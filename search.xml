<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Spring Cloud å¾®æœåŠ¡æƒé™ç³»ç»Ÿæ­å»ºæ•™ç¨‹]]></title>
    <url>%2Fbook.html</url>
    <content type="text"><![CDATA[ðŸ“–ã€Š Spring Cloud å¾®æœåŠ¡æƒé™ç³»ç»Ÿæ­å»ºæ•™ç¨‹ ã€‹ä¸€æœ¬åŸºäºŽSpring Cloud Hoxton.RELEASE&amp;Spring Cloud Oauth2&amp;Spring Cloud Alibabaçš„å¾®æœåŠ¡æƒé™ç³»ç»Ÿæ­å»ºæ•™ç¨‹ä¹¦ç±ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ ä»Žé›¶åˆ°K8Sé›†ç¾¤éƒ¨ç½²ã€‚ç¬¬ä¸€ç«  åŸºç¡€æ¡†æž¶æ­å»º1.1 æž¶æž„é¢„è§ˆ1.2 æ­å»ºå¾®æœåŠ¡æ³¨å†Œä¸­å¿ƒ1.3 æ­å»ºè®¤è¯æœåŠ¡å™¨1.4 æ­å»ºå¾®æœåŠ¡ç½‘å…³1.5 æ­å»ºå¾®æœåŠ¡æä¾›è€…ï¼ˆèµ„æºæœåŠ¡å™¨ï¼‰1.6 æœ¬ç« å°ç»“ç¬¬äºŒç«  æž¶æž„å®Œå–„2.1 å‚æ•°é…ç½®åŒ–2.2 å¼‚å¸¸å¤„ç†2.3 Feignçš„ä½¿ç”¨2.4 å¾®æœåŠ¡é˜²æŠ¤2.5 è·¨åŸŸå¤„ç†2.6 æœ¬ç« å°ç»“ç¬¬ä¸‰ç«  å®Œå–„ç™»å½•æµç¨‹3.1 è¡¨ç»“æž„è®¾è®¡3.2 å®Œå–„ç™»å½•3.3 æ•´åˆå›¾å½¢éªŒè¯ç 3.4 SentineléªŒè¯ç é™æµ3.5 æœ¬ç« å°ç»“ç¬¬å››ç«  æ•´åˆSwagger4.1 å®Œå–„febs-server-system4.2 æŽ¥å…¥Swagger4.3 Swagger OAuth2è®¤è¯4.4 æœ¬ç« å°ç»“ç¬¬äº”ç«  æ•´åˆç¬¬ä¸‰æ–¹æœåŠ¡5.1 æ•´åˆSpring Boot Admin5.2 Sleuth Zipkiné“¾è·¯è¿½è¸ª5.3 logbackæ—¥å¿—æ‰“å°5.4 ELKæ—¥å¿—æ”¶é›†5.5 æœ¬ç« å°ç»“ç¬¬å…­ç«  å‰ç«¯ç³»ç»Ÿä»‹ç»6.1 å°è£…Axios6.2 Vueå¯¼èˆªå®ˆå«6.3 åŠ¨æ€è·¯ç”±æž„å»º6.4 å¤„ç†ç”¨æˆ·ç™»å½•6.5 å¤„ç†ä»¤ç‰Œåˆ·æ–°6.6 è‡ªå®šä¹‰Vueæƒé™æŒ‡ä»¤6.7 æœ¬ç« å°ç»“ç¬¬ä¸ƒç«  å¾®æœåŠ¡éƒ¨ç½²7.1 å¾®æœåŠ¡DokceråŒ–7.2 ä½¿ç”¨Docker Composeéƒ¨ç½²7.3 æœ¬ç« å°ç»“ç¬¬å…«ç«  å¾®æœåŠ¡è¿›é˜¶8.1 ä»¤ç‰Œå­˜å‚¨ç­–ç•¥8.2 ä½¿ç”¨Cloud Gatewayæ­å»ºç½‘å…³8.3 ä½¿ç”¨Alibaba Nacosæ³¨å†Œä¸­å¿ƒ8.4 ä½¿ç”¨Alibaba Nacoså­˜å‚¨é…ç½®8.5 æŽ¥å…¥Prometheus + Grafana8.6 æ•´åˆskywalkingåˆ†å¸ƒå¼è¿½è¸ª8.7 å‡çº§åˆ°Hoxton.RELEASEç¬¬ä¹ç«  K8Sé›†ç¾¤éƒ¨ç½²9.1 é›†ç¾¤çŽ¯å¢ƒå‡†å¤‡9.2 å®‰è£…ç¬¬ä¸‰æ–¹æœåŠ¡9.3 Kubeadmæ­å»ºK8S 1.16.2é›†ç¾¤9.4 NFSæœåŠ¡å™¨æ­å»º9.5 æ­å»ºDockeré•œåƒä»“åº“Harbor9.6 K8Sæž„å»ºé«˜å¯ç”¨Nacos9.7 K8Sæž„å»ºFEBS CloudæœåŠ¡é›†ç¾¤9.8 éƒ¨ç½²å‰ç«¯æµ‹è¯•9.9 K8Så®žè·µæ€»ç»“ç¬¬åç«  åˆ†å¸ƒå¼äº‹åŠ¡ç ”ç©¶10.1 åˆ†å¸ƒå¼æž¶æž„äº‹åŠ¡æŒ‘æˆ˜10.2 åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ10.3 åŸºäºŽæ¶ˆæ¯ä¸­é—´ä»¶RocketMQæ–¹æ¡ˆï¼ˆä¸€ï¼‰10.4 åŸºäºŽæ¶ˆæ¯ä¸­é—´ä»¶RocketMQæ–¹æ¡ˆï¼ˆäºŒï¼‰10.5 åŸºäºŽTX-LCNæ–¹æ¡ˆ10.6 åŸºäºŽé˜¿é‡ŒSeataæ–¹æ¡ˆ10.7 æœ¬ç« æ€»ç»“$(function(){$("#comment-div").remove(),$(".post-copyright").remove(),$("#reward-div").remove(),$(".post-footer").remove()})]]></content>
      <tags>
        <tag>Spring Cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud Alibaba Nacosé…ç½®ä¸­å¿ƒ]]></title>
    <url>%2FSpring-Cloud-Alibaba-Nacos%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83.html</url>
    <content type="text"><![CDATA[ä¸Šä¸€èŠ‚Spring Cloud Alibaba Nacosæ³¨å†Œä¸­å¿ƒè®°å½•äº†Nacosä½œä¸ºæ³¨å†Œä¸­å¿ƒçš„ä½¿ç”¨æ–¹å¼ï¼Œè¿™èŠ‚ç»§ç»­è®°å½•ä¸‹Nacosä½œä¸ºé…ç½®ä¸­å¿ƒçš„ä½¿ç”¨æ–¹å¼ã€‚æœ¬èŠ‚ä½¿ç”¨çš„Spring Cloudç‰ˆæœ¬ä¸ºHoxton.SR3ï¼ŒSpring Cloud Alibabaç‰ˆæœ¬ä¸º2.2.0.RELEASEï¼ŒSpring Bootç‰ˆæœ¬ä¸º2.2.3.RELEASEã€‚æ¡†æž¶æ­å»ºæ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼ŒartifactIdä¸ºspring-cloud-alibaba-nacos-configï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šé¡¹ç›®çš„pomå†…å®¹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.2.5.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-nacos-config&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;spring-cloud-alibaba-nacos-config&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;spring-cloud.version&gt;Hoxton.SR3&lt;/spring-cloud.version&gt; &lt;com-alibaba-cloud.version&gt;2.2.0.RELEASE&lt;/com-alibaba-cloud.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-nacos-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-cloud.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;com-alibaba-cloud.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;å› ä¸ºè¿™èŠ‚è®°å½•çš„æ˜¯Nacosä½œä¸ºé…ç½®ä¸­å¿ƒçš„åŠŸèƒ½ï¼Œæ‰€ä»¥å¼•å…¥çš„æ˜¯spring-cloud-alibaba-nacos-configä¾èµ–ã€‚åŸºæœ¬ä½¿ç”¨åœ¨é¡¹ç›®é…ç½®æ–‡ä»¶application.ymlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š12345server: port: 8080spring: application: name: my-projectä¸Šé¢é…ç½®æŒ‡å®šåº”ç”¨ç«¯å£ä¸º8080ï¼Œåº”ç”¨åç§°ä¸ºmy-projectã€‚æŽ¥ç€åœ¨resourcesç›®å½•ä¸‹æ–°å»ºé…ç½®æ–‡ä»¶bootstrap.ymlï¼Œåœ¨é‡Œé¢æ·»åŠ å¦‚ä¸‹Nacos configé…ç½®ï¼ˆå¿…é¡»åœ¨bootstrap.ymlä¸­é…ç½®ï¼Œbootstrap.ymlä¼˜å…ˆçº§æ¯”application.ymlé«˜ï¼‰ï¼š123456spring: cloud: nacos: config: server-addr: localhost:8848 file-extension: yamlspring.cloud.nacos.config.server-addré…ç½®äº†Nacosé…ç½®ä¸­å¿ƒçš„åœ°å€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡spring.cloud.nacos.server-addræŒ‡å®šï¼Œå®ƒä»¬ä¸¤ä¸ªæ˜¯ç­‰ä»·çš„ï¼›spring.cloud.nacos.config.file-extensionæŒ‡å®šå¾…ä¼šåœ¨Nacosé…ç½®ä¸­å¿ƒè¯»å–çš„é…ç½®çš„æ ¼å¼ä¸ºyamlæ ¼å¼ã€‚æˆ‘ä»¬å›žåˆ°NacosæŽ§åˆ¶å°http://localhost:8848/nacosï¼Œåœ¨é…ç½®åˆ—è¡¨ä¸­æ–°å»ºä¸€ä¸ªé…ç½®ï¼šæˆ‘ä»¬æ–°å»ºäº†ä¸€ä¸ªmy-project.yamlé…ç½®ï¼ˆdataIdä¸ºmy-project.yamlï¼Œgroupä¸ºDEFAULT_GROUPï¼Œå®ƒä»¬çš„å…·ä½“å«ä¹‰ä¸‹é¢ä¼šä»‹ç»åˆ°ï¼‰ï¼Œé…ç½®äº†message: &#39;hello nacos config&#39;ï¼Œåˆ›å»ºå¥½åŽï¼Œç‚¹å‡»å‘å¸ƒå³å¯ã€‚æŽ¥ç€å›žåˆ°æˆ‘ä»¬çš„é¡¹ç›®ï¼Œåœ¨cc.mrbird.nacosç›®å½•ä¸‹æ–°å»ºcontrolleråŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºTestControllerç”¨äºŽæµ‹è¯•é…ç½®èŽ·å–è§„åˆ™ï¼š123456789101112@RestController@RefreshScopepublic class TestController &#123; @Value("$&#123;message:null&#125;") private String message; @GetMapping("message") public String getMessage() &#123; return this.message; &#125;&#125;ä¸Šé¢ä»£ç æˆ‘ä»¬ä»Žåˆšåˆšåœ¨NacosæŽ§åˆ¶å°é…ç½®çš„é…ç½®æ–‡ä»¶ä¸­èŽ·å–messageé…ç½®çš„å€¼ï¼Œ@RefreshScopeç”¨äºŽåˆ·æ–°é…ç½®ï¼Œå³æˆ‘ä»¬åœ¨NacosæŽ§åˆ¶å°ä¿®æ”¹äº†ç›¸å…³é…ç½®ç‚¹å‡»å‘å¸ƒåŽï¼Œæˆ‘ä»¬çš„åº”ç”¨èƒ½å¤Ÿåœ¨ä¸é‡å¯çš„æƒ…å†µä¸‹èŽ·å–åˆ°æœ€æ–°çš„é…ç½®ã€‚å¯åŠ¨é¡¹ç›®ï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼šhttp://localhost:8080/messageï¼šé…ç½®èŽ·å–æˆåŠŸï¼Œåœ¨NacosæŽ§åˆ¶å°ä¸­å°†messageå€¼ä¿®æ”¹ä¸ºhello worldåŽå‘å¸ƒï¼Œå†æ¬¡è®¿é—®http://localhost:8080/messageï¼šèŽ·å–é…ç½®è§„åˆ™Nacosé…ç½®ä¸­å¿ƒé€šè¿‡namespaceã€dataIdå’Œgroupæ¥å”¯ä¸€ç¡®å®šä¸€æ¡é…ç½®ã€‚namespaceï¼Œå³å‘½åç©ºé—´ã€‚é»˜è®¤çš„å‘½åç©ºé—´ä¸ºpublicï¼Œæˆ‘ä»¬å¯ä»¥åœ¨NacosæŽ§åˆ¶å°ä¸­æ–°å»ºå‘½åç©ºé—´ï¼›dataIdï¼Œå³é…ç½®æ–‡ä»¶åç§°ï¼ŒdataIdçš„æ‹¼æŽ¥æ ¼å¼å¦‚ä¸‹ï¼š1$&#123;prefix&#125; - $&#123;spring.profiles.active&#125; . $&#123;file-extension&#125;prefixé»˜è®¤ä¸ºpring.application.nameçš„å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é…ç½®é¡¹spring.cloud.nacos.config.prefixæ¥é…ç½®ï¼›spring.profiles.activeå³ä¸ºå½“å‰çŽ¯å¢ƒå¯¹åº”çš„profileã€‚æ³¨æ„ï¼Œå½“spring.profiles.activeä¸ºç©ºæ—¶ï¼Œå¯¹åº”çš„è¿žæŽ¥ç¬¦-ä¹Ÿå°†ä¸å­˜åœ¨ï¼ŒdataIdçš„æ‹¼æŽ¥æ ¼å¼å˜æˆ${prefix}.${file-extension}ï¼›file-extensionä¸ºé…ç½®å†…å®¹çš„æ•°æ®æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡é…ç½®é¡¹spring.cloud.nacos.config.file-extensionæ¥é…ç½®ã€‚groupï¼Œå³é…ç½®åˆ†ç»„ï¼Œé»˜è®¤ä¸ºDEFAULT_GROUPï¼Œå¯ä»¥é€šè¿‡spring.cloud.nacos.config.groupé…ç½®ã€‚æ‰€ä»¥æ ¹æ®è¿™äº›è§„åˆ™ï¼Œä¸Šé¢ç¤ºä¾‹ä¸­æˆ‘ä»¬çš„åº”ç”¨åç§°spring.application.nameä¸ºmy-projectï¼Œspring.cloud.nacos.config.file-extensionçš„å€¼ä¸ºyamlï¼Œæ²¡æœ‰æŒ‡å®šspring.profiles.activeï¼ŒäºŽæ˜¯dataIdä¸ºmy-project.yamlï¼Œåˆ†ç»„ä¸ºé»˜è®¤çš„DEFAULT_GROUPï¼Œå‘½åç©ºé—´ä¸ºé»˜è®¤çš„publicã€‚è¿™å°±æ˜¯æˆ‘ä»¬åœ¨NacosæŽ§åˆ¶å°ä¸­æ–°å»ºé…ç½®æ—¶çš„æ ¹æ®ã€‚é…ç½®åˆ’åˆ†å®žæˆ˜Nacosé…ç½®ä¸­å¿ƒçš„namespaceã€dataIdå’Œgroupå¯ä»¥æ–¹ä¾¿çµæ´»åœ°åˆ’åˆ†é…ç½®ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬çŽ°åœ¨æœ‰ä¸€ä¸ªé¡¹ç›®éœ€è¦å¼€å‘ï¼Œé¡¹ç›®åç§°ä¸ºfebsï¼Œé¡¹ç›®å¼€å‘äººå‘˜åˆ†ä¸ºä¸¤ä¸ªç»„ï¼šGROUP_Aå’ŒGROUP_Bï¼Œé¡¹ç›®åˆ†ä¸ºä¸‰ä¸ªçŽ¯å¢ƒï¼šå¼€å‘çŽ¯å¢ƒdevã€æµ‹è¯•çŽ¯å¢ƒtestå’Œç”Ÿäº§çŽ¯å¢ƒprodã€‚å‡å¦‚çŽ°åœ¨GROUP_Aç»„çš„ç»„é•¿éœ€è¦åœ¨Nacosä¸­æ–°å»ºä¸€ä¸ªå¼€å‘çŽ¯å¢ƒçš„febsé¡¹ç›®é…ç½®ï¼Œé‚£ä¹ˆä»–å¯ä»¥è¿™æ ·åšï¼šåœ¨NacosæŽ§åˆ¶å°ä¸­æ–°å»ºä¸€ä¸ªåç§°ä¸ºfebsçš„å‘½åç©ºé—´ï¼šæ–°å»ºfebså‘½åç©ºé—´åŽï¼Œä¼šç”Ÿæˆä¸€ä¸ªå”¯ä¸€æ ‡è¯†è¯¥å‘½åç©ºé—´çš„å‘½åç©ºé—´id2ef2186e-078c-4904-8643-ff5e90555456ã€‚åœ¨NacosæŽ§åˆ¶å°ä¸­æ–°å»ºä¸€ä¸ªé…ç½®ï¼šæœ€åŽåœ¨febsé¡¹ç›®çš„bootstrap.ymlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®å³å¯ï¼š1234567891011spring: profiles: active: dev cloud: nacos: config: server-addr: localhost:8848 file-extension: yaml prefix: febs namespace: '2ef2186e-078c-4904-8643-ff5e90555456' group: GROUP_Aé…ç½®å›žæ»šNacosä¸­ï¼Œä¿®æ”¹é…ç½®ç‚¹å‡»å‘å¸ƒåŽä¼šåˆ›å»ºä¸€ä¸ªå¯¹åº”çš„åŽ†å²ç‰ˆæœ¬å¿«ç…§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨NacosæŽ§åˆ¶å°çš„åŽ†å²ç‰ˆæœ¬åˆ—è¡¨ä¸­æ‰¾åˆ°è¿™äº›å¿«ç…§ï¼šç‚¹å‡»å›žæ»šæŒ‰é’®å³å¯å°†é…ç½®æ¢å¤åˆ°æŒ‡å®šçš„ç‰ˆæœ¬ã€‚èŽ·å–å¤šä¸ªé…ç½®é™¤äº†é€šè¿‡ä¸Šé¢çš„æ–¹å¼æŒ‡å®šä¸€ä¸ªå”¯ä¸€é…ç½®å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åŒæ—¶èŽ·å–å¤šä¸ªé…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œæ¯”å¦‚ï¼Œå°†é¡¹ç›®çš„bootstrap.ymlå†…å®¹ä¿®æ”¹ä¸ºï¼š123456789101112spring: cloud: nacos: config: server-addr: localhost:8848 extension-configs: - dataId: ext-config-one.yaml group: DEFAULT_GROUP refresh: true - dataId: ext-config-two.yaml group: DEFAULT_GROUP refresh: falsespring.cloud.nacos.config.extension-configs[n].dataIdï¼ŒæŒ‡å®šå¤šä¸ªé…ç½®çš„dataIdï¼Œå¿…é¡»åŒ…å«æ–‡ä»¶æ ¼å¼ï¼Œæ”¯æŒpropertiesã€yamlæˆ–ymlï¼›spring.cloud.nacos.config.extension-configs[n].groupï¼ŒæŒ‡å®šåˆ†ç»„ï¼›spring.cloud.nacos.config.extension-configs[n].refreshï¼Œæ˜¯å¦æ”¯æŒåˆ·æ–°ã€‚ä¸Šé¢çš„é…ç½®ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«ä»ŽDEFAULT_GROUPä¸­èŽ·å–äº†ext-config-one.yamlå’Œext-config-two.yamlé…ç½®å†…å®¹ï¼Œå¹¶ä¸”ext-config-one.yamlæ”¯æŒåˆ·æ–°ï¼Œext-config-two.yamlä¸æ”¯æŒåˆ·æ–°ã€‚æ²¡æœ‰namespaceçš„é…ç½®ï¼Œè¨€å¤–ä¹‹æ„å°±æ˜¯Nacosç›®å‰è¿˜ä¸æ”¯æŒå¤šä¸ªé…ç½®æŒ‡å®šä¸åŒçš„å‘½åç©ºé—´ã€‚æˆ‘ä»¬åœ¨NacosæŽ§åˆ¶å°ä¸­æ–°å»ºè¿™ä¸¤ä¸ªé…ç½®ï¼šext-config-one.yamlé…ç½®å†…å®¹ï¼š1ext1: 'hello'ext-config-two.yamlé…ç½®å†…å®¹ï¼š1ext2: 'world'åœ¨é¡¹ç›®çš„TestControllerä¸­æ·»åŠ ï¼š12345678910111213141516@RestController@RefreshScopepublic class TestController &#123; @Value("$&#123;ext1:null&#125;") private String ext1; @Value("$&#123;ext2:null&#125;") private String ext2; @GetMapping("multi") public String multiConfig() &#123; return String.format("ext1: %s ext2: %s", ext1, ext2); &#125; ...&#125;å¯åŠ¨é¡¹ç›®ï¼Œæµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8080/multiï¼šå°†ext1çš„å€¼ä¿®æ”¹ä¸ºniceï¼Œext2çš„å€¼ä¿®æ”¹ä¸ºjobï¼šå¯ä»¥çœ‹åˆ°ext1çš„å€¼æ›´æ–°äº†ï¼Œext2æ²¡æœ‰æ›´æ–°ã€‚å¤šé…ç½®å…±äº«å¤šé…ç½®å…±äº«å…¶å®žå’ŒèŽ·å–å¤šä¸ªæ–‡ä»¶é…ç½®ä½œç”¨å·®ä¸å¤šï¼Œä¸‹é¢æ¼”ç¤ºä¸‹å¤šé…ç½®å…±äº«ã€‚å°†bootstrap.ymlé…ç½®ä¿®æ”¹ä¸ºï¼š123456spring: cloud: nacos: config: server-addr: localhost:8848 shared-configs: ext-config-one.yaml,ext-config-two.yamlspring.cloud.nacos.config.shared-configsæŒ‡å®šäº†å…±äº«ext-config-one.yamlå’Œext-config-two.yamlçš„é…ç½®ã€‚é‡å¯é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/multiï¼šä¹Ÿå¯ä»¥æ­£å¸¸èŽ·å–ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºæ˜¯å¤šé…ç½®å…±äº«è¿˜æ˜¯èŽ·å–å¤šä¸ªé…ç½®ï¼Œè¦å®Œæˆçš„äº‹æƒ…æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡å®ƒä»¬éƒ½æœ‰å„è‡ªçš„å±€é™æ€§ã€‚å¤šé…ç½®å…±äº«æ— æ³•æŒ‡å®šåˆ†ç»„ã€æ— æ³•æŒ‡å®šå‘½åç©ºé—´ã€æ— æ³•é…ç½®æ˜¯å¦åˆ·æ–°ï¼›èŽ·å–å¤šä¸ªé…ç½®ç›¸å¯¹è¾ƒä¸ºçµæ´»ï¼Œä¸è¿‡ä¹Ÿä¸èƒ½é…ç½®å‘½åç©ºé—´ã€‚å…·ä½“ç›¸å…³çš„è®¨è®ºå¯ä»¥å‚è€ƒï¼šhttps://github.com/alibaba/spring-cloud-alibaba/issues/141å¸¸ç”¨é…ç½®é…ç½®é¡¹keyé»˜è®¤å€¼è¯´æ˜ŽæœåŠ¡ç«¯åœ°å€spring.cloud.nacos.config.server-addrDataIdå‰ç¼€spring.cloud.nacos.config.prefixspring.application.nameGroupspring.cloud.nacos.config.groupDEFAULT_GROUPdataIDåŽç¼€åŠå†…å®¹æ–‡ä»¶æ ¼å¼spring.cloud.nacos.config.file-extensionpropertiesdataIdçš„åŽç¼€ï¼ŒåŒæ—¶ä¹Ÿæ˜¯é…ç½®å†…å®¹çš„æ–‡ä»¶æ ¼å¼ï¼Œç›®å‰åªæ”¯æŒ propertiesé…ç½®å†…å®¹çš„ç¼–ç æ–¹å¼spring.cloud.nacos.config.encodeUTF-8é…ç½®çš„ç¼–ç èŽ·å–é…ç½®çš„è¶…æ—¶æ—¶é—´spring.cloud.nacos.config.timeout3000å•ä½ä¸º msé…ç½®çš„å‘½åç©ºé—´spring.cloud.nacos.config.namespaceå¸¸ç”¨åœºæ™¯ä¹‹ä¸€æ˜¯ä¸åŒçŽ¯å¢ƒçš„é…ç½®çš„åŒºåˆ†éš”ç¦»ï¼Œä¾‹å¦‚å¼€å‘æµ‹è¯•çŽ¯å¢ƒå’Œç”Ÿäº§çŽ¯å¢ƒçš„èµ„æºéš”ç¦»ç­‰ã€‚AccessKeyspring.cloud.nacos.config.access-keySecretKeyspring.cloud.nacos.config.secret-keyç›¸å¯¹è·¯å¾„spring.cloud.nacos.config.context-pathæœåŠ¡ç«¯ API çš„ç›¸å¯¹è·¯å¾„æŽ¥å…¥ç‚¹spring.cloud.nacos.config.endpointåœ°åŸŸçš„æŸä¸ªæœåŠ¡çš„å…¥å£åŸŸåï¼Œé€šè¿‡æ­¤åŸŸåå¯ä»¥åŠ¨æ€åœ°æ‹¿åˆ°æœåŠ¡ç«¯åœ°å€æ˜¯å¦å¼€å¯ç›‘å¬å’Œè‡ªåŠ¨åˆ·æ–°spring.cloud.nacos.config.refresh.enabledtrueå‚è€ƒé“¾æŽ¥ï¼šhttps://github.com/alibaba/spring-cloud-alibaba/blob/master/spring-cloud-alibaba-examples/nacos-example/nacos-config-example/readme-zh.mdhttps://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_nacos_configæœ¬èŠ‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/75.spring-cloud-alibaba-nacos-configã€‚]]></content>
      <tags>
        <tag>Spring Cloud</tag>
        <tag>Spring Cloud Alibaba</tag>
        <tag>Nacos</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud Alibaba Nacosæ³¨å†Œä¸­å¿ƒ]]></title>
    <url>%2FSpring-Cloud-Alibaba-Nacos%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83.html</url>
    <content type="text"><![CDATA[Nacosæ˜¯ä¸€æ¬¾é›†æœåŠ¡æ³¨å†Œå‘çŽ°ã€æœåŠ¡é…ç½®å’Œç®¡ç†äºŽä¸€èº«çš„å¼€æºè½¯ä»¶ï¼Œè¿™èŠ‚ä¸»è¦è®°å½•Nacosçš„æœåŠ¡æ³¨å†Œå‘çŽ°åŠŸèƒ½çš„ä½¿ç”¨ã€‚å€ŸåŠ©Spring Cloud Alibaba Nacos Discoveryï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°ä½¿ç”¨Spring Cloudç¼–ç¨‹æ¨¡åž‹ä½“éªŒNacosçš„æœåŠ¡æ³¨å†Œå‘çŽ°åŠŸèƒ½ã€‚æœ¬èŠ‚ä½¿ç”¨çš„Spring Cloudç‰ˆæœ¬ä¸ºHoxton.SR3ï¼ŒSpring Cloud Alibabaç‰ˆæœ¬ä¸º2.2.0.RELEASEï¼ŒSpring Bootç‰ˆæœ¬ä¸º2.2.3.RELEASEã€‚Nacoså®‰è£…å› ä¸ºSpring Cloud Alibaba 2.2.0.RELEASEå†…ç½®çš„Nacos clientç‰ˆæœ¬ä¸º1.1.4ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬çš„Nacosã€‚Nacosä¸‹è½½åœ°å€ï¼šhttps://github.com/alibaba/nacos/releasesï¼Œé€‰æ‹©nacos-server-1.1.4.zip ä¸‹è½½å¹¶è§£åŽ‹ï¼šè§£åŽ‹åŽï¼Œæ‰“å¼€confç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨æœ«å°¾æ·»åŠ æ•°æ®æºé…ç½®ï¼š12345spring.datasource.platform=mysqldb.num=1db.url.0=jdbc:mysql://localhost:3306/nacos?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=truedb.user=rootdb.password=123456ç„¶åŽåœ¨MySQLæ•°æ®åº“ä¸­æ–°å»ºnacosæ•°æ®åº“ï¼Œå¹¶å¯¼å…¥Nacosè§£åŽ‹åŒ…confç›®å½•ä¸‹çš„nacos-mysql.sqlè„šæœ¬ï¼Œå¯¼å…¥åŽï¼Œåº“è¡¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šæ•°æ®å±‚å‡†å¤‡å¥½åŽï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯åŠ¨Nacosäº†ã€‚ç¬”è€…çš„ç”µè„‘ä¸ºMacï¼Œæ‰€ä»¥è¿™é‡Œä»¥UnixçŽ¯å¢ƒä¸ºä¾‹ã€‚ç»ˆç«¯åˆ‡æ¢åˆ°Nacosè§£åŽ‹ç›®å½•ä¸‹çš„binç›®å½•ï¼Œç„¶åŽæ‰§è¡Œsh startup.sh -m standaloneå¯åŠ¨å•æœºç‰ˆNacosã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªrun.shè„šæœ¬ï¼š1234#/bin/bashsh shutdown.shsh startup.sh -m standalonetail -10f /Users/mrbird/Desktop/nacos/logs/start.outå…¶ä¸­/Users/mrbird/Desktop/nacosä¸ºæˆ‘çš„Nacosè§£åŽ‹ç›®å½•ã€‚å¯åŠ¨åŽï¼Œæµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8848/nacos/#/loginï¼šè¯´æ˜ŽNacoså¯åŠ¨æˆåŠŸï¼Œè´¦å·å¯†ç éƒ½ä¸ºnacosã€‚æ¡†æž¶æ­å»ºä½¿ç”¨IDEAåˆ›å»ºä¸€ä¸ªmavené¡¹ç›®ï¼ŒartifactIdä¸ºspring-cloud-alibaba-nacos-registerï¼Œç„¶åŽåœ¨å…¶ä¸‹é¢åˆ›å»ºä¸¤ä¸ªModuleï¼ˆSpring Booté¡¹ç›®ï¼‰ï¼ŒartifactIdåˆ†åˆ«ä¸ºconsumerå’Œproviderï¼Œå……å½“æœåŠ¡æ¶ˆè´¹ç«¯å’ŒæœåŠ¡æä¾›ç«¯ï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šspring-cloud-alibaba-nacos-registerçš„pomå†…å®¹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-nacos-register&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;pom&lt;/packaging&gt; &lt;modules&gt; &lt;module&gt;provider&lt;/module&gt; &lt;module&gt;consumer&lt;/module&gt; &lt;/modules&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.2.3.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;spring-cloud.version&gt;Hoxton.SR3&lt;/spring-cloud.version&gt; &lt;com-alibaba-cloud.version&gt;2.2.0.RELEASE&lt;/com-alibaba-cloud.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-cloud.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;com-alibaba-cloud.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt;&lt;/project&gt;å› ä¸ºæœ¬èŠ‚æ¼”ç¤ºçš„æ˜¯Nacosçš„æœåŠ¡æ³¨å†Œå‘çŽ°åŠŸèƒ½ï¼Œæ‰€ä»¥å¼•å…¥çš„æ˜¯spring-cloud-alibaba-nacos-discoveryä¾èµ–ã€‚providerçš„pomçš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021222324&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-nacos-register&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;relativePath&gt;../pom.xml&lt;/relativePath&gt; &lt;/parent&gt; &lt;artifactId&gt;provider&lt;/artifactId&gt; &lt;name&gt;provider&lt;/name&gt; &lt;description&gt;æœåŠ¡æä¾›ç«¯&lt;/description&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;consumerçš„pomå†…å®¹å¦‚ä¸‹ï¼š123456789101112131415161718192021222324&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-nacos-register&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;relativePath&gt;../pom.xml&lt;/relativePath&gt; &lt;/parent&gt; &lt;artifactId&gt;consumer&lt;/artifactId&gt; &lt;name&gt;consumer&lt;/name&gt; &lt;description&gt;æœåŠ¡æ¶ˆè´¹ç«¯&lt;/description&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;Nacosä½œä¸ºæ³¨å†Œä¸­å¿ƒåœ¨providerçš„cc.mrbird.providerç›®å½•ä¸‹æ–°å»ºcontrolleråŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºHelloControllerï¼š123456789@RestController@RequestMapping("provide")public class HelloController &#123; @GetMapping("&#123;message&#125;") public String hello(@PathVariable String message) &#123; return String.format("hello %s", message); &#125;&#125;æä¾›äº†ä¸€ä¸ªRESTæŽ¥å£ï¼Œä¾›consumerè°ƒç”¨ã€‚ç„¶åŽåœ¨providerçš„é¡¹ç›®é…ç½®æ–‡ä»¶application.ymlé‡Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š12345678server: port: 8001spring: application: name: provider cloud: nacos: server-addr: localhost:8848server.portï¼ŒprovideræœåŠ¡ç«¯å£ä¸º8001ï¼›spring.application.nameï¼ŒæœåŠ¡åç§°ä¸ºproviderspring.cloud.nacos.server-addrï¼ŒæŒ‡å®šNacosæ³¨å†Œä¸­å¿ƒçš„åœ°å€ã€‚providerä»£ç å‡†å¤‡å¥½åŽï¼ŒæŽ¥ç€åœ¨consumeré¡¹ç›®çš„cc.mrbird.consumerç›®å½•ä¸‹æ–°å»ºcontrolleråŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºConsumeControllerï¼š1234567891011121314151617@RestController@RequestMapping("consume")public class ConsumeController &#123; @Autowired private LoadBalancerClient loadBalancerClient; @Autowired private RestTemplate restTemplate; @GetMapping("hello/&#123;message&#125;") public String hello(@PathVariable String message) &#123; ServiceInstance serviceInstance = loadBalancerClient.choose("provider"); String path = String.format("http://%s:%s/provide/%s", serviceInstance.getHost(), serviceInstance.getPort(), message); String result = restTemplate.getForObject(path, String.class); return String.format("%s from %s %s", result, serviceInstance.getHost(), serviceInstance.getPort()); &#125;&#125;å› ä¸ºspring-cloud-alibaba-nacos-discoveryå†…ç½®äº†Ribbonï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æŽ¥æ³¨å…¥LoadBalancerClientï¼ŒRestTemplateæˆ‘ä»¬ç¨åŽå†é…ç½®ã€‚hello()æ–¹æ³•ä¸­æˆ‘ä»¬é€šè¿‡æœåŠ¡æä¾›è€…çš„åç§°providerï¼ˆå³provideré¡¹ç›®é…ç½®çš„spring.application.nameï¼‰ä»ŽNacosæ³¨å†Œä¸­å¿ƒä¸­èŽ·å–å¯¹åº”çš„æœåŠ¡å®žä¾‹ï¼Œç„¶åŽè®¿é—®å…¶æä¾›çš„/provide/{message} GETæœåŠ¡ã€‚è¿™äº›åœ¨Spring Cloud Ribbonå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ä¸€èŠ‚ä¸­éƒ½ä»‹ç»è¿‡äº†ï¼Œæœ‰ä¸æ‡‚çš„å¯ä»¥å‚é˜…ä¸‹ã€‚æŽ¥ç€åœ¨consumeré¡¹ç›®çš„cc.mrbird.consumerç›®å½•ä¸‹æ–°å»ºconfigureåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºConsumerConfigureï¼š12345678@Configurationpublic class ConsumerConfigure &#123; @Bean public RestTemplate restTemplate() &#123; return new RestTemplate(); &#125;&#125;ä¸Šé¢ä»£ç é…ç½®äº†RestTemplate Beanã€‚æœ€åŽåœ¨consumeré¡¹ç›®çš„é…ç½®æ–‡ä»¶application.ymlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š12345678server: port: 9001spring: application: name: consumer cloud: nacos: server-addr: localhost:8848é…ç½®å’Œprovideré¡¹ç›®ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚åˆ†åˆ«å¯åŠ¨providerå’Œconsumeré¡¹ç›®ï¼šè§‚å¯ŸNacosæŽ§åˆ¶å°æœåŠ¡åˆ—è¡¨ï¼šå¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªæœåŠ¡éƒ½æ³¨å†Œè¿›æ¥äº†ã€‚æŽ¥ç€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:9001/consume/hello/nacosï¼šè°ƒç”¨æˆåŠŸï¼Œè¯´æ˜ŽæœåŠ¡å‘çŽ°æˆåŠŸã€‚æµ‹è¯•è´Ÿè½½å‡è¡¡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨ProviderApplicationä¸Šå³é”®é€‰æ‹©Copy Configurationâ€¦ï¼šç„¶åŽæŒ‰ç…§ä¸‹å›¾æ‰€ç¤ºå¡«å†™ç›¸å…³å†…å®¹ï¼šç‚¹å‡»okä¿å­˜åŽï¼Œå¯åŠ¨å®ƒï¼šè§‚å¯ŸNacosæŽ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°providerå·²ç»æœ‰ä¸¤ä¸ªå®žä¾‹äº†ï¼šç„¶åŽå¤šæ¬¡è®¿é—®ï¼šhttp://localhost:9001/consume/hello/nacosï¼Œå¯ä»¥çœ‹åˆ°è¯·æ±‚æ˜¯å‡è¡¡çš„ï¼ˆé»˜è®¤ä¸ºè½®è¯¢ç®—æ³•ï¼‰ï¼šNacosæ³¨å†Œä¸­å¿ƒé…ç½®æ›´å¤šå¯ç”¨Nacos Descoveryé…ç½®ï¼šé…ç½®é¡¹Keyé»˜è®¤å€¼è¯´æ˜ŽæœåŠ¡ç«¯åœ°å€spring.cloud.nacos.discovery.server-addræ— Nacos Server å¯åŠ¨ç›‘å¬çš„ipåœ°å€å’Œç«¯å£æœåŠ¡åspring.cloud.nacos.discovery.service${spring.application.name}ç»™å½“å‰çš„æœåŠ¡å‘½åæœåŠ¡åˆ†ç»„spring.cloud.nacos.discovery.groupDEFAULT_GROUPè®¾ç½®æœåŠ¡æ‰€å¤„çš„åˆ†ç»„æƒé‡spring.cloud.nacos.discovery.weight1å–å€¼èŒƒå›´ 1 åˆ° 100ï¼Œæ•°å€¼è¶Šå¤§ï¼Œæƒé‡è¶Šå¤§ç½‘å¡åspring.cloud.nacos.discovery.network-interfaceæ— å½“IPæœªé…ç½®æ—¶ï¼Œæ³¨å†Œçš„IPä¸ºæ­¤ç½‘å¡æ‰€å¯¹åº”çš„IPåœ°å€ï¼Œå¦‚æžœæ­¤é¡¹ä¹Ÿæœªé…ç½®ï¼Œåˆ™é»˜è®¤å–ç¬¬ä¸€å—ç½‘å¡çš„åœ°å€æ³¨å†Œçš„IPåœ°å€spring.cloud.nacos.discovery.ipæ— ä¼˜å…ˆçº§æœ€é«˜æ³¨å†Œçš„ç«¯å£spring.cloud.nacos.discovery.port-1é»˜è®¤æƒ…å†µä¸‹ä¸ç”¨é…ç½®ï¼Œä¼šè‡ªåŠ¨æŽ¢æµ‹å‘½åç©ºé—´spring.cloud.nacos.discovery.namespaceæ— å¸¸ç”¨åœºæ™¯ä¹‹ä¸€æ˜¯ä¸åŒçŽ¯å¢ƒçš„æ³¨å†Œçš„åŒºåˆ†éš”ç¦»ï¼Œä¾‹å¦‚å¼€å‘æµ‹è¯•çŽ¯å¢ƒå’Œç”Ÿäº§çŽ¯å¢ƒçš„èµ„æºï¼ˆå¦‚é…ç½®ã€æœåŠ¡ï¼‰éš”ç¦»ç­‰ã€‚AccessKeyspring.cloud.nacos.discovery.access-keyæ— å½“è¦ä¸Šé˜¿é‡Œäº‘æ—¶ï¼Œé˜¿é‡Œäº‘ä¸Šé¢çš„ä¸€ä¸ªäº‘è´¦å·åSecretKeyspring.cloud.nacos.discovery.secret-keyæ— å½“è¦ä¸Šé˜¿é‡Œäº‘æ—¶ï¼Œé˜¿é‡Œäº‘ä¸Šé¢çš„ä¸€ä¸ªäº‘è´¦å·å¯†ç Metadataspring.cloud.nacos.discovery.metadataæ— ä½¿ç”¨Mapæ ¼å¼é…ç½®ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è‡ªå®šä¹‰ä¸€äº›å’ŒæœåŠ¡ç›¸å…³çš„å…ƒæ•°æ®ä¿¡æ¯æ—¥å¿—æ–‡ä»¶åspring.cloud.nacos.discovery.log-nameæ— é›†ç¾¤spring.cloud.nacos.discovery.cluster-nameDEFAULTé…ç½®æˆNacosé›†ç¾¤åç§°æŽ¥å…¥ç‚¹spring.cloud.nacos.discovery.enpointUTF-8åœ°åŸŸçš„æŸä¸ªæœåŠ¡çš„å…¥å£åŸŸåï¼Œé€šè¿‡æ­¤åŸŸåå¯ä»¥åŠ¨æ€åœ°æ‹¿åˆ°æœåŠ¡ç«¯åœ°å€æ˜¯å¦é›†æˆRibbonribbon.nacos.enabledtrueä¸€èˆ¬éƒ½è®¾ç½®æˆtrueå³å¯æ˜¯å¦å¼€å¯Nacos Watchspring.cloud.nacos.discovery.watch.enabledtrueå¯ä»¥è®¾ç½®æˆfalseæ¥å…³é—­ watchæœ¬èŠ‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/74.spring-cloud-alibaba-nacos-registerã€‚å‚è€ƒè‡ªå®˜æ–¹æ–‡æ¡£ï¼šhttps://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_nacos_discovery]]></content>
      <tags>
        <tag>Spring Cloud</tag>
        <tag>Spring Cloud Alibaba</tag>
        <tag>Nacos</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Batchå¼‚å¸¸å¤„ç†]]></title>
    <url>%2FSpring-Batch%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86.html</url>
    <content type="text"><![CDATA[Spring Batchå¤„ç†ä»»åŠ¡è¿‡ç¨‹ä¸­å¦‚æžœå‘ç”Ÿäº†å¼‚å¸¸ï¼Œé»˜è®¤æœºåˆ¶æ˜¯é©¬ä¸Šåœæ­¢ä»»åŠ¡æ‰§è¡Œï¼ŒæŠ›å‡ºç›¸åº”å¼‚å¸¸ï¼Œå¦‚æžœä»»åŠ¡è¿˜åŒ…å«æœªæ‰§è¡Œçš„æ­¥éª¤ä¹Ÿä¸ä¼šè¢«æ‰§è¡Œã€‚è¦æ”¹å˜è¿™ä¸ªé»˜è®¤è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®å¼‚å¸¸é‡è¯•å’Œå¼‚å¸¸è·³è¿‡æœºåˆ¶ã€‚å¼‚å¸¸è·³è¿‡ï¼šé‡åˆ°å¼‚å¸¸çš„æ—¶å€™ä¸å¸Œæœ›ç»“æŸä»»åŠ¡ï¼Œè€Œæ˜¯è·³è¿‡è¿™ä¸ªå¼‚å¸¸ï¼Œç»§ç»­æ‰§è¡Œï¼›å¼‚å¸¸é‡è¯•ï¼šé‡åˆ°å¼‚å¸¸çš„æ—¶å€™ç»è¿‡æŒ‡å®šæ¬¡æ•°çš„é‡è¯•ï¼Œå¦‚æžœè¿˜æ˜¯å¤±è´¥çš„è¯ï¼Œæ‰ä¼šåœæ­¢ä»»åŠ¡ã€‚é™¤äº†è¿™ä¸¤ä¸ªç‰¹æ€§å¤–ï¼Œæœ¬æ–‡ä¹Ÿä¼šè®°å½•ä¸€äº›åˆ«çš„ç‰¹æ€§ã€‚æ¡†æž¶æ­å»ºæ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.2.4.RELEASEï¼ŒartifactIdä¸ºspring-batch-exceptionï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå‰©ä¸‹çš„æ•°æ®åº“å±‚çš„å‡†å¤‡ï¼Œé¡¹ç›®é…ç½®ï¼Œä¾èµ–å¼•å…¥å’ŒSpring Batchå…¥é—¨æ–‡ç« ä¸­çš„æ¡†æž¶æ­å»ºæ­¥éª¤ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚ä¸‹é¢æˆ‘ä»¬æ¼”ç¤ºä¸‹ï¼Œé»˜è®¤æƒ…å†µä¸‹Spring Batchå¤„ç†ä»»åŠ¡é‡åˆ°å¼‚å¸¸æ˜¯æ€Žä¹ˆå¤„ç†çš„ã€‚åœ¨cc.mrbird.batchç›®å½•ä¸‹æ–°å»ºjobåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºDefaultExceptionJobDemoï¼š123456789101112131415161718192021222324252627282930@Componentpublic class DefaultExceptionJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job defaultExceptionJob() &#123; return jobBuilderFactory.get("defaultExceptionJob") .start( stepBuilderFactory.get("step") .tasklet((stepContribution, chunkContext) -&gt; &#123; // èŽ·å–æ‰§è¡Œä¸Šä¸‹æ–‡ ExecutionContext executionContext = chunkContext.getStepContext().getStepExecution().getExecutionContext(); if (executionContext.containsKey("success")) &#123; System.out.println("ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ"); return RepeatStatus.FINISHED; &#125; else &#123; String errorMessage = "å¤„ç†ä»»åŠ¡è¿‡ç¨‹å‘ç”Ÿå¼‚å¸¸"; System.out.println(errorMessage); executionContext.put("success", true); throw new RuntimeException(errorMessage); &#125; &#125;).build() ).build(); &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨Stepçš„tasklet()æ–¹æ³•ä¸­èŽ·å–äº†æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”åˆ¤æ–­æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ˜¯å¦åŒ…å«keysuccessï¼Œå¦‚æžœåŒ…å«ï¼Œåˆ™ä»»åŠ¡æ‰§è¡ŒæˆåŠŸï¼›å¦‚æžœä¸åŒ…å«ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼ˆæŠ›å‡ºå¼‚å¸¸å‰ï¼Œåœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ·»åŠ successkeyï¼‰ã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š1234567891011122020-03-11 17:12:50.253 INFO 38673 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=defaultExceptionJob]] launched with the following parameters: [&#123;&#125;]2020-03-11 17:12:50.323 INFO 38673 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]å¤„ç†ä»»åŠ¡è¿‡ç¨‹å‘ç”Ÿå¼‚å¸¸2020-03-11 17:12:50.352 ERROR 38673 --- [ main] o.s.batch.core.step.AbstractStep : Encountered an error executing step step in job defaultExceptionJobjava.lang.RuntimeException: å¤„ç†ä»»åŠ¡è¿‡ç¨‹å‘ç”Ÿå¼‚å¸¸ at cc.mrbird.batch.job.DefaultExceptionJobDemo.lambda$defaultExceptionJob$0(DefaultExceptionJobDemo.java:38) ~[classes/:na] at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:407) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:331) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140) ~[spring-tx-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.batch.core.step.tasklet.TaskletStep$2.doInChunkContext(TaskletStep.java:273) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE]...å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Batchå¤„ç†ä»»åŠ¡è¿‡ç¨‹ä¸­å¦‚æžœå‘ç”Ÿäº†å¼‚å¸¸ä¼šé©¬ä¸Šåœæ­¢ä»»åŠ¡çš„æ‰§è¡Œã€‚å†æ¬¡å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š123452020-03-11 17:14:03.184 INFO 38691 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=defaultExceptionJob]] launched with the following parameters: [&#123;&#125;]2020-03-11 17:14:03.264 INFO 38691 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ2020-03-11 17:14:03.302 INFO 38691 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 37ms2020-03-11 17:14:03.326 INFO 38691 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=defaultExceptionJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 120mså› ä¸ºåœ¨ä¸Šæ¬¡ä»»åŠ¡æŠ›å‡ºå¼‚å¸¸å‰ï¼Œæˆ‘ä»¬åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ·»åŠ successkeyï¼ˆé…åˆMySQLæŒä¹…åŒ–ï¼Œä¸ä¼šå› é¡¹ç›®å¯åŠ¨è€Œä¸¢å¤±ï¼‰ã€‚å¼‚å¸¸é‡è¯•Spring Batchå…è®¸æˆ‘ä»¬é…ç½®ä»»åŠ¡åœ¨é‡åˆ°æŒ‡å®šå¼‚å¸¸æ—¶è¿›è¡ŒæŒ‡å®šæ¬¡æ•°çš„é‡è¯•ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰å¼‚å¸¸ã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºexceptionåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºMyJobExecutionExceptionï¼š12345678public class MyJobExecutionException extends Exception&#123; private static final long serialVersionUID = 7168487913507656106L; public MyJobExecutionException(String message) &#123; super(message); &#125;&#125;ç„¶åŽåœ¨jobåŒ…ä¸‹æ–°å»ºRetryExceptionJobDemoï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546@Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job retryExceptionJob() &#123; return jobBuilderFactory.get("retryExceptionJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;String, String&gt;chunk(2) .reader(listItemReader()) .processor(myProcessor()) .writer(list -&gt; list.forEach(System.out::println)) .faultTolerant() // é…ç½®é”™è¯¯å®¹å¿ .retry(MyJobExecutionException.class) // é…ç½®é‡è¯•çš„å¼‚å¸¸ç±»åž‹ .retryLimit(3) // é‡è¯•3æ¬¡ï¼Œä¸‰æ¬¡è¿‡åŽè¿˜æ˜¯å¼‚å¸¸çš„è¯ï¼Œåˆ™ä»»åŠ¡ä¼šç»“æŸï¼Œ // å¼‚å¸¸çš„æ¬¡æ•°ä¸ºreaderï¼Œprocessorå’Œwriterä¸­çš„æ€»æ•°ï¼Œè¿™é‡Œä»…åœ¨processoré‡Œæ¼”ç¤ºå¼‚å¸¸é‡è¯• .build(); &#125; private ListItemReader&lt;String&gt; listItemReader() &#123; ArrayList&lt;String&gt; datas = new ArrayList&lt;&gt;(); IntStream.range(0, 5).forEach(i -&gt; datas.add(String.valueOf(i))); return new ListItemReader&lt;&gt;(datas); &#125; private ItemProcessor&lt;String, String&gt; myProcessor() &#123; return new ItemProcessor&lt;String, String&gt;() &#123; private int count; @Override public String process(String item) throws Exception &#123; System.out.println("å½“å‰å¤„ç†çš„æ•°æ®ï¼š" + item); if (count &gt;= 2) &#123; return item; &#125; else &#123; count++; throw new MyJobExecutionException("ä»»åŠ¡å¤„ç†å‡ºé”™"); &#125; &#125; &#125;; &#125;åœ¨step()æ–¹æ³•ä¸­ï¼ŒfaultTolerant()è¡¨ç¤ºå¼€å¯å®¹é”™åŠŸèƒ½ï¼Œretry(MyJobExecutionException.class)è¡¨ç¤ºé‡åˆ°MyJobExecutionExceptionå¼‚å¸¸æ—¶è¿›è¡Œé‡è¯•ï¼ŒretryLimit(3)è¡¨ç¤ºå¦‚æžœç¬¬ä¸‰æ¬¡é‡è¯•è¿˜æ˜¯å¤±è´¥çš„è¯ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œç»“æŸä»»åŠ¡ã€‚é€šè¿‡å‰é¢çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“ï¼Œæ­¥éª¤StepåŒ…æ‹¬ItemReaderã€ItemWriterå’ŒItemProcessorï¼Œä¸Šé¢é…ç½®çš„é”™è¯¯å®¹å¿æ˜¯é’ˆå¯¹æ•´ä¸ªStepçš„ï¼Œæ‰€ä»¥å®¹å¿çš„å¼‚å¸¸æ¬¡æ•°åº”è¯¥æ˜¯readerï¼Œprocessorå’Œwriterä¸­çš„æ€»æ•°ï¼Œä¸Šé¢çš„ä¾‹å­ä»…åœ¨processoré‡Œæ¼”ç¤ºå¼‚å¸¸é‡è¯•ã€‚myProcessor()çš„ä»£ç é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨å‰ä¸¤æ¬¡çš„æ—¶å€™æŠ›å‡ºMyJobExecutionException(&quot;ä»»åŠ¡å¤„ç†å‡ºé”™&quot;)å¼‚å¸¸ï¼ˆcount &lt; 2ï¼‰ï¼Œç¬¬ä¸‰æ¬¡çš„æ—¶å€™æ­£å¸¸è¿”å›žitemï¼ˆcount = 2 &gt;= 2ï¼‰ï¼Œæ‰€ä»¥ç†è®ºä¸Šä¸Šé¢çš„ä»»åŠ¡åœ¨é‡è¯•ä¸¤æ¬¡ä¹‹åŽæ­£å¸¸è¿è¡Œã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ‰“å°æ—¥å¿—å¦‚ä¸‹ï¼š123456789101112131415162020-03-12 09:04:53.359 INFO 40522 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=retryExceptionJob]] launched with the following parameters: [&#123;&#125;]2020-03-12 09:04:53.415 INFO 40522 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]å½“å‰å¤„ç†çš„æ•°æ®ï¼š0å½“å‰å¤„ç†çš„æ•°æ®ï¼š0å½“å‰å¤„ç†çš„æ•°æ®ï¼š0å½“å‰å¤„ç†çš„æ•°æ®ï¼š101å½“å‰å¤„ç†çš„æ•°æ®ï¼š2å½“å‰å¤„ç†çš„æ•°æ®ï¼š323å½“å‰å¤„ç†çš„æ•°æ®ï¼š442020-03-12 09:04:53.498 INFO 40522 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 83ms2020-03-12 09:04:53.522 INFO 40522 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=retryExceptionJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 152msç»“æžœç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚å‡å¦‚é€šè¿‡retryLimit(2)å°†é‡è¯•æ¬¡æ•°è®¾ç½®ä¸º2ï¼Œå¹¶ä¿®æ”¹ä»»åŠ¡çš„åç§°ä¸ºretryExceptionJob1ï¼Œå¯åŠ¨é¡¹ç›®çœ‹çœ‹è¿è¡Œç»“æžœå¦‚ä½•ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263v2020-03-12 09:06:48.855 INFO 40610 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=retryExceptionJob1]] launched with the following parameters: [&#123;&#125;]2020-03-12 09:06:48.933 INFO 40610 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]å½“å‰å¤„ç†çš„æ•°æ®ï¼š0å½“å‰å¤„ç†çš„æ•°æ®ï¼š02020-03-12 09:06:48.979 ERROR 40610 --- [ main] o.s.batch.core.step.AbstractStep : Encountered an error executing step step in job retryExceptionJob1org.springframework.retry.RetryException: Non-skippable exception in recoverer while processing; nested exception is cc.mrbird.batch.exception.MyJobExecutionException: ä»»åŠ¡å¤„ç†å‡ºé”™ at org.springframework.batch.core.step.item.FaultTolerantChunkProcessor$2.recover(FaultTolerantChunkProcessor.java:289) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.retry.support.RetryTemplate.handleRetryExhausted(RetryTemplate.java:512) ~[spring-retry-1.2.5.RELEASE.jar:na] at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:351) ~[spring-retry-1.2.5.RELEASE.jar:na] at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:211) ~[spring-retry-1.2.5.RELEASE.jar:na] at org.springframework.batch.core.step.item.BatchRetryTemplate.execute(BatchRetryTemplate.java:217) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.item.FaultTolerantChunkProcessor.transform(FaultTolerantChunkProcessor.java:298) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.item.SimpleChunkProcessor.process(SimpleChunkProcessor.java:210) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.item.ChunkOrientedTasklet.execute(ChunkOrientedTasklet.java:77) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:407) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:331) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140) ~[spring-tx-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.batch.core.step.tasklet.TaskletStep$2.doInChunkContext(TaskletStep.java:273) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.scope.context.StepContextRepeatCallback.doInIteration(StepContextRepeatCallback.java:82) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.repeat.support.RepeatTemplate.getNextResult(RepeatTemplate.java:375) ~[spring-batch-infrastructure-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:215) ~[spring-batch-infrastructure-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:145) ~[spring-batch-infrastructure-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:258) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:148) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:410) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:319) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:147) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50) [spring-core-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_231] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_231] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_231] at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_231] at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) [spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) [spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) [spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:127) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) [spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212) [spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] at com.sun.proxy.$Proxy46.run(Unknown Source) [na:na] at org.springframework.boot.autoconfigure.batch.JobLauncherCommandLineRunner.execute(JobLauncherCommandLineRunner.java:192) [spring-boot-autoconfigure-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.autoconfigure.batch.JobLauncherCommandLineRunner.executeLocalJobs(JobLauncherCommandLineRunner.java:166) [spring-boot-autoconfigure-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.autoconfigure.batch.JobLauncherCommandLineRunner.launchJobFromProperties(JobLauncherCommandLineRunner.java:153) [spring-boot-autoconfigure-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.autoconfigure.batch.JobLauncherCommandLineRunner.run(JobLauncherCommandLineRunner.java:148) [spring-boot-autoconfigure-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:784) [spring-boot-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:768) [spring-boot-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.SpringApplication.run(SpringApplication.java:322) [spring-boot-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226) [spring-boot-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.SpringApplication.run(SpringApplication.java:1215) [spring-boot-2.2.5.RELEASE.jar:2.2.5.RELEASE] at cc.mrbird.batch.SpringBatchExceptionApplication.main(SpringBatchExceptionApplication.java:12) [classes/:na]Caused by: cc.mrbird.batch.exception.MyJobExecutionException: ä»»åŠ¡å¤„ç†å‡ºé”™ at cc.mrbird.batch.job.RetryExceptionJobDemo$1.process(RetryExceptionJobDemo.java:64) ~[classes/:na] at cc.mrbird.batch.job.RetryExceptionJobDemo$1.process(RetryExceptionJobDemo.java:55) ~[classes/:na] at org.springframework.batch.core.step.item.SimpleChunkProcessor.doProcess(SimpleChunkProcessor.java:134) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.item.FaultTolerantChunkProcessor$1.doWithRetry(FaultTolerantChunkProcessor.java:233) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:287) ~[spring-retry-1.2.5.RELEASE.jar:na] ... 43 common frames omitted2020-03-12 09:06:48.989 INFO 40610 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 56ms2020-03-12 09:06:49.019 INFO 40610 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=retryExceptionJob1]] completed with the following parameters: [&#123;&#125;] and the following status: [FAILED] in 152mså¼‚å¸¸æ¬¡æ•°è¶…è¿‡äº†é‡è¯•æ¬¡æ•°ï¼Œæ‰€ä»¥æŠ›å‡ºäº†å¼‚å¸¸ã€‚å¼‚å¸¸è·³è¿‡æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨Stepä¸­é…ç½®å¼‚å¸¸è·³è¿‡ï¼Œå³é‡åˆ°æŒ‡å®šç±»åž‹å¼‚å¸¸æ—¶å¿½ç•¥è·³è¿‡å®ƒï¼Œåœ¨jobåŒ…ä¸‹æ–°å»ºSkipExceptionJobDemoï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445@Componentpublic class SkipExceptionJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job skipExceptionJob() &#123; return jobBuilderFactory.get("skipExceptionJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;String, String&gt;chunk(2) .reader(listItemReader()) .processor(myProcessor()) .writer(list -&gt; list.forEach(System.out::println)) .faultTolerant() // é…ç½®é”™è¯¯å®¹å¿ .skip(MyJobExecutionException.class) // é…ç½®è·³è¿‡çš„å¼‚å¸¸ç±»åž‹ .skipLimit(1) // æœ€å¤šè·³è¿‡1æ¬¡ï¼Œ1æ¬¡è¿‡åŽè¿˜æ˜¯å¼‚å¸¸çš„è¯ï¼Œåˆ™ä»»åŠ¡ä¼šç»“æŸï¼Œ // å¼‚å¸¸çš„æ¬¡æ•°ä¸ºreaderï¼Œprocessorå’Œwriterä¸­çš„æ€»æ•°ï¼Œè¿™é‡Œä»…åœ¨processoré‡Œæ¼”ç¤ºå¼‚å¸¸è·³è¿‡ .build(); &#125; private ListItemReader&lt;String&gt; listItemReader() &#123; ArrayList&lt;String&gt; datas = new ArrayList&lt;&gt;(); IntStream.range(0, 5).forEach(i -&gt; datas.add(String.valueOf(i))); return new ListItemReader&lt;&gt;(datas); &#125; private ItemProcessor&lt;String, String&gt; myProcessor() &#123; return item -&gt; &#123; System.out.println("å½“å‰å¤„ç†çš„æ•°æ®ï¼š" + item); if ("2".equals(item)) &#123; throw new MyJobExecutionException("ä»»åŠ¡å¤„ç†å‡ºé”™"); &#125; else &#123; return item; &#125; &#125;; &#125;&#125;åœ¨step()æ–¹æ³•ä¸­ï¼ŒfaultTolerant()è¡¨ç¤ºå¼€å¯å®¹é”™åŠŸèƒ½ï¼Œskip(MyJobExecutionException.class)è¡¨ç¤ºé‡åˆ°MyJobExecutionExceptionå¼‚å¸¸æ—¶è·³è¿‡ï¼ŒskipLimit(1)è¡¨ç¤ºåªè·³è¿‡ä¸€æ¬¡ã€‚myProcessor()çš„é€»è¾‘æ˜¯ï¼Œå½“å¤„ç†çš„itemå€¼ä¸ºâ€2â€œçš„æ—¶å€™ï¼ŒæŠ›å‡ºMyJobExecutionException(&quot;ä»»åŠ¡å¤„ç†å‡ºé”™&quot;)å¼‚å¸¸ã€‚æ­¤å¤–æˆ‘ä»¬è¿˜å¯ä»¥é…ç½®SkipListenerç±»åž‹ç›‘å¬å™¨ï¼Œåœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºlisteneråŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºMySkipListenerï¼š1234567891011121314151617@Componentpublic class MySkipListener implements SkipListener&lt;String, String&gt; &#123; @Override public void onSkipInRead(Throwable t) &#123; System.out.println("åœ¨è¯»å–æ•°æ®çš„æ—¶å€™é‡åˆ°å¼‚å¸¸å¹¶è·³è¿‡ï¼Œå¼‚å¸¸ï¼š" + t.getMessage()); &#125; @Override public void onSkipInWrite(String item, Throwable t) &#123; System.out.println("åœ¨è¾“å‡ºæ•°æ®çš„æ—¶å€™é‡åˆ°å¼‚å¸¸å¹¶è·³è¿‡ï¼Œå¾…è¾“å‡ºæ•°æ®ï¼š" + item + "ï¼Œå¼‚å¸¸ï¼š" + t.getMessage()); &#125; @Override public void onSkipInProcess(String item, Throwable t) &#123; System.out.println("åœ¨å¤„ç†æ•°æ®çš„æ—¶å€™é‡åˆ°å¼‚å¸¸å¹¶è·³è¿‡ï¼Œå¾…è¾“å‡ºæ•°æ®ï¼š" + item + "ï¼Œå¼‚å¸¸ï¼š" + t.getMessage()); &#125;&#125;ç„¶åŽå°†å®ƒæ³¨å…¥åˆ°SkipExceptionJobDemoï¼Œå¹¶é…ç½®ï¼š12345678910111213141516171819202122232425@Componentpublic class SkipExceptionJobDemo &#123; .... @Autowired private MySkipListener mySkipListener; .... private Step step() &#123; return stepBuilderFactory.get("step") .&lt;String, String&gt;chunk(2) .reader(listItemReader()) .processor(myProcessor()) .writer(list -&gt; list.forEach(System.out::println)) .faultTolerant() // é…ç½®é”™è¯¯å®¹å¿ .skip(MyJobExecutionException.class) // é…ç½®è·³è¿‡çš„å¼‚å¸¸ç±»åž‹ .skipLimit(1) // æœ€å¤šè·³è¿‡1æ¬¡ï¼Œ1æ¬¡è¿‡åŽè¿˜æ˜¯å¼‚å¸¸çš„è¯ï¼Œåˆ™ä»»åŠ¡ä¼šç»“æŸï¼Œ // å¼‚å¸¸çš„æ¬¡æ•°ä¸ºreaderï¼Œprocessorå’Œwriterä¸­çš„æ€»æ•°ï¼Œè¿™é‡Œä»…åœ¨processoré‡Œæ¼”ç¤ºå¼‚å¸¸è·³è¿‡ .listener(mySkipListener) .build(); &#125; ....&#125;å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š12345678910111213142020-03-12 09:23:33.528 INFO 40759 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=skipExceptionJob]] launched with the following parameters: [&#123;&#125;]2020-03-12 09:23:33.664 INFO 40759 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]å½“å‰å¤„ç†çš„æ•°æ®ï¼š0å½“å‰å¤„ç†çš„æ•°æ®ï¼š101å½“å‰å¤„ç†çš„æ•°æ®ï¼š2å½“å‰å¤„ç†çš„æ•°æ®ï¼š33åœ¨å¤„ç†æ•°æ®çš„æ—¶å€™é‡åˆ°å¼‚å¸¸å¹¶è·³è¿‡ï¼Œå¾…è¾“å‡ºæ•°æ®ï¼š2ï¼Œå¼‚å¸¸ï¼šä»»åŠ¡å¤„ç†å‡ºé”™å½“å‰å¤„ç†çš„æ•°æ®ï¼š442020-03-12 09:23:33.854 INFO 40759 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 190ms2020-03-12 09:23:33.885 INFO 40759 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=skipExceptionJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 324msäº‹åŠ¡é—®é¢˜ä¸€æ¬¡Setpåˆ†ä¸ºReaderã€Processorå’ŒWriterä¸‰ä¸ªé˜¶æ®µï¼Œè¿™äº›é˜¶æ®µç»Ÿç§°ä¸ºItemã€‚é»˜è®¤æƒ…å†µä¸‹å¦‚æžœé”™è¯¯ä¸æ˜¯å‘ç”Ÿåœ¨Readeré˜¶æ®µï¼Œé‚£ä¹ˆæ²¡å¿…è¦å†åŽ»é‡æ–°è¯»å–ä¸€æ¬¡æ•°æ®ã€‚ä½†æ˜¯æŸäº›åœºæ™¯ä¸‹éœ€è¦Readeréƒ¨åˆ†ä¹Ÿéœ€è¦é‡æ–°æ‰§è¡Œï¼Œæ¯”å¦‚Readeræ˜¯ä»Žä¸€ä¸ªJMSé˜Ÿåˆ—ä¸­æ¶ˆè´¹æ¶ˆæ¯ï¼Œå½“å‘ç”Ÿå›žæ»šçš„æ—¶å€™æ¶ˆæ¯ä¹Ÿä¼šåœ¨é˜Ÿåˆ—ä¸Šé‡æ”¾ï¼Œå› æ­¤ä¹Ÿè¦å°†Readerçº³å…¥åˆ°å›žæ»šçš„äº‹ç‰©ä¸­ï¼Œæ ¹æ®è¿™ä¸ªåœºæ™¯å¯ä»¥ä½¿ç”¨readerIsTransactionalQueue()æ¥é…ç½®æ•°æ®é‡è¯»ï¼š12345678private Step step() &#123; return stepBuilderFactory.get("step") .&lt;String, String&gt;chunk(2) .reader(listItemReader()) .writer(list -&gt; list.forEach(System.out::println)) .readerIsTransactionalQueue() // æ¶ˆæ¯é˜Ÿåˆ—æ•°æ®é‡è¯» .build();&#125;æˆ‘ä»¬è¿˜å¯ä»¥åœ¨Stepä¸­æ‰‹åŠ¨é…ç½®äº‹åŠ¡å±žæ€§ï¼Œäº‹ç‰©çš„å±žæ€§åŒ…æ‹¬éš”ç¦»ç­‰çº§ï¼ˆisolationï¼‰ã€ä¼ æ’­æ–¹å¼ï¼ˆpropagationï¼‰ä»¥åŠè¿‡æœŸæ—¶é—´ï¼ˆtimeoutï¼‰ç­‰ï¼š12345678910111213private Step step() &#123; DefaultTransactionAttribute attribute = new DefaultTransactionAttribute(); attribute.setPropagationBehavior(Propagation.REQUIRED.value()); attribute.setIsolationLevel(Isolation.DEFAULT.value()); attribute.setTimeout(30); return stepBuilderFactory.get("step") .&lt;String, String&gt;chunk(2) .reader(listItemReader()) .writer(list -&gt; list.forEach(System.out::println)) .transactionAttribute(attribute) .build();&#125;é‡å¯æœºåˆ¶é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»åŠ¡æ‰§è¡Œå®Œæ¯•çš„çŠ¶æ€ä¸ºCOMPLETEDï¼Œå†æ¬¡å¯åŠ¨é¡¹ç›®ï¼Œè¯¥ä»»åŠ¡çš„Stepä¸ä¼šå†æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®allowStartIfComplete(true)æ¥å®žçŽ°æ¯æ¬¡é¡¹ç›®é‡æ–°å¯åŠ¨éƒ½å°†æ‰§è¡Œè¿™ä¸ªStepï¼š12345678private Step step() &#123; return stepBuilderFactory.get("step") .&lt;String, String&gt;chunk(2) .reader(listItemReader()) .writer(list -&gt; list.forEach(System.out::println)) .allowStartIfComplete(true) .build();&#125;æŸäº›Stepå¯èƒ½ç”¨äºŽå¤„ç†ä¸€äº›å…ˆå†³çš„ä»»åŠ¡ï¼Œæ‰€ä»¥å½“Jobå†æ¬¡é‡å¯æ—¶è¿™Stepå°±æ²¡å¿…è¦å†æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡è®¾ç½®startLimit()æ¥é™å®šæŸä¸ªStepé‡å¯çš„æ¬¡æ•°ã€‚å½“è®¾ç½®ä¸º1æ—¶å€™è¡¨ç¤ºä»…ä»…è¿è¡Œä¸€æ¬¡ï¼Œè€Œå‡ºçŽ°é‡å¯æ—¶å°†ä¸å†æ‰§è¡Œï¼š12345678private Step step() &#123; return stepBuilderFactory.get("step") .&lt;String, String&gt;chunk(2) .reader(listItemReader()) .writer(list -&gt; list.forEach(System.out::println)) .startLimit(1) .build();&#125;éƒ¨åˆ†å†…å®¹å‚è€ƒè‡ªï¼šhttps://blog.csdn.net/sswltt/article/details/103817645æœ¬ç« æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/72.spring-batch-exceptionã€‚]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>Spring Batch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Batchä»»åŠ¡è°ƒåº¦]]></title>
    <url>%2FSpring-Batch%E4%BD%9C%E4%B8%9A%E8%B0%83%E5%BA%A6.html</url>
    <content type="text"><![CDATA[åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é…ç½®çš„ä»»åŠ¡éƒ½æ˜¯åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™è‡ªåŠ¨è¿è¡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡JobLauncheræˆ–è€…JobOperatoræ‰‹åŠ¨æŽ§åˆ¶ä»»åŠ¡çš„è¿è¡Œæ—¶æœºï¼Œè¿™èŠ‚è®°å½•ä¸‹å®ƒä»¬çš„ç”¨æ³•ã€‚æ¡†æž¶æ­å»ºæ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.2.4.RELEASEï¼ŒartifactIdä¸ºspring-batch-launcherï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå‰©ä¸‹çš„æ•°æ®åº“å±‚çš„å‡†å¤‡ï¼Œé¡¹ç›®é…ç½®ï¼Œä¾èµ–å¼•å…¥å’ŒSpring Batchå…¥é—¨æ–‡ç« ä¸­çš„æ¡†æž¶æ­å»ºæ­¥éª¤ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚æ­¤å¤–ï¼Œæœ¬èŠ‚æˆ‘ä»¬éœ€è¦æ¼”ç¤ºåœ¨Controlleré‡Œé€šè¿‡JobLauncheræˆ–è€…JobOperatorè°ƒåº¦ä»»åŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€åœ¨pomé‡Œå¼•å…¥webä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽå‡†å¤‡ä¸ªä»»åŠ¡ï¼Œç”¨äºŽåŽç»­æµ‹è¯•ã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºjobåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºMyJobï¼š123456789101112131415161718192021222324252627@Componentpublic class MyJob&#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job job()&#123; return jobBuilderFactory.get("job") .start(step()) .build(); &#125; private Step step()&#123; return stepBuilderFactory.get("step") .tasklet((stepContribution, chunkContext) -&gt; &#123; StepExecution stepExecution = chunkContext.getStepContext().getStepExecution(); Map&lt;String, JobParameter&gt; parameters = stepExecution.getJobParameters().getParameters(); System.out.println(parameters.get("message").getValue()); return RepeatStatus.FINISHED; &#125;) .listener(this) .build(); &#125;&#125;åœ¨step()æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ‰§è¡Œä¸Šä¸‹æ–‡èŽ·å–äº†keyä¸ºmessageçš„å‚æ•°å€¼ã€‚JobLauncheråœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºcontrolleråŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºJobControllerï¼š12345678910111213141516171819@RestController@RequestMapping("job")public class JobController &#123; @Autowired private Job job; @Autowired private JobLauncher jobLauncher; @GetMapping("launcher/&#123;message&#125;") public String launcher(@PathVariable String message) throws Exception &#123; JobParameters parameters = new JobParametersBuilder() .addString("message", message) .toJobParameters(); // å°†å‚æ•°ä¼ é€’ç»™ä»»åŠ¡ jobLauncher.run(job, parameters); return "success"; &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ³¨å…¥äº†JobLauncherå’Œä¸Šé¢é…ç½®çš„Jobï¼Œç„¶åŽé€šè¿‡JobLauncherçš„run(Job job, JobParameters jobParameters)æ–¹æ³•è¿è¡ŒæŒ‡å®šçš„ä»»åŠ¡Jobï¼Œå¹¶ä¸”ä¼ é€’äº†å‚æ•°ã€‚è¦å…³é—­Spring Batchå¯åŠ¨é¡¹ç›®è‡ªåŠ¨è¿è¡Œä»»åŠ¡çš„æœºåˆ¶ï¼Œéœ€è¦åœ¨é¡¹ç›®é…ç½®æ–‡ä»¶application.ymlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š1234spring: batch: job: enabled: falseå¯åŠ¨é¡¹ç›®ï¼Œåœ¨æµè§ˆå™¨åœ°å€æ è®¿é—®ï¼šhttp://localhost:8080/job/launcher/helloï¼šé¡¹ç›®æŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š123452020-03-12 10:24:31.547 INFO 41266 --- [nio-8080-exec-4] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=job]] launched with the following parameters: [&#123;message=hello&#125;]2020-03-12 10:24:31.583 INFO 41266 --- [nio-8080-exec-4] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]hello2020-03-12 10:24:31.610 INFO 41266 --- [nio-8080-exec-4] o.s.batch.core.step.AbstractStep : Step: [step] executed in 27ms2020-03-12 10:24:31.632 INFO 41266 --- [nio-8080-exec-4] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=job]] completed with the following parameters: [&#123;message=hello&#125;] and the following status: [COMPLETED] in 76msæ­¤å¤–ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šåŒæ ·çš„å‚æ•°ï¼ŒåŒæ ·çš„ä»»åŠ¡å†æ¬¡è¿è¡Œçš„æ—¶å€™å°†æŠ›å‡ºJobInstanceAlreadyCompleteExceptionå¼‚å¸¸ï¼Œæ¯”å¦‚åœ¨æµè§ˆå™¨ä¸­å†æ¬¡è®¿é—®http://localhost:8080/job/launcher/helloï¼Œé¡¹ç›®æŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š12345678org.springframework.batch.core.repository.JobInstanceAlreadyCompleteException: A job instance already exists and is complete for parameters=&#123;message=hello&#125;. If you want to run this job again, change the parameters. at org.springframework.batch.core.repository.support.SimpleJobRepository.createJobExecution(SimpleJobRepository.java:131) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_231] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_231] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_231] at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_231] at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) ~[spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] ...æ‰€ä»¥æˆ‘ä»¬åœ¨ä»»åŠ¡è°ƒåº¦çš„æ—¶å€™ï¼Œåº”é¿å…å‚æ•°é‡å¤ã€‚JobOperatoråœ¨JobControlleré‡Œæ·»åŠ ä¸€ä¸ªæ–°çš„ç«¯ç‚¹ï¼š1234567891011121314@RestController@RequestMapping("job")public class JobController &#123; @Autowired private JobOperator jobOperator; @GetMapping("operator/&#123;message&#125;") public String operator(@PathVariable String message) throws Exception &#123; // ä¼ é€’ä»»åŠ¡åç§°ï¼Œå‚æ•°ä½¿ç”¨ kvæ–¹å¼ jobOperator.start("job", "message=" + message); return "success"; &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ³¨å…¥äº†JobOperatorï¼ŒJobOperatorçš„start(String jobName, String parameters)æ–¹æ³•ä¼ å…¥çš„æ˜¯ä»»åŠ¡çš„åç§°ï¼ˆä»»åŠ¡åœ¨Spring IOCå®¹å™¨ä¸­çš„åç§°ï¼‰,å¹¶ä¸”å‚æ•°ä½¿ç”¨key-valueçš„æ–¹å¼ä¼ é€’ã€‚è¦é€šè¿‡ä»»åŠ¡åç§°èŽ·å–åˆ°ç›¸åº”çš„Beanï¼Œè¿˜éœ€è¦æ·»åŠ ä¸€ä¸ªé¢å¤–çš„é…ç½®ã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºconfigureåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºJobConfigureï¼š123456789101112131415@Configurationpublic class JobConfigure &#123; /** * æ³¨å†ŒJobRegistryBeanPostProcessor bean * ç”¨äºŽå°†ä»»åŠ¡åç§°å’Œå®žé™…çš„ä»»åŠ¡å…³è”èµ·æ¥ */ @Bean public JobRegistryBeanPostProcessor processor(JobRegistry jobRegistry, ApplicationContext applicationContext) &#123; JobRegistryBeanPostProcessor postProcessor = new JobRegistryBeanPostProcessor(); postProcessor.setJobRegistry(jobRegistry); postProcessor.setBeanFactory(applicationContext.getAutowireCapableBeanFactory()); return postProcessor; &#125;&#125;å¦‚æžœæ²¡æœ‰è¿™æ®µé…ç½®ï¼Œåœ¨ä»»åŠ¡è°ƒåº¦çš„æ—¶å€™å°†æŠ¥org.springframework.batch.core.launch.NoSuchJobException: No job configuration with the name [job] was registeredã€‚å¯åŠ¨ä»»åŠ¡ï¼Œæµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8080/job/operator/mrbirdï¼šé¡¹ç›®æŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š12345672020-03-12 10:51:20.174 INFO 41405 --- [nio-8080-exec-2] o.s.b.c.l.support.SimpleJobOperator : Checking status of job with name=job2020-03-12 10:51:20.183 INFO 41405 --- [nio-8080-exec-2] o.s.b.c.l.support.SimpleJobOperator : Attempting to launch job with name=job and parameters=message=mrbird2020-03-12 10:51:20.239 INFO 41405 --- [nio-8080-exec-2] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=job]] launched with the following parameters: [&#123;message=mrbird&#125;]2020-03-12 10:51:20.293 INFO 41405 --- [nio-8080-exec-2] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]mrbird2020-03-12 10:51:20.324 INFO 41405 --- [nio-8080-exec-2] o.s.batch.core.step.AbstractStep : Step: [step] executed in 31ms2020-03-12 10:51:20.344 INFO 41405 --- [nio-8080-exec-2] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=job]] completed with the following parameters: [&#123;message=mrbird&#125;] and the following status: [COMPLETED] in 83msJobOperatoråŒ…å«äº†è®¸å¤šå®žç”¨çš„æ–¹æ³•ï¼šå…·ä½“å¯ä»¥è‡ªå·±å°è¯•çŽ©ä¸€çŽ©ã€‚æœ¬èŠ‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/73.spring-batch-launcherã€‚]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>Spring Batch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Batchç›‘å¬å™¨]]></title>
    <url>%2FSpring-Batch%E7%9B%91%E5%90%AC%E5%99%A8.html</url>
    <content type="text"><![CDATA[Spring Batchæä¾›äº†å¤šç§ç›‘å¬å™¨Listenerï¼Œç”¨äºŽåœ¨ä»»åŠ¡å¤„ç†è¿‡ç¨‹ä¸­è§¦å‘æˆ‘ä»¬çš„é€»è¾‘ä»£ç ã€‚å¸¸ç”¨çš„ç›‘å¬å™¨æ ¹æ®ç²’åº¦ä»Žç²—åˆ°ç»†åˆ†åˆ«æœ‰ï¼šJobçº§åˆ«çš„ç›‘å¬å™¨JobExecutionListenerã€Stepçº§åˆ«çš„ç›‘å¬å™¨StepExecutionListenerã€Chunkç›‘å¬å™¨ChunkListenerã€ItemReaderç›‘å¬å™¨ItemReadListenerã€ItemWriterç›‘å¬å™¨ItemWriteListenerå’ŒItemProcessorç›‘å¬å™¨ItemProcessListenerç­‰ã€‚å…·ä½“å¯ä»¥å‚è€ƒä¸‹è¡¨ï¼šç›‘å¬å™¨å…·ä½“è¯´æ˜ŽJobExecutionListeneråœ¨Jobå¼€å§‹ä¹‹å‰(beforeJob)å’Œä¹‹åŽ(aflerJob)è§¦å‘StepExecutionListeneråœ¨Stepå¼€å§‹ä¹‹å‰(beforeStep)å’Œä¹‹åŽ(afterStep)è§¦å‘ChunkListeneråœ¨ Chunk å¼€å§‹ä¹‹å‰(beforeChunk),ä¹‹åŽ(afterChunk)å’Œé”™è¯¯åŽ(afterChunkError)è§¦å‘ItemReadListeneråœ¨ Read å¼€å§‹ä¹‹å‰(beforeRead&gt;,ä¹‹åŽ(afterRead)å’Œé”™è¯¯åŽ(onReadError)è§¦å‘ItemProcessListeneråœ¨ Processor å¼€å§‹ä¹‹å‰(beforeProcess),ä¹‹åŽ(afterProcess)å’Œé”™è¯¯åŽ(onProcessError)è§¦å‘ItemWriterListeneråœ¨ Writer å¼€å§‹ä¹‹å‰(beforeWrite),ä¹‹åŽ(afterWrite)å’Œé”™è¯¯åŽ(onWriteError)è§¦å‘æ¡†æž¶æ­å»ºæ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.2.4.RELEASEï¼ŒartifactIdä¸ºspring-batch-listenerï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå‰©ä¸‹çš„æ•°æ®åº“å±‚çš„å‡†å¤‡ï¼Œé¡¹ç›®é…ç½®ï¼Œä¾èµ–å¼•å…¥å’ŒSpring Batchå…¥é—¨æ–‡ç« ä¸­çš„æ¡†æž¶æ­å»ºæ­¥éª¤ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚ç›‘å¬å™¨æ¼”ç¤ºæ¯ç§ç›‘å¬å™¨éƒ½å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼ä½¿ç”¨ï¼šæŽ¥å£å®žçŽ°ï¼›æ³¨è§£é©±åŠ¨ã€‚å…ˆæ¥çœ‹çœ‹é€šè¿‡å®žçŽ°æŽ¥å£çš„æ–¹å¼ä½¿ç”¨ç›‘å¬å™¨ã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºlisteneråŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºMyJobExecutionListenerï¼Œå®žçŽ°JobExecutionListeneræŽ¥å£ï¼š12345678910111213@Componentpublic class MyJobExecutionListener implements JobExecutionListener &#123; @Override public void beforeJob(JobExecution jobExecution) &#123; System.out.println("before job execute: " + jobExecution.getJobInstance().getJobName()); &#125; @Override public void afterJob(JobExecution jobExecution) &#123; System.out.println("after job execute: " + jobExecution.getJobInstance().getJobName()); &#125;&#125;ä¸Šé¢å®žçŽ°çš„ä¸¤ä¸ªæ–¹æ³•å¾ˆç›´è§‚äº†ï¼Œè§¦å‘æ—¶æœºåˆ†åˆ«ä¸ºä»»åŠ¡æ‰§è¡Œå‰å’Œä»»åŠ¡æ‰§è¡ŒåŽã€‚æŽ¥ç€çœ‹çœ‹å¦‚ä½•ä½¿ç”¨æ³¨è§£é©±åŠ¨ä½¿ç”¨ç›‘å¬å™¨ã€‚åœ¨listeneråŒ…ä¸‹æ–°å»ºMyStepExecutionListenerï¼š12345678910111213@Componentpublic class MyStepExecutionListener &#123; @BeforeStep public void breforeStep(StepExecution stepExecution) &#123; System.out.println("before step execute: " + stepExecution.getStepName()); &#125; @AfterStep public void afterStep(StepExecution stepExecution) &#123; System.out.println("after step execute: " + stepExecution.getStepName()); &#125;&#125;é€šè¿‡æ³¨è§£çš„æ–¹å¼ä¸éœ€è¦å®žçŽ°æŽ¥å£ï¼Œè€Œæ˜¯åœ¨å¯¹åº”çš„æ–¹æ³•ä¸Šé€šè¿‡è¯¸å¦‚@BeforeStepã€@AfterStepç­‰æ³¨è§£æ ‡æ³¨å³å¯ï¼Œä¸è¿‡æ–¹æ³•çš„ç­¾åå¿…é¡»ç¬¦åˆæ³¨è§£çš„è¦æ±‚ï¼Œå¦åˆ™ä¼šåå°„å¤±è´¥ã€‚æ¯”å¦‚ï¼ŒæŸ¥çœ‹@BeforeStepçš„æºç ï¼šç›‘å¬å™¨çš„åˆ›å»ºå¤§è‡´å°±è¿™ä¸¤ç§å§¿åŠ¿äº†ï¼Œä¸‹é¢çš„ä¾‹å­ä¸åœ¨è¯¦ç»†è¯´æ˜Žï¼Œç›´æŽ¥è´´ä»£ç ã€‚åœ¨listeneråŒ…ä¸‹ç»§ç»­åˆ›å»ºMyChunkListenerã€MyItemReaderListenerã€MyItemProcessListenerå’ŒMyItemWriterListenerã€‚MyChunkListenerï¼š1234567891011121314151617@Componentpublic class MyChunkListener implements ChunkListener &#123; @Override public void beforeChunk(ChunkContext context) &#123; System.out.println("before chunk: " + context.getStepContext().getStepName()); &#125; @Override public void afterChunk(ChunkContext context) &#123; System.out.println("after chunk: " + context.getStepContext().getStepName()); &#125; @Override public void afterChunkError(ChunkContext context) &#123; System.out.println("before chunk error: " + context.getStepContext().getStepName()); &#125;&#125;MyItemReaderListenerï¼š1234567891011121314151617@Componentpublic class MyItemReaderListener implements ItemReadListener&lt;String&gt; &#123; @Override public void beforeRead() &#123; System.out.println("before read"); &#125; @Override public void afterRead(String item) &#123; System.out.println("after read: " + item); &#125; @Override public void onReadError(Exception ex) &#123; System.out.println("on read error: " + ex.getMessage()); &#125;&#125;MyItemProcessListenerï¼š1234567891011121314151617@Componentpublic class MyItemProcessListener implements ItemProcessListener&lt;String, String&gt; &#123; @Override public void beforeProcess(String item) &#123; System.out.println("before process: " + item); &#125; @Override public void afterProcess(String item, String result) &#123; System.out.println("after process: " + item + " result: " + result); &#125; @Override public void onProcessError(String item, Exception e) &#123; System.out.println("on process error: " + item + " , error message: " + e.getMessage()); &#125;&#125;MyItemWriterListenerï¼š123456789101112131415161718@Componentpublic class MyItemWriterListener implements ItemWriteListener&lt;String&gt; &#123; @Override public void beforeWrite(List&lt;? extends String&gt; items) &#123; System.out.println("before write: " + items); &#125; @Override public void afterWrite(List&lt;? extends String&gt; items) &#123; System.out.println("after write: " + items); &#125; @Override public void onWriteError(Exception exception, List&lt;? extends String&gt; items) &#123; System.out.println("on write error: " + items + " , error message: " + exception.getMessage()); &#125;&#125;å‡†å¤‡å¥½è¿™äº›ç›‘å¬å™¨åŽï¼Œæˆ‘ä»¬åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºjobåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºListenerTestJobDemoï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465@Componentpublic class ListenerTestJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private MyJobExecutionListener myJobExecutionListener; @Autowired private MyStepExecutionListener myStepExecutionListener; @Autowired private MyChunkListener myChunkListener; @Autowired private MyItemReaderListener myItemReaderListener; @Autowired private MyItemProcessListener myItemProcessListener; @Autowired private MyItemWriterListener myItemWriterListener; @Bean public Job listenerTestJob() &#123; return jobBuilderFactory.get("listenerTestJob") .start(step()) .listener(myJobExecutionListener) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .listener(myStepExecutionListener) .&lt;String, String&gt;chunk(2) .faultTolerant() .listener(myChunkListener) .reader(reader()) .listener(myItemReaderListener) .processor(processor()) .listener(myItemProcessListener) .writer(list -&gt; list.forEach(System.out::println)) .listener(myItemWriterListener) .build(); &#125; private ItemReader&lt;String&gt; reader() &#123; List&lt;String&gt; data = Arrays.asList("java", "c++", "javascript", "python"); return new simpleReader(data); &#125; private ItemProcessor&lt;String, String&gt; processor() &#123; return item -&gt; item + " language"; &#125;&#125;class simpleReader implements ItemReader&lt;String&gt; &#123; private Iterator&lt;String&gt; iterator; public simpleReader(List&lt;String&gt; data) &#123; this.iterator = data.iterator(); &#125; @Override public String read() &#123; return iterator.hasNext() ? iterator.next() : null; &#125;&#125;ä¸Šé¢ä»£ç æˆ‘ä»¬åœ¨ç›¸åº”çš„ä½ç½®é…ç½®äº†ç›‘å¬å™¨ï¼ˆé…ç½®chunkç›‘å¬å™¨çš„æ—¶å€™ï¼Œå¿…é¡»é…ç½®faultTolerant()ï¼‰ã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738392020-03-09 17:08:34.439 INFO 20165 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=listenerTestJob]] launched with the following parameters: [&#123;&#125;]before job execute: listenerTestJob32020-03-09 17:08:34.495 INFO 20165 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]before step execute: stepbefore chunk: stepbefore readafter read: javabefore readafter read: c++before process: javaafter process: java result: java languagebefore process: c++after process: c++ result: c++ languagebefore write: [java language, c++ language]java languagec++ languageafter write: [java language, c++ language]after chunk: stepbefore chunk: stepbefore readafter read: javascriptbefore readafter read: pythonbefore process: javascriptafter process: javascript result: javascript languagebefore process: pythonafter process: python result: python languagebefore write: [javascript language, python language]javascript languagepython languageafter write: [javascript language, python language]after chunk: stepbefore chunk: stepbefore readafter chunk: stepafter step execute: step2020-03-09 17:08:34.546 INFO 20165 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 51msafter job execute: listenerTestJob32020-03-09 17:08:34.566 INFO 20165 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=listenerTestJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 105msä»Žä¸Šé¢çš„è¿è¡Œç»“æžœæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼šè¯å®žäº†chunk(2)è¡¨ç¤ºæ¯ä¸€æ‰¹å¤„ç†2ä¸ªæ•°æ®å—ï¼›Stepé‡Œçš„æ‰§è¡Œé¡ºåºæ˜¯read -&gt; process -&gt; writerã€‚èšåˆç›‘å¬å™¨æ¯ç§ç›‘å¬å™¨å¯ä»¥é€šè¿‡å¯¹åº”çš„èšåˆç±»ç»„åˆåœ¨ä¸€èµ·ï¼Œæ¯”å¦‚æœ‰å¤šä¸ªJobExecutionListenerï¼Œåˆ™å¯ä»¥ä½¿ç”¨CompositeJobExecutionListenerèšåˆå®ƒä»¬ã€‚ä¸Šé¢ä»‹ç»çš„è¿™å‡ ç§ç›‘å¬å™¨éƒ½æœ‰ä¸Žä¹‹å¯¹åº”çš„CompositeXXXListenerèšåˆç±»ï¼Œè¿™é‡Œåªæ¼”ç¤ºCompositeJobExecutionListenerï¼Œå‰©ä¸‹çš„ä»¥æ­¤ç±»æŽ¨ã€‚åœ¨jobåŒ…ä¸‹æ–°å»ºCompositeJobExecutionListenerJobDemoï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556@Componentpublic class CompositeJobExecutionListenerJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job compositeJobExecutionListenerJob() &#123; return jobBuilderFactory.get("compositeJobExecutionListenerJob") .start(step()) .listener(compositeJobExecutionListener()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .tasklet((contribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤...."); return RepeatStatus.FINISHED; &#125;).build(); &#125; private CompositeJobExecutionListener compositeJobExecutionListener() &#123; CompositeJobExecutionListener listener = new CompositeJobExecutionListener(); // ä»»åŠ¡ç›‘å¬å™¨1 JobExecutionListener jobExecutionListenerOne = new JobExecutionListener() &#123; @Override public void beforeJob(JobExecution jobExecution) &#123; System.out.println("ä»»åŠ¡ç›‘å¬å™¨Oneï¼Œbefore job execute: " + jobExecution.getJobInstance().getJobName()); &#125; @Override public void afterJob(JobExecution jobExecution) &#123; System.out.println("ä»»åŠ¡ç›‘å¬å™¨Oneï¼Œafter job execute: " + jobExecution.getJobInstance().getJobName()); &#125; &#125;; // ä»»åŠ¡ç›‘å¬å™¨2 JobExecutionListener jobExecutionListenerTwo = new JobExecutionListener() &#123; @Override public void beforeJob(JobExecution jobExecution) &#123; System.out.println("ä»»åŠ¡ç›‘å¬å™¨Twoï¼Œbefore job execute: " + jobExecution.getJobInstance().getJobName()); &#125; @Override public void afterJob(JobExecution jobExecution) &#123; System.out.println("ä»»åŠ¡ç›‘å¬å™¨Twoï¼Œafter job execute: " + jobExecution.getJobInstance().getJobName()); &#125; &#125;; // èšåˆ listener.setListeners(Arrays.asList(jobExecutionListenerOne, jobExecutionListenerTwo)); return listener; &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š1234567892020-03-09 17:26:47.533 INFO 20310 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=compositeJobExecutionListenerJob]] launched with the following parameters: [&#123;&#125;]ä»»åŠ¡ç›‘å¬å™¨Oneï¼Œbefore job execute: compositeJobExecutionListenerJobä»»åŠ¡ç›‘å¬å™¨Twoï¼Œbefore job execute: compositeJobExecutionListenerJob2020-03-09 17:26:47.603 INFO 20310 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]æ‰§è¡Œæ­¥éª¤....2020-03-09 17:26:47.660 INFO 20310 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 57msä»»åŠ¡ç›‘å¬å™¨Twoï¼Œafter job execute: compositeJobExecutionListenerJobä»»åŠ¡ç›‘å¬å™¨Oneï¼Œafter job execute: compositeJobExecutionListenerJob2020-03-09 17:26:47.693 INFO 20310 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=compositeJobExecutionListenerJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 129msé™¤äº†æœ¬æ–‡ä»‹ç»çš„è¿™å‡ ä¸ªç›‘å¬å™¨å¤–ï¼Œè¿˜æœ‰ä¸€äº›å’Œå¼‚å¸¸å¤„ç†ç›¸å…³çš„ç›‘å¬å™¨ï¼Œä¼šåœ¨åŽç»­çš„æ–‡ç« ä¸­æåˆ°ã€‚æœ¬æ–‡æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/71.spring-batch-listenerã€‚]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>Spring Batch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Batchå¤„ç†æ•°æ®]]></title>
    <url>%2FSpring-Batch%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE.html</url>
    <content type="text"><![CDATA[åœ¨Spring Batchä¸­ï¼ŒItemReaderæŽ¥å£ç”¨äºŽè¯»å–æ•°æ®ï¼ŒItemWriteræŽ¥å£ç”¨äºŽè¾“å‡ºæ•°æ®ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ItemProcessoræŽ¥å£å®žçŽ°æ•°æ®çš„å¤„ç†ï¼ŒåŒ…æ‹¬ï¼šæ•°æ®æ ¡éªŒï¼Œæ•°æ®è¿‡æ»¤å’Œæ•°æ®è½¬æ¢ç­‰ã€‚æ•°æ®å¤„ç†çš„æ—¶æœºå‘ç”ŸäºŽItemReaderè¯»å–æ•°æ®ä¹‹åŽï¼ŒItemWriterè¾“å‡ºæ•°æ®ä¹‹å‰ã€‚æœ¬èŠ‚è®°å½•ä¸‹Spring Batchä¸­ItemProcessorçš„ä½¿ç”¨ã€‚æ¡†æž¶æ­å»ºæ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.2.4.RELEASEï¼ŒartifactIdä¸ºspring-batch-itemprocessorï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå‰©ä¸‹çš„æ•°æ®åº“å±‚çš„å‡†å¤‡ï¼Œé¡¹ç›®é…ç½®ï¼Œä¾èµ–å¼•å…¥å’ŒSpring Batchå…¥é—¨æ–‡ç« ä¸­çš„æ¡†æž¶æ­å»ºæ­¥éª¤ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚åœ¨ä»‹ç»Spring Batch ItemProcessorä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå‡†å¤‡ä¸ªç®€å•çš„æ•°æ®è¯»å–æºã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºentityåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºTestDataå®žä½“ç±»ï¼š12345678public class TestData &#123; private int id; private String field1; private String field2; private String field3; // get,set,toStringç•¥&#125;æŽ¥ç€åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºreaderåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹åˆ›å»ºItemReaderConfigureï¼š12345678910111213141516171819202122232425262728@Configurationpublic class ItemReaderConfigure &#123; @Bean public ListItemReader&lt;TestData&gt; simpleReader() &#123; List&lt;TestData&gt; data = new ArrayList&lt;&gt;(); TestData testData1 = new TestData(); testData1.setId(1); testData1.setField1("11"); testData1.setField2("12"); testData1.setField3("13"); data.add(testData1); TestData testData2 = new TestData(); testData2.setId(2); testData2.setField1("21"); testData2.setField2("22"); testData2.setField3("23"); data.add(testData2); TestData testData3 = new TestData(); testData3.setId(3); testData3.setField1("31"); testData3.setField2("32"); // è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œç”¨äºŽåŽé¢æ ¼å¼æ ¡éªŒæ¼”ç¤º testData3.setField3(""); data.add(testData3); return new ListItemReader&lt;&gt;(data); &#125;&#125;ä¸Šé¢æ³¨å†Œäº†ä¸€ä¸ªItemReaderç±»åž‹çš„Beanï¼ŒåŽç»­éƒ½ç”¨å®ƒä½œä¸ºè¯»å–æ•°æ®çš„æ¥æºã€‚æ ¼å¼æ ¡éªŒItemProcessorçš„å®žçŽ°ç±»ValidatingItemProcessorå¯ä»¥ç”¨äºŽæ•°æ®æ ¼å¼æ ¡éªŒã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºjobåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºValidatingItemProcessorDemoï¼š1234567891011121314151617181920212223242526272829303132333435363738@Componentpublic class ValidatingItemProcessorDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Bean public Job validatingItemProcessorJob() &#123; return jobBuilderFactory.get("validatingItemProcessorJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .processor(validatingItemProcessor()) .writer(list -&gt; list.forEach(System.out::println)) .build(); &#125; private ValidatingItemProcessor&lt;TestData&gt; validatingItemProcessor() &#123; ValidatingItemProcessor&lt;TestData&gt; processor = new ValidatingItemProcessor&lt;&gt;(); processor.setValidator(value -&gt; &#123; // å¯¹æ¯ä¸€æ¡æ•°æ®è¿›è¡Œæ ¡éªŒ if ("".equals(value.getField3())) &#123; // å¦‚æžœfield3çš„å€¼ä¸ºç©ºä¸²ï¼Œåˆ™æŠ›å¼‚å¸¸ throw new ValidationException("field3çš„å€¼ä¸åˆæ³•"); &#125; &#125;); return processor; &#125;&#125;é€šè¿‡ValidatingItemProcessoræˆ‘ä»¬å¯¹ItemReaderè¯»å–çš„æ¯ä¸€æ¡æ•°æ®è¿›è¡Œæ ¡éªŒï¼Œå¦‚æžœfield3çš„å€¼ä¸ºç©ºä¸²çš„è¯ï¼Œåˆ™æŠ›å‡ºValidationException(&quot;field3çš„å€¼ä¸åˆæ³•&quot;)å¼‚å¸¸ã€‚ItemProcessoré€šè¿‡æ­¥éª¤åˆ›å»ºå·¥åŽ‚çš„processor()è®¾ç½®ã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—çš„æ‰“å°å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253542020-03-09 14:18:47.186 INFO 17967 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=validatingItemProcessorJob]] launched with the following parameters: [&#123;&#125;]2020-03-09 14:18:47.252 INFO 17967 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]TestData&#123;id=1, field1=&apos;11&apos;, field2=&apos;12&apos;, field3=&apos;13&apos;&#125;TestData&#123;id=2, field1=&apos;21&apos;, field2=&apos;22&apos;, field3=&apos;23&apos;&#125;2020-03-09 14:18:47.300 ERROR 17967 --- [ main] o.s.batch.core.step.AbstractStep : Encountered an error executing step step in job validatingItemProcessorJoborg.springframework.batch.item.validator.ValidationException: field3çš„å€¼ä¸åˆæ³• at cc.mrbird.batch.entity.job.ValidatingItemProcessorDemo.lambda$validatingItemProcessor$1(ValidatingItemProcessorDemo.java:50) ~[classes/:na] at org.springframework.batch.item.validator.ValidatingItemProcessor.process(ValidatingItemProcessor.java:84) ~[spring-batch-infrastructure-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.item.SimpleChunkProcessor.doProcess(SimpleChunkProcessor.java:134) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.item.SimpleChunkProcessor.transform(SimpleChunkProcessor.java:319) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.item.SimpleChunkProcessor.process(SimpleChunkProcessor.java:210) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.item.ChunkOrientedTasklet.execute(ChunkOrientedTasklet.java:77) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:407) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:331) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140) ~[spring-tx-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.batch.core.step.tasklet.TaskletStep$2.doInChunkContext(TaskletStep.java:273) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.scope.context.StepContextRepeatCallback.doInIteration(StepContextRepeatCallback.java:82) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.repeat.support.RepeatTemplate.getNextResult(RepeatTemplate.java:375) ~[spring-batch-infrastructure-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:215) ~[spring-batch-infrastructure-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:145) ~[spring-batch-infrastructure-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:258) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:208) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:148) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:410) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:136) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:319) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:147) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50) [spring-core-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:140) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_231] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_231] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_231] at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_231] at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:344) [spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198) [spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) [spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.batch.core.configuration.annotation.SimpleBatchConfiguration$PassthruAdvice.invoke(SimpleBatchConfiguration.java:127) [spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) [spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212) [spring-aop-5.2.4.RELEASE.jar:5.2.4.RELEASE] at com.sun.proxy.$Proxy46.run(Unknown Source) [na:na] at org.springframework.boot.autoconfigure.batch.JobLauncherCommandLineRunner.execute(JobLauncherCommandLineRunner.java:192) [spring-boot-autoconfigure-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.autoconfigure.batch.JobLauncherCommandLineRunner.executeLocalJobs(JobLauncherCommandLineRunner.java:166) [spring-boot-autoconfigure-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.autoconfigure.batch.JobLauncherCommandLineRunner.launchJobFromProperties(JobLauncherCommandLineRunner.java:153) [spring-boot-autoconfigure-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.autoconfigure.batch.JobLauncherCommandLineRunner.run(JobLauncherCommandLineRunner.java:148) [spring-boot-autoconfigure-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:784) [spring-boot-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:768) [spring-boot-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.SpringApplication.run(SpringApplication.java:322) [spring-boot-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226) [spring-boot-2.2.5.RELEASE.jar:2.2.5.RELEASE] at org.springframework.boot.SpringApplication.run(SpringApplication.java:1215) [spring-boot-2.2.5.RELEASE.jar:2.2.5.RELEASE] at cc.mrbird.batch.SpringBatchItemprocessorApplication.main(SpringBatchItemprocessorApplication.java:12) [classes/:na]2020-03-09 14:18:47.307 INFO 17967 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 55ms2020-03-09 14:18:47.335 INFO 17967 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=validatingItemProcessorJob]] completed with the following parameters: [&#123;&#125;] and the following status: [FAILED] in 127mså¯ä»¥çœ‹åˆ°ä»»åŠ¡å¤„ç†è¿‡ç¨‹ä¸­æŠ›å‡ºäº†é¢„æœŸå¼‚å¸¸ï¼Œå…³äºŽä»»åŠ¡å¤„ç†ä¸­å¦‚ä½•å¤„ç†å¼‚å¸¸ï¼Œå¯ä»¥å‚è€ƒåŽç»­çš„æ–‡ç« ã€‚é™¤äº†ä½¿ç”¨è¿™ç§æ–¹å¼å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨BeanValidatingItemProcessoræ ¡éªŒä½¿ç”¨JSR-303æ³¨è§£æ ‡æ³¨çš„å®žä½“ç±»ã€‚æ¯”å¦‚ï¼Œåœ¨TestDataç±»çš„field3å±žæ€§ä¸Šæ·»åŠ @NotBlankæ³¨è§£ï¼š123456789public class TestData &#123; private int id; private String field1; private String field2; @NotBlank private String field3; // get,set,toStringç•¥&#125;ä½¿ç”¨è¯¥æ³¨è§£éœ€è¦åœ¨pomä¸­æ·»åŠ spring-boot-starter-validationä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåœ¨jobåŒ…ä¸‹æ–°å»ºBeanValidatingItemProcessorDemoï¼š12345678910111213141516171819202122232425262728293031323334@Componentpublic class BeanValidatingItemProcessorDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Bean public Job beanValidatingItemProcessorJob() throws Exception &#123; return jobBuilderFactory.get("beanValidatingItemProcessorJob") .start(step()) .build(); &#125; private Step step() throws Exception &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .processor(beanValidatingItemProcessor()) .writer(list -&gt; list.forEach(System.out::println)) .build(); &#125; private BeanValidatingItemProcessor&lt;TestData&gt; beanValidatingItemProcessor() throws Exception &#123; BeanValidatingItemProcessor&lt;TestData&gt; beanValidatingItemProcessor = new BeanValidatingItemProcessor&lt;&gt;(); // å¼€å¯è¿‡æ»¤ï¼Œä¸ç¬¦åˆè§„åˆ™çš„æ•°æ®è¢«è¿‡æ»¤æŽ‰ï¼› beanValidatingItemProcessor.setFilter(true); beanValidatingItemProcessor.afterPropertiesSet(); return beanValidatingItemProcessor; &#125;&#125;å¯åŠ¨é¡¹ç›®åŽï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š12345672020-03-09 14:31:14.813 INFO 18100 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=beanValidatingItemProcessorJob]] launched with the following parameters: [&#123;&#125;]2020-03-09 14:31:14.873 INFO 18100 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]TestData&#123;id=1, field1=&apos;11&apos;, field2=&apos;12&apos;, field3=&apos;13&apos;&#125;TestData&#123;id=2, field1=&apos;21&apos;, field2=&apos;22&apos;, field3=&apos;23&apos;&#125;2020-03-09 14:31:14.959 INFO 18100 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 85ms2020-03-09 14:31:14.980 INFO 18100 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=beanValidatingItemProcessorJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 145ms2020-03-09 14:31:15.069 INFO 18100 --- [ main]å¯ä»¥çœ‹åˆ°ï¼Œä¸ç¬¦åˆè§„åˆ™çš„æ•°æ®å·²ç»è¢«æŽ’é™¤äº†ã€‚å¦‚æžœä¸å¼€å¯è¿‡æ»¤beanValidatingItemProcessor.setFilter(false)ï¼Œé‚£ä¹ˆåœ¨é‡åˆ°ä¸ç¬¦åˆæ³¨è§£æ ¡éªŒè§„åˆ™çš„æ•°æ®ï¼Œå°†æŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸ï¼š1234567org.springframework.batch.item.validator.ValidationException: Validation failed for TestData&#123;id=3, field1=&apos;31&apos;, field2=&apos;32&apos;, field3=&apos;&apos;&#125;: Field error in object &apos;item&apos; on field &apos;field3&apos;: rejected value []; codes [NotBlank.item.field3,NotBlank.field3,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [item.field3,field3]; arguments []; default message [field3]]; default message [ä¸èƒ½ä¸ºç©º] at org.springframework.batch.item.validator.SpringValidator.validate(SpringValidator.java:54) ~[spring-batch-infrastructure-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.item.validator.ValidatingItemProcessor.process(ValidatingItemProcessor.java:84) ~[spring-batch-infrastructure-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.item.SimpleChunkProcessor.doProcess(SimpleChunkProcessor.java:134) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] at org.springframework.batch.core.step.item.SimpleChunkProcessor.transform(SimpleChunkProcessor.java:319) ~[spring-batch-core-4.2.1.RELEASE.jar:4.2.1.RELEASE] ...æ•°æ®è¿‡æ»¤é€šè¿‡è‡ªå®šä¹‰ItemProcessorçš„å®žçŽ°ç±»ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç®€å•åœ°å®žçŽ°æ•°æ®è¿‡æ»¤ã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºprocessoråŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºTestDataFilterItemProcessorï¼š12345678@Componentpublic class TestDataFilterItemProcessor implements ItemProcessor&lt;TestData, TestData&gt; &#123; @Override public TestData process(TestData item) &#123; // è¿”å›žnullï¼Œä¼šè¿‡æ»¤æŽ‰è¿™æ¡æ•°æ® return "".equals(item.getField3()) ? null : item; &#125;&#125;TestDataFilterItemProcessorå®žçŽ°äº†ItemProcessorçš„process()æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•å†…ç¼–å†™å…·ä½“çš„æ ¡éªŒé€»è¾‘ï¼Œä¸Šé¢ä»£ç åˆ¤æ–­TestDataçš„field3æ˜¯å¦ä¸ºç©ºä¸²ï¼Œæ˜¯çš„è¯è¿”å›žnullï¼ˆè¿”å›žnullä¼šè¿‡æ»¤æŽ‰è¿™æ¡æ•°æ®ï¼‰ã€‚æŽ¥ç€åœ¨jobåŒ…ä¸‹æ–°å»ºTestDataFilterItemProcessorDemoï¼š12345678910111213141516171819202122232425262728@Componentpublic class TestDataFilterItemProcessorDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Autowired private TestDataFilterItemProcessor testDataFilterItemProcessor; @Bean public Job testDataFilterItemProcessorJob() &#123; return jobBuilderFactory.get("testDataFilterItemProcessorJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .processor(testDataFilterItemProcessor) .writer(list -&gt; list.forEach(System.out::println)) .build(); &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š1234562020-03-09 15:03:30.932 INFO 18690 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=testDataFilterItemProcessorJob]] launched with the following parameters: [&#123;&#125;]2020-03-09 15:03:30.973 INFO 18690 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]TestData&#123;id=1, field1=&apos;11&apos;, field2=&apos;12&apos;, field3=&apos;13&apos;&#125;TestData&#123;id=2, field1=&apos;21&apos;, field2=&apos;22&apos;, field3=&apos;23&apos;&#125;2020-03-09 15:03:31.012 INFO 18690 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 39ms2020-03-09 15:03:31.037 INFO 18690 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=testDataFilterItemProcessorJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 95msæ•°æ®è½¬æ¢åœ¨processoråŒ…ä¸‹æ–°å»ºä¸€ä¸ªItemProcessorå®žçŽ°ç±»TestDataTransformItemPorcessorï¼š123456789@Componentpublic class TestDataTransformItemPorcessor implements ItemProcessor&lt;TestData, TestData&gt; &#123; @Override public TestData process(TestData item) &#123; // field1å€¼æ‹¼æŽ¥ hello item.setField1(item.getField1() + " hello"); return item; &#125;&#125;åœ¨jobåŒ…ä¸‹æ–°å»ºTestDataTransformItemPorcessorDemoï¼š12345678910111213141516171819202122232425262728@Componentpublic class TestDataTransformItemPorcessorDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Autowired private TestDataTransformItemPorcessor testDataTransformItemPorcessor; @Bean public Job testDataTransformItemPorcessorJob() &#123; return jobBuilderFactory.get("testDataTransformItemPorcessorJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .processor(testDataTransformItemPorcessor) .writer(list -&gt; list.forEach(System.out::println)) .build(); &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š12345672020-03-09 15:08:55.628 INFO 18775 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=testDataTransformItemPorcessorJob]] launched with the following parameters: [&#123;&#125;]2020-03-09 15:08:55.694 INFO 18775 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]TestData&#123;id=1, field1=&apos;11 hello&apos;, field2=&apos;12&apos;, field3=&apos;13&apos;&#125;TestData&#123;id=2, field1=&apos;21 hello&apos;, field2=&apos;22&apos;, field3=&apos;23&apos;&#125;TestData&#123;id=3, field1=&apos;31 hello&apos;, field2=&apos;32&apos;, field3=&apos;&apos;&#125;2020-03-09 15:08:55.757 INFO 18775 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 63ms2020-03-09 15:08:55.781 INFO 18775 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=testDataTransformItemPorcessorJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 144msèšåˆå¤„ç†åœ¨åˆ›å»ºStepçš„æ—¶å€™ï¼Œé™¤äº†åˆ¶å®šä¸€ä¸ªItemProcesså¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡CompositeItemProcessorèšåˆå¤šä¸ªprocessorå¤„ç†è¿‡ç¨‹ã€‚åœ¨jobåŒ…ä¸‹æ–°å»ºCompositeItemProcessorDemoï¼š123456789101112131415161718192021222324252627282930313233343536373839@Componentpublic class CompositeItemProcessorDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Autowired private TestDataFilterItemProcessor testDataFilterItemProcessor; @Autowired private TestDataTransformItemPorcessor testDataTransformItemPorcessor; @Bean public Job compositeItemProcessorJob() &#123; return jobBuilderFactory.get("compositeItemProcessorJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .processor(compositeItemProcessor()) .writer(list -&gt; list.forEach(System.out::println)) .build(); &#125; // CompositeItemProcessorç»„åˆå¤šç§ä¸­é—´å¤„ç†å™¨ private CompositeItemProcessor&lt;TestData, TestData&gt; compositeItemProcessor() &#123; CompositeItemProcessor&lt;TestData, TestData&gt; processor = new CompositeItemProcessor&lt;&gt;(); List&lt;ItemProcessor&lt;TestData, TestData&gt;&gt; processors = Arrays.asList(testDataFilterItemProcessor, testDataTransformItemPorcessor); // ä»£ç†ä¸¤ä¸ªprocessor processor.setDelegates(processors); return processor; &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡CompositeItemProcessorèšåˆäº†å‰é¢å®šä¹‰çš„è¿žä¸ªprocessorï¼šTestDataFilterItemProcessorå’ŒTestDataTransformItemPorcessorã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š1234562020-03-09 15:21:24.960 INFO 18882 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=compositeItemProcessorJob]] launched with the following parameters: [&#123;&#125;]2020-03-09 15:21:25.005 INFO 18882 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]TestData&#123;id=1, field1=&apos;11 hello&apos;, field2=&apos;12&apos;, field3=&apos;13&apos;&#125;TestData&#123;id=2, field1=&apos;21 hello&apos;, field2=&apos;22&apos;, field3=&apos;23&apos;&#125;2020-03-09 15:21:25.065 INFO 18882 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 60ms2020-03-09 15:21:25.104 INFO 18882 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=compositeItemProcessorJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 128msä»Žç»“æžœå¯ä»¥çœ‹åˆ°ï¼Œæ•°æ®ä¸ä½†è¿›è¡Œäº†è¿‡æ»¤ï¼Œè¿˜è¿›è¡Œäº†è½¬æ¢ï¼ˆæ‹¼æŽ¥helloï¼‰ã€‚æœ¬èŠ‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/70.spring-batch-itemprocessorã€‚]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>Spring Batch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Batchè¾“å‡ºæ•°æ®]]></title>
    <url>%2FSpring-Batch%E8%BE%93%E5%87%BA%E6%95%B0%E6%8D%AE.html</url>
    <content type="text"><![CDATA[Spring Batchè¾“å‡ºæ•°æ®é€šè¿‡ItemWriteræŽ¥å£çš„å®žçŽ°ç±»æ¥å®Œæˆï¼ŒåŒ…æ‹¬FlatFileItemWriteræ–‡æœ¬æ•°æ®è¾“å‡ºã€StaxEventItemWriter XMLæ–‡ä»¶æ•°æ®è¾“å‡ºã€JsonItemWriter JSONæ–‡ä»¶æ•°æ®è¾“å‡ºã€JdbcBatchItemWriteræ•°æ®åº“æ•°æ®æ’å…¥ç­‰å®žçŽ°ï¼Œæ›´å¤šå¯ç”¨çš„å®žçŽ°å¯ä»¥å‚è€ƒï¼šhttps://docs.spring.io/spring-batch/docs/4.2.x/reference/html/appendix.html#itemWritersAppendixï¼Œæœ¬æ–‡åªä»‹ç»è¿™å››ç§æ¯”è¾ƒå¸¸ç”¨çš„è¾“å‡ºæ•°æ®æ–¹å¼ã€‚æ¡†æž¶æ­å»ºæ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.2.4.RELEASEï¼ŒartifactIdä¸ºspring-batch-itemwriterï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå‰©ä¸‹çš„æ•°æ®åº“å±‚çš„å‡†å¤‡ï¼Œé¡¹ç›®é…ç½®ï¼Œä¾èµ–å¼•å…¥å’ŒSpring Batchå…¥é—¨æ–‡ç« ä¸­çš„æ¡†æž¶æ­å»ºæ­¥éª¤ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚åœ¨ä»‹ç»Spring Batchæ•°æ®è¾“å‡ºä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå‡†å¤‡ä¸ªç®€å•çš„æ•°æ®è¯»å–æºã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºentityåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºTestDataå®žä½“ç±»ï¼š12345678public class TestData &#123; private int id; private String field1; private String field2; private String field3; // get,set,toStringç•¥&#125;æŽ¥ç€åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºreaderåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹åˆ›å»ºItemReaderConfigureï¼š123456789101112131415161718192021@Configurationpublic class ItemReaderConfigure &#123; @Bean public ListItemReader&lt;TestData&gt; simpleReader() &#123; List&lt;TestData&gt; data = new ArrayList&lt;&gt;(); TestData testData1 = new TestData(); testData1.setId(1); testData1.setField1("11"); testData1.setField2("12"); testData1.setField3("13"); data.add(testData1); TestData testData2 = new TestData(); testData2.setId(2); testData2.setField1("21"); testData2.setField2("22"); testData2.setField3("23"); data.add(testData2); return new ListItemReader&lt;&gt;(data); &#125;&#125;ä¸Šé¢æ³¨å†Œäº†ä¸€ä¸ªItemReaderç±»åž‹çš„Beanï¼ŒåŽç»­éƒ½ç”¨å®ƒä½œä¸ºè¯»å–æ•°æ®çš„æ¥æºã€‚è¾“å‡ºæ–‡æœ¬æ•°æ®åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºjobåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºFileItemWriterDemoï¼Œç”¨äºŽæµ‹è¯•Spring Batchè¾“å‡ºæ•°æ®åˆ°æ–‡æœ¬æ–‡ä»¶ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152@Componentpublic class FileItemWriterDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Bean public Job fileItemWriterJob() throws Exception &#123; return jobBuilderFactory.get("fileItemWriterJob") .start(step()) .build(); &#125; private Step step() throws Exception &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .writer(fileItemWriter()) .build(); &#125; private FlatFileItemWriter&lt;TestData&gt; fileItemWriter() throws Exception &#123; FlatFileItemWriter&lt;TestData&gt; writer = new FlatFileItemWriter&lt;&gt;(); FileSystemResource file = new FileSystemResource("/Users/mrbird/Desktop/file"); Path path = Paths.get(file.getPath()); if (!Files.exists(path)) &#123; Files.createFile(path); &#125; // è®¾ç½®è¾“å‡ºæ–‡ä»¶è·¯å¾„ writer.setResource(file); // æŠŠè¯»åˆ°çš„æ¯ä¸ªTestDataå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸² LineAggregator&lt;TestData&gt; aggregator = item -&gt; &#123; try &#123; ObjectMapper mapper = new ObjectMapper(); return mapper.writeValueAsString(item); &#125; catch (JsonProcessingException e) &#123; e.printStackTrace(); &#125; return ""; &#125;; writer.setLineAggregator(aggregator); writer.afterPropertiesSet(); return writer; &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼ŒStepä¸­çš„Readerä½¿ç”¨çš„æ˜¯æˆ‘ä»¬ä¸Šé¢åˆ›å»ºçš„simpleReaderï¼Œæ–‡æœ¬æ•°æ®è¾“å‡ºä½¿ç”¨çš„æ˜¯FlatFileItemWriterã€‚fileItemWriter()æ–¹æ³•çš„ä»£ç è¾ƒä¸ºç®€å•ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚å¯åŠ¨é¡¹ç›®åŽï¼Œåœ¨/Users/mrbird/Desktopç›®å½•ä¸‹ï¼ˆä¹Ÿå°±æ˜¯æˆ‘çš„ç”µè„‘æ¡Œé¢ä¸Šï¼‰ä¼šå¤šå‡ºä¸ªfileæ–‡ä»¶ï¼šè¾“å‡ºxmlæ•°æ®åŒæ ·çš„ï¼Œxmlæ ¼å¼æ•°æ®è¾“å‡ºéœ€è¦å€ŸåŠ©spring-oxmæ¡†æž¶ï¼Œåœ¨pomä¸­å¼•å…¥ç›¸å…³ä¾èµ–ï¼š123456789&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-oxm&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.thoughtworks.xstream&lt;/groupId&gt; &lt;artifactId&gt;xstream&lt;/artifactId&gt; &lt;version&gt;1.4.11.1&lt;/version&gt;&lt;/dependency&gt;ç„¶åŽåœ¨jobåŒ…ä¸‹æ–°å»ºXmlFileItemWriterDemoï¼Œç”¨äºŽæµ‹è¯•Spring Batchè¾“å‡ºæ•°æ®åˆ°xmlæ–‡ä»¶ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849@Componentpublic class XmlFileItemWriterDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Bean public Job xmlFileItemWriterJob() throws Exception &#123; return jobBuilderFactory.get("xmlFileItemWriterJob") .start(step()) .build(); &#125; private Step step() throws Exception &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .writer(xmlFileItemWriter()) .build(); &#125; private StaxEventItemWriter&lt;TestData&gt; xmlFileItemWriter() throws IOException &#123; StaxEventItemWriter&lt;TestData&gt; writer = new StaxEventItemWriter&lt;&gt;(); // é€šè¿‡XStreamMarshallerå°†TestDataè½¬æ¢ä¸ºxml XStreamMarshaller marshaller = new XStreamMarshaller(); Map&lt;String,Class&lt;TestData&gt;&gt; map = new HashMap&lt;&gt;(1); map.put("test", TestData.class); marshaller.setAliases(map); // è®¾ç½®xmlæ ‡ç­¾ writer.setRootTagName("tests"); // è®¾ç½®æ ¹æ ‡ç­¾ writer.setMarshaller(marshaller); FileSystemResource file = new FileSystemResource("/Users/mrbird/Desktop/file.xml"); Path path = Paths.get(file.getPath()); if (!Files.exists(path)) &#123; Files.createFile(path); &#125; writer.setResource(file); // è®¾ç½®ç›®æ ‡æ–‡ä»¶è·¯å¾„ return writer; &#125;&#125;xmlç±»åž‹æ–‡ä»¶è¾“å‡ºä½¿ç”¨çš„æ˜¯StaxEventItemWriterã€‚å¯åŠ¨é¡¹ç›®åŽï¼Œåœ¨/Users/mrbird/Desktopç›®å½•ä¸‹ä¼šå¤šå‡ºä¸ªfile.xmlæ–‡ä»¶ï¼šè¾“å‡ºJSONæ•°æ®åœ¨jobåŒ…ä¸‹æ–°å»ºJsonFileItemWriterDemoï¼Œç”¨äºŽæµ‹è¯•Spring Batchè¾“å‡ºæ•°æ®åˆ°jsonæ–‡ä»¶ï¼š12345678910111213141516171819202122232425262728293031323334353637383940@Componentpublic class JsonFileItemWriterDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Bean public Job jsonFileItemWriterJob() throws Exception &#123; return jobBuilderFactory.get("jsonFileItemWriterJob") .start(step()) .build(); &#125; private Step step() throws Exception &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .writer(jsonFileItemWriter()) .build(); &#125; private JsonFileItemWriter&lt;TestData&gt; jsonFileItemWriter() throws IOException &#123; // æ–‡ä»¶è¾“å‡ºç›®æ ‡åœ°å€ FileSystemResource file = new FileSystemResource("/Users/mrbird/Desktop/file.json"); Path path = Paths.get(file.getPath()); if (!Files.exists(path)) &#123; Files.createFile(path); &#125; // å°†å¯¹è±¡è½¬æ¢ä¸ºjson JacksonJsonObjectMarshaller&lt;TestData&gt; marshaller = new JacksonJsonObjectMarshaller&lt;&gt;(); JsonFileItemWriter&lt;TestData&gt; writer = new JsonFileItemWriter&lt;&gt;(file, marshaller); // è®¾ç½®åˆ«å writer.setName("testDatasonFileItemWriter"); return writer; &#125;&#125;jsonç±»åž‹æ–‡ä»¶è¾“å‡ºä½¿ç”¨çš„æ˜¯JsonFileItemWriterã€‚å¯åŠ¨é¡¹ç›®åŽï¼Œåœ¨/Users/mrbird/Desktopç›®å½•ä¸‹ä¼šå¤šå‡ºä¸ªfile.jsonæ–‡ä»¶ï¼šè¾“å‡ºæ•°æ®åˆ°æ•°æ®åº“åœ¨jobåŒ…ä¸‹æ–°å»ºDatabaseItemWriterDemoï¼Œç”¨äºŽæµ‹è¯•Spring Batchè¾“å‡ºæ•°æ®åˆ°æ•°æ®åº“ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344@Componentpublic class DatabaseItemWriterDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Autowired private DataSource dataSource; @Bean public Job datasourceItemWriterJob() &#123; return jobBuilderFactory.get("datasourceItemWriterJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .writer(dataSourceItemWriter()) .build(); &#125; private ItemWriter&lt;TestData&gt; dataSourceItemWriter() &#123; // ItemWriterçš„å®žçŽ°ç±»ä¹‹ä¸€ï¼Œmysqlæ•°æ®åº“æ•°æ®å†™å…¥ä½¿ç”¨JdbcBatchItemWriterï¼Œ // å…¶ä»–å®žçŽ°ï¼šMongoItemWriter,Neo4jItemWriterç­‰ JdbcBatchItemWriter&lt;TestData&gt; writer = new JdbcBatchItemWriter&lt;&gt;(); writer.setDataSource(dataSource); // è®¾ç½®æ•°æ®æº String sql = "insert into TEST(id,field1,field2,field3) values (:id,:field1,:field2,:field3)"; writer.setSql(sql); // è®¾ç½®æ’å…¥sqlè„šæœ¬ // æ˜ å°„TestDataå¯¹è±¡å±žæ€§åˆ°å ä½ç¬¦ä¸­çš„å±žæ€§ BeanPropertyItemSqlParameterSourceProvider&lt;TestData&gt; provider = new BeanPropertyItemSqlParameterSourceProvider&lt;&gt;(); writer.setItemSqlParameterSourceProvider(provider); writer.afterPropertiesSet(); // è®¾ç½®ä¸€äº›é¢å¤–å±žæ€§ return writer; &#125;&#125;MySQLå…³ç³»åž‹æ•°æ®æ•°æ®å†™å…¥ä½¿ç”¨çš„æ˜¯JdbcBatchItemWriterã€‚åœ¨æµ‹è¯•ä¹‹å‰ï¼Œå…ˆæ¸…ç©ºspringbatchæ•°æ®åº“TESTè¡¨æ•°æ®ï¼Œç„¶åŽå¯åŠ¨é¡¹ç›®ï¼Œå¯åŠ¨åŽï¼ŒTESTè¡¨è®°å½•å¦‚ä¸‹æ‰€ç¤ºï¼šå¤šæ–‡æœ¬è¾“å‡ºå¤šæ–‡æœ¬è¾“å‡ºå’Œä¸Šä¸€èŠ‚ä»‹ç»çš„å¤šæ–‡æœ¬æ•°æ®è¯»å–ç±»ä¼¼ï¼Œéƒ½æ˜¯éœ€è¦é€šè¿‡ä»£ç†æ¥å®Œæˆã€‚æˆ‘ä»¬æ¨¡æ‹Ÿä¸ªåŒæ—¶è¾“å‡ºxmlæ ¼å¼å’Œæ™®é€šæ–‡æœ¬æ ¼å¼çš„ä¾‹å­ã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºwriteråŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºItemWriterConfigureé…ç½®ç±»ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556@Configurationpublic class ItemWriterConfigure &#123; @Bean public FlatFileItemWriter&lt;TestData&gt; fileItemWriter() throws Exception &#123; FlatFileItemWriter&lt;TestData&gt; writer = new FlatFileItemWriter&lt;&gt;(); FileSystemResource file = new FileSystemResource("/Users/mrbird/Desktop/file"); Path path = Paths.get(file.getPath()); if (!Files.exists(path)) &#123; Files.createFile(path); &#125; writer.setResource(file); // è®¾ç½®ç›®æ ‡æ–‡ä»¶è·¯å¾„ // æŠŠè¯»åˆ°çš„æ¯ä¸ªTestDataå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸² LineAggregator&lt;TestData&gt; aggregator = item -&gt; &#123; try &#123; ObjectMapper mapper = new ObjectMapper(); return mapper.writeValueAsString(item); &#125; catch (JsonProcessingException e) &#123; e.printStackTrace(); &#125; return ""; &#125;; writer.setLineAggregator(aggregator); writer.afterPropertiesSet(); return writer; &#125; @Bean public StaxEventItemWriter&lt;TestData&gt; xmlFileItemWriter() throws Exception &#123; StaxEventItemWriter&lt;TestData&gt; writer = new StaxEventItemWriter&lt;&gt;(); // é€šè¿‡XStreamMarshallerå°†TestDataè½¬æ¢ä¸ºxml XStreamMarshaller marshaller = new XStreamMarshaller(); Map&lt;String, Class&lt;TestData&gt;&gt; map = new HashMap&lt;&gt;(1); map.put("test", TestData.class); marshaller.setAliases(map); // è®¾ç½®xmlæ ‡ç­¾ writer.setRootTagName("tests"); // è®¾ç½®æ ¹æ ‡ç­¾ writer.setMarshaller(marshaller); FileSystemResource file = new FileSystemResource("/Users/mrbird/Desktop/file.xml"); Path path = Paths.get(file.getPath()); if (!Files.exists(path)) &#123; Files.createFile(path); &#125; writer.setResource(file); // è®¾ç½®ç›®æ ‡æ–‡ä»¶è·¯å¾„ return writer; &#125;&#125;ä¸Šé¢çš„é…ç½®ç±»ä¸­ï¼Œé…ç½®äº†FlatFileItemWriterå’ŒStaxEventItemWriterç±»åž‹çš„ItemWriter Beanï¼Œä»£ç æ­¥éª¤å’Œå‰é¢ä»‹ç»çš„ä¸€è‡´ã€‚ç„¶åŽåœ¨jobåŒ…ä¸‹æ–°å»ºMultiFileItemWriteDemoï¼Œç”¨äºŽæµ‹è¯•å¤šæ–‡æœ¬è¾“å‡ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849@Componentpublic class MultiFileItemWriteDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private DataSource dataSource; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Autowired private ItemStreamWriter&lt;TestData&gt; fileItemWriter; @Autowired private ItemStreamWriter&lt;TestData&gt; xmlFileItemWriter; @Bean public Job multiFileItemWriterJob() &#123; return jobBuilderFactory.get("multiFileItemWriterJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .writer(classifierMultiFileItemWriter()) .stream(fileItemWriter) .stream(xmlFileItemWriter) .build(); &#125; // å°†æ•°æ®åˆ†ç±»ï¼Œç„¶åŽåˆ†åˆ«è¾“å‡ºåˆ°å¯¹åº”çš„æ–‡ä»¶(æ­¤æ—¶éœ€è¦å°†writeræ³¨å†Œåˆ°iocå®¹å™¨ï¼Œå¦åˆ™æŠ¥ // WriterNotOpenException: Writer must be open before it can be written to) private ClassifierCompositeItemWriter&lt;TestData&gt; classifierMultiFileItemWriter() &#123; ClassifierCompositeItemWriter&lt;TestData&gt; writer = new ClassifierCompositeItemWriter&lt;&gt;(); writer.setClassifier((Classifier&lt;TestData, ItemWriter&lt;? super TestData&gt;&gt;) testData -&gt; &#123; try &#123; // idèƒ½è¢«2æ•´é™¤åˆ™è¾“å‡ºåˆ°æ™®é€šæ–‡æœ¬ï¼Œå¦åˆ™è¾“å‡ºåˆ°xmlæ–‡æœ¬ return testData.getId() % 2 == 0 ? fileItemWriter : xmlFileItemWriter; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return null; &#125;); return writer; &#125;&#125;ClassifierCompositeItemWriterå¯ä»¥è®¾ç½®ä¸åŒæ¡ä»¶ä¸‹ä½¿ç”¨ä¸åŒçš„ItemWriterè¾“å‡ºæ•°æ®ï¼Œæ­¤å¤–åœ¨Stepä¸­ï¼Œè¿˜éœ€é€šè¿‡StepBuilderFactoryçš„stream()æ–¹æ³•ä¼ å…¥ä½¿ç”¨åˆ°çš„ItemWriterï¼ˆè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ³¨å…¥çš„æ—¶å€™ï¼Œç±»åž‹åº”é€‰æ‹©ItemStreamWriterï¼‰ã€‚åœ¨å¯åŠ¨é¡¹ç›®å‰ï¼Œå…ˆåˆ æŽ‰/Users/mrbird/Desktopç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚åˆ æŽ‰åŽï¼Œå¯åŠ¨é¡¹ç›®ï¼Œç»“æžœå¦‚ä¸‹ï¼šå¦‚æžœä¸æƒ³ç”¨åˆ†ç±»ï¼Œå¸Œæœ›æ‰€æœ‰æ•°æ®éƒ½è¾“å‡ºåˆ°å¯¹åº”æ ¼å¼çš„æ–‡æœ¬ä¸­ï¼Œåˆ™å¯ä»¥ä½¿ç”¨CompositeItemWriterä½œä¸ºä»£ç†è¾“å‡ºï¼Œä¿®æ”¹MultiFileItemWriteDemoï¼š1234567891011121314151617181920212223242526272829303132333435363738@Componentpublic class MultiFileItemWriteDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private ListItemReader&lt;TestData&gt; simpleReader; @Autowired private ItemStreamWriter&lt;TestData&gt; fileItemWriter; @Autowired private ItemStreamWriter&lt;TestData&gt; xmlFileItemWriter; @Bean public Job multiFileItemWriterJob() &#123; return jobBuilderFactory.get("multiFileItemWriterJob2") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(simpleReader) .writer(multiFileItemWriter()) .build(); &#125; // è¾“å‡ºæ•°æ®åˆ°å¤šä¸ªæ–‡ä»¶ private CompositeItemWriter&lt;TestData&gt; multiFileItemWriter() &#123; // ä½¿ç”¨CompositeItemWriterä»£ç† CompositeItemWriter&lt;TestData&gt; writer = new CompositeItemWriter&lt;&gt;(); // è®¾ç½®å…·ä½“å†™ä»£ç† writer.setDelegates(Arrays.asList(fileItemWriter, xmlFileItemWriter)); return writer; &#125;&#125;åœ¨å¯åŠ¨é¡¹ç›®å‰ï¼Œå…ˆåˆ æŽ‰/Users/mrbird/Desktopç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚åˆ æŽ‰åŽï¼Œå¯åŠ¨é¡¹ç›®ï¼Œç»“æžœå¦‚ä¸‹ï¼šæœ¬èŠ‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/69.spring-batch-itemwriterã€‚]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>Spring Batch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Batchè¯»å–æ•°æ®]]></title>
    <url>%2FSpring-Batch%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE.html</url>
    <content type="text"><![CDATA[Spring Batchè¯»å–æ•°æ®é€šè¿‡ItemReaderæŽ¥å£çš„å®žçŽ°ç±»æ¥å®Œæˆï¼ŒåŒ…æ‹¬FlatFileItemReaderæ–‡æœ¬æ•°æ®è¯»å–ã€StaxEventItemReader XMLæ–‡ä»¶æ•°æ®è¯»å–ã€JsonItemReader JSONæ–‡ä»¶æ•°æ®è¯»å–ã€JdbcPagingItemReaderæ•°æ®åº“åˆ†é¡µæ•°æ®è¯»å–ç­‰å®žçŽ°ï¼Œæ›´å¤šå¯ç”¨çš„å®žçŽ°å¯ä»¥å‚è€ƒï¼šhttps://docs.spring.io/spring-batch/docs/4.2.x/reference/html/appendix.html#itemReadersAppendixï¼Œæœ¬æ–‡åªä»‹ç»è¿™å››ç§æ¯”è¾ƒå¸¸ç”¨çš„è¯»å–æ•°æ®æ–¹å¼ã€‚æ¡†æž¶æ­å»ºæ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.2.4.RELEASEï¼ŒartifactIdä¸ºspring-batch-itemreaderï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå‰©ä¸‹çš„æ•°æ®åº“å±‚çš„å‡†å¤‡ï¼Œé¡¹ç›®é…ç½®ï¼Œä¾èµ–å¼•å…¥å’ŒSpring Batchå…¥é—¨æ–‡ç« ä¸­çš„æ¡†æž¶æ­å»ºæ­¥éª¤ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚ç®€å•æ•°æ®è¯»å–å‰é¢æåˆ°ï¼ŒSpring Batchè¯»å–æ•°æ®æ˜¯é€šè¿‡ItemReaderæŽ¥å£çš„å®žçŽ°ç±»æ¥å®Œæˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªItemReaderçš„å®žçŽ°ç±»ï¼Œå®žçŽ°ç®€å•æ•°æ®çš„è¯»å–ã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºreaderåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºItemReaderæŽ¥å£çš„å®žçŽ°ç±»MySimpleIteamReaderï¼š1234567891011121314public class MySimpleIteamReader implements ItemReader&lt;String&gt; &#123; private Iterator&lt;String&gt; iterator; public MySimpleIteamReader(List&lt;String&gt; data) &#123; this.iterator = data.iterator(); &#125; @Override public String read() &#123; // æ•°æ®ä¸€ä¸ªæŽ¥ç€ä¸€ä¸ªè¯»å– return iterator.hasNext() ? iterator.next() : null; &#125;&#125;æ³›åž‹æŒ‡å®šè¯»å–æ•°æ®çš„æ ¼å¼ï¼Œè¿™é‡Œè¯»å–çš„æ˜¯Stringç±»åž‹çš„Listï¼Œread()æ–¹æ³•çš„å®žçŽ°ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯éåŽ†é›†åˆæ•°æ®ã€‚æŽ¥ç€åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºjobåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºMySimpleItemReaderDemoç±»ï¼Œç”¨äºŽæµ‹è¯•æˆ‘ä»¬å®šä¹‰çš„MySimpleIteamReaderï¼ŒMySimpleItemReaderDemoç±»ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728@Componentpublic class MySimpleItemReaderDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job mySimpleItemReaderJob() &#123; return jobBuilderFactory.get("mySimpleItemReaderJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;String, String&gt;chunk(2) .reader(mySimpleItemReader()) .writer(list -&gt; list.forEach(System.out::println)) // ç®€å•è¾“å‡ºï¼ŒåŽé¢å†è¯¦ç»†ä»‹ç»writer .build(); &#125; private ItemReader&lt;String&gt; mySimpleItemReader() &#123; List&lt;String&gt; data = Arrays.asList("java", "c++", "javascript", "python"); return new MySimpleIteamReader(data); &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡mySimpleItemReader()æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªMySimpleIteamReaderï¼Œå¹¶ä¸”ä¼ å…¥äº†Listæ•°æ®ã€‚ä¸Šé¢ä»£ç å¤§ä½“å’Œä¸Šä¸€èŠ‚ä¸­ä»‹ç»çš„å·®ä¸å¤šï¼Œæœ€ä¸»è¦çš„åŒºåˆ«å°±æ˜¯Stepçš„åˆ›å»ºè¿‡ç¨‹ç¨æœ‰ä¸åŒã€‚åœ¨MySimpleItemReaderDemoç±»ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡StepBuilderFactoryåˆ›å»ºæ­¥éª¤Stepï¼Œä¸è¿‡ä¸å†æ˜¯ä½¿ç”¨tasklet()æ–¹æ³•åˆ›å»ºï¼Œè€Œæ˜¯ä½¿ç”¨chunk()æ–¹æ³•ã€‚chunkå­—é¢ä¸Šçš„æ„æ€æ˜¯â€œå—â€çš„æ„æ€ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºæ•°æ®å—ï¼Œæ³›åž‹&lt;String, String&gt;ç”¨äºŽæŒ‡å®šè¯»å–çš„æ•°æ®å’Œè¾“å‡ºçš„æ•°æ®ç±»åž‹ï¼Œæž„é€ å™¨å…¥å‚æŒ‡å®šäº†æ•°æ®å—çš„å¤§å°ï¼Œæ¯”å¦‚æŒ‡å®šä¸º2æ—¶è¡¨ç¤ºæ¯å½“è¯»å–2ç»„æ•°æ®åŽåšä¸€æ¬¡æ•°æ®è¾“å‡ºå¤„ç†ã€‚æŽ¥ç€reader()æ–¹æ³•æŒ‡å®šè¯»å–æ•°æ®çš„æ–¹å¼ï¼Œè¯¥æ–¹æ³•æŽ¥æ”¶ItemReaderçš„å®žçŽ°ç±»ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„MySimpleIteamReaderã€‚writer()æ–¹æ³•æŒ‡å®šæ•°æ®è¾“å‡ºæ–¹å¼ï¼Œå› ä¸ºè¿™å—ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œæ‰€ä»¥å…ˆç®€å•éåŽ†è¾“å‡ºå³å¯ã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š123456782020-03-07 11:17:32.303 INFO 28381 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=mySimpleItemReaderJob]] launched with the following parameters: [&#123;&#125;]2020-03-07 11:17:32.369 INFO 28381 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]javac++javascriptpython2020-03-07 11:17:32.428 INFO 28381 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 59ms2020-03-07 11:17:32.451 INFO 28381 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=mySimpleItemReaderJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 125msæ–‡æœ¬æ•°æ®è¯»å–Spring Batchè¯»å–æ–‡æœ¬ç±»åž‹æ•°æ®å¯ä»¥é€šè¿‡FlatFileItemReaderå®žçŽ°ï¼Œåœ¨æ¼”ç¤ºæ€Žä¹ˆä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå‡†å¤‡å¥½æ•°æ®æ–‡ä»¶ã€‚åœ¨resourcesç›®å½•ä¸‹æ–°å»ºfileæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234567// æ¼”ç¤ºæ–‡ä»¶æ•°æ®è¯»å–1,11,12,132,21,22,233,31,32,334,41,42,435,51,52,536,61,62,63fileçš„æ•°æ®æ˜¯ä¸€è¡Œä¸€è¡Œä»¥é€—å·åˆ†éš”çš„æ•°æ®ï¼ˆåœ¨æ‰¹å¤„ç†ä¸šåŠ¡ä¸­ï¼Œæ–‡æœ¬ç±»åž‹çš„æ•°æ®æ–‡ä»¶ä¸€èˆ¬éƒ½æ˜¯æœ‰ä¸€å®šè§„å¾‹çš„ï¼‰ã€‚åœ¨æ–‡æœ¬æ•°æ®è¯»å–çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†è¯»å–çš„æ•°æ®è½¬æ¢ä¸ºPOJOå¯¹è±¡å­˜å‚¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªä¸Žä¹‹å¯¹åº”çš„POJOå¯¹è±¡ã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºentityåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºTestDataç±»ï¼š12345678public class TestData &#123; private int id; private String field1; private String field2; private String field3; // get,set,toStringç•¥&#125;å› ä¸ºfileæ–‡æœ¬ä¸­çš„ä¸€è¡Œæ•°æ®ç»è¿‡é€—å·åˆ†éš”åŽä¸º1ã€11ã€12ã€13ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»ºçš„ä¸Žä¹‹å¯¹åº”çš„POJO TestDataåŒ…å«4ä¸ªå±žæ€§idã€field1ã€field2å’Œfield3ã€‚æŽ¥ç€åœ¨jobåŒ…ä¸‹æ–°å»ºFileItemReaderDemoï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354@Componentpublic class FileItemReaderDemo &#123; // ä»»åŠ¡åˆ›å»ºå·¥åŽ‚ @Autowired private JobBuilderFactory jobBuilderFactory; // æ­¥éª¤åˆ›å»ºå·¥åŽ‚ @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job fileItemReaderJob() &#123; return jobBuilderFactory.get("fileItemReaderJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(fileItemReader()) .writer(list -&gt; list.forEach(System.out::println)) .build(); &#125; private ItemReader&lt;TestData&gt; fileItemReader() &#123; FlatFileItemReader&lt;TestData&gt; reader = new FlatFileItemReader&lt;&gt;(); reader.setResource(new ClassPathResource("file")); // è®¾ç½®æ–‡ä»¶èµ„æºåœ°å€ reader.setLinesToSkip(1); // å¿½ç•¥ç¬¬ä¸€è¡Œ // AbstractLineTokenizerçš„ä¸‰ä¸ªå®žçŽ°ç±»ä¹‹ä¸€ï¼Œä»¥å›ºå®šåˆ†éš”ç¬¦å¤„ç†è¡Œæ•°æ®è¯»å–, // ä½¿ç”¨é»˜è®¤æž„é€ å™¨çš„æ—¶å€™ï¼Œä½¿ç”¨é€—å·ä½œä¸ºåˆ†éš”ç¬¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æœ‰å‚æž„é€ å™¨æ¥æŒ‡å®šåˆ†éš”ç¬¦ DelimitedLineTokenizer tokenizer = new DelimitedLineTokenizer(); // è®¾ç½®å±žæ€§åï¼Œç±»ä¼¼äºŽè¡¨å¤´ tokenizer.setNames("id", "field1", "field2", "field3"); // å°†æ¯è¡Œæ•°æ®è½¬æ¢ä¸ºTestDataå¯¹è±¡ DefaultLineMapper&lt;TestData&gt; mapper = new DefaultLineMapper&lt;&gt;(); // è®¾ç½®LineTokenizer mapper.setLineTokenizer(tokenizer); // è®¾ç½®æ˜ å°„æ–¹å¼ï¼Œå³è¯»å–åˆ°çš„æ–‡æœ¬æ€Žä¹ˆè½¬æ¢ä¸ºå¯¹åº”çš„POJO mapper.setFieldSetMapper(fieldSet -&gt; &#123; TestData data = new TestData(); data.setId(fieldSet.readInt("id")); data.setField1(fieldSet.readString("field1")); data.setField2(fieldSet.readString("field2")); data.setField3(fieldSet.readString("field3")); return data; &#125;); reader.setLineMapper(mapper); return reader; &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨fileItemReader()æ–¹æ³•é‡Œç¼–å†™äº†å…·ä½“çš„æ–‡æœ¬æ•°æ®è¯»å–ä»£ç ï¼Œè¿‡ç¨‹å‚è€ƒæ³¨é‡Šå³å¯ã€‚DelimitedLineTokenizeråˆ†éš”ç¬¦è¡Œå¤„ç†å™¨çš„é»˜è®¤æž„é€ å™¨æºç å¦‚ä¸‹æ‰€ç¤ºï¼šå¸¸é‡DELIMITER_COMMAçš„å€¼ä¸ºpublic static final String DELIMITER_COMMA = &quot;,&quot;;ï¼Œå‡å¦‚æˆ‘ä»¬çš„æ•°æ®å¹¶ä¸æ˜¯ç”¨é€—å·åˆ†éš”ï¼Œè€Œæ˜¯ç”¨|ç­‰å­—ç¬¦åˆ†éš”çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å®ƒçš„æœ‰å‚æž„é€ å™¨æŒ‡å®šï¼š1DelimitedLineTokenizer tokenizer = new DelimitedLineTokenizer("|");DelimitedLineTokenizeræ˜¯AbstractLineTokenizerä¸‰ä¸ªå®žçŽ°ç±»ä¹‹ä¸€ï¼šé¡¾åæ€ä¹‰ï¼ŒFixedLengthTokenizeré€šè¿‡æŒ‡å®šçš„å›ºå®šé•¿åº¦æ¥æˆªå–æ•°æ®ï¼ŒRegexLineTokenizeré€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…æ•°æ®ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±çŽ©çŽ©ã€‚ç¼–å†™å¥½FileItemReaderDemoåŽï¼Œå¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š123456789102020-03-07 12:06:11.876 INFO 29042 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=fileItemReaderJob]] launched with the following parameters: [&#123;&#125;]2020-03-07 12:06:11.937 INFO 29042 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]TestData&#123;id=1, field1=&apos;11&apos;, field2=&apos;12&apos;, field3=&apos;13&apos;&#125;TestData&#123;id=2, field1=&apos;21&apos;, field2=&apos;22&apos;, field3=&apos;23&apos;&#125;TestData&#123;id=3, field1=&apos;31&apos;, field2=&apos;32&apos;, field3=&apos;33&apos;&#125;TestData&#123;id=4, field1=&apos;41&apos;, field2=&apos;42&apos;, field3=&apos;43&apos;&#125;TestData&#123;id=5, field1=&apos;51&apos;, field2=&apos;52&apos;, field3=&apos;53&apos;&#125;TestData&#123;id=6, field1=&apos;61&apos;, field2=&apos;62&apos;, field3=&apos;63&apos;&#125;2020-03-07 12:06:12.020 INFO 29042 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 83ms2020-03-07 12:06:12.044 INFO 29042 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=fileItemReaderJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 146msæ•°æ®åº“æ•°æ®è¯»å–åœ¨æ¼”ç¤ºä»Žæ•°æ®åº“ä¸­è¯»å–æ•°æ®ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå‡†å¤‡å¥½æµ‹è¯•æ•°æ®ã€‚åœ¨springbatchæ•°æ®åº“ä¸­æ–°å»ºä¸€å¼ TESTè¡¨ï¼ŒSQLè¯­å¥å¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314151617181920212223-- ------------------------------ Table structure for TEST-- ----------------------------DROP TABLE IF EXISTS `TEST`;CREATE TABLE `TEST` ( `id` bigint(10) NOT NULL COMMENT 'ID', `field1` varchar(10) NOT NULL COMMENT 'å­—æ®µä¸€', `field2` varchar(10) NOT NULL COMMENT 'å­—æ®µäºŒ', `field3` varchar(10) NOT NULL COMMENT 'å­—æ®µä¸‰', PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;-- ------------------------------ Records of TEST-- ----------------------------BEGIN;INSERT INTO `TEST` VALUES (1, '11', '12', '13');INSERT INTO `TEST` VALUES (2, '21', '22', '23');INSERT INTO `TEST` VALUES (3, '31', '32', '33');INSERT INTO `TEST` VALUES (4, '41', '42', '43');INSERT INTO `TEST` VALUES (5, '51', '52', '53');INSERT INTO `TEST` VALUES (6, '61', '62', '63');COMMIT;TESTè¡¨çš„å­—æ®µå’Œä¸Šé¢åˆ›å»ºçš„TestDataå®žä½“ç±»ä¸€è‡´ã€‚ç„¶åŽåœ¨jobåŒ…ä¸‹æ–°å»ºDataSourceItemReaderDemoç±»ï¼Œæµ‹è¯•ä»Žæ•°æ®åº“ä¸­è¯»å–æ•°æ®ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758@Componentpublic class DataSourceItemReaderDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; // æ³¨å…¥æ•°æ®æº @Autowired private DataSource dataSource; @Bean public Job dataSourceItemReaderJob() throws Exception &#123; return jobBuilderFactory.get("dataSourceItemReaderJob") .start(step()) .build(); &#125; private Step step() throws Exception &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(dataSourceItemReader()) .writer(list -&gt; list.forEach(System.out::println)) .build(); &#125; private ItemReader&lt;TestData&gt; dataSourceItemReader() throws Exception &#123; JdbcPagingItemReader&lt;TestData&gt; reader = new JdbcPagingItemReader&lt;&gt;(); reader.setDataSource(dataSource); // è®¾ç½®æ•°æ®æº reader.setFetchSize(5); // æ¯æ¬¡å–å¤šå°‘æ¡è®°å½• reader.setPageSize(5); // è®¾ç½®æ¯é¡µæ•°æ®é‡ // æŒ‡å®šsqlæŸ¥è¯¢è¯­å¥ select id,field1,field2,field3 from TEST MySqlPagingQueryProvider provider = new MySqlPagingQueryProvider(); provider.setSelectClause("id,field1,field2,field3"); //è®¾ç½®æŸ¥è¯¢å­—æ®µ provider.setFromClause("from TEST"); // è®¾ç½®ä»Žå“ªå¼ è¡¨æŸ¥è¯¢ // å°†è¯»å–åˆ°çš„æ•°æ®è½¬æ¢ä¸ºTestDataå¯¹è±¡ reader.setRowMapper((resultSet, rowNum) -&gt; &#123; TestData data = new TestData(); data.setId(resultSet.getInt(1)); data.setField1(resultSet.getString(2)); // è¯»å–ç¬¬ä¸€ä¸ªå­—æ®µï¼Œç±»åž‹ä¸ºString data.setField2(resultSet.getString(3)); data.setField3(resultSet.getString(4)); return data; &#125;); Map&lt;String, Order&gt; sort = new HashMap&lt;&gt;(1); sort.put("id", Order.ASCENDING); provider.setSortKeys(sort); // è®¾ç½®æŽ’åº,é€šè¿‡id å‡åº reader.setQueryProvider(provider); // è®¾ç½®namedParameterJdbcTemplateç­‰å±žæ€§ reader.afterPropertiesSet(); return reader; &#125;&#125;dataSourceItemReader()æ–¹æ³•ä¸­çš„ä¸»è¦æ­¥éª¤å°±æ˜¯ï¼šé€šè¿‡JdbcPagingItemReaderè®¾ç½®å¯¹åº”çš„æ•°æ®æºï¼Œç„¶åŽè®¾ç½®æ•°æ®é‡ã€èŽ·å–æ•°æ®çš„sqlè¯­å¥ã€æŽ’åºè§„åˆ™å’ŒæŸ¥è¯¢ç»“æžœä¸ŽPOJOçš„æ˜ å°„è§„åˆ™ç­‰ã€‚æ–¹æ³•æœ«å°¾ä¹‹æ‰€ä»¥éœ€è¦è°ƒç”¨JdbcPagingItemReaderçš„afterPropertiesSet()æ–¹æ³•æ˜¯å› ä¸ºéœ€è¦è®¾ç½®JDBCæ¨¡æ¿ï¼ˆafterPropertiesSet()æ–¹æ³•æºç ï¼‰ï¼šå¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š123456789102020-03-07 16:01:05.366 INFO 30264 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=dataSourceItemReaderJob]] launched with the following parameters: [&#123;&#125;]2020-03-07 16:01:05.420 INFO 30264 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]TestData&#123;id=1, field1=&apos;11&apos;, field2=&apos;12&apos;, field3=&apos;13&apos;&#125;TestData&#123;id=2, field1=&apos;21&apos;, field2=&apos;22&apos;, field3=&apos;23&apos;&#125;TestData&#123;id=3, field1=&apos;31&apos;, field2=&apos;32&apos;, field3=&apos;33&apos;&#125;TestData&#123;id=4, field1=&apos;41&apos;, field2=&apos;42&apos;, field3=&apos;43&apos;&#125;TestData&#123;id=5, field1=&apos;51&apos;, field2=&apos;52&apos;, field3=&apos;53&apos;&#125;TestData&#123;id=6, field1=&apos;61&apos;, field2=&apos;62&apos;, field3=&apos;63&apos;&#125;2020-03-07 16:01:05.512 INFO 30264 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 92ms2020-03-07 16:01:05.534 INFO 30264 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=dataSourceItemReaderJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 147msXMLæ•°æ®è¯»å–Spring Batchå€ŸåŠ©Spring OXMå¯ä»¥è½»æ¾åœ°å®žçŽ°xmlæ ¼å¼æ•°æ®æ–‡ä»¶è¯»å–ã€‚åœ¨resourcesç›®å½•ä¸‹æ–°å»ºfile.xmlï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021222324252627282930313233343536373839&lt;?xml version="1.0" encoding="utf-8" ?&gt;&lt;tests&gt; &lt;test&gt; &lt;id&gt;1&lt;/id&gt; &lt;field1&gt;11&lt;/field1&gt; &lt;field2&gt;12&lt;/field2&gt; &lt;field3&gt;13&lt;/field3&gt; &lt;/test&gt; &lt;test&gt; &lt;id&gt;2&lt;/id&gt; &lt;field1&gt;21&lt;/field1&gt; &lt;field2&gt;22&lt;/field2&gt; &lt;field3&gt;23&lt;/field3&gt; &lt;/test&gt; &lt;test&gt; &lt;id&gt;3&lt;/id&gt; &lt;field1&gt;31&lt;/field1&gt; &lt;field2&gt;32&lt;/field2&gt; &lt;field3&gt;33&lt;/field3&gt; &lt;/test&gt; &lt;test&gt; &lt;id&gt;4&lt;/id&gt; &lt;field1&gt;41&lt;/field1&gt; &lt;field2&gt;42&lt;/field2&gt; &lt;field3&gt;43&lt;/field3&gt; &lt;/test&gt; &lt;test&gt; &lt;id&gt;5&lt;/id&gt; &lt;field1&gt;51&lt;/field1&gt; &lt;field2&gt;52&lt;/field2&gt; &lt;field3&gt;53&lt;/field3&gt; &lt;/test&gt; &lt;test&gt; &lt;id&gt;6&lt;/id&gt; &lt;field1&gt;61&lt;/field1&gt; &lt;field2&gt;62&lt;/field2&gt; &lt;field3&gt;63&lt;/field3&gt; &lt;/test&gt;&lt;/tests&gt;xmlæ–‡ä»¶å†…å®¹ç”±ä¸€ç»„ä¸€ç»„çš„&lt;test&gt;&lt;/test&gt;æ ‡ç­¾ç»„æˆï¼Œ&lt;test&gt;æ ‡ç­¾åˆåŒ…å«å››ç»„å­æ ‡ç­¾ï¼Œæ ‡ç­¾åç§°å’ŒTestDataå®žä½“ç±»å±žæ€§ä¸€ä¸€å¯¹åº”ã€‚å‡†å¤‡å¥½xmlæ–‡ä»¶åŽï¼Œæˆ‘ä»¬åœ¨pomä¸­å¼•å…¥spring-oxmä¾èµ–ï¼š123456789&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-oxm&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.thoughtworks.xstream&lt;/groupId&gt; &lt;artifactId&gt;xstream&lt;/artifactId&gt; &lt;version&gt;1.4.11.1&lt;/version&gt;&lt;/dependency&gt;æŽ¥ç€åœ¨jobåŒ…ä¸‹æ–°å»ºXmlFileItemReaderDemoï¼Œæ¼”ç¤ºxmlæ–‡ä»¶æ•°æ®èŽ·å–ï¼š1234567891011121314151617181920212223242526272829303132333435363738@Componentpublic class XmlFileItemReaderDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job xmlFileItemReaderJob() &#123; return jobBuilderFactory.get("xmlFileItemReaderJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(xmlFileItemReader()) .writer(list -&gt; list.forEach(System.out::println)) .build(); &#125; private ItemReader&lt;TestData&gt; xmlFileItemReader() &#123; StaxEventItemReader&lt;TestData&gt; reader = new StaxEventItemReader&lt;&gt;(); reader.setResource(new ClassPathResource("file.xml")); // è®¾ç½®xmlæ–‡ä»¶æº reader.setFragmentRootElementName("test"); // æŒ‡å®šxmlæ–‡ä»¶çš„æ ¹æ ‡ç­¾ // å°†xmlæ•°æ®è½¬æ¢ä¸ºTestDataå¯¹è±¡ XStreamMarshaller marshaller = new XStreamMarshaller(); // æŒ‡å®šéœ€è¦è½¬æ¢çš„ç›®æ ‡æ•°æ®ç±»åž‹ Map&lt;String, Class&lt;TestData&gt;&gt; map = new HashMap&lt;&gt;(1); map.put("test", TestData.class); marshaller.setAliases(map); reader.setUnmarshaller(marshaller); return reader; &#125;&#125;åœ¨xmlFileItemReader()æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡StaxEventItemReaderè¯»å–xmlæ–‡ä»¶ï¼Œä»£ç è¾ƒç®€å•ï¼Œçœ‹æ³¨é‡Šå³å¯ã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š12345678910020-03-07 16:23:47.775 INFO 30450 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=xmlFileItemReaderJob]] launched with the following parameters: [&#123;&#125;]2020-03-07 16:23:47.820 INFO 30450 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]TestData&#123;id=1, field1=&apos;11&apos;, field2=&apos;12&apos;, field3=&apos;13&apos;&#125;TestData&#123;id=2, field1=&apos;21&apos;, field2=&apos;22&apos;, field3=&apos;23&apos;&#125;TestData&#123;id=3, field1=&apos;31&apos;, field2=&apos;32&apos;, field3=&apos;33&apos;&#125;TestData&#123;id=4, field1=&apos;41&apos;, field2=&apos;42&apos;, field3=&apos;43&apos;&#125;TestData&#123;id=5, field1=&apos;51&apos;, field2=&apos;52&apos;, field3=&apos;53&apos;&#125;TestData&#123;id=6, field1=&apos;61&apos;, field2=&apos;62&apos;, field3=&apos;63&apos;&#125;2020-03-07 16:23:47.961 INFO 30450 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 140ms2020-03-07 16:23:47.984 INFO 30450 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=xmlFileItemReaderJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 200msJSONæ•°æ®è¯»å–åœ¨resourcesç›®å½•ä¸‹æ–°å»ºfile.jsonæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234567891011121314151617181920[ &#123; "id": 1, "field1": "11", "field2": "12", "field3": "13" &#125;, &#123; "id": 2, "field1": "21", "field2": "22", "field3": "23" &#125;, &#123; "id": 3, "field1": "31", "field2": "32", "field3": "33" &#125;]JSONå¯¹è±¡å±žæ€§å’ŒTestDataå¯¹è±¡å±žæ€§ä¸€ä¸€å¯¹åº”ã€‚åœ¨jobåŒ…ä¸‹æ–°å»ºJSONFileItemReaderDemoï¼Œç”¨äºŽæµ‹è¯•JSONæ–‡ä»¶æ•°æ®è¯»å–ï¼š12345678910111213141516171819202122232425262728293031323334@Componentpublic class JSONFileItemReaderDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job jsonFileItemReaderJob() &#123; return jobBuilderFactory.get("jsonFileItemReaderJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(jsonItemReader()) .writer(list -&gt; list.forEach(System.out::println)) .build(); &#125; private ItemReader&lt;TestData&gt; jsonItemReader() &#123; // è®¾ç½®jsonæ–‡ä»¶åœ°å€ ClassPathResource resource = new ClassPathResource("file.json"); // è®¾ç½®jsonæ–‡ä»¶è½¬æ¢çš„ç›®æ ‡å¯¹è±¡ç±»åž‹ JacksonJsonObjectReader&lt;TestData&gt; jacksonJsonObjectReader = new JacksonJsonObjectReader&lt;&gt;(TestData.class); JsonItemReader&lt;TestData&gt; reader = new JsonItemReader&lt;&gt;(resource, jacksonJsonObjectReader); // ç»™readerè®¾ç½®ä¸€ä¸ªåˆ«å reader.setName("testDataJsonItemReader"); return reader; &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š12345672020-03-07 16:40:52.508 INFO 30599 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=jsonFileItemReaderJob]] launched with the following parameters: [&#123;&#125;]2020-03-07 16:40:52.554 INFO 30599 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]TestData&#123;id=1, field1=&apos;11&apos;, field2=&apos;12&apos;, field3=&apos;13&apos;&#125;TestData&#123;id=2, field1=&apos;21&apos;, field2=&apos;22&apos;, field3=&apos;23&apos;&#125;TestData&#123;id=3, field1=&apos;31&apos;, field2=&apos;32&apos;, field3=&apos;33&apos;&#125;2020-03-07 16:40:52.622 INFO 30599 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 67ms2020-03-07 16:40:52.642 INFO 30599 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=jsonFileItemReaderJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 124mså¤šæ–‡æœ¬æ•°æ®è¯»å–å¤šæ–‡æœ¬çš„æ•°æ®è¯»å–æœ¬è´¨è¿˜æ˜¯å•æ–‡ä»¶æ•°æ®è¯»å–ï¼ŒåŒºåˆ«å°±æ˜¯å¤šæ–‡ä»¶è¯»å–éœ€è¦åœ¨å•æ–‡ä»¶è¯»å–çš„æ–¹å¼ä¸Šè®¾ç½®ä¸€å±‚ä»£ç†ã€‚åœ¨resourcesç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶file1å’Œfile2ï¼Œfile1å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š1234567// æ¼”ç¤ºæ–‡ä»¶æ•°æ®è¯»å–1,11,12,132,21,22,233,31,32,334,41,42,435,51,52,536,61,62,63file2å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123// æ¼”ç¤ºæ–‡ä»¶æ•°æ®è¯»å–7,71,72,738,81,82,83ç„¶åŽåœ¨jobåŒ…ä¸‹æ–°å»ºMultiFileIteamReaderDemoï¼Œæ¼”ç¤ºå¤šæ–‡ä»¶æ•°æ®è¯»å–ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263@Componentpublic class MultiFileIteamReaderDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job multiFileItemReaderJob() &#123; return jobBuilderFactory.get("multiFileItemReaderJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .&lt;TestData, TestData&gt;chunk(2) .reader(multiFileItemReader()) .writer(list -&gt; list.forEach(System.out::println)) .build(); &#125; private ItemReader&lt;TestData&gt; multiFileItemReader() &#123; MultiResourceItemReader&lt;TestData&gt; reader = new MultiResourceItemReader&lt;&gt;(); reader.setDelegate(fileItemReader()); // è®¾ç½®æ–‡ä»¶è¯»å–ä»£ç†ï¼Œæ–¹æ³•å¯ä»¥ä½¿ç”¨å‰é¢æ–‡ä»¶è¯»å–ä¸­çš„ä¾‹å­ Resource[] resources = new Resource[]&#123; new ClassPathResource("file1"), new ClassPathResource("file2") &#125;; reader.setResources(resources); // è®¾ç½®å¤šæ–‡ä»¶æº return reader; &#125; private FlatFileItemReader&lt;TestData&gt; fileItemReader() &#123; FlatFileItemReader&lt;TestData&gt; reader = new FlatFileItemReader&lt;&gt;(); reader.setLinesToSkip(1); // å¿½ç•¥ç¬¬ä¸€è¡Œ // AbstractLineTokenizerçš„ä¸‰ä¸ªå®žçŽ°ç±»ä¹‹ä¸€ï¼Œä»¥å›ºå®šåˆ†éš”ç¬¦å¤„ç†è¡Œæ•°æ®è¯»å–, // ä½¿ç”¨é»˜è®¤æž„é€ å™¨çš„æ—¶å€™ï¼Œä½¿ç”¨é€—å·ä½œä¸ºåˆ†éš”ç¬¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æœ‰å‚æž„é€ å™¨æ¥æŒ‡å®šåˆ†éš”ç¬¦ DelimitedLineTokenizer tokenizer = new DelimitedLineTokenizer(); // è®¾ç½®å±žå§“åï¼Œç±»ä¼¼äºŽè¡¨å¤´ tokenizer.setNames("id", "field1", "field2", "field3"); // å°†æ¯è¡Œæ•°æ®è½¬æ¢ä¸ºTestDataå¯¹è±¡ DefaultLineMapper&lt;TestData&gt; mapper = new DefaultLineMapper&lt;&gt;(); mapper.setLineTokenizer(tokenizer); // è®¾ç½®æ˜ å°„æ–¹å¼ mapper.setFieldSetMapper(fieldSet -&gt; &#123; TestData data = new TestData(); data.setId(fieldSet.readInt("id")); data.setField1(fieldSet.readString("field1")); data.setField2(fieldSet.readString("field2")); data.setField3(fieldSet.readString("field3")); return data; &#125;); reader.setLineMapper(mapper); return reader; &#125;&#125;ä¸Šé¢ä»£ç ä¸­fileItemReader()æ–¹æ³•åœ¨æ–‡æœ¬æ•°æ®è¯»å–ä¸­ä»‹ç»è¿‡äº†ï¼Œå¤šæ–‡ä»¶è¯»å–çš„å…³é”®åœ¨äºŽmultiFileItemReader()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•é€šè¿‡MultiResourceItemReaderå¯¹è±¡è®¾ç½®äº†å¤šä¸ªæ–‡ä»¶çš„ç›®æ ‡åœ°å€ï¼Œå¹¶ä¸”å°†å•æ–‡ä»¶çš„è¯»å–æ–¹å¼è®¾ç½®ä¸ºä»£ç†ã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š1234567891011122020-03-07 16:55:24.480 INFO 30749 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=multiFileItemReaderJob]] launched with the following parameters: [&#123;&#125;]2020-03-07 16:55:24.536 INFO 30749 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]TestData&#123;id=1, field1=&apos;11&apos;, field2=&apos;12&apos;, field3=&apos;13&apos;&#125;TestData&#123;id=2, field1=&apos;21&apos;, field2=&apos;22&apos;, field3=&apos;23&apos;&#125;TestData&#123;id=3, field1=&apos;31&apos;, field2=&apos;32&apos;, field3=&apos;33&apos;&#125;TestData&#123;id=4, field1=&apos;41&apos;, field2=&apos;42&apos;, field3=&apos;43&apos;&#125;TestData&#123;id=5, field1=&apos;51&apos;, field2=&apos;52&apos;, field3=&apos;53&apos;&#125;TestData&#123;id=6, field1=&apos;61&apos;, field2=&apos;62&apos;, field3=&apos;63&apos;&#125;TestData&#123;id=7, field1=&apos;71&apos;, field2=&apos;72&apos;, field3=&apos;73&apos;&#125;TestData&#123;id=8, field1=&apos;81&apos;, field2=&apos;82&apos;, field3=&apos;83&apos;&#125;2020-03-07 16:55:24.617 INFO 30749 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 81ms2020-03-07 16:55:24.643 INFO 30749 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=multiFileItemReaderJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 153msæœ¬èŠ‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/68.spring-batch-itemreaderã€‚]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>Spring Batch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Batchå…¥é—¨]]></title>
    <url>%2FSpring-Batch%E5%85%A5%E9%97%A8.html</url>
    <content type="text"><![CDATA[ä¼ä¸šä¸­ç»å¸¸ä¼šæœ‰éœ€è¦æ‰¹å¤„ç†æ‰èƒ½å®Œæˆçš„ä¸šåŠ¡æ“ä½œï¼Œæ¯”å¦‚ï¼šè‡ªåŠ¨åŒ–åœ°å¤„ç†å¤§æ‰¹é‡å¤æ‚çš„æ•°æ®ï¼Œå¦‚æœˆç»“è®¡ç®—ï¼›é‡å¤æ€§åœ°å¤„ç†å¤§æ‰¹é‡æ•°æ®ï¼Œå¦‚è´¹çŽ‡è®¡ç®—ï¼›å……å½“å†…éƒ¨ç³»ç»Ÿå’Œå¤–éƒ¨ç³»ç»Ÿçš„æ•°æ®çº½å¸¦ï¼Œä¸­é—´éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ ¼å¼åŒ–ï¼Œæ ¡éªŒï¼Œè½¬æ¢å¤„ç†ç­‰ã€‚Spring Batchæ˜¯ä¸€ä¸ªè½»é‡çº§ä½†åŠŸèƒ½åˆååˆ†å…¨é¢çš„æ‰¹å¤„ç†æ¡†æž¶ï¼Œæœ¬èŠ‚æˆ‘ä»¬å°†é€šè¿‡ä¸€äº›ç®€å•çš„ä¾‹å­æ¥å…¥é—¨Spring Batchã€‚æ¡†æž¶æ­å»ºæ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.2.4.RELEASEï¼ŒartifactIdä¸ºspring-batch-startï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šç„¶åŽåœ¨pomä¸­å¼•å…¥Spring Batchã€MySQLå’ŒJDBCä¾èµ–ï¼Œå¼•å…¥åŽpomå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.2.5.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;spring-batch-start&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;spring-batch-start&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-batch&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;åœ¨ç¼–å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç®€å•äº†è§£ä¸‹Spring Batchçš„ç»„æˆï¼šSpring Batché‡Œæœ€åŸºæœ¬çš„å•å…ƒå°±æ˜¯ä»»åŠ¡Jobï¼Œä¸€ä¸ªJobç”±è‹¥å¹²ä¸ªæ­¥éª¤Stepç»„æˆã€‚ä»»åŠ¡å¯åŠ¨å™¨Job Launcherè´Ÿè´£è¿è¡ŒJobï¼Œä»»åŠ¡å­˜å‚¨ä»“åº“Job Repositoryå­˜å‚¨ç€Jobçš„æ‰§è¡ŒçŠ¶æ€ï¼Œå‚æ•°å’Œæ—¥å¿—ç­‰ä¿¡æ¯ã€‚Jobå¤„ç†ä»»åŠ¡åˆå¯ä»¥åˆ†ä¸ºä¸‰å¤§ç±»ï¼šæ•°æ®è¯»å–Item Readerã€æ•°æ®ä¸­é—´å¤„ç†Item Processorå’Œæ•°æ®è¾“å‡ºItem Writerã€‚ä»»åŠ¡å­˜å‚¨ä»“åº“å¯ä»¥æ˜¯å…³ç³»åž‹æ•°æ®åº“MySQLï¼Œéžå…³ç³»åž‹æ•°æ®åº“MongoDBæˆ–è€…ç›´æŽ¥å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæœ¬ç¯‡ä½¿ç”¨çš„æ˜¯MySQLä½œä¸ºä»»åŠ¡å­˜å‚¨ä»“åº“ã€‚æ–°å»ºä¸€ä¸ªåç§°ä¸ºspringbatchçš„MySQLæ•°æ®åº“ï¼Œç„¶åŽå¯¼å…¥org.springframework.batch.coreç›®å½•ä¸‹çš„schema-mysql.sqlæ–‡ä»¶ï¼š å¯¼å…¥åŽï¼Œåº“è¡¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šç„¶åŽåœ¨é¡¹ç›®çš„é…ç½®æ–‡ä»¶application.ymlé‡Œæ·»åŠ MySQLç›¸å…³é…ç½®ï¼š123456spring: datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/springbatch username: root password: 123456æŽ¥ç€åœ¨Spring Bootçš„å…¥å£ç±»ä¸Šæ·»åŠ @EnableBatchProcessingæ³¨è§£ï¼Œè¡¨ç¤ºå¼€å¯Spring Batchæ‰¹å¤„ç†åŠŸèƒ½ï¼š1234567@SpringBootApplication@EnableBatchProcessingpublic class SpringBatchStartApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(SpringBatchStartApplication.class, args); &#125;&#125;è‡³æ­¤ï¼ŒåŸºæœ¬æ¡†æž¶æ­å»ºå¥½äº†ï¼Œä¸‹é¢å¼€å§‹é…ç½®ä¸€ä¸ªç®€å•çš„ä»»åŠ¡ã€‚ç¼–å†™ç¬¬ä¸€ä¸ªä»»åŠ¡åœ¨cc.mrbird.batchç›®å½•ä¸‹æ–°å»ºjobåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºä¸€ä¸ªFirstJobDemoç±»ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314151617181920212223@Componentpublic class FirstJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job firstJob() &#123; return jobBuilderFactory.get("firstJob") .start(step()) .build(); &#125; private Step step() &#123; return stepBuilderFactory.get("step") .tasklet((contribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤...."); return RepeatStatus.FINISHED; &#125;).build(); &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ³¨å…¥äº†JobBuilderFactoryä»»åŠ¡åˆ›å»ºå·¥åŽ‚å’ŒStepBuilderFactoryæ­¥éª¤åˆ›å»ºå·¥åŽ‚ï¼Œåˆ†åˆ«ç”¨äºŽåˆ›å»ºä»»åŠ¡Jobå’Œæ­¥éª¤Stepã€‚JobBuilderFactoryçš„getæ–¹æ³•ç”¨äºŽåˆ›å»ºä¸€ä¸ªæŒ‡å®šåç§°çš„ä»»åŠ¡ï¼Œstartæ–¹æ³•æŒ‡å®šä»»åŠ¡çš„å¼€å§‹æ­¥éª¤ï¼Œæ­¥éª¤é€šè¿‡StepBuilderFactoryæž„å»ºã€‚æ­¥éª¤Stepç”±è‹¥å¹²ä¸ªå°ä»»åŠ¡Taskletç»„æˆï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡taskletæ–¹æ³•åˆ›å»ºã€‚taskletæ–¹æ³•æŽ¥æ”¶ä¸€ä¸ªTaskletç±»åž‹å‚æ•°ï¼ŒTaskletæ˜¯ä¸€ä¸ªå‡½æ•°æ˜¯æŽ¥å£ï¼Œæºç å¦‚ä¸‹ï¼š1234public interface Tasklet &#123; @Nullable RepeatStatus execute(StepContribution contribution, ChunkContext chunkContext) throws Exception;&#125;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨lambdaè¡¨è¾¾å¼åˆ›å»ºä¸€ä¸ªåŒ¿åå®žçŽ°ï¼š1234(contribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤...."); return RepeatStatus.FINISHED;&#125;è¯¥åŒ¿åå®žçŽ°å¿…é¡»è¿”å›žä¸€ä¸ªæ˜Žç¡®çš„æ‰§è¡ŒçŠ¶æ€ï¼Œè¿™é‡Œè¿”å›žRepeatStatus.FINISHEDè¡¨ç¤ºè¯¥å°ä»»åŠ¡æ‰§è¡ŒæˆåŠŸï¼Œæ­£å¸¸ç»“æŸã€‚æ­¤å¤–ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬é…ç½®çš„ä»»åŠ¡Jobå¿…é¡»æ³¨å†Œåˆ°Spring IOCå®¹å™¨ä¸­ï¼Œå¹¶ä¸”ä»»åŠ¡çš„åç§°å’Œæ­¥éª¤çš„åç§°ç»„æˆå”¯ä¸€ã€‚æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡åç§°ä¸ºfirstJobï¼Œæ­¥éª¤çš„åç§°ä¸ºstepï¼Œå¦‚æžœå­˜åœ¨åˆ«çš„ä»»åŠ¡å’Œæ­¥éª¤ç»„åˆä¹Ÿå«è¿™ä¸ªåç§°çš„è¯ï¼Œåˆ™ä¼šæ‰§è¡Œå¤±è´¥ã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ‰“å°æ—¥å¿—å¦‚ä¸‹ï¼š123456...2020-03-06 11:01:11.785 INFO 17324 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=firstJob]] launched with the following parameters: [&#123;&#125;]2020-03-06 11:01:11.846 INFO 17324 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step]æ‰§è¡Œæ­¥éª¤....2020-03-06 11:01:11.886 INFO 17324 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step] executed in 40ms2020-03-06 11:01:11.909 INFO 17324 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=firstJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 101mså¯ä»¥çœ‹åˆ°ï¼Œä»»åŠ¡æˆåŠŸæ‰§è¡Œäº†ï¼Œæ•°æ®åº“çš„åº“è¡¨ä¹Ÿå°†è®°å½•ç›¸å…³è¿è¡Œæ—¥å¿—ã€‚é‡æ–°å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°å¹¶ä¸ä¼šå†æ¬¡æ‰“å°å‡ºä»»åŠ¡æ‰§è¡Œæ—¥å¿—ï¼Œå› ä¸ºJobåç§°å’Œ Stepåç§°ç»„æˆå”¯ä¸€ï¼Œæ‰§è¡Œå®Œçš„ä¸å¯é‡å¤çš„ä»»åŠ¡ï¼Œä¸ä¼šå†æ¬¡æ‰§è¡Œã€‚å¤šæ­¥éª¤ä»»åŠ¡ä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡ä¸€èˆ¬åŒ…å«å¤šä¸ªæ­¥éª¤ï¼Œä¸‹é¢ä¸¾ä¸ªå¤šæ­¥éª¤ä»»åŠ¡çš„ä¾‹å­ã€‚åœ¨jobåŒ…ä¸‹æ–°å»ºMultiStepJobDemoç±»ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041@Componentpublic class MultiStepJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job multiStepJob() &#123; return jobBuilderFactory.get("multiStepJob") .start(step1()) .next(step2()) .next(step3()) .build(); &#125; private Step step1() &#123; return stepBuilderFactory.get("step1") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤ä¸€æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step2() &#123; return stepBuilderFactory.get("step2") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤äºŒæ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step3() &#123; return stepBuilderFactory.get("step3") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤ä¸‰æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡step1()ã€step2()å’Œstep3()ä¸‰ä¸ªæ–¹æ³•åˆ›å»ºäº†ä¸‰ä¸ªæ­¥éª¤ã€‚Jobé‡Œè¦ä½¿ç”¨è¿™äº›æ­¥éª¤ï¼Œåªéœ€è¦é€šè¿‡JobBuilderFactoryçš„startæ–¹æ³•æŒ‡å®šç¬¬ä¸€ä¸ªæ­¥éª¤ï¼Œç„¶åŽé€šè¿‡nextæ–¹æ³•ä¸æ–­åœ°æŒ‡å®šä¸‹ä¸€ä¸ªæ­¥éª¤å³å¯ã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ‰“å°æ—¥å¿—å¦‚ä¸‹ï¼š12345678910112020-03-06 13:52:52.188 INFO 18472 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=multiStepJob]] launched with the following parameters: [&#123;&#125;]2020-03-06 13:52:52.222 INFO 18472 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step1]æ‰§è¡Œæ­¥éª¤ä¸€æ“ä½œã€‚ã€‚ã€‚2020-03-06 13:52:52.251 INFO 18472 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step1] executed in 29ms2020-03-06 13:52:52.292 INFO 18472 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step2]æ‰§è¡Œæ­¥éª¤äºŒæ“ä½œã€‚ã€‚ã€‚2020-03-06 13:52:52.323 INFO 18472 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step2] executed in 30ms2020-03-06 13:52:52.375 INFO 18472 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step3]æ‰§è¡Œæ­¥éª¤ä¸‰æ“ä½œã€‚ã€‚ã€‚2020-03-06 13:52:52.405 INFO 18472 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step3] executed in 29ms2020-03-06 13:52:52.428 INFO 18472 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=multiStepJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 231msä¸‰ä¸ªæ­¥éª¤ä¾æ¬¡æ‰§è¡ŒæˆåŠŸã€‚å¤šä¸ªæ­¥éª¤åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥é€šè¿‡ä¸Šä¸€ä¸ªæ­¥éª¤çš„æ‰§è¡ŒçŠ¶æ€æ¥å†³å®šæ˜¯å¦æ‰§è¡Œä¸‹ä¸€ä¸ªæ­¥éª¤ï¼Œä¿®æ”¹ä¸Šé¢çš„ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243@Componentpublic class MultiStepJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job multiStepJob() &#123; return jobBuilderFactory.get("multiStepJob2") .start(step1()) .on(ExitStatus.COMPLETED.getExitCode()).to(step2()) .from(step2()) .on(ExitStatus.COMPLETED.getExitCode()).to(step3()) .from(step3()).end() .build(); &#125; private Step step1() &#123; return stepBuilderFactory.get("step1") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤ä¸€æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step2() &#123; return stepBuilderFactory.get("step2") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤äºŒæ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step3() &#123; return stepBuilderFactory.get("step3") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤ä¸‰æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125;&#125;multiStepJob()æ–¹æ³•çš„å«ä¹‰æ˜¯ï¼šmultiStepJob2ä»»åŠ¡å…ˆæ‰§è¡Œstep1ï¼Œå½“step1çŠ¶æ€ä¸ºå®Œæˆæ—¶ï¼ŒæŽ¥ç€æ‰§è¡Œstep2ï¼Œå½“step2çš„çŠ¶æ€ä¸ºå®Œæˆæ—¶ï¼ŒæŽ¥ç€æ‰§è¡Œstep3ã€‚ExitStatus.COMPLETEDå¸¸é‡è¡¨ç¤ºä»»åŠ¡é¡ºåˆ©æ‰§è¡Œå®Œæ¯•ï¼Œæ­£å¸¸é€€å‡ºï¼Œè¯¥ç±»è¿˜åŒ…å«ä»¥ä¸‹å‡ ç§é€€å‡ºçŠ¶æ€ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041public class ExitStatus implements Serializable, Comparable&lt;ExitStatus&gt; &#123; /** * Convenient constant value representing unknown state - assumed not * continuable. */ public static final ExitStatus UNKNOWN = new ExitStatus("UNKNOWN"); /** * Convenient constant value representing continuable state where processing * is still taking place, so no further action is required. Used for * asynchronous execution scenarios where the processing is happening in * another thread or process and the caller is not required to wait for the * result. */ public static final ExitStatus EXECUTING = new ExitStatus("EXECUTING"); /** * Convenient constant value representing finished processing. */ public static final ExitStatus COMPLETED = new ExitStatus("COMPLETED"); /** * Convenient constant value representing job that did no processing (e.g. * because it was already complete). */ public static final ExitStatus NOOP = new ExitStatus("NOOP"); /** * Convenient constant value representing finished processing with an error. */ public static final ExitStatus FAILED = new ExitStatus("FAILED"); /** * Convenient constant value representing finished processing with * interrupted status. */ public static final ExitStatus STOPPED = new ExitStatus("STOPPED"); ...&#125;å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š12345678910112020-03-06 14:21:49.384 INFO 18745 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [FlowJob: [name=multiStepJob2]] launched with the following parameters: [&#123;&#125;]2020-03-06 14:21:49.427 INFO 18745 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step1]æ‰§è¡Œæ­¥éª¤ä¸€æ“ä½œã€‚ã€‚ã€‚2020-03-06 14:21:49.456 INFO 18745 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step1] executed in 29ms2020-03-06 14:21:49.501 INFO 18745 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step2]æ‰§è¡Œæ­¥éª¤äºŒæ“ä½œã€‚ã€‚ã€‚2020-03-06 14:21:49.527 INFO 18745 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step2] executed in 26ms2020-03-06 14:21:49.576 INFO 18745 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step3]æ‰§è¡Œæ­¥éª¤ä¸‰æ“ä½œã€‚ã€‚ã€‚2020-03-06 14:21:49.604 INFO 18745 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step3] executed in 28ms2020-03-06 14:21:49.629 INFO 18745 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [FlowJob: [name=multiStepJob2]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 238msFlowçš„ç”¨æ³•Flowçš„ä½œç”¨å°±æ˜¯å¯ä»¥å°†å¤šä¸ªæ­¥éª¤Stepç»„åˆåœ¨ä¸€èµ·ç„¶åŽå†ç»„è£…åˆ°ä»»åŠ¡Jobä¸­ã€‚ä¸¾ä¸ªFlowçš„ä¾‹å­ï¼Œåœ¨jobåŒ…ä¸‹æ–°å»ºFlowJobDemoç±»ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849@Componentpublic class FlowJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job flowJob() &#123; return jobBuilderFactory.get("flowJob") .start(flow()) .next(step3()) .end() .build(); &#125; private Step step1() &#123; return stepBuilderFactory.get("step1") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤ä¸€æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step2() &#123; return stepBuilderFactory.get("step2") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤äºŒæ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step3() &#123; return stepBuilderFactory.get("step3") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤ä¸‰æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; // åˆ›å»ºä¸€ä¸ªflowå¯¹è±¡ï¼ŒåŒ…å«è‹¥å¹²ä¸ªstep private Flow flow() &#123; return new FlowBuilder&lt;Flow&gt;("flow") .start(step1()) .next(step2()) .build(); &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡FlowBuilderå°†step1å’Œstep2ç»„åˆåœ¨ä¸€èµ·ï¼Œåˆ›å»ºäº†ä¸€ä¸ªåä¸ºflowçš„Flowï¼Œç„¶åŽå†å°†å…¶èµ‹ç»™ä»»åŠ¡Jobã€‚ä½¿ç”¨Flowå’ŒStepæž„å»ºJobçš„åŒºåˆ«æ˜¯ï¼ŒJobæµç¨‹ä¸­åŒ…å«Flowç±»åž‹çš„æ—¶å€™éœ€è¦åœ¨build()æ–¹æ³•å‰è°ƒç”¨end()æ–¹æ³•ã€‚å¯åŠ¨ç¨‹åºï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š12345678910112020-03-06 14:36:42.621 INFO 18865 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [FlowJob: [name=flowJob]] launched with the following parameters: [&#123;&#125;]2020-03-06 14:36:42.667 INFO 18865 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step1]æ‰§è¡Œæ­¥éª¤ä¸€æ“ä½œã€‚ã€‚ã€‚2020-03-06 14:36:42.697 INFO 18865 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step1] executed in 30ms2020-03-06 14:36:42.744 INFO 18865 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step2]æ‰§è¡Œæ­¥éª¤äºŒæ“ä½œã€‚ã€‚ã€‚2020-03-06 14:36:42.771 INFO 18865 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step2] executed in 27ms2020-03-06 14:36:42.824 INFO 18865 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step3]æ‰§è¡Œæ­¥éª¤ä¸‰æ“ä½œã€‚ã€‚ã€‚2020-03-06 14:36:42.850 INFO 18865 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step3] executed in 25ms2020-03-06 14:36:42.874 INFO 18865 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [FlowJob: [name=flowJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 245mså¹¶è¡Œæ‰§è¡Œä»»åŠ¡ä¸­çš„æ­¥éª¤é™¤äº†å¯ä»¥ä¸²è¡Œæ‰§è¡Œï¼ˆä¸€ä¸ªæŽ¥ç€ä¸€ä¸ªæ‰§è¡Œï¼‰å¤–ï¼Œè¿˜å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œå¹¶è¡Œæ‰§è¡Œåœ¨ç‰¹å®šçš„ä¸šåŠ¡éœ€æ±‚ä¸‹å¯ä»¥æä¾›ä»»åŠ¡æ‰§è¡Œæ•ˆçŽ‡ã€‚å°†ä»»åŠ¡å¹¶è¡ŒåŒ–åªéœ€ä¸¤ä¸ªç®€å•æ­¥éª¤ï¼šå°†æ­¥éª¤Stepè½¬æ¢ä¸ºFlowï¼›ä»»åŠ¡Jobä¸­æŒ‡å®šå¹¶è¡ŒFlowã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨jobåŒ…ä¸‹æ–°å»ºSplitJobDemoç±»ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455@Componentpublic class SplitJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Bean public Job splitJob() &#123; return jobBuilderFactory.get("splitJob") .start(flow1()) .split(new SimpleAsyncTaskExecutor()).add(flow2()) .end() .build(); &#125; private Step step1() &#123; return stepBuilderFactory.get("step1") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤ä¸€æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step2() &#123; return stepBuilderFactory.get("step2") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤äºŒæ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step3() &#123; return stepBuilderFactory.get("step3") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤ä¸‰æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Flow flow1() &#123; return new FlowBuilder&lt;Flow&gt;("flow1") .start(step1()) .next(step2()) .build(); &#125; private Flow flow2() &#123; return new FlowBuilder&lt;Flow&gt;("flow2") .start(step3()) .build(); &#125;&#125;ä¸Šé¢ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªFlowï¼šflow1ï¼ˆåŒ…å«step1å’Œstep2ï¼‰å’Œflow2ï¼ˆåŒ…å«step3ï¼‰ã€‚ç„¶åŽé€šè¿‡JobBuilderFactoryçš„splitæ–¹æ³•ï¼ŒæŒ‡å®šä¸€ä¸ªå¼‚æ­¥æ‰§è¡Œå™¨ï¼Œå°†flow1å’Œflow2å¼‚æ­¥æ‰§è¡Œï¼ˆä¹Ÿå°±æ˜¯å¹¶è¡Œï¼‰ã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°æ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š12345678910112020-03-06 15:25:43.602 INFO 19449 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [FlowJob: [name=splitJob]] launched with the following parameters: [&#123;&#125;]2020-03-06 15:25:43.643 INFO 19449 --- [cTaskExecutor-1] o.s.batch.core.job.SimpleStepHandler : Executing step: [step3]2020-03-06 15:25:43.650 INFO 19449 --- [cTaskExecutor-2] o.s.batch.core.job.SimpleStepHandler : Executing step: [step1]æ‰§è¡Œæ­¥éª¤ä¸‰æ“ä½œã€‚ã€‚ã€‚æ‰§è¡Œæ­¥éª¤ä¸€æ“ä½œã€‚ã€‚ã€‚2020-03-06 15:25:43.673 INFO 19449 --- [cTaskExecutor-2] o.s.batch.core.step.AbstractStep : Step: [step1] executed in 23ms2020-03-06 15:25:43.674 INFO 19449 --- [cTaskExecutor-1] o.s.batch.core.step.AbstractStep : Step: [step3] executed in 31ms2020-03-06 15:25:43.714 INFO 19449 --- [cTaskExecutor-2] o.s.batch.core.job.SimpleStepHandler : Executing step: [step2]æ‰§è¡Œæ­¥éª¤äºŒæ“ä½œã€‚ã€‚ã€‚2020-03-06 15:25:43.738 INFO 19449 --- [cTaskExecutor-2] o.s.batch.core.step.AbstractStep : Step: [step2] executed in 24ms2020-03-06 15:25:43.758 INFO 19449 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [FlowJob: [name=splitJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 146mså¯ä»¥çœ‹åˆ°step3å¹¶æ²¡æœ‰åœ¨step2åŽæ‰æ‰§è¡Œï¼Œè¯´æ˜Žæ­¥éª¤å·²ç»æ˜¯å¹¶è¡ŒåŒ–çš„ï¼ˆå¼€å¯å¹¶è¡ŒåŒ–åŽï¼Œå¹¶è¡Œçš„æ­¥éª¤æ‰§è¡Œé¡ºåºå¹¶ä¸èƒ½100%ç¡®å®šï¼Œå› ä¸ºçº¿ç¨‹è°ƒåº¦å…·æœ‰ä¸ç¡®å®šæ€§ï¼‰ã€‚ä»»åŠ¡å†³ç­–å™¨å†³ç­–å™¨çš„ä½œç”¨å°±æ˜¯å¯ä»¥æŒ‡å®šç¨‹åºåœ¨ä¸åŒçš„æƒ…å†µä¸‹è¿è¡Œä¸åŒçš„ä»»åŠ¡æµç¨‹ï¼Œæ¯”å¦‚ä»Šå¤©æ˜¯å‘¨æœ«ï¼Œåˆ™è®©ä»»åŠ¡æ‰§è¡Œstep1å’Œstep2ï¼Œå¦‚æžœæ˜¯å·¥ä½œæ—¥ï¼Œåˆ™ä¹‹å¿ƒstep1å’Œstep3ã€‚ä½¿ç”¨å†³ç­–å™¨å‰ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªå†³ç­–å™¨çš„å®žçŽ°ã€‚åœ¨cc.mrbird.batchåŒ…ä¸‹æ–°å»ºdecideråŒ…ï¼Œç„¶åŽåˆ›å»ºMyDeciderç±»ï¼Œå®žçŽ°JobExecutionDecideræŽ¥å£ï¼š1234567891011121314@Componentpublic class MyDecider implements JobExecutionDecider &#123; @Override public FlowExecutionStatus decide(JobExecution jobExecution, StepExecution stepExecution) &#123; LocalDate now = LocalDate.now(); DayOfWeek dayOfWeek = now.getDayOfWeek(); if (dayOfWeek == DayOfWeek.SATURDAY || dayOfWeek == DayOfWeek.SUNDAY) &#123; return new FlowExecutionStatus("weekend"); &#125; else &#123; return new FlowExecutionStatus("workingDay"); &#125; &#125;&#125;MyDeciderå®žçŽ°JobExecutionDecideræŽ¥å£çš„decideæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›žFlowExecutionStatusã€‚ä¸Šé¢çš„é€»è¾‘æ˜¯ï¼šåˆ¤æ–­ä»Šå¤©æ˜¯å¦æ˜¯å‘¨æœ«ï¼Œå¦‚æžœæ˜¯ï¼Œè¿”å›žFlowExecutionStatus(&quot;weekend&quot;)çŠ¶æ€ï¼Œå¦åˆ™è¿”å›žFlowExecutionStatus(&quot;workingDay&quot;)çŠ¶æ€ã€‚ä¸‹é¢æ¼”ç¤ºå¦‚ä½•åœ¨ä»»åŠ¡Jobé‡Œä½¿ç”¨å†³ç­–å™¨ã€‚åœ¨jobåŒ…ä¸‹æ–°å»ºDeciderJobDemoï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354@Componentpublic class DeciderJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private MyDecider myDecider; @Bean public Job deciderJob() &#123; return jobBuilderFactory.get("deciderJob") .start(step1()) .next(myDecider) .from(myDecider).on("weekend").to(step2()) .from(myDecider).on("workingDay").to(step3()) .from(step3()).on("*").to(step4()) .end() .build(); &#125; private Step step1() &#123; return stepBuilderFactory.get("step1") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤ä¸€æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step2() &#123; return stepBuilderFactory.get("step2") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤äºŒæ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step3() &#123; return stepBuilderFactory.get("step3") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤ä¸‰æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125; private Step step4() &#123; return stepBuilderFactory.get("step4") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("æ‰§è¡Œæ­¥éª¤å››æ“ä½œã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build(); &#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ³¨å…¥äº†è‡ªå®šä¹‰å†³ç­–å™¨MyDeciderï¼Œç„¶åŽåœ¨jobDecider()æ–¹æ³•é‡Œä½¿ç”¨äº†è¯¥å†³ç­–å™¨ï¼š1234567891011@Beanpublic Job deciderJob() &#123; return jobBuilderFactory.get("deciderJob") .start(step1()) .next(myDecider) .from(myDecider).on("weekend").to(step2()) .from(myDecider).on("workingDay").to(step3()) .from(step3()).on("*").to(step4()) .end() .build();&#125;è¿™æ®µä»£ç çš„å«ä¹‰æ˜¯ï¼šä»»åŠ¡deciderJobé¦–å…ˆæ‰§è¡Œstep1ï¼Œç„¶åŽæŒ‡å®šè‡ªå®šä¹‰å†³ç­–å™¨ï¼Œå¦‚æžœå†³ç­–å™¨è¿”å›žweekendï¼Œé‚£ä¹ˆæ‰§è¡Œstep2ï¼Œå¦‚æžœå†³ç­–å™¨è¿”å›žworkingDayï¼Œé‚£ä¹ˆæ‰§è¡Œstep3ã€‚å¦‚æžœæ‰§è¡Œäº†step3ï¼Œé‚£ä¹ˆæ— è®ºstep3çš„ç»“æžœæ˜¯ä»€ä¹ˆï¼Œéƒ½å°†æ‰§è¡Œstep4ã€‚å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š12345678910112020-03-06 16:09:10.541 INFO 19873 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [FlowJob: [name=deciderJob]] launched with the following parameters: [&#123;&#125;]2020-03-06 16:09:10.609 INFO 19873 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step1]æ‰§è¡Œæ­¥éª¤ä¸€æ“ä½œã€‚ã€‚ã€‚2020-03-06 16:09:10.641 INFO 19873 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step1] executed in 32ms2020-03-06 16:09:10.692 INFO 19873 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step3]æ‰§è¡Œæ­¥éª¤ä¸‰æ“ä½œã€‚ã€‚ã€‚2020-03-06 16:09:10.723 INFO 19873 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step3] executed in 31ms2020-03-06 16:09:10.769 INFO 19873 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [step4]æ‰§è¡Œæ­¥éª¤å››æ“ä½œã€‚ã€‚ã€‚2020-03-06 16:09:10.797 INFO 19873 --- [ main] o.s.batch.core.step.AbstractStep : Step: [step4] executed in 27ms2020-03-06 16:09:10.818 INFO 19873 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [FlowJob: [name=deciderJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 256mså› ä¸ºä»Šå¤©æ˜¯2020å¹´03æœˆ06æ—¥æ˜ŸæœŸäº”ï¼Œæ˜¯å·¥ä½œæ—¥ï¼Œæ‰€ä»¥ä»»åŠ¡æ‰§è¡Œäº†step1ã€step3å’Œstep4ã€‚ä»»åŠ¡åµŒå¥—ä»»åŠ¡Jobé™¤äº†å¯ä»¥ç”±Stepæˆ–è€…Flowæž„æˆå¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†å¤šä¸ªä»»åŠ¡Jobè½¬æ¢ä¸ºç‰¹æ®Šçš„Stepï¼Œç„¶åŽå†èµ‹ç»™å¦ä¸€ä¸ªä»»åŠ¡Jobï¼Œè¿™å°±æ˜¯ä»»åŠ¡çš„åµŒå¥—ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨jobåŒ…ä¸‹æ–°å»ºNestedJobDemoç±»ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768@Componentpublic class NestedJobDemo &#123; @Autowired private JobBuilderFactory jobBuilderFactory; @Autowired private StepBuilderFactory stepBuilderFactory; @Autowired private JobLauncher jobLauncher; @Autowired private JobRepository jobRepository; @Autowired private PlatformTransactionManager platformTransactionManager; // çˆ¶ä»»åŠ¡ @Bean public Job parentJob() &#123; return jobBuilderFactory.get("parentJob") .start(childJobOneStep()) .next(childJobTwoStep()) .build(); &#125; // å°†ä»»åŠ¡è½¬æ¢ä¸ºç‰¹æ®Šçš„æ­¥éª¤ private Step childJobOneStep() &#123; return new JobStepBuilder(new StepBuilder("childJobOneStep")) .job(childJobOne()) .launcher(jobLauncher) .repository(jobRepository) .transactionManager(platformTransactionManager) .build(); &#125; // å°†ä»»åŠ¡è½¬æ¢ä¸ºç‰¹æ®Šçš„æ­¥éª¤ private Step childJobTwoStep() &#123; return new JobStepBuilder(new StepBuilder("childJobTwoStep")) .job(childJobTwo()) .launcher(jobLauncher) .repository(jobRepository) .transactionManager(platformTransactionManager) .build(); &#125; // å­ä»»åŠ¡ä¸€ private Job childJobOne() &#123; return jobBuilderFactory.get("childJobOne") .start( stepBuilderFactory.get("childJobOneStep") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("å­ä»»åŠ¡ä¸€æ‰§è¡Œæ­¥éª¤ã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build() ).build(); &#125; // å­ä»»åŠ¡äºŒ private Job childJobTwo() &#123; return jobBuilderFactory.get("childJobTwo") .start( stepBuilderFactory.get("childJobTwoStep") .tasklet((stepContribution, chunkContext) -&gt; &#123; System.out.println("å­ä»»åŠ¡äºŒæ‰§è¡Œæ­¥éª¤ã€‚ã€‚ã€‚"); return RepeatStatus.FINISHED; &#125;).build() ).build(); &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡childJobOne()å’ŒchildJobTwo()æ–¹æ³•åˆ›å»ºäº†ä¸¤ä¸ªä»»åŠ¡Jobï¼Œè¿™é‡Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå‰é¢éƒ½ä»‹ç»è¿‡ã€‚å…³é”®åœ¨äºŽchildJobOneStep()æ–¹æ³•å’ŒchildJobTwoStep()æ–¹æ³•ã€‚åœ¨childJobOneStep()æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡JobStepBuilderæž„å»ºäº†ä¸€ä¸ªåç§°ä¸ºchildJobOneStepçš„Stepï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»»åŠ¡åž‹Stepçš„æž„é€ å·¥åŽ‚ï¼Œå¯ä»¥å°†ä»»åŠ¡è½¬æ¢ä¸ºâ€œç‰¹æ®Šâ€çš„æ­¥éª¤ã€‚åœ¨æž„å»ºè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¼ å…¥ä»»åŠ¡æ‰§è¡Œå™¨JobLauncherã€ä»»åŠ¡ä»“åº“JobRepositoryå’Œäº‹åŠ¡ç®¡ç†å™¨PlatformTransactionManagerã€‚å°†ä»»åŠ¡è½¬æ¢ä¸ºç‰¹æ®Šçš„æ­¥éª¤åŽï¼Œå°†å…¶èµ‹ç»™çˆ¶ä»»åŠ¡parentJobå³å¯ï¼Œæµç¨‹å’Œå‰é¢ä»‹ç»çš„ä¸€è‡´ã€‚é…ç½®å¥½åŽï¼Œå¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415162020-03-06 16:58:39.771 INFO 21588 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=parentJob]] launched with the following parameters: [&#123;&#125;]2020-03-06 16:58:39.812 INFO 21588 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [childJobOneStep]2020-03-06 16:58:39.866 INFO 21588 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=childJobOne]] launched with the following parameters: [&#123;&#125;]2020-03-06 16:58:39.908 INFO 21588 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [childJobOneStep]å­ä»»åŠ¡ä¸€æ‰§è¡Œæ­¥éª¤ã€‚ã€‚ã€‚2020-03-06 16:58:39.940 INFO 21588 --- [ main] o.s.batch.core.step.AbstractStep : Step: [childJobOneStep] executed in 32ms2020-03-06 16:58:39.960 INFO 21588 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=childJobOne]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 86ms2020-03-06 16:58:39.983 INFO 21588 --- [ main] o.s.batch.core.step.AbstractStep : Step: [childJobOneStep] executed in 171ms2020-03-06 16:58:40.019 INFO 21588 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [childJobTwoStep]2020-03-06 16:58:40.067 INFO 21588 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=childJobTwo]] launched with the following parameters: [&#123;&#125;]2020-03-06 16:58:40.102 INFO 21588 --- [ main] o.s.batch.core.job.SimpleStepHandler : Executing step: [childJobTwoStep]å­ä»»åŠ¡äºŒæ‰§è¡Œæ­¥éª¤ã€‚ã€‚ã€‚2020-03-06 16:58:40.130 INFO 21588 --- [ main] o.s.batch.core.step.AbstractStep : Step: [childJobTwoStep] executed in 28ms2020-03-06 16:58:40.152 INFO 21588 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=childJobTwo]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 75ms2020-03-06 16:58:40.157 INFO 21588 --- [ main] o.s.batch.core.step.AbstractStep : Step: [childJobTwoStep] executed in 138ms2020-03-06 16:58:40.177 INFO 21588 --- [ main] o.s.b.c.l.support.SimpleJobLauncher : Job: [SimpleJob: [name=parentJob]] completed with the following parameters: [&#123;&#125;] and the following status: [COMPLETED] in 398msæœ¬èŠ‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/67.spring-batch-startã€‚]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>Spring Batch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootæ•´åˆWebSocket]]></title>
    <url>%2FSpring-Boot%E6%95%B4%E5%90%88WebSocket.html</url>
    <content type="text"><![CDATA[æœ¬èŠ‚ç®€å•ä»‹ç»ä¸‹å¦‚ä½•åœ¨Spring Bootå¼•å…¥WebSocketï¼Œå®žçŽ°ç®€å•çš„å®¢æˆ·ç«¯ä¸ŽæœåŠ¡ç«¯å»ºç«‹é•¿è¿žæŽ¥å¹¶äº’å‘é€æ–‡æœ¬æ¶ˆæ¯ã€‚æ¡†æž¶æ­å»ºæ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼ŒartifactIdä¸ºspring-boot-websocket-socketjsï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šé¡¹ç›®çš„pomå†…å®¹å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.2.5.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-websocket-socketjs&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;spring-boot-websocket-socketjs&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-websocket&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;å¼•å…¥äº†spring-boot-starter-websocketå’Œspring-boot-starter-webä¾èµ–ã€‚æž„å»ºæœåŠ¡ç«¯åœ¨cc.mrbird.socketç›®å½•ä¸‹æ–°å»ºhandleråŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºMyStringWebSocketHandlerç»§æ‰¿TextWebSocketHandlerï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243@Componentpublic class MyStringWebSocketHandler extends TextWebSocketHandler &#123; private Logger log = LoggerFactory.getLogger(this.getClass()); @Override public void afterConnectionEstablished(WebSocketSession session) &#123; log.info("å’Œå®¢æˆ·ç«¯å»ºç«‹è¿žæŽ¥"); &#125; @Override public void handleTransportError(WebSocketSession session, Throwable exception) throws Exception &#123; session.close(CloseStatus.SERVER_ERROR); log.error("è¿žæŽ¥å¼‚å¸¸", exception); &#125; @Override public void afterConnectionClosed(WebSocketSession session, CloseStatus status) throws Exception &#123; super.afterConnectionClosed(session, status); log.info("å’Œå®¢æˆ·ç«¯æ–­å¼€è¿žæŽ¥"); &#125; @Override protected void handleTextMessage(WebSocketSession session, TextMessage message) throws Exception &#123; // èŽ·å–åˆ°å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯ String receiveMessage = message.getPayload(); log.info(receiveMessage); // å‘é€æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ session.sendMessage(new TextMessage(fakeAi(receiveMessage))); // å…³é—­è¿žæŽ¥ // session.close(CloseStatus.NORMAL); &#125; private static String fakeAi(String input) &#123; if (input == null || "".equals(input)) &#123; return "ä½ è¯´ä»€ä¹ˆï¼Ÿæ²¡å¬æ¸…ï¸Ž"; &#125; return input.replace('ä½ ', 'æˆ‘') .replace("å—", "") .replace('?', '!') .replace('ï¼Ÿ', 'ï¼'); &#125;&#125;è¯¥ç±»é‡å†™äº†çˆ¶ç±»AbstractWebSocketHandlerçš„å››ä¸ªæ–¹æ³•ï¼šafterConnectionEstablishedï¼Œå’Œå®¢æˆ·ç«¯é“¾æŽ¥æˆåŠŸçš„æ—¶å€™è§¦å‘è¯¥æ–¹æ³•ï¼›handleTransportErrorï¼Œå’Œå®¢æˆ·ç«¯è¿žæŽ¥å¤±è´¥çš„æ—¶å€™è§¦å‘è¯¥æ–¹æ³•ï¼›afterConnectionClosedï¼Œå’Œå®¢æˆ·ç«¯æ–­å¼€è¿žæŽ¥çš„æ—¶å€™è§¦å‘è¯¥æ–¹æ³•ï¼›handleTextMessageï¼Œå’Œå®¢æˆ·ç«¯å»ºç«‹è¿žæŽ¥åŽï¼Œå¤„ç†å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ã€‚WebSocketSessionå¯¹è±¡ä»£è¡¨æ¯ä¸ªå®¢æˆ·ç«¯ä¼šè¯ï¼ŒåŒ…å«è®¸å¤šå®žç”¨æ–¹æ³•ï¼šæ–¹æ³•è§åçŸ¥æ„ï¼Œå°±ä¸èµ˜è¿°äº†ã€‚æ­¤å¤–ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›®çš„æ˜¯å®žçŽ°å’Œå®¢æˆ·ç«¯çš„é€šä¿¡ï¼Œå¹¶ä¸”å†…å®¹ä¸ºæ–‡æœ¬å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§æ‰¿çš„æ˜¯TextWebSocketHandlerï¼›å¦‚æžœä¼ è¾“çš„æ˜¯äºŒè¿›åˆ¶å†…å®¹ï¼Œåˆ™å¯ä»¥ç»§æ‰¿BinaryWebSocketHandlerï¼Œæ›´å¤šä¿¡æ¯å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹WebSocketHandlerçš„å­ç±»ã€‚æŽ¥ç€åœ¨cc.mrbird.socketç›®å½•ä¸‹æ–°å»ºconfigureåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºWebSocketServerConfigureé…ç½®ç±»ï¼š123456789101112@Configuration@EnableWebSocketpublic class WebSocketServerConfigure implements WebSocketConfigurer &#123; @Autowired private MyStringWebSocketHandler myStringWebSocketHandler; @Override public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) &#123; registry.addHandler(myStringWebSocketHandler, "/connect").withSockJS(); &#125;&#125;@EnableWebSocketç”¨äºŽå¼€å¯WebSocketç›¸å…³åŠŸèƒ½ï¼Œæˆ‘ä»¬æ³¨å…¥äº†ä¸Šé¢åˆ›å»ºçš„MyStringWebSocketHandlerï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°äº†WebSocketHandlerRegistryã€‚ä¸Šé¢ä»£ç çš„å«ä¹‰æ˜¯ï¼Œå½“å®¢æˆ·ç«¯é€šè¿‡/connecturlå’ŒæœåŠ¡ç«¯è¿žæŽ¥é€šä¿¡æ—¶ï¼Œä½¿ç”¨MyStringWebSocketHandlerå¤„ç†ä¼šè¯ã€‚withSockJSçš„å«ä¹‰æ˜¯ï¼Œé€šä¿¡çš„å®¢æˆ·ç«¯æ˜¯é€šè¿‡SockJSå®žçŽ°çš„ï¼Œä¸‹é¢ä¼šä»‹ç»åˆ°ã€‚æž„å»ºå®¢æˆ·ç«¯SockJSæ˜¯ä¸€ä¸ªJSæ’ä»¶ï¼Œç”¨äºŽæž„å»ºWebSocketï¼Œå…¼å®¹æ€§å¥½ã€‚åœ¨resourcesç›®å½•ä¸‹æ–°å»ºstaticåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºclient.htmlï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;WebSocketå®¢æˆ·ç«¯&lt;/title&gt; &lt;script src="https://cdn.bootcss.com/sockjs-client/0.3.4/sockjs.min.js"&gt;&lt;/script&gt; &lt;link href="https://cdn.bootcss.com/twitter-bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet"&gt;&lt;/head&gt;&lt;body&gt;&lt;style&gt; .jumbotron &#123; width: 100%; &#125; #text &#123; height: 3rem; font-size: 1rem; line-height: 3rem; margin: 1rem; &#125; .btn &#123; margin-right: 5px; &#125; #connect &#123; margin-left: 1rem; &#125; #log &#123; margin: 1rem 0 0 1rem; &#125;&lt;/style&gt;&lt;div class="container"&gt; &lt;div class="row"&gt; &lt;div class="jumbotron"&gt; &lt;input type="text" placeholder="è¯·è¾“å…¥ä½ æƒ³ä¼ è¾“çš„å†…å®¹" id="text" class="col-lg-12"/&gt; &lt;input type="button" value="è¿žæŽ¥" class="btn btn-info" id="connect" onclick="connect()"/&gt; &lt;input type="button" value="å‘é€" class="btn btn-success" id="sent" disabled="disabled" onclick="sent()"/&gt; &lt;input type="button" value="æ–­å¼€" class="btn btn-danger" id="disconnect" disabled="disabled" onclick="disconnect()"/&gt; &lt;div id="log"&gt; &lt;p&gt;èŠå¤©è®°å½•:&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;script type="text/javascript"&gt; let text = document.querySelector('#text'); let connectBtn = document.querySelector("#connect"); let sentBtn = document.querySelector("#sent"); let disconnectBtn = document.querySelector("#disconnect"); let logDiv = document.querySelector("#log"); let ws = null; function connect() &#123; let targetUri = "/connect"; ws = new SockJS(targetUri); ws.onopen = function () &#123; setConnected(true); log('å’ŒæœåŠ¡ç«¯è¿žæŽ¥æˆåŠŸï¼'); &#125;; ws.onmessage = function (event) &#123; log('æœåŠ¡ç«¯è¯´ï¼š' + event.data); &#125;; ws.onclose = function () &#123; setConnected(false); log('å’ŒæœåŠ¡ç«¯æ–­å¼€è¿žæŽ¥ï¼') &#125; &#125; function sent() &#123; if (ws != null) &#123; ws.send(text.value); log('å®¢æˆ·ç«¯è¯´ï¼š' + text.value); &#125; else &#123; log('è¯·å…ˆå»ºç«‹è¿žæŽ¥ï¼') &#125; &#125; function disconnect() &#123; if (ws != null) &#123; ws.close(); ws = null; &#125; setConnected(false); &#125; function log(value) &#123; let content = document.createElement('p'); content.innerHTML = value; logDiv.appendChild(content); text.value = ''; &#125; function setConnected(connected) &#123; connectBtn.disabled = connected; disconnectBtn.disabled = !connected; sentBtn.disabled = !connected; &#125;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;htmlï¼Œcssé‚£äº›éƒ½ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯æˆ‘ä»¬å¼•å…¥äº†SockJSåº“ã€‚åœ¨connect()æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡new SockJS(/connect)å’Œä¸Šé¢çš„æœåŠ¡ç«¯å»ºç«‹äº†Socketé€šä¿¡ã€‚SockJSå¯¹è±¡åŒ…å«å‡ ä¸ªå¸¸ç”¨çš„å®žç”¨æ–¹æ³•ï¼šonopenï¼Œå’ŒæœåŠ¡ç«¯è®²äº†è¿žæŽ¥åŽçš„å›žè°ƒæ–¹æ³•ï¼›onmessageï¼ŒæœåŠ¡ç«¯è¿”å›žæ¶ˆæ¯æ—¶çš„å›žè°ƒæ–¹æ³•ï¼›oncloseï¼Œå’ŒæœåŠ¡ç«¯æ–­å¼€è¿žæŽ¥çš„å›žè°ƒæ–¹æ³•ï¼›sendï¼Œå‘é€æ¶ˆæ¯ç»™æœåŠ¡ç«¯ï¼›closeï¼Œæ–­å¼€å’ŒæœåŠ¡ç«¯çš„è¿žæŽ¥ã€‚ä¸Šé¢çš„JSè¾ƒä¸ºç®€å•ï¼Œå…¶ä»–é€»è¾‘è‡ªå·±çœ‹çœ‹å§ã€‚é€šä¿¡æµ‹è¯•å¯åŠ¨é¡¹ç›®ï¼Œæµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8080/client.htmlï¼šæºç è¿žæŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/76.spring-boot-websocket-socketjsã€‚]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>WebSocket</tag>
        <tag>SockJS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡ªå®šä¹‰Spring Boot Starter]]></title>
    <url>%2F%E8%87%AA%E5%AE%9A%E4%B9%89Spring-Boot-Starter.html</url>
    <content type="text"><![CDATA[]]></content>
      <tags>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[FEBS Cloudå¸¸è§é—®é¢˜æ±‡æ€»]]></title>
    <url>%2FFEBS-Cloud%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB.html</url>
    <content type="text"><![CDATA[è®°å½•ç¾¤å‹çš„é«˜é¢‘é—®ç‚¹ã€‚å¦‚éœ€è¡¥å……ï¼Œæ¬¢è¿Žåœ¨ä¸‹æ–¹ç•™è¨€ã€‚ç‚¹å‡»ç™»å½•é¡µé¢å¼¹çª—é—®é¢˜æœ‰ä¸¤ç§æƒ…å†µä¼šå¯¼è‡´è¿™ä¸ªé—®é¢˜ï¼šåŽŸå› ä¸€ï¼šè¯·æ±‚å¤´æºå¸¦çš„clientä¿¡æ¯ä¸æ­£ç¡®ï¼›è§£å†³åŠžæ³•ï¼šä¿®æ”¹febs-cloud-webå·¥ç¨‹srcç›®å½•ä¸‹setting.jsæ–‡ä»¶çš„authorizationValueå€¼ï¼šè¿™ä¸ªå€¼æ€Žä¹ˆæ¥çš„ï¼ŸæŸ¥çœ‹æ•°æ®åº“febs_cloud_baseä¸‹çš„oauth_client_detailsè¡¨ï¼šæ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨client_idä¸ºfebsè¿™ä¸ªclientï¼Œå®ƒçš„client_secertæ˜¯ç»è¿‡BCRYåŠ å¯†çš„ï¼ŒåŽŸå¯†ç å€¼å¯ä»¥åŒåŠŸèƒ½origin_secretæŸ¥çœ‹ï¼Œç”±ä¸Šå›¾å¯çŸ¥ï¼Œæ˜¯123456ï¼Œç„¶åŽåˆ°http://tool.chinaz.com/Tools/Base64.aspxç½‘ç«™ï¼šBase64åŠ å¯†å¾—åˆ°çš„å€¼ZmViczoxMjM0NTY=å‰é¢æ‹¼æŽ¥ä¸ŠBasicç©ºæ ¼å°±æ˜¯æœ€ç»ˆauthorizationValueå€¼ï¼šBasic ZmViczoxMjM0NTY=ã€‚åŽŸå› äºŒï¼šæ•°æ®åº“ä¸­æ²¡æœ‰oauth_client_detailsè¿™å¼ è¡¨ã€‚è§£å†³åŠžæ³•ï¼šæ²¡æœ‰è¿™å¼ è¡¨çš„åŽŸå› å¾ˆç®€å•ï¼Œoauth_client_detailsè¡¨çš„additional_infoå­—æ®µé•¿åº¦ä¸º4096ï¼Œ5.7ç‰ˆæœ¬ä»¥ä¸‹çš„MySQLä¸æ”¯æŒï¼šæ‰€ä»¥è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥æ‰‹åŠ¨åœ¨SQLä¸­å°†oauth_client_detailsè¡¨çš„additional_infoå­—æ®µé•¿åº¦ä¿®æ”¹ä¸º500ï¼Œç„¶åŽé‡æ–°å¯¼å…¥ï¼›æˆ–è€…å°†æ‚¨çš„MySQLå‡çº§åˆ°5.7ä»¥ä¸Šçš„ç‰ˆæœ¬ã€‚æ•°æ®æºä¸å­˜åœ¨é—®é¢˜æ¯”å¦‚åœ¨å¯åŠ¨febs-authé¡¹ç›®çš„æ—¶å€™ï¼ŒæŽ§åˆ¶å°æŠ›å‡ºè¯·æ£€æŸ¥æ•°æ®æºä¹‹ç±»çš„é—®é¢˜ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156org.springframework.context.ApplicationContextException: Unable to start web server; nested exception is org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:156) at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:544) at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:141) at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:747) at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397) at org.springframework.boot.SpringApplication.run(SpringApplication.java:315) at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226) at org.springframework.boot.SpringApplication.run(SpringApplication.java:1215) at cc.mrbird.febs.auth.FebsAuthApplication.main(FebsAuthApplication.java:25)Caused by: org.springframework.boot.web.server.WebServerException: Unable to start embedded Tomcat at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:126) at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.&lt;init&gt;(TomcatWebServer.java:88) at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getTomcatWebServer(TomcatServletWebServerFactory.java:438) at org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory.getWebServer(TomcatServletWebServerFactory.java:191) at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.createWebServer(ServletWebServerApplicationContext.java:180) at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.onRefresh(ServletWebServerApplicationContext.java:153) ... 8 common frames omittedCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;servletEndpointRegistrar&apos; defined in class path resource [org/springframework/boot/actuate/autoconfigure/endpoint/web/ServletEndpointManagementContextConfiguration$WebMvcServletEndpointManagementContextConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.boot.actuate.endpoint.web.ServletEndpointRegistrar]: Factory method &apos;servletEndpointRegistrar&apos; threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;healthEndpoint&apos; defined in class path resource [org/springframework/boot/actuate/autoconfigure/health/HealthEndpointConfiguration.class]: Unsatisfied dependency expressed through method &apos;healthEndpoint&apos; parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;healthContributorRegistry&apos; defined in class path resource [org/springframework/boot/actuate/autoconfigure/health/HealthEndpointConfiguration.class]: Unsatisfied dependency expressed through method &apos;healthContributorRegistry&apos; parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthContributorAutoConfiguration&apos;: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;dataSource&apos; defined in class path resource [com/baomidou/dynamic/datasource/spring/boot/autoconfigure/DynamicDataSourceAutoConfiguration.class]: Invocation of init method failed; nested exception is java.lang.RuntimeException: dynamic-datasource Please check the setting of primary at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:645) at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:625) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1338) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1177) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:557) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517) at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:323) at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:321) at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:207) at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:211) at org.springframework.boot.web.servlet.ServletContextInitializerBeans.getOrderedBeansOfType(ServletContextInitializerBeans.java:202) at org.springframework.boot.web.servlet.ServletContextInitializerBeans.addServletContextInitializerBeans(ServletContextInitializerBeans.java:96) at org.springframework.boot.web.servlet.ServletContextInitializerBeans.&lt;init&gt;(ServletContextInitializerBeans.java:85) at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.getServletContextInitializerBeans(ServletWebServerApplicationContext.java:253) at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.selfInitialize(ServletWebServerApplicationContext.java:227) at org.springframework.boot.web.embedded.tomcat.TomcatStarter.onStartup(TomcatStarter.java:53) at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5135) at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:183) at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1384) at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1374) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75) at java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:134) at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:909) at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:841) at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:183) at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1384) at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1374) at java.util.concurrent.FutureTask.run(FutureTask.java:266) at org.apache.tomcat.util.threads.InlineExecutorService.execute(InlineExecutorService.java:75) at java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:134) at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:909) at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:262) at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:183) at org.apache.catalina.core.StandardService.startInternal(StandardService.java:421) at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:183) at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:930) at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:183) at org.apache.catalina.startup.Tomcat.start(Tomcat.java:459) at org.springframework.boot.web.embedded.tomcat.TomcatWebServer.initialize(TomcatWebServer.java:107) ... 13 common frames omittedCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.boot.actuate.endpoint.web.ServletEndpointRegistrar]: Factory method &apos;servletEndpointRegistrar&apos; threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;healthEndpoint&apos; defined in class path resource [org/springframework/boot/actuate/autoconfigure/health/HealthEndpointConfiguration.class]: Unsatisfied dependency expressed through method &apos;healthEndpoint&apos; parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;healthContributorRegistry&apos; defined in class path resource [org/springframework/boot/actuate/autoconfigure/health/HealthEndpointConfiguration.class]: Unsatisfied dependency expressed through method &apos;healthContributorRegistry&apos; parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthContributorAutoConfiguration&apos;: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;dataSource&apos; defined in class path resource [com/baomidou/dynamic/datasource/spring/boot/autoconfigure/DynamicDataSourceAutoConfiguration.class]: Invocation of init method failed; nested exception is java.lang.RuntimeException: dynamic-datasource Please check the setting of primary at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185) at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:640) ... 53 common frames omittedCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;healthEndpoint&apos; defined in class path resource [org/springframework/boot/actuate/autoconfigure/health/HealthEndpointConfiguration.class]: Unsatisfied dependency expressed through method &apos;healthEndpoint&apos; parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;healthContributorRegistry&apos; defined in class path resource [org/springframework/boot/actuate/autoconfigure/health/HealthEndpointConfiguration.class]: Unsatisfied dependency expressed through method &apos;healthContributorRegistry&apos; parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthContributorAutoConfiguration&apos;: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;dataSource&apos; defined in class path resource [com/baomidou/dynamic/datasource/spring/boot/autoconfigure/DynamicDataSourceAutoConfiguration.class]: Invocation of init method failed; nested exception is java.lang.RuntimeException: dynamic-datasource Please check the setting of primary at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:787) at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:528) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1338) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1177) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:557) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517) at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:323) at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:321) at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1108) at org.springframework.boot.actuate.endpoint.annotation.EndpointDiscoverer.createEndpointBean(EndpointDiscoverer.java:143) at org.springframework.boot.actuate.endpoint.annotation.EndpointDiscoverer.createEndpointBeans(EndpointDiscoverer.java:133) at org.springframework.boot.actuate.endpoint.annotation.EndpointDiscoverer.discoverEndpoints(EndpointDiscoverer.java:122) at org.springframework.boot.actuate.endpoint.annotation.EndpointDiscoverer.getEndpoints(EndpointDiscoverer.java:116) at org.springframework.boot.actuate.autoconfigure.endpoint.web.ServletEndpointManagementContextConfiguration$WebMvcServletEndpointManagementContextConfiguration.servletEndpointRegistrar(ServletEndpointManagementContextConfiguration.java:65) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154) ... 54 common frames omittedCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;healthContributorRegistry&apos; defined in class path resource [org/springframework/boot/actuate/autoconfigure/health/HealthEndpointConfiguration.class]: Unsatisfied dependency expressed through method &apos;healthContributorRegistry&apos; parameter 0; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthContributorAutoConfiguration&apos;: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;dataSource&apos; defined in class path resource [com/baomidou/dynamic/datasource/spring/boot/autoconfigure/DynamicDataSourceAutoConfiguration.class]: Invocation of init method failed; nested exception is java.lang.RuntimeException: dynamic-datasource Please check the setting of primary at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:787) at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:528) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1338) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1177) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:557) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517) at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:323) at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:321) at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1287) at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1207) at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:874) at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:778) ... 74 common frames omittedCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name &apos;org.springframework.boot.actuate.autoconfigure.jdbc.DataSourceHealthContributorAutoConfiguration&apos;: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;dataSource&apos; defined in class path resource [com/baomidou/dynamic/datasource/spring/boot/autoconfigure/DynamicDataSourceAutoConfiguration.class]: Invocation of init method failed; nested exception is java.lang.RuntimeException: dynamic-datasource Please check the setting of primary at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:787) at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:226) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1358) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1204) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:557) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517) at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:323) at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:321) at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:400) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1338) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1177) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:557) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517) at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:323) at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:321) at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) at org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1503) at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1467) at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeans(DefaultListableBeanFactory.java:1386) at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1245) at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1207) at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:874) at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:778) ... 88 common frames omittedCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;dataSource&apos; defined in class path resource [com/baomidou/dynamic/datasource/spring/boot/autoconfigure/DynamicDataSourceAutoConfiguration.class]: Invocation of init method failed; nested exception is java.lang.RuntimeException: dynamic-datasource Please check the setting of primary at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1803) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:595) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517) at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:323) at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:321) at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276) at org.springframework.beans.factory.support.DefaultListableBeanFactory.addCandidateEntry(DefaultListableBeanFactory.java:1503) at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1467) at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveMultipleBeans(DefaultListableBeanFactory.java:1386) at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1245) at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1207) at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:874) at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:778) ... 114 common frames omittedCaused by: java.lang.RuntimeException: dynamic-datasource Please check the setting of primary at com.baomidou.dynamic.datasource.DynamicRoutingDataSource.afterPropertiesSet(DynamicRoutingDataSource.java:219) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1862) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1799) ... 128 common frames omittedåŽŸå› å¯èƒ½æœ‰å¦‚ä¸‹ä¸¤ç§ï¼šåŽŸå› ä¸€ï¼šé¡¹ç›®çŽ¯å¢ƒå˜é‡ä¸­æ²¡æœ‰é…ç½®nacosåœ°å€ï¼›è§£å†³åŠžæ³•ï¼Œåœ¨febs-authï¼ˆè¿™é‡Œåªæ˜¯ä»¥febs-authä¸ºä¾‹ï¼‰é¡¹ç›®çš„çŽ¯å¢ƒå˜é‡ä¸­é…ç½®nacosåœ°å€ï¼š åŽŸå› äºŒï¼šé¡¹ç›®æ— æ³•ä»Žnacosä¸­æ‰¾åˆ°å¯¹åº”çš„é…ç½®ã€‚è§£å†³åŠžæ³•ï¼šè¿™ç§æƒ…å†µæ¯”è¾ƒå°‘è§ï¼Œä¸è¿‡å¦‚æžœå‡ºçŽ°äº†ï¼Œå…«æˆæ˜¯å› ä¸ºä½ åœ¨é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„åŽç¼€æ˜¯yamlï¼Œè€ŒnacosæŽ§åˆ¶å°ä¸­é…ç½®çš„ç¡®æ˜¯ymlã€‚rabbitmqé—®é¢˜åœ¨å¯åŠ¨febs-server-systemæˆ–è€…febs-server-testé¡¹ç›®çš„æ—¶å€™ï¼ŒæŽ§åˆ¶å°æŠ›å‡ºAMQPç›¸å…³å¼‚å¸¸ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147org.springframework.amqp.AmqpIOException: java.io.IOException at org.springframework.amqp.rabbit.support.RabbitExceptionTranslator.convertRabbitAccessException(RabbitExceptionTranslator.java:71) at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.createBareConnection(AbstractConnectionFactory.java:510) at org.springframework.amqp.rabbit.connection.CachingConnectionFactory.createConnection(CachingConnectionFactory.java:751) at org.springframework.amqp.rabbit.connection.ConnectionFactoryUtils.createConnection(ConnectionFactoryUtils.java:214) at org.springframework.amqp.rabbit.core.RabbitTemplate.doExecute(RabbitTemplate.java:2092) at org.springframework.amqp.rabbit.core.RabbitTemplate.execute(RabbitTemplate.java:2065) at org.springframework.amqp.rabbit.core.RabbitTemplate.execute(RabbitTemplate.java:2045) at org.springframework.boot.actuate.amqp.RabbitHealthIndicator.getVersion(RabbitHealthIndicator.java:49) at org.springframework.boot.actuate.amqp.RabbitHealthIndicator.doHealthCheck(RabbitHealthIndicator.java:44) at org.springframework.boot.actuate.health.AbstractHealthIndicator.health(AbstractHealthIndicator.java:82) at org.springframework.boot.actuate.health.HealthIndicator.getHealth(HealthIndicator.java:37) at org.springframework.boot.actuate.health.HealthEndpointWebExtension.getHealth(HealthEndpointWebExtension.java:92) at org.springframework.boot.actuate.health.HealthEndpointWebExtension.getHealth(HealthEndpointWebExtension.java:42) at org.springframework.boot.actuate.health.HealthEndpointSupport.getContribution(HealthEndpointSupport.java:106) at org.springframework.boot.actuate.health.HealthEndpointSupport.getAggregateHealth(HealthEndpointSupport.java:116) at org.springframework.boot.actuate.health.HealthEndpointSupport.getContribution(HealthEndpointSupport.java:103) at org.springframework.boot.actuate.health.HealthEndpointSupport.getHealth(HealthEndpointSupport.java:81) at org.springframework.boot.actuate.health.HealthEndpointSupport.getHealth(HealthEndpointSupport.java:68) at org.springframework.boot.actuate.health.HealthEndpointWebExtension.health(HealthEndpointWebExtension.java:80) at org.springframework.boot.actuate.health.HealthEndpointWebExtension.health(HealthEndpointWebExtension.java:69) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.springframework.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:279) at org.springframework.boot.actuate.endpoint.invoke.reflect.ReflectiveOperationInvoker.invoke(ReflectiveOperationInvoker.java:77) at org.springframework.boot.actuate.endpoint.annotation.AbstractDiscoveredOperation.invoke(AbstractDiscoveredOperation.java:60) at org.springframework.boot.actuate.endpoint.web.servlet.AbstractWebMvcEndpointHandlerMapping$ServletWebOperationAdapter.handle(AbstractWebMvcEndpointHandlerMapping.java:305) at org.springframework.boot.actuate.endpoint.web.servlet.AbstractWebMvcEndpointHandlerMapping$OperationHandler.handle(AbstractWebMvcEndpointHandlerMapping.java:388) at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:498) at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:888) at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:793) at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898) at javax.servlet.http.HttpServlet.service(HttpServlet.java:634) at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) at javax.servlet.http.HttpServlet.service(HttpServlet.java:741) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) at brave.servlet.TracingFilter.doFilter(TracingFilter.java:65) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:320) at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:126) at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:90) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:118) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:137) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:111) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:158) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:154) at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter.doFilter(OAuth2AuthenticationProcessingFilter.java:176) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:116) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:92) at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:77) at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:105) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:56) at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:334) at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:215) at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:178) at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:358) at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:271) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) at org.springframework.cloud.sleuth.instrument.web.ExceptionLoggingFilter.doFilter(ExceptionLoggingFilter.java:50) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) at brave.servlet.TracingFilter.doFilter(TracingFilter.java:82) at org.springframework.cloud.sleuth.instrument.web.LazyTracingFilter.doFilter(TraceWebServletAutoConfiguration.java:138) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) at org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter.doFilterInternal(WebMvcMetricsFilter.java:108) at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:526) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408) at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:861) at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1579) at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) at java.lang.Thread.run(Thread.java:748)Caused by: java.io.IOException: null at com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:129) at com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:125) at com.rabbitmq.client.impl.AMQChannel.exnWrappingRpc(AMQChannel.java:147) at com.rabbitmq.client.impl.AMQConnection.start(AMQConnection.java:403) at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1115) at com.rabbitmq.client.ConnectionFactory.newConnection(ConnectionFactory.java:1063) at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.connect(AbstractConnectionFactory.java:526) at org.springframework.amqp.rabbit.connection.AbstractConnectionFactory.createBareConnection(AbstractConnectionFactory.java:473) ... 127 common frames omittedCaused by: com.rabbitmq.client.ShutdownSignalException: connection error; protocol method: #method&lt;connection.close&gt;(reply-code=530, reply-text=NOT_ALLOWED - access to vhost &apos;/&apos; refused for user &apos;febs&apos;, class-id=10, method-id=40) at com.rabbitmq.utility.ValueOrException.getValue(ValueOrException.java:66) at com.rabbitmq.utility.BlockingValueOrException.uninterruptibleGetValue(BlockingValueOrException.java:36) at com.rabbitmq.client.impl.AMQChannel$BlockingRpcContinuation.getReply(AMQChannel.java:502) at com.rabbitmq.client.impl.AMQChannel.privateRpc(AMQChannel.java:293) at com.rabbitmq.client.impl.AMQChannel.exnWrappingRpc(AMQChannel.java:141) ... 132 common frames omittedè§£å†³åŠžæ³•ï¼šè¯·ç¡®ä¿å½“å‰rabbitmqè´¦å·æ‹¥æœ‰æƒé™ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„rabbitmqçš„è´¦å·ä¸ºï¼š123456... rabbitmq: host: $&#123;rabbitmq.url&#125; port: 5672 username: febs password: 123456æµè§ˆå™¨ç™»å½•ï¼šhttp://localhost:15672/ï¼Œé»˜è®¤è´¦å·å¯†ç éƒ½ä¸ºä¸ºguestï¼šå¯ä»¥çœ‹åˆ°ï¼Œfebsè´¦å·æ²¡æœ‰è®¾ç½®æƒé™ï¼Œç‚¹å‡»febsç”¨æˆ·åï¼Œè®¾ç½®æƒé™ï¼šè¿™æ—¶å€™å†æ¬¡å¯åŠ¨febs-server-systemæˆ–febs-server-testå³å¯ã€‚febs-monitor-adminä¸­æœ‰æœåŠ¡çº¢å‰å‰æ­¤ç±»é—®é¢˜éƒ½å¥½è§£å†³ï¼Œåªéœ€è¦ç‚¹å‡»å¯¹åº”æŠ¥çº¢å‰å‰çš„å¾®æœåŠ¡å°±èƒ½çœ‹çš„è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š åœ¨febs-server-systemé¡¹ç›®çš„é…ç½®æ–‡ä»¶febs-server-system.propertiesï¼šæ— è®ºæ˜¯ä»€ä¹ˆåŽŸå› å¯¼è‡´çº¢å‰å‰ï¼Œç‚¹å‡»è¿›åŽ»éƒ½èƒ½çœ‹åˆ°å¯¹åº”çš„é”™è¯¯æç¤ºï¼Œæœ‰äº†é”™è¯¯æç¤ºï¼Œé—®é¢˜ä¾¿å¾ˆå¥½è§£å†³äº†ã€‚swaggerè®¤è¯é¡µé¢å‡ºé”™åœ¨swaggeré¡µé¢ç‚¹å‡»AuthorizeæŒ‰é’®çš„æ—¶å€™ï¼Œé¡µé¢å‡ºçŽ°é”™è¯¯ï¼šæ­¤ç±»é—®é¢˜ä¸€èˆ¬æ˜¯ä½ formè¡¨å•å¡«å†™çš„å†…å®¹æœ‰è¯¯ï¼Œè¯·ä»”ç»†æ ¸å®žã€‚æœ¬åœ°å¦‚ä½•ä½“éªŒç¤¾äº¤ç™»å½•å…·ä½“å‚è€ƒï¼šhttps://www.kancloud.cn/mrbird/spring-cloud/1411213]]></content>
      <tags>
        <tag>FEBS</tag>
        <tag>Spring Cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IDEAä¸­ä½¿ç”¨Dockeræ’ä»¶]]></title>
    <url>%2FIDEA-Docker-Plugin.html</url>
    <content type="text"><![CDATA[åœ¨Windowsä¸Šå¦‚æžœæ²¡æœ‰å®‰è£…docker for windowsçš„è¯ï¼Œæ˜¯æ²¡åŠžæ³•æž„å»ºDockeré•œåƒçš„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æžœè¦é€šè¿‡fat jaræž„å»ºdockeré•œåƒçš„è¯ï¼Œåªèƒ½å°†fat jarä¸Šä¼ åˆ°å®‰è£…äº†dockeræœåŠ¡çš„LinuxæœåŠ¡å™¨ä¸Šï¼Œç„¶åŽç¼–å†™Dockerfileæž„å»ºã€‚è¿™ç§æ–¹å¼æ¯”è¾ƒéº»çƒ¦ï¼Œè¿™é‡Œè®°å½•ä¸‹å¦‚ä½•é€šè¿‡IDEAçš„Dockeræ’ä»¶è¿œç¨‹æž„å»ºDockeré•œåƒã€‚Dockerå¼€å¯è¿œç¨‹è®¿é—®å‡å¦‚æˆ‘åœ¨CentOSè™šæ‹Ÿæœºä¸Šå®‰è£…å¥½äº†Dockerï¼ŒIPåœ°å€ä¸º192.168.33.11ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹Dockerçš„é…ç½®ï¼Œå¼€å¯è¿œç¨‹è®¿é—®æƒé™ï¼š12# ä¿®æ”¹Dockeré…ç½®vi /lib/systemd/system/docker.serviceä¿®æ”¹çš„åœ°æ–¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šä¿®æ”¹ä¿å­˜åŽï¼Œé‡å¯DockeræœåŠ¡ï¼š12systemctl daemon-reload systemctl restart docker.serviceé‡å¯åŽï¼ŒéªŒè¯ä¸‹2375ç«¯å£æ˜¯å¦æ˜¯é€šçš„ï¼š1curl 192.168.33.11:2375/infoå¦‚æžœè¿”å›žäº†ä¸€å¨JSONæ•°æ®ï¼Œè¯´æ˜ŽðŸ†—ã€‚IDEAä½¿ç”¨Dockeræ’ä»¶IDEA Ultimateç‰ˆæœ¬å·²ç»é»˜è®¤å®‰è£…äº†Dockeræ’ä»¶ï¼ˆæ²¡æœ‰çš„è¯åŽ»æ’ä»¶å¸‚åœºä¸‹è½½å®‰è£…ä¸‹å°±å¯ä»¥äº†ï¼‰ã€‚ç‚¹å‡»IDEA -&gt; File -&gt; Settingsâ€¦ -&gt; Build,Execution,Deployment -&gt; Dockerï¼šå¡«å†™è¿œç¨‹Dockeråœ°å€ï¼Œå¦‚æžœæ˜¾ç¤ºConnection Successfullyè¯´æ˜Žè¿žæŽ¥è¿œç¨‹DockeræœåŠ¡æˆåŠŸã€‚æ–°å»ºä¸€ä¸ªç®€å•çš„Spring Booté¡¹ç›®ï¼Œpomå¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.2.1.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;demo&lt;/artifactId&gt; &lt;version&gt;0.0.1&lt;/version&gt; &lt;name&gt;demo&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;ç„¶åŽç”¨mavenæ‰“åŒ…ï¼Œæ‰“åŒ…åŽé¡¹ç›®æ ¹ç›®å½•çš„targetä¸‹ä¼šæœ‰å¦‚ä¸‹fat jarï¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºDockerfileï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š12345FROM openjdk:8u212-jreMAINTAINER MrBird 852252810@qq.comCOPY target/demo-0.0.1.jar /demo-0.0.1.jarENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/demo-0.0.1.jar&quot;]ç„¶åŽç‚¹å‡»IDEA -&gt; Run -&gt; Edit Configrationsâ€¦é€‰æ‹©è¿œç¨‹çš„DockeræœåŠ¡ï¼Œå¡«å†™é•œåƒæ ‡ç­¾å†…å®¹ï¼Œç‚¹å‡»ä¿å­˜åŽï¼Œè¿è¡Œï¼šé€šè¿‡æ—¥å¿—æ¥çœ‹ï¼Œé•œåƒæž„å»ºæ˜¯æˆåŠŸçš„ï¼šå¯ä»¥çœ‹åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šå·²ç»åŒ…å«äº†è¯¥Dockeré•œåƒï¼šå¯ä»¥åˆ°æœåŠ¡å™¨ä¸ŠéªŒè¯ä¸‹ï¼š]]></content>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[KubernetesæœåŠ¡å‘çŽ°æ€»ç»“]]></title>
    <url>%2FKubernetes-Service-Discovery-Summary.html</url>
    <content type="text"><![CDATA[KubernetesæœåŠ¡å‘çŽ°ä¸»è¦å¯ä»¥å½’ä¸ºä¸‰ç§æƒ…å½¢ï¼š1.Kubernetesé›†ç¾¤å†…éƒ¨é—´æœåŠ¡å¦‚ä½•äº’ç›¸é€šä¿¡ï¼›2.Kuberntesé›†ç¾¤å¤–éƒ¨å¦‚ä½•è®¿é—®é›†ç¾¤å†…éƒ¨æœåŠ¡ï¼›3.Kubernetesé›†ç¾¤å†…éƒ¨å¦‚ä½•è®¿é—®é›†ç¾¤å¤–éƒ¨æœåŠ¡ã€‚è¿™èŠ‚é’ˆå¯¹è¿™ä¸‰ç§æƒ…å†µåšä¸ªæ€»ç»“ã€‚é›†ç¾¤é—´æœåŠ¡é€šä¿¡1.é€šè¿‡Pod IPç›¸äº’é€šä¿¡ï¼Œä½†æ˜¯Podå…·æœ‰ä¸ç¡®å®šæ€§ï¼ŒPod IPä¼šå‘ç”Ÿæ”¹å˜ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼å¹¶ä¸æŽ¨èã€‚2.éƒ¨ç½²Podå¯¹åº”çš„Serviceï¼Œè®¿é—®Service IPï¼Œè¯·æ±‚è´Ÿè½½å‡è¡¡è½¬å‘æœåŠ¡åˆ°å„ä¸ªå¯¹åº”çš„Podå®žä¾‹ã€‚æ¯”å¦‚æœ‰å¦‚ä¸‹é…ç½®æ–‡ä»¶demo.ymlï¼š12345678910111213141516171819202122232425262728293031apiVersion: apps/v1kind: Deploymentmetadata: name: nginx-dspec: selector: matchLabels: name: web-app replicas: 3 template: metadata: labels: name: web-app spec: containers: - name: nginx image: nginx ports: - containerPort: 80---apiVersion: v1kind: Servicemetadata: name: nginx-sspec: ports: - port: 8080 targetPort: 80 protocol: TCP selector: name: web-appè¿è¡Œè¯¥é…ç½®ï¼ŒæŸ¥çœ‹Serviceå¯¹åº”çš„IPï¼šé€šè¿‡Service IPå’Œç«¯å£å°±èƒ½è®¿é—®å¯¹åº”çš„PodæœåŠ¡:ä½†æ˜¯æˆ‘ä»¬äº‹å…ˆå¹¶ä¸çŸ¥é“Serviceçš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æžœæˆ‘ä»¬åœ¨å¯åŠ¨æœåŠ¡åŽå†åŽ»é…ç½®è¿™ä¸ªIPçš„è¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯éžå¸¸éº»çƒ¦çš„ï¼Œæ‰€å¹¸æˆ‘ä»¬å¯ä»¥é€šè¿‡DNSè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ç§æ–¹å¼ï¼š3.éƒ¨ç½²Podå¯¹åº”çš„Serviceï¼Œé€šè¿‡ServiceNameï¼Œè¯·æ±‚è´Ÿè½½å‡è¡¡è½¬å‘æœåŠ¡åˆ°å„ä¸ªå¯¹åº”çš„Podå®žä¾‹ã€‚é€šè¿‡ä¸‹é¢è¿™æ®µé…ç½®éƒ¨ç½²ä¸€ä¸ªæ–°çš„PodæœåŠ¡ï¼š123456789101112apiVersion: v1kind: Podmetadata: name: centos-podspec: containers: - name: centos image: centos command: - sh - -c - 'while true; do sleep 360000000; done'è¿›å…¥åˆ°è¯¥å®¹å™¨å†…éƒ¨ï¼Œæµ‹è¯•ä¸‹æ˜¯å¦å¯ä»¥è®¿é—®ä¸Šé¢åˆ›å»ºçš„Serviceï¼šè¯•ç€é€šè¿‡ServiceNameè®¿é—®NginxæœåŠ¡ï¼šå¯ä»¥çœ‹åˆ°æ•ˆæžœæ˜¯ä¸€æ ·çš„ã€‚è¿™å¾—ç›ŠäºŽKube-dnsï¼Œå…·ä½“çš„æ ¼å¼ä¸ºï¼š&lt;service_name&gt;.&lt;namespace&gt;.svc.&lt;cluster_domain&gt;å…¶ä¸­ï¼Œ&lt;cluster_domain&gt;é»˜è®¤å€¼ä¸ºcluster.localï¼Œå¯ä»¥é€šè¿‡kubeletçš„--cluster-domain=SomeDomainå‚æ•°è¿›è¡Œè®¾ç½®ã€‚ä¸ºäº†åœ¨Podä¸­è°ƒç”¨å…¶ä»–Serviceï¼Œkubeletä¼šè‡ªåŠ¨åœ¨å®¹å™¨ä¸­åˆ›å»ºåŸŸåè§£æžé…ç½®ï¼šæ‰€ä»¥é™¤äº†ä½¿ç”¨curl nginx-s:8080è®¿é—®å¤–ï¼Œä»¥ä¸‹è¿™äº›ä¹Ÿæ˜¯ç­‰æ•ˆçš„ï¼š12345curl nginx-s.default:8080curl nginx-s.default.svc:8080curl nginx-s.default.svc.cluster.local:8080æ‰€ä»¥æˆ‘ä»¬çŽ°åœ¨å¯ä»¥ä¸ç”¨äº‹å…ˆçŸ¥é“Serviceçš„IPäº†ï¼Œåªè¦äº‹å…ˆçŸ¥é“ServiceNameå³å¯ï¼ˆServiceNameæ˜¯æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ï¼‰ã€‚4.é€šè¿‡Headless Serviceï¼Œè¿”å›žPodçš„æ‰€æœ‰å®žä¾‹ã€‚æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸éœ€è¦Serviceçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œè€Œæ˜¯æ‰‹åŠ¨èŽ·å–Serviceå¯¹åº”çš„Podå®žä¾‹ï¼Œè‡ªå·±å†³å®šå¦‚ä½•è®¿é—®ã€‚åˆ›å»ºä¸€ä¸ªHeadless Serviceé…ç½®ï¼š12345678910apiVersion: v1kind: Servicemetadata: name: nginx-headless-sspec: ports: - port: 8080 clusterIP: None selector: name: web-appåˆ›å»ºè¯¥Headless Serviceï¼Œç„¶åŽåˆ°centos-podå®¹å™¨å†…éƒ¨æŸ¥è¯¢DNSè®°å½•ï¼šå¦‚æžœæ²¡æœ‰nslookupå‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨yum -y install bind-utilså‘½ä»¤å®‰è£…ã€‚å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡è§£æžnginx-headless-s DNSï¼Œè¿”å›žäº†ä¸‰ä¸ªNginx Podå®žä¾‹åœ°å€ã€‚é›†ç¾¤å¤–éƒ¨è®¿é—®å†…éƒ¨1.PodæŒ‡å®šhostPortï¼Œæˆ–è€…å¼€å¯hostNetworkï¼Œè¿™æ ·å¤–éƒ¨å°±å¯ä»¥é€šè¿‡Podå®¿ä¸»æœºIP+Podç«¯å£è®¿é—®äº†ï¼Œä½†Podè°ƒåº¦çš„ä¸ç¡®å®šæ€§ï¼Œè¿™ç§æ–¹å¼ä¸æŽ¨èï¼›2.é€šè¿‡Serviceçš„NodePortæš´éœ²æœåŠ¡ï¼Œå¦‚æžœæœåŠ¡è¾ƒå¤šçš„è¯ä¸æŽ¨èï¼Œå› ä¸ºè¿™ç§æ–¹å¼ä¼šåœ¨é›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šéƒ½æš´éœ²è¯¥ç«¯å£ï¼Œæ‰€ä»¥å½“æœåŠ¡å¤šçš„æ—¶å€™å¾ˆå®¹æ˜“é€ æˆç«¯å£å†²çªï¼Œå¹¶ä¸”ç«¯å£ç»´æŠ¤ä¸ä¾¿ï¼›3.é€šè¿‡Ingressé›†ä¸­æš´éœ²æœåŠ¡ï¼Œè¦æš´éœ²çš„æœåŠ¡è¾ƒå¤šçš„æ—¶å€™æŽ¨èã€‚è¿™ä¸‰ç§æ–¹å¼æ˜¯å‰é¢åšå®¢ä¸­éƒ½æœ‰ä»‹ç»åˆ°ï¼Œæ‰€ä»¥å°±ä¸èµ˜è¿°äº†ã€‚é›†ç¾¤å†…éƒ¨è®¿é—®å¤–éƒ¨1.ç›´æŽ¥é€šè¿‡å¤–éƒ¨æœåŠ¡çš„IPå’Œç«¯å£è¿›è¡Œè®¿é—®ï¼›2.é€šè¿‡Serviceå’ŒEndpointç»‘å®šï¼Œé›†ç¾¤å†…çš„æœåŠ¡é€šè¿‡DNSè®¿é—®é›†ç¾¤å¤–éƒ¨æœåŠ¡ï¼ˆæŽ¨èï¼‰ã€‚åˆ›å»ºå¦‚ä¸‹é…ç½®ï¼ˆtest-remote.ymlï¼‰ï¼š12345678910111213141516171819apiVersion: v1kind: Servicemetadata: name: remote-sspec: ports: - protocol: TCP port: 8081 targetPort: 8080---apiVersion: v1kind: Endpointsmetadata: name: remote-ssubsets: - addresses: - ip: 192.168.73.42 ports: - port: 8080Serviceå’ŒEndpointsåç§°ä¸€æ ·ï¼Œæ‰€ä»¥ä»–ä»¬ä¼šç»‘å®šä¸Šï¼Œé€šè¿‡è®¿é—®remote-s Serviceä¾¿å¯ä»¥è®¿é—®åˆ°å¯¹åº”çš„Endpointåœ°å€192.168.73.42:8080æœåŠ¡ï¼ˆè¿™æ˜¯ä¸ªæˆ‘åœ¨é›†ç¾¤å¤–éƒ¨ï¼Œé€šè¿‡Spring Bootæ­å»ºçš„ç®€å•webæœåŠ¡ï¼‰ã€‚è¿è¡Œè¯¥é…ç½®åŽï¼Œåœ¨masterèŠ‚ç‚¹ä¸Šï¼Œæµ‹è¯•æ˜¯å¦å¯ä»¥è®¿é—®ï¼šæˆ‘ä»¬è¿›åˆ°centos-podå®¹å™¨å†…éƒ¨ï¼Œé€šè¿‡æœåŠ¡åç§°çœ‹çœ‹æ˜¯å¦å¯ä»¥è®¿é—®åˆ°ï¼šå¯ä»¥çœ‹åˆ°è¿™ç§æ–¹å¼ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ï¼ŒæŽ¨èä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå¯ä»¥é™ä½Žè€¦åˆåº¦ã€‚]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes Ingress]]></title>
    <url>%2FKubernetes-Ingress.html</url>
    <content type="text"><![CDATA[åœ¨Kubernetes ServiceåŸºç¡€ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°å¯ä»¥é€šè¿‡è®¾ç½®Service NodePortå‘Kubernetesé›†ç¾¤å¤–éƒ¨æš´éœ²ç«¯å£ï¼Œå¤–éƒ¨æœåŠ¡å¯ä»¥é€šè¿‡Kubernetesé›†ç¾¤èŠ‚ç‚¹IP+NodePortè®¿é—®é›†ç¾¤å†…éƒ¨èµ„æºã€‚å½“é›†ç¾¤å†…éƒ¨æœåŠ¡ä¼—å¤šæ—¶ï¼Œéœ€è¦æš´éœ²çš„ç«¯å£ä¹Ÿä¼šè¶Šæ¥è¶Šå¤šã€‚è¿™æ ·ä¸ä»…ç«¯å£ç»´æŠ¤å›°éš¾ï¼Œé›†ç¾¤è¾¹ç•Œä¹Ÿå˜å¾—â€œåƒç–®ç™¾å­”â€ã€‚é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼ŒKubernetesæä¾›äº†Ingressæ¥è§£å†³ï¼ŒIngresså¯¹è±¡ç”¨äºŽé…ç½®å¤–éƒ¨è¯·æ±‚è½¬å‘åˆ°é›†ç¾¤å†…éƒ¨æœåŠ¡çš„å…·ä½“è§„åˆ™ï¼Œè€Œå®žé™…çš„è½¬å‘æ“ä½œç”±Ingress Controlleræ¥å®Œæˆã€‚å‡è®¾æˆ‘ä»¬çš„Kubernetesé›†ç¾¤ä¸­åˆ†åˆ«å­˜åœ¨2ä¸ªå®žä¾‹çš„tomcatå’Œnginx Deploymentï¼Œå¹¶ä¸”æœ‰å¯¹åº”çš„Serviceã€‚åŠ å…¥IngressåŽï¼Œæˆ‘ä»¬å¯ä»¥å®žçŽ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æœåŠ¡æš´éœ²æ–¹å¼ï¼šIngress ControllerIngress Controllerå¹¶ä¸æ˜¯Kuberneteså¯¹è±¡ï¼Œè€Œæ˜¯æ ¹æ®Ingresså¯¹è±¡é…ç½®ï¼Œå®žçŽ°å…·ä½“è½¬å‘åŠŸèƒ½çš„ç»„ä»¶ç»Ÿç§°ã€‚é™¤äº†Kuberneteså®˜æ–¹ç»´æŠ¤çš„GCEå’ŒIngress Nginxå¤–ï¼Œè¿˜æœ‰è®¸å¤šç¬¬ä¸‰æ–¹ç»´æŠ¤çš„å®žçŽ°ã€‚è¿™é‡Œä»¥ç”¨çš„è¾ƒå¤šçš„Ingress Nginxä¸ºä¾‹ï¼Œå®žçŽ°Ingress Controllerçš„éƒ¨ç½²ã€‚å› ä¸ºIngress Controlleræ˜¯ç”¨äºŽå¤„ç†é›†ç¾¤å¤–éƒ¨è¯·æ±‚è®¿é—®é›†ç¾¤å†…éƒ¨æœåŠ¡çš„ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ€è€ƒï¼Œå¦‚ä½•å°†Ingress Controlleræš´éœ²å‡ºåŽ»ã€‚æœ€ä¸ºå¸¸è§çš„æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§ï¼šåˆ›å»ºå’ŒIntress Controllerå¯¹åº”çš„ServiceæœåŠ¡ï¼ŒServiceé€šè¿‡NodePortå°†æœåŠ¡ç«¯å£æš´éœ²å‡ºåŽ»ï¼›å°†Ingress Controlleréƒ¨ç½²åˆ°å‡ ä¸ªå›ºå®šçš„èŠ‚ç‚¹ä¸Šï¼Œç„¶åŽé€šè¿‡HostPortå°†ç«¯å£æ˜ å°„å‡ºåŽ»ï¼Œæœ€å¤–å±‚é€šè¿‡LVS+keepaliveå®žçŽ°è´Ÿè½½å‡è¡¡ã€‚å› ä¸ºç¬¬1ç§æ–¹å¼éœ€è¦åœ¨è¯·æ±‚é“¾è·¯ä¸­å†åŠ ä¸€å±‚ServiceæœåŠ¡ï¼Œæ€§èƒ½å¯èƒ½ä¼šæœ‰è€—æŸï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ç¬¬2ç§æ–¹å¼ã€‚ä¸ºäº†ç®€åŒ–è¿‡ç¨‹ï¼Œè¿™é‡Œåªåœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šéƒ¨ç½²Ingress Controllerï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©åœ¨Node1èŠ‚ç‚¹ä¸Šéƒ¨ç½²ã€‚ç»™Node1èŠ‚ç‚¹æ‰“ä¸ªæ ‡ç­¾ï¼š1kubectl label node node1 type="ingress"ä¸‹è½½Ingress Nginxé…ç½®æ–‡ä»¶ï¼š1wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/master/deploy/static/mandatory.yamlä¿®æ”¹è¯¥é…ç½®æ–‡ä»¶ï¼š1vi mandatory.yamlä¿®æ”¹éƒ¨åˆ†å¦‚ä¸‹æ‰€ç¤º:åˆ›å»ºè¯¥é…ç½®æ–‡ä»¶ï¼š1kubectl create -f mandatory.yamlæŸ¥çœ‹æ˜¯å¦åˆ›å»ºæˆåŠŸï¼šä½¿ç”¨æµè§ˆå™¨è®¿é—®http://192.168.33.12/ï¼šå› ä¸ºè¿˜æ²¡æœ‰åˆ›å»ºIngressï¼Œæ‰€ä»¥é¡µé¢å“åº”æš‚æ—¶ä¸º404ã€‚Ingressåœ¨åˆ›å»ºIngresså¯¹è±¡å‰ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡å¥½tomcatå’ŒnginxæœåŠ¡ï¼Œä¾›å¾…ä¼šæ¼”ç¤ºï¼Œåˆ›å»ºdemo.ymlï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162---apiVersion: apps/v1kind: Deploymentmetadata: name: tomcat-appspec: selector: matchLabels: name: tomcat replicas: 2 template: metadata: labels: name: tomcat spec: containers: - name: tomcat image: tomcat:8.0.51-alpine ports: - containerPort: 8080---apiVersion: apps/v1kind: Deploymentmetadata: name: nginx-appspec: selector: matchLabels: name: nginx replicas: 2 template: metadata: labels: name: nginx spec: containers: - name: nginx image: nginx ports: - containerPort: 80---apiVersion: v1kind: Servicemetadata: name: tomcat-servicespec: ports: - port: 8080 targetPort: 8080 selector: name: tomcat---apiVersion: v1kind: Servicemetadata: name: nginx-servicespec: ports: - port: 8081 targetPort: 80 selector: name: nginxåˆ›å»ºï¼š1kubectl create -f demo.ymlæŸ¥çœ‹æ˜¯å¦åˆ›å»ºæˆåŠŸï¼šæŽ¥ç€åˆ›å»ºIngressé…ç½®æ–‡ä»¶ï¼ˆingress.ymlï¼‰:1234567891011121314151617181920apiVersion: networking.k8s.io/v1beta1kind: Ingressmetadata: name: ingressspec: rules: - host: tomcat.mrbird.cc http: paths: - path: / backend: serviceName: tomcat-service servicePort: 8080 - host: nginx.mrbird.cc http: paths: - path: / backend: serviceName: nginx-service servicePort: 8081æ ¹æ®ä¸Šè¿°é…ç½®ï¼Œå½“æˆ‘ä»¬è®¿é—®tomcat.mrbird.ccæ ¹è·¯å¾„çš„æ—¶å€™ï¼Œè¯·æ±‚å°†è½¬å‘åˆ°åç§°ä¸ºtomcat-serviceï¼Œç«¯å£ä¸º8080çš„serviceä¸Šï¼Œæ ¹æ®ä¸Šé¢demo.ymlçš„é…ç½®ï¼Œè¯¥serviceå¯¹åº”ä¸¤ä¸ªtomcat podï¼›è®¿é—®nginx.mrbird.ccæ ¹è·¯å¾„çš„æ—¶å€™ï¼Œè¯·æ±‚å°†è½¬å‘åˆ°nginx-serviceã€‚åˆ›å»ºè¯¥Ingressï¼š1kubectl create -f ingress.ymlä»Žå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå½“æˆ‘ä»¬è®¿é—®tomcat.mrbird.cc/çš„æ—¶å€™ï¼Œè¯·æ±‚ä¼šå‡è¡¡åœ°è½¬å‘åˆ°10.244.1.10:8080/å’Œ10.244.2.15:8080/ã€‚åœ¨Windowsä¸Šé…ç½®hostsåŸŸåè§£æžï¼šæµè§ˆå™¨è®¿é—®http://tomcat.mrbird.cc/ï¼šè®¿é—®http://nginx.mrbird.cc/ï¼šç»“æžœç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚Ingress Nginxå®žè´¨ä¸Šå°±æ˜¯ä¸€ä¸ªnginxæœåŠ¡ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨é€šè¿‡æˆ‘ä»¬çš„Ingressé…ç½®ï¼Œç”Ÿæˆç›¸åº”çš„nginxé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥åˆ°Ingress Nginxå®¹å™¨å†…éƒ¨è¯å®žè¿™ä¸€ç‚¹:åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢è¿™äº›é…ç½®ï¼ˆä»…æˆªå–tomcat.mrbird.ccé…ç½®ï¼‰ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125...## start server tomcat.mrbird.ccserver &#123; server_name tomcat.mrbird.cc ; listen 80 ; listen [::]:80 ; listen 443 ssl http2 ; listen [::]:443 ssl http2 ; set $proxy_upstream_name &quot;-&quot;; ssl_certificate_by_lua_block &#123; certificate.call() &#125; location / &#123; set $namespace &quot;default&quot;; set $ingress_name &quot;ingress&quot;; set $service_name &quot;tomcat-service&quot;; set $service_port &quot;8080&quot;; set $location_path &quot;/&quot;; rewrite_by_lua_block &#123; lua_ingress.rewrite(&#123; force_ssl_redirect = false, ssl_redirect = true, force_no_ssl_redirect = false, use_port_in_redirects = false, &#125;) balancer.rewrite() plugins.run() &#125; header_filter_by_lua_block &#123; plugins.run() &#125; body_filter_by_lua_block &#123; &#125; log_by_lua_block &#123; balancer.log() monitor.call() plugins.run() &#125; port_in_redirect off; set $balancer_ewma_score -1; set $proxy_upstream_name &quot;default-tomcat-service-8080&quot;; set $proxy_host $proxy_upstream_name; set $pass_access_scheme $scheme; set $pass_server_port $server_port; set $best_http_host $http_host; set $pass_port $pass_server_port; set $proxy_alternative_upstream_name &quot;&quot;; client_max_body_size 1m; proxy_set_header Host $best_http_host; # Pass the extracted client certificate to the backend # Allow websocket connections proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection $connection_upgrade; proxy_set_header X-Request-ID $req_id; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $remote_addr; proxy_set_header X-Forwarded-Host $best_http_host; proxy_set_header X-Forwarded-Port $pass_port; proxy_set_header X-Forwarded-Proto $pass_access_scheme; proxy_set_header X-Scheme $pass_access_scheme; # Pass the original X-Forwarded-For proxy_set_header X-Original-Forwarded-For $http_x_forwarded_for; # mitigate HTTPoxy Vulnerability # https://www.nginx.com/blog/mitigating-the-httpoxy-vulnerability-with-nginx/ proxy_set_header Proxy &quot;&quot;; # Custom headers to proxied server proxy_connect_timeout 5s; proxy_send_timeout 60s; proxy_read_timeout 60s; proxy_buffering off; proxy_buffer_size 4k; proxy_buffers 4 4k; proxy_max_temp_file_size 1024m; proxy_request_buffering on; proxy_http_version 1.1; proxy_cookie_domain off; proxy_cookie_path off; # In case of errors try the next upstream server before returning an error proxy_next_upstream error timeout; proxy_next_upstream_timeout 0; proxy_next_upstream_tries 3; proxy_pass http://upstream_balancer; proxy_redirect off; &#125;&#125;## end server tomcat.mrbird.cc...æ›´å¤šIngressé…ç½®å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttps://v1-12.docs.kubernetes.io/zh/docs/concepts/services-networking/ingress/ã€‚]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes StatefulSet]]></title>
    <url>%2FKubernetes-StatefulSet.html</url>
    <content type="text"><![CDATA[å‰é¢ä»‹ç»çš„Podç®¡ç†å¯¹è±¡ï¼Œå¦‚RC/RSã€Deploymentã€DaemonSetç­‰éƒ½æ˜¯é¢å‘æ— çŠ¶æ€æœåŠ¡çš„ï¼Œè€Œå¯¹äºŽæœ‰çŠ¶æ€çš„åº”ç”¨ï¼Œæ¯”å¦‚MySQLé›†ç¾¤ï¼ŒMongoDBé›†ç¾¤ç­‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨StatefulSetæ¥å®Œæˆã€‚æœ‰çŠ¶æ€çš„åº”ç”¨é›†ç¾¤é€šå¸¸æœ‰ä»¥ä¸‹è¿™äº›ç‰¹ç‚¹ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å›ºå®šçš„èº«ä»½IDï¼Œé€šè¿‡è¿™ä¸ªIDï¼Œé›†ç¾¤ä¸­çš„æˆå‘˜å¯ä»¥ç›¸äº’å‘çŽ°å¹¶é€šä¿¡ï¼›é›†ç¾¤çš„è§„æ¨¡æ˜¯æ¯”è¾ƒå›ºå®šçš„ï¼Œé›†ç¾¤è§„æ¨¡ä¸èƒ½éšæ„å˜åŠ¨ï¼›é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯æœ‰çŠ¶æ€çš„ï¼Œé€šå¸¸ä¼šæŒä¹…åŒ–æ•°æ®åˆ°æ°¸ä¹…å­˜å‚¨ä¸­ã€‚StatefulSetç‰¹æ€§é€šè¿‡StatefulSetæ­å»ºçš„é›†ç¾¤é€šå¸¸æœ‰ä»¥ä¸‹è¿™äº›ç‰¹æ€§ï¼šStatefulSeté‡Œçš„æ¯ä¸ªPodéƒ½æœ‰ç¨³å®šã€å”¯ä¸€çš„ç½‘ç»œæ ‡è¯†ï¼Œå¯ä»¥ç”¨æ¥å‘çŽ°é›†ç¾¤å†…çš„å…¶ä»–æˆå‘˜ã€‚å‡è®¾StatefulSetçš„åç§°ä¸ºnginxï¼Œé‚£ä¹ˆç¬¬1ä¸ªPodå«nginx-0ï¼Œç¬¬2ä¸ªå«nginx-1ï¼Œä»¥æ­¤ç±»æŽ¨ï¼›StatefulSetæŽ§åˆ¶çš„Podå‰¯æœ¬çš„å¯åœé¡ºåºæ˜¯å—æŽ§çš„ï¼Œæ“ä½œç¬¬nä¸ªPodæ—¶ï¼Œå‰n-1ä¸ªPodå·²ç»æ˜¯è¿è¡Œä¸”å‡†å¤‡å¥½çš„çŠ¶æ€ã€‚StatefulSeté‡Œçš„Podé‡‡ç”¨ç¨³å®šçš„æŒä¹…åŒ–å­˜å‚¨å·ï¼Œé€šè¿‡PVæˆ–PVCæ¥å®žçŽ°ï¼Œåˆ é™¤Podæ—¶é»˜è®¤ä¸ä¼šåˆ é™¤ä¸ŽStatefulSetç›¸å…³çš„å­˜å‚¨å·ï¼ˆä¸ºäº†ä¿è¯æ•°æ®çš„å®‰å…¨ï¼‰ï¼›é…åˆHeadless Serviceä½¿ç”¨ï¼Œç”¨äºŽå‘çŽ°å’ŒæŽ§åˆ¶Podå®žä¾‹æ•°é‡ã€‚StatefulSetå®žè·µä¸‹é¢ä½¿ç”¨StatefulSetæ­å»ºä¸ªNginxé›†ç¾¤ï¼ŒæŒä¹…åŒ–å­˜å‚¨ä½¿ç”¨ä¸Šä¸€èŠ‚æ­å»ºçš„åç§°ä¸ºmanaged-nfs-storageçš„StorageClassã€‚åˆ›å»ºnginx-headless-service.ymlé…ç½®æ–‡ä»¶ï¼š12345678910111213apiVersion: v1kind: Servicemetadata: name: nginx labels: name: nginxspec: ports: - port: 80 targetPort: 80 clusterIP: None # è¡¨æ˜Žä¸ºHeadleass Service selector: role: web-appåˆ›å»ºè¯¥Headless Serviceï¼š1kubectl create -f nginx-headless-service.ymlæŽ¥ç€åˆ›å»ºnginx-statefulset.ymlé…ç½®æ–‡ä»¶ï¼š123456789101112131415161718192021222324252627282930313233apiVersion: apps/v1kind: StatefulSetmetadata: name: nginx-scspec: serviceName: "nginx" # å¯¹åº”åˆšåˆšåˆ›å»ºçš„Headless Serviceåç§° replicas: 3 selector: matchLabels: role: web-app template: metadata: labels: role: web-app spec: terminationGracePeriodSeconds: 10 containers: - name: nginx image: nginx ports: - containerPort: 80 volumeMounts: - mountPath: /usr/share/nginx/html name: nginx-persistent-storage # å’Œä¸‹é¢çš„pvcåç§°å¯¹åº” volumeClaimTemplates: # pvcæ¨¡æ¿ - metadata: name: nginx-persistent-storage # pvcåç§° spec: storageClassName: managed-nfs-storage # æŒ‡å®šStorageClassåç§° accessModes: ["ReadWriteMany"] resources: requests: storage: 100Miåˆ›å»ºè¯¥StatefulSetï¼Œè§‚å¯Ÿpodçš„åˆ›å»ºè¿‡ç¨‹ï¼šå¯ä»¥çœ‹åˆ°ï¼Œpodçš„åˆ›å»ºæ˜¯ä¸¥æ ¼one by oneçš„ï¼Œå› ä¸ºæˆ‘ä»¬å®šä¹‰çš„StatefulSetçš„åç§°ä½nginx-scï¼Œæ‰€ä»¥Podçš„åç§°åˆ†åˆ«ä½nginx-sc-0ã€nginx-sc-1å’Œnginx-sc-2ã€‚æŸ¥çœ‹å¯¹åº”çš„PVCå’ŒPVï¼šçŠ¶æ€ä¸ºBoundã€‚åˆ é™¤Podï¼Œå†æ¬¡è§‚å¯ŸPodçš„åˆ›å»ºè¿‡ç¨‹ï¼šå¯ä»¥çœ‹åˆ°é¡ºåºæ€§æ˜¯ä¸¥æ ¼ä¿è¯çš„ã€‚è¿›å…¥åˆ°Podå†…éƒ¨ï¼ŒæŸ¥çœ‹å…¶hostnameï¼šhostnameå’Œpodåç§°ä¸€è‡´ã€‚åˆ°192.168.33.13çš„/nfsç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°æŒ‚è½½äº†ä¸‰ä¸ªnginxç›®å½•ï¼šã€ŠKubernetesæƒå¨æŒ‡å—(ç¬¬4ç‰ˆ)ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Kubernetes</tag>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes StorageClasså®žè·µ]]></title>
    <url>%2FKubernetes-StorageClass-Practice.html</url>
    <content type="text"><![CDATA[æ‰‹åŠ¨åˆ›å»ºPVä¸ä»…ç¹çï¼Œè¿˜å¯èƒ½é€ æˆèµ„æºæµªè´¹ã€‚æ¯”å¦‚æŸä¸ªPVå®šä¹‰çš„å­˜å‚¨ç©ºé—´ä¸º10Giï¼Œè¯¥PVè¢«æŸä¸ªå£°æ˜Žéœ€è¦8Giå†…å­˜çš„PVCç»‘å®šä¸Šäº†ï¼Œè¿™æ—¶å€™è¯¥PVå¤„äºŽBoundçŠ¶æ€ï¼Œæ— æ³•å†å’Œåˆ«çš„PVCè¿›è¡Œç»‘å®šï¼ŒPVä¸Šå‰©ä¸‹çš„2Giå†…å­˜å®žé™…ä¸Šæµªè´¹çš„ã€‚StorageClasså¯ä»¥æ ¹æ®PVCçš„å£°æ˜Žï¼ŒåŠ¨æ€åˆ›å»ºå¯¹åº”çš„PVï¼Œè¿™æ ·ä¸ä»…çœåŽ»äº†åˆ›å»ºPVçš„è¿‡ç¨‹ï¼Œè¿˜å®žçŽ°äº†å­˜å‚¨èµ„æºçš„åŠ¨æ€ä¾›åº”ã€‚StorageClassæž„æˆStorageClassçš„å®šä¹‰ä¸»è¦åŒ…æ‹¬åç§°ã€åŽç«¯å­˜å‚¨çš„æä¾›è€…ï¼ˆprovisionerï¼‰å’ŒåŽç«¯å­˜å‚¨çš„ç›¸å…³å‚æ•°é…ç½®ã€‚StorageClassä¸€æ—¦è¢«åˆ›å»ºå‡ºæ¥ï¼Œåˆ™å°†æ— æ³•ä¿®æ”¹ã€‚å¦‚éœ€æ›´æ”¹ï¼Œåˆ™åªèƒ½åˆ é™¤åŽŸStorageClassçš„å®šä¹‰é‡å»ºã€‚ä¸¾ä¸ªç®€å•çš„StorageClassé…ç½®ï¼š1234567apiVersion: storage.k8s.io/v1kind: StorageClassmetadata: name: managed-nfs-storage # StorageClassåç§°provisioner: fuseim.pri/ifs # æŒ‡å®šå…·ä½“å­˜å‚¨çš„æä¾›è€…parameters: # åŽç«¯å­˜å‚¨ç›¸å…³å‚æ•°é…ç½® archiveOnDelete: "false"ä¸åŒçš„StorageClassä¸»è¦åŒºåˆ«åœ¨äºŽï¼šä¸åŒçš„å­˜å‚¨æä¾›è€…éœ€è¦å¡«å†™ä¸åŒçš„å‚æ•°é…ç½®ï¼Œä¸‹é¢å®žçŽ°ä¸ªNFSä½œä¸ºåŠ¨æ€StorageClasså­˜å‚¨çš„ä¾‹å­ã€‚åŸºäºŽNFSå­˜å‚¨ç±»åž‹çš„å®žè·µNFSçŽ¯å¢ƒåœ¨ä¸Šä¸€èŠ‚å·²ç»æ­å»ºå¥½äº†ï¼ŒIPä¸º192.168.33.13ï¼Œè·¯å¾„ä¸º/nfsã€‚åœ¨masterèŠ‚ç‚¹ä¸Šå…‹éš†ç›¸å…³ä»£ç ï¼š1git clone https://github.com/kubernetes-incubator/external-storage.gitåˆ‡æ¢åˆ°external-storage/nfs-client/deployç›®å½•ï¼š1cd external-storage/nfs-client/deployåˆ›å»ºRBACï¼š1kubectl create -f rbac.ymlæŽ¥ç€éƒ¨ç½²NFS Client Provisionerï¼Œéƒ¨ç½²å‰ä¿®æ”¹deployment.ymlï¼š123456789101112131415161718192021222324252627282930313233343536373839404142apiVersion: apps/v1kind: Deploymentmetadata: name: nfs-client-provisioner labels: app: nfs-client-provisioner # replace with namespace where provisioner is deployed namespace: defaultspec: replicas: 1 selector: matchLabels: app: nfs-client-provisioner strategy: type: Recreate selector: matchLabels: app: nfs-client-provisioner template: metadata: labels: app: nfs-client-provisioner spec: serviceAccountName: nfs-client-provisioner containers: - name: nfs-client-provisioner image: quay.io/external_storage/nfs-client-provisioner:latest volumeMounts: - name: nfs-client-root mountPath: /persistentvolumes env: - name: PROVISIONER_NAME value: mrbird.cc/nfs # åç§°éšä½ å®šä¹‰ - name: NFS_SERVER value: 192.168.33.13 # NFS æœåŠ¡IP - name: NFS_PATH value: /nfs # NFS ç›®å½• volumes: - name: nfs-client-root nfs: server: 192.168.33.13 # NFS æœåŠ¡IP path: /nfs # NFS ç›®å½•ç„¶åŽåˆ›å»ºè¯¥deploymentï¼š1kubectl create -f deployment.ymlä¿®æ”¹class.yamlé…ç½®ï¼š1234567apiVersion: storage.k8s.io/v1kind: StorageClassmetadata: name: managed-nfs-storage # StorageClassåç§°ï¼Œéšä½ å®šä¹‰provisioner: mrbird.cc/nfs # å’Œä¸Šé¢deploymenté‡Œå®šä¹‰çš„ä¸€è‡´parameters: archiveOnDelete: "false"åˆ›å»ºè¿™ä¸ªStorageClassï¼š1kubectl create -f class.ymlåˆ›å»ºPVCï¼ŒPVCçš„å®šä¹‰å¯¹åº”test-claim.ymlï¼š1234567891011kind: PersistentVolumeClaimapiVersion: v1metadata: name: test-claimspec: storageClassName: managed-nfs-storage # æŒ‡å®šStorageClassåç§°ï¼Œå³æˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„StorageClass accessModes: - ReadWriteMany resources: requests: storage: 1Miåˆ›å»ºè¿™ä¸ªPVC:1kubectl create -f test-claim.ymlçŠ¶æ€ä¸ºBoundï¼Œè¯´æ˜Žå·²ç»æˆåŠŸç»‘å®šä¸Šäº†å­˜å‚¨ã€‚æŸ¥çœ‹PVï¼Œä¼šçœ‹åˆ°ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºäº†PVï¼š è‡ªåŠ¨åˆ›å»ºçš„PVåç§°ä¸ºpvc-3b8c5364-aadb-4b07-a3b5-fddad280fc98ã€‚æœ€åŽï¼Œä¿®æ”¹test-pod.ymlé…ç½®ï¼š123456789101112131415161718192021kind: PodapiVersion: v1metadata: name: test-podspec: containers: - name: test-pod image: busybox # ä¿®æ”¹ä¸ºè¿™ä¸ªï¼ŒåŽŸå…ˆçš„é•œåƒåœ°å€éœ€è¦ç§‘å­¦ä¸Šç½‘ command: - "/bin/sh" args: - "-c" - "touch /mnt/SUCCESS &amp;&amp; exit 0 || exit 1" volumeMounts: - name: nfs-pvc mountPath: "/mnt" restartPolicy: "Never" volumes: - name: nfs-pvc persistentVolumeClaim: claimName: test-claim # æŒ‡å®šPVCåç§°ï¼Œå¯¹åº”ä¸Šé¢åˆ›å»ºçš„PVCè¯¥Podä¸»è¦å°±æ˜¯é€šè¿‡busyboxåœ¨/mntç›®å½•ä¸‹åˆ›å»ºäº†ä¸ªSUCCESSæ–‡ä»¶ã€‚åˆ›å»ºè¯¥Podï¼š1kubectl create -f test-pod.ymlçŠ¶æ€ä¸ºCompletedï¼Œè¯´æ˜ŽbusyboxæˆåŠŸæ‰§è¡Œå®Œäº†å‘½ä»¤å¹¶ç»“æŸäº†ã€‚å¦‚æžœä¸€åˆ‡é¡ºåˆ©çš„è¯ï¼Œåœ¨192.168.33.13çš„/nfsç›®å½•ä¸‹ä¼šçœ‹åˆ°busybox podåˆ›å»ºçš„SUCCESSæ–‡ä»¶:å¯ä»¥çœ‹åˆ°/nfsç›®å½•ä¸‹æ–°å¢žäº†ä¸€ä¸ªç›®å½•ï¼Œç›®å½•åç§°æ ¼å¼ä¸ºï¼š[namespace]-[pvcåç§°]-[pvåç§°]ã€‚æˆ‘ä»¬è¿˜å¯ä»¥çŽ©ä¸€ä¸‹å¦ä¸€ä¸ªæµ‹è¯•ï¼Œæ–°å»ºä¸€ä¸ªtest-pod-rc.ymlæ–‡ä»¶ï¼š12345678910111213141516171819202122232425262728apiVersion: v1kind: ReplicationControllermetadata: name: busyboxspec: replicas: 2 # å‰¯æœ¬æ•°ä¸º2ï¼Œä¸ºäº†æµ‹è¯•å…±äº«å­˜å‚¨ selector: name: busybox template: metadata: labels: name: busybox spec: containers: - image: busybox command: - sh - -c - 'while true; do sleep $(($RANDOM % 5 + 5)); done' imagePullPolicy: IfNotPresent name: busybox volumeMounts: - name: nfs mountPath: "/mnt" volumes: - name: nfs persistentVolumeClaim: claimName: test-claim # æŒ‡å®šPVCåç§°ï¼Œå¯¹åº”ä¸Šé¢åˆ›å»ºçš„PVCä¸Šé¢busyboxåšçš„äº‹æƒ…å¾ˆç®€å•ï¼Œå°±æ˜¯æ— é™æœŸä¼‘çœ ã€‚åˆ›å»ºè¯¥rcï¼šå¯ä»¥çœ‹åˆ°ï¼Œpodåˆ†åˆ«éƒ¨ç½²åˆ°äº†node1å’Œnode2ä¸Šã€‚åˆ°node1èŠ‚ç‚¹ä¸Šï¼Œè¿›å…¥busyboxå®¹å™¨å†…éƒ¨çš„/mntç›®å½•ï¼Œåœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªhelloæ–‡ä»¶ï¼šç„¶åŽåˆ°node2èŠ‚ç‚¹ä¸Šï¼Œè¿›å…¥busyboxå®¹å™¨å†…éƒ¨/mntç›®å½•ï¼Œè§‚å¯Ÿåˆšåˆšåœ¨node1èŠ‚ç‚¹busyboxå®¹å™¨å†…éƒ¨åˆ›å»ºçš„helloæ–‡ä»¶æ˜¯å¦å·²ç»åŒæ­¥è¿‡æ¥äº†ï¼šå¯ä»¥çœ‹åˆ°ï¼Œæ–‡ä»¶åŒæ­¥æˆåŠŸã€‚å¹¶ä¸”å‰é¢ä¾‹å­åˆ›å»ºSUCCESSä¹ŸåŒæ­¥è¿‡æ¥äº†ï¼Œè¿™æ˜¯å› ä¸ºå®ƒä»¬æŒ‡å®šäº†åŒä¸€ä¸ªPVCã€‚å›žåˆ°NFSæœåŠ¡å™¨çš„/nfsç›®å½•ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°åˆšåˆšåˆ›å»ºçš„helloæ–‡ä»¶ï¼š]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes PV/PVC]]></title>
    <url>%2FKubernetes-PV-PVC.html</url>
    <content type="text"><![CDATA[åœ¨Kubernetesä¸­ï¼Œæˆ‘ä»¬è™½ç„¶å¯ä»¥ä½¿ç”¨volumeå°†å®¹å™¨å†…ç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœºç›®å½•ä¸Šï¼Œä½†ç”±äºŽPodè°ƒåº¦çš„ä¸ç¡®å®šæ€§ï¼Œè¿™ç§æ•°æ®å­˜å‚¨æ–¹å¼æ˜¯ä¸ç‰¢é çš„ã€‚å¯¹äºŽæœ‰çŠ¶æ€çš„åº”ç”¨ï¼Œæˆ‘ä»¬å¸Œæœ›æ— è®ºPodè¢«è°ƒåº¦åˆ°å“ªä¸ªèŠ‚ç‚¹ä¸Šï¼Œå®ƒä»¬çš„æ•°æ®æ€»èƒ½å¤Ÿå®Œæ•´åœ°æ¢å¤ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±ä¸èƒ½ç”¨volumeæŒ‚è½½äº†ï¼Œè€Œåº”è¯¥ä½¿ç”¨â€œç½‘ç»œå…±äº«å­˜å‚¨â€ã€‚PV/PVCå°±æ˜¯ç”¨äºŽè§£å†³é—®é¢˜è€Œå­˜åœ¨çš„ï¼Œå®ƒä»¬å±è”½äº†åº•å±‚å­˜å‚¨å®žçŽ°çš„ç»†èŠ‚ï¼Œä½¿å¾—æˆ‘ä»¬å¾ˆå®¹æ˜“ä¸Šæ‰‹ä½¿ç”¨ã€‚PVPersistentVolumeï¼ˆPVï¼‰æ˜¯å¯¹åº•å±‚ç½‘ç»œå…±äº«å­˜å‚¨çš„æŠ½è±¡ï¼Œå°†å…±äº«å­˜å‚¨å®šä¹‰ä¸ºä¸€ç§â€œèµ„æºâ€ï¼ŒKubernetesæ”¯æŒçš„PVç±»åž‹å¦‚ä¸‹ï¼šç±»åž‹æè¿°AWSElasticBlockStoreAWSå…¬æœ‰äº‘æä¾›çš„ElasticBlockStoreAzureFileAzureå…¬æœ‰äº‘æä¾›çš„FileAzureDiskAzureå…¬æœ‰äº‘æä¾›çš„DiskCephFSä¸€ç§å¼€æºå…±äº«å­˜å‚¨ç³»ç»ŸFCï¼ˆFibre Channelï¼‰å…‰çº¤å­˜å‚¨è®¾å¤‡FlexVolumeä¸€ç§æ’ä»¶å¼çš„å­˜å‚¨æœºåˆ¶Flockerä¸€ç§å¼€æºå…±äº«å­˜å‚¨ç³»ç»ŸGCEPersistentDiskGCEå…¬æœ‰äº‘æä¾›çš„PersistentDiskGlusterfsä¸€ç§å¼€æºå…±äº«å­˜å‚¨ç³»ç»ŸHostPathå®¿ä¸»æœºç›®å½•ï¼Œä»…ç”¨äºŽå•æœºæµ‹è¯•iSCSIiSCSIå­˜å‚¨è®¾å¤‡Localæœ¬åœ°å­˜å‚¨è®¾å¤‡ï¼Œä»ŽKubernetes 1.7ç‰ˆæœ¬å¼•å…¥ï¼Œåˆ°1.14ç‰ˆæœ¬æ—¶æ›´æ–°ä¸ºç¨³å®šç‰ˆï¼Œç›®å‰å¯ä»¥é€šè¿‡æŒ‡å®šå—ï¼ˆBlockï¼‰è®¾å¤‡æä¾›Local PVï¼Œæˆ–é€šè¿‡ç¤¾åŒºå¼€å‘çš„sig-storage-local-static-provisioneræ’ä»¶https://github.com/kubernetes-sigs/sigstorage-local-static-provisioneræ¥ç®¡ç†Local PVçš„ç”Ÿå‘½å‘¨æœŸNFSç½‘ç»œæ–‡ä»¶ç³»ç»ŸPortworx VolumesPortworxæä¾›çš„å­˜å‚¨æœåŠ¡Quobyte VolumesQuobyteæä¾›çš„å­˜å‚¨æœåŠ¡RBDï¼ˆCeph Block Deviceï¼‰Cephå—å­˜å‚¨ScaleIO VolumesDellEMCçš„å­˜å‚¨è®¾å¤‡StorageOSStorageOSæä¾›çš„å­˜å‚¨æœåŠ¡VsphereVolumeVMWareæä¾›çš„å­˜å‚¨ç³»ç»Ÿä¸¾ä¸ªPVé…ç½®æ–‡ä»¶ä¾‹å­ï¼š12345678910111213apiVersion: v1kind: PersistentVolumemetadata: name: nfsspec: capacity: storage: 1Gi # å…·æœ‰1Giå†…å­˜ accessModes: - ReadWriteMany # å…·æœ‰è¯»å†™æƒé™ï¼Œå…è®¸è¢«å¤šä¸ªNodeæŒ‚è½½ persistentVolumeReclaimPolicy: Retain # å›žæ”¶ç­–ç•¥ï¼Œè¿™é‡Œä¸ºä¿ç•™ nfs: # pvç±»åž‹ä¸ºNFSç±»åž‹ server: 192.168.33.13 path: "/nfs"PVæ”¯æŒçš„accessModesæœ‰ï¼šReadWriteOnceï¼ˆRWOï¼‰ï¼šè¯»å†™æƒé™ï¼Œå¹¶ä¸”åªèƒ½è¢«å•ä¸ªNodeæŒ‚è½½ã€‚ReadOnlyManyï¼ˆROXï¼‰ï¼šåªè¯»æƒé™ï¼Œå…è®¸è¢«å¤šä¸ªNodeæŒ‚è½½ã€‚ReadWriteManyï¼ˆRWXï¼‰ï¼šè¯»å†™æƒé™ï¼Œå…è®¸è¢«å¤šä¸ªNodeæŒ‚è½½ã€‚ä¸åŒçš„å­˜å‚¨æä¾›è€…æ”¯æŒçš„accessModesï¼šVolume PluginReadWriteOnceReadOnlyManyReadWriteManyAWSElasticBlockStoreâœ“--AzureFileâœ“âœ“âœ“AzureDiskâœ“--CephFSâœ“âœ“âœ“Cinderâœ“--CSIdepends on the driverdepends on the driverdepends on the driverFCâœ“âœ“-FlexVolumeâœ“âœ“depends on the driverFlockerâœ“--GCEPersistentDiskâœ“âœ“-Glusterfsâœ“âœ“âœ“HostPathâœ“--iSCSIâœ“âœ“-Quobyteâœ“âœ“âœ“NFSâœ“âœ“âœ“RBDâœ“âœ“-VsphereVolumeâœ“-- (works when Pods are collocated)PortworxVolumeâœ“-âœ“ScaleIOâœ“âœ“-StorageOSâœ“--PVæ”¯æŒçš„persistentVolumeReclaimPolicyæœ‰ï¼šRetainï¼Œä¸æ¸…ç†, ä¿ç•™ Volumeï¼ˆéœ€è¦æ‰‹åŠ¨æ¸…ç†ï¼‰Recycleï¼Œåˆ é™¤æ•°æ®ï¼Œï¼ˆåªæœ‰ NFS å’Œ HostPath æ”¯æŒï¼‰Deleteï¼Œåˆ é™¤å­˜å‚¨èµ„æºï¼Œæ¯”å¦‚åˆ é™¤ AWS EBS å·ï¼ˆåªæœ‰ AWS EBS, GCE PD, Azure Disk å’Œ Cinder æ”¯æŒï¼‰PVå£°æ˜Žå‘¨æœŸï¼šAvailableï¼šç©ºé—²çŠ¶æ€ï¼›Boundï¼šå·²ç»ç»‘å®šåˆ°æŸä¸ªPVCä¸Šï¼›Releasedï¼šå¯¹åº”çš„PVCå·²ç»è¢«åˆ é™¤ï¼Œä½†èµ„æºè¿˜æ²¡æœ‰è¢«é›†ç¾¤æ”¶å›žï¼›Failedï¼šPVè‡ªåŠ¨å›žæ”¶å¤±è´¥ã€‚PVCPersistentVolumeClaimï¼ˆPVCï¼‰ï¼Œå¯¹å­˜å‚¨èµ„æºçš„éœ€æ±‚ç”³è¯·ï¼Œä¸»è¦åŒ…æ‹¬å­˜å‚¨ç©ºé—´è¯·æ±‚ã€è®¿é—®æ¨¡å¼ã€PVé€‰æ‹©æ¡ä»¶å’Œå­˜å‚¨ç±»åˆ«ç­‰ä¿¡æ¯çš„è®¾ç½®ã€‚åªæœ‰PVCå’ŒPVç›¸åŒ¹é…ï¼Œæ‰èƒ½ç»‘å®šä¸Šã€‚å®šä¹‰ä¸€ä¸ªPVCé…ç½®ï¼š12345678910kind: PersistentVolumeClaimapiVersion: v1metadata: name: nfsspec: accessModes: - ReadWriteMany resources: requests: storage: 1Giè¯¥PVCå£°æ˜Žäº†éœ€è¦1Giå­˜å‚¨ç©ºé—´ï¼Œè®¿é—®æ¨¡å¼ä¸ºReadWriteManyï¼Œåˆšåˆšå®šä¹‰çš„PVç¬¦åˆè¿™ä¸ªè¦æ±‚ï¼Œæ‰€ä»¥ä¼šè¢«ç»‘å®šä¸Šã€‚å®žè·µå› ä¸ºNFSç±»åž‹å­˜å‚¨æ¼”ç¤ºèµ·æ¥æ–¹ä¾¿ï¼Œæ‰€ä»¥è¿™é‡Œé€‰æ‹©ä½¿ç”¨NFSä½œä¸ºå­˜å‚¨æä¾›è€…ã€‚åœ¨Kubeadmå®‰è£…Kubernetes1.16.2é›†ç¾¤ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ›¾åœ¨ä»¥ä¸‹è™šæ‹Ÿæœºä¸Šæ­å»ºäº†Kubernetesé›†ç¾¤:æ“ä½œç³»ç»ŸIPè§’è‰²CPUæ ¸å¿ƒæ•°å†…å­˜Hostnamecentos7192.168.33.11master24096Mmastercentos7192.168.33.12worker24096Mnode1centos7192.168.33.13worker24096Mnode2ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡Œå°±ä¸å†åˆ›å»ºæ–°çš„è™šæ‹Ÿæœºå®‰è£…NFSï¼Œç›´æŽ¥åœ¨192.168.33.13èŠ‚ç‚¹ä¸Šå‡†å¤‡å¥½NFSçŽ¯å¢ƒã€‚åœ¨192.168.33.13èŠ‚ç‚¹ä¸Šæ‰§è¡Œä»¥ä¸‹bashå‘½ä»¤ï¼š12345678# åˆ›å»ºç›®å½•mkdir /nfs# ä¿®æ”¹æƒé™chmod 777 /nfs# åˆ›å»ºexportsæ–‡ä»¶vim /etc/exportsexportså†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š1/nfs *(rw,insecure,sync,no_subtree_check,no_root_squash)è®©é…ç½®ç”Ÿæ•ˆï¼š1exportfs -rå¯åŠ¨NFSï¼š1234systemctl enable nfssystemctl enable rpcbindsystemctl restart nfssystemctl restart rpcbindæŽ¥ç€åœ¨masterèŠ‚ç‚¹ä¸Šï¼Œåˆ›å»ºtest-pv-pvc.ymlé…ç½®æ–‡ä»¶ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495apiVersion: v1kind: PersistentVolumemetadata: name: nfs-pvspec: capacity: storage: 1Gi accessModes: - ReadWriteMany nfs: server: 192.168.33.13 path: "/nfs"---apiVersion: v1kind: PersistentVolumeClaimmetadata: name: nfs-pvcspec: accessModes: - ReadWriteMany resources: requests: storage: 1Gi---apiVersion: v1kind: ReplicationControllermetadata: name: busyboxspec: replicas: 1 selector: name: busybox template: metadata: labels: name: busybox spec: containers: - image: busybox command: - sh - -c - 'while true; do echo hello world &gt; /mnt/index.html; sleep $(($RANDOM % 5 + 5)); done' imagePullPolicy: IfNotPresent name: busybox volumeMounts: - name: nfs mountPath: "/mnt" volumes: - name: nfs persistentVolumeClaim: claimName: nfs-pvc---apiVersion: v1kind: ReplicationControllermetadata: name: nginxspec: replicas: 1 selector: name: nginx template: metadata: labels: name: nginx spec: containers: - name: nginx image: nginx ports: - name: web containerPort: 80 volumeMounts: - name: nfs mountPath: "/usr/share/nginx/html" volumes: - name: nfs persistentVolumeClaim: claimName: nfs-pvc---kind: ServiceapiVersion: v1metadata: name: nginx-servicespec: ports: - port: 80 nodePort: 30000 type: NodePort selector: name: nginxä¸Šé¢çš„é…ç½®æ–‡ä»¶æ•ˆæžœå¯ä»¥ç”¨ä¸‹é¢è¿™å¼ å›¾è¡¨ç¤ºï¼šä¸»è¦è¿‡ç¨‹å°±æ˜¯busyboxé€šè¿‡nfs-pvcç»‘å®šäº†nfs-pvï¼Œç„¶åŽå®šæ—¶å°†hello worldå†™åˆ°å®¹å™¨å†…éƒ¨/mnt/index.htmlæ–‡ä»¶ä¸­ï¼Œè€Œå®¹å™¨å†…éƒ¨/mntå’ŒPVçš„/nfsç›®å½•æŒ‚è½½ï¼›nginxä¹Ÿé€šè¿‡nfs-pvcç»‘å®šäº†nfs-pvï¼Œå°†/nfsç›®å½•å’Œå®¹å™¨å†…éƒ¨/usr/share/nginx/htmlç›®å½•æŒ‚è½½ï¼›æˆ‘ä»¬åŽç»­å¯ä»¥é€šè¿‡è®¿é—®æµè§ˆå™¨http://192.168.33.11:30000/åœ°å€æŸ¥çœ‹æ•ˆæžœã€‚åˆ›å»ºè¯¥é…ç½®æ–‡ä»¶:æŸ¥çœ‹192.168.33.13è™šæ‹Ÿæœº/nfsç›®å½•ä¸‹æ˜¯å¦å·²ç»å­˜åœ¨index.htmlæ–‡ä»¶ï¼Œå¹¶æŸ¥çœ‹å†…å®¹ï¼šæµè§ˆå™¨è®¿é—®http://192.168.33.11:30000/ï¼šè¯´æ˜Žæ•´ä¸ªæµç¨‹æ²¡é—®é¢˜ã€‚]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CI/CDå®žè·µç¬”è®°]]></title>
    <url>%2FCI-CD-Practice-Note.html</url>
    <content type="text"><![CDATA[CICDï¼ˆContinuous Integration/Continuous Deploymentï¼‰ï¼ŒæŒç»­é›†æˆæŒç»­éƒ¨ç½²çš„æ„æ€ã€‚å®ŒæˆCICDå®žè·µéœ€è¦Kubernetesé›†ç¾¤ï¼ŒHarborï¼ŒGitLabå’ŒJenkinsç­‰è½¯ä»¶é…åˆå®Œæˆï¼Œåœ¨å‰é¢å‡ ç¯‡åšå®¢ä¸­ï¼Œæˆ‘å·²ç»æ­å»ºå¥½äº†Kubernetesé›†ç¾¤ï¼Œå¹¶ä¸”åœ¨masterèŠ‚ç‚¹ï¼ˆ192.168.33.11,CentOSï¼‰ä¸Šå®‰è£…å¥½äº†Harborã€GitLabå’ŒJenkinsï¼Œæœ‰éœ€è¦å¯ä»¥å‚è€ƒä¸‹ã€‚å®žè·µå‡†å¤‡CICDæµç¨‹å›¾CICDçš„å¤§è‡´æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¼€å‘è€…å°†æœ€æ–°ä»£ç æäº¤åˆ°GitLabä»“åº“ï¼›GitLab WebHookè§¦å‘Jenkinsæž„å»ºæµæ°´çº¿ï¼š2.1 æ‹‰å–æœ€æ–°ä»£ç ï¼›2.2 Mavenæ‰“åŒ…ï¼Œæ‰“åŒ…è¿‡ç¨‹ä¸­ä¼šå…ˆè¿›è¡Œå•å…ƒæµ‹è¯•ï¼›2.3 å•å…ƒæµ‹è¯•é€šè¿‡ï¼Œæž„å»ºDockeré•œåƒï¼›2.4 å°†æœ€æ–°é•œåƒæŽ¨é€åˆ°Harborï¼›2.5 æ›´æ–°Kubernetesç›¸å…³é…ç½®é•œåƒç‰ˆæœ¬ã€‚Kubernetesæ„ŸçŸ¥åˆ°é•œåƒæ›´æ–°ï¼Œä»ŽHarboræ‹‰å–æœ€æ–°é•œåƒï¼Œæ»šåŠ¨å‡çº§ï¼›å¼€å‘è€…çœ‹åˆ°æœ€æ–°çš„ä»£ç æ•ˆæžœã€‚é¡¹ç›®å‡†å¤‡è¿™é‡Œæˆ‘ä»¬åœ¨Windowsä¸Šä½¿ç”¨IDEAã€Spring Bootæž„å»ºä¸€ä¸ªç®€å•çš„Java Webé¡¹ç›®ï¼Œé¡¹ç›®åä¸ºdemoï¼Œé¡¹ç›®pomå¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.2.1.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;demo&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;demo&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;åœ¨Bootå…¥å£ç±»ä¸­æ·»åŠ ä¸€ä¸ªç®€å•çš„Controlleræ–¹æ³•ï¼š12345678910111213@RestController@SpringBootApplicationpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125; @GetMapping("hello") public String index() &#123; return "hello world"; &#125;&#125;ä¸Šé¢æ–¹æ³•æä¾›äº†ä¸€ä¸ª/helloæŽ¥å£ï¼Œç®€å•è¿”å›žhello worldä¿¡æ¯ã€‚æŽ¥ç€ç¼–å†™ä¸€ä¸ªç®€å•çš„å•å…ƒæµ‹è¯•ï¼šä»£ç å¦‚ä¸‹ï¼š1234567891011121314@RunWith(SpringRunner.class)@SpringBootTest@AutoConfigureMockMvcclass DemoApplicationTests &#123; @Autowired private MockMvc mockMvc; @Test void testIndex() throws Exception &#123; mockMvc.perform(MockMvcRequestBuilders.get("/hello")) .andExpect(MockMvcResultMatchers.content().string("hello world")); &#125;&#125;æœ€åŽåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªDockerfileï¼š12345FROM openjdk:8u212-jreMAINTAINER MrBird 852252810@qq.comCOPY target/demo-0.0.1-SNAPSHOT.jar /demo-0.0.1-SNAPSHOT.jarENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/demo-0.0.1-SNAPSHOT.jar&quot;]è‡³æ­¤ç®€å•çš„Java Webé¡¹ç›®å°±å‡†å¤‡å¥½äº†ã€‚GitLabå‡†å¤‡æ³¨å†Œä¸€ä¸ªæ–°çš„GitLabè´¦å·ï¼Œæ¯”å¦‚mrbirdï¼Œç„¶åŽåœ¨GitLabæ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œåç§°ä¸ºDemoï¼šå› ä¸ºæˆ‘ä»¬åŽç»­éœ€è¦åœ¨Windowsä¸‹å°†é¡¹ç›®æäº¤åˆ°GitLabï¼Œå¹¶åœ¨192.168.33.11ä¸Šæ‹‰å–è¯¥é¡¹ç›®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨Windowså’Œ192.168.33.11æœåŠ¡å™¨ä¸Šç”ŸæˆSSH Keyï¼Œå¹¶æ·»åŠ åˆ°GitLabä¸­ã€‚åœ¨WindowsåŠ192.168.33.11è™šæ‹Ÿæœºé€šè¿‡ä¸‹é¢çš„å‘½ä»¤ç”ŸæˆSSH Keyï¼š123ssh-keygen -t rsa -C "852252810@qq.com"cat ~/.ssh/id_rsa.pubå°†SSH Keyæ·»åŠ åˆ°GitLabï¼šè¿™æ ·æˆ‘ä»¬åŽç»­çš„pushå’Œpullæ“ä½œå°±ä¸éœ€è¦è¾“å…¥ç”¨æˆ·åäº†ã€‚æŽ¥ç€æˆ‘ä»¬å°†ä¸Šé¢åˆ›å»ºçš„Demoé¡¹ç›®æŽ¨é€åˆ°GitLabä¸­ï¼ˆåœ¨IDEAçš„Terminalçª—å£ä¸­æ“ä½œï¼Œä¸ªäººä¹ æƒ¯ç”¨å‘½ä»¤è¡Œï¼‰ï¼š123456789101112131415# é…ç½®Gitgit config --global user.name &quot;mrbird&quot;git config --global user.email &quot;852252810@qq.com&quot;# åˆå§‹åŒ–Gitä»“åº“git init# commitgit commit -am init# æ·»åŠ è¿œç¨‹ä»“åº“git remote add origin ssh://git@gitlab.mrbird.cc:2223/mrbird/demo.git# æŽ¨é€åˆ°è¿œç¨‹ä»“åº“git push origin masteræŽ¨é€æˆåŠŸåŽï¼Œå›žåˆ°GitLabé¡µé¢å¯ä»¥çœ‹åˆ°é¡¹ç›®å·²ç»æŽ¨é€OKäº†ï¼šKuberneteséƒ¨ç½²SpringBooté¡¹ç›®åœ¨192.168.33.11æœåŠ¡å™¨ä¸Šå°†åˆšåˆšçš„é¡¹ç›®ä»ŽGitLabä¸­å…‹éš†ä¸‹æ¥:1git clone ssh://git@gitlab.mrbird.cc:2223/mrbird/demo.gitå› ä¸ºæ‰“åŒ…éœ€è¦MavençŽ¯å¢ƒï¼Œæ‰€ä»¥æŽ¥ç€é…ç½®Mavenï¼š12345678# ä¸‹è½½Mavenå®‰è£…åŒ…wget http://mirrors.tuna.tsinghua.edu.cn/apache/maven/maven-3/3.6.2/binaries/apache-maven-3.6.2-bin.tar.gz# è§£åŽ‹tar -xzvf apache-maven-3.6.2-bin.tar.gz# ä¿®æ”¹çŽ¯å¢ƒå˜é‡vim /etc/profileæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š12M2_HOME=/home/vagrant/apache-maven-3.6.2export PATH=$PATH:$JAVA_HOME/bin:$M2_HOME/binè®©ä¿®æ”¹ç”Ÿæ•ˆï¼š1source /etc/profileéªŒè¯ä¸‹æ˜¯å¦å®‰è£…æˆåŠŸï¼šçŽ¯å¢ƒå‡†å¤‡å¥½åŽï¼Œå°†ç›®å½•åˆ‡æ¢åˆ°åˆšåˆšgit cloneçš„demoç›®å½•ä¸‹ï¼Œæ‰§è¡Œmvn clean packageå‘½ä»¤ï¼Œå®ŒæˆåŽå¯ä»¥çœ‹åˆ°fat jarï¼šæŽ¥ç€æ‰§è¡Œdocker build -t docker.mrbird.cc/febs/demo .å‘½ä»¤æž„å»ºdockeré•œåƒï¼šæž„å»ºæˆåŠŸåŽæ‰§è¡Œdocker push docker.mrbird.cc/febs/demoå‘½ä»¤æŽ¨é€åˆ°Harborï¼šè®¿é—®Harborç®¡ç†é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°é•œåƒå·²ç»æŽ¨é€ä¸Šæ¥äº†ï¼šæŽ¥ç€ç¼–å†™ä¸ªç®€å•çš„Kubernetesé…ç½®æ–‡ä»¶ï¼ˆdemo.ymlï¼‰ï¼š123456789101112131415161718192021222324252627282930313233343536373839apiVersion: v1kind: Servicemetadata: name: demo-servicespec: type: NodePort ports: - port: 8080 targetPort: 8080 nodePort: 30000 selector: name: demo-app---apiVersion: apps/v1kind: Deploymentmetadata: name: demo-deploymentspec: selector: matchLabels: name: demo-app replicas: 2 template: metadata: labels: name: demo-app spec: containers: - name: demo image: docker.mrbird.cc/febs/demo ports: - containerPort: 8080 resources: limits: cpu: 500m memory: 500Mi requests: cpu: 200m memory: 200Miè¿è¡Œè¯¥é…ç½®:ä½¿ç”¨æµè§ˆå™¨è®¿é—®http://192.168.33.11:30000/hello:è‡³æ­¤Spring Booté¡¹ç›®å·²ç»æˆåŠŸè¿è¡Œåœ¨Kubernetesé›†ç¾¤ä¸­äº†ï¼ŒæŽ¥ä¸‹æ¥å¼€å§‹æ¼”ç¤ºå¦‚ä½•è¿›è¡ŒCICDã€‚CICDå®žè·µå°±å¦‚ä¸Šé¢CICDæµç¨‹å›¾æ‰€ç¤ºï¼Œç¬¬ä¸€æ­¥å°†æœ¬åœ°å¼€å‘ä»£ç pushåˆ°GitLabå·²ç»å®žçŽ°äº†ï¼ŒæŽ¥ä¸‹æ¥å¼€å§‹é…ç½®GitLab WebHookã€‚GitLab WebHookåœ¨Jenkinsä¸­åˆ›å»ºæµæ°´çº¿å‰ï¼Œå…ˆä¿®æ”¹ä¸¤å¤„Jenkinsé…ç½®ã€‚ç‚¹å‡»Jenkinsç®¡ç†é¡µé¢çš„ç³»ç»Ÿç®¡ç†èœå• -&gt; å…¨å±€å®‰å…¨é…ç½®ï¼šå…³é—­CSRFä¿æŠ¤å’Œå¼€å¯åŒ¿åç”¨æˆ·å…·æœ‰å¯è¯»æƒé™ã€‚ç„¶åŽç‚¹å‡»æ–°å»ºä»»åŠ¡èœå•ï¼Œæ–°å¢žä¸€ä¸ªåç§°ä¸ºdemoçš„æµæ°´çº¿ï¼Œå‹¾é€‰è§¦å‘è¿œç¨‹æž„å»ºï¼šä»¤ç‰Œè®¾ç½®ä¸º666666ï¼Œè§¦å‘åœ°å€ä¸ºJENKINS_URL/job/demo/build?token=TOKEN_NAMEï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªåœ°å€é…ç½®ä¸ºGitLabçš„WebHookä¸­ã€‚æ‰“å¼€GitLabçš„Demoé¡¹ç›®é¡µé¢ï¼Œç‚¹å‡»å·¦ä¾§çš„è®¾ç½®èœå•ï¼šé€‰æ‹©integrationsï¼šå…¶ä¸­http://192.168.33.11:8081ä¸ºæˆ‘çš„Jenkinsåœ°å€ï¼Œå¯¹åº”JENKINS_URLï¼›666666æ˜¯æˆ‘ä»¬è®¾ç½®çš„ä»¤ç‰Œï¼Œå¯¹åº”TOKEN_NAMEã€‚è§¦å‘äº‹ä»¶é€‰æ‹©push eventå°±è¡Œã€‚ä¿å­˜WebHookçš„æ—¶å€™å¦‚æžœæç¤ºUrl is blocked: Requests to the local network are not allowedçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨admin@example.comè´¦å·ç™»å½•GitLabï¼ˆå¯†ç å°±æ˜¯ä½ ç¬¬ä¸€æ¬¡ç™»å½•ä¿®æ”¹çš„å¯†ç ï¼‰ï¼Œç„¶åŽç‚¹å‡»Admin Area-&gt;Settings-&gt;Networkï¼šå‹¾é€‰Allow requests to the local network from web hooks and serviceså³å¯ã€‚ä¿å­˜åŽï¼Œé‡æ–°ä½¿ç”¨mrbirdè´¦å·ç™»å½•é‡æ–°é…ç½®WebHookå³å¯ã€‚é…ç½®å¥½åŽï¼Œæµ‹è¯•ä¸€ä¸‹ï¼šé¡µé¢å¼¹å‡ºå¦‚ä¸‹æç¤ºè¯´æ˜Žé…ç½®ðŸ†—ï¼šä»£ç æ‹‰å–Mavenæ‰“åŒ…å‰éœ€è¦å…ˆç”¨gitå‘½ä»¤å°†ä»£ç æ‹‰å–ä¸‹æ¥ã€‚ç¼–è¾‘åˆšåˆšåˆ›å»ºçš„æµæ°´çº¿ï¼Œåœ¨Pipeline scriptä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š12345678910111213141516#!groovypipeline &#123; agent any environment &#123; REPOSITORY="ssh://git@gitlab.mrbird.cc:2223/mrbird/demo.git" &#125; stages &#123; stage('æ‹‰å–ä»£ç ') &#123; steps &#123; echo "ä»ŽGitLabåœ°å€$&#123;REPOSITORY&#125;æ‹‰å–ä»£ç " deleteDir() git "$&#123;REPOSITORY&#125;" &#125; &#125; &#125;&#125;Pipeline scriptçš„åŸºæœ¬æ¨¡æ¿ä¸ºï¼š123456789101112131415#!groovypipeline &#123; agent any environment &#123; // å®šä¹‰å…¨å±€å˜é‡ &#125; stages &#123; // å¯ä»¥å®šä¹‰å¤šä¸ªé˜¶æ®µ stage('é˜¶æ®µåç§°') &#123; steps &#123; // å…·ä½“æ­¥éª¤ &#125; &#125; &#125;&#125;å›žåˆ°ä¸Šé¢çš„Pipeline scriptä»£ç ï¼Œæˆ‘ä»¬ä¸»è¦åšäº†ä¸‹é¢å‡ ä»¶äº‹ï¼šåœ¨environmentä¸­å®šä¹‰GitLabé¡¹ç›®ä»“åº“åœ°å€å˜é‡ï¼Œæ–¹ä¾¿ä¸‹é¢ç›´æŽ¥å¼•ç”¨ï¼›é€šè¿‡echoå‘½ä»¤è¾“å‡ºï¼Œæ–¹ä¾¿åŽç»­ä»Žæ—¥å¿—ä¸­è§‚å¯Ÿè·Ÿè¸ªï¼›é€šè¿‡deleteDir()æ¸…ç©ºå·¥ä½œåŒºï¼›é€šè¿‡git &quot;${REPOSITORY}&quot;ä»ŽæŒ‡å®šGitä»“åº“æ‹‰å–ä»£ç ã€‚å…¶ä¸­ï¼Œä½¿ç”¨environmentä¸­çš„å˜é‡æ—¶å€™ï¼Œä¸€å®šè¦ç”¨&quot;${xx}&quot;çš„æ–¹å¼å¼•ç”¨ï¼›ç¬¬3ç¬¬4æ­¥çš„å‘½ä»¤å¯ä»¥é€šè¿‡æµæ°´çº¿è¯­æ³•æ¥ç”Ÿæˆï¼Œæ¯”å¦‚ç”Ÿæˆæ¸…ç©ºå½“å‰ç›®å½•çš„å‘½ä»¤ï¼šç”Ÿæˆé€šè¿‡Gitæ‹‰å–ä»£ç çš„å‘½ä»¤ï¼šä¿®æ”¹å¥½æµæ°´çº¿åŽï¼Œç‚¹å‡»ç«‹å³æž„å»ºï¼Œçœ‹çœ‹æˆ‘ä»¬çš„é…ç½®æ˜¯å¦ðŸ†—ï¼šä»Žæ—¥å¿—æ¥çœ‹ï¼Œä»£ç æ‹‰å–æ˜¯æˆåŠŸçš„ã€‚Mavenæ‰“åŒ…å’Œå•å…ƒæµ‹è¯•Jenkins é€šè¿‡shellè„šæœ¬è°ƒç”¨mvn å‘½ä»¤çš„æ—¶å€™ï¼Œæ˜¯ä»Ž/usr/bin æ–‡ä»¶å¤¹ä¸­æ‰¾å‘½ä»¤çš„ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦åšä¸ªè½¯é“¾æŽ¥ï¼š1ln -s /home/vagrant/apache-maven-3.6.2/bin/mvn /usr/bin/mvnæ›´æ–°æµæ°´çº¿çš„Pipeline scriptï¼Œæ·»åŠ mavenæ‰“åŒ…é˜¶æ®µå‘½ä»¤ï¼š12345678910111213141516171819202122#!groovypipeline &#123; agent any environment &#123; REPOSITORY="ssh://git@gitlab.mrbird.cc:2223/mrbird/demo.git" &#125; stages &#123; stage('æ‹‰å–ä»£ç ') &#123; steps &#123; echo "ä»ŽGitLabåœ°å€$&#123;REPOSITORY&#125;æ‹‰å–ä»£ç " deleteDir() git "$&#123;REPOSITORY&#125;" &#125; &#125; stage('ä»£ç ç¼–è¯‘åŠå•å…ƒæµ‹è¯•') &#123; steps &#123; echo "å¼€å§‹ç¼–è¯‘ä»£ç å’Œå•å…ƒæµ‹è¯•" sh "mvn -U -am clean package" &#125; &#125; &#125;&#125;mavenæ‰“åŒ…å‰ä¼šè‡ªåŠ¨è¿è¡Œæˆ‘ä»¬åœ¨é¡¹ç›®é‡Œå†™å¥½çš„å•å…ƒæµ‹è¯•ï¼Œä¿®æ”¹åŽï¼Œç‚¹å‡»ç«‹å³æž„å»ºï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼ˆæˆªå–å…³é”®éƒ¨åˆ†ï¼‰ï¼šå¯ä»¥çœ‹åˆ°å•å…ƒæµ‹è¯•åŠæ‰“åŒ…æˆåŠŸã€‚æž„å»ºé•œåƒåŠæŽ¨é€é•œåƒæž„å»ºå’ŒæŽ¨é€æ¶‰åŠå‘½ä»¤è¾ƒå¤šï¼Œæ‰€ä»¥å¯ä»¥å®šä¹‰ä¸€ä¸ªè„šæœ¬ï¼š1vim build_push.shè„šæœ¬å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112#!/bin/bashMODULE=$1TIME=`date &quot;+%Y%m%d%H%M&quot;`GIT_REVISION=`git log -1 --pretty=format:&quot;%h&quot;`IMAGE_NAME=docker.mrbird.cc/febs/$&#123;MODULE&#125;:$&#123;TIME&#125;_$&#123;GIT_REVISION&#125;docker build -t $&#123;IMAGE_NAME&#125; .docker push $&#123;IMAGE_NAME&#125;echo &quot;$&#123;IMAGE_NAME&#125;&quot; &gt; image_nameä¸Šé¢è„šæœ¬å®šä¹‰äº†ä¸‰ä¸ªå˜é‡ï¼šMODULEï¼Œæ¨¡å—åç§°ï¼Œç”±è„šæœ¬æ‰§è¡Œçš„æ—¶å€™ä¼ å…¥ï¼›TIMEï¼Œæ—¶é—´å­—ç¬¦ä¸²ï¼›GIT_REVISIONï¼Œgit æäº¤åŽ†å²å“ˆå¸Œç çš„å‰7ä½ï¼›IMAGE_NAMEï¼Œé•œåƒåç§°ã€‚è„šæœ¬åšçš„äº‹æƒ…å¾ˆç®€å•ï¼Œæ ¹æ®å½“å‰ç›®å½•çš„Dockerfileæž„å»ºDockeré•œåƒï¼Œç„¶åŽå°†é•œåƒæŽ¨é€åˆ°Harborä»“åº“ï¼ŒæŽ¨é€åŽï¼Œå°†é•œåƒåç§°å†™åˆ°å½“å‰ç›®å½•ä¸‹çš„image_nameæ–‡ä»¶ä¸­ï¼ˆä¾›åŽç»­ä½¿ç”¨ï¼‰ã€‚ç»™è„šæœ¬æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼š1chmod +x build_push.shä¿®æ”¹Pipeline scriptï¼Œæ–°å¢žæž„å»ºé•œåƒåŠæŽ¨é€é˜¶æ®µå‘½ä»¤ï¼š1234567891011121314151617181920212223242526272829#!groovypipeline &#123; agent any environment &#123; REPOSITORY=&quot;ssh://git@gitlab.mrbird.cc:2223/mrbird/demo.git&quot; SCRIPT_PATH=&quot;/home/vagrant/bash&quot; &#125; stages &#123; stage(&apos;æ‹‰å–ä»£ç &apos;) &#123; steps &#123; echo &quot;ä»ŽGitLabåœ°å€$&#123;REPOSITORY&#125;æ‹‰å–ä»£ç &quot; deleteDir() git &quot;$&#123;REPOSITORY&#125;&quot; &#125; &#125; stage(&apos;ä»£ç ç¼–è¯‘åŠå•å…ƒæµ‹è¯•&apos;) &#123; steps &#123; echo &quot;å¼€å§‹ç¼–è¯‘ä»£ç å’Œå•å…ƒæµ‹è¯•&quot; sh &quot;mvn -U -am clean package&quot; &#125; &#125; stage(&apos;Dockeré•œåƒæž„å»ºåŠæŽ¨é€&apos;) &#123; steps &#123; echo &quot;å¼€å§‹æž„å»ºDockeré•œåƒå¹¶æŽ¨é€åˆ°Harbor&quot; sh &quot;$&#123;SCRIPT_PATH&#125;/build_push.sh demo&quot; &#125; &#125; &#125;&#125;å…¶ä¸­SCRIPT_PATHæ˜¯ä¸Šé¢å®šä¹‰çš„è„šæœ¬çš„è·¯å¾„ã€‚ä¿®æ”¹å¥½Pipeline scriptï¼Œé‡æ–°ç‚¹å‡»ç«‹å³æž„å»ºï¼Œæˆªå–å’Œè¿™éƒ¨åˆ†ç›¸å…³çš„æ—¥å¿—ï¼šæŸ¥çœ‹é•œåƒåˆ—è¡¨ï¼šKubernetes Deploymentå‡çº§åœ¨/home/vagrant/bashç›®å½•ä¸‹æ–°å»ºdeploy.shè„šæœ¬ï¼š12345#!/bin/bashIMAGE=`cat image_name`kubectl set image deployment/demo-deployment demo=$&#123;IMAGE&#125;è„šæœ¬å†…å®¹å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡kubectlå‘½ä»¤å‡çº§ç›¸å…³Podçš„é•œåƒï¼Œé•œåƒåç§°ä»Žimage_nameæ–‡ä»¶ä¸­è¯»å–ã€‚ä¿®æ”¹Pipeline scriptï¼Œæ·»åŠ Kubernetes Deploymentå‡çº§é˜¶æ®µå‘½ä»¤ï¼š1234567891011121314151617181920212223242526272829303132333435#!groovypipeline &#123; agent any environment &#123; REPOSITORY="ssh://git@gitlab.mrbird.cc:2223/mrbird/demo.git" SCRIPT_PATH="/home/vagrant/bash" &#125; stages &#123; stage('æ‹‰å–ä»£ç ') &#123; steps &#123; echo "ä»ŽGitLabåœ°å€$&#123;REPOSITORY&#125;æ‹‰å–ä»£ç " deleteDir() git "$&#123;REPOSITORY&#125;" &#125; &#125; stage('ä»£ç ç¼–è¯‘åŠå•å…ƒæµ‹è¯•') &#123; steps &#123; echo "å¼€å§‹ç¼–è¯‘ä»£ç å’Œå•å…ƒæµ‹è¯•" sh "mvn -U -am clean package" &#125; &#125; stage('Dockeré•œåƒæž„å»ºåŠæŽ¨é€') &#123; steps &#123; echo "å¼€å§‹æž„å»ºDockeré•œåƒå¹¶æŽ¨é€åˆ°Harbor" sh "$&#123;SCRIPT_PATH&#125;/build_push.sh demo" &#125; &#125; stage('æ›´æ–°Kubernetes Deployment') &#123; steps &#123; echo "å¼€å§‹æ›´æ–°Kubernetes Deployment" sh "$&#123;SCRIPT_PATH&#125;/deploy.sh" &#125; &#125; &#125;&#125;ä¿®æ”¹åŽï¼Œç‚¹å‡»ç«‹å³æž„å»ºï¼šè‡³æ­¤æˆ‘ä»¬æ•´æ¡CICDæµç¨‹å°±å·²ç»éƒ½é€šäº†ï¼Œä¸‹é¢æµ‹è¯•ä¸‹CICDã€‚æ•ˆæžœæµ‹è¯•å¦‚ä¸Šé¢æ‰€ç¤ºï¼Œæˆ‘ä»¬è®¿é—®http://192.168.33.11:30000/helloï¼Œé¡µé¢è¿”å›žhello worldï¼Œæˆ‘ä»¬åœ¨IDEAä¸­ä¿®æ”¹Controlleræ–¹æ³•ï¼šåŒæ—¶ä¿®æ”¹å•å…ƒæµ‹è¯•æ–¹æ³•ï¼šä¿®æ”¹åŽåœ¨IDEAçš„å‘½ä»¤çª—å£è¾“å…¥ï¼š123git commit -am updategit push origin masterå°†æœ€æ–°çš„ä»£ç æäº¤åˆ°GitLabåŽï¼Œè¿‡ä¸€å°ä¼šåˆ·æ–°http://192.168.33.11:30000/helloï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¿®æ”¹çš„å†…å®¹å·²ç»ç”Ÿæ•ˆäº†ï¼š]]></content>
      <tags>
        <tag>GitLab</tag>
        <tag>CI/CD</tag>
        <tag>DevOps</tag>
        <tag>Harbor</tag>
        <tag>Kubernetes</tag>
        <tag>Jenkins</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GitLab & Jenkinså®‰è£…å°è®°]]></title>
    <url>%2FGitLab-Jenkins-Install-Note.html</url>
    <content type="text"><![CDATA[åœ¨CentOSä¸‹å®‰è£…GitLabå’ŒJenkinsã€‚å®‰è£…GitLabä¼ ç»Ÿæ–¹å¼å®‰è£…GitLabæ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Dockerå®‰è£…GitLabï¼Œæ‹‰å–å®˜æ–¹é•œåƒï¼š1docker pull gitlab/gitlab-ce:latesté•œåƒæœ‰ç‚¹å¤§ï¼Œè€å¿ƒç­‰å¾…ã€‚æ‹‰å–å¥½åŽï¼Œç¼–å†™ä¸€ä¸ªå¯åŠ¨è„šæœ¬ï¼š12345678910111213cat &lt;&lt;EOF &gt; run_gitlab.sh#!/bin/bashdocker stop gitlabdocker rm gitlabdocker run -d \ --hostname gitlab.mrbird.cc \ -p 8443:443 -p 8080:80 -p 2223:22 \ --name gitlab \ -v /gitlab/config:/etc/gitlab \ -v /gitlab/logs:/var/log/gitlab \ -v /gitlab/data:/var/opt/gitlab \ gitlab/gitlab-ce:latestEOF--hostname gitlab.mrbird.ccç»‘å®šåŸŸåï¼Œç«¯å£æ˜ å°„äº†ä¸‹ï¼Œé˜²æ­¢å’Œå®¿ä¸»æœºå†²çªã€‚æ‰§è¡Œchmod u+x run_gitlab.shæ·»åŠ å¯æ‰§è¡Œæƒé™ï¼Œç„¶åŽè¿è¡Œsh run_gitlab.shå¯åŠ¨GitLabã€‚æ‰§è¡Œå¯åŠ¨è„šæœ¬åŽï¼Œä½¿ç”¨docker logs -f gitlabæŸ¥çœ‹å¯åŠ¨æ—¥å¿—ï¼Œç¬¬ä¸€æ¬¡å¯åŠ¨æ¯”è¾ƒæ…¢ï¼Œå½“æ—¥å¿—å®šæ—¶è¾“å‡º/metricså†…å®¹æ—¶è¯´æ˜ŽGitLabå·²å¯åŠ¨å®Œæ¯•ï¼š12==&gt; /var/log/gitlab/gitlab-rails/sidekiq_exporter.log &lt;==[2019-11-03T03:35:18.170+0000] 127.0.0.1 - - [03/Nov/2019:03:35:18 UTC] &quot;GET /metrics HTTP/1.1&quot; 200 6162 &quot;-&quot; &quot;Prometheus/2.12.0&quot;å¯åŠ¨åŽï¼Œä¿®æ”¹gitlab.rbæ–‡ä»¶ï¼š1vim /gitlab/config/gitlab.rbå¼€å¯è¿™æ®µé…ç½®ï¼Œå¹¶ä¸”ç«¯å£å·æ”¹ä¸ºä¸Šé¢æŒ‡å®šçš„2223ï¼šç„¶åŽæ‰§è¡Œsh run_gitlab.shé‡å¯å³å¯ã€‚é‡å¯åŽï¼Œåœ¨è™šæ‹Ÿæœºå’Œwindowsé‡Œæ·»åŠ hostsè§£æžï¼š1192.168.33.11 gitlab.mrbird.ccä½¿ç”¨æµè§ˆå™¨è®¿é—®http://gitlab.mrbird.cc:8080/ï¼šGitLabè¿˜æ˜¯æ¯”è¾ƒå å†…å­˜çš„ï¼Œåœ¨å®‰è£…GitLabå‰è¯·ç¡®ä¿å†…å­˜å¤Ÿç”¨ðŸŒšï¼š1234docker stats gitlabCONTAINER ID NAME CPU % MEM USAGE / LIMIT MEM % NET I/O BLOCK I/O PIDSd8edbda28f9f gitlab 6.80% 1.944GiB / 3.701GiB 52.54% 130kB / 2.29MB 118MB / 2.52MB 281å®‰è£…JenkinsJenkinsçš„è¯ï¼ŒæŽ¨èç”¨ä¼ ç»Ÿæ–¹å¼å®‰è£…ï¼Œè¿™æ ·å®¿ä¸»æœºä¸Šå®‰è£…çš„mavenã€dockerã€kubectlç­‰å‘½ä»¤å¯ä»¥ç›´æŽ¥ä½¿ç”¨ã€‚åœ¨å®‰è£…Jenkinsä¹‹å‰ï¼Œéœ€è¦æœ‰Javaï¼ˆæˆ‘å®‰è£…çš„æ˜¯1.8ç‰ˆæœ¬ï¼‰çŽ¯å¢ƒï¼Œåœ¨CentOS7ä¸Šå®‰è£…JDKçš„è¿‡ç¨‹å°±ä¸æ¼”ç¤ºäº†ï¼Œä¹‹å‰åœ¨https://mrbird.cc/FEBS-Vue-Document.htmlä¸­ä¹Ÿæœ‰ä»‹ç»è¿‡ã€‚å®‰è£…å¥½JDKåŽï¼Œä¸‹è½½Jenkins waråŒ…ï¼š1wget http://mirrors.jenkins.io/war-stable/latest/jenkins.warç¼–å†™ä¸€ä¸ªå¯åŠ¨è„šæœ¬run_jenkins.shï¼š1vim run_jenkins.shå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123#!/bin/bashnohup java -jar jenkins.war --httpPort=8081 &amp;æŽˆæƒï¼š1chmod u+x run_jenkins.shå¯åŠ¨Jenkinsï¼š1sh run_jenkins.shå½“å¯åŠ¨æ—¥å¿—è¾“å‡ºå¦‚ä¸‹å†…å®¹æ—¶ï¼Œè¯´æ˜Žjenkinså·²æˆåŠŸå¯åŠ¨ï¼š1234567891011121314***************************************************************************************************************************************************************************************Jenkins initial setup is required. An admin user has been created and a password generated.Please use the following password to proceed to installation:6ddc10e56b574f27a360986f84da19fcThis may also be found at: /root/.jenkins/secrets/initialAdminPassword***************************************************************************************************************************************************************************************å…¶ä¸­6ddc10e56b574f27a360986f84da19fcä¸ºJenkinsçš„å¯†ç ï¼Œè¯¥å¯†ç ä¹Ÿå¯ä»¥åœ¨/root/.jenkins/secrets/initialAdminPasswordæ–‡ä»¶æ‰¾åˆ°ã€‚ä½¿ç”¨æµè§ˆå™¨è®¿é—®http://192.168.33.11:8081/ï¼šè¾“å…¥ä¸Šé¢çš„å¯†ç ï¼Œè¿›å…¥ï¼šç‚¹å‡»â€œé€‰æ‹©æ’ä»¶å®‰è£…â€ï¼Œç„¶åŽPipelines and Continuous Deliveryä¸€æ ä¸­çš„æ‰€æœ‰æ’ä»¶éƒ½å‹¾é€‰ä¸Šï¼šç„¶åŽç‚¹å‡»å®‰è£…å³å¯ï¼Œå®‰è£…ç»“æŸåŽï¼ŒæŽ¥ç€åˆ›å»ºç”¨æˆ·ï¼šç‚¹å‡»é‡å¯ï¼šç”¨åˆšåˆšåˆ›å»ºçš„ç”¨æˆ·ç™»å½•å³å¯ï¼š]]></content>
      <tags>
        <tag>GitLab</tag>
        <tag>Jenkins</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­å»ºDockeré•œåƒä»“åº“Harbor]]></title>
    <url>%2FHarbor.html</url>
    <content type="text"><![CDATA[Harboræ˜¯ä¸€æ¬¾å¼€æºçš„Dockeré•œåƒå­˜å‚¨ä»“åº“ï¼Œå…¶æ‰©å±•äº†Docker Distributionï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ äº†æˆ‘ä»¬å¸¸ç”¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å®‰å…¨è®¤è¯ï¼ŒRBACç”¨æˆ·æƒé™ç®¡ç†ï¼Œå¯è§†åŒ–é¡µé¢æ“ä½œç­‰åŠŸèƒ½ã€‚Harborè¿˜æ”¯æŒå¤šä¸ªHarborä»“åº“é—´çš„ç›¸äº’æ‹·è´ï¼Œä»¥å®žçŽ°Dockeré•œåƒä»“åº“çš„é«˜å¯ç”¨ã€‚è¿™èŠ‚æˆ‘ä»¬åœ¨CentOSè™šæ‹Ÿæœºï¼ˆ192.168.33.11ï¼‰ä¸Šæ­å»ºä¸ªå•æœºç‰ˆçš„Harborä½“éªŒä¸€ä¸‹ã€‚å®‰è£…Harboråœ¨Harborçš„GitHubä»“åº“ï¼šhttps://github.com/goharbor/harbor/releasesä¸‹è½½ç¦»çº¿ç‰ˆæœ¬ï¼ˆofflineï¼‰ï¼Œæˆ‘é€‰æ‹©çš„ç‰ˆæœ¬æ˜¯1.8.4ï¼šä¸‹è½½åŽï¼Œå°†åŽ‹ç¼©åŒ…harbor-offline-installer-v1.8.4.tgzä¸Šä¼ åˆ°192.168.33.11æœåŠ¡å™¨ä¸Šï¼šè§£åŽ‹åŽ‹ç¼©åŒ…ï¼šä¿®æ”¹Harboré…ç½®æ–‡ä»¶ï¼šå°†hostnameä¿®æ”¹ä¸ºå®¿ä¸»æœºIPå³å¯ï¼šç„¶åŽæ‰§è¡Œå½“å‰ç›®å½•ä¸‹çš„install.shè„šæœ¬è¿›è¡Œå®‰è£…ã€‚å®‰è£…è¿‡ç¨‹ä¸­å‡ºçŽ°å¦‚ä¸‹é”™è¯¯ï¼šæ ¹æ®https://docs.docker.com/compose/install/å®‰è£…docker composeåŽé‡æ–°æ‰§è¡Œinstall.shè„šæœ¬ã€‚å‡ºçŽ°å¦‚ä¸‹ä¿¡æ¯æ—¶ï¼Œå®‰è£…æˆåŠŸ:ä½¿ç”¨æµè§ˆå™¨è®¿é—®http://192.168.33.11/åœ°å€ï¼Œå¯ä»¥çœ‹åˆ°Harborçš„ç®¡ç†ç•Œé¢ï¼šé»˜è®¤çš„ç”¨æˆ·åå¯†ç ä¸ºï¼šadminï¼ŒHarbor12345ï¼Œç™»å½•åŽï¼šä¸ºäº†åŽç»­æŽ¨é€é•œåƒæ–¹ä¾¿ï¼Œæˆ‘ä»¬éœ€è¦ç»™192.168.33.11é…ç½®åŸŸåï¼Œæ·»åŠ hostsè§£æžï¼š1192.168.33.11 docker.mrbird.ccåˆ›å»ºç”¨æˆ·å’Œé¡¹ç›®åœ¨http://192.168.33.11/Harborç®¡ç†ç•Œé¢ä¸‹æ–°å¢žä¸€ä¸ªç”¨æˆ·ï¼šç„¶åŽæ–°å¢žä¸€ä¸ªé¡¹ç›®ï¼šåœ¨è¯¥é¡¹ç›®ä¸‹æ·»åŠ åˆšåˆšåˆ›å»ºçš„mrbirdç”¨æˆ·ï¼šæŽ¥ç€åœ¨192.168.33.11ä¸Šè¿›è¡Œç™»å½•:ç”¨æˆ·åå’Œå¯†ç å°±æ˜¯åˆšåˆšåœ¨æŽ§åˆ¶å°åˆ›å»ºçš„mrbirdç”¨æˆ·å’Œå¯†ç ã€‚ä½†æ˜¯ç™»å½•å¤±è´¥äº†ï¼Œè¦ç™»å½•åˆ°http dockerä»“åº“ï¼Œéœ€è¦æ·»åŠ ä¸€äº›é…ç½®ï¼š1vim /etc/docker/daemon.jsonæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼šé‡å¯dockerï¼š1sudo service docker restartç„¶åŽé‡æ–°ç™»å½•å³å¯ï¼šæµ‹è¯•é•œåƒæŽ¨æ‹‰æ‹‰å–nginx:1.17.5é•œåƒï¼š1docker pull nginx:1.17.5æ‰“æ ‡ç­¾:1docker tag nginx:1.17.5 docker.mrbird.cc/febs/nginx:1.17.5æ ‡ç­¾æ ¼å¼ä¸º[dockerä»“åº“åŸŸå]:[é¡¹ç›®åç§°]:[é•œåƒ]ã€‚å°†docker.mrbird.cc/febs/nginx:1.17.5æŽ¨é€åˆ°Harborï¼š1docker push docker.mrbird.cc/febs/nginxå›žåˆ°HarboræŽ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°åœ¨febsé¡¹ç›®ä¸‹å·²ç»å­˜åœ¨ä¸€ä¸ªnginxé•œåƒï¼šåœ¨192.168.33.12æœåŠ¡å™¨ä¸Šæ·»åŠ docker.mrbird.ccçš„è§£æžï¼Œç„¶åŽæ‹‰å–åˆšåˆšçš„é•œåƒï¼Œçœ‹çœ‹æ˜¯å¦æˆåŠŸï¼š1docker pull docker.mrbird.cc/febs/nginx:1.17.5æ‹‰å–æˆåŠŸã€‚]]></content>
      <tags>
        <tag>Harbor</tag>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetesèµ„æºç®¡ç†]]></title>
    <url>%2FKubernetes-Resource-Management.html</url>
    <content type="text"><![CDATA[é€šè¿‡å‰é¢çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡requestså’Œlimitsç»™PodæŒ‡å®šèµ„æºé…ç½®ï¼Œä½†å¦‚æžœæ¯ä¸ªPodéƒ½è¦æŒ‡å®šçš„è¯ç•¥æ˜¾ç¹çï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨LimitRangeæŒ‡å®šä¸€ä¸ªå…¨å±€çš„é»˜è®¤é…ç½®ï¼›æ­¤å¤–é€šè¿‡ResourceQuotaå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰èµ„æºé…é¢ï¼Œè¿™ä¸ªèµ„æºé…é¢å¯ä»¥ä¸ºæ¯ä¸ªå‘½åç©ºé—´éƒ½æä¾›ä¸€ä¸ªæ€»ä½“çš„èµ„æºä½¿ç”¨çš„é™åˆ¶ï¼šå®ƒå¯ä»¥é™åˆ¶å‘½åç©ºé—´ä¸­æŸç§ç±»åž‹çš„å¯¹è±¡çš„æ€»æ•°ç›®ä¸Šé™ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å‘½åç©ºé—´ä¸­Podå¯ä»¥ä½¿ç”¨çš„è®¡ç®—èµ„æºçš„æ€»ä¸Šé™ã€‚LimitRangeåœ¨ä½¿ç”¨LimitRangeä¹‹å‰å…ˆåˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ï¼š1234apiVersion: v1kind: Namespacemetadata: name: test-resourceç„¶åŽå®šä¹‰LimitRangeé…ç½®ï¼ˆlimit-range.ymlï¼‰:1234567891011121314151617181920212223242526272829303132apiVersion: v1kind: LimitRangemetadata: name: limit-range-examplespec: limits: - max: cpu: 2 memory: 2Gi min: cpu: 200m memory: 6Mi maxLimitRequestRatio: cpu: 3 memory: 2 type: Pod - default: cpu: 300m memory: 200Mi defaultRequest: cpu: 200m memory: 100Mi max: cpu: 2 memory: 1Gi min: cpu: 100m memory: 3Mi maxLimitRequestRatio: cpu: 5 memory: 4 type: Containeråˆ›å»ºè¯¥LimitRangeï¼šå¯ä»¥çœ‹åˆ°é…ç½®å·²ç»ç”Ÿæ•ˆäº†ã€‚ä¸‹é¢ä»‹ç»ä¸‹è¿™äº›é…ç½®çš„å«ä¹‰ï¼šä¸Šé¢é…ç½®åˆ†ä¸ºPodå’ŒContaineré…ç½®ï¼ŒContainerèµ„æºé…ç½®å¯¹åº”æ¯ä¸ªDockerå®¹å™¨çš„èµ„æºé…ç½®ï¼ŒPodèµ„æºé…ç½®å¯¹åº”ä¸€ä¸ªPodä¸­æ‰€æœ‰å®¹å™¨èµ„æºçš„æ€»å’Œã€‚å…¶ä¸­Podå’ŒContaineréƒ½å¯ä»¥æŒ‡å®šminï¼Œmaxå’ŒmaxLimitRequestRatioï¼šminï¼šæŒ‡å®šèµ„æºçš„ä¸‹é™ï¼Œå³æœ€ä½Žèµ„æºé…ç½®ä¸èƒ½ä½ŽäºŽè¿™ä¸ªå€¼ï¼›maxï¼šæŒ‡å®šèµ„æºçš„ä¸Šé™ï¼Œå³æœ€é«˜èµ„æºä½¿ç”¨ä¸èƒ½é«˜äºŽè¿™ä¸ªå€¼ï¼›maxLimitRequestRatioï¼šè¯¥å€¼ç”¨äºŽæŒ‡å®šrequestså’Œlimitså€¼æ¯”ä¾‹çš„ä¸Šé™ã€‚ç›¸è¾ƒäºŽPodï¼ŒContainerè¿˜å¯ä»¥æŒ‡å®šdefaultRequestå’Œdefaultï¼ˆå®žé™…ä¸Šå°±æ˜¯defaultLimitï¼Œä¸æ‡‚ä¸ºä»€ä¹ˆKubernetesä¸ç”¨è¿™ä¸ªåç§°ðŸ˜µï¼‰ï¼šdefaultRequestï¼šå…¨å±€å®¹å™¨çš„é»˜è®¤requestså€¼ï¼›defaultï¼šå…¨å±€å®¹å™¨çš„é»˜è®¤limitså€¼ã€‚ä¸‹é¢æˆ‘ä»¬ä¸¾å‡ ä¸ªä¾‹å­ï¼Œçœ‹çœ‹æˆ‘ä»¬åˆ›å»ºçš„LimitRangeæ˜¯å¦ç”Ÿæ•ˆã€‚å®šä¹‰ä¸€ä¸ªPodé…ç½®æ–‡ä»¶ï¼ˆtest-default.ymlï¼‰ï¼š12345678910apiVersion: v1kind: Podmetadata: name: test-defaultspec: containers: - name: nginx image: nginx ports: - containerPort: 80åˆ›å»ºè¯¥Podï¼šå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨test-default.ymlä¸­å¹¶æ²¡æœ‰å®šä¹‰requestså’Œlimitsé…ç½®ï¼Œä½†æ˜¯é€šè¿‡Podå®žä¾‹çš„yamlå¯ä»¥çœ‹åˆ°å®ƒå·²ç»æŒ‡å®šäº†è¿™ä¸¤ä¸ªå€¼ï¼Œè€Œè¿™äº›æ­£æ˜¯ä¸Šé¢æˆ‘ä»¬åœ¨LimitRangeä¸­å®šä¹‰çš„é»˜è®¤å€¼ã€‚æŽ¥ç€å®šä¹‰ä¸€ä¸ªæ–°çš„Podé…ç½®ï¼ˆtest-max.ymlï¼‰:1234567891011121314apiVersion: v1kind: Podmetadata: name: test-maxspec: containers: - name: nginx image: nginx ports: - containerPort: 80 resources: limits: cpu: 3 memory: 500Miåˆ›å»ºè¯¥Podï¼šå¯ä»¥çœ‹åˆ°åœ¨åˆ›å»ºçš„æ—¶å€™å°±æŠ¥é”™äº†ï¼Œå› ä¸ºä¸Šé¢çš„cpué…ç½®å³è¶…è¿‡äº†LimtRangeä¸­å®šä¹‰çš„Containerçš„cpuæœ€é«˜é…ç½®ï¼Œä¹Ÿè¶…è¿‡äº†Podçš„cpuçš„æœ€é«˜é…ç½®ã€‚å†åˆ›å»ºä¸€ä¸ªPodé…ç½®ï¼ˆtest-ratio.ymlï¼‰ï¼š1234567891011121314151617apiVersion: v1kind: Podmetadata: name: test-ratiospec: containers: - name: nginx image: nginx ports: - containerPort: 80 resources: limits: cpu: 2 memory: 500Mi requests: cpu: 300m memory: 50Miåˆ›å»ºè¯¥Podï¼šå¯ä»¥çœ‹åˆ°ä¹ŸæŠ¥é”™äº†ï¼Œå› ä¸ºrequestså’Œlimitsçš„æ¯”ä¾‹ä¸ç¬¦åˆLimitRangeçš„maxLimitRequestRatioé…ç½®ã€‚LimitRangeçš„æµ‹è¯•å…ˆåˆ°è¿™é‡Œå§ï¼Œé€šè¿‡ä¸Šé¢ä¸‰ä¸ªä¾‹å­å¤§ä½“ä¹Ÿèƒ½æ„Ÿå—åˆ°LimitRangeçš„ä½œç”¨äº†ã€‚ResourceQuotaResourceQuotaç”¨äºŽç®¡ç†èµ„æºé…é¢ï¼Œè¿™ä¸ªèµ„æºé…é¢å¯ä»¥ä¸ºæ¯ä¸ªå‘½åç©ºé—´éƒ½æä¾›ä¸€ä¸ªæ€»ä½“çš„èµ„æºä½¿ç”¨çš„é™åˆ¶ã€‚èµ„æºé…é¢ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªç±»åž‹ï¼šè®¡ç®—èµ„æºé…é¢èµ„æºåç§°è¯´æ˜ŽCpuæ‰€æœ‰éžç»ˆæ­¢çŠ¶æ€çš„Podï¼ŒCPU Requestsçš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼limits.cpuæ‰€æœ‰éžç»ˆæ­¢çŠ¶æ€çš„Podï¼Œ CPU Limitsçš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼limits.memoryæ‰€æœ‰éžç»ˆæ­¢çŠ¶æ€çš„Podï¼Œå†…å­˜ Limitsçš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼Memoryæ‰€æœ‰éžç»ˆæ­¢çŠ¶æ€çš„Podï¼Œ å†…å­˜ Requestsçš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼requests.cpuæ‰€æœ‰éžç»ˆæ­¢çŠ¶æ€çš„Podï¼ŒCPU Requestsçš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼requests.memoryæ‰€æœ‰éžç»ˆæ­¢çŠ¶æ€çš„Podï¼Œ å†…å­˜Requestsçš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼å­˜å‚¨èµ„æºé…é¢èµ„æºåç§°è¯´æ˜Žrequests.storageæ‰€æœ‰PVCï¼Œå­˜å‚¨è¯·æ±‚æ€»é‡ä¸èƒ½è¶…è¿‡æ­¤å€¼PersistentVolumeclaimsåœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„æŒä¹…å·çš„æ€»æ•°ä¸Šé™.storageclass.storage.k8s.io/requests.storageå’Œè¯¥å­˜å‚¨ç±»å…³è”çš„æ‰€æœ‰PVCï¼Œå­˜å‚¨è¯·æ±‚æ€»å’Œä¸èƒ½è¶…è¿‡æ­¤å€¼.storageclass.storage.k8s.io/persistentvolumeclaimså’Œè¯¥å­˜å‚¨ç±»å…³è”çš„æ‰€æœ‰PVCçš„æ€»å’Œå¯¹è±¡æ•°é‡é…é¢èµ„æºåç§°è¯´æ˜ŽConfigmapsåœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„ConfigMapçš„æ€»æ•°ä¸Šé™Podsåœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„éžç»ˆæ­¢çŠ¶æ€Podçš„æ€»æ•°ä¸Šé™ï¼ŒPodç»ˆæ­¢çŠ¶æ€ç­‰ä»·äºŽPodçš„status.phase in(Failed, Succeeded) = trueReplicationcontrollersåœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„RCçš„æ€»æ•°ä¸Šé™Resourcequtasåœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„èµ„æºé…é¢é¡¹çš„æ€»æ•°ä¸Šé™Servicesåœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„Serviceçš„æ€»æ•°ä¸Šé™service.loadbalancersåœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„è´Ÿè½½å‡è¡¡çš„æ€»æ•°ä¸Šé™services.nodeportsåœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„NodePortçš„æ€»æ•°ä¸Šé™Secretsåœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„Secretçš„æ€»æ•°ä¸Šé™æµ‹è¯•åœ¨æµ‹è¯•ResourceQuotaä¹‹å‰æˆ‘ä»¬ä¹Ÿå…ˆåˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ï¼š1234apiVersion: v1kind: Namespacemetadata: name: quota-nsåˆ›å»ºä¸ªç®€å•çš„ResourceQuotaé…ç½®ï¼ˆtest-quota.ymlï¼‰ï¼š1234567apiVersion: v1kind: ResourceQuotametadata: name: test-quotaspec: hard: pods: &quot;4&quot;åˆ›å»ºè¯¥ResourceQuotaï¼šæŽ¥ç€å®šä¹‰ä¸€ä¸ªRCé…ç½®ï¼ˆnginx-rc.ymlï¼‰ï¼š12345678910111213141516171819apiVersion: v1kind: ReplicationControllermetadata: name: nginx-rcspec: replicas: 3 selector: name: nginx template: metadata: labels: name: nginx spec: containers: - name: nginx image: nginx imagePullPolicy: IfNotPresent ports: - containerPort: 80åˆ›å»ºè¯¥RC:å¯ä»¥çœ‹åˆ°ï¼Œå·²ç»æœ‰3ä¸ªPodå®žä¾‹äº†ï¼Œå¦‚æžœå°†Podæ•°é‡æ‰©å¤§åˆ°5ï¼Œçœ‹çœ‹ä¼šæ€Žæ ·ï¼šæœ€ç»ˆä¹Ÿåªä¼šæœ‰4ä¸ªPodå®žä¾‹ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ä¸Šé¢ResourceQuotaä¸­æŒ‡å®šçš„æœ€å¤§Podæ•°é‡ä¸º4ã€‚ã€ŠKubernetesæƒå¨æŒ‡å—(ç¬¬4ç‰ˆ)ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes Namespace&Context]]></title>
    <url>%2FKubernetes-Namespaces-Context.html</url>
    <content type="text"><![CDATA[åœ¨ä¸€ä¸ªç»„ç»‡å†…éƒ¨ï¼Œä¸åŒçš„å·¥ä½œç»„å¯ä»¥åœ¨åŒä¸€ä¸ªKubernetesé›†ç¾¤ä¸­å·¥ä½œï¼ŒKubernetesé€šè¿‡å‘½åç©ºé—´å’ŒContextçš„è®¾ç½®å¯¹ä¸åŒçš„å·¥ä½œç»„è¿›è¡ŒåŒºåˆ†ï¼Œä½¿å¾—å®ƒä»¬æ—¢å¯ä»¥å…±äº«åŒä¸€ä¸ªKubernetesé›†ç¾¤çš„æœåŠ¡ï¼Œä¹Ÿèƒ½å¤Ÿäº’ä¸å¹²æ‰°ã€‚Namespaceçš„åˆ›å»ºKubernetesé›†ç¾¤ä¼šå¸®æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåç§°ä¸ºdefaultçš„å‘½åç©ºé—´ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„podã€rcã€serviceç­‰Kubernetesèµ„æºéƒ½æ˜¯ä½¿ç”¨è¿™ä¸ªå‘½åç©ºé—´ï¼Œæ­¤å¤–æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„å‘½åç©ºé—´ã€‚å®šä¹‰ä¸€ä¸ªå‘½åç©ºé—´é…ç½®dev-namesapce.ymlï¼š1234apiVersion: v1kind: Namespacemetadata: name: dev # devå‘½åç©ºé—´åˆ›å»ºè¯¥å‘½åç©ºé—´ï¼šä½¿ç”¨Namespaceä½¿ç”¨å‘½åç©ºé—´åªéœ€è¦åœ¨åˆ›å»ºKubernetesèµ„æºå¯¹è±¡çš„æ—¶å€™æŒ‡å®šå³å¯ï¼Œæ¯”å¦‚åˆ›å»ºä¸€ä¸ªtomcat-rc.ymlï¼Œå¹¶æŒ‡å®šå‘½åç©ºé—´ä¸ºdevï¼š123456789101112131415161718192021apiVersion: v1kind: ReplicationControllermetadata: name: tomcat-rc namespace: dev # æŒ‡å®šå‘½åç©ºé—´spec: replicas: 2 selector: name: tomcat template: metadata: name: tomcat labels: name: tomcat spec: containers: - name: tomcat image: tomcat ports: - containerPort: 8080 hostPort: 8081åˆ›å»ºè¯¥rcï¼šå¯ä»¥çœ‹åˆ°ï¼Œdefalutå‘½åç©ºé—´ä¸‹å¹¶æ²¡æœ‰ä»»ä½•podï¼Œè€Œdevå‘½åç©ºé—´ä¸‹åˆ™æœ‰ä¸¤ä¸ªtomcat podå®žä¾‹ã€‚å‘½åç©ºé—´åªæ˜¯åç§°ä¸Šçš„éš”ç¦»ï¼Œä¸åŒå‘½åç©ºé—´ä¸‹çš„podï¼Œserviceç­‰è¿˜æ˜¯å¯ä»¥ç›¸äº’è®¿é—®çš„ã€‚Contextçš„åˆ›å»ºå’Œä½¿ç”¨æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºContextï¼ˆä¸Šä¸‹æ–‡ï¼‰ï¼ŒæŒ‡å®šä½¿ç”¨çš„å‘½åç©ºé—´ï¼Œç„¶åŽä½¿ç”¨è¯¥Contextï¼Œæ¥å®Œæˆé»˜è®¤çš„å‘½åç©ºé—´åˆ‡æ¢ã€‚åœ¨åˆ›å»ºContextå‰ï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸‹Kubernetesé»˜è®¤çš„é…ç½®ï¼šå¯ä»¥çœ‹åˆ°ï¼Œå½“å‰é»˜è®¤çš„Contextåç§°ä¸ºkubernetes-admin@kubernetesï¼Œç”±æ­¤å¯ä»¥æŽ¨æ–­ï¼Œå®ƒå’Œdefalutè¿™ä¸ªå‘½åç©ºé—´æŒ‚é’©ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„Contextï¼Œåç§°ä¸ºctx-devï¼Œå‘½åç©ºé—´ä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„devï¼šå…¶ä¸­/root/.kube/configä¸ºKubernetesé…ç½®ã€‚åˆ›å»ºæˆåŠŸåŽï¼Œæˆ‘ä»¬ä½¿ç”¨ctx-devè¿™ä¸ªContextï¼šå¯ä»¥çœ‹åˆ°ï¼ŒçŽ°åœ¨ä¸éœ€è¦æŒ‡å®š-n devå°±å¯ä»¥èŽ·å–åˆ°devå‘½åç©ºé—´ä¸‹çš„podäº†ï¼Œä¹Ÿè¯å®žäº†Contextçš„åˆ‡æ¢æ˜¯æˆåŠŸçš„ã€‚å¦‚æžœæƒ³è¦æ¢å¤é»˜è®¤çš„Contextï¼Œå°†ContextæŒ‡å®šä¸ºkubernetes-admin@kubernetesï¼š]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes ServiceåŸºç¡€]]></title>
    <url>%2FKubernetes-Service-Basic.html</url>
    <content type="text"><![CDATA[Kuberneteså¯ä»¥ä¸ºä¸€ç»„å…·æœ‰ç›¸åŒåŠŸèƒ½çš„Podæä¾›ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£åœ°å€ï¼Œå¹¶ä¸”å°†è¯·æ±‚å‡è¡¡çš„è½¬å‘åˆ°å„ä¸ªå¯¹åº”çš„Podä¸Šã€‚æœ¬èŠ‚ä¸»è¦è®°å½•Serviceçš„ä¸€äº›åŸºæœ¬ç”¨æ³•ã€‚åŸºæœ¬ç”¨æ³•åˆ›å»ºä¸€ä¸ªTomcat RCï¼ˆtomcat-rc.ymlï¼‰:12345678910111213141516171819apiVersion: v1kind: ReplicationControllermetadata: name: tomcat-rcspec: replicas: 2 selector: name: tomcat template: metadata: name: tomcat labels: name: tomcat spec: containers: - name: tomcat image: tomcat ports: - containerPort: 8080åˆ›å»ºè¯¥RCï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡Node IP + Container Portåœ¨Kubernetesé›†ç¾¤ä¸­è®¿é—®Tomcatï¼šç”±äºŽPodæ˜¯Kubernetesé›†ç¾¤èŒƒå›´å†…çš„è™šæ‹Ÿæ¦‚å¿µï¼Œé›†ç¾¤å¤–çš„å®¢æˆ·ç«¯æ— æ³•é€šè¿‡Podçš„IPå’Œç«¯å£è®¿é—®ï¼Œæˆ‘ä»¬å¯ä»¥å°†Podçš„ç«¯å£å·æ˜ å°„åˆ°å®¿ä¸»æœºï¼Œä»¥ä½¿å®¢æˆ·ç«¯åº”ç”¨èƒ½å¤Ÿé€šè¿‡ç‰©ç†æœºè®¿é—®å®¹å™¨åº”ç”¨ï¼Œä¿®æ”¹åˆšåˆšçš„tomcat-rc.ymlï¼Œæ·»åŠ hostPortï¼š1234567891011121314151617181920apiVersion: v1kind: ReplicationControllermetadata: name: tomcat-rcspec: replicas: 2 selector: name: tomcat template: metadata: name: tomcat labels: name: tomcat spec: containers: - name: tomcat image: tomcat ports: - containerPort: 8080 hostPort: 8081 # æ–°å¢žæ›´æ–°è¯¥RCï¼šå¯ä»¥çœ‹åˆ°tomcat podè¢«åˆ†é…åˆ°äº†node1å’Œnode2ä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨å®¿ä¸»æœºå¤–ä½¿ç”¨æˆ–è€…è®¿é—®tomcatï¼šä½†æ˜¯æˆ‘ä»¬çŸ¥é“ï¼ŒPodçš„IPåœ°å€æ˜¯ä¸å¯é çš„ï¼Œä¾‹å¦‚å½“Podæ‰€åœ¨çš„Nodeå‘ç”Ÿæ•…éšœæ—¶ï¼ŒPodå°†è¢«Kubernetesé‡æ–°è°ƒåº¦åˆ°å¦ä¸€ä¸ªNodeï¼ŒPodçš„IPåœ°å€å°†å‘ç”Ÿå˜åŒ–ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªtomcat podçš„ç»Ÿä¸€è®¿é—®å…¥å£ï¼Œè¿™å°±æ˜¯Serviceçš„ä½œç”¨ã€‚åˆ›å»ºServiceæœ‰ä¸¤ç§æ–¹å¼ï¼š1.kubectl exposeå‘½ä»¤æ¥åˆ›å»ºService1kubectl expose rc tomcat-rcçŽ°åœ¨æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡Serviceçš„clusterIP + Portæ¥è®¿é—®äº†ï¼šServiceåœ°å€10.1.187.222:8080å‡è¡¡çš„è´Ÿè½½åˆ°äº†ä¸¤ä¸ªtomcat podä¸Šï¼ˆ10.244.1.19:8080å’Œ10.244.4.13:8080ï¼‰2.é€šè¿‡é…ç½®æ–‡ä»¶åˆ›å»ºå®šä¹‰ä¸€ä¸ªtomcat-service.ymlï¼š12345678910apiVersion: v1kind: Servicemetadata: name: tomcat-servicespec: ports: - port: 8081 # serviceç«¯å£ targetPort: 8080 # ç›®æ ‡ç«¯å£ selector: name: tomcat # é€‰æ‹©å™¨ï¼Œé€‰æ‹©name=tomcatçš„podåˆ›å»ºè¯¥Serviceï¼šåŒæ ·ï¼ŒServiceé»˜è®¤æ˜¯ä¸èƒ½å¤–éƒ¨è®¿é—®çš„ï¼Œå¦‚æžœæƒ³è®©å¤–éƒ¨èƒ½å¤Ÿè®¿é—®åˆ°tomcat serviceï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å°†Serviceçš„ç«¯å£æ˜ å°„åˆ°ç‰©ç†æœºï¼Œä¿®æ”¹ä¸Šé¢çš„tomcat-service.ymlï¼š123456789101112apiVersion: v1kind: Servicemetadata: name: tomcat-servicespec: type: NodePort # æ–°å¢ž ports: - port: 8081 targetPort: 8080 nodePort: 30000 # æ–°å¢ž selector: name: tomcatä¸Šé¢é…ç½®é€šè¿‡è®¾ç½®nodePortï¼ˆèŒƒå›´30000-32767ï¼‰æ˜ å°„åˆ°ç‰©ç†æœºï¼ŒåŒæ—¶è®¾ç½®Serviceçš„ç±»åž‹ä¸ºNodePortï¼Œåˆ›å»ºè¯¥Serviceï¼šçŽ°åœ¨æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å®¿ä¸»æœºçš„IP+30000è®¿é—®tomcatäº†ï¼šè´Ÿè½½å‡è¡¡ç­–ç•¥Kubernetes Serviceæä¾›äº†ä¸¤ç§è´Ÿè½½åˆ†å‘ç­–ç•¥ï¼šRoundRobinå’ŒSessionAffinityï¼šRoundRobinï¼šè½®è¯¢æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ï¼Œå³è½®è¯¢å°†è¯·æ±‚è½¬å‘åˆ°åŽç«¯çš„å„ä¸ªPodä¸Šã€‚SessionAffinityï¼šåŸºäºŽå®¢æˆ·ç«¯IPåœ°å€è¿›è¡Œä¼šè¯ä¿æŒçš„æ¨¡å¼ï¼Œå³ç¬¬1æ¬¡å°†æŸä¸ªå®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚è½¬å‘åˆ°åŽç«¯çš„æŸä¸ªPodä¸Šï¼Œä¹‹åŽä»Žç›¸åŒçš„å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚éƒ½å°†è¢«è½¬å‘åˆ°åŽç«¯ç›¸åŒçš„Podä¸Šã€‚å¯ä»¥é€šè¿‡è®¾ç½®service.spec.sessionAffinity=ClientIPæ¥å¯ç”¨SessionAffinityç­–ç•¥ï¼š12345678910111213apiVersion: v1kind: Servicemetadata: name: tomcat-servicespec: type: NodePort sessionAffinity: ClientIP # é‡‡ç”¨SessionAffinityç­–ç•¥ ports: - port: 8081 targetPort: 8080 nodePort: 30000 selector: name: tomcatHeadless ServiceHeadless Serviceä¸æä¾›ClusterIPï¼Œä»…é€šè¿‡Label Selectorå°†åŽç«¯çš„Podåˆ—è¡¨è¿”å›žç»™è°ƒç”¨çš„å®¢æˆ·ç«¯ã€‚åˆ›å»ºtomcat-headless-service.ymlï¼š12345678910apiVersion: v1kind: Servicemetadata: name: tomcat-headless-servicespec: ports: - port: 8080 clusterIP: None # è®¾ç½®clusterIPä¸ºNoneï¼Œè¡¨ç¤ºheadless service selector: name: tomcatåˆ›å»ºè¯¥headless serviceï¼šã€ŠKubernetesæƒå¨æŒ‡å—(ç¬¬4ç‰ˆ)ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes Podæ‰©å®¹ä¸Žç¼©å®¹]]></title>
    <url>%2FKubernetes-Pod-Expansion-Contraction.html</url>
    <content type="text"><![CDATA[é’ˆå¯¹ä¸åŒæ—¶æœŸæµé‡çš„å¤§å°æˆ‘ä»¬å¯ä»¥ç»™Podæ‰©ç¼©å®¹ï¼ŒKubernetesæ”¯æŒé€šè¿‡kubectlå‘½ä»¤æ‰‹åŠ¨æ‰©ç¼©å®¹ï¼Œä¹Ÿæ”¯æŒé€šè¿‡HPAè‡ªåŠ¨æ¨ªå‘æ‰©ç¼©å®¹ã€‚æ‰‹åŠ¨æ‰©ç¼©å®¹çŽ°æœ‰å¦‚ä¸‹deploymenté…ç½®ï¼ˆnginx-deployment.ymlï¼‰ï¼š1234567891011121314151617181920apiVersion: apps/v1kind: Deploymentmetadata: name: nginx-deploymentspec: selector: matchLabels: name: nginx replicas: 3 template: metadata: labels: name: nginx spec: containers: - name: nginx image: nginx:1.7.9 imagePullPolicy: IfNotPresent ports: - containerPort: 80åˆ›å»ºè¯¥Deploymentï¼šæœ‰3ä¸ªnginxå®žä¾‹ï¼ŒçŽ°åœ¨ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤å°†nginxå®žä¾‹æ‰©å……åˆ°5ä¸ªï¼š1kubectl scale deployment nginx-deployment --replicas 5ç¼©å®¹ï¼š1kubectl scale deployment nginx-deployment --replicas 1HPAHPAèƒ½å¤Ÿæ ¹æ®ç‰¹å®šæŒ‡æ ‡å®Œæˆç›®æ ‡Podçš„è‡ªåŠ¨æ‰©ç¼©å®¹ã€‚åˆ›å»ºä¸€ä¸ªä¸Žä¸Šé¢nginx-deploymentç›¸å¯¹åº”çš„HPAï¼ˆnginx-deployment-hpa.ymlï¼‰ï¼š123456789101112apiVersion: autoscaling/v1kind: HorizontalPodAutoscalermetadata: name: nginx-deployment-hpa-v1spec: maxReplicas: 6 minReplicas: 2 scaleTargetRef: apiVersion: apps/v1 kind: Deployment name: nginx-deployment targetCPUUtilizationPercentage: 50ä¸»è¦å‚æ•°å¦‚ä¸‹ï¼šscaleTargetRefï¼šç›®æ ‡ä½œç”¨å¯¹è±¡ï¼Œå¯ä»¥æ˜¯Deploymentã€ReplicationControlleræˆ–ReplicaSetã€‚targetCPUUtilizationPercentageï¼šæœŸæœ›æ¯ä¸ªPodçš„CPUä½¿ç”¨çŽ‡éƒ½ä¸º50%ï¼Œè¯¥ä½¿ç”¨çŽ‡åŸºäºŽPodè®¾ç½®çš„CPU Requestå€¼è¿›è¡Œè®¡ç®—ï¼Œä¾‹å¦‚è¯¥å€¼ä¸º200mï¼Œé‚£ä¹ˆç³»ç»Ÿå°†ç»´æŒPodçš„å®žé™…CPUä½¿ç”¨å€¼ä¸º100mã€‚minReplicaså’ŒmaxReplicasï¼šPodå‰¯æœ¬æ•°é‡çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œç³»ç»Ÿå°†åœ¨è¿™ä¸ªèŒƒå›´å†…è¿›è¡Œè‡ªåŠ¨æ‰©ç¼©å®¹æ“ä½œï¼Œå¹¶ç»´æŒæ¯ä¸ªPodçš„CPUä½¿ç”¨çŽ‡ä¸º50%ã€‚ä½¿ç”¨HPAï¼Œéœ€è¦é¢„å…ˆå®‰è£…Metrics Serverï¼Œç”¨äºŽé‡‡é›†Podçš„CPUä½¿ç”¨çŽ‡ã€‚ã€ŠKubernetesæƒå¨æŒ‡å—(ç¬¬4ç‰ˆ)ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes Podå‡çº§ä¸Žå›žæ»š]]></title>
    <url>%2FKubernetes-Pod-Upgrade-And-Rollback.html</url>
    <content type="text"><![CDATA[å½“é›†ç¾¤ä¸­çš„æŸä¸ªæœåŠ¡éœ€è¦å‡çº§æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœæ­¢ç›®å‰ä¸Žè¯¥æœåŠ¡ç›¸å…³çš„æ‰€æœ‰Podï¼Œç„¶åŽä¸‹è½½æ–°ç‰ˆæœ¬é•œåƒå¹¶åˆ›å»ºæ–°çš„Podã€‚å¦‚æžœé›†ç¾¤è§„æ¨¡æ¯”è¾ƒå¤§ï¼Œåˆ™è¿™ä¸ªå·¥ä½œå˜æˆäº†ä¸€ä¸ªæŒ‘æˆ˜ï¼Œè€Œä¸”å…ˆå…¨éƒ¨åœæ­¢ç„¶åŽé€æ­¥å‡çº§çš„æ–¹å¼ä¼šå¯¼è‡´è¾ƒé•¿æ—¶é—´çš„æœåŠ¡ä¸å¯ç”¨ã€‚Kubernetesæä¾›äº†æ»šåŠ¨å‡çº§åŠŸèƒ½æ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚å¦‚æžœåœ¨æ›´æ–°è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯ï¼Œåˆ™è¿˜å¯ä»¥é€šè¿‡å›žæ»šæ“ä½œæ¢å¤Podçš„ç‰ˆæœ¬ã€‚Deploymentå‡çº§çŽ°æœ‰å¦‚ä¸‹deploymentå®šä¹‰ï¼ˆnginx-deployment.ymlï¼‰ï¼š1234567891011121314151617181920apiVersion: apps/v1kind: Deploymentmetadata: name: nginx-deploymentspec: selector: matchLabels: name: nginx replicas: 3 template: metadata: labels: name: nginx spec: containers: - name: nginx image: nginx:1.7.9 imagePullPolicy: IfNotPresent ports: - containerPort: 80åˆ›å»ºè¯¥deploymentï¼šé€šè¿‡kubectlå‘½ä»¤å°†nginxçš„ç‰ˆæœ¬æ›´æ–°åˆ°1.9.1ï¼š1kubectl set image deployment/nginx-deployment nginx=nginx:1.9.1æŸ¥çœ‹æ»šåŠ¨å‡çº§çš„è¿‡ç¨‹ï¼šæŸ¥çœ‹Podï¼Œä¼šå‘çŽ°åç§°å·²ç»æ”¹å˜äº†ï¼šä¸Šè¿°æ»šåŠ¨å‡çº§çš„è¿‡ç¨‹å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤ºï¼šæŸ¥çœ‹Deployment nginx-deploymentçš„è¯¦ç»†äº‹ä»¶ä¿¡æ¯å¯ä»¥è¯æ˜Žè¿™ä¸€ç‚¹ï¼š1kubectl describe deployments/nginx-deploymentæŸ¥çœ‹rsï¼šé»˜è®¤çš„å‡çº§ç­–ç•¥ä¸ºRollingUpdateï¼ˆæ»šåŠ¨æ›´æ–°ï¼‰ï¼ŒKubernetesè¿˜æ”¯æŒRecreateï¼ˆé‡å»ºï¼‰ç­–ç•¥ï¼šRecreateï¼šå…ˆæ€æŽ‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„Podï¼Œç„¶åŽåˆ›å»ºæ–°çš„Podã€‚RollingUpdateï¼šä»¥æ»šåŠ¨æ›´æ–°çš„æ–¹å¼æ¥é€ä¸ªæ›´æ–°Podã€‚åŒæ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®spec.strategy.rollingUpdateä¸‹çš„ä¸¤ä¸ªå‚æ•°ï¼ˆmaxUnavailableå’ŒmaxSurgeï¼‰æ¥æŽ§åˆ¶æ»šåŠ¨æ›´æ–°çš„è¿‡ç¨‹ã€‚RollingUpdateçš„ä¸¤ä¸ªå‚æ•°å«ä¹‰å¦‚ä¸‹ï¼šmaxUnavailableï¼šç”¨äºŽæŒ‡å®šDeploymentåœ¨æ›´æ–°è¿‡ç¨‹ä¸­ä¸å¯ç”¨çŠ¶æ€çš„Podæ•°é‡çš„ä¸Šé™ã€‚è¯¥maxUnavailableçš„æ•°å€¼å¯ä»¥æ˜¯ç»å¯¹å€¼ï¼ˆä¾‹å¦‚1ï¼‰æˆ–PodæœŸæœ›çš„å‰¯æœ¬æ•°çš„ç™¾åˆ†æ¯”ï¼ˆä¾‹å¦‚10%ï¼‰ã€‚maxSurgeï¼šç”¨äºŽæŒ‡å®šåœ¨Deploymentæ›´æ–°Podçš„è¿‡ç¨‹ä¸­Podæ€»æ•°è¶…è¿‡PodæœŸæœ›å‰¯æœ¬æ•°éƒ¨åˆ†çš„æœ€å¤§å€¼ã€‚è¯¥maxSurgeçš„æ•°å€¼å¯ä»¥æ˜¯ç»å¯¹å€¼ï¼ˆä¾‹å¦‚5ï¼‰æˆ–PodæœŸæœ›å‰¯æœ¬æ•°çš„ç™¾åˆ†æ¯”ï¼ˆä¾‹å¦‚10%ï¼‰ã€‚æ­¤å¤–ï¼Œé™¤äº†ä½¿ç”¨kubectlå‘½ä»¤å‡çº§å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æŽ¥é€šè¿‡ä¿®æ”¹deployment.ymlçš„æ–¹å¼æ¥å®Œæˆã€‚Deploymentå›žæ»šå¦‚æžœå‡çº§åŽæ•ˆæžœä¸æ»¡æ„çš„è¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†Deploymentå›žæ»šåˆ°å‡çº§ä¹‹å‰ï¼Œä½¿ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤æŸ¥çœ‹æ»šåŠ¨å‡çº§çš„åŽ†å²ï¼š1kubectl rollout history deployment/nginx-deploymentREVISIONä¸ºå‡çº§çš„åŽ†å²ç‰ˆæœ¬ï¼Œæˆ‘ä»¬åªå®Œæˆäº†nginxä»Ž1.7.9å‡çº§åˆ°1.9.1çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥REVISION 1è¡¨ç¤ºnginxä¸º1.7.9çš„ç‰ˆæœ¬ï¼ŒREVISION 2è¡¨ç¤ºnginxä¸º1.9.1çš„ç‰ˆæœ¬ã€‚å› ä¸ºæˆ‘ä»¬åœ¨åˆ›å»ºdeploymentçš„æ—¶å€™æ²¡æœ‰åŠ ä¸Š--record=trueå‚æ•°ï¼Œæ‰€ä»¥CHANGE-CACSEåˆ—æ˜¯ç©ºçš„ã€‚éœ€è¦æŸ¥çœ‹ç‰¹å®šç‰ˆæœ¬çš„è¯¦ç»†ä¿¡æ¯ï¼Œåˆ™å¯ä»¥åŠ ä¸Šâ€“revision=å‚æ•°ï¼šè¦å°†nginxå›žé€€åˆ°1.7.9ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥å°†REVISIONæŒ‡å®šä¸º1ï¼š1kubectl rollout undo deployment/nginx-deployment --to-revision=1æš‚åœä¸Žæ¢å¤å› ä¸ºDeploymenté…ç½®ä¸€æ—¦ä¿®æ”¹å°±ä¼šè§¦å‘å‡çº§æ“ä½œï¼Œæ‰€ä»¥å½“ä¿®æ”¹çš„åœ°æ–¹è¾ƒå¤šçš„æ—¶å€™å°±ä¼šé¢‘ç¹è§¦å‘å‡çº§ã€‚æˆ‘ä»¬å¯ä»¥å…ˆæš‚åœå‡çº§æ“ä½œï¼Œå½“æ‰€æœ‰é…ç½®éƒ½ä¿®æ”¹å¥½åŽå†æ¢å¤å‡çº§ã€‚æš‚åœï¼š1kubectl rollout pause deployment/nginx-deploymentæš‚åœåŽï¼Œå¯¹nginx-deploymentçš„ä¿®æ”¹ä¸ä¼šè§¦å‘å‡çº§ã€‚ä¿®æ”¹å¥½åŽï¼Œæ¢å¤å‡çº§ï¼š1kubectl rollout resume deployment/nginx-deploymentå…¶ä»–Podç®¡ç†å¯¹è±¡å‡çº§ç­–ç•¥DaemonSetDaemonSetçš„å‡çº§ç­–ç•¥åŒ…æ‹¬ä¸¤ç§ï¼šOnDeleteå’ŒRollingUpdateï¼šOnDeleteï¼ˆé»˜è®¤ï¼‰ï¼šåœ¨åˆ›å»ºå¥½æ–°çš„DaemonSeté…ç½®ä¹‹åŽï¼Œæ–°çš„Podå¹¶ä¸ä¼šè¢«è‡ªåŠ¨åˆ›å»ºï¼Œç›´åˆ°ç”¨æˆ·æ‰‹åŠ¨åˆ é™¤æ—§ç‰ˆæœ¬çš„Podï¼Œæ‰è§¦å‘æ–°å»ºæ“ä½œã€‚RollingUpdateï¼šå’Œå‰é¢ä»‹ç»çš„ä¸€è‡´ï¼Œä¸è¿‡ä¸æ”¯æŒrolloutï¼Œåªèƒ½é€šè¿‡å°†é…ç½®æ”¹å›žåŽ»æ¥å®žçŽ°ã€‚StatefulSetæ”¯æŒRecreateã€OnDeleteå’ŒRollingUpdateã€‚ã€ŠKubernetesæƒå¨æŒ‡å—(ç¬¬4ç‰ˆ)ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes Podç®¡ç†å¯¹è±¡ä¸Žè°ƒåº¦ç­–ç•¥]]></title>
    <url>%2FKubernetes-Pod-Mananger.html</url>
    <content type="text"><![CDATA[åœ¨å‰é¢çš„å­¦ä¹ ä¸­æˆ‘ä»¬äº†è§£åˆ°ï¼Œåœ¨Kubernetesä¸­ï¼ŒPodç®¡ç†å¯¹è±¡ä¸»è¦æœ‰RC(RS)ã€Deploymentã€StatefulSetã€DaemonSetå’ŒJobï¼ˆCronJobï¼‰ç­‰ã€‚å…¶ä¸­RC(RS)å’ŒDeploymentçš„ç”¨æ³•å·²ç»å¤§è‡´äº†è§£ï¼Œè¿™é‡Œä¸»è¦è®°å½•ä¸‹StatefulSetã€DaemonSetå’ŒJobï¼ˆCronJobï¼‰çš„ç”¨æ³•ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒPodç®¡ç†å¯¹è±¡åœ¨åˆ›å»ºPodçš„æ—¶å€™æ˜¯æ ¹æ®ç³»ç»Ÿè‡ªåŠ¨è°ƒåº¦ç®—æ³•æ¥å®Œæˆéƒ¨ç½²çš„ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®è°ƒåº¦ç­–ç•¥æ¥å®žçŽ°Podçš„ç²¾å‡†è°ƒåº¦ã€‚Podè°ƒåº¦ç­–ç•¥NodeSelectoræˆ‘ä»¬å¯ä»¥è¯¥æŸä¸ªèŠ‚ç‚¹Nodeè®¾ç½®æ ‡ç­¾ï¼Œç„¶åŽé€šè¿‡NodeSelectorè®©Podè°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ä¸Šã€‚å‰é¢æ­å»ºçš„Kubernetesé›†ç¾¤æœ‰ä¸¤ä¸ªworkerèŠ‚ç‚¹node1å’Œnode2ï¼Œæˆ‘ä»¬ç»™node2æ‰“ä¸ªæ ‡ç­¾ï¼š1kubectl label nodes node2 tier=frontendæŽ¥ç€å®šä¹‰ä¸€ä¸ªRCé…ç½®ï¼ˆnode-select-pod.ymlï¼‰ï¼š1234567891011121314151617181920apiVersion: v1kind: ReplicationControllermetadata: name: test-rcspec: replicas: 1 selector: name: nginx template: metadata: labels: name: nginx spec: containers: - name: nginx image: nginx ports: - containerPort: 80 nodeSelector: tier: frontendåˆ›å»ºè¯¥RCï¼Œè§‚å¯ŸPodæœ€ç»ˆè°ƒåº¦çš„èŠ‚ç‚¹ï¼šå¯ä»¥çœ‹åˆ°nginx podå·²ç»æˆåŠŸè°ƒåº¦åˆ°äº†node2èŠ‚ç‚¹ä¸Šã€‚Kubernetesä¼šç»™æ¯ä¸ªnodeè´´ä¸Šä¸€äº›é»˜è®¤çš„æ ‡ç­¾ï¼Œé€šè¿‡kubectl get node node1 -o yamlå¯ä»¥çœ‹åˆ°è¿™äº›é»˜è®¤çš„æ ‡ç­¾ï¼š12345beta.kubernetes.io/arch: amd64beta.kubernetes.io/os: linuxkubernetes.io/arch: amd64kubernetes.io/hostname: node1kubernetes.io/os: linuxè¿™äº›é»˜è®¤çš„æ ‡ç­¾åœ¨ä¸‹é¢è¿™äº›è°ƒåº¦ç­–ç•¥ä¸­ä¹Ÿæ˜¯è›®å¸¸ç”¨çš„ã€‚NodeAffinityAffinity[É™ËˆfÉªnÉ™ti]ï¼šäº²å’ŒåŠ›ï¼Œå–œå¥½ã€‚NodeAffinityä¸ºNodeäº²å’ŒåŠ›è°ƒåº¦ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªè§„åˆ™ï¼ˆåç§°æœ‰ç‚¹é•¿ï¼Œå¿«18cmäº†å§ï¼‰:RequiredDuringSchedulingIgnoredDuringExecutionï¼šå¿…é¡»æ»¡è¶³æŒ‡å®šçš„è§„åˆ™æ‰å¯ä»¥è°ƒåº¦Podï¼Œç¡¬è§„åˆ™ã€‚PreferredDuringSchedulingIgnoredDuringExecutionï¼šè½¯è§„åˆ™ï¼Œæœ€å¥½æ»¡è¶³æ‰€åˆ—å‡ºçš„æ¡ä»¶æ‰è°ƒåº¦Podã€‚IgnoredDuringExecutionçš„æ„æ€æ˜¯ï¼Œå¦‚æžœä¸€ä¸ªPodå·²ç»è°ƒåº¦åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Šäº†ï¼Œç„¶åŽè¿™ä¸ªèŠ‚ç‚¹çš„æ ‡ç­¾å‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆä¸å½±å“å·²ç»è°ƒåº¦å¥½çš„Podï¼Œignoreã€‚å®šä¹‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ˆnode-affinity.ymlï¼‰ï¼Œç”¨äºŽæ¼”ç¤ºNodeAffinityï¼š1234567891011121314151617181920212223242526272829303132333435apiVersion: v1kind: ReplicationControllermetadata: name: test-rcspec: replicas: 1 selector: name: nginx template: metadata: labels: name: nginx spec: containers: - name: nginx image: nginx ports: - containerPort: 80 affinity: nodeAffinity: requiredDuringSchedulingIgnoredDuringExecution: nodeSelectorTerms: - matchExpressions: - key: beta.kubernetes.io/arch operator: In values: - amd64 preferredDuringSchedulingIgnoredDuringExecution: - weight: 1 preference: matchExpressions: - key: disk-type operator: In values: - ssdä¸Šé¢é…ç½®ä½¿å¾—RCåœ¨è°ƒåº¦nginx podçš„æ—¶å€™éœ€è¦æ»¡è¶³ï¼šèŠ‚ç‚¹å…·æœ‰beta.kubernetes.io/arch=amd64æ ‡ç­¾ï¼Œå¦‚æžœå…·æœ‰disk-type=ssdæ ‡ç­¾å°±æ›´å¥½äº†ï¼Œæ¢å¥è¯è¯´å°±æ˜¯å¸Œæœ›nginx podè°ƒåº¦åœ¨cpuæž¶æž„ä¸ºamdï¼Œç£ç›˜ä¸ºssdçš„èŠ‚ç‚¹ä¸Šã€‚ä¸Šé¢é…ç½®ä¸­ï¼Œæ“ä½œç¬¦operatoré™¤äº†å¯ä»¥ä½¿ç”¨Inå¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨NotInã€Existsã€DoesNotExistã€Gtã€Ltã€‚NodeAffinityè§„åˆ™è®¾ç½®éœ€è¦æ³¨æ„çš„å‡ ä¸ªç‚¹ï¼šå¦‚æžœnodeAffinityæŒ‡å®šäº†å¤šä¸ªnodeSelectorTermsï¼Œé‚£ä¹ˆå…¶ä¸­ä¸€ä¸ªèƒ½å¤ŸåŒ¹é…æˆåŠŸå³å¯ï¼›å¦‚æžœåœ¨nodeSelectorTermsä¸­æœ‰å¤šä¸ªmatchExpressionsï¼Œåˆ™ä¸€ä¸ªèŠ‚ç‚¹å¿…é¡»æ»¡è¶³æ‰€æœ‰matchExpressionsæ‰èƒ½è¿è¡Œè¯¥Podã€‚è¿è¡Œä¸Šé¢è¿™ä¸ªé…ç½®ï¼šå¯ä»¥çœ‹åˆ°ï¼Œå› ä¸ºnode1å’Œnode2éƒ½å…·æœ‰beta.kubernetes.io/arch=amd64æ ‡ç­¾ï¼Œè€Œæ²¡æœ‰disk-type=ssdæ ‡ç­¾ï¼Œæ‰€ä»¥nginx podæœ‰å¯èƒ½è¢«è°ƒåº¦åˆ°node1ä¹Ÿæœ‰å¯èƒ½è¢«è°ƒåº¦åˆ°node2ã€‚æˆ‘ä»¬ç»™node1æ·»åŠ disk-type=ssdæ ‡ç­¾ï¼Œé‡æ–°è¿è¡Œä¸Šé¢çš„é…ç½®æ–‡ä»¶ï¼šå¯ä»¥çœ‹åˆ°ï¼Œnginx podè¢«è°ƒåº¦åˆ°äº†node1ä¸Šã€‚PodAffinityPodAffinityæŒ‡çš„æ˜¯Podäº²å’ŒåŠ›è°ƒåº¦è‚¡åˆ™ï¼Œæ¯”å¦‚æŸäº›èŠ‚ç‚¹å·²ç»å­˜åœ¨ä¸€äº›Podäº†ï¼Œæ–°çš„Podåœ¨è°ƒåº¦çš„æ—¶å€™å¸Œæœ›å’ŒæŒ‡å®šPodåœ¨ä¸€å°èŠ‚ç‚¹ä¸Šï¼Œäº¦æˆ–æœ‰æ„é¿å¼€å’ŒæŒ‡å®šPodåœ¨ä¸€å°èŠ‚ç‚¹ä¸Šï¼Œè¿™æ—¶å€™å°±å¯ä»¥ç”¨PodAffinityå®žçŽ°ã€‚NodeAffinityè§„åˆ™è®¾ç½®ä¹Ÿæ˜¯é€šè¿‡requiredDuringSchedulingIgnoredDuringExecutionå’ŒPreferredDuringSchedulingIgnoredDuringExecutionå®žçŽ°çš„ã€‚æ­¤å¤–ï¼ŒNodeAffinityè¿˜éœ€è¦è®¾ç½®topologyï¼ˆæ‹“æ‰‘è§„åˆ™ï¼‰ï¼Œæ„ä¸ºè¡¨è¾¾èŠ‚ç‚¹æ‰€å±žçš„topologyèŒƒå›´ï¼škubernetes.io/hostnameï¼ˆèŠ‚ç‚¹æ‰€å¤„çš„æœåŠ¡å™¨ï¼‰failure-domain.beta.kubernetes.io/zoneï¼ˆèŠ‚ç‚¹æ‰€å¤„çš„æœåŠ¡å™¨äº‘ç›˜åˆ†åŒºï¼‰failure-domain.beta.kubernetes.io/regionï¼ˆèŠ‚ç‚¹æ‰€å¤„çš„æœåŠ¡å™¨äº‘ç›˜æ‰€åœ¨çš„åœ°åŒºï¼‰è¦æ¼”ç¤ºPodAffinityçš„ä½¿ç”¨ï¼Œéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªå‚ç…§Podï¼Œåˆ›å»ºä¸€ä¸ªå‚ç…§Podçš„é…ç½®æ–‡ä»¶ï¼ˆflag-pod.ymlï¼‰:12345678910111213apiVersion: v1kind: Podmetadata: name: flag-pod labels: tier: frontend app: flag-nginxspec: containers: - name: flag-nginx image: nginx ports: - containerPort: 8081è¿™ä¸ªPodå…·æœ‰tier=frontendå’Œapp=flag-nginxæ ‡ç­¾ã€‚åˆ›å»ºè¿™ä¸ªå‚ç…§Podï¼šå‚ç…§podè¿è¡Œåœ¨äº†node1èŠ‚ç‚¹ä¸Šã€‚åˆ›å»ºå¥½åŽï¼ŒæŽ¥ç€å®šä¹‰ä¸€ä¸ªæ–°çš„é…ç½®ç±»ï¼ˆpod-affinity.ymlï¼‰ï¼š1234567891011121314151617181920apiVersion: v1kind: Podmetadata: name: pod-affinityspec: containers: - name: nginx image: nginx ports: - containerPort: 80 affinity: podAffinity: requiredDuringSchedulingIgnoredDuringExecution: - labelSelector: matchExpressions: - key: tier operator: In values: - frontend topologyKey: kubernetes.io/hostnameä¸Šè¿°é…ç½®è¦æ±‚ï¼Œnginx podéœ€è¦å’Œæ ‡ç­¾åŒ…å«tier=frontendçš„Podåˆ†é…åœ¨åŒä¸€ä¸ªNodeä¸Šï¼ˆtopologyKey: kubernetes.io/hostnameï¼‰ï¼Œåˆ›å»ºè¯¥Podï¼Œè§‚å¯Ÿå®ƒè¢«è°ƒåº¦åˆ°å“ªä¸ªèŠ‚ç‚¹ä¸Šäº†ï¼špodAntiAffinityå’ŒpodAffinityåˆšå¥½ç›¸åï¼Œä¸¾ä¸ªä¾‹å­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„é…ç½®ç±»ï¼ˆpod-affinity-two.ymlï¼‰ï¼š1234567891011121314151617181920apiVersion: v1kind: Podmetadata: name: pod-affinity-twospec: containers: - name: nginx image: nginx ports: - containerPort: 80 affinity: podAntiAffinity: requiredDuringSchedulingIgnoredDuringExecution: - labelSelector: matchExpressions: - key: app operator: In values: - flag-nginx topologyKey: kubernetes.io/hostnameä¸Šé¢é…ç½®å¸Œæœ›nginx podä¸å’Œapp=flag-nginxçš„Podåœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ã€‚åˆ›å»ºè¯¥Podï¼Œè§‚å¯Ÿå®ƒè¢«è°ƒåº¦åˆ°å“ªä¸ªèŠ‚ç‚¹ä¸Šäº†ï¼šå¯ä»¥çœ‹åˆ°ï¼Œå®ƒå’Œflag-nginxå¤„äºŽä¸åŒçš„èŠ‚ç‚¹ï¼Œä½äºŽnode2ã€‚Taints &amp; TolerationsTaintsç”¨äºŽç»™èŠ‚ç‚¹æ·»åŠ æ±¡ç‚¹ï¼Œè€ŒTolerationsç”¨äºŽå®šä¹‰Podå¯¹èŠ‚ç‚¹æ±¡ç‚¹çš„å®¹å¿åº¦ã€‚åœ¨Nodeä¸Šè®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªTaintä¹‹åŽï¼Œé™¤éžPodæ˜Žç¡®å£°æ˜Žèƒ½å¤Ÿå®¹å¿è¿™äº›æ±¡ç‚¹ï¼Œå¦åˆ™æ— æ³•åœ¨è¿™äº›Nodeä¸Šè¿è¡Œã€‚Tolerationæ˜¯Podçš„å±žæ€§ï¼Œè®©Podèƒ½å¤Ÿï¼ˆæ³¨æ„ï¼Œåªæ˜¯èƒ½å¤Ÿï¼Œè€Œéžå¿…é¡»ï¼‰è¿è¡Œåœ¨æ ‡æ³¨äº†Taintçš„Nodeä¸Šã€‚ç»™èŠ‚ç‚¹è®¾ç½®æ±¡ç‚¹çš„è¯­æ³•ä¸ºï¼š1kubectl taint nodes [nodeName] key=value:ruleå…¶ä¸­ruleçš„å–å€¼æœ‰ï¼šNoScheudleï¼šä¸è°ƒåº¦ï¼›PreferNoScheduleï¼šæœ€å¥½ä¸è¦è°ƒåº¦ï¼›NoExecuteï¼šä¸è¿è¡Œï¼›PreferNoExecuteï¼šæœ€å¥½ä¸è¿è¡Œã€‚NoScheduleå’ŒNoExecuteåŒºåˆ«ï¼šNoScheduleä¸è°ƒåº¦ï¼Œå¦‚æžœæ˜¯åœ¨è°ƒåº¦åŽè®¾ç½®çš„æ±¡ç‚¹ï¼Œå¹¶ä¸”Podæ²¡æœ‰å®¹å¿è¯¥æ±¡ç‚¹ï¼Œä¹Ÿèƒ½ç»§ç»­æ‰§è¡ŒNoExecuteä¸æ‰§è¡Œï¼Œå¦‚æžœæ˜¯åœ¨è°ƒåº¦åŽè®¾ç½®çš„æ±¡ç‚¹ï¼Œå¹¶ä¸”Podæ²¡æœ‰å®¹å¿è¯¥æ±¡ç‚¹ï¼Œåˆ™ä¼šè¢«é©±é€ã€‚å¯ä»¥è®¾ç½®é©±é€æ—¶é—´tolerationSeconds: xxã€‚æˆ‘ä»¬ç»™node1èŠ‚ç‚¹è®¾ç½®ä¸€ä¸ªæ±¡ç‚¹ï¼š1kubectl taint nodes node1 aa=bb:NoScheduleç„¶åŽæ–°å»ºä¸€ä¸ªPodé…ç½®ç±»ï¼ˆpod-taint-test.ymlï¼‰ï¼š123456789101112131415apiVersion: v1kind: Podmetadata: name: pod-taintspec: containers: - name: nginx image: nginx ports: - containerPort: 80 tolerations: - key: "aa" operator: "Equal" value: "bb" effect: "NoSchedule"Podçš„Tolerationå£°æ˜Žä¸­çš„keyå’Œeffectéœ€è¦ä¸ŽTaintçš„è®¾ç½®ä¿æŒä¸€è‡´ï¼Œå¹¶ä¸”æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼šoperatorçš„å€¼æ˜¯Existsï¼ˆæ— é¡»æŒ‡å®švalueï¼‰ï¼Œå¦‚ï¼š12345...... tolerations: - key: "aa" operator: "Exists" effect: "NoSchedule"operatorçš„å€¼æ˜¯Equalå¹¶ä¸”valueç›¸ç­‰ã€‚å¦‚æžœä¸æŒ‡å®šoperatorï¼Œåˆ™é»˜è®¤å€¼ä¸ºEqualã€‚å¦å¤–ï¼Œæœ‰å¦‚ä¸‹ä¸¤ä¸ªç‰¹ä¾‹ï¼šç©ºçš„keyé…åˆExistsæ“ä½œç¬¦èƒ½å¤ŸåŒ¹é…æ‰€æœ‰çš„é”®å’Œå€¼ï¼›ç©ºçš„effectåŒ¹é…æ‰€æœ‰çš„effectã€‚å›žåˆ°pod-taint-test.ymlï¼Œè¯¥é…ç½®æ–‡ä»¶å®šä¹‰nginx podå¯ä»¥å®¹å¿aa=bb:NoScheduleè¿™ä¸ªæ±¡ç‚¹ï¼Œæ‰€ä»¥å®ƒæœ‰å¯èƒ½ä¼šè¢«è°ƒåº¦åˆ°node1ä¸Šã€‚åˆ›å»ºè¯¥Podï¼Œè§‚å¯Ÿï¼šè¿™æ—¶å€™åœ¨nginx podæ‰€è¿è¡Œçš„èŠ‚ç‚¹node1ä¸Šæ–°å¢žä¸€ä¸ªæ±¡ç‚¹ï¼š1kubectl taint nodes node1 cc=dd:NoExecuteè§‚å¯Ÿnginx podæƒ…å†µï¼šå¯ä»¥çœ‹åˆ°å®ƒè¢«é©±é€äº†ï¼Œå·²ç»æ²¡æœ‰æ­£åœ¨è¿è¡Œçš„podäº†ã€‚Pod Priority Preemptionæˆ‘ä»¬å¯ä»¥ç»™PodæŒ‡å®šä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§å¯ä»¥é€šè¿‡PriorityClasså¯¹è±¡åˆ›å»ºï¼Œæ¯”å¦‚åˆ›å»ºä¸€ä¸ªä¼˜å…ˆçº§ä¸º10000çš„PriorityClassï¼š1234567apiVersion: scheduling.k8s.io/v1kind: PriorityClassmetadata: name: hign-priorityvalue: 10000globalDefault: falsedescription: "10000ä¼˜å…ˆçº§"ä¸Šè¿°æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸ºhigh-priorityçš„ä¼˜å…ˆçº§ç±»åˆ«ï¼Œä¼˜å…ˆçº§ä¸º10000ï¼Œæ•°å­—è¶Šå¤§ï¼Œä¼˜å…ˆè¶Šé«˜ã€‚è¶…è¿‡ä¸€äº¿çš„æ•°å­—è¢«ç³»ç»Ÿä¿ç•™ï¼Œç”¨äºŽæŒ‡æ´¾ç»™ç³»ç»Ÿç»„ä»¶ã€‚ä¼˜å…ˆçº§åˆ›å»ºåŽï¼Œå¯ä»¥åœ¨Podå®šä¹‰ä¸­å¼•ç”¨è¯¥ä¼˜å…ˆçº§ï¼š12345678...spec: containers: - name: nginx image: nginx ports: - containerPort: 80 priorityClassName: hign-priorityPodç®¡ç†å¯¹è±¡JobJobæ˜¯ä¸€ç§ç‰¹æ®Šçš„Podç®¡ç†å¯¹è±¡ï¼Œæ˜¯ä¸€ç§ä¸€æ¬¡æ€§Podè¿è¡Œä»»åŠ¡ï¼Œä»»åŠ¡ç»“æŸåŽï¼ŒPodçš„ç”Ÿå‘½å‘¨æœŸä¹Ÿå°±ç»“æŸäº†ã€‚å®šä¹‰ä¸€ä¸ªJobé…ç½®ç±»ï¼ˆjob.ymlï¼‰ï¼š123456789101112apiVersion: batch/v1kind: Jobmetadata: name: job-exspec: template: spec: containers: - name: job image: busybox command: ["echo", "hello job"] restartPolicy: NeverJobçš„é‡å¯ç­–ç•¥restartPolicyåªæ”¯æŒNeverå’ŒOnFailureã€‚åˆ›å»ºè¿™ä¸ªJobï¼šæŸ¥çœ‹JobçŠ¶æ€ï¼šCOMPLETIONS 1/1è¡¨ç¤ºæ€»å…±éœ€è¦æ‰§è¡Œ1ä¸ªä»»åŠ¡ï¼Œå…±æ‰§è¡Œå®Œ1ä¸ªä»»åŠ¡ã€‚æŸ¥çœ‹å¯¹åº”Podçš„çŠ¶æ€ï¼šçŠ¶æ€ä¸ºCompletedã€‚æŸ¥çœ‹Jobæ—¥å¿—ï¼šJobè¿˜å¯ä»¥è®¾ç½®å¹¶å‘æ•°é‡å’Œæ€»Jobæ•°ï¼Œä¿®æ”¹ä¸Šé¢çš„job.ymlï¼š1234567891011121314apiVersion: batch/v1kind: Jobmetadata: name: job-exspec: parallelism: 2 # å¹¶å‘æ•°2 completions: 6 # æ€»çš„Jobæ•°é‡ template: spec: containers: - name: job image: busybox command: ["echo", "hello job"] restartPolicy: Neverè¿è¡Œè¯¥Jobï¼š æŸ¥çœ‹Podï¼šCronJobCronJobé¡¾åæ€ä¹‰å°±æ˜¯æ”¯æŒCronè¡¨è¾¾å¼çš„Jobï¼Œä¸è¿‡Kubernetesçš„Cronè¡¨è¾¾å¼å’Œä¼ ç»Ÿçš„Cronè¡¨è¾¾å¼ä¸å¤ªä¸€æ ·ï¼Œä¸æ”¯æŒåˆ°ç§’çº§ã€‚å…·ä½“è§„åˆ™å¦‚ä¸‹ï¼š1Minutes Hours DayofMonth Month DayofWeek YearMinutesï¼šå¯å‡ºçŽ°, - * / è¿™4ä¸ªå­—ç¬¦ï¼Œæœ‰æ•ˆèŒƒå›´ä¸º0ï½ž59çš„æ•´æ•°ã€‚Hoursï¼šå¯å‡ºçŽ°, - * /è¿™4ä¸ªå­—ç¬¦ï¼Œ æœ‰æ•ˆèŒƒå›´ä¸º0ï½ž23çš„æ•´æ•°ã€‚DayofMonthï¼šå¯å‡ºçŽ°, - * / ? L W C è¿™8ä¸ªå­—ç¬¦ï¼Œæœ‰æ•ˆèŒƒå›´ä¸º0ï½ž31çš„æ•´æ•°ã€‚Monthï¼šå¯å‡ºçŽ°, - * /è¿™4ä¸ªå­—ç¬¦ï¼Œæœ‰æ•ˆèŒƒå›´ä¸º1ï½ž12çš„æ•´æ•°æˆ–JANï½žDECã€‚DayofWeekï¼šå¯å‡ºçŽ°, - * / ? L C ï¼ƒè¿™8ä¸ªå­—ç¬¦ï¼Œæœ‰æ•ˆèŒƒå›´ä¸º1ï½ž7çš„æ•´æ•°æˆ–SUNï½žSATã€‚1è¡¨ç¤ºæ˜ŸæœŸå¤©ï¼Œ2è¡¨ç¤ºæ˜ŸæœŸä¸€ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ä¸Šé¢ç‰¹æ®Šå­—ç¬¦çš„å«ä¹‰å¦‚ä¸‹ï¼š*ï¼šè¡¨ç¤ºåŒ¹é…è¯¥åŸŸçš„ä»»æ„å€¼ï¼Œå‡å¦‚åœ¨MinutesåŸŸä½¿ç”¨*ï¼Œåˆ™è¡¨ç¤ºæ¯åˆ†é’Ÿéƒ½ä¼šè§¦å‘äº‹ä»¶ã€‚/ï¼šè¡¨ç¤ºä»Žèµ·å§‹æ—¶é—´å¼€å§‹è§¦å‘ï¼Œç„¶åŽæ¯éš”å›ºå®šæ—¶é—´è§¦å‘ä¸€æ¬¡ï¼Œä¾‹å¦‚åœ¨MinutesåŸŸè®¾ç½®ä¸º5/20ï¼Œåˆ™æ„å‘³ç€ç¬¬1æ¬¡è§¦å‘åœ¨ç¬¬5minæ—¶ï¼ŒæŽ¥ä¸‹æ¥æ¯20minè§¦å‘ä¸€æ¬¡ï¼Œå°†åœ¨ç¬¬25minã€ç¬¬45minç­‰æ—¶åˆ»åˆ†åˆ«è§¦å‘ã€‚å®šä¹‰ä¸€ä¸ªCronJobçš„é…ç½®ç±»ï¼ˆcron-job.ymlï¼‰ï¼š123456789101112131415apiVersion: batch/v1beta1kind: CronJobmetadata: name: cron-job-exspec: schedule: "*/1 * * * *" jobTemplate: spec: template: spec: containers: - name: hello image: busybox command: ["sh", "-c", "date;echo hello cronJob"] restartPolicy: Neverä¸Šé¢çš„å®šæ—¶ä»»åŠ¡æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚åˆ›å»ºè¯¥CronJobï¼šè¿‡ä¸ªä¸¤ä¸‰åˆ†é’ŸæŸ¥çœ‹è¿è¡Œæƒ…å†µï¼šDaemonSetDaemonSeté€‚ç”¨äºŽåœ¨æ¯ä¸ªNodeéƒ½éœ€è¦è¿è¡Œä¸€ä¸ªPodçš„æ—¶å€™ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼šæ¯ä¸€ä¸ªNodeä¸Šè¿è¡Œä¸€ä¸ªæ—¥å¿—é‡‡é›†ã€æ€§èƒ½ç›‘æŽ§çš„Podã€‚æ¯”å¦‚æˆ‘ä»¬çŽ°åœ¨éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½éƒ¨ç½²ä¸€ä¸ªnode-exporteræ¥é‡‡é›†èŠ‚ç‚¹ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡DaemonSetæ¥å®žçŽ°ã€‚å®šä¹‰ä¸€ä¸ªDaemonSeté…ç½®æ–‡ä»¶ï¼ˆdaemonset.ymlï¼‰ï¼š123456789101112131415161718apiVersion: apps/v1kind: DaemonSetmetadata: name: node-exporter-dspec: selector: matchLabels: name: node-exporter template: metadata: labels: name: node-exporter spec: containers: - name: node-exporter image: prom/node-exporter ports: - containerPort: 9100åˆ›å»ºè¯¥DaemonSetä¹‹å‰å…ˆåˆ é™¤ä¸Šé¢åœ¨node1èŠ‚ç‚¹ä¸Šåˆ›å»ºçš„æ±¡ç‚¹ï¼š12kubectl taint nodes node1 aa:NoSchedule-kubectl taint nodes node1 cc:NoExecute-åˆ›å»ºè¯¥DaemonSetï¼Œç„¶åŽè§‚å¯ŸPodä¿¡æ¯ï¼Œçœ‹æ˜¯å¦æ¯ä¸ªèŠ‚ç‚¹éƒ½éƒ¨ç½²äº†ä¸€ä¸ªå®žä¾‹ï¼šStatefulSetç³»ç»Ÿå­¦ä¹ PV/PVCåŽå†æ·±å…¥ã€‚ã€ŠKubernetesæƒå¨æŒ‡å—(ç¬¬4ç‰ˆ)ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes PodåŸºç¡€]]></title>
    <url>%2FKubernetes-Pod-Basic.html</url>
    <content type="text"><![CDATA[Podæ˜¯Kubernetesçš„æœ€å°è°ƒåº¦å•ä½ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ï¼ˆæ¯”å¦‚Dockerå®¹å™¨ï¼‰ï¼Œå®¹å™¨é—´å…±äº«ç½‘ç»œå’Œå­˜å‚¨ã€‚è¿™èŠ‚ä¸»è¦è®°å½•ä»€ä¹ˆæ˜¯é™æ€Podï¼ŒPodå®¹å™¨å¦‚ä½•å…±äº«å­˜å‚¨ï¼Œå¦‚ä½•ä½¿ç”¨ConfigMapç®¡ç†Podé…ç½®ï¼Œå¦‚ä½•ä½¿ç”¨Downward APIèŽ·å–Podä¿¡æ¯ç­‰ã€‚é™æ€Podé™æ€Podæ˜¯ç”±kubeletåˆ›å»ºå¹¶ç®¡ç†çš„ç‰¹æ®Šçš„Podï¼Œæ— æ³•å’ŒPodç®¡ç†å¯¹è±¡å…³è”ï¼Œå¹¶ä¸”ä¸èƒ½é€šè¿‡API Serverå…³è”ã€‚åˆ›å»ºé™æ€Podæœ‰é…ç½®æ–‡ä»¶æ–¹å¼å’ŒHTTPæ–¹å¼ï¼šé…ç½®æ–‡ä»¶æ–¹å¼åœ¨æ­å»ºKubernetesé›†ç¾¤çš„æ—¶å€™ï¼Œä»Žå¯åŠ¨MasterèŠ‚ç‚¹çš„æ—¥å¿—å¯ä»¥çœ‹å‡ºï¼Œé™æ€Podçš„ç›®å½•ä½äºŽ/etc/kubernetes/manifestsï¼šåœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºé™æ€Podæ–‡ä»¶ï¼š12cd /etc/kubernetes/manifestsvim static-pod.yamlå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213apiVersion: v1kind: Podmetadata: name: static-pod labels: name: static-podspec: containers: - name: static-nginx image: nginx imagePullPolicy: IfNotPresent ports: - containerPort: 80è¿‡äº†ä¸€ä¼šæŸ¥çœ‹Podï¼šäºŽé™æ€Podæ— æ³•é€šè¿‡API Serverç›´æŽ¥ç®¡ç†ï¼Œæ‰€ä»¥åœ¨Masterä¸Šå°è¯•åˆ é™¤è¿™ä¸ªPodæ—¶ï¼Œä¼šä½¿å…¶å˜æˆPendingçŠ¶æ€ï¼Œä¸”ä¸ä¼šè¢«åˆ é™¤ã€‚åˆ é™¤è¯¥Podçš„æ“ä½œåªèƒ½æ˜¯åˆ°å…¶æ‰€åœ¨Nodeä¸Šå°†å…¶å®šä¹‰æ–‡ä»¶static-pod.yamlä»Ž/etc/kubernetes/manifestsç›®å½•ä¸‹åˆ é™¤ï¼šHTTPæ–¹å¼è¿‡è®¾ç½®kubeletçš„å¯åŠ¨å‚æ•°--manifest-urlï¼Œkubeletå°†ä¼šå®šæœŸä»Žè¯¥URLåœ°å€ä¸‹è½½Podçš„å®šä¹‰æ–‡ä»¶ï¼Œå¹¶ä»¥.yamlæˆ–.jsonæ–‡ä»¶çš„æ ¼å¼è¿›è¡Œè§£æžï¼Œç„¶åŽåˆ›å»ºPodã€‚Podå®¹å™¨å…±äº«VolumeåŒä¸€ä¸ªPodçš„å¤šä¸ªå®¹å™¨é—´å¯ä»¥å…±äº«Podçº§åˆ«çš„Volumeï¼Œä¸¾ä¸ªä¾‹å­ï¼š1vim pod-volume.ymlå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021222324apiVersion: v1kind: Podmetadata: name: pod-volumespec: containers: - name: tomcat image: tomcat imagePullPolicy: IfNotPresent ports: - containerPort: 8080 volumeMounts: - mountPath: /usr/local/tomcat/logs name: logs - name: busybox image: busybox imagePullPolicy: IfNotPresent command: ["sh", "-c", "tail -f /logs/catalina*.log"] volumeMounts: - mountPath: /logs name: logs volumes: - name: logs emptyDir: &#123;&#125;ä¸Šé¢Podå®šä¹‰ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªPodçº§åˆ«çš„Volumeï¼Œåç§°ä¸ºlogsï¼Œç±»åž‹ä¸ºemptyDirã€‚è¿™ä¸ªVolumeåŒæ—¶æŒ‚è½½åˆ°äº†tomcatçš„/usr/local/tomcat/logsç›®å½•ä¸‹ï¼Œä¹ŸæŒ‚è½½åˆ°äº†busyboxçš„/logsç›®å½•ä¸‹ã€‚åˆ›å»ºè¯¥Podï¼š1kubectl create -f pod-volume.ymlè¿™é‡Œçš„tomcaté•œåƒæ¯”è¾ƒå¤§ï¼Œå¤§æ¦‚æœ‰500MBå·¦å³ï¼Œæ‰€ä»¥åœ¨åˆ›å»ºä¹‹å‰ï¼Œæœ€å¥½åœ¨Kubernetesé›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹ä¸­é…ç½®Dockeré•œåƒåŠ é€Ÿåœ°å€ã€‚å½“pod-volumeçŠ¶æ€ä¸ºreadyåŽï¼ŒæŸ¥çœ‹busyboxçš„æ—¥å¿—ï¼šè¯¥æ—¥å¿—ä¸ºtomcatçš„å¯åŠ¨æ—¥å¿—ï¼Œè¯´æ˜Žä¸Šé¢æŒ‚è½½çš„Volumeç”Ÿæ•ˆäº†ï¼Œå¯ä»¥é€šè¿‡æŸ¥çœ‹tomcat/usr/local/tomcat/logsç›®å½•ä¸‹å’Œbusybox/logsç›®å½•ä¸‹çš„å†…å®¹æ¥è¯æ˜Žè¿™ä¸€ç‚¹ï¼šConfigMapConfigMapä»¥ä¸€ä¸ªæˆ–å¤šä¸ªkey:valueçš„å½¢å¼ä¿å­˜åœ¨Kubernetesç³»ç»Ÿä¸­ä¾›åº”ç”¨ä½¿ç”¨ï¼Œæ—¢å¯ä»¥ç”¨äºŽè¡¨ç¤ºä¸€ä¸ªå˜é‡çš„å€¼ï¼ˆä¾‹å¦‚version=v1ï¼‰ï¼Œä¹Ÿå¯ä»¥ç”¨äºŽè¡¨ç¤ºä¸€ä¸ªå®Œæ•´é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼ˆä¾‹å¦‚server.xml=&lt;?xml...&gt;...ï¼‰ã€‚åˆ›å»ºConfigMapåˆ›å»ºConfigMapä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š1.é€šè¿‡ymlæ–‡ä»¶åˆ›å»ºåˆ›å»ºsimple-cm.ymlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š1234567apiVersion: v1kind: ConfigMapmetadata: name: simple-cmdata: version: v1 release: stableè¯¥ConfigMapä»…åŒ…å«ä¸¤ä¸ªç®€å•çš„å€¼versionå’Œreleasesã€‚åˆ›å»ºè¯¥ConfigMapï¼š1kubectl create -f simple-cm.ymlæŸ¥çœ‹è¯¥ConfigMapï¼šåœ¨å®šä¹‰ConfigMapçš„æ—¶å€™ï¼Œvalueé™¤äº†å¯ä»¥ä½¿ç”¨ç®€å•çš„å€¼å¤–ï¼Œè¿˜å¯ä»¥æ˜¯æ•´ä¸ªé…ç½®æ–‡ä»¶çš„å†…å®¹ã€‚åˆ›å»ºfile-cm.ymlï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758apiVersion: v1kind: ConfigMapmetadata: name: file-cmdata: serverXml: | &lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;Server port="8005" shutdown="SHUTDOWN"&gt; &lt;Listener className="org.apache.catalina.startup.VersionLoggerListener"/&gt; &lt;Listener SSLEngine="on" className="org.apache.catalina.core.AprLifecycleListener"/&gt; &lt;!-- Prevent memory leaks due to use of particular java/javax APIs--&gt; &lt;Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener"/&gt; &lt;Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener"/&gt; &lt;Listener className="org.apache.catalina.core.ThreadLocalLeakPreventionListener"/&gt; &lt;GlobalNamingResources&gt; &lt;Resource auth="Container" description="User database that can be updated and saved" factory="org.apache.catalina.users.MemoryUserDatabaseFactory" name="UserDatabase" pathname="conf/tomcat-users.xml" type="org.apache.catalina.UserDatabase"/&gt; &lt;/GlobalNamingResources&gt; &lt;Service name="Catalina"&gt; &lt;Connector connectionTimeout="20000" port="8080" protocol="HTTP/1.1" redirectPort="8443"/&gt; &lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443"/&gt; &lt;Engine defaultHost="localhost" name="Catalina"&gt; &lt;Realm className="org.apache.catalina.realm.LockOutRealm"&gt; &lt;Realm className="org.apache.catalina.realm.UserDatabaseRealm" resourceName="UserDatabase"/&gt; &lt;/Realm&gt; &lt;Host appBase="webapps" autoDeploy="true" name="localhost" unpackWARs="true"&gt; &lt;Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs" pattern="%h %l %u %t &amp;quot;%r&amp;quot; %s %b" prefix="localhost_access_log" suffix=".txt"/&gt; &lt;Context docBase="D:\Code\apache-tomcat-8.5.32\webapps\tj_certification" path="/tj_certification" reloadable="true" source="org.eclipse.jst.jee.server:tj_certification"/&gt;&lt;/Host&gt; &lt;/Engine&gt; &lt;/Service&gt; &lt;/Server&gt; serverProperties: "1catalina.org.apache.juli.AsyncFileHandler.level = FINE 1catalina.org.apache.juli.AsyncFileHandler.directory = $&#123;catalina.base&#125;/logs 1catalina.org.apache.juli.AsyncFileHandler.prefix = catalina. 2localhost.org.apache.juli.AsyncFileHandler.level = FINE 2localhost.org.apache.juli.AsyncFileHandler.directory = $&#123;catalina.base&#125;/logs 2localhost.org.apache.juli.AsyncFileHandler.prefix = localhost. 3manager.org.apache.juli.AsyncFileHandler.level = FINE 3manager.org.apache.juli.AsyncFileHandler.directory = $&#123;catalina.base&#125;/logs 3manager.org.apache.juli.AsyncFileHandler.prefix = manager. 4host-manager.org.apache.juli.AsyncFileHandler.level = FINE 4host-manager.org.apache.juli.AsyncFileHandler.directory = $&#123;catalina.base&#125;/logs 4host-manager.org.apache.juli.AsyncFileHandler.prefix = host-manager. java.util.logging.ConsoleHandler.level = FINE java.util.logging.ConsoleHandler.formatter = org.apache.juli.OneLineFormatter org.apache.catalina.core.ContainerBase.[Catalina].[localhost].level = INFO org.apache.catalina.core.ContainerBase.[Catalina].[localhost].handlers = 2localhost.org.apache.juli.AsyncFileHandler org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/manager].level = INFO org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/manager].handlers = 3manager.org.apache.juli.AsyncFileHandler org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/host-manager].level = INFO org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/host-manager].handlers = 4host-manager.org.apache.juli.AsyncFileHandler"åˆ›å»ºè¯¥ConfigMapï¼š2.ç›´æŽ¥é€šè¿‡Kubectlå‘½ä»¤åˆ›å»ºé€šè¿‡kubectlå‘½ä»¤åˆ›å»ºConfigMapä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§ç”¨æ³•ï¼šé€šè¿‡â€“from-fileå‚æ•°ä»Žæ–‡ä»¶ä¸­è¿›è¡Œåˆ›å»ºï¼Œå¯ä»¥æŒ‡å®škeyçš„åç§°ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªå‘½ä»¤è¡Œä¸­åˆ›å»ºåŒ…å«å¤šä¸ªkeyçš„ConfigMapï¼Œè¯­æ³•ä¸ºï¼š1kubectl cerate configmap [NAME] --from-file=[key=]source --from-file=[key=]sourceé€šè¿‡â€“from-fileå‚æ•°ä»Žç›®å½•ä¸­è¿›è¡Œåˆ›å»ºï¼Œè¯¥ç›®å½•ä¸‹çš„æ¯ä¸ªé…ç½®æ–‡ä»¶åéƒ½è¢«è®¾ç½®ä¸ºkeyï¼Œæ–‡ä»¶çš„å†…å®¹è¢«è®¾ç½®ä¸ºvalueï¼Œè¯­æ³•ä¸ºï¼š1kubectl cerate configmap [NAME] --from-file=config-file-dirä½¿ç”¨â€“from-literalæ—¶ä¼šä»Žæ–‡æœ¬ä¸­è¿›è¡Œåˆ›å»ºï¼Œç›´æŽ¥å°†æŒ‡å®šçš„key#=value#åˆ›å»ºä¸ºConfigMapçš„å†…å®¹ï¼Œè¯­æ³•ä¸ºï¼š1kubectl cerate configmap [NAME] --from-literal=key1=value1 --from-literal=key2=value2æ¯”å¦‚ä½¿ç”¨kubectlå‘½ä»¤åˆ›å»ºä¸€ä¸ªå’Œsimple-cmæ•ˆæžœä¸€æ ·çš„ConfigMapï¼šä½¿ç”¨kubectlå‘½ä»¤åˆ›å»ºä¸€ä¸ªå’Œfile-cmæ•ˆæžœä¸€æ ·çš„ConfigMapï¼šé¦–å…ˆåœ¨å½“å‰ç›®å½•ä¸‹å‡†å¤‡å¥½ä¸¤ä¸ªé…ç½®æ–‡ä»¶server.xmlå’Œserver.propertiesï¼šç„¶åŽä½¿ç”¨kubectlå‘½ä»¤åˆ›å»ºï¼šPodå®¹å™¨ä½¿ç”¨ConfigMapPodçš„å®¹å™¨è¦ä½¿ç”¨ConfigMapä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šé€šè¿‡çŽ¯å¢ƒå˜é‡èŽ·å–ConfigMapä¸­çš„å†…å®¹;é€šè¿‡VolumeæŒ‚è½½çš„æ–¹å¼å°†ConfigMapä¸­çš„å†…å®¹æŒ‚è½½ä¸ºå®¹å™¨å†…éƒ¨çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚é€šè¿‡çŽ¯å¢ƒå˜é‡çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªPodé…ç½®ï¼ˆsimple-cm-pod.ymlï¼‰ï¼š1234567891011121314151617181920apiVersion: v1kind: Podmetadata: name: simple-cm-podspec: containers: - name: busybox image: busybox command: ["sh", "-c", "env | grep ENV"] # æ‰“å°åç§°åŒ…å«ENVçš„çŽ¯å¢ƒå˜é‡ env: - name: ENVVERSION # å®šä¹‰çŽ¯å¢ƒå˜é‡åç§° valueFrom: # å€¼æ¥è‡ª... configMapKeyRef: # ConfigMapé”®çš„å¼•ç”¨ key: version # ConfigMapçš„key name: simple-cm # ConfigMapçš„åç§° - name: ENVRELEASE valueFrom: configMapKeyRef: key: release name: simple-cmåˆ›å»ºè¯¥Podï¼Œå¹¶æŸ¥çœ‹æ—¥å¿—ï¼šå¯ä»¥çœ‹åˆ°ï¼Œå€¼å·²ç»æˆåŠŸä»ŽConfigMapé‡ŒåŽ»åˆ°äº†ã€‚å¦‚æžœè¦å¼•ç”¨æŸä¸ªConfigMapçš„æ‰€æœ‰å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼ã€‚å®šä¹‰ä¸€ä¸ªPodé…ç½®ï¼ˆsimple-cm-pod-all.uymlï¼‰ï¼š123456789101112apiVersion: v1kind: Podmetadata: name: simple-cm-pod-allspec: containers: - name: busybox image: busybox command: ["sh", "-c", "env"] envFrom: - configMapRef: name: simple-cmåˆ›å»ºè¯¥Podï¼Œå¹¶æŸ¥çœ‹æ—¥å¿—ï¼šé€šè¿‡VolumeæŒ‚è½½çš„æ–¹å¼åˆ›å»ºä¸€ä¸ªPodé…ç½®ï¼ˆfile-cm-pod.ymlï¼‰ï¼š12345678910111213141516171819202122apiVersion: v1kind: Podmetadata: name: file-cm-podspec: containers: - name: tomcat image: tomcat ports: - containerPort: 8080 volumeMounts: - mountPath: /configs # å®¹å™¨æŒ‚è½½ç›®å½•ä¸º/configs name: config-vm # å¼•ç”¨ä¸‹é¢å®šä¹‰çš„è¿™ä¸ªVolume volumes: - name: config-vm # volumeåç§°ä¸ºconfig-vm configMap: # é€šè¿‡ConfigMapèŽ·å– name: file-cm # å¼•ç”¨åç§°ä¸ºfile-cmçš„ConfigMap items: - key: serverXml # ConfigMapé‡Œé…ç½®çš„key path: server.xml # å€¼ä½¿ç”¨server.xmlæ–‡ä»¶è¿›è¡ŒæŒ‚è½½ - key: serverProperties path: server.propertiesåˆ›å»ºè¯¥Podï¼Œå¹¶è¿›å…¥åˆ°å®¹å™¨å†…éƒ¨è§‚å¯Ÿ/configsç›®å½•ä¸‹æ–‡ä»¶å†…å®¹ï¼šå¯ä»¥çœ‹åˆ°åç§°ä¸ºfile-cmçš„ConfigMapå†…å®¹å·²ç»æˆåŠŸæŒ‚è½½åˆ°äº†tomcatå®¹å™¨å†…éƒ¨ã€‚å¦‚æžœåœ¨å¼•ç”¨ConfigMapæ—¶ä¸æŒ‡å®šitemsï¼Œåˆ™ä½¿ç”¨volumeMountæ–¹å¼åœ¨å®¹å™¨å†…çš„ç›®å½•ä¸‹ä¸ºæ¯ä¸ªiteméƒ½ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶åä¸ºkeyçš„æ–‡ä»¶ã€‚åœ¨Podå¯¹ConfigMapè¿›è¡ŒæŒ‚è½½ï¼ˆvolumeMountï¼‰æ“ä½œæ—¶ï¼Œåœ¨å®¹å™¨å†…éƒ¨åªèƒ½æŒ‚è½½ä¸ºâ€œç›®å½•â€ï¼Œæ— æ³•æŒ‚è½½ä¸ºâ€œæ–‡ä»¶â€ã€‚åœ¨æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨åŽï¼Œåœ¨ç›®å½•ä¸‹å°†åŒ…å«ConfigMapå®šä¹‰çš„æ¯ä¸ªitemï¼Œå¦‚æžœåœ¨è¯¥ç›®å½•ä¸‹åŽŸæ¥è¿˜æœ‰å…¶ä»–æ–‡ä»¶ï¼Œåˆ™å®¹å™¨å†…çš„è¯¥ç›®å½•å°†è¢«æŒ‚è½½çš„ConfigMapè¦†ç›–ã€‚Downward APIDownward APIç”¨äºŽå°†Podç›¸å…³ä¿¡æ¯æ³¨å…¥åˆ°å®¹å™¨å†…éƒ¨ï¼Œä¸»è¦æœ‰çŽ¯å¢ƒå˜é‡å’ŒVolumeæŒ‚è½½ä¸¤ç§æ–¹å¼ã€‚çŽ¯å¢ƒå˜é‡åˆ›å»ºä¸€ä¸ªPodé…ç½®ï¼ˆdapi-pod.ymlï¼‰ï¼š12345678910111213141516171819202122apiVersion: v1kind: Podmetadata: name: dapi-podspec: containers: - name: busybox image: busybox command: ["sh", "-c", "env | grep MY_POD"] env: - name: MY_POD_NAME valueFrom: fieldRef: fieldPath: metadata.name # é€šè¿‡downward apièŽ·å–å½“å‰podåç§° - name: MY_POD_NAMESPACE valueFrom: fieldRef: fieldPath: metadata.namespace # é€šè¿‡downward apièŽ·å–å½“å‰pod namespace - name: MY_POD_IP valueFrom: fieldRef: fieldPath: status.podIP # é€šè¿‡downward apièŽ·å–å½“å‰pod IPåˆ›å»ºè¯¥Podï¼Œå¹¶æŸ¥çœ‹æ—¥å¿—ï¼šé€šè¿‡çŽ¯å¢ƒå˜é‡çš„æ–¹å¼è¿˜å¯ä»¥å°†å®¹å™¨çš„requestså’Œlimitsä¿¡æ¯æ³¨å…¥åˆ°å®¹å™¨çš„çŽ¯å¢ƒå˜é‡ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªPodé…ç½®ï¼ˆdapi-pod-container-vars.ymlï¼‰ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344apiVersion: v1kind: Podmetadata: name: dapi-pod-container-varsspec: containers: - name: busybox image: busybox command: ["sh", "-c"] args: - while true;do echo -en '\n'; printenv MY_CPU_REQUEST MY_CPU_LIMIT; printenv MY_MEM_REQUEST MY_MEM_LIMIT; sleep 3600; done; resources: requests: memory: "32Mi" cpu: "125m" limits: memory: "64Mi" cpu: "250m" env: - name: MY_CPU_REQUEST valueFrom: resourceFieldRef: resource: requests.cpu containerName: busybox - name: MY_CPU_LIMIT valueFrom: resourceFieldRef: resource: limits.cpu containerName: busybox - name: MY_MEM_REQUEST valueFrom: resourceFieldRef: resource: request.memory containerName: busybox - name: MY_MEM_LIMIT valueFrom: resourceFieldRef: resource: limits.memory containerName: busyboxåˆ›å»ºè¯¥Podå¹¶è§‚å¯Ÿæ—¥å¿—ï¼šé€šè¿‡VolumeæŒ‚è½½æˆ‘ä»¬å¯ä»¥é€šè¿‡Downward APIå°†Podçš„Labelï¼ŒAnnotationç­‰ä¿¡æ¯æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨æ–‡ä»¶ä¸­ï¼Œæ–°å»ºä¸€ä¸ªPodé…ç½®ï¼ˆdapi-pod-volumes.ymlï¼‰ï¼š1234567891011121314151617181920212223242526272829apiVersion: v1kind: Podmetadata: name: dapi-pod-volume labels: tier: frontend release: canary environment: dev annotations: builder: mrbird blog: https://mrbird.ccspec: containers: - name: busybox image: busybox command: ["sh", "-c", "sleep 36000"] volumeMounts: - mountPath: /podinfo # æŒ‚è½½è·¯å¾„ name: pod-info volumes: - name: pod-info downwardAPI: # é€šè¿‡downward apièŽ·å–pod labelså’Œannationsä¿¡æ¯ items: - path: "labels" # æŒ‚è½½æ–‡ä»¶åç§° fieldRef: fieldPath: metadata.labels # æŒ‚è½½å†…å®¹ - path: "annotation" fieldRef: fieldPath: metadata.annotationsåˆ›å»ºè¯¥Podï¼Œå¹¶è¿›å…¥åˆ°å®¹å™¨/podinfoç›®å½•è§‚å¯Ÿç»“æžœï¼šPodç”Ÿå‘½å‘¨æœŸé˜¶æ®µæè¿°PendingPod å·²è¢« Kubernetes æŽ¥å—ï¼Œä½†å°šæœªåˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨é•œåƒã€‚è¿™åŒ…æ‹¬è¢«è°ƒåº¦ä¹‹å‰çš„æ—¶é—´ä»¥åŠé€šè¿‡ç½‘ç»œä¸‹è½½é•œåƒæ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œæ‰§è¡Œéœ€è¦ä¸€æ®µæ—¶é—´ã€‚RunningPod å·²ç»è¢«ç»‘å®šåˆ°äº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰€æœ‰å®¹å™¨å·²è¢«åˆ›å»ºã€‚è‡³å°‘ä¸€ä¸ªå®¹å™¨æ­£åœ¨è¿è¡Œï¼Œæˆ–è€…æ­£åœ¨å¯åŠ¨æˆ–é‡æ–°å¯åŠ¨ã€‚Succeededæ‰€æœ‰å®¹å™¨æˆåŠŸç»ˆæ­¢ï¼Œä¹Ÿä¸ä¼šé‡å¯ã€‚Failedæ‰€æœ‰å®¹å™¨ç»ˆæ­¢ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨ä»¥å¤±è´¥æ–¹å¼ç»ˆæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªå®¹å™¨è¦ä¹ˆå·²éž 0 çŠ¶æ€é€€å‡ºï¼Œè¦ä¹ˆè¢«ç³»ç»Ÿç»ˆæ­¢ã€‚Unknownç”±äºŽä¸€äº›åŽŸå› ï¼ŒPod çš„çŠ¶æ€æ— æ³•èŽ·å–ï¼Œé€šå¸¸æ˜¯ä¸Ž Pod é€šä¿¡æ—¶å‡ºé”™å¯¼è‡´çš„ã€‚ä¸‰ç§é‡å¯ç­–ç•¥ï¼šAlwaysï¼šå½“å®¹å™¨å¤±æ•ˆæ—¶ï¼Œç”±kubeletè‡ªåŠ¨é‡å¯è¯¥å®¹å™¨ï¼›OnFailureï¼šå½“å®¹å™¨ç»ˆæ­¢è¿è¡Œä¸”é€€å‡ºç ä¸ä¸º0æ—¶ï¼Œç”±kubeletè‡ªåŠ¨é‡å¯è¯¥å®¹å™¨ï¼›Neverï¼šä¸è®ºå®¹å™¨è¿è¡ŒçŠ¶æ€å¦‚ä½•ï¼Œkubeletéƒ½ä¸ä¼šé‡å¯è¯¥å®¹å™¨ã€‚ç»“åˆPodçš„çŠ¶æ€å’Œé‡å¯ç­–ç•¥ï¼Œä»¥ä¸‹ä¸ºä¸€äº›å¸¸è§çš„çŠ¶æ€è½¬æ¢åœºæ™¯ï¼šPodåŒ…å«çš„å®¹å™¨æ•°Podå½“å‰çš„çŠ¶æ€å‘ç”Ÿäº‹ä»¶Podçš„ç»“æžœçŠ¶æ€RestarPolicy=AlwaysRestartPolicy=OnFailureRestartPolicy=NeveråŒ…å«1ä¸ªå®¹å™¨Runningå®¹å™¨æˆåŠŸé€€å‡ºRunningSucceededSucceededåŒ…å«1ä¸ªå®¹å™¨Runningå®¹å™¨å¤±è´¥é€€å‡ºRunningRunningFailedåŒ…å«ä¸¤ä¸ªå®¹å™¨Running1ä¸ªå®¹å™¨å¤±è´¥é€€å‡ºRunningRunningRunningåŒ…å«ä¸¤ä¸ªå®¹å™¨Runningå®¹å™¨è¢«OOMæ€æŽ‰RunningRunningFailedã€ŠKubernetesæƒå¨æŒ‡å—(ç¬¬4ç‰ˆ)ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[KubernetesåŸºç¡€]]></title>
    <url>%2FKubernetes-Basic.html</url>
    <content type="text"><![CDATA[ä¸Šä¸€èŠ‚æˆ‘ä»¬å·²ç»æˆåŠŸæ­å»ºäº†Kubernetesé›†ç¾¤ï¼ŒKubernetesåŒ…å«äº†å¤§é‡çš„æ¦‚å¿µå’Œæœ¯è¯­ï¼Œæ¯”å¦‚Masterã€Nodeã€Podã€Replication Controllerã€Serviceç­‰ç­‰ï¼Œåœ¨æ·±å…¥å­¦ä¹ Kubernetesä¹‹å‰ï¼Œæœ‰å¿…è¦æ‹æ¸…Kubernetesæž¶æž„è®¾è®¡å’Œè¿™äº›æœ¯è¯­çš„å«ä¹‰ã€‚Kubernetesæž¶æž„KubernetesåŸºæœ¬æž¶æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šç”±ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒKubernetesé›†ç¾¤èŠ‚ç‚¹å¯åˆ†ä¸ºMasterå’ŒNodeï¼šMasterï¼šæŒ‡çš„æ˜¯é›†ç¾¤ä¸­çš„æŽ§åˆ¶èŠ‚ç‚¹ï¼Œè´Ÿè´£ç®¡ç†å’ŒæŽ§åˆ¶æ•´ä¸ªé›†ç¾¤ã€‚åŸºæœ¬ä¸Šæˆ‘ä»¬å¯¹Kubernetesé›†ç¾¤çš„æ“ä½œéƒ½æ˜¯åœ¨MasterèŠ‚ç‚¹ä¸Šå®Œæˆçš„ï¼›Nodeï¼šé™¤äº†Masterå¤–ï¼ŒKubernetesé›†ç¾¤ä¸­å…¶ä»–èŠ‚ç‚¹ç§°ä¸ºNodeã€‚æ¯ä¸ªNodeéƒ½å°†è´Ÿè´£è¿è¡ŒMasteræŒ‡æ´¾çš„Dockerå®¹å™¨ï¼Œå½“æŸä¸ªNodeå®•æœºåŽï¼Œè¿™äº›å·¥ä½œä¼šè¢«Masterè½¬ç§»åˆ°åˆ«çš„Nodeä¸Šã€‚MasterèŠ‚ç‚¹ä¸Šä¸»è¦åŒ…å«äº†ä»¥ä¸‹è¿™äº›å…³æŽ¥çš„è¿›ç¨‹:API Serverï¼šæä¾›äº†HTTP RestæŽ¥å£çš„å…³é”®æœåŠ¡è¿›ç¨‹ï¼Œæ˜¯Kubernetesé‡Œæ‰€æœ‰èµ„æºçš„å¢žã€åˆ ã€æ”¹ã€æŸ¥ç­‰æ“ä½œçš„å”¯ä¸€å…¥å£ï¼Œä¹Ÿæ˜¯é›†ç¾¤æŽ§åˆ¶çš„å…¥å£è¿›ç¨‹ï¼›Controller Managerï¼šè´Ÿè´£ç»´æŠ¤é›†ç¾¤çš„çŠ¶æ€ï¼Œæ¯”å¦‚æ•…éšœæ£€æµ‹ï¼Œæ‰©ç¼©å®¹ï¼Œæ»šåŠ¨æ›´æ–°ç­‰ç­‰ï¼›Schedulerï¼šè´Ÿè´£èµ„æºçš„è°ƒåº¦ï¼ŒæŒ‰ç…§é¢„å®šçš„ç­–ç•¥æŠŠpodè°ƒåº¦åˆ°æŒ‡å®šçš„nodeèŠ‚ç‚¹ï¼›etcdï¼šå­˜å‚¨Kubernetesé›†ç¾¤ä¿¡æ¯ã€‚NodeèŠ‚ç‚¹ä¸Šä¸»è¦åŒ…å«äº†ä»¥ä¸‹è¿™äº›å…³æŽ¥çš„è¿›ç¨‹:kubeletï¼šè´Ÿè´£Podå¯¹åº”çš„å®¹å™¨çš„åˆ›å»ºã€å¯åœç­‰ä»»åŠ¡ï¼›kube-proxyï¼šå®žçŽ°Kubernetes Serviceçš„é€šä¿¡ä¸Žè´Ÿè½½å‡è¡¡æœºåˆ¶çš„é‡è¦ç»„ä»¶ï¼›dockerï¼šDockerå¼•æ“Žï¼Œè´Ÿè´£æœ¬æœºçš„å®¹å™¨åˆ›å»ºå’Œç®¡ç†å·¥ä½œï¼›podï¼šPodæ˜¯Kubernetesä¸­èƒ½å¤Ÿåˆ›å»ºå’Œéƒ¨ç½²çš„æœ€å°å•å…ƒï¼Œæ˜¯Kubernetesé›†ç¾¤ä¸­çš„ä¸€ä¸ªåº”ç”¨å®žä¾‹ã€‚PodåŒ…å«äº†ä¸€ä¸ªâ€œæ ¹å®¹å™¨â€Pauseå’Œå¤šä¸ªDockerå®¹å™¨ï¼›KubernetesèŠ‚ç‚¹é—´çš„ç½‘ç»œé€šä¿¡é€šè¿‡ç½‘ç»œæ’ä»¶å®žçŽ°ï¼Œæ¯”å¦‚Flannelï¼ŒCalicoç­‰ã€‚Podç®¡ç†å¯¹è±¡Podç®¡ç†å¯¹è±¡æŒ‡çš„æ˜¯Kubernetesä¸­å¯ä»¥ç”¨äºŽåˆ›å»ºå’Œç®¡ç†Podçš„ç»„ä»¶ï¼Œæ¯”å¦‚RC(RS)ï¼ŒDeploymentï¼ŒStableSetç­‰ç­‰ã€‚åœ¨äº†è§£è¿™äº›ç»„ä»¶å‰ï¼Œå…ˆæ¥çœ‹çœ‹Podçš„ç»„æˆï¼šPodåŒ…å«ä¸€ä¸ªPauseå®¹å™¨å’Œå¤šä¸ªDockerå®¹å™¨ï¼ŒPauseå®¹å™¨ç”¨äºŽç®¡ç†è¿™äº›Dockerå®¹å™¨ã€‚Podå¯ä»¥é€šè¿‡yamlæ–‡ä»¶æ¥åˆ›å»ºï¼Œä¸‹é¢ä¸¾ä¸ªç®€å•çš„ä¾‹å­:12345678910111213apiVersion: v1kind: Pod # kindä¸ºpodè¡¨æ˜Žè¿™æ˜¯ä¸€ä¸ªpodå®šä¹‰metadata: name: nginx-pod # podåç§°ä¸ºnginx-pod labels: # å®šä¹‰æ ‡ç­¾ä¿¡æ¯ï¼ˆlabelï¼‰ name: nginx spec: containers: - name: nginx # å®¹å™¨åç§° image: nginx # åŸºäºŽnginxé•œåƒæž„å»º imagePullPolicy: IfNotPresent # é•œåƒæ‹‰å–è§„åˆ™ï¼Œä¸å­˜åœ¨åˆ™è¿œç¨‹æ‹‰å– ports: - containerPort: 80 # ç«¯å£æ¯ä¸ªPodéƒ½åŒ…å«ä¸€ä¸ªå”¯ä¸€çš„IPåœ°å€ï¼Œç§°ä¸ºPod IPï¼ŒKubernetesé›†ç¾¤å†…çš„ä»»æ„ä¸¤ä¸ªPodä¹‹é—´éƒ½èƒ½æ­£å¸¸é€šä¿¡ã€‚Pod IPåŠ ä¸Šä¸Šé¢å®šä¹‰çš„80ç«¯å£ï¼Œç»„æˆäº†ä¸€ä¸ªEndpointï¼Œä»£è¡¨æ­¤Podé‡Œçš„ä¸€ä¸ªæœåŠ¡è¿›ç¨‹çš„å¯¹å¤–é€šä¿¡åœ°å€ã€‚Podçš„ç›¸å…³å†…å®¹å­˜å‚¨åœ¨Volumeä¸­ï¼ŒPodçš„ç›¸å…³è¿è¡Œè®°å½•å¯ä»¥é€šè¿‡EventæŸ¥çœ‹ï¼šåœ¨å®šä¹‰Podçš„æ—¶å€™æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šèµ„æºèµ„æºé™é¢ï¼Œèµ„æºä¸»è¦åŒ…æ‹¬CPUå’ŒMemoryï¼šåœ¨Kubernetesä¸­ï¼Œ1mè¡¨ç¤ºåƒåˆ†ä¹‹ä¸€CPUï¼Œå³1000mè¡¨ç¤ºä¸€ä¸ªCPUï¼›å¸¸ç”¨å•ä½æœ‰KiBã€MiBå’ŒGiBç­‰ï¼Œæ˜¯äºŒè¿›åˆ¶è¡¨ç¤ºçš„å­—èŠ‚å•ä½ï¼Œ1 KiBï¼ˆKibiByteï¼‰= 2^10 Bytes = 1024 Bytes = 8192 Bitsã€‚åœ¨Kubernetesé‡Œï¼Œä¸€ä¸ªè®¡ç®—èµ„æºè¿›è¡Œé…é¢é™å®šæ—¶éœ€è¦è®¾å®šä»¥ä¸‹ä¸¤ä¸ªå‚æ•°ï¼šRequestsï¼šè¯¥èµ„æºçš„æœ€å°ç”³è¯·é‡ï¼Œç³»ç»Ÿå¿…é¡»æ»¡è¶³è¦æ±‚ï¼›Limitsï¼šè¯¥èµ„æºæœ€å¤§å…è®¸ä½¿ç”¨çš„é‡ï¼Œä¸èƒ½è¢«çªç ´ï¼Œå½“å®¹å™¨è¯•å›¾ä½¿ç”¨è¶…è¿‡è¿™ä¸ªé‡çš„èµ„æºæ—¶ï¼Œå¯èƒ½ä¼šè¢«Kubernetesâ€œæ€æŽ‰â€å¹¶é‡å¯ã€‚æ¯”å¦‚ä¿®æ”¹ä¸Šé¢çš„Podé…ç½®æ–‡ä»¶ï¼Œå®šä¹‰èµ„æºé…é¢ï¼š1234567891011121314151617181920apiVersion: v1kind: Pod metadata: name: nginx-pod labels: name: nginxspec: containers: - name: nginx image: nginx imagePullPolicy: IfNotPresent ports: - containerPort: 80 resources: requests: memory: "64Mi" # è‡³å°‘éœ€è¦64MiBå†…å­˜ cpu: "200m" # è‡³å°‘éœ€è¦0.2ä¸ªCPU limits: memory: "128Mi" # å†…å­˜æ¶ˆè€—ä¸èƒ½å¤šäºŽ128MiB cpu: "500m" # CPUæ¶ˆè€—ä¸èƒ½å¤šäºŽ0.5é™¤äº†ç›´æŽ¥ä½¿ç”¨Podé…ç½®æ–‡ä»¶æ¥åˆ›å»ºPodå¤–ï¼Œæ›´ä¸ºå¸¸ç”¨çš„æ˜¯ä½¿ç”¨Podç®¡ç†å¯¹è±¡RC(RS)ã€Deploymentç­‰åˆ›å»ºå’Œç®¡ç†Podã€‚RC(RS)RCå…¨ç§°Replication Controllerï¼ˆå‰¯æœ¬æŽ§åˆ¶å™¨ï¼‰,ç”¨äºŽæŽ§åˆ¶ä»»æ„æ—¶åˆ»æŒ‡å®šPodçš„æ•°é‡éƒ½ç¬¦åˆé¢„æœŸå€¼ã€‚RCé…ç½®æ–‡ä»¶ä¸€èˆ¬åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ï¼šæœŸæœ›çš„Podå‰¯æœ¬æ•°é‡ï¼›ç”¨äºŽç­›é€‰Podçš„Label Selectorï¼›åˆ›å»ºPodçš„æ¨¡æ¿ï¼ˆå½“æ•°é‡å°‘äºŽé¢„æœŸçš„æ—¶å€™ï¼Œç”¨è¿™ä¸ªæ¨¡æ¿åˆ›å»ºPodï¼‰ã€‚ä¸¾ä¸ªRC yamlçš„ä¾‹å­ï¼š12345678910111213141516171819apiVersion: v1kind: ReplicationController # è¡¨ç¤ºRCmetadata: name: nginx-rc # RCæŽ§åˆ¶å™¨åç§°ä¸ºnginx-rcspec: replicas: 3 # æœŸæœ›Podçš„å‰¯æœ¬æ•°é‡ä¸º3 selector: name: nginx # Labelç­›é€‰å™¨ï¼Œç­›é€‰å‡ºLabelåŒ…å«ï¼ˆname=nginxï¼‰çš„Pod template: # Podåˆ›å»ºæ¨¡æ¿ï¼Œæ ¼å¼åŸºæœ¬å’Œæˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„Pod yamlä¸€è‡´ metadata: labels: name: nginx spec: containers: - name: nginx image: nginx imagePullPolicy: IfNotPresent ports: - containerPort: 80é€šè¿‡è¿™ä¸ªRCï¼Œæˆ‘ä»¬å¯ä»¥å®žçŽ°ï¼šåœ¨Kubernetesé›†ç¾¤ä¸­ï¼Œä»»æ„æ—¶åˆ»éƒ½å­˜åœ¨3ä¸ªè¿è¡Œç€Nginxå®¹å™¨çš„Podï¼Œå³é€šè¿‡è¿™ä¸ªRCæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªNginxæ•°é‡ä¸º3çš„Nginxé›†ç¾¤ï¼ˆå…¶ä¸­ä¸€ç§å¯èƒ½æ€§ï¼‰ï¼šåœ¨Kubernetesçš„å‘å±•ä¸­ï¼ŒRCå‡çº§ä¸ºäº†Replica Setï¼Œä¿—ç§°RSï¼Œè¯­æ³•å¤§è‡´å’ŒRCä¸€è‡´ã€‚RSå’ŒRCæœ€å¤§çš„åŒºåˆ«åœ¨äºŽï¼šRSæ‹¥æœ‰æ›´ä¸ºðŸ‚ðŸºçš„Podç­›é€‰å™¨ã€‚æ¯”å¦‚ï¼š12345678910111213apiVersion: apps/v1kind: ReplicaSetmetadata: name: frontendspec: replicas: 2 selector: matchLabels: tier: frontend matchExpressions: - &#123;key: release, operator: In, values: [stable, snapshot]&#125; template: ...ä¸Šé¢çš„RSç­›é€‰Podè§„åˆ™ä¸ºï¼šç­›é€‰æ ‡ç­¾åŒ…å«tierä¸ºfrontendï¼Œå¹¶ä¸”releaseçš„å€¼ä¸ºstableæˆ–è€…snapshotçš„Podã€‚æ€»ä¹‹ï¼ŒRC(RS)çš„ä½œç”¨ä¸º:Podçš„åˆ›å»ºåŠæ•°é‡æŽ§åˆ¶ï¼›é€šè¿‡æ”¹å˜RCé‡Œçš„Podå‰¯æœ¬æ•°é‡ï¼Œå¯ä»¥å®žçŽ°Podçš„æ‰©å®¹æˆ–ç¼©å®¹ï¼›é€šè¿‡æ”¹å˜RCé‡ŒPodæ¨¡æ¿ä¸­çš„é•œåƒç‰ˆæœ¬ï¼Œå¯ä»¥å®žçŽ°Podçš„æ»šåŠ¨å‡çº§ã€‚DeploymentDeploymentå¯ä»¥çœ‹æˆæ˜¯RSçš„å‡çº§ç‰ˆç»„ä»¶ï¼Œå†…éƒ¨ä½¿ç”¨RSç®¡ç†Podï¼Œå’ŒRSç›¸æ¯”æœ€å¤§çš„ä¸åŒåœ¨äºŽDeploymentå¯ä»¥éšæ—¶æŸ¥çœ‹Podçš„éƒ¨ç½²çŠ¶æ€ã€‚Deploymentçš„yamlé…ç½®å’ŒRSå·®ä¸å¤šï¼Œä¸¾ä¸ªDeployment yamlçš„ä¾‹å­(nginx-deployment.yml):1234567891011121314151617181920apiVersion: apps/v1kind: Deploymentmetadata: name: nginx-deploymentspec: selector: matchLabels: name: nginx replicas: 3 template: metadata: labels: name: nginx spec: containers: - name: nginx image: nginx imagePullPolicy: IfNotPresent ports: - containerPort: 80é™¤äº†kindï¼Œå…¶ä»–éƒ½å’ŒRSå·®ä¸å¤šã€‚åœ¨Kubernetesé›†ç¾¤ä¸­åˆ›å»ºè¯¥Deploymentï¼šREADYï¼šé›†ç¾¤ä¸­å‡†å¤‡å°±ç»ªçš„Podæ•°é‡ï¼›UP-TO-DATEï¼šæœ€æ–°ç‰ˆæœ¬çš„Podçš„å‰¯æœ¬æ•°é‡ï¼Œç”¨äºŽæŒ‡ç¤ºåœ¨æ»šåŠ¨å‡çº§çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰å¤šå°‘ä¸ªPodå‰¯æœ¬å·²ç»æˆåŠŸå‡çº§ï¼›AVAILABLEï¼šå½“å‰é›†ç¾¤ä¸­å¯ç”¨çš„Podå‰¯æœ¬æ•°é‡ï¼Œå³é›†ç¾¤ä¸­å½“å‰å­˜æ´»çš„Podæ•°é‡ã€‚æŸ¥çœ‹RSå’ŒPodï¼šå¯ä»¥çœ‹åˆ°å®ƒä»¬çš„å…³ç³»ä¸ºdeployment -&gt; rs -&gt; podsï¼šStatefulSetStatefulSetï¼ˆæœ‰çŠ¶æ€é›†åˆï¼‰å¯ä»¥çœ‹æˆæ˜¯Deploymentçš„ä¸€ä¸ªå˜ç§ï¼Œé€‚åˆç”¨äºŽæž„å»ºMySQLé›†ç¾¤ã€MongoDBé›†ç¾¤ç­‰æœ‰çŠ¶æ€çš„é›†ç¾¤ï¼Œè¿™äº›é›†ç¾¤æœ‰ä»¥ä¸‹è¿™äº›å…±åŒç‰¹ç‚¹ï¼šé›†ç¾¤è§„æ¨¡ç›¸å¯¹å›ºå®šï¼Œä¸èƒ½éšæ„å˜åŠ¨ï¼›é›†ç¾¤ä¸­æ¯ä¸ªPodéƒ½æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå³æ•°æ®ä¼šè¢«æŒä¹…åŒ–åˆ°å­˜å‚¨ä¸­ï¼›æ¯ä¸ªPodéƒ½æœ‰å›ºå®šçš„IDã€‚StatefulSetåˆ›å»ºçš„Podé›†ç¾¤ç¬¦åˆä¸Šé¢çš„éœ€æ±‚ï¼Œå…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹:æ¯ä¸ªPodçš„åç§°åœ¨åˆ›å»ºå‰å°±å¯ä»¥ç¡®å®šä¸‹æ¥äº†ã€‚æ¯”å¦‚StatefulSetçš„åç§°ä¸ºmysqlï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªPodå«mysql-0ï¼Œç¬¬äºŒä¸ªå«mysql-1ï¼Œä»¥æ­¤ç±»æŽ¨ï¼›Podçš„å¯åœè¯•æ˜¯æŒ‰ç…§é¡ºåºæ¥çš„ï¼›Podé€šè¿‡PVæˆ–è€…PVCæ¥æŒä¹…åŒ–å­˜å‚¨ã€‚è¿™é‡Œå°±å…ˆä¸æ·±å…¥ç ”ç©¶StatefulSetäº†ï¼ŒåŽé¢å†æ‰¾æœºä¼šç ”ç©¶ã€‚JobJobæ˜¯ä¸€ç§ç‰¹æ®Šçš„Podç®¡ç†å¯¹è±¡ï¼Œæ˜¯ä¸€ç§ä¸€æ¬¡æ€§Podè¿è¡Œä»»åŠ¡ï¼Œä»»åŠ¡ç»“æŸåŽï¼ŒPodçš„ç”Ÿå‘½å‘¨æœŸä¹Ÿå°±ç»“æŸäº†ã€‚Kubernetesä¸­æ”¯æŒCronè¡¨è¾¾å¼çš„ä»»åŠ¡ç§°ä¸ºCronJobï¼ŒåŽé¢æŽ¥è§¦åˆ°äº†å†ä»”ç»†ç ”ç©¶ðŸ˜ªã€‚Labelå°±å¦‚ä¸Šé¢æ‰€è¯´ï¼ŒLabelå°±æ˜¯ç”¨äºŽç»™Podæ‰“æ ‡ç­¾ç”¨çš„ï¼Œä¾›Podç®¡ç†å¯¹è±¡ã€Serviceç­‰ç­›é€‰ä½¿ç”¨ã€‚HPAé™¤äº†ä½¿ç”¨kubectl scaleå‘½ä»¤ä¿®æ”¹Podæ•°é‡å®žçŽ°æ‰©å®¹æˆ–è€…ç¼©å®¹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©HPAï¼ˆHorizontal Pod Autoscalingï¼ŒPodæ¨ªå‘è‡ªåŠ¨æ‰©å±•ï¼‰æ¥å®ŒæˆPodçš„è‡ªåŠ¨åŒ–æ‰©ç¼©å®¹ã€‚ä¸¾ä¸ªHPAçš„ä¾‹å­ï¼š123456789101112apiVersion: autoscaling/v1kind: HorizontalPodAutoscalermetadata: name: nginx-hpa namespace: defaultspec: maxReplicas: 10 minReplicas: 3 scaleTargetRef: kind: Deployment name: nginx-deployment targetCPUUtilizationPercentage: 80ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªåä¸ºnginx-hpaçš„HPAï¼Œç›‘æŽ§åç§°ä¸ºnginx-deploymentçš„Deploymentä¸­çš„Podï¼Œå½“å…¶targetCPUUtilizationPercentageçš„å€¼å¤§äºŽ80%æ—¶ï¼Œå°†å‘ç”ŸåŠ¨æ€æ‰©å®¹è¡Œä¸ºï¼Œå¹¶ä¸”Podçš„æ•°é‡å¿…é¡»å†3~10ä¹‹é—´ã€‚targetCPUUtilizationPercentageæŒ‡çš„æ˜¯Podä¸€åˆ†é’Ÿå†…CPUä½¿ç”¨çŽ‡çš„ç®—æ•°å¹³å‡å€¼ã€‚æ¯”å¦‚Podçš„requests cpuä¸º0.4ï¼Œå½“å‰CPUä½¿ç”¨é‡ä¸º0.3ï¼Œåˆ™CPUä½¿ç”¨çŽ‡ä¸º75%ã€‚æ‰€ä»¥è¦ä½¿ç”¨HPAçš„åŠŸèƒ½ï¼ŒPodå¿…é¡»æŒ‡å®šäº†requests cpuå€¼ã€‚ServiceServiceã€RCå’ŒPodä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šä»Žå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒServiceæ˜¯å¤–ç•Œè®¿é—®Podçš„æ¡¥æ¢ï¼ŒServiceé€šè¿‡Label Selectoræ¥ç­›é€‰å¤„ç¬¦åˆçš„Podï¼Œå°†è¯·æ±‚å‡è¡¡çš„è½¬å‘åˆ°ç›®æ ‡Podä¸Šã€‚å‰é¢ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡Deploymentåˆ›å»ºäº†ä¸‰ä¸ªNginx Podï¼Œä½†çŽ°åœ¨å¤–ç•Œå¹¶ä¸èƒ½ç›´æŽ¥è®¿é—®å®ƒä»¬ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªServiceæ¥å®žçŽ°è¿™ä¸ªéœ€æ±‚ï¼š1vim nginx-service.ymlå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112apiVersion: v1kind: Servicemetadata: name: nginx-servicespec: ports: - port: 8080 targetPort: 80 nodePort: 30001 type: NodePort selector: name: nginxä¸Šé¢é…ç½®ä¸­spec.portså®šä¹‰äº†ä¸‰ä¸ªç«¯å£ï¼Œåœ¨äº†è§£è¿™ä¸‰ä¸ªç«¯å£çš„å«ä¹‰ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸‹ä¸‹é¢è¿™ä¸‰ä¸ªIPçš„å«ä¹‰ï¼šNode IPï¼šNodeçš„IPåœ°å€ï¼ŒNodeæ˜¯éƒ¨ç½²åœ¨å®¿ä¸»æœºä¸Šçš„ï¼Œæ‰€ä»¥å®žé™…ä¸Šå°±æ˜¯å®¿ä¸»æœºçš„IPåœ°å€ï¼Œä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼›Pod IPï¼šPodçš„IPåœ°å€ï¼Œç”±äºŽåŠ¨æ€æ‰©ç¼©å®¹ã€å®•æœºè½¬ç§»ç­‰åŽŸå› ï¼Œè¿™ä¸ªIPç»å¸¸ä¼šå‘ç”Ÿæ”¹å˜ï¼›Cluster IPï¼šServiceçš„IPåœ°å€ï¼Œåœ¨ä¸€ä¸ªå®Œæ•´çš„Serviceç”Ÿå‘½å‘¨æœŸå†…æ˜¯ä¸ä¼šæ”¹å˜çš„ã€‚å…¶ä¸­Pod IPå’ŒCluster IPæ˜¯å±žäºŽKubernetesé›†ç¾¤èŒƒå›´å†…çš„ï¼Œå¤–ç•Œæ— æ³•ç›´æŽ¥è®¿é—®ã€‚å†å›žå¤´çœ‹ä¸Šé¢ä¸‰ä¸ªç«¯å£çš„å«ä¹‰ï¼športï¼šæŒ‡å®šServiceçš„ç«¯å£å·ï¼›targetPortï¼šç›®æ ‡Podçš„ç«¯å£ï¼Œæ ¹æ®å‰é¢nginx-deploymentçš„å®šä¹‰ï¼Œè¿™é‡Œåº”è¯¥æŒ‡å®šä¸º80ï¼›nodePortï¼šåœ¨Nodeä¸Šå¼€å¯çš„ç›‘å¬ç«¯å£ï¼Œç”¨äºŽå¤–ç•Œé€šè¿‡Cluster IP:nodePortæ¥è®¿é—®å¯¹åº”çš„Serviceã€‚ä½¿ç”¨nodePortæ—¶ï¼Œéœ€è¦å°†Serviceçš„typeæŒ‡å®šä¸ºNodePortï¼Œå¹¶ä¸”nodePortæœ‰èŒƒå›´é™åˆ¶ï¼Œå¿…é¡»åœ¨30000-32767ä¹‹é—´ã€‚ä½¿ç”¨kubectl create -f nginx-service.ymlåˆ›å»ºè¯¥Serviceï¼šæŸ¥çœ‹Serviceå’Œendpointï¼šçŽ°åœ¨æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡node1 Ip:nodePortæ¥è®¿é—®Nginx PodæœåŠ¡äº†ï¼šVolumeVolumeæ˜¯Podä¸Šèƒ½å¤Ÿè¢«å¤šä¸ªDockerå®¹å™¨è®¿é—®çš„å…±äº«ç›®å½•ï¼ŒVolumeçš„ç”Ÿå‘½å‘¨æœŸå’ŒPodç›¸å…³ï¼Œä¸ŽDockerå®¹å™¨æ— å…³ã€‚å¯ä»¥åœ¨å®šä¹‰Podçš„æ—¶å€™æŒ‡å®šVolumeï¼š12345678910111213141516171819apiVersion: v1kind: Podmetadata: name: nginx-pod labels: name: nginxspec: volumes: - name: nginx-data emptyDir: &#123;&#125; containers: - name: nginx image: nginx imagePullPolicy: IfNotPresent ports: - containerPort: 80 volumeMounts: - mountPath: /etc/nginx name: nginx-dataé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯çŽ°åœ¨Podé‡Œå£°æ˜Žä¸€ä¸ªVolumeï¼Œç„¶åŽåœ¨å®¹å™¨é‡Œå¼•ç”¨è¯¥Volumeï¼Œå¹¶æŒ‚è½½åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•ä¸Šã€‚æ¯”è¾ƒå¸¸ç”¨çš„Volumeç±»åž‹æœ‰ï¼šemptyDirï¼šä¸€ä¸ªemptyDir Volumeæ˜¯åœ¨Podåˆ†é…åˆ°Nodeæ—¶åˆ›å»ºçš„ã€‚ä»Žå®ƒçš„åç§°å°±å¯ä»¥çœ‹å‡ºï¼Œå®ƒçš„åˆå§‹å†…å®¹ä¸ºç©ºï¼Œå¹¶ä¸”æ— é¡»æŒ‡å®šå®¿ä¸»æœºä¸Šå¯¹åº”çš„ç›®å½•æ–‡ä»¶ï¼Œå› ä¸ºè¿™æ˜¯Kubernetesè‡ªåŠ¨åˆ†é…çš„ä¸€ä¸ªç›®å½•ï¼Œå½“Podä»ŽNodeä¸Šç§»é™¤æ—¶ï¼ŒemptyDirä¸­çš„æ•°æ®ä¹Ÿä¼šè¢«æ°¸ä¹…åˆ é™¤ï¼›hostPathä¸ºåœ¨Podä¸ŠæŒ‚è½½å®¿ä¸»æœºä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œæ¯”å¦‚ï¼š12345spec: volumes: - name: "persistend-storage" hostPath: path: "/data"PV,PVCPV(Persistent Volume)æ˜¯Kubernetesé›†ç¾¤ä¸­çš„æŸä¸ªç½‘ç»œå­˜å‚¨å¯¹åº”çš„ä¸€å—å­˜å‚¨ï¼Œä¸å±žäºŽä»»ä½•Nodeï¼Œä½†å¯ä»¥åœ¨æ¯ä¸ªNodeä¸Šè®¿é—®ï¼›PVC(Persistent Volume Claimï¼ŒPVå£°æ˜Ž)ï¼ŒæŸä¸ªPodéœ€è¦ç”¨åˆ°PVå‰ï¼Œå¿…é¡»å…ˆå®šä¹‰PVCã€‚å®šä¸€ä¸ªNFSç±»åž‹çš„PVï¼Œå£°æ˜Žéœ€è¦10Giå­˜å‚¨ï¼š123456789101112apiVersion: v1kind: PersistentVolumemetadata: name: pv01spec: capacity: storage: 10Gi accessModes: - ReadWriteOnce nfs: path: /somepath server: 127.17.0.2è¯¥PVå£°æ˜Žäº†127.17.0.2NFSç³»ç»Ÿä¸‹çš„/somepathç›®å½•ä½œä¸ºç½‘ç»œå­˜å‚¨ï¼Œå†…å­˜ä¸º10Giï¼Œè¯¥PVåç§°ä¸ºpv01ã€‚accessModesæœ‰ä»¥ä¸‹ä¸‰ç§æ¨¡å¼ï¼šReadWriteOnceï¼šè¯»å†™æƒé™ï¼Œå¹¶ä¸”åªèƒ½è¢«å•ä¸ªNodeæŒ‚è½½ï¼›ReadOnlyManyï¼šåªè¯»æƒé™ï¼Œå…è®¸è¢«å¤šä¸ªNodeæŒ‚è½½ï¼›ReadWriteManyï¼šè¯»å†™æƒé™ï¼Œå…è®¸è¢«å¤šä¸ªNodeæŒ‚è½½ã€‚æŽ¥ç€å®šä¹‰ä¸€ä¸ªPVCï¼š12345678910apiVersion: v1kind: PersistentVolumeClaimmetadata: name: pvclaimspec: accessModes: - ReadWriteOnce resources: requests: storage: 8Giè¯¥PVCå£°æ˜Žäº†éœ€è¦8Giå­˜å‚¨ç©ºé—´ï¼Œåˆšåˆšå®šä¹‰çš„PVç¬¦åˆè¿™ä¸ªè¦æ±‚ï¼Œæ‰€ä»¥ä¼šè¢«ç»‘å®šä¸Šã€‚å®šä¹‰äº†PVCåŽï¼Œå°±å¯ä»¥åœ¨Podé‡Œå¼•ç”¨äº†ï¼š12345spec: volumes: - name: podpv persistentVolumeClaim: claimName: pvclaimPVå…·æœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€ï¼šAvailableï¼šç©ºé—²çŠ¶æ€ï¼›Boundï¼šå·²ç»ç»‘å®šåˆ°æŸä¸ªPVCä¸Šï¼›Releasedï¼šå¯¹åº”çš„PVCå·²ç»è¢«åˆ é™¤ï¼Œä½†èµ„æºè¿˜æ²¡æœ‰è¢«é›†ç¾¤æ”¶å›žï¼›Failedï¼šPVè‡ªåŠ¨å›žæ”¶å¤±è´¥ã€‚NamespaceNamespaceé¡¾åæ€ä¹‰ï¼Œå‘½åç©ºé—´ï¼Œç”¨äºŽèµ„æºéš”ç¦»ã€‚é»˜è®¤Kubernetesä¼šåˆ›å»ºdefaultå‘½åç©ºé—´ï¼Œå¹¶ä¸”Podï¼ŒRCç­‰éƒ½æ˜¯ç”¨è¯¥å‘½åç©ºé—´ã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰è‡ªå·±çš„å‘½åç©ºé—´ï¼š1234apiVersion: v1kind: Namespacemetadata: name: febsåœ¨åˆ›å»ºPodç­‰èµ„æºçš„æ—¶å€™å°±å¯ä»¥æŒ‡å®šè¯¥å‘½åç©ºé—´äº†ï¼š12345678apiVersion: v1kind: Podmetadata: name: nginx-pod namespace: febs labels: name: nginx...AnnotationAnnotationæ˜¯ç”¨æˆ·ä»»æ„å®šä¹‰çš„é™„åŠ ä¿¡æ¯ï¼Œä¾¿äºŽå¤–éƒ¨å·¥å…·æŸ¥æ‰¾ï¼Œæ¯”å¦‚ç‰ˆæœ¬ä¿¡æ¯ï¼Œbuildä¿¡æ¯ç­‰ã€‚ConfigMapå­¦è¿‡Dockerçš„éƒ½çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŒ‚è½½ç›®å½•çš„æ–¹å¼å°†å®¿ä¸»æœºä¸­çš„é…ç½®æ–‡ä»¶æ˜ å°„åˆ°Dockerå®¹å™¨å†…ã€‚ä½†è¿™åœ¨é›†ç¾¤çŽ¯å¢ƒä¸‹ï¼Œè¦æŒ‚è½½çš„é…ç½®æ–‡ä»¶è¿‡å¤šï¼Œä¸ä»…éº»çƒ¦è€Œä¸”å®¹æ˜“å‡ºé”™ï¼ŒKuberneteçš„ConfigMapå°±æ˜¯ç”¨äºŽè§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚ConfigMapå­˜å‚¨äº†å¤§é‡key-valueé…ç½®ï¼Œå­˜å‚¨åœ¨etcdä¸­ï¼Œé€šè¿‡Volumeçš„æ–¹å¼æ˜ å°„åˆ°ç›®æ ‡Podå†…ï¼Œæˆä¸ºä¸€ä»½é…ç½®æ–‡ä»¶ï¼ŒConfigMapå®žè´¨ä¸Šå°±æ˜¯ä¸€ä¸ªé…ç½®ä¸­å¿ƒã€‚ã€ŠKubernetesæƒå¨æŒ‡å—(ç¬¬4ç‰ˆ)ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes1.16.2å®‰è£…Dashboard]]></title>
    <url>%2FKubernetes1-16-2-install-Dashboard.html</url>
    <content type="text"><![CDATA[Kubernetes Dashboardæ˜¯Kubernetesæä¾›çš„Webç”¨æˆ·ç•Œé¢ï¼Œé€šè¿‡Dashboardæˆ‘ä»¬å¯ä»¥å°†å®¹å™¨åŒ–çš„åº”ç”¨éƒ¨ç½²åˆ°Kubernetesé›†ç¾¤ä¸­ï¼Œå¯¹å®¹å™¨åŒ–çš„åº”ç”¨è¿›è¡Œæ•…éšœæŽ’é™¤ä»¥åŠé›†ç¾¤èµ„æºç®¡ç†ï¼›å¯ä»¥é€šè¿‡DashboardæŸ¥çœ‹é›†ç¾¤åº”ç”¨è¯¦æƒ…ï¼Œåˆ›å»ºæˆ–ä¿®æ”¹å•ä¸ªKubernetesèµ„æºï¼ˆä¾‹å¦‚Deploymentsï¼ŒJobsï¼ŒDaemonSetsç­‰ï¼‰ã€‚å®‰è£…Dashboardä¸ŠèŠ‚æˆ‘ä»¬æ­å»ºçš„Kubernetesé›†ç¾¤ç‰ˆæœ¬ä¸º1.16.2ï¼Œæˆªè‡³ç›®å‰ä¸ºæ­¢ï¼Œä¸Žè¯¥ç‰ˆæœ¬å¯¹åº”çš„Dashboardç‰ˆæœ¬ä¸ºv2.0.0-beta5ï¼Œå¯ä»¥é€šè¿‡https://github.com/kubernetes/dashboard/releasesæŸ¥çœ‹ï¼šä¸‹è½½è¯¥ç‰ˆæœ¬çš„Dashboard yamlæ–‡ä»¶ï¼š1wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-beta5/aio/deploy/recommended.yamlä¿®æ”¹è¯¥é…ç½®æ–‡ä»¶ï¼š1vim recommended.yamlä¿®æ”¹çš„å†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šæŽ¥ç€åˆ›å»ºè¯ä¹¦ï¼š123456789101112131415161718mkdir dashboard-certscd dashboard-certs/#åˆ›å»ºå‘½åç©ºé—´kubectl create namespace kubernetes-dashboard#åˆ›å»ºkeyæ–‡ä»¶openssl genrsa -out dashboard.key 2048#è¯ä¹¦è¯·æ±‚openssl req -days 36000 -new -out dashboard.csr -key dashboard.key -subj &apos;/CN=dashboard-cert&apos;#è‡ªç­¾è¯ä¹¦openssl x509 -req -in dashboard.csr -signkey dashboard.key -out dashboard.crt#åˆ›å»ºkubernetes-dashboard-certså¯¹è±¡kubectl create secret generic kubernetes-dashboard-certs --from-file=dashboard.key --from-file=dashboard.crt -n kubernetes-dashboardç„¶åŽæ‰§è¡Œkubectl create -f ../recommended.yamlå‘½ä»¤å®‰è£…Dashboardã€‚ä½¿ç”¨kubectl get service -n kubernetes-dashboard -o wideå‘½ä»¤æŸ¥çœ‹æ˜¯å¦éƒ¨ç½²æˆåŠŸï¼šåˆ›å»ºè´¦å·ä¸ŽæŽˆæƒDashboardéƒ¨ç½²å¥½åŽï¼ŒæŽ¥ç€åˆ›å»ºè´¦å·ï¼š1vim dashboard-admin.yamlå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š1234567apiVersion: v1kind: ServiceAccountmetadata: labels: k8s-app: kubernetes-dashboard name: dashboard-admin namespace: kubernetes-dashboardåˆ›å»ºè¯¥è´¦å·ï¼š1kubectl create -f dashboard-admin.yamlè´¦å·åˆ›å»ºå¥½åŽï¼ŒæŽ¥ç€ä¸ºå…¶æŽˆæƒï¼š1vim dashboard-admin-bind-cluster-role.yamlå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata: name: dashboard-admin-bind-cluster-role labels: k8s-app: kubernetes-dashboardroleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-adminsubjects:- kind: ServiceAccount name: dashboard-admin namespace: kubernetes-dashboardæŽˆæƒï¼š1kubectl create -f dashboard-admin-bind-cluster-role.yamlè®¿é—®Dashboardä½¿ç”¨æµè§ˆå™¨è®¿é—®https://192.168.33.12:30008/#/loginï¼šé€‰æ‹©Tokenï¼ŒTokençš„å€¼å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤èŽ·å–ï¼š1kubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep dashboard-admin | awk &apos;&#123;print $1&#125;&apos;)å¤åˆ¶è¯¥Tokenåˆ°Dashboardï¼šç‚¹å‡»Sign Inï¼šå®‰è£…Metrics Serviceä¸Šé¢Dashboardçš„CPU Usage (cores)å’ŒMemory Usage (bytes)åˆ—æ˜¯ç©ºçš„ï¼Œè¿™æ˜¯å› ä¸ºKubernetesçš„æ—©æœŸç‰ˆæœ¬ä¾é Heapsteræ¥å®žçŽ°å®Œæ•´çš„æ€§èƒ½æ•°æ®é‡‡é›†å’Œç›‘æŽ§åŠŸèƒ½ï¼ŒKubernetesä»Ž1.8ç‰ˆæœ¬å¼€å§‹ï¼Œæ€§èƒ½æ•°æ®å¼€å§‹ä»¥Metrics APIçš„æ–¹å¼æä¾›æ ‡å‡†åŒ–æŽ¥å£ï¼Œå¹¶ä¸”ä»Ž1.10ç‰ˆæœ¬å¼€å§‹å°†Heapsteræ›¿æ¢ä¸ºMetrics Serverã€‚é¦–å…ˆåœ¨masterèŠ‚ç‚¹ä¸Šå®‰è£…gitï¼š1yum install gitç„¶åŽå…‹éš†Metrics Server GitHubä»“åº“ï¼š1git clone https://github.com/kubernetes-sigs/metrics-server.gitä¿®æ”¹metrics-server-deployment.yamlï¼š1vim metrics-server/deploy/1.8+/metrics-server-deployment.yamlä¿®æ”¹å†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š1234567...... imagePullPolicy: IfNotPresent command: - /metrics-server - --kubelet-preferred-address-types=InternalIP - --kubelet-insecure-tls......å› ä¸ºé»˜è®¤metrics serviceçš„é•œåƒåœ°å€éœ€è¦ç§‘å­¦ä¸Šç½‘æ‰èƒ½æ‹‰å–ï¼Œæ‰€ä»¥åœ¨åˆ›å»ºä¹‹å‰ï¼Œæˆ‘ä»¬åœ¨node1å’Œnode2èŠ‚ç‚¹å…ˆæ‰§è¡Œä»¥ä¸‹æ“ä½œå‡†å¤‡é•œåƒï¼š12docker pull bluersw/metrics-server-amd64:v0.3.6docker tag bluersw/metrics-server-amd64:v0.3.6 k8s.gcr.io/metrics-server-amd64:v0.3.6ç„¶åŽå›žåˆ°masterèŠ‚ç‚¹ï¼Œæ‰§è¡Œï¼š1kubectl create -f metrics-server/deploy/1.8+/ç¨ç­‰ç‰‡åˆ»ï¼Œç„¶åŽæ‰§è¡Œkubectl top nodesä¾¿å¯ä»¥çœ‹åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„CPUå’Œå†…å­˜ä½¿ç”¨çŽ‡äº†ï¼šå›žåˆ°Dashboardï¼š]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubeadmå®‰è£…Kubernetes1.16.2é›†ç¾¤]]></title>
    <url>%2FKubeadm-install-Kubernetes1-16-2-cluster.html</url>
    <content type="text"><![CDATA[Kubernetesä»Ž1.4ç‰ˆæœ¬å¼€å§‹åŽå°±å¼•å…¥äº†kubeadmç”¨äºŽç®€åŒ–é›†ç¾¤æ­å»ºçš„è¿‡ç¨‹ï¼Œåœ¨Kubernetes 1.13ç‰ˆæœ¬ä¸­ï¼Œkubeadmå·¥å…·è¿›å…¥GAé˜¶æ®µï¼Œå¯ç”¨äºŽç”Ÿäº§çŽ¯å¢ƒKubernetesé›†ç¾¤æ­å»ºã€‚æœ¬èŠ‚å°†ä½¿ç”¨Kubeadmæ­å»ºKubernetes1.16.2é›†ç¾¤ï¼Œå®¿ä¸»æœºé‡‡ç”¨3å°Vagrantæž„å»ºçš„Centos7è™šæ‹Ÿæœºï¼Œé…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼ˆKubernetesæŽ¨èå®¿ä¸»æœºæœ€ä½Žå†…å­˜ä¸èƒ½ä½ŽäºŽ2Gï¼ŒCPUæ ¸å¿ƒæ•°æœ€ä½Žä¸èƒ½ä½ŽäºŽ2ï¼‰ï¼šæ“ä½œç³»ç»ŸIPè§’è‰²CPUæ ¸å¿ƒæ•°å†…å­˜Hostnamecentos7192.168.33.11master24096Mmastercentos7192.168.33.12worker24096Mnode1centos7192.168.33.13worker24096Mnode2åˆ†äº«ä¸‹æˆ‘çš„Vagrantfileé…ç½®ï¼š1234567891011121314151617181920212223242526272829Vagrant.configure("2") do |config| config.vm.box = "centos/7" config.vm.define "one" do |one| one.vm.network "private_network", ip: "192.168.33.11" one.vm.hostname = "master" one.vm.provider "virtualbox" do |v| v.memory = 4096 v.cpus = 2 end end config.vm.define "two" do |two| two.vm.network "private_network", ip: "192.168.33.12" two.vm.hostname = "node1" two.vm.provider "virtualbox" do |v| v.memory = 4096 v.cpus = 2 end end config.vm.define "three" do |three| three.vm.network "private_network", ip: "192.168.33.13" three.vm.hostname = "node2" three.vm.provider "virtualbox" do |v| v.memory = 4096 v.cpus = 2 end endendå¯åŠ¨åŽå¦‚ä¸‹æ‰€ç¤ºï¼šå‡†å¤‡å·¥ä½œä¸‹é¢è¿™äº›å‡†å¤‡å·¥ä½œåˆ†åˆ«åœ¨3å°æœºå™¨ä¸Šä½¿ç”¨rootè´¦å·æ“ä½œï¼š1.å®‰è£…å¿…è¦è½¯ä»¶ï¼š1yum install -y net-tools.x86_64 vim wget2.é…ç½®hostsï¼š1vim /etc/hostså†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123192.168.33.11 master192.168.33.12 node1192.168.33.13 node23.å…³é—­é˜²ç«å¢™ï¼šä¸ºäº†é¿å…kubernetesçš„MasterèŠ‚ç‚¹å’Œå„ä¸ªå·¥ä½œèŠ‚ç‚¹çš„NodeèŠ‚ç‚¹é—´çš„é€šä¿¡å‡ºçŽ°é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å…³é—­æœ¬åœ°æ­å»ºçš„Centosè™šæ‹Ÿæœºçš„é˜²ç«å¢™ã€‚ç”Ÿäº§çŽ¯å¢ƒæŽ¨èçš„åšæ³•æ˜¯åœ¨é˜²ç«å¢™ä¸Šé…ç½®å„ä¸ªç»„ä»¶éœ€è¦ç›¸äº’é€šä¿¡çš„ç«¯å£ã€‚12systemctl disable firewalldsystemctl stop firewalld4.ç¦ç”¨SELinuxï¼Œè®©å®¹å™¨å¯ä»¥é¡ºåˆ©åœ°è¯»å–ä¸»æœºæ–‡ä»¶ç³»ç»Ÿï¼š1setenforce 01sed -i &apos;s/^SELINUX=enforcing$/SELINUX=disabled/&apos; /etc/selinux/config5.å®‰è£…18.09ç‰ˆæœ¬çš„dockerï¼šå› ä¸ºæœ¬èŠ‚éœ€è¦å®‰è£…çš„kubernetesé›†ç¾¤ç‰ˆæœ¬ä¸º1.16.2ï¼Œè€Œè¯¥ç‰ˆæœ¬çš„kubernetesæœ€é«˜æ”¯æŒçš„dockerç‰ˆæœ¬ä¸º18.09ã€‚å¯ä»¥é€šè¿‡è¯¥åœ°å€æŸ¥çœ‹kuberneteså’Œdockerçš„ç‰ˆæœ¬å¯¹åº”å…³ç³»ï¼šhttps://github.com/kubernetes/kubernetes/blob/master/CHANGELOG-1.16.md#downloads-for-v1160ï¼šå®‰è£…å¿…è¦ä¾èµ–:123yum install -y yum-utils \ device-mapper-persistent-data \ lvm2æ·»åŠ dockerç¨³å®šç‰ˆä»“åº“ï¼š123yum-config-manager \ --add-repo \ https://download.docker.com/linux/centos/docker-ce.repoå®‰è£…18.09ç‰ˆæœ¬ï¼š1yum install docker-ce-18.09.0 docker-ce-cli-18.09.0 containerd.ioå¯åŠ¨dockerï¼Œå¹¶è®¾ç½®å¼€æœºè‡ªå¯ï¼š1systemctl enable docker &amp;&amp; systemctl start dockerä¿®æ”¹/etc/docker/daemon.jsonæ–‡ä»¶:1vim /etc/docker/daemon.jsonå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123&#123; &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]&#125;é‡å¯dockerï¼š12systemctl daemon-reloadsystemctl restart docker6.å°†æ¡¥æŽ¥çš„IPv4æµé‡ä¼ é€’åˆ°iptablesçš„é“¾1234cat &gt; /etc/sysctl.d/k8s.conf &lt;&lt; EOF net.bridge.bridge-nf-call-ip6tables = 1 net.bridge.bridge-nf-call-iptables = 1EOF1sysctl --system7.å…³é—­swapSwapæ˜¯æ“ä½œç³»ç»Ÿåœ¨å†…å­˜åƒç´§çš„æƒ…å†µç”³è¯·çš„è™šæ‹Ÿå†…å­˜ï¼ŒæŒ‰ç…§Kuberneteså®˜ç½‘çš„è¯´æ³•ï¼ŒSwapä¼šå¯¹Kubernetesçš„æ€§èƒ½é€ æˆå½±å“ï¼Œä¸æŽ¨èä½¿ç”¨Swapã€‚1swapoff -aå®‰è£…Masterå‡†å¤‡å·¥ä½œå®Œæ¯•åŽï¼ŒæŽ¥ç€å¼€å§‹åœ¨192.168.33.11 Masterè™šæ‹Ÿæœºä¸Šå®‰è£…Kubernetes Masterã€‚1.é…ç½®å›½å†…çš„kubernetesæºï¼š1234567891011cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo[kubernetes]name=Kubernetesbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/enabled=1gpgcheck=1repo_gpgcheck=1gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpgEOF2.å®‰è£…kubeletã€kubeadmå’Œkubectlå·¥å…·ï¼š1yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes3.å¯åŠ¨kubeletå¹¶è®¾ç½®å¼€æœºè‡ªå¯ï¼š1systemctl enable kubelet &amp;&amp; systemctl start kubelet4.ä½¿ç”¨ä¸‹é¢è¿™æ¡å‘½ä»¤å¯åŠ¨masterï¼š12345kubeadm init --kubernetes-version=v1.16.2 \--pod-network-cidr=10.244.0.0/16 \--service-cidr=10.1.0.0/16 \--apiserver-advertise-address=192.168.33.11 \--image-repository registry.aliyuncs.com/google_containersé…ç½®å«ä¹‰å¦‚ä¸‹ï¼škubernetes-version: ç”¨äºŽæŒ‡å®šk8sç‰ˆæœ¬ï¼Œè¿™é‡ŒæŒ‡å®šä¸ºæœ€æ–°çš„1.16.2ç‰ˆæœ¬ï¼›apiserver-advertise-addressï¼šç”¨äºŽæŒ‡å®škube-apiserverç›‘å¬çš„ipåœ°å€ï¼Œå°±æ˜¯masteræœ¬æœºIPåœ°å€ã€‚pod-network-cidrï¼šå› ä¸ºåŽé¢æˆ‘ä»¬é€‰æ‹©flannelä½œä¸ºPodçš„ç½‘ç»œæ’ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦æŒ‡å®šPodçš„ç½‘ç»œèŒƒå›´ä¸º10.244.0.0/16service-cidrï¼šç”¨äºŽæŒ‡å®šSVCçš„ç½‘ç»œèŒƒå›´ï¼›image-repository: å…¶ä¸­é»˜è®¤çš„é•œåƒä»“åº“k8s.gcr.ioæ²¡æœ‰ç§‘å­¦ä¸Šç½‘çš„è¯æ— æ³•è®¿é—®ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä¿®æ”¹ä¸ºå›½å†…çš„é˜¿é‡Œé•œåƒä»“åº“registry.aliyuncs.com/google_containerså¯åŠ¨æ—¶ï¼Œéœ€è¦æ‹‰å–é•œåƒï¼Œè¿‡ç¨‹æ¯”è¾ƒç¼“æ…¢è€å¿ƒç­‰å¾…å³å¯ã€‚å¦‚æžœä½ æƒ³å…ˆæ‹‰å¥½é•œåƒå†å¯åŠ¨ï¼Œä½ å¯ä»¥ä½¿ç”¨kubeadm config images listå‘½ä»¤åˆ—å‡ºéœ€è¦æ‹‰å–çš„é•œåƒã€‚å¯åŠ¨æˆåŠŸåŽï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹æç¤º:12345678910111213141516Your Kubernetes control-plane has initialized successfully!To start using your cluster, you need to run the following as a regular user: mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/configYou should now deploy a pod network to the cluster.Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at: https://kubernetes.io/docs/concepts/cluster-administration/addons/Then you can join any number of worker nodes by running the following on each as root:kubeadm join 192.168.33.11:6443 --token yf7sct.o63ceq25gxdu71cd \ --discovery-token-ca-cert-hash sha256:bcd15ddd7432d393d3831c75ac7673f582d4e9895ff2c579c3f545d2a5d3026eæ„æ€æ˜¯ï¼Œå¦‚æžœä½ æƒ³è¦éžrootç”¨æˆ·ä¹Ÿèƒ½ä½¿ç”¨kubectlå‘½ä»¤çš„è¯ï¼Œéœ€è¦æ‰§è¡Œä¸‹é¢è¿™äº›æ“ä½œï¼š123mkdir -p $HOME/.kubesudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/configsudo chown $(id -u):$(id -g) $HOME/.kube/configè€Œå¦‚æžœä½ æ˜¯rootç”¨æˆ·çš„è¯ï¼Œç›´æŽ¥è¿è¡Œä¸‹é¢è¿™æ®µå‘½ä»¤å³å¯ï¼š1export KUBECONFIG=/etc/kubernetes/admin.confè€Œä¸‹é¢è¿™æ®µåˆ™æ˜¯ç”¨äºŽå·¥ä½œèŠ‚ç‚¹NodeåŠ å…¥Masteré›†ç¾¤ç”¨çš„ï¼ŒåŽé¢ä¼šä½¿ç”¨åˆ°12kubeadm join 192.168.33.11:6443 --token yf7sct.o63ceq25gxdu71cd \ --discovery-token-ca-cert-hash sha256:bcd15ddd7432d393d3831c75ac7673f582d4e9895ff2c579c3f545d2a5d3026eå®‰è£…NodeèŠ‚ç‚¹ï¼ŒåŠ å…¥é›†ç¾¤æŽ¥ç€åœ¨192.168.33.12å’Œ192.168.33.13è™šæ‹Ÿæœºä¸Šæ“ä½œã€‚å’Œå®‰è£…Masteræ­¥éª¤ä¸€æ ·ï¼Œå…ˆå®‰è£…å¥½kubeadmç›¸å…³å·¥å…·ï¼Œç„¶åŽæ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤å°†NodeåŠ å…¥åˆ°é›†ç¾¤ï¼š12kubeadm join 192.168.33.11:6443 --token yf7sct.o63ceq25gxdu71cd \ --discovery-token-ca-cert-hash sha256:bcd15ddd7432d393d3831c75ac7673f582d4e9895ff2c579c3f545d2a5d3026eå½“è¾“å‡ºå¦‚ä¸‹å†…å®¹æ˜¯è¯´æ˜ŽåŠ å…¥æˆåŠŸï¼šå®‰è£…ç½‘ç»œæ’ä»¶åœ¨Masterä¸Šæ‰§è¡Œkubectl get nodeså‘½ä»¤ï¼Œä¼šå‘çŽ°Kubernetesæç¤ºMasterä¸ºNotReadyçŠ¶æ€ï¼Œè¿™æ˜¯å› ä¸ºè¿˜æ²¡æœ‰å®‰è£…CNIç½‘ç»œæ’ä»¶ï¼šå¯¹äºŽCNIç½‘ç»œæ’ä»¶ï¼Œå¯ä»¥æœ‰è®¸å¤šé€‰æ‹©ï¼Œè¯·å‚è€ƒhttps://kubernetes.io/docs/setup/independent/create-cluster-kubeadm/#pod-networkçš„è¯´æ˜Žã€‚è¿™é‡Œæˆ‘é€‰æ‹©çš„flannelï¼š1wget https://raw.githubusercontent.com/coreos/flannel/2140ac876ef134e0ed5af15c65e414cf26827915/Documentation/kube-flannel.ymlä¿®æ”¹kube-flannel.ymlï¼š1vim kube-flannel.ymlä¿®æ”¹çš„åœ°æ–¹å¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011......containers: - name: kube-flannel image: quay.io/coreos/flannel:v0.11.0-amd64 command: - /opt/bin/flanneld args: - --ip-masq - --kube-subnet-mgr - --iface=eth1 # æ–°å¢žéƒ¨åˆ†......Vagrant åœ¨å¤šä¸»æœºæ¨¡å¼ä¸‹æœ‰å¤šä¸ªç½‘å¡ï¼Œeth0 ç½‘å¡ç”¨äºŽnatè½¬å‘è®¿é—®å…¬ç½‘ï¼Œè€Œeth1ç½‘å¡æ‰æ˜¯ä¸»æœºçœŸæ­£çš„IPï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ç›´æŽ¥éƒ¨ç½²k8s flannel æ’ä»¶ä¼šå¯¼è‡´CoreDNSæ— æ³•å·¥ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸Šé¢è¿™æ¡é…ç½®å¼ºåˆ¶flannelä½¿ç”¨eth1ã€‚å®‰è£…flannelï¼š1kubectl create -f kube-flannel.ymlè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºæ—¶ï¼Œè¡¨ç¤ºå®‰è£…æˆåŠŸï¼šç¨ç­‰ç‰‡åˆ»åŽï¼Œå†æ¬¡æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€ï¼šå¯ä»¥çœ‹åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯ReadyçŠ¶æ€ã€‚æ‰§è¡Œkubectl get pods --all-namespacesï¼ŒéªŒè¯Kubernetesé›†ç¾¤çš„ç›¸å…³Podæ˜¯å¦éƒ½æ­£å¸¸åˆ›å»ºå¹¶è¿è¡Œï¼šåˆ°è¿™é‡Œé€šè¿‡Kubeadmå®‰è£…Kubernetes 1.16.2é›†ç¾¤å·²ç»æˆåŠŸäº†ã€‚å¦‚æžœå®‰è£…å¤±è´¥ï¼Œåˆ™å¯ä»¥æ‰§è¡Œkubeadm resetå‘½ä»¤å°†ä¸»æœºæ¢å¤åŽŸçŠ¶ï¼Œé‡æ–°æ‰§è¡Œkubeadm initå‘½ä»¤ï¼Œå†æ¬¡è¿›è¡Œå®‰è£…ã€‚å°è¯•ç‰›åˆ€ä¸ºäº†å¿«é€Ÿåœ°éªŒè¯ä¸€ä¸‹ä¸Šé¢æ­å»ºé›†ç¾¤æ˜¯å¦å¯ç”¨ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªNginx Deploymentï¼š123kubectl create deployment nginx --image=nginx kubectl expose deployment nginx --port=80 --type=NodePortä½¿ç”¨å‘½ä»¤kubectl get pod,svcæŸ¥çœ‹æ˜¯å¦æ­£å¸¸ï¼šä½¿ç”¨å‘½ä»¤kubectl get pods,svc -o wideæŸ¥çœ‹è¯¥Podå…·ä½“ä½äºŽå“ªä¸€ä¸ªèŠ‚ç‚¹ï¼šå¯ä»¥çœ‹åˆ°å…¶ä½äºŽNode2èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹IPä¸º192.168.33.13ï¼Œç«¯å£ä¸º30935ï¼Œä½¿ç”¨æµè§ˆå™¨è®¿é—®è¯¥åœ°å€ï¼šä½¿ç”¨kubectl get podså‘½ä»¤æŸ¥çœ‹Podçš„æƒ…å†µ:ä½¿ç”¨kubectl deleteå‘½ä»¤åˆ é™¤è¿™ä¸ªPodçœ‹çœ‹ä¼šæ€Žæ ·ï¼šå¯ä»¥çœ‹åˆ°ï¼Œåˆšåˆšçš„åä¸ºxxxçš„Podå¤„äºŽTerminatingï¼ˆç»“æŸä¸­ï¼‰çš„çŠ¶æ€ï¼Œè€Œå¦ä¸€ä¸ªæ–°çš„åä¸ºxxxçš„Podæ­£å¤„äºŽContainerCreatingï¼ˆåˆ›å»ºä¸­ï¼‰çŠ¶æ€ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œreplicasçš„å€¼ä¸º1ï¼ŒKubernetesé›†ç¾¤ä¼šå§‹ç»ˆä¿æŒNginxçš„å®žä¾‹ä¸º1ã€‚è¦åˆ é™¤Nginxå¯ä»¥é€šè¿‡åˆ é™¤deploymentæ¥å®Œæˆï¼Œä½¿ç”¨kubectl get deploymentså‘½ä»¤æŸ¥çœ‹å½“å‰çš„deploymentï¼šä½¿ç”¨å‘½ä»¤kubectl delete deployment nginxï¼šå®žé™…ä¸­æˆ‘ä»¬ä¸€èˆ¬é€šè¿‡ymlæˆ–è€…jsonæ–‡ä»¶æ¥åˆ›å»ºåº”ç”¨ï¼Œä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ymlçš„æ–¹å¼åˆ›å»ºä¸€ä¸ª3å®žä¾‹çš„Nginxé›†ç¾¤ï¼š1vim nginx-rc.ymlå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819apiVersion: v1kind: ReplicationControllermetadata: name: nginx-rcspec: replicas: 3 selector: name: nginx template: metadata: labels: name: nginx spec: containers: - name: nginx image: nginx imagePullPolicy: IfNotPresent ports: - containerPort: 801vim nginx-service.ymlå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112apiVersion: v1kind: Servicemetadata: name: nginx-servicespec: ports: - port: 8080 targetPort: 80 protocol: TCP type: NodePort selector: name: nginxæŽ¥ç€æ‰§è¡Œä¸‹é¢è¿™ä¸¤æ¡å‘½ä»¤å¯åŠ¨Nginxé›†ç¾¤ï¼š12kubectl create -f nginx-rc.ymlkubectl create -f nginx-service.ymlä½¿ç”¨kubectl get podså‘½ä»¤æŸ¥çœ‹Podæƒ…å†µ:ä½¿ç”¨kubectl get serviceså‘½ä»¤æŸ¥çœ‹Serviceæƒ…å†µï¼šä½¿ç”¨kubectl describe svc nginx-serviceå‘½ä»¤æŸ¥çœ‹Nginx Serviceè¯¦æƒ…ï¼šä½¿ç”¨å‘½ä»¤kubectl get pods,svc -o wideæŸ¥çœ‹Nginx Podå…·ä½“ä½äºŽå“ªä¸€ä¸ªèŠ‚ç‚¹ï¼šå¯ä»¥çœ‹åˆ°åœ¨node1å’Œnode2èŠ‚ç‚¹ä¸Šéƒ½æœ‰Nginxçš„Podï¼Œä½¿ç”¨æµè§ˆå™¨è®¿é—®http://192.168.33.12:32631/æˆ–è€…http://192.168.33.13:32631/ï¼šåˆ é™¤çš„è¯æ‰§è¡Œä¸‹é¢è¿™ä¸¤æ¡å‘½ä»¤å³å¯ï¼š12kubectl delete -f nginx-service.ymlkubectl delete -f nginx-rc.yml]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JVMå­¦ä¹ ]]></title>
    <url>%2FJVM-Learn.html</url>
    <content type="text"><![CDATA[JVMç»“æž„JVMç»“æž„æ¦‚è§ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šä¸Šå›¾ä¸­ï¼Œç°è‰²éƒ¨åˆ†ï¼ˆJavaæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆå’Œç¨‹åºè®¡æ•°å™¨ï¼‰æ˜¯çº¿ç¨‹ç§æœ‰ï¼Œä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œæ©™è‰²éƒ¨åˆ†ï¼ˆæ–¹æ³•åŒºå’Œå †ï¼‰ä¸ºçº¿ç¨‹å…±äº«åŒºã€‚ç±»åŠ è½½å™¨ç±»åŠ è½½å™¨(Class Loader)è´Ÿè´£åŠ è½½classæ–‡ä»¶ï¼Œclassæ–‡ä»¶åœ¨æ–‡ä»¶å¼€å¤´æœ‰ç‰¹å®šçš„æ–‡ä»¶æ ‡è¯†ï¼Œå°†classæ–‡ä»¶å­—èŠ‚ç å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†è¿™äº›å†…å®¹è½¬æ¢æˆæ–¹æ³•åŒºä¸­çš„è¿è¡Œæ—¶æ•°æ®ç»“æž„ã€‚ClassLoaderåªè´Ÿè´£classæ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºŽå®ƒæ˜¯å¦å¯ä»¥è¿è¡Œï¼Œåˆ™ç”±æ‰§è¡Œå¼•æ“ŽExecution Engineå†³å®šã€‚ç±»åŠ è½½ç¤ºæ„å›¾ï¼šä¹Ÿå°±æ˜¯è¯´ï¼Œç±»åŠ è½½å™¨è¯†åˆ«çš„classæ–‡ä»¶é™¤äº†æ˜¯.classæ ¼å¼å¤–ï¼Œæ–‡ä»¶çš„å¼€å¤´è¿˜å¾—æœ‰ç‰¹æ®Šçš„æ ‡è¯†ï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ä¸€ä¸ªclassæ ¼å¼çš„æ–‡ä»¶ï¼š1234567891011121314151617cafe babe 0000 0034 0010 0a00 0300 0d07000e 0700 0f01 0006 3c69 6e69 743e 01000328 2956 0100 0443 6f64 6501 000f 4c696e65 4e75 6d62 6572 5461 626c 6501 00124c6f 6361 6c56 6172 6961 626c 6554 61626c65 0100 0474 6869 7301 0014 4c63 632f6d72 6269 7264 2f63 6173 2f54 6573 743b0100 0a53 6f75 7263 6546 696c 6501 00095465 7374 2e6a 6176 610c 0004 0005 01001263 632f 6d72 6269 7264 2f63 6173 2f546573 7401 0010 6a61 7661 2f6c 616e 672f4f62 6a65 6374 0021 0002 0003 0000 00000001 0001 0004 0005 0001 0006 0000 002f0001 0001 0000 0005 2ab7 0001 b100 00000200 0700 0000 0600 0100 0000 0300 08000000 0c00 0100 0000 0500 0900 0a00 00000100 0b00 0000 0200 0cè¿™ä¸ªç‰¹å®šçš„æ ‡è¯†å°±æ˜¯åå…­è¿›åˆ¶å­—ç¬¦cafe babeã€‚ç±»åŠ è½½å™¨å¯ä»¥åˆ†ä¸º4ç§ï¼š1.å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrapClassLoaderï¼‰å¯åŠ¨ç±»åŠ è½½å™¨BootstrapClassLoaderä¹Ÿå«æ ¹åŠ è½½å™¨ï¼Œæ˜¯è™šæ‹Ÿæœºè‡ªå¸¦çš„åŠ è½½å™¨ï¼Œåº•å±‚ç”±C++å®žçŽ°ï¼Œç”¨äºŽåŠ è½½$JAVA_HOME/jre/lib/rt.jaråŒ…å†…çš„classæ–‡ä»¶ã€‚rt.jaræ˜¯JavaåŸºç¡€ç±»åº“ï¼ŒåŒ…å«Javaè¿è¡ŒçŽ¯å¢ƒæ‰€éœ€çš„é‚£äº›åŸºç¡€ç±»ï¼šä¸¾ä¸ªä¾‹å­ï¼š123456public class Test &#123; public static void main(String[] args) &#123; Object object = new Object(); System.out.println(object.getClass().getClassLoader()); &#125;&#125;Objectä¸ºJavaè‡ªå¸¦çš„ç±»ï¼Œè¿è¡Œç»“æžœå¦‚ä¸‹ï¼š1nullå¹¶æ²¡æœ‰è¿”å›žé¢„æœŸçš„BootstrapClassLoaderï¼Œè¿™æ˜¯å› ä¸ºBootstrapClassLoaderåº•å±‚æ˜¯ç”±C++å®žçŽ°çš„ï¼Œå¹¶éžJavaå®žçŽ°ã€‚2.æ‹“å±•ç±»åŠ è½½å™¨ï¼ˆExtClassLoaderï¼‰æ‹“å±•ç±»åŠ è½½å™¨ExtClassLoaderæ˜¯è™šæ‹Ÿæœºè‡ªå¸¦çš„åŠ è½½å™¨ï¼Œç”±Javaè¯­è¨€å®žçŽ°ï¼Œç”¨äºŽåŠ è½½$JAVA_HOME/jre/lib/ext/**.jarç›®å½•ä¸‹çš„classæ–‡ä»¶ï¼šæ¯”å¦‚ï¼š123456public class Test &#123; public static void main(String[] args) &#123; ZipInfo zipInfo = new ZipInfo(); System.out.println(zipInfo.getClass().getClassLoader()); &#125;&#125;è¿™éƒ¨åˆ†ä¸»è¦æ˜¯Javaåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼Œä¸€äº›æ‹“å±•çš„åŠŸèƒ½ã€‚ZipInfoæ˜¯$JAVA_HOME/jre/lib/ext/zipfs.jaråŒ…é‡Œçš„ä¸€ä¸ªç±»ï¼Œç¨‹åºè¿è¡Œç»“æžœå¦‚ä¸‹ï¼š1sun.misc.Launcher$ExtClassLoader@5e2de80c3.åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆAppClassLoaderï¼‰åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨AppClassLoaderæ˜¯è™šæ‹Ÿæœºè‡ªå¸¦çš„åŠ è½½å™¨ï¼Œç”¨äºŽåŠ è½½å½“å‰åº”ç”¨çš„classpathçš„æ‰€æœ‰ç±»ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„é‚£äº›Javaä»£ç ï¼Œæ¯”å¦‚ï¼š12345public class Test &#123; public static void main(String[] args) &#123; System.out.println(Test.class.getClassLoader()); &#125;&#125;ç¨‹åºè¿è¡Œç»“æžœï¼š1sun.misc.Launcher$AppClassLoader@18b4aac24.ç”¨æˆ·è‡ªå®šä¹‰åŠ è½½å™¨é™¤äº†ä½¿ç”¨ä¸Šé¢ä¸‰ç§JVMè‡ªå¸¦çš„ç±»åŠ è½½å™¨å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç»§æ‰¿Java.lang.ClassLoaderæŠ½è±¡ç±»è‡ªå®šä¹‰ä¸€ä¸ªç±»åŠ è½½å™¨ã€‚è¿™å››ç§ç±»åŠ è½½å™¨çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå®ƒä»¬çš„å…³ç³»æ˜¯ä¸€ç§çˆ¶å­å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç éªŒè¯ï¼š12345678public class Test &#123; public static void main(String[] args) &#123; Class&lt;Test&gt; testClass = Test.class; System.out.println(testClass.getClassLoader()); System.out.println(testClass.getClassLoader().getParent()); System.out.println(testClass.getClassLoader().getParent().getParent()); &#125;&#125;ç¨‹åºè¿è¡Œç»“æžœå¦‚ä¸‹æ‰€ç¤ºï¼š123sun.misc.Launcher$AppClassLoader@18b4aac2sun.misc.Launcher$ExtClassLoader@61bbe9banullèŠåˆ°ç±»åŠ è½½å™¨ä¸å¾—ä¸æçš„è¯é¢˜å°±æ˜¯åŒäº²å§”æ´¾æœºåˆ¶ï¼Œåœ¨äº†è§£ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æœºåˆ¶ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸ªä¾‹å­ï¼šåœ¨src/main/javaç›®å½•ä¸‹æ–°å»ºjava.langåŒ…ï¼Œç„¶åŽåœ¨è¯¥åŒ…ä¸‹æ–°å»ºä¸€ä¸ªStringç±»ï¼šStringç±»çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š1234567package java.lang;public class String &#123; public static void main(String[] args) &#123; System.out.println("helo"); &#125;&#125;ç¨‹åºè¾“å‡ºç»“æžœï¼š123é”™è¯¯: åœ¨ç±» java.lang.String ä¸­æ‰¾ä¸åˆ° main æ–¹æ³•, è¯·å°† main æ–¹æ³•å®šä¹‰ä¸º: public static void main(String[] args)å¦åˆ™ JavaFX åº”ç”¨ç¨‹åºç±»å¿…é¡»æ‰©å±•javafx.application.Applicationæ‰€è°“çš„åŒäº²å§”æ´¾æœºåˆ¶å°±æ˜¯ï¼šå½“ä¸€ä¸ªç±»æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œä»–é¦–å…ˆä¸ä¼šå°è¯•è‡ªå·±åŽ»åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŽ»å®Œæˆï¼Œæ¯ä¸€ä¸ªå±‚æ¬¡ç±»åŠ è½½å™¨éƒ½æ˜¯å¦‚æ­¤ã€‚åªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼ˆåœ¨å®ƒçš„åŠ è½½è·¯å¾„ä¸‹æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€åŠ è½½çš„Classï¼‰ï¼Œå­ç±»åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±åŽ»åŠ è½½ã€‚æ‰€ä»¥ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒAppClassLoaderå§”æ´¾ç»™å®ƒçš„çˆ¶ç±»ExtClassLoaderåŽ»åŠ è½½ï¼ŒExtClassLoaderåˆå§”æ‰˜ç»™å®ƒçš„çˆ¶ç±»BootstrapClassLoaderåŽ»åŠ è½½ã€‚BootstrapClassLoaderä»Žå®ƒçš„åŠ è½½è·¯å¾„$JAVA_HOME/jre/lib/rt.jarä¸‹æ‰¾åˆ°äº†java.lang.Stringç±»ï¼Œå³rt.jaråŒ…ä¸‹çš„Stringç±»ï¼Œè€Œè¯¥ç±»é‡Œå¹¶æ²¡æœ‰mainæ–¹æ³•ï¼Œæ‰€ä»¥ä¾¿æŠ›å‡ºäº†å¦‚ä¸Šå¼‚å¸¸ã€‚é‡‡ç”¨åŒäº²å§”æ´¾çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼šå°±å¦‚ä¸Šé¢æ‰€è¯´ï¼Œä¸ç®¡æ˜¯å“ªä¸ªåŠ è½½å™¨åŠ è½½è¿™ä¸ªç±»ï¼Œæœ€ç»ˆéƒ½æ˜¯å§”æ‰˜ç»™é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼Œè¿™æ ·å°±ä¿è¯äº†ä½¿ç”¨ä¸åŒçš„ç±»åŠ è½½å™¨æœ€ç»ˆå¾—åˆ°çš„éƒ½æ˜¯åŒæ ·ä¸€ä¸ªStringå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå®šä¹‰çš„Javaç±»å¹¶ä¸ä¼šæ±¡æŸ“JDKè‡ªå¸¦çš„é‚£äº›ç±»ï¼ˆå³ä½¿å…¨ç±»åä¸€æ ·ï¼‰ï¼Œè¿™ç§ä¿æŠ¤æœºåˆ¶ä¹Ÿå«æ²™ç®±å®‰å…¨æœºåˆ¶ã€‚æœ¬åœ°æ–¹æ³•æŽ¥å£&amp;&amp;æœ¬åœ°æ–¹æ³•æ ˆæœ¬åœ°æ–¹æ³•æŽ¥å£(Native Interface)çš„ä½œç”¨æ˜¯èžåˆä¸åŒçš„ç¼–ç¨‹è¯­è¨€ä¸ºJavaæ‰€ç”¨ï¼Œå®ƒçš„åˆè¡·æ˜¯èžåˆC/C++ç¨‹åºã€‚Javaè¯žç”Ÿçš„æ—¶å€™æ˜¯ C/C++æ¨ªè¡Œçš„æ—¶å€™ï¼Œè¦æƒ³ç«‹è¶³ï¼Œå¿…é¡»æœ‰è°ƒç”¨ C/C++ç¨‹åºï¼ŒäºŽæ˜¯å°±åœ¨å†…å­˜ä¸­ä¸“é—¨å¼€è¾Ÿäº†ä¸€å—åŒºåŸŸå¤„ç†æ ‡è®°ä¸ºnativeçš„ä»£ç ã€‚å®ƒçš„å…·ä½“åšæ³•æ˜¯åœ¨æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰ä¸­ç™»è®°nativeæ–¹æ³•ï¼Œåœ¨Execution Engineæ‰§è¡Œæ—¶åŠ è½½native libraiesã€‚ç¨‹åºè®¡æ•°å™¨ç¨‹åºè®¡æ•°å™¨(Program Counter Register)åˆå«PCå¯„å­˜å™¨ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ï¼Œæ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚å®ƒæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æ–¹æ³•åŒºä¸­çš„æ–¹æ³•å­—èŠ‚ç ï¼Œç”¨æ¥å­˜å‚¨æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ä»£ç ï¼Œç”±æ‰§è¡Œå¼•æ“Žè¯»å–ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œæ˜¯ä¸€ä¸ªéžå¸¸å°çš„å†…å­˜ç©ºé—´ï¼Œå‡ ä¹Žå¯ä»¥å¿½ç•¥ä¸è®°ã€‚è¿™å—å†…å­˜åŒºåŸŸå¾ˆå°ï¼Œå®ƒæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œå­—èŠ‚ç è§£é‡Šå™¨é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚å¦‚æžœæ‰§è¡Œçš„æ˜¯ä¸€ä¸ªNativeæ–¹æ³•ï¼Œé‚£è¿™ä¸ªè®¡æ•°å™¨æ˜¯ç©ºçš„ã€‚æ–¹æ³•åŒºæ–¹æ³•åŒºå¹¶ä¸æ˜¯æ‰€è°“çš„å­˜å‚¨æ–¹æ³•çš„åŒºåŸŸï¼Œè€Œæ˜¯ä¾›å„çº¿ç¨‹å…±äº«çš„è¿è¡Œæ—¶å†…å­˜åŒºåŸŸã€‚å®ƒå­˜å‚¨äº†æ¯ä¸€ä¸ªç±»çš„ç»“æž„ä¿¡æ¯ï¼ˆç±»åŠ è½½å™¨é€šè¿‡åŠ è½½classæ–‡ä»¶æ‰€åˆ›å»ºçš„ç±»çš„æ¨¡æ¿ï¼ŒåŒ…å«è¿è¡Œæ—¶å¸¸é‡æ± ã€å­—æ®µå’Œæ–¹æ³•æ•°æ®ã€æž„é€ å‡½æ•°å’Œæ™®é€šæ–¹æ³•çš„å­—èŠ‚ç å†…å®¹ï¼‰ã€‚æ–¹æ³•åŒºä¹Ÿæ˜¯ä¸€ç§è§„èŒƒï¼Œåœ¨ä¸åŒè™šæ‹Ÿæœºé‡Œå¤´å®žçŽ°æ˜¯ä¸ä¸€æ ·çš„ï¼Œæœ€å…¸åž‹çš„å®žçŽ°å°±æ˜¯Java8ä¹‹å‰çš„æ°¸ä¹…ä»£(PermGen space)å’ŒJava8çš„å…ƒç©ºé—´(Metaspace)ã€‚å®žä¾‹å˜é‡å­˜åœ¨å †å†…å­˜ä¸­ï¼Œå’Œæ–¹æ³•åŒºæ— å…³ã€‚åœ¨JDK7.0ç‰ˆæœ¬ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä»Žæ–¹æ³•åŒºä¸­ç§»åˆ°äº†å †ä¸­äº†ã€‚Javaæ ˆJavaæ ˆï¼ˆJava Stackï¼‰ä¹Ÿå«æ ˆå†…å­˜ï¼Œè´Ÿè´£Javaç¨‹åºçš„è¿è¡Œï¼Œæ˜¯åœ¨çº¿ç¨‹åˆ›å»ºæ—¶åˆ›å»ºï¼Œå®ƒçš„ç”Ÿå‘½æœŸæ˜¯è·Ÿéšçº¿ç¨‹çš„ç”Ÿå‘½æœŸï¼Œçº¿ç¨‹ç»“æŸæ ˆå†…å­˜ä¹Ÿå°±é‡Šæ”¾ï¼Œæ‰€ä»¥å¯¹äºŽæ ˆæ¥è¯´ä¸å­˜åœ¨åžƒåœ¾å›žæ”¶é—®é¢˜ï¼Œåªè¦çº¿ç¨‹ä¸€ç»“æŸè¯¥æ ˆå°±ç»“æŸã€‚8ç§åŸºæœ¬ç±»åž‹çš„å˜é‡+å¯¹è±¡çš„å¼•ç”¨å˜é‡+å®žä¾‹æ–¹æ³•éƒ½æ˜¯åœ¨å‡½æ•°çš„æ ˆå†…å­˜ä¸­åˆ†é…ã€‚æ ˆä¸­çš„æ•°æ®éƒ½æ˜¯ä»¥æ ˆå¸§ï¼ˆStack Frameï¼‰çš„æ ¼å¼å­˜åœ¨ï¼Œæ ˆå¸§æ˜¯ä¸€ä¸ªå†…å­˜åŒºå—ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®é›†ï¼Œæ˜¯ä¸€ä¸ªæœ‰å…³æ–¹æ³•(Method)å’Œè¿è¡ŒæœŸæ•°æ®çš„æ•°æ®é›†ï¼Œæ ˆå¸§ä¸­ä¸»è¦ä¿å­˜3 ç±»æ•°æ®ï¼šæœ¬åœ°å˜é‡ï¼ˆLocal Variablesï¼‰ï¼šè¾“å…¥å‚æ•°å’Œè¾“å‡ºå‚æ•°ä»¥åŠæ–¹æ³•å†…çš„å˜é‡ï¼›æ ˆæ“ä½œï¼ˆOperand Stackï¼‰ï¼šè®°å½•å‡ºæ ˆã€å…¥æ ˆçš„æ“ä½œï¼›æ ˆå¸§æ•°æ®ï¼ˆFrame Dataï¼‰ï¼šåŒ…æ‹¬ç±»æ–‡ä»¶ã€æ–¹æ³•ç­‰ç­‰ã€‚æ ˆè¿è¡Œçš„ä¸»è¦è¿‡ç¨‹ï¼šå½“ä¸€ä¸ªæ–¹æ³•Aè¢«è°ƒç”¨æ—¶å°±äº§ç”Ÿäº†ä¸€ä¸ªæ ˆå¸§F1ï¼Œå¹¶è¢«åŽ‹å…¥åˆ°æ ˆä¸­ï¼ŒAæ–¹æ³•åˆè°ƒç”¨äº†Bæ–¹æ³•ï¼ŒäºŽæ˜¯äº§ç”Ÿæ ˆå¸§F2ä¹Ÿè¢«åŽ‹å…¥æ ˆï¼ŒBæ–¹æ³•åˆè°ƒç”¨äº†Cæ–¹æ³•ï¼ŒäºŽæ˜¯äº§ç”Ÿæ ˆå¸§F3ä¹Ÿè¢«åŽ‹å…¥æ ˆã€‚F3æ‰§è¡Œå®Œæ¯•åŽï¼Œå…ˆå¼¹å‡ºF3æ ˆå¸§ï¼Œå†å¼¹å‡ºF2æ ˆå¸§ï¼Œå†å¼¹å‡ºF1æ ˆå¸§ï¼Œéµå¾ªå…ˆè¿›åŽå‡ºï¼ŒåŽè¿›å…ˆå‡ºï¼ˆFILOï¼‰åŽŸåˆ™ã€‚æ¯”å¦‚ï¼š1234567891011public class Test &#123; public static void method1()&#123; System.out.println("method1"); &#125; public static void main(String[] args) &#123; System.out.println("11111"); method1(); System.out.println("22222"); &#125;&#125;ç¨‹åºè¾“å‡ºï¼š12311111method122222ä¸Šé¢ä¾‹å­ä¸­ï¼Œmainçº¿ç¨‹å¼€å§‹æ‰§è¡ŒåŽï¼Œå¯¹åº”çš„æ ˆè¿è¡Œå¼€å§‹ï¼šmainæ–¹æ³•é¦–å…ˆå…¥æ ˆï¼Œè¾“å‡ºäº†11111ï¼Œç„¶åŽè°ƒç”¨method1æ–¹æ³•ï¼Œmethod1æ–¹æ³•å…¥æ ˆã€‚æ­¤æ—¶ä½äºŽæ ˆåº•çš„mainæ–¹æ³•å¿…é¡»ç­‰å¾…æ ˆé¡¶çš„method1æ–¹æ³•æ‰§è¡Œå®Œæ¯•æ‰èƒ½é€€å‡ºï¼Œæ‰€ä»¥ç¨‹åºè¾“å‡ºmethod1åŽå†è¾“å‡º22222ã€‚æ ˆç©ºé—´æ˜¯æœ‰é™çš„ï¼Œå¦‚æžœæ–¹æ³•ä¸åœçš„é€’å½’è°ƒç”¨å…¥æ ˆï¼Œæ ˆç©ºé—´å°†ä¼šè¢«â€œåŽ‹çˆ†â€ï¼ŒæŠ›å‡ºjava.lang.StackOverflowErroræ ˆæº¢å‡ºé”™è¯¯ï¼š123456789public class Test &#123; public static void method1()&#123; method1(); &#125; public static void main(String[] args) &#123; method1(); &#125;&#125;å †å †ï¼ˆHeapï¼‰ä¸€ä¸ªJVMå®žä¾‹åªå­˜åœ¨ä¸€ä¸ªå †å†…å­˜ï¼Œå †å†…å­˜çš„å¤§å°æ˜¯å¯ä»¥è°ƒèŠ‚çš„ã€‚å †ä¸­ä¿å­˜ç€æ‰€æœ‰å¼•ç”¨ç±»åž‹çš„çœŸå®žä¿¡æ¯ï¼Œä»¥æ–¹ä¾¿æ‰§è¡Œå™¨æ‰§è¡Œã€‚å †åœ¨é€»è¾‘ä¸Šåˆ†ä¸ºä¸‰ä¸ªåŒºåŸŸï¼šJava7ï¼šJava8ï¼šå¯ä»¥çœ‹åˆ°ï¼Œåœ¨Java7æ—¶ä»£ï¼Œå †åˆ†ä¸ºæ–°ç”ŸåŒºï¼ˆæ–°ç”ŸåŒºåŒ…å«ä¼Šç”¸å›­åŒºå’Œå¹¸å­˜åŒºï¼Œå¹¸å­˜åŒºåˆåŒ…å«å¹¸å­˜è€…0åŒºå’Œå¹¸å­˜è€…1åŒºã€‚æ­¤å¤–ï¼Œå¹¸å­˜è€…0åŒºåˆç§°ä¸ºFromåŒºï¼Œå¹¸å­˜è€…1åŒºåˆç§°ä¸ºToåŒºï¼‰ï¼Œå…»è€åŒºå’Œæ°¸ä¹…ä»£ï¼›åœ¨Java8ä¸­ï¼Œæ°¸ä¹…ä»£å·²ç»è¢«ç§»é™¤ï¼Œè¢«ä¸€ä¸ªç§°ä¸ºå…ƒç©ºé—´çš„åŒºåŸŸæ‰€å–ä»£ã€‚å…ƒç©ºé—´çš„æœ¬è´¨å’Œæ°¸ä¹…ä»£ç±»ä¼¼ã€‚å…ƒç©ºé—´ä¸Žæ°¸ä¹…ä»£ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åœ¨äºŽï¼šæ°¸ä¹…å¸¦ä½¿ç”¨çš„JVMçš„å †å†…å­˜ï¼Œä½†æ˜¯java8ä»¥åŽçš„å…ƒç©ºé—´å¹¶ä¸åœ¨è™šæ‹Ÿæœºä¸­è€Œæ˜¯ä½¿ç”¨æœ¬æœºç‰©ç†å†…å­˜ï¼ˆæ‰€ä»¥åœ¨ä¸Šå›¾ä¸­ï¼Œæˆ‘ç”¨è™šçº¿è¡¨ç¤ºï¼‰ã€‚ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è®²è¿°è¿™å‡ ä¸ªåŒºçš„äº¤äº’é€»è¾‘ï¼š1.ä»»ä½•æ–°çš„å¯¹è±¡éƒ½æ˜¯åœ¨ä¼Šç”¸å›­åŒºè¢«newå‡ºæ¥åˆ›å»ºï¼Œåˆšå¼€å§‹çš„æ—¶å€™ä¸¤ä¸ªå¹¸å­˜è€…åŒºå’Œå…»è€åŒºéƒ½æ˜¯ç©ºçš„ï¼š2.éšç€å¯¹è±¡çš„ä¸æ–­åˆ›å»ºï¼Œä¼Šç”¸å›­åŒºç©ºé—´é€æ¸è¢«å¡«æ»¡ï¼š3.è¿™æ—¶å€™å°†è§¦å‘ä¸€æ¬¡Minor GCï¼ˆYoung GCï¼‰ï¼Œåˆ é™¤æœªå¼•ç”¨çš„å¯¹è±¡ï¼ŒGCå‰©ä¸‹æ¥çš„è¿˜å­˜åœ¨å¼•ç”¨çš„å¯¹è±¡å°†ç§»åŠ¨åˆ°å¹¸å­˜è€…0åŒºï¼Œç„¶åŽæ¸…ç©ºä¼Šç”¸å›­åŒºï¼š4.éšç€å¯¹è±¡çš„åˆ›å»ºï¼Œä¼Šç”¸å›­åŒºç©ºé—´åˆæ»¡äº†ï¼Œå†ä¸€æ¬¡è§¦å‘Minor GCï¼Œåˆ é™¤æœªå¼•ç”¨çš„å¯¹è±¡ï¼Œç•™ä¸‹å­˜åœ¨å¼•ç”¨çš„å¯¹è±¡ã€‚è¿™æ¬¡å’Œä¸Šä¸€æ¬¡Minor GCæœ‰äº›ä¸åŒï¼Œè¿™è½®GCç•™ä¸‹çš„å¯¹è±¡å°†è¢«ç§»åŠ¨åˆ°å¹¸å­˜è€…1åŒºï¼Œå¹¶ä¸”ä¸Šä¸€è½®GCç•™ä¸‹æ¥çš„å­˜å‚¨åœ¨å¹¸å­˜è€…0åŒºçš„å¯¹è±¡å¹´é¾„é€’å¢žå¹¶ç§»åŠ¨åˆ°å¹¸å­˜è€…1åŒºã€‚å½“æ‰€æœ‰å¹¸å­˜å¯¹è±¡éƒ½ç§»åŠ¨åˆ°å¹¸å­˜è€…1åŒºåŽï¼Œå¹¸å­˜è€…0åŒºå’Œä¼Šç”¸å›­åŒºç©ºé—´æ¸…é™¤ï¼š5.éšç€å¯¹è±¡çš„åˆ›å»ºä¼Šç”¸å›­åŒºç©ºé—´å†ä¸€æ¬¡æ»¡äº†ï¼Œè§¦å‘äº†ç¬¬ä¸‰æ¬¡Minor GCï¼Œè¿™ä¸€æ¬¡å¹¸å­˜åŒºç©ºé—´å°†å‘ç”Ÿäº’æ¢ï¼ŒGCç•™ä¸‹æ¥çš„å¹¸å­˜è€…å°†ç§»åŠ¨åˆ°å¹¸å­˜è€…0åŒºï¼Œå¹¸å­˜è€…1åŒºçš„å¹¸å­˜å¯¹è±¡å¹´é¾„é€’å¢žåŽä¹Ÿç§»åŠ¨åˆ°å¹¸å­˜è€…0åŒºï¼Œç„¶åŽä¼Šç”¸å›­åŒºå’Œå¹¸å­˜è€…1åŒºçš„ç©ºé—´è¢«æ¸…é™¤ï¼š6.éšç€Minor GCçš„ä¸è¯»å‘ç”Ÿï¼Œå¹¸å­˜å¯¹è±¡åœ¨ä¸¤ä¸ªå¹¸å­˜åŒºä¸æ–­åœ°äº¤æ¢å­˜å‚¨ï¼Œå¹´é¾„ä¹Ÿä¸æ–­é€’å¢žã€‚å¦‚æ­¤ååå¤å¤ä¹‹åŽï¼Œå½“å¹¸å­˜å¯¹è±¡çš„å¹´é¾„è¾¾åˆ°æŒ‡å®šçš„é˜ˆå€¼ï¼ˆè¿™ä¸ªä¾‹å­ä¸­æ˜¯8ï¼Œç”±JVMå‚æ•°MaxTenuringThresholdå†³å®šï¼‰åŽï¼Œå®ƒä»¬å°†è¢«ç§»åŠ¨åˆ°å…»è€åŒºï¼š7.éšç€ä¸Šè¿°è¿‡ç¨‹çš„ä¸æ–­å‡ºçŽ°ï¼Œå½“å…»è€åŒºå¿«æ…¢æ—¶ï¼Œå°†è§¦å‘Major GCï¼ˆFull GCï¼‰è¿›è¡Œå…»è€åŒºçš„å†…å­˜æ¸…ç†ã€‚è‹¥å…»è€åŒºæ‰§è¡Œäº†GCä¹‹åŽå‘çŽ°ä¾ç„¶æ— æ³•è¿›è¡Œå¯¹è±¡çš„ä¿å­˜ï¼Œå°±ä¼šäº§ç”ŸOOMå¼‚å¸¸ã€‚å †å‚æ•°ä»¥JDK1.8+HotSpotä¸ºä¾‹ï¼Œå¸¸ç”¨çš„å¯è°ƒæ•´çš„å †å‚æ•°æœ‰ï¼šå‚æ•°å«ä¹‰-Xmsè®¾ç½®å †çš„åˆå§‹å†…å­˜å¤§å°ï¼Œé»˜è®¤ä¸ºç‰©ç†å†…å­˜çš„1/64-Xmxè®¾ç½®å †çš„æœ€å¤§å†…å­˜å¤§å°ï¼Œé»˜è®¤ä¸ºç‰©ç†å†…å­˜çš„1/4-Xmnè®¾ç½®å †æ–°ç”Ÿä»£çš„å†…å­˜å¤§å°-XX:MaxTenuringThresholdè®¾ç½®è½¬å…¥å…»è€åŒºçš„å­˜æ´»æ¬¡æ•°-XX:Newratioè®¾ç½®æ–°ç”ŸåŒºå’Œå…»è€åŒºçš„æ¯”ä¾‹ï¼Œæ¯”å¦‚å€¼ä¸º2ï¼Œåˆ™å…»è€åŒºæ˜¯æ–°ç”ŸåŒºçš„2å€ï¼Œå³å…»è€åŒºå æ®å †å†…å­˜çš„1/3-XX:Newsizeè®¾ç½®æ–°ç”ŸåŒºçš„åˆå§‹å€¼å¤§å°-XX:Maxnewsizeè®¾ç½®æ–°ç”ŸåŒºçš„æœ€å¤§å€¼å¤§å°-XX:Surviorratioè®¾ç½®ä¼Šç”¸å›­åŒºå’Œä¸€ä¸ªå¹¸å­˜åŒºçš„æ¯”ä¾‹ï¼Œæ¯”å¦‚å€¼ä¸º5åˆ™è¡¨ç¤ºä¼Šç”¸å›­åŒºå æ–°ç”ŸåŒºçš„5/7ï¼ˆä¸¤ä¸ªå¹¸å­˜åŒºæ˜¯ä¸€æ ·å¤§çš„ï¼‰ç”Ÿäº§çŽ¯å¢ƒä¸­ï¼ŒæŽ¨èå°†-Xmså’Œ-Xmxè®¾ç½®ä¸ºä¸€æ ·å¤§ã€‚æ­¤å¤–ï¼Œè¦åœ¨ç¨‹åºä¸­è¾“å‡ºè¯¦ç»†çš„GCå¤„ç†æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨-XX:+PrintGCDetailsã€‚æ¯”å¦‚ï¼Œæˆ‘çš„ç”µè„‘å†…å­˜ä¸º32GBï¼Œæ‰€ä»¥å †çš„é»˜è®¤åˆå§‹å€¼å¤§å°ä¸º500MBå·¦å³ï¼Œå †çš„æœ€å¤§å€¼å¤§çº¦ä¸º8000MBå·¦å³ï¼š123456789public class Test &#123; public static void main(String[] args) &#123; long maxMemory = Runtime.getRuntime().maxMemory(); long totalMemory = Runtime.getRuntime().totalMemory(); System.out.println("å †å†…å­˜çš„åˆå§‹å€¼" + totalMemory / 1024 / 1024 + "mb"); System.out.println("å †å†…å­˜çš„æœ€å¤§å€¼" + maxMemory / 1024 / 1024 + "mb"); &#125;&#125;ç¨‹åºè¾“å‡ºï¼š12å †å†…å­˜çš„åˆå§‹å€¼491mbå †å†…å­˜çš„æœ€å¤§å€¼7282mbå¯ä»¥é€šè¿‡IDEAè°ƒæ•´å †çš„å¤§å°ï¼šæˆ‘ä»¬å°†å †å†…å­˜çš„åˆå§‹å¤§å°å’Œæœ€å¤§å€¼éƒ½è®¾ç½®ä¸º10mbï¼Œå¹¶ä¸”å¼€å¯GCæ—¥å¿—æ‰“å°ï¼Œé‡æ–°è¿è¡Œä¸‹é¢è¿™æ®µç¨‹åºï¼š123456789public class Test &#123; public static void main(String[] args) &#123; long maxMemory = Runtime.getRuntime().maxMemory(); long totalMemory = Runtime.getRuntime().totalMemory(); System.out.println("å †å†…å­˜çš„åˆå§‹å€¼" + totalMemory / 1024 + "kb"); System.out.println("å †å†…å­˜çš„æœ€å¤§å€¼" + maxMemory / 1024 + "kb"); &#125;&#125;è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011å †å†…å­˜çš„åˆå§‹å€¼9728kbå †å†…å­˜çš„æœ€å¤§å€¼9728kbHeap PSYoungGen total 2560K, used 1388K [0x00000007bfd00000, 0x00000007c0000000, 0x00000007c0000000) eden space 2048K, 67% used [0x00000007bfd00000,0x00000007bfe5b370,0x00000007bff00000) from space 512K, 0% used [0x00000007bff80000,0x00000007bff80000,0x00000007c0000000) to space 512K, 0% used [0x00000007bff00000,0x00000007bff00000,0x00000007bff80000) ParOldGen total 7168K, used 0K [0x00000007bf600000, 0x00000007bfd00000, 0x00000007bfd00000) object space 7168K, 0% used [0x00000007bf600000,0x00000007bf600000,0x00000007bfd00000) Metaspace used 2947K, capacity 4496K, committed 4864K, reserved 1056768K class space used 320K, capacity 388K, committed 512K, reserved 1048576Kå¯ä»¥çœ‹åˆ°ï¼ŒPSYoungGenï¼ˆæ–°ç”ŸåŒºï¼‰çš„æ€»å†…å­˜å¤§å°ä¸º2560kï¼ŒParOldGenï¼ˆå…»è€åŒºï¼‰çš„æ€»å†…å­˜å¤§å°ä¸º7168kï¼Œæ€»å’Œåˆšå¥½æ˜¯9728Kï¼Œè¿™ä¹Ÿè¯´æ˜Žäº†ï¼šJava8åŽçš„å †ç‰©ç†ä¸Šåªåˆ†ä¸ºæ–°ç”ŸåŒºå’Œå…»è€åŒºï¼ŒMetaspaceï¼ˆå…ƒç©ºé—´ï¼‰ä¸å ç”¨å †å†…å­˜ï¼Œè€Œæ˜¯ç›´æŽ¥ä½¿ç”¨ç‰©ç†å†…å­˜ã€‚å†ä¸¾ä¸ªOOMçš„ä¾‹å­ï¼Œä½¿ç”¨åˆšåˆš-Xms10m -Xmx10m -XX:+PrintGCDetailsçš„è®¾ç½®ï¼Œè¿è¡Œä¸‹é¢è¿™æ®µç¨‹åºï¼š12345678public class Test &#123; public static void main(String[] args) &#123; String value = "hello"; while (true) &#123; value += value + new Random().nextInt(1000000000) + new Random().nextInt(1000000000); &#125; &#125;&#125;è¾“å‡ºå¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728[GC (Allocation Failure) [PSYoungGen: 1893K-&gt;491K(2560K)] 1893K-&gt;597K(9728K), 0.0007246 secs] [Times: user=0.01 sys=0.00, real=0.00 secs] [GC (Allocation Failure) [PSYoungGen: 2207K-&gt;496K(2560K)] 2313K-&gt;1153K(9728K), 0.0008383 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] [GC (Allocation Failure) [PSYoungGen: 2007K-&gt;496K(2560K)] 2664K-&gt;1897K(9728K), 0.0009456 secs] [Times: user=0.01 sys=0.00, real=0.01 secs] [GC (Allocation Failure) [PSYoungGen: 2021K-&gt;496K(2560K)] 4894K-&gt;4113K(9728K), 0.0010814 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] [GC (Allocation Failure) [PSYoungGen: 1359K-&gt;496K(2560K)] 6448K-&gt;5600K(9728K), 0.0015792 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] [GC (Allocation Failure) [PSYoungGen: 496K-&gt;496K(1536K)] 5600K-&gt;5600K(8704K), 0.0006416 secs] [Times: user=0.01 sys=0.00, real=0.00 secs] [Full GC (Allocation Failure) [PSYoungGen: 496K-&gt;0K(1536K)] [ParOldGen: 5104K-&gt;2585K(7168K)] 5600K-&gt;2585K(8704K), [Metaspace: 2982K-&gt;2982K(1056768K)], 0.0044783 secs] [Times: user=0.02 sys=0.00, real=0.01 secs] [GC (Allocation Failure) [PSYoungGen: 61K-&gt;192K(2048K)] 7061K-&gt;7192K(9216K), 0.0012566 secs] [Times: user=0.01 sys=0.00, real=0.00 secs] [Full GC (Ergonomics) [PSYoungGen: 192K-&gt;0K(2048K)] [ParOldGen: 7000K-&gt;1840K(7168K)] 7192K-&gt;1840K(9216K), [Metaspace: 3042K-&gt;3042K(1056768K)], 0.0072023 secs] [Times: user=0.02 sys=0.00, real=0.01 secs] [GC (Allocation Failure) [PSYoungGen: 65K-&gt;160K(2048K)] 6321K-&gt;6416K(9216K), 0.0022603 secs] [Times: user=0.02 sys=0.00, real=0.00 secs] [Full GC (Ergonomics) [PSYoungGen: 160K-&gt;0K(2048K)] [ParOldGen: 6256K-&gt;4785K(7168K)] 6416K-&gt;4785K(9216K), [Metaspace: 3076K-&gt;3076K(1056768K)], 0.0056740 secs] [Times: user=0.03 sys=0.00, real=0.01 secs] [GC (Allocation Failure) [PSYoungGen: 0K-&gt;0K(2048K)] 4785K-&gt;4785K(9216K), 0.0003871 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] [Full GC (Allocation Failure) [PSYoungGen: 0K-&gt;0K(2048K)] [ParOldGen: 4785K-&gt;4765K(7168K)] 4785K-&gt;4765K(9216K), [Metaspace: 3076K-&gt;3076K(1056768K)], 0.0049903 secs] [Times: user=0.02 sys=0.00, real=0.00 secs] Heap PSYoungGen total 2048K, used 59K [0x00000007bfd00000, 0x00000007c0000000, 0x00000007c0000000) eden space 1024K, 5% used [0x00000007bfd00000,0x00000007bfd0efb8,0x00000007bfe00000) from space 1024K, 0% used [0x00000007bfe00000,0x00000007bfe00000,0x00000007bff00000) to space 1024K, 0% used [0x00000007bff00000,0x00000007bff00000,0x00000007c0000000) ParOldGen total 7168K, used 4765K [0x00000007bf600000, 0x00000007bfd00000, 0x00000007bfd00000) object space 7168K, 66% used [0x00000007bf600000,0x00000007bfaa77b8,0x00000007bfd00000) Metaspace used 3113K, capacity 4496K, committed 4864K, reserved 1056768K class space used 339K, capacity 388K, committed 512K, reserved 1048576KException in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space at java.util.Arrays.copyOf(Arrays.java:3332) at java.lang.AbstractStringBuilder.ensureCapacityInternal(AbstractStringBuilder.java:124) at java.lang.AbstractStringBuilder.append(AbstractStringBuilder.java:674) at java.lang.StringBuilder.append(StringBuilder.java:208) at cc.mrbird.Test.main(Test.java:19)å¯ä»¥çœ‹åˆ°ï¼Œç»è¿‡æ•°æ¬¡çš„GCå’ŒFull GCåŽï¼Œå †å†…å­˜è¿˜æ˜¯æ— æ³•è…¾å‡ºç©ºé—´ï¼Œæœ€ç»ˆæŠ›å‡ºOOMé”™è¯¯ã€‚æ—¥å¿—çš„å«ä¹‰å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šYoung GCï¼ˆMinor GCï¼‰ï¼šFull GCï¼ˆMajor GCï¼‰ï¼šå‚è€ƒæ–‡ç« ï¼šhttps://www.oracle.com/webfolder/technetwork/tutorials/obe/java/gc01/index.html]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java BlockingQueue && BlockingDeque]]></title>
    <url>%2FJava-BlockingQueue.html</url>
    <content type="text"><![CDATA[BlockingQueueå³é˜»å¡žé˜Ÿåˆ—ï¼Œä¸€ä¸ªé˜»å¡žé˜Ÿåˆ—åœ¨æ•°æ®ç»“æž„ä¸­èµ·åˆ°çš„ä½œç”¨å¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šä¸Šå›¾ä¸­ï¼Œçº¿ç¨‹1å¾€é˜»å¡žé˜Ÿåˆ—ä¸­æ·»åŠ å…ƒç´ ï¼Œçº¿ç¨‹2ä»Žé˜»å¡žé˜Ÿåˆ—ä¸­ç§»å‡ºå…ƒç´ ã€‚å½“é˜»å¡žé˜Ÿåˆ—æ˜¯ç©ºçš„æ—¶å€™ï¼Œä»Žé˜Ÿåˆ—ä¸­èŽ·å–å…ƒç´ çš„æ“ä½œå°†ä¼šè¢«é˜»å¡žï¼›å½“é˜»å¡žé˜Ÿåˆ—æ˜¯æ»¡çš„æ—¶å€™ï¼Œå¾€é˜Ÿåˆ—ä¸­æ·»åŠ å…ƒç´ çš„æ“ä½œå°†ä¼šè¢«é˜»å¡žã€‚ä½¿ç”¨BlockingQueueçš„å¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒä»€ä¹ˆæ—¶å€™éœ€è¦é˜»å¡žçº¿ç¨‹ï¼Œä»€ä¹ˆæ—¶å€™éœ€è¦å”¤é†’çº¿ç¨‹ï¼Œè¿™äº›éƒ½ç”±BlockingQueueè‡ªå®šå®Œæˆã€‚7å¤§å®žçŽ°ç±»BlockingQueueæ˜¯ä¸€ä¸ªæŽ¥å£ç±»ï¼Œä¸»è¦æœ‰7ç§å®žçŽ°ç±»åž‹ï¼ŒUMLç±»å›¾å¦‚ä¸‹æ‰€ç¤ºï¼šArrayBlockingQueueï¼šç”±æ•°ç»„æœºæž„ç»„æˆçš„æœ‰ç•Œé˜»å¡žé˜Ÿåˆ—ï¼›LinkedBlockingQueueï¼šç”±é“¾è¡¨ç»“æž„ç»„æˆçš„æœ‰ç•Œï¼ˆé»˜è®¤å¤§å°éžå¸¸å¤§ï¼Œä¸ºInteger.MAX_VALUEï¼‰é˜»å¡žé˜Ÿåˆ—ï¼›PriorityBlockingQueueï¼šä¸€ä¸ªæ”¯æŒä¼˜å…ˆçº§æŽ’åºçš„æ— ç•Œé˜»å¡žé˜Ÿåˆ—ï¼›DelayQueueï¼šä¸€ä¸ªä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å®žçŽ°çš„æ— ç•Œé˜»å¡žé˜Ÿåˆ—ï¼›SynchronousQueueï¼šä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡žé˜Ÿåˆ—ï¼›LinkedTransferQueueï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æž„ç»„æˆçš„æ— ç•Œé˜»å¡žé˜Ÿåˆ—ï¼›LinkedBlockingDequeï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æž„ç»„æˆçš„åŒå‘é˜»å¡žé˜Ÿåˆ—ã€‚å‰å…­ç§éƒ½æ˜¯å•å‘é˜Ÿåˆ—ï¼Œå®žçŽ°çš„æ˜¯BlockingQueueæŽ¥å£ï¼ŒLinkedBlockingDequeæ˜¯ä¸€ä¸ªåŒå‘é˜Ÿåˆ—ï¼Œå®žçŽ°çš„æ˜¯BlockDequeæŽ¥å£ï¼Œè¯¥æŽ¥å£ç»§æ‰¿äº†BlockingQueueæŽ¥å£ã€‚å¸¸ç”¨æ–¹æ³•BlockingQueueçš„ç›¸å…³æ–¹æ³•å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç§ç±»åž‹ï¼šæ–¹æ³•æè¿°æŠ›å‡ºå¼‚å¸¸è¿”å›žç‰¹æ®Šçš„å€¼ä¸€ç›´é˜»å¡žè¶…æ—¶é€€å‡ºæ’å…¥æ•°æ®add(e)offer(e)put(e)offer(e,time,unit)èŽ·å–å¹¶ç§»é™¤é˜Ÿåˆ—çš„å¤´remove()poll()take()poll(time,unit)èŽ·å–ä½†ä¸ç§»é™¤é˜Ÿåˆ—çš„å¤´element()peek()ä¸å¯ç”¨ä¸å¯ç”¨æŠ›å‡ºå¼‚å¸¸ï¼šå½“é˜»å¡žé˜Ÿåˆ—æ»¡æ—¶ï¼Œå†å¾€é˜Ÿåˆ—é‡Œaddæ’å…¥å…ƒç´ å°±ä¼šæŠ›å‡ºIllegalStateException: Queue fullï¼›å½“é˜»å¡žé˜Ÿåˆ—ç©ºæ—¶ï¼Œå†å¾€é˜Ÿåˆ—é‡Œremoveç§»å‡ºå…ƒç´ å°±ä¼šæŠ›å‡ºNoSuchElementExceptionï¼›è¿”å›žç‰¹æ®Šå€¼ï¼šæ’å…¥æ–¹æ³•ï¼ŒæˆåŠŸæ—¶è¿”å›žtrueï¼Œå¤±è´¥æ—¶è¿”å›žfalseï¼›ç§»å‡ºæ–¹æ³•ï¼ŒæˆåŠŸæ—¶å€™è¿”å›žç§»å‡ºé˜Ÿåˆ—çš„å…ƒç´ ï¼Œæ²¡æœ‰å…ƒç´ å°±è¿”å›žnullï¼›ä¸€ç›´é˜»å¡žï¼šå½“é˜»å¡žé˜Ÿåˆ—æ»¡æ—¶ï¼Œå¦‚æžœç”Ÿäº§è€…çº¿ç¨‹å¾€é˜Ÿåˆ—é‡Œputå…ƒç´ ï¼Œé˜Ÿåˆ—ä¼šä¸€ç›´é˜»å¡žç”Ÿäº§è€…çº¿ç¨‹ï¼Œç›´åˆ°æ‹¿åˆ°æ•°æ®ï¼Œæˆ–è€…å“åº”ä¸­æ–­é€€å‡ºã€‚å½“é˜Ÿåˆ—ç©ºæ—¶ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹è¯•å›¾ä»Žé˜Ÿåˆ—é‡Œtakeå…ƒç´ ï¼Œé˜Ÿåˆ—ä¹Ÿä¼šé˜»å¡žæ¶ˆè´¹è€…çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—å¯ç”¨ï¼›è¶…æ—¶é€€å‡ºï¼šå½“é˜»å¡žé˜Ÿåˆ—æ»¡æ—¶ï¼Œé˜Ÿåˆ—ä¼šé˜»å¡žç”Ÿäº§è€…çº¿ç¨‹ä¸€æ®µæ—¶é—´ï¼Œå¦‚æžœè¶…è¿‡ä¸€å®šçš„æ—¶é—´ï¼Œç”Ÿäº§è€…çº¿ç¨‹å°±ä¼šé€€å‡ºã€‚BlockDequeä¹Ÿæä¾›äº†è¿™å››ç§ç±»åž‹å¯¹åº”çš„æ–¹æ³•ï¼Œä¸è¿‡ç”±äºŽæ˜¯åŒå‘é˜Ÿåˆ—ï¼Œæ‰€ä»¥è¿™äº›æ–¹æ³•å¯ä»¥åˆ†ä¸ºå¤´éƒ¨æ“ä½œå’Œå°¾éƒ¨æ“ä½œï¼šå¤´éƒ¨æ“ä½œï¼šæ–¹æ³•æè¿°æŠ›å‡ºå¼‚å¸¸è¿”å›žç‰¹æ®Šçš„å€¼ä¸€ç›´é˜»å¡žè¶…æ—¶é€€å‡ºæ’å…¥æ•°æ®addLast(e)offerLast(e)putLast(e)offerLast(e, time, unit)èŽ·å–å¹¶ç§»é™¤é˜Ÿåˆ—çš„å¤´removeLast()pollLast()takeLast()pollLast(time, unit)èŽ·å–ä½†ä¸ç§»é™¤é˜Ÿåˆ—çš„å¤´getLast()peekLast()ä¸é€‚ç”¨ä¸é€‚ç”¨å°¾éƒ¨æ“ä½œï¼šæ–¹æ³•æè¿°æŠ›å‡ºå¼‚å¸¸è¿”å›žç‰¹æ®Šçš„å€¼ä¸€ç›´é˜»å¡žè¶…æ—¶é€€å‡ºæ’å…¥æ•°æ®addLast(e)offerLast(e)putLast(e)offerLast(e, time, unit)èŽ·å–å¹¶ç§»é™¤é˜Ÿåˆ—çš„å¤´removeLast()pollLast()takeLast()pollLast(time, unit)èŽ·å–ä½†ä¸ç§»é™¤é˜Ÿåˆ—çš„å¤´getLast()peekLast()ä¸é€‚ç”¨ä¸é€‚ç”¨ç®€å•ä»‹ç»ArrayBlockingQueueArrayBlockingQueueæ˜¯ä¸€ä¸ªç”¨æ•°ç»„å®žçŽ°çš„æœ‰ç•Œé˜»å¡žé˜Ÿåˆ—ã€‚æ­¤é˜Ÿåˆ—æŒ‰ç…§å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„åŽŸåˆ™å¯¹å…ƒç´ è¿›è¡ŒæŽ’åºã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä¿è¯è®¿é—®è€…å…¬å¹³çš„è®¿é—®é˜Ÿåˆ—ï¼Œæ‰€è°“å…¬å¹³è®¿é—®é˜Ÿåˆ—æ˜¯æŒ‡é˜»å¡žçš„æ‰€æœ‰ç”Ÿäº§è€…çº¿ç¨‹æˆ–æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œå½“é˜Ÿåˆ—å¯ç”¨æ—¶ï¼Œå¯ä»¥æŒ‰ç…§é˜»å¡žçš„å…ˆåŽé¡ºåºè®¿é—®é˜Ÿåˆ—ï¼Œå³å…ˆé˜»å¡žçš„ç”Ÿäº§è€…çº¿ç¨‹ï¼Œå¯ä»¥å…ˆå¾€é˜Ÿåˆ—é‡Œæ’å…¥å…ƒç´ ï¼Œå…ˆé˜»å¡žçš„æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œå¯ä»¥å…ˆä»Žé˜Ÿåˆ—é‡ŒèŽ·å–å…ƒç´ ã€‚é€šå¸¸æƒ…å†µä¸‹ä¸ºäº†ä¿è¯å…¬å¹³æ€§ä¼šé™ä½Žåžåé‡ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç åˆ›å»ºä¸€ä¸ªå…¬å¹³çš„é˜»å¡žé˜Ÿåˆ—ï¼š1ArrayBlockingQueue&lt;String&gt; fairArrayBlockingQueue = new ArrayBlockingQueue&lt;&gt;(5, true);ä¸Šé¢ä»£ç æŒ‡å®šäº†ä¸€ä¸ªåˆå§‹å¤§å°ä¸º5çš„å…¬å¹³çš„ArrayBlockingQueueã€‚è®¿é—®è€…çš„å…¬å¹³æ€§æ˜¯ä½¿ç”¨å¯é‡å…¥é”å®žçŽ°çš„ï¼Œæž„é€ å™¨æºç å¦‚ä¸‹ï¼šLinkedBlockingQueueLinkedBlockingQueueæ˜¯ä¸€ä¸ªç”¨é“¾è¡¨å®žçŽ°çš„æœ‰ç•Œé˜»å¡žé˜Ÿåˆ—ã€‚æ­¤é˜Ÿåˆ—æŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„åŽŸåˆ™å¯¹å…ƒç´ è¿›è¡ŒæŽ’åºã€‚æ­¤é˜Ÿåˆ—çš„é»˜è®¤å’Œæœ€å¤§é•¿åº¦ä¸ºInteger.MAX_VALUEï¼šæ‰€ä»¥æŽ¨èçš„åšæ³•æ˜¯ä¸è¦ä½¿ç”¨æ— å‚æž„é€ å™¨ï¼Œè€Œæ˜¯é€šè¿‡æœ‰å‚æž„é€ å™¨æŒ‡å®šå®¹å™¨çš„åˆå§‹å¤§å°ã€‚PriorityBlockingQueuePriorityBlockingQueueæ˜¯ä¸€ä¸ªæ”¯æŒä¼˜å…ˆçº§çš„æ— ç•Œé˜Ÿåˆ—ã€‚é»˜è®¤æƒ…å†µä¸‹å…ƒç´ é‡‡å–è‡ªç„¶é¡ºåºæŽ’åˆ—ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ¯”è¾ƒå™¨comparatoræ¥æŒ‡å®šå…ƒç´ çš„æŽ’åºè§„åˆ™ã€‚å…ƒç´ æŒ‰ç…§å‡åºæŽ’åˆ—ã€‚DelayQueueDelayQueueä¹Ÿæ˜¯ä¸€ä¸ªæ— ç•Œé˜»å¡žé˜Ÿåˆ—ï¼Œåªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡æ—¶æ‰èƒ½ä»Žä¸­æå–å…ƒç´ ã€‚DelayQueueçš„æ‰€æœ‰æ–¹æ³•åªèƒ½æ“ä½œâ€œåˆ°æœŸçš„å…ƒç´ â€œï¼Œä¾‹å¦‚ï¼Œpoll()ã€remove()ã€size()ç­‰æ–¹æ³•ï¼Œéƒ½ä¼šå¿½ç•¥æŽ‰æœªåˆ°æœŸçš„å…ƒç´ ã€‚ æˆ‘ä»¬å¯ä»¥å°†DelayQueueè¿ç”¨åœ¨ä»¥ä¸‹åº”ç”¨åœºæ™¯ï¼šç¼“å­˜ç³»ç»Ÿçš„è®¾è®¡ï¼šå¯ä»¥ç”¨DelayQueueä¿å­˜ç¼“å­˜å…ƒç´ çš„æœ‰æ•ˆæœŸï¼Œä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å¾ªçŽ¯æŸ¥è¯¢DelayQueueï¼Œä¸€æ—¦èƒ½ä»ŽDelayQueueä¸­èŽ·å–å…ƒç´ æ—¶ï¼Œè¡¨ç¤ºç¼“å­˜æœ‰æ•ˆæœŸåˆ°äº†ï¼›å®šæ—¶ä»»åŠ¡è°ƒåº¦ã€‚ä½¿ç”¨DelayQueueä¿å­˜å½“å¤©å°†ä¼šæ‰§è¡Œçš„ä»»åŠ¡å’Œæ‰§è¡Œæ—¶é—´ï¼Œä¸€æ—¦ä»ŽDelayQueueä¸­èŽ·å–åˆ°ä»»åŠ¡å°±å¼€å§‹æ‰§è¡Œã€‚DelayQueueçš„å®žçŽ°æ˜¯åŸºäºŽPriorityQueueï¼Œæ˜¯ä¸€ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œæ˜¯ä»¥å»¶æ—¶æ—¶é—´çš„é•¿çŸ­è¿›è¡ŒæŽ’åºçš„ã€‚æ‰€ä»¥ï¼ŒDelayQueueéœ€è¦çŸ¥é“æ¯ä¸ªå…ƒç´ çš„å»¶æ—¶æ—¶é—´ï¼Œè€Œè¿™ä¸ªå»¶æ—¶æ—¶é—´æ˜¯ç”±DelayedæŽ¥å£çš„getDelay()æ–¹æ³•èŽ·å–çš„ã€‚æ‰€ä»¥ï¼ŒDelayQueueçš„å…ƒç´ å¿…é¡»å®žçŽ°DelayedæŽ¥å£ã€‚SynchronousQueueSynchronousQueueæ˜¯ä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡žé˜Ÿåˆ—ã€‚æ¯ä¸€ä¸ªputæ“ä½œå¿…é¡»ç­‰å¾…ä¸€ä¸ªtakeæ“ä½œï¼Œå¦åˆ™ä¸èƒ½ç»§ç»­æ·»åŠ å…ƒç´ ã€‚SynchronousQueueå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªä¼ çƒæ‰‹ï¼Œè´Ÿè´£æŠŠç”Ÿäº§è€…çº¿ç¨‹å¤„ç†çš„æ•°æ®ç›´æŽ¥ä¼ é€’ç»™æ¶ˆè´¹è€…çº¿ç¨‹ã€‚é˜Ÿåˆ—æœ¬èº«å¹¶ä¸å­˜å‚¨ä»»ä½•å…ƒç´ ï¼Œéžå¸¸é€‚åˆäºŽä¼ é€’æ€§åœºæ™¯,æ¯”å¦‚åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ä½¿ç”¨çš„æ•°æ®ï¼Œä¼ é€’ç»™å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ã€‚LinkedTransferQueueLinkedTransferQueueæ˜¯ä¸€ä¸ªç”±é“¾è¡¨ç»“æž„ç»„æˆçš„æ— ç•Œé˜»å¡žTransferQueueé˜Ÿåˆ—ã€‚ç›¸å¯¹äºŽå…¶ä»–é˜»å¡žé˜Ÿåˆ—LinkedTransferQueueå¤šäº†tryTransferå’Œtransferæ–¹æ³•ã€‚transferæ–¹æ³•ï¼šå¦‚æžœå½“å‰æœ‰æ¶ˆè´¹è€…æ­£åœ¨ç­‰å¾…æŽ¥æ”¶å…ƒç´ ï¼ˆæ¶ˆè´¹è€…ä½¿ç”¨take()æ–¹æ³•æˆ–å¸¦æ—¶é—´é™åˆ¶çš„poll()æ–¹æ³•æ—¶ï¼‰ï¼Œtransferæ–¹æ³•å¯ä»¥æŠŠç”Ÿäº§è€…ä¼ å…¥çš„å…ƒç´ ç«‹åˆ»transferï¼ˆä¼ è¾“ï¼‰ç»™æ¶ˆè´¹è€…ã€‚å¦‚æžœæ²¡æœ‰æ¶ˆè´¹è€…åœ¨ç­‰å¾…æŽ¥æ”¶å…ƒç´ ï¼Œtransferæ–¹æ³•ä¼šå°†å…ƒç´ å­˜æ”¾åœ¨é˜Ÿåˆ—çš„tailèŠ‚ç‚¹ï¼Œå¹¶ç­‰åˆ°è¯¥å…ƒç´ è¢«æ¶ˆè´¹è€…æ¶ˆè´¹äº†æ‰è¿”å›žã€‚tryTransferæ–¹æ³•ã€‚åˆ™æ˜¯ç”¨æ¥è¯•æŽ¢ä¸‹ç”Ÿäº§è€…ä¼ å…¥çš„å…ƒç´ æ˜¯å¦èƒ½ç›´æŽ¥ä¼ ç»™æ¶ˆè´¹è€…ã€‚å¦‚æžœæ²¡æœ‰æ¶ˆè´¹è€…ç­‰å¾…æŽ¥æ”¶å…ƒç´ ï¼Œåˆ™è¿”å›žfalseã€‚å’Œtransferæ–¹æ³•çš„åŒºåˆ«æ˜¯tryTransferæ–¹æ³•æ— è®ºæ¶ˆè´¹è€…æ˜¯å¦æŽ¥æ”¶ï¼Œæ–¹æ³•ç«‹å³è¿”å›žã€‚è€Œtransferæ–¹æ³•æ˜¯å¿…é¡»ç­‰åˆ°æ¶ˆè´¹è€…æ¶ˆè´¹äº†æ‰è¿”å›žã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨é‡è½½æ–¹æ³•tryTransfer(E e, long timeout, TimeUnit unit)æŒ‡å®šè¶…æ—¶æ—¶é—´ã€‚LinkedBlockingDequeLinkedBlockingDequeæ˜¯ä¸€ä¸ªç”±é“¾è¡¨ç»“æž„ç»„æˆçš„åŒå‘é˜»å¡žé˜Ÿåˆ—ã€‚æ‰€è°“åŒå‘é˜Ÿåˆ—æŒ‡çš„ä½ å¯ä»¥ä»Žé˜Ÿåˆ—çš„ä¸¤ç«¯æ’å…¥å’Œç§»å‡ºå…ƒç´ ã€‚åŒç«¯é˜Ÿåˆ—å› ä¸ºå¤šäº†ä¸€ä¸ªæ“ä½œé˜Ÿåˆ—çš„å…¥å£ï¼Œåœ¨å¤šçº¿ç¨‹åŒæ—¶å…¥é˜Ÿæ—¶ï¼Œä¹Ÿå°±å‡å°‘äº†ä¸€åŠçš„ç«žäº‰ã€‚ç›¸æ¯”å…¶ä»–çš„é˜»å¡žé˜Ÿåˆ—ï¼ŒLinkedBlockingDequeå¤šäº†ä¸€äº›é¦–å°¾å…ƒç´ çš„æ“ä½œæ–¹æ³•ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä¸Šé¢çš„è¡¨æ ¼ã€‚å‚è€ƒæ–‡ç« http://ifeve.com/java-blocking-queue/https://www.cnblogs.com/jinggod/p/8495502.html]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Fork/Joinä½¿ç”¨å­¦ä¹ ]]></title>
    <url>%2FJDK7-Fork-Join.html</url>
    <content type="text"><![CDATA[JDK7æä¾›äº†ä¸€ä¸ªå°†ä»»åŠ¡â€œåˆ†è€Œæ²»ä¹‹â€çš„æ¡†æž¶ â€” Fork/Joinã€‚å®ƒæŠŠä¸€ä¸ªå¤§çš„ä»»åŠ¡åˆ†å‰²æˆè¶³å¤Ÿå°çš„å­ä»»åŠ¡ï¼Œå¦‚æžœå­ä»»åŠ¡æ¯”è¾ƒå¤§çš„è¯è¿˜è¦å¯¹å­ä»»åŠ¡è¿›è¡Œç»§ç»­åˆ†å‰²ã€‚åˆ†å‰²çš„å­ä»»åŠ¡åˆ†åˆ«æ”¾åˆ°åŒç«¯é˜Ÿåˆ—é‡Œï¼Œç„¶åŽå¯åŠ¨çº¿ç¨‹åˆ†åˆ«ä»ŽåŒç«¯é˜Ÿåˆ—é‡ŒèŽ·å–ä»»åŠ¡æ‰§è¡Œã€‚å­ä»»åŠ¡æ‰§è¡Œå®Œçš„ç»“æžœéƒ½æ”¾åœ¨å¦å¤–ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä»Žé˜Ÿåˆ—é‡Œå–æ•°æ®ï¼Œç„¶åŽåˆå¹¶è¿™äº›æ•°æ®ã€‚Fork/Joinçš„æ€æƒ³å¦‚ä¸‹æ‰€ç¤ºï¼š RecursiveTaskRecursiveTaské€‚ç”¨äºŽå°†ä»»åŠ¡åˆ†è€Œæ²»ä¹‹ï¼Œå¹¶ä¸”æœ‰è¿”å›žå€¼çš„æƒ…å†µï¼Œä¸¾ä¸ªè®¡ç®—1åˆ°100å’Œçš„ä¾‹å­ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546public class RecursiveTest &#123; // å®šä¹‰æœ€å°åŒºé—´ä¸º10 private final static int MAX_THRESHOLD = 10; public static void main(String[] args) &#123; final ForkJoinPool forkJoinPool = new ForkJoinPool(); ForkJoinTask&lt;Integer&gt; future = forkJoinPool.submit(new CalculateRecursiveTask(1, 100)); try &#123; Integer result = future.get(); System.out.println(result); &#125; catch (InterruptedException | ExecutionException e) &#123; e.printStackTrace(); &#125; &#125; private static class CalculateRecursiveTask extends RecursiveTask&lt;Integer&gt; &#123; // èµ·å§‹ private int start; // ç»“æŸ private int end; public CalculateRecursiveTask(int start, int end) &#123; this.start = start; this.end = end; &#125; @Override protected Integer compute() &#123; // å¦‚æžœèµ·å§‹å’Œç»“æŸèŒƒå›´å°äºŽæˆ‘ä»¬å®šä¹‰çš„åŒºé—´èŒƒå›´ï¼Œåˆ™ç›´æŽ¥è®¡ç®— if ((end - start) &lt;= MAX_THRESHOLD) &#123; return IntStream.rangeClosed(start, end).sum(); &#125; else &#123; // å¦åˆ™ï¼Œå°†èŒƒå›´ä¸€åˆ†ä¸ºäºŒï¼Œåˆ†æˆä¸¤ä¸ªå­ä»»åŠ¡ int middle = (start + end) / 2; CalculateRecursiveTask leftTask = new CalculateRecursiveTask(start, middle); CalculateRecursiveTask rightTask = new CalculateRecursiveTask(middle + 1, end); // æ‰§è¡Œå­ä»»åŠ¡ leftTask.fork(); rightTask.fork(); // æ±‡æ€»å­ä»»åŠ¡ return leftTask.join() + rightTask.join(); &#125; &#125; &#125;&#125;ForkJoinPoolä½¿ç”¨submitæˆ–invokeæäº¤çš„åŒºåˆ«ï¼šinvokeæ˜¯åŒæ­¥æ‰§è¡Œï¼Œè°ƒç”¨ä¹‹åŽéœ€è¦ç­‰å¾…ä»»åŠ¡å®Œæˆï¼Œæ‰èƒ½æ‰§è¡ŒåŽé¢çš„ä»£ç ï¼›submitæ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œåªæœ‰åœ¨Futureè°ƒç”¨getçš„æ—¶å€™ä¼šé˜»å¡žã€‚å¯åŠ¨ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼šå…¶å®žè¿™é‡Œæ‰§è¡Œå­ä»»åŠ¡è°ƒç”¨forkæ–¹æ³•å¹¶ä¸æ˜¯æœ€ä½³çš„é€‰æ‹©ï¼Œæœ€ä½³çš„é€‰æ‹©æ˜¯invokeAllæ–¹æ³•ï¼š123456// æ‰§è¡Œå­ä»»åŠ¡// leftTask.fork();// rightTask.fork();invokeAll(leftTask,rightTask);// æ±‡æ€»å­ä»»åŠ¡return leftTask.join() + rightTask.join();RecursiveActionä½¿ç”¨æ–¹å¼å’ŒRecursiveTaskç±»ä¼¼ï¼Œåªä¸è¿‡æ²¡æœ‰è¿”å›žå€¼ï¼š12345678910111213141516171819202122232425262728293031323334353637383940public class RecursiveActionTest &#123; // å®šä¹‰æœ€å°åŒºé—´ä¸º10 private final static int MAX_THRESHOLD = 10; private final static AtomicInteger SUM = new AtomicInteger(0); public static void main(String[] args) throws InterruptedException &#123; final ForkJoinPool forkJoinPool = new ForkJoinPool(); forkJoinPool.submit(new CalculateRecursiveAction(0, 100)); forkJoinPool.awaitTermination(2, TimeUnit.SECONDS); System.out.println(SUM); &#125; private static class CalculateRecursiveAction extends RecursiveAction &#123; // èµ·å§‹ private final int start; // ç»“æŸ private final int end; private CalculateRecursiveAction(int start, int end) &#123; this.start = start; this.end = end; &#125; @Override protected void compute() &#123; // å¦‚æžœèµ·å§‹å’Œç»“æŸèŒƒå›´å°äºŽæˆ‘ä»¬å®šä¹‰çš„åŒºé—´èŒƒå›´ï¼Œåˆ™ç›´æŽ¥è®¡ç®— if ((end - start) &lt;= MAX_THRESHOLD) &#123; SUM.addAndGet(IntStream.rangeClosed(start, end).sum()); &#125; else &#123; // å¦åˆ™ï¼Œå°†èŒƒå›´ä¸€åˆ†ä¸ºäºŒï¼Œåˆ†æˆä¸¤ä¸ªå­ä»»åŠ¡ int middle = (end + start) / 2; CalculateRecursiveAction leftAction = new CalculateRecursiveAction(start, middle); CalculateRecursiveAction rightAction = new CalculateRecursiveAction(middle + 1, end); // æ‰§è¡Œå­ä»»åŠ¡ invokeAll(leftAction, rightAction); // æ²¡æœ‰æ±‡æ€»å­ä»»åŠ¡ç»“æžœè¿‡ç¨‹ï¼Œå› ä¸ºæ²¡æœ‰è¿”å›žå€¼ã€‚ &#125; &#125; &#125;&#125;è¾“å‡ºç»“æžœä¹Ÿæ˜¯5050ã€‚ä»€ä¹ˆæ—¶å€™ç”¨ä¸Šé¢åªæ˜¯ä¸ºäº†æ¼”ç¤ºFork/Joinçš„ç”¨æ³•ï¼Œå®žé™…æ˜¯é‡‡ç”¨è¿™ç§æ–¹å¼è®¡ç®—åè€Œæ›´åŠ è´¹æ—¶ï¼Œå› ä¸ºåˆ‡å‰²ä»»åŠ¡ï¼Œåˆ†é…çº¿ç¨‹éœ€è¦é¢å¤–çš„å¼€é”€ã€‚å…¶å®žä»€ä¹ˆæ—¶å€™ç”¨ä¸å¿…å¤ªçº ç»“ï¼Œä¸€ä¸ªè¶³å¤Ÿå¤§çš„ä»»åŠ¡ï¼Œå¦‚æžœé‡‡ç”¨Fork/Joinæ¥å¤„ç†æ¯”ä¼ ç»Ÿå¤„ç†æ–¹å¼å¿«çš„è¯ï¼Œé‚£å°±æ¯«ä¸çŠ¹è±«çš„é€‰æ‹©å®ƒå§ï¼å‚è€ƒæ–‡ç« ï¼šhttps://www.imooc.com/article/24822]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥å­¦ä¹ Javaçº¿ç¨‹æ± ]]></title>
    <url>%2FJava-Thread-Pool.html</url>
    <content type="text"><![CDATA[åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡new Threadæ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œç”±äºŽçº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯éƒ½éœ€è¦æ¶ˆè€—ä¸€å®šçš„CPUèµ„æºï¼Œæ‰€ä»¥åœ¨é«˜å¹¶å‘ä¸‹è¿™ç§åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼å°†ä¸¥é‡å½±å“ä»£ç æ‰§è¡Œæ•ˆçŽ‡ã€‚è€Œçº¿ç¨‹æ± çš„ä½œç”¨å°±æ˜¯è®©ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç»“æŸåŽä¸é©¬ä¸Šé”€æ¯ï¼Œç»§ç»­æ‰§è¡Œæ–°çš„ä»»åŠ¡ï¼Œè¿™æ ·å°±èŠ‚çœäº†ä¸æ–­åˆ›å»ºçº¿ç¨‹å’Œé”€æ¯çº¿ç¨‹çš„å¼€é”€ã€‚ThreadPoolExecutoråˆ›å»ºJavaçº¿ç¨‹æ± æœ€ä¸ºæ ¸å¿ƒçš„ç±»ä¸ºThreadPoolExecutorï¼šå®ƒæä¾›äº†å››ç§æž„é€ å‡½æ•°æ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Œå…¶ä¸­æœ€ä¸ºæ ¸å¿ƒçš„æž„é€ å‡½æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š1234567public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler)è¿™7ä¸ªå‚æ•°çš„å«ä¹‰å¦‚ä¸‹ï¼šcorePoolSize çº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹æ•°ã€‚å³çº¿ç¨‹æ± ä¸­ä¿ç•™çš„çº¿ç¨‹ä¸ªæ•°ï¼Œå³ä½¿è¿™äº›çº¿ç¨‹æ˜¯ç©ºé—²çš„ï¼Œä¹Ÿä¸ä¼šè¢«é”€æ¯ï¼Œé™¤éžé€šè¿‡ThreadPoolExecutorçš„allowCoreThreadTimeOut(true)æ–¹æ³•å¼€å¯äº†æ ¸å¿ƒçº¿ç¨‹çš„è¶…æ—¶ç­–ç•¥ï¼›maximumPoolSize çº¿ç¨‹æ± ä¸­å…è®¸çš„æœ€å¤§çº¿ç¨‹ä¸ªæ•°ï¼›keepAliveTime ç”¨äºŽè®¾ç½®é‚£äº›è¶…å‡ºæ ¸å¿ƒçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹çš„æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´è¿˜æ²¡æœ‰æ–°ä»»åŠ¡çš„è¯ï¼Œè¶…å‡ºçš„çº¿ç¨‹å°†è¢«é”€æ¯ï¼›unit è¶…æ—¶æ—¶é—´å•ä½ï¼›workQueue çº¿ç¨‹é˜Ÿåˆ—ã€‚ç”¨äºŽä¿å­˜é€šè¿‡executeæ–¹æ³•æäº¤çš„ï¼Œç­‰å¾…è¢«æ‰§è¡Œçš„ä»»åŠ¡ï¼›threadFactory çº¿ç¨‹åˆ›å»ºå·¥ç¨‹ï¼Œå³æŒ‡å®šæ€Žæ ·åˆ›å»ºçº¿ç¨‹ï¼›handler æ‹’ç»ç­–ç•¥ã€‚å³æŒ‡å®šå½“çº¿ç¨‹æäº¤çš„æ•°é‡è¶…å‡ºäº†maximumPoolSizeåŽï¼Œè¯¥ä½¿ç”¨ä»€ä¹ˆç­–ç•¥å¤„ç†è¶…å‡ºçš„çº¿ç¨‹ã€‚åœ¨é€šè¿‡è¿™ä¸ªæž„é€ æ–¹æ³•åˆ›å»ºçº¿ç¨‹æ± çš„æ—¶å€™ï¼Œè¿™å‡ ä¸ªå‚æ•°å¿…é¡»æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œå¦åˆ™å°†æŠ›å‡ºIllegalArgumentExceptionå¼‚å¸¸ï¼šcorePoolSizeä¸èƒ½å°äºŽ0ï¼›keepAliveTimeä¸èƒ½å°äºŽ0ï¼›maximumPoolSize ä¸èƒ½å°äºŽç­‰äºŽ0ï¼›maximumPoolSizeä¸èƒ½å°äºŽcorePoolSizeï¼›æ­¤å¤–ï¼ŒworkQueueã€threadFactoryå’Œhandlerä¸èƒ½ä¸ºnullï¼Œå¦åˆ™å°†æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚ä¸‹é¢ä¸¾äº›ä¾‹å­æ¥æ·±å…¥ç†è§£è¿™å‡ ä¸ªå‚æ•°çš„å«ä¹‰ã€‚ä½¿ç”¨ä¸Šé¢çš„æž„é€ æ–¹æ³•åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼š123456789101112131415161718192021ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 1, 2, 10, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy());System.out.println("çº¿ç¨‹æ± åˆ›å»ºå®Œæ¯•");int activeCount = -1;int queueSize = -1;while (true) &#123; if (activeCount != threadPoolExecutor.getActiveCount() || queueSize != threadPoolExecutor.getQueue().size()) &#123; System.out.println("æ´»è·ƒçº¿ç¨‹ä¸ªæ•° " + threadPoolExecutor.getActiveCount()); System.out.println("æ ¸å¿ƒçº¿ç¨‹ä¸ªæ•° " + threadPoolExecutor.getCorePoolSize()); System.out.println("é˜Ÿåˆ—çº¿ç¨‹ä¸ªæ•° " + threadPoolExecutor.getQueue().size()); System.out.println("æœ€å¤§çº¿ç¨‹æ•° " + threadPoolExecutor.getMaximumPoolSize()); System.out.println("------------------------------------"); activeCount = threadPoolExecutor.getActiveCount(); queueSize = threadPoolExecutor.getQueue().size(); &#125;&#125;ä¸Šé¢çš„ä»£ç åˆ›å»ºäº†ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹æ•°é‡ä¸º1ï¼Œå…è®¸æœ€å¤§çº¿ç¨‹æ•°é‡ä¸º2ï¼Œæœ€å¤§æ´»è·ƒæ—¶é—´ä¸º10ç§’ï¼Œçº¿ç¨‹é˜Ÿåˆ—é•¿åº¦ä¸º1çš„çº¿ç¨‹æ± ã€‚å‡å¦‚æˆ‘ä»¬é€šè¿‡executeæ–¹æ³•å‘çº¿ç¨‹æ± æäº¤1ä¸ªä»»åŠ¡ï¼Œçœ‹çœ‹ç»“æžœå¦‚ä½•ï¼š1234567891011121314151617181920212223ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 1, 2, 10, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy());System.out.println("çº¿ç¨‹æ± åˆ›å»ºå®Œæ¯•");threadPoolExecutor.execute(() -&gt; sleep(100));int activeCount = -1;int queueSize = -1;while (true) &#123; if (activeCount != threadPoolExecutor.getActiveCount() || queueSize != threadPoolExecutor.getQueue().size()) &#123; System.out.println("æ´»è·ƒçº¿ç¨‹ä¸ªæ•° " + threadPoolExecutor.getActiveCount()); System.out.println("æ ¸å¿ƒçº¿ç¨‹ä¸ªæ•° " + threadPoolExecutor.getCorePoolSize()); System.out.println("é˜Ÿåˆ—çº¿ç¨‹ä¸ªæ•° " + threadPoolExecutor.getQueue().size()); System.out.println("æœ€å¤§çº¿ç¨‹æ•° " + threadPoolExecutor.getMaximumPoolSize()); System.out.println("------------------------------------"); activeCount = threadPoolExecutor.getActiveCount(); queueSize = threadPoolExecutor.getQueue().size(); &#125;&#125;ThreadPoolExecutorçš„executeå’Œsubmitæ–¹æ³•éƒ½å¯ä»¥å‘çº¿ç¨‹æ± æäº¤ä»»åŠ¡ï¼ŒåŒºåˆ«æ˜¯ï¼Œsubmitæ–¹æ³•èƒ½å¤Ÿè¿”å›žæ‰§è¡Œç»“æžœï¼Œè¿”å›žå€¼ç±»åž‹ä¸ºFuturesleepæ–¹æ³•ä»£ç ï¼š12345678private static void sleep(long value) &#123; try &#123; System.out.println(Thread.currentThread().getName() + "çº¿ç¨‹æ‰§è¡Œsleepæ–¹æ³•"); TimeUnit.SECONDS.sleep(value); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125;&#125;å¯åŠ¨ç¨‹åºï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š çº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹æ•°é‡ä¸º1ï¼Œé€šè¿‡executeæäº¤äº†ä¸€ä¸ªä»»åŠ¡åŽï¼Œç”±äºŽæ ¸å¿ƒçº¿ç¨‹æ˜¯ç©ºé—²çš„ï¼Œæ‰€ä»¥ä»»åŠ¡è¢«æ‰§è¡Œäº†ã€‚ç”±äºŽè¿™ä¸ªä»»åŠ¡çš„é€»è¾‘æ˜¯ä¼‘çœ 100ç§’ï¼Œæ‰€ä»¥åœ¨è¿™100ç§’å†…ï¼Œçº¿ç¨‹æ± çš„æ´»è·ƒçº¿ç¨‹æ•°é‡ä¸º1ã€‚æ­¤å¤–ï¼Œå› ä¸ºæäº¤çš„ä»»åŠ¡è¢«æ ¸å¿ƒçº¿ç¨‹æ‰§è¡Œäº†ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰çº¿ç¨‹éœ€è¦è¢«æ”¾åˆ°çº¿ç¨‹é˜Ÿåˆ—é‡Œç­‰å¾…ï¼Œçº¿ç¨‹é˜Ÿåˆ—é•¿åº¦ä¸º0ã€‚å‡å¦‚æˆ‘ä»¬é€šè¿‡executeæ–¹æ³•å‘çº¿ç¨‹æ± æäº¤2ä¸ªä»»åŠ¡ï¼Œçœ‹çœ‹ç»“æžœå¦‚ä½•ï¼š12threadPoolExecutor.execute(() -&gt; sleep(100));threadPoolExecutor.execute(() -&gt; sleep(100));çº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹æ•°é‡ä¸º1ï¼Œé€šè¿‡executeæäº¤äº†2ä¸ªä»»åŠ¡åŽï¼Œä¸€å¼€å§‹æ ¸å¿ƒçº¿ç¨‹æ˜¯ç©ºé—²çš„ï¼ŒThread-0è¢«æ‰§è¡Œã€‚ç”±äºŽè¿™ä¸ªä»»åŠ¡çš„é€»è¾‘æ˜¯ä¼‘çœ 100ç§’ï¼Œæ‰€ä»¥åœ¨è¿™100ç§’å†…ï¼Œçº¿ç¨‹æ± çš„æ´»è·ƒçº¿ç¨‹æ•°é‡ä¸º1ã€‚å› ä¸ºæ ¸å¿ƒçº¿ç¨‹æ•°é‡ä¸º1ï¼Œæ‰€ä»¥å¦å¤–ä¸€ä¸ªä»»åŠ¡åœ¨è¿™100ç§’å†…ä¸èƒ½è¢«æ‰§è¡Œï¼ŒäºŽæ˜¯è¢«æ”¾åˆ°çº¿ç¨‹é˜Ÿåˆ—é‡Œç­‰å¾…ï¼Œçº¿ç¨‹é˜Ÿåˆ—é•¿åº¦ä¸º1ã€‚å‡å¦‚æˆ‘ä»¬é€šè¿‡executeæ–¹æ³•å‘çº¿ç¨‹æ± æäº¤3ä¸ªä»»åŠ¡ï¼Œçœ‹çœ‹ç»“æžœå¦‚ä½•ï¼š123threadPoolExecutor.execute(() -&gt; sleep(100));threadPoolExecutor.execute(() -&gt; sleep(100));threadPoolExecutor.execute(() -&gt; sleep(100));è¿™ä¸‰ä¸ªä»»åŠ¡éƒ½æ˜¯ä¼‘çœ 100ç§’ï¼Œæ‰€ä»¥æ ¸å¿ƒçº¿ç¨‹æ± ä¸­ç¬¬ä¸€ä¸ªä»»åŠ¡æ­£åœ¨è¢«æ‰§è¡Œï¼Œç¬¬äºŒä¸ªä»»åŠ¡è¢«æ”¾å…¥åˆ°äº†çº¿ç¨‹é˜Ÿåˆ—ã€‚è€Œå½“ç¬¬ä¸‰ä¸ªä»»åŠ¡è¢«æäº¤è¿›æ¥æ—¶ï¼Œçº¿ç¨‹é˜Ÿåˆ—æ»¡äº†ï¼ˆæˆ‘ä»¬å®šä¹‰çš„é•¿åº¦ä¸º1ï¼‰ï¼Œç”±äºŽè¯¥çº¿ç¨‹æ± å…è®¸çš„æœ€å¤§çº¿ç¨‹æ•°é‡ä¸º2ï¼Œæ‰€ä»¥çº¿ç¨‹æ± è¿˜å¯ä»¥å†åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œå¦å¤–ä¸€ä¸ªä»»åŠ¡ï¼ŒäºŽæ˜¯ä¹Žä¹‹å‰åœ¨çº¿ç¨‹é˜Ÿåˆ—é‡Œçš„çº¿ç¨‹è¢«å–å‡ºæ‰§è¡Œï¼ˆFIFOï¼‰ï¼Œç¬¬ä¸‰ä¸ªä»»åŠ¡è¢«æ”¾å…¥åˆ°äº†çº¿ç¨‹é˜Ÿåˆ—ã€‚æ”¹å˜ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªä»»åŠ¡çš„ç¡çœ æ—¶é—´ï¼Œè§‚å¯Ÿè¾“å‡ºï¼š123threadPoolExecutor.execute(() -&gt; sleep(100));threadPoolExecutor.execute(() -&gt; sleep(5));threadPoolExecutor.execute(() -&gt; sleep(5));ç¬¬äºŒä¸ªä»»åŠ¡æäº¤5ç§’åŽï¼Œä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ‰€ä»¥çº¿ç¨‹é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡è¢«æ‰§è¡Œï¼ŒäºŽæ˜¯é˜Ÿåˆ—çº¿ç¨‹ä¸ªæ•°ä¸º0ï¼Œæ´»è·ƒçº¿ç¨‹æ•°é‡ä¸º2ï¼ˆç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªä»»åŠ¡ï¼‰ã€‚å†è¿‡5ç§’åŽï¼Œç¬¬ä¸‰ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼ŒäºŽæ˜¯æ´»è·ƒçº¿ç¨‹æ•°é‡ä¸º1ï¼ˆç¬¬ä¸€ä¸ª100ç§’è¿˜æ²¡æ‰§è¡Œå®Œæ¯•ï¼‰ã€‚åœ¨ç¬¬ä¸‰ä¸ªä»»åŠ¡ç»“æŸçš„çž¬é—´ï¼Œæˆ‘ä»¬è§‚å¯Ÿçº¿ç¨‹å¿«ç…§:å¯ä»¥çœ‹åˆ°ï¼Œçº¿ç¨‹æ± ä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼ŒThread-0åœ¨æ‰§è¡Œç¬¬ä¸€ä¸ªä»»åŠ¡ï¼ˆä¼‘çœ 100ç§’ï¼Œè¿˜æ²¡ç»“æŸï¼‰ï¼ŒThread-1æ‰§è¡Œå®Œç¬¬ä¸‰ä¸ªä»»åŠ¡åŽå¹¶æ²¡æœ‰é©¬ä¸Šè¢«é”€æ¯ã€‚è¿‡æ®µæ—¶é—´åŽï¼ˆ10ç§’é’ŸåŽï¼‰å†è§‚å¯Ÿçº¿ç¨‹å¿«ç…§:å¯ä»¥çœ‹åˆ°ï¼ŒThread-1è¿™ä¸ªçº¿ç¨‹è¢«é”€æ¯äº†ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨åˆ›å»ºçº¿ç¨‹æ± çš„æ—¶å€™ï¼ŒæŒ‡å®škeepAliveTime ä¸º10ç§’ï¼Œ10ç§’åŽï¼Œè¶…å‡ºæ ¸å¿ƒçº¿ç¨‹æ± çº¿ç¨‹å¤–çš„é‚£äº›çº¿ç¨‹å°†è¢«é”€æ¯ã€‚å‡å¦‚ä¸€æ¬¡æ€§æäº¤4ä¸ªä»»åŠ¡ï¼Œçœ‹çœ‹ä¼šæ€Žæ ·ï¼š1234threadPoolExecutor.execute(() -&gt; sleep(100));threadPoolExecutor.execute(() -&gt; sleep(100));threadPoolExecutor.execute(() -&gt; sleep(100));threadPoolExecutor.execute(() -&gt; sleep(100));å› ä¸ºæˆ‘ä»¬è®¾ç½®çš„æ‹’ç»ç­–ç•¥ä¸ºAbortPolicyï¼Œæ‰€ä»¥æœ€åŽæäº¤çš„é‚£ä¸ªä»»åŠ¡ç›´æŽ¥è¢«æ‹’ç»äº†ã€‚æ›´å¤šæ‹’ç»ç­–ç•¥ä¸‹é¢ä¼šä»‹ç»åˆ°ã€‚å…³é—­çº¿ç¨‹æ± çº¿ç¨‹æ± åŒ…å«ä»¥ä¸‹å‡ ä¸ªçŠ¶æ€ï¼šå½“çº¿ç¨‹æ± ä¸­æ‰€æœ‰ä»»åŠ¡éƒ½å¤„ç†å®Œæ¯•åŽï¼Œçº¿ç¨‹å¹¶ä¸ä¼šè‡ªå·±å…³é—­ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨shutdownå’ŒshutdownNowæ–¹æ³•æ¥å…³é—­çº¿ç¨‹æ± ã€‚ä¸¤è€…çš„åŒºåˆ«åœ¨äºŽï¼šshutdownæ–¹æ³•å°†çº¿ç¨‹æ± ç½®ä¸ºshutdownçŠ¶æ€ï¼Œæ‹’ç»æ–°çš„ä»»åŠ¡æäº¤ï¼Œä½†çº¿ç¨‹æ± å¹¶ä¸ä¼šé©¬ä¸Šå…³é—­ï¼Œè€Œæ˜¯ç­‰å¾…æ‰€æœ‰æ­£åœ¨æŠ˜è¡Œçš„å’Œçº¿ç¨‹é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæ¯•åŽï¼Œçº¿ç¨‹æ± æ‰ä¼šè¢«å…³é—­ã€‚æ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯å¹³æ»‘çš„å…³é—­çº¿ç¨‹æ± ã€‚shutdownNowæ–¹æ³•å°†çº¿ç¨‹æ± ç½®ä¸ºstopçŠ¶æ€ï¼Œæ‹’ç»æ–°çš„ä»»åŠ¡æäº¤ï¼Œä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„é‚£äº›ä»»åŠ¡ï¼Œå¹¶ä¸”æ¸…é™¤çº¿ç¨‹é˜Ÿåˆ—é‡Œçš„ä»»åŠ¡å¹¶è¿”å›žã€‚æ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯æ¯”è¾ƒâ€œæš´åŠ›â€çš„ã€‚ä¸¾ä¸¤ä¸ªä¾‹å­è§‚å¯Ÿä¸‹ä¸¤è€…çš„åŒºåˆ«ï¼šshutdownä¾‹å­:123456789101112131415161718192021222324252627282930313233343536373839public static void main(String[] args) &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 2, 4, 10, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(2), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy()); threadPoolExecutor.execute(new shortTask()); threadPoolExecutor.execute(new longTask()); threadPoolExecutor.execute(new longTask()); threadPoolExecutor.execute(new shortTask()); threadPoolExecutor.shutdown(); System.out.println("å·²ç»æ‰§è¡Œäº†çº¿ç¨‹æ± shutdownæ–¹æ³•");&#125;static class shortTask implements Runnable &#123; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(1); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒshortTaskå®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("shortTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;static class longTask implements Runnable &#123; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(5); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒlongTaskå®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("longTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;å¯åŠ¨ç¨‹åºï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šå¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶åœ¨ä»»åŠ¡éƒ½è¢«æäº¤åŽé©¬ä¸Šæ‰§è¡Œäº†shutdownæ–¹æ³•ï¼Œä½†æ˜¯å¹¶ä¸ä¼šé©¬ä¸Šå…³é—­çº¿ç¨‹æ± ï¼Œè€Œæ˜¯ç­‰å¾…æ‰€æœ‰è¢«æäº¤çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œäº†æ‰å…³é—­ã€‚shutdownNowä¾‹å­ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041public static void main(String[] args) &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 2, 4, 10, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(2), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy()); threadPoolExecutor.execute(new shortTask()); threadPoolExecutor.execute(new longTask()); threadPoolExecutor.execute(new longTask()); threadPoolExecutor.execute(new shortTask()); List&lt;Runnable&gt; runnables = threadPoolExecutor.shutdownNow(); // é©¬ä¸Šå…³é—­ï¼Œå¹¶è¿”å›žè¿˜æœªè¢«æ‰§è¡Œçš„ä»»åŠ¡ System.out.println(runnables); System.out.println("å·²ç»æ‰§è¡Œäº†çº¿ç¨‹æ± shutdownNowæ–¹æ³•");&#125;static class shortTask implements Runnable &#123; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(1); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒshortTaskå®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("shortTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;static class longTask implements Runnable &#123; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(5); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒlongTaskå®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("longTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;å¯åŠ¨ç¨‹åºï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ‰§è¡ŒshutdownNowæ–¹æ³•åŽï¼Œçº¿ç¨‹æ± é©¬ä¸Šå°±è¢«å…³é—­äº†ï¼Œæ­£åœ¨æ‰§è¡Œä¸­çš„ä¸¤ä¸ªä»»åŠ¡è¢«æ‰“æ–­ï¼Œå¹¶ä¸”è¿”å›žäº†çº¿ç¨‹é˜Ÿåˆ—ä¸­ç­‰å¾…è¢«æ‰§è¡Œçš„ä¸¤ä¸ªä»»åŠ¡ã€‚é€šè¿‡ä¸Šé¢ä¸¤ä¸ªä¾‹å­æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°shutdownå’ŒshutdownNowæ–¹æ³•éƒ½ä¸æ˜¯é˜»å¡žçš„ã€‚å¸¸ä¸Žshutdownæ­é…çš„æ–¹æ³•æœ‰awaitTerminationã€‚awaitTerminationæ–¹æ³•æŽ¥æ”¶timeoutå’ŒTimeUnitä¸¤ä¸ªå‚æ•°ï¼Œç”¨äºŽè®¾å®šè¶…æ—¶æ—¶é—´åŠå•ä½ã€‚å½“ç­‰å¾…è¶…è¿‡è®¾å®šæ—¶é—´æ—¶ï¼Œä¼šç›‘æµ‹ExecutorServiceæ˜¯å¦å·²ç»å…³é—­ï¼Œè‹¥å…³é—­åˆ™è¿”å›žtrueï¼Œå¦åˆ™è¿”å›žfalseã€‚è¯¥æ–¹æ³•æ˜¯é˜»å¡žçš„ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445public static void main(String[] args) throws InterruptedException &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 2, 4, 10, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(2), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy()); threadPoolExecutor.execute(new shortTask()); threadPoolExecutor.execute(new longTask()); threadPoolExecutor.execute(new longTask()); threadPoolExecutor.execute(new shortTask()); threadPoolExecutor.shutdown(); boolean isShutdown = threadPoolExecutor.awaitTermination(3, TimeUnit.SECONDS); if (isShutdown) &#123; System.out.println("çº¿ç¨‹æ± åœ¨3ç§’å†…æˆåŠŸå…³é—­"); &#125; else &#123; System.out.println("ç­‰äº†3ç§’è¿˜æ²¡å…³é—­ï¼Œä¸ç­‰äº†â•°ï¼ˆâ€µâ–¡â€²ï¼‰â•¯"); &#125; System.out.println("------------");&#125;static class shortTask implements Runnable &#123; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(1); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒshortTaskå®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("shortTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;static class longTask implements Runnable &#123; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(5); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒlongTaskå®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("longTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;å¯åŠ¨ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š4å¤§æ‹’ç»ç­–ç•¥å½“çº¿ç¨‹æ± æ— æ³•å†æŽ¥æ”¶æ–°çš„ä»»åŠ¡çš„æ—¶å€™ï¼Œå¯é‡‡å–å¦‚ä¸‹å››ç§ç­–ç•¥ï¼š CallerRunsPolicyCallerRunsPolicyç­–ç•¥ï¼šç”±è°ƒç”¨çº¿ç¨‹å¤„ç†è¯¥ä»»åŠ¡ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public static void main(String[] args) throws InterruptedException &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 2, 3, 10, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.CallerRunsPolicy()); threadPoolExecutor.execute(new shortTask("ä»»åŠ¡1")); threadPoolExecutor.execute(new longTask("ä»»åŠ¡2")); threadPoolExecutor.execute(new longTask("ä»»åŠ¡3")); threadPoolExecutor.execute(new shortTask("ä»»åŠ¡4")); threadPoolExecutor.execute(new shortTask("ä»»åŠ¡5")); threadPoolExecutor.shutdown();&#125;static class shortTask implements Runnable &#123; private String name; public shortTask(String name) &#123; this.name = name; &#125; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(1); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒshortTask-name-" + name + "å®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("shortTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;static class longTask implements Runnable &#123; private String name; public longTask(String name) &#123; this.name = name; &#125; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(5); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒlongTask-name-" + name + "å®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("longTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;ä¸Šé¢çš„çº¿ç¨‹æ± æœ€å¤šåªèƒ½ä¸€æ¬¡æ€§æäº¤4ä¸ªä»»åŠ¡ï¼Œç¬¬5ä¸ªä»»åŠ¡æäº¤åŽä¼šè¢«æ‹’ç»ç­–ç•¥å¤„ç†ã€‚å¯åŠ¨ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼šå¯ä»¥çœ‹åˆ°ï¼Œç¬¬5ä¸ªæäº¤çš„ä»»åŠ¡ç”±è°ƒç”¨çº¿ç¨‹ï¼ˆå³mainçº¿ç¨‹ï¼‰å¤„ç†è¯¥ä»»åŠ¡ã€‚AbortPolicyAbortPolicyç­–ç•¥ï¼šä¸¢å¼ƒä»»åŠ¡ï¼Œå¹¶æŠ›å‡ºRejectedExecutionExceptionå¼‚å¸¸ã€‚å‰é¢çš„ä¾‹å­å°±æ˜¯ä½¿ç”¨è¯¥ç­–ç•¥ï¼Œæ‰€ä»¥ä¸å†æ¼”ç¤ºã€‚DiscardOldestPolicyDiscardOldestPolicyç­–ç•¥ï¼šä¸¢å¼ƒæœ€æ—©è¢«æ”¾å…¥åˆ°çº¿ç¨‹é˜Ÿåˆ—çš„ä»»åŠ¡ï¼Œå°†æ–°æäº¤çš„ä»»åŠ¡æ”¾å…¥åˆ°çº¿ç¨‹é˜Ÿåˆ—æœ«ç«¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public static void main(String[] args) throws InterruptedException &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 2, 3, 10, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.DiscardOldestPolicy()); threadPoolExecutor.execute(new shortTask("ä»»åŠ¡1")); threadPoolExecutor.execute(new longTask("ä»»åŠ¡2")); threadPoolExecutor.execute(new longTask("ä»»åŠ¡3")); threadPoolExecutor.execute(new shortTask("ä»»åŠ¡4")); threadPoolExecutor.execute(new shortTask("ä»»åŠ¡5")); threadPoolExecutor.shutdown();&#125;static class shortTask implements Runnable &#123; private String name; public shortTask(String name) &#123; this.name = name; &#125; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(1); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒshortTask-name-" + name + "å®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("shortTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;static class longTask implements Runnable &#123; private String name; public longTask(String name) &#123; this.name = name; &#125; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(5); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒlongTask-name-" + name + "å®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("longTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;å¯åŠ¨ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼šå¯ä»¥çœ‹åˆ°æœ€åŽæäº¤çš„ä»»åŠ¡è¢«æ‰§è¡Œäº†ï¼Œè€Œç¬¬3ä¸ªä»»åŠ¡æ˜¯ç¬¬ä¸€ä¸ªè¢«æ”¾åˆ°çº¿ç¨‹é˜Ÿåˆ—çš„ä»»åŠ¡ï¼Œè¢«ä¸¢å¼ƒäº†ã€‚DiscardPolicyDiscardPolicyç­–ç•¥ï¼šç›´æŽ¥ä¸¢å¼ƒæ–°çš„ä»»åŠ¡ï¼Œä¸æŠ›å¼‚å¸¸ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public static void main(String[] args) throws InterruptedException &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 2, 3, 10, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.DiscardPolicy()); threadPoolExecutor.execute(new shortTask("ä»»åŠ¡1")); threadPoolExecutor.execute(new longTask("ä»»åŠ¡2")); threadPoolExecutor.execute(new longTask("ä»»åŠ¡3")); threadPoolExecutor.execute(new shortTask("ä»»åŠ¡4")); threadPoolExecutor.execute(new shortTask("ä»»åŠ¡5")); threadPoolExecutor.shutdown();&#125;static class shortTask implements Runnable &#123; private String name; public shortTask(String name) &#123; this.name = name; &#125; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(1); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒshortTask-name-" + name + "å®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("shortTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;static class longTask implements Runnable &#123; private String name; public longTask(String name) &#123; this.name = name; &#125; @Override public void run() &#123; try &#123; TimeUnit.SECONDS.sleep(5); System.out.println(Thread.currentThread().getName() + "æ‰§è¡ŒlongTask-name-" + name + "å®Œæ¯•"); &#125; catch (InterruptedException e) &#123; System.err.println("longTaskæ‰§è¡Œè¿‡ç¨‹ä¸­è¢«æ‰“æ–­" + e.getMessage()); &#125; &#125;&#125;å¯åŠ¨ç¨‹åºï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š ç¬¬5ä¸ªä»»åŠ¡ç›´æŽ¥è¢«æ‹’ç»ä¸¢å¼ƒäº†ï¼Œè€Œæ²¡æœ‰æŠ›å‡ºä»»ä½•å¼‚å¸¸ã€‚çº¿ç¨‹æ± å·¥åŽ‚æ–¹æ³•é™¤äº†ä½¿ç”¨ThreadPoolExecutorçš„æž„é€ æ–¹æ³•åˆ›å»ºçº¿ç¨‹æ± å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨Executorsæä¾›çš„å·¥åŽ‚æ–¹æ³•æ¥åˆ›å»ºä¸åŒç±»åž‹çš„çº¿ç¨‹æ± ï¼šnewFixedThreadPoolæŸ¥çœ‹newFixedThreadPoolæ–¹æ³•æºç ï¼š12345public static ExecutorService newFixedThreadPool(int nThreads) &#123; return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());&#125;å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡newFixedThreadPoolåˆ›å»ºçš„æ˜¯ä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ï¼Œå¤§å°ç”±nThreadså‚æ•°æŒ‡å®šï¼Œå®ƒå…·æœ‰å¦‚ä¸‹å‡ ä¸ªç‰¹ç‚¹:å› ä¸ºcorePoolSizeå’ŒmaximumPoolSizeçš„å€¼éƒ½ä¸ºnThreadsï¼Œæ‰€ä»¥çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°é‡æ°¸è¿œç­‰äºŽnThreadsï¼Œä¸å¯èƒ½æ–°å»ºé™¤äº†æ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ï¼Œå³keepAliveTimeå®žé™…ä¸Šåœ¨è¿™é‡Œæ˜¯æ— æ•ˆçš„ã€‚LinkedBlockingQueueæ˜¯ä¸€ä¸ªæ— ç•Œé˜Ÿåˆ—ï¼ˆæœ€å¤§é•¿åº¦ä¸ºInteger.MAX_VALUEï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªçº¿ç¨‹æ± ç†è®ºæ˜¯å¯ä»¥æ— é™çš„æŽ¥æ”¶æ–°çš„ä»»åŠ¡ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šé¢æ²¡æœ‰æŒ‡å®šæ‹’ç»ç­–ç•¥çš„åŽŸå› ã€‚newCachedThreadPoolæŸ¥çœ‹newCachedThreadPoolæ–¹æ³•æºç ï¼š12345public static ExecutorService newCachedThreadPool() &#123; return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;());&#125;è¿™æ˜¯ä¸€ä¸ªç†è®ºä¸Šæ— é™å¤§å°çš„çº¿ç¨‹æ± ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ä¸º0ï¼ŒSynchronousQueueé˜Ÿåˆ—æ˜¯æ²¡æœ‰é•¿åº¦çš„é˜Ÿåˆ—ï¼Œæ‰€ä»¥å½“æœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œå¦‚æžœæœ‰ç©ºé—²çš„è¿˜æœªè¶…æ—¶çš„ï¼ˆæœ€å¤§ç©ºé—²æ—¶é—´60ç§’ï¼‰çº¿ç¨‹åˆ™æ‰§è¡Œè¯¥ä»»åŠ¡ï¼Œå¦åˆ™æ–°å¢žä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†è¯¥ä»»åŠ¡ã€‚å› ä¸ºçº¿ç¨‹æ•°é‡æ²¡æœ‰é™åˆ¶ï¼Œç†è®ºä¸Šå¯ä»¥æŽ¥æ”¶æ— é™ä¸ªæ–°ä»»åŠ¡ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿæ²¡æœ‰æŒ‡å®šæ‹’ç»ç­–ç•¥ã€‚newSingleThreadExecutoræŸ¥çœ‹newSingleThreadExecutoræºç ï¼š123456public static ExecutorService newSingleThreadExecutor() &#123; return new FinalizableDelegatedExecutorService (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()));&#125;æ ¸å¿ƒçº¿ç¨‹æ•°å’Œæœ€å¤§çº¿ç¨‹æ•°éƒ½ä¸º1ï¼Œæ¯æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¤„ç†ä»»åŠ¡ã€‚LinkedBlockingQueueé˜Ÿåˆ—å¯ä»¥æŽ¥æ”¶æ— é™ä¸ªæ–°ä»»åŠ¡ã€‚newScheduledThreadPoolæŸ¥çœ‹newScheduledThreadPoolæºç ï¼š123456789public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) &#123; return new ScheduledThreadPoolExecutor(corePoolSize);&#125;......public ScheduledThreadPoolExecutor(int corePoolSize) &#123; super(corePoolSize, Integer.MAX_VALUE, 0, NANOSECONDS, new DelayedWorkQueue());&#125;æ‰€ä»¥newScheduledThreadPoolç†è®ºæ˜¯ä¹Ÿæ˜¯å¯ä»¥æŽ¥æ”¶æ— é™ä¸ªä»»åŠ¡ï¼ŒDelayedWorkQueueä¹Ÿæ˜¯ä¸€ä¸ªæ— ç•Œé˜Ÿåˆ—ã€‚ä½¿ç”¨newScheduledThreadPoolåˆ›å»ºçš„çº¿ç¨‹æ± é™¤äº†å¯ä»¥å¤„ç†æ™®é€šçš„Runnableä»»åŠ¡å¤–ï¼Œå®ƒè¿˜å…·æœ‰è°ƒåº¦çš„åŠŸèƒ½ï¼š1.å»¶è¿ŸæŒ‡å®šæ—¶é—´åŽæ‰§è¡Œï¼š123ScheduledExecutorService executorService = Executors.newScheduledThreadPool(1);// å»¶è¿Ÿ5ç§’æ‰§è¡ŒexecutorService.schedule(() -&gt; System.out.println("hello"), 5, TimeUnit.SECONDS);2.æŒ‰æŒ‡å®šçš„é€ŸçŽ‡æ‰§è¡Œï¼š12345ScheduledExecutorService executorService = Executors.newScheduledThreadPool(1);// å»¶è¿Ÿ1ç§’æ‰§è¡Œï¼Œç„¶åŽæ¯5ç§’æ‰§è¡Œä¸€æ¬¡executorService.scheduleAtFixedRate( () -&gt; System.out.println(LocalTime.now()), 1, 5, TimeUnit.SECONDS);3.æŒ‰æŒ‡å®šçš„æ—¶å»¶æ‰§è¡Œï¼š1234ScheduledExecutorService executorService = Executors.newScheduledThreadPool(1);executorService.scheduleWithFixedDelay( () -&gt; System.out.println(LocalTime.now()), 1, 5, TimeUnit.SECONDS);ä¹ä¸€çœ‹ï¼ŒscheduleAtFixedRateå’ŒscheduleWithFixedDelayæ²¡å•¥åŒºåˆ«ï¼Œå®žé™…å®ƒä»¬è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼šscheduleAtFixedRateæŒ‰ç…§å›ºå®šé€ŸçŽ‡æ‰§è¡Œä»»åŠ¡ï¼Œæ¯”å¦‚æ¯5ç§’æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œå³ä½¿ä¸Šä¸€ä¸ªä»»åŠ¡æ²¡æœ‰ç»“æŸï¼Œ5ç§’åŽä¹Ÿä¼šå¼€å§‹å¤„ç†æ–°çš„ä»»åŠ¡ï¼›scheduleWithFixedDelayæŒ‰ç…§å›ºå®šçš„æ—¶å»¶å¤„ç†ä»»åŠ¡ï¼Œæ¯”å¦‚æ¯å»¶è¿Ÿ5ç§’æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œæ— è®ºä¸Šä¸€ä¸ªä»»åŠ¡å¤„ç†äº†1ç§’ï¼Œ1åˆ†é’Ÿè¿˜æ˜¯1å°æ—¶ï¼Œä¸‹ä¸€ä¸ªä»»åŠ¡æ€»æ˜¯åœ¨ä¸Šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•åŽ5ç§’é’ŸåŽå¼€å§‹æ‰§è¡Œã€‚å¯¹äºŽè¿™äº›çº¿ç¨‹æ± å·¥åŽ‚æ–¹æ³•çš„ä½¿ç”¨ï¼Œé˜¿é‡Œå·´å·´ç¼–ç¨‹è§„ç¨‹æŒ‡å‡ºï¼šå› ä¸ºè¿™å‡ ä¸ªçº¿ç¨‹æ± ç†è®ºæ˜¯éƒ½å¯ä»¥æŽ¥æ”¶æ— é™ä¸ªä»»åŠ¡ï¼Œæ‰€ä»¥è¿™å°±æœ‰å†…å­˜æº¢å‡ºçš„é£Žé™©ã€‚å®žé™…ä¸Šåªè¦æˆ‘ä»¬æŽŒæ¡äº†ThreadPoolExecutoræž„é€ å‡½æ•°7ä¸ªå‚æ•°çš„å«ä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®ä¸åŒçš„ä¸šåŠ¡æ¥åˆ›å»ºå‡ºç¬¦åˆéœ€æ±‚çš„çº¿ç¨‹æ± ã€‚ä¸€èˆ¬çº¿ç¨‹æ± çš„åˆ›å»ºå¯ä»¥å‚è€ƒå¦‚ä¸‹è§„åˆ™ï¼šIOå¯†é›†åž‹ä»»åŠ¡ï¼šIOå¯†é›†åž‹ä»»åŠ¡çº¿ç¨‹å¹¶ä¸æ˜¯ä¸€ç›´åœ¨æ‰§è¡Œä»»åŠ¡ï¼Œåº”è¯¥é…ç½®å°½å¯èƒ½å¤šçš„çº¿ç¨‹ï¼Œçº¿ç¨‹æ± çº¿ç¨‹æ•°é‡æŽ¨èè®¾ç½®ä¸º2 * CPUæ ¸å¿ƒæ•°ï¼›å¯¹å¼ˆIOå¯†é›†åž‹ä»»åŠ¡ï¼Œç½‘ç»œä¸Šä¹Ÿæœ‰å¦ä¸€ç§çº¿ç¨‹æ± æ•°é‡è®¡ç®—å…¬å¼ï¼šCPUæ ¸å¿ƒæ•°/(1 - é˜»å¡žç³»æ•°)ï¼Œé˜»å¡žç³»æ•°å–å€¼0.8~0.9ï¼Œè‡³äºŽè¿™ä¸¤ç§å…¬å¼ä½¿ç”¨å“ªä¸€ä¸ªï¼Œå¯ä»¥æ ¹æ®å®žé™…çŽ¯å¢ƒæµ‹è¯•æ¯”è¾ƒå¾—å‡ºï¼›è®¡ç®—å¯†é›†åž‹ä»»åŠ¡ï¼šæ­¤ç±»åž‹éœ€è¦CPUçš„å¤§é‡è¿ç®—ï¼Œæ‰€ä»¥å°½å¯èƒ½çš„åŽ»åŽ‹æ¦¨CPUèµ„æºï¼Œçº¿ç¨‹æ± çº¿ç¨‹æ•°é‡æŽ¨èè®¾ç½®ä¸ºCPUæ ¸å¿ƒæ•° + 1ã€‚CPUæ ¸å¿ƒæ•°å¯ä»¥ä½¿ç”¨RuntimeèŽ·å¾—ï¼š1Runtime.getRuntime().availableProcessors()ä¸€äº›APIçš„ç”¨æ³•ThreadPoolExecutoræä¾›äº†å‡ ä¸ªåˆ¤æ–­çº¿ç¨‹æ± çŠ¶æ€çš„æ–¹æ³•ï¼š12345678910111213141516171819202122public static void main(String[] args) throws InterruptedException &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 1, 2, 5, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy() ); threadPoolExecutor.execute(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(5); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;); threadPoolExecutor.shutdown(); System.out.println("çº¿ç¨‹æ± ä¸ºshutdownçŠ¶æ€ï¼š" + threadPoolExecutor.isShutdown()); System.out.println("çº¿ç¨‹æ± æ­£åœ¨å…³é—­ï¼š" + threadPoolExecutor.isTerminating()); System.out.println("çº¿ç¨‹æ± å·²ç»å…³é—­ï¼š" + threadPoolExecutor.isTerminated()); threadPoolExecutor.awaitTermination(6, TimeUnit.SECONDS); System.out.println("çº¿ç¨‹æ± å·²ç»å…³é—­" + threadPoolExecutor.isTerminated());&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼šå‰é¢æˆ‘ä»¬æåˆ°ï¼Œçº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹å³ä½¿æ˜¯ç©ºé—²çŠ¶æ€ä¹Ÿä¸ä¼šè¢«é”€æ¯ï¼Œé™¤éžä½¿ç”¨allowCoreThreadTimeOutè®¾ç½®äº†å…è®¸æ ¸å¿ƒçº¿ç¨‹è¶…æ—¶ï¼š12345678910111213141516public static void main(String[] args) throws InterruptedException &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 1, 2, 3, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy() ); threadPoolExecutor.allowCoreThreadTimeOut(true); threadPoolExecutor.execute(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(5); System.out.println("ä»»åŠ¡æ‰§è¡Œå®Œæ¯•"); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;); &#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š5ç§’åŽä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ ¸å¿ƒçº¿ç¨‹å¤„äºŽç©ºé—²çš„çŠ¶æ€ã€‚å› ä¸ºé€šè¿‡allowCoreThreadTimeOutæ–¹æ³•è®¾ç½®äº†å…è®¸æ ¸å¿ƒçº¿ç¨‹è¶…æ—¶ï¼Œæ‰€ä»¥3ç§’åŽï¼ˆkeepAliveTimeè®¾ç½®ä¸º3ç§’ï¼‰ï¼Œæ ¸å¿ƒçº¿ç¨‹è¢«é”€æ¯ã€‚æ ¸å¿ƒçº¿ç¨‹è¢«é”€æ¯åŽï¼Œçº¿ç¨‹æ± ä¹Ÿå°±æ²¡æœ‰ä½œç”¨äº†ï¼ŒäºŽæ˜¯å°±è‡ªåŠ¨å…³é—­äº†ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æžœä¸€ä¸ªçº¿ç¨‹æ± è°ƒç”¨äº†allowCoreThreadTimeOut(true)æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒçš„keepAliveTimeä¸èƒ½ä¸º0ã€‚ThreadPoolExecutoræä¾›äº†ä¸€removeæ–¹æ³•ï¼ŒæŸ¥çœ‹å…¶æºç ï¼š12345public boolean remove(Runnable task) &#123; boolean removed = workQueue.remove(task); tryTerminate(); // In case SHUTDOWN and now empty return removed;&#125;å¯çœ‹åˆ°ï¼Œå®ƒåˆ é™¤çš„æ˜¯çº¿ç¨‹é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œè€Œéžæ­£åœ¨è¢«æ‰§è¡Œçš„ä»»åŠ¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼š123456789101112131415161718192021public static void main(String[] args) throws InterruptedException &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 1, 2, 3, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy() ); threadPoolExecutor.execute(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(5); System.out.println("ä»»åŠ¡æ‰§è¡Œå®Œæ¯•"); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;); Runnable r = () -&gt; System.out.println("çœ‹çœ‹æˆ‘æ˜¯å¦ä¼šè¢«åˆ é™¤"); threadPoolExecutor.execute(r); threadPoolExecutor.remove(r); threadPoolExecutor.shutdown();&#125;æ‰§è¡Œç¨‹åºï¼Œè¾“å‡ºå¦‚ä¸‹ï¼šå¯çœ‹åˆ°ä»»åŠ¡å¹¶æ²¡æœ‰è¢«æ‰§è¡Œï¼Œå·²ç»è¢«åˆ é™¤ï¼Œå› ä¸ºå”¯ä¸€ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹å·²ç»åœ¨æ‰§è¡Œä»»åŠ¡äº†ï¼Œæ‰€ä»¥åŽæäº¤çš„è¿™ä¸ªä»»åŠ¡è¢«æ”¾åˆ°äº†çº¿ç¨‹é˜Ÿåˆ—é‡Œï¼Œç„¶åŽé€šè¿‡removeæ–¹æ³•åˆ é™¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰å½“å¾€çº¿ç¨‹æ± é‡Œæäº¤äº†ä»»åŠ¡åŽï¼Œçº¿ç¨‹æ± æ‰ä¼šå¯åŠ¨æ ¸å¿ƒçº¿ç¨‹å¤„ç†ä»»åŠ¡ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨prestartCoreThreadæ–¹æ³•ï¼Œè®©æ ¸å¿ƒçº¿ç¨‹å³ä½¿æ²¡æœ‰ä»»åŠ¡æäº¤ï¼Œä¹Ÿå¤„äºŽç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„æ´»è·ƒçŠ¶æ€ï¼š1234567891011121314public static void main(String[] args) throws InterruptedException &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 2, 2, 3, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy() ); System.out.println("æ´»è·ƒçº¿ç¨‹æ•°: " + threadPoolExecutor.getActiveCount()); threadPoolExecutor.prestartCoreThread(); System.out.println("æ´»è·ƒçº¿ç¨‹æ•°: " + threadPoolExecutor.getActiveCount()); threadPoolExecutor.prestartCoreThread(); System.out.println("æ´»è·ƒçº¿ç¨‹æ•°: " + threadPoolExecutor.getActiveCount()); threadPoolExecutor.prestartCoreThread(); System.out.println("æ´»è·ƒçº¿ç¨‹æ•°: " + threadPoolExecutor.getActiveCount());&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼šè¯¥æ–¹æ³•è¿”å›žbooleanç±»åž‹å€¼ï¼Œå¦‚æžœæ‰€ä»¥æ ¸å¿ƒçº¿ç¨‹éƒ½å¯åŠ¨äº†ï¼Œè¿”å›žfalseï¼Œåä¹‹è¿”å›žtrueã€‚è¿˜æœ‰ä¸€ä¸ªå’Œå®ƒç±»ä¼¼çš„prestartAllCoreThreadsæ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯ä¸€æ¬¡æ€§å¯åŠ¨æ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹ï¼Œè®©å…¶å¤„äºŽæ´»è·ƒåœ°ç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„çŠ¶æ€ã€‚ThreadPoolExecutorçš„invokeAnyæ–¹æ³•ç”¨äºŽéšæœºæ‰§è¡Œä»»åŠ¡é›†åˆä¸­çš„æŸä¸ªä»»åŠ¡ï¼Œå¹¶è¿”å›žæ‰§è¡Œç»“æžœï¼Œè¯¥æ–¹æ³•æ˜¯åŒæ­¥æ–¹æ³•ï¼š123456789101112131415161718public static void main(String[] args) throws InterruptedException, ExecutionException &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 2, 5, 3, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy() ); // ä»»åŠ¡é›†åˆ List&lt;Callable&lt;Integer&gt;&gt; tasks = IntStream.range(0, 4).boxed().map(i -&gt; (Callable&lt;Integer&gt;) () -&gt; &#123; TimeUnit.SECONDS.sleep(ThreadLocalRandom.current().nextInt(5)); return i; &#125;).collect(Collectors.toList()); // éšæœºæ‰§è¡Œç»“æžœ Integer result = threadPoolExecutor.invokeAny(tasks); System.out.println("-------------------"); System.out.println(result); threadPoolExecutor.shutdownNow();&#125;å¯åŠ¨ç¨‹åºï¼Œè¾“å‡ºå¦‚ä¸‹ï¼šThreadPoolExecutorçš„invokeAllåˆ™æ˜¯æ‰§è¡Œä»»åŠ¡é›†åˆä¸­çš„æ‰€æœ‰ä»»åŠ¡ï¼Œè¿”å›žFutureé›†åˆï¼š1234567891011121314151617181920212223public static void main(String[] args) throws InterruptedException, ExecutionException &#123; ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor( 2, 5, 3, TimeUnit.SECONDS, new ArrayBlockingQueue&lt;&gt;(1), (ThreadFactory) Thread::new, new ThreadPoolExecutor.AbortPolicy() ); List&lt;Callable&lt;Integer&gt;&gt; tasks = IntStream.range(0, 4).boxed().map(i -&gt; (Callable&lt;Integer&gt;) () -&gt; &#123; TimeUnit.SECONDS.sleep(ThreadLocalRandom.current().nextInt(5)); return i; &#125;).collect(Collectors.toList()); List&lt;Future&lt;Integer&gt;&gt; futureList = threadPoolExecutor.invokeAll(tasks); futureList.stream().map(f-&gt;&#123; try &#123; return f.get(); &#125; catch (InterruptedException | ExecutionException e) &#123; return null; &#125; &#125;).forEach(System.out::println); threadPoolExecutor.shutdownNow();&#125;è¾“å‡ºå¦‚ä¸‹ï¼š æ€»ç»“ä¸‹è¿™äº›æ–¹æ³•ï¼šæ–¹æ³•æè¿°allowCoreThreadTimeOut(boolean value)æ˜¯å¦å…è®¸æ ¸å¿ƒçº¿ç¨‹ç©ºé—²åŽè¶…æ—¶ï¼Œæ˜¯çš„è¯è¶…æ—¶åŽæ ¸å¿ƒçº¿ç¨‹å°†é”€æ¯ï¼Œçº¿ç¨‹æ± è‡ªåŠ¨å…³é—­awaitTermination(long timeout, TimeUnit unit)é˜»å¡žå½“å‰çº¿ç¨‹ï¼Œç­‰å¾…çº¿ç¨‹æ± å…³é—­ï¼Œtimeoutç”¨äºŽæŒ‡å®šç­‰å¾…æ—¶é—´ã€‚execute(Runnable command)å‘çº¿ç¨‹æ± æäº¤ä»»åŠ¡ï¼Œæ²¡æœ‰è¿”å›žå€¼submit(Runnable task)å‘çº¿ç¨‹æ± æäº¤ä»»åŠ¡ï¼Œè¿”å›žFutureisShutdown()åˆ¤æ–­çº¿ç¨‹æ± æ˜¯å¦ä¸ºshutdownçŠ¶æ€isTerminating()åˆ¤æ–­çº¿ç¨‹æ± æ˜¯å¦æ­£åœ¨å…³é—­isTerminated()åˆ¤æ–­çº¿ç¨‹æ± æ˜¯å¦å·²ç»å…³é—­remove(Runnable task)ç§»é™¤çº¿ç¨‹é˜Ÿåˆ—ä¸­çš„æŒ‡å®šä»»åŠ¡prestartCoreThread()æå‰è®©ä¸€ä¸ªæ ¸å¿ƒçº¿ç¨‹å¤„äºŽæ´»è·ƒçŠ¶æ€ï¼Œç­‰å¾…æ‰§è¡Œä»»åŠ¡prestartAllCoreThreads()æå‰è®©æ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹å¤„äºŽæ´»è·ƒçŠ¶æ€ï¼Œç­‰å¾…æ‰§è¡Œä»»åŠ¡getActiveCount()èŽ·å–çº¿ç¨‹æ± æ´»è·ƒçº¿ç¨‹æ•°getCorePoolSize()èŽ·å–çº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹æ•°threadPoolExecutor.getQueue()èŽ·å–çº¿ç¨‹æ± çº¿ç¨‹é˜Ÿåˆ—getMaximumPoolSize()èŽ·å–çº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°shutdown()è®©çº¿ç¨‹æ± å¤„äºŽshutdownçŠ¶æ€ï¼Œä¸å†æŽ¥æ”¶ä»»åŠ¡ï¼Œç­‰å¾…æ‰€æœ‰æ­£åœ¨è¿è¡Œä¸­çš„ä»»åŠ¡ç»“æŸåŽï¼Œå…³é—­çº¿ç¨‹æ± ã€‚shutdownNow()è®©çº¿ç¨‹æ± å¤„äºŽstopçŠ¶æ€ï¼Œä¸å†æŽ¥å—ä»»åŠ¡ï¼Œå°è¯•æ‰“æ–­æ­£åœ¨è¿è¡Œä¸­çš„ä»»åŠ¡ï¼Œå¹¶å…³é—­çº¿ç¨‹æ± ï¼Œè¿”å›žçº¿ç¨‹é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é›†åˆçº¿ç¨‹å®‰å…¨é—®é¢˜]]></title>
    <url>%2F%E9%9B%86%E5%90%88%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98.html</url>
    <content type="text"><![CDATA[å¸¸ç”¨çš„é›†åˆç±»åž‹å¦‚ArrayListï¼ŒHashMapï¼ŒHashSetç­‰ï¼Œåœ¨å¹¶å‘çŽ¯å¢ƒä¸‹ä¿®æ”¹æ“ä½œéƒ½æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¼šæŠ›å‡ºjava.util.ConcurrentModificationExceptionå¼‚å¸¸ï¼Œè¿™èŠ‚ä¸»è¦è®°å½•å¦‚ä½•åœ¨å¹¶å‘çŽ¯å¢ƒä¸‹å®‰å…¨åœ°ä¿®æ”¹é›†åˆæ•°æ®ã€‚Listä¸¾ä¸ªArrayListçº¿ç¨‹ä¸å®‰å…¨çš„ä¾‹å­ï¼š12345678910public class CollectionTest &#123; public static void main(String[] args) &#123; List&lt;String&gt; data = new ArrayList&lt;&gt;(); IntStream.range(0, 30).forEach( i -&gt; new Thread(() -&gt; data.add(String.valueOf(i)), String.valueOf(i)).start() ); System.out.println(data); &#125;&#125;ä¸Šé¢ä¾‹å­ä¸­ï¼Œæœ‰30ä¸ªçº¿ç¨‹å¯¹dataè¿›è¡Œä¿®æ”¹æ“çºµï¼Œå¤šè¿è¡Œå‡ æ¬¡ä¸Šé¢çš„ç¨‹åºï¼ŒæŽ§åˆ¶å°ä¾¿ä¼šæŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸ï¼šä¹‹æ‰€ä»¥ä¼šæŠ›å‡ºjava.util.ConcurrentModificationExceptionå¼‚å¸¸ï¼Œæ˜¯å› ä¸ºå¤šä¸ªçº¿ç¨‹å¹¶å‘äº‰æŠ¢ä¿®æ”¹dataå¯¼è‡´ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨å†™å…¥ä½†è¿˜æœªå†™å®Œæ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹æŠ¢å¤ºå†™å…¥ï¼Œè¿™ä¾¿å¯¼è‡´äº†æ•°æ®å¼‚å¸¸ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š1. ä½¿ç”¨Vectorï¼š12345678910public class CollectionTest &#123; public static void main(String[] args) &#123; List&lt;String&gt; data = new Vector&lt;&gt;(); IntStream.range(0, 30).forEach( i -&gt; new Thread(() -&gt; data.add(String.valueOf(i)), String.valueOf(i)).start() ); System.out.println(data); &#125;&#125;Vectorç±»çš„addæ–¹æ³•æ˜¯é€šè¿‡åŠ åŒæ­¥é”æ¥å®žçŽ°çº¿ç¨‹å®‰å…¨çš„ï¼ŒæŸ¥çœ‹æºç ï¼š2. ä½¿ç”¨Collectionså·¥å…·ç±»çš„synchronizedListæ–¹æ³•ï¼š12345678910public class CollectionTest &#123; public static void main(String[] args) &#123; List&lt;String&gt; data = Collections.synchronizedList(new ArrayList&lt;&gt;()); IntStream.range(0, 30).forEach( i -&gt; new Thread(() -&gt; data.add(String.valueOf(i)), String.valueOf(i)).start() ); System.out.println(data); &#125;&#125;å…¶æœ¬è´¨è¿˜æ˜¯é€šè¿‡åŒæ­¥é”æ¥è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š3. ä½¿ç”¨CopyOnWriteArrayListï¼š12345678910public class CollectionTest &#123; public static void main(String[] args) &#123; List&lt;String&gt; data = new CopyOnWriteArrayList&lt;&gt;(); IntStream.range(0, 30).forEach( i -&gt; new Thread(() -&gt; data.add(String.valueOf(i)), String.valueOf(i)).start() ); System.out.println(data); &#125;&#125;æŸ¥çœ‹CopyOnWriteArrayListç±»çš„addæ–¹æ³•æºç ï¼Œä¼šå‘çŽ°å®ƒæ˜¯é€šè¿‡å¯é‡å…¥é”æ¥è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜çš„ï¼šä¸Šé¢æ–¹æ³•çš„æºç ä½¿ç”¨äº†å†™æ—¶å¤åˆ¶çš„æ€æƒ³ï¼ˆCopyOnWriteï¼‰ï¼šå¾€ä¸€ä¸ªå®¹å™¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¸ç›´æŽ¥å¾€å½“å‰å®¹å™¨Object[]æ·»åŠ ï¼Œè€Œæ˜¯å…ˆå°†å½“å‰å®¹å™¨Object[]è¿›è¡Œå¤åˆ¶ï¼Œå¤åˆ¶å‡ºä¸€ä¸ªæ–°çš„å®¹å™¨Object[] newElementsï¼Œç„¶åŽå¾€æ–°çš„å®¹å™¨Object[] newElementsé‡Œæ·»åŠ æ–°çš„å…ƒç´ ã€‚æ·»åŠ å®ŒåŽï¼Œå†å°†åŽŸå®¹å™¨çš„å¼•ç”¨æŒ‡å‘æ–°çš„å®¹å™¨ï¼ˆå³æºç ä¸­çš„setArray(newElements)ï¼‰ã€‚è¿™ç§åšæ³•çš„å¥½å¤„æ˜¯å¯ä»¥å¯¹CopyOnWriteçš„å®¹å™¨è¿›è¡Œå¹¶å‘çš„è¯»ï¼Œè€Œä¸éœ€è¦åŠ é”ï¼Œå› ä¸ºå½“å‰å®¹å™¨ä¸ä¼šæ·»åŠ ä»»ä½•å…ƒç´ ã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸€ç§è¯»å†™åˆ†ç¦»çš„æ€æƒ³ï¼Œå³è¯»å’Œå†™çš„å®¹å™¨æ˜¯ä¸åŒçš„å®¹å™¨ã€‚ä¸Šé¢è¿™ä¸‰ç§è§£å†³åŠžæ³•ä¸­ï¼Œæ›´æŽ¨èä½¿ç”¨CopyOnWriteArrayListã€‚SetHashSetåœ¨å¹¶å‘ä¸‹ä¿®æ”¹ä¹Ÿä¼šå‡ºçŽ°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚è§£å†³åŠžæ³•åŒæ ·å¯ä»¥é€šè¿‡Collections#synchronizedSetå’ŒCopyOnWriteArraySetè§£å†³ï¼Œè¿‡ç¨‹å’Œä¸Šè¿°ç±»ä¼¼ï¼Œæ‰€ä»¥ä¸å†èµ˜è¿°ã€‚MapHashMapåœ¨å¹¶å‘çŽ¯å¢ƒä¸‹ä¿®æ”¹æ—¶çš„çº¿ç¨‹å®‰å…¨é—®é¢˜åŒæ ·å¯ä»¥é€šè¿‡Collections.synchronizedMapè§£å†³ã€‚æ­¤å¤–å¹¶æ²¡æœ‰æ‰€è°“çš„CopyOnWriteHashMapï¼Œçº¿ç¨‹å®‰å…¨çš„HashMapå¯ä»¥ä½¿ç”¨ConcurrentHashMapï¼š12345678910public class CollectionTest &#123; public static void main(String[] args) &#123; Map&lt;String, String&gt; data = new ConcurrentHashMap&lt;&gt;(); IntStream.range(0, 30).forEach( i -&gt; new Thread(() -&gt; data.put(String.valueOf(i), String.valueOf(i)), String.valueOf(i)).start() ); System.out.println(data); &#125;&#125;]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java Concurrency Lock]]></title>
    <url>%2FJava-Concurrency-Lock.html</url>
    <content type="text"><![CDATA[Locké”æ˜¯ç”¨æ¥æŽ§åˆ¶å¤šä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºçš„æ–¹å¼ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªé”èƒ½å¤Ÿé˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«èµ„æºï¼ˆä½†æ˜¯æœ‰äº›é”å¯ä»¥å…è®¸å¤šä¸ªçº¿ç¨‹å¹¶å‘çš„è®¿é—®å…±äº«èµ„æºï¼Œæ¯”å¦‚è¯»å†™é”ï¼‰ã€‚åœ¨LockæŽ¥å£å‡ºçŽ°ä¹‹å‰ï¼ŒJavaç¨‹åºæ˜¯é synchronizedå…³é”®å­—å®žçŽ°é”åŠŸèƒ½çš„ï¼Œè€ŒJava SE 5ä¹‹åŽï¼Œå¹¶å‘åŒ…ä¸­æ–°å¢žäº†LockæŽ¥å£ï¼ˆä»¥åŠç›¸å…³å®žçŽ°ç±»ï¼‰ç”¨æ¥å®žçŽ°é”åŠŸèƒ½ï¼Œå®ƒæä¾›äº†ä¸Žsynchronizedå…³é”®å­—ç±»ä¼¼çš„åŒæ­¥åŠŸèƒ½ï¼Œåªæ˜¯åœ¨ä½¿ç”¨æ—¶éœ€è¦æ˜¾å¼åœ°èŽ·å–å’Œé‡Šæ”¾é”ã€‚è™½ç„¶å®ƒç¼ºå°‘äº†ï¼ˆé€šè¿‡synchronizedå—æˆ–è€…æ–¹æ³•æ‰€æä¾›çš„ï¼‰éšå¼èŽ·å–é‡Šæ”¾é”çš„ä¾¿æ·æ€§ï¼Œä½†æ˜¯å´æ‹¥æœ‰äº†é”èŽ·å–ä¸Žé‡Šæ”¾çš„å¯æ“ä½œæ€§ã€å¯ä¸­æ–­çš„èŽ·å–é”ä»¥åŠè¶…æ—¶èŽ·å–é”ç­‰å¤šç§synchronizedå…³é”®å­—æ‰€ä¸å…·å¤‡çš„åŒæ­¥ç‰¹æ€§ã€‚ReentrantLockReentrantLockå­—é¢ä¸Šæ„æ€å°±æ˜¯å¯é‡å…¥é”ï¼ˆåˆç§°ä¸ºé€’å½’é”ï¼‰ï¼Œè¡¨ç¤ºè¯¥é”èƒ½å¤Ÿæ”¯æŒä¸€ä¸ªçº¿ç¨‹å¯¹èµ„æºçš„é‡å¤åŠ é”ã€‚å®šä¹‰ä¸€ä¸ªReentrantLockï¼š1ReentrantLock lock = new ReentrantLock();é»˜è®¤æ— å‚æž„é€ å‡½æ•°åˆ›å»ºçš„æ˜¯éžå…¬å¹³é”ï¼Œæž„é€ å‡½æ•°é‡è½½æ–¹æ³•ReentrantLock(boolean fair)æ”¯æŒä¼ å…¥trueåˆ›å»ºå…¬å¹³é”ã€‚å…¬å¹³é”çš„æ„æ€æ˜¯å¤šçº¿ç¨‹åœ¨èŽ·å–é”çš„æ—¶å€™æ˜¯å…¬å¹³çš„ï¼Œä¹Ÿå°±æ˜¯ç­‰å¾…æ—¶é—´æœ€é•¿çš„çº¿ç¨‹æœ€ä¼˜å…ˆèŽ·å–é”ï¼Œç±»ä¼¼FIFOã€‚ä½¿ç”¨ReentrantLockå¯ä»¥å®žçŽ°å’Œsynchronizedä¸€æ ·çš„åŠŸèƒ½ï¼š123456789101112131415161718public class ReentrantLockTest &#123; private static final ReentrantLock lock = new ReentrantLock(); public static void main(String[] args) throws InterruptedException &#123; IntStream.range(0, 2).forEach(i -&gt; new Thread(ReentrantLockTest::needLock).start()); &#125; public static void needLock() &#123; try &#123; lock.lock(); System.out.println(Thread.currentThread().getName() + "å¼€å§‹å·¥ä½œ"); TimeUnit.SECONDS.sleep(5); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125;&#125;ç¡®ä¿åœ¨finallyé‡Œé‡Šæ”¾é”ï¼Œå¦åˆ™å®¹æ˜“é€ æˆæ­»é”ã€‚ä¸Šé¢ä¾‹å­åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥èŽ·å¾—é”lockï¼Œåˆ«çš„çº¿ç¨‹å¿…é¡»ç­‰å¾…é”è¢«é‡Šæ”¾ï¼ˆunlockï¼‰æ‰èƒ½å¼€å§‹ç«žäº‰èŽ·å–é”ã€‚ç¨‹åºè¿è¡Œç»“æžœå¦‚ä¸‹æ‰€ç¤ºï¼šneedLockæ–¹æ³•å’Œä¸‹é¢é€šè¿‡synchronizedå…³é”®å­—å®žçŽ°é”æ–¹æ³•æ•ˆæžœæ˜¯ä¸€æ ·çš„ï¼š12345678910public static void needLockBySync() &#123; synchronized (ReentrantLockTest.class) &#123; try &#123; System.out.println(Thread.currentThread().getName() + "å¼€å§‹å·¥ä½œ"); TimeUnit.SECONDS.sleep(5); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;&#125;ä¸ºä»€ä¹ˆReentrantLockåˆç§°ä¸ºé€’å½’é”å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºï¼šä¸€ä¸ªçº¿ç¨‹å¦‚æžœèŽ·å–äº†æŸä¸ªæ–¹æ³•çš„é”ï¼Œè¿™ä¸ªæ–¹æ³•å†…éƒ¨å³ä½¿è°ƒç”¨äº†åˆ«çš„éœ€è¦èŽ·å–é”çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹ä¸éœ€è¦å†æ¬¡ç­‰å¾…èŽ·å–é”ï¼Œå¯ä»¥ç›´æŽ¥è¿›åŽ»ã€‚è¯´ç€å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œä¸‹é¢ä¸¾ä¸ªä¾‹å­ï¼š1234567891011121314151617181920212223242526public class Test &#123; private static Lock lock = new ReentrantLock(); public static void main(String[] args) &#123; IntStream.rangeClosed(0,1).forEach(i-&gt; new Thread(Test::method1, String.valueOf(i)).start()); &#125; public static void method1() &#123; lock.lock(); try &#123; System.out.println(Thread.currentThread().getName() + " invoked method1"); method2(); &#125; finally &#123; lock.unlock(); &#125; &#125; public static void method2() &#123; lock.lock(); try &#123; System.out.println(Thread.currentThread().getName() + " invoked method2"); &#125; finally &#123; lock.unlock(); &#125; &#125;&#125;ç¨‹åºè¿è¡Œç»“æžœï¼š12340 invoked method10 invoked method21 invoked method11 invoked method2ä¸Šé¢ä¾‹å­ä¸­ï¼Œmethod1å’Œmethod2éƒ½åŠ äº†é”ï¼Œçº¿ç¨‹0èŽ·å–åˆ°äº†method1çš„é”åŽï¼Œå†…éƒ¨å¯ä»¥ç›´æŽ¥è°ƒç”¨method2ï¼Œæ— éœ€é‡æ–°èŽ·å–é”å¯¹è±¡ã€‚synchronizedä¹Ÿå…·æœ‰ç›¸åŒçš„ç‰¹æ€§ã€‚ReentrantLockå¯ä»¥å¯¹ä¸€ä¸ªæ–¹æ³•ä¸é™æ¬¡çš„é‡å¤åŠ é”ï¼Œä½†è§£é”æ¬¡æ•°å¿…é¡»å’ŒåŠ é”æ¬¡æ•°ä¸€è‡´ï¼Œå¦åˆ™é”æ°¸è¿œä¸ä¼šè¢«é‡Šæ”¾ï¼Œåˆ«çš„çº¿ç¨‹å°†æ— æ³•èŽ·å–è¯¥æ–¹æ³•çš„é”ï¼Œæ¯”å¦‚ï¼š123456789101112131415161718192021222324public class Test &#123; private static Lock lock = new ReentrantLock(); public static void main(String[] args) &#123; IntStream.rangeClosed(0,1).forEach(i-&gt; new Thread(Test::method1, String.valueOf(i)).start()); &#125; public static void method1() &#123; // åŠ é”4æ¬¡ lock.lock(); lock.lock(); lock.lock(); lock.lock(); try &#123; System.out.println(Thread.currentThread().getName() + " invoked method1"); &#125; finally &#123; // è§£é”3æ¬¡ lock.unlock(); lock.unlock(); lock.unlock(); &#125; &#125;&#125;ç¨‹åºè¿è¡Œç»“æžœï¼š çº¿ç¨‹1ä¸€ç›´å¤„äºŽWAITINGçŠ¶æ€ï¼Œå› ä¸ºçº¿ç¨‹0åŠ é”äº†4æ¬¡ï¼Œä½†åªé‡Šæ”¾äº†3æ¬¡é”ï¼Œæ‰€ä»¥çº¿ç¨‹1ä¸€ç›´æ— æ³•èŽ·å–åˆ°é”ã€‚lockæ–¹æ³•æ˜¯ä¸å¯è¢«æ‰“æ–­çš„ï¼Œå³è°ƒç”¨çº¿ç¨‹çš„interruptæ–¹æ³•ä¸èµ·ä½œç”¨ï¼š123456789101112131415161718192021222324public class ReentrantLockTest &#123; private static final ReentrantLock lock = new ReentrantLock(); public static void main(String[] args) throws InterruptedException &#123; Thread thread1 = new Thread(ReentrantLockTest::testLockUnInterruptibly); thread1.start(); TimeUnit.SECONDS.sleep(1); Thread thread2 = new Thread(ReentrantLockTest::testLockUnInterruptibly); thread2.start(); TimeUnit.SECONDS.sleep(1); thread2.interrupt(); &#125; public static void testLockUnInterruptibly() &#123; try &#123; lock.lock(); // ä¸å¯ä»¥è¢«æ‰“æ–­ System.out.println(Thread.currentThread().getName() + "å¼€å§‹å·¥ä½œ"); while (true) &#123; &#125; &#125; finally &#123; lock.unlock(); &#125; &#125;&#125;è¿è¡Œç»“æžœ:thread2(Thread-1)ä¾æ—§åœ¨ç»§ç»­ç­‰å¾…èŽ·å–é”ï¼Œæ²¡æœ‰è¢«æ‰“æ–­ã€‚ReentrantLockæä¾›äº†å¯æ‰“æ–­èŽ·å–é”çš„æ–¹æ³•lockInterruptiblyï¼š12345678910111213141516171819202122232425262728public class ReentrantLockTest &#123; private static final ReentrantLock lock = new ReentrantLock(); public static void main(String[] args) throws InterruptedException &#123; Thread thread1 = new Thread(ReentrantLockTest::testLockInterruptibly); thread1.start(); TimeUnit.SECONDS.sleep(1); Thread thread2 = new Thread(ReentrantLockTest::testLockInterruptibly); thread2.start(); TimeUnit.SECONDS.sleep(1); thread2.interrupt(); &#125; public static void testLockInterruptibly() &#123; try &#123; lock.lockInterruptibly(); // å¯ä»¥è¢«æ‰“æ–­ System.out.println(Thread.currentThread().getName() + "å¼€å§‹å·¥ä½œ"); while (true) &#123; &#125; &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125;&#125;thread2åœ¨ç­‰å¾…èŽ·å–é”æ—¶è¢«æ‰“æ–­ï¼ŒæŠ›å‡ºInterruptedExceptionå¼‚å¸¸ã€‚ReentrantLockçš„tryLockæ–¹æ³•ç”¨äºŽå°è¯•èŽ·å–é”ï¼Œè¿”å›žbooleanç±»åž‹ï¼Œè¡¨ç¤ºèŽ·å–é”æˆåŠŸä¸Žå¦ï¼š123456789101112131415161718192021222324public class ReentrantLockTest &#123; private static final ReentrantLock lock = new ReentrantLock(); public static void main(String[] args) throws InterruptedException &#123; Thread thread1 = new Thread(ReentrantLockTest::testTryLock, "thread1"); thread1.start(); TimeUnit.SECONDS.sleep(1); Thread thread2 = new Thread(ReentrantLockTest::testTryLock, "thread2"); thread2.start(); &#125; public static void testTryLock() &#123; if (lock.tryLock()) &#123; try &#123; System.out.println(Thread.currentThread().getName() + "å¼€å§‹å·¥ä½œ"); while (true) &#123; &#125; &#125; finally &#123; lock.unlock(); &#125; &#125; else &#123; System.out.println(Thread.currentThread().getName() + "æ²¡æœ‰èŽ·å–åˆ°é”"); &#125; &#125;&#125;thread1æŠ¢åˆ°é”åŽè¿›å…¥æ­»å¾ªçŽ¯ï¼Œä¸€ç›´ä¸é‡Šæ”¾é”ã€‚thread2å°è¯•èŽ·å–é”å¤±è´¥åŽç›´æŽ¥æ”¾å¼ƒã€‚tryLockçš„é‡è½½æ–¹æ³•tryLock(long timeout, TimeUnit unit)å¯ä»¥è®¾ç½®å°è¯•èŽ·å–é”çš„æ—¶é—´èŒƒå›´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´æ²¡æœ‰èŽ·å–åˆ°é”åˆ™è¿”å›žfalseã€‚ReentrantLockä¸€äº›åˆ«çš„æ–¹æ³•ï¼šæ–¹æ³•å«ä¹‰getQueueLength()ç­‰å¾…èŽ·å–é”çº¿ç¨‹æ•°é‡hasQueuedThreads()æ˜¯å¦æœ‰åœ¨ç­‰å¾…èŽ·å–é”çš„çº¿ç¨‹hasQueuedThread(Thread thread)ç­‰å¾…èŽ·å–é”çš„çº¿ç¨‹é˜Ÿåˆ—é‡Œæ˜¯åŒ…å«æŒ‡å®šçš„çº¿ç¨‹isLockedå½“å‰é”æ˜¯å¦è¢«ä»»æ„ä¸€ä¸ªçº¿ç¨‹èŽ·å–åˆ°äº†Spin LockJUCä¸­å¹¶æ²¡æœ‰è‡ªæ—‹é”å¯¹åº”çš„ç±»ï¼Œè€Œæ‰€è°“çš„è‡ªæ—‹é”å°±æ˜¯ï¼šå°è¯•èŽ·å–é”çš„çº¿ç¨‹ä¸ä¼šé©¬ä¸Šé˜»å¡žï¼Œè€Œæ˜¯é‡‡ç”¨å¾ªçŽ¯çš„æ–¹å¼åŽ»å°è¯•èŽ·å–é”ã€‚è¿™ç§æ–¹å¼çš„å¥½å¤„æ˜¯å¯ä»¥å‡å°‘çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ¶ˆè€—ï¼Œç¼ºç‚¹æ˜¯å¾ªçŽ¯ä¼šæ¶ˆè€—CPUèµ„æºã€‚ä¸€ä¸ªç»å…¸çš„è‡ªæ—‹é”ä¾‹å­å°±æ˜¯unsafeç±»é‡Œçš„CASæ€æƒ³ï¼šæˆ‘ä»¬å¯ä»¥åˆ©ç”¨CASå®žçŽ°ä¸€ä¸ªè‡ªæ—‹é”ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546public class SpinLock &#123; AtomicReference&lt;Thread&gt; reference = new AtomicReference&lt;&gt;(); public void lock() &#123; Thread thread = Thread.currentThread(); System.out.println(thread.getName() + "å°è¯•èŽ·å–é”"); while (!reference.compareAndSet(null, thread)) &#123; // è‡ªæ—‹é”å°±æ˜¯åˆ©ç”¨CASæ€æƒ³åˆ¶é€ å¾ªçŽ¯ï¼Œblockä½ä»£ç  &#125; System.out.println(thread.getName() + "èŽ·å–åˆ°äº†é”"); &#125; public void unlock() &#123; Thread thread = Thread.currentThread(); reference.compareAndSet(thread, null); System.out.println(thread.getName() + "é‡Šæ”¾é”"); &#125; public static void main(String[] args) &#123; SpinLock lock = new SpinLock(); new Thread(() -&gt; &#123; lock.lock(); try &#123; System.out.println(Thread.currentThread().getName() + "åšæŸäº‹..."); TimeUnit.SECONDS.sleep(5); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125;, "çº¿ç¨‹1").start(); new Thread(() -&gt; &#123; lock.lock(); try &#123; System.out.println(Thread.currentThread().getName() + "åšæŸäº‹..."); TimeUnit.SECONDS.sleep(5); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125;, "çº¿ç¨‹2").start(); &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š12345678çº¿ç¨‹1å°è¯•èŽ·å–é”çº¿ç¨‹1èŽ·å–åˆ°äº†é”çº¿ç¨‹1åšæŸäº‹...çº¿ç¨‹2å°è¯•èŽ·å–é”çº¿ç¨‹1é‡Šæ”¾é”çº¿ç¨‹2èŽ·å–åˆ°äº†é”çº¿ç¨‹2åšæŸäº‹...çº¿ç¨‹2é‡Šæ”¾é”ReadWriteLockReadWriteLockä¸ºè¯»å†™é”ã€‚ReentrantLockä¸ºæŽ’ä»–é”ï¼ŒåŒä¸€æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œè®¿é—®ï¼Œè€Œè¯»å†™é”åœ¨åŒä¸€æ—¶åˆ»å¯ä»¥å…è®¸å¤šä¸ªè¯»çº¿ç¨‹è®¿é—®ï¼Œä½†æ˜¯åœ¨å†™çº¿ç¨‹è®¿é—®æ—¶ï¼Œæ‰€æœ‰çš„è¯»çº¿ç¨‹å’Œå…¶ä»–å†™çº¿ç¨‹å‡è¢«é˜»å¡žã€‚è¯»å†™é”ç»´æŠ¤äº†ä¸€å¯¹é”ï¼Œä¸€ä¸ªè¯»é”å’Œä¸€ä¸ªå†™é”ï¼Œé€šè¿‡åˆ†ç¦»è¯»é”å’Œå†™é”ï¼Œä½¿å¾—å¹¶å‘æ€§ç›¸æ¯”ä¸€èˆ¬çš„æŽ’ä»–é”æœ‰äº†å¾ˆå¤§æå‡ã€‚ç®€è€Œè¨€ä¹‹ï¼ŒReadWriteLockåŒ…å«è¯»å†™é”ï¼Œéµå¾ªä»¥ä¸‹è§„åˆ™ï¼šå†™çš„æ—¶å€™ä¸èƒ½è¯»å†™çš„æ—¶å€™ä¸èƒ½å†™è¯»çš„æ—¶å€™ä¸èƒ½å†™è¯»çš„æ—¶å€™å¯ä»¥è¯»ReadWriteLockä¸ºæŽ¥å£ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒçš„å®žçŽ°ç±»ReentrantReadWriteLockåˆ›å»ºè¯»å†™é”å®žä¾‹ï¼š123ReentrantReadWriteLock lock = new ReentrantReadWriteLock(true);ReentrantReadWriteLock.ReadLock readLock = lock.readLock();ReentrantReadWriteLock.WriteLock writeLock = lock.writeLock();ä½¿ç”¨è¯»å†™é”åˆ›å»ºä¸€ä¸ªè¯»å†™çš„ä¾‹å­ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950public class ReadWriteLockTest &#123; private static ReentrantReadWriteLock lock = new ReentrantReadWriteLock(true); // è¯»é” private static ReentrantReadWriteLock.ReadLock readLock = lock.readLock(); // å†™é” private static ReentrantReadWriteLock.WriteLock writeLock = lock.writeLock(); // å­˜æ”¾æ•°æ® private static List&lt;Long&gt; data = new ArrayList&lt;&gt;(); public static void main(String[] args) throws InterruptedException &#123; new Thread(() -&gt; &#123; while (true) &#123; write(); &#125; &#125;, "writer").start(); new Thread(() -&gt; &#123; while (true) &#123; read(); &#125; &#125;, "reader").start(); &#125; public static void write() &#123; try &#123; writeLock.lock(); // å†™é” TimeUnit.SECONDS.sleep(1); long value = System.currentTimeMillis(); data.add(value); System.out.println(Thread.currentThread().getName() + " å†™å…¥value: " + value); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; writeLock.unlock(); // é‡Šæ”¾å†™é” &#125; &#125; public static void read() &#123; try &#123; readLock.lock(); // èŽ·å–è¯»é” TimeUnit.SECONDS.sleep(1); String value = data.stream().map(String::valueOf).collect(Collectors.joining(",")); System.out.println(Thread.currentThread().getName() + "è¯»å–data: " + value); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; readLock.unlock(); // é‡Šæ”¾è¯»é” &#125; &#125;&#125;ReentrantReadWriteLockè¿˜åŒ…å«äº†ä¸€äº›åˆ«çš„å®žç”¨æ–¹æ³•ï¼šåŠŸèƒ½å’Œä¸Šé¢ä»‹ç»çš„ReentrantLockå·®ä¸å¤šï¼Œæ–¹æ³•åè§åçŸ¥å…¶æ„ï¼Œä¸å†æ¼”ç¤ºäº†ã€‚JDK8 StampedLockJDK8 æ–°å¢žäº†ä¸€ä¸ªé”StampedLockï¼Œå®ƒæ˜¯å¯¹ReadWriteLockçš„æ”¹è¿›ã€‚ä½¿ç”¨ReadWriteLockçš„æ—¶å€™ï¼Œå½“è¯»çº¿ç¨‹æ•°é‡è¿œå¤§äºŽå†™çº¿ç¨‹æ•°é‡çš„æ—¶å€™å°±ä¼šå‡ºçŽ°â€œå†™é¥¥é¥¿â€çŽ°è±¡ã€‚å› ä¸ºé”å¤§æ¦‚çŽ‡éƒ½è¢«è¯»çº¿ç¨‹æŠ¢èµ°äº†ï¼Œå†™çº¿ç¨‹å¾ˆéš¾æŠ¢åˆ°é”ï¼Œè¿™å°†ä½¿å¾—è¯»å†™æ•ˆçŽ‡éžå¸¸ä½Žä¸‹ã€‚JDK8çš„StampedLockå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œè®¾è®¡çš„ï¼ŒStampedLockåŒ…å«ä¹è§‚é”å’Œæ‚²è§‚é”ï¼šä¹è§‚é”ï¼šæ¯æ¬¡åŽ»æ‹¿æ•°æ®çš„æ—¶å€™ï¼Œå¹¶ä¸èŽ·å–é”å¯¹è±¡ï¼Œè€Œæ˜¯åˆ¤æ–­æ ‡è®°ä½ï¼ˆstampï¼‰æ˜¯å¦æœ‰è¢«ä¿®æ”¹ï¼Œå¦‚æžœæœ‰ä¿®æ”¹å°±å†åŽ»è¯»ä¸€æ¬¡ã€‚æ‚²è§‚é”ï¼šæ¯æ¬¡æ‹¿æ•°æ®çš„æ—¶å€™éƒ½åŽ»èŽ·å–é”ã€‚é€šè¿‡ä¹è§‚é”ï¼Œå½“å†™çº¿ç¨‹æ²¡æœ‰å†™æ•°æ®çš„æ—¶å€™ï¼Œæ ‡å¿—ä½stampå¹¶æ²¡æœ‰æ”¹å˜ï¼Œæ‰€ä»¥å³ä½¿æœ‰å†å¤šçš„è¯»çº¿ç¨‹åœ¨è¯»å–æ•°æ®ï¼Œå®ƒä»¬éƒ½å¯ä»¥ç›´æŽ¥åŽ»è¯»æ•°æ®ï¼Œè€Œæ— éœ€èŽ·å–é”ï¼Œè¿™å°±ä¸ä¼šä½¿å¾—å†™çº¿ç¨‹æŠ¢ä¸åˆ°é”äº†ã€‚stampç±»ä¼¼ä¸€ä¸ªæ—¶é—´æˆ³çš„ä½œç”¨ï¼Œæ¯æ¬¡å†™çš„æ—¶å€™å¯¹å…¶+1æ¥æ”¹å˜è¢«æ“ä½œå¯¹è±¡çš„stampå€¼ã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥æ¨¡æ‹Ÿå†™é¥¥é¥¿çš„æƒ…å†µï¼šåˆ›å»º20ä¸ªçº¿ç¨‹ï¼Œå…¶ä¸­19ä¸ªçº¿ç¨‹ç”¨äºŽè¯»æ•°æ®ï¼Œ1ä¸ªçº¿ç¨‹ç”¨äºŽå†™æ•°æ®ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445public class StampedLockTest &#123; private static StampedLock lock = new StampedLock(); private static List&lt;Long&gt; data = new ArrayList&lt;&gt;(); public static void main(String[] args) &#123; ExecutorService executorService = Executors.newFixedThreadPool(20); Runnable read = StampedLockTest::read; Runnable write = StampedLockTest::write; IntStream.range(0, 19).forEach(i -&gt; executorService.submit(read)); executorService.submit(write); executorService.shutdown(); &#125; private static void read() &#123; long stamped = -1; try &#123; stamped = lock.readLock(); // èŽ·å–æ‚²è§‚é”ï¼Œé˜»å¡žå†™çº¿ç¨‹ TimeUnit.SECONDS.sleep(1); String collect = data.stream().map(String::valueOf).collect(Collectors.joining(",")); System.out.println(Thread.currentThread().getName() + " read value: " + collect); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlockRead(stamped); &#125; &#125; private static void write() &#123; long stamped = -1; try &#123; stamped = lock.writeLock(); TimeUnit.SECONDS.sleep(1); long value = System.currentTimeMillis(); data.add(value); System.out.println(Thread.currentThread().getName() + " write value: " + value); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlockWrite(stamped); &#125; &#125;&#125;ä¸Šé¢ä¾‹å­é€šè¿‡StampedLockè°ƒç”¨writeLockã€unlockWriteã€readLockå’ŒunlockReadçš„æ—¶å€™éƒ½ä¼šå¯¼è‡´StampedLockçš„stampå€¼çš„å˜åŒ–ï¼Œå³æ¯æ¬¡+1ï¼Œç›´åˆ°åŠ åˆ°æœ€å¤§å€¼ï¼Œç„¶åŽä»Ž0é‡æ–°å¼€å§‹ã€‚ä¸Šé¢ç¨‹åºè¿è¡Œç»“æžœå¦‚ä¸‹ï¼š å¯ä»¥çœ‹åˆ°å†™çº¿ç¨‹æœ€åŽæ‰æŠ¢åˆ°é”å¹¶å†™å…¥æ•°æ®ã€‚æˆ‘ä»¬é€šè¿‡ä¹è§‚é”æ¥æ”¹å–„è¿™ä¸ªä¾‹å­ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657public class StampedLockTest2 &#123; private static StampedLock lock = new StampedLock(); private static List&lt;Long&gt; data = new ArrayList&lt;&gt;(); public static void main(String[] args) &#123; ExecutorService executorService = Executors.newFixedThreadPool(20); Runnable read = StampedLockTest2::read; Runnable write = StampedLockTest2::write; IntStream.range(0, 19).forEach(i -&gt; executorService.submit(read)); executorService.submit(write); executorService.shutdown(); &#125; private static void read() &#123; long stamped = lock.tryOptimisticRead(); // èŽ·å–ä¹è§‚é” try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; // ç›´æŽ¥è¯»å–å€¼ String collect = data.stream().map(String::valueOf).collect(Collectors.joining(",")); // å¦‚æžœæˆ³è¢«æ”¹å˜ï¼Œæ–¹æ³•è¿”å›žfalseï¼Œè¯´æ˜Žstampedè¢«ä¿®æ”¹è¿‡äº†ï¼ˆè¢«writeæ–¹æ³•ä¿®æ”¹è¿‡äº†ï¼Œæœ‰æ–°çš„æ•°æ®å†™å…¥ï¼‰ï¼Œ // é‚£ä¹ˆé‡æ–°èŽ·å–é”å¹¶åŽ»è¯»å–å€¼ï¼Œå¦åˆ™ç›´æŽ¥ä½¿ç”¨ä¸Šé¢è¯»å–çš„å€¼ã€‚ if (!lock.validate(stamped)) &#123; try &#123; stamped = lock.readLock(); TimeUnit.SECONDS.sleep(1); collect = data.stream().map(String::valueOf).collect(Collectors.joining(",")); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlockRead(stamped); &#125; &#125; System.out.println(Thread.currentThread().getName() + " read value: " + collect); &#125; private static void write() &#123; long stamped = -1; try &#123; stamped = lock.writeLock(); TimeUnit.SECONDS.sleep(1); long value = System.currentTimeMillis(); data.add(value); System.out.println(Thread.currentThread().getName() + " write value: " + value); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlockWrite(stamped); &#125; &#125;&#125;æˆ‘ä»¬é‡ç‚¹å…³æ³¨readæ–¹æ³•ã€‚readæ–¹æ³•ä¸€å¼€å§‹é€šè¿‡è°ƒç”¨StampedLockçš„tryOptimisticReadæ–¹æ³•æ¥èŽ·å–æ ‡å¿—ä½stampï¼ŒèŽ·å–ä¹è§‚é”å¹¶ä¸ä¼šçœŸæ­£çš„åŽ»èŽ·å–é”ï¼ˆæ‰€ä»¥ä¸ä¼šé˜»å¡žå†™æ“ä½œï¼‰ï¼Œç„¶åŽç›´æŽ¥åŽ»è¯»æ•°æ®ã€‚æŽ¥ç€é€šè¿‡StampedLockçš„validateæ–¹æ³•åˆ¤æ–­æ ‡å¿—ä½stampæ˜¯å¦è¢«ä¿®æ”¹äº†ï¼ˆwriteæ–¹æ³•é‡Œä¼šä¿®æ”¹æ ‡å¿—ä½çš„å€¼ï¼‰ï¼Œå¦‚æžœæ–¹æ³•è¿”å›žtrueï¼Œåˆ™è¯´æ˜Žæ•°æ®æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ï¼Œç›´æŽ¥ä½¿ç”¨å‰é¢è¯»å–çš„æ•°æ®å³å¯ï¼›å¦åˆ™éœ€è¦åŽ»èŽ·å–é”é‡æ–°åŽ»è¯»æ•°æ®ï¼Œé˜»æ­¢å†™æ“ä½œã€‚ä¸Šé¢ä¾‹å­è¿è¡Œç»“æžœå¦‚ä¸‹ï¼šå¯ä»¥çœ‹åˆ°ï¼Œå†™æ“ä½œä¸€å¼€å§‹å°±æŠ¢åˆ°äº†é”ï¼Œå¹¶å†™å…¥äº†æ•°æ®ã€‚ç®€è€Œè¨€ä¹‹ï¼ŒStampedLockè§£å†³äº†åœ¨æ²¡æœ‰æ–°æ•°æ®å†™å…¥æ—¶ï¼Œç”±äºŽè¿‡å¤šè¯»æ“ä½œæŠ¢å¤ºé”è€Œä½¿å¾—å†™æ“ä½œä¸€ç›´èŽ·å–ä¸åˆ°é”æ— æ³•å†™å…¥æ–°æ•°æ®çš„é—®é¢˜ã€‚ConditionConditionæŽ¥å£æä¾›äº†ç±»ä¼¼Objectçš„waitã€notifyå’ŒnotifyAllæ–¹æ³•ï¼Œä¸ŽLocké…åˆå¯ä»¥å®žçŽ°ç”Ÿäº§/æ¶ˆè´¹æ¨¡å¼ï¼Œä½†æ˜¯è¿™ä¸¤è€…åœ¨ä½¿ç”¨æ–¹å¼ä»¥åŠåŠŸèƒ½ç‰¹æ€§ä¸Šè¿˜æ˜¯æœ‰å·®åˆ«çš„ã€‚ä½¿ç”¨Coditionå®žçŽ°ä¸€ä¸ªç”Ÿäº§æ¶ˆè´¹çš„ä¾‹å­ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657public class ConditionTest &#123; private static ReentrantLock lock = new ReentrantLock(); private static Condition condition = lock.newCondition(); // åˆå§‹æ•°æ® private static int data = 0; // æ˜¯å¦è¢«æ¶ˆè´¹ private static volatile boolean consumed = false; public static void main(String[] args) &#123; new Thread(() -&gt; &#123; while (true) &#123; produceData(); &#125; &#125;,"producer").start(); new Thread(() -&gt; &#123; while (true) &#123; consumeData(); &#125; &#125;,"consumer").start(); &#125; public static void produceData() &#123; try &#123; lock.lock(); // èŽ·å–é” while (!consumed) &#123; // åˆ¤æ–­æ•°æ®æ˜¯å¦è¢«æ¶ˆè´¹ condition.await(); // å¦‚æžœæ²¡æœ‰è¢«æ¶ˆè´¹åˆ™è¿›å…¥ç­‰å¾… &#125; TimeUnit.SECONDS.sleep(1); data++; System.out.println(Thread.currentThread().getName() + " produce data = " + data); consumed = false; // ç”Ÿäº§å®Œæ•°æ®å°†æ¶ˆè´¹æ ‡è¯†ç½®ä¸ºfalse condition.signal(); // è§£é™¤awaitï¼Œç”¨äºŽé€šçŸ¥æ¶ˆè´¹è€…å¯ä»¥å¼€å§‹æ¶ˆè´¹äº† &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); // é‡Šæ”¾é” &#125; &#125; public static void consumeData() &#123; try &#123; lock.lock(); // èŽ·å–é” while (consumed) &#123; // åˆ¤æ–­æ•°æ®æ˜¯å¦è¢«æ¶ˆè´¹ condition.await(); // å¦‚æžœè¢«æ¶ˆè´¹äº†åˆ™è¿›å…¥ç­‰å¾… &#125; TimeUnit.MICROSECONDS.sleep(500); System.out.println(Thread.currentThread().getName() + " consume data = " + data); consumed = true; // æ¶ˆè´¹å®Œå°†æ¶ˆè´¹æ ‡è¯†ç½®ä¸ºtrue condition.signal(); // è§£é™¤awaitï¼Œç”¨äºŽé€šçŸ¥ç”Ÿäº§è€…å¯ä»¥å¼€å§‹ç”Ÿäº§äº† &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); // é‡Šæ”¾é” &#125; &#125;&#125;ä¸Šé¢ä¾‹å­ä¸­ï¼Œé€šè¿‡consumedåˆ¤æ–­æ•°æ®æ˜¯å¦è¢«æ¶ˆè´¹ã€‚produceDataæ–¹æ³•åœ¨èŽ·å–é”åŽï¼Œåˆ¤æ–­æ•°æ®æ˜¯å¦è¢«æ¶ˆè´¹ï¼Œå¦‚æžœæ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œåˆ™è°ƒç”¨Conditionçš„awaitæ–¹æ³•è¿›å…¥ç­‰å¾…ï¼Œç›´åˆ°Conditionå¯¹è±¡çš„signalæ–¹æ³•è¢«è°ƒç”¨ï¼›consumeDataæ–¹æ³•é€»è¾‘å’ŒproduceDataä¸€è‡´ã€‚Conditionæ ¸å¿ƒç”¨æ³•å°±æ˜¯é€šè¿‡awaitæ–¹æ³•è®©çº¿ç¨‹è¿›å…¥é˜»å¡žç­‰å¾…çŠ¶æ€ï¼Œé€šè¿‡signalè§£é™¤é˜»å¡žçŠ¶æ€ã€‚ä¸Šé¢çš„ä¾‹å­è¿è¡Œæ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼šå¯¹åº”ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥æ€è€ƒä¸‹é¢ä¸‰ä¸ªé—®é¢˜ï¼šæ˜¯å¦å¯ä»¥åªä½¿ç”¨Lockè€Œä¸ä½¿ç”¨Conditionï¼Ÿç”Ÿäº§è€…æŠ¢åˆ°äº†é”è¿›å…¥awaitï¼Œå¹¶æ²¡æœ‰é‡Šæ”¾é”ï¼Œä¸ºä»€ä¹ˆæ¶ˆè´¹è€…å¯ä»¥èŽ·å¾—é”ï¼Ÿæ˜¯å¦å¯ä»¥åªä½¿ç”¨Conditionä¸ä½¿ç”¨Lockï¼Ÿå¯¹äºŽç¬¬ä¸€ä¸ªé—®é¢˜ï¼šæ˜¯å¦å¯ä»¥åªä½¿ç”¨Lockè€Œä¸ä½¿ç”¨Conditionï¼Ÿè™½ç„¶æˆ‘ä»¬å¯ä»¥å®šä¹‰å…¬å¹³çš„ReentrantLockï¼Œä½†æ˜¯å®žé™…ä¸Šå¹¶ä¸èƒ½ç¡®ä¿100%å…¬å¹³ï¼Œåªæ˜¯å°½å¯èƒ½çš„å…¬å¹³ã€‚ç”Ÿäº§æ¶ˆè´¹æ¨¡åž‹å¿…é¡»ä¸ºç”Ÿäº§è€…ç”Ÿæˆå®Œäº†æ•°æ®é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œæ¶ˆè´¹è€…æ¶ˆè´¹å®Œäº†é€šçŸ¥ç”Ÿäº§è€…ç”Ÿäº§ï¼Œè¿™æ˜¯çŽ¯çŽ¯ç›¸æ‰£çš„ï¼Œä¸å…è®¸å‡ºçŽ°åˆ«çš„æƒ…å†µã€‚å¯¹äºŽç¬¬äºŒä¸ªé—®é¢˜ï¼šç”Ÿäº§è€…æŠ¢åˆ°äº†é”è¿›å…¥awaitï¼Œå¹¶æ²¡æœ‰é‡Šæ”¾é”ï¼Œä¸ºä»€ä¹ˆæ¶ˆè´¹è€…å¯ä»¥èŽ·å¾—é”ï¼Ÿå‡å¦‚ä¸€å¼€å§‹produceDataæ–¹æ³•å…ˆé€šè¿‡lock.lock()èŽ·å–åˆ°äº†é”ï¼Œconsumedåˆå§‹å€¼ä¸ºfalseï¼Œæ‰€ä»¥æŽ¥ç€æ–¹æ³•ä¼šè°ƒç”¨condition.await()è¿›å…¥é˜»å¡žç­‰å¾…ã€‚awaitæ–¹æ³•ä¼šä½¿å¾—å½“å‰çº¿ç¨‹é‡Šæ”¾é”å¯¹è±¡ï¼Œç„¶åŽè¿›å…¥ä¼‘çœ çŠ¶æ€ï¼Œç›´åˆ°å‘ç”Ÿä¸‹é¢ä¸‰ç§æƒ…å†µä¹‹ä¸€æ‰ä¼šè¢«è§£é™¤ä¼‘çœ ï¼šConditionçš„signalæ–¹æ³•è¢«è°ƒç”¨ï¼›Conditionçš„signalAllæ–¹æ³•è¢«è°ƒç”¨ï¼›å…¶ä»–çº¿ç¨‹è°ƒç”¨äº†å½“å‰çº¿ç¨‹çš„interruptæ–¹æ³•ã€‚å¯¹äºŽç¬¬ä¸‰ä¸ªé—®é¢˜ï¼šæ˜¯å¦å¯ä»¥åªä½¿ç”¨Conditionä¸ä½¿ç”¨Lockï¼Ÿæ—¢ç„¶awaitä¼šä½¿å¾—çº¿ç¨‹è¿›å…¥é˜»å¡žç­‰å¾…çŠ¶æ€ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥ç›´æŽ¥ä½¿ç”¨awaitï¼Œè€Œä¸ä½¿ç”¨Lockå‘¢ï¼Ÿæˆ‘ä»¬æ”¹é€ ä¸Šé¢çš„ä¾‹å­ï¼ŒåŽ»æŽ‰èŽ·å–å’Œé‡Šæ”¾é”çš„ç›¸å…³ä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253public class ConditionTest &#123; // å…¬å¹³é” private static ReentrantLock lock = new ReentrantLock(true); private static Condition condition = lock.newCondition(); // åˆå§‹æ•°æ® private static int data = 0; // æ˜¯å¦è¢«æ¶ˆè´¹ private static volatile boolean consumed = false; public static void main(String[] args) throws InterruptedException &#123; new Thread(() -&gt; &#123; while (true) &#123; produceData(); &#125; &#125;).start(); new Thread(() -&gt; &#123; while (true) &#123; consumeData(); &#125; &#125;).start(); &#125; public static void produceData() &#123; try &#123; while (!consumed) &#123; condition.await(); &#125; TimeUnit.SECONDS.sleep(1); data++; System.out.println(Thread.currentThread().getName() + " produce data = " + data); consumed = false; condition.signal(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; public static void consumeData() &#123; try &#123; while (consumed) &#123; condition.await(); &#125; TimeUnit.MICROSECONDS.sleep(500); System.out.println(Thread.currentThread().getName() + " consume data = " + data); consumed = true; condition.signal(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;&#125;å¯ä»¥çœ‹åˆ°ï¼Œç¨‹åºæŠ›å‡ºIllegalMonitorStateExceptionå¼‚å¸¸ï¼Œæ‰€ä»¥Conditionå¿…é¡»é…åˆLockä½¿ç”¨ã€‚æ­£å¦‚å‰é¢è¯´çš„ï¼ŒConditionçš„åŠŸèƒ½ç±»ä¼¼äºŽObjectå¯¹è±¡çš„waitå’Œnotifyæ–¹æ³•ï¼Œä¸‹é¢æˆ‘ä»¬ä½¿ç”¨Objectå¯¹è±¡çš„waitå’Œnotifyæ–¹æ³•å®žçŽ°ä¸€ä¸ªç±»ä¼¼ä¸Šé¢ç”Ÿäº§æ¶ˆè´¹çš„åŠŸèƒ½ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061public class WaitNotifyExample &#123; private static int data = 0; private static volatile boolean used = false; private final static Object MONITOR = new Object(); public static void main(String[] args) &#123; new Thread(() -&gt; &#123; while (true) &#123; produceData(); &#125; &#125;, "thread1").start(); new Thread(() -&gt; &#123; while (true) &#123; consumeData(); &#125; &#125;, "thread2").start(); &#125; public static void produceData() &#123; synchronized (MONITOR) &#123; while (!used) &#123; try &#123; MONITOR.wait(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; data++; System.out.println(Thread.currentThread().getName() + " ç”Ÿäº§data = " + data); used = false; MONITOR.notifyAll(); &#125; &#125; public static void consumeData() &#123; synchronized (MONITOR) &#123; while (used) &#123; try &#123; MONITOR.wait(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(Thread.currentThread().getName() + " æ¶ˆè´¹data = " + data); used = true; MONITOR.notifyAll(); &#125; &#125;&#125;æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼šConditionè¿˜å¯ä»¥ç»‘å®šå¤šä¸ªæ¡ä»¶ï¼Œå¹¶å”¤é†’æŒ‡å®šçš„çº¿ç¨‹ï¼Œä¸¾ä¸ªä¸‰ä¸ªçº¿ç¨‹å¾ªçŽ¯å¹²æ´»çš„ä¾‹å­ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465public class Loop &#123; private volatile String value = "a"; private Lock lock = new ReentrantLock(); // æ¡ä»¶1 private Condition condition1 = lock.newCondition(); // æ¡ä»¶2 private Condition condition2 = lock.newCondition(); // æ¡ä»¶3 private Condition condition3 = lock.newCondition(); public void printA() &#123; try &#123; lock.lock(); while (!value.equals("a")) &#123; condition1.await(); &#125; System.out.println(Thread.currentThread().getName() + " print a"); value = "b"; condition2.signal(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125; public void printB() &#123; try &#123; lock.lock(); while (!value.equals("b")) &#123; condition2.await(); &#125; System.out.println(Thread.currentThread().getName() + " print b"); value = "c"; condition3.signal(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125; public void printC() &#123; try &#123; lock.lock(); while (!value.equals("c")) &#123; condition3.await(); &#125; System.out.println(Thread.currentThread().getName() + " print c"); value = "a"; condition1.signal(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125; public static void main(String[] args) &#123; Loop loop = new Loop(); IntStream.rangeClosed(0, 2).forEach(i -&gt; new Thread(loop::printA, "çº¿ç¨‹A").start()); IntStream.rangeClosed(0, 2).forEach(i -&gt; new Thread(loop::printB, "çº¿ç¨‹B").start()); IntStream.rangeClosed(0, 2).forEach(i -&gt; new Thread(loop::printC, "çº¿ç¨‹C").start()); &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š123456789çº¿ç¨‹A print açº¿ç¨‹B print bçº¿ç¨‹C print cçº¿ç¨‹A print açº¿ç¨‹B print bçº¿ç¨‹C print cçº¿ç¨‹A print açº¿ç¨‹B print bçº¿ç¨‹C print csynchronizedå’ŒLockåŒºåˆ«synchronizedå’ŒLockéƒ½æ˜¯ç”¨äºŽæŽ§åˆ¶å¤šä¸ªçº¿ç¨‹è®¿é—®å…±äº«èµ„æºçš„æ–¹å¼ï¼Œä½†ä»–ä»¬è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼Œä¸»è¦å¯ä»¥ä»Žä¸‹é¢å‡ ä¸ªæ–¹é¢æ¯”è¾ƒï¼š1.æž„æˆä¸ä¸€æ ·synchronizedæ˜¯Javaå…³é”®å­—ï¼Œå±žäºŽJVMå±‚é¢ï¼Œåº•å±‚æ˜¯ç”±monitorenterå’ŒmonitorexitæŒ‡ä»¤å®Œæˆï¼ˆæŸ¥çœ‹å­—èŠ‚ç è¯å®žï¼‰ï¼šè€ŒLockæ˜¯JUCä¸‹çš„JavaæŽ¥å£ç±»ï¼Œæ˜¯APIå±‚é¢çš„ðŸ”ã€‚2.ä½¿ç”¨æ–¹å¼ä¸åŒsynchronizedä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œå½“synchronizedä»£ç æ‰§è¡Œå®ŒåŽï¼Œå½“å‰çº¿ç¨‹ä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼›ReentrantLockéœ€è¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œä¸ç„¶ä¼šé€ æˆæ­»é”ã€‚3.å¯ä¸­æ–­æ€§synchronizedæ˜¯ä¸å¯ä¸­æ–­çš„ï¼Œé™¤éžåŒæ­¥æ–¹æ³•å†…æŠ›å‡ºå¼‚å¸¸æˆ–è€…ç¨‹åºæ­£å¸¸è¿è¡Œå®Œæˆï¼› ReentrantLockæ˜¯å¯ä»¥ä¸­æ–­çš„ï¼Œæ¯”å¦‚lockInterruptibly()æ–¹æ³•ã€‚4.å…¬å¹³å¦synchronizedæ˜¯éžå…¬å¹³é”ï¼›ReentrantLockå¯ä»¥é€šè¿‡æž„é€ æ–¹æ³•ReentrantLock(boolean fair)è®¾ç½®å…¬å¹³ä¸Žå¦ã€‚5.çµæ´»æ€§synchronizedä¸å¯ä»¥è®¾ç½®æ¡ä»¶ï¼›ReentrantLockå¯ä»¥é€šè¿‡conditionç»‘å®šå¤šæ¡ä»¶ï¼Œç²¾ç¡®å”¤é†’æŒ‡å®šçº¿ç¨‹ã€‚]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ThreadLocalä½¿ç”¨å­¦ä¹ ]]></title>
    <url>%2FThreadLocal.html</url>
    <content type="text"><![CDATA[ThreadLocalå­—é¢ä¸Šçš„æ„æ€æ˜¯å±€éƒ¨çº¿ç¨‹å˜é‡ï¼Œæ¯ä¸ªçº¿ç¨‹é€šè¿‡ThreadLocalçš„getå’Œsetæ–¹æ³•æ¥è®¿é—®å’Œä¿®æ”¹çº¿ç¨‹è‡ªå·±ç‹¬æœ‰çš„å˜é‡ã€‚ç®€å•åœ°è¯´ï¼ŒThreadLocalçš„ä½œç”¨å°±æ˜¯ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹æä¾›äº†ä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜è‡ªå·±çš„å‰¯æœ¬ï¼Œè€Œä¸ä¼šå½±å“å…¶å®ƒçº¿ç¨‹æ‰€å¯¹åº”çš„å‰¯æœ¬ã€‚ThreadLocalçš„åŸºæœ¬ä½¿ç”¨ThreadLocalæ˜¯ä¸€ä¸ªæ³›åž‹ç±»ï¼Œåœ¨åˆ›å»ºçš„æ—¶å€™éœ€è¦æŒ‡å®šå˜é‡çš„ç±»åž‹ï¼š1private static ThreadLocal&lt;String&gt; threadLocal = new ThreadLocal&lt;&gt;();ThreadLocalæä¾›äº†setæ–¹æ³•æ¥è®¾ç½®å˜é‡çš„å€¼ï¼Œgetæ–¹æ³•èŽ·å–å˜é‡çš„å€¼ï¼Œremoveæ–¹æ³•ç§»é™¤å˜é‡ï¼š1234567891011public class ThreadLocalTest &#123; private static ThreadLocal&lt;String&gt; threadLocal = new ThreadLocal&lt;&gt;(); public static void main(String[] args) throws InterruptedException &#123; threadLocal.set("mrbird"); System.out.println(threadLocal.get()); threadLocal.remove(); System.out.println(threadLocal.get()); &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™ThreadLocalè®¾ç½®åˆå§‹å€¼ï¼Œè®¾ç½®åˆå§‹å€¼æœ‰ä¸¤ç§æ–¹å¼ï¼šé‡å†™initialValueæ–¹æ³•ï¼š1234567891011public class ThreadLocalTest &#123; private static ThreadLocal&lt;String&gt; threadLocal = new ThreadLocal&lt;String&gt;()&#123; @Override protected String initialValue() &#123; return "åˆå§‹å€¼"; &#125; &#125;; public static void main(String[] args) throws InterruptedException &#123; System.out.println(threadLocal.get()); // åˆå§‹å€¼ &#125;&#125;ä½¿ç”¨ThreadLocalçš„withInitialæ–¹æ³•ï¼š123456public class ThreadLocalTest &#123; private static ThreadLocal&lt;String&gt; threadLocal = ThreadLocal.withInitial(() -&gt; "åˆå§‹å€¼"); public static void main(String[] args) throws InterruptedException &#123; System.out.println(threadLocal.get()); // åˆå§‹å€¼ &#125;&#125;å€¼å¾—æ³¨æ„çš„æ˜¯removeæ— æ³•ç§»é™¤åˆå§‹å€¼ï¼š1234567public class ThreadLocalTest &#123; private static ThreadLocal&lt;String&gt; threadLocal = ThreadLocal.withInitial(() -&gt; "åˆå§‹å€¼"); public static void main(String[] args) throws InterruptedException &#123; threadLocal.remove(); System.out.println(threadLocal.get()); // åˆå§‹å€¼ &#125;&#125;æ¼”ç¤ºå¤šçº¿ç¨‹é—´ç‹¬ç«‹åœ¨å¤šä¸ªçº¿ç¨‹ä¸­ä½¿ç”¨ThreadLocalï¼š12345678910111213141516171819202122232425262728293031323334public class ThreadLocalTest2 &#123; private static ThreadLocal&lt;String&gt; threadLocal = new ThreadLocal&lt;&gt;(); private static Random random = new Random(System.currentTimeMillis()); public static void main(String[] args) throws InterruptedException &#123; Thread thread1 = new Thread(() -&gt; &#123; threadLocal.set("thread t1"); try &#123; TimeUnit.MICROSECONDS.sleep(random.nextInt(1000)); System.out.println(Thread.currentThread().getName() + " " + threadLocal.get()); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;, "thread1"); Thread thread2 = new Thread(() -&gt; &#123; threadLocal.set("thread t2"); try &#123; TimeUnit.MICROSECONDS.sleep(random.nextInt(1000)); System.out.println(Thread.currentThread().getName() + " " + threadLocal.get()); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;, "thread2"); thread1.start(); thread2.start(); thread1.join(); thread2.join(); System.out.println(Thread.currentThread().getName() + " " + threadLocal.get()); &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼šç»“æžœè¯æ˜Žäº†ThreadLocalåœ¨æ¯ä¸ªçº¿ç¨‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼ŒthreadLocalåœ¨thread1ã€thread2å’Œmainçº¿ç¨‹é—´éƒ½æœ‰ä¸€ä»½ç‹¬ç«‹æ‹·è´ã€‚ThreadLocalåŸºæœ¬åŽŸç†åœ¨ThreadLocalç±»ä¸­æœ‰ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ThreadLocalMap(æ¦‚å¿µä¸Šç±»ä¼¼äºŽMap)ï¼Œç”¨é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨æ¯ä¸€ä¸ªçº¿ç¨‹çš„å˜é‡å‰¯æœ¬ï¼ŒThreadLocalMapä¸­å…ƒç´ çš„keyä¸ºå½“å‰ThreadLocalå¯¹è±¡ï¼Œè€Œvalueå¯¹åº”çº¿ç¨‹çš„å˜é‡å‰¯æœ¬ã€‚æˆ‘ä»¬ä½¿ç”¨Mapæ¥ä»£æ›¿ThreadLocalMapï¼Œåˆ›å»ºä¸€ä¸ªç®€æ˜“çš„ç±»ThreadLocalå®žçŽ°ï¼š123456789101112131415161718192021222324252627public class MyThreadLocal&lt;T&gt; &#123; private final Map&lt;Thread, T&gt; threadLocalMap = new HashMap&lt;&gt;(); public void set(T t) &#123; synchronized (this) &#123; Thread key = Thread.currentThread(); threadLocalMap.put(key, t); &#125; &#125; public T get() &#123; synchronized (this) &#123; Thread key = Thread.currentThread(); T t = threadLocalMap.get(key); if (t == null) &#123; return initalValue(); &#125; else &#123; return t; &#125; &#125; &#125; public T initalValue() &#123; return null; &#125;&#125;ä½¿ç”¨æ–¹å¼å’Œä¹‹å‰çš„ä¾‹å­ä¸€è‡´ï¼š123456789101112131415161718192021222324252627282930313233343536373839public class ThreadLocalTest3 &#123; private static MyThreadLocal&lt;String&gt; threadLocal = new MyThreadLocal&lt;String&gt;() &#123; @Override public String initalValue() &#123; return "initalValue"; &#125; &#125;; private static Random random = new Random(System.currentTimeMillis()); public static void main(String[] args) throws InterruptedException &#123; Thread thread1 = new Thread(() -&gt; &#123; threadLocal.set("thread t1"); try &#123; TimeUnit.MICROSECONDS.sleep(random.nextInt(1000)); System.out.println(Thread.currentThread().getName() + " " + threadLocal.get()); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;, "thread1"); Thread thread2 = new Thread(() -&gt; &#123; threadLocal.set("thread t2"); try &#123; TimeUnit.MICROSECONDS.sleep(random.nextInt(1000)); System.out.println(Thread.currentThread().getName() + " " + threadLocal.get()); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;, "thread2"); thread1.start(); thread2.start(); thread1.join(); thread2.join(); System.out.println(Thread.currentThread().getName() + " " + threadLocal.get()); &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼šä½¿ç”¨å»ºè®®å°†ThreadLocalå˜é‡æŒ‡å®šä¸ºprivate staticï¼›ä½¿ç”¨å®Œæ¯•åŽæ˜¾å¼åœ°è°ƒç”¨removeæ–¹æ³•ç§»é™¤ã€‚]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥å­¦ä¹ CAS]]></title>
    <url>%2FCAS.html</url>
    <content type="text"><![CDATA[åœ¨æ·±å…¥ç†è§£volatileå…³é”®å­—ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æåˆ°volatileå¹¶ä¸èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨æ€§ï¼Œè¦è§£å†³æ–‡ç« ä¸­æåˆ°çš„ç´¯åŠ ä¾‹å­çº¿ç¨‹å®‰å…¨é—®é¢˜çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨åŒæ­¥é”ï¼ˆsynchronizedï¼‰å’ŒAtomicç±»åž‹ã€‚ä½†å°±é‚£ä¸ªä¾‹å­æ¥è¯´ï¼Œä½¿ç”¨synchronizedåŒæ­¥é”æœ‰ç‚¹å°é¢˜å¤§ä½œï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ›´ä¸ºè½»é‡çš„AtomicIntegeræ¥è§£å†³ã€‚å°†å‰é¢çš„ä¾‹å­æ”¹å†™ä¸ºï¼š1234567891011121314public class AtomticIntegerTest &#123; private static AtomicInteger value = new AtomicInteger(0); public static void main(String[] args) throws InterruptedException &#123; Thread thread1 = new Thread(() -&gt; IntStream.range(0, 500).forEach(i -&gt; value.getAndIncrement())); Thread thread2 = new Thread(() -&gt; IntStream.range(0, 500).forEach(i -&gt; value.getAndIncrement())); thread1.start(); thread2.start(); thread1.join(); thread2.join(); System.out.println(value); &#125;&#125;æˆ‘ä»¬å°†valueç±»åž‹ä»Žvolatileä¿®é¥°çš„intç±»åž‹æ”¹ä¸ºAtomicIntegerç±»åž‹ï¼Œè¿™ä¸ªä¾‹å­æ— è®ºè¿è¡Œå¤šå°‘æ¬¡ï¼Œç»“æžœéƒ½æ˜¯æˆ‘ä»¬æœŸæœ›çš„1000ï¼šAtomicç±»åž‹å†…éƒ¨å¹¶æ²¡æœ‰é€šè¿‡é”æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œé‚£ä¹ˆå®ƒä»¬æ˜¯å¦‚ä½•å®žçŽ°çš„å‘¢ï¼Ÿè¿™å°±æ˜¯æœ¬èŠ‚è¦è®¨è®ºçš„CASã€‚ä»€ä¹ˆæ˜¯CASCASæ˜¯Compare-And-Swapçš„ç¼©å†™ï¼Œæ„æ€ä¸ºæ¯”è¾ƒå¹¶äº¤æ¢ã€‚ä»¥AtomicIntegerä¸ºä¾‹ï¼Œå…¶æä¾›äº†compareAndSet(int expect, int update)æ–¹æ³•ï¼Œexpectä¸ºæœŸæœ›å€¼ï¼ˆè¢«ä¿®æ”¹çš„å€¼åœ¨ä¸»å†…å­˜ä¸­çš„æœŸæœ›å€¼ï¼‰ï¼Œupdateä¸ºä¿®æ”¹åŽçš„å€¼ã€‚compareAndSetæ–¹æ³•è¿”å›žå€¼ç±»åž‹ä¸ºå¸ƒå°”ç±»åž‹ï¼Œä¿®æ”¹æˆåŠŸåˆ™è¿”å›žtrueï¼Œä¿®æ”¹å¤±è´¥è¿”å›žfalseã€‚ä¸¾ä¸ªcompareAndSetæ–¹æ³•çš„ä¾‹å­ï¼š123456789public class AtomticIntegerTest &#123; public static void main(String[] args) &#123; AtomicInteger atomicInteger = new AtomicInteger(0); boolean result = atomicInteger.compareAndSet(0, 1); System.out.println(result); System.out.println(atomicInteger.get()); &#125;&#125;ä¸Šé¢ä¾‹å­ä¸­ï¼Œé€šè¿‡AtomicInteger(int initialValue)æž„é€ æ–¹æ³•æŒ‡å®šäº†AtomicIntegerç±»æˆå‘˜å˜é‡valueçš„åˆå§‹å€¼ä¸º0ï¼š123456789101112131415public class AtomicInteger extends Number implements java.io.Serializable &#123; ...... private volatile int value; /** * Creates a new AtomicInteger with the given initial value. * * @param initialValue the initial value */ public AtomicInteger(int initialValue) &#123; value = initialValue; &#125; ......&#125;æŽ¥ç€æ‰§è¡ŒcompareAndSetæ–¹æ³•ï¼Œmainçº¿ç¨‹ä»Žä¸»å†…å­˜ä¸­æ‹·è´äº†valueçš„å‰¯æœ¬åˆ°å·¥ä½œçº¿ç¨‹ï¼Œå€¼ä¸º0ï¼Œå¹¶å°†è¿™ä¸ªå€¼ä¿®æ”¹ä¸º1ã€‚å¦‚æžœæ­¤æ—¶ä¸»å†…å­˜ä¸­valueçš„å€¼è¿˜æ˜¯ä¸º0çš„è¯ï¼ˆè¨€å¤–ä¹‹æ„å°±æ˜¯æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹è¿‡ï¼‰ï¼Œåˆ™å°†ä¿®æ”¹åŽçš„å‰¯æœ¬å€¼åˆ·å›žä¸»å†…å­˜æ›´æ–°valueçš„å€¼ã€‚æ‰€ä»¥ä¸Šé¢çš„ä¾‹å­è¿è¡Œç»“æžœåº”è¯¥æ˜¯trueå’Œ1ï¼šå°†ä¸Šé¢çš„ä¾‹å­ä¿®æ”¹ä¸ºï¼š1234567891011public class AtomticIntegerTest &#123; public static void main(String[] args) &#123; AtomicInteger atomicInteger = new AtomicInteger(0); boolean firstResult = atomicInteger.compareAndSet(0, 1); boolean secondResult = atomicInteger.compareAndSet(0, 1); System.out.println(firstResult); System.out.println(secondResult); System.out.println(atomicInteger.get()); &#125;&#125;ä¸Šé¢ä¾‹å­ä¸­ï¼Œmainçº¿ç¨‹ç¬¬äºŒæ¬¡è°ƒç”¨compareAndSetæ–¹æ³•çš„æ—¶å€™ï¼Œvalueçš„å€¼å·²ç»è¢«ä¿®æ”¹ä¸º1äº†ï¼Œä¸ç¬¦åˆå…¶expectçš„å€¼ï¼Œæ‰€ä»¥ä¿®æ”¹å°†å¤±è´¥ã€‚ä¸Šé¢ä¾‹å­è¾“å‡ºå¦‚ä¸‹ï¼šCASåº•å±‚åŽŸç†æŸ¥çœ‹compareAndSetæ–¹æ³•æºç ï¼šè¯¥æ–¹æ³•é€šè¿‡è°ƒç”¨unsafeç±»çš„compareAndSwapIntæ–¹æ³•å®žçŽ°ç›¸å…³åŠŸèƒ½ã€‚compareAndSwapIntæ–¹æ³•åŒ…å«å››ä¸ªå‚æ•°ï¼šthisï¼Œå½“å‰å¯¹è±¡ï¼›valueOffsetï¼Œvalueæˆå‘˜å˜é‡çš„å†…å­˜åç§»é‡ï¼ˆä¹Ÿå°±æ˜¯å†…å­˜åœ°å€ï¼‰ï¼š12345678private static final long valueOffset;static &#123; try &#123; valueOffset = unsafe.objectFieldOffset (AtomicInteger.class.getDeclaredField("value")); &#125; catch (Exception ex) &#123; throw new Error(ex); &#125;&#125;expectï¼ŒæœŸå¾…å€¼ï¼›updateï¼Œæ›´æ–°å€¼ã€‚æ‰€ä»¥è¿™ä¸ªæ–¹æ³•çš„å«ä¹‰ä¸ºï¼šèŽ·å–å½“å‰å¯¹è±¡valueæˆå‘˜å˜é‡åœ¨ä¸»å†…å­˜ä¸­çš„å€¼ï¼Œå’Œä¼ å…¥çš„æœŸå¾…å€¼ç›¸æ¯”ï¼Œå¦‚æžœç›¸ç­‰åˆ™è¯´æ˜Žè¿™ä¸ªå€¼æ²¡æœ‰è¢«åˆ«çš„çº¿ç¨‹ä¿®æ”¹è¿‡ï¼Œç„¶åŽå°†å…¶ä¿®æ”¹ä¸ºæ›´æ–°å€¼ã€‚é‚£ä¹ˆunsafeåˆæ˜¯ä»€ä¹ˆï¼Ÿå®ƒçš„compareAndSwapIntæ–¹æ³•æ˜¯åŽŸå­æ€§çš„ä¹ˆï¼ŸæŸ¥çœ‹è¯¥æ–¹æ³•çš„æºç ï¼šè¯¥æ–¹æ³•å¹¶æ²¡æœ‰å…·ä½“Javaä»£ç å®žçŽ°ï¼Œæ–¹æ³•é€šè¿‡nativeå…³é”®å­—ä¿®é¥°ã€‚ç”±äºŽJavaæ–¹æ³•æ— æ³•ç›´æŽ¥è®¿é—®åº•å±‚ç³»ç»Ÿï¼ŒUnsafeç±»ç›¸å½“äºŽä¸€ä¸ªåŽé—¨ï¼Œå¯ä»¥é€šè¿‡è¯¥ç±»çš„æ–¹æ³•ç›´æŽ¥æ“ä½œç‰¹å®šå†…å­˜çš„æ•°æ®ã€‚Unsafeç±»å­˜åœ¨äºŽsun.msicåŒ…ä¸­ï¼ŒJVMä¼šå¸®æˆ‘ä»¬å®žçŽ°å‡ºç›¸åº”çš„æ±‡ç¼–æŒ‡ä»¤ã€‚Unsafeç±»ä¸­çš„CASæ–¹æ³•æ˜¯ä¸€æ¡CPUå¹¶å‘åŽŸè¯­ï¼Œç”±è‹¥å¹²æ¡æŒ‡ä»¤ç»„æˆï¼Œç”¨äºŽå®ŒæˆæŸä¸ªåŠŸèƒ½çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚åŽŸè¯­çš„æ‰§è¡Œå¿…é¡»æ˜¯è¿žç»­çš„ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸å…è®¸è¢«ä¸­æ–­ï¼Œä¸ä¼šå­˜åœ¨æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚getAndIncrementæ–¹æ³•å‰–æžäº†è§£äº†CASåŽŸç†åŽï¼Œæˆ‘ä»¬å›žå¤´çœ‹ä¸‹AtomicIntegerçš„getAndIncrementæ–¹æ³•æºç ï¼šè¯¥æ–¹æ³•é€šè¿‡è°ƒç”¨unsafeç±»çš„compareAndSwapIntæ–¹æ³•å®žçŽ°ç›¸å…³åŠŸèƒ½ã€‚ç»§ç»­æŸ¥çœ‹compareAndSwapIntæ–¹æ³•çš„æºç ï¼šç»“åˆè¿™ä¸¤å¼ å›¾ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥å¾ˆç›´è§‚åœ°çœ‹å‡ºä¸ºä»€ä¹ˆAtomicIntegerçš„getAndIncrementæ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„äº†ï¼šä¸Šå›¾ä¸­ï¼Œvar1æ˜¯AtomicIntegerå¯¹è±¡æœ¬èº«ï¼›var2æ˜¯AtomicIntegerå¯¹è±¡çš„æˆå‘˜å˜é‡valueçš„å†…å­˜åœ°å€ï¼›var4æ˜¯éœ€è¦å˜æ›´çš„æ•°é‡ï¼›var5æ˜¯é€šè¿‡unsafeçš„getIntVolatileæ–¹æ³•èŽ·å¾—AtomicIntegerå¯¹è±¡çš„æˆå‘˜å˜é‡valueåœ¨ä¸»å†…å­˜ä¸­çš„å€¼ã€‚do whileå¾ªçŽ¯ä¸­çš„é€»è¾‘ä¸ºï¼šç”¨å½“å‰å¯¹è±¡çš„å€¼å’Œvar5æ¯”è¾ƒï¼Œå¦‚æžœç›¸åŒï¼Œè¯´æ˜Žè¯¥å€¼æ²¡æœ‰è¢«åˆ«çš„çº¿ç¨‹ä¿®æ”¹è¿‡ï¼Œæ›´æ–°ä¸ºvar5+var4ï¼Œå¹¶è¿”å›žtrueï¼ˆCASï¼‰ï¼›å¦åˆ™ç»§ç»­èŽ·å–å€¼å¹¶æ¯”è¾ƒï¼Œç›´åˆ°æ›´æ–°å®Œæˆã€‚CASçš„ç¼ºç‚¹CASå¹¶ä¸æ˜¯å®Œç¾Žçš„ï¼Œå…¶å­˜åœ¨ä»¥ä¸‹è¿™äº›ç¼ºç‚¹ï¼šå¦‚æžœåˆšå¥½whileé‡Œçš„CASæ“ä½œä¸€ç›´ä¸æˆåŠŸï¼Œé‚£ä¹ˆå¯¹CPUçš„å¼€é”€å¤§ï¼›åªèƒ½ç¡®ä¿ä¸€ä¸ªå…±äº«å˜é‡çš„åŽŸå­æ“ä½œï¼›å­˜åœ¨ABAé—®é¢˜ã€‚CASå®žçŽ°çš„ä¸€ä¸ªé‡è¦å‰ææ˜¯éœ€è¦å–å‡ºæŸä¸€æ—¶åˆ»çš„æ•°æ®å¹¶åœ¨å½“ä¸‹æ—¶åˆ»æ¯”è¾ƒäº¤æ¢ï¼Œè¿™ä¹‹é—´çš„æ—¶é—´å·®ä¼šå¯¼è‡´æ•°æ®çš„å˜åŒ–ã€‚æ¯”å¦‚ï¼šthread1çº¿ç¨‹ä»Žä¸»å†…å­˜ä¸­å–å‡ºäº†å˜é‡açš„å€¼ä¸ºAï¼Œthread2é¡µä»Žä¸»å†…å­˜ä¸­å–å‡ºäº†å˜é‡açš„å€¼ä¸ºAã€‚ç”±äºŽçº¿ç¨‹è°ƒåº¦çš„ä¸ç¡®å®šæ€§ï¼Œè¿™æ—¶å€™thread1å¯èƒ½è¢«çŸ­æš‚æŒ‚èµ·äº†ï¼Œthread2è¿›è¡Œäº†ä¸€äº›æ“ä½œå°†å€¼ä¿®æ”¹ä¸ºäº†Bï¼Œç„¶åŽåˆè¿›è¡Œäº†ä¸€äº›æ“ä½œå°†å€¼ä¿®æ”¹å›žäº†Aï¼Œè¿™æ—¶å€™å½“thread1é‡æ–°èŽ·å–CPUæ—¶é—´ç‰‡é‡æ–°æ‰§è¡ŒCASæ“ä½œæ—¶ï¼Œä¼šå‘çŽ°å˜é‡aåœ¨ä¸»å†…å­˜ä¸­çš„å€¼ä»»ç„¶æ˜¯Aï¼Œæ‰€ä»¥CASæ“ä½œæˆåŠŸã€‚è§£å†³ABAé—®é¢˜é‚£ä¹ˆå¦‚ä½•è§£å†³CASçš„ABAé—®é¢˜å‘¢ï¼Ÿç”±ä¸Šé¢çš„é˜è¿°è¯¾ä»¶ï¼Œå…‰é€šè¿‡åˆ¤æ–­å€¼æ˜¯å¦ç›¸ç­‰å¹¶ä¸èƒ½ç¡®ä¿åœ¨ä¸€å®šæ—¶é—´å·®å†…å€¼æ²¡æœ‰å˜æ›´è¿‡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªé¢å¤–çš„æŒ‡æ ‡æ¥è¾…åŠ©åˆ¤æ–­ï¼Œç±»ä¼¼äºŽæ—¶é—´æˆ³ï¼Œç‰ˆæœ¬å·ç­‰ã€‚JUCä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªAtomicStampedReferenceç±»ï¼Œé€šè¿‡æŸ¥çœ‹å®ƒçš„æž„é€ æ–¹æ³•å°±å¯ä»¥çœ‹å‡ºï¼Œé™¤äº†æŒ‡å®šåˆå§‹å€¼å¤–ï¼Œè¿˜éœ€æŒ‡å®šä¸€ä¸ªç‰ˆæœ¬å·ï¼ˆæˆ³ï¼‰ï¼šæˆ‘ä»¬å°±ç”¨è¿™ä¸ªç±»æ¥è§£å†³ABAé—®é¢˜ï¼Œé¦–å…ˆæ¨¡æ‹Ÿä¸€ä¸ªABAé—®é¢˜åœºæ™¯ï¼š1234567891011121314151617181920212223242526public class AtomticIntegerTest &#123; public static void main(String[] args) &#123; AtomicReference&lt;String&gt; atomicReference = new AtomicReference&lt;&gt;("A"); new Thread(() -&gt; &#123; // æ¨¡æ‹Ÿä¸€æ¬¡ABAæ“ä½œ atomicReference.compareAndSet("A", "B"); atomicReference.compareAndSet("B", "A"); System.out.println(Thread.currentThread().getName() + "çº¿ç¨‹å®Œæˆäº†ä¸€æ¬¡ABAæ“ä½œ"); &#125;, "thread1").start(); new Thread(() -&gt; &#123; // è®©thread2å…ˆç¡çœ 2ç§’é’Ÿï¼Œç¡®ä¿thread1çš„ABAæ“ä½œå®Œæˆ try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; boolean result = atomicReference.compareAndSet("A", "B"); if (result) &#123; System.out.println(Thread.currentThread().getName() + "çº¿ç¨‹ä¿®æ”¹å€¼æˆåŠŸï¼Œå½“å‰å€¼ä¸ºï¼š" + atomicReference.get()); &#125; &#125;, "thread2").start(); &#125;&#125;è¿è¡Œç¨‹åºï¼Œè¾“å‡ºå¦‚ä¸‹ï¼šä½¿ç”¨AtomicStampedReferenceè§£å†³ABAé—®é¢˜ï¼š123456789101112131415161718192021222324252627282930313233343536373839public class AtomticIntegerTest &#123; public static void main(String[] args) &#123; // åˆå§‹å€¼ä¸ºAï¼Œç‰ˆæœ¬å·ä¸º1 AtomicStampedReference&lt;String&gt; reference = new AtomicStampedReference&lt;&gt;("A", 1); new Thread(() -&gt; &#123; int stamp = reference.getStamp(); System.out.println(Thread.currentThread().getName() + "å½“å‰ç‰ˆæœ¬å·ä¸ºï¼š" + stamp); // ä¼‘çœ 1ç§’ï¼Œè®©thread2ä¹Ÿæ‹¿åˆ°åˆå§‹çš„ç‰ˆæœ¬å· try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; // æ¨¡æ‹Ÿä¸€æ¬¡ABAæ“ä½œ reference.compareAndSet("A", "B", reference.getStamp(), reference.getStamp() + 1); reference.compareAndSet("B", "A", reference.getStamp(), reference.getStamp() + 1); System.out.println(Thread.currentThread().getName() + "çº¿ç¨‹å®Œæˆäº†ä¸€æ¬¡ABAæ“ä½œ"); &#125;, "thread1").start(); new Thread(() -&gt; &#123; int stamp = reference.getStamp(); System.out.println(Thread.currentThread().getName() + "å½“å‰ç‰ˆæœ¬å·ä¸ºï¼š" + stamp); // è®©thread2å…ˆç¡çœ 2ç§’é’Ÿï¼Œç¡®ä¿thread1çš„ABAæ“ä½œå®Œæˆ try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; boolean result = reference.compareAndSet("A", "B", stamp, stamp + 1); if (result) &#123; System.out.println(Thread.currentThread().getName() + "çº¿ç¨‹ä¿®æ”¹å€¼æˆåŠŸï¼Œå½“å‰å€¼ä¸ºï¼š" + reference.getReference()); &#125; else &#123; System.out.println(Thread.currentThread().getName() + "çº¿ç¨‹ä¿®æ”¹å€¼å¤±è´¥ï¼Œå½“å‰å€¼ä¸ºï¼š" + reference.getReference() + "ï¼Œç‰ˆæœ¬å·ä¸ºï¼š" + reference.getStamp()); &#125; &#125;, "thread2").start(); &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JUCä¹‹Semaphore]]></title>
    <url>%2FJUC-Semaphore.html</url>
    <content type="text"><![CDATA[JUCçš„Semaphoreä¿—ç§°ä¿¡å·é‡ï¼Œå¯ç”¨æ¥æŽ§åˆ¶åŒæ—¶è®¿é—®ç‰¹å®šèµ„æºçš„çº¿ç¨‹æ•°é‡ã€‚é€šè¿‡å®ƒçš„æž„é€ å‡½æ•°æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¿¡å·é‡ï¼ˆç§°ä¸ºè®¸å¯è¯permitså¯èƒ½æ›´ä¸ºæ˜Žç¡®ï¼‰çš„æ•°é‡ï¼Œçº¿ç¨‹å¯ä»¥è°ƒç”¨Semaphoreå¯¹è±¡çš„acquireæ–¹æ³•èŽ·å–ä¸€ä¸ªè®¸å¯è¯ï¼Œè°ƒç”¨releaseæ¥å½’è¿˜ä¸€ä¸ªè®¸å¯è¯ã€‚ä¸‹é¢ä¸¾ä¸ªSemaphoreçš„åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹ã€‚Semaphoreç¤ºä¾‹123456789101112131415161718192021222324public class SemaphoreTest &#123; public static void main(String[] args) throws InterruptedException &#123; // å®šä¹‰è®¸å¯è¯æ•°é‡ final Semaphore semaphore = new Semaphore(2); IntStream.range(0, 4).forEach(i -&gt; &#123; new Thread(() -&gt; &#123; System.out.println(Thread.currentThread().getName() + "å¼€å§‹"); try &#123; semaphore.acquire(); // ä¸€æ¬¡æ‹¿ä¸€ä¸ªè®¸å¯è¯ System.out.println(Thread.currentThread().getName() + "èŽ·å–è®¸å¯è¯"); TimeUnit.SECONDS.sleep(3); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; System.out.println(Thread.currentThread().getName() + "é‡Šæ”¾è®¸å¯è¯"); semaphore.release(); &#125; System.out.println(Thread.currentThread().getName() + "ç»“æŸ"); &#125;, "thread" + (i + 1)).start(); &#125;); &#125;&#125;ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰è®¸å¯è¯çš„æ•°é‡ä¸º2ä¸ªï¼Œç„¶åŽ4ä¸ªçº¿ç¨‹é€šè¿‡acquireæ–¹æ³•åŽ»èŽ·å–è®¸å¯è¯ï¼Œç»“æŸè¡Œé€šè¿‡releaseæ–¹æ³•é‡Šæ”¾è®¸å¯è¯ã€‚acquireæ–¹æ³•é»˜è®¤ä¸€æ¬¡åªæ‹¿ä¸€ä¸ªè®¸å¯è¯ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒåŒä¸€æ—¶åˆ»æœ€å¤šåªæœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œã€‚ç¨‹åºè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š acquireçš„é‡è½½æ–¹æ³•acquire(int permits)å…è®¸çº¿ç¨‹ä¸€æ¬¡æ€§èŽ·å–Nä¸ªè®¸å¯è¯ï¼›åŒæ ·çš„releaseçš„é‡è½½æ–¹æ³•release(int permits)å…è®¸çº¿ç¨‹ä¸€æ¬¡æ€§é‡Šæ”¾Nä¸ªè®¸å¯è¯ã€‚Semaphoreè¿˜æœ‰ä¸€ä¸ªtryAcquireï¼Œå®ƒå…è®¸çº¿ç¨‹å°è¯•åŽ»èŽ·å–1ä¸ªè®¸å¯è¯ï¼Œå¦‚æžœè®¸å¯è¯ä¸è¶³æ²¡æœ‰èŽ·å–åˆ°çš„è¯ï¼Œçº¿ç¨‹ä¹Ÿä¼šç»§ç»­æ‰§è¡Œï¼Œè€Œéžé˜»å¡žç­‰å¾…ã€‚tryAcquireæ–¹æ³•çš„é‡è½½æ–¹æ³•tryAcquire(long timeout, TimeUnit unit)å¯ä»¥æŒ‡å®šå°è¯•èŽ·å–è®¸å¯è¯çš„è¶…æ—¶æ—¶é—´ã€‚acquireUninterruptiblyä»Žä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¼šå‘çŽ°acquireæ–¹æ³•ä¼šæŠ›å‡ºInterruptedExceptionå¼‚å¸¸ï¼Œè¯´æ˜Žè¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥è¢«æ‰“æ–­çš„ï¼š123456789101112131415161718public class SemaphoreTest &#123; public static void main(String[] args) throws InterruptedException &#123; final Semaphore semaphore = new Semaphore(1); Thread thread1 = new Thread(() -&gt; &#123; try &#123; semaphore.acquire(2); &#125; catch (InterruptedException e) &#123; System.err.println("semaphore InterruptedException"); e.printStackTrace(); &#125; &#125;); thread1.start(); TimeUnit.MICROSECONDS.sleep(500); thread1.interrupt(); &#125;&#125;ä¸Šé¢ä¾‹å­thread1çº¿ç¨‹èŽ·å–2ä¸ªè®¸å¯è¯ï¼Œä½†è®¸å¯è¯æ€»æ•°åªæœ‰1ä¸ªï¼Œæ‰€ä»¥ä¼šé˜»å¡žç­‰å¾…ã€‚mainçº¿ç¨‹é€šè¿‡è°ƒç”¨thread1çš„interruptæ–¹æ³•åŽ»æ‰“æ–­thread1çº¿ç¨‹ï¼Œç»“æžœå¦‚ä¸‹ï¼šè€Œé€šè¿‡acquireUninterruptiblyæ–¹æ³•åŽ»èŽ·å–è®¸å¯è¯æ˜¯ä¸å¯è¢«æ‰“æ–­çš„ï¼š123456789101112public class SemaphoreTest &#123; public static void main(String[] args) throws InterruptedException &#123; final Semaphore semaphore = new Semaphore(1); Thread thread1 = new Thread(() -&gt; &#123; semaphore.acquireUninterruptibly(2); &#125;); thread1.start(); TimeUnit.MICROSECONDS.sleep(500); thread1.interrupt(); &#125;&#125;ä¸Šé¢ç¨‹åºå¹¶ä¸ä¼šæŠ›å‡ºInterruptedExceptionï¼Œthread1ä¼šä¸€ç›´å¤„äºŽé˜»å¡žçŠ¶æ€ã€‚drainPermitsdrainPermitsæ–¹æ³•ä¸€æ¬¡æ€§èŽ·å–æ‰€æœ‰è®¸å¯è¯ï¼ˆdrainæŠ½å¹²æ¦¨å¹²ðŸ˜®ï¼‰ï¼š12345678910111213141516171819public class SemaphoreTest &#123; public static void main(String[] args) throws InterruptedException &#123; final Semaphore semaphore = new Semaphore(5); new Thread(() -&gt; &#123; System.out.println("availablePermits: " + semaphore.availablePermits()); semaphore.drainPermits(); // èŽ·å–æ‰€æœ‰è®¸å¯è¯ï¼ŒæŠ½å¹² System.out.println("availablePermits: " + semaphore.availablePermits()); try &#123; TimeUnit.SECONDS.sleep(4); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; semaphore.release(5); System.out.println(Thread.currentThread().getName() + "ç»“æŸ"); &#125;, "thread1").start(); &#125;&#125;availablePermitsæ–¹æ³•ç”¨äºŽèŽ·å–å½“å‰å¯ç”¨è®¸å¯è¯æ•°é‡çš„é¢„ä¼°å€¼ã€‚ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼šåˆ«çš„APIhasQueuedThreadsæ–¹æ³•ç”¨äºŽåˆ¤æ–­æ˜¯å¦æœ‰å¤„äºŽç­‰å¾…èŽ·å–è®¸å¯è¯çŠ¶æ€çš„çº¿ç¨‹ï¼›getQueueLengthç”¨äºŽèŽ·å–å¤„äºŽç­‰å¾…èŽ·å–è®¸å¯è¯çŠ¶æ€çš„çº¿ç¨‹çš„æ•°é‡ï¼›getQueuedThreadsç”¨äºŽèŽ·å–å¤„äºŽç­‰å¾…èŽ·å–è®¸å¯è¯çŠ¶æ€çš„çº¿ç¨‹é›†åˆã€‚getQueuedThreadsæ˜¯protectedçš„ï¼Œæ‰€ä»¥è¦ä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬å¾—è‡ªå®šä¹‰ä¸€ä¸ªSemaphoreçš„å­ç±»ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849public class SemaphoreTest &#123; public static void main(String[] args) &#123; // å®šä¹‰è®¸å¯è¯æ•°é‡ final MySemaphore semaphore = new MySemaphore(1); IntStream.range(0, 4).forEach(i -&gt; &#123; new Thread(() -&gt; &#123; System.out.println(Thread.currentThread().getName() + "å¼€å§‹"); try &#123; semaphore.acquire(); System.out.println(Thread.currentThread().getName() + "èŽ·å–è®¸å¯è¯"); TimeUnit.SECONDS.sleep(3); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; System.out.println(Thread.currentThread().getName() + "é‡Šæ”¾è®¸å¯è¯"); semaphore.release(); &#125; System.out.println(Thread.currentThread().getName() + "ç»“æŸ"); &#125;, "thread" + (i + 1)).start(); &#125;); while (true) &#123; if (semaphore.hasQueuedThreads()) &#123; System.out.println("ç­‰å¾…çº¿ç¨‹æ•°é‡ï¼š" + semaphore.getQueueLength()); Collection&lt;Thread&gt; queuedThreads = semaphore.getQueuedThreads(); System.out.println("ç­‰å¾…çº¿ç¨‹ï¼š" + queuedThreads.stream().map(Thread::getName).collect(Collectors.joining(","))); &#125; &#125; &#125; static class MySemaphore extends Semaphore &#123; private static final long serialVersionUID = -2595494765642942297L; public MySemaphore(int permits) &#123; super(permits); &#125; public MySemaphore(int permits, boolean fair) &#123; super(permits, fair); &#125; public Collection&lt;Thread&gt; getQueuedThreads() &#123; return super.getQueuedThreads(); &#125; &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼ˆæˆªå–ä¸€éƒ¨åˆ†ï¼‰ï¼š Apiæ€»ç»“æ€»ç»“ä¸‹Semaphoreå¸¸ç”¨çš„æ–¹æ³•ï¼šæ–¹æ³•æè¿°acquire()èŽ·å–ä¸€ä¸ªè®¸å¯è¯ï¼Œå¯ä»¥è¢«æ‰“æ–­ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„è®¸å¯è¯æ—¶é˜»å¡žç­‰å¾…acquire(int permits)èŽ·å–æŒ‡å®šæ•°é‡çš„è®¸å¯è¯ï¼Œå¯ä»¥è¢«æ‰“æ–­ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„è®¸å¯è¯æ—¶é˜»å¡žç­‰å¾…acquireUninterruptibly()èŽ·å–ä¸€ä¸ªè®¸å¯è¯ï¼Œä¸å¯è¢«æ‰“æ–­ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„è®¸å¯è¯æ—¶é˜»å¡žç­‰å¾…acquireUninterruptibly(int permits)èŽ·å–æŒ‡å®šæ•°é‡çš„è®¸å¯è¯ï¼Œä¸å¯è¢«æ‰“æ–­ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„è®¸å¯è¯æ—¶é˜»å¡žç­‰å¾…tryAcquire()å°è¯•èŽ·å–ä¸€ä¸ªè®¸å¯è¯ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„è®¸å¯è¯æ—¶ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œä¸ä¼šè¢«é˜»å¡žtryAcquire(int permits)å°è¯•èŽ·å–æŒ‡å®šæ•°é‡çš„è®¸å¯è¯ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„è®¸å¯è¯æ—¶ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œä¸ä¼šè¢«é˜»å¡žtryAcquire(long timeout, TimeUnit unit)åœ¨æŒ‡å®šçš„æ—¶é—´èŒƒå›´å†…å°è¯•èŽ·å–1ä¸ªè®¸å¯è¯ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„è®¸å¯è¯æ—¶ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œä¸ä¼šè¢«é˜»å¡žï¼Œåœ¨è¯¥æ—¶é—´æ–¹ä½å†…å¯ä»¥è¢«æ‰“æ–­tryAcquire(int permits, long timeout, TimeUnit unit)åœ¨æŒ‡å®šçš„æ—¶é—´èŒƒå›´å†…å°è¯•èŽ·å–æŒ‡å®šæ•°é‡çš„è®¸å¯è¯ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„è®¸å¯è¯æ—¶ç¨‹åºç»§ç»­æ‰§è¡Œï¼Œä¸ä¼šè¢«é˜»å¡žï¼Œåœ¨è¯¥æ—¶é—´æ–¹ä½å†…å¯ä»¥è¢«æ‰“æ–­release()é‡Šæ”¾ä¸€ä¸ªè®¸å¯è¯drainPermits()ä¸€æ¬¡æ€§èŽ·å–æ‰€æœ‰å¯ç”¨çš„è®¸å¯è¯availablePermits()èŽ·å–å½“å‰å¯ç”¨è®¸å¯è¯æ•°é‡çš„é¢„ä¼°å€¼hasQueuedThreads()åˆ¤æ–­æ˜¯å¦æœ‰å¤„äºŽç­‰å¾…èŽ·å–è®¸å¯è¯çŠ¶æ€çš„çº¿ç¨‹getQueueLength()èŽ·å–å¤„äºŽç­‰å¾…èŽ·å–è®¸å¯è¯çŠ¶æ€çš„çº¿ç¨‹çš„æ•°é‡çš„é¢„ä¼°å€¼getQueuedThreads()èŽ·å–å¤„äºŽç­‰å¾…èŽ·å–è®¸å¯è¯çŠ¶æ€çš„çº¿ç¨‹é›†åˆ]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥ç†è§£volatileå…³é”®å­—]]></title>
    <url>%2Fvolatile.html</url>
    <content type="text"><![CDATA[volatileå…³é”®å­—ä¿®é¥°çš„æˆå‘˜å˜é‡å…·æœ‰ä¸¤å¤§ç‰¹æ€§ï¼šä¿è¯äº†è¯¥æˆå‘˜å˜é‡åœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§ï¼›ç¦æ­¢å¯¹è¯¥æˆå‘˜å˜é‡è¿›è¡Œé‡æŽ’åºï¼Œä¹Ÿå°±ä¿è¯äº†å…¶æœ‰åºæ€§ã€‚ä½†æ˜¯volatileä¿®é¥°çš„æˆå‘˜å˜é‡å¹¶ä¸å…·æœ‰åŽŸå­æ€§ï¼Œåœ¨å¹¶å‘ä¸‹å¯¹å®ƒçš„ä¿®æ”¹æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚ä¸‹é¢åˆ†åˆ«ä¸¾ä¾‹æ¥æ¼”ç¤ºè¿™ä¸¤ä¸ªç‰¹æ€§ï¼Œå¹¶ä¸”åˆ†æžä¸ºä»€ä¹ˆvolatileä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¯è§æ€§é€šè¿‡å¯¹JMMçš„å­¦ä¹ ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“çº¿ç¨‹å¯¹ä¸»å†…å­˜ä¸­å…±äº«å˜é‡çš„ä¿®æ”¹é¦–å…ˆä¼šä»Žä¸»å†…å­˜èŽ·å–å€¼çš„æ‹·è´ï¼Œç„¶åŽä¿å­˜åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ã€‚æŽ¥ç€åœ¨å·¥ä½œå†…å­˜ä¸­å¯¹å€¼è¿›è¡Œä¿®æ”¹ï¼Œæœ€ç»ˆåˆ·å›žä¸»å†…å­˜ã€‚ç”±äºŽä¸åŒçº¿ç¨‹æ‹¥æœ‰å„è‡ªçš„å·¥ä½œå†…å­˜ï¼Œæ‰€ä»¥å®ƒä»¬å¯¹æŸä¸ªå…±äº«å˜é‡å€¼çš„ä¿®æ”¹åœ¨æ²¡æœ‰åˆ·å›žä¸»å†…å­˜çš„æ—¶å€™åªå¯¹è‡ªå·±å¯è§ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ç”¨äºŽä¿®æ”¹å…±äº«å˜é‡valueï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ç”¨äºŽèŽ·å–ä¿®æ”¹åŽçš„valueï¼š1234567891011121314151617181920212223242526272829public class VolatileTest &#123; private static int INIT_VALUE = 0; private final static int LIMIT = 5; public static void main(String[] args) &#123; new Thread(() -&gt; &#123; int value = INIT_VALUE; while (value &lt; LIMIT) &#123; if (value != INIT_VALUE) &#123; System.out.println("èŽ·å–æ›´æ–°åŽçš„å€¼ï¼š" + INIT_VALUE); value = INIT_VALUE; &#125; &#125; &#125;, "reader").start(); new Thread(() -&gt; &#123; int value = INIT_VALUE; while (INIT_VALUE &lt; LIMIT) &#123; System.out.println("å°†å€¼æ›´æ–°ä¸ºï¼š" + ++value); INIT_VALUE = value; try &#123; TimeUnit.MICROSECONDS.sleep(500); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, "writer").start(); &#125;&#125;writerçº¿ç¨‹æ¯éš”0.5ç§’å°†INIT_VALUEå€¼é€’å¢žï¼Œç›´åˆ°INIT_VALUEå¤§äºŽç­‰äºŽ5ã€‚è€Œreaderçº¿ç¨‹åˆ™æ˜¯ä¸åœçš„åŽ»èŽ·å–INIT_VALUEçš„å€¼ï¼Œç›´åˆ°INIT_VALUEçš„å€¼å¤§äºŽç­‰äºŽ5ã€‚ç¨‹åºæ‰§è¡Œç»“æžœå¦‚ä¸‹ï¼šå¤šæ‰§è¡Œå‡ æ¬¡å¯èƒ½æ¯æ¬¡ç»“æžœéƒ½ä¸ä¸€æ ·ï¼Œä½†æ˜¯å¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œwriterå¯¹å€¼çš„ä¿®æ”¹readerå¹¶ä¸èƒ½é©¬ä¸Šæ„ŸçŸ¥åˆ°ï¼ˆå¦‚æžœèƒ½æ„ŸçŸ¥åˆ°çš„è¯ï¼Œreaderçº¿ç¨‹å°±ä¸ä¼šåœä¸ä¸‹æ¥äº†ï¼‰ã€‚ä¸ºä»€ä¹ˆä¼šå‡ºçŽ°ä¸Šé¢çš„ç»“æžœå‘¢ï¼Ÿå› ä¸ºwriterçº¿ç¨‹åœ¨å·¥ä½œå†…å­˜ä¸­ä¿®æ”¹äº†INIT_VALUEçš„å€¼ï¼Œå³ä½¿å®ƒåˆ·å›žä¸»å†…å­˜äº†ï¼Œä½†æ˜¯readerçº¿ç¨‹åœ¨æ­¤ä¹‹å‰å·²ç»ä»Žä¸»å†…å­˜èŽ·å–äº†INIT_VALUEçš„å€¼ï¼ˆå› ä¸ºçº¿ç¨‹èŽ·å–CPUæ—¶é—´ç‰‡ä¸ç¡®å®šæ€§ï¼Œè¿™ä¸ªå€¼å¯èƒ½æ˜¯0ï¼Œä¹Ÿå¯èƒ½æ˜¯è¢«writerä¿®æ”¹åŽçš„å€¼ï¼Œä½†writerçº¿ç¨‹æ˜¯æ¯éš”0.5ç§’æ‰ä¼šåŽ»ä¿®æ”¹å€¼ï¼Œæ‰€ä»¥readerèŽ·å–åˆ°çš„INIT_VALUEçš„å€¼ä¸€èˆ¬ä¸ä¼šæ˜¯writerä¿®æ”¹çš„æœ€ç»ˆå€¼5ï¼‰ï¼Œå¹¶ä¿å­˜åˆ°äº†readerçº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ã€‚readerçº¿ç¨‹é€šè¿‡whileä¸æ–­çš„è½®è¯¢åˆ¤æ–­valueå’ŒINIT_VALUEçš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œä½†æ˜¯ç”±äºŽreaderçº¿ç¨‹å·¥ä½œå†…å­˜ä¸­å·²ç»æœ‰INIT_VALUEçš„å€¼çš„æ‹·è´äº†ï¼Œæ‰€ä»¥readerå¹¶ä¸ä¼šé‡æ–°ä»Žä¸»å†…å­˜ä¸­èŽ·å–è¢«writerä¿®æ”¹åŽçš„INIT_VALUEçš„å€¼ï¼Œreaderçº¿ç¨‹é‡Œwhileæ¡ä»¶ä¸€ç›´æˆç«‹ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆreaderçº¿ç¨‹ä¸ä¼šæ­£å¸¸åœæ­¢å¹¶ä¸”æ²¡æœ‰è¾“å‡ºä¿®æ”¹åŽçš„å€¼çš„åŽŸå› ã€‚ä¿®æ”¹ä¸Šé¢çš„ä¾‹å­ï¼Œå°†INIT_VALUEæˆå‘˜å˜é‡ä½¿ç”¨volatileå…³é”®å­—ä¿®é¥°ï¼š1234567891011121314151617181920212223242526272829public class VolatileTest &#123; private volatile static int INIT_VALUE = 0; private final static int LIMIT = 5; public static void main(String[] args) &#123; new Thread(() -&gt; &#123; int value = INIT_VALUE; while (value &lt; LIMIT) &#123; if (value != INIT_VALUE) &#123; System.out.println("èŽ·å–æ›´æ–°åŽçš„å€¼ï¼š" + INIT_VALUE); value = INIT_VALUE; &#125; &#125; &#125;, "reader").start(); new Thread(() -&gt; &#123; int value = INIT_VALUE; while (INIT_VALUE &lt; LIMIT) &#123; System.out.println("å°†å€¼æ›´æ–°ä¸ºï¼š" + ++value); INIT_VALUE = value; try &#123; TimeUnit.MICROSECONDS.sleep(500); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, "writer").start(); &#125;&#125;å¯ä»¥çœ‹åˆ°ï¼Œreaderçº¿ç¨‹å·²ç»å¯ä»¥æ­£å¸¸åœæ­¢äº†ï¼Œå› ä¸ºæœ€ç»ˆINIT_VALUEçš„å€¼è‚¯å®šæ˜¯5ï¼Œå¹¶ä¸”readerå¯ä»¥æ„ŸçŸ¥åˆ°è¿™ä¸ªå€¼è¢«ä¿®æ”¹ä¸º5äº†ã€‚ä¸ºä»€ä¹ˆvolatileä¿®é¥°çš„æˆå‘˜å˜é‡åœ¨çº¿ç¨‹é—´å…·æœ‰å¯è§æ€§å‘¢ï¼Ÿå› ä¸ºé€šè¿‡volatileä¿®é¥°ï¼Œå¯¹æ­¤å˜é‡è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œæ±‡ç¼–æŒ‡ä»¤ä¸­ä¼šæœ‰ä¸€ä¸ªLOCKå‰ç¼€æŒ‡ä»¤ï¼ŒåŠ äº†è¿™ä¸ªæŒ‡ä»¤åŽï¼Œä¼šå¼•å‘ä¸¤ä»¶äº‹æƒ…ï¼šå°†å½“å‰å¤„ç†å™¨ç¼“å­˜è¡Œçš„å†…å®¹å†™å›žåˆ°ç³»ç»Ÿå†…å­˜ï¼Œä¹Ÿå°±æ˜¯å¼ºåˆ¶å°†å·¥ä½œå†…å­˜ä¸­çš„å€¼åˆ·å›žä¸»å†…å­˜ï¼›è¿™ä¸ªå†™å›žåˆ°å†…å­˜çš„æ“ä½œä¼šä½¿å¾—åœ¨å…¶ä»–CPUé‡Œç¼“å­˜äº†è¯¥å†…å­˜åœ°å€çš„æ•°æ®å¤±æ•ˆã€‚å…¶ä»–CPUç¼“å­˜æ•°æ®å¤±æ•ˆï¼Œåˆ™ä¼šé‡æ–°åŽ»å†…å­˜ä¸­è¯»å–å€¼ï¼Œä¹Ÿå°±æ˜¯è¢«ä¿®æ”¹çš„æ•°æ®ã€‚é€šè¿‡ä¸Šé¢è¿™ä¸¤ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œwriterå¯¹å€¼è¿›è¡Œä¿®æ”¹å¹¶åˆ·å›žä¸»å†…å­˜åŽï¼Œreaderé‡ŒINIT_VALUEå€¼çš„æ‹·è´å°±å¤±æ•ˆäº†ï¼Œæ‰€ä»¥readerçº¿ç¨‹ä¼šå†æ¬¡ä»Žä¸»å†…å­˜ä¸­èŽ·å–INIT_VALUEçš„å€¼ï¼Œè¿™æ—¶å€™è¿™ä¸ªå€¼å·²ç»æ˜¯è¢«writerçº¿ç¨‹ä¿®æ”¹åˆ·æ–°åŽçš„å€¼äº†ã€‚æœ‰åºæ€§æ¥çœ‹ä¸€ä¸ªçº¿ç¨‹ä¸å®‰å…¨çš„å•ä¾‹å®žçŽ°ï¼ˆåŒé‡åŒæ­¥é”å•ä¾‹æ¨¡å¼ï¼Œæ›´å¤šå…³äºŽå•ä¾‹çš„ä»‹ç»å¯ä»¥å‚è€ƒå•ä¾‹çš„å‡ ç§å†™æ³•å’Œå¯¹æ¯”ï¼‰:123456789101112131415161718public class SingletonTest &#123; // ç§æœ‰åŒ–æž„é€ å‡½æ•°ï¼Œè®©å¤–éƒ¨æ²¡åŠžæ³•ç›´æŽ¥é€šè¿‡newæ¥åˆ›å»º private SingletonTest() &#123; &#125; // å•ä¾‹å¯¹è±¡ private static SingletonTest instance = null; // é™æ€å·¥åŽ‚æ–¹æ³• public static SingletonTest getInstance() &#123; if (instance == null) &#123; // åŒé‡æ£€æµ‹ synchronized (SingletonTest.class) &#123; // åŒæ­¥é” if (instance == null) &#123; instance = new SingletonTest(); &#125; &#125; &#125; return instance; &#125;&#125;ä¸Šé¢çš„ä¾‹å­è™½ç„¶åŠ äº†åŒæ­¥é”ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ä¸‹å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ç¬¬12è¡Œinstance = new SingletonTest()åœ¨å®žé™…æ‰§è¡Œçš„æ—¶å€™ä¼šè¢«æ‹†åˆ†ä¸ºä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤:åˆ†é…å­˜å‚¨SingletonTestå¯¹è±¡çš„å†…å­˜ç©ºé—´ï¼›åˆå§‹åŒ–SingletonTestå¯¹è±¡ï¼›å°†instanceæŒ‡å‘åˆšåˆšåˆ†é…çš„å†…å­˜ç©ºé—´ã€‚é€šè¿‡JMMçš„å­¦ä¹ æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¸¸å¸¸ä¼šå¯¹æŒ‡ä»¤åšé‡æŽ’åºï¼Œå› ä¸ºç¬¬2æ­¥å’Œç¬¬3æ­¥å¹¶æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥å¯èƒ½å‘ç”Ÿé‡æŽ’åºï¼ŒæŽ’åºåŽçš„æ­¥éª¤ä¸ºï¼šåˆ†é…å­˜å‚¨SingletonTestå¯¹è±¡çš„å†…å­˜ç©ºé—´ï¼›å°†instanceæŒ‡å‘åˆšåˆšåˆ†é…çš„å†…å­˜ç©ºé—´ï¼›åˆå§‹åŒ–SingletonTestå¯¹è±¡ã€‚ç»è¿‡é‡æŽ’åºåŽï¼Œä¸Šé¢çš„ä¾‹å­åœ¨å¤šçº¿ç¨‹ä¸‹å°±ä¼šå‡ºçŽ°é—®é¢˜ã€‚å‡å¦‚çŽ°åœ¨æœ‰ä¸¤ä¸ªçº¿ç¨‹Aå’ŒBåŒæ—¶è°ƒç”¨SingletonTest#getInstanceï¼Œçº¿ç¨‹Aæ‰§è¡Œåˆ°äº†ä»£ç çš„ç¬¬12è¡Œinstance = new SingletonTest()ï¼Œå·²ç»å®Œæˆäº†å¯¹è±¡å†…å­˜ç©ºé—´çš„åˆ†é…å¹¶å°†instanceæŒ‡å‘äº†è¯¥å†…å­˜ç©ºé—´ï¼Œçº¿ç¨‹Bæ‰§è¡Œåˆ°äº†ç¬¬9è¡Œï¼Œå‘çŽ°instanceå¹¶ä¸æ˜¯nullï¼ˆå› ä¸ºå·²ç»æŒ‡å‘äº†å†…å­˜ç©ºé—´ï¼‰ï¼Œæ‰€ä»¥å°±ç›´æŽ¥è¿”å›žinstanceäº†ã€‚ä½†æ˜¯çº¿ç¨‹Aå¹¶è¿˜æ²¡æœ‰æ‰§è¡Œåˆå§‹åŒ–SingletonTestæ“ä½œï¼Œæ‰€ä»¥å®žé™…çº¿ç¨‹Bæ‹¿åˆ°çš„SingletonTestå®žä¾‹æ˜¯ç©ºçš„ï¼Œé‚£ä¹ˆçº¿ç¨‹BåŽç»­å¯¹SingletonTestæ“æŽ§å°†æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚è¦è®©ä¸Šé¢çš„ä¾‹å­æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªéœ€è¦ç”¨volatileä¿®é¥°å•ä¾‹å¯¹è±¡å³å¯ï¼š123456789101112131415161718public class SingletonTest &#123; // ç§æœ‰åŒ–æž„é€ å‡½æ•°ï¼Œè®©å¤–éƒ¨æ²¡åŠžæ³•ç›´æŽ¥é€šè¿‡newæ¥åˆ›å»º private SingletonTest() &#123; &#125; // å•ä¾‹å¯¹è±¡ private volatile static SingletonTest instance = null; // é™æ€å·¥åŽ‚æ–¹æ³• public static SingletonTest getInstance() &#123; if (instance == null) &#123; // åŒé‡æ£€æµ‹ synchronized (SingletonTest.class) &#123; // åŒæ­¥é” if (instance == null) &#123; instance = new SingletonTest(); &#125; &#125; &#125; return instance; &#125;&#125;å› ä¸ºé€šè¿‡volatileä¿®é¥°çš„æˆå‘˜å˜é‡ä¼šæ·»åŠ å†…å­˜å±éšœæ¥é˜»æ­¢JVMè¿›è¡ŒæŒ‡ä»¤é‡æŽ’ä¼˜åŒ–ã€‚çº¿ç¨‹ä¸å®‰å…¨ä¸¾ä¸ªé€’å¢žçš„ä¾‹å­ï¼š1234567891011121314public class VolatileTest2 &#123; private volatile static int value; public static void main(String[] args) throws InterruptedException &#123; Thread thread1 = new Thread(() -&gt; IntStream.range(0, 500).forEach(i -&gt; value += 1)); Thread thread2 = new Thread(() -&gt; IntStream.range(0, 500).forEach(i -&gt; value += 1)); thread1.start(); thread2.start(); thread1.join(); thread2.join(); System.out.println(value); &#125;&#125;å¤šæ¬¡è¿è¡Œä¸Šé¢çš„ä¾‹å­ï¼šå¯ä»¥çœ‹åˆ°æœ€ç»ˆçš„å€¼æœ‰å¯èƒ½å°äºŽ1000ã€‚volatileå¯ä»¥ä¿è¯ä¿®æ”¹çš„å€¼èƒ½å¤Ÿé©¬ä¸Šæ›´æ–°åˆ°ä¸»å†…å­˜ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿä¼šæ•æ‰åˆ°è¢«ä¿®æ”¹åŽçš„å€¼ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸èƒ½ä¿è¯åŽŸå­æ€§å‘¢ï¼Ÿå› ä¸ºåœ¨Javaä¸­ï¼Œåªæœ‰å¯¹åŸºæœ¬ç±»åž‹çš„èµ‹å€¼å’Œä¿®æ”¹æ‰æ˜¯åŽŸå­æ€§çš„ï¼Œè€Œå¯¹å…±äº«å˜é‡çš„ä¿®æ”¹å¹¶ä¸æ˜¯åŽŸå­æ€§çš„ã€‚é€šè¿‡JMMå†…å­˜äº¤äº’åè®®æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹å…±äº«å˜é‡çš„å€¼éœ€è¦ç»è¿‡ä¸‹é¢è¿™äº›æ­¥éª¤ï¼šçº¿ç¨‹ä»Žä¸»å†…å­˜ä¸­è¯»å–ï¼ˆreadï¼‰å…±äº«å˜é‡çš„å€¼ï¼Œç„¶åŽè½½å…¥ï¼ˆloadï¼‰åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼›ä½¿ç”¨ï¼ˆuseï¼‰å·¥ä½œå†…å­˜å˜é‡çš„å€¼ï¼Œæ‰§è¡ŒåŠ å‡æ“ä½œï¼Œç„¶åŽå°†ä¿®æ”¹åŽçš„å€¼èµ‹å€¼ï¼ˆassignï¼‰ç»™å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼›å°†å·¥ä½œå†…å­˜ä¸­ä¿®æ”¹åŽçš„å˜é‡çš„å€¼å­˜å‚¨ï¼ˆstoreï¼‰åˆ°ä¸»å†…å­˜ä¸­ï¼Œå¹¶æ‰§è¡Œå†™å…¥ï¼ˆwriteï¼‰æ“ä½œã€‚æ‰€ä»¥ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¯èƒ½å‡ºçŽ°ä¸‹é¢è¿™ç§æƒ…å†µï¼šthread1å’Œthread2åŒæ—¶èŽ·å–äº†valueçš„å€¼ï¼Œæ¯”å¦‚ä¸º100ã€‚thread1æ‰§è¡Œäº†+1æ“ä½œï¼Œç„¶åŽå†™å›žä¸»å†…å­˜ï¼Œè¿™ä¸ªæ—¶å€™thread2åˆšå¥½æ‰§è¡Œå®Œuseæ“ä½œï¼ˆ+1ï¼‰ï¼Œå‡†å¤‡æ‰§è¡Œassignï¼ˆå°†+1åŽçš„å€¼å†™å›žå·¥ä½œå†…å­˜å¯¹åº”çš„å˜é‡ä¸­ï¼‰æ“ä½œã€‚è™½ç„¶è¿™æ—¶å€™thread2å·¥ä½œå†…å­˜ä¸­valueå€¼çš„æ‹·è´æ— æ•ˆäº†ï¼ˆå› ä¸ºvolatileçš„ç‰¹æ€§ï¼‰ï¼Œä½†æ˜¯thread2å·²ç»æ‰§è¡Œå®Œ+1æ“ä½œäº†ï¼Œå®ƒå¹¶ä¸éœ€è¦å†ä»Žä¸»å†…å­˜ä¸­èŽ·å–valueçš„å€¼ï¼Œæ‰€ä»¥thread2å¯ä»¥é¡ºåˆ©åœ°å°†+1åŽçš„å€¼èµ‹å€¼ç»™å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œç„¶åŽåˆ·å›žä¸»å­˜ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ç´¯åŠ ç»“æžœå¯èƒ½ä¼šå°äºŽ1000çš„åŽŸå› ã€‚è¦è®©ä¸Šé¢çš„ä¾‹å­æ˜¯çº¿ç¨‹å®‰å…¨çš„è¯å¯ä»¥åŠ åŒæ­¥é”ï¼Œæˆ–è€…ä½¿ç”¨atomicç±»ï¼ŒåŽç»­ä¼šä»‹ç»åˆ°ã€‚]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JUCä¹‹Exchanger]]></title>
    <url>%2FJUC-Exchanger.html</url>
    <content type="text"><![CDATA[JUCä¸­çš„Exchangerå…è®¸æˆå¯¹çš„çº¿ç¨‹åœ¨æŒ‡å®šçš„åŒæ­¥ç‚¹ä¸Šé€šè¿‡exchangeæ–¹æ³•æ¥äº¤æ¢æ•°æ®ã€‚å¦‚æžœç¬¬ä¸€ä¸ªçº¿ç¨‹å…ˆæ‰§è¡Œexchangeæ–¹æ³•ï¼Œå®ƒä¼šä¸€ç›´ç­‰å¾…ç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿ æ‰§è¡Œexchangeæ–¹æ³•ï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹éƒ½åˆ°è¾¾åŒæ­¥ç‚¹æ—¶ï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹å°±å¯ä»¥äº¤æ¢æ•°æ®ï¼Œå°†å½“å‰çº¿ç¨‹ç”Ÿäº§ å‡ºæ¥çš„æ•°æ®ä¼ é€’ç»™å¯¹æ–¹ã€‚Exchangerç¤ºä¾‹ä¸¤ä¸ªçº¿ç¨‹é€šè¿‡Exchangeräº¤æ¢æ•°æ®çš„ç®€å•ç¤ºä¾‹ï¼š123456789101112131415161718192021222324252627public class ExchangerTest &#123; public static void main(String[] args) &#123; final Exchanger&lt;String&gt; exchanger = new Exchanger&lt;&gt;(); new Thread(() -&gt; &#123; System.out.println("thread1å¼€å§‹"); try &#123; String exchange = exchanger.exchange("æ¥è‡ªthread1çš„æ•°æ®"); System.out.println("æŽ¥æ”¶thread2å‘é€çš„æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("thread1ç»“æŸ"); &#125;, "thread1").start(); new Thread(() -&gt; &#123; System.out.println("thread2å¼€å§‹"); try &#123; String exchange = exchanger.exchange("æ¥è‡ªthread2çš„æ•°æ®"); System.out.println("æŽ¥æ”¶thread1å‘é€çš„æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("thread2ç»“æŸ"); &#125;, "thread2").start(); &#125;&#125;åœ¨å®šä¹‰Exchangerçš„æ—¶å€™éœ€è¦æŒ‡å®šäº¤æ¢çš„æ•°æ®ç±»åž‹ï¼Œè¿™é‡Œä¸ºStringç±»åž‹ã€‚exchangeæ–¹æ³•ç”¨äºŽå‘å¦ä¸€ä¸ªçº¿ç¨‹å‘é€æ•°æ®ï¼Œæ–¹æ³•çš„è¿”å›žå€¼ä¸ºå¦ä¸€ä¸ªçº¿ç¨‹å‘é€è¿‡æ¥çš„æ•°æ®ã€‚ä¸Šé¢ä¾‹å­è¾“å‡ºå¦‚ä¸‹ï¼š123456thread1å¼€å§‹thread2å¼€å§‹æŽ¥æ”¶thread2å‘é€çš„æ•°æ®ï¼šæ¥è‡ªthread2çš„æ•°æ®thread1ç»“æŸæŽ¥æ”¶thread1å‘é€çš„æ•°æ®ï¼šæ¥è‡ªthread1çš„æ•°æ®thread2ç»“æŸä¸Šé¢è¯´è¿‡ï¼Œåªæœ‰å½“æˆå¯¹çš„çº¿ç¨‹éƒ½åˆ°è¾¾åŒæ­¥ç‚¹çš„æ—¶å€™ï¼Œæ‰ä¼šæ‰§è¡Œæ•°æ®äº¤æ¢æ“ä½œã€‚çŽ°åœ¨æˆ‘ä»¬è®©thread2ä¼‘çœ ä¸€ä¼šå„¿ï¼Œçœ‹çœ‹thread1æ˜¯å¦ä¼šè¿›å…¥ç­‰å¾…ï¼š12345678910111213141516171819202122232425262728public class ExchangerTest &#123; public static void main(String[] args) &#123; final Exchanger&lt;String&gt; exchanger = new Exchanger&lt;&gt;(); new Thread(() -&gt; &#123; System.out.println("thread1å¼€å§‹"); try &#123; String exchange = exchanger.exchange("æ¥è‡ªthread1çš„æ•°æ®"); System.out.println("æŽ¥æ”¶thread2å‘é€çš„æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("thread1ç»“æŸ"); &#125;, "thread1").start(); new Thread(() -&gt; &#123; System.out.println("thread2å¼€å§‹"); try &#123; TimeUnit.SECONDS.sleep(3); // thread1ä¹Ÿä¼šè¿›å…¥ç­‰å¾…ï¼Œç›´åˆ°åŒæ–¹éƒ½å‡†å¤‡å¥½äº¤æ¢æ•°æ®ã€‚ String exchange = exchanger.exchange("æ¥è‡ªthread2çš„æ•°æ®"); System.out.println("æŽ¥æ”¶thread1å‘é€çš„æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("thread2ç»“æŸ"); &#125;, "thread2").start(); &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼šé‚£ä¹ˆå¦‚æžœçº¿ç¨‹ä¸æˆå¯¹ä¼šå‡ºçŽ°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿæˆ‘ä»¬æ·»åŠ thread3çº¿ç¨‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738public class ExchangerTest &#123; public static void main(String[] args) &#123; final Exchanger&lt;String&gt; exchanger = new Exchanger&lt;&gt;(); new Thread(() -&gt; &#123; System.out.println("thread1å¼€å§‹"); try &#123; String exchange = exchanger.exchange("å‘é€æ•°æ®-thread1"); System.out.println("æŽ¥æ”¶æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("thread1ç»“æŸ"); &#125;, "thread1").start(); new Thread(() -&gt; &#123; System.out.println("thread2å¼€å§‹"); try &#123; String exchange = exchanger.exchange("å‘é€æ•°æ®-thread2"); System.out.println("æŽ¥æ”¶æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("thread2ç»“æŸ"); &#125;, "thread2").start(); new Thread(() -&gt; &#123; System.out.println("thread3å¼€å§‹"); try &#123; String exchange = exchanger.exchange("å‘é€æ•°æ®-thread3"); System.out.println("æŽ¥æ”¶æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("thread3ç»“æŸ"); &#125;, "thread3").start(); &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š1234567thread1å¼€å§‹thread3å¼€å§‹æŽ¥æ”¶æ•°æ®ï¼šå‘é€æ•°æ®-thread1thread3ç»“æŸthread2å¼€å§‹æŽ¥æ”¶æ•°æ®ï¼šå‘é€æ•°æ®-thread3thread1ç»“æŸå¯çœ‹åˆ°thread1å’Œthread3äº¤æ¢äº†æ•°æ®ç„¶åŽæ­£å¸¸åœæ­¢äº†ï¼Œè€Œthread2ç”±äºŽæ²¡æœ‰çº¿ç¨‹å’Œå®ƒäº¤æ¢æ•°æ®è€Œè‹¦è‹¦ç­‰å¾…ï¼Œçº¿ç¨‹æ°¸è¿œä¸ä¼šåœæ­¢ã€‚æŸ¥çœ‹çº¿ç¨‹å¿«ç…§å¯ä»¥è¯æ˜Žè¿™ç‚¹ï¼šçº¿ç¨‹åŒ¹é…æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥ä¹Ÿæœ‰å¯èƒ½thread1å’Œthread2åŒ¹é…ï¼Œthread3è¿›å…¥æ— ä¼‘æ­¢çš„ç­‰å¾…ï¼Œè¿™å°±ç±»ä¼¼äºŽâ€¦å¦ä¸€ä¸ªå€¼å¾—ä¸€æçš„ç‚¹å°±æ˜¯é€šè¿‡Exchangeräº¤æ¢çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯å¯¹è±¡çš„æ‹·è´ï¼š12345678910111213141516171819202122232425262728293031public class ExchangerTest &#123; public static void main(String[] args) &#123; final Exchanger&lt;Object&gt; exchanger = new Exchanger&lt;&gt;(); new Thread(() -&gt; &#123; System.out.println("thread1å¼€å§‹"); Object object = new Object(); System.out.println("thread1å‘é€æ•°æ®ï¼š" + object); try &#123; Object exchange = exchanger.exchange(object); System.out.println("æŽ¥æ”¶thread2å‘é€çš„æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("thread1ç»“æŸ"); &#125;, "thread1").start(); new Thread(() -&gt; &#123; System.out.println("thread2å¼€å§‹"); Object object = new Object(); System.out.println("thread2å‘é€æ•°æ®ï¼š" + object); try &#123; Object exchange = exchanger.exchange(object); System.out.println("æŽ¥æ”¶thread1å‘é€çš„æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("thread2ç»“æŸ"); &#125;, "thread2").start(); &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š12345678thread1å¼€å§‹thread2å¼€å§‹thread2å‘é€æ•°æ®ï¼šjava.lang.Object@6d559005thread1å‘é€æ•°æ®ï¼šjava.lang.Object@7702c19æŽ¥æ”¶thread2å‘é€çš„æ•°æ®ï¼šjava.lang.Object@6d559005æŽ¥æ”¶thread1å‘é€çš„æ•°æ®ï¼šjava.lang.Object@7702c19thread2ç»“æŸthread1ç»“æŸå¯ä»¥çœ‹åˆ°thread1å‘é€çš„å¯¹è±¡å’Œthread2æŽ¥æ”¶çš„å¯¹è±¡å¥æŸ„æ˜¯ä¸€è‡´çš„ã€‚è®¾ç½®è¶…æ—¶æ—¶é—´å¦‚æžœä¸æƒ³çº¿ç¨‹åœ¨äº¤æ¢æ•°æ®çš„æ—¶å€™ç­‰å¾…è¿‡é•¿çš„æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨exchangerçš„é‡è½½æ–¹æ³•exchange(V x, long timeout, TimeUnit unit)æ¥æŒ‡å®šè¶…æ—¶æ—¶é—´ï¼š12345678910111213141516171819202122232425262728public class ExchangerTest &#123; public static void main(String[] args) &#123; final Exchanger&lt;String&gt; exchanger = new Exchanger&lt;&gt;(); new Thread(() -&gt; &#123; System.out.println("thread1å¼€å§‹"); try &#123; String exchange = exchanger.exchange("æ¥è‡ªthread1çš„æ•°æ®", 5, TimeUnit.SECONDS); System.out.println("æŽ¥æ”¶thread2å‘é€çš„æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException | TimeoutException e) &#123; e.printStackTrace(); &#125; System.out.println("thread1ç»“æŸ"); &#125;, "thread1").start(); new Thread(() -&gt; &#123; System.out.println("thread2å¼€å§‹"); try &#123; TimeUnit.SECONDS.sleep(10); String exchange = exchanger.exchange("æ¥è‡ªthread2çš„æ•°æ®"); System.out.println("æŽ¥æ”¶thread1å‘é€çš„æ•°æ®ï¼š" + exchange); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("thread2ç»“æŸ"); &#125;, "thread2").start(); &#125;&#125;ä¸Šé¢ä¾‹å­ä¸­ï¼Œthread2ä¼‘çœ 10ç§’åŽæ‰å¼€å§‹äº¤æ¢æ•°æ®ï¼Œè€Œthread1åœ¨ç­‰å¾…5ç§’åŽæ²¡èƒ½æˆåŠŸäº¤æ¢æ•°æ®å°±æŠ›å‡ºTimeoutExceptionå¼‚å¸¸äº†ã€‚10ç§’åŽç”±äºŽæ²¡æœ‰çº¿ç¨‹å†å’Œthread2äº¤æ¢æ•°æ®ï¼Œæ‰€ä»¥thread2ä¼šä¸€ç›´ç­‰å¾…ï¼š]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JUCä¹‹CyclicBarrier]]></title>
    <url>%2FJUC-CyclicBarrier.html</url>
    <content type="text"><![CDATA[CyclicBarrierçš„å­—é¢æ„æ€æ˜¯å¯å¾ªçŽ¯ä½¿ç”¨ï¼ˆCyclicï¼‰çš„å±éšœï¼ˆBarrierï¼‰ã€‚å®ƒè¦åšçš„äº‹æƒ…æ˜¯ï¼Œè®©ä¸€ç»„çº¿ç¨‹åˆ°è¾¾ä¸€ä¸ªå±éšœï¼ˆä¹Ÿå¯ä»¥å«åŒæ­¥ç‚¹ï¼‰æ—¶è¢«é˜»å¡žï¼Œç›´åˆ°æœ€åŽä¸€ä¸ªçº¿ç¨‹åˆ°è¾¾å±éšœæ—¶ï¼Œå±éšœæ‰ä¼šå¼€é—¨ï¼Œæ‰€æœ‰è¢«å±éšœæ‹¦æˆªçš„çº¿ç¨‹æ‰ä¼šç»§ç»­è¿è¡Œã€‚CyclicBarrieré»˜è®¤çš„æž„é€ æ–¹æ³•æ˜¯CyclicBarrier(int parties)ï¼Œå…¶å‚æ•°è¡¨ç¤ºå±éšœæ‹¦æˆªçš„çº¿ç¨‹æ•°é‡ï¼Œæ¯ä¸ªçº¿ç¨‹è°ƒç”¨awaitæ–¹æ³•å‘Šè¯‰CyclicBarrieræˆ‘å·²ç»åˆ°è¾¾äº†å±éšœï¼Œç„¶åŽå½“å‰çº¿ç¨‹è¢«é˜»å¡žã€‚CyclicBarrierç¤ºä¾‹ä½¿ç”¨â€œäººæ»¡å‘è½¦â€çš„ä¾‹å­æ¥æ¼”ç¤ºCyclicBarrierï¼š12345678910111213141516171819202122232425262728public class CyclicBarrierTest &#123; public static void main(String[] args) &#123; CyclicBarrier barrier = new CyclicBarrier(2); System.out.println("å¿«ä¸Šè½¦æ¥ä¸åŠè§£é‡Šäº†"); new Thread(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(5); System.out.println(Thread.currentThread() + "å·²ä¸Šè½¦"); barrier.await(); System.out.println("æ‰€æœ‰äººå·²ä¸Šè½¦ï¼Œå‘è½¦"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, "Jane").start(); new Thread(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(3); System.out.println(Thread.currentThread() + "å·²ä¸Šè½¦"); barrier.await(); System.out.println("æ‰€æœ‰äººå·²ä¸Šè½¦ï¼Œå‘è½¦"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, "Mike").start(); &#125;&#125;ä¸Šé¢ä¾‹å­ä¸­æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç­‰å¾…2ä¸ªçº¿ç¨‹å®Œæˆçš„CyclicBarrierï¼Œåœ¨ä¸¤ä¸ªçº¿ç¨‹å†…éƒ¨è°ƒç”¨äº†awaitæ–¹æ³•ï¼Œè®©å…¶é˜»å¡žç­‰å¾…ï¼Œå¹¶å‘ŠçŸ¥CyclicBarrieræˆ‘å·²ç»åˆ°è¾¾å±éšœäº†ã€‚åªæœ‰å½“ä¸¤ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œåˆ°barrier.await()è¿™ä¸€è¡Œæ—¶ï¼Œå±éšœå¼€å¯ï¼Œçº¿ç¨‹æ‰ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ç¨‹åºè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š12345å¿«ä¸Šè½¦æ¥ä¸åŠè§£é‡Šäº†Thread[Mike,5,main]å·²ä¸Šè½¦Thread[Jane,5,main]å·²ä¸Šè½¦æ‰€æœ‰äººå·²ä¸Šè½¦ï¼Œå‘è½¦æ‰€æœ‰äººå·²ä¸Šè½¦ï¼Œå‘è½¦CyclicBarrierçš„æž„é€ å‡½æ•°æ”¯æŒä¼ å…¥ä¸€ä¸ªå›žè°ƒæ–¹æ³•ï¼š123CyclicBarrier barrier = new CyclicBarrier(n, () -&gt; &#123; System.out.println("å½“æ‰€æœ‰çº¿ç¨‹åˆ°è¾¾å±éšœæ—¶ï¼Œæ‰§è¡Œè¯¥å›žè°ƒ");&#125;);æ”¹é€ ä¸Šé¢çš„ä¾‹å­ï¼š12345678910111213141516171819202122232425262728293031public class CyclicBarrierTest &#123; public static void main(String[] args) &#123; CyclicBarrier barrier = new CyclicBarrier(2, new Thread(() -&gt; &#123; System.out.println("å‘è½¦ï¼Œå˜Ÿå˜Ÿå˜Ÿ"); &#125;)); System.out.println("å¿«ä¸Šè½¦æ¥ä¸åŠè§£é‡Šäº†"); new Thread(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(5); System.out.println(Thread.currentThread() + "å·²ä¸Šè½¦"); barrier.await(); System.out.println("æ‰€æœ‰äººå·²ä¸Šè½¦"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, "Jane").start(); new Thread(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(3); System.out.println(Thread.currentThread() + "å·²ä¸Šè½¦"); barrier.await(); System.out.println("æ‰€æœ‰äººå·²ä¸Šè½¦"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, "Mike").start(); &#125;&#125;è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š123456å¿«ä¸Šè½¦æ¥ä¸åŠè§£é‡Šäº†Thread[Mike,5,main]å·²ä¸Šè½¦Thread[Jane,5,main]å·²ä¸Šè½¦å‘è½¦ï¼Œå˜Ÿå˜Ÿå˜Ÿæ‰€æœ‰äººå·²ä¸Šè½¦ï¼Œå‘è½¦æ‰€æœ‰äººå·²ä¸Šè½¦ï¼Œå‘è½¦è®¾ç½®è¶…æ—¶æ—¶é—´awaitçš„é‡è½½æ–¹æ³•ï¼šawait(long timeout, TimeUnit unit)å¯ä»¥è®¾ç½®æœ€å¤§ç­‰å¾…æ—¶é•¿ï¼Œè¶…å‡ºè¿™ä¸ªæ—¶é—´å±éšœè¿˜æ²¡æœ‰å¼€å¯çš„è¯åˆ™æŠ›å‡ºTimeoutExceptionï¼š1234567891011121314151617181920212223242526public class CyclicBarrierTest2 &#123; public static void main(String[] args) throws InterruptedException &#123; CyclicBarrier barrier = new CyclicBarrier(2); new Thread(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(3); barrier.await(); System.out.println(Thread.currentThread() + "ç»§ç»­æ‰§è¡Œ"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, "thread1").start(); new Thread(() -&gt; &#123; try &#123; barrier.await(1, TimeUnit.SECONDS); System.out.println(Thread.currentThread() + "ç»§ç»­æ‰§è¡Œ"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; catch (TimeoutException e) &#123; e.printStackTrace(); &#125; &#125;, "thread2").start(); &#125;&#125;BrokenBarrierExceptionæŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸æ—¶è¡¨ç¤ºå±éšœç ´æŸï¼Œæ­¤æ—¶æ ‡å¿—ä½broken=trueã€‚æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸çš„æƒ…å†µä¸»è¦æœ‰ï¼šå…¶ä»–ç­‰å¾…çš„çº¿ç¨‹è¢«ä¸­æ–­ï¼Œåˆ™å½“å‰çº¿ç¨‹æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ï¼›å…¶ä»–ç­‰å¾…çš„çº¿ç¨‹è¶…æ—¶ï¼Œåˆ™å½“å‰çº¿ç¨‹æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ï¼›å½“å‰çº¿ç¨‹åœ¨ç­‰å¾…æ—¶ï¼Œå…¶ä»–çº¿ç¨‹è°ƒç”¨CyclicBarrier.reset()æ–¹æ³•ï¼Œåˆ™å½“å‰çº¿ç¨‹æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ã€‚æ¨¡æ‹Ÿç¬¬1ç§æƒ…å†µï¼Œå…¶ä»–ç­‰å¾…çš„çº¿ç¨‹è¢«ä¸­æ–­ï¼Œåˆ™å½“å‰çº¿ç¨‹æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ï¼š12345678910111213141516171819202122232425262728293031public class CyclicBarrierTest2 &#123; public static void main(String[] args) throws InterruptedException &#123; CyclicBarrier barrier = new CyclicBarrier(2); new Thread(() -&gt; &#123; try &#123; System.out.println(Thread.currentThread() + "å¼€å§‹æ‰§è¡Œ"); TimeUnit.SECONDS.sleep(3); barrier.await(); System.out.println(Thread.currentThread() + "ç»§ç»­æ‰§è¡Œ"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, "thread1").start(); Thread thread2 = new Thread(() -&gt; &#123; try &#123; System.out.println(Thread.currentThread() + "å¼€å§‹æ‰§è¡Œ"); TimeUnit.SECONDS.sleep(1); barrier.await(); System.out.println(Thread.currentThread() + "ç»§ç»­æ‰§è¡Œ"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, "thread2"); thread2.start(); TimeUnit.SECONDS.sleep(2); thread2.interrupt(); &#125;&#125;è¾“å‡ºï¼šä¸Šé¢ä¾‹å­ä¸­thread2çº¿ç¨‹ç¡çœ 1ç§’åŽå…ˆåˆ°è¾¾å±éšœç‚¹ï¼Œç„¶åŽè¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚2ç§’åŽmainçº¿ç¨‹æ‰§è¡Œthread2.interrupt()ä¸­æ–­ç­‰å¾…ä¸­çš„thread2çº¿ç¨‹ï¼Œæ‰€ä»¥ç¨‹åºæŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ã€‚3ç§’åŽthread1çº¿ç¨‹åˆ°è¾¾å±éšœç‚¹ï¼Œæ­¤æ—¶å±éšœå·²ç»è¢«ç ´åäº†ï¼Œæ‰€ä»¥ä¹ŸæŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ã€‚æ¨¡æ‹Ÿç¬¬2é’Ÿæƒ…å†µï¼šå…¶ä»–ç­‰å¾…çš„çº¿ç¨‹è¶…æ—¶ï¼Œåˆ™å½“å‰çº¿ç¨‹æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ï¼š123456789101112131415161718192021222324252627public class CyclicBarrierTest2 &#123; public static void main(String[] args) throws InterruptedException &#123; CyclicBarrier barrier = new CyclicBarrier(2); new Thread(() -&gt; &#123; try &#123; System.out.println(Thread.currentThread() + "å¼€å§‹æ‰§è¡Œ"); TimeUnit.SECONDS.sleep(3); barrier.await(); System.out.println(Thread.currentThread() + "ç»§ç»­æ‰§è¡Œ"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, "thread1").start(); new Thread(() -&gt; &#123; try &#123; System.out.println(Thread.currentThread() + "å¼€å§‹æ‰§è¡Œ"); TimeUnit.SECONDS.sleep(1); barrier.await(1, TimeUnit.SECONDS); System.out.println(Thread.currentThread() + "ç»§ç»­æ‰§è¡Œ"); &#125; catch (InterruptedException | BrokenBarrierException | TimeoutException e) &#123; e.printStackTrace(); &#125; &#125;, "thread2").start(); &#125;&#125;è¾“å‡ºï¼šä¸Šé¢ä¾‹å­ä¸­thread2ç¡çœ 1ç§’åŽåˆ°è¾¾å±éšœç‚¹ï¼Œç„¶åŽè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼ˆæœ€å¤šç­‰å¾…1ç§’ï¼‰ï¼Œç„¶è€Œå› ä¸ºthread1è¦3ç§’åŽæ‰èƒ½åˆ°è¾¾å±éšœç‚¹ï¼Œæ‰€ä»¥thread2å°†æŠ›å‡ºTimeoutExceptionã€‚3ç§’åŽï¼Œthread1åˆ°è¾¾å±éšœç‚¹ï¼Œä½†è¿™æ—¶å€™ç”±äºŽthread2çš„awaitæ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ç ´åäº†å±éšœï¼Œæ‰€ä»¥thread1å°†æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ã€‚æ¨¡æ‹Ÿç¬¬3ä¸­æƒ…å†µï¼šå½“å‰çº¿ç¨‹åœ¨ç­‰å¾…æ—¶ï¼Œå…¶ä»–çº¿ç¨‹è°ƒç”¨CyclicBarrier.reset()æ–¹æ³•ï¼Œåˆ™å½“å‰çº¿ç¨‹æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ï¼š1234567891011121314151617181920212223242526272829303132public class CyclicBarrierTest2 &#123; public static void main(String[] args) throws InterruptedException &#123; CyclicBarrier barrier = new CyclicBarrier(2); new Thread(() -&gt; &#123; try &#123; System.out.println(Thread.currentThread() + "å¼€å§‹æ‰§è¡Œ"); TimeUnit.SECONDS.sleep(3); barrier.await(); System.out.println(Thread.currentThread() + "ç»§ç»­æ‰§è¡Œ"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, "thread1").start(); new Thread(() -&gt; &#123; try &#123; System.out.println(Thread.currentThread() + "å¼€å§‹æ‰§è¡Œ"); TimeUnit.SECONDS.sleep(1); barrier.await(); System.out.println(Thread.currentThread() + "ç»§ç»­æ‰§è¡Œ"); &#125; catch (InterruptedException | BrokenBarrierException e) &#123; e.printStackTrace(); &#125; &#125;, "thread2").start(); TimeUnit.SECONDS.sleep(2); System.out.println(barrier.getNumberWaiting()); barrier.reset(); &#125;&#125;è¾“å‡ºï¼šä¸Šé¢ä¾‹å­ä¸­ï¼Œthread2ç¡çœ 1ç§’åŽåˆ°è¾¾å±éšœç‚¹ï¼Œç„¶åŽè¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚2ç§’åŽmainçº¿ç¨‹è°ƒç”¨resetæ–¹æ³•é‡ç½®äº†å±éšœï¼Œæ‰€ä»¥åœ¨ç­‰å¾…çŠ¶æ€ä¸­çš„thread2æŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ã€‚3ç§’åŽï¼Œthread1åˆ°è¾¾å±éšœç‚¹ï¼Œç”±äºŽresetæ–¹æ³•é‡ç½®äº†å±éšœï¼Œæ‰€ä»¥thread1å¹¶ä¸ä¼šæŠ›å‡ºBrokenBarrierExceptionå¼‚å¸¸ï¼Œè€Œæ˜¯ä¸€ç›´åœ¨å±éšœç‚¹è¿›è¡Œç­‰å¾…åˆ«çš„çº¿ç¨‹åˆ°è¾¾å±éšœç‚¹ã€‚ä»Žä¸Šé¢çš„ä¸‰ä¸ªä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºæ˜¯å“ªç§æƒ…å†µå¯¼è‡´å±éšœç ´åï¼Œå±éšœç‚¹åŽé¢çš„ä»£ç éƒ½æ²¡æœ‰è¢«æ‰§è¡Œï¼Œmainæ–¹æ³•ä¹Ÿæ²¡æœ‰é€€å‡ºã€‚å’ŒCountDownLatchåŒºåˆ«CountDownLatchï¼šä¸€ä¸ªçº¿ç¨‹(æˆ–è€…å¤šä¸ª)ï¼Œç­‰å¾…å¦å¤–Nä¸ªçº¿ç¨‹å®ŒæˆæŸä¸ªäº‹æƒ…ä¹‹åŽæ‰èƒ½æ‰§è¡Œï¼›CyclicBarrierï¼šNä¸ªçº¿ç¨‹ç›¸äº’ç­‰å¾…ï¼Œä»»ä½•ä¸€ä¸ªçº¿ç¨‹å®Œæˆä¹‹å‰ï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½å¿…é¡»ç­‰å¾…ã€‚CountDownLatchï¼šä¸€æ¬¡æ€§çš„ï¼›CyclicBarrierï¼šå¯ä»¥é‡å¤ä½¿ç”¨ã€‚]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JUCä¹‹CountDownLatch]]></title>
    <url>%2FJUC-CountDownLatch.html</url>
    <content type="text"><![CDATA[CountDownLatchå…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆæ“ä½œã€‚å®šä¹‰CountDownLatchçš„æ—¶å€™ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªæ­£æ•°æ¥åˆå§‹åŒ–è®¡æ•°å™¨ï¼ˆè™½ç„¶ä¼ å…¥0ä¹Ÿå¯ä»¥ï¼Œä½†è¿™æ ·çš„è¯CountDownLatchæ²¡ä»€ä¹ˆå®žé™…æ„ä¹‰ï¼‰ã€‚å…¶countDownæ–¹æ³•ç”¨äºŽé€’å‡è®¡æ•°å™¨ï¼Œawaitæ–¹æ³•ä¼šä½¿å½“å‰çº¿ç¨‹é˜»å¡žï¼Œç›´åˆ°è®¡æ•°å™¨é€’å‡ä¸º0ã€‚æ‰€ä»¥CountDownLatchå¸¸ç”¨äºŽå¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„åè°ƒå·¥ä½œã€‚CountDownLatchç¤ºä¾‹å‡è®¾æˆ‘ä»¬çŽ°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šä»Žæ•°æ®åº“èŽ·å–æ•°æ®å¯¹è¿™æ‰¹æ•°æ®è¿›è¡Œå¤„ç†ä¿å­˜è¿™æ‰¹æ•°æ®ä¸ºäº†è®©ç¨‹åºæ‰§è¡Œæ•ˆçŽ‡æ›´é«˜ï¼Œç¬¬2æ­¥ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šçº¿ç¨‹æ¥å¹¶è¡Œå¤„ç†è¿™æ‰¹æ•°æ®ï¼Œå¤§è‡´è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021222324252627282930313233public class CountDownLatchTest &#123; public static void main(String[] args) throws InterruptedException &#123; // 1. æ¨¡æ‹Ÿä»Žæ•°æ®åº“èŽ·å–æ•°æ® int[] data = query(); System.out.println("èŽ·å–æ•°æ®å®Œæ¯•"); // 2. æ•°æ®å¤„ç† IntStream.range(0, data.length).forEach(i -&gt; &#123; ExecutorService.execute(() -&gt; &#123; System.out.println(Thread.currentThread() + "å¤„ç†ç¬¬" + (i + 1) + "æ¡æ•°æ®"); int value = data[i]; if (value % 2 == 0) &#123; data[i] = value * 2; &#125; else &#123; data[i] = value * 10; &#125; &#125;); &#125;); System.out.println("æ‰€æœ‰æ•°æ®éƒ½å¤„ç†å®Œäº†"); // å…³é—­çº¿ç¨‹æ±  ExecutorService.shutdown(); // 3. ä¿å­˜æ•°æ® save(data); &#125; private static int[] query() &#123; return new int[]&#123;1, 2, 3, 4, 5, 6, 7, 8, 9, 10&#125;; &#125; private static void save(int[] data) &#123; System.out.println("ä¿å­˜æ•°æ® - " + Arrays.toString(data)); &#125;&#125;ç”±äºŽçº¿ç¨‹èŽ·å–CPUæ—¶é—´ç‰‡çš„ä¸ç¡®å®šæ€§ï¼Œæ‰€ä»¥æœ‰å¯èƒ½æ•°æ®è¿˜æ²¡æœ‰å¤„ç†å®Œæ¯•ï¼Œç¬¬3æ­¥å°±æ‰§è¡Œå®Œäº†ï¼š12345678910111213èŽ·å–æ•°æ®å®Œæ¯•æ‰€æœ‰æ•°æ®éƒ½å¤„ç†å®Œäº†ä¿å­˜æ•°æ® - [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]Thread[pool-1-thread-2,5,main]å¤„ç†ç¬¬2æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬1æ¡æ•°æ®Thread[pool-1-thread-2,5,main]å¤„ç†ç¬¬3æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬4æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬6æ¡æ•°æ®Thread[pool-1-thread-2,5,main]å¤„ç†ç¬¬5æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬7æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬9æ¡æ•°æ®Thread[pool-1-thread-2,5,main]å¤„ç†ç¬¬8æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬10æ¡æ•°æ®æˆ‘ä»¬å¯ä»¥å€ŸåŠ©CountDownLatchè§£å†³è¿™ä¸ªé—®é¢˜ï¼š12345678910111213141516171819202122232425262728293031323334353637public class CountDownLatchTest &#123; private static ExecutorService ExecutorService = Executors.newFixedThreadPool(2); private static CountDownLatch latch = new CountDownLatch(10); public static void main(String[] args) throws InterruptedException &#123; // 1. æ¨¡æ‹Ÿä»Žæ•°æ®åº“èŽ·å–æ•°æ® int[] data = query(); System.out.println("èŽ·å–æ•°æ®å®Œæ¯•"); // 2. æ•°æ®å¤„ç† IntStream.range(0, data.length).forEach(i -&gt; &#123; ExecutorService.execute(() -&gt; &#123; System.out.println(Thread.currentThread() + "å¤„ç†ç¬¬" + (i + 1) + "æ¡æ•°æ®"); int value = data[i]; if (value % 2 == 0) &#123; data[i] = value * 2; &#125; else &#123; data[i] = value * 10; &#125; latch.countDown(); &#125;); &#125;); latch.await(); System.out.println("æ‰€æœ‰æ•°æ®éƒ½å¤„ç†å®Œäº†"); // å…³é—­çº¿ç¨‹æ±  ExecutorService.shutdown(); // 3. ä¿å­˜æ•°æ® save(data); &#125; private static int[] query() &#123; return new int[]&#123;1, 2, 3, 4, 5, 6, 7, 8, 9, 10&#125;; &#125; private static void save(int[] data) &#123; System.out.println("ä¿å­˜æ•°æ® - " + Arrays.toString(data)); &#125;&#125;æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªCountDownLatchï¼Œè®¡æ•°å™¨å€¼ä¸º10ï¼Œå’Œæ•°æ®é‡ä¸€è‡´ã€‚ç„¶åŽåœ¨ç¬¬2æ­¥ä¸­ï¼Œå½“æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•çš„æ—¶å€™è°ƒç”¨countDownæ–¹æ³•ï¼Œè®©è®¡æ•°å™¨å‡1ã€‚åœ¨ç¬¬3æ­¥å‰è°ƒç”¨awaitæ–¹æ³•è®©mainçº¿ç¨‹é˜»å¡žç­‰å¾…ï¼Œç›´åˆ°è®¡æ•°å™¨è¢«å‡ä¸º0ã€‚æ‰€ä»¥è¿™å°±ä¿è¯äº†åªæœ‰å½“æ‰€æœ‰æ•°æ®åŠ å·¥å®Œæ¯•æ‰æ‰§è¡Œä¿å­˜æ•°æ®æ“ä½œã€‚æ‰§è¡Œæ–¹æ³•ï¼Œç¨‹åºè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213èŽ·å–æ•°æ®å®Œæ¯•Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬1æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬3æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬4æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬5æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬6æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬7æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬8æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬9æ¡æ•°æ®Thread[pool-1-thread-1,5,main]å¤„ç†ç¬¬10æ¡æ•°æ®Thread[pool-1-thread-2,5,main]å¤„ç†ç¬¬2æ¡æ•°æ®æ‰€æœ‰æ•°æ®éƒ½å¤„ç†å®Œäº†ä¿å­˜æ•°æ® - [10, 4, 30, 8, 50, 12, 70, 16, 90, 20]awaitæœ‰é‡è½½æ–¹æ³•ï¼šawait(long timeout, TimeUnit unit)ï¼Œè®¾ç½®æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ç¨‹åºå°†ç»§ç»­æ‰§è¡Œä¸å†è¢«é˜»å¡žï¼š123456789101112131415161718public class CountDownLatchTest &#123; public static void main(String[] args) throws InterruptedException &#123; final CountDownLatch latch = new CountDownLatch(1); new Thread(() -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(4); System.out.println(Thread.currentThread() + "çº¿ç¨‹æ‰§è¡Œå®Œæ¯•"); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; finally &#123; latch.countDown(); &#125; &#125;, "thread1").start(); latch.await(3, TimeUnit.SECONDS); // æœ€å¤šç­‰å¾… 3ç§’ System.out.println("mainçº¿ç¨‹æ‰§è¡Œå®Œæ¯•"); &#125;&#125;è¾“å‡ºå¦‚ä¸‹ï¼š12mainçº¿ç¨‹æ‰§è¡Œå®Œæ¯•Thread[thread1,5,main]çº¿ç¨‹æ‰§è¡Œå®Œæ¯•]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java å†…å­˜æ¨¡åž‹]]></title>
    <url>%2FJava-Memory-model.html</url>
    <content type="text"><![CDATA[ç†è§£Javaå†…å­˜æ¨¡åž‹æ˜¯æ·±å…¥å­¦ä¹ Javaå¹¶å‘ä¸å¯æˆ–ç¼ºçš„éƒ¨åˆ†ã€‚Javaå†…å­˜æ¨¡åž‹å³Java Memory Modelï¼Œç®€ç§°ä¸ºJMMï¼Œå®šä¹‰äº†å¤šçº¿ç¨‹ä¹‹é—´å…±äº«å˜é‡çš„å¯è§æ€§ä»¥åŠå¦‚ä½•åœ¨éœ€è¦çš„æ—¶å€™å¯¹å…±äº«å˜é‡è¿›è¡ŒåŒæ­¥ã€‚JMMè§„å®šJavaçº¿ç¨‹é—´çš„é€šä¿¡é‡‡ç”¨å…±äº«å†…å­˜çš„æ–¹å¼ã€‚åœ¨Javaä¸­ï¼Œæ‰€æœ‰æˆå‘˜å˜é‡ã€é™æ€å˜é‡å’Œæ•°ç»„å…ƒç´ éƒ½å­˜å‚¨åœ¨å †å†…å­˜ä¸­ï¼Œå †å†…å­˜åœ¨çº¿ç¨‹ä¹‹é—´å…±äº«ï¼Œæ‰€ä»¥å®ƒä»¬é€šå¸¸ä¹Ÿç§°ä¸ºå…±äº«å˜é‡ã€‚JMMå®šä¹‰äº†çº¿ç¨‹å’Œä¸»å†…å­˜ä¹‹é—´çš„æŠ½ è±¡å…³ç³»ï¼šçº¿ç¨‹ä¹‹é—´çš„å…±äº«å˜é‡å­˜å‚¨åœ¨ä¸»å†…å­˜ï¼ˆMain Memoryï¼‰ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç§æœ‰çš„æœ¬åœ°å†…å­˜ï¼ˆLocal Memoryï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ç§°ä¸ºå·¥ä½œå†…å­˜ Work Memoryï¼‰ï¼Œæœ¬åœ°å†…å­˜ä¸­å­˜å‚¨äº†è¯¥çº¿ç¨‹ä»¥è¯»/å†™å…±äº«å˜é‡çš„å‰¯æœ¬ã€‚æœ¬åœ°å†…å­˜æ˜¯JMMçš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå¹¶ä¸çœŸå®žå­˜åœ¨ã€‚å®ƒæ¶µç›–äº†ç¼“å­˜ã€å†™ç¼“å†²åŒºã€å¯„å­˜å™¨ä»¥åŠå…¶ä»–çš„ç¡¬ä»¶å’Œç¼–è¯‘å™¨ä¼˜åŒ–ã€‚JMMæŠ½è±¡JMMçš„æŠ½è±¡ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹åŒä¸€ä¸ªå…±äº«å˜é‡è¿›è¡Œè¯»å†™çš„æ—¶å€™ä¼šäº§ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚é‚£ä¸ºä»€ä¹ˆCPUä¸ç›´æŽ¥æ“ä½œå†…å­˜ï¼Œè€Œè¦åœ¨CPUå’Œå†…å­˜é—´åŠ ä¸Šå„ç§ç¼“å­˜å’Œå¯„å­˜å™¨ç­‰ç¼“å†²åŒºå‘¢ï¼Ÿå› ä¸ºCPUçš„è¿ç®—é€Ÿåº¦è¦æ¯”å†…å­˜çš„è¯»å†™é€Ÿåº¦å¿«å¾—å¤šï¼Œå¦‚æžœCPUç›´æŽ¥æ“ä½œå†…å­˜çš„è¯åŠ¿å¿…ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´ç­‰å¾…æ•°æ®åˆ°æ¥ï¼Œæ‰€ä»¥ç¼“å­˜çš„å‡ºçŽ°ä¸»è¦æ˜¯ä¸ºäº†è§£å†³CPUè¿ç®—é€Ÿåº¦ä¸Žå†…å­˜è¯»å†™é€Ÿåº¦ä¸åŒ¹é…çš„çŸ›ç›¾ã€‚å†…å­˜é—´äº¤äº’åè®®JMMè§„å®šäº†ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜é—´å…·ä½“çš„äº¤äº’åè®®ï¼Œå³ä¸€ä¸ªå˜é‡å¦‚ä½•ä»Žä¸»å†…å­˜æ‹·è´åˆ°å·¥ä½œå†…å­˜ã€å¦‚ä½•ä»Žå·¥ä½œå†…å­˜åŒæ­¥åˆ°ä¸»å†…å­˜ä¹‹é—´çš„å®žçŽ°ç»†èŠ‚ï¼Œè¿™ä¸»è¦åŒ…å«äº†ä¸‹é¢8ä¸ªæ­¥éª¤ï¼šlockï¼ˆé”å®šï¼‰ï¼šä½œç”¨äºŽä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡æ ‡è¯†ä¸ºä¸€æ¡çº¿ç¨‹ç‹¬å çŠ¶æ€ã€‚unlockï¼ˆè§£é”ï¼‰ï¼šä½œç”¨äºŽä¸»å†…å­˜å˜é‡ï¼ŒæŠŠä¸€ä¸ªå¤„äºŽé”å®šçŠ¶æ€çš„å˜é‡é‡Šæ”¾å‡ºæ¥ï¼Œé‡Šæ”¾åŽçš„å˜é‡æ‰å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹é”å®šã€‚readï¼ˆè¯»å–ï¼‰ï¼šä½œç”¨äºŽä¸»å†…å­˜å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡å€¼ä»Žä¸»å†…å­˜ä¼ è¾“åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåŽçš„loadåŠ¨ä½œä½¿ç”¨loadï¼ˆè½½å…¥ï¼‰ï¼šä½œç”¨äºŽå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠreadæ“ä½œä»Žä¸»å†…å­˜ä¸­å¾—åˆ°çš„å˜é‡å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­ã€‚useï¼ˆä½¿ç”¨ï¼‰ï¼šä½œç”¨äºŽå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“Žï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªéœ€è¦ä½¿ç”¨å˜é‡çš„å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶å°†ä¼šæ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚assignï¼ˆèµ‹å€¼ï¼‰ï¼šä½œç”¨äºŽå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªä»Žæ‰§è¡Œå¼•æ“ŽæŽ¥æ”¶åˆ°çš„å€¼èµ‹å€¼ç»™å·¥ä½œå†…å­˜çš„å˜é‡ï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªç»™å˜é‡èµ‹å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚storeï¼ˆå­˜å‚¨ï¼‰ï¼šä½œç”¨äºŽå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåŽçš„writeçš„æ“ä½œã€‚writeï¼ˆå†™å…¥ï¼‰ï¼šä½œç”¨äºŽä¸»å†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠstoreæ“ä½œä»Žå·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜çš„å˜é‡ä¸­ã€‚è¿™8ä¸ªæ­¥éª¤å¿…é¡»ç¬¦åˆä¸‹è¿°è§„åˆ™ï¼šä¸å…è®¸readå’Œloadï¼Œstoreå’Œwriteæ“ä½œä¹‹ä¸€å•ç‹¬å‡ºçŽ°ã€‚ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹ä¸¢å¼ƒå®ƒæœ€è¿‘çš„assignæ“ä½œã€‚å³å˜é‡åœ¨å·¥ä½œå†…å­˜ä¸­æ”¹å˜äº†è´¦å·å¿…é¡»æŠŠå˜åŒ–åŒæ­¥å›žä¸»å†…å­˜ä¸€ä¸ªæ–°çš„å˜é‡åªå…è®¸åœ¨ä¸»å†…å­˜ä¸­è¯žç”Ÿï¼Œä¸å…è®¸å·¥ä½œå†…å­˜ç›´æŽ¥ä½¿ç”¨æœªåˆå§‹åŒ–çš„å˜é‡ã€‚ä¸€ä¸ªå˜é‡åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€æ¡çº¿ç¨‹è¿›è¡Œlockæ“ä½œï¼Œä½†åŒä¸€çº¿ç¨‹å¯ä»¥lockå¤šæ¬¡ï¼Œlockå¤šæ¬¡ä¹‹åŽå¿…é¡»æ‰§è¡ŒåŒæ ·æ¬¡æ•°çš„unlockæ“ä½œå¦‚æžœå¯¹ä¸€ä¸ªå˜é‡è¿›è¡Œlockæ“ä½œï¼Œé‚£ä¹ˆå°†ä¼šæ¸…ç©ºå·¥ä½œå†…å­˜ä¸­æ­¤å˜é‡çš„å€¼ã€‚ä¸å…è®¸å¯¹æœªlockçš„å˜é‡è¿›è¡Œunlockæ“ä½œï¼Œä¹Ÿä¸å…è®¸unlockä¸€ä¸ªè¢«å…¶å®ƒçº¿ç¨‹lockçš„å˜é‡å¦‚æžœä¸€ä¸ªå˜é‡æ‰§è¡Œunlockæ“ä½œï¼Œå¿…é¡»å…ˆæŠŠæ­¤å˜é‡åŒæ­¥å›žä¸»å†…å­˜ä¸­ã€‚æŒ‡ä»¤é‡æŽ’åœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¸¸å¸¸ä¼šå¯¹æŒ‡ä»¤åšé‡æŽ’åºã€‚ä»ŽJavaæºä»£ç åˆ°æœ€ç»ˆå®žé™…æ‰§è¡Œçš„æŒ‡ä»¤åºåˆ—ï¼Œä¼šåˆ†åˆ«ç»åŽ†ä¸‹é¢3ç§é‡æŽ’åºï¼šç¼–è¯‘å™¨ä¼˜åŒ–çš„é‡æŽ’åºã€‚ç¼–è¯‘å™¨åœ¨ä¸æ”¹å˜å•çº¿ç¨‹ç¨‹åºè¯­ä¹‰çš„å‰æä¸‹ï¼Œå¯ä»¥é‡æ–°å®‰æŽ’è¯­å¥çš„æ‰§è¡Œé¡ºåºã€‚æŒ‡ä»¤çº§å¹¶è¡Œçš„é‡æŽ’åºã€‚çŽ°ä»£å¤„ç†å™¨é‡‡ç”¨äº†æŒ‡ä»¤çº§å¹¶è¡ŒæŠ€æœ¯ï¼ˆInstruction-LevelParallelismï¼ŒILPï¼‰æ¥å°†å¤šæ¡æŒ‡ä»¤é‡å æ‰§è¡Œã€‚å¦‚æžœä¸å­˜åœ¨æ•°æ®ä¾èµ–æ€§ï¼Œå¤„ç†å™¨å¯ä»¥æ”¹å˜è¯­å¥å¯¹åº”æœºå™¨æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚å†…å­˜ç³»ç»Ÿçš„é‡æŽ’åºã€‚ç”±äºŽå¤„ç†å™¨ä½¿ç”¨ç¼“å­˜å’Œè¯»/å†™ç¼“å†²åŒºï¼Œè¿™ä½¿å¾—åŠ è½½å’Œå­˜å‚¨æ“ä½œçœ‹ä¸ŠåŽ»å¯èƒ½æ˜¯åœ¨ä¹±åºæ‰§è¡Œã€‚å¦‚æžœä¸¤ä¸ªæ“ä½œè®¿é—®åŒä¸€ä¸ªå˜é‡ï¼Œå…¶ä¸­ä¸€ä¸ªä¸ºå†™æ“ä½œï¼Œæ­¤æ—¶è¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´å­˜åœ¨æ•°æ®ä¾èµ–æ€§ã€‚ ç¼–è¯‘å™¨å’Œå¤„ç†å™¨ä¸ä¼šæ”¹å˜å­˜åœ¨æ•°æ®ä¾èµ–æ€§å…³ç³»çš„ä¸¤ä¸ªæ“ä½œçš„æ‰§è¡Œé¡ºåºï¼Œå³ä¸ä¼šé‡æŽ’åºã€‚ä¸ç®¡æ€Žä¹ˆé‡æŽ’åºï¼Œå•çº¿ç¨‹ä¸‹çš„æ‰§è¡Œç»“æžœä¸èƒ½è¢«æ”¹å˜ï¼Œç¼–è¯‘å™¨ã€runtimeå’Œå¤„ç†å™¨éƒ½å¿…é¡»éµå®ˆas-if-serialè¯­ä¹‰ã€‚å†…å­˜å±éšœé€šè¿‡æ’å…¥å†…å­˜å±éšœï¼ˆMemory Barrierï¼‰å¯ä»¥é˜»æ­¢ç‰¹å®šç±»åž‹çš„æŒ‡ä»¤é‡æŽ’ã€‚JMMå°†å†…å­˜å±éšœåˆ’åˆ†ä¸ºå››ç§ï¼šå±éšœç±»åž‹ç¤ºä¾‹æè¿°LoadLoad BarriersLoad1-LoadLoad-Load2Load1æ•°æ®è£…è½½è¿‡ç¨‹è¦å…ˆäºŽLoad2åŠæ‰€æœ‰åŽç»­çš„æ•°æ®è£…è½½è¿‡ç¨‹StoreStore BarriersStore1-StoreStore-Store2Store1åˆ·æ–°æ•°æ®åˆ°å†…å­˜çš„è¿‡ç¨‹è¦å…ˆäºŽStrore2åŠåŽç»­æ‰€æœ‰åˆ·æ–°æ•°æ®åˆ°å†…å­˜çš„è¿‡ç¨‹LoadStore BarriersLoad1-LoadStore-Store2Load1æ•°æ®è£…è½½è¦å…ˆäºŽStrore2åŠåŽç»­æ‰€æœ‰åˆ·æ–°æ•°æ®åˆ°å†…å­˜çš„è¿‡ç¨‹StoreLoad BarriersStore1-StoreLoad-Load2Store1åˆ·æ–°æ•°æ®åˆ°å†…å­˜çš„è¿‡ç¨‹è¦å…ˆäºŽLoad2åŠæ‰€æœ‰åŽç»­çš„æ•°æ®è£…è½½è¿‡ç¨‹Javaä¸­volatileå…³é”®å­—çš„å®žçŽ°å°±æ˜¯é€šè¿‡å†…å­˜å±éšœæ¥å®Œæˆçš„ã€‚happens-beforeä»Žjdk5å¼€å§‹ï¼Œjavaä½¿ç”¨æ–°çš„JSR-133å†…å­˜æ¨¡åž‹ï¼ŒåŸºäºŽhappens-beforeçš„æ¦‚å¿µæ¥é˜è¿°æ“ä½œä¹‹é—´çš„å†…å­˜å¯è§æ€§ã€‚åœ¨JMMä¸­ï¼Œå¦‚æžœä¸€ä¸ªæ“ä½œçš„æ‰§è¡Œç»“æžœéœ€è¦å¯¹å¦ä¸€ä¸ªæ“ä½œå¯è§ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´å¿…é¡»è¦å­˜åœ¨happens-beforeå…³ç³»ï¼Œè¿™ä¸ªçš„ä¸¤ä¸ªæ“ä½œæ—¢å¯ä»¥åœ¨åŒä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸åŒçš„ä¸¤ä¸ªçº¿ç¨‹ä¸­ã€‚ä¸Žç¨‹åºå‘˜å¯†åˆ‡ç›¸å…³çš„happens-beforeè§„åˆ™å¦‚ä¸‹ï¼šç¨‹åºé¡ºåºè§„åˆ™ï¼šä¸€ä¸ªçº¿ç¨‹ä¸­çš„æ¯ä¸ªæ“ä½œï¼Œhappens-beforeäºŽè¯¥çº¿ç¨‹ä¸­ä»»æ„çš„åŽç»­æ“ä½œã€‚ç›‘è§†å™¨é”è§„åˆ™ï¼šå¯¹ä¸€ä¸ªé”çš„è§£é”æ“ä½œï¼Œhappens-beforeäºŽéšåŽå¯¹è¿™ä¸ªé”çš„åŠ é”æ“ä½œã€‚volatileåŸŸè§„åˆ™ï¼šå¯¹ä¸€ä¸ªvolatileåŸŸçš„å†™æ“ä½œï¼Œhappens-beforeäºŽä»»æ„çº¿ç¨‹åŽç»­å¯¹è¿™ä¸ªvolatileåŸŸçš„è¯»ã€‚ä¼ é€’æ€§è§„åˆ™ï¼šå¦‚æžœ A happens-before Bï¼Œä¸” B happens-before Cï¼Œé‚£ä¹ˆA happens-before Cã€‚æ³¨æ„ï¼šä¸¤ä¸ªæ“ä½œä¹‹é—´å…·æœ‰happens-beforeå…³ç³»ï¼Œå¹¶ä¸æ„å‘³å‰ä¸€ä¸ªæ“ä½œå¿…é¡»è¦åœ¨åŽä¸€ä¸ªæ“ä½œä¹‹å‰æ‰§è¡Œï¼ä»…ä»…è¦æ±‚å‰ä¸€ä¸ªæ“ä½œçš„æ‰§è¡Œç»“æžœï¼Œå¯¹äºŽåŽä¸€ä¸ªæ“ä½œæ˜¯å¯è§çš„ï¼Œä¸”å‰ä¸€ä¸ªæ“ä½œæŒ‰é¡ºåºæŽ’åœ¨åŽä¸€ä¸ªæ“ä½œä¹‹å‰ã€‚å‚è€ƒè‡ªï¼šJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Guava æ‚é¡¹ç¬”è®°]]></title>
    <url>%2FGuava-Miscellaneous-notes.html</url>
    <content type="text"><![CDATA[è¿™é‡Œä¸»è¦è®°å½•Guavaæä¾›çš„ä¸€äº›å·¥å…·ç±»çš„ç”¨æ³•ã€‚Stringsç©ºå’Œnullç›¸äº’è½¬æ¢ï¼š1234String s1 = Strings.emptyToNull("");System.out.println(s1); // nullString s2 = Strings.nullToEmpty(null);System.out.println(s2); //èŽ·å–ç›¸åŒçš„å‰ç¼€å’ŒåŽç¼€ï¼š1234String s3 = Strings.commonPrefix("mrbird", "mr.right");System.out.println(s3); // mrString s4 = Strings.commonSuffix("mrbird", "third");System.out.println(s4); // irdrepeaté‡å¤æ“ä½œï¼š12String s5 = Strings.repeat("mrbird", 3);System.out.println(s5); // mrbirdmrbirdmrbirdåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºæˆ–nullï¼š12boolean nullOrEmpty = Strings.isNullOrEmpty(null);System.out.println(nullOrEmpty); // trueå·¦ä¾§å¡«å……å’Œå³ä¾§å¡«å……ï¼š1234String s6 = Strings.padStart("01", 5, '0');System.out.println(s6); // 00001String s7 = Strings.padEnd("1.0", 5, '0');System.out.println(s7); // 1.000StopWatcherStopWatcherç”¨äºŽç›‘æµ‹ä¸€æ®µç¨‹åºçš„æ‰§è¡Œè€—æ—¶ã€‚æˆ‘ä»¬ä¹‹å‰é€šå¸¸çš„åšæ³•æ˜¯ï¼š1234System.out.println("ç¨‹åºå¼€å§‹å¤„ç†");long start = System.currentTimeMillis();TimeUnit.SECONDS.sleep(2);System.out.println("ç¨‹åºå¤„ç†ç»“æŸï¼Œè€—æ—¶" + (System.currentTimeMillis() - start) + "æ¯«ç§’"); // ç¨‹åºå¤„ç†ç»“æŸï¼Œè€—æ—¶2.002 sä½¿ç”¨StopWatcheræ–¹ä¾¿ä¹‹å¤„åœ¨äºŽå®ƒä¼šå¸®æˆ‘ä»¬é€‰å–åˆé€‚çš„æ—¶é—´å•ä½ï¼š1234System.out.println("ç¨‹åºå¼€å§‹å¤„ç†");Stopwatch stopwatch = Stopwatch.createStarted();TimeUnit.SECONDS.sleep(2);System.out.println("ç¨‹åºå¤„ç†ç»“æŸï¼Œè€—æ—¶" + stopwatch.stop()); // ç¨‹åºå¤„ç†ç»“æŸï¼Œè€—æ—¶2.002 sPreconditionsæ–­è¨€æ–­è¨€å¸¸ç”¨äºŽç±»åº“è®¾è®¡ä¸­æ–¹æ³•å‚æ•°çš„åˆ¤æ–­ï¼Œå½“å‚æ•°ä¸ç¬¦åˆè¦æ±‚æ—¶ï¼Œè®©ç¨‹åºæå‰æŠ›å¼‚å¸¸ç»“æŸã€‚Preconditionsæ˜¯Guavaæä¾›çš„æ–­è¨€ç±»ã€‚éžç©ºæ ¡éªŒåˆ¤æ–­æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºçš„è¯æŠ›å‡ºNullPointerExceptionï¼š12List&lt;String&gt; list = null;Preconditions.checkNotNull(list);è‡ªå®šä¹‰æè¿°ï¼š12List&lt;String&gt; list = null;Preconditions.checkNotNull(list, "listä¸èƒ½ä¸ºç©º");è‡ªå®šä¹‰æè¿° + é•¿åº¦æ ¡éªŒï¼š12List&lt;String&gt; list = null;Preconditions.checkNotNull(list, "listé•¿åº¦å¿…é¡»ä¸º%s", 2);å‚æ•°æ ¡éªŒæ ¡éªŒä¸é€šè¿‡æ—¶ï¼ŒæŠ›å‡ºIllegalArgumentExceptionï¼š12String value = "hello";Preconditions.checkArgument("world".equals(value), "å‚æ•°å†…å®¹å¿…é¡»ä¸ºworld");çŠ¶æ€æ ¡éªŒæ ¡éªŒä¸é€šè¿‡æ—¶ï¼ŒæŠ›å‡ºIllegalStateExceptionï¼š12String state = "on";Preconditions.checkState("off".equals(state), "çŠ¶æ€å¿…é¡»ä¸ºoff");æ ¡éªŒå…ƒç´ ä¸ªæ•°æ ¡éªŒä¸é€šè¿‡ï¼ŒæŠ›å‡ºIndexOutOfBoundsExceptionï¼š12List&lt;String&gt; list = ImmutableList.of();Preconditions.checkElementIndex(10, list.size(), "ä¸‹æ ‡è¶Šç•Œï¼Œä¸å­˜åœ¨ç¬¬10ä¸ªå…ƒç´ ");IOæ“ä½œæ¼”ç¤ºä¹‹å‰å…ˆåˆ›å»ºä¸€ä¸ªsource.txtæ–‡ä»¶ï¼š12Guava I/O operationGuava I/O æ“ä½œç›¸å…³å¸¸é‡ï¼š12private static final String SOURCE_FILE = "C:\\Users\\Administrator\\Desktop\\guavatest\\src\\test\\java\\cc\\mrbird\\resources\\source.txt";private static final String TARGET_FILE = "C:\\Users\\Administrator\\Desktop\\guavatest\\src\\test\\java\\cc\\mrbird\\resources\\target.txt";æ–‡ä»¶æ‹·è´123File targetFile = new File(TARGET_FILE);Files.copy(new File(SOURCE_FILE), targetFile);System.out.println(targetFile.exists()); // trueæ–‡ä»¶ç§»åŠ¨1Files.move(new File(SOURCE_FILE), new File(TARGET_FILE));æ–‡ä»¶ç§»åŠ¨å’Œæ–‡ä»¶æ‹·è´çš„åŒºåˆ«æ˜¯ï¼Œæ–‡ä»¶ç§»åŠ¨ä¼šåˆ é™¤æºæ–‡ä»¶ï¼šè¯»å–æ–‡ä»¶å†…å®¹å°†æ–‡ä»¶å†…å®¹è¯»å–åˆ°Stringé›†åˆä¸­ï¼š12List&lt;String&gt; list = Files.readLines(new File(SOURCE_FILE), Charsets.UTF_8);list.forEach(System.out::println);è¯»çš„è¿‡ç¨‹ä¸­è¿›è¡Œä¸€äº›åŠ å·¥ï¼š12345678910111213141516LineProcessor&lt;List&lt;String&gt;&gt; lineProcessor = new LineProcessor&lt;List&lt;String&gt;&gt;() &#123; List&lt;String&gt; result = Lists.newArrayList(); @Override public boolean processLine(String line) &#123; if (line.length() != 0) &#123; result.add(line + "ã€‚"); &#125; return true; &#125; @Override public List&lt;String&gt; getResult() &#123; return result; &#125;&#125;;List&lt;String&gt; result = Files.asCharSource(new File(SOURCE_FILE), Charsets.UTF_8).readLines(lineProcessor);System.out.println(result); // [Guava I/O operationã€‚, Guava I/O æ“ä½œã€‚]å†™æ“ä½œè¿½åŠ æ“ä½œï¼š1234567File file = new File(SOURCE_FILE);String value = "æ·»åŠ ä¸€äº›å†…å®¹";CharSink charSink = Files.asCharSink(file, Charsets.UTF_8, FileWriteMode.APPEND); // è¿½åŠ charSink.write(value);String read = Files.asCharSource(file, Charsets.UTF_8).read();System.out.println(read);è¦†ç›–æ“ä½œï¼š1234567File file = new File(SOURCE_FILE);String value = "æ·»åŠ ä¸€äº›å†…å®¹";CharSink charSink = Files.asCharSink(file, Charsets.UTF_8); // è¦†ç›–charSink.write(value);String read = Files.asCharSource(file, Charsets.UTF_8).read();System.out.println(read);æ–‡ä»¶è½¬ä¸ºå“ˆå¸Œç 123File file = new File(SOURCE_FILE);HashCode hash = Files.asByteSource(file).hash(Hashing.sha256());System.out.println(hash); // c46982603d4b2ba5032d73dc1fffbe1aea1f11d75921b2839632c56636673d31æ–‡ä»¶åˆ›å»º12345String TOUCH_FILE = "C:\\Users\\Administrator\\Desktop\\guavatest\\src\\test\\java\\cc\\mrbird\\resources\\new.txt";File file = new File(TOUCH_FILE);Files.touch(file);boolean exists = file.exists();System.out.println(exists); // trueé€’å½’æ“ä½œç”±æµ…å…¥æ·±ï¼š12345678910File file = new File("C:\\Users\\Administrator\\Desktop\\guavatest\\src\\test\\java\\cc\\mrbird");// depthFirstPreOrder ç”±æµ…å…¥æ·±Iterable&lt;File&gt; files = Files.fileTraverser().depthFirstPreOrder(file);files.forEach(f -&gt; &#123; if (f.isDirectory()) &#123; System.out.println("directory: " + f); &#125; else &#123; System.out.println("file: " + f); &#125;&#125;);ç”±æ·±å…¥æµ…ï¼š12345678910File file = new File("C:\\Users\\Administrator\\Desktop\\guavatest\\src\\test\\java\\cc\\mrbird");// depthFirstPostOrder ç”±æ·±å…¥æµ…Iterable&lt;File&gt; files = Files.fileTraverser().depthFirstPostOrder(file);files.forEach(f -&gt; &#123; if (f.isDirectory()) &#123; System.out.println("directory: " + f); &#125; else &#123; System.out.println("file: " + f); &#125;&#125;);]]></content>
      <tags>
        <tag>guava</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NIO2æŽ¥å£æ–¹æ³•]]></title>
    <url>%2FNIO2%E6%8E%A5%E5%8F%A3%E6%96%B9%E6%B3%95.html</url>
    <content type="text"><![CDATA[JDK7å¯¹NIOè¿›è¡Œäº†æžå¤§çš„æ‰©å±•ï¼Œå¢žå¼ºäº†å¯¹æ–‡ä»¶å¤„ç†å’Œæ–‡ä»¶ç³»ç»Ÿç‰¹æ€§çš„æ”¯æŒï¼Œä»¥è‡³äºŽæˆ‘ä»¬ç§°ä»–ä»¬ä¸º NIO.2ã€‚å› ä¸ºNIO æä¾›çš„ä¸€äº›åŠŸèƒ½ï¼ŒNIOå·²ç»æˆä¸ºæ–‡ä»¶å¤„ç†ä¸­è¶Šæ¥è¶Šé‡è¦çš„éƒ¨åˆ†ã€‚Path ä¸Ž Pathsjava.nio.file.PathæŽ¥å£ä»£è¡¨ä¸€ä¸ªå¹³å°æ— å…³çš„å¹³å°è·¯å¾„ï¼Œæè¿°äº†ç›®å½•ç»“æž„ä¸­æ–‡ä»¶çš„ä½ç½®ã€‚Pathsæä¾›çš„get()æ–¹æ³•ç”¨æ¥èŽ·å–Pathå¯¹è±¡ï¼šPath get(String first, String â€¦ more)ï¼šç”¨äºŽå°†å¤šä¸ªå­—ç¬¦ä¸²ä¸²è¿žæˆè·¯å¾„ã€‚Pathå¸¸ç”¨æ–¹æ³•ï¼šboolean endsWith(String path)ï¼š åˆ¤æ–­æ˜¯å¦ä»¥ path è·¯å¾„ç»“æŸï¼›boolean startsWith(String path)ï¼šåˆ¤æ–­æ˜¯å¦ä»¥ path è·¯å¾„å¼€å§‹ï¼›boolean isAbsolute()ï¼š åˆ¤æ–­æ˜¯å¦æ˜¯ç»å¯¹è·¯å¾„ï¼›Path getFileName()ï¼š è¿”å›žä¸Žè°ƒç”¨ Path å¯¹è±¡å…³è”çš„æ–‡ä»¶åï¼›Path getName(int idx)ï¼šè¿”å›žçš„æŒ‡å®šç´¢å¼•ä½ç½® idx çš„è·¯å¾„åç§°ï¼›int getNameCount()ï¼šè¿”å›žPath æ ¹ç›®å½•åŽé¢å…ƒç´ çš„æ•°é‡ï¼›Path getParent() ï¼šè¿”å›žPathå¯¹è±¡åŒ…å«æ•´ä¸ªè·¯å¾„ï¼Œä¸åŒ…å« Path å¯¹è±¡æŒ‡å®šçš„æ–‡ä»¶è·¯å¾„ï¼›Path getRoot() ï¼šè¿”å›žè°ƒç”¨ Path å¯¹è±¡çš„æ ¹è·¯å¾„ï¼›Path resolve(Path p) ï¼šå°†ç›¸å¯¹è·¯å¾„è§£æžä¸ºç»å¯¹è·¯å¾„ï¼›Path toAbsolutePath()ï¼šä½œä¸ºç»å¯¹è·¯å¾„è¿”å›žè°ƒç”¨ Path å¯¹è±¡ï¼›String toString()ï¼šè¿”å›žè°ƒç”¨ Path å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚Files ç±»java.nio.file.Files ç”¨äºŽæ“ä½œæ–‡ä»¶æˆ–ç›®å½•çš„å·¥å…·ç±»ã€‚Fileså¸¸ç”¨æ–¹æ³•ï¼ˆå¢žåˆ æ”¹ï¼‰ï¼šPath copy(Path src, Path dest, CopyOption â€¦ how)ï¼šæ–‡ä»¶çš„å¤åˆ¶ï¼›Path createDirectory(Path path, FileAttribute&lt;?&gt; â€¦ attr)ï¼šåˆ›å»ºä¸€ä¸ªç›®å½•ï¼›Path createFile(Path path, FileAttribute&lt;?&gt; â€¦ arr)ï¼šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼›void delete(Path path)ï¼šåˆ é™¤ä¸€ä¸ªæ–‡ä»¶ï¼›Path move(Path src, Path dest, CopyOptionâ€¦how)ï¼šå°† src ç§»åŠ¨åˆ° dest ä½ç½®ï¼›long size(Path path)ï¼šè¿”å›ž path æŒ‡å®šæ–‡ä»¶çš„å¤§å°ã€‚Fileså¸¸ç”¨æ–¹æ³•ï¼ˆåˆ¤æ–­ç±»ï¼‰ï¼šboolean exists(Path path, LinkOption â€¦ opts)ï¼šåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼›boolean isDirectory(Path path, LinkOption â€¦ opts)ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯ç›®å½•ï¼›boolean isExecutable(Path path)ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼›boolean isHidden(Path path)ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯éšè—æ–‡ä»¶ï¼›boolean isReadable(Path path)ï¼šåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯è¯»ï¼›boolean isWritable(Path path)ï¼šåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯å†™ï¼›boolean notExists(Path path, LinkOption â€¦ opts)ï¼šåˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸å­˜åœ¨ï¼›public static &lt;A extends BasicFileAttributes&gt; A readAttributes(Path path,Class&lt;A&gt; type,LinkOption... options)ï¼šèŽ·å–ä¸Ž path æŒ‡å®šçš„æ–‡ä»¶ç›¸å…³è”çš„å±žæ€§ã€‚Fileså¸¸ç”¨æ–¹æ³•ï¼ˆå†…å®¹æ“ä½œï¼‰ï¼šSeekableByteChannel newByteChannel(Path path, OpenOptionâ€¦how)ï¼šèŽ·å–ä¸ŽæŒ‡å®šæ–‡ä»¶çš„è¿žæŽ¥ï¼Œhow æŒ‡å®šæ‰“å¼€æ–¹å¼ã€‚DirectoryStream newDirectoryStream(Path path)ï¼šæ‰“å¼€ path æŒ‡å®šçš„ç›®å½•InputStream newInputStream(Path path, OpenOptionâ€¦how)ï¼šèŽ·å– InputStream å¯¹è±¡OutputStream newOutputStream(Path path, OpenOptionâ€¦how)ï¼šèŽ·å– OutputStream å¯¹è±¡]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Guava RateLimiter]]></title>
    <url>%2FGuava-RateLimiter.html</url>
    <content type="text"><![CDATA[Google Guavaæä¾›çš„RateLimiterä½¿ç”¨çš„æ˜¯ä»¤ç‰Œæ¡¶ç®—æ³•ã€‚ä»¤ç‰Œæ¡¶ç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ä»¥å›ºå®šçš„é€ŸçŽ‡ç”Ÿæˆä»¤ç‰Œï¼Œåœ¨æ‰§è¡Œè¯·æ±‚ä¹‹å‰éƒ½éœ€è¦ä»Žä»¤ç‰Œæ¡¶é‡ŒèŽ·å–è¶³å¤Ÿçš„ä»¤ç‰Œã€‚å½“ä»¤ç‰Œæ•°é‡ä¸è¶³çš„æ—¶å€™ï¼Œè¯·æ±‚å°†è¢«é˜»å¡žè¿›å…¥ç­‰å¾…çŠ¶æ€æˆ–è€…ç›´æŽ¥è¿”å›žå¤±è´¥ã€‚RateLimiterå¸¸ç”¨äºŽé™åˆ¶è®¿é—®èµ„æºçš„é€ŸçŽ‡ã€‚RateLimiterä½¿ç”¨ç¤ºä¾‹ä¸‹é¢æ˜¯ä¸€ä¸ªRateLimiterçš„ç®€å•ä½¿ç”¨ç¤ºä¾‹ï¼š1234567891011121314public class RateLimiterTest &#123; // 1ç§’é’Ÿäº§ç”Ÿ0.5å¼ ä»¤ç‰Œ private final static RateLimiter limiter = RateLimiter.create(0.5); public static void main(String[] args) &#123; ExecutorService service = Executors.newFixedThreadPool(5); IntStream.range(0, 5).forEach(i -&gt; service.submit(RateLimiterTest::testLimiter)); service.shutdown(); &#125; private static void testLimiter() &#123; System.out.println(Thread.currentThread() + " waiting " + limiter.acquire()); &#125;&#125;æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªRateLimiterå®žä¾‹ï¼Œæ¯ç§’é’Ÿäº§ç”Ÿ0.5å¼ ä»¤ç‰Œï¼Œå³æ¯2ç§’é’Ÿäº§ç”Ÿ1å¼ ä»¤ç‰Œã€‚testLimiteræ–¹æ³•ä¸­é€šè¿‡limiter.acquire()æ–¹æ³•èŽ·å–ä»¤ç‰Œï¼ˆä¸å¸¦å‚æ•°æ—¶é»˜è®¤èŽ·å–1å¼ ä»¤ç‰Œï¼‰ã€‚Executors.newFixedThreadPool(5)ç”Ÿæˆäº”ä¸ªçº¿ç¨‹ï¼Œå¹¶å‘è°ƒç”¨testLimiteræ–¹æ³•ï¼Œæ‰§è¡Œä»£ç ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š12345Thread[pool-1-thread-1,5,main] waiting 0.0Thread[pool-1-thread-5,5,main] waiting 1.908947Thread[pool-1-thread-4,5,main] waiting 3.908935Thread[pool-1-thread-3,5,main] waiting 5.908919Thread[pool-1-thread-2,5,main] waiting 7.908808å¯ä»¥çœ‹åˆ°æ¯ä¸ªçº¿ç¨‹è°ƒç”¨æ—¶é—´ç›¸éš”å¤§çº¦ä¸º2ç§’é’Ÿã€‚å¯èƒ½ä½ ä¼šé—®ï¼Œä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªçº¿ç¨‹æ²¡æœ‰ç­‰å¾…2ç§’ï¼Œç›´æŽ¥å°±èŽ·å–åˆ°äº†ä»¤ç‰Œç„¶åŽæ‰§è¡Œäº†å‘¢ï¼ŸGuava RateLimiterå…è®¸æŸæ¬¡è¯·æ±‚èŽ·å–è¶…å‡ºå‰©ä½™ä»¤ç‰Œæ•°çš„ä»¤ç‰Œï¼Œä½†æ˜¯ä¸‹ä¸€æ¬¡è¯·æ±‚å°†ä¸ºæ­¤ä»˜å‡ºä»£ä»·ï¼Œä¸€ç›´ç­‰åˆ°ä»¤ç‰Œäºç©ºè¡¥ä¸Šã€‚å†æ¥çœ‹ä¸€ä¸ªRateLimiterçš„ä¾‹å­ï¼š123456789public class RateLimiterTest &#123; public static void main(String[] args) &#123; RateLimiter limiter = RateLimiter.create(1); System.out.println(limiter.acquire(4)); System.out.println(limiter.acquire(3)); System.out.println(limiter.acquire(2)); System.out.println(limiter.acquire(1)); &#125;&#125;ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š12340.03.9966022.9974482.000229ä¸Šé¢ä¾‹å­é’Ÿï¼Œä¸€ç§’é’Ÿäº§ç”Ÿä¸€å¼ ä»¤ç‰Œï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚ç›´æŽ¥å–å‡º4å¼ ä»¤ç‰Œï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡è¯·æ±‚éœ€è¦ç­‰å¾…4/1ç§’æ‰èƒ½å–åˆ°ä»¤ç‰Œã€‚ç»è¿‡å¤§çº¦4ç§’åŽï¼Œç¬¬äºŒæ¬¡è¯·æ±‚ç›´æŽ¥å–å‡º3å¼ ä»¤ç‰Œï¼Œæ‰€ä»¥ç¬¬ä¸‰æ¬¡è¯·æ±‚éœ€è¦ç­‰å¾…3/1ç§’åŽæ‰èƒ½å–åˆ°ä»¤ç‰Œï¼Œä¾æ­¤ç±»æŽ¨ã€‚è®¾ç½®è¶…æ—¶æ—¶é—´æˆ‘ä»¬å¯ä»¥è®¾ç½®ç­‰å¾…ä»¤ç‰Œçš„è¶…æ—¶æ—¶é—´ï¼Œå¦‚æžœç­‰å¾…ä»¤ç‰Œçš„æ—¶é—´å¤§äºŽè¶…æ—¶æ—¶é—´ï¼Œå°†ç›´æŽ¥è¿”å›žfalseï¼Œä¸å†ç­‰å¾…ï¼š1234567public class RateLimiterTest &#123; public static void main(String[] args) &#123; RateLimiter limiter = RateLimiter.create(1); System.out.println(limiter.acquire(3)); System.out.println(limiter.tryAcquire(1, 2, TimeUnit.SECONDS)); &#125;&#125;ä¸Šé¢ä¾‹å­limiter.tryAcquireè®¾ç½®äº†è¶…æ—¶æ—¶é—´ä¸º2ç§’ï¼Œç”±äºŽç¬¬ä¸€æ¬¡è¯·æ±‚ä¸€æ¬¡æ€§èŽ·å–äº†3å¼ ä»¤ç‰Œï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ç­‰å¾…å¤§çº¦3ç§’é’Ÿï¼Œè¶…å‡ºäº†2ç§’çš„è¶…æ—¶æ—¶é—´ï¼Œæ‰€ä»¥limiter.tryAcquireä¸ä¼šç­‰å¾…3ç§’ï¼Œè€Œæ˜¯ç›´æŽ¥è¿”å›žfalseã€‚]]></content>
      <tags>
        <tag>guava</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Guava ç¼“å­˜]]></title>
    <url>%2FGuava-Cache.html</url>
    <content type="text"><![CDATA[Guavaç¼“å­˜æ˜¯è½»é‡çº§çš„ï¼Œå®ƒå°†å†…å®¹ç¼“å­˜åˆ°è¿è¡Œå†…å­˜ä¸­ã€‚å¦‚æžœç³»ç»Ÿä¸­æŸäº›å€¼ï¼ˆæ¯”å¦‚ä¸€äº›é…ç½®è¡¨ï¼‰è¢«é¢‘ç¹æŸ¥è¯¢ä½¿ç”¨ï¼Œå¹¶ä¸”æˆ‘ä»¬æ„¿æ„æ¶ˆè€—ä¸€äº›å†…å­˜ç©ºé—´æ¥æå‡åº”ç”¨çš„é€Ÿåº¦ï¼Œå‡è½»æ•°æ®åº“åŽ‹åŠ›çš„è¯ï¼ŒGuavaç¼“å­˜å°†ä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ç”±äºŽç¼“å­˜æ˜¯å­˜å‚¨åœ¨è¿è¡Œå†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç¡®ä¿ç¼“å­˜çš„å¤§å°ä¸è¶…å‡ºå†…å­˜çš„å®¹é‡ã€‚åˆ›å»ºç¼“å­˜æˆ‘ä»¬å¯ä»¥ç›´æŽ¥åˆ›å»ºGuavaç¼“å­˜å¯¹è±¡ï¼Œè€Œä¸ä½¿ç”¨ä»»ä½•çš„CacheLoaderï¼š1234Cache&lt;String, String&gt; cache = CacheBuilder.newBuilder().build();cache.put("hello", "world");System.out.println(cache.getIfPresent("hello")); // worldkeyå€¼æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œæ‰€ä»¥ä½¿ç”¨cache.getIfPresent(&quot;HELLO&quot;)å°†è¿”å›žnullå€¼ã€‚æŽ¥ä¸‹æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨CacheLoaderåˆ›å»ºç¼“å­˜å¯¹è±¡ï¼š123456789101112131415CacheLoader&lt;String, String&gt; loader = new CacheLoader&lt;String, String&gt;() &#123; @Override public String load(String key) &#123; return sayHello(key); &#125;&#125;;LoadingCache&lt;String, String&gt; cache = CacheBuilder.newBuilder().build(loader);String mrbird = cache.getUnchecked("mrbird");System.out.println(mrbird); // hello mrbird...private String sayHello(String key) &#123; return String.format("hello %s", key);&#125;æ–¹æ³•getUncheckedä½œç”¨ä¸ºï¼šå½“å€¼ä¸å­˜åœ¨æ—¶ï¼Œä¼šé€šè¿‡CacheLoaderè®¡ç®—å‡ºå€¼ï¼Œç„¶åŽå­˜åˆ°ç¼“å­˜ä¸­ã€‚é©±é€æœºåˆ¶æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€äº›é©±é€ç¼“å­˜çš„æœºåˆ¶æ¥é™åˆ¶ç¼“å­˜çš„å¤§å°ã€‚é™åˆ¶ç¼“å­˜æ•°ç›®æˆ‘ä»¬å¯ä»¥é€šè¿‡maximumSizeæ¥é™åˆ¶ç¼“å­˜çš„æ¡ç›®ï¼š12345678910Cache&lt;String, String&gt; cache = CacheBuilder.newBuilder().maximumSize(3).build();cache.put("k1", "v1");cache.put("k2", "v2");cache.put("k3", "v3");cache.put("k4", "v4");System.out.println(cache.size()); // 3System.out.println(cache.getIfPresent("k1")); // nullSystem.out.println(cache.asMap()); // &#123;k3=v3, k4=v4, k2=v2&#125;æˆ‘ä»¬é™åˆ¶æœ€å¤šåªèƒ½å­˜å‚¨3ä¸ªå€¼ï¼Œæ‰€ä»¥k4çš„å­˜å…¥æŠŠæœ€æ—©çš„k1ç»™é©±é€å‡ºåŽ»äº†ï¼Œç±»ä¼¼äºŽFIFOã€‚é™åˆ¶ç¼“å­˜å¤§å°æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æƒé‡å‡½æ•°æ¥é™åˆ¶ç¼“å­˜çš„å¤§å°ï¼š123456789101112Weigher&lt;String, String&gt; weigher = (key, value) -&gt; value.length();Cache&lt;String, String&gt; cache = CacheBuilder.newBuilder().maximumWeight(15).weigher(weigher).build();cache.put("k1", "11111");cache.put("k2", "22222");cache.put("k3", "33333");cache.put("k4", "4444");cache.put("k5", "5555");System.out.println(cache.size()); // 3System.out.println(cache.getIfPresent("k1")); // nullSystem.out.println(cache.asMap()); // &#123;k3=33333, k5=5555, k4=4444&#125;ä¸Šé¢ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡maximumWeight(15)æŒ‡å®šäº†ç¼“å­˜çš„æœ€å¤§å®¹é‡ï¼Œæƒé‡è§„åˆ™ä¸ºvalueçš„é•¿åº¦ã€‚k3ï¼Œk4å’Œk5çš„valueé•¿åº¦åŠ èµ·æ¥ä¸º13ï¼Œæ‰€ä»¥k1å’Œk2çš„å€¼å­˜ä¸å°äº†ï¼Œè¢«é©±é€ã€‚è®¾ç½®ç¼“å­˜æ—¶é—´æˆ‘ä»¬å¯ä»¥è®¾ç½®ç¼“å­˜çš„æœ‰æ•ˆæ—¶é—´å’Œç¼“å­˜çš„æ´»è·ƒæ—¶é—´ã€‚è®¾ç½®ç¼“å­˜çš„æ´»è·ƒæ—¶é—´ä¸º2sï¼š1234567891011121314Cache&lt;String, String&gt; cache = CacheBuilder.newBuilder().expireAfterAccess(2, TimeUnit.SECONDS).build();cache.put("k1", "v1");cache.put("k2", "v2");cache.getIfPresent("k1");TimeUnit.SECONDS.sleep(1);cache.getIfPresent("k1");TimeUnit.SECONDS.sleep(1);System.out.println(cache.getIfPresent("k1")); // v1System.out.println(cache.getIfPresent("k2")); // nullSystem.out.println(cache.size()); // 1System.out.println(cache.asMap()); // &#123;k1=v1&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡cache.getIfPresent(&quot;k1&quot;)èŽ·å–äº†k1çš„å€¼ï¼Œç„¶åŽè®©çº¿ç¨‹é˜»å¡ž1ç§’ï¼Œè¿™æ—¶å€™k1å’Œk2çš„æœ‰æ•ˆæ—¶é—´å¤§çº¦ä¸º1ç§’å·¦å³ã€‚æŽ¥ç€åˆèŽ·å–äº†k1çš„å€¼ï¼Œæ‰€ä»¥k1çš„æœ‰æ•ˆæ—¶é—´è¿˜æ˜¯2ç§’ï¼Œk2ä¸º1ç§’ï¼Œå†æ¬¡è®©çº¿ç¨‹é˜»å¡ž1ç§’åŽï¼Œk1çš„æœ‰æ•ˆæ—¶é—´ä¸º1ç§’ï¼Œk2å·²ç»å¤±æ•ˆäº†ã€‚æ‰“å°è¾“å‡ºçš„ç»“æžœå’Œæˆ‘ä»¬é¢„æœŸçš„ä¸€è‡´ã€‚è®¾ç½®ç¼“å­˜çš„æœ‰æ•ˆæ—¶é—´ä¸º2sï¼š1234567891011121314 Cache&lt;String, String&gt; cache = CacheBuilder.newBuilder().expireAfterWrite(2, TimeUnit.SECONDS).build();cache.put("k1", "v1");cache.put("k2", "v2");cache.getIfPresent("k1");TimeUnit.SECONDS.sleep(1);cache.getIfPresent("k1");TimeUnit.SECONDS.sleep(1);System.out.println(cache.getIfPresent("k1")); // nullSystem.out.println(cache.getIfPresent("k2")); // nullSystem.out.println(cache.size()); // 0System.out.println(cache.asMap()); // &#123;&#125;å› ä¸ºæˆ‘ä»¬è®¾ç½®ç¼“å­˜æœ‰æ•ˆæ—¶é—´ä¸º2ç§’ï¼Œæ‰€ä»¥2ç§’åŽæ‰€æœ‰ç¼“å­˜éƒ½è¿‡æœŸå¤±æ•ˆäº†ï¼Œæ— è®ºæœŸé—´èŽ·å–è¿‡å¤šå°‘æ¬¡ç¼“å­˜ã€‚weakKeys&amp;softValuesé»˜è®¤æƒ…å†µä¸‹ï¼ŒGuavaç¼“å­˜é”®å€¼éƒ½æœ‰å¼ºå¼•ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨weakKeyså’ŒsoftValuesæ¥è®©é”®å€¼å˜ä¸ºå¼±å¼•ç”¨ï¼Œè¿™æ ·åžƒåœ¾æ”¶é›†å™¨åœ¨å¿…è¦çš„æƒ…å†µä¸‹å°†ä¼šå·¥ä½œï¼š1Cache&lt;String, String&gt; cache = CacheBuilder.newBuilder().weakKeys().softValues().build();åˆ·æ–°ç¼“å­˜å¯ä»¥é€šè¿‡refreshAfterWriteè®¾ç½®ç¼“å­˜è‡ªåŠ¨åˆ·æ–°é—´éš”ï¼Œæˆ–è€…å¯ä»¥ç›´æŽ¥è°ƒç”¨refreshæ–¹æ³•æ¥æ‰‹åŠ¨åˆ·æ–°ç¼“å­˜ï¼š1Cache&lt;String, String&gt; cache = CacheBuilder.newBuilder().refreshAfterWrite(1,TimeUnit.SECONDS).build();æ·»åŠ å¤šä¸ªç¼“å­˜å¯ä»¥é€šè¿‡putAllæ¥ä¸€æ¬¡æ€§æ·»åŠ å¤šä¸ªç¼“å­˜ï¼š12345678910Cache&lt;String, String&gt; cache = CacheBuilder.newBuilder().build();Map&lt;String, String&gt; map = Maps.newHashMap();map.put("k1", "v1");map.put("k2", "v2");map.put("k3", "v3");cache.putAll(map);System.out.println(cache.size()); // 3System.out.println(cache.asMap()); // &#123;k3=v3, k1=v1, k2=v2&#125;åˆ é™¤ç¼“å­˜Cache.invalidate(key)æ–¹æ³•é€šè¿‡keyæ¥åˆ é™¤ç¼“å­˜ï¼š123456789Cache&lt;String, String&gt; cache = CacheBuilder.newBuilder().build();Map&lt;String, String&gt; map = Maps.newHashMap();map.put("k1", "v1");cache.putAll(map);System.out.println(cache.asMap()); // &#123;k1=v1&#125;cache.invalidate("k1");System.out.println(cache.asMap()); // &#123;&#125;é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡Cache.invalidateAll(keys)ä¸€æ¬¡æ€§åˆ é™¤å¤šä¸ªç¼“å­˜æˆ–è€…Cache.invalidateAll()åˆ é™¤å…¨éƒ¨ç¼“å­˜ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ç»™åˆ é™¤äº‹ä»¶æ·»åŠ ç›‘å¬å™¨ï¼š1234567RemovalListener&lt;String, String&gt; listener = notification -&gt; System.out.println("ç›‘å¬åˆ°åˆ é™¤äº‹ä»¶ï¼Œkey=" + notification.getKey() + "ï¼Œvalue=" + notification.getValue());Cache&lt;String, String&gt; cache = CacheBuilder.newBuilder().removalListener(listener).build();cache.put("k1", "v1");cache.invalidate("k1"); // ç›‘å¬åˆ°åˆ é™¤äº‹ä»¶ï¼Œkey=k1ï¼Œvalue=v1å¢žåˆ æ”¹æŸ¥ç®€å•å°è£…ä¸€ä¸ªGuavaç¼“å­˜å·¥å…·ç±»ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283public class GuavaCacheUtil &#123; private static Logger logger = LoggerFactory.getLogger(GuavaCacheUtil.class); private static Cache&lt;String, String&gt; cache; static &#123; RemovalListener&lt;String, String&gt; listener = n -&gt; logger.info("ç›‘å¬åˆ°åˆ é™¤äº‹ä»¶ï¼Œkey=&#123;&#125;ï¼Œvalue=&#123;&#125;", n.getKey(), n.getValue()); cache = CacheBuilder.newBuilder() .removalListener(listener).build(); &#125; /** * æ·»åŠ ç¼“å­˜ * * @param key é”® * @param value å€¼ */ public void put(String key, String value) &#123; if (StringUtils.isNotBlank(key) &amp;&amp; StringUtils.isNotBlank(value)) &#123; cache.put(key, value); &#125; &#125; /** * æ‰¹é‡æ·»åŠ ç¼“å­˜ * * @param map key,valueé›†åˆ */ public void putAll(Map&lt;String, String&gt; map) &#123; cache.putAll(map); &#125; /** * åˆ é™¤ç¼“å­˜ * * @param key é”® */ public void remove(String key) &#123; if (StringUtils.isNotBlank(key)) &#123; cache.invalidate(key); &#125; &#125; /** * æ‰¹é‡åˆ é™¤ç¼“å­˜ * * @param keys keyé›†åˆ */ public void remove(List&lt;String&gt; keys) &#123; if (CollectionUtils.isNotEmpty(keys)) &#123; cache.invalidateAll(keys); &#125; &#125; /** * æ¸…ç©ºç¼“å­˜ */ public void removeAll() &#123; cache.invalidateAll(); &#125; /** * èŽ·å–ç¼“å­˜ * * @param key é”® * @return å€¼ */ public String get(String key) &#123; return StringUtils.isNotBlank(key) ? cache.getIfPresent(key) : null; &#125; /** * æ‰¹é‡èŽ·å–ç¼“å­˜ * * @param keys é”®é›†åˆ * @return å€¼é›†åˆ */ public ImmutableMap&lt;String, String&gt; get(List&lt;String&gt; keys) &#123; return CollectionUtils.isNotEmpty(keys) ? cache.getAllPresent(keys) : null; &#125;&#125;]]></content>
      <tags>
        <tag>guava</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Guava é›†åˆæ“ä½œ]]></title>
    <url>%2FGuava-Collection.html</url>
    <content type="text"><![CDATA[ä¸å¯å˜é›†åˆä¸å¯å˜é›†åˆä¾‹å­ï¼š12ImmutableSet&lt;String&gt; FRUITS = ImmutableSet.of("apple", "watermelon", "cherry", "mango");FRUITS.remove("apple");å°†æŠ›å‡ºjava.lang.UnsupportedOperationExceptionå¼‚å¸¸ï¼š åˆ›å»ºä¸å¯å˜é›†åˆof12ImmutableList&lt;String&gt; immutableList = ImmutableList.of("a", "b", "c");ImmutableMap&lt;Integer, String&gt; immutableMap = ImmutableMap.of(1, "v1", 2, "v2", 3, "v3")copyOf12Map&lt;String, String&gt; map = Maps.newHashMap();ImmutableMap&lt;String, String&gt; immutableMap = ImmutableMap.copyOf(map);builder12345678910Map&lt;String, String&gt; map = Maps.newHashMap();ImmutableMap&lt;String, String&gt; immutableMap = ImmutableMap.&lt;String, String&gt;builder() .putAll(map) .put("k1", "v1") .build();List&lt;String&gt; list = Lists.newArrayList();ImmutableList&lt;String&gt; immutableList = ImmutableList.&lt;String&gt;builder() .addAll(list) .build();é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»ŽJava 8 Streamä¸­åˆ›å»ºä¸å¯å˜é›†åˆï¼š12345678import static java.util.stream.Collectors.*;...List&lt;String&gt; list = Arrays.asList("a", "b", "c");List&lt;String&gt; immutableList = list.stream() .collect(collectingAndThen(toList(), ImmutableList::copyOf));System.out.println(immutableList.getClass()); // class com.google.common.collect.RegularImmutableListä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨Guavaæä¾›çš„æ”¶é›†å™¨ï¼š12345List&lt;String&gt; list = Arrays.asList("a", "b", "c");List&lt;String&gt; immutableList = list.stream() .collect(ImmutableList.toImmutableList());System.out.println(immutableList.getClass()); // class com.google.common.collect.RegularImmutableListä¸å¯å˜é›†åˆä¼˜ç‚¹å½“å¯¹è±¡è¢«ä¸å¯ä¿¡çš„åº“è°ƒç”¨æ—¶ï¼Œä¸å¯å˜å½¢å¼æ˜¯å®‰å…¨çš„ï¼›ä¸å¯å˜å¯¹è±¡è¢«å¤šä¸ªçº¿ç¨‹è°ƒç”¨æ—¶ï¼Œä¸å­˜åœ¨ç«žæ€æ¡ä»¶é—®é¢˜ä¸å¯å˜é›†åˆä¸éœ€è¦è€ƒè™‘å˜åŒ–ï¼Œå› æ­¤å¯ä»¥èŠ‚çœæ—¶é—´å’Œç©ºé—´ã€‚æ‰€æœ‰ä¸å¯å˜çš„é›†åˆéƒ½æ¯”å®ƒä»¬çš„å¯å˜å½¢å¼æœ‰æ›´å¥½çš„å†…å­˜åˆ©ç”¨çŽ‡ï¼ˆåˆ†æžå’Œæµ‹è¯•ç»†èŠ‚ï¼‰ï¼›ä¸å¯å˜å¯¹è±¡å› ä¸ºæœ‰å›ºå®šä¸å˜ï¼Œå¯ä»¥ä½œä¸ºå¸¸é‡æ¥å®‰å…¨ä½¿ç”¨ã€‚æ–°é›†åˆç±»åž‹Guavaæä¾›äº†è®¸å¤šJDKæ²¡æœ‰çš„é›†åˆç±»åž‹ã€‚RangeSetRangeSetä¸€ç»„ä¸ç›¸è¿žçš„ã€éžç©ºçš„åŒºé—´ï¼ŒåŸºæœ¬å®žçŽ°ä¸ºTreeRangeSetï¼Œçœ‹ä¸ªRangeSetçš„ä¾‹å­ï¼š123456789101112131415RangeSet&lt;Integer&gt; rangeSet = TreeRangeSet.create();rangeSet.add(Range.closed(1, 10));System.out.println(rangeSet); // [[1..10]]rangeSet.add(Range.closedOpen(11, 15));System.out.println(rangeSet); // ä¸ç›¸è¿žåŒºé—´ [[1..10], [11..15)]rangeSet.add(Range.closedOpen(15, 20));System.out.println(rangeSet); // ç›¸è¿žåŒºé—´ [[1..10], [11..20)]rangeSet.add(Range.openClosed(0, 0));System.out.println(rangeSet); // ç©ºåŒºé—´ [[1..10], [11..20)]rangeSet.remove(Range.open(5, 10)); System.out.println(rangeSet); // åŒºé—´åˆ†å‰² [[1..5], [10..10], [11..20)]æŸ¥çœ‹RangeSetçš„èŒƒå›´è·¨åº¦ï¼š1234567RangeSet&lt;Integer&gt; rangeSet = TreeRangeSet.create();rangeSet.add(Range.closed(1, 10));rangeSet.add(Range.closedOpen(11, 15));Range&lt;Integer&gt; span = rangeSet.span();System.out.println(span.lowerEndpoint().intValue()); // 1System.out.println(span.upperEndpoint().intValue()); // 15ä»Žå·²æœ‰çš„RangeSetèŽ·å–ä¸€ä¸ªå­èŒƒå›´RangeSetï¼š123456789RangeSet&lt;Integer&gt; numberRangeSet = TreeRangeSet.create();numberRangeSet.add(Range.closed(0, 2));numberRangeSet.add(Range.closed(3, 5));numberRangeSet.add(Range.closed(5, 8));RangeSet&lt;Integer&gt; numberSubRangeSet = numberRangeSet.subRangeSet(Range.closed(4, 14));System.out.println(numberRangeSet); // [[0..2], [3..8]]System.out.println(numberSubRangeSet); // [[4..8]]èŽ·å–é™¤äº†RangeSetèŒƒå›´å¤–çš„RangeSetï¼š123456789RangeSet&lt;Integer&gt; numberRangeSet = TreeRangeSet.create();numberRangeSet.add(Range.closed(0, 2));numberRangeSet.add(Range.closed(3, 5));numberRangeSet.add(Range.closed(6, 8));RangeSet&lt;Integer&gt; numberRangeComplementSet = numberRangeSet.complement();System.out.println(numberRangeSet); // [[0..2], [3..5], [6..8]]System.out.println(numberRangeComplementSet); // [(-âˆž..0), (2..3), (5..6), (8..+âˆž)]åˆ¤æ–­ä¸€ä¸ªRangeSetæ˜¯å¦å’Œå¦ä¸€ä¸ªèŒƒå›´æœ‰äº¤é›†ï¼š12345678RangeSet&lt;Integer&gt; numberRangeSet = TreeRangeSet.create();numberRangeSet.add(Range.closed(0, 2));numberRangeSet.add(Range.closed(3, 10));numberRangeSet.add(Range.closed(15, 18));System.out.println(numberRangeSet); // [[0..2], [3..10], [15..18]]System.out.println(numberRangeSet.intersects(Range.closed(4, 17))); // trueéåŽ†RangeSetçš„èŒƒå›´åŒºé—´ï¼š12345678RangeSet&lt;Integer&gt; numberRangeSet = TreeRangeSet.create();numberRangeSet.add(Range.closed(0, 2));numberRangeSet.add(Range.closed(3, 10));numberRangeSet.add(Range.closed(15, 18));Set&lt;Range&lt;Integer&gt;&gt; ranges = numberRangeSet.asRanges();ranges.forEach(System.out::print); // [0..2][3..10][15..18]ä»ŽRangeSetä¸­èŽ·å–åŒ…å«æŸä¸ªå€¼çš„è®¿é—®åŒºé—´ï¼š1234567RangeSet&lt;Integer&gt; numberRangeSet = TreeRangeSet.create();numberRangeSet.add(Range.closed(0, 2));numberRangeSet.add(Range.closed(3, 10));numberRangeSet.add(Range.closed(15, 18));System.out.println(numberRangeSet.rangeContaining(7)); // [3..10]RangeMapRangeMapæ˜¯ä¸€ç»„ä¸ç›¸è¿žçš„ã€éžç©ºçš„åŒºé—´ä¸ŽæŒ‡å®šå€¼çš„æ˜ å°„ï¼ŒåŸºæœ¬å®žçŽ°ä¸ºTreeRangeMapå…‰è¿™æ ·è¯´æœ‰ç‚¹æŠ½è±¡ï¼Œçœ‹äº›ä¾‹å­:123456789101112RangeMap&lt;Integer, String&gt; rangeMap = TreeRangeMap.create();rangeMap.put(Range.closed(1, 10), "foo");System.out.println(rangeMap); // [[1..10]=foo]rangeMap.put(Range.open(3, 6), "bar");System.out.println(rangeMap); // [[1..3]=foo, (3..6)=bar, [6..10]=foo]rangeMap.put(Range.open(10, 20), "eoo");System.out.println(rangeMap); // [[1..3]=foo, (3..6)=bar, [6..10]=foo, (10..20)=eoo]rangeMap.remove(Range.closed(5, 11));System.out.println(rangeMap); // [[1..3]=foo, (3..5)=bar, (11..20)=eoo]ä»ŽRangeMapä¸­èŽ·å–ä¸€ä¸ªEntryï¼š123456789RangeMap&lt;Integer, String&gt; rangeMap = TreeRangeMap.create();rangeMap.put(Range.closed(0, 2), "foo");rangeMap.put(Range.closed(3, 5), "bar");rangeMap.put(Range.closed(6, 8), "eoo");Map.Entry&lt;Range&lt;Integer&gt;, String&gt; entry = rangeMap.getEntry(7);System.out.println(entry.getKey()); // [6..8]System.out.println(entry.getValue()); // eooå‰©ä¸‹çš„æ“ä½œå’ŒRangeSetå·®ä¸å¤šã€‚BiMapBiMapæ˜¯ä¸€ç§ç‰¹æ®Šçš„ï¼ŒåŒå‘æ˜ å°„çš„Mapï¼Œå¯ä»¥ç¡®ä¿ä¸ä¼šå‡ºçŽ°é‡å¤çš„å€¼å¹¶ä¸”æˆ‘ä»¬æ€»æ˜¯å¯ä»¥å®‰å…¨åœ°é€šè¿‡keyèŽ·å–åˆ°valueã€‚BiMapçš„åŸºæœ¬å®žçŽ°ä¸ºHashBiMapã€‚çœ‹çœ‹ä¾‹å­ï¼š12345678BiMap&lt;String, String&gt; biMap = HashBiMap.create();biMap.put("k1", "v1");biMap.put("k2", "v2");biMap.put("k3", "v3");System.out.println(biMap); // &#123;k1=v1, k2=v2, k3=v3&#125;BiMap&lt;String, String&gt; inverse = biMap.inverse();System.out.println(inverse); // &#123;v1=k1, v2=k2, v3=k3&#125;é€šè¿‡inverseå¯ä»¥å¾—åˆ°å€¼ï¼Œé”®æ˜ å°„çš„BiMapã€‚å¾€BiMapé‡Œæ·»åŠ é‡å¤çš„å€¼å°†ä¼šæŠ¥é”™ï¼š1234BiMap&lt;String, String&gt; biMap = HashBiMap.create();biMap.put("k1", "v1");biMap.put("k2", "v2");biMap.put("k3", "v1");å¦‚æžœéžè¦æ·»åŠ é‡å¤çš„å€¼çš„è¯ï¼Œå¯ä»¥ç”¨forcePutæ–¹æ³•ï¼š12345BiMap&lt;String, String&gt; biMap = HashBiMap.create();biMap.put("k1", "v1");biMap.put("k2", "v2");biMap.forcePut("k3", "v1");System.out.println(biMap); // &#123;k2=v2, k3=v1&#125;TableTableæ˜¯ä¸€ä¸ªåŒ…å«è¡Œï¼Œåˆ—å’Œå•å…ƒæ ¼çš„é›†åˆç±»åž‹ï¼Œè¡Œå’Œåˆ—ç»„æˆæœ‰åºé”®å¯¹ã€‚åˆ›å»ºä¸€ä¸ªHashBasedTableï¼ˆå†…éƒ¨ä½¿ç”¨LinkedHashMapï¼‰ï¼š1Table&lt;String, String, Integer&gt; hashBasedTable = HashBasedTable.create();å¦‚æžœéœ€è¦å¯¹tableçš„è¡Œå’Œåˆ—æŒ‰ç…§è‡ªç„¶é¡ºåºæˆ–è€…æä¾›çš„æŽ’åºè§„åˆ™è¿›è¡ŒæŽ’åºçš„è¯ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªTreeBasedTableï¼š1Table&lt;String, String, Integer&gt; treeBasedTable = TreeBasedTable.create();å¦‚æžœäº‹å…ˆçŸ¥é“è¡Œå’Œåˆ—çš„å€¼ï¼Œå¹¶ä¸”tableå¤§å°æ˜¯å›ºå®šçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ArrayTableï¼š1234List&lt;String&gt; row = Lists.newArrayList("r1", "r2");List&lt;String&gt; column = Lists.newArrayList("c1", "c2", "c3");Table&lt;String, String, Integer&gt; arrayTable = ArrayTable.create(row, column);System.out.println(arrayTable); // &#123;r1=&#123;c1=null, c2=null, c3=null&#125;, r2=&#123;c1=null, c2=null, c3=null&#125;&#125;ä¸Šé¢ä¾‹å­åˆ›å»ºäº†ä¸€ä¸ªä¸¤è¡Œä¸‰åˆ—çš„tableã€‚åˆ›å»ºä¸å¯å˜tableï¼š123Table&lt;String, String, String&gt; immutableTable = ImmutableTable.&lt;String, String, String&gt; builder() .put("r1", "c1", "hello") .build();é€šè¿‡è¡Œå’Œåˆ—èŽ·å–å•å…ƒæ ¼çš„å€¼ï¼š12345678910111213Table&lt;String, String, String&gt; hashBasedTable = HashBasedTable.create();hashBasedTable.put("r1", "c1", "hello");hashBasedTable.put("r1", "c2", "world");hashBasedTable.put("r2", "c1", "good");hashBasedTable.put("r2", "c2", "bye");System.out.println(hashBasedTable); // &#123;r1=&#123;c1=hello, c2=world&#125;, r2=&#123;c1=good, c2=bye&#125;&#125;String v1 = hashBasedTable.get("r1", "c1");String v2 = hashBasedTable.get("r2", "c3");System.out.println(v1); // helloSystem.out.println(v2); // nullæˆ‘ä»¬å¯ä»¥æ£€æµ‹tableæ˜¯å¦åŒ…å«æŸä¸ªè¡Œé”®ï¼ŒæŸä¸ªåˆ—é”®ï¼ŒæŸä¸ªå€¼å’ŒæŸä¸ªè¡Œå’Œåˆ—ç»„åˆçš„é”®ï¼š12345678910Table&lt;String, String, String&gt; hashBasedTable = HashBasedTable.create();hashBasedTable.put("r1", "c1", "hello");hashBasedTable.put("r1", "c2", "world");hashBasedTable.put("r2", "c1", "good");hashBasedTable.put("r2", "c2", "bye");boolean b1 = hashBasedTable.contains("r1", "c2"); // trueboolean b2 = hashBasedTable.containsColumn("c3"); // falseboolean b3 = hashBasedTable.containsRow("r2"); // trueboolean b4 = hashBasedTable.containsValue("world"); // trueé€šè¿‡è¡Œå’Œåˆ—åˆ é™¤å•å…ƒæ ¼ï¼Œè¿”å›žè¢«åˆ é™¤çš„å€¼ï¼š12345678910Table&lt;String, String, String&gt; hashBasedTable = HashBasedTable.create();hashBasedTable.put("r1", "c1", "hello");hashBasedTable.put("r1", "c2", "world");hashBasedTable.put("r2", "c1", "good");hashBasedTable.put("r2", "c2", "bye");String removeValue = hashBasedTable.remove("r1", "c1");System.out.println(removeValue); // helloSystem.out.println(hashBasedTable); // &#123;r1=&#123;c2=world&#125;, r2=&#123;c1=good, c2=bye&#125;&#125;æˆ‘ä»¬å¯ä»¥é€šè¿‡è¡Œæˆ–åˆ—å¾—åˆ°ä¸€ä¸ªMapï¼Œå¦‚æžœé€šè¿‡è¡Œå¾—åˆ°Mapï¼Œé‚£ä¹ˆMapçš„é”®ä¸ºåˆ—å€¼ï¼ŒMapçš„å€¼ä¸ºå¯¹åº”å•å…ƒæ ¼çš„å€¼ï¼Œå…‰è¯´æœ‰ç‚¹æŠ½è±¡ï¼Œçœ‹ä¸ªä¾‹å­ï¼š123456789101112Table&lt;String, String, String&gt; hashBasedTable = HashBasedTable.create();hashBasedTable.put("r1", "c1", "hello");hashBasedTable.put("r1", "c2", "world");hashBasedTable.put("r2", "c1", "good");hashBasedTable.put("r2", "c2", "bye");Map&lt;String, String&gt; c2Map = hashBasedTable.column("c2");Map&lt;String, String&gt; r1Map = hashBasedTable.row("r1");System.out.println(c2Map); // &#123;r1=world, r2=bye&#125;System.out.println(r1Map); // &#123;c1=hello, c2=world&#125;System.out.println(c2Map.get("r1")); // worldæˆ‘ä»¬è¿˜å¯ä»¥å•ç‹¬èŽ·å–æ‰€æœ‰è¡Œæˆ–è€…æ‰€æœ‰åˆ—ç»„æˆçš„Mapï¼š1234567891011Table&lt;String, String, String&gt; hashBasedTable = HashBasedTable.create();hashBasedTable.put("r1", "c1", "hello");hashBasedTable.put("r1", "c2", "world");hashBasedTable.put("r2", "c1", "good");hashBasedTable.put("r2", "c2", "bye");Map&lt;String, Map&lt;String, String&gt;&gt; columnMap = hashBasedTable.columnMap();Map&lt;String, Map&lt;String, String&gt;&gt; rowMap = hashBasedTable.rowMap();System.out.println(columnMap); // &#123;c1=&#123;r1=hello, r2=good&#125;, c2=&#123;r1=world, r2=bye&#125;&#125;System.out.println(rowMap); // &#123;r1=&#123;c1=hello, c2=world&#125;, r2=&#123;c1=good, c2=bye&#125;&#125;èŽ·å–æ‰€æœ‰è¡Œé”®ã€åˆ—é”®æˆ–è€…å€¼çš„é›†åˆï¼š12345678910111213Table&lt;String, String, String&gt; hashBasedTable = HashBasedTable.create();hashBasedTable.put("r1", "c1", "hello");hashBasedTable.put("r1", "c2", "world");hashBasedTable.put("r2", "c1", "good");hashBasedTable.put("r2", "c2", "bye");Set&lt;String&gt; rowKeySet = hashBasedTable.rowKeySet();Set&lt;String&gt; columnKeySet = hashBasedTable.columnKeySet();Set&lt;Table.Cell&lt;String, String, String&gt;&gt; cells = hashBasedTable.cellSet();System.out.println(rowKeySet); // [r1, r2]System.out.println(columnKeySet); // [c1, c2]System.out.println(cells); // [(r1,c1)=hello, (r1,c2)=world, (r2,c1)=good, (r2,c2)=bye]MultisetMultisetå’Œjava.util.setç±»ä¼¼ï¼Œä¸è¿‡Mutisetå¯ä»¥æ·»åŠ é‡å¤çš„å€¼ï¼š123456789101112HashMultiset&lt;String&gt; hashMultiset = HashMultiset.create();hashMultiset.add("are you ok?");hashMultiset.add("are you ok?");hashMultiset.add("are you ok?");System.out.println(hashMultiset); // [are you ok? x 3]hashMultiset.remove("are you ok?");System.out.println(hashMultiset); // [are you ok? x 2]hashMultiset.setCount("are you ok?", 10); // ç›´æŽ¥è®¾ç½®å…ƒç´ ä¸ªæ•°System.out.println(hashMultiset); // [are you ok? x 10]åœ¨å¹¶å‘çŽ¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ConcurrentHashMultisetï¼Œå®ƒçš„addå’Œremoveæ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å”¯ä¸€å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¹¶å‘çŽ¯å¢ƒä¸‹ä½¿ç”¨setCountæ–¹æ³•æ—¶å€™ï¼Œéœ€ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼ï¼š12345HashMultiset&lt;String&gt; hashMultiset = HashMultiset.create();hashMultiset.setCount("are you ok?", 0, 5);hashMultiset.setCount("are you ok?", 10, 5);System.out.println(hashMultiset); // [are you ok? x 5]ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºéœ€è¦æ·»åŠ çš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå½“å‰Multiseté‡Œå…ƒç´ ä¸ªæ•°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºéœ€è¦æ·»åŠ çš„å…ƒç´ ä¸ªæ•°ã€‚åªæœ‰ç¬¬äºŒä¸ªå‚æ•°çš„å€¼æ­£ç¡®çš„æ—¶å€™ï¼ŒsetCountæ‰æœ‰æ•ˆï¼Œæ‰€ä»¥hashMultiset.setCount(&quot;are you ok?&quot;, 10, 5)å®žé™…ä¸Šæ˜¯ä¸ç”Ÿæ•ˆçš„ã€‚MultimapMultimapå¯ä»¥é€šè¿‡ä¸€ä¸ªé”®æ˜ å°„å¤šä¸ªå€¼ï¼š1234567String key = "hello";ArrayListMultimap&lt;String, String&gt; multimap = ArrayListMultimap.create();multimap.put(key, "world");multimap.put(key, "java");System.out.println(multimap); // &#123;hello=[world, java]&#125;System.out.println(multimap.get(key)); // [world, java]ClassToInstanceMapä½¿ç”¨ç±»åž‹ä½œä¸ºé”®ï¼š1234567MutableClassToInstanceMap&lt;Object&gt; classToInstanceMap = MutableClassToInstanceMap.create();classToInstanceMap.put(String.class, "hello");classToInstanceMap.put(Integer.class, 777);classToInstanceMap.put(Double.class, 43.96);System.out.println(classToInstanceMap); // &#123;class java.lang.Double=43.96, class java.lang.String=hello, class java.lang.Integer=777&#125;System.out.println(classToInstanceMap.get(Double.class)); // 43.96Listsã€Maps&amp;SetsListsåˆ›å»ºä¸€ä¸ªListï¼š1ArrayList&lt;String&gt; list = Lists.newArrayList("a", "b", "c");åè½¬Listï¼š1234ArrayList&lt;String&gt; list = Lists.newArrayList("a", "b", "c");List&lt;String&gt; reverse = Lists.reverse(list);System.out.println(reverse); // [c, b, a]é€šè¿‡å­—ç¬¦ä¸²ç”Ÿæˆå­—ç¬¦é›†åˆï¼š12List&lt;Character&gt; characters = Lists.charactersOf("mrbird");System.out.println(characters); // [m, r, b, i, r, d]å°†é›†åˆæŒ‰ç…§æŒ‡å®šåŒºå—å¤§å°åˆ†åŒºï¼š1234List&lt;String&gt; list = Lists.newArrayList("java", "php", "go", "python", "c#", "javascript");List&lt;List&lt;String&gt;&gt; partition = Lists.partition(list, 2);System.out.println(partition); // [[java, php], [go, python], [c#, javascript]]ä¸€ä¸ªåˆ é™¤Listä¸­é‡å¤é¡¹çš„æŠ€å·§ï¼š1234List&lt;String&gt; list = Lists.newArrayList("a", "p", "p", "l", "e");ImmutableList&lt;String&gt; newList = ImmutableSet.copyOf(list).asList();System.out.println(newList); // [a, p, l, e]ä»Žé›†åˆä¸­åˆ é™¤nullå€¼ï¼š1234List&lt;String&gt; list = Lists.newArrayList("java", null," python");Iterables.removeIf(list, Objects::isNull);System.out.println(list); // [java, python]Setsé€šè¿‡Setsåˆ›å»ºsetï¼š1Set&lt;Object&gt; hashSet = Sets.newHashSet();åˆå¹¶ä¸¤ä¸ªSetï¼š12345Set&lt;String&gt; set1 = ImmutableSet.of("a", "b", "c");Set&lt;String&gt; set2 = ImmutableSet.of("b", "c", "d");Set&lt;String&gt; union = Sets.union(set1, set2);System.out.println(union); // [a, b, c, d]å¯ä»¥é€šè¿‡Sets.cartesianProduct()èŽ·å–ä¸¤ä¸ªSetçš„ç¬›å¡å°”ç§¯ï¼š12345Set&lt;Character&gt; first = ImmutableSet.of('a', 'b');Set&lt;Character&gt; second = ImmutableSet.of('c', 'd');Set&lt;List&lt;Character&gt;&gt; result = Sets.cartesianProduct(first, second);System.out.println(result); // [[a, c], [a, d], [b, c], [b, d]]èŽ·å–ä¸¤ä¸ªSetçš„äº¤é›†ï¼š12345Set&lt;Character&gt; first = ImmutableSet.of('a', 'b', 'c');Set&lt;Character&gt; second = ImmutableSet.of('c', 'd', 'e');Set&lt;Character&gt; intersection = Sets.intersection(first, second);System.out.println(intersection); // [c]èŽ·å–ä¸¤ä¸ªSetçš„å·®é›†ï¼š12345Set&lt;Character&gt; first = ImmutableSet.of('a', 'b', 'c');Set&lt;Character&gt; second = ImmutableSet.of('c', 'd', 'e');Set&lt;Character&gt; difference = Sets.symmetricDifference(first, second);System.out.println(difference); // [a, b, d, e]Mapsé€šè¿‡Mapsåˆ›å»ºMapï¼š1HashMap&lt;Object, Object&gt; map = Maps.newHashMap();åˆ›å»ºæœŸæœ›å¤§å°çš„Mapï¼š1HashMap&lt;Object, Object&gt; map = Maps.newHashMapWithExpectedSize(5);Joinerä¸ŽSplitterJoinerJoinerç”¨äºŽè¿žæŽ¥æ“ä½œã€‚æ¯”å¦‚å°†Listé‡Œçš„å…ƒç´ é€šè¿‡â€œ,â€è¿žæŽ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼š1234List&lt;String&gt; list = Lists.newArrayList("a", "b", "c");String join = Joiner.on(",").join(list);System.out.println(join); // a,b,cä½¿ç”¨Joinerå°†Mapè½¬æ¢ä¸ºStringï¼š123456HashMap&lt;String, Integer&gt; map = Maps.newHashMap();map.put("mrbird", 18);map.put("scott", 28);String join = Joiner.on(",").withKeyValueSeparator("~").join(map);System.out.println(join); // mrbird~18,scott~28åœ¨ä½¿ç”¨Joinerçš„æ—¶å€™ï¼Œå¦‚æžœé›†åˆä¸­å«æœ‰nullå€¼ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è·³è¿‡å®ƒï¼š1234List&lt;String&gt; list = Lists.newArrayList("a", null, "b", "c", "d");String result = Joiner.on(",").skipNulls().join(list);System.out.println(result); // a,b,c,dæˆ–è€…ä½¿ç”¨æŒ‡å®šå€¼æ›¿ä»£nullï¼š1234List&lt;String&gt; list = Lists.newArrayList("a", null, "b", "c", "d");String result = Joiner.on(",").useForNull("ç©º").join(list);System.out.println(result); // a,ç©º,b,c,dSplitterSplitterç”¨äºŽå°†Stringæ‹†åˆ†ä¸ºé›†åˆç±»åž‹ï¼Œçœ‹ä¸ªä¾‹å­:1234String value = "a,b,c,d ";List&lt;String&gt; list = Splitter.on(",").trimResults().splitToList(value);System.out.println(list); // [a, b, c, d]ä½¿ç”¨Splitterå°†Stringæ‹†åˆ†ä¸ºMapï¼š1234 String value = "mrbird=18,scott=28";Map&lt;String, String&gt; map = Splitter.on(",").withKeyValueSeparator("=").split(value);System.out.println(map); // &#123;mrbird=18, scott=28&#125;åˆ†å‰²å…·æœ‰å¤šç§åˆ†éš”ç¬¦çš„Stringï¼š1234String value = "a.b,,c,,..";List&lt;String&gt; result = Splitter.onPattern("[.,]").omitEmptyStrings().splitToList(value);System.out.println(result); // [a, b, c]omitEmptyStringsç”¨äºŽå¿½ç•¥ç©ºå­—ç¬¦ä¸²ã€‚æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡æŒ‡å®šé•¿åº¦æ¥æ‹†åˆ†å­—ç¬¦ä¸²ï¼š1234String value = "äººä»¬éƒ½è¯´ï¼šâ€œæ¡‚æž—å±±æ°´ç”²å¤©ä¸‹â€ï¼Œæˆ‘ä»¬ä¹˜ç€æœ¨èˆ¹è¡æ¼¾åœ¨æ¼“æ±Ÿä¸Šï¼Œæ¥è§‚èµæ¡‚æž—çš„å±±æ°´ã€‚";List&lt;String&gt; list = Splitter.fixedLength(3).splitToList(value);System.out.println(list); // [äººä»¬éƒ½, è¯´ï¼šâ€œ, æ¡‚æž—å±±, æ°´ç”²å¤©, ä¸‹â€ï¼Œ, æˆ‘ä»¬ä¹˜, ç€æœ¨èˆ¹, è¡æ¼¾åœ¨, æ¼“æ±Ÿä¸Š, ï¼Œæ¥è§‚, èµæ¡‚æž—, çš„å±±æ°´, ã€‚]ä¹Ÿå¯ä»¥æŒ‡å®šæ‹†åˆ†é¡¹çš„é•¿åº¦ï¼š1234String value = "a-b-c-d-e";List&lt;String&gt; result = Splitter.on("-").limit(4).splitToList(value);System.out.println(result); // [a, b, c, d-e]å¯ä»¥çœ‹åˆ°d-eæ²¡æœ‰è¢«æ‹†åˆ†ã€‚Filter&amp;TransformFilterå¯ä»¥é€šè¿‡Guavaæä¾›çš„Predicatesæ¥å®žçŽ°å„ç§é›†åˆè¿‡æ»¤æ“ä½œã€‚æ¯”å¦‚æ‰¾å‡ºé›†åˆä¸­åŒ…å«açš„å…ƒç´ ï¼š1234List&lt;String&gt; list = Lists.newArrayList("java", "javascript", "c#", "golang");Iterable&lt;String&gt; result = Iterables.filter(list, Predicates.containsPattern("a"));System.out.println(result); // [java, javascript, golang]ä¸Šé¢çš„ä¾‹å­ä¹Ÿå¯ä»¥é€šè¿‡Collections2.filteræ¥å®žçŽ°ï¼š1234List&lt;String&gt; list = Lists.newArrayList("java", "javascript", "c#", "golang");Collection&lt;String&gt; result = Collections2.filter(list, Predicates.containsPattern("a"));System.out.println(result);æˆ‘ä»¬ä¹Ÿå¯ä»¥ç¼–å†™è‡ªå®šä¹‰çš„è¿‡æ»¤è§„åˆ™ï¼š1234567891011121314 Predicate&lt;String&gt; predicate = new Predicate&lt;String&gt;() &#123; @Override public boolean apply(@Nullable String input) &#123; return input.endsWith("a") || input.contains("#"); &#125; @Override public boolean test(String input) &#123; return this.apply(input); &#125;&#125;;List&lt;String&gt; list = Lists.newArrayList("java", "javascript", "c#", "golang");Collection&lt;String&gt; result = Collections2.filter(list, predicate);System.out.println(result); // [java, c#]ç»„åˆå¤šä¸ªè¿‡æ»¤æ¡ä»¶ï¼š1234567List&lt;String&gt; list = Lists.newArrayList("java", "javascript", "c#", "golang");Collection&lt;String&gt; result = Collections2.filter(list, Predicates.or( Predicates.containsPattern("a"), Predicates.containsPattern("#") ));System.out.println(result); // [java, javascript, c#, golang]è¿‡æ»¤æŽ‰é›†åˆä¸­çš„nullï¼š1234List&lt;String&gt; list = Lists.newArrayList("java", null," python");Collection&lt;String&gt; result = Collections2.filter(list, Predicates.&lt;String&gt;notNull());System.out.println(result); // [java, python]æ£€æµ‹é›†åˆä¸­æ˜¯å¦æœ‰åŒ…å«aå­—ç¬¦çš„å…ƒç´ ï¼š1234List&lt;String&gt; list = Lists.newArrayList("java", "c#"," python");boolean result = Iterables.any(list, Predicates.containsPattern("a"));System.out.println(result); // trueTransformå°†é›†åˆè½¬æ¢ä¸ºå…ƒç´ é•¿åº¦çš„é›†åˆï¼š1234567891011Function&lt;String, Integer&gt; function = new Function&lt;String, Integer&gt;() &#123; @Nullable @Override public Integer apply(@Nullable String s) &#123; return s.length(); &#125;&#125;;List&lt;String&gt; list = Lists.newArrayList("java", "c#", " python");Iterable&lt;Integer&gt; result = Iterables.transform(list, function);System.out.println(result); // [4, 2, 7]ä¸Šé¢çš„ä¾‹å­åŒæ ·å¯ä»¥ä½¿ç”¨Collections2.transformæ¥ä»£æ›¿Iterables.transformã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡Functions.fromPredicateæ¥åˆ›å»ºç®€å•çš„è½¬æ¢å‡½æ•°Functionï¼š1234List&lt;String&gt; list = Lists.newArrayList("java", "c#", " python");Iterable&lt;Boolean&gt; result = Iterables.transform(list, Functions.forPredicate(Predicates.containsPattern("#")));System.out.println(result); // [false, true, false]ç»„åˆå¤šä¸ªè½¬æ¢å‡½æ•°ï¼š1234567891011121314151617Function&lt;String, String&gt; f1 = new Function&lt;String, String&gt;() &#123; @Override public String apply(String input) &#123; return "i like " + input; &#125;&#125;;Function&lt;String, String&gt; f2 = new Function&lt;String, String&gt;() &#123; @Override public String apply(String input) &#123; return input.toUpperCase(); &#125;&#125;;List&lt;String&gt; list = Lists.newArrayList("java", "c#", " python");Iterable&lt;String&gt; result = Iterables.transform(list, Functions.compose(f2, f1));System.out.println(result); // [I LIKE JAVA, I LIKE C#, I LIKE PYTHON]æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è¿‡æ»¤å’Œè½¬æ¢ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼š12345678910111213141516171819202122232425Predicate&lt;String&gt; predicate = new Predicate&lt;String&gt;() &#123; @Override public boolean apply(String input) &#123; return input.startsWith("j"); &#125; @Override public boolean test(String input) &#123; return this.apply(input); &#125;&#125;;Function&lt;String, String&gt; function = new Function&lt;String,String&gt;()&#123; @Override public String apply(String input) &#123; return input.toUpperCase(); &#125;&#125;;List&lt;String&gt; list = Lists.newArrayList("java", "c#", "javascript", "python");ImmutableList&lt;String&gt; result = FluentIterable.from(list) .filter(predicate) .transform(function) .toList();System.out.println(result); // [JAVA, JAVASCRIPT]Iterablesé™¤äº†ä¸Šé¢æ¶‰åŠçš„Iterablesçš„ç”¨æ³•å¤–ï¼Œå…¶è¿˜æä¾›äº†è®¸å¤šåˆ«çš„å¥½ç”¨çš„æ–¹æ³•ã€‚removeAllè¯¥æ–¹æ³•ç”¨äºŽä»Žç‰¹å®šé›†åˆä¸­åˆ é™¤ç»™å®šé›†åˆä¸­çš„å…ƒç´ ï¼š123456List&lt;String&gt; removeFrom = Lists.newArrayList("a", "b", "c");List&lt;String&gt; elementsToRemove = Lists.newArrayList("b", "c");boolean result = Iterables.removeAll(removeFrom, elementsToRemove);System.out.println(result); // trueSystem.out.println(removeFrom); // [a]retainAllretainAllçš„åŠŸèƒ½å’ŒremoveAllç›¸åï¼š123456List&lt;String&gt; removeFrom = Lists.newArrayList("a", "b", "c");List&lt;String&gt; elementsToRetain = Lists.newArrayList("b", "c");boolean result = Iterables.retainAll(removeFrom, elementsToRetain);System.out.println(result); // trueSystem.out.println(removeFrom); // [b, c]addAlladdAllç”¨äºŽå°†ç»™å®šé›†åˆæ·»åŠ åˆ°çŽ°æœ‰é›†åˆä¸­ï¼š12345List&lt;String&gt; list1 = Lists.newArrayList("a", "b", "c");List&lt;String&gt; list2 = Lists.newArrayList("b", "c");boolean b = Iterables.addAll(list1, list2); // trueSystem.out.println(list1); // [a, b, c, b, c]concatconcatç”¨äºŽåˆå¹¶é›†åˆï¼Œç»„æˆä¸€ä¸ªæ–°çš„é›†åˆå¯¹è±¡ï¼š12345List&lt;String&gt; list1 = Lists.newArrayList("a", "b", "c");List&lt;String&gt; list2 = Lists.newArrayList("b", "c");Iterable&lt;String&gt; result = Iterables.concat(list1,list2);System.out.println(result); // [a, b, c, b, c]Iterablesè¿˜åŒ…å«è®¸å¤šåˆ«çš„å®žç”¨æ–¹æ³•ï¼šè¿™é‡Œå°±ä¸ä¸€ä¸€æ¼”ç¤ºäº†ï¼Œæºœäº†ã€‚æ›´è¯¦ç»†çš„å†…å®¹å¯ä»¥å‚è€ƒguavaå®˜æ–¹wikiï¼šhttps://github.com/google/guava/wiki]]></content>
      <tags>
        <tag>guava</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[FEBS-Vueæ–‡æ¡£]]></title>
    <url>%2FFEBS-Vue-Document.html</url>
    <content type="text"><![CDATA[FEBS-Vueä¸ºFEBS-Shiroçš„å‰åŽç«¯åˆ†ç¦»ç‰ˆæœ¬ï¼Œå‰ç«¯ä½¿ç”¨Vueå…¨å®¶æ¡¶ï¼Œç»„ä»¶åº“é‡‡ç”¨Ant-Design-Vueã€‚æ–‡æ¡£é‡Œä»‹ç»çš„ç¤ºä¾‹æ˜¯åœ¨Windows10æ“ä½œç³»ç»Ÿä¸‹å®Œæˆçš„ï¼ŒåŽç«¯ç¼–è¾‘å™¨ä½¿ç”¨IDEAï¼Œå‰ç«¯ç¼–è¾‘å™¨ä½¿ç”¨WebStormã€‚é¡¹ç›®å¯¼å…¥ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ç›´æŽ¥åœ¨æ¡Œé¢ä¸Šé€šè¿‡git bashå…‹éš†é¡¹ç›®ï¼š1git clone https://github.com/wuyouzhuguli/FEBS-Vue.gitå…‹éš†åŽï¼Œæ¡Œé¢ä¸Šå¤šå‡ºä¸€ä¸ªFEBS-Vueæ–‡ä»¶å¤¹ï¼šbackendä¸ºåŽç«¯é¡¹ç›®æºç ï¼Œfrontendä¸ºå‰ç«¯é¡¹ç›®æºç ï¼Œsqlä¸ºæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ã€‚JDKå› ä¸ºé¡¹ç›®ç”¨åˆ°äº†JDK 8çš„ä¸€äº›ç‰¹æ€§ï¼Œæ‰€ä»¥JDKæœ€ä½Žç‰ˆæœ¬ä¸èƒ½ä½ŽäºŽ8ã€‚JDK 8å®˜æ–¹ä¸‹è½½åœ°å€ï¼šhttps://www.oracle.com/technetwork/java/javase/downloadsã€‚å®‰è£…Node.jsNode.jsä¸‹è½½åœ°å€ï¼šhttp://nodejs.cn/download/ï¼Œç›´æŽ¥å®‰è£…å³å¯ï¼Œå®‰è£…åŽæŸ¥çœ‹å…¶ç‰ˆæœ¬ï¼šNode.jsé›†æˆäº†npmï¼Œæ‰€ä»¥å®‰è£…å¥½Node.jsåŽnpmå°±å¯ä»¥ä½¿ç”¨äº†ï¼šå®‰è£…yarnåœ¨CMDä¸­æ‰§è¡Œnpm install -g yarnï¼šå› ä¸ºæˆ‘ä¹‹å‰å·²ç»å®‰è£…è¿‡äº†ï¼Œæ‰€ä»¥è¿™é‡Œå°±ç›¸å½“äºŽæ›´æ–°æ“ä½œäº†ã€‚å®‰è£…Redisé¡¹ç›®ç¼“å­˜æ•°æ®åº“ä½¿ç”¨çš„æ˜¯Redisï¼Œæ‰€ä»¥åœ¨å¯¼å…¥é¡¹ç›®å‰éœ€å…ˆå®‰è£…Redisã€‚Redis Windowsç‰ˆæœ¬ä¸‹è½½åœ°å€ï¼šhttps://github.com/MicrosoftArchive/redis/releasesã€‚ç›´æŽ¥ä¸‹è½½zipç‰ˆæœ¬è§£åŽ‹åˆ°ä»»æ„ç›®å½•å³å¯ã€‚ä¸‹è½½åŽï¼Œä½¿ç”¨cmdå‘½ä»¤åˆ‡æ¢åˆ°Redisæ ¹ç›®å½•ï¼Œç„¶åŽè¿è¡Œredis-server.exe redis.windows.confå¯åŠ¨å³å¯ï¼šå®‰è£…MySQLé¡¹ç›®æ•°æ®åº“é‡‡ç”¨MySQLç¤¾åŒºç‰ˆï¼Œç‰ˆæœ¬ä¸º5.7.xã€‚ä¸‹è½½åœ°å€ï¼šhttps://dev.mysql.com/downloads/windows/installer/5.7.htmlå¯¼å…¥SQLä½¿ç”¨Navicatæ–°å»ºä¸€ä¸ªæ•°æ®åº“ï¼šç„¶åŽå¯¼å…¥SQLè„šæœ¬å³å¯ã€‚å¯¼å…¥åŽç«¯é¡¹ç›®IDEAé€‰æ‹©backendï¼š å¯¼å…¥é¡¹ç›®åŽå®‰è£…lombokæ’ä»¶ï¼ˆä¸æ‡‚lombokå¯ä»¥è‡ªè¡Œç™¾åº¦ï¼‰ï¼šå®‰è£…å®Œé‡å¯IDEAæ‰èƒ½ç”Ÿæ•ˆã€‚æŽ¥ç€ä¿®æ”¹application.ymlä¸­çš„æ•°æ®åº“å’ŒRedisé…ç½®ï¼Œä¿®æ”¹å®ŒåŽé€šè¿‡Spring Bootå…¥å£ç±»FebsApplicationå¯åŠ¨å³å¯ï¼šæŽ¥ç€å¼€å§‹å¯¼å…¥å‰ç«¯é¡¹ç›®ã€‚å¯¼å…¥å‰ç«¯é¡¹ç›®ä½¿ç”¨WebStormæ‰“å¼€frontendï¼šåœ¨ç»ˆç«¯è¾“å…¥yarn installå‘½ä»¤å®‰è£…ä¾èµ–ï¼šç¨ç­‰ç‰‡åˆ»ï¼Œåä¸Žæ”¾å®½ã€‚ä¾èµ–ä¸‹è½½å®Œæ¯•åŽï¼Œè¾“å…¥yarn startå¯åŠ¨å‰ç«¯é¡¹ç›®ï¼šæµè§ˆå™¨è®¿é—®http://localhost:8081ï¼šé¡¹ç›®éƒ¨ç½²ä¸‹é¢æ¼”ç¤ºå¦‚ä½•åœ¨Linuxä¸Šéƒ¨ç½²é¡¹ç›®ï¼ˆä¾‹å­é‡‡ç”¨CentOS7ï¼‰ã€‚Vagrantåˆ›å»ºCentOSå¦‚æžœæ²¡æœ‰CentOS7çŽ¯å¢ƒå¯ä»¥ä½¿ç”¨Vagrantå¿«é€Ÿæž„å»ºä¸€ä¸ªCentOSè™šæ‹Ÿæœºï¼Œå…·ä½“å¯ä»¥å‚è€ƒï¼šhttps://mrbird.cc/Create-Virtual-Machine-By-Vagrant.htmlã€‚æˆ‘çš„CentOSè™šæ‹ŸæœºIPä¸ºï¼š192.168.33.11ã€‚ä½¿ç”¨å‘½ä»¤timedatectl set-timezone Asia/Shanghaiè®¾ç½®CentOSçš„æ—¶åŒºï¼Œä»¥é¿å…å› æ—¶åŒºå¸¦æ¥çš„BUGã€‚JavaçŽ¯å¢ƒé…ç½®ä¸‹è½½JDK8ï¼šä¸‹è½½åŽé€šè¿‡Vagrantå…±äº«åˆ°CentOSä¸Šï¼ˆæˆ‘çš„Vagrantfileå…±äº«é…ç½®ä¸ºconfig.vm.synced_folder &quot;./sync&quot;, &quot;/vagrant&quot;, create:true, owner: &quot;root&quot;, group: &quot;root&quot;ï¼‰ï¼šå®‰è£…JDK8ï¼š1rpm -ivh jdk-8u201-linux-x64.rpmé…ç½®çŽ¯å¢ƒå˜é‡1vim /etc/profileè¾“å…¥ä»¥ä¸‹å†…å®¹ï¼š12345JAVA_HOME=/usr/java/jdk1.8.0_201JRE_HOME=/usr/java/jdk1.8.0_201/jrePATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/binCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/libexport JAVA_HOME JRE_HOME PATH CLASSPATHç„¶åŽæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæ•ˆï¼š1source /etc/profileå®‰è£…Dockerå®˜æ–¹å®‰è£…æ•™ç¨‹ï¼šhttps://docs.docker.com/install/linux/docker-ce/centos/å®‰è£…å¥½åŽï¼šDockerå®‰è£…MySQLæ‹‰å–MySQLé•œåƒï¼šåˆ›å»ºç›®å½•/home/febs/mysqlï¼Œç”¨äºŽæŒ‚è½½MySQL volume:åˆ›å»ºMySQLå®¹å™¨ï¼š12docker run -d --name mysql -p 3306:3306 \ -v $(pwd):/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7.25ä½¿ç”¨Navicatè¿žæŽ¥MySQLï¼Œåˆ›å»ºæ•°æ®åº“å¹¶å¯¼å…¥æ•°æ®ï¼šè¿žæŽ¥ï¼šæ–°å¢žæ•°æ®åº“ï¼šå¯¼å…¥SQLï¼šDockerå®‰è£…Redisæ‹‰å–Redisé•œåƒ:åˆ›å»ºæ–‡ä»¶/home/febs/redis/conf/redis.confï¼Œç”¨äºŽæŒ‚è½½Redisé…ç½®æ–‡ä»¶ï¼šåˆ›å»ºRediså®¹å™¨ï¼š123docker run -d -p 6379:6379 \ -v /home/febs/redis/conf/redis.conf:/usr/local/etc/redis/redis.conf \ --name redis redis:4.0.14æµ‹è¯•è¿žæŽ¥ï¼šDockerå®‰è£…Nginxæ‹‰å–Nginxé•œåƒ:åˆ›å»ºç›®å½•/home/febs/nginx/htmlã€/home/febs/nginx/logså’Œæ–‡ä»¶/home/febs/nginx/conf/nginx.confï¼Œåˆ†åˆ«ç”¨äºŽæŒ‚è½½Nginx html,logså’Œé…ç½®æ–‡ä»¶ï¼š ä¿®æ”¹Nginxé…ç½®ï¼š1vim /home/febs/nginx/conf/nginx.conf1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465worker_processes auto;error_log /var/log/nginx/error.log;pid /run/nginx.pid;events &#123; worker_connections 1024;&#125;http &#123; include mime.types; default_type application/octet-stream; server_names_hash_bucket_size 512; client_header_buffer_size 32k; large_client_header_buffers 4 32k; client_max_body_size 50m; sendfile on; tcp_nopush on; keepalive_timeout 60; tcp_nodelay on; fastcgi_connect_timeout 300; fastcgi_send_timeout 300; fastcgi_read_timeout 300; fastcgi_buffer_size 64k; fastcgi_buffers 4 64k; fastcgi_busy_buffers_size 128k; fastcgi_temp_file_write_size 256k; fastcgi_intercept_errors on; gzip on; gzip_min_length 1k; gzip_buffers 16 8k; gzip_http_version 1.1; gzip_comp_level 6; gzip_types text/plain application/javascript application/x-javascript text/javascript text/css application/xml; gzip_vary on; gzip_proxied expired no-cache no-store private auth; gzip_disable "MSIE [1-6]\."; limit_conn_zone $binary_remote_addr zone=perip:10m; limit_conn_zone $server_name zone=perserver:10m; server_tokens off; access_log off; server &#123; listen 80; server_name localhost; charset utf-8; location / &#123; root html; index index.html index.htm; &#125; location = /50x.html &#123; root html; &#125; &#125;&#125;åˆ›å»ºNginxå®¹å™¨ï¼š1234docker run --name nginx -d -p 80:80 \-v /home/febs/nginx/conf/nginx.conf:/etc/ng inx/nginx.conf \-v /home/febs/nginx/html:/etc/nginx/html \-v /home/febs/nginx/logs:/var/log/nginx nginx:1.14.2åŽç«¯éƒ¨ç½²ä¿®æ”¹application.ymlä¸­æ•°æ®åº“å’Œredisçš„è¿žæŽ¥é…ç½®ï¼Œç„¶åŽå°†é¡¹ç›®æ‰“åŒ…æˆjaræ–‡ä»¶ï¼šå°†å…¶ä¸Šä¼ åˆ°CentOSè™šæ‹Ÿæœºçš„/home/febs/backendç›®å½•ä¸‹ï¼šç¼–å†™ä¸€ä¸ªå¯åŠ¨é¡¹ç›®çš„shellè„šæœ¬ï¼š1vim start.shå†…å®¹ï¼š1nohup java -jar febs_shiro_jwt-1.0.0-release.jar &amp;ç¼–å†™ä¸€ä¸ªå…³åœé¡¹ç›®çš„shellè„šæœ¬ï¼š1vim stop.shå†…å®¹ï¼š12345678PID=`ps -ef | grep febs_shiro_jwt-1.0.0-release.jar | grep -v grep | awk &apos;&#123;print $2&#125;&apos;`if [ -z &quot;$PID&quot; ]then echo Application is already stoppedelse echo kill $PID kill -9 $PIDfiæŽˆæƒï¼Œè®©å…¶å¯æ‰§è¡Œï¼šå¯åŠ¨é¡¹ç›®ï¼š123./start.shtail -f nohup.outçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºçš„æ—¶å€™è¯´æ˜ŽåŽç«¯é¡¹ç›®å¯åŠ¨æˆåŠŸï¼šå‰ç«¯éƒ¨ç½²ç‚¹å‡»buildï¼šbuildæˆåŠŸåŽï¼Œé¡¹ç›®ç›®å½•ä¸‹ä¼šå¤šå‡ºä¸ªdistæ–‡ä»¶å¤¹ï¼šå°†è¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ä¸Šä¼ åˆ°CentOSè™šæ‹Ÿæœºçš„/home/febs/nginx/htmlç›®å½•ä¸‹ï¼šæµè§ˆå™¨è®¿é—®http://192.168.33.11/#/loginï¼šéƒ¨ç½²æˆåŠŸã€‚åŽç«¯é¡¹ç›®ä»‹ç»é¡¹ç›®ç»“æž„åŽç«¯é¡¹ç›®ç›®å½•å«ä¹‰å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šCommonæ¨¡å—æ–‡ä»¶å«ä¹‰å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå…¶ä»–æ¨¡å—æ–‡ä»¶è¾ƒä¸ºç®€å•ï¼Œç•¥ã€‚é¡¹ç›®é…ç½®application.ymlä¸­é™¤äº†å„ä¸ªæ’ä»¶çš„é…ç½®å¤–ï¼Œä¸‹é¢è¿™æ®µé…ç½®ä¸ºç³»ç»Ÿé…ç½®ï¼š123456789febs: openAopLog: true max: batch: insert: num: 1000 shiro: anonUrl: /login,/logout/**,/regist,/user/check/** jwtTimeOut: 3600febs.opAopLogï¼šBooleanç±»åž‹ï¼Œå–å€¼trueæˆ–è€…falseï¼Œä¸ºtrueæ—¶è¡¨ç¤ºå¼€å¯Aopè®°å½•ç”¨æˆ·çš„æ“ä½œæ—¥å¿—ï¼Œéœ€å’Œ@Logæ³¨è§£æ­é…ä½¿ç”¨ã€‚febs.max.batch.insert.numï¼šå¤§äºŽ0çš„Integerç±»åž‹ï¼Œè¡¨ç¤ºExcelå¯¼å…¥æ•°æ®å½“æ¬¡æœ€å¤§å…¥åº“æ•°æ®é‡ã€‚æ¯”å¦‚é…ç½®ä¸º1000æ—¶è¡¨ç¤ºå…¥åº“æ•°æ®ä¸º0 - 1000 æ—¶åªä¼šæ‰§è¡Œä¸€æ¬¡æ•°æ®åº“commitæ“ä½œã€‚febs.shiro.anonUrlï¼šé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ— éœ€è®¤è¯çš„èµ„æºè·¯å¾„ã€‚febs.shiro.jwtTimeOutï¼šå®šä¹‰tokençš„æœ‰æ•ˆæ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼Œæ¯”å¦‚é…ç½®ä¸º3600è¡¨ç¤ºtokenä¸€ä¸ªå°æ—¶å†…æœ‰æ•ˆï¼Œè¶…è¿‡ä¸€ä¸ªå°æ—¶åŽéœ€è¦é‡æ–°è®¤è¯ã€‚RESTfulé£Žæ ¼ç³»ç»ŸControlleræš´éœ²çš„æŽ¥å£é£Žæ ¼ä¸ºRESTfulï¼Œé€šè¿‡HTTPè¯·æ±‚methodå¯¹åº”å¢žåˆ æ”¹æŸ¥ç±»åž‹ï¼Œå“åº”ä»¥HTTP Codeä¸ºåˆ¤æ–­ä¾æ®ã€‚ä»¥UserControllerä¸ºä¾‹å­ï¼šæè¿°è¯·æ±‚URIHTTP Methodå¯¹åº”æ³¨è§£æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·/userGET@GetMappingé€šè¿‡ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·/user/{username}GET@GetMappingæ–°å¢žç”¨æˆ·/userPOST@PostMappingä¿®æ”¹ç”¨æˆ·/userPUT@PutMappingåˆ é™¤ç”¨æˆ·/user/{userIds}DELETE@DeleteMappingControlleræ–¹æ³•é»˜è®¤è¿”å›ž200çŠ¶æ€ç ï¼Œå½“ControlleræŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œå°†è¢«GlobalExceptionHandleræ•èŽ·ï¼Œæ ¹æ®å¼‚å¸¸ç±»åž‹ï¼Œè¿”å›žä¸åŒçš„HTTPçŠ¶æ€ç ï¼šå¼‚å¸¸ç±»åž‹å¼‚å¸¸æè¿°çŠ¶æ€ç å¯¹åº”å¸¸é‡UnauthorizedExceptionæœªæŽˆæƒå¼‚å¸¸ï¼Œæƒé™ä¸è¶³å¼‚å¸¸403HttpStatus.FORBIDDENLimitAccessExceptioné™åˆ¶è®¿é—®å¼‚å¸¸ï¼Œè®¿é—®æŽ¥å£é¢‘çŽ‡è¶…é™429HttpStatus.TOO_MANY_REQUESTSConstraintViolationExceptionå‚æ•°æ ¡éªŒå¼‚å¸¸ï¼ˆæ™®é€šä¼ å‚ï¼‰400HttpStatus.BAD_REQUESTBindExceptionå‚æ•°æ ¡éªŒå¼‚å¸¸ï¼ˆå®žä½“å¯¹è±¡ä¼ å‚ï¼‰400HttpStatus.BAD_REQUESTFebsExceptionFebsç³»ç»Ÿå¼‚å¸¸500HttpStatus.INTERNAL_SERVER_ERRORExceptionå‰©ä¸‹çš„åˆ«çš„å¼‚å¸¸500HttpStatus.INTERNAL_SERVER_ERRORæ•°æ®å±‚ä»‹ç»é¦–å…ˆçœ‹çœ‹è¡¨ç»“æž„ï¼Œæ•°æ®è¡¨åˆ†ä¸ºä¸¤å¤§ç±»ï¼šå®šæ—¶ä»»åŠ¡è¡¨å’Œç³»ç»Ÿè¡¨ã€‚ä»¥qrtz_å¼€å¤´çš„ä¸ºå®šæ—¶ä»»åŠ¡è¡¨ï¼Œå®šæ—¶ä»»åŠ¡æœ‰åŸºäºŽå†…å­˜å’ŒåŸºäºŽæ•°æ®åº“çš„ï¼Œæœ¬é¡¹ç›®ä½¿ç”¨çš„æ˜¯åŸºäºŽæ•°æ®åº“æŒä¹…åŒ–çš„æ–¹æ¡ˆã€‚è¦è¯¦ç»†äº†è§£è¿™äº›è¡¨å¯ä»¥å‚è€ƒæ–‡ç« ï¼šhttp://www.ibloger.net/article/2650.htmlã€‚ä»¥t_å¼€å¤´çš„ä¸ºç³»ç»Ÿè¡¨ï¼Œä»–ä»¬çš„å…³ç³»å¦‚ä¸‹æ‰€ç¤º:å…¶ä¸­ç”¨æˆ·ï¼Œè§’è‰²å’Œæƒé™ä¹‹é—´çš„å…³ç³»ä½¿ç”¨çš„æ˜¯ç»å…¸çš„RBACï¼ˆRole-Based Access Controlï¼ŒåŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶ï¼‰æ¨¡åž‹ã€‚ç®€å•åœ°è¯´ï¼Œä¸€ä¸ªç”¨æˆ·æ‹¥æœ‰è‹¥å¹²è§’è‰²ï¼Œæ¯ä¸€ä¸ªè§’è‰²æ‹¥æœ‰è‹¥å¹²æƒé™ã€‚è¿™æ ·ï¼Œå°±æž„é€ æˆâ€œç”¨æˆ·-è§’è‰²-æƒé™â€çš„æŽˆæƒæ¨¡åž‹ã€‚åœ¨è¿™ç§æ¨¡åž‹ä¸­ï¼Œç”¨æˆ·ä¸Žè§’è‰²ä¹‹é—´ï¼Œè§’è‰²ä¸Žæƒé™ä¹‹é—´ï¼Œä¸€èˆ¬è€…æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šæ¯”å¦‚èŽ·å–ç”¨æˆ·åä¸ºmrbridçš„ç”¨æˆ·æƒé™è¿‡ç¨‹ä¸ºï¼šé€šè¿‡mrbridçš„user_idä»Žt_user_roleè¡¨èŽ·å–å¯¹åº”çš„role_idï¼›é€šè¿‡ç¬¬1æ­¥èŽ·å–çš„role_idä»Žt_role_menuè¡¨èŽ·å–å¯¹åº”çš„menu_idï¼›é€šè¿‡ç¬¬2æ­¥èŽ·å–çš„menu_idä»Žt_menuèŽ·å–menuç›¸å…³ä¿¡æ¯ï¼ˆt_menuè¡¨çš„permissionä¸ºæƒé™ä¿¡æ¯ï¼‰ã€‚æ•°æ®å±‚æ¡†æž¶é‡‡ç”¨çš„æ˜¯MybatisPlusï¼Œå…·ä½“å¯ä»¥å‚è€ƒå…¶å®˜æ–¹æ–‡æ¡£ã€‚ç™»å½•é€»è¾‘ç™»å½•é€»è¾‘å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šè¿™é‡Œè¯¦ç»†è¯´æ˜Žä¸‹ç™»å½•æˆåŠŸåŽçš„ç¬¬2æ­¥ã€ç¬¬3æ­¥å’Œç¬¬4æ­¥è¿‡ç¨‹ï¼šç™»å½•æˆåŠŸåŽï¼Œæž„å»ºä¸€ä¸ªActiveUserå¯¹è±¡ï¼Œå¯¹åº”LoginControllerçš„saveTokenToRedisæ–¹æ³•ï¼š123456789// æž„å»ºåœ¨çº¿ç”¨æˆ·ActiveUser activeUser = new ActiveUser();activeUser.setUsername(user.getUsername());activeUser.setIp(ip);activeUser.setToken(token.getToken());activeUser.setLoginAddress(AddressUtil.getCityInfo(DbSearcher.BTREE_ALGORITHM, ip));// zset å­˜å‚¨ç™»å½•ç”¨æˆ·ï¼Œscore ä¸ºè¿‡æœŸæ—¶é—´æˆ³this.redisService.zadd(FebsConstant.ACTIVE_USERS_ZSET_PREFIX, Double.valueOf(token.getExipreAt()), mapper.writeValueAsString(activeUser));ç„¶åŽå°†activeUseré€šè¿‡ObjectMapperåºåˆ—åŒ–ï¼Œå­˜å‚¨åˆ°Redisçš„Zsetç»“æž„ä¸­ï¼Œkeyä¸ºFebsConstant.ACTIVE_USERS_ZSET_PREFIXï¼ˆå³febs.user.activeï¼‰ï¼Œscoreä¸ºè¯¥ç”¨æˆ·çš„ç™»å½•è¿‡æœŸæ—¶é—´ç‚¹ï¼ˆå³Tokeanå¤±æ•ˆæ—¶é—´ï¼‰ï¼Œvalueä¸ºactiveUseråºåˆ—åŒ–å€¼ã€‚Zsetå®ƒåœ¨setçš„åŸºç¡€ä¸Šå¢žåŠ äº†ä¸€ä¸ªé¡ºåºå±žæ€§(score)ï¼Œè¿™ä¸€å±žæ€§åœ¨æ·»åŠ ä¿®æ”¹å…ƒç´ æ—¶å€™å¯ä»¥æŒ‡å®šï¼Œæ¯æ¬¡æŒ‡å®šåŽï¼Œzsetä¼šè‡ªåŠ¨é‡æ–°æŒ‰æ–°çš„å€¼è°ƒæ•´é¡ºåºã€‚å¯ä»¥ç†è§£ä¸ºæœ‰ä¸¤åˆ—å­—æ®µçš„æ•°æ®è¡¨ï¼Œä¸€åˆ—å­˜value,ä¸€åˆ—å­˜é¡ºåºç¼–å·ã€‚Zsetç›¸å…³Rediså‘½ä»¤ï¼šæ¯”å¦‚å½“ç”¨æˆ·mrbirdå’Œscottç™»å½•æˆåŠŸåŽï¼ŒæŸ¥çœ‹Redisä¸­keyä¸ºfebs.user.activeçš„å€¼:å°†Tokenå­˜å‚¨åˆ°Redisä¸­ï¼škeyä¸ºfebs.cache.token.tokenå€¼.IPåœ°å€ï¼Œvalueä¸ºtokenå€¼ï¼Œæœ‰æ•ˆæœŸä¸ºtokençš„æœ‰æ•ˆæ—¶é•¿ï¼Œå¯¹åº”çš„æºç ä¸ºï¼š1this.redisService.set(FebsConstant.TOKEN_CACHE_PREFIX + token.getToken() + StringPool.DOT + ip, token.getToken(), properties.getShiro().getJwtTimeOut() * 1000);è¿”å›žå‰ç«¯æ•°æ®åŒ…æ‹¬:1.tokenï¼štokenï¼›2.exipreTimeï¼štokenè¿‡æœŸæ—¶é—´ï¼›3.rolesï¼šç”¨æˆ·è§’è‰²ï¼›4.permissionsï¼šç”¨æˆ·æƒé™ï¼›5.configï¼šç”¨æˆ·å‰ç«¯ç³»ç»Ÿçš„ä¸ªæ€§åŒ–é…ç½®ï¼›6.userï¼šç”¨æˆ·ä¿¡æ¯ï¼ˆä¸åŒ…æ‹¬å¯†ç ï¼‰ã€‚æ¯”å¦‚ï¼Œå½“scottç™»å½•æˆåŠŸåŽï¼ŒæŽ¥å£è¿”å›žæ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172&#123; "data": &#123; "permissions": [ "user:view", "dept:add", "job:export", "role:add", "weather:view", "dict:add", "role:export", "menu:export", "dict:view", "dept:export", "menu:view", "role:view", "user:export", "job:add", "dept:view", "article:view", "log:view", "jobLog:view", "job:view", "menu:add", "redis:view", "log:export", "movie:coming", "movie:hot", "dict:export", "jobLog:export", "user:online" ], "roles": [ "æ³¨å†Œç”¨æˆ·" ], "exipreTime": "20190408164521", "config": &#123; "userId": 2, "theme": "light", "layout": "side", "multiPage": "0", "fixSiderbar": "1", "fixHeader": "1", "color": "rgb(24, 144, 255)" &#125;, "user": &#123; "userId": 2, "username": "scott", "password": "it's a secret", "deptId": 6, "deptName": null, "email": "scott@qq.com", "mobile": "15134627380", "status": "1", "createTime": "2017-12-30 00:16:39", "modifyTime": "2019-01-18 08:59:09", "lastLoginTime": "2019-01-23 15:34:28", "ssex": "0", "description": "æˆ‘æ˜¯scottï¼Œå—¯å—¯", "avatar": "gaOngJwsRYRaVAuXXcmB.png", "roleId": null, "roleName": null, "sortField": null, "sortOrder": null, "createTimeFrom": null, "createTimeTo": null, "id": "YBeNsMJ0ZJm9GLJP1rlO", "authCacheKey": 2 &#125;, "token": "b25e39b47e774b4a05b3cb1555fc377f209457c3fd339d373d3fca7b1ea8be56fdc6ed05b7ffb0700e7300d242fb83b57b35f45ee1b155b380 50a0671bc7ec54c2f2c5bb1aee0651db69ce657e8ab4cb79c7806209103eda8a3bc96aa043a0144ae3c06a5c549ac168183c37384cf4347e450bf11644d0 62c31ffc3059e63722f849a5de4540b0d1" &#125;, "message": "è®¤è¯æˆåŠŸ"&#125;Redisç¼“å­˜ä½¿ç”¨åœ¨ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œä¼šæ‰§è¡Œç¼“å­˜åˆå§‹åŒ–æ“ä½œï¼Œå¯¹åº”CacheInitRunnerï¼š123456789101112131415161718192021@Slf4j@Componentpublic class CacheInitRunner implements ApplicationRunner &#123; @Autowired private UserService userService; @Autowired private UserManager userManager; @Override public void run(ApplicationArguments args) &#123; try &#123; ... List&lt;User&gt; list = this.userService.list(); for (User user : list) &#123; userManager.loadUserRedisCache(user); &#125; &#125; catch (Exception e) &#123; ... &#125; &#125;&#125;loadUserRedisCacheæ–¹æ³•æºç ï¼š123456789101112131415/** * å°†ç”¨æˆ·ç›¸å…³ä¿¡æ¯æ·»åŠ åˆ° Redisç¼“å­˜ä¸­ * * @param user user */public void loadUserRedisCache(User user) throws Exception &#123; // ç¼“å­˜ç”¨æˆ· cacheService.saveUser(user.getUsername()); // ç¼“å­˜ç”¨æˆ·è§’è‰² cacheService.saveRoles(user.getUsername()); // ç¼“å­˜ç”¨æˆ·æƒé™ cacheService.savePermissions(user.getUsername()); // ç¼“å­˜ç”¨æˆ·ä¸ªæ€§åŒ–é…ç½® cacheService.saveUserConfigs(String.valueOf(user.getUserId()));&#125;å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸€è¿‡ç¨‹ç¼“å­˜äº†ç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æˆ·è§’è‰²ä¿¡æ¯ï¼Œç”¨æˆ·æƒé™ä¿¡æ¯ï¼Œç”¨æˆ·çš„ä¸ªæ€§åŒ–é…ç½®ä¿¡æ¯ï¼Œç¼“å­˜çš„å…·ä½“keyï¼Œvalueå¯ä»¥æŸ¥çœ‹ä¸Šè¿°æ–¹æ³•çš„æºç ã€‚é€šè¿‡è¿™äº›ç¼“å­˜ï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦å‡è½»æ•°æ®åº“åŽ‹åŠ›ã€‚ä¸ºäº†ç¡®ä¿ç¼“å­˜æ•°æ®å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ç›¸åº”çš„å¢žåˆ æ”¹æ–¹æ³•ä¸­å¯¹ç¼“å­˜è¿›è¡Œç›¸åº”çš„æ“ä½œã€‚æ¯”å¦‚åœ¨æ›´æ–°ç”¨æˆ·åŽï¼Œæˆ‘ä»¬å¿…é¡»æ›´æ–°ç›¸åº”çš„ç¼“å­˜ï¼š12345678910@Override@Transactionalpublic void updateUser(User user) throws Exception &#123; ... // é‡æ–°å°†ç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æˆ·è§’è‰²ä¿¡æ¯ï¼Œç”¨æˆ·æƒé™ä¿¡æ¯ åŠ è½½åˆ° redisä¸­ cacheService.saveUser(user.getUsername()); cacheService.saveRoles(user.getUsername()); cacheService.savePermissions(user.getUsername());&#125;æ€»è€Œè¨€ä¹‹ï¼Œç”±äºŽæˆ‘ä»¬åœ¨å¯åŠ¨ç³»ç»Ÿçš„æ—¶å€™ç¼“å­˜äº†ç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æˆ·è§’è‰²ä¿¡æ¯ï¼Œç”¨æˆ·æƒé™ä¿¡æ¯ï¼Œç”¨æˆ·çš„ä¸ªæ€§åŒ–é…ç½®ä¿¡æ¯ï¼Œä¹‹åŽå‡¡æ˜¯æ¶‰åŠåˆ°ç”¨æˆ·ï¼Œç”¨æˆ·è§’è‰²ï¼Œç”¨æˆ·æƒé™å’Œç”¨æˆ·ä¸ªæ€§åŒ–é…ç½®çš„ç›¸å…³å¢žåˆ æ”¹æ“ä½œéƒ½åº”è¯¥åŠæ—¶æ›´æ–°ç›¸åº”çš„ç¼“å­˜ã€‚åŠ¨æ€è·¯ç”±æž„å»ºä¸åŒçš„ç”¨æˆ·æ‹¥æœ‰ä¸åŒçš„è§’è‰²ï¼Œä¸åŒçš„è§’è‰²å¯¹åº”ä¸åŒçš„èœå•æƒé™ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ç”¨æˆ·æŸ¥è¯¢å‡ºå¯¹åº”çš„èœå•åˆ—è¡¨ï¼Œç„¶åŽå°†åˆ—è¡¨æž„å»ºæˆå‰ç«¯éœ€è¦çš„è·¯ç”±ï¼ˆå‰ç«¯æ ¹æ®è·¯ç”±ä¿¡æ¯æž„å»ºç›¸åº”çš„èœå•ï¼‰ã€‚èŽ·å–ç”¨æˆ·è·¯ç”±çš„æ–¹æ³•ä¸ºUserManage#getUserRoutersï¼š12345678910111213141516171819202122/** * é€šè¿‡ç”¨æˆ·åæž„å»º Vueè·¯ç”± * * @param username ç”¨æˆ·å * @return è·¯ç”±é›†åˆ */public ArrayList&lt;VueRouter&lt;Menu&gt;&gt; getUserRouters(String username) &#123; List&lt;VueRouter&lt;Menu&gt;&gt; routes = new ArrayList&lt;&gt;(); List&lt;Menu&gt; menus = this.menuService.findUserMenus(username); menus.forEach(menu -&gt; &#123; VueRouter&lt;Menu&gt; route = new VueRouter&lt;&gt;(); route.setId(menu.getMenuId().toString()); route.setParentId(menu.getParentId().toString()); route.setIcon(menu.getIcon()); route.setPath(menu.getPath()); route.setComponent(menu.getComponent()); route.setName(menu.getMenuName()); route.setMeta(new RouterMeta(true, null)); routes.add(route); &#125;); return TreeUtil.buildVueRouter(routes);&#125;æ¯”å¦‚ç”¨æˆ·mrbirdå¯¹åº”çš„å‰ç«¯è·¯ç”±ä¸ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277[ &#123; "path": "/", "name": "ä¸»é¡µ", "component": "MenuView", "icon": "none", "redirect": "/home", "children": [ &#123; "path": "/home", "name": "ç³»ç»Ÿä¸»é¡µ", "component": "HomePageView", "icon": "home", "meta": &#123; "closeable": false, "isShow": true &#125; &#125;, &#123; "path": "/system", "name": "ç³»ç»Ÿç®¡ç†", "component": "PageView", "icon": "appstore-o", "meta": &#123; "closeable": true &#125;, "children": [ &#123; "path": "/system/user", "name": "ç”¨æˆ·ç®¡ç†", "component": "system/user/User", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/system/role", "name": "è§’è‰²ç®¡ç†", "component": "system/role/Role", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/system/menu", "name": "èœå•ç®¡ç†", "component": "system/menu/Menu", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/system/dept", "name": "éƒ¨é—¨ç®¡ç†", "component": "system/dept/Dept", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/system/dict", "name": "å­—å…¸ç®¡ç†", "component": "system/dict/Dict", "icon": "", "meta": &#123; "closeable": true &#125; &#125; ] &#125;, &#123; "path": "/monitor", "name": "ç³»ç»Ÿç›‘æŽ§", "component": "PageView", "icon": "dashboard", "meta": &#123; "closeable": true &#125;, "children": [ &#123; "path": "/monitor/online", "name": "åœ¨çº¿ç”¨æˆ·", "component": "monitor/Online", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/monitor/systemlog", "name": "ç³»ç»Ÿæ—¥å¿—", "component": "monitor/SystemLog", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/monitor/redis/info", "name": "Redisç›‘æŽ§", "component": "monitor/RedisInfo", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/monitor/httptrace", "name": "è¯·æ±‚è¿½è¸ª", "component": "monitor/Httptrace", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/monitor/system", "name": "ç³»ç»Ÿä¿¡æ¯", "component": "EmptyPageView", "meta": &#123; "closeable": true &#125;, "children": [ &#123; "path": "/monitor/system/jvminfo", "name": "JVMä¿¡æ¯", "component": "monitor/JvmInfo", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/monitor/system/tomcatinfo", "name": "Tomcatä¿¡æ¯", "component": "monitor/TomcatInfo", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/monitor/system/info", "name": "æœåŠ¡å™¨ä¿¡æ¯", "component": "monitor/SystemInfo", "meta": &#123; "closeable": true &#125; &#125; ] &#125; ] &#125;, &#123; "path": "/job", "name": "ä»»åŠ¡è°ƒåº¦", "component": "PageView", "icon": "clock-circle-o", "meta": &#123; "closeable": true &#125;, "children": [ &#123; "path": "/job/job", "name": "å®šæ—¶ä»»åŠ¡", "component": "quartz/job/Job", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/job/log", "name": "è°ƒåº¦æ—¥å¿—", "component": "quartz/log/JobLog", "icon": "", "meta": &#123; "closeable": true &#125; &#125; ] &#125;, &#123; "path": "/web", "name": "ç½‘ç»œèµ„æº", "component": "PageView", "icon": "compass", "meta": &#123; "closeable": true &#125;, "children": [ &#123; "path": "/web/weather", "name": "å¤©æ°”æŸ¥è¯¢", "component": "web/Weather", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/web/dailyArticle", "name": "æ¯æ—¥ä¸€æ–‡", "component": "web/DailyArticle", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/web/movie", "name": "å½±è§†èµ„è®¯", "component": "EmptyPageView", "meta": &#123; "closeable": true &#125;, "children": [ &#123; "path": "/web/movie/hot", "name": "æ­£åœ¨çƒ­æ˜ ", "component": "web/MovieHot", "icon": "", "meta": &#123; "closeable": true &#125; &#125;, &#123; "path": "/web/movie/coming", "name": "å³å°†ä¸Šæ˜ ", "component": "web/MovieComing", "icon": "", "meta": &#123; "closeable": true &#125; &#125; ] &#125; ] &#125;, &#123; "path": "/others", "name": "å…¶ä»–æ¨¡å—", "component": "PageView", "icon": "coffee", "meta": &#123; "closeable": true &#125;, "children": [ &#123; "path": "/others/excel", "name": "å¯¼å…¥å¯¼å‡º", "component": "others/Excel", "meta": &#123; "closeable": true &#125; &#125; ] &#125;, &#123; "path": "/profile", "name": "ä¸ªäººä¸­å¿ƒ", "component": "personal/Profile", "icon": "none", "meta": &#123; "closeable": true, "isShow": false &#125; &#125; ] &#125;, &#123; "path": "*", "name": "404", "component": "error/404" &#125;]å…³äºŽVue Routerå¯ä»¥å‚è€ƒï¼šhttps://router.vuejs.org/zh/ã€‚æƒé™æŽ§åˆ¶æˆ‘ä»¬å¯ä»¥åœ¨Controllerçš„æ–¹æ³•ä¸Šé€šè¿‡Shiroç›¸å…³çš„æƒé™æ³¨è§£è¿›è¡Œæƒé™æŽ§åˆ¶ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªæ–¹æ³•åªæœ‰å½“ç”¨æˆ·æ‹¥æœ‰user:addæƒé™æ‰èƒ½è®¿é—®ï¼š12345@PostMapping("/user")@RequiresPermissions("user:add")public void addUser(@Valid User user) &#123; ...&#125;å½“ç”¨æˆ·æ²¡æœ‰user:addæƒé™æ—¶ï¼Œç³»ç»Ÿå°†æŠ›å‡ºUnauthorizedExceptionå¼‚å¸¸ï¼Œç”±GlobalExceptionHandleræ•èŽ·ï¼Œè¿”å›ž403çŠ¶æ€ç ã€‚æ›´å¤šShiroæä¾›çš„æƒé™æ³¨è§£å¯ä»¥å‚è€ƒï¼š1234567891011121314// è¡¨ç¤ºå½“å‰Subjectå·²ç»é€šè¿‡loginè¿›è¡Œäº†èº«ä»½éªŒè¯ï¼›å³Subject.isAuthenticated()è¿”å›žtrueã€‚@RequiresAuthentication // è¡¨ç¤ºå½“å‰Subjectå·²ç»èº«ä»½éªŒè¯æˆ–è€…é€šè¿‡è®°ä½æˆ‘ç™»å½•çš„ã€‚@RequiresUser // è¡¨ç¤ºå½“å‰Subjectæ²¡æœ‰èº«ä»½éªŒè¯æˆ–é€šè¿‡è®°ä½æˆ‘ç™»å½•è¿‡ï¼Œå³æ˜¯æ¸¸å®¢èº«ä»½ã€‚@RequiresGuest // è¡¨ç¤ºå½“å‰Subjectéœ€è¦è§’è‰²adminå’Œuserã€‚ @RequiresRoles(value=&#123;"admin", "user"&#125;, logical= Logical.AND) // è¡¨ç¤ºå½“å‰Subjectéœ€è¦æƒé™user:aæˆ–user:bã€‚@RequiresPermissions (value=&#123;"user:a", "user:b"&#125;, logical= Logical.OR)å¤šæ•°æ®æºå¤šæ•°æ®æºé‡‡ç”¨çš„æ˜¯MyBatis Plusæä¾›çš„æ–¹æ¡ˆï¼šhttps://mp.baomidou.com/guide/dynamic-datasource.htmlä»£ç ç”Ÿæˆç›®å‰åªæœ‰åŽç«¯ä»£ç ç”Ÿæˆå™¨ï¼Œé‡‡ç”¨çš„æ˜¯MyBatis Plusæä¾›çš„æ–¹æ¡ˆï¼Œå¯¹åº”æºç cc.mrbird.febs.common.generator.CodeGeneratorï¼Œæ‰§è¡Œå…¶mainæ–¹æ³•ï¼Œç„¶åŽè¾“å…¥è¡¨åï¼Œå°±å¯ä»¥ç”Ÿæˆç›¸åº”çš„domainã€daoã€serviceã€controllerã€mapper.xmlã€‚Excelå¯¼å…¥å¯¼å‡ºExcelå¯¼å…¥å¯¼å‡ºä½¿ç”¨çš„æ’ä»¶ä¸ºï¼šhttps://gitee.com/wuwenze/ExcelKitï¼Œå…·ä½“æ“ä½œè§„åˆ™å¯ä»¥ä»”ç»†é˜…è¯»è¿™ä¸ªé¡¹ç›®çš„Readme.mdç»Ÿä¸€å‚æ•°æ ¡éªŒç»Ÿä¸€å‚æ•°æ ¡éªŒå¯ä»¥å‚è€ƒæˆ‘çš„åšå®¢ï¼šSpring Booté…åˆHibernate Validatorå‚æ•°æ ¡éªŒã€‚SQLæ‰“å°SQLæ‰“å°é‡‡ç”¨çš„æ’ä»¶ä¸ºp6spyï¼Œè¦å¼€å¯p6spyçš„SQLæ‰“å°åŠŸèƒ½ï¼Œåªéœ€å°†é…ç½®æ–‡ä»¶application.ymlä¸­çš„spring.datasource.dynamic.p6spyæ”¹ä¸ºtrueå³å¯ã€‚åœ¨p6spy.propertiesæ–‡ä»¶ä¸­å¯ä»¥é…ç½®æ‰“å°è§„åˆ™ï¼š123456789101112# ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿè®°å½• sqlappender=com.p6spy.engine.spy.appender.Slf4JLogger# è‡ªå®šä¹‰æ—¥å¿—æ‰“å°logMessageFormat=cc.mrbird.febs.common.config.P6spySqlFormatConfig# æ˜¯å¦å¼€å¯æ…¢ SQLè®°å½•outagedetection=true# æ…¢ SQLè®°å½•æ ‡å‡† 2 ç§’outagedetectioninterval=2# å¼€å¯è¿‡æ»¤filter=true# åŒ…å« QRTZçš„ä¸æ‰“å°exclude=QRTZSQLæ‰“å°æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011122019-04-08 15:29:50 | INFO | http-nio-9527-exec-1 | p6spy | 2019-04-08 15:29:50 | è€—æ—¶ 73 ms | SQL è¯­å¥ï¼šUPDATE t_user SET last_login_time=&apos;2019-04-08T15:29:50.724+0800&apos; WHERE username = &apos;mrbird&apos;;2019-04-08 15:29:50 | INFO | http-nio-9527-exec-1 | p6spy | 2019-04-08 15:29:50 | è€—æ—¶ 0 ms | SQL è¯­å¥ï¼šSELECT USER_ID,username,password,dept_id,email,mobile,status,create_time,modify_time,last_login_time,ssex,description,avatar FROM t_user WHERE username = &apos;mrbird&apos;;2019-04-08 15:29:52 | INFO | http-nio-9527-exec-1 | p6spy | 2019-04-08 15:29:52 | è€—æ—¶ 489 ms | SQL è¯­å¥ï¼šINSERT INTO t_login_log ( username, login_time, location, ip ) VALUES ( &apos;mrbird&apos;, &apos;2019-04-08T15:29:50.874+0800&apos;, &apos;&apos;, &apos;127.0.0.1&apos; );2019-04-08 15:45:20 | INFO | http-nio-9527-exec-7 | p6spy | 2019-04-08 15:45:20 | è€—æ—¶ 1 ms | SQL è¯­å¥ï¼šUPDATE t_user SET last_login_time=&apos;2019-04-08T15:45:20.193+0800&apos; WHERE username = &apos;scott&apos;;2019-04-08 15:45:20 | INFO | http-nio-9527-exec-7 | p6spy | 2019-04-08 15:45:20 | è€—æ—¶ 0 ms | SQL è¯­å¥ï¼šSELECT USER_ID,username,password,dept_id,email,mobile,status,create_time,modify_time,last_login_time,ssex,description,avatar FROM t_user WHERE username = &apos;scott&apos;;2019-04-08 15:45:21 | INFO | http-nio-9527-exec-7 | p6spy | 2019-04-08 15:45:21 | è€—æ—¶ 89 ms | SQL è¯­å¥ï¼šINSERT INTO t_login_log ( username, login_time, location, ip ) VALUES ( &apos;scott&apos;, &apos;2019-04-08T15:45:20.466+0800&apos;, &apos;&apos;, &apos;127.0.0.1&apos; );å¼€å¯è¿™ä¸ªåŠŸèƒ½æ–¹ä¾¿æˆ‘ä»¬å¼€å‘è°ƒè¯•ï¼Œç”Ÿäº§çŽ¯å¢ƒæœ€å¥½å…³é—­è¿™ä¸ªåŠŸèƒ½ï¼Œå› ä¸ºå®ƒåœ¨ä¸€å®šç¨‹åº¦ä¸Šä¼šé€ æˆæ€§èƒ½è€—æŸã€‚æ›´å¤šp6psyçš„é…ç½®å¯ä»¥å‚è€ƒï¼šhttps://p6spy.readthedocs.io/en/latest/configandusage.htmlAOPè®°å½•æ“ä½œæ—¥å¿—å…·ä½“å¯ä»¥å‚è€ƒæˆ‘çš„åšå®¢ï¼šSpring Boot AOPè®°å½•ç”¨æˆ·æ“ä½œæ—¥å¿—ã€‚è®°å½•æ“ä½œæ—¥å¿—çš„è¿‡ç¨‹å¯ä»¥æ”¹ä¸ºå¼‚æ­¥çš„æ–¹å¼ï¼Œè¿™æ ·ä¸ä¼šé€ æˆæŽ¥å£æ€§èƒ½æŸè€—ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„åšå®¢ï¼šSpring Boot ä¸­çš„å¼‚æ­¥è°ƒç”¨ã€‚æŽ¥å£é™æµé¡¹ç›®ä¸­@Limitæ³¨è§£å¯ä»¥å®žçŽ°æŽ¥å£çš„é™æµã€‚å³è§„å®šä¸€æ®µæ—¶é—´å†…æœ€å¤šå¯ä»¥è®¿é—®è¯¥æŽ¥å£çš„æ¬¡æ•°ï¼Œè¶…è¿‡è¿™ä¸ªæ¬¡æ•°åˆ™æŠ›å‡ºLimitAccessExceptionå¼‚å¸¸ã€‚@Limitæ³¨è§£å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819import cc.mrbird.common.domain.LimitType;import java.lang.annotation.*;@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)public @interface Limit &#123; // èµ„æºåç§°ï¼Œç”¨äºŽæè¿°æŽ¥å£åŠŸèƒ½ String name() default ""; // èµ„æº key String key() default ""; // key prefix String prefix() default ""; // æ—¶é—´çš„ï¼Œå•ä½ç§’ int period(); // é™åˆ¶è®¿é—®æ¬¡æ•° int count(); // é™åˆ¶ç±»åž‹ LimitType limitType() default LimitType.CUSTOMER;&#125;å…¶ä¸­ï¼ŒlimitTypeåŒ…å«ä¼ ç»Ÿç±»åž‹é™æµå’Œæ ¹æ®IPé™æµï¼Œå…¶ä¸ºæžšä¸¾ç±»åž‹ï¼š123456public enum LimitType &#123; // ä¼ ç»Ÿç±»åž‹ CUSTOMER, // æ ¹æ® IP é™åˆ¶ IP;&#125;ä¸‹é¢ä¸¾ä¸ªä½¿ç”¨ç¤ºä¾‹ï¼š1234567891011121314151617import cc.mrbird.common.annotation.Limit;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RestController;import java.util.concurrent.atomic.AtomicInteger;@RestControllerpublic class TestController &#123; private static final AtomicInteger ATOMIC_INTEGER = new AtomicInteger(); @Limit(key = "test", period = 600, count = 10, name = "resource", prefix = "limit") @GetMapping("/test") public int testLimiter() &#123; return ATOMIC_INTEGER.incrementAndGet(); &#125;&#125;ä¸Šé¢é…ç½®è¡¨ç¤ºä½¿ç”¨ä¼ ç»Ÿé™æµçš„æ–¹å¼ï¼ŒtestLimiteræ–¹æ³•åœ¨600ç§’å†…æœ€å¤šåªèƒ½è®¿é—®10æ¬¡ã€‚å½“600ç§’å†…ç¬¬11æ¬¡è®¿é—®è¯¥æŽ¥å£æ—¶ï¼ŒæŽ¥å£å°†æŠ›å‡ºLimitAccessExceptionå¼‚å¸¸ã€‚Shiroæ•™ç¨‹Apache Shiroç®€ä»‹Spring Boot Shiroç”¨æˆ·è®¤è¯Spring Boot Shiro æ·»åŠ è®°ä½æˆ‘åŠŸèƒ½Spring Boot Shiroæƒé™æŽ§åˆ¶Spring Boot Shiroä¸­ä½¿ç”¨ç¼“å­˜Spring Boot Thymeleafä¸­ä½¿ç”¨Shiroæ ‡ç­¾Spring Boot Shiroåœ¨çº¿ä¼šè¯ç®¡ç†Shiroå¦‚ä½•æ•´åˆJWTShiroå¦‚ä½•æ•´åˆJWTå¯ä»¥å‚è€ƒï¼šhttps://gitlab.com/wuyouzhuguli/shiro_jwtä¸ºäº†ç®€åŒ–è¿‡ç¨‹ï¼Œä¾‹å­æ²¡æœ‰ä½¿ç”¨æ•°æ®åº“å’ŒRedisï¼Œåœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿäº†ä¸¤ä¸ªç”¨æˆ·ï¼š12345678910111213141516171819202122/** * æ¨¡æ‹Ÿä¸¤ä¸ªç”¨æˆ· * * @return List&lt;User&gt; */private static List&lt;User&gt; users() &#123; List&lt;User&gt; users = new ArrayList&lt;&gt;(); // æ¨¡æ‹Ÿä¸¤ä¸ªç”¨æˆ·ï¼š // 1. ç”¨æˆ·å adminï¼Œå¯†ç  123456ï¼Œè§’è‰² adminï¼ˆç®¡ç†å‘˜ï¼‰ï¼Œæƒé™ "user:add"ï¼Œ"user:view" // 1. ç”¨æˆ·å scottï¼Œå¯†ç  123456ï¼Œè§’è‰² registï¼ˆæ³¨å†Œç”¨æˆ·ï¼‰ï¼Œæƒé™ "user:view" users.add(new User( "admin", "bfc62b3f67a4c3e57df84dad8cc48a3b", new HashSet&lt;&gt;(Collections.singletonList("admin")), new HashSet&lt;&gt;(Arrays.asList("user:add", "user:view")))); users.add(new User( "scott", "11bd73355c7bbbac151e4e4f943e59be", new HashSet&lt;&gt;(Collections.singletonList("regist")), new HashSet&lt;&gt;(Collections.singletonList("user:view")))); return users;&#125;å¯ä»¥ä½¿ç”¨PostManè¿›è¡ŒæŽ¥å£æµ‹è¯•ã€‚å‰ç«¯é¡¹ç›®ä»‹ç»é¡¹ç›®ç»“æž„é¡¹ç›®æœºæž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šæ•°æ®å­˜å‚¨åœ¨ç”¨æˆ·ç™»å½•æˆåŠŸåŽï¼Œé¡¹ç›®ä¼šé€šè¿‡Vuexå’Œlocalstorageå­˜å‚¨ä¸€äº›æ•°æ®ä¾›é¡¹ç›®å…¨å±€ä½¿ç”¨ã€‚æ­£å¦‚å‰é¢æ‰€è¯´ï¼Œå½“ç”¨æˆ·ç™»å½•æˆåŠŸåŽï¼ŒåŽç«¯ä¼šè¿”å›žå¦‚ä¸‹æ•°æ®ï¼štokenï¼štokenï¼›exipreTimeï¼štokenè¿‡æœŸæ—¶é—´ï¼›rolesï¼šç”¨æˆ·è§’è‰²ï¼›permissionsï¼šç”¨æˆ·æƒé™ï¼›configï¼šç”¨æˆ·å‰ç«¯ç³»ç»Ÿçš„ä¸ªæ€§åŒ–é…ç½®ï¼›userï¼šç”¨æˆ·ä¿¡æ¯ï¼ˆä¸åŒ…æ‹¬å¯†ç ï¼‰ã€‚åœ¨src/views/login/Login.vueæ–‡ä»¶ä¸­ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹ä»£ç ï¼š1234567891011121314151617181920212223242526...mapMutations(&#123; setToken: 'account/setToken', setExpireTime: 'account/setExpireTime', setPermissions: 'account/setPermissions', setRoles: 'account/setRoles', setUser: 'account/setUser', setTheme: 'setting/setTheme', setLayout: 'setting/setLayout', setMultipage: 'setting/setMultipage', fixSiderbar: 'setting/fixSiderbar', fixHeader: 'setting/fixHeader', setColor: 'setting/setColor'&#125;),saveLoginData (data) &#123; this.setToken(data.token) this.setExpireTime(data.exipreTime) this.setUser(data.user) this.setPermissions(data.permissions) this.setRoles(data.roles) this.setTheme(data.config.theme) this.setLayout(data.config.layout) this.setMultipage(data.config.multiPage === '1') this.fixSiderbar(data.config.fixSiderbar === '1') this.fixHeader(data.config.fixHeader === '1') this.setColor(data.config.color)&#125;è¿™å°†æŠŠç™»å½•æŽ¥å£è¿”å›žçš„æ•°æ®å­˜å‚¨åˆ°Vuexå’Œæµè§ˆå™¨çš„localstorageä¸­ã€‚å­˜å‚¨Tokençš„åŽŸå› æ˜¯ï¼ŒåŽç»­éœ€è¦è®¤è¯çš„è¯·æ±‚ï¼Œéƒ½ä¼šåœ¨è¯·æ±‚å¤´ä¸­æºå¸¦è¿™ä¸ªTokenï¼›å­˜å‚¨ExpireTimeçš„åŽŸå› æ˜¯ä¸ºäº†ä¼˜åŒ–è®¤è¯è¿‡æœŸæ—¶çš„ç”¨æˆ·ä½“éªŒï¼›å­˜å‚¨ç”¨æˆ·ä¿¡æ¯çš„åŽŸå› æ˜¯ä¸ºäº†ä¾›ä¸ªäººä¸­å¿ƒå’Œç³»ç»Ÿä¸»é¡µä½¿ç”¨ï¼›å­˜å‚¨è§’è‰²å’Œæƒé™æ˜¯ä¸ºäº†åˆ¤æ–­é¡µé¢æŒ‰é’®æ¸²æŸ“ä¸Žå¦ï¼›å­˜å‚¨ç”¨æˆ·ä¸ªæ€§åŒ–é…ç½®çš„åŽŸå› æ˜¯ä¸ºäº†é€šè¿‡è¿™äº›é…ç½®æ¸²æŸ“ä¸åŒçš„ç³»ç»Ÿç•Œé¢ã€‚è·¯ç”±å¯¼èˆªå®ˆå«è·¯ç”±å¯¼èˆªå®ˆå«ä»£ç ä½ç½®ï¼šfrontend/src/router/index.jsï¼š12345678910111213141516171819202122232425262728293031323334353637383940...const whiteList = ['/login']let asyncRouter// å¯¼èˆªå®ˆå«ï¼Œæ¸²æŸ“åŠ¨æ€è·¯ç”±router.beforeEach((to, from, next) =&gt; &#123; if (whiteList.indexOf(to.path) !== -1) &#123; next() &#125; let token = db.get('USER_TOKEN') let user = db.get('USER') let userRouter = get('USER_ROUTER') if (token.length &amp;&amp; user) &#123; if (!asyncRouter) &#123; if (!userRouter) &#123; request.get(`menu/$&#123;user.username&#125;`).then((res) =&gt; &#123; asyncRouter = res.data save('USER_ROUTER', asyncRouter) go(to, next) &#125;) &#125; else &#123; asyncRouter = userRouter go(to, next) &#125; &#125; else &#123; next() &#125; &#125; else &#123; next('/login') &#125;&#125;)function go (to, next) &#123; asyncRouter = filterAsyncRouter(asyncRouter) router.addRoutes(asyncRouter) next(&#123;...to, replace: true&#125;)&#125;...ä¸»è¦é€»è¾‘åˆ†ä¸ºä¸‹é¢å‡ æ­¥ï¼šåˆ¤æ–­è¦è·³è½¬çš„è·¯ç”±åœ°å€æ˜¯å¦åœ¨è·¯ç”±ç™½åå•å†…ï¼Œæ˜¯çš„è¯æ”¾è¡Œï¼Œä¸æ˜¯çš„è¯è¿›è¡Œç¬¬2æ­¥ï¼›ä»Žå†…å­˜ä¸­èŽ·å–tokenå’Œç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æžœå­˜åœ¨åˆ™è¿›è¡Œç¬¬3æ­¥ï¼Œä¸å­˜åœ¨è·³è½¬åˆ°ç™»å½•é¡µï¼›åˆ¤æ–­åŠ¨æ€è·¯ç”±ä¿¡æ¯æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨åˆ™æ”¾è¡Œï¼Œä¸å­˜åœ¨åˆ™è¿›è¡Œç¬¬4æ­¥ï¼›åˆ¤æ–­ç”¨æˆ·è·¯ç”±æ˜¯å¦å·²ç»åŠ è½½ï¼Œæ˜¯çš„è¯å°†ç”¨æˆ·è·¯ç”±èµ‹å€¼ç»™åŠ¨æ€è·¯ç”±ï¼Œå¹¶æ‰§è¡Œè·¯ç”±æ·»åŠ æ“ä½œï¼Œç„¶åŽè·³è½¬ï¼›å¦‚æžœç”¨æˆ·è·¯ç”±ä¸å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œç¬¬5æ­¥ï¼›æ ¹æ®ç”¨æˆ·åä»ŽåŽå°èŽ·å–ç”¨æˆ·è·¯ç”±ä¿¡æ¯ï¼Œå¹¶å°†å…¶ä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œå†æ‰§è¡Œè·¯ç”±æ·»åŠ æ“ä½œï¼Œç„¶åŽè·³è½¬ã€‚æƒé™æŽ§åˆ¶åœ¨å‰ç«¯é¡µé¢ä¸­ï¼Œæˆ‘ä»¬å·²ç»å®žçŽ°äº†é€šè¿‡ä¸åŒç”¨æˆ·èŽ·å–ä¸åŒçš„è·¯ç”±ï¼Œä»¥æ­¤æ¸²æŸ“å‡ºä¸åŒçš„èœå•åˆ—è¡¨åŠŸèƒ½ï¼Œæ­¤å¤–é¡µé¢ä¸Šçš„æ“ä½œæŒ‰é’®ä¹Ÿå¿…é¡»è¿›è¡Œæƒé™æŽ§åˆ¶ã€‚æ­£å¦‚å‰é¢æ‰€è¿°ï¼Œåœ¨ç™»å½•æˆåŠŸåŽï¼Œç³»ç»Ÿä¼šæŠŠç”¨æˆ·çš„è§’è‰²å’Œæƒé™ä¿¡æ¯å­˜å‚¨åˆ°äº†å†…å­˜ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™äº›ä¿¡æ¯ç»“åˆ è‡ªå®šä¹‰VueæŒ‡ä»¤ çš„æ–¹å¼æ¥å®žçŽ°æŒ‰é’®çš„æƒé™æŽ§åˆ¶ã€‚ç›®å‰æ”¯æŒçš„å’Œæƒé™ç›¸å…³çš„VueæŒ‡ä»¤æœ‰ï¼šæŒ‡ä»¤å«ä¹‰ç¤ºä¾‹v-hasPermissionå½“ç”¨æˆ·æ‹¥æœ‰åˆ—å‡ºçš„æƒé™çš„æ—¶å€™ï¼Œæ¸²æŸ“è¯¥å…ƒç´ &lt;template v-hasPermission=&quot;&#39;user:add&#39;,&#39;user:update&#39;&quot;&gt;&lt;span&gt;hello&lt;/span&gt;&lt;/template&gt;v-hasAnyPermissionå½“ç”¨æˆ·æ‹¥æœ‰åˆ—å‡ºçš„ä»»æ„ä¸€é¡¹æƒé™çš„æ—¶å€™ï¼Œæ¸²æŸ“è¯¥å…ƒç´ &lt;template v-hasAnyPermission=&quot;&#39;user:add&#39;,&#39;user:update&#39;&quot;&gt;&lt;span&gt;hello&lt;/span&gt;&lt;/template&gt;v-hasRoleå½“ç”¨æˆ·æ‹¥æœ‰åˆ—å‡ºçš„è§’è‰²çš„æ—¶å€™ï¼Œæ¸²æŸ“è¯¥å…ƒç´ &lt;template v-hasRole=&quot;&#39;admin&#39;,&#39;register&#39;&quot;&gt;&lt;span&gt;hello&lt;/span&gt;&lt;/template&gt;v-hasAnyRoleå½“ç”¨æˆ·æ‹¥æœ‰åˆ—å‡ºçš„ä»»æ„ä¸€ä¸ªè§’è‰²çš„æ—¶å€™ï¼Œæ¸²æŸ“è¯¥å…ƒç´ &lt;template v-hasAnyRole=&quot;&#39;admin&#39;,&#39;register&#39;&quot;&gt;&lt;span&gt;hello&lt;/span&gt;&lt;/template&gt;hasNoPermissionå½“ç”¨æˆ·æ²¡æœ‰åˆ—å‡ºçš„æƒé™çš„æ—¶å€™ï¼Œæ¸²æŸ“è¯¥å…ƒç´ &lt;template v-hasNoPermission=&quot;&#39;user:add&#39;,&#39;register&#39;&quot;&gt;&lt;span&gt;æ— æ“ä½œæƒé™&lt;/span&gt;&lt;/template&gt;ä»¥v-hasPermission=&quot;user:add&quot;ä¸ºä¾‹ï¼Œè¯¦ç»†ä»‹ç»ä¸‹è‡ªå®šä¹‰æƒé™VueæŒ‡ä»¤çš„å®žçŽ°è¿‡ç¨‹ï¼šåœ¨src/utils/permissionDirect.jsä¸­å®šä¹‰å¦‚ä¸‹ä»£ç ï¼š1234567891011121314151617181920212223 export const hasPermission = &#123; install (Vue) &#123; Vue.directive('hasPermission', &#123; bind (el, binding, vnode) &#123; let permissions = vnode.context.$store.state.account.permissions let value = binding.value.split(',') let flag = true for (let v of value) &#123; if (!permissions.includes(v)) &#123; flag = false &#125; &#125; if (!flag) &#123; if (!el.parentNode) &#123; el.style.display = 'none' &#125; else &#123; el.parentNode.removeChild(el) &#125; &#125; &#125; &#125;) &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä»ŽVuexä¸­èŽ·å–äº†ç”¨æˆ·æ‰€æ‹¥æœ‰çš„æƒé™ï¼Œç„¶åŽåˆ¤æ–­è¿™äº›æƒé™ä¸­æ˜¯å¦åŒ…å«user:addï¼Œå¦‚æžœä¸åŒ…å«ï¼Œåˆ™å°†å¯¹åº”çš„å…ƒç´ ï¼ˆelï¼‰ç§»é™¤æˆ–è€…éšè—ã€‚æ‰€ä»¥å½“ç”¨æˆ·æ²¡æœ‰user:addæƒé™æ—¶ï¼Œä¸‹é¢çš„æŒ‰é’®å°†ä¸ä¼šè¢«æ¸²æŸ“åœ¨é¡µé¢ä¸Šï¼š1&lt;template v-hasPermission="'user:add'"&gt;&lt;button&gt;æ–°å¢žç”¨æˆ·&lt;/button&gt;&lt;/template&gt;è¦è®©è‡ªå®šä¹‰VueæŒ‡ä»¤ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦åœ¨src/utils/install.jsä¸­å°†å…¶æ·»åŠ åˆ°Pluginsåˆ—è¡¨ã€‚Axioså°è£…é¡¹ç›®ä½¿ç”¨Axiosæ’ä»¶æ¥å‘é€HTTPè¯·æ±‚ï¼Œå¹¶å¯¹å®ƒè¿›è¡Œäº†å°è£…ï¼ˆfrontend/src/utils/request.jsï¼‰ï¼Œè¿™é‡Œä¸»è¦è®²è¿°ä¸‹request.jsä¸­ä¸»è¦é€»è¾‘ã€‚123456789// ç»Ÿä¸€é…ç½®let FEBS_REQUEST = axios.create(&#123; baseURL: 'http://127.0.0.1:9527/', responseType: 'json', validateStatus (status) &#123; // 200 å¤–çš„çŠ¶æ€ç éƒ½è®¤å®šä¸ºå¤±è´¥ return status === 200 &#125;&#125;)ä¸Šé¢è¿™æ®µä»£ç å¯¹è¯·æ±‚è¿›è¡Œäº†ç»Ÿä¸€é…ç½®ï¼ŒbaseURLå®šä¹‰äº†åŽç«¯åœ°å€çš„åŸºç¡€è·¯å¾„ï¼ŒresponseTypeå®šä¹‰äº†å“åº”æ•°æ®ç±»åž‹ä¸ºJSONï¼Œåªæœ‰çŠ¶æ€ç ä¸º200æ—¶æ‰è®¤å®šè¯·æ±‚æˆåŠŸã€‚1234567891011121314151617181920212223242526272829// æ‹¦æˆªè¯·æ±‚FEBS_REQUEST.interceptors.request.use((config) =&gt; &#123; let expireTime = store.state.account.expireTime let now = moment().format('YYYYMMDDHHmmss') // è®©tokenæ—©10ç§’ç§è¿‡æœŸï¼Œæå‡â€œè¯·é‡æ–°ç™»å½•â€å¼¹çª—ä½“éªŒ if (now - expireTime &gt;= -10) &#123; Modal.error(&#123; title: 'ç™»å½•å·²è¿‡æœŸ', content: 'å¾ˆæŠ±æ­‰ï¼Œç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•', okText: 'é‡æ–°ç™»å½•', mask: false, onOk: () =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; // ä¸ºä»€ä¹ˆä¸ç›´æŽ¥è·³è½¬åˆ°ç™»å½•é¡µå‘¢ï¼Ÿé‚£æ˜¯å› ä¸ºVueæ²¡æœ‰æä¾›æ¸…ç©ºè·¯ç”±çš„æ–¹æ³•ï¼Œåªèƒ½é€šè¿‡åˆ·æ–°é¡µé¢çš„æ–¹å¼ // æ¥æ¸…é™¤ä¹‹å‰åŠ¨æ€æ·»åŠ çš„è·¯ç”±ä¿¡æ¯ã€‚ db.clear() location.reload() &#125;) &#125; &#125;) &#125; // æœ‰ tokenå°±å¸¦ä¸Š if (store.state.account.token) &#123; config.headers.Authentication = store.state.account.token &#125; return config&#125;, (error) =&gt; &#123; return Promise.reject(error)&#125;)åœ¨Axiosçš„å‰ç½®æ‹¦æˆªä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ¤æ–­äº†tokenæ˜¯å¦å·²ç»è¿‡æœŸï¼Œå¦‚æžœè¿‡æœŸäº†åˆ™æ¸…ç©ºåœ¨ç™»å½•æ—¶ä¿å­˜çš„æ•°æ®ï¼Œå¹¶ä¸”åˆ·æ–°é¡µé¢ã€‚è¿™æ—¶å€™é€šè¿‡è·¯ç”±å¯¼èˆªå®ˆå«ï¼Œé¡µé¢ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ï¼Œå¼•å¯¼ç”¨æˆ·é‡æ–°ç™»å½•ã€‚å¦‚æžœtokenæ²¡æœ‰è¿‡æœŸï¼Œåˆ™åœ¨è¯·æ±‚å¤´ä¸Šå¸¦ä¸Štokenä¿¡æ¯ã€‚headers.Authenticationå’ŒåŽç«¯ä»£ç ä¸­çš„TOKENåç§°ç›¸å¯¹åº”ï¼š123456789101112131415161718192021222324252627282930313233// æ‹¦æˆªå“åº”FEBS_REQUEST.interceptors.response.use((config) =&gt; &#123; return config&#125;, (error) =&gt; &#123; if (error.response) &#123; let errorMessage = error.response.data === null ? 'ç³»ç»Ÿå†…éƒ¨å¼‚å¸¸ï¼Œè¯·è”ç³»ç½‘ç«™ç®¡ç†å‘˜' : error.response.data.message switch (error.response.status) &#123; case 404: notification.error(&#123; message: 'ç³»ç»Ÿæç¤º', description: 'å¾ˆæŠ±æ­‰ï¼Œèµ„æºæœªæ‰¾åˆ°', duration: 4 &#125;) break case 403: case 401: notification.warn(&#123; message: 'ç³»ç»Ÿæç¤º', description: 'å¾ˆæŠ±æ­‰ï¼Œæ‚¨æ— æ³•è®¿é—®è¯¥èµ„æºï¼Œå¯èƒ½æ˜¯å› ä¸ºæ²¡æœ‰ç›¸åº”æƒé™æˆ–è€…ç™»å½•å·²å¤±æ•ˆ', duration: 4 &#125;) break default: notification.error(&#123; message: 'ç³»ç»Ÿæç¤º', description: errorMessage, duration: 4 &#125;) break &#125; &#125; return Promise.reject(error)&#125;)ä¸Šé¢ä»£ç ä¸­æˆ‘ä»¬å®žçŽ°äº†å¼‚å¸¸å“åº”çš„ç»Ÿä¸€å¤„ç†ï¼Œæ ¹æ®ä¸åŒçš„çŠ¶æ€ç ç»™äºˆä¸åŒçš„æç¤ºä¿¡æ¯ã€‚æ­¤å¤–ï¼Œé¡¹ç›®è¿˜å¯¹å„ç§HTTPè¯·æ±‚è¿›è¡Œäº†å°è£…ï¼Œä¸‹é¢ä¸€ä¸€åˆ—ä¸¾å‡ºå®ƒä»¬çš„ç”¨æ³•ï¼šGETè¯·æ±‚æ–¹å¼ä¸€ï¼š12345this.$get('user', &#123; ...params&#125;).then((r) =&gt; &#123; console.log(r)&#125;)å› ä¸ºæˆ‘ä»¬åœ¨å‰é¢å·²ç»å®šä¹‰äº†åŽç«¯åœ°å€çš„åŸºç¡€è·¯å¾„ï¼Œæ‰€ä»¥ä¸Šé¢è¿™ä¸ªè¯·æ±‚çš„å®žé™…åœ°å€ä¸ºï¼šhttp://127.0.0.1:9527/userã€‚åœ¨å‰é¢æˆ‘ä»¬å·²ç»å¯¹å¼‚å¸¸å“åº”è¿›è¡Œç»Ÿä¸€å¤„ç†ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€šè¿‡catchæ¥è¦†ç›–ï¼š1234567this.$get('user', &#123; ...params&#125;).then((r) =&gt; &#123; console.log(r)&#125;).catch((error) =&gt; &#123; alert('å‡ºé”™å•¦')&#125;)æ–¹å¼äºŒï¼ˆè·¯å¾„ä¼ å‚ï¼‰ï¼š123this.$get(`menu/$&#123;user.username&#125;`).then((r) =&gt; &#123; console.log(r)&#125;)æ–¹å¼ä¸‰ï¼š123this.$get(`user?username=$&#123;user.username&#125;`).then((r) =&gt; &#123; console.log(r)&#125;)POSTè¯·æ±‚12345this.$post('user', &#123; ...params&#125;).then((r) =&gt; &#123; console.log(r)&#125;)PUTè¯·æ±‚12345this.$put('user', &#123; ...params&#125;).then((r) =&gt; &#123; console.log(r)&#125;)DELETEè¯·æ±‚123this.$delete('user/$&#123;user.userId&#125;').then((r) =&gt; &#123; console.log(r)&#125;)ä¸‹è½½æ–‡ä»¶1this.$download('file', &#123; ...params &#125;, 'xxx.xx')xxx.xxä¸ºä¸‹è½½çš„æ–‡ä»¶åï¼Œæ¯”å¦‚ä¸‹è½½xlsxæ–‡ä»¶çš„è¯ä¸º Excelæ–‡ä»¶.xlsxï¼ŒåŽç«¯æŽ¥å£è¿”å›žæ•°æ®æµå³å¯ã€‚ä¸Šä¼ æ–‡ä»¶1234let formData = new FormData($("#form")[0]);this.$upload('upload', formData).then((r) =&gt; &#123; console.log(r)&#125;)åŽç«¯ä»¥MultipartFileæŽ¥æ”¶æ–‡ä»¶å³å¯ã€‚è·¯å¾„é…ç½®åœ¨build/webpack.base.conf.jsä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€äº›è·¯å¾„å˜é‡ï¼š12345678910111213module.exports = &#123; ... resolve: &#123; ... alias: &#123; 'vue$': 'vue/dist/vue.esm.js', '@': resolve('src'), '~': resolve('src/components'), 'utils': resolve('src/utils') &#125; &#125;, ...&#125;æ¯”å¦‚~ä»£è¡¨src/componentsè·¯å¾„ï¼Œåœ¨é¡¹ç›®ä¸­ï¼Œå¦‚æžœè¦å¼•å…¥src/components/test.vueåªéœ€è¦è¿™æ ·åšå³å¯ï¼š1import ~/test.vueå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„ï¼Œè€Œä¸ä½¿ç”¨è¿™äº›å˜é‡ã€‚ç¬¬ä¸‰æ–¹ç»„ä»¶ä»‹ç»Ant Design Vueå·²ç»æä¾›äº†éžå¸¸ä¸°å¯Œçš„ç»„ä»¶ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œé¡¹ç›®é‡Œä½¿ç”¨çš„å›¾è¡¨æ’ä»¶ä¸ºï¼šapexcharts.jsï¼Œå…¶å®˜æ–¹æ–‡æ¡£æä¾›äº†å¾ˆå¤šç¤ºä¾‹ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚å¼€å‘å»ºè®®ç›¸ä¿¡æ­£åœ¨é˜…è¯»æ–‡æ¡£çš„ä½ åæœ‰å…«ä¹æ˜¯ä¸€ååŽç«¯å¼€å‘è€…ï¼Œå¯èƒ½å¯¹å‰ç«¯ç‰¹åˆ«æ˜¯å¯¹Vueä¸å¤ªç†Ÿæ‚‰ï¼Œè¿™é‡Œç»™å‡ºå‡ ç‚¹æ”¹é€ frontendçš„å»ºè®®ï¼šè¦æœ‰ä¸€å®šçš„ES6è¯­æ³•åŸºç¡€ï¼Œå¯ä»¥å‚è€ƒ ES6å­¦ä¹ ç¬”è®° ï¼Œå¦‚æžœè¦ç³»ç»Ÿå­¦ä¹ ES6ï¼ŒæŽ¨èé˜®ä¸€å³°çš„ï¼š ECMAScript 6 å…¥é—¨ ã€‚Vueçš„å®˜æ–¹æ–‡æ¡£è¿˜æ˜¯æŒºè¯¦ç»†çš„ï¼Œå»ºè®®ä»”ç»†é˜…è¯»ï¼Œæˆ‘åœ¨å­¦ä¹ Vueçš„æ—¶å€™ä¹Ÿåšäº†ä¸€äº›ç¬”è®°ï¼Œå¯ä»¥å‚è€ƒï¼šhttps://mrbird.cc/Vue-Learn-Note.htmlã€‚Vueçš„å­¦ä¹ è·¯çº¿ï¼šVueåŸºç¡€è¯­æ³• -&gt; Vuex -&gt; Vue Routerã€‚å‰ç«¯ç»„ä»¶ç”¨çš„æ˜¯Ant Design Vueï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨å®ƒæä¾›çš„ç»„ä»¶çš„æ—¶å€™ï¼Œå¤šé˜…è¯»å®ƒçš„ä½¿ç”¨æ–‡æ¡£ã€‚å¼€å‘ç¤ºä¾‹æ–°å»ºä¸€ä¸ªé¡µé¢åœ¨frontendå·¥ç¨‹çš„src/viewsä¸‹æ–°å»ºä¸€ä¸ªtestç›®å½•ï¼Œåœ¨è¯¥ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªtest.vueæ–‡ä»¶ï¼š å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314151617181920&lt;template&gt; &lt;div class="test"&gt;&#123;&#123;hello&#125;&#125;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: 'test', data () &#123; return &#123; hello: 'hello world' &#125; &#125;&#125;&lt;/script&gt;&lt;style lang="less" scoped&gt; .test &#123; color: #42b984; font-size: 1.1rem; font-weight: 600; &#125;&lt;/style&gt;å¯åŠ¨é¡¹ç›®ï¼Œä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•ï¼Œç„¶åŽåœ¨èœå•ç®¡ç†ä¸­æ–°å»ºä¸€ä¸ªèœå•ï¼šèœå•URLï¼šè¿™é‡Œå¡«å†™/testçš„è¯ï¼Œåœ¨è®¿é—®è¿™ä¸ªé¡µé¢çš„æ—¶å€™ï¼Œæµè§ˆå™¨åœ°å€æ ä¸ºhttp://localhost:8081/#/testï¼Œåªè¦ç¡®ä¿è¿™ä¸ªå€¼ä¸é‡å¤å³å¯ï¼›ç»„ä»¶åœ°å€ï¼šå¯¹åº”è¦æ¸²æŸ“çš„Vueç»„ä»¶åœ°å€ï¼Œåœ¨è·¯ç”±å¯¼èˆªå®ˆå«ä¸­æœ‰å¦‚ä¸‹ä¸€æ®µä»£ç ï¼šæ‰€ä»¥è¿™é‡Œå¡«test/testï¼Œå¯¹åº”@/views/test/test.vueç»„ä»¶ã€‚ç›¸å…³æƒé™ï¼šè®¿é—®è¿™ä¸ªé¡µé¢éœ€è¦test:viewæƒé™ã€‚ç‚¹å‡»ç¡®å®šåŽï¼Œè¿™ä¸ªèœå•å°±è¢«å»ºå¥½äº†ï¼šæŽ¥ç€ä¿®æ”¹ç®¡ç†å‘˜è§’è‰²ï¼Œå°†åˆšåˆšæ–°å»ºçš„èœå•æŽˆæƒç»™ç®¡ç†å‘˜ï¼šç‚¹å‡»ç¡®å®šä¿®æ”¹åŽï¼Œé‡æ–°ç™»å½•ç³»ç»Ÿï¼šå¦‚ä½•æ–°å»ºä¸€ä¸ªå¤šçº§èœå•åœ¨æ–°å¢žå¤šçº§èœå•å‰ï¼Œå…ˆäº†è§£ä¸‹ç³»ç»Ÿä¸­çš„ä¸€ä¸ªçº¦å®šï¼šåœ¨ä¸€ä¸ªå¤šçº§èœå•ä¸­ï¼Œé¡¶çº§èœå•å¯¹åº”çš„ç»„ä»¶ä¸ºPageViewï¼Œæœ«çº§èœå•å¯¹åº”çš„ç»„ä»¶ä¸ºéœ€è¦æ¸²æŸ“çš„é¡µé¢ç»„ä»¶ï¼Œå‰©ä¸‹çš„ï¼ˆéžé¡¶çº§ï¼Œéžæœ«çº§çš„ä¸­é—´èœå•å¯¹åº”çš„ç»„ä»¶ä¸ºEmptyPageViewï¼‰ã€‚æˆ‘ä»¬æ¥å»ºä¸€ä¸ªå››çº§èœå•ï¼Œé¦–å…ˆæ–°å¢žä¸€ä¸ªé¡¶çº§èœå•ï¼šå› ä¸ºæ˜¯é¡¶çº§èœå•ï¼Œæ‰€ä»¥å¯¹åº”ç»„ä»¶å¡«PageViewã€‚æŽ¥ç€æ–°å¢žç¬¬äºŒçº§èœå•ï¼šå› ä¸ºå®ƒæ•°æ®ä¸­é—´èœå•ï¼ˆéžé¡¶çº§éžæœ«çº§ï¼‰æ‰€ä»¥å¯¹åº”ç»„ä»¶å¡«EmptyPageViewï¼Œä¸Šçº§èœå•å‹¾é€‰åˆšåˆšæ–°å»ºçš„ä¸€çº§èœå•ã€‚ç»§ç»­æ–°å¢žä¸‰çº§èœå•ï¼šå› ä¸ºå®ƒä¹Ÿæ˜¯ä¸€ä¸ªä¸­é—´èœå•ï¼Œæ‰€ä»¥å¯¹åº”ç»„ä»¶å¡«EmptyPageViewï¼Œä¸Šçº§èœå•å‹¾é€‰åˆšåˆšæ–°å»ºçš„äºŒçº§èœå•ã€‚æœ€åŽå°†æˆ‘ä»¬å‰é¢å»ºå¥½çš„æµ‹è¯•é¡µé¢ä½œä¸ºæœ«çº§ï¼Œç‚¹å‡»æµ‹è¯•é¡µé¢åŽé¢çš„å°é½¿è½®æŒ‰é’®ï¼Œè¿›è¡Œä¿®æ”¹ï¼šç‚¹å‡»ç¡®å®šåŽä¸€ä¸ªå››çº§èœå•å°±å»ºå¥½äº†ï¼šæœ€åŽä¸€æ­¥æŽˆæƒï¼ä¿®æ”¹ç®¡ç†å‘˜è§’è‰²ï¼šä¿®æ”¹åŽï¼Œé‡æ–°ç™»å½•ç³»ç»Ÿï¼šå› ä¸ºæˆ‘æ²¡æœ‰è®¾ç½®æŽ’åºï¼Œæ‰€ä»¥é»˜è®¤æŽ’åœ¨æœ€å‰é¢äº†ã€‚å¦‚ä½•éšè—è·¯ç”±æœ‰çš„æ—¶å€™ï¼Œä¸€äº›è·¯ç”±å¹¶ä¸éœ€è¦æ¸²æŸ“æˆèœå•ï¼Œæ¯”å¦‚ä¸ªäººä¸­å¿ƒè¿™ç±»é¡µé¢ã€‚è€Œè¿™äº›é¡µé¢ä¸€èˆ¬éƒ½æ˜¯æ‰€æœ‰ç”¨æˆ·å…±æœ‰çš„ï¼Œæ‰€ä»¥åœ¨åŽå°ç³»ç»Ÿé‡Œæž„å»ºè·¯ç”±çš„æ—¶å€™å†™æ­»å³å¯ã€‚è¦éšè—è·¯ç”±åªéœ€è¦å°†è·¯ç”±metaçš„isShowå±žæ€§è®¾ç½®ä¸ºfalseå³å¯ï¼šå‚è€ƒåŽå°ä»£ç cc.mrbird.febs.common.utils.TreeUtilï¼šå¦‚ä½•åˆ†é…æƒé™æƒé™æ˜¯å’Œè§’è‰²ç»‘å®šçš„ï¼Œæ‰€ä»¥è¦åˆ†é…æƒé™å®žé™…å°±æ˜¯å¯¹è§’è‰²çš„å¢žåˆ æ”¹ã€‚å‡å¦‚çŽ°åœ¨è¦é…ç½®ä¸€ä¸ªè§’è‰² â€”â€”â€” ç³»ç»Ÿç›‘æŽ§ç®¡ç†å‘˜ï¼Œè´Ÿè´£ç³»ç»Ÿç›‘æŽ§æ¨¡å—çš„æŸ¥çœ‹ï¼šç„¶åŽæ–°å¢žä¸€ä¸ªç”¨æˆ· â€”â€”â€” yuukiï¼Œè§’è‰²ä¸ºç³»ç»Ÿç›‘æŽ§ç®¡ç†å‘˜ï¼šæ–°å»ºå¥½åŽï¼Œä½¿ç”¨yuukiçš„è´¦å·ç™»å½•ï¼šå¯ä»¥çœ‹åˆ°ï¼Œyuukiåªæœ‰ç³»ç»Ÿç›‘æŽ§æ¨¡å—çš„æƒé™ã€‚å‰ç«¯å¦‚ä½•æ·»åŠ ä¾èµ–åœ¨https://www.npmjs.com/æœç´¢éœ€è¦å®‰è£…çš„ä¾èµ–ï¼Œæ¯”å¦‚jQueryï¼šæ¯”å¦‚æˆ‘éœ€è¦å®‰è£…jQuery 3.3.1ç‰ˆæœ¬ï¼Œåªéœ€è¦åœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤å³å¯ï¼šå®‰è£…å¥½åŽï¼Œåœ¨package.jsonçš„ä¾èµ–åˆ—è¡¨é‡Œä¼šå¤šå‡ºä¸€ä¸ªjquery 3.3.1ï¼šå¦‚ä½•å¤„ç†æŽ’åºå¯¹äºŽå‰ç«¯æ¥è¯´ï¼Œéœ€è¦ä¸Šé€ä¸¤ä¸ªå‚æ•°ï¼šsortFieldï¼šéœ€è¦æŽ’åºçš„å­—æ®µï¼›sortOrderï¼šæŽ’åºè§„åˆ™ï¼Œascendæˆ–è€…descendã€‚å¯¹äºŽåŽç«¯æ¥è¯´ï¼ŒæŽ’åºä¸»è¦åˆ†ä¸ºå››ç§æƒ…å†µï¼šç»“æžœéœ€è¦åˆ†é¡µçš„ï¼Œå¹¶ä¸”æ˜¯é€šè¿‡xmlå®šä¹‰çš„SQLæŸ¥è¯¢å‡ºæ¥çš„ç»“æžœï¼š1SortUtil.handlePageSort(request, page, "userId", FebsConstant.ORDER_ASC, false);userIdå’ŒFebsConstant.ORDER_ASCæŒ‡å®šäº†é»˜è®¤çš„æŽ’åºè§„åˆ™ï¼Œå³é»˜è®¤æŒ‰ç…§userIdå­—æ®µå‡åºæŽ’åºã€‚æœ€åŽä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ˜¯å¦éœ€è¦å¼€å¯é©¼å³°è½¬ä¸‹åˆ’çº¿ï¼Œè¿™ç§æƒ…å†µä¸‹ä¸éœ€è¦ï¼Œfalseå³å¯ã€‚å…·ä½“å¯ä»¥å‚è€ƒcc.mrbird.febs.system.service.impl.UserServiceImpl#findUserDetailã€‚å¦‚æžœä¸éœ€è¦æŒ‡å®šé»˜è®¤æŽ’åºè§„åˆ™ï¼Œä½¿ç”¨handlePageSortçš„é‡è½½æ–¹æ³•å³å¯ï¼š1SortUtil.handlePageSort(request, page, false);ç»“æžœéœ€è¦åˆ†é¡µçš„ï¼Œå¹¶ä¸”æ˜¯é€šè¿‡Mybatis Plusæ’ä»¶æŸ¥è¯¢å‡ºæ¥çš„ç»“æžœï¼š1SortUtil.handlePageSort(request, page, true);è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€åŽä¸€ä¸ªå‚æ•°å€¼å¿…é¡»ä¸ºtrueã€‚å…·ä½“å¯ä»¥å‚è€ƒcc.mrbird.febs.system.service.impl.DictServiceImpl#findDictsã€‚1å’Œ2ä¸»è¦åŒºåˆ«å°±æ˜¯æ˜¯å¦éœ€è¦å¼€å¯é©¼å³°è½¬ä¸‹åˆ’çº¿ã€‚ç»“æžœä¸éœ€è¦åˆ†é¡µï¼Œå¹¶ä¸”æ˜¯é€šè¿‡xmlå®šä¹‰çš„SQLæŸ¥è¯¢å‡ºæ¥çš„ç»“æžœï¼š1SortUtil.handleWrapperSort(request, queryWrapper, "orderNum", FebsConstant.ORDER_ASC, false);å…·ä½“å¯ä»¥å‚è€ƒï¼šcc.mrbird.febs.system.service.impl.DeptServiceImpl#findDeptsç»“æžœä¸éœ€è¦åˆ†é¡µï¼Œå¹¶ä¸”æ˜¯é€šè¿‡Mybatis Plusæ’ä»¶æŸ¥è¯¢å‡ºæ¥çš„ç»“æžœï¼š1SortUtil.handleWrapperSort(request, queryWrapper, "orderNum", FebsConstant.ORDER_ASC, true);æ€»ä¹‹ï¼Œå¯¹äºŽå¤„ç†æŽ’åºçš„æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸€å®šæ˜¯cc.mrbird.febs.common.domain.QueryRequestã€‚ç¬¬äºŒä¸ªå‚æ•°å¦‚æžœéœ€è¦åˆ†é¡µï¼Œåˆ™ä¼ é€’com.baomidou.mybatisplus.extension.plugins.pagination.Pageï¼Œä¸éœ€è¦åˆ†é¡µåˆ™ä¼ é€’com.baomidou.mybatisplus.core.conditions.query.QueryWrapperã€‚æœ€åŽä¸€ä¸ªå‚æ•°å¦‚æžœæŸ¥è¯¢ç»“æžœæ˜¯Mybatis PlusæŸ¥è¯¢å‡ºæ¥çš„ç»“æžœï¼Œåˆ™éœ€è®¾ç½®ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚åŽç«¯æŽ¥å£æµ‹è¯•ç”±äºŽåŽç«¯æŽ¥å£ä¸ºRESTfulæŽ¥å£ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨æµè§ˆå™¨æ¥æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨PostManæˆ–è€…Chromeæ’ä»¶RestLetæ¥æµ‹è¯•åŽç«¯æŽ¥å£ã€‚æ–‡æ¡£ä»¥PostManä¸ºä¾‹ã€‚å› ä¸ºåŽå°æŽ¥å£å¤§éƒ¨åˆ†éƒ½éœ€è¦ç”¨æˆ·è®¤è¯åŽæ‰èƒ½è®¿é—®ï¼Œæ‰€ä»¥åœ¨æµ‹è¯•ä¹‹å‰éœ€è¦é€šè¿‡ç™»å½•æŽ¥å£èŽ·å–ä¸€ä¸ªå¯ç”¨çš„tokenã€‚æˆåŠŸèŽ·å–åˆ°äº†tokenã€‚æµ‹è¯•èŽ·å–mrbirdçš„å‰ç«¯è·¯ç”±ä¿¡æ¯ï¼šåœ¨Headersè®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹ï¼Œkeyä¸ºAuthenticationï¼Œvalueä¸ºåˆšåˆšèŽ·å–åˆ°çš„tokenï¼Œå‘é€è¯·æ±‚ä¾¿å¯ä»¥èŽ·å–åˆ°mrbirdçš„è·¯ç”±ä¿¡æ¯ã€‚å…¶ä»–æŽ¥å£æµ‹è¯•ä»¥æ­¤ç±»æŽ¨ã€‚å¦‚æžœtokenå¡«é”™æˆ–è€…ä¸å¡«ï¼šåŽç«¯å°†è¿”å›ž401ã€‚å¸¸è§é—®é¢˜å¯¼å…¥é¡¹ç›®ç¼–è¯‘å‡ºé”™ï¼Œä»£ç æ˜¯å¦ä¸å…¨ï¼Ÿç¼–è¾‘å™¨å®‰è£…lombokæ’ä»¶å³å¯ã€‚å¯¼å…¥SQLä¸ºä½•å‡ºé”™ï¼ŸMySQLæ•°æ®åº“è¯·ä½¿ç”¨5.7.xç‰ˆæœ¬ï¼Œä¸åŒç‰ˆæœ¬SQLè¯­æ³•æœ‰å·®å¼‚ã€‚å¦‚æžœä½ SQLæŠ€æœ¯è¿‡ç¡¬å¯ä»¥é€šè¿‡é”™è¯¯ä¿¡æ¯åŽ»ä¿®æ”¹å‡ºé”™çš„SQLï¼Œæ›´æŽ¨èçš„åšæ³•æ˜¯å®‰è£…æŽ¨èç‰ˆæœ¬çš„MySQLæ•°æ®åº“ã€‚ip2regionæ˜¯å•¥çŽ©æ„ï¼Œæ‰“å¼€æ€Žä¹ˆä¹±ç ï¼Ÿé€šè¿‡ipèŽ·å–åœ°å€çš„å¼€æºè½¯ä»¶æ•°æ®åº“æ–‡ä»¶ï¼Œä¸è¦ç›´æŽ¥æ‰“å¼€ã€‚ip2regionåœ°å€ï¼šhttps://github.com/lionsoul2014/ip2regionã€‚é¡¹ç›®ç¼ºé™·å‰ç«¯é¡µé¢ä¸æ”¯æŒç§»åŠ¨ç«¯ï¼ˆä¸èƒ½è‡ªé€‚åº”ï¼‰ï¼›å‰ç«¯æ‰“åŒ…åŽvendor.jsè¾ƒå¤§ï¼Œé€šè¿‡nginxåŽ‹ç¼©åŽåœ¨591kbå·¦å³ï¼Œåœ¨æˆ‘çš„æ¸£æ¸£æœåŠ¡å™¨ï¼ˆ1æ ¸1G1Mï¼‰ä¸‹ï¼Œè®¿é—®æ—¶é—´å¤§çº¦ä¸º7 - 8ç§’å·¦å³ï¼šå¦‚æžœä½ çš„æœåŠ¡å™¨å¸¦å®½å¤Ÿå¤§ï¼Œæˆ–è€…æ˜¯éƒ¨ç½²åœ¨å…¬å¸å±€åŸŸç½‘å†…çš„è¯ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥å¿½ç•¥ã€‚å¦‚æžœè¦åœ¨æ ¹æºä¸Šè§£å†³è¿™ä¸ªé—®é¢˜ä¸ªäººè§‰å¾—å¯ä»¥ä»Žè¿™å‡ ä¸ªåœ°æ–¹å…¥æ‰‹ï¼šAnt Designé‡‡ç”¨SVGæ ¼å¼çš„å›¾æ ‡åŽï¼Œå¯¼è‡´é¡¹ç›®æ‰“åŒ…ä½“ç§¯è¿‡å¤§ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹issueçš„è®¨è®ºï¼šhttps://github.com/vueComponent/ant-design-vue/issues/325å’Œhttps://github.com/ant-design/ant-design/issues/12011ï¼›å¯ä»¥å°†ä¾èµ–é€šè¿‡CDNæ¥åŠ è½½ï¼Œå‚è€ƒè¿žæŽ¥ï¼šhttps://blog.csdn.net/qq_35844177/article/details/78599064ï¼›webpackæ‰“åŒ…é…ç½®å¯èƒ½å­˜åœ¨å¯ä¼˜åŒ–çš„åœ°æ–¹ã€‚ç”±äºŽæˆ‘æ‰ç–å­¦æµ…ï¼Œå‰ç«¯æŠ€èƒ½è–„å¼±ï¼Œæ‰€ä»¥æ²¡èƒ½å¤Ÿå¾ˆå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ¬¢è¿Žæ¥è‡ªäº”æ¹–å››æµ·çš„èƒ½äººå¿—å£«pull requestæ¥æ”¹å–„è¿™ä¸ªé—®é¢˜ï¼Œæ„Ÿæ¿€ä¸å°½ã€‚]]></content>
      <tags>
        <tag>FEBS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot WebFluxå¢žåˆ æ”¹æŸ¥æ ·ä¾‹]]></title>
    <url>%2FSpring-Boot-WebFlux-CRUD.html</url>
    <content type="text"><![CDATA[åœ¨ Spring Boot 2.0 WebFluxç¼–ç¨‹ ä¸€èŠ‚æˆ‘ä»¬å¤§è‡´äº†è§£äº†WebFluxçš„ç”¨æ³•ï¼Œè¿™èŠ‚æˆ‘ä»¬å°†ç»“åˆMongo DBåœ¨WebFluxçš„æž¶æž„ä¸‹å®žçŽ°å¢žåˆ æ”¹æŸ¥æ ·ä¾‹ã€‚å’Œ Spring Bootæ•´åˆMongo DB ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯Reactive Mongo DBä¾èµ–ï¼Œæ‰€æœ‰å¢žåˆ æ”¹æŸ¥æ–¹æ³•è¿”å›žå€¼ç±»åž‹ä¸ºFluxæˆ–è€…Monoã€‚é¡¹ç›®å‡†å¤‡æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.1.3.RELEASEï¼Œå¹¶å¼•å…¥webfluxå’Œreactive mongodbä¾èµ–ï¼š12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-webflux&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-mongodb-reactive&lt;/artifactId&gt;&lt;/dependency&gt;è¦å¼€å¯Reactive Mongo DBçš„ç›¸å…³é…ç½®ï¼Œéœ€è¦åœ¨Spring Bootå¯åŠ¨ç±»ä¸Šæ·»åŠ @EnableReactiveMongoRepositoriesæ³¨è§£ï¼š1234567@SpringBootApplication@EnableReactiveMongoRepositoriespublic class WebfluxApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(WebfluxApplication.class, args); &#125;&#125;æŽ¥ç€åœ¨é…ç½®æ–‡ä»¶application.ymlé‡Œé…ç½®Mongo DBè¿žæŽ¥ï¼š123456spring: data: mongodb: host: localhost port: 27017 database: webfluxä½¿ç”¨çš„æ˜¯webfluxæ•°æ®åº“ï¼Œæ‰€ä»¥éœ€è¦åœ¨Mongo DBé‡Œæ–°å»ºä¸€ä¸ªwebfluxæ•°æ®åº“ï¼ˆå¹¶åˆ›å»ºuseræ–‡æ¡£/è¡¨ï¼Œä»¥ä¾›å¾…ä¼šä½¿ç”¨ï¼‰ï¼šåˆ›å»ºUserå®žä½“ç±»:1234567891011@Document(collection = "user")public class User &#123; @Id private String id; private String name; private Integer age; private String description; // get set ç•¥&#125;ç®€å•å¢žåˆ æ”¹æŸ¥åˆ›å»ºUserDaoæŽ¥å£ï¼Œç»§æ‰¿è‡ªReactiveMongoRepositoryï¼š123@Repositorypublic interface UserDao extends ReactiveMongoRepository&lt;User, String&gt; &#123;&#125;å’Œ Spring Bootæ•´åˆMongo DB ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬ç»§æ‰¿çš„æ˜¯ReactiveMongoRepositoryè€ŒéžMongoRepositoryï¼Œå®ƒæ‰€æä¾›çš„æ–¹æ³•éƒ½æ˜¯å“åº”å¼çš„ï¼šåœ¨UserServiceé‡Œé€šè¿‡UserDaoå®šä¹‰ç®€å•å¢žåˆ æ”¹æŸ¥æ–¹æ³•ï¼š123456789101112131415161718192021222324252627282930313233@Servicepublic class UserService &#123; @Autowired private UserDao userDao; public Flux&lt;User&gt; getUsers() &#123; return userDao.findAll(); &#125; public Mono&lt;User&gt; getUser(String id) &#123; return this.userDao.findById(id); &#125; public Mono&lt;User&gt; createUser(User user) &#123; return userDao.save(user); &#125; public Mono&lt;Void&gt; deleteUser(String id) &#123; return this.userDao.findById(id) .flatMap(user -&gt; this.userDao.delete(user)); &#125; public Mono&lt;User&gt; updateUser(String id, User user) &#123; return this.userDao.findById(id) .flatMap(u -&gt; &#123; u.setName(user.getName()); u.setAge(user.getAge()); u.setDescription(user.getDescription()); return this.userDao.save(u); &#125;); &#125;&#125;å¤§è‡´ä¸Šå’Œ Spring Bootæ•´åˆMongo DB ä¸­çš„UserServiceå·®ä¸å¤šï¼Œä¸åŒçš„æ˜¯è¿”å›žå€¼ç±»åž‹ä¸ºFluxæˆ–è€…Monoï¼Œå³å®ƒä»¬æ˜¯å“åº”å¼éžé˜»å¡žçš„æ–¹æ³•ã€‚ç¼–å†™RESTfulUserControllerï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960@RestController@RequestMapping("user")public class UserController &#123; @Autowired private UserService userService; /** * ä»¥æ•°ç»„çš„å½¢å¼ä¸€æ¬¡æ€§è¿”å›žæ‰€æœ‰æ•°æ® */ @GetMapping public Flux&lt;User&gt; getUsers() &#123; return userService.getUsers(); &#125; /** * ä»¥ Server sent eventså½¢å¼å¤šæ¬¡è¿”å›žæ•°æ® */ @GetMapping(value = "/stream", produces = MediaType.TEXT_EVENT_STREAM_VALUE) public Flux&lt;User&gt; getUsersStream() &#123; return userService.getUsers(); &#125; @PostMapping public Mono&lt;User&gt; createUser(User user) &#123; return userService.createUser(user); &#125; /** * å­˜åœ¨è¿”å›ž 200ï¼Œä¸å­˜åœ¨è¿”å›ž 404 */ @DeleteMapping("/&#123;id&#125;") public Mono&lt;ResponseEntity&lt;Void&gt;&gt; deleteUser(@PathVariable String id) &#123; return userService.deleteUser(id) .then(Mono.just(new ResponseEntity&lt;Void&gt;(HttpStatus.OK))) .defaultIfEmpty(new ResponseEntity&lt;&gt;(HttpStatus.NOT_FOUND)); &#125; /** * å­˜åœ¨è¿”å›žä¿®æ”¹åŽçš„ User * ä¸å­˜åœ¨è¿”å›ž 404 */ @PutMapping("/&#123;id&#125;") public Mono&lt;ResponseEntity&lt;User&gt;&gt; updateUser(@PathVariable String id, User user) &#123; return userService.updateUser(id, user) .map(u -&gt; new ResponseEntity&lt;&gt;(u, HttpStatus.OK)) .defaultIfEmpty(new ResponseEntity&lt;&gt;(HttpStatus.NOT_FOUND)); &#125; /** * æ ¹æ®ç”¨æˆ· idæŸ¥æ‰¾ * å­˜åœ¨è¿”å›žï¼Œä¸å­˜åœ¨è¿”å›ž 404 */ @GetMapping("/&#123;id&#125;") public Mono&lt;ResponseEntity&lt;User&gt;&gt; getUser(@PathVariable String id) &#123; return userService.getUser(id) .map(user -&gt; new ResponseEntity&lt;&gt;(user, HttpStatus.OK)) .defaultIfEmpty(new ResponseEntity&lt;&gt;(HttpStatus.NOT_FOUND)); &#125;&#125;å¯¹äºŽè¿”å›žå€¼ä¸ºFlux&lt;T&gt;ç±»åž‹çš„æ–¹æ³•ï¼ŒæŽ¨èå®šä¹‰ä¸¤ä¸ªä¸€æ ·çš„æ–¹æ³•ï¼Œä¸€ä¸ªä»¥æ™®é€šå½¢å¼è¿”å›žï¼Œä¸€ä¸ªä»¥Server Sent Eventçš„å½¢å¼è¿”å›žã€‚å¯¹äºŽä¿®æ”¹å’Œåˆ é™¤ï¼Œå¦‚æžœéœ€è¦ä¿®æ”¹å’Œåˆ é™¤çš„ç”¨æˆ·ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬è¿”å›ž404ã€‚å¯¹äºŽFluxå’ŒMonoçš„æ“ä½œï¼Œåœ¨ Spring Boot 2.0 WebFluxç¼–ç¨‹ ä¸€èŠ‚ä¸­å·²ç»ä»‹ç»è¿‡äº†ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚æŽ’åºä¸Žåˆ†é¡µåœ¨ Spring Bootæ•´åˆMongo DB ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡MongoTemplateå®žçŽ°äº†æŽ’åºä¸Žåˆ†é¡µã€‚ä¸ŽMongoTemplateå¯¹äºŽçš„å“åº”å¼çš„å¯¹è±¡ä¸ºReactiveMongoTemplateï¼Œæ‰€ä»¥æˆ‘ä»¬ç…§è‘«èŠ¦ç”»ç“¢ï¼Œä»¿ç…§MongoTemplateçš„å†™æ³•æ¥å®žçŽ°ï¼š123456789101112131415161718192021222324252627282930313233/** * åˆ†é¡µæŸ¥è¯¢ï¼Œåªè¿”å›žåˆ†é¡µåŽçš„æ•°æ®ï¼Œcountå€¼éœ€è¦é€šè¿‡ getUserByConditionCount * æ–¹æ³•èŽ·å– */public Flux&lt;User&gt; getUserByCondition(int size, int page, User user) &#123; Query query = getQuery(user); Sort sort = new Sort(Sort.Direction.DESC, "age"); Pageable pageable = PageRequest.of(page, size, sort); return template.find(query.with(pageable), User.class);&#125;/** * è¿”å›ž countï¼Œé…åˆ getUserByConditionä½¿ç”¨ */public Mono&lt;Long&gt; getUserByConditionCount(User user) &#123; Query query = getQuery(user); return template.count(query, User.class);&#125;private Query getQuery(User user) &#123; Query query = new Query(); Criteria criteria = new Criteria(); if (!StringUtils.isEmpty(user.getName())) &#123; criteria.and("name").is(user.getName()); &#125; if (!StringUtils.isEmpty(user.getDescription())) &#123; criteria.and("description").regex(user.getDescription()); &#125; query.addCriteria(criteria); return query;&#125;ä¹‹æ‰€ä»¥æ‹†åˆ†æ˜¯å› ä¸ºæ²¡æ‰¾åˆ°ä¸ŽPageableExecutionUtilsç±»çš„getPageæ–¹æ³•ç±»ä¼¼çš„æ–¹æ³•ï¼Œå¦‚æžœæ˜¯å“åº”å¼çš„è¯ï¼Œè¿”å›žå€¼ç±»åž‹åº”è¯¥æ˜¯Mono&lt;Page&lt;User&gt;&gt;ï¼Œä¸æ‡‚å¤§å®¶æœ‰æ²¡åˆ«çš„æ›´å¥½çš„å®žçŽ°æ–¹æ³•ï¼Ÿæºç å’ŒPostManæµ‹è¯•æ ·ä¾‹é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/58.Spring-Boot-WebFlux-crud]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
        <tag>MongoDB</tag>
        <tag>WebFlux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud ConsulæœåŠ¡æ²»ç†]]></title>
    <url>%2FSpring-Cloud-Consul.html</url>
    <content type="text"><![CDATA[Consulæ˜¯ä¸€æ¬¾ç”±HashiCorpå…¬å¸å¼€æºçš„ï¼Œç”¨äºŽæœåŠ¡æ²»ç†çš„è½¯ä»¶ï¼ŒSpring Cloud Consulå¯¹å…¶è¿›è¡Œäº†å°è£…ã€‚Consulå…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹:æœåŠ¡æ³¨å†Œ - è‡ªåŠ¨æ³¨å†Œå’Œå–æ¶ˆæ³¨å†ŒæœåŠ¡å®žä¾‹çš„ç½‘ç»œä½ç½®è¿è¡ŒçŠ¶å†µæ£€æŸ¥ - æ£€æµ‹æœåŠ¡å®žä¾‹ä½•æ—¶å¯åŠ¨å¹¶è¿è¡Œåˆ†å¸ƒå¼é…ç½® - ç¡®ä¿æ‰€æœ‰æœåŠ¡å®žä¾‹ä½¿ç”¨ç›¸åŒçš„é…ç½®Consul agentæœ‰ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼šServerå’ŒClientã€‚è¿™é‡Œçš„Serverå’ŒClientåªæ˜¯Consulé›†ç¾¤å±‚é¢çš„åŒºåˆ†ï¼Œä¸Žæ­å»ºåœ¨Clusterä¹‹ä¸Š çš„åº”ç”¨æœåŠ¡æ— å…³ã€‚ ä»¥Serveræ¨¡å¼è¿è¡Œçš„Consul agentèŠ‚ç‚¹ç”¨äºŽç»´æŠ¤Consulé›†ç¾¤çš„çŠ¶æ€ï¼Œå®˜æ–¹å»ºè®®æ¯ä¸ªConsul Clusterè‡³å°‘æœ‰3ä¸ªæˆ–ä»¥ä¸Šçš„è¿è¡Œåœ¨Server modeçš„Agentï¼ŒClientèŠ‚ç‚¹ä¸é™ã€‚å®‰è£…ConsulConsulä¸‹è½½åœ°å€ï¼šhttps://www.consul.io/downloads.htmlï¼Œæœ¬æ–‡é€‰æ‹©Linux 64bit ç‰ˆæœ¬è¿›è¡Œæ¼”ç¤ºã€‚ä¸‹è½½åŽè§£åŽ‹ï¼Œç„¶åŽåœ¨è§£åŽ‹ç›®å½•ä¸‹è¿è¡Œ./consulå‘½ä»¤ï¼šå¯ä»¥çœ‹åˆ°Consulæ‰€åŒ…å«çš„å‘½ä»¤ï¼Œä½¿ç”¨consul [å‘½ä»¤] --helpå¯ä»¥æŸ¥çœ‹æŸä¸ªå‘½ä»¤çš„å…·ä½“ç”¨æ³•ã€‚æ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªConsul agentï¼š1./consul agent -dev -client 192.168.140.215-devè¡¨ç¤ºåˆ›å»ºä¸€ä¸ªå¼€å‘çŽ¯å¢ƒä¸‹çš„serverèŠ‚ç‚¹ï¼Œåœ¨è¯¥æ¨¡å¼ä¸‹ä¸ä¼šæœ‰ä»»ä½•æŒä¹…åŒ–æ“ä½œï¼Œå³ä¸ä¼šæœ‰ä»»ä½•æ•°æ®å†™å…¥åˆ°ç£ç›˜ï¼Œæ‰€ä»¥è¿™ä¸ªæ¨¡å¼é€‚åˆç”¨äºŽå¼€å‘è¿‡ç¨‹ï¼Œè€Œä¸é€‚ç”¨äºŽç”Ÿäº§çŽ¯å¢ƒã€‚-client 192.168.140.215è¡¨ç¤ºè¿è¡Œå®¢æˆ·ç«¯ä½¿ç”¨ipåœ°å€192.168.140.215ï¼ˆæœ¬æ–‡LinuxçŽ¯å¢ƒIPåœ°å€ï¼‰åŽ»è®¿é—®ã€‚å¯åŠ¨åŽï¼Œé»˜è®¤çš„ç«¯å£å·ä¸º8500ï¼Œè®¿é—®http://192.168.140.215:8500å½“å‰å°±ä¸€ä¸ªconsulæœåŠ¡ã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹åˆ›å»ºæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ã€‚Server-Provideråˆ›å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.0.2.RELEASEï¼ŒartifactIdä¸ºserver-providerï¼ŒSpring Cloudç‰ˆæœ¬ä¸ºFinchley.RELEASEï¼š123456789101112131415161718192021222324252627&lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;spring-cloud.version&gt;Finchley.RELEASE&lt;/spring-cloud.version&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-cloud.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;ç„¶åŽåœ¨é…ç½®æ–‡ä»¶é‡Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š1234567891011121314server: port: 9000spring: application: name: server-provider cloud: consul: host: 192.168.140.215 port: 8500 discovery: health-check-interval: 10s service-name: $&#123;spring.application.name&#125; register-health-check: true health-check-path: /checkspring.cloud.consul.hostå’Œspring.cloud.consul.porté…ç½®äº†consulçš„ipå’Œç«¯å£ï¼›spring.cloud.consul.discovery.service-nameé…ç½®äº†è¯¥æœåŠ¡åœ¨consulé‡Œæ³¨å†Œçš„æœåŠ¡åç§°ï¼›spring.cloud.consul.discovery.register-health-checkç”¨äºŽå¼€å¯å¥åº·æ£€æŸ¥ï¼Œspring.cloud.consul.discovery.health-check-intervalé…ç½®äº†å¥åº·æ£€æŸ¥çš„å‘¨æœŸä¸º10ç§’ï¼Œspring.cloud.consul.discovery.health-check-pathé…ç½®äº†å¥åº·æ£€æŸ¥è·¯å¾„ã€‚æŽ¥ç€æ–°å»ºTestControllerï¼š12345678910111213141516@RestControllerpublic class TestController &#123; private Logger logger = LoggerFactory.getLogger(this.getClass()); @GetMapping("check") private String check() &#123; logger.info("health check"); return "ok"; &#125; @GetMapping("hello") public String hello() &#123; logger.info("hello"); return "hello from server provider"; &#125;&#125;checkæ–¹æ³•ç”¨äºŽç›‘æŽ§æ£€æŸ¥ï¼ŒTestControllerè¿˜æä¾›äº†ä¸€ä¸ªhelloæ–¹æ³•ï¼Œä»¥ä¾›åŽç»­æœåŠ¡æ¶ˆè´¹è€…è°ƒç”¨ã€‚spring.cloud.consul.discovery.health-check-pathçš„é»˜è®¤å€¼ä¸º/actuator/healthï¼Œå¦‚æžœé‡‡ç”¨è¯¥é»˜è®¤å€¼çš„è¯ï¼Œè¿˜éœ€è¦å¯¼å…¥spring-boot-starter-actuatorä¾èµ–ã€‚æœ€åŽï¼Œè¦å¼€å¯æœåŠ¡æ³¨å†Œä¸Žå‘è¡Œï¼Œéœ€è¦åœ¨Spring Bootå…¥å£ç±»ä¸Šæ·»åŠ @EnableDiscoveryClientæ³¨è§£ï¼š1234567@EnableDiscoveryClient@SpringBootApplicationpublic class ServerProviderApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(ServerProviderApplication.class, args); &#125;&#125;å‡†å¤‡å®Œæ¯•åŽï¼Œæ‰“åŒ…é¡¹ç›®ï¼Œç„¶åŽå¯åŠ¨ä¸¤ä¸ªå®žä¾‹ï¼Œç«¯å£å·åˆ†åˆ«ä¸º9000å’Œ9001ï¼Œå¯åŠ¨åŽï¼Œå†æ¬¡è®¿é—®consulç®¡ç†ç•Œé¢ï¼šæœåŠ¡æä¾›è€…æ³¨å†ŒæˆåŠŸï¼ŒæŽ¥ä¸‹æ¥å¼€å§‹æ­å»ºæœåŠ¡æ¶ˆè´¹è€…ã€‚Server-Consumeråˆ›å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.0.2.RELEASEï¼ŒartifactIdä¸ºserver-providerï¼ŒSpring Cloudç‰ˆæœ¬ä¸ºFinchley.RELEASEï¼š12345678910111213141516171819202122232425262728293031&lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;spring-cloud.version&gt;Finchley.RELEASE&lt;/spring-cloud.version&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-cloud.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;å¼•å…¥spring-boot-starter-actuatorç”¨äºŽé»˜è®¤çš„å¥åº·æ£€æŸ¥ã€‚é…ç½®application.ymlï¼š12345678910111213server: port: 9002spring: application: name: server-consumer cloud: consul: host: 192.168.140.215 port: 8500 discovery: service-name: $&#123;spring.application.name&#125;åŒæ ·çš„ï¼Œéœ€è¦å¼€å¯æœåŠ¡æ³¨å†Œä¸Žå‘çŽ°éœ€è¦åœ¨å…¥å£ç±»ä¸Šæ·»åŠ @EnableDiscoveryClientæ³¨è§£ã€‚æŽ¥ç€åˆ›å»ºTestControlleræ¥æ¶ˆè´¹Server-Provideræä¾›çš„helloæœåŠ¡ï¼š1234567891011121314151617181920212223242526272829@RestControllerpublic class TestController &#123; private Logger loggr = LoggerFactory.getLogger(this.getClass()); @Autowired private DiscoveryClient discoveryClient; @Autowired private LoadBalancerClient loadBalancerClient; private final RestTemplate restTemplate = new RestTemplate(); private static final String SERVER_ID = "server-provider"; @GetMapping("uri") public List&lt;URI&gt; getServerUris() &#123; return this.discoveryClient.getInstances(SERVER_ID) .stream() .map(ServiceInstance::getUri).collect(Collectors.toList()); &#125; @GetMapping("hello") public String hello() &#123; ServiceInstance instance = loadBalancerClient.choose(SERVER_ID); String url = instance.getUri().toString() + "/hello"; loggr.info("remote server urlï¼š&#123;&#125;", url); return restTemplate.getForObject(url, String.class); &#125;&#125;SERVER_IDçš„å€¼ä¸ºæœåŠ¡æä¾›è€…åœ¨consulæ³¨å†Œä¸­å¿ƒçš„å®žä¾‹åç§°ï¼Œå³server-providerã€‚é€šè¿‡DiscoveryClientæˆ‘ä»¬å¯ä»¥èŽ·å–åˆ°æ‰€æœ‰åç§°ä¸ºserver-providerçš„æœåŠ¡å®žä¾‹ä¿¡æ¯ã€‚é€šè¿‡LoadBalancerClientæˆ‘ä»¬å¯ä»¥å®žçŽ°è´Ÿè½½å‡è¡¡åœ°åŽ»èŽ·å–æœåŠ¡å®žä¾‹ï¼Œå¹¶é€šè¿‡RestTemplateåŽ»è°ƒç”¨æœåŠ¡ã€‚æ‰“åŒ…éƒ¨ç½²é¡¹ç›®ï¼Œç„¶åŽæŸ¥çœ‹consulæŽ§åˆ¶å°ï¼šè®¿é—®ï¼šhttp://192.168.140.215:9002/uriï¼šå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æˆåŠŸèŽ·å–åˆ°äº†æœåŠ¡åç§°ä¸ºserver-providerçš„ä¸¤ä¸ªå…·ä½“å®žä¾‹ã€‚å¤šæ¬¡è°ƒç”¨http://192.168.140.215:9002/helloï¼šæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šæœåŠ¡è°ƒç”¨æ˜¯å‡è¡¡çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œconsulå†…ç½®äº†Ribbonï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡@LoadBalancedæ ‡æ³¨çš„RestTemplateæ¥å®žçŽ°è´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨ï¼š12345678910111213141516@Autowiredprivate RestTemplate restTemplate;private static final String SERVER_ID = "server-provider";@Bean@LoadBalancedpublic RestTemplate restTemplate() &#123; return new RestTemplate();&#125;@GetMapping("hello")public String hello() &#123; String url = "http://" + SERVER_ID + "/hello"; return restTemplate.getForObject(url, String.class);&#125;æ•ˆæžœæ˜¯ä¸€æ ·çš„ã€‚consulé›†ç¾¤ä¸Šé¢æˆ‘ä»¬åªæ˜¯ä»¥-devæ¨¡å¼å¼€å¯äº†ä¸€ä¸ªå•èŠ‚ç‚¹consul agentï¼Œç”Ÿäº§çŽ¯å¢ƒä¸‹éœ€è¦æ­å»ºconsulé›†ç¾¤æ¥ç¡®ä¿é«˜å¯ç”¨ã€‚æ­å»ºconsulé›†ç¾¤æ—¶å¸¸ç”¨çš„å‘½ä»¤æœ‰:å‘½ä»¤è§£é‡Šç¤ºä¾‹agentè¿è¡Œä¸€ä¸ªconsul agentconsul agent -devjoinå°†agentåŠ å…¥åˆ°consulé›†ç¾¤consul join IPmembersåˆ—å‡ºconsul clusteré›†ç¾¤ä¸­çš„membersconsul membersleaveå°†èŠ‚ç‚¹ç§»é™¤æ‰€åœ¨é›†ç¾¤consul leaveå‡†å¤‡äº†ä¸‰å°LinuxæœåŠ¡å™¨ï¼Œé…ç½®å¦‚ä¸‹ï¼šåºå·èŠ‚ç‚¹ipèŠ‚ç‚¹åç§°è§’è‰²1192.168.140.215consul-server-215server2192.168.140.213consul-server-213server3192.168.140.216consul-server-216server &amp; web uiåœ¨è¿™ä¸‰å°æœåŠ¡å™¨ä¸Šä¸‹è½½å¹¶è§£åŽ‹consulï¼Œç„¶åŽåœ¨è§£åŽ‹çš„æ ¹ç›®å½•ä¸Šåˆ›å»ºä¸€ä¸ªdataç›®å½•ã€‚ç”±äºŽæˆ‘ä»¬ä¹‹å‰å·²ç»åœ¨215ä¸Šå¯åŠ¨äº†consulï¼Œæ‰€ä»¥å…ˆæ‰§è¡Œkillall consulæ¥æ€æŽ‰è¿›ç¨‹ï¼Œç„¶åŽæ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ï¼š1nohup ./consul agent -server -bind 192.168.140.215 -client=0.0.0.0 -bootstrap-expect=3 -data-dir=data -node=consul-server-215 &amp;è§£é‡Šä¸€ä¸‹ä¸Šé¢è¿™æ¡å‘½ä»¤çš„å«ä¹‰:-serverè¡¨ç¤ºä»¥æœåŠ¡çš„å½¢å¼å¯åŠ¨agent-bindè¡¨ç¤ºç»‘å®šåˆ°å½“å‰Linuxçš„ipï¼ˆæœ‰äº›æœåŠ¡å™¨ä¼šç»‘å®šå¤šå—ç½‘å¡ï¼Œå¯ä»¥é€šè¿‡bindå‚æ•°å¼ºåˆ¶æŒ‡å®šç»‘å®šçš„ipï¼‰-clientæŒ‡å®šå®¢æˆ·ç«¯è®¿é—®çš„ipï¼ˆconsulæœ‰ä¸°å¯Œçš„apiæŽ¥å£ï¼Œè¿™é‡Œçš„å®¢æˆ·ç«¯æŒ‡æµè§ˆå™¨æˆ–è°ƒç”¨æ–¹ï¼‰ï¼Œ0.0.0.0è¡¨ç¤ºä¸é™å®¢æˆ·ç«¯ip-bootstrap-expect=3è¡¨ç¤ºserveré›†ç¾¤æœ€ä½ŽèŠ‚ç‚¹æ•°ä¸º3ï¼Œä½ŽäºŽè¿™ä¸ªå€¼å°†å·¥ä½œä¸æ­£å¸¸(æ³¨ï¼šç±»ä¼¼zookeeperä¸€æ ·ï¼Œé€šå¸¸é›†ç¾¤æ•°ä¸ºå¥‡æ•°ï¼Œæ–¹ä¾¿é€‰ä¸¾ï¼Œconsulé‡‡ç”¨çš„æ˜¯raftç®—æ³•)-data-dirè¡¨ç¤ºæŒ‡å®šæ•°æ®çš„å­˜æ”¾ç›®å½•ï¼ˆè¯¥ç›®å½•å¿…é¡»å­˜åœ¨ï¼‰-nodeè¡¨ç¤ºèŠ‚ç‚¹çš„åç§°æŽ¥ç€åœ¨213æœåŠ¡å™¨ä¸Šæ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ï¼š1nohup ./consul agent -server -bind 192.168.140.213 -client=0.0.0.0 -bootstrap-expect=3 -data-dir=data -node=consul-server-213 &amp;æœ€åŽåœ¨216ä¸Šæ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ï¼š1nohup ./consul agent -server -bind 192.168.140.216 -client=0.0.0.0 -bootstrap-expect=3 -data-dir=data -node=consul-server-216 -ui &amp;å’Œå‰ä¸¤æ¡å‘½ä»¤ç›¸æ¯”ï¼Œè¿™æ¡å‘½ä»¤å¤šäº†-uié€‰é¡¹ï¼Œè¡¨ç¤ºå¼€å¯ç®¡ç†ç•Œé¢UIã€‚ç„¶åŽåˆ†åˆ«åœ¨213å’Œ215ä¸‹æ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ï¼š1./consul join 192.168.140.216è¿™æ ·213å’Œ215æˆåŠŸåŠ å…¥åˆ°äº†216æž„æˆäº†ä¸€ä¸ªä¸‰èŠ‚ç‚¹é›†ç¾¤ï¼Œè¿è¡Œ./consul membersæŸ¥çœ‹ï¼šè®¿é—®http://192.168.140.216:8500ï¼šè®¿é—®http://192.168.140.215:9002/helloï¼šè¿™æ—¶å€™åœ¨215æ‰§è¡Œkillall consulå‘½ä»¤ï¼Œæ€æ­»consulæœåŠ¡ï¼Œç„¶åŽåœ¨216ä¸Šæ‰§è¡Œ./consul membersï¼šå¯ä»¥çœ‹åˆ°215èŠ‚ç‚¹å·²ç»æŒ‚äº†ï¼Œå†æ¬¡è®¿é—®http://192.168.140.215:9002/helloï¼šæœåŠ¡ä¾æ—§èŽ·å–æˆåŠŸã€‚å¯è§ï¼Œè™½ç„¶æˆ‘ä»¬åœ¨application.ymlä¸­é…ç½®consulçš„åœ°å€æ˜¯192.168.140.215:8500ï¼Œä½†ç”±äºŽæˆ‘ä»¬æž„å»ºçš„æ˜¯consulé›†ç¾¤ï¼Œæ‰€ä»¥å¾®æœåŠ¡å¯åŠ¨æ—¶ä¼šèŽ·å–åˆ°æ•´ä¸ªé›†ç¾¤ä¿¡æ¯ï¼Œå³ä½¿215è¿™ä¸ªèŠ‚ç‚¹æŒ‚äº†ï¼Œå¾®æœåŠ¡å¯ä»¥ä»Žåˆ«çš„consulèŠ‚ç‚¹ä¸ŠèŽ·å–æ³¨å†Œçš„æœåŠ¡ä¿¡æ¯ã€‚å‚è€ƒæ–‡æ¡£ï¼šhttps://learn.hashicorp.com/consul/getting-started/install.htmlhttps://cloud.spring.io/spring-cloud-consul/spring-cloud-consul.html#spring-cloud-consul-hystrixæºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/55.Spring-Cloud-Consul]]></content>
      <tags>
        <tag>Spring Cloud</tag>
        <tag>Consul</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootæ•´åˆKafka]]></title>
    <url>%2FSpring-Boot-Kafka.html</url>
    <content type="text"><![CDATA[Kafkaæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ã€å¯åˆ†åŒºçš„ã€å¯å¤åˆ¶çš„æ¶ˆæ¯ç³»ç»Ÿï¼Œä¸‹é¢æ˜¯Kafkaçš„å‡ ä¸ªåŸºæœ¬æœ¯è¯­ï¼šKafkaå°†æ¶ˆæ¯ä»¥topicä¸ºå•ä½è¿›è¡Œå½’çº³ï¼›å°†å‘Kafka topicå‘å¸ƒæ¶ˆæ¯çš„ç¨‹åºæˆä¸ºproducersï¼›å°†é¢„è®¢topicså¹¶æ¶ˆè´¹æ¶ˆæ¯çš„ç¨‹åºæˆä¸ºconsumerï¼›Kafkaä»¥é›†ç¾¤çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæœåŠ¡ç»„æˆï¼Œæ¯ä¸ªæœåŠ¡å«åšä¸€ä¸ªbrokerã€‚producersé€šè¿‡ç½‘ç»œå°†æ¶ˆæ¯å‘é€åˆ°Kafkaé›†ç¾¤ï¼Œé›†ç¾¤å‘æ¶ˆè´¹è€…æä¾›æ¶ˆæ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šåˆ›å»ºä¸€ä¸ªtopicæ—¶ï¼Œå¯ä»¥æŒ‡å®špartitionsï¼ˆåˆ†åŒºï¼‰æ•°ç›®ï¼Œpartitionsæ•°è¶Šå¤šï¼Œå…¶åžåé‡ä¹Ÿè¶Šå¤§ï¼Œä½†æ˜¯éœ€è¦çš„èµ„æºä¹Ÿè¶Šå¤šï¼ŒåŒæ—¶ä¹Ÿä¼šå¯¼è‡´æ›´é«˜çš„ä¸å¯ç”¨æ€§ï¼Œkafkaåœ¨æŽ¥æ”¶åˆ°producerså‘é€çš„æ¶ˆæ¯ä¹‹åŽï¼Œä¼šæ ¹æ®å‡è¡¡ç­–ç•¥å°†æ¶ˆæ¯å­˜å‚¨åˆ°ä¸åŒçš„partitionsä¸­ï¼šåœ¨æ¯ä¸ªpartitionsä¸­ï¼Œæ¶ˆæ¯ä»¥é¡ºåºå­˜å‚¨ï¼Œæœ€æ™šæŽ¥æ”¶çš„çš„æ¶ˆæ¯ä¼šæœ€åŽè¢«æ¶ˆè´¹ã€‚producersåœ¨å‘kafkaé›†ç¾¤å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®špartitionsæ¥å‘é€åˆ°æŒ‡å®šçš„partitionsä¸­ã€‚ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šå‡è¡¡ç­–ç•¥æ¥å°†æ¶ˆæ¯å‘é€åˆ°ä¸åŒçš„partitionsä¸­ã€‚å¦‚æžœä¸æŒ‡å®šï¼Œå°±ä¼šé‡‡ç”¨é»˜è®¤çš„éšæœºå‡è¡¡ç­–ç•¥ï¼Œå°†æ¶ˆæ¯éšæœºçš„å­˜å‚¨åˆ°ä¸åŒçš„partitionsä¸­ã€‚åœ¨consumeræ¶ˆè´¹æ¶ˆæ¯æ—¶ï¼Œkafkaä½¿ç”¨offsetæ¥è®°å½•å½“å‰æ¶ˆè´¹çš„ä½ç½®ï¼šåœ¨kafkaçš„è®¾è®¡ä¸­ï¼Œå¯ä»¥æœ‰å¤šä¸ªä¸åŒçš„groupæ¥åŒæ—¶æ¶ˆè´¹åŒä¸€ä¸ªtopicä¸‹çš„æ¶ˆæ¯ï¼Œå¦‚å›¾ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªä¸åŒçš„groupåŒæ—¶æ¶ˆè´¹ï¼Œä»–ä»¬çš„çš„æ¶ˆè´¹çš„è®°å½•ä½ç½®offsetå„ä¸é¡¹ç›®ï¼Œä¸äº’ç›¸å¹²æ‰°ã€‚å¯¹äºŽä¸€ä¸ªgroupè€Œè¨€ï¼Œconsumerçš„æ•°é‡ä¸åº”è¯¥å¤šäºŽpartitionsçš„æ•°é‡ï¼Œå› ä¸ºåœ¨ä¸€ä¸ªgroupä¸­ï¼Œæ¯ä¸ªpartitionsè‡³å¤šåªèƒ½ç»‘å®šåˆ°ä¸€ä¸ªconsumerä¸Šï¼Œå³ä¸€ä¸ªconsumerå¯ä»¥æ¶ˆè´¹å¤šä¸ªpartitionsï¼Œä¸€ä¸ªpartitionsåªèƒ½ç»™ä¸€ä¸ªconsumeræ¶ˆè´¹ã€‚å› æ­¤ï¼Œè‹¥ä¸€ä¸ªgroupä¸­çš„consumeræ•°é‡å¤§äºŽpartitionsæ•°é‡çš„è¯ï¼Œå¤šä½™çš„consumerå°†ä¸ä¼šæ”¶åˆ°ä»»ä½•æ¶ˆæ¯ã€‚Kafkaå®‰è£…ä½¿ç”¨è¿™é‡Œæ¼”ç¤ºåœ¨Windowsä¸‹Kafkaå®‰è£…ä¸Žä½¿ç”¨ã€‚Kafkaä¸‹è½½åœ°å€ï¼šhttp://kafka.apache.org/downloadsï¼Œé€‰æ‹©äºŒè¿›åˆ¶æ–‡ä»¶ä¸‹è½½ï¼ˆBinary downloadsï¼‰ï¼Œç„¶åŽè§£åŽ‹å³å¯ã€‚Kafkaçš„é…ç½®æ–‡ä»¶ä½äºŽconfigç›®å½•ä¸‹ï¼Œå› ä¸ºKafkaé›†æˆäº†Zookeeperï¼ˆKafkaå­˜å‚¨æ¶ˆæ¯çš„åœ°æ–¹ï¼‰ï¼Œæ‰€ä»¥configç›®å½•ä¸‹é™¤äº†æœ‰Kafkaçš„é…ç½®æ–‡ä»¶server.propertieså¤–ï¼Œè¿˜å¯ä»¥çœ‹åˆ°ä¸€ä¸ªZookeeperé…ç½®æ–‡ä»¶zookeeper.propertiesï¼šæ‰“å¼€server.propertiesï¼Œå°†broker.idçš„å€¼ä¿®æ”¹ä¸º1ï¼Œæ¯ä¸ªbrokerçš„idéƒ½å¿…é¡»è®¾ç½®ä¸ºIntegerç±»åž‹ï¼Œä¸”ä¸èƒ½é‡å¤ã€‚Zookeeperçš„é…ç½®ä¿æŒé»˜è®¤å³å¯ã€‚æŽ¥ä¸‹æ¥å¼€å§‹ä½¿ç”¨Kafkaã€‚å¯åŠ¨Zookeeperåœ¨Windowsä¸‹æ‰§è¡Œä¸‹é¢è¿™äº›å‘½ä»¤å¯èƒ½ä¼šå‡ºçŽ°æ‰¾ä¸åˆ°æˆ–æ— æ³•åŠ è½½ä¸»ç±»çš„é—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆå¯å‚è€ƒï¼šhttps://blog.csdn.net/cx2932350/article/details/78870135ã€‚åœ¨Kafkaæ ¹ç›®å½•ä¸‹ä½¿ç”¨cmdæ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ï¼Œå¯åŠ¨ZKï¼š1bin\windows\zookeeper-server-start.bat config\zookeeper.propertiesåœ¨Linuxä¸‹ï¼Œå¯ä»¥ä½¿ç”¨åŽå°è¿›ç¨‹çš„æ–¹å¼å¯åŠ¨ZKï¼š1bin/zookeeper-server-start.sh -daemon config/zookeeper.propertieså¯åŠ¨Kafkaæ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤å¯åŠ¨Kafkaï¼š1bin\windows\kafka-server-start.bat config\server.propertiesLinuxå¯¹åº”å‘½ä»¤ï¼š1bin/kafka-server-start.sh config/server.propertieså½“çœ‹åˆ°å‘½ä»¤è¡Œæ‰“å°å¦‚ä¸‹ä¿¡æ¯ï¼Œè¯´æ˜Žå¯åŠ¨å®Œæ¯•:åˆ›å»ºTopicæ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤åˆ›å»ºä¸€ä¸ªTopic1bin\windows\kafka-topics.bat --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic testè¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯ï¼Œåˆ›å»ºä¸€ä¸ªTopicåˆ°ZKï¼ˆæŒ‡å®šZKçš„åœ°å€ï¼‰ï¼Œå‰¯æœ¬ä¸ªæ•°ä¸º1ï¼Œåˆ†åŒºæ•°ä¸º1ï¼ŒTopicçš„åç§°ä¸ºtestã€‚Linuxå¯¹åº”çš„å‘½ä»¤ä¸º:1bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic teståˆ›å»ºå¥½åŽæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹Kafkaé‡Œçš„Topicåˆ—è¡¨ï¼š1bin\windows\kafka-topics.bat --list --zookeeper localhost:2181å¯çœ‹åˆ°ç›®å‰åªåŒ…å«ä¸€ä¸ªæˆ‘ä»¬åˆšåˆ›å»ºçš„test Topicã€‚Linuxå¯¹åº”çš„å‘½ä»¤ä¸ºï¼š1bin/kafka-topics.sh --list --zookeeper localhost:2181æŸ¥çœ‹test Topicçš„å…·ä½“ä¿¡æ¯ï¼š1bin\windows\kafka-topics.bat --describe --zookeeper localhost:2181 --topic testLinuxå¯¹åº”çš„å‘½ä»¤ä¸ºï¼š1bin/kafka-topics.sh --describe --zookeeper localhost:2181 --topic testç”Ÿäº§æ¶ˆæ¯å’Œæ¶ˆè´¹æ¶ˆæ¯å¯åŠ¨Producers1bin\windows\kafka-console-producer.bat --broker-list localhost:9092 --topic test9092ä¸ºç”Ÿäº§è€…çš„é»˜è®¤ç«¯å£å·ã€‚è¿™é‡Œå¯åŠ¨äº†ç”Ÿäº§è€…ï¼Œå‡†å¤‡å¾€test Topicé‡Œå‘é€æ•°æ®ã€‚Linuxä¸‹å¯¹åº”çš„å‘½ä»¤ä¸ºï¼š1bin/kafka-console-producer.sh --broker-list localhost:9092 --topic testå¯åŠ¨ConsumersæŽ¥ç€å¯åŠ¨ä¸€ä¸ªæ¶ˆè´¹è€…ç”¨äºŽæ¶ˆè´¹ç”Ÿäº§è€…ç”Ÿäº§çš„æ•°æ®ï¼Œæ–°å»ºä¸€ä¸ªcmdçª—å£ï¼Œè¾“å…¥ä¸‹é¢è¿™æ¡å‘½ä»¤ï¼š1bin\windows\kafka-console-consumer.bat --bootstrap-server localhost:9092 --topic test --from-beginningfrom-beginningè¡¨ç¤ºä»Žå¤´å¼€å§‹è¯»å–æ•°æ®ã€‚Linuxä¸‹å¯¹åº”çš„å‘½ä»¤ä¸ºï¼š1bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginningå¯åŠ¨å¥½ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åŽæˆ‘ä»¬åœ¨ç”Ÿäº§è€…é‡Œç”Ÿäº§å‡ æ¡æ•°æ®:æ¶ˆè´¹è€…æˆåŠŸæŽ¥æ”¶åˆ°æ•°æ®ï¼šSpring Bootæ•´åˆKafakaä¸Šé¢ç®€å•ä»‹ç»äº†Kafkaçš„ä½¿ç”¨ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹åœ¨Spring Booté‡Œä½¿ç”¨Kafkaã€‚æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.1.3.RELEASEï¼Œå¹¶å¼•å…¥å¦‚ä¸‹ä¾èµ–:12345678 &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt; &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;&lt;/dependency&gt;ç”Ÿäº§è€…é…ç½®æ–°å»ºä¸€ä¸ªJavaé…ç½®ç±»KafkaProducerConfigï¼Œç”¨äºŽé…ç½®ç”Ÿäº§è€…ï¼š1234567891011121314151617181920212223242526@Configurationpublic class KafkaProducerConfig &#123; @Value("$&#123;spring.kafka.bootstrap-servers&#125;") private String bootstrapServers; @Bean public ProducerFactory&lt;String, String&gt; producerFactory() &#123; Map&lt;String, Object&gt; configProps = new HashMap&lt;&gt;(); configProps.put( ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers); configProps.put( ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class); configProps.put( ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class); return new DefaultKafkaProducerFactory&lt;&gt;(configProps); &#125; @Bean public KafkaTemplate&lt;String, String&gt; kafkaTemplate() &#123; return new KafkaTemplate&lt;&gt;(producerFactory()); &#125;&#125;é¦–å…ˆæˆ‘ä»¬é…ç½®äº†ä¸€ä¸ªproducerFactoryï¼Œæ–¹æ³•é‡Œé…ç½®äº†Kafka Producerå®žä¾‹çš„ç­–ç•¥ã€‚bootstrapServersä¸ºKafkaç”Ÿäº§è€…çš„åœ°å€ï¼Œæˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶application.ymlé‡Œé…ç½®å®ƒï¼š123spring: kafka: bootstrap-servers: localhost:9092ProducerConfig.KEY_SERIALIZER_CLASS_CONFIGå’ŒProducerConfig.VALUE_SERIALIZER_CLASS_CONFIGæŒ‡å®šäº†keyï¼Œvalueåºåˆ—åŒ–ç­–ç•¥ï¼Œè¿™é‡ŒæŒ‡å®šä¸ºKafkaæä¾›çš„StringSerializerï¼Œå› ä¸ºæˆ‘ä»¬æš‚æ—¶åªå‘é€ç®€å•çš„Stringç±»åž‹çš„æ¶ˆæ¯ã€‚æŽ¥ç€æˆ‘ä»¬ä½¿ç”¨producerFactoryé…ç½®äº†kafkaTemplateï¼Œå…¶åŒ…å«äº†å‘é€æ¶ˆæ¯çš„ä¾¿æ·æ–¹æ³•ï¼ŒåŽé¢æˆ‘ä»¬å°±ç”¨è¿™ä¸ªå¯¹è±¡æ¥å‘é€æ¶ˆæ¯ã€‚å‘å¸ƒæ¶ˆæ¯é…ç½®å¥½ç”Ÿäº§è€…ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å‘å¸ƒæ¶ˆæ¯äº†ã€‚æ–°å»ºä¸€ä¸ªSendMessageControllerï¼š1234567891011@RestControllerpublic class SendMessageController &#123; @Autowired private KafkaTemplate&lt;String, String&gt; kafkaTemplate; @GetMapping("send/&#123;message&#125;") public void send(@PathVariable String message) &#123; this.kafkaTemplate.send("test", message); &#125;&#125;æˆ‘ä»¬æ³¨å…¥äº†kafkaTemplateå¯¹è±¡ï¼Œkey-valueéƒ½ä¸ºStringç±»åž‹ï¼Œå¹¶é€šè¿‡å®ƒçš„sendæ–¹æ³•æ¥å‘é€æ¶ˆæ¯ã€‚å…¶ä¸­testä¸ºTopicçš„åç§°ï¼Œä¸Šé¢æˆ‘ä»¬å·²ç»ä½¿ç”¨å‘½ä»¤åˆ›å»ºè¿‡è¿™ä¸ªTopicäº†ã€‚sendæ–¹æ³•æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å›žè°ƒçš„æ–¹å¼æ¥ç¡®å®šæ¶ˆæ¯æ˜¯å¦å‘é€æˆåŠŸï¼Œæˆ‘ä»¬æ”¹é€ SendMessageControllerï¼š123456789101112131415161718192021222324@RestControllerpublic class SendMessageController &#123; private Logger logger = LoggerFactory.getLogger(this.getClass()); @Autowired private KafkaTemplate&lt;String, String&gt; kafkaTemplate; @GetMapping("send/&#123;message&#125;") public void send(@PathVariable String message) &#123; ListenableFuture&lt;SendResult&lt;String, String&gt;&gt; future = this.kafkaTemplate.send("test", message); future.addCallback(new ListenableFutureCallback&lt;SendResult&lt;String, String&gt;&gt;() &#123; @Override public void onSuccess(SendResult&lt;String, String&gt; result) &#123; logger.info("æˆåŠŸå‘é€æ¶ˆæ¯ï¼š&#123;&#125;ï¼Œoffset=[&#123;&#125;]", message, result.getRecordMetadata().offset()); &#125; @Override public void onFailure(Throwable ex) &#123; logger.error("æ¶ˆæ¯ï¼š&#123;&#125; å‘é€å¤±è´¥ï¼ŒåŽŸå› ï¼š&#123;&#125;", message, ex.getMessage()); &#125; &#125;); &#125;&#125;æ¶ˆæ¯å‘é€æˆåŠŸåŽï¼Œä¼šå›žè°ƒonSuccessæ–¹æ³•ï¼Œå‘é€å¤±è´¥åŽå›žè°ƒonFailureæ–¹æ³•ã€‚æ¶ˆè´¹è€…é…ç½®æŽ¥ç€æˆ‘ä»¬æ¥é…ç½®æ¶ˆè´¹è€…ï¼Œæ–°å»ºä¸€ä¸ªJavaé…ç½®ç±»KafkaConsumerConfigï¼š123456789101112131415161718192021222324252627282930313233343536373839404142@EnableKafka@Configurationpublic class KafkaConsumerConfig &#123; @Value("$&#123;spring.kafka.bootstrap-servers&#125;") private String bootstrapServers; @Value("$&#123;spring.kafka.consumer.group-id&#125;") private String consumerGroupId; @Value("$&#123;spring.kafka.consumer.auto-offset-reset&#125;") private String autoOffsetReset; @Bean public ConsumerFactory&lt;String, String&gt; consumerFactory() &#123; Map&lt;String, Object&gt; props = new HashMap&lt;&gt;(); props.put( ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers); props.put( ConsumerConfig.GROUP_ID_CONFIG, consumerGroupId); props.put( ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, autoOffsetReset); props.put( ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class); props.put( ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class); return new DefaultKafkaConsumerFactory&lt;&gt;(props); &#125; @Bean public ConcurrentKafkaListenerContainerFactory&lt;String, String&gt; kafkaListenerContainerFactory() &#123; ConcurrentKafkaListenerContainerFactory&lt;String, String&gt; factory = new ConcurrentKafkaListenerContainerFactory&lt;&gt;(); factory.setConsumerFactory(consumerFactory()); return factory; &#125;&#125;consumerGroupIdå’ŒautoOffsetResetéœ€è¦åœ¨application.ymlé‡Œé…ç½®ï¼š12345spring: kafka: consumer: group-id: test-consumer auto-offset-reset: latestå…¶ä¸­group-idå°†æ¶ˆè´¹è€…è¿›è¡Œåˆ†ç»„ï¼ˆä½ ä¹Ÿå¯ä»¥ä¸è¿›è¡Œåˆ†ç»„ï¼‰ï¼Œç»„åä¸ºtest-consumerï¼Œå¹¶æŒ‡å®šäº†æ¶ˆæ¯è¯»å–ç­–ç•¥ï¼ŒåŒ…å«å››ä¸ªå¯é€‰å€¼ï¼šearliest:å½“å„åˆ†åŒºä¸‹æœ‰å·²æäº¤çš„offsetæ—¶ï¼Œä»Žæäº¤çš„offsetå¼€å§‹æ¶ˆè´¹ï¼›æ— æäº¤çš„offsetæ—¶ï¼Œä»Žå¤´å¼€å§‹æ¶ˆè´¹latest:å½“å„åˆ†åŒºä¸‹æœ‰å·²æäº¤çš„offsetæ—¶ï¼Œä»Žæäº¤çš„offsetå¼€å§‹æ¶ˆè´¹ï¼›æ— æäº¤çš„offsetæ—¶ï¼Œæ¶ˆè´¹æ–°äº§ç”Ÿçš„è¯¥åˆ†åŒºä¸‹çš„æ•°æ®none:topicå„åˆ†åŒºéƒ½å­˜åœ¨å·²æäº¤çš„offsetæ—¶ï¼Œä»ŽoffsetåŽå¼€å§‹æ¶ˆè´¹ï¼›åªè¦æœ‰ä¸€ä¸ªåˆ†åŒºä¸å­˜åœ¨å·²æäº¤çš„offsetï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸exception:ç›´æŽ¥æŠ›å‡ºå¼‚å¸¸åœ¨KafkaConsumerConfigä¸­æˆ‘ä»¬é…ç½®äº†ConsumerFactoryå’ŒKafkaListenerContainerFactoryã€‚å½“è¿™ä¸¤ä¸ªBeanæˆåŠŸæ³¨å†Œåˆ°Spring IOCå®¹å™¨ä¸­åŽï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ä½¿ç”¨@KafkaListeneræ³¨è§£æ¥ç›‘å¬æ¶ˆæ¯äº†ã€‚é…ç½®ç±»ä¸Šéœ€è¦@EnableKafkaæ³¨é‡Šæ‰èƒ½åœ¨Springæ‰˜ç®¡Beanä¸Šæ£€æµ‹@KafkaListeneræ³¨è§£ã€‚æ¶ˆæ¯æ¶ˆè´¹é…ç½®å¥½æ¶ˆè´¹è€…ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ¶ˆè´¹æ¶ˆæ¯äº†ï¼Œæ–°å»ºKafkaMessageListenerï¼š12345678910@Componentpublic class KafkaMessageListener &#123; private Logger logger = LoggerFactory.getLogger(this.getClass()); @KafkaListener(topics = "test", groupId = "test-consumer") public void listen(String message) &#123; logger.info("æŽ¥æ”¶æ¶ˆæ¯: &#123;&#125;", message); &#125;&#125;æˆ‘ä»¬é€šè¿‡@KafkaListeneræ³¨è§£æ¥ç›‘å¬åç§°ä¸ºtestçš„Topicï¼Œæ¶ˆè´¹è€…åˆ†ç»„çš„ç»„åä¸ºtest-consumerã€‚æ¼”ç¤ºå¯åŠ¨Spring Booté¡¹ç›®ï¼Œå¯åŠ¨è¿‡ç¨‹ä¸­ï¼ŒæŽ§åˆ¶å°ä¼šè¾“å‡ºKafkaçš„é…ç½®ï¼Œå¯åŠ¨å¥½åŽï¼Œè®¿é—®http://localhost:8080/send/hello,mrbirdï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š@KafkaListenerè¯¦è§£@KafkaListeneré™¤äº†å¯ä»¥æŒ‡å®šTopicåç§°å’Œåˆ†ç»„idå¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åŒæ—¶ç›‘å¬æ¥è‡ªå¤šä¸ªTopicçš„æ¶ˆæ¯:1@KafkaListener(topics = "topic1, topic2")æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡@Headeræ³¨è§£æ¥èŽ·å–å½“å‰æ¶ˆæ¯æ¥è‡ªå“ªä¸ªåˆ†åŒºï¼ˆpartitionsï¼‰:12345@KafkaListener(topics = "test", groupId = "test-consumer")public void listen(@Payload String message, @Header(KafkaHeaders.RECEIVED_PARTITION_ID) int partition) &#123; logger.info("æŽ¥æ”¶æ¶ˆæ¯: &#123;&#125;ï¼Œpartitionï¼š&#123;&#125;", message, partition);&#125;é‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®http://localhost:8080/send/hello,mrbirdï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šå› ä¸ºæˆ‘ä»¬æ²¡æœ‰è¿›è¡Œåˆ†åŒºï¼Œæ‰€ä»¥test Topicåªæœ‰ä¸€ä¸ªåŒºï¼Œä¸‹æ ‡ä¸º0ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡@KafkaListeneræ¥æŒ‡å®šåªæŽ¥æ”¶æ¥è‡ªç‰¹å®šåˆ†åŒºçš„æ¶ˆæ¯ï¼š123456789@KafkaListener(groupId = "test-consumer", topicPartitions = @TopicPartition(topic = "test", partitionOffsets = &#123; @PartitionOffset(partition = "0", initialOffset = "0") &#125;))public void listen(@Payload String message, @Header(KafkaHeaders.RECEIVED_PARTITION_ID) int partition) &#123; logger.info("æŽ¥æ”¶æ¶ˆæ¯: &#123;&#125;ï¼Œpartitionï¼š&#123;&#125;", message, partition);&#125;å¦‚æžœä¸éœ€è¦æŒ‡å®šinitialOffsetï¼Œä¸Šé¢ä»£ç å¯ä»¥ç®€åŒ–ä¸ºï¼š12@KafkaListener(groupId = "test-consumer", topicPartitions = @TopicPartition(topic = "test", partitions = &#123; "0", "1" &#125;))æ¶ˆæ¯è¿‡æ»¤å™¨æˆ‘ä»¬å¯ä»¥ä¸ºæ¶ˆæ¯ç›‘å¬æ·»åŠ è¿‡æ»¤å™¨æ¥è¿‡æ»¤ä¸€äº›ç‰¹å®šçš„ä¿¡æ¯ã€‚æˆ‘ä»¬åœ¨æ¶ˆè´¹è€…é…ç½®ç±»KafkaConsumerConfigçš„kafkaListenerContainerFactoryæ–¹æ³•é‡Œé…ç½®è¿‡æ»¤è§„åˆ™ï¼š1234567891011@Beanpublic ConcurrentKafkaListenerContainerFactory&lt;String, String&gt; kafkaListenerContainerFactory() &#123; ConcurrentKafkaListenerContainerFactory&lt;String, String&gt; factory = new ConcurrentKafkaListenerContainerFactory&lt;&gt;(); factory.setConsumerFactory(consumerFactory()); // ------- è¿‡æ»¤é…ç½® -------- factory.setRecordFilterStrategy( r -&gt; r.value().contains("fuck") ); return factory;&#125;setRecordFilterStrategyæŽ¥æ”¶RecordFilterStrategy&lt;K, V&gt;ï¼Œä»–æ˜¯ä¸€ä¸ªå‡½æ•°å¼æŽ¥å£ï¼š123public interface RecordFilterStrategy&lt;K, V&gt; &#123; boolean filter(ConsumerRecord&lt;K, V&gt; var1);&#125;æ‰€ä»¥æˆ‘ä»¬ç”¨lambdaè¡¨è¾¾å¼æŒ‡å®šäº†ä¸Šé¢è¿™æ¡è§„åˆ™ï¼Œå³å¦‚æžœæ¶ˆæ¯å†…å®¹åŒ…å«fuckè¿™ä¸ªç²—é„™ä¹‹è¯­çš„æ—¶å€™ï¼Œåˆ™ä¸æŽ¥å—æ¶ˆæ¯ã€‚é…ç½®å¥½åŽæˆ‘ä»¬é‡å¯é¡¹ç›®ï¼Œåˆ†åˆ«å‘é€ä¸‹é¢è¿™ä¸¤æ¡è¯·æ±‚ï¼šhttp://localhost:8080/send/fuck,mrbirdhttp://localhost:8080/send/love,mrbirdè§‚å¯ŸæŽ§åˆ¶å°ï¼šå¯ä»¥çœ‹åˆ°ï¼Œfuck,mrbirdè¿™æ¡æ¶ˆæ¯æ²¡æœ‰è¢«æŽ¥æ”¶ã€‚å‘é€å¤æ‚çš„æ¶ˆæ¯æˆªè‡³ç›®å‰ä½ç½®æˆ‘ä»¬åªå‘é€äº†ç®€å•çš„å­—ç¬¦ä¸²ç±»åž‹çš„æ¶ˆæ¯ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨æ¥å‘é€å¤æ‚çš„æ¶ˆæ¯ã€‚å®šä¹‰æ¶ˆæ¯å®žä½“åˆ›å»ºä¸€ä¸ªMessageç±»ï¼š1234567891011121314151617181920212223242526public class Message implements Serializable &#123; private static final long serialVersionUID = 6678420965611108427L; private String from; private String message; public Message() &#123; &#125; public Message(String from, String message) &#123; this.from = from; this.message = message; &#125; @Override public String toString() &#123; return "Message&#123;" + "from='" + from + '\'' + ", message='" + message + '\'' + '&#125;'; &#125; // get set ç•¥&#125;æ”¹é€ æ¶ˆæ¯ç”Ÿäº§è€…é…ç½®1234567891011121314151617181920212223242526@Configurationpublic class KafkaProducerConfig &#123; @Value("$&#123;spring.kafka.bootstrap-servers&#125;") private String bootstrapServers; @Bean public ProducerFactory&lt;String, Message&gt; producerFactory() &#123; Map&lt;String, Object&gt; configProps = new HashMap&lt;&gt;(); configProps.put( ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers); configProps.put( ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class); configProps.put( ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, JsonSerializer.class); return new DefaultKafkaProducerFactory&lt;&gt;(configProps); &#125; @Bean public KafkaTemplate&lt;String, Message&gt; kafkaTemplate() &#123; return new KafkaTemplate&lt;&gt;(producerFactory()); &#125;&#125;æˆ‘ä»¬å°†valueåºåˆ—åŒ–ç­–ç•¥æŒ‡å®šä¸ºäº†Kafkaæä¾›çš„JsonSerializerï¼Œå¹¶ä¸”kafkaTemplateè¿”å›žç±»åž‹ä¸ºKafkaTemplate&lt;String, Message&gt;ã€‚å‘é€æ–°çš„æ¶ˆæ¯åœ¨SendMessageControlleré‡Œå‘é€å¤æ‚çš„æ¶ˆæ¯:1234567@Autowiredprivate KafkaTemplate&lt;String, Message&gt; kafkaTemplate;@GetMapping("send/&#123;message&#125;")public void sendMessage(@PathVariable String message) &#123; this.kafkaTemplate.send("test", new Message("mrbird", message));&#125;ä¿®æ”¹æ¶ˆè´¹è€…é…ç½®ä¿®æ”¹æ¶ˆè´¹è€…é…ç½®KafkaConsumerConfigï¼š123456789101112131415161718192021222324252627282930313233343536373839@EnableKafka@Configurationpublic class KafkaConsumerConfig &#123; @Value("$&#123;spring.kafka.bootstrap-servers&#125;") private String bootstrapServers; @Value("$&#123;spring.kafka.consumer.group-id&#125;") private String consumerGroupId; @Value("$&#123;spring.kafka.consumer.auto-offset-reset&#125;") private String autoOffsetReset; @Bean public ConsumerFactory&lt;String, Message&gt; consumerFactory() &#123; Map&lt;String, Object&gt; props = new HashMap&lt;&gt;(); props.put( ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers); props.put( ConsumerConfig.GROUP_ID_CONFIG, consumerGroupId); props.put( ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, autoOffsetReset); return new DefaultKafkaConsumerFactory&lt;&gt;( props, new StringDeserializer(), new JsonDeserializer&lt;&gt;(Message.class)); &#125; @Bean public ConcurrentKafkaListenerContainerFactory&lt;String, Message&gt; kafkaListenerContainerFactory() &#123; ConcurrentKafkaListenerContainerFactory&lt;String, Message&gt; factory = new ConcurrentKafkaListenerContainerFactory&lt;&gt;(); factory.setConsumerFactory(consumerFactory()); return factory; &#125;&#125;ä¿®æ”¹æ¶ˆæ¯ç›‘å¬ä¿®æ”¹KafkaMessageListenerï¼š1234@KafkaListener(topics = "test", groupId = "test-consumer")public void listen(Message message) &#123; logger.info("æŽ¥æ”¶æ¶ˆæ¯: &#123;&#125;", message);&#125;é‡å¯é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/send/helloï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šæ›´å¤šé…ç½®12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394spring.kafka.admin.client-id= # ID to pass to the server when making requests. Used for server-side logging.spring.kafka.admin.fail-fast=false # Whether to fail fast if the broker is not available on startup.spring.kafka.admin.properties.*= # Additional admin-specific properties used to configure the client.spring.kafka.admin.ssl.key-password= # Password of the private key in the key store file.spring.kafka.admin.ssl.key-store-location= # Location of the key store file.spring.kafka.admin.ssl.key-store-password= # Store password for the key store file.spring.kafka.admin.ssl.key-store-type= # Type of the key store.spring.kafka.admin.ssl.protocol= # SSL protocol to use.spring.kafka.admin.ssl.trust-store-location= # Location of the trust store file.spring.kafka.admin.ssl.trust-store-password= # Store password for the trust store file.spring.kafka.admin.ssl.trust-store-type= # Type of the trust store.spring.kafka.bootstrap-servers= # Comma-delimited list of host:port pairs to use for establishing the initial connections to the Kafka cluster. Applies to all components unless overridden.spring.kafka.client-id= # ID to pass to the server when making requests. Used for server-side logging.spring.kafka.consumer.auto-commit-interval= # Frequency with which the consumer offsets are auto-committed to Kafka if 'enable.auto.commit' is set to true.spring.kafka.consumer.auto-offset-reset= # What to do when there is no initial offset in Kafka or if the current offset no longer exists on the server.spring.kafka.consumer.bootstrap-servers= # Comma-delimited list of host:port pairs to use for establishing the initial connections to the Kafka cluster. Overrides the global property, for consumers.spring.kafka.consumer.client-id= # ID to pass to the server when making requests. Used for server-side logging.spring.kafka.consumer.enable-auto-commit= # Whether the consumer's offset is periodically committed in the background.spring.kafka.consumer.fetch-max-wait= # Maximum amount of time the server blocks before answering the fetch request if there isn't sufficient data to immediately satisfy the requirement given by "fetch-min-size".spring.kafka.consumer.fetch-min-size= # Minimum amount of data the server should return for a fetch request.spring.kafka.consumer.group-id= # Unique string that identifies the consumer group to which this consumer belongs.spring.kafka.consumer.heartbeat-interval= # Expected time between heartbeats to the consumer coordinator.spring.kafka.consumer.key-deserializer= # Deserializer class for keys.spring.kafka.consumer.max-poll-records= # Maximum number of records returned in a single call to poll().spring.kafka.consumer.properties.*= # Additional consumer-specific properties used to configure the client.spring.kafka.consumer.ssl.key-password= # Password of the private key in the key store file.spring.kafka.consumer.ssl.key-store-location= # Location of the key store file.spring.kafka.consumer.ssl.key-store-password= # Store password for the key store file.spring.kafka.consumer.ssl.key-store-type= # Type of the key store.spring.kafka.consumer.ssl.protocol= # SSL protocol to use.spring.kafka.consumer.ssl.trust-store-location= # Location of the trust store file.spring.kafka.consumer.ssl.trust-store-password= # Store password for the trust store file.spring.kafka.consumer.ssl.trust-store-type= # Type of the trust store.spring.kafka.consumer.value-deserializer= # Deserializer class for values.spring.kafka.jaas.control-flag=required # Control flag for login configuration.spring.kafka.jaas.enabled=false # Whether to enable JAAS configuration.spring.kafka.jaas.login-module=com.sun.security.auth.module.Krb5LoginModule # Login module.spring.kafka.jaas.options= # Additional JAAS options.spring.kafka.listener.ack-count= # Number of records between offset commits when ackMode is "COUNT" or "COUNT_TIME".spring.kafka.listener.ack-mode= # Listener AckMode. See the spring-kafka documentation.spring.kafka.listener.ack-time= # Time between offset commits when ackMode is "TIME" or "COUNT_TIME".spring.kafka.listener.client-id= # Prefix for the listener's consumer client.id property.spring.kafka.listener.concurrency= # Number of threads to run in the listener containers.spring.kafka.listener.idle-event-interval= # Time between publishing idle consumer events (no data received).spring.kafka.listener.log-container-config= # Whether to log the container configuration during initialization (INFO level).spring.kafka.listener.monitor-interval= # Time between checks for non-responsive consumers. If a duration suffix is not specified, seconds will be used.spring.kafka.listener.no-poll-threshold= # Multiplier applied to "pollTimeout" to determine if a consumer is non-responsive.spring.kafka.listener.poll-timeout= # Timeout to use when polling the consumer.spring.kafka.listener.type=single # Listener type.spring.kafka.producer.acks= # Number of acknowledgments the producer requires the leader to have received before considering a request complete.spring.kafka.producer.batch-size= # Default batch size.spring.kafka.producer.bootstrap-servers= # Comma-delimited list of host:port pairs to use for establishing the initial connections to the Kafka cluster. Overrides the global property, for producers.spring.kafka.producer.buffer-memory= # Total memory size the producer can use to buffer records waiting to be sent to the server.spring.kafka.producer.client-id= # ID to pass to the server when making requests. Used for server-side logging.spring.kafka.producer.compression-type= # Compression type for all data generated by the producer.spring.kafka.producer.key-serializer= # Serializer class for keys.spring.kafka.producer.properties.*= # Additional producer-specific properties used to configure the client.spring.kafka.producer.retries= # When greater than zero, enables retrying of failed sends.spring.kafka.producer.ssl.key-password= # Password of the private key in the key store file.spring.kafka.producer.ssl.key-store-location= # Location of the key store file.spring.kafka.producer.ssl.key-store-password= # Store password for the key store file.spring.kafka.producer.ssl.key-store-type= # Type of the key store.spring.kafka.producer.ssl.protocol= # SSL protocol to use.spring.kafka.producer.ssl.trust-store-location= # Location of the trust store file.spring.kafka.producer.ssl.trust-store-password= # Store password for the trust store file.spring.kafka.producer.ssl.trust-store-type= # Type of the trust store.spring.kafka.producer.transaction-id-prefix= # When non empty, enables transaction support for producer.spring.kafka.producer.value-serializer= # Serializer class for values.spring.kafka.properties.*= # Additional properties, common to producers and consumers, used to configure the client.spring.kafka.ssl.key-password= # Password of the private key in the key store file.spring.kafka.ssl.key-store-location= # Location of the key store file.spring.kafka.ssl.key-store-password= # Store password for the key store file.spring.kafka.ssl.key-store-type= # Type of the key store.spring.kafka.ssl.protocol= # SSL protocol to use.spring.kafka.ssl.trust-store-location= # Location of the trust store file.spring.kafka.ssl.trust-store-password= # Store password for the trust store file.spring.kafka.ssl.trust-store-type= # Type of the trust store.spring.kafka.streams.application-id= # Kafka streams application.id property; default spring.application.name.spring.kafka.streams.auto-startup=true # Whether or not to auto-start the streams factory bean.spring.kafka.streams.bootstrap-servers= # Comma-delimited list of host:port pairs to use for establishing the initial connections to the Kafka cluster. Overrides the global property, for streams.spring.kafka.streams.cache-max-size-buffering= # Maximum memory size to be used for buffering across all threads.spring.kafka.streams.client-id= # ID to pass to the server when making requests. Used for server-side logging.spring.kafka.streams.properties.*= # Additional Kafka properties used to configure the streams.spring.kafka.streams.replication-factor= # The replication factor for change log topics and repartition topics created by the stream processing application.spring.kafka.streams.ssl.key-password= # Password of the private key in the key store file.spring.kafka.streams.ssl.key-store-location= # Location of the key store file.spring.kafka.streams.ssl.key-store-password= # Store password for the key store file.spring.kafka.streams.ssl.key-store-type= # Type of the key store.spring.kafka.streams.ssl.protocol= # SSL protocol to use.spring.kafka.streams.ssl.trust-store-location= # Location of the trust store file.spring.kafka.streams.ssl.trust-store-password= # Store password for the trust store file.spring.kafka.streams.ssl.trust-store-type= # Type of the trust store.spring.kafka.streams.state-dir= # Directory location for the state store.spring.kafka.template.default-topic= # Default topic to which messages are sent.æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/54.Spring-Boot-Kafka]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>Kafka</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot 2.0 WebFluxç¼–ç¨‹]]></title>
    <url>%2FSpring-Boot-2-0-WebFlux.html</url>
    <content type="text"><![CDATA[Spring MVC Webæž¶æž„æ˜¯åŸºäºŽé˜»å¡žå¼Servlet APIæž„å»ºçš„ã€‚Servlet 3.1åŽæä¾›äº†éžé˜»å¡žAPIï¼ŒSpring 5.0åŽåŸºäºŽè¿™äº›APIæž„å»ºäº†ä¸€å¥—å…¨æ–°çš„éžé˜»å¡žWebæ¡†æž¶ â€”â€” WebFluxã€‚Spring Boot 2.0åŸºäºŽSpring 5.0æž„å»ºï¼Œæ‰€ä»¥è¦åœ¨Spring Bootä¸­ä½¿ç”¨WebFluxæž¶æž„ï¼Œç‰ˆæœ¬å¿…é¡»å¤§äºŽ2.0ã€‚é€šè¿‡ä¸‹é¢è¿™å¼ å›¾äº†è§£ä¸‹Spring MVCå’ŒSpring WebFluxçš„åŒºåˆ«ï¼š https://www.cnblogs.com/javabg/p/7976977.htmlå¯ä»¥çœ‹åˆ°ï¼ŒSpring WebFluxæ˜¯éžé˜»å¡žå¼çš„ï¼Œæ”¯æŒ Reactive StreamsèƒŒåŽ‹ï¼Œå¹¶åœ¨Nettyï¼ŒUndertowå’ŒServlet 3.1+å®¹å™¨ç­‰æœåŠ¡å™¨ä¸Šè¿è¡Œã€‚å…¶ç›®å‰åªæ”¯æŒéžå…³ç³»åž‹æ•°æ®åº“ï¼Œå¦‚Mongoï¼ŒRedisç­‰ã€‚éžé˜»å¡žå¼çš„ç¼–ç¨‹æ¨¡åž‹å¯ä»¥æé«˜ç¨‹åºçš„å¹¶å‘é‡ï¼Œæå‡æ€§èƒ½å’Œåžåé‡ã€‚å¼‚æ­¥Servletæ—¢ç„¶WebFluxæ˜¯åŸºäºŽå¼‚æ­¥Servelt APIæž„å»ºçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯å¼‚æ­¥Servletã€‚ä½¿ç”¨IDEAåˆ›å»ºä¸€ä¸ªä¼ ç»Ÿçš„Java Webåº”ç”¨ï¼ˆå¯ä»¥å‚è€ƒhttps://www.cnblogs.com/javabg/p/7976977.htmlï¼‰ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªSyncServletï¼š12345678910111213141516171819202122232425262728@WebServlet(urlPatterns = "/sync")public class SyncServlet extends HttpServlet &#123; private static final long serialVersionUID = 7583536145022393360L; private Logger log = Logger.getLogger(SyncServlet.class.getName()); @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) &#123; long start = System.currentTimeMillis(); this.execute(request, response); log.info("æ€»è€—æ—¶ï¼š" + (System.currentTimeMillis() - start) + "ms"); &#125; private void execute(HttpServletRequest request, HttpServletResponse response) &#123; try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; try &#123; response.getWriter().append("hello"); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125;doGetæ–¹æ³•ä¸­çº¿ç¨‹é˜»å¡ž2ç§’ï¼Œç„¶åŽæ‰“å°helloã€‚éƒ¨ç½²é¡¹ç›®åˆ°Tomcatï¼Œcontext-pathä¸º/servletï¼Œå¯åŠ¨åŽè®¿é—®http://localhost:8080/servlet/sync:ä¼ ç»Ÿçš„Servlet APIæ˜¯é˜»å¡žçš„ï¼Œlog.info(&quot;æ€»è€—æ—¶ï¼š&quot; + (System.currentTimeMillis() - start) + &quot;ms&quot;)è¿™è¡Œä»£ç å¿…é¡»ç­‰å¾…this.execute()æ‰§è¡Œå®Œæ¯•åŽæ‰å¼€å§‹æ‰§è¡Œã€‚æŽ¥ä¸‹æ¥çœ‹çœ‹éžé˜»å¡žServlet APIæ˜¯æ€Žä¹ˆæžçš„ã€‚æ–°å»ºä¸€ä¸ªAsyncServletï¼š123456789101112131415161718192021222324252627282930313233@WebServlet(urlPatterns = "/async", asyncSupported = true)public class AsyncServlet extends HttpServlet &#123; private static final long serialVersionUID = 393375716683413545L; private Logger log = Logger.getLogger(AsyncServlet.class.getName()); @Override protected void doGet(HttpServletRequest request, HttpServletResponse response) &#123; long start = System.currentTimeMillis(); AsyncContext asyncContext = request.startAsync(); CompletableFuture.runAsync(() -&gt; execute( asyncContext, asyncContext.getRequest(), asyncContext.getResponse()) ); log.info("æ€»è€—æ—¶ï¼š" + (System.currentTimeMillis() - start) + "ms"); &#125; private void execute(AsyncContext asyncContext, ServletRequest request, ServletResponse response) &#123; try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; try &#123; response.getWriter().append("hello"); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; asyncContext.complete(); &#125;&#125;åœ¨ç±»ä¸Šä½¿ç”¨@WebServlet(asyncSupported = true)å¼€å¯å¼‚æ­¥æ”¯æŒï¼Œé€šè¿‡AsyncContext asyncContext = request.startAsync();èŽ·å–å¼‚æ­¥ä¸Šä¸‹æ–‡AsyncContextï¼ŒAsyncContextçš„completeæ–¹æ³•ç”¨äºŽæ ‡è¯†å¼‚æ­¥è°ƒç”¨ç»“æŸã€‚CompletableFutureä¸ºJava 8æä¾›çš„FutureæŽ¥å£å®žçŽ°ç±»ï¼Œå¯ä»¥æ–¹ä¾¿çš„å¤„ç†å¼‚æ­¥è°ƒç”¨ã€‚å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/servlet/asyncï¼Œå“åº”è€—æ—¶ä¹Ÿåœ¨2ç§’å·¦å³ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼ŒæŸ¥çœ‹æŽ§åˆ¶å°æ—¥å¿—å°±å¯ä»¥è¯æ˜Žè¿™ç‚¹ï¼šæ‰€ä»¥ï¼Œå¼‚æ­¥è°ƒç”¨é€‚ç”¨äºŽé‚£äº›å¯¹æ–¹æ³•è¿”å›žå€¼æ²¡æœ‰å½±å“çš„æ“ä½œï¼Œæ¯”å¦‚å¼‚æ­¥è®°å½•ç”¨æˆ·æ“ä½œæ—¥å¿—ç­‰ã€‚å¦‚æžœæ–¹æ³•çš„è¿”å›žå€¼ä¾èµ–äºŽå¼‚æ­¥è°ƒç”¨çš„ç»“æžœï¼Œé‚£ä¹ˆæ–¹æ³•è€—æ—¶åœ¨åŒæ­¥å’Œå¼‚æ­¥ä¸Šæ˜¯æ²¡æœ‰åŒºåˆ«çš„ã€‚Monoå’ŒFluxäº†è§£äº†å¼‚æ­¥ServletåŽï¼Œæˆ‘ä»¬å›žåˆ°WebFluxï¼Œæ–°å»ºä¸€ä¸ªSpringBootç¨‹åºï¼Œç‰ˆæœ¬ä¸º2.1.3.RELEASEï¼Œå¹¶å¼•å…¥spring-boot-starter-webfluxä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-webflux&lt;/artifactId&gt;&lt;/dependency&gt;Reactor æ˜¯Spring WebFluxæ‰€ä½¿ç”¨çš„å“åº”å¼åº“ï¼Œå…¶æä¾›äº†ä¸¤ä¸ªç‰¹æ®Šçš„ç±»Monoå’ŒFluxã€‚Monoå’ŒFluxåœ¨å‘å¸ƒè®¢é˜…æ¨¡å¼ä¸­éƒ½å±žäºŽå‘å¸ƒè€…ï¼ˆä¸æ¸…æ¥šçš„å¯ä»¥å‚è€ƒJava 9 Flow APIå­¦ä¹ ï¼‰ï¼ŒæŸ¥çœ‹æºç ä¼šå‘çŽ°å®ƒä»¬éƒ½å®žçŽ°äº†PublisheræŽ¥å£ã€‚Monoè¡¨ç¤º0 ~ 1ä¸ªå…ƒç´ çš„æ•°æ®å‘å¸ƒè€…ï¼ŒFluxè¡¨ç¤º 0 ~ Nä¸ªå…ƒç´ çš„æ•°æ®å‘å¸ƒè€…ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥äº†è§£Monoå’ŒFluxï¼Œåˆ›å»ºMonoFluxTestç±»ï¼š12345678910111213141516171819202122232425262728293031323334353637383940public class MonoFluxTest &#123; public static void main(String[] args) &#123; Subscriber&lt;Integer&gt; subscriber = new Subscriber&lt;Integer&gt;() &#123; private Subscription subscription; @Override public void onSubscribe(Subscription subscription) &#123; this.subscription = subscription; this.subscription.request(1); &#125; @Override public void onNext(Integer item) &#123; System.out.println("æŽ¥å—åˆ°æ•°æ®: " + item); try &#123; TimeUnit.SECONDS.sleep(3); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; this.subscription.request(1); &#125; @Override public void onError(Throwable throwable) &#123; throwable.printStackTrace(); this.subscription.cancel(); &#125; @Override public void onComplete() &#123; System.out.println("å¤„ç†å®Œäº†!"); &#125; &#125;; String[] strs = &#123;"1", "2", "3"&#125;; Flux.fromArray(strs).map(Integer::parseInt).subscribe(subscriber); Mono.fromSupplier(() -&gt; 1).map(s -&gt; s + 1).subscribe(subscriber); &#125;&#125;ç¨‹åºé¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªè®¢é˜…è€…ï¼ˆå‚è€ƒJava 9 Flow APIå­¦ä¹ ï¼‰ï¼Œç„¶åŽåˆ†åˆ«ä½¿ç”¨Flux.fromArrayå’ŒMono.fromSupplieræž„é€ äº†Fluxç±»åž‹å‘å¸ƒè€…å’ŒMonoç±»åž‹å‘å¸ƒè€…ï¼Œå¹¶å’Œè®¢é˜…è€…ä¿æŒè®¢é˜…å…³ç³»ã€‚è¿è¡Œmainæ–¹æ³•ï¼ŒæŽ§åˆ¶å°è¾“å‡ºï¼šäº†è§£äº†Monoå’ŒFluxåŽï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªTestControllerï¼š1234567891011121314151617181920212223242526272829@RestControllerpublic class TestController &#123; private Logger logger = LoggerFactory.getLogger(this.getClass()); @GetMapping("sync") public String sync() &#123; logger.info("sync method start"); String result = this.execute(); logger.info("sync method end"); return result; &#125; @GetMapping("async/mono") public Mono&lt;String&gt; asyncMono() &#123; logger.info("async method start"); Mono&lt;String&gt; result = Mono.fromSupplier(this::execute); logger.info("async method end"); return result; &#125; private String execute() &#123; try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; return "hello"; &#125;&#125;executeæ–¹æ³•è¿”å›žä¸€ä¸ªå€¼helloï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨Monoæ¥å¤„ç†è¿”å›žå€¼ï¼Œä½¿å®ƒæˆä¸ºä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ã€‚asyncMonoæ–¹æ³•è¿”å›žMono&lt;String&gt;ç±»åž‹ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªStringç±»åž‹çš„æ•°æ®å‘å¸ƒè€…ï¼Œæˆ‘ä»¬ä¸ç”¨åŽ»æ‰‹åŠ¨å¤„ç†è®¢é˜…å…³ç³»ï¼ŒSpringä¼šå¸®æˆ‘ä»¬å¤„ç†ï¼Œæˆ‘ä»¬ç›´æŽ¥è¿”å›žå³å¯ã€‚å¯åŠ¨é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°WebFluxé»˜è®¤ä½¿ç”¨çš„æ˜¯NettyæœåŠ¡å™¨ï¼šåˆ†åˆ«è®¿é—®http://localhost:8080/syncå’Œhttp://localhost:8080/async/monoï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šå¯ä»¥çœ‹åˆ°asyncMonoæ–¹æ³•é‡Œçš„Mono&lt;String&gt; result = Mono.fromSupplier(this::execute)æ˜¯å¼‚æ­¥éžé˜»å¡žçš„ï¼Œå¹¶ä¸”http://localhost:8080/async/monoè¿”å›žçš„å€¼ä¸ºå­—ç¬¦ä¸²helloã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè¿”å›žç±»åž‹ä¸ºFlux&lt;String&gt;ç±»åž‹çš„ä¾‹å­ã€‚Server Sent Eventsè¿”å›žå€¼ç±»åž‹ä¸ºFluxçš„æ—¶å€™ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•°æ®æµï¼Œä¸æ˜¯ä¸€æ¬¡æ€§æ•°æ®åŒ…ï¼ŒæœåŠ¡ç«¯ä¼šä¸æ–­åœ°ï¼ˆå‡å¦‚Fluxæ•°æ®é•¿åº¦å¤§äºŽ1ï¼‰å¾€å®¢æˆ·ç«¯å‘é€æ•°æ®ã€‚è¿™æ—¶ï¼Œå®¢æˆ·ç«¯ä¸ä¼šå…³é—­è¿žæŽ¥ï¼Œä¼šä¸€ç›´ç­‰ç€æœåŠ¡å™¨å‘è¿‡æ¥çš„æ–°çš„æ•°æ®æµã€‚è¿™ç§æ¨¡å¼ç§°ä¸ºServer-Sent Eventsã€‚åœ¨TestControlleræ–°å¢žä¸€ä¸ªasyncFluxæ–¹æ³•ï¼š1234567891011121314@GetMapping(value = "async/flux", produces = MediaType.TEXT_EVENT_STREAM_VALUE)public Flux&lt;String&gt; asyncFlux() &#123; logger.info("async method start"); Flux&lt;String&gt; result = Flux.fromStream(IntStream.range(1, 5).mapToObj(i -&gt; &#123; try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; return "int valueï¼š" + i; &#125;)); logger.info("async method end"); return result;&#125;@GetMappingå¿…é¡»é€šè¿‡producesæŒ‡å®šæ•°æ®ç±»åž‹ä¸ºtext/event-streamï¼Œé‡å¯é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/async/fluxï¼šå‰ç«¯å¯ä»¥é€šè¿‡H5çš„EventSourceæ¥æŽ¥æ”¶ã€‚å¼•å…¥thymeleafä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåœ¨resources/templatesä¸‹æ–°å»ºflux.htmlï¼š123456789101112131415161718&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;test sse&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;script&gt; var es = new EventSource("async/flux"); es.onmessage = function (evt) &#123; console.log(evt.data); if (evt.data === "int valueï¼š4") &#123; es.close(); &#125; &#125;;&lt;/script&gt;&lt;/html&gt;éœ€è¦è°ƒç”¨es.close()æ¥å…³é—­äº‹ä»¶æµï¼Œä¸ç„¶EventSourceä¼šåœ¨æ•°æ®ä¼ è¾“å®Œæ¯•ä¼šè‡ªåŠ¨é‡è¿žï¼Œè¿™æ ·å°±ä¼šä¸é—´æ–­çš„è°ƒç”¨localhost:8080/async/fluxè¯·æ±‚äº†ã€‚æ·»åŠ ä¸€ä¸ªViewControllerï¼Œç”¨æ¥è®¿é—®flux.htmlï¼š12345678@Controllerpublic class ViewController &#123; @GetMapping("flux") public String flux() &#123; return "flux"; &#125;&#125;é‡å¯é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/fluxï¼Œæµè§ˆå™¨æŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹æ‰€ç¤º:Mono,Fluxå¸¸ç”¨æ–¹æ³•é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç®€å•äº†è§£äº†Monoå’ŒFluxçš„ç”¨æ³•å’ŒåŒºåˆ«ï¼Œä¸‹é¢æˆ‘ä»¬åˆ—ä¸¾ä¸€äº›å®ƒä»¬çš„å¸¸ç”¨æ–¹æ³•ã€‚æºå¤´æ“ä½œFluxå¯ä»¥é€šè¿‡Fluxç±»çš„é™æ€æ–¹æ³•æ¥ç”Ÿæˆï¼šjust()ï¼šå¯ä»¥æŒ‡å®šåºåˆ—ä¸­åŒ…å«çš„å…¨éƒ¨å…ƒç´ ã€‚åˆ›å»ºå‡ºæ¥çš„ Flux åºåˆ—åœ¨å‘å¸ƒè¿™äº›å…ƒç´ ä¹‹åŽä¼šè‡ªåŠ¨ç»“æŸã€‚fromArray()ï¼ŒfromIterable()å’Œ fromStream()ï¼šå¯ä»¥ä»Žä¸€ä¸ªæ•°ç»„ã€Iterable å¯¹è±¡æˆ– Stream å¯¹è±¡ä¸­åˆ›å»º Flux å¯¹è±¡ã€‚empty()ï¼šåˆ›å»ºä¸€ä¸ªä¸åŒ…å«ä»»ä½•å…ƒç´ ï¼Œåªå‘å¸ƒç»“æŸæ¶ˆæ¯çš„åºåˆ—ã€‚error(Throwable error)ï¼šåˆ›å»ºä¸€ä¸ªåªåŒ…å«é”™è¯¯æ¶ˆæ¯çš„åºåˆ—ã€‚never()ï¼šåˆ›å»ºä¸€ä¸ªä¸åŒ…å«ä»»ä½•æ¶ˆæ¯é€šçŸ¥çš„åºåˆ—ã€‚range(int start, int count)ï¼šåˆ›å»ºåŒ…å«ä»Ž start èµ·å§‹çš„ count ä¸ªæ•°é‡çš„ Integer å¯¹è±¡çš„åºåˆ—ã€‚interval(Duration period)å’Œ interval(Duration delay, Duration period)ï¼šåˆ›å»ºä¸€ä¸ªåŒ…å«äº†ä»Ž 0 å¼€å§‹é€’å¢žçš„ Long å¯¹è±¡çš„åºåˆ—ã€‚å…¶ä¸­åŒ…å«çš„å…ƒç´ æŒ‰ç…§æŒ‡å®šçš„é—´éš”æ¥å‘å¸ƒã€‚é™¤äº†é—´éš”æ—¶é—´ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šèµ·å§‹å…ƒç´ å‘å¸ƒä¹‹å‰çš„å»¶è¿Ÿæ—¶é—´ã€‚ä¸¾äº›ä¾‹å­ï¼š123456789public static void main(String[] args) throws InterruptedException &#123; Flux.just("Hello", "World").subscribe(System.out::println); Flux.fromArray(new Integer[] &#123;1, 2, 3&#125;).subscribe(System.out::println); Flux.empty().subscribe(System.out::println); Flux.range(1, 4).subscribe(System.out::println); Flux.interval(Duration.of(1, ChronoUnit.SECONDS)).subscribe(System.out::println); // çº¿ç¨‹å»¶è¿Ÿå…³é—­ï¼Œä¸ç„¶æœ€åŽä¸€ä¸ªä¾‹å­æœ¨æœ‰è¾“å‡º Thread.currentThread().join(10000);&#125;è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š ä¸Šé¢çš„è¿™äº›é™æ€æ–¹æ³•é€‚åˆäºŽç®€å•çš„Fluxåºåˆ—ç”Ÿæˆï¼Œå½“åºåˆ—çš„ç”Ÿæˆéœ€è¦å¤æ‚çš„é€»è¾‘æ—¶ï¼Œåˆ™åº”è¯¥ä½¿ç”¨generate()æˆ–create()æ–¹æ³•ã€‚generate()generate()æ–¹æ³•é€šè¿‡åŒæ­¥å’Œé€ä¸€çš„æ–¹å¼æ¥äº§ç”Ÿ Flux åºåˆ—ã€‚åºåˆ—çš„äº§ç”Ÿæ˜¯é€šè¿‡è°ƒç”¨æ‰€æä¾›çš„ SynchronousSink å¯¹è±¡çš„ next()ï¼Œcomplete()å’Œ error(Throwable)æ–¹æ³•æ¥å®Œæˆçš„ï¼š12345678910111213141516Flux.generate(sink -&gt; &#123; sink.next("Hello"); sink.complete();&#125;).subscribe(System.out::println);final Random random = new Random();Flux.generate(ArrayList::new, (list, sink) -&gt; &#123; int value = random.nextInt(100); list.add(value); sink.next(value); if (list.size() == 10) &#123; sink.complete(); &#125; return list;&#125;).subscribe(System.out::println);è¾“å‡ºå¦‚ä¸‹æ‰€ç¤º:å¦‚æžœä¸è°ƒç”¨ complete()æ–¹æ³•ï¼Œæ‰€äº§ç”Ÿçš„æ˜¯ä¸€ä¸ªæ— é™åºåˆ—ã€‚create()create()æ–¹æ³•ä¸Ž generate()æ–¹æ³•çš„ä¸åŒä¹‹å¤„åœ¨äºŽæ‰€ä½¿ç”¨çš„æ˜¯ FluxSink å¯¹è±¡ã€‚FluxSink æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥çš„æ¶ˆæ¯äº§ç”Ÿï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸€æ¬¡è°ƒç”¨ä¸­äº§ç”Ÿå¤šä¸ªå…ƒç´ ï¼š123456Flux.create(sink -&gt; &#123; for (int i = 0; i &lt; 10; i++) &#123; sink.next(i); &#125; sink.complete();&#125;).subscribe(System.out::println);MonoMono çš„åˆ›å»ºæ–¹å¼ä¸Žä¹‹å‰ä»‹ç»çš„ Flux æ¯”è¾ƒç›¸ä¼¼ã€‚Mono ç±»ä¸­ä¹ŸåŒ…å«äº†ä¸€äº›ä¸Ž Flux ç±»ä¸­ç›¸åŒçš„é™æ€æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•åŒ…æ‹¬ just()ï¼Œempty()ï¼Œerror()å’Œ never()ç­‰ã€‚é™¤äº†è¿™äº›æ–¹æ³•ä¹‹å¤–ï¼ŒMono è¿˜æœ‰ä¸€äº›ç‹¬æœ‰çš„é™æ€æ–¹æ³•ï¼šfromCallable()ã€fromCompletionStage()ã€fromFuture()ã€fromRunnable()å’Œ fromSupplier()ï¼šåˆ†åˆ«ä»Ž Callableã€CompletionStageã€CompletableFutureã€Runnable å’Œ Supplier ä¸­åˆ›å»º Monoã€‚delay(Duration duration)ï¼šåˆ›å»ºä¸€ä¸ª Mono åºåˆ—ï¼Œåœ¨æŒ‡å®šçš„å»¶è¿Ÿæ—¶é—´ä¹‹åŽï¼Œäº§ç”Ÿæ•°å­— 0 ä½œä¸ºå”¯ä¸€å€¼ã€‚ignoreElements(Publisher&lt;T&gt; source)ï¼šåˆ›å»ºä¸€ä¸ª Mono åºåˆ—ï¼Œå¿½ç•¥ä½œä¸ºæºçš„ Publisher ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œåªäº§ç”Ÿç»“æŸæ¶ˆæ¯ã€‚justOrEmpty(Optional&lt;? extends T&gt; data)å’Œ justOrEmpty(T data)ï¼šä»Žä¸€ä¸ª Optional å¯¹è±¡æˆ–å¯èƒ½ä¸º null çš„å¯¹è±¡ä¸­åˆ›å»º Monoã€‚åªæœ‰ Optional å¯¹è±¡ä¸­åŒ…å«å€¼æˆ–å¯¹è±¡ä¸ä¸º null æ—¶ï¼ŒMono åºåˆ—æ‰äº§ç”Ÿå¯¹åº”çš„å…ƒç´ ã€‚ä¸¾äº›ä¾‹å­:1234Mono.just("are").subscribe(System.out::println);Mono.empty().subscribe(System.out::println);Mono.fromSupplier(() -&gt; "you").subscribe(System.out::println);Mono.justOrEmpty(Optional.of("ok")).subscribe(System.out::println);è¾“å‡º:è¿˜å¯ä»¥é€šè¿‡ create()æ–¹æ³•æ¥ä½¿ç”¨ MonoSink æ¥åˆ›å»º Monoï¼š1Mono.create(sink -&gt; sink.success("Hello")).subscribe(System.out::println);ä¸­é—´æ“ä½œfilterå¯¹æµä¸­åŒ…å«çš„å…ƒç´ è¿›è¡Œè¿‡æ»¤ï¼Œåªç•™ä¸‹æ»¡è¶³ Predicate æŒ‡å®šæ¡ä»¶çš„å…ƒç´ ï¼š1Flux.range(1, 10).filter(i -&gt; i % 2 == 0).subscribe(System.out::println);è¾“å‡ºå‰10å¶æ•°ã€‚taketake ç³»åˆ—æ“ä½œç¬¦ç”¨æ¥ä»Žå½“å‰æµä¸­æå–å…ƒç´ ã€‚æå–çš„æ–¹å¼å¯ä»¥æœ‰å¾ˆå¤šç§ã€‚take(long n)ï¼šæŒ‰ç…§æŒ‡å®šçš„æ•°é‡æ¥æå–ã€‚takeLast(long n)ï¼šæå–æµä¸­çš„æœ€åŽ N ä¸ªå…ƒç´ ã€‚takeUntil(Predicate&lt;? super T&gt; predicate)ï¼šæå–å…ƒç´ ç›´åˆ° Predicate è¿”å›ž trueã€‚4 takeWhile(Predicate&lt;? super T&gt; continuePredicate)ï¼š å½“ Predicate è¿”å›ž true æ—¶æ‰è¿›è¡Œæå–ã€‚ä¸¾äº›ä¾‹å­ï¼š1234Flux.range(1, 20).take(10).subscribe(System.out::println);Flux.range(1, 20).takeLast(10).subscribe(System.out::println);Flux.range(1, 20).takeWhile(i -&gt; i &lt; 10).subscribe(System.out::println);Flux.range(1, 20).takeUntil(i -&gt; i == 10).subscribe(System.out::println);reduce å’Œ reduceWithreduce å’Œ reduceWith æ“ä½œç¬¦å¯¹æµä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´ è¿›è¡Œç´¯ç§¯æ“ä½œï¼Œå¾—åˆ°ä¸€ä¸ªåŒ…å«è®¡ç®—ç»“æžœçš„ Mono åºåˆ—ã€‚ç´¯ç§¯æ“ä½œæ˜¯é€šè¿‡ä¸€ä¸ª BiFunction æ¥è¡¨ç¤ºçš„ã€‚åœ¨æ“ä½œæ—¶å¯ä»¥æŒ‡å®šä¸€ä¸ªåˆå§‹å€¼ã€‚å¦‚æžœæ²¡æœ‰åˆå§‹å€¼ï¼Œåˆ™åºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä½œä¸ºåˆå§‹å€¼ã€‚æ¯”å¦‚ï¼š12Flux.range(1, 10).reduce((x, y) -&gt; x + y).subscribe(System.out::println);Flux.range(1, 10).reduceWith(() -&gt; 10, (x, y) -&gt; x + y).subscribe(System.out::println);ç¬¬ä¸€è¡Œè¯­å¥å¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œç›¸åŠ æ“ä½œï¼Œç»“æžœä¸º 55ï¼›ç¬¬äºŒè¡Œè¯­å¥åŒæ ·ä¹Ÿæ˜¯è¿›è¡Œç›¸åŠ æ“ä½œï¼Œä¸è¿‡é€šè¿‡ä¸€ä¸ª Supplier ç»™å‡ºäº†åˆå§‹å€¼ä¸º 10ï¼Œæ‰€ä»¥ç»“æžœä¸º 65ã€‚mergemergeæ“ä½œç¬¦ç”¨æ¥æŠŠå¤šä¸ªæµåˆå¹¶æˆä¸€ä¸ª Flux åºåˆ—ï¼š1234Flux.merge( Flux.interval(Duration.of(500, ChronoUnit.MILLIS)).take(2), Flux.interval(Duration.of(500, ChronoUnit.MILLIS)).take(2)).toStream().forEach(System.out::println);è¾“å‡º 0 0 1 1ã€‚bufferç›´æŽ¥çœ‹ä¾‹å­å§ï¼š123Flux.range(1, 100).buffer(20).subscribe(System.out::println);Flux.range(1, 10).bufferUntil(i -&gt; i % 2 == 0).subscribe(System.out::println);Flux.range(1, 10).bufferWhile(i -&gt; i % 2 == 0).subscribe(System.out::println);è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼šç±»ä¼¼äºŽæ•°æ®æµåˆ†åŒºã€‚zipWithå°†ä¸¤ä¸ªæµçš„å…ƒç´ å®‰è£…å…ƒç´ ä½ç½®ä¸€ä¸€ç»„åˆï¼š123Flux.just("a", "b", "c", "d") .zipWith(Flux.just("e", "f", "g", "h", "i")) .subscribe(System.out::println);è¾“å‡ºï¼šæ²¡æœ‰é…å¯¹ä¸Šçš„è¢«ä¸¢å¼ƒã€‚å¦å¤–ä¸€ä¸ªä¾‹å­ï¼š123Flux.just("a", "b", "c", "d") .zipWith(Flux.just("e", "f", "g", "h", "i"), (s1, s2) -&gt; String.format("%s-%s", s1, s2)) .subscribe(System.out::println);è¾“å‡ºå¦‚ä¸‹:flatMapæŠŠæµä¸­çš„æ¯ä¸ªå…ƒç´ è½¬æ¢æˆä¸€ä¸ªæµï¼Œå†æŠŠæ‰€æœ‰æµä¸­çš„å…ƒç´ è¿›è¡Œåˆå¹¶ã€‚æ¯”å¦‚ï¼š123Flux.just(5, 10).flatMap( x -&gt; Flux.range(1, x).take(x) ).subscribe(System.out::println);ç»ˆç«¯å¤„ç†é€šè¿‡subscribe()æ–¹æ³•å¤„ç†æ­£å¸¸å’Œé”™è¯¯æ¶ˆæ¯ï¼š123Flux.just(1, 2) .concatWith(Mono.error(new IllegalStateException())) .subscribe(System.out::println, System.err::println);è¾“å‡º:12312java.lang.IllegalStateExceptionå‡ºçŽ°é”™è¯¯æ—¶è¿”å›žé»˜è®¤å€¼ï¼š1234Flux.just(1, 2) .concatWith(Mono.error(new IllegalStateException())) .onErrorReturn(0) .subscribe(System.out::println);è¾“å‡ºï¼š123120å‡ºçŽ°é”™è¯¯æ—¶ä½¿ç”¨å¦å¤–çš„æµï¼š12345678910Flux.just(1, 2) .concatWith(Mono.error(new IllegalArgumentException())) .onErrorResume(e -&gt; &#123; if (e instanceof IllegalStateException) &#123; return Mono.just(0); &#125; else if (e instanceof IllegalArgumentException) &#123; return Mono.just(-1); &#125; return Mono.empty(); &#125;).subscribe(System.out::println);è¾“å‡ºå¦‚ä¸‹:12312-1æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/57.Spring-Boot-WebFluxå‚è€ƒé“¾æŽ¥:https://docs.spring.io/spring/docs/current/spring-framework-reference/web-reactive.html#spring-webfluxhttps://developer.mozilla.org/zh-CN/docs/Server-sent_events/Using_server-sent_eventshttp://www.ruanyifeng.com/blog/2017/05/server-sent_events.htmlhttps://projectreactor.io/docs/core/release/reference/#fluxhttps://www.ibm.com/developerworks/cn/java/j-cn-with-reactor-response-encode/index.html]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
        <tag>WebFlux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootæ•´åˆMongo DB]]></title>
    <url>%2FSpring-Boot-Mongo-DB-CRUD.html</url>
    <content type="text"><![CDATA[è¿™èŠ‚æˆ‘ä»¬å°†æ•´åˆSpring Bootä¸ŽMongo DBå®žçŽ°å¢žåˆ æ”¹æŸ¥çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å®žçŽ°åºåˆ—é€’å¢žã€‚Mongo DBä¸‹è½½åœ°å€ï¼šhttps://www.mongodb.com/download-center/communityã€‚Mongo DBçš„åŸºæœ¬ä»‹ç»å’Œå¢žåˆ æ”¹æŸ¥çš„ç”¨æ³•å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« ï¼š MongoDB shell ã€ MongoDBæ–‡æ¡£CUD å’Œ MongoDB æ–‡æ¡£æŸ¥è¯¢ ã€‚æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.1.3.RELEASEï¼Œå¹¶å¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽå¯ä»¥é€šè¿‡Mongo Shellæˆ–è€…Mongo Compasså·¥å…·åˆ›å»ºä¸€ä¸ªåç§°ä¸ºtestdbçš„æ•°æ®åº“ï¼Œå¹¶æ–°å¢žuseræ–‡æ¡£ï¼ˆæ–‡æ¡£ï¼Œç±»ä¼¼ä¸Žå…³ç³»åž‹æ•°æ®åº“é‡Œçš„æ•°æ®è¡¨ï¼‰ï¼šåœ¨é…ç½®æ–‡ä»¶application.ymlé‡Œé…ç½®Mongo DBï¼š123456spring: data: mongodb: host: localhost port: 27017 database: testdbMongo DBçš„é»˜è®¤ç«¯å£ä¸º27017ï¼Œä½¿ç”¨çš„æ•°æ®åº“ä¸ºåˆšåˆšåˆ›å»ºçš„testdbã€‚åˆ›å»ºUserå®žä½“ç±»ï¼š1234567891011121314@Document(collection = "user")public class User &#123; @Id private String id; private String name; private Integer age; private String description; // get set ç•¥&#125;@Document(collection = &quot;user&quot;)è¡¨æ˜Žè¿™æ˜¯ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡ï¼Œåç§°ä¸ºuserï¼Œå¯¹åº”Mongo DBé‡Œçš„userè¡¨ã€‚@Idæ ‡æ³¨ä¸»é”®å­—æ®µï¼ŒStringç±»åž‹çš„ä¸»é”®å€¼åœ¨æ’å…¥çš„æ—¶å€™Mongo DBä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆã€‚å¦‚æžœå¯¹è±¡ä¸­çš„æŸä¸ªå±žæ€§ä¸ºéžè¡¨å­—æ®µï¼Œå¯ä»¥ä½¿ç”¨æ³¨è§£@Transientè¿›è¡ŒæŽ’é™¤ã€‚å‡†å¤‡å¥½è¿™äº›åŽï¼Œæˆ‘ä»¬å¼€å§‹ç¼–å†™ä¸€äº›ç®€å•çš„å¢žåˆ æ”¹æŸ¥æ ·ä¾‹ã€‚ç®€å•å¢žåˆ æ”¹æŸ¥åˆ›å»ºä¸€ä¸ªUserDaoæŽ¥å£ï¼š123@Repositorypublic interface UserDao extends MongoRepository&lt;User, String&gt; &#123;&#125;æŽ¥å£ç»§æ‰¿è‡ªMongoRepositoryï¼Œæ³›åž‹åˆ†åˆ«ä¸ºå®žä½“å¯¹è±¡å’Œä¸»é”®ç±»åž‹ã€‚é€šè¿‡ç»§æ‰¿MongoRepositoryï¼ŒUserDaoåŒ…å«äº†ä¸€äº›å¢žåˆ æ”¹æŸ¥çš„æ–¹æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šæŽ¥ç€ç¼–å†™UserServiceï¼Œä¸ºäº†æ–¹ä¾¿è¿™é‡Œä¸å†ç¼–å†™æŽ¥å£ï¼š12345678910111213141516171819202122232425262728293031323334353637383940@Servicepublic class UserService &#123; @Autowired private UserDao userDao; public List&lt;User&gt; getUsers() &#123; return userDao.findAll(); &#125; public Optional&lt;User&gt; getUser(String id) &#123; return this.userDao.findById(id); &#125; /** * æ–°å¢žå’Œä¿®æ”¹éƒ½æ˜¯ saveæ–¹æ³•ï¼Œ * id å­˜åœ¨ä¸ºä¿®æ”¹ï¼Œid ä¸å­˜åœ¨ä¸ºæ–°å¢ž */ public User createUser(User user) &#123; user.setId(null); return userDao.save(user); &#125; public void deleteUser(String id) &#123; this.userDao.findById(id) .ifPresent(user -&gt; this.userDao.delete(user)); &#125; public void updateUser(String id, User user) &#123; this.userDao.findById(id) .ifPresent( u -&gt; &#123; u.setName(user.getName()); u.setAge(user.getAge()); u.setDescription(user.getDescription()); this.userDao.save(u); &#125; ); &#125;&#125;ä¸Šé¢æˆ‘ä»¬ç¼–å†™äº†åŸºæœ¬çš„å¢žåˆ æ”¹æŸ¥æ ·ä¾‹ï¼Œæ–°å¢žå’Œä¿®æ”¹éƒ½æ˜¯é€šè¿‡saveæ–¹æ³•å®Œæˆçš„ï¼Œå½“ä¸»é”®å­˜åœ¨æ—¶åˆ™ä¸ºä¿®æ”¹ï¼Œä¸»é”®ä¸å­˜åœ¨åˆ™ä¸ºæ–°å¢žã€‚æœ€åŽç¼–å†™ä¸€ä¸ªRESTfulçš„UserControllerï¼ˆä¸ºäº†æ–¹ä¾¿ï¼Œæ²¡æœ‰å¯¹å‚æ•°è¿›è¡Œæ ¡éªŒï¼‰ï¼š123456789101112131415161718192021222324252627282930313233343536@RestController@RequestMapping("user")public class UserController &#123; @Autowired private UserService userService; @GetMapping public List&lt;User&gt; getUsers() &#123; return userService.getUsers(); &#125; @PostMapping public User createUser(User user) &#123; return userService.createUser(user); &#125; @DeleteMapping("/&#123;id&#125;") public void deleteUser(@PathVariable String id) &#123; userService.deleteUser(id); &#125; @PutMapping("/&#123;id&#125;") public void updateUser(@PathVariable String id, User user) &#123; userService.updateUser(id, user); &#125; /** * æ ¹æ®ç”¨æˆ· idæŸ¥æ‰¾ * å­˜åœ¨è¿”å›žï¼Œä¸å­˜åœ¨è¿”å›ž null */ @GetMapping("/&#123;id&#125;") public User getUser(@PathVariable String id) &#123; return userService.getUser(id).orElse(null); &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼Œä½¿ç”¨postmanæ¥æµ‹è¯•æŽ¥å£çš„å¯ç”¨æ€§ã€‚æµ‹è¯•æ–°å¢žç”¨æˆ·ï¼šæ–°å¢žæˆåŠŸï¼ŒæŸ¥çœ‹æ•°æ®åº“ï¼šæµ‹è¯•æŸ¥è¯¢ç”¨æˆ·ï¼šæŸ¥è¯¢æˆåŠŸã€‚æµ‹è¯•é€šè¿‡ç”¨IDæŸ¥æ‰¾ç”¨æˆ·ï¼šæ›´æ–°ç”¨æˆ·ï¼šæŸ¥çœ‹æ•°æ®åº“æ˜¯å¦æ›´æ–°æˆåŠŸï¼šæ›´æ–°æˆåŠŸã€‚æœ€åŽæµ‹è¯•é€šè¿‡ç”¨æˆ·IDåˆ é™¤ç”¨æˆ·ï¼šè¿”å›žçŠ¶æ€ç 200ï¼Œåˆ é™¤æˆåŠŸã€‚æŸ¥çœ‹æ•°æ®åº“ï¼Œåˆ é™¤æˆåŠŸï¼šå¤šæ¡ä»¶æŸ¥è¯¢å…¶å®žUserDaoé€šè¿‡ç»§æ‰¿MongoRepositoryå·²ç»å…·æœ‰äº†JPAçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ–¹æ³•åæ¥æž„å»ºå¤šæŸ¥è¯¢æ¡ä»¶çš„SQLã€‚æ¯”å¦‚é€šè¿‡ç”¨æˆ·çš„å¹´é¾„æ®µæ¥æŸ¥è¯¢ï¼š123456789101112@Repositorypublic interface UserDao extends MongoRepository&lt;User, String&gt; &#123; /** * æ ¹æ®å¹´é¾„æ®µæ¥æŸ¥æ‰¾ * * @param from from * @param to to * @return List&lt;User&gt; */ List&lt;User&gt; findByAgeBetween(Integer from, Integer to);&#125;åœ¨è¾“å…¥findByåŽï¼ŒIDEAä¼šæ ¹æ®å®žä½“å¯¹è±¡çš„å±žæ€§å’ŒSQLçš„å„ç§å…³é”®å­—è‡ªåŠ¨ç»„åˆæç¤ºï¼šæ¯”å¦‚å†åœ¨åˆ›å»ºä¸€ä¸ªé€šè¿‡å¹´é¾„æ®µï¼Œç”¨æˆ·åå’Œæè¿°ï¼ˆæ¨¡ç³ŠæŸ¥è¯¢ï¼‰æŸ¥è¯¢ç”¨æˆ·çš„æ–¹æ³•ï¼š12345678910/** * é€šè¿‡å¹´é¾„æ®µï¼Œç”¨æˆ·åï¼Œæè¿°ï¼ˆæ¨¡ç³ŠæŸ¥è¯¢ï¼‰ * * @param from from * @param to to * @param name name * @param description description * @return List&lt;User&gt; */List&lt;User&gt; findByAgeBetweenAndNameEqualsAndDescriptionIsLike(Integer from, Integer to, String name, String description);æ–¹æ³•å‚æ•°ä¸ªæ•°éœ€è¦å’Œæ–¹æ³•åä¸­æ‰€éœ€è¦çš„å‚æ•°ä¸ªæ•°å¯¹åº”ä¸Šã€‚æŽ’åºä¸Žåˆ†é¡µæŽ’åºå’Œåˆ†é¡µéœ€è¦ä½¿ç”¨MongoTemplateå¯¹è±¡æ¥å®Œæˆï¼Œåœ¨UserServiceé‡Œæ–°å¢žä¸€ä¸ªgetUserByConditionæ–¹æ³•ï¼š12345678910111213141516171819202122@Autowiredprivate MongoTemplate template;public Page&lt;User&gt; getUserByCondition(int size, int page, User user) &#123; Query query = new Query(); Criteria criteria = new Criteria(); if (!StringUtils.isEmpty(user.getName())) &#123; criteria.and("name").is(user.getName()); &#125; if (!StringUtils.isEmpty(user.getDescription())) &#123; criteria.and("description").regex(user.getDescription()); &#125; query.addCriteria(criteria); Sort sort = new Sort(Sort.Direction.DESC, "age"); Pageable pageable = PageRequest.of(page, size, sort); List&lt;User&gt; users = template.find(query.with(pageable), User.class); return PageableExecutionUtils.getPage(users, pageable, () -&gt; template.count(query, User.class));&#125;sizeè¡¨ç¤ºæ¯é¡µæ˜¾ç¤ºçš„æ¡æ•°ï¼Œpageè¡¨ç¤ºå½“å‰é¡µç æ•°ï¼Œ0è¡¨ç¤ºç¬¬ä¸€é¡µã€‚ä¸Šé¢çš„æ–¹æ³•é€šè¿‡nameå’Œdescriptionï¼ˆæ¨¡ç³ŠæŸ¥è¯¢ï¼‰æ¥æŸ¥è¯¢ç”¨æˆ·åˆ†é¡µä¿¡æ¯ï¼Œå¹¶ä¸”æŸ¥è¯¢ç»“æžœä½¿ç”¨ageå­—æ®µé™åºæŽ’åºã€‚æ–¹æ³•è¿”å›žPageå¯¹è±¡ã€‚åœ¨UserControlleré‡Œæ·»åŠ ï¼š1234@GetMapping("/condition")public Page&lt;User&gt; getUserByCondition(int size, int page, User user) &#123; return userService.getUserByCondition(size, page, user);&#125;é‡å¯é¡¹ç›®ï¼Œæˆ‘ä»¬å¾€æ•°æ®åº“é‡Œå¤šåŠ å‡ æ¡æ•°æ®ï¼šèŽ·å–ç¬¬1é¡µæ•°æ®ï¼Œæ¯é¡µæ˜¾ç¤º10æ¡ï¼šè¿”å›žæ•°æ®ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&#123; "content": [ &#123; "id": "5ca56ae2f08f0b6048fd470d", "name": "jane", "age": 26, "description": "web developer" &#125;, &#123; "id": "5ca56ad1f08f0b6048fd470c", "name": "scott", "age": 23, "description": "ui designer" &#125;, &#123; "id": "5ca56afaf08f0b6048fd470e", "name": "mike", "age": 21, "description": "python developer" &#125;, &#123; "id": "5ca56b38f08f0b6048fd470f", "name": "mrbird", "age": 18, "description": "java noob" &#125; ], "pageable": &#123; "sort": &#123; "sorted": true, "unsorted": false, "empty": false &#125;, "offset": 0, "pageSize": 10, "pageNumber": 0, "unpaged": false, "paged": true &#125;, "last": true, "totalPages": 1, "totalElements": 4, "number": 0, "size": 10, "sort": &#123; "sorted": true, "unsorted": false, "empty": false &#125;, "numberOfElements": 4, "first": true, "empty": false&#125;å‰©ä¸‹å¯ä»¥è‡ªå·±æµ‹è¯•ã€‚postmanæµ‹è¯•æ ·ä¾‹åŠæºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/56.Spring-Boot-MongoDB-crud]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java 9 Flow API å­¦ä¹ ]]></title>
    <url>%2FJava-9-Flow-API-Learn.html</url>
    <content type="text"><![CDATA[å“åº”å¼ç¼–ç¨‹ï¼ˆReactive Programmingï¼‰å¯ä»¥ç†è§£ä¸ºä¸€ç§å¤„ç†æ•°æ®é¡¹ï¼ˆData Itemï¼‰çš„å¼‚æ­¥æµï¼Œå³åœ¨æ•°æ®é¡¹äº§ç”Ÿçš„æ—¶å€™ï¼ŒæŽ¥æ”¶è€…å°±å¯¹å…¶è¿›è¡Œå“åº”ã€‚åœ¨å“åº”å¼ç¼–ç¨‹ä¸­ï¼Œä¼šæœ‰ä¸€ä¸ªæ•°æ®å‘å¸ƒè€…ï¼ˆPublisherï¼‰å’Œæ•°æ®è®¢é˜…è€…ï¼ˆSubscriberï¼‰ï¼ŒåŽè€…ç”¨äºŽå¼‚æ­¥æŽ¥æ”¶å‘å¸ƒè€…å‘å¸ƒçš„æ•°æ®ã€‚åœ¨è¯¥æ¨¡å¼ä¸­ï¼Œè¿˜å¼•å…¥äº†ä¸€ä¸ªæ›´é«˜çº§çš„ç‰¹æ€§ï¼šæ•°æ®å¤„ç†å™¨ï¼ˆProcessorï¼‰ï¼Œå®ƒç”¨äºŽå°†æ•°æ®å‘å¸ƒè€…å‘å¸ƒçš„æ•°æ®è¿›è¡ŒæŸäº›è½¬æ¢æ“ä½œï¼Œç„¶åŽå†å‘å¸ƒç»™æ•°æ®è®¢é˜…è€…ã€‚æ€»ä¹‹ï¼Œå“åº”å¼ç¼–ç¨‹æ˜¯å¼‚æ­¥éžé˜»å¡žç¼–ç¨‹ï¼Œèƒ½å¤Ÿæå‡ç¨‹åºæ€§èƒ½ï¼Œå¯ä»¥è§£å†³ä¼ ç»Ÿç¼–ç¨‹æ¨¡åž‹é‡åˆ°çš„å›°å¢ƒã€‚åŸºäºŽè¿™ä¸ªæ¨¡åž‹å®žçŽ°çš„æœ‰Java 9 Flow APIã€RxJavaå’ŒReactorç­‰ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»çš„æ˜¯Java 9 Flow APIçš„ä½¿ç”¨ã€‚FlowæŽ¥å£æ¦‚è§ˆJava 9 æ–°å¢žäº†ä¸€ä¸ªFlowæŽ¥å£ï¼Œä½äºŽjava.util.concurrentè·¯å¾„ä¸‹ï¼Œæž„æˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå…¶ä¸­Publisherä¸ºæ•°æ®å‘å¸ƒè€…ï¼ŒSubscriberä¸ºæ•°æ®è®¢é˜…è€…ï¼ŒSubscriptionä¸ºå‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´çš„è®¢é˜…å…³ç³»ï¼ŒProcessorä¸ºæ•°æ®å¤„ç†å™¨ã€‚PublisherPublisheréƒ¨åˆ†çš„æºç å¦‚ä¸‹æ‰€ç¤º:å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°å¼æŽ¥å£ï¼ŒåªåŒ…å«ä¸€ä¸ªsubscribeæ–¹æ³•ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•å°†æ•°æ®å‘å¸ƒå‡ºåŽ»ã€‚SubscriberSubscriberéƒ¨åˆ†çš„æºç å¦‚ä¸‹æ‰€ç¤º: è¯¥æŽ¥å£åŒ…å«äº†å››ä¸ªæ–¹æ³•ï¼šæ–¹æ³•æè¿°onSubscribeè®¢é˜…æˆåŠŸçš„å›žè°ƒæ–¹æ³•ï¼Œç”¨äºŽåˆå§‹åŒ–Subscriptionï¼Œå¹¶ä¸”è¡¨æ˜Žå¯ä»¥å¼€å§‹æŽ¥æ”¶è®¢é˜…æ•°æ®äº†onNextæŽ¥æ”¶ä¸‹ä¸€é¡¹è®¢é˜…æ•°æ®çš„å›žè°ƒæ–¹æ³•onErroråœ¨Publisheræˆ–Subcriberé‡åˆ°ä¸å¯æ¢å¤çš„é”™è¯¯æ—¶è°ƒç”¨æ­¤æ–¹æ³•ï¼ŒSubscriberä¸å†æŽ¥æ”¶è®¢é˜…æ¶ˆæ¯onCompleteå½“æŽ¥æ”¶å®Œæ‰€æœ‰è®¢é˜…æ•°æ®ï¼Œå¹¶ä¸”å‘å¸ƒè€…å·²ç»å…³é—­åŽä¼šå›žè°ƒè¿™ä¸ªæ–¹æ³•SubscriptionSubscriptionéƒ¨åˆ†çš„æºç å¦‚ä¸‹æ‰€ç¤ºï¼šè¯¥æŽ¥å£åŒ…å«äº†ä¸¤ä¸ªæ–¹æ³•ï¼šæ–¹æ³•æè¿°requestç”¨äºŽå‘æ•°æ®å‘å¸ƒè€…è¯·æ±‚nä¸ªæ•°æ®é¡¹cancelå–æ¶ˆæ¶ˆæ¯è®¢é˜…ï¼Œè®¢é˜…è€…å°†ä¸å†æŽ¥æ”¶æ•°æ®ProcessorProcessoréƒ¨åˆ†çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼šå®ƒæ˜¯ä¸€ä¸ªç©ºæŽ¥å£ï¼Œä½†æ˜¯å®ƒç»§æ‰¿äº†Publisherå’ŒSubscriberï¼Œæ‰€ä»¥å®ƒæ—¢èƒ½å‘å¸ƒæ•°æ®ä¹Ÿèƒ½è®¢é˜…æ•°æ®ã€‚åŸºäºŽè¿™ä¸ªç‰¹æ€§ï¼Œå®ƒå¯ä»¥å……å½“æ•°æ®è½¬æ¢çš„è§’è‰²ï¼Œå…ˆä»Žæ•°æ®å‘å¸ƒè€…é‚£æŽ¥æ”¶æ•°æ®é¡¹ï¼Œç„¶åŽç»è¿‡å¤„ç†åŽå†å‘å¸ƒç»™æœ€ç»ˆçš„æ•°æ®è®¢é˜…è€…ã€‚å‘å¸ƒè®¢é˜…ç¤ºä¾‹æŽ¥ä¸‹æ¥æˆ‘ä»¬ä¸¾ä¸ªæ•°æ®å‘å¸ƒå’Œæ•°æ®è®¢é˜…çš„ç®€å•ç¤ºä¾‹ï¼Œä»¥æ­¤äº†è§£Java 9 Flow APIçš„ä½¿ç”¨ã€‚å…ˆå…¥ä¸ºä¸»ï¼Œç›´æŽ¥è´´å‡ºæ•´ä¸ªç¤ºä¾‹ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667public class FlowApiTest &#123; public static void main(String[] args) throws InterruptedException &#123; // 1. å®šä¹‰ String ç±»åž‹çš„æ•°æ®å‘å¸ƒè€…ï¼ŒJDK 9è‡ªå¸¦çš„ // SubmissionPublisher å®žçŽ°äº† Publisher SubmissionPublisher&lt;String&gt; publisher = new SubmissionPublisher&lt;&gt;(); // 2. åˆ›å»ºä¸€ä¸ªè®¢é˜…è€…ï¼Œç”¨äºŽæŽ¥æ”¶å‘å¸ƒè€…çš„æ¶ˆæ¯ Subscriber&lt;String&gt; subscriber = new Subscriber&lt;&gt;() &#123; private Subscription subscription; @Override public void onSubscribe(Subscription subscription) &#123; // é€šè¿‡ Subscription å’Œå‘å¸ƒè€…ä¿æŒè®¢é˜…å…³ç³»ï¼Œå¹¶ç”¨å®ƒæ¥ç»™å‘å¸ƒè€…åé¦ˆ this.subscription = subscription; // è¯·æ±‚ä¸€ä¸ªæ•°æ® this.subscription.request(1); &#125; @Override public void onNext(String item) &#123; // æŽ¥æ”¶å‘å¸ƒè€…å‘å¸ƒçš„æ¶ˆæ¯ System.out.println("ã€è®¢é˜…è€…ã€‘æŽ¥æ”¶æ¶ˆæ¯ &lt;------ " + item); // æŽ¥æ”¶åŽå†æ¬¡è¯·æ±‚ä¸€ä¸ªæ•°æ® this.subscription.request(1); // å¦‚æžœä¸æƒ³å†æŽ¥æ”¶æ•°æ®ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥è°ƒç”¨ cancelï¼Œè¡¨ç¤ºä¸å†æŽ¥æ”¶äº† // this.subscription.cancel(); &#125; @Override public void onError(Throwable throwable) &#123; // è¿‡ç¨‹ä¸­å‡ºçŽ°å¼‚å¸¸ä¼šå›žè°ƒè¿™ä¸ªæ–¹æ³• System.out.println("ã€è®¢é˜…è€…ã€‘æ•°æ®æŽ¥æ”¶å‡ºçŽ°å¼‚å¸¸ï¼Œ" + throwable); // å‡ºçŽ°å¼‚å¸¸ï¼Œå–æ¶ˆè®¢é˜…ï¼Œå‘Šè¯‰å‘å¸ƒè€…æˆ‘ä¸å†æŽ¥æ”¶æ•°æ®äº† // å®žé™…æµ‹è¯•å‘çŽ°ï¼Œåªè¦è®¢é˜…è€…æŽ¥æ”¶æ¶ˆæ¯å‡ºçŽ°å¼‚å¸¸ï¼Œè¿›å…¥äº†è¿™ä¸ªå›žè°ƒ // è®¢é˜…è€…å°±ä¸ä¼šå†ç»§ç»­æŽ¥æ”¶æ¶ˆæ¯äº† this.subscription.cancel(); &#125; @Override public void onComplete() &#123; // å½“å‘å¸ƒè€…å‘å‡ºçš„æ•°æ®éƒ½è¢«æŽ¥æ”¶äº†ï¼Œ // å¹¶ä¸”å‘å¸ƒè€…å…³é—­åŽï¼Œä¼šå›žè°ƒè¿™ä¸ªæ–¹æ³• System.out.println("ã€è®¢é˜…è€…ã€‘æ•°æ®æŽ¥æ”¶å®Œæ¯•"); &#125; &#125;; // 3. å‘å¸ƒè€…å’Œè®¢é˜…è€…éœ€è¦å»ºç«‹å…³ç³» publisher.subscribe(subscriber); // 4. å‘å¸ƒè€…å¼€å§‹å‘å¸ƒæ•°æ® for (int i = 0; i &lt; 10; i++) &#123; String message = "hello flow api " + i; System.out.println("ã€å‘å¸ƒè€…ã€‘å‘å¸ƒæ¶ˆæ¯ ------&gt; " + message); publisher.submit(message); &#125; // 5. å‘å¸ƒç»“æŸåŽï¼Œå…³é—­å‘å¸ƒè€… publisher.close(); // mainçº¿ç¨‹å»¶è¿Ÿå…³é—­ï¼Œä¸ç„¶è®¢é˜…è€…è¿˜æ²¡æŽ¥æ”¶å®Œæ¶ˆæ¯ï¼Œçº¿ç¨‹å°±è¢«å…³é—­äº† Thread.currentThread().join(2000); &#125;&#125;ä¸Šé¢ä½¿ç”¨JDK è‡ªå¸¦çš„Publisherå®žçŽ°ç±»SubmissionPublisheræ¥å‘å¸ƒ Stringç±»åž‹çš„æ•°æ®ï¼Œç„¶åŽç”¨åŒ¿åå®žçŽ°ç±»çš„æ–¹å¼åˆ›å»ºäº†ä¸€ä¸ªSubscriberå®žçŽ°ç±»ã€‚æŽ¥ç€ä½¿ç”¨SubmissionPublisherçš„subscribeæ–¹æ³•æ¥ä¸ºå‘å¸ƒè€…å’Œè®¢é˜…è€…å»ºç«‹å…³ç³»ã€‚å»ºç«‹å…³ç³»åŽï¼Œå‘å¸ƒè€…å°±å¯ä»¥å‘å¸ƒæ•°æ®ï¼ŒæŽ¥æ”¶è€…ä¹Ÿå¼€å§‹æŽ¥æ”¶æ•°æ®ã€‚è¯¦ç»†çš„è¯´æ˜Žæ³¨é‡Šé‡Œéƒ½å†™äº†ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ä»£ç çš„é€»è¾‘äº†ã€‚ç¨‹åºçš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼šæ¨¡æ‹ŸèƒŒåŽ‹æ‰€è°“çš„èƒŒåŽ‹ï¼ˆBackpressureï¼‰é€šä¿—çš„è®²å°±æ˜¯æ•°æ®æŽ¥æ”¶è€…çš„åŽ‹åŠ›ï¼Œä¼ ç»Ÿæ¨¡å¼ä¸‹ï¼Œå‘å¸ƒè€…åªå…³å¿ƒæ•°æ®çš„åˆ›é€ ä¸Žå‘å¸ƒï¼Œè€Œå½“æ•°æ®å‘å¸ƒé€ŸçŽ‡è¿œé«˜äºŽæ•°æ®æŽ¥æ”¶é€ŸçŽ‡çš„æ—¶å€™ï¼Œæ•°æ®æŽ¥æ”¶è€…ç¼“å†²åŒºå°†è¢«å¡«æ»¡ï¼Œæ— æ³•å†æŽ¥æ”¶æ•°æ®ã€‚å‘å¸ƒè€…å¹¶ä¸å…³å¿ƒè¿™äº›ï¼Œä¾æ—§ä¸æ–­åœ°å‘é€æ•°æ®ï¼Œæ‰€ä»¥å°±é€ æˆäº†IOé˜»å¡žã€‚åŸºäºŽå“åº”å¼æ¨¡åž‹å®žçŽ°çš„Flow APIå¯ä»¥å¾ˆå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åœ¨Java 9çš„Flow APIå®šä¹‰ä¸­ï¼ŒSubscriberä¼šå°†Publisherå‘å¸ƒçš„æ•°æ®ç¼“å†²åœ¨Subscriptionä¸­ï¼Œå…¶é•¿åº¦é»˜è®¤ä¸º256ï¼šå‡å¦‚å½“è¿™ä¸ªç¼“å†²åŒºéƒ½è¢«å¡«æ»¡åŽï¼ŒPublisherå°†ä¼šåœæ­¢å‘é€æ•°æ®ï¼Œç›´åˆ°SubscriberæŽ¥æ”¶äº†æ•°æ®Subscriptionæœ‰ç©ºé—²ä½ç½®çš„æ—¶å€™ï¼ŒPublisheræ‰ä¼šç»§ç»­å‘å¸ƒæ•°æ®ï¼Œè€Œéžä¸€å‘³åœ°å‘ä¸ªä¸åœã€‚ä¸‹é¢ç”¨ä»£ç æ¥æ¼”ç¤ºè¿™ä¸ªæƒ…å†µï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475public class FlowApiTest &#123; public static void main(String[] args) throws InterruptedException &#123; // 1. å®šä¹‰Stringç±»åž‹çš„æ•°æ®å‘å¸ƒè€…ï¼ŒJDK 9è‡ªå¸¦çš„ // SubmissionPublisherå®žçŽ°äº† Publisher SubmissionPublisher&lt;String&gt; publisher = new SubmissionPublisher&lt;&gt;(); // 2. åˆ›å»ºä¸€ä¸ªè®¢é˜…è€…ï¼Œç”¨äºŽæŽ¥æ”¶å‘å¸ƒè€…çš„æ¶ˆæ¯ Subscriber&lt;String&gt; subscriber = new Subscriber&lt;&gt;() &#123; private Subscription subscription; @Override public void onSubscribe(Subscription subscription) &#123; // é€šè¿‡ Subscription å’Œå‘å¸ƒè€…ä¿æŒè®¢é˜…å…³ç³»ï¼Œå¹¶ç”¨å®ƒæ¥ç»™å‘å¸ƒè€…åé¦ˆ this.subscription = subscription; // è¯·æ±‚ä¸€ä¸ªæ•°æ® this.subscription.request(1); &#125; @Override public void onNext(String item) &#123; // æŽ¥æ”¶å‘å¸ƒè€…å‘å¸ƒçš„æ¶ˆæ¯ System.out.println("ã€è®¢é˜…è€…ã€‘æŽ¥æ”¶æ¶ˆæ¯ &lt;------ " + item); // æ¨¡æ‹ŸæŽ¥æ”¶æ•°æ®ç¼“æ…¢ï¼Œè®©ç¼“å†²æ± å¡«æ»¡ try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; // æŽ¥æ”¶åŽå†æ¬¡è¯·æ±‚ä¸€ä¸ªæ•°æ®ï¼Œè¡¨ç¤ºæˆ‘å·²ç»å¤„ç†å®Œäº†ï¼Œä½ å¯ä»¥å†å‘æ•°æ®è¿‡æ¥äº† this.subscription.request(1); // å¦‚æžœä¸æƒ³å†æŽ¥æ”¶æ•°æ®ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥è°ƒç”¨cancelï¼Œè¡¨ç¤ºä¸å†æŽ¥æ”¶äº† // this.subscription.cancel(); &#125; @Override public void onError(Throwable throwable) &#123; // è¿‡ç¨‹ä¸­å‡ºçŽ°å¼‚å¸¸ä¼šå›žè°ƒè¿™ä¸ªæ–¹æ³• System.out.println("ã€è®¢é˜…è€…ã€‘æ•°æ®æŽ¥æ”¶å‡ºçŽ°å¼‚å¸¸ï¼Œ" + throwable); // å‡ºçŽ°å¼‚å¸¸ï¼Œå–æ¶ˆè®¢é˜…ï¼Œå‘Šè¯‰å‘å¸ƒè€…æˆ‘ä¸å†æŽ¥æ”¶æ•°æ®äº† // å®žé™…æµ‹è¯•å‘çŽ°ï¼Œåªè¦è®¢é˜…è€…æŽ¥æ”¶æ¶ˆæ¯å‡ºçŽ°å¼‚å¸¸ï¼Œè¿›å…¥äº†è¿™ä¸ªå›žè°ƒ // è®¢é˜…è€…å°±ä¸ä¼šå†ç»§ç»­æŽ¥æ”¶æ¶ˆæ¯äº† this.subscription.cancel(); &#125; @Override public void onComplete() &#123; // å½“å‘å¸ƒè€…å‘å‡ºçš„æ•°æ®éƒ½è¢«æŽ¥æ”¶äº†ï¼Œ // å¹¶ä¸”å‘å¸ƒè€…å…³é—­åŽï¼Œä¼šå›žè°ƒè¿™ä¸ªæ–¹æ³• System.out.println("ã€è®¢é˜…è€…ã€‘æ•°æ®æŽ¥æ”¶å®Œæ¯•"); &#125; &#125;; // 3. å‘å¸ƒè€…å’Œè®¢é˜…è€…éœ€è¦å»ºç«‹å…³ç³» publisher.subscribe(subscriber); // 4. å‘å¸ƒè€…å¼€å§‹å‘å¸ƒæ•°æ® for (int i = 0; i &lt; 500; i++) &#123; String message = "hello flow api " + i; System.out.println("ã€å‘å¸ƒè€…ã€‘å‘å¸ƒæ¶ˆæ¯ ------&gt; " + message); publisher.submit(message); &#125; // 5. å‘å¸ƒç»“æŸåŽï¼Œå…³é—­å‘å¸ƒè€… publisher.close(); // mainçº¿ç¨‹å»¶è¿Ÿå…³é—­ï¼Œä¸ç„¶è®¢é˜…è€…è¿˜æ²¡æŽ¥æ”¶å®Œæ¶ˆæ¯ï¼Œçº¿ç¨‹å°±è¢«å…³é—­äº† Thread.currentThread().join(20000); &#125;&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨Subscriberçš„onNextæ–¹æ³•ä¸­ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿå»¶è¿Ÿï¼Œè®©æ•°æ®å¤„ç†è¿‡ç¨‹ç»´æŒåœ¨2ç§’å·¦å³ï¼š12345try &#123; TimeUnit.SECONDS.sleep(2);&#125; catch (InterruptedException e) &#123; e.printStackTrace();&#125;ç„¶åŽæ•°æ®å‘å¸ƒé‡è°ƒæ•´åˆ°äº†500ï¼Œå½“ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œç”±äºŽæ•°æ®å‘å¸ƒçš„é€Ÿåº¦éžå¸¸å¿«ï¼ˆæ™®é€šforå¾ªçŽ¯ï¼‰ï¼Œæ‰€ä»¥æ•°æ®è®¢é˜…è€…çš„æ•°æ®ç¼“å†²åŒºçž¬é—´è¢«å¡«æ»¡ï¼ŒäºŽæ˜¯ä½ ä¼šçœ‹åˆ°ä¸‹é¢è¿™ä¸ªæƒ…å†µï¼Œåªæœ‰å½“æ•°æ®è®¢é˜…è€…å¤„ç†äº†ä¸€ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œæ•°æ®å‘å¸ƒè€…æ‰ä¼šç›¸åº”åœ°å†æ¬¡å‘å¸ƒä¸€ä¸ªæ–°æ•°æ®ï¼šProcessorç¤ºä¾‹Processorçš„ä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œå…¶å®žå®ƒå°±æ˜¯Publisherå’ŒSubscriberçš„ç»“åˆä½“ï¼Œå……å½“æ•°æ®å¤„ç†çš„è§’è‰²ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ç”¨å®ƒæ¥æŽ¥æ”¶å‘å¸ƒè€…å‘å¸ƒçš„æ¶ˆæ¯ï¼Œç„¶åŽè¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œå†å°†æ•°æ®å‘å¸ƒå‡ºåŽ»ï¼Œä¾›æ¶ˆæ¯è®¢é˜…è€…æŽ¥æ”¶ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªProcessorç”¨æ³•çš„ç®€å•ç¤ºä¾‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106public class FlowApiTest2 &#123; static class MyProcessor extends SubmissionPublisher&lt;String&gt; implements Processor&lt;String, String&gt; &#123; private Subscription subscription; @Override public void onSubscribe(Subscription subscription) &#123; // é€šè¿‡ Subscription å’Œå‘å¸ƒè€…ä¿æŒè®¢é˜…å…³ç³»ï¼Œå¹¶ç”¨å®ƒæ¥ç»™å‘å¸ƒè€…åé¦ˆ this.subscription = subscription; // è¯·æ±‚ä¸€ä¸ªæ•°æ® this.subscription.request(1); &#125; @Override public void onNext(String item) &#123; // æŽ¥æ”¶å‘å¸ƒè€…å‘å¸ƒçš„æ¶ˆæ¯ System.out.println("ã€å¤„ç†å™¨ã€‘æŽ¥æ”¶æ¶ˆæ¯ &lt;------ " + item); // å¤„ç†å™¨å°†æ¶ˆæ¯è¿›è¡Œè½¬æ¢ String newItem = "ã€å¤„ç†å™¨åŠ å·¥åŽçš„æ•°æ®: " + item + "ã€‘"; this.submit(newItem); // æŽ¥æ”¶åŽå†æ¬¡è¯·æ±‚ä¸€ä¸ªæ•°æ®ï¼Œè¡¨ç¤ºæˆ‘å·²ç»å¤„ç†å®Œäº†ï¼Œä½ å¯ä»¥å†å‘æ•°æ®è¿‡æ¥äº† this.subscription.request(1); // å¦‚æžœä¸æƒ³å†æŽ¥æ”¶æ•°æ®ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥è°ƒç”¨cancelï¼Œè¡¨ç¤ºä¸å†æŽ¥æ”¶äº† // this.subscription.cancel(); &#125; @Override public void onError(Throwable throwable) &#123; // è¿‡ç¨‹ä¸­å‡ºçŽ°å¼‚å¸¸ä¼šå›žè°ƒè¿™ä¸ªæ–¹æ³• System.out.println("ã€å¤„ç†å™¨ã€‘æ•°æ®æŽ¥æ”¶å‡ºçŽ°å¼‚å¸¸ï¼Œ" + throwable); // å‡ºçŽ°å¼‚å¸¸ï¼Œå–æ¶ˆè®¢é˜…ï¼Œå‘Šè¯‰å‘å¸ƒè€…æˆ‘ä¸å†æŽ¥æ”¶æ•°æ®äº† this.subscription.cancel(); &#125; @Override public void onComplete() &#123; System.out.println("ã€å¤„ç†å™¨ã€‘æ•°æ®å¤„ç†å®Œæ¯•"); // å¤„ç†å™¨å¤„ç†å®Œæ•°æ®åŽå…³é—­ this.close(); &#125; &#125; public static void main(String[] args) throws InterruptedException &#123; // 1. å®šä¹‰Stringç±»åž‹çš„æ•°æ®å‘å¸ƒè€…ï¼ŒJDK 9è‡ªå¸¦çš„ // SubmissionPublisherå®žçŽ°äº† Publisher SubmissionPublisher&lt;String&gt; publisher = new SubmissionPublisher&lt;&gt;(); // 2. åˆ›å»ºå¤„ç†å™¨ï¼Œç”¨äºŽæŽ¥æ”¶å‘å¸ƒè€…å‘å¸ƒçš„æ¶ˆæ¯ï¼Œ // è½¬æ¢åŽå†å‘é€ç»™è®¢é˜…è€… MyProcessor processor = new MyProcessor(); // 3. å‘å¸ƒè€…å’Œå¤„ç†å™¨å»ºç«‹è®¢é˜…çš„å…³ç³» publisher.subscribe(processor); // 4.åˆ›å»ºä¸€ä¸ªè®¢é˜…è€…ï¼Œç”¨äºŽæŽ¥æ”¶å¤„ç†å™¨çš„æ¶ˆæ¯ Subscriber&lt;String&gt; subscriber = new Subscriber&lt;&gt;() &#123; private Subscription subscription; @Override public void onSubscribe(Subscription subscription) &#123; this.subscription = subscription; this.subscription.request(1); &#125; @Override public void onNext(String item) &#123; System.out.println("ã€è®¢é˜…è€…ã€‘æŽ¥æ”¶æ¶ˆæ¯ &lt;------ " + item + ""); this.subscription.request(1); &#125; @Override public void onError(Throwable throwable) &#123; System.out.println("ã€è®¢é˜…è€…ã€‘æ•°æ®æŽ¥æ”¶å‡ºçŽ°å¼‚å¸¸ï¼Œ" + throwable); this.subscription.cancel(); &#125; @Override public void onComplete() &#123; System.out.println("ã€è®¢é˜…è€…ã€‘æ•°æ®æŽ¥æ”¶å®Œæ¯•"); &#125; &#125;; // 5. å¤„ç†å™¨å’Œè®¢é˜…è€…å»ºç«‹è®¢é˜…å…³ç³» processor.subscribe(subscriber); // 6. å‘å¸ƒè€…å¼€å§‹å‘å¸ƒæ•°æ® for (int i = 0; i &lt; 10; i++) &#123; String message = "hello flow api " + i; System.out.println("ã€å‘å¸ƒè€…ã€‘å‘å¸ƒæ¶ˆæ¯ ------&gt; " + message); publisher.submit(message); &#125; // 7. å‘å¸ƒç»“æŸåŽï¼Œå…³é—­å‘å¸ƒè€… publisher.close(); // mainçº¿ç¨‹å»¶è¿Ÿå…³é—­ï¼Œä¸ç„¶è®¢é˜…è€…è¿˜æ²¡æŽ¥æ”¶å®Œæ¶ˆæ¯ï¼Œçº¿ç¨‹å°±è¢«å…³é—­äº† Thread.currentThread().join(2000); &#125;&#125;ç¨‹åºè¿è¡Œç»“æžœå¦‚ä¸‹æ‰€ç¤ºï¼šå‚è€ƒæ–‡æ¡£ï¼šhttps://community.oracle.com/docs/DOC-1006738]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Java 9</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java 10 æ–°ç‰¹æ€§ä¹‹var]]></title>
    <url>%2FJava10-new-feature-var.html</url>
    <content type="text"><![CDATA[ä»Šå¹´3æœˆï¼ŒJava 10 å¦‚æœŸå‘å¸ƒï¼ŒJava 10 æ˜¯é‡‡ç”¨æ–°å‘å¸ƒå‘¨æœŸçš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œæä¾›äº† 109 é¡¹æ–°ç‰¹æ€§ï¼Œå…¶ä¸­æœ€å¤‡å—å…³æ³¨çš„èŽ«è¿‡äºŽå±€éƒ¨å˜é‡çš„ç±»åž‹æŽ¨æ–­ã€‚æ‰€ä»¥è¿™é‡Œä¸»è¦è®°å½•ä¸€ä¸‹è¿™ä¸ªç‰¹æ€§çš„ç”¨æ³•ã€‚çœ‹å‡ ä¸ªJava 10ä¹‹å‰å£°æ˜Žå˜é‡çš„ä¾‹å­:12345List&lt;String&gt; list = new ArrayList&lt;&gt;();Stream&lt;String&gt; stream = list.stream();InputStreamReader reader = new InputStreamReader(System.in);HttpClient httpClient = HttpClient.newHttpClient();åœ¨Java 10 ä¸­ï¼Œåªè¦æ˜¯ç¼–è¯‘å™¨èƒ½å¤Ÿé€šè¿‡å¯¹è±¡ç±»åž‹æ¥ç¡®å®šå˜é‡ç±»åž‹çš„æƒ…å†µä¸‹ï¼Œå˜é‡ç±»åž‹å£°æ˜Žå¯ä»¥ä½¿ç”¨varä¿ç•™å­—ä»£æ›¿ï¼š12345var list = new ArrayList&lt;&gt;();var stream = list.stream();var reader = new InputStreamReader(System.in);var httpClient = HttpClient.newHttpClient();å¼•å…¥è¿™ä¸ªç‰¹æ€§ä½¿å¾—æˆ‘ä»¬çš„Java ä»£ç å˜å¾—æ›´åŠ çš„ç®€æ´æ˜“è¯»ã€‚é™¤æ­¤ä¹‹å¤–æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å¢žå¼ºforå¾ªçŽ¯ä¸­ä½¿ç”¨varï¼š12345var list = new ArrayList&lt;&gt;();list.add("hello");list.add("java 10");for (var s : list) System.out.println(s);å½“ç„¶ï¼Œvarå¹¶ä¸æ˜¯åœ¨ä½•æ—¶ä½•åœ°éƒ½èƒ½ä½¿ç”¨ï¼Œç”¨äºŽå˜é‡å£°æ˜Žæ—¶ï¼Œä»…å±€é™äºŽå…·æœ‰æž„é€ å™¨çš„å˜é‡æˆ–åŸºæœ¬æ•°æ®ç±»åž‹ï¼Œæ¯”å¦‚ä¸‹é¢è¿™äº›ä¾‹å­ç¼–è¯‘æ˜¯ä¸é€šè¿‡çš„ï¼š1234var a;a = "hello world";var b = &#123;1, 2, 3&#125;;ç¼–è¯‘å™¨å°†ä¼šå‘Šè­¦ï¼š]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Java 10</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java 9 æ–°ç‰¹æ€§å­¦ä¹ ]]></title>
    <url>%2FJava-9-Feature.html</url>
    <content type="text"><![CDATA[åœ¨Java 8 å‘å¸ƒ3å¹´å¤šåŽï¼ŒJava 9 ç»ˆäºŽåœ¨2017å¹´9æœˆ21æ—¥æ­£å¼å‘å¸ƒã€‚Java 9 æä¾›äº†è¶…è¿‡150é¡¹æ–°åŠŸèƒ½ç‰¹æ€§ï¼ŒåŒ…æ‹¬å¤‡å—æœŸå¾…çš„æ¨¡å—åŒ–ç³»ç»Ÿã€ å¯äº¤äº’çš„REPLå·¥å…·jShellã€JDKç¼–è¯‘å·¥å…·ã€Javaå…¬å…±APIå’Œç§æœ‰ä»£ç ï¼Œä»¥åŠå®‰å…¨å¢žå¼ºã€æ‰©å±•æå‡å’Œæ€§èƒ½ç®¡ç†æ”¹å–„ç­‰ã€‚åœ¨å­¦ä¹ è¿™äº›æ–°ç‰¹æ€§ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—å…ˆå®‰è£…å¥½JDK 9ï¼ŒJDK 9 ä¸‹è½½åœ°å€ï¼šhttps://www.oracle.com/technetwork/cn/java/javase/downloads/jdk9-downloads-3848520-zhs.htmlã€‚æ¨¡å—åŒ–Java 9 ä¸­çš„æ¨¡å—åŒ–ï¼ˆModuleï¼‰ç±»ä¼¼äºŽES6ä¸­çš„æ¨¡å—åŒ–ï¼Œéƒ½æ˜¯ä¸ºäº†è§£å†³é¡¹ç›®ä¸­å‡å°‘å†…å­˜çš„å¼€é”€ï¼Œæä¾›å¯ç»´æŠ¤æ€§å’Œç³»ç»Ÿæ€§èƒ½è€Œæå‡ºçš„ã€‚é€šä¿—åœ°è¯´ï¼ŒJava 9 çš„æ¨¡å—åŒ–æœ¬è´¨ä¸Šå°±æ˜¯åœ¨åŒ…ï¼ˆpackageï¼‰ä¸Šå†åŒ…è£¹ä¸€å±‚ï¼ˆModuleï¼‰ï¼Œé»˜è®¤æ¨¡å—é‡Œçš„å†…å®¹éƒ½æ˜¯éšè—çš„ï¼Œåªèƒ½é€šè¿‡ï¼ˆexportsï¼‰å…³é”®å­—æ¥æš´éœ²æ¨¡å—é‡Œçš„å†…å®¹ï¼Œè€Œåˆ«çš„æ¨¡å—éœ€è¦ç”¨åˆ°è¿™äº›å†…å®¹åˆ™éœ€è¦ä½¿ç”¨ï¼ˆrequiresï¼‰å…³é”®å­—æ¥å¯¼å…¥ã€‚ä¸‹é¢æˆ‘ä»¬ç”¨ä»£ç æ¥æ¼”ç¤ºè¿™ä¸€ä¸ªæ–°ç‰¹æ€§ã€‚æ–°å»ºä¸€ä¸ªJava å·¥ç¨‹ï¼Œç„¶åŽåœ¨å·¥ç¨‹ä¸‹é¢åˆ›å»ºä¸€ä¸ªåä¸ºModuleOneçš„æ¨¡å—ï¼šåŒæ ·çš„ï¼Œæˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ªModuleTwoæ¨¡å—ï¼Œåˆ›å»ºå®ŒåŽé¡¹ç›®ç›®å½•å¦‚ä¸‹æ‰€ç¤ºï¼šæŽ¥ç€æˆ‘ä»¬åœ¨ModuleOneçš„srcç›®å½•ä¸‹åˆ›å»ºcc.mrbird.domainåŒ…ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªåä¸ºPersonçš„ç±»ï¼š1234567891011121314151617181920212223242526272829303132333435package cc.mrbird.domain;public class Person &#123; private String name; private int age; public Person(String name, int age) &#123; this.name = name; this.age = age; &#125; @Override public String toString() &#123; return "Person&#123;" + "name='" + name + '\'' + ", age=" + age + '&#125;'; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public int getAge() &#123; return age; &#125; public void setAge(int age) &#123; this.age = age; &#125;&#125;ç„¶åŽåœ¨ModuleTwoçš„srcç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªcc.mrbid.teståŒ…ï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªTestç±»ï¼Œç”¨äºŽå¾…ä¼šæµ‹è¯•ã€‚è‡³æ­¤ï¼Œå·¥ç¨‹ç›®å½•ç»“æž„å¦‚ä¸‹æ‰€ç¤º:æˆ‘ä»¬åœ¨ModuleTwoçš„Testç±»ä¸‹è¯•å›¾å¼•å…¥ModuleOneçš„Personç±»ï¼Œä¼šå‘çŽ°æ˜¯è¡Œä¸é€šçš„ï¼šæ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œæ¨¡å—é‡Œçš„ä¸œè¥¿é»˜è®¤éƒ½æ˜¯éšè—çš„ï¼Œè¦è®©å…¶å¯ä»¥è¢«åˆ«çš„æ¨¡å—ä½¿ç”¨ï¼Œéœ€è¦é€šè¿‡exportså…³é”®å­—æ¥æš´éœ²å®ƒä»¬ã€‚åœ¨ModuleOneæ¨¡å—ä¸‹çš„srcä¸Šå³é”®ï¼Œæ–°å»ºä¸€ä¸ªmodule-info.javaï¼šä»£ç å¦‚ä¸‹æ‰€ç¤º:1234module ModuleOne &#123; // å¯¼å‡ºåŒ… exports cc.mrbird.domain;&#125;ä¸Šé¢ä»£ç ä¸­å¯¼å‡ºäº†cc.mrbird.domainåŒ…ä¸‹çš„æ‰€æœ‰å†…å®¹ï¼Œå¯¹åˆ«çš„æ¨¡å—æ¥è¯´ï¼Œå®ƒä»¬æ˜¯å¯è§çš„äº†ã€‚ç„¶åŽåŒæ ·åœ°åœ¨ModuleTwoæ¨¡å—ä¸‹çš„srcä¸Šå³é”®ï¼Œä¹Ÿæ–°å»ºä¸€ä¸ªmodule-info.javaï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤º:1234module ModuleTwo &#123; // å¯¼å…¥æ¨¡å— requires ModuleOne;&#125;è¿™é‡Œæˆ‘ä»¬ä¸»è¦åšçš„æ˜¯å°†ModuleOneå¯¼å…¥è¿›æ¥ï¼Œæ‰€ä»¥å…¶æš´éœ²çš„cc.mrbird.domainåŒ…ä¸‹çš„å†…å®¹å°±å¯ä»¥åœ¨ModuleTwoä¸‹è¢«ä½¿ç”¨äº†ã€‚è¿™æ—¶å€™å›žåˆ°ModuleTwoæ¨¡å—ä¸‹çš„Testç±»ï¼ŒIDEAä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å¯¼å…¥éœ€è¦çš„ç±»ï¼Œä»£ç å°±ä¸ä¼šæŠ¥é”™äº†ï¼šæˆ‘ä»¬ç»§ç»­åœ¨Testç±»ä¸­åŠ å…¥ä¸€äº›å†…å®¹ï¼šä¸Šé¢æˆ‘ä»¬ä½¿ç”¨äº†java.util.logging.Loggeræ¥æ‰“å°æ—¥å¿—ï¼Œä½†æ˜¯ä»£ç ç¼–è¯‘æ˜¯ä¸é€šè¿‡çš„ï¼Œä½¿ç”¨Alt+Enterå¿«æ·é”®åŽé€‰æ‹©ç¬¬ä¸€é¡¹ï¼ŒIDEAä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åœ¨module-info.javaæ–‡ä»¶ä¸­å¯¼å…¥éœ€è¦çš„åŒ…ï¼Œéžå¸¸æ–¹ä¾¿ã€‚å¯¼å…¥åŽï¼Œmodule-info.javaä¸‹çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š12345module ModuleTwo &#123; // å¯¼å…¥æ¨¡å— requires ModuleOne; requires java.logging;&#125;æ€»çš„æ¥è¯´ï¼Œé€šè¿‡æ¨¡å—åŒ–æ¥æž„å»ºé¡¹ç›®å¯ä»¥å¸¦æ¥ä»¥ä¸‹å¥½å¤„:å‡å°‘å†…å­˜çš„å¼€é”€ï¼›ç®€åŒ–å„ç§ç±»åº“å’Œå¤§åž‹åº”ç”¨çš„å¼€å‘å’Œç»´æŠ¤ï¼›æ”¹è¿›å…¶å®‰å…¨æ€§ï¼Œå¯ç»´æŠ¤æ€§ï¼Œæé«˜æ€§èƒ½ã€‚jshellå‘½ä»¤åœ¨Java 9 ä¹‹å‰ï¼Œæˆ‘ä»¬è¦æƒ³ä½¿ç”¨Javaæ¥è¾“å‡ºä¸€å¥hello worldæˆ–è€…è®¡ç®—ä¸¤ä¸ªæ•°çš„å’Œéƒ½å¿…é¡»åˆ›å»ºä¸€ä¸ªJavaé¡¹ç›®ï¼Œç„¶åŽåˆ›å»ºç±»åœ¨é‡Œé¢å†™mainæ–¹æ³•æ¥è¿è¡Œã€‚Java 9 åŽå°±ä¸å¿…è¿™æ ·äº†ï¼Œå…¶æä¾›äº†REPLå·¥å…·ï¼šjshellã€‚åˆ©ç”¨ jshell åœ¨æ²¡æœ‰åˆ›å»ºç±»çš„æƒ…å†µä¸‹ç›´æŽ¥å£°æ˜Žå˜é‡ï¼Œè®¡ç®—è¡¨è¾¾å¼ï¼Œæ‰§è¡Œè¯­å¥ã€‚å³å¼€å‘æ—¶å¯ä»¥åœ¨å‘½ä»¤è¡Œé‡Œç›´æŽ¥è¿è¡Œ Java çš„ä»£ç ï¼Œè€Œæ— éœ€åˆ›å»º Java æ–‡ä»¶ã€‚åœ¨JDK 9 çš„binç›®å½•ä¸‹æœ‰ä¸ªjshell.exeæ–‡ä»¶ï¼Œæˆ‘ä»¬è¿è¡Œå®ƒï¼šä¸‹é¢æ¼”ç¤ºä¸€äº›jshellçš„å¸¸ç”¨æ“ä½œã€‚åŸºæœ¬ä½¿ç”¨åœ¨jshellä¸­ï¼Œä»£ç æœ«å°¾çš„;æ˜¯å¯é€‰çš„ã€‚å¯¼åŒ…æ“ä½œæŸ¥çœ‹æ‰€æœ‰å·²ç»å¯¼å…¥çš„åŒ…ä½¿ç”¨Tabé”®è¡¥å…¨ä»£ç æŸ¥çœ‹å½“å‰çŽ¯å¢ƒä¸‹æ‰€æœ‰æœ‰æ•ˆä»£ç æŸ¥çœ‹å½“å‰çŽ¯å¢ƒä¸‹æ‰€æœ‰å˜é‡æŸ¥çœ‹å½“å‰çŽ¯å¢ƒä¸‹æ‰€æœ‰æ–¹æ³•ä½¿ç”¨å¤–éƒ¨ä»£ç ç¼–è¾‘å™¨æ¥ä¿®æ”¹addæ–¹æ³•ç•Œé¢å¼¹å‡ºï¼šä¿®æ”¹å®Œæ¯•ç‚¹å‡»Acceptå’ŒExitæŒ‰é’®å³å¯ï¼šåŠ è½½å¤–éƒ¨ä»£ç åœ¨æ¡Œé¢æ–°å»ºä¸€ä¸ªHello.javaæ–‡ä»¶ï¼š1234public void hello() &#123; System.out.println("hello world");&#125;hello();ç„¶åŽä½¿ç”¨/openå‘½ä»¤æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶ï¼šæ›´å¤šå…³äºŽjshellçš„åŠŸèƒ½ä»‹ç»ï¼Œå¯ä»¥ä½¿ç”¨/helpå‘½ä»¤æ¥æŸ¥çœ‹ã€‚æŽ¥å£ä¸­çš„ç§æœ‰æ–¹æ³•æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨JDK 8ä¹‹å‰ï¼ŒæŽ¥å£åªèƒ½åŒ…å«public static finalçš„æˆå‘˜å˜é‡å’Œpublic abstractä¿®é¥°çš„æŠ½è±¡æ–¹æ³•ï¼›è€Œåœ¨JDK 8ä¸­ï¼ŒæŽ¥å£ä¸­å¯ä»¥å®šä¹‰é™æ€æ–¹æ³•å’Œé»˜è®¤æ–¹æ³•äº†ï¼›JDK 9çš„æŽ¥å£åˆåŠ äº†æ–°çš„ç‰¹æ€§ï¼Œå…¶å…è®¸æŽ¥å£ä¸­åŒ…å«ç§æœ‰çš„æ–¹æ³•ï¼Œä¸‹é¢è¿™ä¸ªæŽ¥å£å®šä¹‰åœ¨JDK 9 ä¸­æ˜¯åˆæ³•çš„ï¼š123456789101112131415161718public interface TestInterface &#123; // before jdk 7 : void method1(); // jdk 8: static void method2() &#123; System.out.println("mehtod2"); &#125; default void method3() &#123; System.out.println("mehtod3"); &#125; // jdk 9: private void method4() &#123; System.out.println("mehtod4"); &#125;&#125;Diamond Operatorä½¿ç”¨å‡çº§åœ¨Java 9 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬ä¸èƒ½å°†é’»çŸ³æ“ä½œç¬¦ï¼ˆDiamond Operatorï¼‰å’ŒåŒ¿åå®žçŽ°ç±»æ”¾åœ¨ä¸€èµ·ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­åœ¨Java 9 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ç¼–è¯‘æ˜¯ä¸é€šè¿‡çš„ï¼šè€Œåœ¨Java 9ä¸­å–æ¶ˆäº†è¿™ä¸ªé™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªç‰¹æ€§æ¥è¿›è¡Œä¸€äº›åˆå§‹åŒ–æ“ä½œ:tryä½¿ç”¨å‡çº§åœ¨Java 9 ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ç§ä¼˜é›…çš„æ–¹å¼æ¥è¿›è¡Œæµçš„å…³é—­æ“ä½œï¼š12345try (InputStreamReader reader = new InputStreamReader(System.in)) &#123; reader.read();&#125; catch (IOException e) &#123; e.printStackTrace();&#125;åœ¨tryåŽé¢çš„æ‹¬å·ä¸­å£°æ˜Žåˆå§‹åŒ–çš„æµJavaä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è¿›è¡Œå…³é—­æ“ä½œã€‚Java 9 å¯¹è¿™ä¸ªç‰¹æ€§è¿›è¡Œäº†å‡çº§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨tryåŽé¢çš„æ‹¬å·ä¸­ä½¿ç”¨å·²ç»åˆå§‹åŒ–è¿‡çš„èµ„æºï¼Œæ­¤æ—¶çš„èµ„æºæ˜¯finalçš„ï¼š123456InputStreamReader reader = new InputStreamReader(System.in);try (reader) &#123; reader.read();&#125; catch (IOException e) &#123; e.printStackTrace();&#125;å¦‚æžœå¯¹readerå†æ¬¡è¿›è¡Œèµ‹å€¼æ“ä½œï¼Œç¼–è¯‘å°†ä¸é€šè¿‡ï¼šä¸‹åˆ’çº¿æ ‡è¯†ç¬¦çš„é™åˆ¶Java 8 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿_ä½œä¸ºæ ‡è¯†ç¬¦ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç æ˜¯åˆæ³•çš„ï¼š12String _ = "mrbird";System.out.println(_);è€Œåœ¨Java 9 ä¸­ï¼Œä¸‹åˆ’çº¿_å·²ç»ä¸èƒ½ç”¨äºŽæ ‡è¯†ç¬¦äº†ï¼šStringå­˜å‚¨ç»“æž„å˜æ›´Java 9 ä¹‹å‰ï¼Œå­—ç¬¦ä¸²çš„åº•å±‚æ˜¯ç”¨char[]è¿›è¡Œå­˜å‚¨çš„ï¼ŒJava 9 ä¸­ï¼Œå­—ç¬¦ä¸²æ”¹ç”¨æˆäº†byte[]è¿›è¡Œå­˜å‚¨:ä¹‹æ‰€ä»¥åšå‡ºè¿™ä¸ªæ”¹å˜æ˜¯å› ä¸ºï¼šå¤§å¤šæ•°Stringç±»åž‹å¯¹è±¡å­˜å‚¨çš„éƒ½æ˜¯æ‹‰ä¸å­—ç¬¦ï¼Œè¿™äº›å­—ç¬¦åªå ä¸€ä¸ªå­—èŠ‚ï¼Œè€Œcharèƒ½å¤Ÿå­˜å‚¨ä¸¤ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æµªè´¹äº†ä¸€åŠçš„å­˜å‚¨ç©ºé—´ã€‚Java 9 å°†Stringç±»çš„å†…éƒ¨è¡¨ç¤ºä»ŽUTF-16çš„charæ•°ç»„æ›´æ”¹ä¸ºbyteæ•°ç»„åŠ ä¸Šencoding-flagå­—æ®µã€‚æ–°Stringç±»å°†æ ¹æ®å­—ç¬¦ä¸²çš„å†…å®¹å­˜å‚¨ç¼–ç ä¸ºISO-8859-1 / Latin-1ï¼ˆæ¯ä¸ªå­—ç¬¦ä¸€ä¸ªå­—èŠ‚ï¼‰æˆ–UTF-16ï¼ˆæ¯ä¸ªå­—ç¬¦ä¸¤ä¸ªå­—èŠ‚ï¼‰çš„å­—ç¬¦ã€‚encoding-flagç¼–ç æ ‡å¿—å°†æŒ‡ç¤ºä½¿ç”¨å“ªç§ç¼–ç ã€‚åŸºäºŽStringçš„ç±»å¦‚StringBufferå’ŒStringBuilderç­‰ä¹Ÿæ˜¯åšå‡ºäº†ç›¸åŒçš„æ”¹å˜ã€‚å…·ä½“å¯å‚è€ƒï¼šhttp://openjdk.java.net/jeps/254ã€‚é›†åˆçš„ofæ–¹æ³•Java 9 ä¹‹å‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼æ¥åˆ›å»ºä¸å¯å˜é›†åˆï¼š12345678List&lt;Integer&gt; list = Collections.unmodifiableList(Arrays.asList(1, 2, 3));Set&lt;Integer&gt; set = Collections.unmodifiableSet(new HashSet&lt;&gt;(Arrays.asList(1, 2, 3)));Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();map.put("mrbird", 18);map.put("kangkang", 20);Map&lt;String, Object&gt; map1 = Collections.unmodifiableMap(map);Java 9 ä¸­çš„é›†åˆç±»éƒ½æ·»åŠ äº†ä¸€ä¸ªofæ–¹æ³•ï¼Œå¯ä»¥å¿«é€Ÿçš„æž„é€ ä¸å¯å˜é›†åˆï¼š123List&lt;Integer&gt; list = List.of(1, 2, 3);Set&lt;Integer&gt; set = Set.of(1, 2, 3);Map&lt;String, Object&gt; map1 = Map.of("mrbird", 18, "kangkang", 20);å¯¹ä¸å¯å˜é›†åˆè¿›è¡Œèµ‹å€¼æ“ä½œå°†æŠ›å‡ºå¼‚å¸¸ï¼šå¢žå¼ºçš„Steam APIåœ¨ Java 9 ä¸­ï¼ŒStream APIå˜å¾—æ›´å¥½ï¼ŒStreamæŽ¥å£ä¸­æ·»åŠ äº† 4 ä¸ªæ–°çš„æ–¹æ³•ï¼šdropWhile, takeWhile, ofNullableï¼Œè¿˜æœ‰ä¸ª iterateæ–¹æ³•çš„æ–°é‡è½½æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ æä¾›ä¸€ä¸ªPredicateï¼ˆåˆ¤æ–­æ¡ä»¶ï¼‰æ¥æŒ‡å®šä»€ä¹ˆæ—¶å€™ç»“æŸè¿­ä»£ã€‚ä¸‹é¢ä¸¾ä¾‹æ¥æ¼”ç¤ºè¿™å‡ ä¸ªçš„ç”¨æ³•ï¼štakeWhiletakeWhileç”¨äºŽä»ŽStreamä¸­èŽ·å–ä¸€éƒ¨åˆ†æ•°æ®ï¼ŒæŽ¥æ”¶ä¸€ä¸ªPredicateæ¥è¿›è¡Œé€‰æ‹©ã€‚åœ¨æœ‰åºçš„Streamä¸­ï¼ŒtakeWhileè¿”å›žä»Žå¼€å¤´å¼€å§‹çš„å°½é‡å¤šçš„å…ƒç´ ã€‚12List&lt;Integer&gt; list = Arrays.asList(45, 43, 76, 87, 42, 77, 90, 73, 67, 88);list.stream().takeWhile(x -&gt; x &lt; 50).forEach(System.out::println);ç»“æžœè¾“å‡º:ç¨‹åºä»Žå¤´å¼€å§‹åˆ¤æ–­å½“å‰å€¼æ˜¯å¦å°äºŽ50ï¼Œå½“åˆ¤æ–­åˆ°ç¬¬ä¸‰ä¸ªå…ƒç´ 76æ—¶ï¼Œå‘çŽ°ä¸æ»¡è¶³ï¼ŒäºŽæ˜¯ç¨‹åºå°±ç»“æŸäº†ã€‚æ‰€ä»¥takeWhileä¸åŒäºŽè¿‡æ»¤å™¨ã€‚dropWhiledropWhileçš„è¡Œä¸ºä¸ŽtakeWhileç›¸åï¼Œè¿”å›žå‰©ä½™çš„å…ƒç´ ï¼š12List&lt;Integer&gt; list = Arrays.asList(45, 43, 76, 87, 42, 77, 90, 73, 67, 88);list.stream().dropWhile(x -&gt; x &lt; 50).forEach(System.out::println);ç¨‹åºè¾“å‡º:ofNullableJava 8 ä¸­Streamä¸èƒ½å®Œå…¨ä¸ºnullï¼ˆåªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œä¸”ä¸ºnullï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚è€ŒJava 9 ä¸­çš„ofNullable æ–¹æ³•å…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå•å…ƒç´  Streamï¼Œå¯ä»¥åŒ…å«ä¸€ä¸ªéžç©ºå…ƒç´ ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªç©º Streamï¼š1234567891011121314151617181920// æŠ¥ NullPointerException// Stream&lt;Object&gt; stream1 = Stream.of(null);// System.out.println(stream1.count());// ä¸æŠ¥å¼‚å¸¸ï¼Œå…è®¸é€šè¿‡Stream&lt;String&gt; stringStream = Stream.of("AA", "BB", null);System.out.println(stringStream.count()); // 3// ä¸æŠ¥å¼‚å¸¸ï¼Œå…è®¸é€šè¿‡List&lt;String&gt; list = new ArrayList&lt;&gt;();list.add("AA");list.add(null);System.out.println(list.stream().count()); // 2// ofNullable()ï¼šå…è®¸å€¼å®Œå…¨ä¸º nullStream&lt;Object&gt; stream1 = Stream.ofNullable(null);System.out.println(stream1.count()); // 0Stream&lt;String&gt; stream = Stream.ofNullable("hello world");System.out.println(stream.count()); // 1Steam iteratorçš„é‡è½½æ–¹æ³•1234// Java 8 ä¸­çš„Stream.iterate(0, x -&gt; x + 1).limit(10).forEach(System.out::println);// ç­‰ä»·äºŽ Java 9 ä¸­çš„Stream.iterate(0, x -&gt; x &lt; 10, x -&gt; x + 1).forEach(System.out::println);é™¤äº†ä¸Šé¢å‡ ä¸ªæ–°ç‰¹æ€§å¤–ï¼ŒJava 9 è¿˜æ”¯æŒå°†optionalè½¬æ¢ä¸ºæµçš„æ“ä½œï¼š1234567891011121314List&lt;String&gt; list = new ArrayList&lt;&gt;();list.add("mrbird");list.add("kangkang");list.add("maria");Optional&lt;List&lt;String&gt;&gt; optional = Optional.of(list);// æµä¸­çš„å…ƒç´ ä¸º listStream&lt;List&lt;String&gt;&gt; stream = optional.stream();stream.forEach(System.out::println);// æµä¸­çš„å…ƒç´ ä¸º listä¸­çš„æ¯ä¸ªå…ƒç´ Stream&lt;String&gt; stringStream = optional.stream().flatMap(Collection::stream);stringStream.forEach(System.out::println);ç¨‹åºè¾“å‡ºï¼šHTTP ClientJava 9 ä¸­æ–°å¢žäº†å…¨æ–°çš„HttpClientæ¥æ›¿ä»£HttpURLConnectionï¼Œå…¶å¯ä»¥ä»Žjdk.incubator.httpclientæ¨¡å—ä¸­èŽ·å–ã€‚å› ä¸ºåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ¨¡å—æ˜¯ä¸èƒ½æ ¹æ®classpathèŽ·å–çš„ï¼Œéœ€è¦ä½¿ç”¨add moduleså‘½ä»¤é€‰é¡¹é…ç½®è¿™ä¸ªæ¨¡å—ï¼Œå°†è¿™ä¸ªæ¨¡å—æ·»åŠ åˆ° classpathä¸­ã€‚æˆ‘ä»¬åœ¨srcä¸‹çš„module-info.javaä¸­å¼•å…¥è¿™ä¸ªæ¨¡å—ï¼š1requires jdk.incubator.httpclient;å†™ä¸ªåŸºäºŽHttpClientçš„ä¾‹å­:12345678HttpClient client = HttpClient.newHttpClient();HttpRequest req = HttpRequest.newBuilder(URI.create("https://mrbird.cc")) .GET() .build();HttpResponse&lt;String&gt; response = client.send(req, HttpResponse.BodyHandler.asString());System.out.println(response.statusCode());System.out.println(response.version().name());System.out.println(response.body());è¾“å‡ºç»“æžœï¼šå‚è€ƒè‡ªï¼šhttps://www.jianshu.com/u/5f70a16b98e7]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Java 9</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Docker Compose]]></title>
    <url>%2FDocker-Compose.html</url>
    <content type="text"><![CDATA[éƒ¨ç½²ä¸€ä¸ªåº”ç”¨å¯èƒ½éœ€è¦ç”¨åˆ°å¤šä¸ªDockerå®¹å™¨ï¼Œæ¯”å¦‚MySQLï¼ŒRedisï¼ŒNginxç­‰ï¼Œå•ç‹¬çš„åŽ»ç®¡ç†æ¯ä¸ªå®¹å™¨å¯èƒ½ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚Docker Composeå¯ä»¥é€šè¿‡ä¸€ä¸ªymlæ–‡ä»¶æ¥ç»Ÿä¸€ç®¡ç†è¿™äº›å®¹å™¨ï¼Œå¯ä»¥æžå¤§ç®€åŒ–æˆ‘ä»¬çš„åº”ç”¨éƒ¨ç½²è¿‡ç¨‹ã€‚è¿™é‡Œä»¥éƒ¨ç½²WordPressä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨Docker ComposeåŽ»ç»Ÿä¸€ç®¡ç†å¤šä¸ªDockerå®¹å™¨ã€‚å…ˆæ¥çœ‹çœ‹ä¸ç”¨Docker Composeæ—¶éƒ¨ç½²WordPressçš„æ­¥éª¤ã€‚Dockeréƒ¨ç½²WordPresså®‰è£…MySQLDockeræ‹‰å–MySQLé•œåƒï¼š1docker pull mysql:5.7.25åˆ›å»ºMySQLå®¹å™¨:1docker run -d --name mysql -v mysql:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 -e MYSQL_DATABASE=wordpress -p 3306:3306 mysql:5.7.25å®‰è£…WordPressDockeræ‹‰å–WordPressé•œåƒï¼š1docker pull wordpressåˆ›å»ºWordPresså®¹å™¨ï¼š1docker run -d -p 8080:80 --link mysql -e WORDPRESS_DB_HOST=mysql:3306 -e WORDPRESS_DB_USER=root -e WORDPRESS_DB_PASSWORD=123456 -e WORDPRESS_DB_NAME=wordpress wordpressæŸ¥çœ‹æ˜¯å¦æˆåŠŸï¼šDocker Composeéƒ¨ç½²WordPressæŽ¥ä¸‹æ¥çœ‹ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨Docker Composeéƒ¨ç½²WordPressã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ é™¤ä¸Šé¢åˆ›å»ºçš„ä¸¤ä¸ªå®¹å™¨ï¼Œç„¶åŽå®‰è£…Docker Composeï¼Œå®‰è£…æ•™ç¨‹ï¼šhttps://docs.docker.com/compose/install/ã€‚æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼šç¼–å†™ä¸€ä¸ªdocker-compose.ymlï¼š1vim docker-compose.ymlå†…å®¹å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233version: '3'services: wordpress: image: wordpress ports: - 8080:80 environment: WORDPRESS_DB_HOST: mysql:3306 WORDPRESS_DB_NAME: wordpress WORDPRESS_DB_USER: root WORDPRESS_DB_PASSWORD: 123456 networks: - my-bridge mysql: image: mysql:5.7.25 ports: - 3306:3306 environment: MYSQL_ROOT_PASSWORD: 123456 MYSQL_DATABASE: wordpress volumes: - mysql-data:/var/lib/mysql networks: - my-bridgevolumes: mysql-data:networks: my-bridge: driver: bridgeç„¶åŽæ‰§è¡Œå‘½ä»¤docker-compose up -dè¿è¡Œï¼šæŸ¥çœ‹WordPressæ˜¯å¦éƒ¨ç½²æˆåŠŸï¼šdocker-compose.ymlä¸Šé¢ä¾‹å­ä¸­æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶ï¼Œè¿è¡Œdocker-compose upå‘½ä»¤ä¸€æ¬¡æ€§åˆ›å»ºäº†ä¸¤ä¸ªå®¹å™¨ï¼šdocker-compose.ymlä¸€èˆ¬åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†:servicesã€networkså’Œvolumesã€‚servicesä¸€ä¸ªserviceä»£è¡¨ä¸€ä¸ªcontainerï¼Œå¯ä»¥ä»ŽDocker Hubçš„imageåˆ›å»ºï¼Œä¹Ÿå¯ä»¥é€šè¿‡æœ¬åœ°çš„dockerfileåˆ›å»ºçš„imageæ¥åˆ›å»ºã€‚serviceç±»ä¼¼äºŽdocker runï¼Œdocker runæ”¯æŒçš„é€‰é¡¹ serviceä¹Ÿå¯ä»¥ç”¨ã€‚ä¸¾ä¸¤ä¸ªä¾‹å­:åŸºäºŽé•œåƒï¼š1234567services: db: image: mysql:5.7.25 volumes: - mysql-data:/var/lib/mysql networks: - my-bridgeç±»ä¼¼äºŽå‘½ä»¤ï¼š1docker run -d --network my-bridge -v mysql-data:/var/lib/mysql mysql:5.7.25åŸºäºŽdockerfileï¼š12345678services: worker: build: ./worker links: - db - redis networks: - my-bridgeåŸºäºŽå½“å‰ç›®å½•ä¸‹worker/æ–‡ä»¶å¤¹é‡Œçš„dockerfileæž„å»ºcontainerã€‚networksä¸€ä¸ªnetworksçš„ä¾‹å­ï¼š123networks: my-bridge: driver: bridgeç­‰ä»·äºŽï¼š1docker network create -d bridge my-bridgevolumesä¸€ä¸ªvolumesçš„ä¾‹å­ï¼š12volumes: mysql-data:ç­‰ä»·äºŽ1docker volume create mysql-dataçŽ°åœ¨å›žå¤´çœ‹çœ‹åˆšåˆšçš„ymlæ–‡ä»¶:version: 3è¡¨ç¤ºåŸºäºŽç¬¬ä¸‰ç‰ˆæœ¬docker-compose.ymlè¯­æ³•æž„å»ºï¼Œç„¶åŽåˆ›å»ºäº†ä¸¤ä¸ªå®¹å™¨wordpresså’Œmysqlï¼Œä¸€ä¸ªvolumeâ€”â€”mysql-dataï¼Œä¸€ä¸ªnetworkï¼Œåç§°ä¸ºmy-bridgeï¼Œé‡‡ç”¨bridgeç½‘ç»œæ¨¡å¼ã€‚åœ¨wordpressçš„å®šä¹‰ä¸­ï¼Œä½¿ç”¨imageæŒ‡å®šäº†åŸºäºŽwordpressé•œåƒæž„å»ºï¼Œportsè¿›è¡Œç«¯å£æ˜ å°„ï¼Œenvironmenté…ç½®äº†wordpressé•œåƒæ”¯æŒçš„çŽ¯å¢ƒå˜é‡ï¼ŒæŒ‡å®šç½‘ç»œä¸ºmy-bridgeã€‚mysqlçš„å®šä¹‰å’Œwordpressç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚æ›´å¤šdocker-compose.ymlæ”¯æŒçš„å‘½ä»¤å¯ä»¥å‚è€ƒï¼šhttps://www.jianshu.com/p/2217cfed29d7ã€‚docker-composeå‘½ä»¤çœ‹çœ‹docker-composeæ”¯æŒå“ªäº›å‘½ä»¤ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657[root@mrbird vagrant]# docker-composeDefine and run multi-container applications with Docker.Usage: docker-compose [-f &lt;arg&gt;...] [options] [COMMAND] [ARGS...] docker-compose -h|--helpOptions: -f, --file FILE Specify an alternate compose file (default: docker-compose.yml) -p, --project-name NAME Specify an alternate project name (default: directory name) --verbose Show more output --log-level LEVEL Set log level (DEBUG, INFO, WARNING, ERROR, CRITICAL) --no-ansi Do not print ANSI control characters -v, --version Print version and exit -H, --host HOST Daemon socket to connect to --tls Use TLS; implied by --tlsverify --tlscacert CA_PATH Trust certs signed only by this CA --tlscert CLIENT_CERT_PATH Path to TLS certificate file --tlskey TLS_KEY_PATH Path to TLS key file --tlsverify Use TLS and verify the remote --skip-hostname-check Don't check the daemon's hostname against the name specified in the client certificate --project-directory PATH Specify an alternate working directory (default: the path of the Compose file) --compatibility If set, Compose will attempt to convert keys in v3 files to their non-Swarm equivalentCommands: build Build or rebuild services bundle Generate a Docker bundle from the Compose file config Validate and view the Compose file create Create services down Stop and remove containers, networks, images, and volumes events Receive real time events from containers exec Execute a command in a running container help Get help on a command images List images kill Kill containers logs View output from containers pause Pause services port Print the public port for a port binding ps List containers pull Pull service images push Push service images restart Restart services rm Remove stopped containers run Run a one-off command scale Set number of containers for a service start Start services stop Stop services top Display the running processes unpause Unpause services up Create and start containers version Show the Docker-Compose version informationæŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨ï¼š1docker-compose psåœæ­¢ï¼š1docker-compose stopå¯åŠ¨ï¼š1docker-compose startåœæ­¢å¹¶åˆ é™¤ï¼ˆåˆ é™¤åˆ›å»ºçš„networkï¼Œvolumeï¼Œcontainerï¼‰ï¼š1docker-compose downå‚è€ƒðŸ”—ï¼šhttps://docs.docker.com/compose/compose-file/]]></content>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Dockerå­˜å‚¨]]></title>
    <url>%2FDocker-Volume.html</url>
    <content type="text"><![CDATA[Dockerå®¹å™¨åœ¨è¿è¡Œçš„æ—¶å€™ä¼šäº§ç”Ÿæ•°æ®ï¼Œä¸ºäº†ä¸è®©è¿™äº›æ•°æ®éšç€å®¹å™¨çš„åˆ é™¤è€Œåˆ é™¤ï¼ŒDockeræ”¯æŒæ•°æ®æŒä¹…åŒ–ã€‚Dockeræ•°æ®æŒä¹…åŒ–ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼švolumeå’Œbind mountã€‚ä½¿ç”¨volumeæ•°æ®å°†æŒä¹…åŒ–åœ¨Dockerç®¡ç†çš„volumeä¸­ï¼ˆä¿å­˜åœ¨/var/lib/docker/volumesç›®å½•ä¸‹ï¼‰ï¼Œä½¿ç”¨bind mountï¼Œæ•°æ®å°†æŒä¹…åŒ–åœ¨æˆ‘ä»¬æŒ‡å®šçš„å®¿ä¸»æœºçš„æŸä¸ªç›®å½•ä¸­ã€‚å’Œæ•°æ®æŒä¹…åŒ–ç›¸å…³çš„Dockerå‘½ä»¤ï¼š1234567891011121314root@mrbird vagrant]# docker volume --helpUsage: docker volume COMMANDManage volumesCommands: create Create a volume inspect Display detailed information on one or more volumes ls List volumes prune Remove all unused local volumes rm Remove one or more volumesRun 'docker volume COMMAND --help' for more information on a command.volumeä»¥MySQLä¸ºä¾‹å­ï¼ŒæŸ¥çœ‹5.7.25ç‰ˆæœ¬çš„ MySQL Dockerfileï¼Œä¼šçœ‹åˆ°æœ«å°¾å¤„æœ‰è¿™ä¹ˆä¸€è¡Œï¼š1VOLUME /var/lib/mysqlæ„æ€æ˜¯åœ¨Dockeråˆ›å»ºMySQLå®¹å™¨æ—¶ï¼ŒDockerä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªvolumeï¼ŒMySQLå®¹å™¨ä¸­/var/lib/mysqlç›®å½•ä¸‹çš„å†…å®¹å°†åŒæ­¥åˆ°è¿™ä¸ªvolumeä¸­ã€‚æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªMySQLå®¹å™¨ï¼š1docker run -d --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql:5.7.25ç„¶åŽæŸ¥çœ‹æ˜¯å¦åˆ›å»ºäº†volumeï¼švolumeé»˜è®¤çš„åç§°å¥½é•¿å“¦ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºå®¹å™¨çš„æ—¶å€™æŒ‡å®švolumeçš„åç§°ï¼Œæˆ‘ä»¬åˆ æŽ‰MySQLè¿™ä¸ªå®¹å™¨ï¼Œé‡æ–°åˆ›å»ºä¸ªï¼Œå¹¶æŒ‡å®švolumeçš„åç§°ä¸ºmysqlï¼š1docker run -d --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -v mysql:/var/lib/mysql mysql:5.7.25-v mysql:/var/lib/mysqlçš„æ„æ€æ˜¯ä½¿ç”¨åç§°ä¸ºmysqlçš„volumeï¼ˆæ²¡æœ‰åˆ™åˆ›å»ºï¼‰ï¼Œå­˜å‚¨å®¹å™¨/var/lib/mysqlç›®å½•ä¸‹çš„å†…å®¹ï¼ˆå’ŒMySQL Dockerfileä¸­ä½¿ç”¨VOLUMEæŒ‡å®šçš„ç›®å½•ä¸€è‡´ï¼‰ã€‚æŸ¥çœ‹volumeï¼šå¯ä»¥çœ‹åˆ°å¤šäº†ä¸ªåç§°ä¸ºmysqlçš„volumeã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬åšä¸ªå®žéªŒï¼šè¿›å…¥åˆ°MySQLå®¹å™¨ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåç§°ä¸ºdockerçš„æ•°æ®åº“ï¼šé€€å‡ºå®¹å™¨å¹¶åˆ é™¤è¯¥å®¹å™¨ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªæ–°çš„MySQLå®¹å™¨ï¼ŒvolumeæŒ‡å®šä¸ºmysqlï¼šå¯ä»¥çœ‹åˆ°dockerè¿™ä¸ªæ•°æ®åº“è¿˜åœ¨ï¼Œè¯´æ˜Žæ•°æ®æ¢å¤äº†ã€‚bind mountbind mountä¾‹å­ï¼š1docker run -v /home/aaa:/root/aaaå®¿ä¸»æœºçš„/home/aaaå°†å’Œå®¹å™¨ä¸­çš„/root/aaaåŒæ­¥ï¼Œå®¿ä¸»æœº/home/aaaç›®å½•ä¸‹æ–‡ä»¶åšäº†ä¿®æ”¹ï¼Œå®¹å™¨ä¸­/root/aaaç›®å½•ä¸‹æ–‡ä»¶ä¹Ÿä¼šè¢«ä¿®æ”¹ï¼Œåä¹‹äº¦ç„¶ã€‚ä»¥Nginxä¸ºä¾‹ï¼Œæ‹‰å–Nginx stableé•œåƒï¼š1docker pull nginx:1.14.2åˆ›å»ºNginxå®¹å™¨:1docker run -d --name nginx -p 80:80 -v $(pwd):/usr/share/nginx/html nginx:1.14.2é€šè¿‡$(pwd):/usr/share/nginx/htmlæˆ‘ä»¬å°†å®¿ä¸»æœºçš„å½“å‰ç›®å½•å’ŒNginxå®¹å™¨å†…éƒ¨çš„/usr/share/nginx/htmlç›®å½•è¿›è¡Œäº†åŒæ­¥ã€‚æˆ‘ä»¬åœ¨å®¿ä¸»æœºå½“å‰ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªhello.htmlï¼šç„¶åŽè¿›å…¥åˆ°Nginxå®¹å™¨å†…çš„/usr/share/nginx/htmlç›®å½•ï¼šåŒæ­¥æ˜¯okçš„ï¼Œåœ¨å®¿ä¸»æœºå¤–è®¿é—® http://192.168.33.10/hello.html çœ‹çœ‹ï¼ˆæˆ‘çš„å®¿ä¸»æœºIPä¸º192.168.33.10ï¼‰ï¼šå‚è€ƒðŸ”—ï¼šhttps://docs.docker.com/storage/volumes/]]></content>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Dockerç½‘ç»œé…ç½®]]></title>
    <url>%2FDocker-network.html</url>
    <content type="text"><![CDATA[åœ¨å®‰è£…å¥½DockeråŽï¼Œå…¶é»˜è®¤æä¾›äº†ä¸‰ç§ç½‘ç»œæ¨¡å¼ï¼šbridgeã€hostå’Œnoneã€‚å…¶ä¸­bridgeæ˜¯Dockeré»˜è®¤çš„ç½‘ç»œæ¨¡å¼ï¼Œåœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œå®¹å™¨æ‹¥æœ‰è‡ªå·±çš„IP namespaceï¼Œå®¹å™¨å¯ä»¥é€šè¿‡å®¿ä¸»æœºä¸Šçš„docker0ç½‘æ¡¥ä¸Žåˆ«çš„å®¹å™¨ã€å®¿ä¸»æœºæˆ–è€…å¤–éƒ¨ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚æ­¤å¤–æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç«¯å£æ˜ å°„çš„æ–¹å¼è®©å¤–éƒ¨çŽ¯å¢ƒä¹Ÿèƒ½è®¿é—®åˆ°å®¹å™¨å†…éƒ¨ã€‚Dockeré»˜è®¤çš„ç½‘ç»œæ¨¡å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šbridgeç½‘ç»œæ¨¡å¼Dockerä¸‰ç§ç½‘ç»œæ¨¡å¼ï¼šä¸‹é¢æˆ‘ä»¬é€šè¿‡busyboxæ¥è¿›è¡Œæ¼”ç¤ºã€‚BusyBox æ˜¯ä¸€ä¸ªé›†æˆäº†ä¸€ç™¾å¤šä¸ªæœ€å¸¸ç”¨ Linux å‘½ä»¤å’Œå·¥å…·ï¼ˆå¦‚ catã€echoã€grepã€mountã€telnet ã€pingã€ifconfig ç­‰ï¼‰çš„ç²¾ç®€å·¥å…·ç®±ï¼Œå®ƒåªéœ€è¦å‡  MB çš„å¤§å°ï¼Œå¾ˆæ–¹ä¾¿è¿›è¡Œå„ç§å¿«é€ŸéªŒè¯ï¼Œè¢«èª‰ä¸ºâ€œLinux ç³»ç»Ÿçš„ç‘žå£«å†›åˆ€â€ã€‚ä¸‹è½½busyboxé•œåƒ:é€šè¿‡è¯¥é•œåƒåˆ›å»ºä¸¤ä¸ªå®¹å™¨test1å’Œtest2ï¼šä½¿ç”¨docker network inspect bridgeå‘½ä»¤æŸ¥çœ‹bridgeç½‘ç»œè¯¦æƒ…ï¼šå¯ä»¥çœ‹åˆ°test1å’Œtest2éƒ½è¿žæŽ¥åˆ°äº†bridgeï¼ˆå› ä¸ºæ˜¯Dockeré»˜è®¤çš„ç½‘ç»œæ¨¡å¼ï¼‰ï¼Œå¹¶ä¸”test1å†…éƒ¨IPä¸º172.17.0.2ï¼Œtest2å†…éƒ¨IPä¸º172.17.0.3ã€‚æˆ‘ä»¬çœ‹ä¸‹åœ¨test1å®¹å™¨å†…éƒ¨æ˜¯å¦å¯ä»¥pingé€štest2çš„IPï¼šå¯ä»¥çœ‹åˆ°æ˜¯æ²¡é—®é¢˜çš„ã€‚çœ‹ä¸‹test1å†…éƒ¨pingå®¿ä¸»æœºIPï¼ˆ192.168.33.10ï¼‰å’Œå¤–éƒ¨ç½‘ç»œæ˜¯å¦å¯è¡Œï¼šlinkæˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºå®¹å™¨çš„ä½¿ç”¨ä½¿ç”¨--linkæ¥è®©å®¹å™¨é—´çš„ç½‘ç»œå»ºç«‹æ˜ å°„å…³ç³»ã€‚æˆ‘ä»¬åˆ é™¤test2å®¹å™¨ï¼Œé‡æ–°åˆ›å»ºtest2å®¹å™¨ï¼Œå¹¶ä¸”è®©å…¶å’Œtest1å»ºç«‹ç½‘ç»œæ˜ å°„å…³ç³»ï¼šè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨test2å®¹å™¨å†…éƒ¨ä½¿ç”¨ping test1pingé€štest1ç½‘ç»œäº†ï¼šåˆ›å»ºè‡ªå®šä¹‰ç½‘æ¡¥æˆ‘ä»¬å¯ä»¥é€šè¿‡docker network createæ¥åˆ›å»ºè‡ªå®šä¹‰çš„ç½‘æ¡¥ï¼Œæ¯”å¦‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ç½‘æ¡¥ï¼Œåç§°ä¸ºmy-bridgeï¼šæ¨¡å¼é€‰æ‹©çš„æ˜¯bridgeã€‚æˆ‘ä»¬è®©test1å’Œtest2å®¹å™¨éƒ½è¿žæŽ¥åˆ°è¿™ä¸ªæ–°çš„ç½‘æ¡¥ä¸Šï¼ˆä¹Ÿå¯ä»¥åœ¨åˆ›å»ºå®¹å™¨çš„æ—¶å€™ä½¿ç”¨--networkæ¥æŒ‡å®šéœ€è¦è¿žæŽ¥çš„ç½‘æ¡¥ï¼‰ï¼šæŸ¥çœ‹my-bridgeè¯¦æƒ…ï¼šå¯ä»¥çœ‹åˆ°test1å’Œtest2éƒ½è¿žæŽ¥ä¸Šæ¥äº†ã€‚ä½¿ç”¨è‡ªå®šä¹‰ç½‘æ¡¥æœ‰ä¸ªæ˜Žæ˜¾çš„å¥½å¤„æ˜¯ï¼Œå®¹å™¨é—´å¯ä»¥é€šè¿‡å®¹å™¨åç§°è¿›è¡Œç½‘ç»œé€šä¿¡ï¼ˆæ— éœ€åœ¨åˆ›å»ºå®¹å™¨çš„æ—¶å€™ä½¿ç”¨--linkæ¥æŒ‡å®šï¼‰ã€‚æˆ‘ä»¬åœ¨åˆ›å»ºtest1å®¹å™¨çš„æ—¶å€™å¹¶æ²¡æœ‰ä½¿ç”¨--link test2æ¥è¿žæŽ¥test2ï¼Œæˆ‘ä»¬çœ‹çœ‹åœ¨è¿žæŽ¥åˆ°my-bridgeåŽï¼Œtest1å†…éƒ¨æ˜¯å¦å¯ä»¥é€šè¿‡ping test2pingé€štest2 IPï¼šå¯ä»¥çœ‹åˆ°æ˜¯æ²¡é—®é¢˜çš„ã€‚ç«¯å£æ˜ å°„åœ¨å®¿ä¸»æœºä¸Šæˆ‘ä»¬æ˜¯æ— æ³•è®¿é—®Dockerå®¹å™¨å†…éƒ¨ç½‘ç»œçš„ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡ç«¯å£æ˜ å°„çš„æ–¹å¼æ¥å®žçŽ°è¿™ä¸ªéœ€æ±‚ã€‚ä»¥MySQLä¸ºä¾‹å­ï¼Œæˆ‘ä»¬æ‹‰å–MySQLé•œåƒï¼š1docker pull mysql:5.7.25åœ¨åˆ›å»ºMySQLå®¹å™¨çš„æ—¶å€™å¯ä»¥ä½¿ç”¨-pæˆ–-Pè®©å®¹å™¨æš´éœ²çš„ç«¯å£å’Œå®¿ä¸»æœºçš„ç«¯å£è¿›è¡Œæ˜ å°„ï¼š-eæŒ‡å®šçŽ¯å¢ƒå˜é‡ã€‚-p 3306:3306ï¼ˆå†’å·å‰é¢çš„ç«¯å£ä¸ºå®¿ä¸»æœºç«¯å£ï¼ŒåŽé¢çš„ç«¯å£ä¸ºå®¹å™¨ç«¯å£ï¼‰çš„æ„æ€æ˜¯ï¼Œè®©å®¹å™¨æš´éœ²çš„3306ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„3306ç«¯å£ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨å®¿ä¸»æœºå¤–éƒ¨é€šè¿‡192.168.33.10:3306æ¥è¿žæŽ¥MySQLå®¹å™¨äº†ï¼šDockerçš„hostå’Œnoneç½‘ç»œæ¨¡å¼ä½¿ç”¨è¾ƒå°‘è¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚å‚è€ƒðŸ”—ï¼šhttps://docs.docker.com/v17.09/engine/userguide/networking/#set-the-environment-variables-manually]]></content>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­¦ä¹ Dockerfile]]></title>
    <url>%2FDockerfile.html</url>
    <content type="text"><![CDATA[åœ¨ Docker é•œåƒä¸Žå®¹å™¨ ä¸€èŠ‚ä¸­æˆ‘ä»¬é€šè¿‡Dockerfileæž„å»ºäº†é•œåƒï¼Œè¿™èŠ‚æˆ‘ä»¬æ¥äº†è§£ä¸‹Dockerfileçš„è¯­æ³•ã€‚DockerfileåŒ…å«äº†è¯¸å¤šå…³é”®å­—ï¼Œæ‰€ä»¥è¦å­¦ä¹ Dockerfileçš„ç”¨æ³•ï¼Œå¾—å…ˆä»Žè¿™äº›å…³é”®å­—å…¥æ‰‹ã€‚FROMä½äºŽDockerfileå¼€å¤´ï¼Œè¡¨ç¤ºåŸºäºŽä»€ä¹ˆé•œåƒæž„å»ºï¼š12FROM scratch # åˆ¶ä½œbase imageFROM ubuntu:16.04 #ä½¿ç”¨ubuntu:16.04è¿™ä¸ªimageå‡ºäºŽå®‰å…¨è€ƒè™‘ï¼Œæœ€å¥½ä½¿ç”¨å®˜æ–¹çš„imageä½œä¸ºbase imageã€‚LABELDockerfileçš„å…ƒæ•°æ®ï¼Œæè¿°ä½œç”¨ã€‚1LABEL version=&quot;1.0&quot; author=&quot;mrbird&quot; description=&quot;dockerfile demo&quot;Dockerfileæœ€å¥½éƒ½è¦æœ‰å…ƒæ•°æ®ï¼Œè¿™æ ·æ›´æ˜“äºŽç†è§£ã€‚RUNè¿è¡Œå‘½ä»¤ï¼Œæ¯æ¬¡runéƒ½ä¼šç”Ÿæˆä¸€ä¸ªå›¾å±‚ï¼Œæ‰€ä»¥æœ€å¥½å°†å‘½ä»¤åˆå¹¶:123FROM ubuntuRUN apt-get update \ &amp;&amp; apt-get install -y vim\æ¢è¡ŒWORKDIRç”¨äºŽæŒ‡å®šå·¥ä½œç›®å½•ï¼Œåˆ‡æ¢è·¯å¾„ï¼š1234FROM ubuntuWORKDIR /test # æ²¡æœ‰åˆ™è‡ªåŠ¨åˆ›å»ºtestç›®å½•WORKDIR demoRUN pwdè¾“å‡º /test/demoã€‚æœ€å¥½ä¸è¦ç”¨RUN cdæ¥åˆ‡æ¢ç›®å½•ï¼Œè€Œä½¿ç”¨WORKDIRï¼Œè¿™æ ·å¯ä»¥å‡å°‘ä¸å¿…è¦çš„å›¾å±‚ï¼Œå°½é‡ä½¿ç”¨ç»å¯¹ç›®å½•ã€‚ADD &amp; COPYADD å’ŒCOPYéƒ½å¯ä»¥å°†æž„å»ºçŽ¯å¢ƒä¸­çš„æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°é•œåƒä¸­ï¼Œæ¯”å¦‚12WORKDIR /demoADD test test/12WORKDIR /demoCOPY test test/æœ€ç»ˆéƒ½ä¼šå°†testæ–‡ä»¶æ·»åŠ åˆ°/demo/test/ç›®å½•ä¸‹ã€‚åŒºåˆ«ï¼šADD æ·»åŠ çš„æ–‡ä»¶æ˜¯åŽ‹ç¼©æ–‡ä»¶çš„è¯ï¼Œä¼šè‡ªåŠ¨è§£åŽ‹ã€‚COPY åªèƒ½å¤åˆ¶æž„å»ºç›®å½•ä¸‹çš„æ–‡ä»¶ï¼ŒADDå¯ä»¥æ·»åŠ ä¸€ä¸ªæž„å»ºä¸Šä¸‹æ–‡ä¸­çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªURLï¼Œå¦‚ï¼š1ADD http://wordpress.org/latest.zip /ENVè®¾ç½®çŽ¯å¢ƒå˜é‡å¸¸é‡ã€‚12ENV MYSQL_VERSION 5.7RUN apt-get install -y mysql-server=&quot;$&#123;MYSQL_VERSION&#125;&quot;é€šè¿‡è®¾å®šå¸¸é‡ï¼Œå¯ä»¥æé«˜å¯ç»´æŠ¤æ€§ã€‚VOLUME &amp; EXPOSEå­˜å‚¨å’Œç½‘ç»œï¼Œè¿™é‡Œå…ˆç•¥ï¼ŒåŽé¢å­¦ä¹ åˆ°è¿™ä¸€å—å†è¯´ã€‚CMDè®¾ç½®å®¹å™¨å¯åŠ¨åŽé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤å’Œå‚æ•°ã€‚docker runæŒ‡å®šäº†å…¶ä»–å‘½ä»¤ï¼ŒCMDå‘½ä»¤ä¼šè¢«å¿½ç•¥ã€‚å®šä¹‰äº†å¤šä¸ªCMDï¼Œåªæœ‰æœ€åŽä¸€ä¸ªæœ‰æ•ˆã€‚æ¯”å¦‚æœ‰å¦‚ä¸‹Dockerfileï¼š1234FROM ubuntuENV name mrbirdCMD echo &quot;hello docker&quot;CMD echo &quot;hello $name&quot;æž„å»ºé•œåƒï¼Œè¿è¡Œï¼š1docker run [image]è¾“å‡º hello mrbirdã€‚å¦‚æžœè¿è¡Œï¼š1docker run -it [image] /bin/bashåˆ™æ²¡æœ‰è¾“å‡ºã€‚ENTRYPOINTè®¾ç½®å®¹å™¨å¯åŠ¨æ—¶è¿è¡Œçš„å‘½ä»¤ã€‚ä¸ä¼šè¢«å¿½ç•¥ï¼Œä¸€å®šä¼šæ‰§è¡Œã€‚ä¸€èˆ¬å†™ä¸€ä¸ªshellè„šæœ¬ä½œä¸ºENTRYPOINTã€‚æ¯”å¦‚mongodbå®˜æ–¹Dockerfileæœ«å°¾ä¸€æ®µï¼š12345COPY docker-entrypoint.sh /usr/local/bin/ENTRYPOINT [&quot;docker-entrypoint.sh&quot;]EXPOSE 27017CMD [&quot;mongod&quot;]ENTRYPOINTå’ŒCMDç»“åˆä½¿ç”¨æœ‰ä¸€ä¸ªæŠ€å·§ï¼šæ¯”å¦‚æœ‰å¦‚ä¸‹ä¸€ä¸ªDockerfileï¼š123FROM ubuntuENTRYPOINT [&quot;/bin/ls&quot;]CMD []æ„æ€æ˜¯åœ¨ubuntuè¿™ä¸ªé•œåƒä¸Šæž„å»ºï¼Œé€šè¿‡ENTRYPOINTè¿è¡Œ/bin/lså‘½ä»¤ï¼Œç„¶åŽCMD []è¿™è¡Œå¯ä»¥ä»‹ç»é¢å¤–çš„å‚æ•°é€‰é¡¹ã€‚é€šè¿‡è¿™ä¸ªDockerfileæž„å»ºé•œåƒåŽ(image idä¸º95c35bb00761)ï¼Œåˆ†åˆ«è¿è¡Œä¸‹é¢è¿™äº›å‘½ä»¤æ¥åˆ›å»ºå®¹å™¨ï¼šå¯ä»¥çœ‹åˆ°æˆ‘ä»¬é€šè¿‡ç›¸åŒçš„é•œåƒæž„å»ºå‡ºäº†ä¸åŒçš„å®¹å™¨ã€‚Shellå’ŒExecæ ¼å¼åœ¨Dockerfileä¸­ï¼Œå‘½ä»¤çš„å†™æ³•æœ‰Shellæ ¼å¼å’ŒExecæ ¼å¼ï¼šShellæ ¼å¼çš„Dockerfileå¦‚ä¸‹ï¼š123RUN apt-get install -y vimCMD echo &quot;hello world&quot;ENTRYPOINTT echo &quot;hello world&quot;Execæ ¼å¼å¦‚ä¸‹æ‰€ç¤º:123RUN [&quot;apt-get&quot;,&quot;install&quot;,&quot;-y&quot;,&quot;vim&quot;]CMD [&quot;/bin/echo&quot;,&quot;hello world&quot;]ENTRYPOINTT [&quot;/bin/echo&quot;,&quot;hello world&quot;]åœ¨ä½¿ç”¨Execæ ¼å¼çš„æ—¶å€™éœ€è¦æ³¨æ„å’Œå¸¸é‡çš„æ­é…ä½¿ç”¨é—®é¢˜ï¼Œæ¯”å¦‚åœ¨Shellæ ¼å¼ä¸‹ï¼š123FROM ubuntuENV name mrbirdENTRYPOINTER echo &quot;hello $name&quot;åˆ›å»ºé•œåƒï¼Œè¿è¡Œå®¹å™¨åŽè¾“å‡ºï¼šhello mrbirdã€‚ä½†æ˜¯åœ¨Execæ ¼å¼ä¸‹ï¼š123FROM ubuntuENV name mrbirdENTRYPOINTER [&quot;/bin/echo&quot;,&quot;hello $name&quot;]åˆ›å»ºé•œåƒï¼Œè¿è¡Œå®¹å™¨åŽè¾“å‡ºï¼šhello $nameã€‚æ­£ç¡®çš„å†™æ³•æ˜¯:123FROM ubuntuENV name mrbirdENTRYPOINTER [&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;echo hello $name&quot;]å‚è€ƒæ–‡æ¡£ï¼šhttps://docs.docker.com/engine/reference/builder/]]></content>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Docker é•œåƒä¸Žå®¹å™¨]]></title>
    <url>%2FDocker-Image-Container.html</url>
    <content type="text"><![CDATA[å¼€å§‹ä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡ Vagrantæž„å»ºä¸€ä¸ªCentOSçŽ¯å¢ƒ ï¼Œç„¶åŽæ ¹æ® å®˜æ–¹æ–‡æ¡£ æ¥å®‰è£…Dokcerï¼Œä¸‹é¢çš„ä¾‹å­è¿è¡Œåœ¨CentOS7çŽ¯å¢ƒä¸‹ã€‚Docker Imageä¿—ç§°Dockeré•œåƒï¼Œå®ƒæ˜¯ç”±ä¸€ç³»åˆ—å›¾å±‚ï¼ˆLayerï¼‰æž„æˆçš„ï¼Œæ¯ä¸ªå›¾å±‚ä»£è¡¨Dockerfileï¼ˆé€šè¿‡Dockerfileæˆ‘ä»¬å¯ä»¥åˆ›å»ºé•œåƒï¼‰ä¸­çš„ä¸€è¡ŒæŒ‡ä»¤ï¼Œé•œåƒæ˜¯åªè¯»çš„ã€‚é‚£ä»€ä¹ˆæ˜¯Dockerfileå‘¢ï¼Œä¸¾ä¸ªç®€å•çš„Dockerfileç¤ºä¾‹ï¼š12FROM centosRUN yum install -y vimä¸Šé¢çš„DockerfileåŒ…å«ä¸¤è¡Œå‘½ä»¤ï¼ˆæ‰€ä»¥å®ƒå¯¹åº”ä¸¤ä¸ªå›¾å±‚ï¼‰ï¼Œç¬¬ä¸€è¡Œè¡¨ç¤ºä»Žcentosè¿™ä¸ªé•œåƒä¸­åˆ›å»ºä¸€ä¸ªå›¾å±‚ï¼Œç„¶åŽç¬¬äºŒè¡Œè¡¨ç¤ºæŽ¥ç€è¿è¡Œyum install -y vimæ¥å®‰è£…vimã€‚é€šè¿‡è¿™ä¸ªDockerfileæˆ‘ä»¬å¯ä»¥æž„å»ºä¸€ä¸ªé•œåƒï¼Œé€šè¿‡é•œåƒæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼ˆContainerï¼‰ã€‚ä»€ä¹ˆæ˜¯Dockerå®¹å™¨ï¼Ÿå®¹å™¨æ˜¯é€šè¿‡é•œåƒæž„å»ºçš„ä¸€ä¸ªéš”ç¦»çš„åº”ç”¨å¹³å°ï¼Œå®ƒåŒ…å«äº†è¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€è¦çš„ä¸€åˆ‡ã€‚å’Œé•œåƒç›¸æ¯”ï¼Œå®ƒåœ¨é¡¶éƒ¨å¤šäº†ä¸€å±‚å¯è¯»å†™å›¾å±‚ï¼Œå°±å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šé•œåƒå’Œå®¹å™¨çš„å…³ç³»å°±åƒæ˜¯Javaé‡Œç±»ä¸Žå¯¹è±¡çš„å…³ç³»é‚£æ ·ï¼Œé•œåƒæ˜¯æž„å»ºå®¹å™¨çš„æ¨¡æ¿ï¼Œå®¹å™¨æ˜¯é•œåƒæž„å»ºå‡ºæ¥çš„å®žä¾‹ã€‚Dockeré•œåƒé€šè¿‡docker image lsæŸ¥çœ‹å½“å‰æœ‰å“ªäº›é•œåƒï¼ˆç­‰ä»·äºŽdocker imagesï¼‰ï¼šå½“å‰æš‚æ— é•œåƒï¼Œå¯ä»¥é€šè¿‡docker pull [OPTIONS] NAME[:TAG|@DIGEST]æ¥ä»Ž DockerHub æ‹‰å–é•œåƒï¼Œæ¯”å¦‚æ‹‰å–ä¸€ä¸ªUbuntué•œåƒï¼šä¸å¸¦tagåˆ™æ˜¯æ‹‰å–æœ€æ–°çš„é•œåƒï¼Œå¯ä»¥é€šè¿‡tagæ¥æŒ‡å®šæ‹‰å–çš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚æ‹‰å–Ubuntu16.04ï¼š1docker pull ubuntu:16.04å¯ä»¥é€šè¿‡docker history [OPTIONS] IMAGEæ¥æŸ¥çœ‹imageçš„æž„å»ºåŽ†å²ï¼ˆå›¾å±‚ï¼‰ï¼šå¯ä»¥é€šè¿‡é•œåƒçš„åç§°æˆ–è€…é•œåƒIDæ¥æŒ‡å®šã€‚ä½¿ç”¨é•œåƒIDçš„æ—¶å€™ï¼Œå¯ä»¥åªæŒ‡å®šå‰å‡ ä½ï¼Œåªè¦èƒ½å”¯ä¸€æ ‡è¯†ä¸€ä¸ªé•œåƒå³å¯ï¼Œæ‰€ä»¥ä¸Šé¢çš„94e814e2efa8å¯ä»¥ç®€å†™ä¸º94eã€‚åˆ é™¤é•œåƒä½¿ç”¨çš„å‘½ä»¤ä¸ºdocker image rm [OPTIONS] IMAGE [IMAGE...]ï¼Œç­‰ä»·äºŽdocker rmi [OPTIONS] IMAGE [IMAGE...]ã€‚æ›´å¤šå…³äºŽé•œåƒçš„å‘½ä»¤å¯ä»¥ä½¿ç”¨docker image --helpæ¥æŸ¥çœ‹ï¼šDockerå®¹å™¨å¯ä»¥é€šè¿‡docker run [OPTIONS] IMAGE [COMMAND] [ARG...]å‘½ä»¤æ¥è¿è¡Œé•œåƒï¼Œç”Ÿæˆå®¹å™¨ï¼Œæ¯”å¦‚è¿è¡Œåˆšåˆšæ‹‰åŽ»ä¸‹æ¥çš„ubuntué•œåƒï¼Œç„¶åŽé€šè¿‡docker container lså‘½ä»¤æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼šæ²¡æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡docker container ls -aå‘½ä»¤æ¥æŸ¥çœ‹æ‰€æœ‰çŠ¶æ€ä¸‹çš„å®¹å™¨ï¼ˆå¯ç®€å†™ä¸ºdocker ps -aï¼‰ï¼šå¯çœ‹åˆ°ï¼Œubuntuè¿™ä¸ªå®¹å™¨çŠ¶æ€ä¸ºExitedé€€å‡ºçŠ¶æ€ï¼Œè¦è®©è¿è¡Œå®¹å™¨å¸¸é©»ï¼Œå¯ä»¥ä½¿ç”¨docker run -itå‘½ä»¤ï¼šæˆ‘ä»¬å·²ç»è¿›å…¥åˆ°ubuntuå®¹å™¨çŽ¯å¢ƒé‡Œäº†ï¼Œå¯ä»¥åœ¨ä¸Šé¢æ‰§è¡Œä»»ä½•ubuntuæ”¯æŒçš„æ“ä½œã€‚è¿™æ—¶å€™æ–°å¼€ä¸€ä¸ªcmdçª—å£ï¼ŒæŸ¥çœ‹ç›®å‰å®¹å™¨çš„çŠ¶æ€ï¼šä¸Šé¢åŒ…å«äº†ä¸€å¼€å§‹åˆ›å»ºçš„exitedçŠ¶æ€çš„å®¹å™¨ä»¥åŠå¸¸é©»å†…å­˜çš„çŠ¶æ€ä¸ºupçš„å®¹å™¨ã€‚é€€å‡ºå®¹å™¨çŽ¯å¢ƒä½¿ç”¨exitå‘½ä»¤å³å¯ã€‚å¯ä»¥ä½¿ç”¨docker container rm [OPTIONS] CONTAINER [CONTAINER...]å‘½ä»¤æ¥åˆ é™¤å®¹å™¨ï¼šä¸Šé¢çš„å‘½ä»¤ä¹Ÿå¯ä»¥ç®€åŒ–ä¸ºdocker rm dd1ã€‚å¯ä»¥é€šè¿‡docker rm $(docker container ls -aq)å‘½ä»¤æ¥ä¸€æ¬¡æ€§åˆ é™¤å…¨éƒ¨çš„containerï¼Œdocker container ls -aqä½œç”¨ä¸ºåˆ—å‡ºæ‰€æœ‰container idã€‚å¯ä»¥ä½¿ç”¨docker rm $(docker container ls -f &quot;status=xxx&quot; -q)æ¥åˆ é™¤æŒ‡å®šçŠ¶æ€çš„å®¹å™¨ï¼Œæ¯”å¦‚ä»…åˆ é™¤çŠ¶æ€ä¸ºExitedçš„å®¹å™¨ï¼š1docker rm $(docker container ls -f "status=exited" -q)å®¹å™¨çŠ¶æ€æ”¹å˜å¯¹äºŽExitedçŠ¶æ€çš„å®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨docker container startæ¥å¯åŠ¨å®¹å™¨ï¼šè¿›å…¥è¿è¡Œä¸­çš„å®¹å™¨çš„å‘½ä»¤ä¸ºï¼šæš‚åœå®¹å™¨ï¼šæ¢å¤å®¹å™¨ï¼šåœæ­¢å®¹å™¨:ä¸‹å›¾å±•ç¤ºäº†Dockerå®¹å™¨çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼šæ›´å¤šå…³äºŽcontainerçš„å‘½ä»¤å¯ä»¥ä½¿ç”¨docker container --helpæ¥æŸ¥çœ‹ï¼šDockeré•œåƒçš„æž„å»ºDockeré•œåƒçš„æž„å»ºæœ‰ä¸¤ç§æ–¹å¼ï¼šåŸºäºŽå®¹å™¨commitå’Œé€šè¿‡Dockerfileæž„å»ºã€‚åŸºäºŽå®¹å™¨æ¯”å¦‚æˆ‘ä»¬åœ¨åˆšåˆšè¿è¡Œä¸­çš„unubtuå®¹å™¨ä¸­å®‰è£…vimæ’ä»¶ï¼šç„¶åŽexité€€å‡ºï¼Œä½¿ç”¨docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]å‘½ä»¤æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒï¼šæŸ¥çœ‹è¯¥é•œåƒçš„historyï¼šåœæ­¢å®¹å™¨ï¼šå¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ˜¯åœ¨idä¸º94e814e2efa8é•œåƒä¸ŠåŠ äº†ä¸€å±‚å›¾å±‚ï¼Œidä¸ºcc7609287eaaï¼Œä¹Ÿå°±æ˜¯æ–°çš„é•œåƒçš„idã€‚ä¸€èˆ¬ä¸æŽ¨èè¿™ç§æ–¹å¼æ¥æž„å»ºé•œåƒï¼Œå› ä¸ºé€šè¿‡ä¿®æ”¹å®¹å™¨commitæ¥æž„å»ºæ–°çš„é•œåƒï¼Œæˆ‘ä»¬ä¸æ¸…æ¥šåŽŸæ¥çš„å®¹å™¨è¢«ä¿®æ”¹äº†ä»€ä¹ˆï¼ˆæ¯”å¦‚å®‰è£…æ¶æ„è½¯ä»¶ï¼‰ã€‚æŽ¨èçš„åšæ³•æ˜¯é€šè¿‡Dockerfileæ¥æž„å»ºé•œåƒã€‚åŸºäºŽDockerfileæ–°å»ºä¸€ä¸ªç›®å½•ï¼š1mkdir ubuntu-vimç„¶åŽåœ¨è¯¥ç›®å½•ä¸‹ç¼–è¾‘Dockerfile12cd ubuntu-vimvim DockerfileDockerfileå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š1234FROM ubuntuRUN apt-get updateRUN apt-get installRUN apt-get install -y vimæ„æ€æ˜¯åœ¨ubuntuè¿™ä¸ªé•œåƒåŸºç¡€ä¸Šï¼Œåˆ†åˆ«è¿è¡Œapt-get updateï¼Œapt-get installå’Œapt-get install -y vimï¼ˆ-yæŒ‡çš„æ˜¯åœ¨å‘½ä»¤è¡Œäº¤äº’æç¤ºä¸­ï¼Œç›´æŽ¥è¾“å…¥ yesï¼‰ã€‚åˆ›å»ºå¥½è¿™ä¸ªDockerfileåŽï¼Œè¿è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤æ¥æž„å»ºé•œåƒï¼šæ„æ€æ˜¯é€šè¿‡å½“å‰ç›®å½•ä¸‹çš„Dockerfileæž„å»ºè¿›è¡Œï¼Œé•œåƒåç§°ä¸ºmrbird/ubuntu-vim-dkã€‚æž„å»ºå¥½åŽï¼ŒæŸ¥çœ‹å½“å‰é•œåƒåˆ—è¡¨ï¼šå…¶å¤§å°å’Œæˆ‘ä¹‹å‰é€šè¿‡ä¿®æ”¹å®¹å™¨çš„æ–¹å¼æž„å»ºçš„é•œåƒä¸€æ ·ã€‚æŸ¥çœ‹å…¶historyï¼šå¯ä»¥çœ‹åˆ°Dockerfileçš„æ¯ä¸€è¡ŒRUNæŒ‡ä»¤éƒ½åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å›¾å±‚ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æ¥æž„å»ºé•œåƒçš„å¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ†äº«Dockerfileçš„æ–¹å¼æ¥åˆ†äº«å®¹å™¨ï¼Œå¹¶ä¸”å¯¹åŽŸé•œåƒçš„ä¿®æ”¹è¿‡ç¨‹ä¸€ç›®äº†ç„¶ã€‚å‘å¸ƒé•œåƒæˆ‘ä»¬å¯ä»¥å°†æœ¬åœ°æž„å»ºçš„é•œåƒå‘å¸ƒåˆ° Docker Hub ä¸Šã€‚é¦–å…ˆå¾—åœ¨ Docker Hub ä¸Šæ³¨å†Œä¸ªè´¦å·ï¼šæˆ‘çš„idä¸ºwuyouzhuguliã€‚ç„¶åŽæ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªDockerfileï¼š123mkdir hellocd hellovim Dockerfile123FROM centosLABEL user=&quot;mrbird&quot; email=&quot;852252810@qq.com&quot; description=&quot;hello demo&quot;CMD echo &quot;hello docker by mrbird&quot;æŽ¥ç€é€šè¿‡è¿™ä¸ªDockerfileæž„å»ºé•œåƒ:tagéƒ¨åˆ†å¿…é¡»å’Œä¸Šé¢æ³¨å†Œè´¦å·ä¸€è‡´ã€‚ç„¶åŽä½¿ç”¨å‘½ä»¤docker loginç™»å½• Dockerï¼šç™»å½•æˆåŠŸï¼Œå¼€å§‹pushæ“ä½œï¼špushæˆåŠŸï¼ŒæŸ¥çœ‹ Docker Hubï¼šå…³è”Githubåˆ›å»ºé™¤äº†é€šè¿‡docker pushå¾€Docker Hubä¸Šä¼ é•œåƒå¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…³è”Githubä»“åº“çš„æ–¹å¼æ¥åˆ›å»ºé•œåƒã€‚é¦–å…ˆåœ¨Githubä¸‹æ–°å»ºä¸€ä¸ªä»“åº“ï¼Œç„¶åŽä¸Šä¼ Dockerfileï¼šç„¶åŽå›žåˆ°Docker Hubï¼Œæ–°å»ºä¸€ä¸ªä»“åº“ï¼šå…³è”Githubè´¦å·ï¼Œç„¶åŽç‚¹å‡»Createï¼Œç„¶åŽåœ¨Buildsé€‰é¡¹å¡é‡Œé€‰æ‹©Githubï¼šç„¶åŽé€‰æ‹©Githubçš„Dockerfilesä»“åº“ï¼Œè·¯å¾„é€‰æ‹©helloï¼šç‚¹å‡»save and buildæŒ‰é’®åŽï¼ŒDocker Hubä¼šæ ¹æ®å…³è”çš„Githubä»“åº“ä¸‹çš„Dockerfileæ¥æž„å»ºä¸€ä¸ªé•œåƒï¼šä¸€èˆ¬æŽ¨èè¿™ç§æ–¹å¼ã€‚å‚è€ƒé“¾æŽ¥ï¼šhttps://docs.docker.com/v17.09/engine/userguide/storagedriver/imagesandcontainers/#images-and-layershttps://stackoverflow.com/questions/21498832/in-docker-whats-the-difference-between-a-container-and-an-image]]></content>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨Vagrantåˆ›å»ºCentOSè™šæ‹Ÿæœº]]></title>
    <url>%2FCreate-Virtual-Machine-By-Vagrant.html</url>
    <content type="text"><![CDATA[Vagrantæ˜¯ä¸€æ¬¾ç”±HashiCorpå…¬å¸æä¾›çš„ï¼Œç”¨äºŽå¿«é€Ÿæž„å»ºè™šæ‹ŸæœºçŽ¯å¢ƒçš„è½¯ä»¶ã€‚æœ¬èŠ‚æˆ‘ä»¬å°†ä½¿ç”¨Vagrantç»“åˆOracle VM VirtualBoxå¿«é€Ÿåœ°åœ¨win10çŽ¯å¢ƒä¸‹æž„å»ºCentOS7è™šæ‹Ÿæœºã€‚åœ¨æ­¤ä¹‹å‰éœ€è¦å…ˆå®‰è£…å¥½ Vagrant å’Œ VirtualBoxã€‚æž„å»ºCentOS7è™šæ‹Ÿæœºåœ¨https://app.vagrantup.com/boxes/searchä¸‹æœç´¢centosï¼šç„¶åŽåœ¨win10ä»»æ„ç›˜ç¬¦ä¸‹åˆ›å»ºvagrant_vmç›®å½•ï¼ˆæ³¨æ„ç›®å½•æœ€å¥½ä¸è¦æœ‰ä¸­æ–‡å’Œç©ºæ ¼ï¼‰ï¼Œç„¶åŽåœ¨è¯¥ç›®å½•ä¸‹ä½¿ç”¨cmdæ‰§è¡Œvagrant init centos/7å‘½ä»¤ï¼šç„¶åŽæ‰§è¡Œvagrant upå¯åŠ¨ï¼ˆè¿™æ—¶å€™æœ€å¥½ä¹Ÿæ‰“å¼€VirtualBoxï¼‰ï¼šæž„å»ºå®Œæ¯•ï¼Œè¿™æ—¶å€™VirtualBoxçš„åˆ—è¡¨é‡Œä¼šå‡ºçŽ°ä¸€å°æ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºï¼šè¿™å°±æ˜¯æˆ‘ä»¬åˆšåˆšé€šè¿‡Vagrantæž„å»ºçš„CentOS7è™šæ‹Ÿæœºäº†ã€‚å¦‚æžœå½“ä½ æ‰§è¡Œvagrant upå‘½ä»¤åŽï¼Œè™šæ‹Ÿæœºæ–‡ä»¶ä¸‹è½½éžå¸¸çš„æ…¢çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼æ¥æž„å»ºï¼šåœ¨ä¸Šé¢çš„æ—¥å¿—ä¸­å¯ä»¥æ‰¾åˆ°è¿™ä¹ˆä¸€è¡Œï¼š1Downloading: https://vagrantcloud.com/centos/boxes/7/versions/1902.01/providers/virtualbox.boxåŽé¢è¿™ä¸ªURLå°±æ˜¯ä¸‹è½½åœ°å€äº†ï¼Œå°†å®ƒé»è´´åˆ°è¿…é›·ç­‰ä¸‹è½½å·¥å…·ä¸‹è½½å³å¯ã€‚ç„¶åŽå°†ä¸‹è½½å¥½åŽçš„xxx.boxæ–‡ä»¶å¤åˆ¶åˆ°vagrant_vmç›®å½•ä¸‹ï¼Œå¹¶ä¸”é‡å‘½åä¸ºcentos7.boxï¼ˆåˆ é™¤centos7.boxä¹‹å¤–çš„æ–‡ä»¶å’Œç›®å½•ï¼Œåªä¿ç•™centos7.boxä¸€ä¸ªæ–‡ä»¶ï¼‰ã€‚æŽ¥ç€è¿è¡Œvagrant box add -name &#39;centos/7&#39; centos7.boxå‘½ä»¤ï¼šæ·»åŠ æˆåŠŸåŽæ‰§è¡Œvagrant init centos/7åˆå§‹åŒ–ï¼šåˆå§‹åŒ–æˆåŠŸåŽæ‰§è¡Œvagrant upå¯åŠ¨ï¼šæž„å»ºæˆåŠŸï¼Œæ•ˆæžœå’Œä¸€å¼€å§‹åœ¨çº¿ä¸‹è½½æž„å»ºæ˜¯ä¸€æ ·çš„ã€‚è¿žæŽ¥è™šæ‹Ÿæœºæˆ‘ä»¬å…ˆç”¨vagrant statuså‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹è™šæ‹Ÿæœºçš„çŠ¶æ€ï¼šå¯ä»¥çœ‹åˆ°è™šæ‹Ÿæœºæ˜¯è¿è¡Œä¸­çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œvagrant haltæ¥å…³é—­è™šæ‹Ÿæœºï¼šå¯åŠ¨è™šæ‹Ÿæœºçš„å‘½ä»¤ä¸ºvagrant upï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨vagrant suspendå‘½ä»¤æ¥æš‚åœè¿è¡Œä¸­çš„è™šæ‹Ÿæœºï¼Œä»¥ä¿æŒå®ƒçš„è¿è¡ŒçŠ¶æ€ï¼šæš‚åœåŽå¯ä»¥ä½¿ç”¨vagrant resumeå‘½ä»¤æ¥æ¢å¤è™šæ‹Ÿæœºï¼šè¿žæŽ¥æ­£åœ¨è¿è¡Œä¸­çš„è™šæ‹Ÿæœºçš„å‘½ä»¤ä¸ºvagrant sshï¼šé‡å¯è™šæ‹Ÿæœºä½¿ç”¨çš„å‘½ä»¤ä¸ºvagrant reloadã€‚å¦‚æžœä½ ä¸æƒ³è¦è¿™ä¸ªè™šæ‹Ÿæœºçš„è¯å¯ä»¥ä½¿ç”¨vagrant distroyå‘½ä»¤è¿›è¡Œé”€æ¯ã€‚ç›®å½•å…±äº«Vagrantçš„æ ¹ç›®å½•ï¼ˆå°±æ˜¯æˆ‘ä»¬ä¸€å¼€å§‹åˆ›å»ºçš„vagrant_vmï¼‰å’Œè™šæ‹Ÿæœºé‡Œçš„/vagrantç›®å½•æ˜¯å…±äº«çš„ã€‚æˆ‘ä»¬åœ¨vagrant_vmç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªhello.txtæ–‡ä»¶ï¼Œå†…å®¹ä¸ºhelloï¼šç„¶åŽè¿žæŽ¥è™šæ‹Ÿæœºï¼ŒæŸ¥çœ‹è™šæ‹Ÿæœº/vagrantç›®å½•ä¸‹æœ‰ä»€ä¹ˆå†…å®¹:è¯´æ˜ŽåŒæ­¥æˆåŠŸã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å…±äº«è·¯åŠ²ï¼Œç¼–è¾‘vagrant_vmæ–‡ä»¶å¤¹ä¸‹çš„Vagrantfileæ–‡ä»¶ï¼šåœ¨è¿™è¡Œä¸‹é¢æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š1config.vm.synced_folder &quot;./data&quot;, &quot;/share&quot;, create:true, owner: &quot;root&quot;, group: &quot;root&quot;è¿™ä¸ªé…ç½®çš„æ„æ€æ˜¯å°†å½“å‰è·¯å¾„ä¸‹çš„dataæ–‡ä»¶å¤¹å’Œè™šæ‹Ÿæœºçš„/shareç›®å½•å…±äº«ï¼Œæ‹¥æœ‰è€…ä¸ºrootï¼Œç¾¤ç»„ä¸ºrootï¼Œå¦‚æžœè·¯å¾„ä¸å­˜åœ¨åˆ™åˆ›å»ºã€‚ä¿®æ”¹äº†Vagrantfileæ–‡ä»¶éœ€è¦æ‰§è¡Œ vagrant reloadé‡å¯ã€‚é‡å¯åŽæˆ‘ä»¬åœ¨dataæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªworld.txtæ–‡ä»¶ï¼Œç„¶åŽè¿žæŽ¥è™šæ‹Ÿæœºçœ‹çœ‹æ˜¯å¦å…±äº«æˆåŠŸï¼šå…±äº«æˆåŠŸï¼åœ¨è¿™é€”ä¸­ï¼Œé‡åˆ°äº†å¦‚ä¸‹é—®é¢˜:Vagrant was unable to mount VirtualBox shared folders. This is usually because the filesystem â€œvboxsfâ€ is not available. This filesystem is made available via the VirtualBox Guest Additions and kernel module. Please verify that these guest additions are properly installed in the guest. This is not a bug in Vagrant and is usually caused by a faulty Vagrant box. For context, the command attempted wasâ€¦The error output from the command was: mount: unknown filesystem type â€˜vboxsfâ€™å®‰è£…ä¸‹é¢è¿™ä¸ªæ’ä»¶å¯è§£å†³é—®é¢˜ï¼š1vagrant plugin install vagrant-vbguestç½‘ç»œé…ç½®è™šæ‹Ÿæœºç§æœ‰ç½‘ç»œåœ¨Vagrantfileé‡Œæ‰“å¼€ä¸‹é¢è¿™è¡Œé…ç½®ï¼šç„¶åŽä½¿ç”¨å‘½ä»¤vagrant reloadé‡å¯è™šæ‹Ÿæœºï¼Œé‡å¯åŽæˆ‘ä»¬ä½¿ç”¨pingå‘½ä»¤çœ‹æ˜¯å¦å¯ä»¥åœ¨windowsä¸Šè®¿é—®åˆ°è¿™ä¸ªipï¼šè®¿é—®æˆåŠŸï¼Œè¿žæŽ¥è™šæ‹Ÿæœºï¼Œä½¿ç”¨ifconfigæŸ¥çœ‹å…¶IPï¼šæ­£æ˜¯æˆ‘ä»¬åˆšåˆšé…ç½®çš„é‚£ä¸ªIPã€‚è™šæ‹Ÿæœºå…¬æœ‰ç½‘ç»œç¼–è¾‘Vagrantfileï¼Œå°†æˆ‘ä»¬åˆšåˆšå¼€å¯çš„ç§æœ‰ç½‘ç»œé…ç½®æ³¨é‡Šï¼Œç„¶åŽå¼€å¯ä¸‹é¢è¿™è¡Œé…ç½®ï¼šç„¶åŽé‡å¯è™šæ‹Ÿæœºï¼Œé‡å¯è¿‡ç¨‹ä¸­ä¼šç„¶ä½ æ ¹æ®å½“å‰ç½‘ç»œçŽ¯å¢ƒé€‰æ‹©ï¼šå› ä¸ºæˆ‘ç”µè„‘è¿žæŽ¥çš„æ˜¯å®¶é‡Œwifiæ‰€ä»¥é€‰æ‹©ç¬¬å››ä¸ªé€‰é¡¹ï¼Œé‡å¯å¥½åŽè¿žæŽ¥è™šæ‹Ÿæœºï¼ŒæŸ¥çœ‹å…¶IPï¼šæ–°å¼€ä¸€ä¸ªcmdçª—å£ï¼Œping è¿™ä¸ªåœ°å€çœ‹æ˜¯å¦èƒ½é€š:å…¬æœ‰ç½‘ç»œå’Œç§æœ‰ç½‘ç»œçš„åŒºåˆ«æ˜¯ï¼Œå…¬æœ‰ç½‘ç»œæ˜¯æ— çº¿è·¯ç”±å™¨è‡ªåŠ¨åˆ†é…çš„IPåœ°å€ï¼Œå¹¶ä¸”åœ¨åŒä¸€ä¸ªwifiç½‘ç»œä¸‹çš„å…¶ä»–è®¾å¤‡ä¹Ÿæ˜¯å¯ä»¥è®¿é—®è¿™ä¸ªIPåœ°å€çš„ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨windowsæµè§ˆå™¨é‡Œè¾“å…¥http://192.168.28.83/ï¼šç„¶åŽè®©æ‰‹æœºè¿žæŽ¥å’Œç”µè„‘ç›¸åŒçš„wifiç½‘ç»œï¼Œå¹¶ä¸”è®¿é—®http://192.168.28.83/ï¼šç»“æžœè¯´æ˜Žå…¬æœ‰ç½‘ç»œé…ç½®æˆåŠŸã€‚å¤šä¸»æœºé…ç½®ä½¿ç”¨Vagrantå¯ä»¥è½»æ¾åœ°åˆ›å»ºå¤šå°è™šæ‹Ÿä¸»æœºã€‚ä¸‹é¢æˆ‘ä»¬å¼€å§‹é€šè¿‡Vagrantæ¥åˆ›å»ºä¸¤å°æ–°çš„è™šæ‹Ÿä¸»æœºâ€œprodâ€å’Œâ€œdevâ€ã€‚åœ¨vagrant_vmç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œåç§°ä¸ºmultiï¼Œç„¶åŽé€šè¿‡çŽ°æœ‰çš„boxæ¥åˆå§‹åŒ–ä¸€ä¸ªVagrantfileé…ç½®ï¼šæŽ¥ç€ç¼–è¾‘multiç›®å½•ä¸‹çš„Vagrantfileæ–‡ä»¶ï¼Œæ–°å¢žä¸‹é¢ä¸¤é¡¹é…ç½®ï¼šè¿è¡Œvagrant statusï¼šå¯ä»¥çœ‹åˆ°å¤šäº†ä¸¤å°çŠ¶æ€ä¸ºnot createdçš„è™šæ‹Ÿæœºï¼Œåç§°åˆ†åˆ«ä¸ºâ€œprodâ€å’Œâ€œdevâ€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨vagrant upæ¥å¯åŠ¨ä¸¤å°ä¸»æœºï¼Œä¹Ÿå¯ä»¥é€šè¿‡vagrant up prodæ¥å•ç‹¬å¯åŠ¨â€œprodâ€è¿™å°è™šæ‹Ÿä¸»æœºã€‚å¯åŠ¨åŽï¼ˆç¬¬ä¸€æ¬¡å¯åŠ¨è€—æ—¶å¯èƒ½æ¯”è¾ƒé•¿ï¼‰ï¼Œä½¿ç”¨vagrant statusæ¥æŸ¥çœ‹å®ƒä»¬çš„çŠ¶æ€ï¼šé€šè¿‡vagrant ssh ä¸»æœºåå°±å¯ä»¥è¿žæŽ¥ä¸Šå®ƒä»¬äº†ã€‚ç½‘ç»œé…ç½®æŽ¥ä¸‹æ¥å¼€å§‹é…ç½®ç½‘ç»œï¼Œè®©å®ƒä»¬ä¹‹é—´å¯ä»¥é€šè®¯ã€‚æˆ‘ä»¬æŒ‰ç…§ä¸Šé¢ä»‹ç»ç½‘ç»œé…ç½®çš„æ–¹å¼æ¥ä¸ºè¿™ä¸¤å°è™šæ‹Ÿä¸»æœºé…ç½®ç§æœ‰ç½‘ç»œï¼šå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨é…ç½®ç§æœ‰ç½‘ç»œçš„æ—¶å€™ï¼ŒIPç½‘æ®µä¸èƒ½å’ŒWindowsä¸»æœºç›¸åŒã€‚é…ç½®å¥½åŽé‡å¯è¿™ä¸¤å°è™šæ‹Ÿæœºï¼Œç„¶åŽåˆ†åˆ«è¿žæŽ¥è¿™ä¸¤å°è™šæ‹Ÿæœºï¼Œçœ‹æ˜¯å¦èƒ½å¤Ÿpingé€šï¼šé…ç½®æˆåŠŸã€‚è‡ªå®šä¹‰ä¸»æœºåç¼–è¾‘Vagrantfileï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼šé‡å¯åŽï¼Œè¿žæŽ¥è™šæ‹Ÿæœºï¼Œå¯ä»¥çœ‹åˆ°hostnameå·²ç»ä¿®æ”¹ä¸ºæˆ‘ä»¬è®¾ç½®çš„åç§°äº†ï¼šå¤šä¸»æœºçš„å…±äº«ç›®å½•é»˜è®¤çš„è¿™ä¸¤å°è™šæ‹Ÿä¸»æœºçš„/vagrantå’Œå½“å‰ç›®å½•multi/æ˜¯å…±äº«çš„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ†åˆ«ä¸ºå®ƒä»¬è®¾ç½®ä¸åŒçš„å…±äº«ç›®å½•ã€‚ç¼–è¾‘Vagrantfileï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼šç„¶åŽé‡å¯è¿™ä¸¤å°è™šæ‹Ÿä¸»æœºå°±å¥½äº†ã€‚æ›´å¤šVagrantçš„é…ç½®å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼šhttps://www.vagrantup.com/docs/]]></content>
      <tags>
        <tag>Vagrant</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot ä¸­çš„å¼‚æ­¥è°ƒç”¨]]></title>
    <url>%2FSpring-Boot-Async.html</url>
    <content type="text"><![CDATA[é€šå¸¸æˆ‘ä»¬å¼€å‘çš„ç¨‹åºéƒ½æ˜¯åŒæ­¥è°ƒç”¨çš„ï¼Œå³ç¨‹åºæŒ‰ç…§ä»£ç çš„é¡ºåºä¸€è¡Œä¸€è¡Œçš„é€æ­¥å¾€ä¸‹æ‰§è¡Œï¼Œæ¯ä¸€è¡Œä»£ç éƒ½å¿…é¡»ç­‰å¾…ä¸Šä¸€è¡Œä»£ç æ‰§è¡Œå®Œæ¯•æ‰èƒ½å¼€å§‹æ‰§è¡Œã€‚è€Œå¼‚æ­¥ç¼–ç¨‹åˆ™æ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œä»£ç çš„è°ƒç”¨ä¸å†æ˜¯é˜»å¡žçš„ã€‚æ‰€ä»¥åœ¨ä¸€äº›æƒ…æ™¯ä¸‹ï¼Œé€šè¿‡å¼‚æ­¥ç¼–ç¨‹å¯ä»¥æé«˜æ•ˆçŽ‡ï¼Œæå‡æŽ¥å£çš„åžåé‡ã€‚è¿™èŠ‚å°†ä»‹ç»å¦‚ä½•åœ¨Spring Bootä¸­è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹ã€‚å¼€å¯å¼‚æ­¥æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.1.0.RELEASEï¼Œå¹¶å¼•å…¥spring-boot-starter-webä¾èµ–ï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹æ‰€ç¤ºï¼šè¦å¼€å¯å¼‚æ­¥æ”¯æŒï¼Œé¦–å…ˆå¾—åœ¨Spring Bootå…¥å£ç±»ä¸ŠåŠ ä¸Š@EnableAsyncæ³¨è§£ï¼š1234567@SpringBootApplication@EnableAsyncpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;æŽ¥ä¸‹æ¥å¼€å§‹ç¼–å†™å¼‚æ­¥æ–¹æ³•ã€‚åœ¨com.example.demoè·¯å¾„ä¸‹æ–°å»ºserviceåŒ…ï¼Œå¹¶åˆ›å»ºTestServiceï¼š1234567891011121314151617181920212223@Servicepublic class TestService &#123; private Logger logger = LoggerFactory.getLogger(this.getClass()); @Async public void asyncMethod() &#123; sleep(); logger.info("å¼‚æ­¥æ–¹æ³•å†…éƒ¨çº¿ç¨‹åç§°ï¼š&#123;&#125;", Thread.currentThread().getName()); &#125; public void syncMethod() &#123; sleep(); &#125; private void sleep() &#123; try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;&#125;ä¸Šé¢çš„Serviceä¸­åŒ…å«ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•asyncMethodï¼ˆå¼€å¯å¼‚æ­¥æ”¯æŒåŽï¼Œåªéœ€è¦åœ¨æ–¹æ³•ä¸ŠåŠ ä¸Š@Asyncæ³¨è§£ä¾¿æ˜¯å¼‚æ­¥æ–¹æ³•äº†ï¼‰å’ŒåŒæ­¥æ–¹æ³•syncMethodã€‚sleepæ–¹æ³•ç”¨äºŽè®©å½“å‰çº¿ç¨‹é˜»å¡ž2ç§’é’Ÿã€‚æŽ¥ç€åœ¨com.example.demoè·¯å¾„ä¸‹æ–°å»ºcontrolleråŒ…ï¼Œç„¶åŽåˆ›å»ºTestControllerï¼š1234567891011121314151617181920212223242526272829303132@RestControllerpublic class TestController &#123; private Logger logger = LoggerFactory.getLogger(this.getClass()); @Autowired private TestService testService; @GetMapping("async") public void testAsync() &#123; long start = System.currentTimeMillis(); logger.info("å¼‚æ­¥æ–¹æ³•å¼€å§‹"); testService.asyncMethod(); logger.info("å¼‚æ­¥æ–¹æ³•ç»“æŸ"); long end = System.currentTimeMillis(); logger.info("æ€»è€—æ—¶ï¼š&#123;&#125; ms", end - start); &#125; @GetMapping("sync") public void testSync() &#123; long start = System.currentTimeMillis(); logger.info("åŒæ­¥æ–¹æ³•å¼€å§‹"); testService.syncMethod(); logger.info("åŒæ­¥æ–¹æ³•ç»“æŸ"); long end = System.currentTimeMillis(); logger.info("æ€»è€—æ—¶ï¼š&#123;&#125; ms", end - start); &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—® http://localhost:8080/sync è¯·æ±‚ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šå¯çœ‹åˆ°é»˜è®¤ç¨‹åºæ˜¯åŒæ­¥çš„ï¼Œç”±äºŽsleepæ–¹æ³•é˜»å¡žçš„åŽŸå› ï¼ŒtestSyncæ–¹æ³•æ‰§è¡Œäº†2ç§’é’Ÿä»¥ä¸Šã€‚è®¿é—® http://localhost:8080/async ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šå¯çœ‹åˆ°testAsyncæ–¹æ³•è€—æ—¶æžå°‘ï¼Œå› ä¸ºå¼‚æ­¥çš„åŽŸå› ï¼Œç¨‹åºå¹¶æ²¡æœ‰è¢«sleepæ–¹æ³•é˜»å¡žï¼Œè¿™å°±æ˜¯å¼‚æ­¥è°ƒç”¨çš„å¥½å¤„ã€‚åŒæ—¶å¼‚æ­¥æ–¹æ³•å†…éƒ¨ä¼šæ–°å¯ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œï¼Œè¿™é‡Œçº¿ç¨‹åç§°ä¸ºtask - 1ã€‚é»˜è®¤æƒ…å†µä¸‹çš„å¼‚æ­¥çº¿ç¨‹æ± é…ç½®ä½¿å¾—çº¿ç¨‹ä¸èƒ½è¢«é‡ç”¨ï¼Œæ¯æ¬¡è°ƒç”¨å¼‚æ­¥æ–¹æ³•éƒ½ä¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šä¹‰å¼‚æ­¥çº¿ç¨‹æ± æ¥ä¼˜åŒ–ã€‚è‡ªå®šä¹‰å¼‚æ­¥çº¿ç¨‹æ± åœ¨com.example.demoä¸‹æ–°å»ºconfigåŒ…ï¼Œç„¶åŽåˆ›å»ºAsyncPoolConfigé…ç½®ç±»ï¼š1234567891011121314151617181920@Configurationpublic class AsyncPoolConfig &#123; @Bean public ThreadPoolTaskExecutor asyncThreadPoolTaskExecutor()&#123; ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor(); executor.setCorePoolSize(20); executor.setMaxPoolSize(200); executor.setQueueCapacity(25); executor.setKeepAliveSeconds(200); executor.setThreadNamePrefix("asyncThread"); executor.setWaitForTasksToCompleteOnShutdown(true); executor.setAwaitTerminationSeconds(60); executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy()); executor.initialize(); return executor; &#125;&#125;ä¸Šé¢æˆ‘ä»¬é€šè¿‡ThreadPoolTaskExecutorçš„ä¸€äº›æ–¹æ³•è‡ªå®šä¹‰äº†ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œè¿™äº›æ–¹æ³•çš„å«ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼šcorePoolSizeï¼šçº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹çš„æ•°é‡ï¼Œé»˜è®¤å€¼ä¸º1ï¼ˆè¿™å°±æ˜¯é»˜è®¤æƒ…å†µä¸‹çš„å¼‚æ­¥çº¿ç¨‹æ± é…ç½®ä½¿å¾—çº¿ç¨‹ä¸èƒ½è¢«é‡ç”¨çš„åŽŸå› ï¼‰ã€‚maxPoolSizeï¼šçº¿ç¨‹æ± ç»´æŠ¤çš„çº¿ç¨‹çš„æœ€å¤§æ•°é‡ï¼Œåªæœ‰å½“æ ¸å¿ƒçº¿ç¨‹éƒ½è¢«ç”¨å®Œå¹¶ä¸”ç¼“å†²é˜Ÿåˆ—æ»¡åŽï¼Œæ‰ä¼šå¼€å§‹ç”³è¶…è¿‡è¯·æ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹ï¼Œé»˜è®¤å€¼ä¸ºInteger.MAX_VALUEã€‚queueCapacityï¼šç¼“å†²é˜Ÿåˆ—ã€‚keepAliveSecondsï¼šè¶…å‡ºæ ¸å¿ƒçº¿ç¨‹æ•°å¤–çš„çº¿ç¨‹åœ¨ç©ºé—²æ—¶å€™çš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼Œé»˜è®¤ä¸º60ç§’ã€‚threadNamePrefixï¼šçº¿ç¨‹åå‰ç¼€ã€‚waitForTasksToCompleteOnShutdownï¼šæ˜¯å¦ç­‰å¾…æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰å…³é—­çº¿ç¨‹æ± ï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚awaitTerminationSecondsï¼šwaitForTasksToCompleteOnShutdownçš„ç­‰å¾…çš„æ—¶é•¿ï¼Œé»˜è®¤å€¼ä¸º0ï¼Œå³ä¸ç­‰å¾…ã€‚rejectedExecutionHandlerï¼šå½“æ²¡æœ‰çº¿ç¨‹å¯ä»¥è¢«ä½¿ç”¨æ—¶çš„å¤„ç†ç­–ç•¥ï¼ˆæ‹’ç»ä»»åŠ¡ï¼‰ï¼Œé»˜è®¤ç­–ç•¥ä¸ºabortPolicyï¼ŒåŒ…å«ä¸‹é¢å››ç§ç­–ç•¥ï¼šcallerRunsPolicyï¼šç”¨äºŽè¢«æ‹’ç»ä»»åŠ¡çš„å¤„ç†ç¨‹åºï¼Œå®ƒç›´æŽ¥åœ¨ execute æ–¹æ³•çš„è°ƒç”¨çº¿ç¨‹ä¸­è¿è¡Œè¢«æ‹’ç»çš„ä»»åŠ¡ï¼›å¦‚æžœæ‰§è¡Œç¨‹åºå·²å…³é—­ï¼Œåˆ™ä¼šä¸¢å¼ƒè¯¥ä»»åŠ¡ã€‚abortPolicyï¼šç›´æŽ¥æŠ›å‡ºjava.util.concurrent.RejectedExecutionExceptionå¼‚å¸¸ã€‚discardOldestPolicyï¼šå½“çº¿ç¨‹æ± ä¸­çš„æ•°é‡ç­‰äºŽæœ€å¤§çº¿ç¨‹æ•°æ—¶ã€æŠ›å¼ƒçº¿ç¨‹æ± ä¸­æœ€åŽä¸€ä¸ªè¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œæ–°ä¼ å…¥çš„ä»»åŠ¡ã€‚discardPolicyï¼šå½“çº¿ç¨‹æ± ä¸­çš„æ•°é‡ç­‰äºŽæœ€å¤§çº¿ç¨‹æ•°æ—¶ï¼Œä¸åšä»»ä½•åŠ¨ä½œã€‚è¦ä½¿ç”¨è¯¥çº¿ç¨‹æ± ï¼Œåªéœ€è¦åœ¨@Asyncæ³¨è§£ä¸ŠæŒ‡å®šçº¿ç¨‹æ± Beanåç§°å³å¯ï¼š12345678910@Servicepublic class TestService &#123; ...... @Async("asyncThreadPoolTaskExecutor") public void asyncMethod() &#123; ...... &#125; ......&#125;é‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—® http://localhost:8080/async ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå…¥ä¸‹ï¼šå¤„ç†å¼‚æ­¥å›žè°ƒå¦‚æžœå¼‚æ­¥æ–¹æ³•å…·æœ‰è¿”å›žå€¼çš„è¯ï¼Œéœ€è¦ä½¿ç”¨Futureæ¥æŽ¥æ”¶å›žè°ƒå€¼ã€‚æˆ‘ä»¬ä¿®æ”¹TestServiceçš„asyncMethodæ–¹æ³•ï¼Œç»™å…¶æ·»åŠ è¿”å›žå€¼ï¼š123456@Async("asyncThreadPoolTaskExecutor")public Future&lt;String&gt; asyncMethod() &#123; sleep(); logger.info("å¼‚æ­¥æ–¹æ³•å†…éƒ¨çº¿ç¨‹åç§°ï¼š&#123;&#125;", Thread.currentThread().getName()); return new AsyncResult&lt;&gt;("hello async");&#125;æ³›åž‹æŒ‡å®šè¿”å›žå€¼çš„ç±»åž‹ï¼ŒAsyncResultä¸ºSpringå®žçŽ°çš„Futureå®žçŽ°ç±»ï¼šæŽ¥ç€æ”¹é€ TestControllerçš„testAsyncæ–¹æ³•ï¼š123456789101112131415@GetMapping("async")public String testAsync() throws Exception &#123; long start = System.currentTimeMillis(); logger.info("å¼‚æ­¥æ–¹æ³•å¼€å§‹"); Future&lt;String&gt; stringFuture = testService.asyncMethod(); String result = stringFuture.get(); logger.info("å¼‚æ­¥æ–¹æ³•è¿”å›žå€¼ï¼š&#123;&#125;", result); logger.info("å¼‚æ­¥æ–¹æ³•ç»“æŸ"); long end = System.currentTimeMillis(); logger.info("æ€»è€—æ—¶ï¼š&#123;&#125; ms", end - start); return stringFuture.get();&#125;FutureæŽ¥å£çš„getæ–¹æ³•ç”¨äºŽèŽ·å–å¼‚æ­¥è°ƒç”¨çš„è¿”å›žå€¼ã€‚é‡å¯é¡¹ç›®ï¼Œè®¿é—® http://localhost:8080/async æŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹æ‰€ç¤º:é€šè¿‡è¿”å›žç»“æžœæˆ‘ä»¬å¯ä»¥çœ‹å‡ºFutureçš„getæ–¹æ³•ä¸ºé˜»å¡žæ–¹æ³•ï¼Œåªæœ‰å½“å¼‚æ­¥æ–¹æ³•è¿”å›žå†…å®¹äº†ï¼Œç¨‹åºæ‰ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚getè¿˜æœ‰ä¸€ä¸ªget(long timeout, TimeUnit unit)é‡è½½æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªé‡è½½æ–¹æ³•è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå³å¼‚æ­¥æ–¹æ³•åœ¨è®¾å®šæ—¶é—´å†…æ²¡æœ‰è¿”å›žå€¼çš„è¯ï¼Œç›´æŽ¥æŠ›å‡ºjava.util.concurrent.TimeoutExceptionå¼‚å¸¸ã€‚æ¯”å¦‚è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º60ç§’ï¼š1String result = stringFuture.get(60, TimeUnit.SECONDS);æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/49.Spring-Boot-Async]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot ä¸­å¤„ç†è·¨åŸŸ]]></title>
    <url>%2FSpring-Boot-Deal-CORS.html</url>
    <content type="text"><![CDATA[HTML 5ä¸­æ–°å¢žçš„è·¨åŸŸèµ„æºè®¿é—®ï¼ˆCross-Origin Resource Sharingï¼‰ç‰¹æ€§å¯ä»¥è®©æˆ‘ä»¬åœ¨å¼€å‘åŽç«¯ç³»ç»Ÿçš„æ—¶å€™å†³å®šèµ„æºæ˜¯å¦å…è®¸è¢«è·¨åŸŸè®¿é—®ã€‚æ‰€è°“è·¨åŸŸæŒ‡çš„æ˜¯åŸŸåä¸åŒæˆ–è€…ç«¯å£ä¸åŒæˆ–è€…åè®®ä¸åŒï¼Œæ¯”å¦‚å½“ä»Žmrbrid.ccç½‘ç«™è®¿é—®mrbird.cc:8080ç½‘ç«™èµ„æºå°±ä¼šå­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚Springä»Ž4.2ç‰ˆæœ¬å¼€å§‹å°±æä¾›äº†è·¨åŸŸçš„æ”¯æŒï¼Œå¼€ç®±å³ç”¨ã€‚è¿™é‡Œä»‹ç»å¦‚ä½•åœ¨Spring Bootå¼€å‘ä¸­è§£å†³è·¨åŸŸçš„é—®é¢˜ï¼Œä¸»è¦åˆ†ä¸ºæ³¨è§£é©±åŠ¨å’ŒæŽ¥å£ç¼–ç¨‹çš„æ–¹å¼ã€‚æ¨¡æ‹Ÿè·¨åŸŸè¦è§£å†³è·¨åŸŸé—®é¢˜ï¼Œæˆ‘ä»¬å°±å¾—å…ˆæ¨¡æ‹Ÿä¸€ä¸ªè·¨åŸŸæƒ…æ™¯ã€‚æ–°å»ºSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.1.0.RELEASEï¼Œå¹¶å¼•å¦‚ä¸‹ä¾èµ–ï¼š12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&lt;/dependency&gt;é¡¹ç›®ç»“æž„å¦‚ä¸‹æ‰€ç¤ºï¼šåœ¨com.example.demoè·¯å¾„ä¸‹æ–°å»ºcontrolleråŒ…ï¼Œå¹¶åˆ›å»ºTestControllerï¼š1234567891011121314@Controllerpublic class TestController &#123; @RequestMapping("index") public String index () &#123; return "index"; &#125; @RequestMapping("hello") @ResponseBody public String hello()&#123; return "hello"; &#125;&#125;ç„¶åŽåœ¨resources/templatesä¸‹æ–°å»ºindex.htmlï¼š123456789101112131415161718&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;è·¨åŸŸæµ‹è¯•&lt;/title&gt; &lt;script src="http://libs.baidu.com/jquery/1.11.3/jquery.min.js"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="hello"&gt;&lt;/div&gt;&lt;/body&gt;&lt;script&gt; $(function () &#123; $.get("http://test.mrbird.cc:8080/hello", function (data) &#123; $("#hello").text(data); &#125;) &#125;)&lt;/script&gt;&lt;/html&gt;ç¼–è¾‘æœ¬åœ°hostsæ–‡ä»¶ï¼Œå°†http://test.mrbird.ccç½‘å€æ˜ å°„åˆ°127.0.0.1ä¸Šï¼šå¯åŠ¨é¡¹ç›®è®¿é—®http://localhost:8080/ï¼Œä¼šå‘çŽ°é¡µé¢å¹¶æ²¡æœ‰æˆåŠŸæ˜¾ç¤ºhelloï¼Œå¹¶ä¸”F12è§‚å¯Ÿæµè§ˆå™¨æŽ§åˆ¶å°ä¼šå‘çŽ°å…¶æŠ¥é”™äº†ï¼šè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨http://localhost:8080/åŸŸåä¸‹è¯•å›¾è®¿é—®http://test.mrbird.cc:8080ä¸‹çš„helloæŽ¥å£ï¼Œè¿™å°±å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ³¨è§£é©±åŠ¨Spring 4.2åŽæä¾›äº†@CrossOriginæ³¨è§£ï¼Œè¯¥æ³¨è§£å¯ä»¥æ ‡æ³¨äºŽæ–¹æ³•æˆ–è€…ç±»ä¸Šï¼ŒåŒ…å«äº†ä»¥ä¸‹å±žæ€§:å±žæ€§å«ä¹‰valueæŒ‡å®šæ‰€æ”¯æŒåŸŸçš„é›†åˆï¼Œ*è¡¨ç¤ºæ‰€æœ‰åŸŸéƒ½æ”¯æŒï¼Œé»˜è®¤å€¼ä¸º*ã€‚è¿™äº›å€¼å¯¹åº”HTTPè¯·æ±‚å¤´ä¸­çš„Access-Control-Allow-OriginoriginsåŒvalueallowedHeaderså…è®¸è¯·æ±‚å¤´ä¸­çš„headerï¼Œé»˜è®¤éƒ½æ”¯æŒexposedHeaderså“åº”å¤´ä¸­å…è®¸è®¿é—®çš„headerï¼Œé»˜è®¤ä¸ºç©ºmethodsæ”¯æŒè¯·æ±‚çš„æ–¹æ³•ï¼Œæ¯”å¦‚GETï¼ŒPOSTï¼ŒPUTç­‰ï¼Œé»˜è®¤å’ŒControllerä¸­çš„æ–¹æ³•ä¸Šæ ‡æ³¨çš„ä¸€è‡´ã€‚allowCredentialsæ˜¯å¦å…è®¸cookieéšè¯·æ±‚å‘é€ï¼Œä½¿ç”¨æ—¶å¿…é¡»æŒ‡å®šå…·ä½“çš„åŸŸmaxAgeé¢„è¯·æ±‚çš„ç»“æžœçš„æœ‰æ•ˆæœŸï¼Œé»˜è®¤30åˆ†é’Ÿæˆ‘ä»¬æ¥æ”¹é€ TestControllerä¸­çš„helloæ–¹æ³•ï¼š123456@RequestMapping("hello")@ResponseBody@CrossOrigin(value = "*")public String hello() &#123; return "hello";&#125;è¡¨ç¤ºå…è®¸æ‰€æœ‰åŸŸéƒ½æ”¯æŒï¼Œé‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®http://localhost:8080/ï¼šæŽ¥å£ç¼–ç¨‹é™¤äº†ä½¿ç”¨@CrossOriginæ³¨è§£å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æŽ¥å£ç¼–ç¨‹çš„æ–¹å¼è¿›è¡Œç»Ÿä¸€é…ç½®ã€‚åœ¨com.example.demoè·¯å¾„ä¸‹æ–°å»ºconfigåŒ…ï¼Œç„¶åŽåˆ›å»ºWebConfigurerï¼Œå®žçŽ°WebMvcConfigurerï¼Œé‡å†™addCorsMappingsé»˜è®¤å®žçŽ°ï¼š12345678910@Configurationpublic class WebConfigurer implements WebMvcConfigurer &#123; @Override public void addCorsMappings(CorsRegistry registry) &#123; registry.addMapping("/**") .allowedOrigins("*") .allowedMethods("GET"); &#125;&#125;ä¸Šé¢é…ç½®è¡¨ç¤ºå…è®¸æ‰€æœ‰è¯·æ±‚æ”¯æŒè·¨åŸŸè®¿é—®ï¼Œå¹¶ä¸”ä¸é™å®šåŸŸï¼Œä½†æ˜¯æ”¯æŒæŒGETæ–¹æ³•ã€‚å°†helloæ–¹æ³•ä¸Šçš„@CrossOriginæ³¨è§£æ³¨é‡ŠæŽ‰ï¼Œé‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®http://localhost:8080/ï¼Œç»“æžœä¹Ÿæ˜¯OKçš„ã€‚è¿‡æ»¤å™¨å®žçŽ°æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œå‘çŽ°å…¶è¿˜æä¾›äº†åŸºäºŽè¿‡æ»¤å™¨çš„å®žçŽ°æ–¹å¼ï¼š1234567891011@Beanpublic FilterRegistrationBean corsFilter() &#123; UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource(); CorsConfiguration config = new CorsConfiguration(); config.setAllowCredentials(true); config.addAllowedOrigin("*"); source.registerCorsConfiguration("/**", config); FilterRegistrationBean bean = new FilterRegistrationBean(new CorsFilter(source)); bean.setOrder(0); return bean;&#125;Actuatorè·¨åŸŸå¦‚æžœé¡¹ç›®é‡Œé›†æˆäº†Actuatorç›¸å…³åŠŸèƒ½ï¼Œå…¶æš´éœ²çš„æŽ¥å£ä¹Ÿæ”¯æŒè·¨åŸŸï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®å³å¯ï¼šENDPOINTS CORS CONFIGURATION (CorsEndpointProperties)123456management.endpoints.web.cors.allow-credentials= # Whether credentials are supported. When not set, credentials are not supported.management.endpoints.web.cors.allowed-headers= # Comma-separated list of headers to allow in a request. &apos;*&apos; allows all headers.management.endpoints.web.cors.allowed-methods= # Comma-separated list of methods to allow. &apos;*&apos; allows all methods. When not set, defaults to GET.management.endpoints.web.cors.allowed-origins= # Comma-separated list of origins to allow. &apos;*&apos; allows all origins. When not set, CORS support is disabled.management.endpoints.web.cors.exposed-headers= # Comma-separated list of headers to include in a response.management.endpoints.web.cors.max-age=1800s # How long the response from a pre-flight request can be cached by clients. If a duration suffix is not specified, seconds will be used.æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/48.Spring-Boot-CORS-Support]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡ªå®šä¹‰Spring Boot å†…å®¹åå•†]]></title>
    <url>%2FSpring-Boot-Diy-Resolver.html</url>
    <content type="text"><![CDATA[å†…å®¹åå•†æœºåˆ¶æ˜¯æŒ‡å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å°±å“åº”çš„èµ„æºå†…å®¹è¿›è¡Œäº¤æ¶‰ï¼Œç„¶åŽæä¾›ç»™å®¢æˆ·ç«¯æœ€ä¸ºé€‚åˆçš„èµ„æºã€‚å†…å®¹åå•†ä¼šä»¥å“åº”èµ„æºçš„è¯­è¨€ã€å­—ç¬¦é›†ã€ç¼–ç æ–¹å¼ç­‰ä½œä¸ºåˆ¤æ–­çš„åŸºå‡†ã€‚HTTPè¯·æ±‚å¤´ä¸­Content-Typeï¼ŒAcceptç­‰å†…å®¹å°±æ˜¯å†…å®¹åå•†åˆ¤æ–­çš„æ ‡å‡†ã€‚åœ¨Spring Bootä¸­ï¼Œä¸€ä¸ªå®Œæ•´çš„å†…å®¹åå•†è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šè¿™ä¸ªè¿‡ç¨‹çš„æ ¸å¿ƒç»„ä»¶ï¼šç»„ä»¶åç§°è¯´æ˜ŽContentNegotiationManagerå†…å®¹åå•†ç®¡ç†å™¨ContentNegotiationStrategy æŽ§åˆ¶ç­–ç•¥MediaTypeåª’ä½“ç±»åž‹HTTP æ¶ˆæ¯åª’ä½“ç±»åž‹ï¼Œå¦‚ text/html@RequestMapping#consumesæ¶ˆè´¹åª’ä½“ç±»åž‹è¯·æ±‚å¤´ Content-Type åª’ä½“ç±»åž‹æ˜ å°„@RequestMapping#producesç”Ÿäº§åª’ä½“ç±»åž‹å“åº”å¤´ Content-Type åª’ä½“ç±»åž‹æ˜ å°„HttpMessageConverterHTTPæ¶ˆæ¯è½¬æ¢å™¨æŽ¥å£HTTP æ¶ˆæ¯è½¬æ¢å™¨ï¼Œç”¨äºŽååºåˆ—åŒ– HTTP è¯·æ±‚æˆ–åºåˆ—åŒ–å“åº”WebMvcConfigurerWeb MVC é…ç½®å™¨é…ç½® REST ç›¸å…³çš„ç»„ä»¶HandlerMethodå¤„ç†æ–¹æ³•@RequestMapping æ ‡æ³¨çš„æ–¹æ³•HandlerMethodArgumentResolverå¤„ç†æ–¹æ³•å‚æ•°è§£æžå™¨ç”¨äºŽ HTTP è¯·æ±‚ä¸­è§£æž HandlerMethod å‚æ•°å†…å®¹HandlerMethodReturnValueHandlerå¤„ç†æ–¹æ³•è¿”å›žå€¼è§£æžå™¨ç”¨äºŽ HandlerMethod è¿”å›žå€¼è§£æžä¸º HTTP å“åº”å†…å®¹HttpMessageConverterä¸ºHTTPæ¶ˆæ¯è½¬æ¢æŽ¥å£ï¼ŒSpringæ ¹æ®ä¸åŒçš„åª’ä½“ç±»åž‹è¿›è¡Œäº†ç›¸åº”çš„å®žçŽ°ã€‚æ¯”å¦‚ä¸Šå›¾ä¸­Acceptä¸ºapplication/jsonï¼Œæ‰€ä»¥åœ¨ç¬¬7æ­¥ä¸­ï¼Œä¼šé€‰æ‹©ä½¿ç”¨HttpMessageConverterçš„å®žçŽ°ç±»MappingJackson2HttpMessageConverteræ¥å¤„ç†è¿”å›žå€¼ã€‚è‡ªå®šä¹‰HttpMessageConverteré™¤äº†Springç»™æˆ‘ä»¬æä¾›çš„HttpMessageConverterå®žçŽ°å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰HttpMessageConverterçš„å®žçŽ°ï¼Œæ¥å¤„ç†ä¸€äº›å®žé™…ä¸šåŠ¡éœ€æ±‚ã€‚å‡å¦‚çŽ°åœ¨è¦å®žçŽ°ä¸€ä¸ªç”¨äºŽå¤„ç† Content-Type ä¸º text/properties åª’ä½“ç±»åž‹çš„ HttpMessageConverter å®žçŽ°ç±» PropertiesHttpMessageConverterï¼Œå½“æˆ‘ä»¬åœ¨è¯·æ±‚ä½“ä¸­ä¼ è¾“ä¸‹é¢å†…å®¹æ—¶ï¼š12name:mrbridage:18èƒ½å¤Ÿè‡ªåŠ¨è½¬æ¢ä¸ºPropertieså¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥å‚ç…§MappingJackson2HttpMessageConverterçš„å®žçŽ°æ–¹å¼æ¥è¿›è¡Œå®žçŽ°ï¼ŒæŸ¥çœ‹MappingJackson2HttpMessageConverterçš„åŽŸåž‹å›¾ï¼šæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§æ‰¿AbstractGenericHttpMessageConverterçš„æ–¹å¼æ¥å®žçŽ°HttpMessageConverteræŽ¥å£ã€‚æ–°å»ºSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.1.0.RELEASEï¼Œå¹¶å¼•å…¥spring-boot-starter-webä¾èµ–ï¼Œé¡¹ç›®ç»“æž„å¦‚ä¸‹æ‰€ç¤º:æˆ‘ä»¬åœ¨com.example.demoè·¯å¾„ä¸‹æ–°å»ºconverteråŒ…ï¼Œç„¶åŽåˆ›å»ºPropertiesHttpMessageConverterï¼Œç»§æ‰¿AbstractGenericHttpMessageConverterï¼š1234567891011121314public class PropertiesHttpMessageConverter extends AbstractGenericHttpMessageConverter&lt;Properties&gt; &#123; @Override protected void writeInternal(Properties properties, Type type, HttpOutputMessage outputMessage) throws IOException, HttpMessageNotWritableException &#123; &#125; @Override protected Properties readInternal(Class&lt;? extends Properties&gt; clazz, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException &#123; return null; &#125; @Override public Properties read(Type type, Class&lt;?&gt; contextClass, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException &#123; return null; &#125;&#125;å…¶ä¸­readxxxä¸ºååºåˆ—åŒ–è¿‡ç¨‹ï¼Œå³å°†HTTPè¯·æ±‚ååºåˆ—åŒ–ä¸ºå‚æ•°çš„è¿‡ç¨‹ï¼›writeInternalä¸ºåºåˆ—åŒ–è¿‡ç¨‹ï¼Œå°†å“åº”åºåˆ—åŒ–ã€‚ååºåˆ—åŒ–è¿‡ç¨‹æˆ‘ä»¬ç»§ç»­ç¼–å†™PropertiesHttpMessageConverterï¼š1234567891011121314151617181920212223242526272829303132333435public class PropertiesHttpMessageConverter extends AbstractGenericHttpMessageConverter&lt;Properties&gt; &#123; @Override protected void writeInternal(Properties properties, Type type, HttpOutputMessage outputMessage) throws IOException, HttpMessageNotWritableException &#123; &#125; @Override protected Properties readInternal(Class&lt;? extends Properties&gt; clazz, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException &#123; Properties properties = new Properties(); // èŽ·å–è¯·æ±‚å¤´ HttpHeaders headers = inputMessage.getHeaders(); // èŽ·å– content-type MediaType contentType = headers.getContentType(); // èŽ·å–ç¼–ç  Charset charset = null; if (contentType != null) &#123; charset = contentType.getCharset(); &#125; charset = charset == null ? Charset.forName("UTF-8") : charset; // èŽ·å–è¯·æ±‚ä½“ InputStream body = inputMessage.getBody(); InputStreamReader inputStreamReader = new InputStreamReader(body, charset); properties.load(inputStreamReader); return properties; &#125; @Override public Properties read(Type type, Class&lt;?&gt; contextClass, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException &#123; return readInternal(null, inputMessage); &#125;&#125;åœ¨readInternalæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬èŽ·å–äº†HTTPè¯·æ±‚ä½“ä¸­çš„è¾“å…¥æµå’Œç¼–ç ï¼Œç„¶åŽè°ƒç”¨Propertieså¯¹è±¡çš„loadæ–¹æ³•æ¥å°†æµè½¬æ¢ä¸ºPropertieså¯¹è±¡ã€‚ååºåˆ—åŒ–è¿‡ç¨‹å®Œæˆäº†ï¼Œæˆ‘ä»¬è¿˜éœ€å°†PropertiesHttpMessageConverteræ·»åŠ åˆ°HttpMessageConverteré›†åˆä¸­ã€‚åœ¨com.example.demoè·¯å¾„ä¸‹æ–°å»ºconfigåŒ…ï¼Œç„¶åŽåˆ›å»ºWebConfigureré…ç½®ç±»ï¼š1234567@Configurationpublic class WebConfigurer implements WebMvcConfigurer &#123; public void extendMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) &#123; converters.add(new PropertiesHttpMessageConverter()); &#125;&#125;extendMessageConvertersæ–¹æ³•ä¸ºWebMvcConfigurerçš„é»˜è®¤æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œç”¨äºŽå°†PropertiesHttpMessageConverteræ·»åŠ åˆ°æ¶ˆæ¯è½¬æ¢å™¨é›†åˆä¸­ã€‚æŽ¥ç€åˆ›å»ºä¸€ä¸ªControlleræ¥æµ‹è¯•ä¸€æ³¢ï¼Œåœ¨com.example.demoè·¯å¾„ä¸‹æ–°å»ºcontrolleråŒ…ï¼Œç„¶åŽåˆ›å»ºTestControllerï¼š12345678@RestControllerpublic class TestController &#123; @GetMapping(value = "test", consumes = "text/properties") public Properties test(@RequestBody Properties properties) &#123; return properties; &#125;&#125;æˆ‘ä»¬é€šè¿‡@GetMappingæ³¨è§£çš„consumeså±žæ€§æŒ‡å®šäº†æ–¹æ³•æŽ¥æ”¶çš„åª’ä½“ç±»åž‹ä¸ºtext/propertiesï¼Œå¦‚æžœæ–¹æ³•èƒ½å¤ŸæˆåŠŸè¢«è°ƒç”¨ï¼Œå¹¶ä¸”å¯ä»¥è¿”å›žPropertieså¯¹è±¡ï¼Œåˆ™è¯´æ˜Žæˆ‘ä»¬è‡ªå®šä¹‰çš„HTTPæ¶ˆæ¯è½¬æ¢å™¨æ˜¯å¯è¡Œçš„ã€‚å¯åŠ¨é¡¹ç›®ï¼Œä½¿ç”¨PostManè®¿é—®ï¼šè¯·æ±‚å¤´ä¸­æŒ‡å®šContent-Typeä¸ºtext/propertiesï¼Œè¯·æ±‚ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤º:è®¿é—®åŽï¼ŒæŽ§åˆ¶å°è¾“å‡ºé”™è¯¯å¦‚ä¸‹ï¼š1Resolved [org.springframework.http.converter.HttpMessageNotReadableException: Required request body is missing: public java.util.Properties com.example.demo.controller.TestController.test(java.util.Properties)]ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬åœ¨è‡ªå®šä¹‰PropertiesHttpMessageConverterçš„æ—¶å€™éœ€è¦åœ¨å…¶æž„é€ å™¨ä¸­æŒ‡å®šå®ƒèƒ½å¤Ÿå¤„ç†çš„åª’ä½“ç±»åž‹ï¼Œæˆ‘ä»¬æŸ¥çœ‹MappingJackson2HttpMessageConverterçš„æž„é€ å™¨ï¼Œçœ‹çœ‹å®ƒæ˜¯æ€Žä¹ˆå®žçŽ°çš„ï¼šæ‰€ä»¥æˆ‘ä»¬åœ¨PropertiesHttpMessageConverterçš„æž„é€ å™¨ä¸­æ·»åŠ ç›¸åº”çš„åª’ä½“ç±»åž‹ï¼š123public PropertiesHttpMessageConverter() &#123; super(new MediaType("text", "properties"));&#125;è¿™æ—¶å€™ï¼Œé‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®ä¸Šé¢çš„è¯·æ±‚ï¼Œå¯çœ‹åˆ°å“åº”å¦‚ä¸‹æ‰€ç¤º:åºåˆ—åŒ–è¿‡ç¨‹åºåˆ—åŒ–çš„è¿‡ç¨‹å°±æ˜¯å¤„ç†HTTPå“åº”çš„è¿‡ç¨‹ï¼Œå¯¹åº”PropertiesHttpMessageConverterçš„writeInternalæ–¹æ³•ã€‚é‚£ä¸ºä»€ä¹ˆæˆ‘ä»¬éƒ½è¿˜å®žçŽ°è¿™ä¸ªæ–¹æ³•ï¼Œä¸Šé¢çš„Controllerè¯·æ±‚å´èƒ½è¿”å›žæ­£å¸¸çš„JSONå†…å®¹å‘¢ï¼Ÿä¸¤ä¸ªåŽŸå› ï¼šè¿™é‡Œæˆ‘ä»¬å®šä¹‰çš„æ˜¯RESTæŽ¥å£ï¼Œæ‰€ä»¥å“åº”é»˜è®¤ä¼šè¢«åºåˆ—åŒ–ä¸ºJSONæ ¼å¼ï¼›ç”±äºŽä½¿ç”¨converters.add(new PropertiesHttpMessageConverter());è¿™ç§æ–¹å¼æ¥æ·»åŠ è‡ªå®šä¹‰HTTPæ¶ˆæ¯å¤„ç†å™¨é»˜è®¤ä¼šè¢«æ·»åŠ åˆ°é›†åˆçš„æœ«å°¾ï¼Œåœ¨å¤„ç†JSONå“åº”çš„æ—¶å€™è¢«æŽ’åœ¨å‰é¢çš„MappingJackson2HttpMessageConverterä¼˜å…ˆå¤„ç†äº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡debugæ¥æŸ¥çœ‹PropertiesHttpMessageConverteræ˜¯å¦çœŸçš„è¢«æ·»åŠ åˆ°é›†åˆæœ«å°¾äº†ï¼šæ‰€ä»¥æˆ‘ä»¬è¦æ¢ä¸‹é¢è¿™ç§æ–¹å¼æ¥æ·»åŠ è‡ªå®šä¹‰HTTPå¤„ç†å™¨ï¼š123456789@Configurationpublic class WebConfigurer implements WebMvcConfigurer &#123; public void extendMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) &#123; // converters.add(new PropertiesHttpMessageConverter()); // æŒ‡å®šé¡ºåºï¼Œè¿™é‡Œä¸ºç¬¬ä¸€ä¸ª converters.add(0, new PropertiesHttpMessageConverter()); &#125;&#125;æˆ‘ä»¬é‡å¯é¡¹ç›®ï¼Œå†æ¬¡debugï¼šå¯çœ‹åˆ°ï¼ŒPropertiesHttpMessageConverterå·²ç»æŽ’åœ¨ç¬¬ä¸€ä¸ªäº†ã€‚è¿™æ—¶å€™å†æ¬¡è®¿é—®ä¸Šé¢çš„è¯·æ±‚ï¼Œå“åº”å¦‚ä¸‹æ‰€ç¤º:æ²¡æœ‰ä»»ä½•è¿”å›žå€¼ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡å®žçŽ°writeInternalå‘¢ã€‚ç»§ç»­å®žçŽ°writeInternalæ–¹æ³•ï¼š123456789101112131415161718192021222324252627public class PropertiesHttpMessageConverter extends AbstractGenericHttpMessageConverter&lt;Properties&gt; &#123; ... @Override protected void writeInternal(Properties properties, Type type, HttpOutputMessage outputMessage) throws IOException, HttpMessageNotWritableException &#123; // èŽ·å–è¯·æ±‚å¤´ HttpHeaders headers = outputMessage.getHeaders(); // èŽ·å– content-type MediaType contentType = headers.getContentType(); // èŽ·å–ç¼–ç  Charset charset = null; if (contentType != null) &#123; charset = contentType.getCharset(); &#125; charset = charset == null ? Charset.forName("UTF-8") : charset; // èŽ·å–è¯·æ±‚ä½“ OutputStream body = outputMessage.getBody(); OutputStreamWriter outputStreamWriter = new OutputStreamWriter(body, charset); properties.store(outputStreamWriter, "Serialized by PropertiesHttpMessageConverter#writeInternal"); &#125; ...&#125;è¿‡ç¨‹å’ŒååºåŒ–å·®ä¸å¤šï¼Œè¿™é‡Œæ˜¯é€šè¿‡Propertieså¯¹è±¡çš„storeæ–¹æ³•æ¥è¿›è¡Œå†™æ“ä½œã€‚é‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®ä¸Šé¢çš„è¯·æ±‚ï¼Œå“åº”å¦‚ä¸‹æ‰€ç¤ºï¼šè‡ªå®šä¹‰HandlerMethodArgumentResolverä¸Šé¢è¿™ç§æ–¹å¼å¿…é¡»ä¾èµ–äºŽ@RequestBodyå’Œ@ResponseBodyæ³¨è§£ï¼Œé™¤æ­¤ä¹‹å¤–æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡è‡ªå®šä¹‰HandlerMethodArgumentResolverå’ŒHandlerMethodReturnValueHandlerå®žçŽ°ç±»çš„æ–¹å¼æ¥å¤„ç†å†…å®¹åå•†ã€‚HandlerMethodArgumentResolverä¿—ç§°æ–¹æ³•å‚æ•°è§£æžå™¨ï¼Œç”¨äºŽè§£æžç”±@RequestMappingæ³¨è§£ï¼ˆæˆ–å…¶æ´¾ç”Ÿçš„æ³¨è§£ï¼‰æ‰€æ ‡æ³¨çš„æ–¹æ³•çš„å‚æ•°ã€‚è¿™é‡Œæˆ‘ä»¬å¼€å§‹é€šè¿‡å®žçŽ°HandlerMethodArgumentResolverçš„æ–¹å¼æ¥å°†HTTPè¯·æ±‚ä½“çš„å†…å®¹è‡ªåŠ¨è§£æžä¸ºPropertieså¯¹è±¡ã€‚åœ¨com.example.demoè·¯å¾„ä¸‹æ–°å»ºresolveråŒ…ï¼Œç„¶åŽåˆ›å»ºPropertiesHandlerMethodReturnValueHandlerå®žçŽ°HandlerMethodArgumentResolveræŽ¥å£ï¼š12345678910111213141516171819202122232425public class PropertiesHandlerMethodArgumentResolver implements HandlerMethodArgumentResolver &#123; @Override public boolean supportsParameter(MethodParameter parameter) &#123; return Properties.class.equals(parameter.getParameterType()); &#125; @Override public Object resolveArgument(MethodParameter parameter, ModelAndViewContainer mavContainer, NativeWebRequest webRequest, WebDataBinderFactory binderFactory) throws Exception &#123; ServletWebRequest servletWebRequest = (ServletWebRequest) webRequest; HttpServletRequest request = servletWebRequest.getRequest(); String contentType = request.getHeader("Content-Type"); MediaType mediaType = MediaType.parseMediaType(contentType); // èŽ·å–ç¼–ç  Charset charset = mediaType.getCharset() == null ? Charset.forName("UTF-8") : mediaType.getCharset(); // èŽ·å–è¾“å…¥æµ InputStream inputStream = request.getInputStream(); InputStreamReader inputStreamReader = new InputStreamReader(inputStream, charset); // è¾“å…¥æµè½¬æ¢ä¸º Properties Properties properties = new Properties(); properties.load(inputStreamReader); return properties; &#125;&#125;æ–¹æ³•supportsParameterç”¨äºŽæŒ‡å®šæ”¯æŒè§£æžçš„å‚æ•°ç±»åž‹ï¼Œè¿™é‡Œä¸ºPropertiesç±»åž‹ã€‚resolveArgumentæ–¹æ³•ç”¨äºŽå®žçŽ°è§£æžé€»è¾‘ï¼Œè§£æžè¿‡ç¨‹å’Œä¸Šé¢å®šä¹‰çš„PropertiesHttpMessageConverterçš„readInternalæ–¹æ³•ç±»ä¼¼ã€‚æŽ¥ç€ï¼Œæˆ‘ä»¬è¿˜éœ€å°†PropertiesHandlerMethodArgumentResolveræ·»åŠ åˆ°Springè‡ªå¸¦çš„HandlerMethodArgumentResolverå®žçŽ°ç±»é›†åˆä¸­ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½åœ¨é…ç½®ç±»WebMvcConfigurerä¸­é€šè¿‡é‡å†™addArgumentResolversçš„æ–¹å¼æ¥æ·»åŠ ï¼ŒæŸ¥çœ‹è¯¥æ–¹æ³•æºç ä¸Šçš„æ³¨é‡Šï¼šå¤§è‡´æ„æ€æ˜¯é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥æ·»åŠ çš„æ–¹æ³•å‚æ•°è§£æžå™¨ä¸ä¼šè¦†ç›–Springå†…ç½®çš„æ–¹æ³•å‚æ•°è§£æžå™¨ï¼Œå¦‚æžœéœ€è¦è¿™ä¹ˆåšçš„è¯ï¼Œå¯ä»¥ç›´æŽ¥é€šè¿‡ä¿®æ”¹RequestMappingHandlerAdapteræ¥å®žçŽ°ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢è¿™ä¸ªæ–¹å¼æ¥å®žçŽ°ï¼š1234567891011121314151617181920@Configurationpublic class WebConfigurer implements WebMvcConfigurer &#123; @Autowired private RequestMappingHandlerAdapter requestMappingHandlerAdapter; @PostConstruct public void init() &#123; // èŽ·å–å½“å‰ RequestMappingHandlerAdapter æ‰€æœ‰çš„ ArgumentResolverå¯¹è±¡ List&lt;HandlerMethodArgumentResolver&gt; argumentResolvers = requestMappingHandlerAdapter.getArgumentResolvers(); List&lt;HandlerMethodArgumentResolver&gt; newArgumentResolvers = new ArrayList&lt;&gt;(argumentResolvers.size() + 1); // æ·»åŠ  PropertiesHandlerMethodArgumentResolver åˆ°é›†åˆç¬¬ä¸€ä¸ªä½ç½® newArgumentResolvers.add(0, new PropertiesHandlerMethodArgumentResolver()); // å°†åŽŸ ArgumentResolver æ·»åŠ åˆ°é›†åˆä¸­ newArgumentResolvers.addAll(argumentResolvers); // é‡æ–°è®¾ç½® ArgumentResolverå¯¹è±¡é›†åˆ requestMappingHandlerAdapter.setArgumentResolvers(newArgumentResolvers); &#125;&#125;æˆ‘ä»¬åœ¨WebConfigureré…ç½®ç±»è£…é…å®Œæ¯•çš„æ—¶å€™ï¼Œé€šè¿‡requestMappingHandlerAdapterå¯¹è±¡çš„setArgumentResolversæ–¹æ³•æ¥é‡æ–°è®¾ç½®æ–¹æ³•è§£æžå™¨é›†åˆï¼Œå°†PropertiesHandlerMethodArgumentResolveræ·»åŠ åˆ°é›†åˆçš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚ä¹‹æ‰€ä»¥è¦å°†PropertiesHandlerMethodArgumentResolveræ·»åŠ åˆ°ç¬¬ä¸€ä¸ªä½ç½®æ˜¯å› ä¸ºPropertiesæœ¬è´¨ä¹Ÿæ˜¯ä¸€ä¸ªMapå¯¹è±¡ï¼Œè€ŒSpringå†…ç½®çš„MapMethodProcessorå°±æ˜¯ç”¨äºŽå¤„ç†Mapå‚æ•°ç±»åž‹çš„ï¼Œå¦‚æžœä¸å°†PropertiesHandlerMethodArgumentResolverä¼˜å…ˆçº§æé«˜ï¼Œé‚£ä¹ˆPropertiesç±»åž‹å‚æ•°ä¼šè¢«MapMethodProcessorè§£æžï¼Œä»Žè€Œå‡ºé”™ã€‚é…ç½®å®Œæ¯•åŽï¼Œæˆ‘ä»¬æ”¹é€ ä¸€ä¸‹TestControllerï¼š12345678910111213141516// @RestController@Controllerpublic class TestController &#123; @GetMapping(value = "test", consumes = "text/properties") @ResponseBody public Properties test(@RequestBody Properties properties) &#123; return properties; &#125; @GetMapping(value = "test1", consumes = "text/properties") @ResponseBody public Properties test1(Properties properties) &#123; return properties; &#125;&#125;test1æ–¹æ³•çš„å‚æ•°æ²¡æœ‰è¢«@RequestBodyæ ‡æ³¨ï¼Œå¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®ä¸‹é¢è¿™ä¸ªè¯·æ±‚ï¼šå¯ä»¥çœ‹åˆ°æ–¹æ³•æˆåŠŸæ‰§è¡Œï¼Œå¹¶ä¸”è¿”å›žäº†æ­£ç¡®çš„å†…å®¹ï¼Œè¯´æ˜Žæˆ‘ä»¬è‡ªå®šä¹‰çš„æ–¹æ³•å‚æ•°è§£æžå™¨PropertiesHandlerMethodArgumentResolveræ˜¯å¯è¡Œçš„ã€‚ä½†æ˜¯æ–¹æ³•çš„è¿”å›žå€¼è¿˜æ˜¯ç”±PropertiesHttpMessageConverterçš„writeInternalæ–¹æ³•è§£æžçš„ï¼Œå¹¶ä¸”ä¾èµ–äºŽ@ResponseBodyæ³¨è§£ï¼ŒæŽ¥ç€æˆ‘ä»¬å¼€å§‹å®žçŽ°è‡ªå®šä¹‰æ–¹æ³•è¿”å›žå€¼è§£æžå™¨ï¼Œå¹¶ä¸”ä¸ä¾èµ–äºŽ@ResponseBodyæ³¨è§£ã€‚è‡ªå®šä¹‰HandlerMethodReturnValueHandlerHandlerMethodArgumentResolverä¿—ç§°æ–¹æ³•è¿”å›žå€¼è§£æžå™¨ï¼Œç”¨äºŽè§£æžç”±@RequestMappingæ³¨è§£ï¼ˆæˆ–å…¶æ´¾ç”Ÿçš„æ³¨è§£ï¼‰æ‰€æ ‡æ³¨çš„æ–¹æ³•çš„è¿”å›žå€¼ã€‚è¿™é‡Œæˆ‘ä»¬å¼€å§‹é€šè¿‡å®žçŽ°HandlerMethodReturnValueHandlerçš„æ–¹å¼æ¥è‡ªå®šä¹‰ä¸€ä¸ªç”¨äºŽå¤„ç†è¿”å›žå€¼ç±»åž‹ä¸ºPropertiesç±»åž‹çš„è§£æžå™¨ã€‚åœ¨com.example.demoè·¯å¾„ä¸‹æ–°å»ºhandleråŒ…ï¼Œç„¶åŽåˆ›å»ºPropertiesHandlerMethodReturnValueHandlerå®žçŽ°HandlerMethodReturnValueHandlerï¼š1234567891011121314151617181920212223242526272829303132333435public class PropertiesHandlerMethodReturnValueHandler implements HandlerMethodReturnValueHandler &#123; @Override public boolean supportsReturnType(MethodParameter returnType) &#123; return Properties.class.equals(returnType.getMethod().getReturnType()); &#125; @Override public void handleReturnValue(Object returnValue, MethodParameter returnType, ModelAndViewContainer mavContainer, NativeWebRequest webRequest) throws Exception &#123; Properties properties = (Properties) returnValue; ServletWebRequest servletWebRequest = (ServletWebRequest) webRequest; HttpServletResponse response = servletWebRequest.getResponse(); ServletServerHttpResponse servletServerHttpResponse = new ServletServerHttpResponse(response); // èŽ·å–è¯·æ±‚å¤´ HttpHeaders headers = servletServerHttpResponse.getHeaders(); MediaType contentType = headers.getContentType(); // èŽ·å–ç¼–ç  Charset charset = null; if (contentType != null) &#123; charset = contentType.getCharset(); &#125; charset = charset == null ? Charset.forName("UTF-8") : charset; // èŽ·å–è¯·æ±‚ä½“ OutputStream body = servletServerHttpResponse.getBody(); OutputStreamWriter outputStreamWriter = new OutputStreamWriter(body, charset); properties.store(outputStreamWriter, "Serialized by PropertiesHandlerMethodReturnValueHandler#handleReturnValue"); &#125;&#125;supportsReturnTypeæ–¹æ³•æŒ‡å®šäº†å¤„ç†è¿”å›žå€¼çš„ç±»åž‹ï¼ŒhandleReturnValueæ–¹æ³•ç”¨äºŽå¤„ç†è¿”å›žå€¼ï¼Œè¿™é‡Œçš„é€»è¾‘å’ŒPropertiesHttpMessageConverterçš„writeInternalæ–¹æ³•åŸºæœ¬ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ã€‚æŽ¥ç€å°†PropertiesHandlerMethodReturnValueHandleræ·»åŠ åˆ°åˆ°Springè‡ªå¸¦çš„HandlerMethodReturnValueHandlerå®žçŽ°ç±»é›†åˆä¸­ï¼Œæ·»åŠ æ–¹å¼å’Œè‡ªå®šä¹‰HandlerMethodArgumentResolverä¸€è‡´ï¼š123456789101112131415161718192021222324252627282930@Configurationpublic class WebConfigurer implements WebMvcConfigurer &#123; @Autowired private RequestMappingHandlerAdapter requestMappingHandlerAdapter; @PostConstruct public void init() &#123; // èŽ·å–å½“å‰ RequestMappingHandlerAdapter æ‰€æœ‰çš„ ArgumentResolverå¯¹è±¡ List&lt;HandlerMethodArgumentResolver&gt; argumentResolvers = requestMappingHandlerAdapter.getArgumentResolvers(); List&lt;HandlerMethodArgumentResolver&gt; newArgumentResolvers = new ArrayList&lt;&gt;(argumentResolvers.size() + 1); // æ·»åŠ  PropertiesHandlerMethodArgumentResolver åˆ°é›†åˆç¬¬ä¸€ä¸ªä½ç½® newArgumentResolvers.add(0, new PropertiesHandlerMethodArgumentResolver()); // å°†åŽŸ ArgumentResolver æ·»åŠ åˆ°é›†åˆä¸­ newArgumentResolvers.addAll(argumentResolvers); // é‡æ–°è®¾ç½® ArgumentResolverå¯¹è±¡é›†åˆ requestMappingHandlerAdapter.setArgumentResolvers(newArgumentResolvers); // èŽ·å–å½“å‰ RequestMappingHandlerAdapter æ‰€æœ‰çš„ returnValueHandlerså¯¹è±¡ List&lt;HandlerMethodReturnValueHandler&gt; returnValueHandlers = requestMappingHandlerAdapter.getReturnValueHandlers(); List&lt;HandlerMethodReturnValueHandler&gt; newReturnValueHandlers = new ArrayList&lt;&gt;(returnValueHandlers.size() + 1); // æ·»åŠ  PropertiesHandlerMethodReturnValueHandler åˆ°é›†åˆç¬¬ä¸€ä¸ªä½ç½® newReturnValueHandlers.add(0, new PropertiesHandlerMethodReturnValueHandler()); // å°†åŽŸ returnValueHandlers æ·»åŠ åˆ°é›†åˆä¸­ newReturnValueHandlers.addAll(returnValueHandlers); // é‡æ–°è®¾ç½® ReturnValueHandlerså¯¹è±¡é›†åˆ requestMappingHandlerAdapter.setReturnValueHandlers(newReturnValueHandlers); &#125;&#125;é…ç½®å¥½åŽï¼Œæˆ‘ä»¬å°†TestControllerçš„test1æ–¹æ³•çš„@ResponseBodyæ³¨è§£åŽ»æŽ‰ï¼Œé‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®:å¯ä»¥çœ‹åˆ°ï¼Œè¿”å›žå€¼æˆåŠŸè¢«PropertiesHandlerMethodReturnValueHandlerçš„handleReturnValueæ–¹æ³•è§£æžäº†ã€‚ä½†æ˜¯è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æŸ¥çœ‹æŽ§åˆ¶å°ï¼Œä¼šå‘çŽ°å¦‚ä¸‹å¼‚å¸¸:1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950javax.servlet.ServletException: Circular view path [test1]: would dispatch back to the current handler URL [/test1] again. Check your ViewResolver setup! (Hint: This may be the result of an unspecified view, due to default view name generation.) at org.springframework.web.servlet.view.InternalResourceView.prepareForRendering(InternalResourceView.java:209) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:147) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:316) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1370) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:1116) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1055) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:998) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:890) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:634) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:875) ~[spring-webmvc-5.1.2.RELEASE.jar:5.1.2.RELEASE] at javax.servlet.http.HttpServlet.service(HttpServlet.java:741) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.12.jar:9.0.12] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107) ~[spring-web-5.1.2.RELEASE.jar:5.1.2.RELEASE] at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199) ~[tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96) [tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490) [tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139) [tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) [tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) [tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408) [tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66) [tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:770) [tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1415) [tomcat-embed-core-9.0.12.jar:9.0.12] at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.12.jar:9.0.12] at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_171] at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_171] at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.12.jar:9.0.12] at java.lang.Thread.run(Thread.java:748) [na:1.8.0_171]è¿™æ˜¯å› ä¸ºï¼Œåœ¨Springä¸­å¦‚æžœControllerä¸­çš„æ–¹æ³•æ²¡æœ‰è¢«@ResponseBodyæ ‡æ³¨çš„è¯ï¼Œé»˜è®¤ä¼šæŠŠè¿”å›žå€¼å½“æˆè§†å›¾çš„åç§°ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬å¹¶ä¸å¸Œæœ›è§£æžçš„Propertieså€¼è¢«å½“æˆè§†å›¾åç§°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨PropertiesHandlerMethodReturnValueHandlerçš„handleReturnValueæ–¹æ³•æœ€åŽä¸€è¡Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š12// å‘Šè¯‰ Spring MVC è¯·æ±‚å·²ç»å¤„ç†å®Œæ¯•mavContainer.setRequestHandled(true);è¿™è¡Œä»£ç å‘Šè¯‰Springï¼Œè¯·æ±‚å·²ç»æˆåŠŸå®Œæˆäº†ï¼Œæ— éœ€è¿›è¡ŒåŽç»­çš„å¤„ç†ã€‚é‡å¯é¡¹ç›®å†æ¬¡è®¿é—®ä¸Šé¢çš„è¯·æ±‚ï¼ŒæŽ§åˆ¶å°ä¾¿ä¸å†æŠ›å¼‚å¸¸äº†ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/47.Spring-Boot-Content-Negotiation]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Booté…åˆHibernate Validatorå‚æ•°æ ¡éªŒ]]></title>
    <url>%2FSpring-Boot-Hibernate-Validator-Params-Check.html</url>
    <content type="text"><![CDATA[Spring Bootä¸­ç»“åˆHibernate Validatorå¯ä»¥å®žçŽ°ä¼˜é›…çš„å‚æ•°æ ¡éªŒï¼Œè€Œä¸å¿…åœ¨ä¸šåŠ¡ä»£ç ä¸­å†™ä¸€å¤§å †çš„å‚æ•°æ ¡éªŒé€»è¾‘ã€‚Hibernate Validatorçš„åŸºæœ¬ä½¿ç”¨å¯ä»¥å‚è€ƒSpringè¡¨å•æ ¡éªŒï¼Œè¿™é‡Œä»‹ç»ä¸€ç§ç»“åˆå…¨å±€å¼‚å¸¸æ•èŽ·çš„æ–¹å¼æ¥å®žçŽ°ä½Žè€¦åˆç®€æ´çš„å‚æ•°æ ¡éªŒè§£å†³æ–¹æ¡ˆã€‚æ–¹æ³•å‚æ•°æ ¡éªŒæ–°å»ºä¸€ä¸ªSpring Bootå·¥ç¨‹ï¼Œç‰ˆæœ¬ä¸º2.1.0.RELEASEï¼ŒartifactIdä¸ºvalidatorï¼Œå¹¶å¼•å…¥spring-boot-starter-webå’Œcommons-lang3ä¾èµ–ï¼š1234567891011 &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;é¡¹ç›®ç»“æž„å¦‚ä¸‹æ‰€ç¤ºï¼šspring-boot-starter-webå·²ç»åŒ…å«äº†hibernate-validatorï¼Œæ‰€ä»¥æ— éœ€å•ç‹¬å¼•å…¥ï¼š åœ¨com.example.demoä¸‹æ–°å»ºcontrolleråŒ…ï¼Œç„¶åŽåˆ›å»ºTestControllerï¼Œå®šä¹‰ä¸€ä¸ªtest1æ–¹æ³•ï¼š1234567891011@RestController@Validatedpublic class TestController &#123; @GetMapping("test1") public String test1( @NotBlank(message = "&#123;required&#125;") String name, @Email(message = "&#123;invalid&#125;") String email) &#123; return "success"; &#125;&#125;test1æ–¹æ³•çš„nameå‚æ•°ä½¿ç”¨@NotBlankæ ‡æ³¨ï¼Œè¡¨ç¤ºä¸èƒ½ä¸ºç©ºï¼Œæç¤ºä¿¡æ¯ä¸º{required}å ä½ç¬¦é‡Œçš„å†…å®¹ï¼›emailå‚æ•°ä½¿ç”¨@Emailæ³¨è§£æ ‡æ³¨ï¼Œè¡¨ç¤ºå¿…é¡»ä¸ºä¸€ä¸ªåˆæ³•çš„é‚®ç®±å€¼ï¼ˆå¯ä»¥ä¸ºç©ºï¼‰ï¼Œæç¤ºä¿¡æ¯ä¸º{invalid}å ä½ç¬¦é‡Œçš„å†…å®¹ã€‚è¦è®©å‚æ•°æ ¡éªŒç”Ÿæ•ˆï¼Œæˆ‘ä»¬è¿˜éœ€åœ¨ç±»ä¸Šä½¿ç”¨@Validatedæ³¨è§£æ ‡æ³¨ã€‚æŽ¥ä¸‹æ¥å®šä¹‰ä¸Šé¢ä¸¤ä¸ªå ä½ç¬¦çš„å†…å®¹ã€‚åœ¨resourcesç›®å½•ä¸‹æ–°å»ºValidationMessages.propertiesæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š12required=\u4e0d\u80fd\u4e3a\u7a7ainvalid=\u683c\u5f0f\u4e0d\u5408\u6cd5å†…å®¹ä¸ºä¸­æ–‡è½¬UnicodeåŽçš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨http://tool.chinaz.com/tools/unicode.aspxç½‘ç«™è½¬æ¢ï¼Œ\u4e0d\u80fd\u4e3a\u7a7aè½¬ä¸ºä¸­æ–‡ä¸ºâ€œä¸èƒ½ä¸ºç©ºâ€ï¼Œ\u683c\u5f0f\u4e0d\u5408\u6cd5è½¬ä¸ºä¸­æ–‡ä¸ºâ€œæ ¼å¼ä¸åˆæ³•â€ã€‚å¯åŠ¨é¡¹ç›®ï¼Œä½¿ç”¨Postmanè¿›è¡Œæµ‹è¯•ï¼Œå‚æ•°å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼šè¿™é‡Œnameå‚æ•°å€¼ä¸ºç©ºï¼Œemailå‚æ•°å€¼ä¸º123ï¼Œè®¿é—®åŽï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¼‚å¸¸å¦‚ä¸‹ï¼šå¯è§ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼å‚æ•°æ ¡éªŒä¸é€šè¿‡æ—¶ï¼Œä¼šæŠ›å‡ºjavax.validation.ConstraintViolationExceptionï¼Œæˆ‘ä»¬ä½¿ç”¨å…¨å±€å¼‚å¸¸æ•èŽ·æ¥å¤„ç†è¿™ç§å¼‚å¸¸ï¼šåœ¨com.example.demoä¸‹æ–°å»ºhandleråŒ…ï¼Œç„¶åŽåˆ›å»ºGlobalExceptionHandlerï¼š123456789101112131415161718192021222324@RestControllerAdvice@Order(value = Ordered.HIGHEST_PRECEDENCE)public class GlobalExceptionHandler &#123; /** * ç»Ÿä¸€å¤„ç†è¯·æ±‚å‚æ•°æ ¡éªŒ(æ™®é€šä¼ å‚) * * @param e ConstraintViolationException * @return FebsResponse */ @ExceptionHandler(value = ConstraintViolationException.class) @ResponseStatus(HttpStatus.BAD_REQUEST) public String handleConstraintViolationException(ConstraintViolationException e) &#123; StringBuilder message = new StringBuilder(); Set&lt;ConstraintViolation&lt;?&gt;&gt; violations = e.getConstraintViolations(); for (ConstraintViolation&lt;?&gt; violation : violations) &#123; Path path = violation.getPropertyPath(); String[] pathArr = StringUtils.splitByWholeSeparatorPreserveAllTokens(path.toString(), "."); message.append(pathArr[1]).append(violation.getMessage()).append(","); &#125; message = new StringBuilder(message.substring(0, message.length() - 1)); return message.toString(); &#125;&#125;ä¸Šé¢ä¸»è¦çš„é€»è¾‘æ˜¯èŽ·å–æ ¡éªŒä¸é€šè¿‡çš„å‚æ•°åç§°ï¼Œç„¶åŽæ‹¼æŽ¥ä¸Šæç¤ºä¿¡æ¯ï¼Œå¹¶ä¸”HTTPè¿”å›žçŠ¶æ€ç ä¸º400ã€‚é‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®åˆšåˆšçš„é“¾æŽ¥ï¼Œå“åº”å¦‚ä¸‹æ‰€ç¤ºï¼šä½¿ç”¨å®žä½“ä¼ å‚å½“å‚æ•°è¾ƒå°‘çš„æ—¶å€™å¯ä»¥ä½¿ç”¨ä¸Šé¢è¿™ç§æ–¹å¼ï¼Œä½†å¦‚æžœå‚æ•°ä¼—å¤šä¸Šé¢çš„æ–¹å¼å°±ç•¥æ˜¾ç¹çäº†ã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®žä½“å¯¹è±¡æ¥è¿›è¡Œä¼ å‚ã€‚ä¸ºäº†æ¨¡æ‹Ÿè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬åœ¨com.example.demoè·¯å¾„ä¸‹æ–°å»ºdomainåŒ…ï¼Œç„¶åŽæ–°å»ºUserç±»ï¼š12345678910111213141516171819202122232425public class User implements Serializable &#123; private static final long serialVersionUID = -2731598327208972274L; @NotBlank(message = "&#123;required&#125;") private String name; @Email(message = "&#123;invalid&#125;") private String email; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public String getEmail() &#123; return email; &#125; public void setEmail(String email) &#123; this.email = email; &#125;&#125;æŽ¥ç€åœ¨TestControlleré‡Œåˆ›å»ºä¸€ä¸ªtest2æ–¹æ³•:1234@GetMapping("test2")public String test2(@Valid User user) &#123; return "success";&#125;ä½¿ç”¨å®žä½“å¯¹è±¡ä¼ å‚çš„æ–¹å¼å‚æ•°æ ¡éªŒéœ€è¦åœ¨ç›¸åº”çš„å‚æ•°å‰åŠ ä¸Š@Validæ³¨è§£ã€‚é‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®ä¸‹é¢è¿™ä¸ªè¯·æ±‚ï¼š æŽ§åˆ¶å°ä¼šè¾“å‡ºå¦‚ä¸‹ä¿¡æ¯:123Resolved [org.springframework.validation.BindException: org.springframework.validation.BeanPropertyBindingResult: 2 errorsField error in object &apos;user&apos; on field &apos;name&apos;: rejected value []; codes [NotBlank.user.name,NotBlank.name,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [user.name,name]; arguments []; default message [name]]; default message [ä¸èƒ½ä¸ºç©º]Field error in object &apos;user&apos; on field &apos;email&apos;: rejected value [123]; codes [Email.user.email,Email.email,Email.java.lang.String,Email]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [user.email,email]; arguments []; default message [email],[Ljavax.validation.constraints.Pattern$Flag;@5fb82092,org.springframework.validation.beanvalidation.SpringValidatorAdapter$ResolvableAttribute@cc0c307]; default message [æ ¼å¼ä¸åˆæ³•]]è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨GlobalExceptionHandleræ•èŽ·org.springframework.validation.BindExceptionå¼‚å¸¸ï¼š123456789101112131415161718/** * ç»Ÿä¸€å¤„ç†è¯·æ±‚å‚æ•°æ ¡éªŒ(å®žä½“å¯¹è±¡ä¼ å‚) * * @param e BindException * @return FebsResponse */@ExceptionHandler(BindException.class)@ResponseStatus(HttpStatus.BAD_REQUEST)public String validExceptionHandler(BindException e) &#123; StringBuilder message = new StringBuilder(); List&lt;FieldError&gt; fieldErrors = e.getBindingResult().getFieldErrors(); for (FieldError error : fieldErrors) &#123; message.append(error.getField()).append(error.getDefaultMessage()).append(","); &#125; message = new StringBuilder(message.substring(0, message.length() - 1)); return message.toString();&#125;é‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®åˆšåˆšçš„è¯·æ±‚ï¼Œå“åº”å¦‚ä¸‹æ‰€ç¤º:æˆ‘ä»¬å°†è¯·æ±‚å‚æ•°æ”¹ä¸ºåˆæ³•çš„å†…å®¹ï¼šç‚¹å‡»è®¿é—®ï¼Œå“åº”å¦‚ä¸‹æ‰€ç¤º:æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/46.Spring-Boot-Hibernate-Validator]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥å­¦ä¹ Spring Bootä¸­çš„SpringApplication]]></title>
    <url>%2Fdeepin-springboot-application.html</url>
    <content type="text"><![CDATA[åœ¨Spring Bootçš„å…¥å£ç±»ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æ˜¯é€šè¿‡è°ƒç”¨SpringApplicationçš„runæ–¹æ³•æ¥å¯åŠ¨Spring Booté¡¹ç›®ã€‚è¿™èŠ‚æˆ‘ä»¬æ¥æ·±å…¥å­¦ä¹ ä¸‹SpringApplicationçš„ä¸€äº›ç»†èŠ‚ã€‚è‡ªå®šä¹‰SpringApplicationé»˜è®¤çš„æˆ‘ä»¬éƒ½æ˜¯ç›´æŽ¥é€šè¿‡SpringApplicationçš„runæ–¹æ³•æ¥ç›´æŽ¥å¯åŠ¨Spring Bootï¼Œå…¶å®žæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›APIæ¥è°ƒæ•´æŸäº›è¡Œä¸ºã€‚é€šè¿‡SpringApplication APIè°ƒæ•´æˆ‘ä»¬æ–°å»ºä¸€ä¸ªSpringBooté¡¹ç›®ï¼ŒSpring Bootç‰ˆæœ¬ä¸º2.1.0.RELEASEï¼ŒartifactIdä¸ºSpringApplicationï¼Œå¹¶å¼•å…¥spring-boot-starter-webä¾èµ–ã€‚é¡¹ç›®ç»“æž„å¦‚ä¸‹æ‰€ç¤º:æˆ‘ä»¬å°†å…¥å£ç±»çš„ä»£ç æ”¹ä¸ºï¼š12345SpringApplication application = new SpringApplication(DemoApplication.class);application.setBannerMode(Banner.Mode.OFF);application.setWebApplicationType(WebApplicationType.NONE);application.setAdditionalProfiles("dev");application.run(args);é€šè¿‡è°ƒç”¨SpringApplicationçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å…³é—­äº†Bannerçš„æ‰“å°ï¼Œè®¾ç½®åº”ç”¨çŽ¯å¢ƒä¸ºéžWEBåº”ç”¨ï¼ŒprofilesæŒ‡å®šä¸ºdevã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒSpringApplicationè¿˜åŒ…å«äº†è®¸å¤šåˆ«çš„æ–¹æ³•ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹æºç æˆ–è€…å®˜æ–¹æ–‡æ¡£ï¼šé€šè¿‡SpringApplicationBuilder APIè°ƒæ•´SpringApplicationBuilderæä¾›äº†Fluent APIï¼Œå¯ä»¥å®žçŽ°é“¾å¼è°ƒç”¨ï¼Œä¸‹é¢çš„ä»£ç å’Œä¸Šé¢çš„æ•ˆæžœä¸€è‡´ï¼Œä½†åœ¨ç¼–å†™ä¸Šè¾ƒä¸ºæ–¹ä¾¿ï¼š12345new SpringApplicationBuilder(DemoApplication.class) .bannerMode(Banner.Mode.OFF) .web(WebApplicationType.NONE) .profiles("dev") .run(args);SpringApplicationå‡†å¤‡é˜¶æ®µSpringApplicationçš„ç”Ÿå‘½å‘¨æœŸé˜¶æ®µå¤§è‡´å¯ä»¥åˆ†ä¸ºå‡†å¤‡é˜¶æ®µå’Œè¿è¡Œé˜¶æ®µã€‚æˆ‘ä»¬é€šè¿‡æºç æ¥æŸ¥çœ‹SpringApplicationçš„æœ‰å‚æž„é€ å™¨ï¼šé€šè¿‡æœ‰å‚æž„é€ å™¨é‡Œçš„ä»£ç æˆ‘ä»¬å¯ä»¥å°†SpringApplicationçš„å‡†å¤‡é˜¶æ®µåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼šé…ç½®æºæž„é€ å™¨ä¸­this.primarySources = new LinkedHashSet&lt;&gt;(Arrays.asList(primarySources));è¿™è¡Œä»£ç ç”¨äºŽåŠ è½½æˆ‘ä»¬é…ç½®çš„Spring Boot Beanæºã€‚é€šå¸¸æˆ‘ä»¬ä½¿ç”¨SpringApplicationæˆ–è€…SpringApplicationBuilderçš„æž„é€ å™¨æ¥ç›´æŽ¥æŒ‡å®šæºã€‚æ‰€è°“çš„Spring Boot BeanæºæŒ‡çš„æ˜¯æŸä¸ªè¢«@SpringBootApplicationæ³¨è§£æ ‡æ³¨çš„ç±»ï¼Œæ¯”å¦‚å…¥å£ç±»ï¼šæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸Šé¢çš„ä»£ç æ”¹ä¸ºä¸‹é¢è¿™ç§æ–¹å¼ï¼š123456789101112public class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication application = new SpringApplication(ApplicationResource.class); application.run(args); &#125; @SpringBootApplication public static class ApplicationResource &#123; &#125;&#125;è¿™æ ·ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚æŸ¥çœ‹SpringApplicationçš„å•ä¸ªå‚æ•°æž„é€ å™¨ï¼šè¯´æ˜Žæˆ‘ä»¬é™¤äº†é…ç½®å•ä¸ªæºå¤–ï¼Œè¿˜å¯ä»¥é…ç½®å¤šä¸ªæºã€‚æŽ¨æ–­åº”ç”¨ç±»åž‹æž„é€ å™¨ä¸­è¿™è¡Œthis.webApplicationType = WebApplicationType.deduceFromClasspath();ä»£ç ç”¨äºŽæŽ¨æ–­å½“å‰Spring Bootåº”ç”¨ç±»åž‹ã€‚Spring Boot 2.0åŽï¼Œåº”ç”¨å¯ä»¥åˆ†ä¸ºä¸‹é¢ä¸‰ç§ç±»åž‹ï¼šWebApplicationType.NONEï¼šéžWEBç±»åž‹ï¼›WebApplicationType.REACTIVEï¼šWeb Reactiveç±»åž‹ï¼›WebApplicationType.SERVLETï¼šWeb Servletç±»åž‹ã€‚WebApplicationType.deduceFromClasspath()æˆ–æ ¹æ®å½“å‰åº”ç”¨ClassPathä¸­æ˜¯å¦å­˜åœ¨ç›¸å…³çš„å®žçŽ°ç±»æ¥åˆ¤æ–­åº”ç”¨ç±»åž‹åˆ°åº•æ˜¯å“ªä¸ªï¼ŒdeduceFromClasspathæ–¹æ³•çš„æºç å¦‚ä¸‹æ‰€ç¤º:æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æŽ¥é€šè¿‡SpringApplicationçš„setWebApplicationTypeæ–¹æ³•æˆ–è€…SpringApplicationBuilderçš„webæ–¹æ³•æ¥æŒ‡å®šå½“å‰åº”ç”¨çš„ç±»åž‹ã€‚åŠ è½½åº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹å™¨æŽ¥ç€ä¸‹ä¸€è¡Œä»£ç setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));ç”¨äºŽåŠ è½½åº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹å™¨ApplicationContextInitializerã€‚getSpringFactoriesInstancesæ–¹æ³•çš„æºç å¦‚ä¸‹æ‰€ç¤ºï¼šä¸Šé¢ä»£ç åˆ©ç”¨Springå·¥åŽ‚åŠ è½½æœºåˆ¶ï¼Œå®žä¾‹åŒ–ApplicationContextInitializerå®žçŽ°ç±»ï¼Œå¹¶è¿›è¡ŒæŽ’åºã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å®žçŽ°ApplicationContextInitializeræŽ¥å£ç”¨äºŽåœ¨Spring Bootåº”ç”¨åˆå§‹åŒ–ä¹‹å‰æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰æ“ä½œã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨com.example.demoä¸‹æ–°å»ºinitializeråŒ…ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªHelloApplicationContextInitializerç±»ï¼Œå®žçŽ°ApplicationContextInitializeræŽ¥å£ï¼š1234567@Order(Ordered.HIGHEST_PRECEDENCE)public class HelloApplicationContextInitializer implements ApplicationContextInitializer &#123; @Override public void initialize(ConfigurableApplicationContext applicationContext) &#123; System.out.println("ConfigurableApplicationContext.id - " + applicationContext.getId()); &#125;&#125;ä¸Šé¢ä»£ç ä¸­å®žçŽ°äº†initializeæ–¹æ³•ï¼Œå¹¶ä¸”ä½¿ç”¨@Orderæ³¨è§£æŒ‡å®šä¼˜å…ˆçº§ã€‚å…¶ä¸­Ordered.HIGHEST_PRECEDENCEç­‰äºŽInteger.MIN_VALUEï¼ŒOrdered.LOWEST_PRECEDENCEç­‰äºŽInteger.MAX_VALUEã€‚æ‰€ä»¥æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚é™¤äº†ä½¿ç”¨@Orderæ³¨è§£æ¥æŒ‡å®šä¼˜å…ˆçº§å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å®žçŽ°org.springframework.core.OrderedæŽ¥å£çš„getOrderæ–¹æ³•æ¥æŒ‡å®šä¼˜å…ˆçº§ã€‚æŽ¥ç€æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªä¼˜å…ˆçº§æ¯”HelloApplicationContextInitializerä½Žçš„Initializer â€”â€” AfterHelloApplicationContextInitializerï¼š1234567891011public class AfterHelloApplicationContextInitializer implements ApplicationContextInitializer, Ordered &#123; @Override public void initialize(ConfigurableApplicationContext applicationContext) &#123; System.out.println("AfterHelloApplicationContextInitializer: " + applicationContext.getId()); &#125; @Override public int getOrder() &#123; return Ordered.LOWEST_PRECEDENCE; &#125;&#125;ä¸Šé¢é€šè¿‡getOrderæ–¹æ³•æ¥æŒ‡å®šäº†ä¼˜å…ˆçº§ä¸ºæœ€ä½Žä¼˜å…ˆçº§ã€‚åˆ›å»ºå¥½åŽï¼Œæˆ‘ä»¬è¿˜éœ€åœ¨å·¥åŽ‚é…ç½®æ–‡ä»¶é‡Œé…ç½®è¿™ä¸¤ä¸ªå®žçŽ°ç±»ã€‚åœ¨resourcesç›®å½•ä¸‹æ–°å»ºMETA-INFç›®å½•ï¼Œå¹¶åˆ›å»ºspring.factoriesæ–‡ä»¶ï¼š1234# Initializersorg.springframework.context.ApplicationContextInitializer=\com.example.demo.initializer.HelloApplicationContextInitializer,\com.example.demo.initializer.AfterHelloApplicationContextInitializerè¿™æ—¶å€™ï¼Œå¯åŠ¨Spring Booté¡¹ç›®ï¼Œä¼šå‘çŽ°æŽ§åˆ¶å°åœ¨æ‰“å°BanneråŽå°±æ‰§è¡Œäº†è¿™ä¸¤ä¸ªåˆå§‹åŒ–å™¨ï¼Œå¹¶ä¸”HelloApplicationContextInitializerçš„initializeæ–¹æ³•æ‰§è¡Œæ—¶æœºå…ˆäºŽAfterHelloApplicationContextInitializerçš„initializeæ–¹æ³•ï¼šåŠ è½½åº”ç”¨äº‹ä»¶ç›‘å¬å™¨åœ¨åŠ è½½å®Œåº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹å™¨åŽï¼Œä¸‹ä¸€è¡Œçš„setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));ä»£ç åŠ è½½äº†åº”ç”¨äº‹ä»¶ç›‘å¬å™¨ã€‚ä¸ŽåŠ è½½äº‹ä»¶ä¸Šä¸‹æ–‡åˆå§‹å™¨ç±»ä¼¼ï¼ŒSpring Bootä¹Ÿæ˜¯é€šè¿‡Springçš„å·¥åŽ‚æ–¹æ³•æ¥å®žä¾‹åŒ–ApplicationListenerçš„å®žçŽ°ç±»ï¼Œå¹¶è¿›è¡ŒæŽ’åºã€‚æ—¢ç„¶æ˜¯äº‹ä»¶ç›‘å¬ï¼Œé‚£ä¹ˆå…¶å¯ä»¥ç›‘å¬ä»€ä¹ˆäº‹ä»¶å‘¢ï¼Ÿå…¶ç›‘å¬çš„æ˜¯ApplicationEventæŽ¥å£çš„å®žçŽ°ç±»ï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹éƒ½æœ‰å“ªäº›äº‹ä»¶å®žçŽ°äº†è¿™ä¸ªæŽ¥å£ï¼šè¿™é‡Œæˆ‘ä»¬ä»¥ContextClosedEventä¸ºä¾‹å­æ¥ç¼–å†™è‡ªå®šä¹‰çš„åº”ç”¨äº‹ä»¶ç›‘å¬å™¨ï¼Œç›‘å¬Springä¸Šä¸‹æ–‡å…³é—­äº‹ä»¶ã€‚åœ¨com.example.demoä¸‹æ–°å»ºlisteneråŒ…ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªContextClosedEventListenerç±»ï¼Œå®žçŽ°ApplicationListeneræŽ¥å£ï¼š12345678@Order(Ordered.HIGHEST_PRECEDENCE)public class ContextClosedEventListener implements ApplicationListener&lt;ContextClosedEvent&gt; &#123; @Override public void onApplicationEvent(ContextClosedEvent event) &#123; System.out.println("ContextClosedEvent: " + event.getApplicationContext().getId()); &#125;&#125;ä¸Šé¢ä»£ç å®žçŽ°äº†å¯¹ContextClosedEventäº‹ä»¶çš„ç›‘å¬ï¼Œå¹¶ä¸”åˆ†é…äº†æœ€é«˜ä¼˜å…ˆçº§ã€‚æŽ¥ç€åˆ›å»ºä¸€ä¸ªä¼˜å…ˆçº§æ¯”ContextClosedEventListenerä½Žçš„ä¸Šé¢ä»£ç å®žçŽ°äº†å¯¹ContextClosedEventäº‹ä»¶ç›‘å¬å™¨AfterContextClosedEventListenerï¼š1234567891011public class AfterContextClosedEventListener implements ApplicationListener&lt;ContextClosedEvent&gt;, Ordered &#123; @Override public void onApplicationEvent(ContextClosedEvent event) &#123; System.out.println("AfterContextClosedEventr: " + event.getApplicationContext().getId()); &#125; @Override public int getOrder() &#123; return Ordered.HIGHEST_PRECEDENCE + 1; &#125;&#125;æœ€åŽï¼Œåˆ«å¿˜äº†åœ¨Springå·¥åŽ‚é…ç½®æ–‡ä»¶é‡Œè¿›è¡Œé…ç½®ï¼š1234# Application Listenersorg.springframework.context.ApplicationListener=\com.example.demo.listener.ContextClosedEventListener,\com.example.demo.listener.AfterContextClosedEventListeneråœ¨Spring Bootå…¥å£ç±»ä¸­å°†çŽ¯å¢ƒæŒ‡å®šä¸ºéžWEBçŽ¯å¢ƒï¼ˆè¿™æ ·åœ¨å¯åŠ¨åŽåº”ç”¨ä¼šé©¬ä¸Šå…³é—­ï¼‰:123new SpringApplicationBuilder(DemoApplication.class) .web(WebApplicationType.NONE) .run(args);è¿è¡ŒSpring Bootå…¥å£ç±»ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š æŽ¨æ–­å…¥å£ç±»æŽ¥ç€æž„é€ å™¨é‡Œçš„ä»£ç ä¸‹ä¸€è¡Œthis.mainApplicationClass = deduceMainApplicationClass();ç”¨äºŽæŽ¨æ–­è¿è¡ŒSpring Bootåº”ç”¨çš„å…¥å£ç±»ã€‚æŸ¥çœ‹deduceMainApplicationClassæ–¹æ³•æºç ï¼šä»£ç ä¸»è¦é€»è¾‘æ˜¯æ ¹æ®Mainçº¿ç¨‹æ‰§è¡Œå †æ ˆåˆ¤æ–­å®žé™…çš„å…¥å£ç±»ã€‚å‡†å¤‡é˜¶æ®µä»‹ç»å®Œæ¯•åŽï¼ŒæŽ¥ä¸‹æ¥å¼€å§‹ä»‹ç»è¿è¡Œé˜¶æ®µã€‚SpringApplicationè¿è¡Œé˜¶æ®µSpringApplicationçš„è¿è¡Œé˜¶æ®µå¯¹åº”SpringApplicationçš„runæ–¹æ³•ï¼Œæˆ‘ä»¬æŸ¥çœ‹å…¶æºç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243public ConfigurableApplicationContext run(String... args) &#123; StopWatch stopWatch = new StopWatch(); stopWatch.start(); ConfigurableApplicationContext context = null; Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = new ArrayList&lt;&gt;(); configureHeadlessProperty(); SpringApplicationRunListeners listeners = getRunListeners(args); listeners.starting(); try &#123; ApplicationArguments applicationArguments = new DefaultApplicationArguments( args); ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments); configureIgnoreBeanInfo(environment); Banner printedBanner = printBanner(environment); context = createApplicationContext(); exceptionReporters = getSpringFactoriesInstances( SpringBootExceptionReporter.class, new Class[]&#123;ConfigurableApplicationContext.class&#125;, context); prepareContext(context, environment, listeners, applicationArguments, printedBanner); refreshContext(context); afterRefresh(context, applicationArguments); stopWatch.stop(); if (this.logStartupInfo) &#123; new StartupInfoLogger(this.mainApplicationClass) .logStarted(getApplicationLog(), stopWatch); &#125; listeners.started(context); callRunners(context, applicationArguments); &#125; catch (Throwable ex) &#123; handleRunFailure(context, ex, exceptionReporters, listeners); throw new IllegalStateException(ex); &#125; try &#123; listeners.running(context); &#125; catch (Throwable ex) &#123; handleRunFailure(context, ex, exceptionReporters, null); throw new IllegalStateException(ex); &#125; return context;&#125;è¿è¡Œé˜¶æ®µå¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‹é¢è¿™å‡ ä¸ªè¿‡ç¨‹ï¼šå¼€å¯æ—¶é—´ç›‘å¬runæ–¹æ³•å¼€å¤´çš„è¿™ä¸¤è¡Œä»£ç ç”¨äºŽå¼€å¯æ—¶é—´ç›‘å¬ï¼š12StopWatch stopWatch = new StopWatch();stopWatch.start();ä¸Šé¢ä»£ç ç”¨äºŽå¼€å¯Spring Bootåº”ç”¨å¯åŠ¨æ—¶é—´ç›‘å¬ï¼Œé…åˆä¸‹é¢çš„stopWatch.stop();ä¾¿å¯ä»¥è®¡ç®—å‡ºå®Œæ•´çš„å¯åŠ¨æ—¶é—´ã€‚å¼€å¯è¿è¡Œç›‘å¬å™¨runæ–¹æ³•çš„è¿™å‡ è¡Œä»£ç ç”¨äºŽåŠ è½½Springåº”ç”¨è¿è¡Œç›‘å¬å™¨ï¼ˆSpringApplicationRunListenerï¼‰ï¼š12SpringApplicationRunListeners listeners = getRunListeners(args);listeners.started();getRunListenersæ–¹æ³•æºç ï¼š12345private SpringApplicationRunListeners getRunListeners(String[] args) &#123; Class&lt;?&gt;[] types = new Class&lt;?&gt;[] &#123; SpringApplication.class, String[].class &#125;; return new SpringApplicationRunListeners(logger, getSpringFactoriesInstances( SpringApplicationRunListener.class, types, this, args));&#125;ä¸Šé¢ä»£ç é€šè¿‡SpringFactoriesLoaderæ£€ç´¢META-INF/spring.factoriesæ‰¾åˆ°å£°æ˜Žçš„æ‰€æœ‰SpringApplicationRunListenerçš„å®žçŽ°ç±»å¹¶å°†å…¶å®žä¾‹åŒ–ï¼Œç„¶åŽè£…é…åˆ°List&lt;SpringApplicationRunListener&gt;è¿è¡Œç›‘å¬å™¨é›†åˆä¸­ã€‚listeners.started();ç”¨äºŽéåŽ†è¿è¡Œç›‘å¬å™¨é›†åˆä¸­çš„æ‰€æœ‰SpringApplicationRunListenerçš„å®žçŽ°ç±»ï¼Œå¹¶é€ä¸€è°ƒç”¨å®ƒä»¬çš„startingæ–¹æ³•ï¼Œå¹¿æ’­Spring Bootåº”ç”¨è¦å¼€å§‹å¯åŠ¨äº†ã€‚åœ¨Spring Bootä¸­SpringApplicationRunListeneræŽ¥å£ç”¨äºŽç›‘å¬æ•´ä¸ªSpring Bootåº”ç”¨ç”Ÿå‘½å‘¨æœŸï¼Œå…¶ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415public interface SpringApplicationRunListener &#123; void starting(); void environmentPrepared(ConfigurableEnvironment environment); void contextPrepared(ConfigurableApplicationContext context); void contextLoaded(ConfigurableApplicationContext context); void started(ConfigurableApplicationContext context); void running(ConfigurableApplicationContext context); void failed(ConfigurableApplicationContext context, Throwable exception);&#125;è¿™äº›æ–¹æ³•å¯¹åº”ç€Spring Bootåº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µï¼šæ–¹æ³•åç§°å¯¹åº”ç”Ÿå‘½å‘¨æœŸSpring Bootèµ·å§‹ç‰ˆæœ¬starting()Spring åº”ç”¨åˆšå¯åŠ¨1.0environmentPrepared(ConfigurableEnvironment)ConfigurableEnvironment å‡†å¤‡å®Œæ¯•ï¼Œå…è®¸å°†å…¶è°ƒæ•´1.0contextPrepared(ConfigurableApplicationContext)ConfigurableApplicationContext å‡†å¤‡å®Œæ¯•ï¼Œå…è®¸å°†å…¶è°ƒæ•´1.0contextLoaded(ConfigurableApplicationContext)ConfigurableApplicationContext å·²è£…è½½ï¼Œä½†ä»æœªå¯åŠ¨1.0started(ConfigurableApplicationContext)ConfigurableApplicationContext å·²å¯åŠ¨ï¼Œæ­¤æ—¶ Spring Bean å·²åˆå§‹åŒ–å®Œæˆ2.0running(ConfigurableApplicationContext)Spring åº”ç”¨æ­£åœ¨è¿è¡Œ2.0failed(ConfigurableApplicationContext,Throwable)Spring åº”ç”¨è¿è¡Œå¤±è´¥2.0æˆ‘ä»¬åœ¨com.example.demo.linstenerä¸‹è‡ªå®šä¹‰ä¸€ä¸ªSpringApplicationRunListeneræŽ¥å£å®žçŽ°ç±»HelloSpringApplicationRunListenerï¼š12345678910111213141516171819202122232425262728293031323334353637383940public class HelloApplicationRunListener implements SpringApplicationRunListener &#123; public HelloApplicationRunListener(SpringApplication application, String[] args) &#123; &#125; @Override public void starting() &#123; System.out.println("HelloApplicationRunListener starting......"); &#125; @Override public void environmentPrepared(ConfigurableEnvironment environment) &#123; &#125; @Override public void contextPrepared(ConfigurableApplicationContext context) &#123; &#125; @Override public void contextLoaded(ConfigurableApplicationContext context) &#123; &#125; @Override public void started(ConfigurableApplicationContext context) &#123; &#125; @Override public void running(ConfigurableApplicationContext context) &#123; &#125; @Override public void failed(ConfigurableApplicationContext context, Throwable exception) &#123; &#125;&#125;é€šè¿‡è¿™ä¸ªå®žçŽ°ç±»ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Spring Bootåº”ç”¨åˆšå¯åŠ¨çš„æ—¶å€™åœ¨æŽ§åˆ¶å°è¾“å‡ºHelloApplicationRunListener starting......ã€‚å› ä¸ºå…¶åŸºäºŽSpringçš„å·¥åŽ‚æ–¹æ³•æ¥å®žçŽ°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨spring.factoriesæ–‡ä»¶é‡Œé…ç½®è¿™ä¸ªå®žçŽ°ç±»:123# Run Listenersorg.springframework.boot.SpringApplicationRunListener=\com.example.demo.run.HelloApplicationRunListenerå¯åŠ¨Spring Bootåº”ç”¨ä¾¿å¯ä»¥åœ¨æŽ§åˆ¶å°çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºäº†ï¼šåˆ›å»º Environmentrunæ–¹æ³•ä¸­çš„è¿™è¡Œä»£ç ç”¨äºŽåˆ›å»ºå¹¶é…ç½®å½“å‰SpringBootåº”ç”¨å°†è¦ä½¿ç”¨çš„Environmentï¼ˆåŒ…æ‹¬é…ç½®è¦ä½¿ç”¨çš„PropertySourceä»¥åŠProfileï¼‰ï¼š1ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);æˆ‘ä»¬å·²ç»åœ¨å‡†å¤‡é˜¶æ®µé‡ŒæŽ¨æ–­å‡ºäº†åº”ç”¨ç±»åž‹ï¼Œè¿™é‡Œåªè¦æ ¹æ®ç›¸åº”çš„åº”ç”¨ç±»åž‹æ¥åˆ›å»ºç›¸åº”çš„åº”ç”¨çŽ¯å¢ƒå³å¯ï¼Œç±»åž‹å’ŒçŽ¯å¢ƒå¯¹åº”å…³ç³»å¦‚ä¸‹ï¼šWeb Reactiveï¼š StandardReactiveWebEnvironmentWeb Servletï¼š StandardServletEnvironmentéž Webï¼š StandardEnvironmentåœ¨prepareEnvironmentæ–¹æ³•ä¸­ä¼šæ‰§è¡Œlisteners.environmentPrepared(environment);ï¼Œç”¨äºŽéåŽ†è°ƒç”¨æ‰€æœ‰SpringApplicationRunListenerå®žçŽ°ç±»çš„environmentPrepared()æ–¹æ³•ï¼Œå¹¿æ’­Environmentå‡†å¤‡å®Œæ¯•ã€‚æ˜¯å¦æ‰“å°Bannerrunæ–¹æ³•ä¸­çš„è¿™è¡Œä»£ç ä¼šæ ¹æ®æˆ‘ä»¬çš„é…ç½®æ¥å†³å®šæ˜¯å¦æ‰“å°Bannerï¼š1Banner printedBanner = printBanner(environment);åˆ›å»ºContextrunæ–¹æ³•ä¸­çš„è¿™è¡Œä»£ç ç”¨äºŽåˆ›å»ºApplicationContextï¼š1context = createApplicationContext();ä¸åŒçš„çŽ¯å¢ƒå¯¹åº”ä¸åŒçš„ApplicationContextï¼šWeb Reactiveï¼š AnnotationConfigReactiveWebServerApplicationContextWeb Servletï¼š AnnotationConfigServletWebServerApplicationContextéž Webï¼š AnnotationConfigApplicationContextè£…é…Contextrunæ–¹æ³•ä¸­çš„è¿™è¡Œä»£ç ç”¨äºŽè£…é…Contextï¼š1prepareContext(context, environment, listeners, applicationArguments, printedBanner);æ–¹æ³•prepareContextçš„æºç å¦‚ä¸‹æ‰€ç¤º:123456789101112131415161718192021222324252627private void prepareContext(ConfigurableApplicationContext context, ConfigurableEnvironment environment, SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner) &#123; context.setEnvironment(environment); postProcessApplicationContext(context); applyInitializers(context); listeners.contextPrepared(context); if (this.logStartupInfo) &#123; logStartupInfo(context.getParent() == null); logStartupProfileInfo(context); &#125; // Add boot specific singleton beans ConfigurableListableBeanFactory beanFactory = context.getBeanFactory(); beanFactory.registerSingleton("springApplicationArguments", applicationArguments); if (printedBanner != null) &#123; beanFactory.registerSingleton("springBootBanner", printedBanner); &#125; if (beanFactory instanceof DefaultListableBeanFactory) &#123; ((DefaultListableBeanFactory) beanFactory) .setAllowBeanDefinitionOverriding(this.allowBeanDefinitionOverriding); &#125; // Load the sources Set&lt;Object&gt; sources = getAllSources(); Assert.notEmpty(sources, "Sources must not be empty"); load(context, sources.toArray(new Object[0])); listeners.contextLoaded(context);&#125;prepareContextæ–¹æ³•å¼€å¤´ä¸ºApplicationContextåŠ è½½äº†environmentï¼Œä¹‹åŽé€šè¿‡applyInitializersæ–¹æ³•é€ä¸ªæ‰§è¡ŒApplicationContextInitializerçš„initializeæ–¹æ³•æ¥è¿›ä¸€æ­¥å°è£…ApplicationContextï¼Œå¹¶è°ƒç”¨æ‰€æœ‰çš„SpringApplicationRunListenerå®žçŽ°ç±»çš„contextPreparedæ–¹æ³•ï¼Œå¹¿æ’­ApplicationContextå·²ç»å‡†å¤‡å®Œæ¯•äº†ã€‚ä¹‹åŽåˆå§‹åŒ–IOCå®¹å™¨ï¼Œå¹¶è°ƒç”¨SpringApplicationRunListenerå®žçŽ°ç±»çš„contextLoadedæ–¹æ³•ï¼Œå¹¿æ’­ApplicationContextåŠ è½½å®Œæˆï¼Œè¿™é‡Œå°±åŒ…æ‹¬é€šè¿‡@EnableAutoConfigurationå¯¼å…¥çš„å„ç§è‡ªåŠ¨é…ç½®ç±»ã€‚Refresh Contextrunæ–¹æ³•ä¸­çš„è¿™è¡Œä»£ç ç”¨äºŽåˆå§‹åŒ–æ‰€æœ‰è‡ªåŠ¨é…ç½®ç±»ï¼Œå¹¶è°ƒç”¨ApplicationContextçš„refreshæ–¹æ³•ï¼š1refreshContext(context);å¹¿æ’­åº”ç”¨å·²å¯åŠ¨runæ–¹æ³•ä¸­çš„è¿™è¡Œä»£ç ç”¨äºŽå¹¿æ’­Spring Bootåº”ç”¨å·²å¯åŠ¨ï¼š1listeners.started(context);startedæ–¹æ³•ä¼šè°ƒç”¨æ‰€æœ‰çš„SpringApplicationRunListenerçš„finishedæ–¹æ³•ï¼Œå¹¿æ’­SpringBootåº”ç”¨å·²ç»æˆåŠŸå¯åŠ¨ã€‚æ‰§è¡ŒRunnerrunæ–¹æ³•ä¸­çš„è¿™è¡Œä»£ç callRunners(context, applicationArguments);éåŽ†æ‰€æœ‰ApplicationRunnerå’ŒCommandLineRunnerçš„å®žçŽ°ç±»ï¼Œå¹¶æ‰§è¡Œå…¶runæ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥å®žçŽ°è‡ªå·±çš„ApplicationRunneræˆ–è€…CommandLineRunnerï¼Œæ¥å¯¹Spring Bootçš„å¯åŠ¨è¿‡ç¨‹è¿›è¡Œæ‰©å±•ã€‚æˆ‘ä»¬åœ¨com.example.demoä¸‹æ–°å»ºrunneråŒ…ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªApplicationRunnerçš„å®žçŽ°ç±»HelloApplicationRunnerï¼š1234567@Componentpublic class HelloApplicationRunner implements ApplicationRunner &#123; @Override public void run(ApplicationArguments args) &#123; System.out.println("HelloApplicationRunner: hello spring boot"); &#125;&#125;è¿™é‡Œæˆ‘ä»¬éœ€è¦å°†HelloApplicationRunnerä½¿ç”¨@Componentæ³¨è§£æ ‡æ³¨ï¼Œè®©å…¶æ³¨å†Œåˆ°IOCå®¹å™¨ä¸­ã€‚ç„¶åŽå†åˆ›å»ºä¸€ä¸ªCommandLineRunnerçš„å®žçŽ°ç±»HelloCommandLineRunnerï¼š1234567@Componentpublic class HelloCommandLineRunner implements CommandLineRunner &#123; @Override public void run(String... args) &#123; System.out.println("HelloCommandLineRunner: hello spring boot"); &#125;&#125;å¯åŠ¨Spring Bootåº”ç”¨ï¼Œä¾¿å¯ä»¥åœ¨åº”ç”¨åˆšå¯åŠ¨å¥½åŽçœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼šå¹¿æ’­åº”ç”¨è¿è¡Œä¸­runæ–¹æ³•ä¸­çš„è¿™è¡Œä»£ç listeners.running(context);ç”¨äºŽè°ƒç”¨SpringApplicationRunListenerçš„runningæ–¹æ³•ï¼Œå¹¿æ’­Spring Bootåº”ç”¨æ­£åœ¨è¿è¡Œä¸­ã€‚å½“runæ–¹æ³•è¿è¡Œå‡ºçŽ°å¼‚å¸¸æ—¶ï¼Œä¾¿ä¼šè°ƒç”¨handleRunFailureæ–¹æ³•æ¥å¤„ç†å¼‚å¸¸ï¼Œè¯¥æ–¹æ³•é‡Œä¼šé€šè¿‡listeners.failed(context, exception);æ¥è°ƒç”¨SpringApplicationRunListenerçš„failedæ–¹æ³•ï¼Œå¹¿æ’­åº”ç”¨å¯åŠ¨å¤±è´¥ï¼Œå¹¶å°†å¼‚å¸¸æ‰©æ•£å‡ºåŽ»ã€‚ä¸Šé¢æ‰€æœ‰çš„å¹¿æ’­äº‹ä»¶éƒ½æ˜¯ä½¿ç”¨Springçš„åº”ç”¨äº‹ä»¶å¹¿æ’­å™¨æŽ¥å£ApplicationEventMulticasterçš„å®žçŽ°ç±»SimpleApplicationEventMulticasteræ¥è¿›è¡Œå¹¿æ’­çš„ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/45.Spring-Boot-SpringApplication]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥å­¦ä¹ Spring Bootè‡ªåŠ¨è£…é…]]></title>
    <url>%2Fdeepin-springboot-autoconfig.html</url>
    <content type="text"><![CDATA[æ¨¡å¼æ³¨è§£Stereotype Annotationä¿—ç§°ä¸ºæ¨¡å¼æ³¨è§£ï¼ŒSpringä¸­å¸¸è§çš„æ¨¡å¼æ³¨è§£æœ‰@Serviceï¼Œ@Repositoryï¼Œ@Controllerç­‰ï¼Œå®ƒä»¬éƒ½â€œæ´¾ç”Ÿâ€è‡ª@Componentæ³¨è§£ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå‡¡æ˜¯è¢«@Componentæ ‡æ³¨çš„ç±»éƒ½ä¼šè¢«Springæ‰«æå¹¶çº³å…¥åˆ°IOCå®¹å™¨ä¸­ï¼Œé‚£ä¹ˆç”±@Componentæ´¾ç”Ÿçš„æ³¨è§£æ‰€æ ‡æ³¨çš„ç±»ä¹Ÿä¼šè¢«æ‰«æåˆ°IOCå®¹å™¨ä¸­ã€‚ä¸‹é¢æˆ‘ä»¬ä¸»è¦é€šè¿‡è‡ªå®šä¹‰æ¨¡å¼æ³¨è§£æ¥äº†è§£@Componentçš„â€œæ´¾ç”Ÿæ€§â€å’Œâ€œå±‚æ¬¡æ€§â€ã€‚@Component â€œæ´¾ç”Ÿæ€§â€æ–°å»ºä¸€ä¸ªSpring Bootå·¥ç¨‹ï¼ŒSpring Bootç‰ˆæœ¬ä¸º2.1.0.RELEASEï¼ŒartifactIdä¸ºautoconfigï¼Œå¹¶å¼•å…¥spring-boot-starter-webä¾èµ–ã€‚é¡¹ç›®ç»“æž„å¦‚ä¸‹æ‰€ç¤º:åœ¨com.example.demoä¸‹æ–°å»ºannotationåŒ…ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªFirstLevelServiceæ³¨è§£ï¼š1234567@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Servicepublic @interface FirstLevelService &#123; String value() default "";&#125;è¿™ä¸ªæ³¨è§£å®šä¹‰ç”±@Serviceæ ‡æ³¨ï¼ŒæŸ¥çœ‹@Serviceçš„æºç ä¼šå‘çŽ°å…¶è¢«@Componentæ³¨è§£æ ‡æ³¨ï¼Œæ‰€ä»¥å®ƒä»¬çš„å±‚æ¬¡å…³ç³»ä¸º:123â””â”€@Component â””â”€@Service â””â”€@FirstLevelServiceå³@FirstLevelServiceä¸º@Componentæ´¾ç”Ÿå‡ºæ¥çš„æ¨¡å¼æ³¨è§£ï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹è¢«å®ƒæ ‡æ³¨çš„ç±»æ˜¯å¦èƒ½å¤Ÿè¢«æ‰«æåˆ°IOCå®¹å™¨ä¸­ï¼šåœ¨com.example.demoä¸‹æ–°å»ºserviceåŒ…ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªTestServiceç±»ï¼š123@SecondLevelServicepublic class TestService &#123;&#125;åœ¨com.example.demoä¸‹æ–°å»ºbootstrapåŒ…ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªServiceBootStrapç±»ï¼Œç”¨äºŽæµ‹è¯•æ³¨å†ŒTestServiceå¹¶ä»ŽIOCå®¹å™¨ä¸­èŽ·å–å®ƒï¼š123456789101112@ComponentScan("com.example.demo.service")public class ServiceBootstrap &#123; public static void main(String[] args) &#123; ConfigurableApplicationContext context = new SpringApplicationBuilder(ServiceBootstrap.class) .web(WebApplicationType.NONE) .run(args); TestService testService = context.getBean("testService", TestService.class); System.out.println("TestService Bean: " + testService); context.close(); &#125;&#125;è¿è¡Œè¯¥ç±»çš„mainæ–¹æ³•ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š@Component â€œå±‚æ¬¡æ€§â€æˆ‘ä»¬åœ¨com.example.demo.annotationè·¯å¾„ä¸‹å†åˆ›å»ºä¸€ä¸ªSecondLevelServiceæ³¨è§£å®šä¹‰ï¼Œè¯¥æ³¨è§£ç”±ä¸Šé¢çš„@FirstLevelServiceæ ‡æ³¨ï¼š1234567@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@FirstLevelServicepublic @interface SecondLevelService &#123; String value() default "";&#125;è¿™æ—¶å€™å±‚æ¬¡å…³ç³»ä¸ºï¼š1234â””â”€@Component â””â”€@Service â””â”€@FirstLevelService â””â”€@SecondLevelServiceæˆ‘ä»¬å°†TestServiceä¸Šçš„æ³¨è§£æ¢æˆ@SecondLevelServiceï¼Œç„¶åŽå†æ¬¡è¿è¡ŒServiceBootStrapçš„mainæ–¹æ³•ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼šå¯è§ç»“æžœä¹Ÿæ˜¯æˆåŠŸçš„ã€‚è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼š@Componentæ³¨è§£åªåŒ…å«ä¸€ä¸ªvalueå±žæ€§å®šä¹‰ï¼Œæ‰€ä»¥å…¶â€œæ´¾ç”Ÿâ€çš„æ³¨è§£ä¹Ÿåªèƒ½åŒ…å«ä¸€ä¸ªvalueå±žæ€§å®šä¹‰ã€‚@Enableæ¨¡å—é©±åŠ¨@Enableæ¨¡å—é©±åŠ¨åœ¨Spring Framework 3.1åŽå¼€å§‹æ”¯æŒã€‚è¿™é‡Œçš„æ¨¡å—é€šä¿—çš„æ¥è¯´å°±æ˜¯ä¸€äº›ä¸ºäº†å®žçŽ°æŸä¸ªåŠŸèƒ½çš„ç»„ä»¶çš„é›†åˆã€‚é€šè¿‡@Enableæ¨¡å—é©±åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å¯ç›¸åº”çš„æ¨¡å—åŠŸèƒ½ã€‚@Enableæ¨¡å—é©±åŠ¨å¯ä»¥åˆ†ä¸ºâ€œæ³¨è§£é©±åŠ¨â€å’Œâ€œæŽ¥å£ç¼–ç¨‹â€ä¸¤ç§å®žçŽ°æ–¹å¼ï¼Œä¸‹é¢é€ä¸€è¿›è¡Œæ¼”ç¤ºï¼šæ³¨è§£é©±åŠ¨Springä¸­ï¼ŒåŸºäºŽæ³¨è§£é©±åŠ¨çš„ç¤ºä¾‹å¯ä»¥æŸ¥çœ‹@EnableWebMvcæºç ï¼š123456@Retention(RetentionPolicy.RUNTIME)@Target(&#123;ElementType.TYPE&#125;)@Documented@Import(&#123;DelegatingWebMvcConfiguration.class&#125;)public @interface EnableWebMvc &#123;&#125;è¯¥æ³¨è§£é€šè¿‡@Importå¯¼å…¥ä¸€ä¸ªé…ç½®ç±»DelegatingWebMvcConfigurationï¼šè¯¥é…ç½®ç±»åˆç»§æ‰¿è‡ªWebMvcConfigurationSupportï¼Œé‡Œé¢å®šä¹‰äº†ä¸€äº›Beançš„å£°æ˜Žã€‚æ‰€ä»¥ï¼ŒåŸºäºŽæ³¨è§£é©±åŠ¨çš„@Enableæ¨¡å—é©±åŠ¨å…¶å®žå°±æ˜¯é€šè¿‡@Importæ¥å¯¼å…¥ä¸€ä¸ªé…ç½®ç±»ï¼Œä»¥æ­¤å®žçŽ°ç›¸åº”æ¨¡å—çš„ç»„ä»¶æ³¨å†Œï¼Œå½“è¿™äº›ç»„ä»¶æ³¨å†Œåˆ°IOCå®¹å™¨ä¸­ï¼Œè¿™ä¸ªæ¨¡å—å¯¹åº”çš„åŠŸèƒ½ä¹Ÿå°±å¯ä»¥ä½¿ç”¨äº†ã€‚æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªåŸºäºŽæ³¨è§£é©±åŠ¨çš„@Enableæ¨¡å—é©±åŠ¨ã€‚åœ¨com.example.demoä¸‹æ–°å»ºconfigurationåŒ…ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªHelloWorldConfigurationé…ç½®ç±»ï¼š12345678@Configurationpublic class HelloWorldConfiguration &#123; @Bean public String hello() &#123; return "hello world"; &#125;&#125;è¿™ä¸ªé…ç½®ç±»é‡Œå®šä¹‰äº†ä¸€ä¸ªåä¸ºhelloçš„Beanï¼Œå†…å®¹ä¸ºhello worldã€‚åœ¨com.example.demo.annotationä¸‹åˆ›å»ºä¸€ä¸ªEnableHelloWorldæ³¨è§£å®šä¹‰ï¼š123456@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Import(HelloWorldConfiguration.class)public @interface EnableHelloWorld &#123;&#125;æˆ‘ä»¬åœ¨è¯¥æ³¨è§£ç±»ä¸Šé€šè¿‡@Importå¯¼å…¥äº†åˆšåˆšåˆ›å»ºçš„é…ç½®ç±»ã€‚æŽ¥ç€åœ¨com.example.demo.bootstrapä¸‹åˆ›å»ºä¸€ä¸ªTestEnableBootstapå¯åŠ¨ç±»æ¥æµ‹è¯•@EnableHelloWorldæ³¨è§£æ˜¯å¦ç”Ÿæ•ˆï¼š1234567891011@EnableHelloWorldpublic class TestEnableBootstap &#123; public static void main(String[] args) &#123; ConfigurableApplicationContext context = new SpringApplicationBuilder(TestEnableBootstap.class) .web(WebApplicationType.NONE) .run(args); String hello = context.getBean("hello", String.class); System.out.println("hello Bean: " + hello); context.close(); &#125;&#125;è¿è¡Œè¯¥ç±»çš„mainæ–¹æ³•ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šè¯´æ˜Žæˆ‘ä»¬è‡ªå®šä¹‰çš„åŸºäºŽæ³¨è§£é©±åŠ¨çš„@EnableHelloWorldæ˜¯å¯è¡Œçš„ã€‚æŽ¥å£ç¼–ç¨‹é™¤äº†ä½¿ç”¨ä¸Šé¢è¿™ä¸ªæ–¹å¼å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡æŽ¥å£ç¼–ç¨‹çš„æ–¹å¼æ¥å®žçŽ°@Enableæ¨¡å—é©±åŠ¨ã€‚Springä¸­ï¼ŒåŸºäºŽæŽ¥å£ç¼–ç¨‹æ–¹å¼çš„æœ‰@EnableCachingæ³¨è§£ï¼ŒæŸ¥çœ‹å…¶æºç ï¼š1234567891011@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Import(&#123;CachingConfigurationSelector.class&#125;)public @interface EnableCaching &#123; boolean proxyTargetClass() default false; AdviceMode mode() default AdviceMode.PROXY; int order() default 2147483647;&#125;EnableCachingæ³¨è§£é€šè¿‡@Importå¯¼å…¥äº†CachingConfigurationSelectorç±»ï¼Œè¯¥ç±»é—´æŽ¥å®žçŽ°äº†ImportSelectoræŽ¥å£ï¼Œåœ¨ æ·±å…¥å­¦ä¹ Springç»„ä»¶æ³¨å†Œ ä¸­ï¼Œæˆ‘ä»¬æ›¾ä»‹ç»äº†å¯ä»¥é€šè¿‡ImportSelectoræ¥å®žçŽ°ç»„ä»¶æ³¨å†Œã€‚æ‰€ä»¥é€šè¿‡æŽ¥å£ç¼–ç¨‹å®žçŽ°@Enableæ¨¡å—é©±åŠ¨çš„æœ¬è´¨æ˜¯ï¼šé€šè¿‡@Importæ¥å¯¼å…¥æŽ¥å£ImportSelectorå®žçŽ°ç±»ï¼Œè¯¥å®žçŽ°ç±»é‡Œå¯ä»¥å®šä¹‰éœ€è¦æ³¨å†Œåˆ°IOCå®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œä»¥æ­¤å®žçŽ°ç›¸åº”æ¨¡å—å¯¹åº”ç»„ä»¶çš„æ³¨å†Œã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬æ ¹æ®è¿™ä¸ªæ€è·¯æ¥è‡ªä¸ªå®žçŽ°ä¸€éï¼šåœ¨com.example.demoä¸‹æ–°å»ºselectoråŒ…ï¼Œç„¶åŽåœ¨è¯¥è·¯å¾„ä¸‹æ–°å»ºä¸€ä¸ªHelloWorldImportSelectorå®žçŽ°ImportSelectoræŽ¥å£ï¼š123456public class HelloWorldImportSelector implements ImportSelector &#123; @Override public String[] selectImports(AnnotationMetadata importingClassMetadata) &#123; return new String[]&#123;HelloWorldConfiguration.class.getName()&#125;; &#125;&#125;å¦‚æžœçœ‹ä¸æ‡‚ä¸Šé¢è¿™æ®µä»£ç å«ä¹‰çš„æœ‹å‹å¯ä»¥é˜…è¯»æ·±å…¥å­¦ä¹ Springç»„ä»¶æ³¨å†Œä¸€æ–‡ã€‚æŽ¥ç€æˆ‘ä»¬ä¿®æ”¹EnableHelloWorldï¼š123456@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Import(HelloWorldImportSelector.class)public @interface EnableHelloWorld &#123;&#125;ä¸Šé¢å¯¼å…¥çš„æ˜¯HelloWorldImportSelectorï¼Œè€ŒéžHelloWorldConfigurationã€‚å†æ¬¡è¿è¡ŒTestEnableBootstapçš„mainæ–¹æ³•ï¼Œä½ ä¼šå‘çŽ°è¾“å‡ºæ˜¯ä¸€æ ·çš„ã€‚è‡ªåŠ¨è£…é…Spring Bootä¸­çš„è‡ªåŠ¨è£…é…æŠ€æœ¯åº•å±‚ä¸»è¦ç”¨åˆ°äº†ä¸‹é¢è¿™äº›æŠ€æœ¯:Spring æ¨¡å¼æ³¨è§£è£…é…Spring @Enable æ¨¡å—è£…é…Spring æ¡ä»¶è£…é…è£…ï¼ˆæ·±å…¥å­¦ä¹ Springç»„ä»¶æ³¨å†Œä¸­æœ‰ä»‹ç»ï¼‰Spring å·¥åŽ‚åŠ è½½æœºåˆ¶Spring å·¥åŽ‚åŠ è½½æœºåˆ¶çš„å®žçŽ°ç±»ä¸ºSpringFactoriesLoaderï¼ŒæŸ¥çœ‹å…¶æºç ï¼šè¯¥ç±»çš„æ–¹æ³•ä¼šè¯»å–META-INFç›®å½•ä¸‹çš„spring.factoriesé…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬æŸ¥çœ‹spring-boot-autoconfigure-2.1.0.RELEASE.jarä¸‹çš„è¯¥æ–‡ä»¶ï¼šå½“å¯åŠ¨ç±»è¢«@EnableAutoConfigurationæ ‡æ³¨åŽï¼Œä¸Šé¢æˆªå›¾ä¸­çš„æ‰€æœ‰ç±»Springéƒ½ä¼šåŽ»æ‰«æï¼Œçœ‹æ˜¯å¦å¯ä»¥çº³å…¥åˆ°IOCå®¹å™¨ä¸­è¿›è¡Œç®¡ç†ã€‚æ¯”å¦‚æˆ‘ä»¬æŸ¥çœ‹org.springframework.boot.autoconfigure.data.redis.RedisAutoConfigurationçš„æºç ï¼šå¯çœ‹åˆ°è¯¥ç±»ä¸Šæ ‡æ³¨äº†ä¸€äº›æ³¨è§£ï¼Œå…¶ä¸­@Configurationä¸ºæ¨¡å¼æ³¨è§£ï¼Œ@EnableConfigurationPropertiesä¸ºæ¨¡å—è£…é…æŠ€æœ¯ï¼ŒConditionalOnClassä¸ºæ¡ä»¶è£…é…æŠ€æœ¯ã€‚è¿™å’Œæˆ‘ä»¬ä¸Šé¢åˆ—å‡ºçš„Spring Bootè‡ªåŠ¨è£…é…åº•å±‚ä¸»è¦æŠ€æœ¯ä¸€è‡´ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªæ€è·¯æ¥è‡ªå®šä¹‰ä¸€ä¸ªè‡ªåŠ¨è£…é…å®žçŽ°ã€‚æ–°å»ºä¸€ä¸ªé…ç½®ç±»HelloWorldAutoConfigurationï¼š12345@Configuration@EnableHelloWorld@ConditionalOnProperty(name = "helloworld", havingValue = "true")public class HelloWorldAutoConfiguration &#123;&#125;ç„¶åŽåœ¨resourcesç›®å½•ä¸‹æ–°å»ºMETA-INFç›®å½•ï¼Œå¹¶åˆ›å»ºspring.factoriesæ–‡ä»¶ï¼š123# Auto Configureorg.springframework.boot.autoconfigure.EnableAutoConfiguration=\com.example.demo.configuration.HelloWorldAutoConfigurationæŽ¥ç€åœ¨é…ç½®æ–‡ä»¶application.propertiesä¸­æ·»åŠ helloworld=trueé…ç½®1helloworld=trueæœ€åŽåˆ›å»ºEnableAutoConfigurationBootstrapï¼Œæµ‹è¯•ä¸‹HelloWorldAutoConfigurationæ˜¯å¦ç”Ÿæ•ˆï¼š123456789101112@EnableAutoConfigurationpublic class EnableAutoConfigurationBootstrap &#123; public static void main(String[] args) &#123; ConfigurableApplicationContext context = new SpringApplicationBuilder(EnableAutoConfigurationBootstrap.class) .web(WebApplicationType.NONE) .run(args); String hello = context.getBean("hello", String.class); System.out.println("hello Bean: " + hello); context.close(); &#125;&#125;è¿è¡Œè¯¥mainæ–¹æ³•ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šè¯´æ˜Žæˆ‘ä»¬è‡ªå®šä¹‰çš„è‡ªåŠ¨è£…é…å·²ç»æˆåŠŸäº†ã€‚ä¸‹é¢ç®€è¦åˆ†æžä¸‹ä»£ç çš„è¿è¡Œé€»è¾‘ï¼šSpring çš„å·¥åŽ‚åŠ è½½æœºåˆ¶ä¼šè‡ªåŠ¨è¯»å–META-INFç›®å½•ä¸‹spring.factoriesæ–‡ä»¶å†…å®¹ï¼›æˆ‘ä»¬åœ¨spring.factorieså®šä¹‰äº†ï¼š12org.springframework.boot.autoconfigure.EnableAutoConfiguration=\com.example.demo.configuration.HelloWorldAutoConfigurationæˆ‘ä»¬åœ¨æµ‹è¯•ç±»ä¸Šä½¿ç”¨äº†@EnableAutoConfigurationæ³¨è§£æ ‡æ³¨ï¼Œé‚£ä¹ˆHelloWorldAutoConfigurationå°±ä¼šè¢«Springæ‰«æï¼Œçœ‹æ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œå¦‚æžœç¬¦åˆåˆ™çº³å…¥åˆ°IOCå®¹å™¨ä¸­ï¼›HelloWorldAutoConfigurationä¸Šçš„@ConditionalOnPropertyçš„æ³¨è§£ä½œç”¨ä¸ºï¼šå½“é…ç½®æ–‡ä»¶ä¸­é…ç½®äº†helloworld=trueï¼ˆæˆ‘ä»¬ç¡®å®žæ·»åŠ äº†è¿™ä¸ªé…ç½®ï¼Œæ‰€ä»¥ç¬¦åˆè¦æ±‚ï¼‰åˆ™è¿™ä¸ªç±»ç¬¦åˆæ‰«æè§„åˆ™ï¼›@EnableHelloWorldæ³¨è§£æ˜¯æˆ‘ä»¬å‰é¢ä¾‹å­ä¸­è‡ªå®šä¹‰çš„æ¨¡å—é©±åŠ¨æ³¨è§£ï¼Œå…¶å¼•å…¥äº†helloè¿™ä¸ªBeanï¼Œæ‰€ä»¥IOCå®¹å™¨ä¸­ä¾¿ä¼šå­˜åœ¨helloè¿™ä¸ªBeanäº†ï¼›é€šè¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸Šä¸‹æ–‡èŽ·å–åˆ°helloè¿™ä¸ªBeanäº†ã€‚æºç é“¾æŽ¥ï¼š https://github.com/wuyouzhuguli/SpringAll/tree/master/44.Spring-Boot-Autoconfiguration]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥å­¦ä¹ Spring Beanç”Ÿå‘½å‘¨æœŸ]]></title>
    <url>%2FSpring-Bean-Lifecycle.html</url>
    <content type="text"><![CDATA[æ‰€è°“Spring Beançš„ç”Ÿå‘½å‘¨æœŸæŒ‡çš„æ˜¯Beanä»Žåˆ›å»ºåˆ°åˆå§‹åŒ–å†åˆ°é”€æ¯çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ç”±IOCå®¹å™¨ç®¡ç†ã€‚ä¸€ä¸ªå®Œæ•´çš„Beanç”Ÿå‘½å‘¨æœŸå¯ä»¥å‚è€ƒSpring Beanç”Ÿå‘½å‘¨æœŸã€‚è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®°å½•ä¸€äº›å’ŒBeanç”Ÿå‘½å‘¨æœŸç›¸å…³çš„ç»†èŠ‚ã€‚Beançš„åˆå§‹åŒ–å’Œé”€æ¯åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰Beançš„åˆå§‹åŒ–å’Œé”€æ¯é’©å­å‡½æ•°ï¼Œå½“Beançš„ç”Ÿå‘½å‘¨æœŸåˆ°è¾¾ç›¸åº”çš„é˜¶æ®µçš„æ—¶å€™ï¼ŒSpringä¼šè°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„Beançš„åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•ã€‚è‡ªå®šä¹‰Beanåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•æœ‰å¤šç§æ–¹å¼ï¼Œä¸‹é¢é€ä¸€ä»‹ç»ã€‚@Beanä¸Šä¸€èŠ‚ä¸­ä»‹ç»äº†å¯ä»¥åœ¨é…ç½®ç±»ä¸­é€šè¿‡@Beanæ³¨è§£æ¥æ³¨å†ŒBeanï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å®ƒæ¥æŒ‡å®šBeançš„åˆå§‹åŒ–å’Œæ–¹æ³•ã€‚ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªUserç±»ï¼š1234567891011public class User &#123; public User() &#123; System.out.println("è°ƒç”¨æ— å‚æž„é€ å™¨åˆ›å»ºUser"); &#125; public void init() &#123; System.out.println("åˆå§‹åŒ–User"); &#125; public void destory() &#123; System.out.println("é”€æ¯User"); &#125;&#125;ç„¶åŽåœ¨é…ç½®ç±»é‡Œæ³¨å†Œè¯¥ç»„ä»¶ï¼Œå¹¶æŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•ï¼š12345678@Configurationpublic class WebConfig &#123; @Bean(initMethod = "init", destroyMethod = "destory") public User user() &#123; return new User(); &#125;&#125;å…¶ä¸­initMethod = &quot;init&quot;å’ŒdestroyMethod = &quot;destory&quot;ä¸ŽUserç±»é‡Œçš„initï¼Œdestoryæ–¹æ³•ç›¸å¯¹åº”ã€‚åœ¨Spring Bootå…¥å£ç±»ä¸­æµ‹è¯•:12345// è¿”å›ž IOC å®¹å™¨ï¼Œä½¿ç”¨æ³¨è§£é…ç½®ï¼Œä¼ å…¥é…ç½®ç±»AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class);User user = context.getBean(User.class);// å…³é—­ IOC å®¹å™¨context.close();å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°è¾“å‡º:ä»Žä¸Šé¢çš„è¾“å‡ºæˆ‘ä»¬çœ‹å‡ºåœ¨å®¹å™¨å¯åŠ¨ä¹‹å‰ï¼Œå…ˆè°ƒç”¨å¯¹è±¡çš„æ— å‚æž„é€ å™¨åˆ›å»ºå¯¹è±¡ï¼Œç„¶åŽè°ƒç”¨åˆå§‹åŒ–æ–¹æ³•ï¼Œåœ¨å®¹å™¨å…³é—­çš„æ—¶å€™è°ƒç”¨é”€æ¯æ–¹æ³•ã€‚ä¸Šé¢çš„æƒ…å†µæ˜¯å¯¹äºŽå•ä¾‹è€Œè¨€çš„ï¼Œå¦‚æžœç»„ä»¶æ˜¯å¤šä¾‹æ¨¡å¼åˆæ˜¯ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿæˆ‘ä»¬æŠŠä¸Šé¢çš„ç»„ä»¶æ³¨å†Œé…ç½®æ”¹ä¸ºå¤šä¾‹ï¼Œç„¶åŽå†æ¬¡å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°è¾“å‡º:æŽ§åˆ¶å°çš„è¾“å‡ºå’Œæˆ‘ä»¬ä¸ŠèŠ‚è®¨è®ºçš„ä¸€è‡´ï¼Œå³åœ¨å¤šä¾‹æ¨¡å¼ä¸‹ï¼ŒIOCå®¹å™¨å¯åŠ¨çš„æ—¶å€™å¹¶ä¸ä¼šåŽ»åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯åœ¨æ¯æ¬¡èŽ·å–çš„æ—¶å€™æ‰ä¼šåŽ»è°ƒç”¨æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œåˆ›å»ºå®Œå¯¹è±¡åŽå†è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•ã€‚ä½†åœ¨å®¹å™¨å…³é—­åŽï¼ŒSpringå¹¶æ²¡æœ‰è°ƒç”¨ç›¸åº”çš„é”€æ¯æ–¹æ³•ï¼Œè¿™æ˜¯å› ä¸ºåœ¨å¤šä¾‹æ¨¡å¼ä¸‹ï¼Œå®¹å™¨ä¸ä¼šç®¡ç†è¿™ä¸ªç»„ä»¶ï¼ˆåªè´Ÿè´£åœ¨ä½ éœ€è¦çš„æ—¶å€™åˆ›å»ºè¿™ä¸ªç»„ä»¶ï¼‰ï¼Œæ‰€ä»¥å®¹å™¨åœ¨å…³é—­çš„æ—¶å€™å¹¶ä¸ä¼šè°ƒç”¨ç›¸åº”çš„é”€æ¯æ–¹æ³•ã€‚InitializingBean&amp;DisposableBeané™¤äº†ä¸Šé¢è¿™ç§æ–¹å¼æŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•å¤–ï¼ŒSpringè¿˜ä¸ºæˆ‘ä»¬æä¾›äº†å’Œåˆå§‹åŒ–ï¼Œé”€æ¯ç›¸å¯¹åº”çš„æŽ¥å£ï¼šInitializingBeanæŽ¥å£åŒ…å«ä¸€ä¸ªafterPropertiesSetæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®žçŽ°è¯¥æŽ¥å£ï¼Œç„¶åŽåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ç¼–å†™åˆå§‹åŒ–é€»è¾‘ã€‚DisposableBeanæŽ¥å£åŒ…å«ä¸€ä¸ªdestoryæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®žçŽ°è¯¥æŽ¥å£ï¼Œç„¶åŽå†è¿™ä¸ªæ–¹æ³•ä¸­ç¼–å†™é”€æ¯é€»è¾‘ã€‚æ–°å»ºä¸€ä¸ªç±»ï¼Œåç§°ä¸ºBirdï¼Œç„¶åŽå®žçŽ°è¿™ä¸¤ä¸ªæŽ¥å£ï¼š123456789101112131415public class Bird implements InitializingBean, DisposableBean &#123; public Bird() &#123; System.out.println("è°ƒç”¨æ— å‚æž„é€ å™¨åˆ›å»ºBird"); &#125; @Override public void destroy() &#123; System.out.println("é”€æ¯Bird"); &#125; @Override public void afterPropertiesSet() &#123; System.out.println("åˆå§‹åŒ–Bird"); &#125;&#125;åœ¨é…ç½®ç±»ä¸­æ³¨å†Œè¿™ä¸ªç»„ä»¶:1234@Beanpublic Bird bird() &#123; return new Bird();&#125;æµ‹è¯•ä¸€æ³¢ï¼š123AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class);System.out.println("å®¹å™¨åˆ›å»ºå®Œæ¯•");context.close();å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°è¾“å‡º:@PostConstruct&amp;@PreDestroyé™¤äº†ä¸Šé¢ä¸¤ç§æŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•çš„æ–¹å¼å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨@PostConstructå’Œ@PreDestroyæ³¨è§£ä¿®é¥°æ–¹æ³•æ¥æŒ‡å®šç›¸åº”çš„åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•ã€‚æ–°å»ºä¸€ä¸ªç±»ï¼Œåç§°ä¸ºFishï¼š123456789101112131415public class Fish &#123; public Fish() &#123; System.out.println("è°ƒç”¨æ— å‚æž„é€ å™¨åˆ›å»ºFish"); &#125; @PostConstruct public void init() &#123; System.out.println("åˆå§‹åŒ–Fish"); &#125; @PreDestroy public void destory() &#123; System.out.println("é”€æ¯Fish"); &#125;&#125;åœ¨é…ç½®ç±»ä¸­æ³¨å†Œè¿™ä¸ªç»„ä»¶:1234@Beanpublic Fish fish()&#123; return new Fish();&#125;æµ‹è¯•ä¸€æ³¢ï¼š123AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class);System.out.println("å®¹å™¨åˆ›å»ºå®Œæ¯•");context.close();å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°è¾“å‡º:æ•ˆæžœå’Œä¸Šé¢ä¸¤ç§æ–¹å¼ä¸€è‡´ã€‚è¿™ä¸¤ä¸ªæ³¨è§£å¹¶éžSpringæä¾›ï¼Œè€Œæ˜¯JSR250è§„èŒƒæä¾›ã€‚BeanPostProcessorSpringæä¾›äº†ä¸€ä¸ªBeanPostProcessoræŽ¥å£ï¼Œä¿—ç§°BeanåŽç½®é€šçŸ¥å¤„ç†å™¨ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªæ–¹æ³•postProcessBeforeInitializationå’ŒpostProcessAfterInitializationã€‚å…¶ä¸­postProcessBeforeInitializationåœ¨ç»„ä»¶çš„åˆå§‹åŒ–æ–¹æ³•è°ƒç”¨ä¹‹å‰æ‰§è¡Œï¼ŒpostProcessAfterInitializationåœ¨ç»„ä»¶çš„åˆå§‹åŒ–æ–¹æ³•è°ƒç”¨ä¹‹åŽæ‰§è¡Œã€‚å®ƒä»¬éƒ½åŒ…å«ä¸¤ä¸ªå…¥å‚ï¼šbeanï¼šå½“å‰ç»„ä»¶å¯¹è±¡ï¼›beanNameï¼šå½“å‰ç»„ä»¶åœ¨å®¹å™¨ä¸­çš„åç§°ã€‚ä¸¤ä¸ªæ–¹æ³•éƒ½è¿”å›žä¸€ä¸ªObjectç±»åž‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥è¿”å›žå½“å‰ç»„ä»¶å¯¹è±¡ï¼Œæˆ–è€…åŒ…è£…åŽè¿”å›žã€‚æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªBeanPostProcessoræŽ¥å£çš„å®žçŽ°ç±»MyBeanPostProcessorï¼š123456789101112public class MyBeanPostProcessor implements BeanPostProcessor &#123; @Override public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException &#123; System.out.println(beanName + " åˆå§‹åŒ–ä¹‹å‰è°ƒç”¨"); return bean; &#125; @Override public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException &#123; System.out.println(beanName + " åˆå§‹åŒ–ä¹‹åŽè°ƒç”¨"); return bean; &#125;&#125;åœ¨é…ç½®ç±»ä¸­æ³¨å†Œè¯¥ç»„ä»¶:1234@Beanpublic MyBeanPostProcessor myBeanPostProcessor () &#123; return new MyBeanPostProcessor();&#125;å†æ¬¡å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°è¾“å‡º:å¯ä»¥çœ‹åˆ°ï¼ŒBeanPostProcessorå¯¹IOCå®¹å™¨ä¸­æ‰€æœ‰ç»„ä»¶éƒ½ç”Ÿæ•ˆã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/51.Spring-Bean-Lifecycle]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥å­¦ä¹ Springç»„ä»¶æ³¨å†Œ]]></title>
    <url>%2FSpring-Bean-Regist.html</url>
    <content type="text"><![CDATA[æŽ¥è§¦è¿‡Springçš„åŒå­¦è‚¯å®šéƒ½å¬è¿‡IOCã€‚åœ¨ä¼ ç»Ÿçš„Javaç¼–ç¨‹ä¸­ï¼Œå½“éœ€è¦ç”¨åˆ°æŸä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä¸»åŠ¨åœ°æ˜¾ç¤ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡å®žä¾‹ï¼ˆnewï¼‰ã€‚ä½¿ç”¨SpringåŽå°±ä¸éœ€è¦è¿™æ ·åšäº†ï¼Œå› ä¸ºSpringä¼šå¸®æˆ‘ä»¬åœ¨éœ€è¦ç”¨åˆ°æŸäº›å¯¹è±¡çš„åœ°æ–¹è‡ªåŠ¨æ³¨å…¥è¯¥å¯¹è±¡ï¼Œè€Œæ— é¡»æˆ‘ä»¬è‡ªå·±åŽ»åˆ›å»ºã€‚è¿™ç§æ¨¡å¼ä¿—ç§°æŽ§åˆ¶åè½¬ï¼Œå³IOCï¼ˆInversion of Controlï¼‰ã€‚é‚£ä¹ˆSpringæ˜¯ä»Žä»€ä¹ˆåœ°æ–¹èŽ·å–åˆ°æˆ‘ä»¬æ‰€éœ€è¦çš„å¯¹è±¡å‘¢ï¼Ÿå…¶å®žSpringç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªIOCå®¹å™¨ï¼Œé‡Œé¢ç®¡ç†ç€æ‰€æœ‰æˆ‘ä»¬éœ€è¦çš„å¯¹è±¡ï¼Œç»„ä»¶æ³¨å†Œå°±æ˜¯æˆ‘ä»¬åŽ»å‘Šè¯‰Springå“ªäº›ç±»éœ€è¦äº¤ç»™IOCå®¹å™¨ç®¡ç†ã€‚è¿™é‡Œä¸»è¦è®°å½•ç»„ä»¶æ³¨å†Œçš„ä¸€äº›ç»†èŠ‚ã€‚é€šè¿‡@Beanæ³¨å†Œç»„ä»¶åœ¨è¾ƒæ—©ç‰ˆæœ¬çš„Springä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡XMLçš„æ–¹å¼æ¥å¾€IOCå®¹å™¨ä¸­æ³¨å†Œç»„ä»¶çš„ï¼Œä¸‹é¢è¿™æ®µä»£ç å¤§å®¶è‚¯å®šä¸ä¼šé™Œç”Ÿï¼š123// è¿”å›ž IOC å®¹å™¨ï¼ŒåŸºäºŽ XMLé…ç½®ï¼Œä¼ å…¥é…ç½®æ–‡ä»¶çš„ä½ç½®ApplicationContext applicationContext = new ClassPathXmlApplicationContext("xxx.xml");User user = (User) applicationContext.getBean("user");Spring 4åŽæŽ¨èæˆ‘ä»¬ä½¿ç”¨Java Configçš„æ–¹å¼æ¥æ³¨å†Œç»„ä»¶ã€‚ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬é€šè¿‡http://start.spring.io/æ­å»ºä¸€ä¸ªç®€å•Spring Bootåº”ç”¨ï¼Œç„¶åŽå¼•å…¥Lombokä¾èµ–ï¼ˆç¼–è¾‘å™¨ä¹Ÿéœ€è¦å®‰è£…Lombokæ’ä»¶ï¼‰ï¼š12345&lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;scope&gt;provided&lt;/scope&gt;&lt;/dependency&gt;ç„¶åŽåˆ›å»ºä¸€ä¸ªUserç±»ï¼š1234567@ToString@AllArgsConstructor@Datapublic class User &#123; private String name; private Integer age;&#125;æŽ¥ç€åˆ›å»ºä¸€ä¸ªé…ç½®ç±»ï¼Œåœ¨é‡Œé¢é€šè¿‡@Beanæ³¨è§£æ³¨å†ŒUserç±»ï¼š1234567@Configurationpublic class WebConfig &#123; @Bean() public User user() &#123; return new User("mrbird", 18); &#125;&#125;é€šè¿‡@Beanæ³¨è§£ï¼Œæˆ‘ä»¬å‘IOCå®¹å™¨æ³¨å†Œäº†ä¸€ä¸ªåç§°ä¸ºuserï¼ˆBeanåç§°é»˜è®¤ä¸ºæ–¹æ³•åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡@Bean(&quot;myUser&quot;)æ–¹å¼æ¥å°†ç»„ä»¶åç§°æŒ‡å®šä¸ºmyUserï¼‰ã€‚ç»„ä»¶æ³¨å†Œå®Œæ¯•åŽï¼Œæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ä»ŽIOCå®¹å™¨ä¸­èŽ·å–è¿™ä¸ªç»„ä»¶ã€‚åœ¨Spring Bootå…¥å£ç±»ä¸­ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š1234567891011@SpringBootApplicationpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); // è¿”å›ž IOC å®¹å™¨ï¼Œä½¿ç”¨æ³¨è§£é…ç½®ï¼Œä¼ å…¥é…ç½®ç±» ApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class); User user = context.getBean(User.class); System.out.println(user); &#125;&#125;å› ä¸ºæˆ‘ä»¬æ˜¯é€šè¿‡æ³¨è§£æ–¹å¼æ¥æ³¨å†Œç»„ä»¶çš„ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨AnnotationConfigApplicationContextæ¥èŽ·å–ç›¸åº”çš„IOCå®¹å™¨ï¼Œå…¥å‚ä¸ºé…ç½®ç±»ã€‚å¯åŠ¨é¡¹ç›®ï¼Œçœ‹ä¸‹æŽ§åˆ¶å°è¾“å‡ºï¼šè¯´æ˜Žç»„ä»¶æ³¨å†ŒæˆåŠŸã€‚æˆ‘ä»¬å°†ç»„ä»¶çš„åç§°æ”¹ä¸ºmyUserï¼Œç„¶åŽçœ‹çœ‹IOCå®¹å™¨ä¸­ï¼ŒUserç±»åž‹ç»„ä»¶æ˜¯å¦å«myUserï¼š1234567891011@SpringBootApplicationpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); ApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class); // æŸ¥çœ‹ User è¿™ä¸ªç±»åœ¨ Spring å®¹å™¨ä¸­å«å•¥çŽ©æ„ String[] beanNames = context.getBeanNamesForType(User.class); Arrays.stream(beanNames).forEach(System.out::println); &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°è¾“å‡º:ä½¿ç”¨@ComponentScanæ‰«æåœ¨ä½¿ç”¨XMLé…ç½®ç»„ä»¶æ‰«æçš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½æ˜¯è¿™æ ·é…ç½®çš„ï¼š1&lt;context:component-scan base-package=""&gt;&lt;/context:component-scan&gt;å…¶ä¸­base-packageæŒ‡å®šäº†æ‰«æçš„è·¯å¾„ã€‚è·¯å¾„ä¸‹æ‰€æœ‰è¢«@Controllerã€@Serviceã€@Repositoryå’Œ@Componentæ³¨è§£æ ‡æ³¨çš„ç±»éƒ½ä¼šè¢«çº³å…¥IOCå®¹å™¨ä¸­ã€‚çŽ°åœ¨æˆ‘ä»¬è„±ç¦»XMLé…ç½®åŽï¼Œå¯ä»¥ä½¿ç”¨@ComponentScanæ³¨è§£æ¥æ‰«æç»„ä»¶å¹¶æ³¨å†Œã€‚åœ¨ä½¿ç”¨@ComponentScanæ‰«æä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªControllerï¼Œä¸€ä¸ªServiceï¼Œä¸€ä¸ªDaoï¼Œå¹¶æ ‡æ³¨ä¸Šç›¸åº”çš„æ³¨è§£ã€‚ç„¶åŽä¿®æ”¹é…ç½®ç±»ï¼š123456789@Configuration@ComponentScan("cc.mrbird.demo")public class WebConfig &#123; // @Bean("myUser") // public User user() &#123; // return new User("mrbird", 18); // &#125;&#125;åœ¨é…ç½®ç±»ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡@ComponentScan(&quot;cc.mrbird.demo&quot;)é…ç½®äº†æ‰«æè·¯å¾„ï¼Œå¹¶ä¸”å°†Userç»„ä»¶æ³¨å†Œæ³¨é‡ŠæŽ‰äº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯åœ¨Userç±»ä¸ŠåŠ ä¸Š@Componentæ³¨è§£ï¼š123456789@ToString@AllArgsConstructor@NoArgsConstructor@Data@Componentpublic class User &#123; private String name; private Integer age;&#125;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½å°†Spring Bootçš„å…¥å£ç±»çº³å…¥æ‰«æèŒƒå›´ä¸­ï¼Œå¦åˆ™é¡¹ç›®å¯åŠ¨å°†å‡ºé”™ã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸‹åœ¨åŸºäºŽæ³¨è§£çš„IOCå®¹å™¨ä¸­æ˜¯å¦åŒ…å«äº†è¿™äº›ç»„ä»¶ï¼š1234567891011@SpringBootApplicationpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); ApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class); // æŸ¥çœ‹åŸºäºŽæ³¨è§£çš„ IOCå®¹å™¨ä¸­æ‰€æœ‰ç»„ä»¶åç§° String[] beanNames = context.getBeanDefinitionNames(); Arrays.stream(beanNames).forEach(System.out::println); &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°ï¼šå¯è§ï¼Œç»„ä»¶å·²ç»æˆåŠŸè¢«æ‰«æè¿›åŽ»äº†ï¼Œå¹¶ä¸”åç§°é»˜è®¤ä¸ºç±»åé¦–å­—æ¯å°å†™ã€‚è¿™é‡Œï¼Œé…ç½®ç±»WebConfigä¹Ÿè¢«æ‰«æå¹¶æ³¨å†Œäº†ï¼ŒæŸ¥çœ‹@Configurationæºç å°±ä¼šå‘çŽ°åŽŸå› ï¼š1234567@Target(ElementType.TYPE)@Retention(RetentionPolicy.RUNTIME)@Documented@Componentpublic @interface Configuration &#123; String value() default "";&#125;æŒ‡å®šæ‰«æç­–ç•¥@ComponentScanæ³¨è§£å…è®¸æˆ‘ä»¬æŒ‡å®šæ‰«æç­–ç•¥ï¼Œå³æŒ‡å®šå“ªäº›è¢«æ‰«æï¼Œå“ªäº›ä¸è¢«æ‰«æï¼ŒæŸ¥çœ‹å…¶æºç å¯å‘çŽ°è¿™ä¸¤ä¸ªå±žæ€§ï¼š1234567891011121314151617/** * Specifies which types are eligible for component scanning. * &lt;p&gt;Further narrows the set of candidate components from everything in &#123;@link #basePackages&#125; * to everything in the base packages that matches the given filter or filters. * &lt;p&gt;Note that these filters will be applied in addition to the default filters, if specified. * Any type under the specified base packages which matches a given filter will be included, * even if it does not match the default filters (i.e. is not annotated with &#123;@code @Component&#125;). * @see #resourcePattern() * @see #useDefaultFilters() */Filter[] includeFilters() default &#123;&#125;;/** * Specifies which types are not eligible for component scanning. * @see #resourcePattern */Filter[] excludeFilters() default &#123;&#125;;å…¶ä¸­Filterä¹Ÿæ˜¯ä¸€ä¸ªæ³¨è§£:1234567891011121314151617/** * Declares the type filter to be used as an &#123;@linkplain ComponentScan#includeFilters * include filter&#125; or &#123;@linkplain ComponentScan#excludeFilters exclude filter&#125;. */@Retention(RetentionPolicy.RUNTIME)@Target(&#123;&#125;)@interface Filter &#123; FilterType type() default FilterType.ANNOTATION; @AliasFor("classes") Class&lt;?&gt;[] value() default &#123;&#125;; @AliasFor("value") Class&lt;?&gt;[] classes() default &#123;&#125;; String[] pattern() default &#123;&#125;;&#125;æŽ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨excludeFiltersæ¥æŽ’é™¤ä¸€äº›ç»„ä»¶çš„æ‰«æï¼š12345678910@Configuration@ComponentScan(value = "cc.mrbird.demo", excludeFilters = &#123; @Filter(type = FilterType.ANNOTATION, classes = &#123;Controller.class, Repository.class&#125;), @Filter(type = FilterType.ASSIGNABLE_TYPE, classes = User.class) &#125;)public class WebConfig &#123;&#125;ä¸Šé¢æˆ‘ä»¬æŒ‡å®šäº†ä¸¤ç§æŽ’é™¤æ‰«æçš„è§„åˆ™ï¼šæ ¹æ®æ³¨è§£æ¥æŽ’é™¤ï¼ˆtype = FilterType.ANNOTATIONï¼‰,è¿™äº›æ³¨è§£çš„ç±»åž‹ä¸ºclasses = {Controller.class, Repository.class}ã€‚å³Controllerå’ŒRepositoryæ³¨è§£æ ‡æ³¨çš„ç±»ä¸å†è¢«çº³å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚æ ¹æ®æŒ‡å®šç±»åž‹ç±»æŽ’é™¤ï¼ˆtype = FilterType.ASSIGNABLE_TYPEï¼‰ï¼ŒæŽ’é™¤ç±»åž‹ä¸ºUser.classï¼Œå…¶å­ç±»ï¼Œå®žçŽ°ç±»éƒ½ä¼šè¢«æŽ’é™¤ã€‚å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°ï¼šå¯è§æŽ’é™¤æˆåŠŸã€‚é™¤äº†ä¸Šé¢ä¸¤ç§å¸¸ç”¨çš„è§„åˆ™å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨åˆ«çš„è§„åˆ™ï¼ŒæŸ¥çœ‹FilterTypeæºç ï¼š1234567891011121314151617181920212223242526272829303132333435public enum FilterType &#123; /** * Filter candidates marked with a given annotation. * * @see org.springframework.core.type.filter.AnnotationTypeFilter */ ANNOTATION, /** * Filter candidates assignable to a given type. * * @see org.springframework.core.type.filter.AssignableTypeFilter */ ASSIGNABLE_TYPE, /** * Filter candidates matching a given AspectJ type pattern expression. * * @see org.springframework.core.type.filter.AspectJTypeFilter */ ASPECTJ, /** * Filter candidates matching a given regex pattern. * * @see org.springframework.core.type.filter.RegexPatternTypeFilter */ REGEX, /** * Filter candidates using a given custom * &#123;@link org.springframework.core.type.filter.TypeFilter&#125; implementation. */ CUSTOM&#125;å¯çœ‹åˆ°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ASPECTJè¡¨è¾¾å¼ï¼ŒREGEXæ­£åˆ™è¡¨è¾¾å¼å’ŒCUSTOMè‡ªå®šä¹‰è§„åˆ™ï¼ˆä¸‹é¢è¯¦ç»†ä»‹ç»ï¼‰æ¥æŒ‡å®šæ‰«æç­–ç•¥ã€‚includeFiltersçš„ä½œç”¨å’ŒexcludeFiltersç›¸åï¼Œå…¶æŒ‡å®šçš„æ˜¯å“ªäº›ç»„ä»¶éœ€è¦è¢«æ‰«æï¼š12345678@Configuration@ComponentScan(value = "cc.mrbird.demo", includeFilters = &#123; @Filter(type = FilterType.ANNOTATION, classes = Service.class) &#125;, useDefaultFilters = false)public class WebConfig &#123;&#125;ä¸Šé¢é…ç½®äº†åªå°†Controllerçº³å…¥IOCå®¹å™¨ï¼Œå¹¶ä¸”éœ€è¦ç”¨useDefaultFilters = falseæ¥å…³é—­Springé»˜è®¤çš„æ‰«æç­–ç•¥æ‰èƒ½è®©æˆ‘ä»¬çš„é…ç½®ç”Ÿæ•ˆï¼ˆSpring Bootå…¥å£ç±»çš„@SpringBootApplicationæ³¨è§£åŒ…å«äº†ä¸€äº›é»˜è®¤çš„æ‰«æç­–ç•¥ï¼‰ã€‚å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°ï¼šå¯çœ‹åˆ°ï¼ŒIOCå®¹å™¨ä¸­å°†ä¸å†åŒ…å«daoï¼Œserviceã€‚å¤šæ‰«æç­–ç•¥é…ç½®åœ¨Java 8ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨@ComponentScansæ¥é…ç½®å¤šä¸ª@ComponentScanä»¥å®žçŽ°å¤šæ‰«æè§„åˆ™é…ç½®ï¼šè€Œåœ¨Java 8ä¸­ï¼Œæ–°å¢žäº†@Repeatableæ³¨è§£ï¼Œä½¿ç”¨è¯¥æ³¨è§£ä¿®é¥°çš„æ³¨è§£å¯ä»¥é‡å¤ä½¿ç”¨ï¼ŒæŸ¥çœ‹@ComponentScanæºç ä¼šå‘çŽ°å…¶å·²ç»è¢«è¯¥æ³¨è§£æ ‡æ³¨ï¼šæ‰€ä»¥é™¤äº†ä½¿ç”¨@ComponentScansæ¥é…ç½®å¤šæ‰«æè§„åˆ™å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å¤šæ¬¡ä½¿ç”¨@ComponentScanæ¥æŒ‡å®šå¤šä¸ªä¸åŒçš„æ‰«æè§„åˆ™ã€‚è‡ªå®šä¹‰æ‰«æç­–ç•¥è‡ªå®šä¹‰æ‰«æç­–ç•¥éœ€è¦æˆ‘ä»¬å®žçŽ°org.springframework.core.type.filter.TypeFilteræŽ¥å£ï¼Œåˆ›å»ºMyTypeFilterå®žçŽ°è¯¥æŽ¥å£ï¼š123456public class MyTypeFilter implements TypeFilter &#123; @Override public boolean match(MetadataReader metadataReader, MetadataReaderFactory metadataReaderFactory) throws IOException &#123; return false; &#125;&#125;è¯¥æŽ¥å£åŒ…å«matchæ–¹æ³•ï¼Œå…¶ä¸¤ä¸ªå…¥å‚MetadataReaderå’ŒMetadataReaderFactoryå«ä¹‰å¦‚ä¸‹ï¼šMetadataReaderï¼šå½“å‰æ­£åœ¨æ‰«æçš„ç±»çš„ä¿¡æ¯ï¼›MetadataReaderFactoryï¼šå¯ä»¥é€šè¿‡å®ƒæ¥èŽ·å–å…¶ä»–ç±»çš„ä¿¡æ¯ã€‚å½“matchæ–¹æ³•è¿”å›žtrueæ—¶è¯´æ˜ŽåŒ¹é…æˆåŠŸï¼Œfalseåˆ™è¯´æ˜ŽåŒ¹é…å¤±è´¥ã€‚ç»§ç»­å®Œå–„è¿™ä¸ªè¿‡æ»¤è§„åˆ™ï¼š1234567891011121314public class MyTypeFilter implements TypeFilter &#123; @Override public boolean match(MetadataReader metadataReader, MetadataReaderFactory metadataReaderFactory) &#123; // èŽ·å–å½“å‰æ­£åœ¨æ‰«æçš„ç±»çš„æ³¨è§£ä¿¡æ¯ AnnotationMetadata annotationMetadata = metadataReader.getAnnotationMetadata(); // èŽ·å–å½“å‰æ­£åœ¨æ‰«æçš„ç±»çš„ç±»ä¿¡æ¯ ClassMetadata classMetadata = metadataReader.getClassMetadata(); // èŽ·å–å½“å‰æ­£åœ¨æ‰«æçš„ç±»çš„è·¯å¾„ç­‰ä¿¡æ¯ Resource resource = metadataReader.getResource(); String className = classMetadata.getClassName(); return StringUtils.hasText("er"); &#125;&#125;ä¸Šé¢æŒ‡å®šäº†å½“è¢«æ‰«æçš„ç±»ååŒ…å«eræ—¶å€™ï¼ŒåŒ¹é…æˆåŠŸï¼Œé…åˆexcludeFiltersä½¿ç”¨æ„æŒ‡å½“è¢«æ‰«æçš„ç±»ååŒ…å«eræ—¶ï¼Œè¯¥ç±»ä¸è¢«çº³å…¥IOCå®¹å™¨ä¸­ã€‚æˆ‘ä»¬åœ¨@ComponentScanä¸­ä½¿ç”¨è¿™ä¸ªè‡ªå®šä¹‰çš„è¿‡æ»¤ç­–ç•¥ï¼š1234567@Configuration@ComponentScan(value = "cc.mrbird.demo", excludeFilters = &#123; @Filter(type = FilterType.CUSTOM, classes = MyTypeFilter.class) &#125;)public class WebConfig &#123;&#125;å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯Ÿè¾“å‡ºï¼š å› ä¸ºUserï¼ŒUserMapperï¼ŒUserServiceå’ŒUserControllerç­‰ç±»çš„ç±»åéƒ½åŒ…å«erï¼Œæ‰€ä»¥å®ƒä»¬éƒ½æ²¡æœ‰è¢«çº³å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚ç»„ä»¶ä½œç”¨åŸŸ@Scopeé»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨Springçš„IOCå®¹å™¨ä¸­æ¯ä¸ªç»„ä»¶éƒ½æ˜¯å•ä¾‹çš„ï¼Œå³æ— è®ºåœ¨ä»»ä½•åœ°æ–¹æ³¨å…¥å¤šå°‘æ¬¡ï¼Œè¿™äº›å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ä¾‹å­ã€‚é¦–å…ˆå°†Userå¯¹è±¡ä¸­çš„@Componentæ³¨è§£åŽ»é™¤ï¼Œç„¶åŽåœ¨é…ç½®ç±»ä¸­é…ç½®User Beanï¼š1234567@Configurationpublic class WebConfig &#123; @Bean public User user() &#123; return new User("mrbird", 18); &#125;&#125;æŽ¥ç€å¤šæ¬¡ä»ŽIOCå®¹å™¨ä¸­èŽ·å–è¿™ä¸ªç»„ä»¶ï¼Œçœ‹çœ‹æ˜¯å¦ä¸ºåŒä¸€ä¸ªï¼š12345// è¿”å›ž IOC å®¹å™¨ï¼Œä½¿ç”¨æ³¨è§£é…ç½®ï¼Œä¼ å…¥é…ç½®ç±»ApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class);Object user1 = context.getBean("user");Object user2 = context.getBean("user");System.out.println(user1 == user2);å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°è¾“å‡º:ç»“æžœè¯å®žäº†ä¸Šé¢çš„è§‚ç‚¹ã€‚åœ¨Springä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@Scopeæ³¨è§£æ¥æ”¹å˜ç»„ä»¶çš„ä½œç”¨åŸŸï¼šsingletonï¼šå•å®žä¾‹ï¼ˆé»˜è®¤ï¼‰,åœ¨Spring IOCå®¹å™¨å¯åŠ¨çš„æ—¶å€™ä¼šè°ƒç”¨æ–¹æ³•åˆ›å»ºå¯¹è±¡ç„¶åŽçº³å…¥åˆ°IOCå®¹å™¨ä¸­ï¼Œä»¥åŽæ¯æ¬¡èŽ·å–éƒ½æ˜¯ç›´æŽ¥ä»ŽIOCå®¹å™¨ä¸­èŽ·å–ï¼ˆmap.get()ï¼‰ï¼›prototypeï¼šå¤šå®žä¾‹ï¼ŒIOCå®¹å™¨å¯åŠ¨çš„æ—¶å€™å¹¶ä¸ä¼šåŽ»åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯åœ¨æ¯æ¬¡èŽ·å–çš„æ—¶å€™æ‰ä¼šåŽ»è°ƒç”¨æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼›requestï¼šä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ªå®žä¾‹ï¼›sessionï¼šåŒä¸€ä¸ªsessionå¯¹åº”ä¸€ä¸ªå®žä¾‹ã€‚æ‡’åŠ è½½@Lazyæ‡’åŠ è½½æ˜¯é’ˆå¯¹å•ä¾‹æ¨¡å¼è€Œè¨€çš„ï¼Œæ­£å¦‚å‰é¢æ‰€è¯´ï¼ŒIOCå®¹å™¨ä¸­çš„ç»„ä»¶é»˜è®¤æ˜¯å•ä¾‹çš„ï¼Œå®¹å™¨å¯åŠ¨çš„æ—¶å€™ä¼šè°ƒç”¨æ–¹æ³•åˆ›å»ºå¯¹è±¡ç„¶åŽçº³å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚åœ¨User Beanæ³¨å†Œçš„åœ°æ–¹åŠ å…¥ä¸€å¥è¯ä»¥è§‚å¯Ÿï¼š12345678@Configurationpublic class WebConfig &#123; @Bean public User user() &#123; System.out.println("å¾€IOCå®¹å™¨ä¸­æ³¨å†Œuser bean"); return new User("mrbird", 18); &#125;&#125;æµ‹è¯•ï¼š12ApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class);System.out.println("å®¹å™¨åˆ›å»ºå®Œæ¯•");å¯åŠ¨é¡¹ç›®è§‚å¯ŸæŽ§åˆ¶å°è¾“å‡º:å¯ä»¥çœ‹åˆ°ï¼Œåœ¨IOCå®¹å™¨åˆ›å»ºå®Œæ¯•ä¹‹å‰ï¼Œç»„ä»¶å·²ç»æ·»åŠ åˆ°å®¹å™¨ä¸­äº†ã€‚å°†User Beanæ”¹ä¸ºæ‡’åŠ è½½çš„æ–¹å¼ï¼š123456789@Configurationpublic class WebConfig &#123; @Bean @Lazy public User user() &#123; System.out.println("å¾€IOCå®¹å™¨ä¸­æ³¨å†Œuser bean"); return new User("mrbird", 18); &#125;&#125;å†æ¬¡å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯Ÿè¾“å‡ºï¼šå¯çœ‹åˆ°ï¼Œå®¹å™¨åˆ›å»ºå®Œçš„æ—¶å€™ï¼ŒUser Beanè¿™ä¸ªç»„ä»¶å¹¶æœªæ·»åŠ åˆ°å®¹å™¨ä¸­ã€‚æ‰€ä»¥æ‡’åŠ è½½çš„åŠŸèƒ½æ˜¯ï¼Œåœ¨å•ä¾‹æ¨¡å¼ä¸­ï¼ŒIOCå®¹å™¨åˆ›å»ºçš„æ—¶å€™ä¸ä¼šé©¬ä¸ŠåŽ»è°ƒç”¨æ–¹æ³•åˆ›å»ºå¯¹è±¡å¹¶æ³¨å†Œï¼Œåªæœ‰å½“ç»„ä»¶ç¬¬ä¸€æ¬¡è¢«ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šè°ƒç”¨æ–¹æ³•åˆ›å»ºå¯¹è±¡å¹¶åŠ å…¥åˆ°å®¹å™¨ä¸­ã€‚æµ‹è¯•ä¸€ä¸‹ï¼š1234ApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class);System.out.println("å®¹å™¨åˆ›å»ºå®Œæ¯•");Object user1 = context.getBean("user");Object user2 = context.getBean("user");å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯Ÿè¾“å‡º:ç»“æžœè¯å®žäº†æˆ‘ä»¬çš„è§‚ç‚¹ã€‚æ¡ä»¶æ³¨å†Œç»„ä»¶@Conditionalä½¿ç”¨@Conditionalæ³¨è§£æˆ‘ä»¬å¯ä»¥æŒ‡å®šç»„ä»¶æ³¨å†Œçš„æ¡ä»¶ï¼Œå³æ»¡è¶³ç‰¹å®šæ¡ä»¶æ‰å°†ç»„ä»¶çº³å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚åœ¨ä½¿ç”¨è¯¥æ³¨è§£ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç±»ï¼Œå®žçŽ°ConditionæŽ¥å£ï¼š123456public class MyCondition implements Condition &#123; @Override public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) &#123; return false; &#125;&#125;è¯¥æŽ¥å£åŒ…å«ä¸€ä¸ªmatchesæ–¹æ³•ï¼ŒåŒ…å«ä¸¤ä¸ªå…¥å‚:ConditionContextï¼šä¸Šä¸‹æ–‡ä¿¡æ¯ï¼›AnnotatedTypeMetadataï¼šæ³¨è§£ä¿¡æ¯ã€‚ç®€å•å®Œå–„ä¸€ä¸‹è¿™ä¸ªå®žçŽ°ç±»:1234567public class MyCondition implements Condition &#123; @Override public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) &#123; String osName = context.getEnvironment().getProperty("os.name"); return osName != null &amp;&amp; osName.contains("Windows"); &#125;&#125;æŽ¥ç€å°†è¿™ä¸ªæ¡ä»¶æ·»åŠ åˆ°User Beanæ³¨å†Œçš„åœ°æ–¹ï¼š12345@Bean@Conditional(MyCondition.class)public User user() &#123; return new User("mrbird", 18);&#125;åœ¨WindowsçŽ¯å¢ƒä¸‹ï¼ŒUserè¿™ä¸ªç»„ä»¶å°†è¢«æˆåŠŸæ³¨å†Œï¼Œå¦‚æžœæ˜¯åˆ«çš„æ“ä½œç³»ç»Ÿï¼Œè¿™ä¸ªç»„ä»¶å°†ä¸ä¼šè¢«æ³¨å†Œåˆ°IOCå®¹å™¨ä¸­ã€‚@Profile@Profileå¯ä»¥æ ¹æ®ä¸åŒçš„çŽ¯å¢ƒå˜é‡æ¥æ³¨å†Œä¸åŒçš„ç»„ä»¶ï¼Œä¸‹é¢æˆ‘ä»¬æ¥å­¦ä¸€ä¸‹å®ƒçš„ç”¨æ³•ã€‚æ–°å»ºä¸€ä¸ªæŽ¥å£CalculateServiceï¼š123public interface CalculateService &#123; Integer sum(Integer... value);&#125;æŽ¥ç€æ·»åŠ ä¸¤ä¸ªå®žçŽ°Java7CalculateServiceImplå’ŒJava8CalculateServiceImpl:12345678910111213@Service@Profile("java7")public class Java7CalculateServiceImpl implements CalculateService &#123; @Override public Integer sum(Integer... value) &#123; System.out.println("Java 7çŽ¯å¢ƒä¸‹æ‰§è¡Œ"); int result = 0; for (int i = 0; i &lt;= value.length; i++) &#123; result += i; &#125; return result; &#125;&#125;123456789@Service@Profile("java8")public class Java8CalculateServiceImpl implements CalculateService &#123; @Override public Integer sum(Integer... value) &#123; System.out.println("Java 8çŽ¯å¢ƒä¸‹æ‰§è¡Œ"); return Arrays.stream(value).reduce(0, Integer::sum); &#125;&#125;é€šè¿‡@Profileæ³¨è§£æˆ‘ä»¬å®žçŽ°äº†ï¼šå½“çŽ¯å¢ƒå˜é‡åŒ…å«java7çš„æ—¶å€™ï¼ŒJava7CalculateServiceImplå°†ä¼šè¢«æ³¨å†Œåˆ°IOCå®¹å™¨ä¸­ï¼›å½“çŽ¯å¢ƒå˜é‡åŒ…å«java8çš„æ—¶å€™ï¼ŒJava8CalculateServiceImplå°†ä¼šè¢«æ³¨å†Œåˆ°IOCå®¹å™¨ä¸­ã€‚æµ‹è¯•ä¸€ä¸‹ï¼š1234567ConfigurableApplicationContext context1 = new SpringApplicationBuilder(DemoApplication.class) .web(WebApplicationType.NONE) .profiles("java8") .run(args);CalculateService service = context1.getBean(CalculateService.class);System.out.println("æ±‚åˆç»“æžœï¼š " + service.sum(1, 2, 3, 4, 5, 6, 7, 8, 9, 10));å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šå¦‚æžœå°†.profiles(&quot;java8&quot;)æ”¹ä¸º.profiles(&quot;java7&quot;)çš„è¯ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šå¯¼å…¥ç»„ä»¶@Importåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒ…æ‰«æå’Œ@Beanæ¥å®žçŽ°ç»„ä»¶æ³¨å†Œã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨@Importæ¥å¿«é€Ÿåœ°å¾€IOCå®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»Helloï¼š12public class Hello &#123;&#125;ç„¶åŽåœ¨é…ç½®ç±»ä¸­å¯¼å…¥è¿™ä¸ªç»„ä»¶ï¼š12345@Configuration@Import(&#123;Hello.class&#125;)public class WebConfig &#123; ...&#125;æŸ¥çœ‹IOCå®¹å™¨ä¸­æ‰€æœ‰ç»„ä»¶çš„åç§°ï¼š123ApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class);String[] beanNames = context.getBeanDefinitionNames();Arrays.stream(beanNames).forEach(System.out::println);å¯åŠ¨é¡¹ç›®ï¼ŒæŽ§åˆ¶å°è¾“å‡º:å¯çœ‹åˆ°ï¼Œé€šè¿‡@Importæˆ‘ä»¬å¯ä»¥å¿«é€Ÿåœ°å¾€IOCå®¹å™¨ä¸­æ·»åŠ ç»„ä»¶ï¼ŒIdé»˜è®¤ä¸ºå…¨ç±»åã€‚ImportSelectoré€šè¿‡@Importæˆ‘ä»¬å·²ç»å®žçŽ°äº†ç»„ä»¶çš„å¯¼å…¥ï¼Œå¦‚æžœéœ€è¦ä¸€æ¬¡æ€§å¯¼å…¥è¾ƒå¤šç»„ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ImportSelectoræ¥å®žçŽ°ã€‚æ–°å¢žä¸‰ä¸ªç±»Appleï¼ŒBananaå’ŒWatermelonï¼Œä»£ç ç•¥ã€‚æŸ¥çœ‹ImportSelectoræºç ï¼š12345678public interface ImportSelector &#123; /** * Select and return the names of which class(es) should be imported based on * the &#123;@link AnnotationMetadata&#125; of the importing @&#123;@link Configuration&#125; class. */ String[] selectImports(AnnotationMetadata importingClassMetadata);&#125;ImportSelectoræ˜¯ä¸€ä¸ªæŽ¥å£ï¼ŒåŒ…å«ä¸€ä¸ªselectImportsæ–¹æ³•ï¼Œæ–¹æ³•è¿”å›žç±»çš„å…¨ç±»åæ•°ç»„ï¼ˆå³éœ€è¦å¯¼å…¥åˆ°IOCå®¹å™¨ä¸­ç»„ä»¶çš„å…¨ç±»åæ•°ç»„ï¼‰ï¼ŒåŒ…å«ä¸€ä¸ªAnnotationMetadataç±»åž‹å…¥å‚ï¼Œé€šè¿‡è¿™ä¸ªå‚æ•°æˆ‘ä»¬å¯ä»¥èŽ·å–åˆ°ä½¿ç”¨ImportSelectorçš„ç±»çš„å…¨éƒ¨æ³¨è§£ä¿¡æ¯ã€‚æˆ‘ä»¬æ–°å»ºä¸€ä¸ªImportSelectorå®žçŽ°ç±»MyImportSelectorï¼š12345678910public class MyImportSelector implements ImportSelector &#123; @Override public String[] selectImports(AnnotationMetadata importingClassMetadata) &#123; return new String[]&#123; "cc.mrbird.demo.domain.Apple", "cc.mrbird.demo.domain.Banana", "cc.mrbird.demo.domain.Watermelon" &#125;; &#125;&#125;ä¸Šé¢æ–¹æ³•è¿”å›žäº†æ–°å¢žçš„ä¸‰ä¸ªç±»çš„å…¨ç±»åæ•°ç»„ï¼ŒæŽ¥ç€æˆ‘ä»¬åœ¨é…ç½®ç±»çš„@Importæ³¨è§£ä¸Šä½¿ç”¨MyImportSelectoræ¥æŠŠè¿™ä¸‰ä¸ªç»„ä»¶å¿«é€Ÿåœ°å¯¼å…¥åˆ°IOCå®¹å™¨ä¸­ï¼š1234@Import(&#123;MyImportSelector.class&#125;)public class WebConfig &#123; ...&#125;æŸ¥çœ‹å®¹å™¨ä¸­æ˜¯å¦å·²ç»æœ‰è¿™ä¸‰ä¸ªç»„ä»¶:123ApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class);String[] beanNames = context.getBeanDefinitionNames();Arrays.stream(beanNames).forEach(System.out::println);å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°ï¼šç»„ä»¶å·²ç»æˆåŠŸå¯¼å…¥ã€‚ImportBeanDefinitionRegistraré™¤äº†ä¸Šé¢ä¸¤ç§å¾€IOCå®¹å™¨å¯¼å…¥ç»„ä»¶çš„æ–¹æ³•å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ImportBeanDefinitionRegistraræ¥æ‰‹åŠ¨å¾€IOCå®¹å™¨å¯¼å…¥ç»„ä»¶ã€‚æŸ¥çœ‹å…¶æºç ï¼š123public interface ImportBeanDefinitionRegistrar &#123; public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry);&#125;ImportBeanDefinitionRegistraræ˜¯ä¸€ä¸ªæŽ¥å£ï¼ŒåŒ…å«ä¸€ä¸ªregisterBeanDefinitionsæ–¹æ³•ï¼Œè¯¥æ–¹æ³•åŒ…å«ä¸¤ä¸ªå…¥å‚ï¼šAnnotationMetadataï¼šå¯ä»¥é€šè¿‡å®ƒèŽ·å–åˆ°ç±»çš„æ³¨è§£ä¿¡æ¯ï¼›BeanDefinitionRegistryï¼šBeanå®šä¹‰æ³¨å†Œå™¨ï¼ŒåŒ…å«äº†ä¸€äº›å’ŒBeanæœ‰å…³çš„æ–¹æ³•ï¼š123456789101112131415 public interface BeanDefinitionRegistry extends AliasRegistry &#123; void registerBeanDefinition(String var1, BeanDefinition var2) throws BeanDefinitionStoreException; void removeBeanDefinition(String var1) throws NoSuchBeanDefinitionException; BeanDefinition getBeanDefinition(String var1) throws NoSuchBeanDefinitionException; boolean containsBeanDefinition(String var1); String[] getBeanDefinitionNames(); int getBeanDefinitionCount(); boolean isBeanNameInUse(String var1);&#125;è¿™é‡Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©BeanDefinitionRegistryçš„registerBeanDefinitionæ–¹æ³•æ¥å¾€IOCå®¹å™¨ä¸­æ³¨å†ŒBeanã€‚è¯¥æ–¹æ³•åŒ…å«ä¸¤ä¸ªå…¥å‚ï¼Œç¬¬ä¸€ä¸ªä¸ºéœ€è¦æ³¨å†Œçš„Beanåç§°ï¼ˆIdï¼‰,ç¬¬äºŒä¸ªå‚æ•°ä¸ºBeançš„å®šä¹‰ä¿¡æ¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŽ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶å®žçŽ°ç±»RootBeanDefinitionæ¥å®Œæˆï¼šä¸ºäº†æ¼”ç¤ºImportBeanDefinitionRegistrarçš„ä½¿ç”¨ï¼Œæˆ‘ä»¬å…ˆæ–°å¢žä¸€ä¸ªç±»ï¼Œåç§°ä¸ºStrawberryï¼Œä»£ç ç•¥ã€‚ç„¶åŽæ–°å¢žä¸€ä¸ªImportBeanDefinitionRegistrarå®žçŽ°ç±»MyImportBeanDefinitionRegistrarï¼š1234567891011public class MyImportBeanDefinitionRegistrar implements ImportBeanDefinitionRegistrar &#123; @Override public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) &#123; final String beanName = "strawberry"; boolean contain = registry.containsBeanDefinition(beanName); if (!contain) &#123; RootBeanDefinition rootBeanDefinition = new RootBeanDefinition(Strawberry.class); registry.registerBeanDefinition(beanName, rootBeanDefinition); &#125; &#125;&#125;åœ¨ä¸Šé¢çš„å®žçŽ°ç±»ä¸­ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡BeanDefinitionRegistryçš„containsBeanDefinitionæ–¹æ³•åˆ¤æ–­IOCå®¹å™¨ä¸­æ˜¯å¦åŒ…å«äº†åç§°ä¸ºstrawberryçš„ç»„ä»¶ï¼Œå¦‚æžœæ²¡æœ‰ï¼Œåˆ™æ‰‹åŠ¨é€šè¿‡BeanDefinitionRegistryçš„registerBeanDefinitionæ–¹æ³•æ³¨å†Œä¸€ä¸ªã€‚å®šä¹‰å¥½MyImportBeanDefinitionRegistraråŽï¼Œæˆ‘ä»¬åŒæ ·åœ°åœ¨é…ç½®ç±»çš„@Importä¸­ä½¿ç”¨å®ƒï¼š12345@Configuration@Import(&#123;MyImportBeanDefinitionRegistrar.class&#125;)public class WebConfig &#123; ...&#125;æŸ¥çœ‹å®¹å™¨ä¸­æ˜¯å¦å·²ç»æœ‰è¿™ä¸ªç»„ä»¶:123ApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class);String[] beanNames = context.getBeanDefinitionNames();Arrays.stream(beanNames).forEach(System.out::println);å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°ï¼šç»„ä»¶å·²ç»æ³¨å†ŒæˆåŠŸã€‚ä½¿ç”¨FactoryBeanæ³¨å†Œç»„ä»¶Springè¿˜æä¾›äº†ä¸€ä¸ªFactoryBeanæŽ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®žçŽ°è¯¥æŽ¥å£æ¥æ³¨å†Œç»„ä»¶ï¼Œè¯¥æŽ¥å£åŒ…å«äº†ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•å’Œä¸€ä¸ªé»˜è®¤æ–¹æ³•ï¼šä¸ºäº†æ¼”ç¤ºFactoryBeançš„ä½¿ç”¨ï¼Œæˆ‘ä»¬æ–°å¢žä¸€ä¸ªCherryç±»ï¼Œä»£ç ç•¥ã€‚ç„¶åŽåˆ›å»ºFactoryBeançš„å®žçŽ°ç±»CherryFactoryBean:12345678910111213141516public class CherryFactoryBean implements FactoryBean&lt;Cherry&gt; &#123; @Override public Cherry getObject() &#123; return new Cherry(); &#125; @Override public Class&lt;?&gt; getObjectType() &#123; return Cherry.class; &#125; @Override public boolean isSingleton() &#123; return false; &#125;&#125;getObjectè¿”å›žéœ€è¦æ³¨å†Œçš„ç»„ä»¶å¯¹è±¡ï¼ŒgetObjectTypeè¿”å›žéœ€è¦æ³¨å†Œçš„ç»„ä»¶ç±»åž‹ï¼ŒisSingletonæŒ‡æ˜Žè¯¥ç»„ä»¶æ˜¯å¦ä¸ºå•ä¾‹ã€‚å¦‚æžœä¸ºå¤šä¾‹çš„è¯ï¼Œæ¯æ¬¡ä»Žå®¹å™¨ä¸­èŽ·å–è¯¥ç»„ä»¶éƒ½ä¼šè°ƒç”¨å…¶getObjectæ–¹æ³•ã€‚å®šä¹‰å¥½CherryFactoryBeanåŽï¼Œæˆ‘ä»¬åœ¨é…ç½®ç±»ä¸­æ³¨å†Œè¿™ä¸ªç±»ï¼š1234@Beanpublic CherryFactoryBean cherryFactoryBean() &#123; return new CherryFactoryBean();&#125;æµ‹è¯•ä»Žå®¹å™¨ä¸­èŽ·å–ï¼š123ApplicationContext context = new AnnotationConfigApplicationContext(WebConfig.class);Object cherry = context.getBean("cherryFactoryBean");System.out.println(cherry.getClass());å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°è¾“å‡ºï¼šå¯çœ‹åˆ°ï¼Œè™½ç„¶æˆ‘ä»¬èŽ·å–çš„æ˜¯Idä¸ºcherryFactoryBeançš„ç»„ä»¶ï¼Œä½†å…¶èŽ·å–åˆ°çš„å®žé™…æ˜¯getObjectæ–¹æ³•é‡Œè¿”å›žçš„å¯¹è±¡ã€‚å¦‚æžœæˆ‘ä»¬è¦èŽ·å–cherryFactoryBeanæœ¬èº«ï¼Œåˆ™å¯ä»¥è¿™æ ·åšï¼š12Object cherryFactoryBean = context.getBean("&amp;cherryFactoryBean");System.out.println(cherryFactoryBean.getClass());å¯åŠ¨é¡¹ç›®ï¼Œè§‚å¯ŸæŽ§åˆ¶å°ï¼šä¸ºä»€ä¹ˆåŠ ä¸Š&amp;å‰ç¼€å°±å¯ä»¥èŽ·å–åˆ°ç›¸åº”çš„å·¥åŽ‚ç±»äº†å‘¢ï¼ŒæŸ¥çœ‹BeanFactoryçš„æºç ä¼šå‘çŽ°åŽŸå› :æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/50.Spring-Regist-Bean]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Dubboçš„é«˜å¯ç”¨]]></title>
    <url>%2FDubbo-High-Availability.html</url>
    <content type="text"><![CDATA[Dubboçš„ä¸€äº›è‡ªèº«ç‰¹æ€§ç¡®ä¿äº†Dubboçš„é«˜å¯ç”¨ï¼Œæ¯”å¦‚å½“æ³¨å†Œä¸­å¿ƒå®•æœºåŽï¼ŒæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ä»èƒ½é€šè¿‡æœ¬åœ°ç¼“å­˜é€šè®¯ï¼›æ³¨å†Œä¸­å¿ƒå¯¹ç­‰é›†ç¾¤ï¼Œä»»æ„ä¸€å°å®•æŽ‰åŽï¼Œå°†è‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€å°ï¼›å½“æœ‰å¤šå°æœåŠ¡æä¾›è€…æä¾›æœåŠ¡æ—¶ï¼ŒDubboå†…ç½®äº†å‡ ç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå¹¶ä¸”æœåŠ¡æä¾›è€…æ˜¯æ— çŠ¶æ€çš„ï¼Œä»»æ„ä¸€å°å®•æŽ‰åŽï¼Œä¸å½±å“ä½¿ç”¨ï¼›æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡æ•´åˆHystrixæ¥å®žçŽ°æœåŠ¡é™çº§ã€‚æ³¨å†Œä¸­å¿ƒè¿™é‡Œæ¨¡æ‹Ÿä¸€ä¸‹å½“æ‰€æœ‰æœåŠ¡æ³¨å†Œä¸­å¿ƒå®•æœºåŽï¼ŒæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸é€šè®¯ã€‚åœ¨ä¸Šä¸€èŠ‚çš„ä¾‹å­ä¸Šï¼Œå¯åŠ¨Zookeeperï¼Œç„¶åŽåˆ†åˆ«å¯åŠ¨server-proivderå’Œserver-consumerï¼Œå¯åŠ¨å¥½åŽå…³é—­Zookeeperï¼Œè¿™æ—¶å€™æ³¨å†Œä¸­å¿ƒæ˜¯å®•æœºçš„çŠ¶æ€ï¼šè®¿é—®http://localhost:8081/hello/mrbirdçœ‹æ˜¯å¦å¯ä»¥æˆåŠŸæ¶ˆè´¹æœåŠ¡ï¼šå¯ä»¥çœ‹åˆ°æœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…é€šè®¯æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºæ³¨å†Œä¸­å¿ƒè´Ÿè´£æœåŠ¡åœ°å€çš„æ³¨å†Œä¸ŽæŸ¥æ‰¾ï¼Œç›¸å½“äºŽç›®å½•æœåŠ¡ï¼ŒæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…åªåœ¨å¯åŠ¨æ—¶ä¸Žæ³¨å†Œä¸­å¿ƒäº¤äº’ï¼Œæ³¨å†Œä¸­å¿ƒå…¨éƒ¨å®•æœºï¼Œä¸å½±å“å·²è¿è¡Œçš„æä¾›è€…å’Œæ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…åœ¨æœ¬åœ°ç¼“å­˜äº†æä¾›è€…åˆ—è¡¨ã€‚Dubboç›´è¿žä½¿ç”¨æ³¨å†Œä¸­å¿ƒæ¥ç»´æŠ¤æœåŠ¡å¯ä»¥é™ä½ŽåŽæœŸç»´æŠ¤å’Œæ‹“å±•çš„å¤æ‚åº¦ï¼Œé™ä½Žè€¦åˆã€‚ä¸è¿‡Dubboä¹Ÿæä¾›äº†ç»•è¿‡æ³¨å†Œä¸­å¿ƒçš„æ–¹æ³•ï¼Œå³æœåŠ¡æ¶ˆè´¹è€…ä¸é€šè¿‡æ³¨å†Œä¸­å¿ƒï¼Œè€Œæ˜¯ç›´æŽ¥å–è®¿é—®æœåŠ¡æä¾›è€…æ¥èŽ·å–æœåŠ¡ï¼Œè¿™ç§æ–¹å¼ä¹Ÿç§°ä¸ºDubboç›´è¿žã€‚æˆ‘ä»¬åœ¨æœåŠ¡æ¶ˆè´¹è€…çš„@Referenceæ³¨è§£ä¸Šç›´æŽ¥æŒ‡å®šæœåŠ¡æä¾›è€…çš„åœ°å€ï¼Œå³å¯å®žçŽ°Dubboç›´è¿žï¼š12@Reference(url = "http://127.0.0.1:8080")private HelloService helloService;è´Ÿè½½å‡è¡¡Dubboæä¾›äº†å››ç§è´Ÿè½½å‡è¡¡æœºåˆ¶ï¼šRandomLoadBalanceï¼ŒLeastActiveLoadBalanceï¼ŒConsistentHashLoadBalanceå’ŒRoundRobinLoadBalanceã€‚RandomLoadBalanceRandomLoadBalanceæ˜¯åŸºäºŽæƒé‡çš„è´Ÿè½½å‡è¡¡æœºåˆ¶ã€‚å‡å¦‚çŽ°åœ¨æœ‰ä¸€ä¸ªç”±ä¸‰ä¸ªæœåŠ¡æä¾›è€…æž„æˆçš„é›†ç¾¤ï¼ŒServer1çš„æƒé‡ä¸º100ï¼ŒServer2çš„æƒé‡ä¸º200ï¼ŒServer3çš„æƒé‡ä¸º300ï¼Œé‚£ä¹ˆå½“ä¸€ä¸ªæœåŠ¡æ¶ˆè´¹è¯·æ±‚å‘é€è¿‡æ¥æ—¶ï¼Œæœ‰1/6çš„å‡ çŽ‡å‘½ä¸­Server1ï¼Œ1/3çš„è®°å½•å‘½ä¸­Server2ï¼Œ1/2çš„è®°å½•å‘½ä¸­Server3ã€‚LeastActiveLoadBalanceLeastActiveLoadBalanceä¿—ç§°æœ€å°æ´»è·ƒæ•°è´Ÿè½½å‡è¡¡ï¼Œå‡å¦‚çŽ°åœ¨æœ‰ä¸€ä¸ªç”±Server1ã€Server2å’ŒServer3ä¸‰ä¸ªæœåŠ¡æä¾›è€…æž„æˆçš„é›†ç¾¤ï¼Œåœ¨ä¸Šä¸€æ¬¡è¯·æ±‚ä¸­ï¼ŒServer1çš„è€—æ—¶ä¸º100msï¼ŒServer2çš„è€—æ—¶ä¸º200msï¼ŒServer3çš„è€—æ—¶ä¸º300msï¼Œé‚£ä¹ˆå½“ä¸€ä¸ªæ–°çš„è¯·æ±‚åˆ°æ¥æ—¶ï¼Œä¼šå‘½ä¸­è€—æ—¶æœ€å°‘çš„é‚£ä¸ªæœåŠ¡ï¼Œå³Server1ã€‚ConsistentHashLoadBalanceè¯¦è§å®˜æ–¹æ–‡æ¡£ä»‹ç»ï¼šhttp://dubbo.apache.org/zh-cn/docs/source_code_guide/loadbalance.htmlã€‚RoundRobinLoadBalanceRoundRobinLoadBalanceæ˜¯åŸºäºŽæƒé‡çš„è½®è¯¢è´Ÿè½½å‡è¡¡æœºåˆ¶ï¼Œå³æœåŠ¡è¯·æ±‚åœ¨è½®è¯¢çš„åŒæ—¶è¿˜å¾—è€ƒè™‘æƒé‡ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‡å¦‚çŽ°åœ¨æœ‰ä¸€ä¸ªç”±ä¸‰ä¸ªæœåŠ¡æä¾›è€…æž„æˆçš„é›†ç¾¤ï¼ŒServer1çš„æƒé‡ä¸º100ï¼ŒServer2çš„æƒé‡ä¸º200ï¼ŒServer3çš„æƒé‡ä¸º300ï¼ŒçŽ°åœ¨æœ‰6ä¸ªæœåŠ¡æ¶ˆè´¹è¯·æ±‚ä¾æ³•å‘é€è¿‡æ¥ï¼ŒæŒ‰ç…§è½®è¯¢æœºåˆ¶ï¼Œç¬¬1ä¸ªè¯·æ±‚å‘½ä¸­Server1ï¼Œç¬¬2ä¸ªè¯·æ±‚å‘½ä¸­Server2ï¼Œç¬¬3ä¸ªè¯·æ±‚å‘½ä¸­Server3ï¼Œåˆ°è¿™é‡Œä¸‰ä¸ªæœåŠ¡æä¾›è€…å·²ç»è½®è¯¢å®Œä¸€æ¬¡ï¼Œç¬¬4ä¸ªè¯·æ±‚æœ¬åº”è¯¥ä»Žæ–°å¼€å§‹è½®è¯¢ï¼Œå‘½ä¸­Server1ï¼Œä½†æ˜¯ç”±äºŽServer1çš„æƒé‡ä¸º100ï¼ˆå 1/6ï¼Œå³6æ¬¡åªä¼šå‘½ä¸­ä¸€æ¬¡ï¼‰ï¼Œæ‰€ä»¥ç¬¬4ä¸ªè¯·æ±‚ä¼šè¢«åˆ†é…åˆ°Server2ã€‚æŽ¥ç€è½®è¯¢ï¼Œç¬¬5ä¸ªè¯·æ±‚å°†å‘½ä¸­Server3ï¼Œç¬¬6ä¸ªè¯·æ±‚å‘½ä¸­Server2ã€‚æ‰€ä»¥è¿™6ä¸ªè¯·æ±‚å‘½ä¸­çš„é¡ºåºä¸º123232ï¼Œè¿™ä¸ªæ¦‚çŽ‡å’ŒæœåŠ¡æä¾›è€…çš„æƒé‡æ¯”ç›¸åŒ¹é…ã€‚æœºåˆ¶é€‰æ‹©é»˜è®¤æƒ…å†µä¸‹ï¼ŒDubboé‡‡ç”¨RandomLoadBalanceè´Ÿè½½å‡è¡¡æœºåˆ¶ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ä¸ŠæŒ‡å®šä½¿ç”¨å“ªç§è´Ÿè½½å‡è¡¡ï¼šåœ¨å®¢æˆ·ç«¯çš„@Referenceæ³¨è§£ä¸ŠæŒ‡å®šï¼š12@Reference(loadbalance = RoundRobinLoadBalance.NAME)private HelloService helloService;åœ¨æœåŠ¡ç«¯çš„@Serveræ³¨è§£ä¸ŠæŒ‡å®šï¼š1@Service(interfaceClass = HelloService.class, loadbalance = RoundRobinLoadBalance.NAME)æƒé‡åˆ†é…æˆ‘ä»¬å¯ä»¥åœ¨Dubboæä¾›çš„@Serveræ³¨è§£ä¸ŠæŒ‡å®šæš´éœ²æœåŠ¡çš„æƒé‡ï¼š1@Service(interfaceClass = HelloService.class, weight = 100)è¿™æ—¶å€™åœ¨Dubbo Adminé‡Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæœåŠ¡çš„æƒé‡å°±ä¸º100äº†ï¼šæˆ‘ä»¬å¯ä»¥å¯ä»¥é€šè¿‡Dubbo Adminæ¥åŠ¨æ€è°ƒèŠ‚æœåŠ¡çš„æƒé‡:é›†ç¾¤å®¹é”™Dubboæ”¯æŒå¤šç§å®¹é”™æ¨¡å¼ï¼šhttp://dubbo.apache.org/zh-cn/docs/user/demos/fault-tolerent-strategy.htmlæœåŠ¡é™çº§Dubboé»˜è®¤æ”¯æŒä¸¤ç§é™çº§ç­–ç•¥:mock=force:return+null è¡¨ç¤ºæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•è°ƒç”¨éƒ½ç›´æŽ¥è¿”å›ž null å€¼ï¼Œä¸å‘èµ·è¿œç¨‹è°ƒç”¨ã€‚ç”¨æ¥å±è”½ä¸é‡è¦æœåŠ¡ä¸å¯ç”¨æ—¶å¯¹è°ƒç”¨æ–¹çš„å½±å“ã€‚è¿˜å¯ä»¥æ”¹ä¸º mock=fail:return+null è¡¨ç¤ºæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•è°ƒç”¨åœ¨å¤±è´¥åŽï¼Œå†è¿”å›ž null å€¼ï¼Œä¸æŠ›å¼‚å¸¸ã€‚ç”¨æ¥å®¹å¿ä¸é‡è¦æœåŠ¡ä¸ç¨³å®šæ—¶å¯¹è°ƒç”¨æ–¹çš„å½±å“ã€‚æˆ‘ä»¬å¯ä»¥åœ¨Dubbo AdminæŽ§åˆ¶å°ä¸Šæ¥å¤„ç†é™çº§ã€‚ä¸ºäº†æ¨¡æ‹Ÿé”™è¯¯æƒ…å†µï¼Œæˆ‘ä»¬æ”¹é€ æœåŠ¡æä¾›è€…å®žçŽ°çš„helloæ–¹æ³•ï¼š12345678910@Overridepublic String hello(String message) &#123; System.out.println("è°ƒç”¨ cc.mrbird.provider.service.HelloServiceImpl#hello"); try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; return "hello," + message;&#125;æ–¹æ³•ä¸­è®©çº¿ç¨‹é˜»å¡žäº†2ç§’ã€‚æŽ¥ç€æ”¹é€ æœåŠ¡æ¶ˆè´¹è€…ï¼Œåœ¨@Referenceæ³¨è§£ä¸Šé…ç½®è¶…æ—¶æ—¶é—´ï¼š12@Reference(timeout = 1000)private HelloService helloService;åœ¨ä¸è¿›è¡ŒæœåŠ¡é™çº§çš„æƒ…å†µä¸‹ï¼Œè®¿é—®http://localhost:8081/hello/mrbirdå°†çœ‹æŠ›å‡ºå¼‚å¸¸:åœ¨Dubbo Adminæ¶ˆè´¹è€…åˆ—è¡¨ä¸Šçš„å±è”½æŒ‰é’®å¯¹åº”mock=force:return+nullç­–ç•¥ï¼Œå³ä¸è°ƒç”¨æœåŠ¡ï¼Œç›´æŽ¥è¿”å›žnullï¼Œç‚¹å‡»å±è”½åŽï¼Œå†æ¬¡è®¿é—®http://localhost:8081/hello/mrbirdï¼šæœåŠ¡æä¾›è€…çš„æŽ§åˆ¶å°ä¹Ÿæ²¡æœ‰ä»»ä½•è°ƒç”¨æ—¥å¿—:è€Œå®¹é”™æŒ‰é’®åˆ™å¯¹åº”mock=fail:return+nullæœºåˆ¶ã€‚ç‚¹å‡»å®¹é”™æŒ‰é’®ï¼Œå†æ¬¡è®¿é—®http://localhost:8081/hello/mrbirdï¼šä¸Šè¿°ç»“æžœè¯æ˜Žäº†åœ¨mock=fail:return+nullç­–ç•¥ä¸‹ï¼Œæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•è°ƒç”¨åœ¨å¤±è´¥åŽï¼Œå†è¿”å›ž null å€¼ï¼ˆä¹‹æ‰€ä»¥ä¼šè¾“å‡ºå¤šæ¬¡è°ƒç”¨æ—¥å¿—ï¼Œæ˜¯å› ä¸ºDubboçš„é‡è¯•æœºåˆ¶ï¼‰ã€‚æ•´åˆHystrixæˆ‘ä»¬å¯ä»¥é€šè¿‡æ•´åˆSpring-Cloud-Hystrixå’ŒDubboæ¥æ‹“å±•æœåŠ¡é™çº§ã€‚åœ¨server-provideré‡Œå¼•å…¥Hystrixä¾èµ–ï¼š12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt; &lt;version&gt;2.0.2.RELEASE&lt;/version&gt;&lt;/dependency&gt;ç„¶åŽå†server-providerçš„å…¥å£ç±»ä¸Šä½¿ç”¨@EnableHystrixæ³¨è§£å¼€å¯HystrixåŠŸèƒ½ã€‚æŽ¥ç€æ”¹é€ server-providerçš„HelloServiceImplï¼š1234567891011121314151617@Service(interfaceClass = HelloService.classE)@Componentpublic class HelloServiceImpl implements HelloService &#123; @Override @HystrixCommand(fallbackMethod = "defaultHello") public String hello(String message) &#123; System.out.println("è°ƒç”¨ cc.mrbird.provider.service.HelloServiceImpl#hello"); String a = null; a.toString(); return "hello," + message; &#125; public String defaultHello(String message) &#123; return "hello anonymous"; &#125;&#125;åœ¨helloæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åˆ¶é€ ä¸€ä¸ªç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œé€šè¿‡@HystrixCommand(fallbackMethod = &quot;defaultHello&quot;)æŒ‡å®šäº†é™çº§çš„æ–¹æ³•ä¸ºdefaultHelloã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé™çº§æ–¹æ³•çš„æ–¹æ³•å‚æ•°å’Œè¿”å›žç±»åž‹å¿…é¡»å’ŒåŽŸæ–¹æ³•ä¿æŒä¸€è‡´ï¼Œä¸ç†Ÿæ‚‰çš„è¯»è€…å¯ä»¥å‚è€ƒhttps://mrbird.cc/Spring-Cloud-Hystrix-Circuit-Breaker.htmlã€‚æ”¹é€ å¥½åŽï¼Œé‡å¯æœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ï¼Œè®¿é—®http://localhost:8081/hello/mrbirdï¼šå¯è§æœåŠ¡å·²ç»æˆåŠŸé™çº§ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/53.Dubbo-High-Availability]]></content>
      <tags>
        <tag>Dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç›‘æŽ§DubboæœåŠ¡]]></title>
    <url>%2Fdubbo-mointor.html</url>
    <content type="text"><![CDATA[Dubboç»™æˆ‘ä»¬æä¾›äº†dubbo-adminå’Œdubbo-monitor-simpleç”¨äºŽç›‘æŽ§DubboæœåŠ¡ï¼Œå¯ä»¥ç”¨æ¥ç›‘æŽ§æŽ¥å£æš´éœ²ï¼Œæ³¨å†Œæƒ…å†µï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºæŽ¥å£çš„è°ƒç”¨æ˜Žç»†å’Œè°ƒç”¨æ—¶é—´ã€‚dubbo-adminå’Œdubbo-monitor-simpleçš„ä¸‹è½½åœ°å€ä¸ºï¼šhttps://github.com/apache/incubator-dubbo-admin/tree/masterï¼Œè¿™é‡Œç®€å•ä»‹ç»å®ƒä»¬å¦‚ä½•ä½¿ç”¨ã€‚å‡†å¤‡è¦ç›‘æŽ§DubboæœåŠ¡ï¼Œé¦–å…ˆæˆ‘ä»¬å¿…é¡»åœ¨Dubboåº”ç”¨ä¸Šæä¾›è¿žæŽ¥ç›‘æŽ§ä¸­å¿ƒçš„é…ç½®ï¼ŒDubboæ”¯æŒä¸¤ç§æ–¹å¼ï¼šå±žæ€§å¯¹åº”URLå‚æ•°ç±»åž‹æ˜¯å¦å¿…å¡«ç¼ºçœå€¼ä½œç”¨æè¿°å…¼å®¹æ€§protocolprotocolstringå¯é€‰dubboæœåŠ¡æ²»ç†ç›‘æŽ§ä¸­å¿ƒåè®®ï¼Œå¦‚æžœä¸ºprotocol=â€registryâ€ï¼Œè¡¨ç¤ºä»Žæ³¨å†Œä¸­å¿ƒå‘çŽ°ç›‘æŽ§ä¸­å¿ƒåœ°å€ï¼Œå¦åˆ™ç›´è¿žç›‘æŽ§ä¸­å¿ƒã€‚2.0.9ä»¥ä¸Šç‰ˆæœ¬address&lt;url&gt;stringå¯é€‰N/AæœåŠ¡æ²»ç†ç›´è¿žç›‘æŽ§ä¸­å¿ƒæœåŠ¡å™¨åœ°å€ï¼Œaddress=â€10.20.130.230:12080â€1.0.16ä»¥ä¸Šç‰ˆæœ¬è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œåœ¨ä¸Šä¸€èŠ‚ä¸­çš„server-providerå’Œserver-consumerçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®:123dubbo: monitor: protocol: registryé…ç½®å¥½åŽï¼Œä¾æ¬¡å¯åŠ¨server-providerå’Œserver-consumerï¼ŒæŽ¥ä¸‹æ¥å¼€å§‹æ­å»ºç›‘æŽ§ä¸­å¿ƒã€‚dubbo-monitor-simpleä¸‹è½½https://github.com/apache/incubator-dubbo-admin/tree/masteræºç åŽï¼Œä½¿ç”¨IDEAå¯¼å…¥dubbo-monitor-simpleåº”ç”¨ï¼Œä¿®æ”¹å…¶é…ç½®æ–‡ä»¶dubbo.propertieså†…å®¹ï¼š1234567891011dubbo.container=log4j,spring,registry,jetty-monitordubbo.application.name=simple-monitordubbo.application.owner=dubbodubbo.registry.address=zookeeper://127.0.0.1:2181dubbo.protocol.port=7070dubbo.jetty.port=7000dubbo.jetty.directory=$&#123;user.home&#125;/monitordubbo.charts.directory=$&#123;user.home&#125;/monitor/chartsdubbo.statistics.directory=$&#123;user.home&#125;/monitor/statisticsdubbo.log4j.file=logs/dubbo-monitor-simple.logdubbo.log4j.level=WARNä¸Šé¢ä¸»è¦æŒ‡å®šäº†æ³¨å†Œä¸­å¿ƒåœ°å€ä¸ºzookeeper://127.0.0.1:2181ï¼Œç›‘æŽ§ä¸­å¿ƒåè®®ç«¯å£ä¸º7070ä»¥åŠç›‘æŽ§åº”ç”¨è®¿é—®ç«¯å£ä¸º7000ã€‚é…ç½®å¥½åŽï¼Œè¿è¡Œå¯åŠ¨ç±»MonitorStarterçš„mainæ–¹æ³•æ¥å¯åŠ¨åº”ç”¨ï¼Œå¯åŠ¨åŽï¼Œè®¿é—®http://localhost:7000ä¾¿å¯çœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼šåœ¨çº¿åº”ç”¨ä¿¡æ¯:å¤šæ¬¡è®¿é—®http://localhost:8081/hello/mrbirdåŽï¼Œä¾¿å¯ä»¥åœ¨ç›‘æŽ§ä¸­å¿ƒæŸ¥çœ‹æœåŠ¡è°ƒç”¨æƒ…å†µï¼šdubbo-adminä½¿ç”¨IDEAå¯¼å…¥dubbo-adminåº”ç”¨ï¼Œä¿®æ”¹å…¶é…ç½®æ–‡ä»¶application.propertiesï¼š12345678910server.port=7001spring.velocity.cache=falsespring.velocity.charset=UTF-8spring.velocity.layout-url=/templates/default.vmspring.messages.fallback-to-system-locale=falsespring.messages.basename=i18n/messagespring.root.password=rootspring.guest.password=guestdubbo.registry.address=zookeeper://127.0.0.1:2181ä¸Šé¢é…ç½®ä¸»è¦é…ç½®äº†æ³¨å†Œä¸­å¿ƒåœ°å€ä¸ºzookeeper://127.0.0.1:2181ï¼Œåº”ç”¨ç«¯å£å·ä¸º7001ï¼Œrootå’Œguestè´¦æˆ·çš„å¯†ç ã€‚é…ç½®å¥½åŽï¼Œå¯åŠ¨åº”ç”¨ï¼ˆdubbo-adminä½¿ç”¨Spring Bootæž„å»ºï¼Œå¯åŠ¨å…¥å£ç±»å³å¯ï¼‰ï¼Œè®¿é—®http://localhost:7001ï¼šduuboæä¾›äº†æ–°ç‰ˆçš„dubbo-adminï¼Œé‡‡ç”¨å‰åŽç«¯åˆ†ç¦»çš„æ–¹å¼ï¼Œå‰ç«¯ç”±Vue.jsæž„å»ºï¼ŒUIæ›´ä¸ºniceï¼Œä¸è¿‡è¿˜ä¸å®Œå–„ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/52.Dubbo-OPS-Mointor]]></content>
      <tags>
        <tag>Dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootæ•´åˆDubbo&Zookeeper]]></title>
    <url>%2FSpring-Boot-Dubbo-Zookeeper.html</url>
    <content type="text"><![CDATA[Dubboæ˜¯ä¸€æ¬¾ç”±é˜¿é‡Œå·´å·´å¼€å‘çš„è¿œç¨‹æœåŠ¡è°ƒç”¨æ¡†æž¶ï¼ˆRPCï¼‰ï¼Œå…¶å¯ä»¥é€æ˜ŽåŒ–çš„è°ƒç”¨è¿œç¨‹æœåŠ¡ï¼Œå°±åƒè°ƒç”¨æœ¬åœ°æœåŠ¡ä¸€æ ·ç®€å•ã€‚æˆªè‡³ç›®å‰ï¼ŒDubboå‘å¸ƒäº†åŸºäºŽSpring Bootæž„å»ºçš„ç‰ˆæœ¬ï¼Œç‰ˆæœ¬å·ä¸º0.2.0ï¼Œè¿™ä½¿å¾—å…¶ä¸ŽSpring Booté¡¹ç›®æ•´åˆå˜å¾—æ›´ä¸ºç®€å•æ–¹ä¾¿ã€‚è€ŒZookeeperåœ¨è¿™é‡Œå……å½“çš„æ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„è§’è‰²ï¼Œæˆ‘ä»¬å°†å„ä¸ªå¾®æœåŠ¡æä¾›çš„æœåŠ¡é€šè¿‡Dubboæ³¨å†Œåˆ°Zookeeperä¸­ï¼Œç„¶åŽæœåŠ¡æ¶ˆè´¹è€…é€šè¿‡Dubboä»ŽZookeeperä¸­èŽ·å–ç›¸åº”æœåŠ¡å¹¶æ¶ˆè´¹ã€‚æœ¬æ–‡æ¡ˆä¾‹çš„æž¶æž„å›¾å¯ä»¥ç®€å•ç”¨ä¸‹å›¾è¡¨ç¤ºï¼š æœ¬æ–‡æ¡ˆä¾‹æœ€ç»ˆé¡¹ç›®ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šé¡¹ç›®é‡‡ç”¨Mavenæž„å»ºï¼Œå„æ¨¡å—çš„ä½œç”¨ï¼šæ¨¡å—æè¿°common-apiç»Ÿä¸€å®šä¹‰æŽ¥å£ï¼Œä¾›å…¶ä½™å­æ¨¡å—å¼•ç”¨server-provideræœåŠ¡æä¾›è€…ï¼Œå®žçŽ°common-apiæ¨¡å—ä¸­çš„æŽ¥å£ï¼Œç„¶åŽæš´éœ²åˆ°Zookeeperä¸­ï¼Œä¾›æœåŠ¡æ¶ˆè´¹è€…ä½¿ç”¨server-consumeræœåŠ¡æ¶ˆè´¹è€…ï¼Œé€šè¿‡Dubboä»ŽZookeeperä¸­èŽ·å–æœåŠ¡å¹¶æ¶ˆè´¹çŽ¯å¢ƒå‡†å¤‡Zookeeperå®‰è£…åœ¨æ­å»ºé¡¹ç›®ä¹‹å‰éœ€è¦å¯åŠ¨ZookeeperæœåŠ¡ï¼ŒZookeeperä¸‹è½½åœ°å€ï¼šhttp://zookeeper.apache.org/releases.html#downloadã€‚ä¸‹è½½åŽè§£åŽ‹ï¼Œå°†configç›®å½•ä¸‹çš„zoo_sample.cfgé‡å‘½åä¸ºzoo.cfg(Zookeeperé…ç½®æ–‡ä»¶ï¼Œé»˜è®¤ç«¯å£ä¸º2181ï¼Œå¯æ ¹æ®å®žé™…è¿›è¡Œä¿®æ”¹)ã€‚ç„¶åŽåŒå‡»binç›®å½•ä¸‹çš„zkServer.cmdå¯åŠ¨å³å¯ã€‚æž„å»ºçˆ¶æ¨¡å—æ–°å»ºä¸€ä¸ªMavené¡¹ç›®ï¼ŒgroupIdä¸ºcc.mrbirdï¼ŒartifactIdä¸ºdubbo-bootï¼ŒpackagingæŒ‡å®šä¸ºpomã€‚ç„¶åŽå¼•å…¥Spring Bootï¼Œdubbo-spring-boot-starterå’ŒZookeeperç›¸å…³ä¾èµ–ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;dubbo-boot&lt;/artifactId&gt; &lt;packaging&gt;pom&lt;/packaging&gt; &lt;version&gt;1.0&lt;/version&gt; &lt;name&gt;dubbo-boot&lt;/name&gt; &lt;description&gt;Spring Boot-Dubbo-ZooKeeper&lt;/description&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.4.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;/parent&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;project.version&gt;1.0&lt;/project.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- dubbo --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.boot&lt;/groupId&gt; &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;0.2.0&lt;/version&gt; &lt;/dependency&gt; &lt;!-- zookeeper --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;version&gt;3.4.8&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.101tec&lt;/groupId&gt; &lt;artifactId&gt;zkclient&lt;/artifactId&gt; &lt;version&gt;0.10&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;source&gt;$&#123;java.version&#125;&lt;/source&gt; &lt;target&gt;$&#123;java.version&#125;&lt;/target&gt; &lt;encoding&gt;$&#123;project.build.sourceEncoding&#125;&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;æž„å»ºCommon-apiæ–°å»ºä¸€ä¸ªMavenæ¨¡å—ï¼ŒartifactIdä¸ºcommon-apiï¼Œç›®å½•ç»“æž„å¦‚ä¸‹æ‰€ç¤ºï¼špom.xmlï¼š12345678910111213&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;parent&gt; &lt;artifactId&gt;dubbo-boot&lt;/artifactId&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;version&gt;1.0&lt;/version&gt; &lt;/parent&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;artifactId&gt;common-api&lt;/artifactId&gt;&lt;/project&gt;é¡¹ç›®åªåŒ…å«ä¸€ä¸ªHelloServiceæŽ¥å£ï¼š12345package cc.mrbird.common.api;public interface HelloService &#123; String hello(String message);&#125;è‡³æ­¤æˆ‘ä»¬å¯ä»¥å¼€å§‹æž„å»ºæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…äº†ã€‚æž„å»ºServer-Provideræ–°å»ºä¸€ä¸ªMavenæ¨¡å—ï¼Œç”¨äºŽæš´éœ²DubboæœåŠ¡ï¼ŒartifactIdä¸ºserver-providerï¼Œç›®å½•ç»“æž„å¦‚ä¸‹æ‰€ç¤ºï¼špomå†…å®¹å¦‚ä¸‹ï¼š123456789101112131415161718192021&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;parent&gt; &lt;artifactId&gt;dubbo-boot&lt;/artifactId&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;version&gt;1.0&lt;/version&gt; &lt;/parent&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;artifactId&gt;server-provider&lt;/artifactId&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;common-api&lt;/artifactId&gt; &lt;version&gt;$&#123;project.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt;è¿™é‡Œæˆ‘ä»¬å¼•å…¥äº†common-apiæ¨¡å—ï¼Œç”¨äºŽåŽç»­å®žçŽ°ç›¸åº”çš„æœåŠ¡ã€‚åœ¨Spring Bootå¯åŠ¨ç±»ä¸­æˆ‘ä»¬åŠ å…¥@EnableDubboæ³¨è§£ï¼Œè¡¨ç¤ºè¦å¼€å¯dubboåŠŸèƒ½:123456789101112import com.alibaba.dubbo.config.spring.context.annotation.EnableDubbo;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@EnableDubbo@SpringBootApplicationpublic class ProviderApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(ProviderApplication.class, args); System.out.println("complete"); &#125;&#125;æŽ¥ç€åœ¨application.ymlä¸­é…ç½®Dubboï¼š12345678910111213141516server: port: 8080dubbo: application: # æœåŠ¡åç§°ï¼Œä¿æŒå”¯ä¸€ name: server-provider # zookeeperåœ°å€ï¼Œç”¨äºŽå‘å…¶æ³¨å†ŒæœåŠ¡ registry: address: zookeeper://127.0.0.1:2181 #æš´éœ²æœåŠ¡æ–¹å¼ protocol: # dubboåè®®ï¼Œå›ºå®šå†™æ³• name: dubbo # æš´éœ²æœåŠ¡ç«¯å£ ï¼ˆé»˜è®¤æ˜¯20880ï¼Œä¸åŒçš„æœåŠ¡æä¾›è€…ç«¯å£ä¸èƒ½é‡å¤ï¼‰ port: 20880å¦‚æžœZookeeperæ˜¯é›†ç¾¤çš„è¯ï¼Œspring.dubbo.registry.addressé…ç½®ä¸ºï¼š1234spring: dubbo: registry: address: zookeeper://127.0.0.1:2181?backup=127.0.0.1:2180,127.0.0.1:2182æŽ¥ä¸‹æ¥æˆ‘ä»¬åœ¨cc.mrbird.provider.serviceè·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªHelloServiceæŽ¥å£çš„å®žçŽ°ç±»ï¼š123456789101112import cc.mrbird.common.api.HelloService;import com.alibaba.dubbo.config.annotation.Service;import org.springframework.stereotype.Component;@Service(interfaceClass = HelloService.class)@Componentpublic class HelloServiceImpl implements HelloService &#123; @Override public String hello(String message) &#123; return "hello," + message; &#125;&#125;å€¼å¾—æ³¨æ„çš„æ˜¯@Serviceæ³¨è§£ä¸ºDubboæä¾›çš„com.alibaba.dubbo.config.annotation.Serviceï¼Œè€ŒéžSpringçš„é‚£ä¸ªã€‚å…¶ä¸­interfaceClassæ˜¯æŒ‡è¦å‘å¸ƒæœåŠ¡çš„æŽ¥å£ã€‚é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œæˆ‘ä»¬å·²ç»å°†HelloServiceæŽ¥å£çš„å®žçŽ°æš´éœ²åˆ°Zookeeperä¸­äº†ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­åˆ›å»ºä¸€ä¸ªæœåŠ¡æ¶ˆè´¹è€…ï¼Œæ¥æ¶ˆè´¹è¿™ä¸ªæœåŠ¡ã€‚æ­å»ºServer-Consumeræ–°å»ºä¸€ä¸ªMavenæ¨¡å—ï¼Œç”¨äºŽæ¶ˆè´¹DubboæœåŠ¡ï¼ŒartifactIdä¸ºserver-consumerï¼Œç›®å½•ç»“æž„å¦‚ä¸‹æ‰€ç¤ºï¼špomå†…å®¹å¦‚ä¸‹ï¼š123456789101112131415161718192021&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;parent&gt; &lt;artifactId&gt;dubbo-boot&lt;/artifactId&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;version&gt;1.0&lt;/version&gt; &lt;/parent&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;artifactId&gt;server-consumer&lt;/artifactId&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;common-api&lt;/artifactId&gt; &lt;version&gt;$&#123;project.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt;åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿåœ¨Spring Bootå¯åŠ¨ç±»ä¸­æˆ‘ä»¬åŠ å…¥@EnableDubboæ³¨è§£ï¼Œè¡¨ç¤ºè¦å¼€å¯dubboåŠŸèƒ½ã€‚æŽ¥ç€åœ¨application.ymlä¸­é…ç½®Dubboï¼š12345678910111213server: port: 8081dubbo: application: # æœåŠ¡åç§°ï¼Œä¿æŒå”¯ä¸€ name: server-consumer # zookeeperåœ°å€ï¼Œç”¨äºŽä»Žä¸­èŽ·å–æ³¨å†Œçš„æœåŠ¡ registry: address: zookeeper://127.0.0.1:2181 protocol: # dubboåè®®ï¼Œå›ºå®šå†™æ³• name: dubboåŒæœåŠ¡æä¾›è€…ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šZookeeperçš„åœ°å€ï¼Œåè®®ä¸ºdubboã€‚æŽ¥ç€æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªTestControllerï¼Œæ¼”ç¤ºæœåŠ¡æ¶ˆè´¹ï¼š1234567891011121314151617import cc.mrbird.common.api.HelloService;import com.alibaba.dubbo.config.annotation.Reference;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.RestController;@RestControllerpublic class HelloController &#123; @Reference private HelloService helloService; @GetMapping("/hello/&#123;message&#125;") public String hello(@PathVariable String message) &#123; return this.helloService.hello(message); &#125;&#125;é€šè¿‡Dubboçš„@Referenceæ³¨è§£æ³¨å…¥éœ€è¦ä½¿ç”¨çš„interfaceï¼Œç±»ä¼¼äºŽSpringçš„@Autowiredã€‚æµ‹è¯•åˆ†åˆ«å¯åŠ¨Server-Providerå’ŒServer-Consumerï¼Œè®¿é—®http://localhost:8081/hello/mrbirdï¼šè¯´æ˜Žè¿œç¨‹æœåŠ¡è°ƒç”¨å·²ç»æˆåŠŸã€‚è¿™é‡Œåªæ˜¯é€šè¿‡Spring Bootå’ŒDubboçš„æ•´åˆæ¥ç®€å•äº†è§£Dubboçš„ä½¿ç”¨ï¼Œä»…ä½œæŠ›ç –å¼•çŽ‰ï¼Œæ›´ä¸ºè¯¦ç»†çš„Dubboé…ç½®å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼šhttp://dubbo.apache.org/zh-cn/docs/user/quick-start.htmlæºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/40.Spring-Boot-Dubbo-Zookeeper]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Dubbo</tag>
        <tag>Spring Boot</tag>
        <tag>Zookeeper</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨WireMockå¿«é€Ÿä¼ªé€ RESTfulæœåŠ¡]]></title>
    <url>%2FWireMock-mock-RESTful.html</url>
    <content type="text"><![CDATA[å‰åŽç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼å·²ç»è¶Šæ¥è¶Šæµè¡Œï¼Œä½†æ˜¯å‰åŽç«¯çš„å¼€å‘è¿›åº¦å¹¶ä¸èƒ½å®Œå…¨ä¿æŒä¸€è‡´ï¼Œå½“å‰ç«¯éœ€è¦è°ƒç”¨åŽç«¯å°šæœªå¼€å‘çš„RESTfulæŽ¥å£æ—¶ä¸å¾—ä¸ç­‰å¾…åŽç«¯å¼€å‘å®Œæ¯•ï¼Œè¿™å°†å½±å“å¹¶è¡Œå¼€å‘çš„æ•ˆçŽ‡ã€‚http://wiremock.orgå°±æ˜¯ä¸€æ¬¾ç”¨äºŽè§£å†³è¿™ä¸ªé—®é¢˜çš„å¼€æºæ¡†æž¶ã€‚WireMockå¯ä»¥å¿«é€Ÿçš„ä¼ªé€ RESTfulæŽ¥å£å¹¶è¿”å›žä¼ªé€ çš„JSONæ•°æ®ã€‚è¿™é‡Œç®€å•è®°å½•ä¸‹WireMockçš„ä½¿ç”¨æ–¹æ³•ã€‚æ­å»ºWireMockæœåŠ¡å™¨æˆ‘ä»¬åœ¨æœ¬åœ°æ­å»ºä¸€ä¸ªWireMockæœåŠ¡å™¨ã€‚é€šè¿‡http://repo1.maven.org/maven2/com/github/tomakehurst/wiremock-standalone/2.18.0/wiremock-standalone-2.18.0.jarä¸‹è½½wiremock-standalone-x.xx.xx.jarï¼Œç„¶åŽä½¿ç”¨java -jarå‘½ä»¤è¿è¡Œï¼š1java -jar wiremock-standalone-2.18.0.jar --port=8080å¯åŠ¨ç•Œé¢ï¼š WireMockçš„ç®€å•ä½¿ç”¨ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬åœ¨Spring BootçŽ¯å¢ƒé‡Œè¿›è¡Œç¼–å†™ã€‚åœ¨é¡¹ç›®ä¸­å¼•å…¥WireMockä¾èµ–ï¼š12345&lt;dependency&gt; &lt;groupId&gt;com.github.tomakehurst&lt;/groupId&gt; &lt;artifactId&gt;wiremock&lt;/artifactId&gt; &lt;version&gt;2.18.0&lt;/version&gt;&lt;/dependency&gt;æ–°å»ºä¸€ä¸ªMockServerç±»ï¼ŒåŒ…å«mainæ–¹æ³•ï¼Œå¹¶å¼•å…¥com.github.tomakehurst.wiremock.client.WireMockçš„æ‰€æœ‰é™æ€æ–¹æ³•ï¼š12345678910111213141516import static com.github.tomakehurst.wiremock.client.WireMock.*;public class MockService &#123; public static void main(String[] args) &#123; // é…ç½®WireMockæœåŠ¡å™¨çš„åœ°å€ http://localhost:8080 configureFor("127.0.0.1", 8080); // æ¸…é™¤WireMockæœåŠ¡å™¨é‡Œä¹‹å‰çš„é…ç½® removeAllMappings(); //ä¼ªé€ ä¸€ä¸ªgetè¯·æ±‚ï¼Œè¯·æ±‚åœ°å€ä¸º /user/1ï¼Œç„¶åŽè¿”å›žä½“åŒ…å«JSONæ•°æ®ï¼ŒçŠ¶æ€ä¸º200 stubFor(get(urlEqualTo("/user/1")) .willReturn(aResponse() .withBody("&#123;\"name\":\"mrbird\",\"url\":\"https://mrbird.cc\",\"age\":18&#125;") .withStatus(200))); &#125;&#125;ä¸Šé¢ä»£ç ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šä½¿ç”¨configureForæ–¹æ³•é…ç½®WireMockæœåŠ¡å™¨çš„åœ°å€ä¸ºhttp://localhost:8080ï¼›è°ƒç”¨removeAllMappingsæ¸…é™¤WireMockæœåŠ¡å™¨é‡Œæ‰€æœ‰é…ç½®ï¼›è°ƒç”¨stubForæ‰“æ¡©ï¼Œå¹¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œç„¶åŽè¿”å›ž200çŠ¶æ€ç ï¼Œè¿”å›žæŠ¥æ–‡å¤´éƒ¨åŒ…å«JSONä¿¡æ¯ã€‚è¿™é‡ŒURLä½¿ç”¨æ–¹æ³•urlEqualToå…¨åŒ¹é…ï¼ŒWireMockä¹Ÿæä¾›äº†æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…URLçš„æ–¹æ³•ã€‚åœ¨é…ç½®å®Œäº†åŽè¿è¡Œmainæ–¹æ³•ï¼Œå°±å¯ä»¥å°†æˆ‘ä»¬çš„é…ç½®å†™åˆ°WireMockæœåŠ¡å™¨é‡Œï¼Œè¿™æ—¶å€™åœ¨æµè§ˆå™¨ä¸­è°ƒç”¨http://localhost:8080/user/1ä¾¿èƒ½çœ‹åˆ°æˆ‘ä»¬æ¨¡æ‹Ÿçš„è¾“å‡ºç»“æžœï¼šè¿™é‡ŒæŽ¨èä¸ªåœ¨çº¿JSONç¼–è¾‘å™¨ï¼šhttps://www.bejson.com/jsoneditoronline/ã€‚ç®€å•å°è£…æˆ‘ä»¬å¯ä»¥å¯¹ä¸Šé¢çš„ä»£ç è¿›è¡Œç®€å•çš„å°è£…ï¼Œæ–¹ä¾¿é‡ç”¨ï¼š123456789import org.apache.commons.io.FileUtils;import org.apache.commons.lang3.StringUtils;import org.springframework.core.io.ClassPathResource;private static void getMock(String url, String file) throws IOException &#123; ClassPathResource resource = new ClassPathResource("mock/response/" + file); String content = StringUtils.join(FileUtils.readLines(resource.getFile(), "UTF-8").toArray(), "\n"); stubFor(get(urlPathEqualTo(url)).willReturn(aResponse().withBody(content).withStatus(200)));&#125;ä¸Šé¢ä»£ç å°è£…äº†ä¸€ä¸ªgetMockæ–¹æ³•ï¼Œç”¨äºŽå¤„ç†getç±»åž‹çš„Mockï¼Œå‚æ•°ä¸ºæ¨¡æ‹ŸURLå’Œæ¨¡æ‹ŸJSONæ–‡ä»¶ã€‚æˆ‘ä»¬åœ¨src/main/resource/mock/responseç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªuser.jsonæ–‡ä»¶ï¼š12345&#123; "name": "mrbird", "url": "https://mrbird.cc", "age": 18&#125;åŽé¢æˆ‘ä»¬åªéœ€è¦åƒä¸‹é¢è¿™æ ·è°ƒç”¨å°±è¡Œäº†ï¼š1getMock("/user/1", "user.json");WireMockè¿˜æä¾›äº†è®¸å¤šåˆ«çš„åŠŸèƒ½ï¼Œå…·ä½“å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ http://wiremock.org/docs/ã€‚]]></content>
      <tags>
        <tag>WireMock</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨Spring Cloud Sleuthè·Ÿè¸ªå¾®æœåŠ¡]]></title>
    <url>%2FSpring-Cloud-sleuth.html</url>
    <content type="text"><![CDATA[åœ¨å¾®æœåŠ¡æ•°é‡è¾ƒå¤šçš„ç³»ç»Ÿæž¶æž„ä¸­ï¼Œä¸€ä¸ªå®Œæ•´çš„HTTPè¯·æ±‚å¯èƒ½éœ€è¦ç»è¿‡å¥½å‡ ä¸ªå¾®æœåŠ¡ã€‚å¦‚æžœæƒ³è¦è·Ÿè¸ªä¸€æ¡å®Œæ•´çš„HTTPè¯·æ±‚é“¾è·¯æ‰€äº§ç”Ÿçš„æ—¥å¿—ï¼Œæˆ‘ä»¬éœ€è¦åˆ°å„ä¸ªå¾®æœåŠ¡ä¸ŠåŽ»æŸ¥çœ‹æ—¥å¿—å¹¶æ£€ç´¢å‡ºæˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ã€‚éšç€ä¸šåŠ¡å‘å±•ï¼Œå¾®æœåŠ¡çš„æ•°é‡ä¹Ÿä¼šè¶Šæ¥è¶Šå¤šï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿå˜å¾—æ„ˆå‘å›°éš¾ã€‚ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼ŒSpring Cloud Sleuthä¸ºæˆ‘ä»¬æä¾›äº†åˆ†å¸ƒå¼æœåŠ¡è·Ÿè¸ªçš„è§£å†³æ–¹æ¡ˆã€‚ä¸ºäº†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨Spring Cloud Sleuthï¼Œæˆ‘ä»¬éœ€è¦æž„å»ºä¸€ä¸ªå°åž‹çš„å¾®æœåŠ¡ç³»ç»Ÿã€‚å‡†å¤‡å·¥ä½œè¿™é‡Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸¤ä¸ªå¾®æœåŠ¡Server-Provider1å’ŒServer-Provider2ï¼Œå®ƒä»¬éƒ½å…·æœ‰ä¸€ä¸ªåä¸ºhelloçš„RESTæŽ¥å£ï¼ŒServer-Provider1çš„helloæŽ¥å£ä¾èµ–äºŽServer-Provider2çš„helloæŽ¥å£ã€‚å¹¶å°†è¿™ä¸¤ä¸ªæœåŠ¡æ³¨å†Œåˆ°Eureka-ServeræœåŠ¡æ³¨å†Œä¸­å¿ƒé›†ç¾¤ã€‚Eureka-ServeræœåŠ¡æ³¨å†Œä¸­å¿ƒé›†ç¾¤ç›´æŽ¥ä½¿ç”¨https://mrbird.cc/Spring-Cloud-Eureka.htmlé‡Œæž„å»ºçš„å³å¯ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚åˆ›å»ºServer-Provider1æ–°å»ºä¸€ä¸ªSpring Bootå·¥ç¨‹ï¼ŒartifactIdä¸ºServer-Provider1ï¼Œå¹¶å¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š123456789101112131415161718192021222324252627282930&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-ribbon&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-sleuth&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;spring-cloud-starter-eurekaç”¨äºŽæ³¨å†Œå¾®æœåŠ¡ï¼Œspring-cloud-starter-ribbonç”¨äºŽè°ƒç”¨Server-Provider2æä¾›çš„æœåŠ¡ï¼Œspring-cloud-starter-sleuthä¸ºSpring Cloud Sleuthä¾èµ–ï¼Œç”¨äºŽè·Ÿè¸ªå¾®æœåŠ¡è¯·æ±‚ã€‚æŽ¥ç€åœ¨é…ç½®æ–‡ä»¶application.ymlé‡Œæ·»åŠ å¦‚ä¸‹é…ç½®:12345678910spring: application: name: server-provider1server: port: 9000eureka: client: serviceUrl: defaultZone: http://mrbird:123456@peer1:8080/eureka/,http://mrbird:123456@peer2:8081/eureka/é…ç½®ä¸­æŒ‡å®šäº†å¾®æœåŠ¡åç§°ä¸ºserver-provider1ï¼Œç«¯å£å·ä¸º9000ä»¥åŠæœåŠ¡æ³¨å†Œä¸­å¿ƒåœ°å€ã€‚ç„¶åŽæˆ‘ä»¬åœ¨å…¥å£ç±»ä¸­æ·»åŠ @EnableDiscoveryClientæ³¨è§£ï¼Œå¼€å¯æœåŠ¡çš„æ³¨å†Œä¸Žå‘çŽ°ã€‚å¹¶ä¸”æ³¨å†ŒRestTemplateï¼Œç”¨äºŽRibbonæœåŠ¡è¿œç¨‹è°ƒç”¨ï¼š1234567891011121314@SpringBootApplication@EnableDiscoveryClientpublic class DemoApplication &#123; @Bean @LoadBalanced RestTemplate restTemplate() &#123; return new RestTemplate(); &#125; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;æœ€åŽç¼–å†™RESTæŽ¥å£ï¼š123456789101112131415@RestController@RequestMapping("hello")public class HelloController &#123; private Logger logger = LoggerFactory.getLogger(this.getClass()); @Autowired private RestTemplate restTemplate; @GetMapping public String hello() &#123; logger.info("è°ƒç”¨server-provider1çš„helloæŽ¥å£"); return this.restTemplate.getForEntity("http://server-provider2/hello", String.class).getBody(); &#125;&#125;åœ¨helloæŽ¥å£ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡RestTemplateè¿œç¨‹è°ƒç”¨äº†server-provider2çš„helloæŽ¥å£ã€‚åˆ›å»ºServer-Provider2æ–°å»ºä¸€ä¸ªæ–°å»ºä¸€ä¸ªSpring Bootå·¥ç¨‹ï¼ŒartifactIdä¸ºServer-Provider2ï¼Œä¾èµ–å’ŒServer-Provider1ç›¸åŒã€‚åœ¨application.ymlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š12345678910spring: application: name: server-provider2server: port: 9001eureka: client: serviceUrl: defaultZone: http://mrbird:123456@peer1:8080/eureka/,http://mrbird:123456@peer2:8081/eureka/åœ¨å…¥å£ç±»ä¸­æ·»åŠ @EnableDiscoveryClientæ³¨è§£ï¼Œå¼€å¯æœåŠ¡æ³¨å†Œä¸Žå‘çŽ°ã€‚æœ€åŽç¼–å†™ä¸€ä¸ªRESTæŽ¥å£ï¼Œä¾›Server-Provider1è°ƒç”¨ï¼š123456789101112@RestController@RequestMapping("hello")public class HelloController &#123; private Logger logger = LoggerFactory.getLogger(this.getClass()); @GetMapping public String hello() &#123; logger.info("è°ƒç”¨server-provider2çš„helloæŽ¥å£"); return "hello world"; &#125;&#125;è‡³æ­¤ï¼ŒServer-Provider2ä¹Ÿæ­å»ºå®Œäº†ã€‚æµ‹è¯•Spring Cloud Sleuthå¯åŠ¨8080å’Œ8081Eureka-Serveré›†ç¾¤ï¼Œç„¶åŽåˆ†åˆ«å¯åŠ¨Server-Provider1å’ŒServer-Provider2ã€‚è®¿é—®http://localhost:8080/æŸ¥çœ‹æœåŠ¡æ˜¯å¦éƒ½å¯åŠ¨æˆåŠŸï¼šå¯è§æœåŠ¡éƒ½å¯åŠ¨æˆåŠŸäº†ï¼Œæˆ‘ä»¬å¾€Server-provider1å‘é€http://localhost:9000/helloè¯·æ±‚ï¼Œç„¶åŽè§‚å¯Ÿå„è‡ªçš„æ—¥å¿—ï¼šServer-Provider1ï¼š12018-06-25 10:13:40.921 INFO [server-provider1,939ca3c1d060ed40,939ca3c1d060ed40,false] 12516 --- [nio-9000-exec-6] c.e.demo.controller.HelloController : è°ƒç”¨server-provider1çš„helloæŽ¥å£Server-Provider2ï¼š12018-06-25 10:13:40.931 INFO [server-provider2,939ca3c1d060ed40,3f31114e88154074,false] 6500 --- [nio-9001-exec-3] c.e.demo.controller.HelloController : è°ƒç”¨server-provider2çš„helloæŽ¥å£å¯ä»¥çœ‹åˆ°ï¼Œæ—¥å¿—é‡Œå‡ºçŽ°äº†[server-provider2,939ca3c1d060ed40,3f31114e88154074,false]ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ç”±Spring Cloud Sleuthç”Ÿæˆï¼Œç”¨äºŽè·Ÿè¸ªå¾®æœåŠ¡è¯·æ±‚é“¾è·¯ã€‚è¿™äº›ä¿¡æ¯åŒ…å«äº†4ä¸ªéƒ¨åˆ†çš„å€¼ï¼Œå®ƒä»¬çš„å«ä¹‰å¦‚ä¸‹ï¼šserver-provider2å¾®æœåŠ¡çš„åç§°ï¼Œä¸Žspring.application.nameå¯¹åº”ï¼›939ca3c1d060ed40ç§°ä¸ºTrace IDï¼Œåœ¨ä¸€æ¡å®Œæ•´çš„è¯·æ±‚é“¾è·¯ä¸­ï¼Œè¿™ä¸ªå€¼æ˜¯å›ºå®šçš„ã€‚è§‚å¯Ÿä¸Šé¢çš„æ—¥å¿—å³å¯è¯å®žè¿™ä¸€ç‚¹ï¼›3f31114e88154074ç§°ä¸ºSpan IDï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªåŸºæœ¬çš„å·¥ä½œå•å…ƒï¼›falseè¡¨ç¤ºæ˜¯å¦è¦å°†è¯¥ä¿¡æ¯è¾“å‡ºåˆ°Zipkinç­‰æœåŠ¡ä¸­æ¥æ”¶é›†å’Œå±•ç¤ºï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜æ²¡æœ‰é›†æˆZipkinï¼Œæ‰€ä»¥ä¸ºfalseã€‚é›†æˆZipkinè™½ç„¶æˆ‘ä»¬å·²ç»å¯ä»¥é€šè¿‡Trace IDæ¥è·Ÿè¸ªæ•´ä½“è¯·æ±‚é“¾è·¯äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¾—åŽ»å„ä¸ªç³»ç»Ÿä¸­æžå–æ—¥å¿—ã€‚åœ¨å¹¶å‘è¾ƒé«˜å¾—æ—¶å€™ï¼Œæ—¥å¿—æ˜¯æµ·é‡çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å€ŸåŠ©Zipkinæ¥ä»£æ›¿æˆ‘ä»¬å®Œæˆæ—¥å¿—èŽ·å–ä¸Žåˆ†æžã€‚Zipkinæ˜¯Twitterçš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œä¸»è¦åŒ…å«äº†ä»¥ä¸‹å››ä¸ªç»„ä»¶ï¼šCollectorï¼šæ”¶é›†å™¨ï¼Œè´Ÿè´£æ”¶é›†æ—¥å¿—ä¿¡æ¯ï¼Œä»¥ä¾›åŽç»­çš„å­˜å‚¨ï¼Œåˆ†æžä¸Žå±•ç¤ºï¼›Storageï¼šå­˜å‚¨æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒå°†æ—¥å¿—å­˜å‚¨åˆ°MySQLä¸­ï¼›RESTful APIï¼šAPIç»„ä»¶ï¼Œå®ƒä¸»è¦ç”¨æ¥æä¾›å¤–éƒ¨è®¿é—®æŽ¥å£ã€‚ æ¯”å¦‚ç»™å®¢æˆ·ç«¯å±•ç¤ºè·Ÿè¸ªä¿¡æ¯ï¼Œæˆ–æ˜¯å¤–æŽ¥ç³»ç»Ÿè®¿é—®ä»¥å®žçŽ°ç›‘æŽ§ç­‰ï¼›WEB UIï¼šé€šè¿‡webé¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾çš„åˆ†æžä¸Žè·Ÿè¸ªè¯·æ±‚æ—¥å¿—ã€‚æ­å»ºZipkin-Serveråœ¨å®ŒæˆSpring Cloud Cleuthä¸ŽZipkinçš„æ•´åˆä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ­å»ºä¸€ä¸ªZipkinæœåŠ¡ã€‚æ–°å»ºä¸€ä¸ªSpring Bootåº”ç”¨ï¼ŒartifactIdä¸ºZipkin-Serverï¼Œå¹¶å¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š1234567891011121314151617181920212223242526&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.zipkin.java&lt;/groupId&gt; &lt;artifactId&gt;zipkin-server&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.zipkin.java&lt;/groupId&gt; &lt;artifactId&gt;zipkin-autoconfigure-ui&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;åœ¨å…¥å£ç±»ä¸­æ·»åŠ @EnableZipkinServeræ³¨è§£ï¼Œç”¨äºŽå¯åŠ¨ZipkinæœåŠ¡ã€‚æŽ¥ç€åœ¨application.ymlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š12345spring: application: name: zipkin-serverserver: port: 9100å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost:9100ï¼šå¾®æœåŠ¡å¼•å…¥ZipkinæŽ¥ç€æˆ‘ä»¬éœ€è¦åœ¨Server-Provider1å’ŒServer-Provider2é‡Œå¼•å…¥ZipkinæœåŠ¡ã€‚åˆ†åˆ«åœ¨Server-Provider1å’ŒServer-Provider2é‡Œæ·»åŠ Zipkinç›¸å…³ä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-sleuth-zipkin&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåˆ†åˆ«åœ¨Server-Provider1å’ŒServer-Provider2çš„é…ç½®æ–‡ä»¶é‡Œæ·»åŠ ZipkinæœåŠ¡åœ°å€ï¼š123spring: zipkin: base-url: http://localhost:9100è‡³æ­¤ï¼Œå¾®æœåŠ¡æ”¹é€ å®Œæ¯•ã€‚æµ‹è¯•å¯åŠ¨Server-Provider1å’ŒServer-Provider2ï¼Œå†æ¬¡å¾€Server-Provider1å‘é€å¤šä¸ªhttp://localhost:9000/helloè¯·æ±‚ï¼Œå½“æœ€åŽä¸€ä¸ªå‚æ•°ä¸ºtrueçš„æ—¶å€™ï¼Œè¯´æ˜Žè¯¥è·Ÿè¸ªä¿¡æ¯ä¼šè¾“å‡ºç»™Zipkin Serverï¼šè¿™æ—¶å€™è®¿é—®http://localhost:9100ï¼Œè§‚å¯ŸZipkin webé¡µé¢ï¼šç‚¹å‡»ä¸‹æ–¹çš„è·Ÿè¸ªä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•´ä¸ªé“¾è·¯ç»è¿‡äº†å“ªäº›æœåŠ¡ï¼Œæ€»è€—æ—¶ç­‰ä¿¡æ¯ï¼šç‚¹å‡»â€œä¾èµ–åˆ†æžâ€ä¹Ÿå¯ä»¥çœ‹åˆ°è¯·æ±‚é‡Œå¾®æœåŠ¡çš„å…³ç³»ï¼šè¿™é‡Œä¹‹æ‰€ä»¥è¦å¾€Server-Provider1å‘é€å¤šä¸ªhttp://localhost:9000/helloè¯·æ±‚æ˜¯å› ä¸ºspring.sleuth.sampler.percentageé»˜è®¤å€¼ä¸º0.1ï¼Œå³é‡‡æ ·çŽ‡æ‰1/10ã€‚å¦‚æžœæƒ³æ¯æ¬¡è¯·æ±‚éƒ½è¢«é‡‡æ ·ï¼Œå³æ¯æ¬¡è¯·æ±‚è·Ÿè¸ªä¿¡æ¯çš„ç¬¬å››ä¸ªå‚æ•°éƒ½ä¸ºtrueçš„è¯ï¼Œå¯ä»¥å°†è¿™ä¸ªå€¼è®¾ç½®ä¸º1ã€‚æ•°æ®å­˜å‚¨è¿™äº›è·Ÿè¸ªä¿¡æ¯åœ¨Zipkin-ServeræœåŠ¡é‡å¯åŽä¾¿ä¼šä¸¢å¤±ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›ä¿¡æ¯å­˜å‚¨åˆ°MySQLæ•°æ®åº“ä¸­ã€‚æˆ‘ä»¬åœ¨Zipkin-Serverä¸­æ·»åŠ MySQLæ•°æ®åº“é©±åŠ¨å’ŒJDBCä¾èµ–ï¼š123456789101112&lt;dependency&gt; &lt;groupId&gt;io.zipkin.java&lt;/groupId&gt; &lt;artifactId&gt;zipkin-autoconfigure-storage-mysql&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåœ¨application.ymlä¸­æ·»åŠ æ•°æ®åº“è¿žæŽ¥ä¿¡æ¯ï¼š123456789spring: datasource: url: jdbc:mysql://127.0.0.1:3306/zipkin?useUnicode=true&amp;characterEncoding=utf-8 driver-class-name: com.mysql.jdbc.Driver username: root password: 123456zipkin: storage: type: mysqlé…ç½®æ–‡ä»¶ä¸­åŒæ—¶é€šè¿‡zipkin.storage.type=mysqlæŒ‡å®šäº†Zipkinçš„å­˜å‚¨æ–¹å¼ä¸ºMySQLã€‚æŽ¥ä¸‹æ¥åˆ›å»ºæ•°æ®åº“å’Œæ•°æ®åº“è¡¨ï¼Œæ–°å»ºä¸€ä¸ªåä¸ºzipkinçš„æ•°æ®åº“ï¼šç„¶åŽå¯¼å…¥åº“è¡¨ï¼Œåº“è¡¨SQLæ–‡ä»¶åœ¨io.zipkin.java:zipkin-storage-mysql:2.6.1ä¾èµ–é‡Œå¯ä»¥æ‰¾åˆ°ï¼šåˆ›å»ºå®ŒåŽï¼Œæˆ‘ä»¬é‡å¯Zipkin-Serverï¼Œå‘é€http://localhost:9000/helloè¯·æ±‚ï¼Œç„¶åŽæŸ¥çœ‹æ•°æ®åº“ä¼šå‘çŽ°è·Ÿè¸ªä¿¡æ¯å·²ç»å­˜å‚¨åœ¨åº“è¡¨é‡Œäº†ï¼šZipkin APIæ­£å¦‚ä¸Šé¢æ‰€è¯´çš„ï¼ŒZipkinæä¾›äº†RESTful APIä¾›æˆ‘ä»¬è°ƒç”¨ï¼Œåœ¨å¯åŠ¨Zipkin-Serverçš„æ—¶å€™ï¼ŒæŽ§åˆ¶å°æ‰“å°æ—¥å¿—åŒ…å«å¦‚ä¸‹ä¿¡æ¯ï¼šè¿™äº›æŽ¥å£çš„åŠŸèƒ½å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šæŽ¥å£è¯·æ±‚æ–¹å¼æè¿°/trace/{traceIdHex}GETæ ¹æ®Trace IDèŽ·å–æŒ‡å®šè·Ÿè¸ªä¿¡æ¯çš„Spanåˆ—è¡¨/tracesGETæ ¹æ®æŒ‡å®šæ¡ä»¶æŸ¥è¯¢å¹¶è¿”å›žç¬¦åˆæ¡ä»¶çš„traceæ¸…å•/dependenciesGETç”¨æ¥èŽ·å–é€šè¿‡æ”¶é›†åˆ°çš„Spanåˆ†æžå‡ºçš„ä¾èµ–å…³ç³»/servicesGETç”¨æ¥èŽ·å–æœåŠ¡åˆ—è¡¨/spansGETæ ¹æ®æœåŠ¡åæ¥èŽ·å–æ‰€æœ‰çš„Spanåä¹Ÿå¯ä»¥å‚è€ƒhttps://zipkin.io/zipkin-api/ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/43.Spring-Cloud-Sleuthã€‚å‚è€ƒæ–‡ç«  Spring Cloudå¾®æœåŠ¡å®žæˆ˜]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨Spring Cloud Busåˆ·æ–°é…ç½®]]></title>
    <url>%2FSpring-Cloud-Bus.html</url>
    <content type="text"><![CDATA[åœ¨ä¸Šä¸€èŠ‚Spring Cloud Configç»Ÿä¸€é…ç½®ç®¡ç†ä¸­ï¼Œæˆ‘ä»¬å®žçŽ°äº†é€šè¿‡å¾€Config-Clientå‘é€/refreshPOSTè¯·æ±‚æ¥åˆ·æ–°é…ç½®ã€‚ä¸è¿‡è¿™ç§æ–¹å¼åªå¯¹å•ä¸ªConfig-Clientæœ‰æ•ˆï¼ˆå¾€å“ªä¸ªConfig-Clientå‘é€åˆ·æ–°è¯·æ±‚ï¼Œå“ªä¸ªé…ç½®å°±å¾—åˆ°åˆ·æ–°ï¼Œå‰©ä¸‹çš„Config-ClientèŽ·å–çš„ä»æ˜¯æ—§çš„é…ç½®ä¿¡æ¯ï¼‰ã€‚å½“Config-Clientå®žä¾‹é›†ç¾¤æ•°é‡è¾ƒå¤šæ—¶ï¼Œå¦‚æžœéƒ½è¦æ‰‹åŠ¨ä¸€ä¸ªä¸€ä¸ªåŽ»åˆ·æ–°é…ç½®ï¼Œä¸ä»…éº»çƒ¦è¿˜å®¹æ˜“é—æ¼ã€‚å€¼å¾—åº†å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©Spring Cloud Busæ¥è‡ªåŠ¨åˆ·æ–°é›†ç¾¤çš„é…ç½®ä¿¡æ¯ã€‚Spring Cloud Busä½¿ç”¨è½»é‡çº§çš„æ¶ˆæ¯ä»£ç†ï¼ˆå¦‚RabbitMQï¼ŒKafkaï¼‰è¿žæŽ¥åˆ†å¸ƒå¼ç³»ç»Ÿçš„èŠ‚ç‚¹ï¼Œå¯ä»¥ä»¥å¹¿æ’­çš„å½¢å¼å°†ä¸€äº›å˜æ›´ä¿¡æ¯ï¼ˆå¦‚é…ç½®çš„å˜æ›´ï¼‰æ‰©æ•£åˆ°åˆ†å¸ƒå¼é“¾è·¯ä¸­åŽ»ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨Config-Serverå’ŒConfig-Clienté›†ç¾¤ä¸­åŠ å…¥Spring Cloud Busï¼Œç„¶åŽå¾€æŸä¸ªConfig-Serverå®žä¾‹å‘é€/refreshè¯·æ±‚æ¥åˆ·æ–°é›†ç¾¤ä¸­æ‰€æœ‰å®žä¾‹çš„é…ç½®ä¿¡æ¯ã€‚åœ¨å¼•å…¥Spring Cloud Busä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç®€å•éªŒè¯ä¸‹å¼€å¤´çš„ç»“è®ºã€‚æˆ‘ä»¬ç”¨ä¸Šä¸€èŠ‚çš„æºç ä¸ºåŸºç¡€ï¼Œæ¥æ­å»ºEureka-Serverã€Config-Serverå’ŒConfig-Clientçš„é›†ç¾¤ã€‚å°†è¿™ä¸‰ä¸ªé¡¹ç›®æ‰“æˆjaråŒ…åŽï¼Œåˆ†åˆ«ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªåŒèŠ‚ç‚¹çš„Eureka-Serveré›†ç¾¤ï¼š12java -jar Eureka-Service-0.0.1-SNAPSHOT.jar --spring.profiles.active=peer1java -jar Eureka-Service-0.0.1-SNAPSHOT.jar --spring.profiles.active=peer2ç„¶åŽåˆ†åˆ«ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªåŒèŠ‚ç‚¹çš„Config-Serveré›†ç¾¤ï¼š12java -jar Config-Server-0.0.1-SNAPSHOT.jar --server.port=12579java -jar Config-Server-0.0.1-SNAPSHOT.jar --server.port=12580æœ€åŽåˆ†åˆ«ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªåŒèŠ‚ç‚¹çš„Config-Clienté›†ç¾¤ï¼š12java -jar Config-Client-0.0.1-SNAPSHOT.jar --server.port=12581java -jar Config-Client-0.0.1-SNAPSHOT.jar --server.port=12582è®¿é—®http://localhost:8080/æŸ¥çœ‹é›†ç¾¤èŠ‚ç‚¹æ˜¯å¦éƒ½å¯åŠ¨æˆåŠŸï¼šè¿™æ—¶å€™æˆ‘ä»¬è®¿é—®http://localhost:12581/messageæŸ¥çœ‹messageçš„å€¼ï¼šæŽ¥ç€æ‰‹åŠ¨ä¿®æ”¹Gitä»“åº“é‡Œçš„messageå€¼ä¸º&#39;å‘µå‘µå‘µå‘µ&#39;ï¼Œå¹¶å¾€12581ç«¯å£çš„Config-Clientå‘é€åˆ·æ–°è¯·æ±‚ï¼š12&gt; curl -u mrbird:123456 -X POST http://localhost:12581/refresh[&quot;config.client.version&quot;,&quot;message&quot;]å†æ¬¡è®¿é—®http://localhost:12581/messageï¼šå¯ä»¥çœ‹åˆ°12581ç«¯å£çš„Config-ClientèŽ·å–çš„é…ç½®ä¿¡æ¯å·²ç»å¾—åˆ°äº†æ›´æ–°ï¼Œé‚£12582ç«¯å£çš„Config-Clientå‘¢ï¼Ÿè®¿é—®http://localhost:12582/messageçœ‹çœ‹ç»“æžœï¼šå¯çœ‹åˆ°ï¼Œå…¶èŽ·å–çš„é…ç½®ä»ç„¶æ˜¯æ—§çš„ã€‚è¿™ä¹Ÿè¯å®žäº†æˆ‘ä»¬ä¸€å¼€å§‹çš„ç»“è®ºã€‚å¼•å…¥Spring Cloud BusSpring Cloud Busæ”¯æŒRabbitMQå’ŒKafkaç­‰æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œè¿™é‡Œåªä»‹ç»é…åˆRabbitMQçš„ä½¿ç”¨æ–¹å¼ã€‚RabbitMQçš„å®‰è£…ä¸Žå¯åŠ¨å¯ä»¥å‚è€ƒhttps://mrbird.cc/Spring-Cloud-Hystrix-Dashboard.htmlä¸­çš„ä»‹ç»ã€‚åœ¨Config-Serverå’ŒConfig-Clientçš„pomä¸­å¼•å…¥spring-cloud-starter-bus-amqpå’Œspring-boot-starter-actuatorä¾èµ–ï¼š12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-bus-amqp&lt;/artifactId&gt;&lt;/dependency&gt;å…¶ä¸­spring-cloud-starter-bus-amqpæ˜¯Spring Cloud Busçš„RabbitMQå®žçŽ°ï¼Œåˆ·æ–°ç”¨çš„ç«¯ç‚¹ç”±spring-boot-starter-actuatoræä¾›ã€‚ç„¶åŽåœ¨Config-Serverå’ŒConfig-Clientçš„application.ymlä¸­å¼•å…¥RabbitMQçš„è¿žæŽ¥ä¿¡æ¯ï¼š12345678910spring: rabbitmq: # RabbitMQ IP host: localhost # RabbitMQ Port port: 5672 # default RabbitMQ username username: guest # default RabbitMQ password password: gueståˆ°è¿™é‡Œï¼Œå¯¹Config-Serverå’ŒConfig-Clientæ”¹é€ å°±å®Œæˆäº†ï¼Œæ²¡é”™å°±æ˜¯è¿™ä¹ˆç®€å•ðŸ™‚ã€‚æˆ‘ä»¬é‡æ–°æ‰“åŒ…Config-Serverå’ŒConfig-Clientï¼Œç„¶åŽè¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨åŒèŠ‚ç‚¹Config-Serveré›†ç¾¤ï¼š12java -jar Config-Server-0.0.1-SNAPSHOT.jar --server.port=12579java -jar Config-Server-0.0.1-SNAPSHOT.jar --server.port=12580æŽ¥ç€åˆ†åˆ«ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªåŒèŠ‚ç‚¹çš„Config-Clienté›†ç¾¤ï¼š12java -jar Config-Client-0.0.1-SNAPSHOT.jar --server.port=12581java -jar Config-Client-0.0.1-SNAPSHOT.jar --server.port=12582å¯åŠ¨åŽæˆ‘ä»¬è®¿é—®RabbitMQçš„æŽ§åˆ¶é¡µé¢ï¼šhttp://localhost:15672ï¼Œå¯çœ‹åˆ°åœ¨Queuesä¸­å¤šäº†å››ä¸ªspringCloudBusé˜Ÿåˆ—ï¼šæ‰‹åŠ¨ä¿®æ”¹Gitä»“åº“é‡Œmessageçš„é…ç½®å€¼ä¸º&#39;spring cloud bus&#39;ï¼Œç„¶åŽå¾€ä»»æ„ä¸€ä¸ªConfig-ServerèŠ‚ç‚¹å‘é€/bus/refreshPOSTè¯·æ±‚ï¼š1curl -u mrbird:123456 -X POST http://localhost:12580/bus/refreshåˆ†åˆ«è®¿é—®http://localhost:12581/messageå’Œhttp://localhost:12582/messageï¼šé…ç½®éƒ½å·²åˆ·æ–°æˆåŠŸã€‚WebHooksé…åˆWebHookså¯ä»¥å®žçŽ°è‡ªåŠ¨é…ç½®åˆ·æ–°ï¼Œåœ¨é…ç½®å¾—åˆ°ä¿®æ”¹çš„æ—¶å€™å®ƒå¯ä»¥ä»£æ›¿æˆ‘ä»¬å‘Config-Serverå‘é€åˆ·æ–°è¯·æ±‚ã€‚ä»¥ç äº‘ä¸ºä¾‹ï¼Œæ·»åŠ ä¸€ä¸ªWebHooksï¼šç”±äºŽè¿™é‡Œæ˜¯åœ¨æœ¬åœ°è¿è¡Œæµ‹è¯•æ²¡æœ‰å…¬ç½‘IPï¼Œæ‰€ä»¥æ²¡æ³•æµ‹è¯•ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/42.Spring-Cloud-Bus]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud Configç»Ÿä¸€é…ç½®ç®¡ç†]]></title>
    <url>%2FSpring-Cloud-Config.html</url>
    <content type="text"><![CDATA[Spring Cloud Configå¯ä»¥å¯¹å¾®æœåŠ¡é…ç½®è¿›è¡Œç»Ÿä¸€çš„å¤–éƒ¨ç®¡ç†ï¼Œå¹¶ä¸”é»˜è®¤é‡‡ç”¨Gitæ¥ç®¡ç†é…ç½®ä¿¡æ¯ã€‚ç›¸å¯¹äºŽä¼ ç»Ÿçš„æ¯ä¸ªå¾®æœåŠ¡å¯¹åº”ä¸€ä»½è‡ªä¸ªå„¿çš„é…ç½®æ–‡ä»¶æ¥è¯´ï¼Œé€šè¿‡Spring Cloud Configç»Ÿä¸€ç®¡ç†æ‰€æœ‰å¾®æœåŠ¡é…ç½®å…·æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š1.é›†ä¸­ç®¡ç†å¾®æœåŠ¡é…ç½®ï¼Œå½“å¾®æœåŠ¡æ•°é‡ä¼—å¤šçš„æ—¶å€™ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼ä¼šæ›´ä¸ºæ–¹ä¾¿ï¼›2.é€šè¿‡Gitç®¡ç†å¾®æœåŠ¡é…ç½®ï¼Œæ–¹ä¾¿è¿½è¸ªé…ç½®ä¿®æ”¹è®°å½•ï¼›3.å¯ä»¥åœ¨åº”ç”¨è¿è¡ŒæœŸé—´ä¿®æ”¹é…ç½®ï¼Œå¾®æœåŠ¡èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°é…ç½®ã€‚Spring Cloud ConfigåŒ…å«äº†æœåŠ¡ç«¯Serverå’Œå®¢æˆ·ç«¯Clientã€‚æœåŠ¡ç«¯ç”¨äºŽä»ŽGitä»“åº“ä¸­åŠ è½½é…ç½®ï¼Œå¹¶ä¸”ç¼“å­˜åˆ°æœ¬åœ°ï¼›å®¢æˆ·ç«¯ç”¨äºŽä»ŽæœåŠ¡ç«¯èŽ·å–é…ç½®ä¿¡æ¯ã€‚æ‰€ä»¥ä¸ºäº†æ¼”ç¤ºSpring Cloud Configï¼Œæˆ‘ä»¬å…ˆæ¥æ­å»ºä¸€ä¸ªæœåŠ¡ç«¯ã€‚æ­å»ºConfig-Serveråœ¨æ­å»ºConfig-Serverä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå¥½ä¸€ä¸ªå­˜å‚¨é…ç½®æ–‡ä»¶çš„Gitä»“åº“ã€‚è¿™é‡Œä»¥ç äº‘ä¸ºä¾‹å­ï¼Œåˆ›å»ºä¸€ä¸ªåç§°ä¸ºSpring-Cloud-Configçš„å‚è€ƒï¼Œç„¶åŽå¾€ä»“åº“çš„masteråˆ†æ”¯pushå››ä¸ªé…ç½®æ–‡ä»¶ï¼šå››ä¸ªé…ç½®æ–‡ä»¶ä¸­åˆ†åˆ«éƒ½åŒ…å«äº†ä¸€ä¸ªmessageå±žæ€§ï¼šfebs.yml:1message: 'default properties (master v1.0)'febs-dev.yml:1message: 'dev properties (master v1.0)'febs-test.yml:1message: 'test properties (master v1.0)'febs-pro.yml:1message: 'pro properties (master v1.0)'æŽ¥ç€åˆ›å»ºä¸€ä¸ªteståˆ†æ”¯ï¼ŒåŒæ ·pushè¿™å››ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¸è¿‡é…ç½®æ–‡ä»¶ä¸­messageå±žæ€§çš„å†…å®¹æœ«å°¾éƒ½æ”¹ä¸ºäº†(test v1.0)ã€‚åˆ›å»ºå¥½é…ç½®æ–‡ä»¶ä»“åº“åŽï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼ŒartifactIdä¸ºConfig-Serverï¼Œç„¶åŽå¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š12345678910111213141516171819202122&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;åœ¨å…¥å£ç±»ä¸­åŠ å…¥@EnableConfigServeræ³¨è§£ï¼Œå¼€å¯Spring Cloud ConfigæœåŠ¡ç«¯åŠŸèƒ½ã€‚æŽ¥ç€é…ç½®application.ymlï¼š123456789101112spring: application: name: config-server cloud: config: server: git: uri: https://gitee.com/mrbird/spring-cloud-config username: xxx password: xxxserver: port: 12580uriçš„æœ«å°¾åŠ ä¸åŠ .gitéƒ½å¯ä»¥ã€‚é…ç½®å…·ä½“å«ä¹‰å¦‚ä¸‹ï¼šspring.cloud.config.server.git.uriï¼šé…ç½®äº†Gitä»“åº“çš„åœ°å€ï¼Œè¿™é‡Œç”¨çš„æ˜¯ç äº‘ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ«çš„Gitä»£ç æ‰˜ç®¡å¹³å°ï¼›spring.cloud.config.server.git.usernameï¼šä»“åº“ç”¨æˆ·åï¼Œå³Gitæ‰˜ç®¡å¹³å°çš„ç”¨æˆ·åï¼›spring.cloud.config.server.git.passwordï¼šä»“åº“å¯†ç ï¼Œå³Gitæ‰˜ç®¡å¹³å°çš„å¯†ç ã€‚è¿™é‡ŒæœåŠ¡ç«¯çš„ç«¯å£å·ä¸º12580ã€‚å¯åŠ¨åº”ç”¨ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™äº›æ ¼å¼æ¥è®¿é—®é…ç½®ä¿¡æ¯äº†ï¼š/{application}/{profile}[/{label}]/{application}-{profile}.yml/{label}/{application}-{profile}.yml/{application}-{profile}.properties/{label}/{application}-{profile}.propertiesæ¯”å¦‚å½“æˆ‘ä»¬è®¿é—®http://localhost:12580/master/febs-testæ—¶ï¼Œå“åº”ä¿¡æ¯å¦‚ä¸‹æ‰€ç¤ºï¼šè®¿é—®http://localhost:12580/master/febs-test.ymlï¼šè®¿é—®http://localhost:12580/test/febs-test.ymlï¼šè‡³æ­¤æœåŠ¡ç«¯æ­å»ºæˆåŠŸã€‚æ­å»ºConfig-Clientæ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼ŒartifactIdä¸ºConfig-Clientï¼Œç„¶åŽå¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š1234567891011121314151617181920212223242526&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;ç¼–å†™ä¸€ä¸ªControllerï¼Œç”¨äºŽæµ‹è¯•èŽ·å–Config-Serverä¸­é…ç½®æ–‡ä»¶çš„messageå±žæ€§å€¼ï¼š1234567891011@RestControllerpublic class TestController &#123; @Value("$&#123;message&#125;") private String message; @GetMapping("message") public String getMessage() &#123; return this.message; &#125;&#125;è¦æƒ³è®©ä¸Šé¢çš„ä»£ç é¡ºåˆ©çš„èŽ·å–åˆ°messageå±žæ€§å€¼ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¸€äº›é¢å¤–é…ç½®ï¼š1234567891011spring: application: name: febs cloud: config: profile: dev label: test uri: http://localhost:12580server: port: 12581å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œé…ç½®æ–‡ä»¶å¹¶ä¸æ˜¯å«application.ymlï¼Œè€Œæ˜¯å¿…é¡»å‘½åä¸ºbootstrap.ymlã€‚ä¸Šé¢é…ç½®å«ä¹‰å¦‚ä¸‹ï¼šspring.application.name: å¯¹åº”é…ç½®æ–‡ä»¶è§„åˆ™ä¸­çš„{application}ï¼›spring.cloud.config.profile: å¯¹åº”é…ç½®æ–‡ä»¶è§„åˆ™ä¸­çš„{profile}éƒ¨åˆ†ï¼›spring.cloud.config.label: å¯¹åº”é…ç½®æ–‡ä»¶è§„åˆ™ä¸­çš„{label}éƒ¨åˆ†ï¼›spring.cloud.config.uri: å¯¹åº”Config-Serverçš„åœ°å€ã€‚é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œmessageçš„å†…å®¹åº”è¯¥æ˜¯Gitä»“åº“ä¸­teståˆ†æ”¯ï¼Œfebs-dev.ymlä¸­çš„messageå±žæ€§å€¼ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¯å®žä¸€ä¸‹è¿™ä¸ªæŽ¨æµ‹ã€‚å¯åŠ¨Config-Clientï¼ˆConfig-Serveræ²¡å¯åŠ¨çš„è¯å¾—å…ˆå¯åŠ¨Config-Serverï¼‰ï¼Œè®¿é—®http://localhost:12581/messageï¼šç»“æžœè¯å®žäº†æˆ‘ä»¬çš„æŽ¨æµ‹ã€‚Config-Serveré¢å¤–é…ç½®ä¸Šé¢æˆ‘ä»¬ç®€å•çš„åœ°æ­å»ºäº†ä¸€ä¸ªConfig-Serverï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¿›ä¸€æ­¥äº†è§£Config-Serverçš„å¯ç”¨é…ç½®ã€‚å ä½ç¬¦çš„ä½¿ç”¨åœ¨Config-Serverä¸­ï¼Œé™¤äº†å›ºå®šé…ç½®ä¸€ä¸ªGitä»“åº“åœ°å€å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨å ä½ç¬¦æ¥çµæ´»çš„æŒ‡å®šGitä»“åº“åœ°å€ã€‚å°†ä¸Šé¢Config-Serverçš„Gitä»“åº“åœ°å€æ”¹ä¸ºï¼š123456spring: cloud: config: server: git: uri: https://gitee.com/mrbird/&#123;application&#125;è¿™é‡Œä½¿ç”¨å ä½ç¬¦{application}æ¥ä»£æ›¿ä¸Šé¢çš„spring-cloud-configï¼Œé€šè¿‡è¿™ç§é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥è®©ä¸åŒçš„Config-ClientåŽ»ä¸åŒçš„Gitä»“åº“èŽ·å–é…ç½®ã€‚æ¯”å¦‚ï¼Œå½“Config-Clientçš„é¡¹ç›®åç§°ä¸ºfebsçš„æ—¶å€™ï¼Œå¯¹åº”Gitä»“åº“åœ°å€ä¸º:https://gitee.com/mrbird/febsï¼Œå½“åç§°ä¸ºtestæ—¶ï¼Œå¯¹åº”Gitä»“åº“åœ°å€ä¸º:https://gitee.com/mrbird/testã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¸ºä¸åŒçš„é¡¹ç›®é…ç½®ä¸åŒçš„Gitä»“åº“ã€‚å­ç›®å½•æ”¯æŒé™¤äº†ä½¿ç”¨å ä½ç¬¦ä¸ºæ¯ä¸ªé¡¹ç›®åˆ›å»ºå•ç‹¬çš„Gitä»“åº“æ¥å­˜å‚¨é…ç½®ä¿¡æ¯å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åªåˆ›å»ºä¸€ä¸ªGitä»“åº“æ¥å­˜å‚¨é…ç½®ï¼Œåªä¸è¿‡æ˜¯å°†ä¸åŒçš„é¡¹ç›®é…ç½®æ”¾ç½®åˆ°ä¸åŒçš„ç›®å½•ä¸‹ï¼Œåªéœ€è¦åƒä¸‹é¢è¿™æ ·é…ç½®å³å¯ï¼š123456789spring: cloud: config: server: git: uri: https://gitee.com/mrbird/spring-cloud-config/ username: xxxx password: xxxx search-paths: '&#123;application&#125;'é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥å®žçŽ°åœ¨https://gitee.com/mrbird/spring-cloud-config/ä»“åº“ä¸­ï¼Œä¸€ä¸ªConfig-Clientå¯¹åº”ä¸€ä¸ªé…ç½®ç›®å½•çš„æ•ˆæžœï¼Œå³å½“Config-Clientçš„é¡¹ç›®åç§°ä¸ºfebsçš„æ—¶å€™ï¼Œå…¶æœç´¢é…ç½®çš„ç›®å½•ä¸ºhttps://gitee.com/mrbird/spring-cloud-config/febsã€‚è¿™é‡Œsearch-pathsçš„å ä½ç¬¦å¿…é¡»åŠ ä¸Šå•å¼•å·&#39;&#39;ï¼Œå¦åˆ™æ²¡åŠžæ³•æ­£ç¡®è¯»å–é…ç½®ï¼Œå…·ä½“å¯å‚è€ƒï¼šhttps://blog.csdn.net/weixin_35022258/article/details/79019033clone-on-starté»˜è®¤æƒ…å†µä¸‹Config-Serveråœ¨å¯åŠ¨çš„æ—¶å€™å¹¶ä¸ä¼šé©¬ä¸Šå°±åŽ»Gitå‚è€ƒcloneé…ç½®æ–‡ä»¶ï¼Œåªæœ‰å½“Config-Clinetä»ŽConfig-ServerèŽ·å–ç›¸å…³é…ç½®ä¿¡æ¯çš„æ—¶å€™ï¼Œå…¶æ‰ä¼šåŽ»è¿›è¡Œcloneæ“ä½œã€‚æˆ‘ä»¬å¯ä»¥å°†clone-on-startå±žæ€§è®¾ç½®ä¸ºtrueï¼Œå…¶Config-Serveråœ¨å¯åŠ¨çš„æ—¶å€™å°±è¿›è¡Œcloneæ“ä½œï¼š123456spring cloud: config: server: git: clone-on-start: trueè¿™æ ·åšçš„å¥½å¤„åœ¨äºŽï¼Œå½“Gitè¿žæŽ¥ä¿¡æ¯æœ‰è¯¯æ—¶ï¼Œå¯ä»¥é©¬ä¸Šå‘çŽ°ã€‚æ•´åˆSpring SecurityConfig-Serverä¸­åŒ…å«äº†Gitè¿žæŽ¥ä¿¡æ¯ï¼Œä¸ºäº†ä½¿å…¶æ›´åŠ å®‰å…¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Spring Securityæ¥åšç”¨æˆ·åå¯†ç è®¤è¯ã€‚åœ¨Config-Serverä¸­åŠ å…¥Spring Securityä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåœ¨Config-Serverçš„é…ç½®æ–‡ä»¶application.ymlä¸­åŠ å…¥ç”¨æˆ·åå’Œå¯†ç ï¼š1234security: user: name: mrbird password: 123456ä¸Žæ­¤åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦åœ¨Config-Clientä¸­é…ç½®Config-Serverçš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå¦åˆ™åœ¨èŽ·å–é…ç½®çš„æ—¶å€™å°†æŠ¥401é”™è¯¯ï¼š12345spring: cloud: config: username: mrbird password: 123456åŠ å¯†è§£å¯†æˆªè‡³ç›®å‰ä¸ºæ­¢ï¼ŒConfig-Serverä¸­Gitä»“åº“çš„å¯†ç æ˜¯ç›´æŽ¥æ˜Žæ–‡é…ç½®çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™äº›æ•æ„Ÿä¿¡æ¯è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…JCEï¼ˆJava Cryptography Extensionï¼‰ï¼Œæœ¬æ–‡ä½¿ç”¨çš„æ˜¯JDK 8ï¼Œä¸Žä¹‹å¯¹åº”çš„JCEä¸‹è½½åœ°å€ä¸ºï¼šhttps://www.oracle.com/technetwork/java/javase/downloads/jce-all-download-5170447.htmlï¼šè§£åŽ‹åŽï¼ŒåŒ…å«ä¸‰ä¸ªæ–‡ä»¶ï¼šæŠŠå®ƒä»¬å¤åˆ¶åˆ°$JAVA HOME/jre/lib/securityç›®å½•ä¸‹å³å¯ã€‚å¯¹ç§°åŠ å¯†ä½¿ç”¨å¯¹ç§°åŠ å¯†çš„æ–¹å¼éœ€è¦åœ¨Config-Serverä¸­é…ç½®åŠ å¯†ç”¨çš„å¯†é’¥ï¼š12encrypt: key: helloé…ç½®å¥½åŽé‡å¯Config-Serverï¼Œè®¿é—®http://localhost:12580/encrypt/statusæŸ¥çœ‹å¯†é’¥æ˜¯å¦é…ç½®æˆåŠŸ:å¯è§é…ç½®å¹¶æœªç”Ÿæ•ˆï¼ŒæŸ¥çœ‹Spring-Cloud-Configçš„Github issueæ‰¾åˆ°äº†è§£å†³åŠžæ³•ï¼šhttps://github.com/spring-cloud/spring-cloud-config/issues/767ã€‚è§£å†³åŠžæ³•å°±æ˜¯éœ€è¦å°†å¯†é’¥é…ç½®åœ¨bootstrap.ymlä¸­ï¼Œå†æ¬¡è®¿é—®http://localhost:12580/encrypt/statusï¼šå‡å¦‚æˆ‘ä»¬Gitä»“åº“çš„å¯†ç ä¸ºmrbird123ï¼Œè¦å¯¹å…¶åŠ å¯†çš„è¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨curlå‘½ä»¤æ¥èŽ·å–åŠ å¯†åŽçš„å¯†ç ï¼šå› ä¸ºConfig-Serverè®¾ç½®äº†ç”¨æˆ·åå’Œå¯†ç ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨curlå‘½ä»¤æ—¶ï¼Œéœ€è¦å¸¦ä¸Š-u mrbird:123456ã€‚å¯çœ‹åˆ°mrbird123è¢«åŠ å¯†æˆäº†f413c4d441a7a00ef82d9aedfab087dae51772276c0201a9d9b13df3e2a9b64cï¼Œå› ä¸ºæ˜¯å¯¹ç§°åŠ å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†f413c4d441a7a00ef82d9aedfab087dae51772276c0201a9d9b13df3e2a9b64cè§£å¯†ï¼šæˆ‘ä»¬ç”¨åŠ å¯†åŽçš„å¯†ç æ›¿æ¢æŽ‰Gitè¿žæŽ¥çš„æ˜Žæ–‡å¯†ç ï¼š123456spring: cloud: config: server: git: password: '&#123;cipher&#125;155315857d26a3235027679a015aa7c71a15ca43ae77e2a11ce9d122d1f4bd043d18'ä½¿ç”¨{cipher}å¼€å¤´è¡¨æ˜Žè¿™æ˜¯ä¸€ä¸ªåŠ å¯†çš„å†…å®¹ï¼ŒConfig-Serverä¼šè‡ªåŠ¨ä¸ºå…¶è§£å¯†ã€‚å½“ç„¶ï¼Œä½ è¿˜å¯ä»¥ä¸ºä»»ä½•ä½ æƒ³åŠ å¯†çš„å±žæ€§å€¼è¿›è¡ŒåŠ å¯†ï¼Œä¸é™äºŽå¯†ç ã€‚éžå¯¹ç§°åŠ å¯† éžå¯¹ç§°åŠ å¯†ç›¸æ¯”å¯¹ç§°åŠ å¯†æ¥è¯´æ˜¾å¾—æ›´åŠ å®‰å…¨ï¼Œè¦ç”Ÿæˆéžå¯¹ç§°åŠ å¯†çš„å¯†ç ï¼Œéœ€è¦å€ŸåŠ©keytoolå‘½ä»¤æ¥ç”Ÿæˆå¯†é’¥ã€‚keytoolæ˜¯JDKä¸­çš„ä¸€ä¸ªå¯†é’¥å’Œè¯ä¹¦ ç®¡ç†å·¥å…·ã€‚ ä½äºŽ%JAVA_HOME%\bin\ç›®å½•ä¸‹ï¼šæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æ¥ç”Ÿæˆä¸€ä¸ªå¯†é’¥æ–‡ä»¶ï¼šå‘½ä»¤æ‰§è¡Œç»“æŸåŽï¼Œä¼šåœ¨%JAVA_HOME%\bin\ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª config-server.keystoreæ–‡ä»¶ã€‚å¯†é’¥æ–‡ä»¶çš„æœ‰æ•ˆæœŸé»˜è®¤ä¸º90å¤©ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨-validity 365æ¥æ”¹å˜å…¶æœ‰æ•ˆå¤©æ•°ä¸º365å¤©ã€‚æŽ¥ç€å°†å¯†é’¥æ–‡ä»¶æ‹·è´åˆ°Config-Serverçš„resourcesç›®å½•ä¸‹ï¼Œç„¶åŽåœ¨bootstrap.ymlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š123456789#encrypt:## key: helloencrypt: key-store: location: classpath:config-server.keystore alias: Config-Server password: 123456 secret: 654321å…¶ä¸­encrypt.key-store.passwordä¸ºç¬¬ä¸€æ¬¡è¾“å…¥çš„å£ä»¤ï¼Œencrypt.key-store.secretä¸º&lt;Config-Server&gt;çš„å¯†é’¥å£ä»¤çš„å¯†é’¥å£ä»¤ã€‚æˆ‘ä»¬å°†Gitè¿žæŽ¥çš„å¯†ç æ”¹å›žæ˜Žæ–‡ï¼Œç„¶åŽé‡å¯Config-Serverï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤é‡æ–°å¯¹Gitè¿žæŽ¥å¯†ç è¿›è¡ŒåŠ å¯†ï¼šç„¶åŽå°†åŠ å¯†åŽçš„å¯†ç æ›¿æ¢æ˜Žæ–‡å¯†ç å³å¯ï¼š123456spring: cloud: config: server: git: password: '&#123;cipher&#125;AQAjzCKbjLdmgBt+Zm0/jznvbwbCAZ7j1hZKl1NtcmdEj2GFGzF02Bi5jIk9ETz92XOV3z9U5UZTEBMLblKFlZqEzFNooJAZSEmCdwDY9iI5mbhe5oGApxlhbzF4pccF9wtkt4YIW3ElQWCfg01FhDuBiDIZ8NPlMJXRDjIV+/rhla/MkdHVWaphWW3PbHlF95D7bjssCLlyeDB5BjF4orOMpVdVAT/BZA5ANy+xDbEUiOd54E9E9pYAwxG+0qW6a3PvK6OCFozVfPgvT5xorAiJ50AzIH64ZjqILSPonpk3hcIm1PlTguOE5x2BYvgxYmq/CnlkhML07yJVElVAaWh4sTIs8I5hAwQ58SvAcgq/oDE5QluF+dHvoZFn748yCe0='Config-Clienté¢å¤–é…ç½®åˆ·æ–°é…ç½®åœ¨Config-Serverå’ŒConfig-Clientéƒ½å¯åŠ¨åŽï¼Œå¦‚æžœè¿™æ—¶å€™Gitä»“åº“å­˜å‚¨çš„é…ç½®ä¿¡æ¯æ”¹å˜äº†ï¼Œåœ¨ä¸é‡å¯Config-Clientçš„æƒ…å†µä¸‹ï¼Œé…ç½®ä¿¡æ¯æ˜¯ä¸ä¼šè·Ÿç€æ›´æ–°çš„ã€‚é‚£ä¹ˆå¦‚ä½•åœ¨Gitä»“åº“å­˜å‚¨çš„é…ç½®å¾—åˆ°æ”¹å˜çš„æ—¶å€™ä¹Ÿåˆ·æ–°Config-Clientä¸­èŽ·å–åˆ°çš„é…ç½®å€¼å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹Config-Clientè¿›è¡Œç®€å•çš„æ”¹é€ ï¼šåœ¨Config-Clientä¸­æ·»åŠ spring-boot-starter-actuatorä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;è¯¥ä¾èµ–åŒ…å«äº†/refreshç«¯ç‚¹ï¼Œå¯ä»¥ç”¨æ¥åˆ·æ–°é…ç½®ã€‚ç„¶åŽåœ¨èŽ·å–é…ç½®çš„Controllerä¸ŠåŠ å…¥@RefreshScopeæ³¨è§£ï¼š123456789101112@RestController@RefreshScopepublic class TestController &#123; @Value("$&#123;message&#125;") private String message; @GetMapping("message") public String getMessage() &#123; return this.message; &#125;&#125;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦åœ¨Config-Clientçš„é…ç½®æ–‡ä»¶ä¸­åŠ å…¥å¦‚ä¸‹é…ç½®æ¥å…³é—­è®¤è¯ï¼Œå¦åˆ™æˆ‘ä»¬æ— æƒè®¿é—®/refreshç«¯ç‚¹ï¼Œå…·ä½“å¯è§https://github.com/spring-guides/gs-centralized-configuration/issues/5ï¼š123management: security: enabled: falseé‡å¯Config-Clientï¼Œè®¿é—®http://localhost:12581/message:è¿™æ—¶å€™æˆ‘ä»¬å°†Gitä»“åº“ä¸­å¯¹åº”çš„é…ç½®ä¿¡æ¯æ”¹ä¸ºæµ‹è¯•é…ç½®åˆ·æ–°ï¼Œå†æ¬¡è®¿é—®http://localhost:12581/messageä¼šå‘çŽ°å€¼è¿˜æ˜¯dev properties (master v1.0)ã€‚æŽ¥ç€æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥åˆ·æ–°é…ç½®ï¼šè¿™æ—¶å€™å†æ¬¡è®¿é—®http://localhost:12581/messageï¼šå¯çœ‹åˆ°åœ¨ä¸é‡å¯Config-Clientçš„å‰æä¸‹é…ç½®å€¼å·²ç»å¾—åˆ°äº†æ›´æ–°ã€‚é›†ç¾¤é…ç½®å¦‚æžœConfig-Serveråªæ˜¯å•æœºéƒ¨ç½²çš„è¯ï¼Œå½“å…¶é‡åˆ°é—®é¢˜å®•æœºåŽï¼Œæ‰€æœ‰ä»ŽConfig-ServerèŽ·å–é…ç½®ä¿¡æ¯çš„å¾®æœåŠ¡éƒ½æ— æ³•æ­£å¸¸å·¥ä½œäº†ï¼Œè¿™æ˜¯ç¾éš¾æ€§çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¾ˆæœ‰å¿…è¦å¯¹Config-Serverè¿›è¡Œé›†ç¾¤å¤„ç†ã€‚é›†ç¾¤çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œè¿™é‡Œä»‹ç»é€šè¿‡å°†Config-Serveræ³¨å†Œåˆ°Eurekaçš„æ–¹å¼æ¥æ­å»ºé›†ç¾¤ã€‚æˆ‘ä»¬ä½¿ç”¨åœ¨Spring Cloud EurekaæœåŠ¡æ²»ç†ä¸€èŠ‚ä¸­çš„Eureka-Serviceæ¥æž„å»ºEureka-ServeræœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨Eureka-Serveré›†ç¾¤ï¼š12java -jar Eureka-Service-0.0.1-SNAPSHOT.jar --spring.profiles.active=peer1java -jar Eureka-Service-0.0.1-SNAPSHOT.jar --spring.profiles.active=peer2å¯åŠ¨åŽï¼Œè®¿é—®http://localhost:8080/:è¯´æ˜ŽEurekaé›†ç¾¤å¯åŠ¨æˆåŠŸã€‚ æŽ¥ä¸‹æ¥å¼€å§‹å¯¹Config-Serverè¿›è¡Œæ”¹é€ ï¼Œå°†å…¶æ³¨å†Œåˆ°EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚åœ¨Config-Serverä¸­åŠ å…¥Eurekaä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåœ¨Config-Serverçš„å¯åŠ¨ç±»ä¸­åŠ å…¥@EnableDiscoveryClientæ³¨è§£ï¼Œç”¨äºŽå°†æœåŠ¡æ³¨å†Œåˆ°EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒä¸Šï¼š12345678@SpringBootApplication@EnableConfigServer@EnableDiscoveryClientpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;æœ€åŽåœ¨é…ç½®ç±»application.ymlä¸­æŒ‡å®šEurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼š1234eureka: client: serviceUrl: defaultZone: http://mrbird:123456@peer1:8080/eureka/,http://mrbird:123456@peer2:8081/eureka/å› ä¸ºä¹‹å‰EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒæ·»åŠ äº†è®¤è¯ï¼Œæ‰€ä»¥éœ€è¦åœ¨urlä¸­æŒ‡å®šç”¨æˆ·åå’Œå¯†ç ã€‚æ”¹é€ å¥½åŽï¼Œå¯åŠ¨Config-Serverï¼Œå†æ¬¡è®¿é—®EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒåœ°å€ï¼šhttp://localhost:8080/ï¼šå¯çœ‹åˆ°Config-Serverå·²ç»æˆåŠŸæ³¨å†Œäº†ã€‚æŽ¥ç€å¼€å§‹æ”¹é€ Config-Clientï¼Œåœ¨å…¶pomä¸­åŒæ ·å¼•å…¥Eurekaä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåœ¨bootstrap.ymlä¸­æŒ‡å®šèŽ·å–Config-ServeræœåŠ¡çš„åœ°å€ï¼š1234567891011121314151617spring: application: name: febs cloud: config: profile: dev label: master username: mrbird password: 123456 discovery: enabled: true service-id: config-servereureka: client: serviceUrl: defaultZone: http://mrbird:123456@peer1:8080/eureka/,http://mrbird:123456@peer2:8081/eureka/å…¶ä¸­eureka.client.serviceUrl.defaultZoneæŒ‡å®šäº†EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼›spring.cloud.config.discovery.enabledæŒ‡å®šä¸ºtrueå¼€å¯èŽ·å–æœåŠ¡çš„åŠŸèƒ½ï¼Œspring.cloud.config.discovery.service-idè¡¨æ˜Žéœ€è¦èŽ·å–æœåŠ¡çš„åç§°ä¸ºconfig-serverã€‚æœ€åŽåœ¨Config-Clientçš„å¯åŠ¨ç±»ä¸­å¼•å…¥@EnableDiscoveryClientæ³¨è§£ï¼š1234567@SpringBootApplication@EnableDiscoveryClientpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;å¯åŠ¨Config-Clientï¼Œè®¿é—®ï¼šhttp://localhost:12581/messageå¯çœ‹åˆ°ï¼Œé…ç½®ä¿¡æ¯åŒæ ·èŽ·å–æˆåŠŸã€‚å‚è€ƒæ–‡ç« ï¼šSpring Cloudå¾®æœåŠ¡å®žæˆ˜http://cloud.spring.io/spring-cloud-static/spring-cloud-config/1.4.3.RELEASE/single/spring-cloud-config.htmlæºç åœ°å€ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/41.Spring-Cloud-Config]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud ZuulæœåŠ¡ç½‘å…³]]></title>
    <url>%2FSpring-Cloud-Zuul-Router.html</url>
    <content type="text"><![CDATA[åœ¨å¾®æœåŠ¡çš„æž¶æž„ä¸­ï¼ŒæœåŠ¡ç½‘å…³å°±æ˜¯ä¸€ä¸ªä»‹äºŽå®¢æˆ·ç«¯ä¸ŽæœåŠ¡ç«¯ä¹‹é—´çš„ä¸­é—´å±‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯åªéœ€è¦è·ŸæœåŠ¡ç½‘å…³äº¤äº’ï¼Œæ— éœ€è°ƒç”¨å…·ä½“çš„å¾®æœåŠ¡æŽ¥å£ã€‚è¿™æ ·çš„å¥½å¤„åœ¨äºŽï¼Œå®¢æˆ·ç«¯å¯ä»¥é™ä½Žå¤æ‚æ€§ï¼›å¯¹äºŽéœ€è¦è®¤è¯çš„æœåŠ¡ï¼Œåªéœ€è¦åœ¨æœåŠ¡ç½‘å…³é…ç½®å³å¯ï¼›åŒæ ·ä¹Ÿæ–¹ä¾¿åŽæœŸå¾®æœåŠ¡çš„å˜æ›´å’Œé‡æž„ï¼Œå³å¾®æœåŠ¡æŽ¥å£å˜æ›´åªéœ€åœ¨æœåŠ¡ç½‘å…³è°ƒæ•´é…ç½®å³å¯ï¼Œæ— éœ€æ›´æ”¹å®¢æˆ·ç«¯ä»£ç ã€‚Zuulæ˜¯ä¸€æ¬¾ç”±Netflixå¼€å‘çš„å¾®æœåŠ¡ç½‘å…³å¼€æºè½¯ä»¶ï¼Œå¯ä»¥å’Œå…¶è‡ªå®¶å¼€å‘çš„Eurekaï¼ŒRibbonå’ŒHystrixé…åˆä½¿ç”¨ï¼ŒSpring Cloudå¯¹å…¶è¿›è¡Œäº†å°è£…ã€‚Spring Cloud Zuulå…¥é—¨åœ¨æž„å»ºå¾®æœåŠ¡ç½‘å…³ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå°†ç›¸å…³å¾®æœåŠ¡æ­å»ºå¥½ã€‚è¿™é‡Œæˆ‘ä»¬ç›´æŽ¥ä½¿ç”¨å‰é¢çš„ä¾‹å­ï¼Œåˆ†åˆ«å¯åŠ¨å¦‚ä¸‹æœåŠ¡ï¼šå¯åŠ¨Eureka-Serveré›†ç¾¤ï¼Œç«¯å£å·ä¸º8080å’Œ8081ï¼›å¯åŠ¨ä¸€ä¸ªEureka-Clientï¼Œç«¯å£å·ä¸º8082ï¼›å¯åŠ¨ä¸€ä¸ªFeign-Consumerï¼Œç«¯å£å·ä¸º9000ï¼›æŸ¥çœ‹http://localhost:8080/ï¼šå…¶ä¸­Feign-Consumerè™½ç„¶ä¹‹å‰æˆ‘ä»¬å°†å®ƒå®šä¹‰ä¸ºæœåŠ¡æ¶ˆè´¹è€…ï¼Œä½†å…¶ä¹Ÿå¯ä»¥å……å½“æœåŠ¡æä¾›è€…çš„è§’è‰²ã€‚å¯åŠ¨å¥½è¿™äº›å¾®æœåŠ¡åŽï¼Œæˆ‘ä»¬å¼€å§‹æž„å»ºä¸€ä¸ªå¾®æœåŠ¡ç½‘å…³Zuul-Gatewayã€‚æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼ŒartifactIdä¸ºZuul-Gatewayï¼Œç„¶åŽå¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š123456789101112131415161718192021&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-zuul&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;æŸ¥çœ‹ä¾èµ–å…³ç³»å¯çœ‹åˆ°spring-cloud-starter-zuulåŒ…å«ä»¥ä¸‹ä¾èµ–ï¼šå› ä¸ºspring-cloud-starter-zuulä¾èµ–å·²ç»åŒ…å«äº†Hystrixå’ŒRibbonï¼Œæ‰€ä»¥zuulæ”¯æŒå‰é¢ä»‹ç»çš„Hystrixå’ŒRibbonç›¸å…³é…ç½®ã€‚æŽ¥ç€åœ¨Spring Bootçš„å…¥å£ç±»ä¸Šæ ‡æ³¨@EnableZuulProxyæ³¨è§£ï¼Œå¼€å¯ZuulæœåŠ¡ç½‘å…³çš„åŠŸèƒ½ï¼š1234567@EnableZuulProxy@SpringBootApplicationpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;æœ€åŽç®€å•é…ç½®ä¸‹application.ymlï¼š12345spring: application: name: Zuul-Gatewayserver: port: 12580è‡³æ­¤ä¸€ä¸ªç®€å•çš„Zuulå¾®æœåŠ¡ç½‘å…³å°±æ­å»ºå¥½äº†ï¼Œä¸‹é¢å¼€å§‹å¯¹è·¯ç”±è§„åˆ™è¿›è¡Œé…ç½®ã€‚è·¯ç”±é…ç½®ä¼ ç»Ÿé…ç½®ä¼ ç»Ÿé…ç½®å°±æ˜¯æ‰‹åŠ¨æŒ‡å®šæœåŠ¡çš„è½¬å‘åœ°å€ï¼Œå¦‚åœ¨ymlä¸­é…ç½®ï¼š12345zuul: routes: api-a: path: /api-a/** url: http://localhost:8082é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œæ‰€æœ‰ç¬¦åˆ/api-a/**è§„åˆ™çš„è®¿é—®éƒ½å°†è¢«è·¯ç”±è½¬å‘åˆ°http://localhost:8082/åœ°å€ä¸Šï¼Œå³å½“æˆ‘ä»¬å‘æœåŠ¡ç½‘å…³è®¿é—®http://localhost:12580/api-a/helloè¯·æ±‚çš„æ—¶å€™ï¼Œè¯·æ±‚å°†è¢«è½¬å‘åˆ°http://localhost:8082/helloæœåŠ¡ä¸Šï¼šåŸºäºŽæœåŠ¡åç§°é…ç½®ä¼ ç»Ÿçš„é…ç½®æ–¹å¼ä¸ä¾¿ä¹‹å¤„åœ¨äºŽéœ€è¦çŸ¥é“æœåŠ¡çš„å…·ä½“åœ°å€å’Œç«¯å£å·ç­‰ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©Eurekaæ¥å®žçŽ°é€šè¿‡æœåŠ¡åç§°é…ç½®è·¯ç”±ã€‚åœ¨Zuul-Gatewayé¡¹ç›®ä¸­å¼•å…¥Eurekaä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåœ¨å…¥å£ç±»ä¸­åŠ å…¥@EnableDiscoveryClientæ³¨è§£ï¼Œä½¿å…¶å…·æœ‰èŽ·å–æœåŠ¡çš„èƒ½åŠ›ã€‚æŽ¥ç€åœ¨ymlä¸­é…ç½®åŸºäºŽæœåŠ¡åç§°çš„è·¯ç”±ï¼š123456789101112eureka: client: serviceUrl: defaultZone: http://mrbird:123456@peer1:8080/eureka/,http://mrbird:123456@peer2:8081/eureka/zuul: routes: api-b: path: /api-b/** serviceId: server-provider api-c: path: /api-c/** serviceId: server-consumerä¸Šé¢æˆ‘ä»¬é¦–å…ˆæŒ‡æ˜Žäº†EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼Œç„¶åŽé…ç½®äº†api-bå’Œapi-cçš„è·¯ç”±ï¼Œå®ƒä»¬éƒ½æ˜¯é€šè¿‡serviceIdæ¥æŒ‡å®šæœåŠ¡åç§°çš„ã€‚å¯åŠ¨Zuul-Gatewayï¼Œè®¿é—®ï¼šhttp://localhost:12580/api-b/helloï¼šè®¿é—®ï¼šhttp://localhost:12580/api-c/user/1ï¼šåŸºäºŽæœåŠ¡åç§°çš„è·¯ç”±é…ç½®è¿˜å¯ä»¥è¿›è¡Œç®€åŒ–ï¼Œæ ¼å¼ä¸ºzuul.routes.&lt;serviceid&gt;=&lt;path&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†api-bå’Œapi-cçš„è·¯ç”±é…ç½®ä¿®æ”¹ä¸ºï¼š123456zuul: routes: server-provider: path: /api-b/** server-consumer: path: /api-c/**é»˜è®¤è·¯ç”±é…ç½®è§„åˆ™æˆ‘ä»¬å°è¯•è®¿é—®http://localhost:12580/server-consumer/user/1:æˆ‘ä»¬åŽ‹æ ¹æ²¡é…ç½®è¿™ä¸ªè·¯ç”±å•Šï¼Œä¸ºä»€ä¹ˆå¯ä»¥æ­£å¸¸å“åº”ï¼Ÿï¼Ÿå…¶å®žZuulé…åˆEurekaåŽå°†ä¼šæˆä¸€å¥—é»˜è®¤çš„é…ç½®è§„åˆ™ã€‚å½“æˆ‘ä»¬ä½¿ç”¨æœåŠ¡åç§°ä½œä¸ºè¯·æ±‚çš„å‰ç¼€è·¯å¾„æ—¶ï¼Œå®žé™…ä¸Šå°±ä¼šåŒ¹é…ä¸Šç±»ä¼¼ä¸‹é¢çš„é»˜è®¤è·¯ç”±é…ç½®ï¼š12345zuul: routes: server-consumer: path: /server-consumer/** serviceId: server-consumerå¦‚æžœä¸æƒ³å¯åŠ¨è¿™ä¸ªé»˜è®¤é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨zuul.ignored-servicesé…ç½®æ¥å…³é—­ï¼Œå¦‚åœ¨ymlä¸­åŠ å…¥å¦‚ä¸‹é…ç½®ä¹‹åŽï¼Œå†æ¬¡è®¿é—®http://localhost:12580/server-consumer/user/1å°†è¿”å›ž404ï¼š12zuul: ignored-services: server-consumerè®¾ç½®ä¸ºzuul.ignored-services=*çš„æ—¶å€™å°†å…³é—­æ‰€æœ‰é»˜è®¤è·¯ç”±é…ç½®è§„åˆ™ã€‚ä¼˜å…ˆçº§å‡å¦‚æŸä¸ªè¯·æ±‚è·¯å¾„å¯ä»¥å’Œå¤šä¸ªè·¯ç”±é…ç½®è§„åˆ™ç›¸åŒ¹é…çš„è¯ï¼ŒZuulæ ¹æ®åŒ¹é…çš„å…ˆåŽé¡ºåºæ¥å†³å®šæœ€ç»ˆä½¿ç”¨å“ªä¸ªè·¯ç”±é…ç½®ã€‚æ¯”å¦‚ï¼š12345678zuul: routes: api-c: path: /api-c/** serviceId: server-consumer api-d: path: /api-c/user/1 serviceId: lolå½“æˆ‘ä»¬è®¿é—®http://localhost:12580/api-c/user/1çš„æ—¶å€™ï¼Œapi-cå’Œapi-dçš„è·¯ç”±é…ç½®éƒ½å¯ä»¥åŒ¹é…ä¸Šï¼Œä½†ç”±äºŽapi-cå…ˆäºŽapi-dé…ç½®ï¼Œæ‰€ä»¥æœ€ç»ˆç”Ÿæ•ˆçš„æ˜¯api-cçš„é…ç½®ã€‚å‡å¦‚å°†api-cå’Œapi-dçš„é…ç½®é¡ºåºè°ƒæ¢ï¼Œå†æ¬¡è®¿é—®http://localhost:12580/api-c/user/1æ—¶å°†æŠ›å‡ºå¼‚å¸¸ï¼ŒåŽŸå› æ˜¯ä¸å­˜åœ¨æœåŠ¡åä¸ºlolçš„æœåŠ¡ï¼šCaused by: com.netflix.client.ClientException: Load balancer does not have available server for client: lolå‰ç¼€é…ç½®zuul.prefixå¯ä»¥ä¸ºç½‘å…³çš„è¯·æ±‚è·¯å¾„åŠ ä¸ªå‰ç¼€ï¼Œæ¯”å¦‚ï¼š12zuul: prefix: /gatewayè¿™æ ·é…ç½®åŽï¼Œæˆ‘ä»¬é€šè¿‡Zuulç½‘å…³èŽ·å–æœåŠ¡çš„æ—¶å€™ï¼Œè·¯å¾„ä¹Ÿå¾—åŠ ä¸Šè¿™ä¸ªå‰ç¼€ï¼Œå¦‚http://localhost:12580/gateway/api-c/user/1ã€‚æœ¬åœ°è·³è½¬Zuulç½‘å…³é™¤äº†æ”¯æŒå°†æœåŠ¡è½¬å‘åˆ°å„ä¸ªå¾®æœåŠ¡ä¸Šä¹‹å¤–ï¼Œè¿˜æ”¯æŒå°†æœåŠ¡è·³è½¬åˆ°ç½‘å…³æœ¬èº«çš„æœåŠ¡ä¸Šï¼Œæ¯”å¦‚çŽ°åœ¨ymlä¸­æœ‰å¦‚ä¸‹ä¸€æ®µé…ç½®:12345zuul: routes: api-e: path: /api-e/** url: forward:/testå½“è®¿é—®http://localhost:12580/gateway/api-e/helloæ—¶ï¼ŒZuulä¼šä»Žæœ¬åœ°/test/helloèŽ·å–æœåŠ¡ã€‚æˆ‘ä»¬åœ¨Zuul-Gatewayå…¥å£ç±»ä¸­åŠ ä¸Šè¯¥RESTæœåŠ¡ï¼š12345678910111213@EnableZuulProxy@EnableDiscoveryClient@SpringBootApplication@RestControllerpublic class DemoApplication &#123; @GetMapping("/test/hello") public String hello() &#123; return "hello zuul"; &#125; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼šå¤´éƒ¨è¿‡æ»¤ &amp; é‡å®šå‘åœ¨ä½¿ç”¨Zuulç½‘å…³çš„æ—¶å€™ä½ å¯èƒ½ä¼šé‡åˆ°Cookieä¸¢å¤±çš„æƒ…å†µï¼Œè¿™æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹Zuulä¼šè¿‡æ»¤æŽ‰HTTPè¯·æ±‚å¤´ä¸­çš„ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œè¿™äº›æ•æ„Ÿä¿¡æ¯é€šè¿‡ä¸‹é¢çš„é…ç½®è®¾å®šï¼š12zuul: sensitive-headers: Cookie,Set-Cookie,Authorizationå¦‚æžœæƒ³å…³é—­è¿™ä¸ªé»˜è®¤é…ç½®ï¼Œé€šè¿‡è®¾ç½®å…¨å±€å‚æ•°ä¸ºç©ºæ¥è¦†ç›–é»˜è®¤å€¼ï¼š12zuul: sensitive-headers:å¦‚æžœåªæƒ³å…³é—­æŸä¸ªè·¯ç”±çš„HTTPè¯·æ±‚å¤´è¿‡æ»¤ï¼Œå¯ä»¥è¿™æ ·ï¼š1234zuul: routes: api-a: sensitive-headers:ä½¿ç”¨Zuulå¦ä¸€ä¸ªå¸¸è§é—®é¢˜æ˜¯é‡å®šå‘çš„é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„è®¾ç½®è§£å†³ï¼š12zuul: add-host-header: trueè¿‡æ»¤å™¨Zuulå¦ä¸€ä¸ªæ ¸å¿ƒçš„åŠŸèƒ½å°±æ˜¯è¯·æ±‚è¿‡æ»¤ã€‚Zuulä¸­é»˜è®¤å®šä¹‰äº†4ç§ä¸åŒç”Ÿå‘½å‘¨æœŸçš„è¿‡æ»¤å™¨ç±»åž‹ï¼Œåœ¨å¦‚ä¸‹å›¾æ‰€ç¤ºå›¾ç‰‡æ¥è‡ªäºŽ Zuul GitHubè¿™4ç§è¿‡æ»¤å™¨å¤„äºŽä¸åŒçš„ç”Ÿå‘½å‘¨æœŸï¼Œæ‰€ä»¥å…¶èŒè´£ä¹Ÿå„ä¸ç›¸åŒï¼šPREï¼šPREè¿‡æ»¤å™¨ç”¨äºŽå°†è¯·æ±‚è·¯å¾„ä¸Žé…ç½®çš„è·¯ç”±è§„åˆ™è¿›è¡ŒåŒ¹é…ï¼Œä»¥æ‰¾åˆ°éœ€è¦è½¬å‘çš„ç›®æ ‡åœ°å€ï¼Œå¹¶åšä¸€äº›å‰ç½®åŠ å·¥ï¼Œæ¯”å¦‚è¯·æ±‚çš„æ ¡éªŒç­‰ï¼›ROUTINGï¼šROUTINGè¿‡æ»¤å™¨ç”¨äºŽå°†å¤–éƒ¨è¯·æ±‚è½¬å‘åˆ°å…·ä½“æœåŠ¡å®žä¾‹ä¸ŠåŽ»ï¼›POSTï¼šPOSTè¿‡æ»¤å™¨ç”¨äºŽå°†å¾®æœåŠ¡çš„å“åº”ä¿¡æ¯è¿”å›žåˆ°å®¢æˆ·ç«¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§å¯ä»¥å¯¹è¿”å›žæ•°æ®è¿›è¡ŒåŠ å·¥å¤„ç†ï¼›ERRORï¼šä¸Šè¿°çš„è¿‡ç¨‹å‘ç”Ÿå¼‚å¸¸åŽå°†è°ƒç”¨ERRORè¿‡æ»¤å™¨ã€‚ERRORè¿‡æ»¤å™¨æ•èŽ·åˆ°å¼‚å¸¸åŽéœ€è¦å°†å¼‚å¸¸ä¿¡æ¯è¿”å›žç»™å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥æœ€ç»ˆè¿˜æ˜¯ä¼šè°ƒç”¨POSTè¿‡æ»¤å™¨ã€‚æ ¸å¿ƒè¿‡æ»¤å™¨Spring Cloud Zuulä¸ºå„ä¸ªç”Ÿå‘½å‘¨æœŸé˜¶æ®µå®žçŽ°äº†ä¸€æ‰¹è¿‡æ»¤å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šè¿™äº›è¿‡æ»¤å™¨çš„ä¼˜å…ˆçº§å’Œä½œç”¨å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šç”Ÿå‘½å‘¨æœŸä¼˜å…ˆçº§è¿‡æ»¤å™¨åŠŸèƒ½æè¿°pre-3ServletDetectionFilteræ ‡è®°å¤„ç†Servletçš„ç±»åž‹pre-2Servlet30WrapperFilteråŒ…è£…HttpServletRequestè¯·æ±‚pre-1FormBodyWrapperFilteråŒ…è£…è¯·æ±‚ä½“route1DebugFilteræ ‡è®°è°ƒè¯•æ ‡å¿—route5PreDecorationFilterå¤„ç†è¯·æ±‚ä¸Šä¸‹æ–‡ä¾›åŽç»­ä½¿ç”¨route10RibbonRoutingFilterserviceIdè¯·æ±‚è½¬å‘route100SimpleHostRoutingFilterurlè¯·æ±‚è½¬å‘route500SendForwardFilterforwardè¯·æ±‚è½¬å‘post0SendErrorFilterå¤„ç†æœ‰é”™è¯¯çš„è¯·æ±‚å“åº”post1000SendResponseFilterå¤„ç†æ­£å¸¸çš„è¯·æ±‚å“åº”å…¶ä¸­ä¼˜å…ˆçº§æ•°å­—è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚è¦å…³é—­è¿™äº›è¿‡æ»¤å™¨å¯ä»¥åœ¨application.ymlä¸­æŒ‰ç…§æ ¼å¼zuul.&lt;SimpleClassName&gt;.&lt;filterType&gt;.disable=trueé…ç½®å³å¯ã€‚æ¯”å¦‚å…³é—­SendResponseFilterè¿‡æ»¤å™¨ï¼š12345zuul: SendResponseFilter: post: disable: trueè‡ªå®šä¹‰Zuulè¿‡æ»¤å™¨æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªPreSendForwardFilterç”¨äºŽèŽ·å–è¯·æ±‚è½¬å‘å‰çš„ä¸€äº›ä¿¡æ¯ï¼š1234567891011121314151617181920212223import com.netflix.zuul.ZuulFilter;public class PreSendForwardFilter extends ZuulFilter &#123; @Override public String filterType() &#123; return null; &#125; @Override public int filterOrder() &#123; return 0; &#125; @Override public boolean shouldFilter() &#123; return false; &#125; @Override public Object run() &#123; return null; &#125;&#125;å¯ä»¥çœ‹åˆ°è‡ªå®šä¹‰Zuulè¿‡æ»¤å™¨åªéœ€è¦ç»§æ‰¿ZuulFilterï¼Œç„¶åŽå®žçŽ°ä»¥ä¸‹å››ä¸ªæŠ½è±¡æ–¹æ³•å³å¯ï¼šfilterTypeï¼šå¯¹åº”Zuulç”Ÿå‘½å‘¨æœŸçš„å››ä¸ªé˜¶æ®µï¼špreã€postã€routeå’Œerrorï¼›filterOrderï¼šè¿‡æ»¤å™¨çš„ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼›shouldFilterï¼šæ–¹æ³•è¿”å›žbooleanç±»åž‹ï¼Œtrueæ—¶è¡¨ç¤ºæ˜¯å¦æ‰§è¡Œè¯¥è¿‡æ»¤å™¨çš„runæ–¹æ³•ï¼Œfalseåˆ™è¡¨ç¤ºä¸æ‰§è¡Œï¼›runï¼šè¿‡æ»¤å™¨çš„è¿‡æ»¤é€»è¾‘ã€‚ç»§ç»­å®Œå–„PreSendForwardFilterï¼š123456789101112131415161718192021222324252627282930@Componentpublic class PreSendForwardFilter extends ZuulFilter &#123; private Logger log = LoggerFactory.getLogger(this.getClass()); @Override public String filterType() &#123; return "pre"; &#125; @Override public int filterOrder() &#123; return 1; &#125; @Override public boolean shouldFilter() &#123; return true; &#125; @Override public Object run() &#123; RequestContext requestContext = RequestContext.getCurrentContext(); HttpServletRequest request = requestContext.getRequest(); String host = request.getRemoteHost(); String method = request.getMethod(); String uri = request.getRequestURI(); log.info("è¯·æ±‚URIï¼š&#123;&#125;ï¼ŒHTTP Methodï¼š&#123;&#125;ï¼Œè¯·æ±‚IPï¼š&#123;&#125;", uri, method, host); return null; &#125;&#125;è¿™æ—¶å€™è®¿é—®http://localhost:12580/api-a/helloï¼ŒæŽ§åˆ¶å°å°†æ‰“å°å‡ºï¼š1c.e.demo.filter.PreSendForwardFilter : è¯·æ±‚URIï¼š/api-a/helloï¼ŒHTTP Methodï¼šGETï¼Œè¯·æ±‚IPï¼š0:0:0:0:0:0:0:1æºç é“¾æŽ¥ https://github.com/wuyouzhuguli/SpringAll/tree/master/39.Spring-Cloud-Zuul-Routerå‚è€ƒèµ„æ–™ï¼š Spring Cloudå¾®æœåŠ¡å®žæˆ˜]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Cloud</tag>
        <tag>Zuul</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud Feign å£°æ˜Žå¼æœåŠ¡è°ƒç”¨]]></title>
    <url>%2FSpring-Cloud-Feign.html</url>
    <content type="text"><![CDATA[å‰é¢æˆ‘ä»¬åˆ†åˆ«é€šè¿‡Spring Cloud Ribbonå’ŒSpring Cloud Hystrixå®žçŽ°äº†å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å’ŒæœåŠ¡å®¹é”™ï¼Œè€ŒSpring Cloud Feignä¸ä½†æ•´åˆäº†è¿™ä¸¤è€…çš„åŠŸèƒ½ï¼Œè€Œä¸”è¿˜æä¾›äº†ä¸€ç§æ¯”Ribbonæ›´ç®€å•çš„æœåŠ¡è°ƒç”¨æ–¹å¼ â€”â€”â€” å£°æ˜Žå¼æœåŠ¡è°ƒç”¨ã€‚åœ¨Spring Cloud Feignä¸­ç¼–å†™æœåŠ¡è°ƒç”¨ä»£ç éžå¸¸ç®€å•ï¼Œå‡ ä¹Žå¯ä»¥ç›´æŽ¥å°†æœåŠ¡æä¾›è€…çš„ä»£ç å¤åˆ¶è¿‡æ¥ï¼Œæ”¹ä¸ºæŽ¥å£å³å¯ï¼Œä¸‹é¢é€šè¿‡ä¾‹å­æ¥æ¼”ç¤ºè¿™ä¸ªç‰¹æ€§ã€‚æ­å»ºFeign Consumeråˆ›å»ºä¸€ä¸ªæ–°çš„Spring Bootåº”ç”¨ï¼Œç‰ˆæœ¬ä¸º1.5.13.RELEASEï¼ŒartifactIdæ”¹ä¸ºFeign-Consumerï¼Œå¹¶å¼•å…¥ä¸‹é¢è¿™äº›ä¾èµ–ï¼š12345678910111213141516171819202122232425&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-feign&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;é™¤äº†spring-cloud-starter-feignä¾èµ–å¤–ï¼Œæˆ‘ä»¬è¿˜å¼•å…¥äº†spring-cloud-starter-eurekaï¼Œç›®çš„æ˜¯ä¸ºäº†ä»ŽEurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒèŽ·å–æœåŠ¡ã€‚åœ¨Spring Bootçš„å…¥å£ç±»ä¸­åŠ å…¥@EnableFeignClientså’Œ@EnableDiscoveryClientæ³¨è§£ï¼Œç”¨äºŽå¼€å¯Spring Cloud Feignå’ŒæœåŠ¡æ³¨å†Œä¸Žå‘çŽ°ï¼š12345678@EnableDiscoveryClient@EnableFeignClients@SpringBootApplicationpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;åœ¨å‰é¢å‡ èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ›¾åœ¨æœåŠ¡æä¾›è€…Eureka-Clientä¸­å®šä¹‰äº†ä¸€ä¸ªUserControllerï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314151617181920212223242526272829303132333435@RestController@RequestMapping("user")public class UserController &#123; private Logger log = LoggerFactory.getLogger(this.getClass()); @GetMapping("/&#123;id:\\d+&#125;") public User get(@PathVariable Long id) &#123; log.info("èŽ·å–ç”¨æˆ·idä¸º " + id + "çš„ä¿¡æ¯"); return new User(id, "mrbird", "123456"); &#125; @GetMapping public List&lt;User&gt; get() &#123; List&lt;User&gt; list = new ArrayList&lt;&gt;(); list.add(new User(1L, "mrbird", "123456")); list.add(new User(2L, "scott", "123456")); log.info("èŽ·å–ç”¨æˆ·ä¿¡æ¯ " + list); return list; &#125; @PostMapping public void add(@RequestBody User user) &#123; log.info("æ–°å¢žç”¨æˆ·æˆåŠŸ " + user); &#125; @PutMapping public void update(@RequestBody User user) &#123; log.info("æ›´æ–°ç”¨æˆ·æˆåŠŸ " + user); &#125; @DeleteMapping("/&#123;id:\\d+&#125;") public void delete(@PathVariable Long id) &#123; log.info("åˆ é™¤ç”¨æˆ·æˆåŠŸ " + id); &#125;&#125;åœ¨Spring Cloud Ribbonä¸­è®¿é—®è¿™äº›æœåŠ¡éœ€è¦é€šè¿‡RestTemplateå¯¹è±¡æ¥å®žçŽ°ï¼Œå¹¶ä¸”å‚æ•°ç»‘å®šçš„è¿‡ç¨‹ä¹Ÿæ¯”è¾ƒç¹çã€‚Spring Cloud Feignå¯¹è¿™ä¸ªæ­¥éª¤è¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼Œåœ¨Feign Consumerä¸­è°ƒç”¨è¿™äº›æœåŠ¡åªéœ€è¦å®šä¹‰ä¸€ä¸ªUserServiceæŽ¥å£ï¼Œç„¶åŽå°†UserControllerä¸­çš„ä»£ç å¤åˆ¶è¿‡å¹¶å°†æ–¹æ³•ä½“åŽ»æŽ‰å³å¯ï¼Œå¦‚ï¼š123456789101112131415161718@FeignClient("Server-Provider")public interface UserService &#123; @GetMapping("user/&#123;id&#125;") public User get(@PathVariable("id") Long id); @GetMapping("user") public List&lt;User&gt; get(); @PostMapping("user") public void add(@RequestBody User user); @PutMapping("user") public void update(@RequestBody User user); @DeleteMapping("user/&#123;id&#125;") public void delete(@PathVariable("id") Long id);&#125;å¯¹æ¯”Feign Consumerä¸­çš„UserServiceå’ŒEureka-Clientä¸­UserControllerä»£ç ï¼Œä¸¤è€…æ˜¯ä¸æ˜¯å¾ˆç›¸ä¼¼ï¼Ÿåœ¨UserServiceä¸­ï¼Œæˆ‘ä»¬é€šè¿‡@FeignClient(&quot;Server-Provider&quot;)æ³¨è§£æ¥èŽ·å–æˆ‘ä»¬éœ€è¦çš„æœåŠ¡ï¼Œå…¶ä¸­Server-Providerä¸åŒºåˆ†å¤§å°å†™ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å®šä¹‰å„å‚æ•°ç»‘å®šæ—¶ï¼Œ@RequestParamã€@RequestHeaderç­‰å¯ ä»¥æŒ‡å®šå‚æ•°åç§°çš„æ³¨è§£ï¼Œå®ƒä»¬çš„valueåƒä¸‡ä¸èƒ½å°‘ã€‚åœ¨SpringMVC ç¨‹åºä¸­ï¼Œè¿™äº›æ³¨è§£ä¼šæ ¹æ®å‚æ•°åæ¥ä½œä¸ºé»˜è®¤å€¼ï¼Œä½†æ˜¯åœ¨Feignä¸­ç»‘å®šå‚æ•°å¿…é¡»é€šè¿‡valueå±žæ€§æ¥æŒ‡æ˜Žå…·ä½“çš„å‚æ•°åï¼Œä¸ç„¶ä¼šæŠ›å‡ºillegalStateExceptionå¼‚å¸¸ï¼Œvalue å±žæ€§ä¸èƒ½ä¸ºç©ºã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬åœ¨Feign Consumerä¸­å®šä¹‰ä¸€ä¸ªTestControllerï¼Œæ¥è°ƒç”¨UserServiceä¸­å®šä¹‰çš„æœåŠ¡ï¼š123456789101112131415161718192021222324252627282930313233@RestControllerpublic class TestController &#123; @Autowired private UserService userService; @GetMapping("user/&#123;id&#125;") public User getUser(@PathVariable Long id) &#123; return userService.get(id); &#125; @GetMapping("user") public List&lt;User&gt; getUsers() &#123; return userService.get(); &#125; @PostMapping("user") public void addUser() &#123; User user = new User(1L, "mrbird", "123456"); userService.add(user); &#125; @PutMapping("user") public void updateUser() &#123; User user = new User(1L, "mrbird", "123456"); userService.update(user); &#125; @DeleteMapping("user/&#123;id&#125;") public void deleteUser(@PathVariable Long id) &#123; userService.delete(id); &#125;&#125;æœ€åŽé…ç½®ä¸€ä¸‹application.ymlï¼š1234567891011server: port: 9000 spring: application: name: Server-Consumer eureka: client: serviceUrl: defaultZone: http://mrbird:123456@peer1:8080/eureka/,http://mrbird:123456@peer2:8081/eureka/ä¸Šé¢é…ç½®æŒ‡å®šäº†EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼Œç”¨äºŽèŽ·å–æœåŠ¡ã€‚æœ€åŽæˆ‘ä»¬åˆ†åˆ«å¯åŠ¨ä»¥ä¸‹æœåŠ¡ï¼šå¯åŠ¨Eureka-Serveré›†ç¾¤ï¼Œç«¯å£å·ä¸º8080å’Œ8081ï¼›å¯åŠ¨ä¸¤ä¸ªEureka-Clientï¼Œç«¯å£å·ä¸º8082å’Œ8083ï¼›å¯åŠ¨Feign-Consumerï¼Œç«¯å£å·ä¸º9000ã€‚å¤šæ¬¡è®¿é—®http://localhost:9000/user/1æœåŠ¡ï¼Œè§‚å¯Ÿ8082å’Œ8083æœåŠ¡çš„æŽ§åˆ¶å°ï¼š12345678910111213142018-06-10 14:27:38.105 INFO 10120 --- [nio-8082-exec-8] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:39.989 INFO 10120 --- [nio-8082-exec-7] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:41.197 INFO 10120 --- [nio-8082-exec-6] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:41.802 INFO 10120 --- [nio-8082-exec-5] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:42.224 INFO 10120 --- [nio-8082-exec-4] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:42.865 INFO 10120 --- [nio-8082-exec-3] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:43.296 INFO 10120 --- [nio-8082-exec-2] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:38.358 INFO 9104 --- [nio-8083-exec-8] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:40.754 INFO 9104 --- [nio-8083-exec-7] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:41.397 INFO 9104 --- [nio-8083-exec-6] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:42.006 INFO 9104 --- [nio-8083-exec-5] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:42.445 INFO 9104 --- [nio-8083-exec-4] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-10 14:27:43.073 INFO 9104 --- [nio-8083-exec-3] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯ä½¿ç”¨Feignå®žçŽ°çš„æ¶ˆè´¹è€…ï¼Œä¾ç„¶æ˜¯åˆ©ç”¨Ribbonç»´æŠ¤äº†é’ˆå¯¹Seriver-Providerçš„æœåŠ¡åˆ—è¡¨ä¿¡æ¯ï¼Œå¹¶ä¸”é€šè¿‡è½®è¯¢å®žçŽ°äº†å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ã€‚è€Œä¸ŽRibbonä¸åŒçš„æ˜¯ï¼Œé€šè¿‡Feignæˆ‘ä»¬åªéœ€å®šä¹‰æœåŠ¡ç»‘å®šæŽ¥å£ï¼Œä»¥å£°æ˜Žå¼çš„æ–¹æ³•ï¼Œä¼˜é›…è€Œç®€å•åœ°å®žçŽ°äº†æœåŠ¡è°ƒç”¨ã€‚Ribbonç›¸å…³é…ç½®Spring Cloud Feignå†…éƒ¨çš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡æ˜¯é€šè¿‡Ribbonæ¥å®žçŽ°çš„ï¼Œæ‰€ä»¥åœ¨Spring Cloud Feignä¸­é…ç½®Ribbonï¼Œå’Œä¹‹å‰åœ¨Spring Cloud Ribbonå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ä¸­ä»‹ç»çš„Spring Cloud Ribboné…ç½®ä¸€æ ·ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚Hystrixç›¸å…³é…ç½®è¦åœ¨Spring Cloud Feignä¸­å¼€å¯Hystrixï¼Œå¯ä»¥åœ¨ymlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š123feign: hystrix: enabled: trueå‰©ä¸‹çš„Hystrixé…ç½®å’Œä¹‹å‰åœ¨Spring Cloud HystrixæœåŠ¡å®¹é”™ä¸­ä»‹ç»çš„Hystrixå±žæ€§é…ç½®ä¸€æ ·ã€‚åœ¨Spring Cloud Feignä¸­é…ç½®æœåŠ¡é™çº§å’Œåœ¨Spring Cloud Hystrixä¸­é…ç½®æœåŠ¡é™çº§åŒºåˆ«å¾ˆå¤§ï¼Œä¸‹é¢å…·ä½“æ¥çœ‹ä¸‹æ€Žä¹ˆåœ¨Feign-Consumerä¸­é…ç½®æœåŠ¡é™çº§ã€‚å®šä¹‰ä¸€ä¸ªç”¨äºŽå¤„ç†æœåŠ¡é™çº§æ–¹æ³•çš„ç±»UserServiceFallbackï¼Œå¹¶ä¸”å®žçŽ°ä¸Šé¢å®šä¹‰çš„UserServiceæŽ¥å£ï¼š1234567891011121314151617181920212223242526272829@Componentpublic class UserServiceFallback implements UserService &#123; private Logger log = LoggerFactory.getLogger(this.getClass()); @Override public User get(Long id) &#123; return new User(-1L, "default", "123456"); &#125; @Override public List&lt;User&gt; get() &#123; return null; &#125; @Override public void add(User user) &#123; log.info("test fallback"); &#125; @Override public void update(User user) &#123; log.info("test fallback"); &#125; @Override public void delete(Long id) &#123; log.info("test fallback"); &#125;&#125;åœ¨UserServiceçš„ä¸­é€šè¿‡@FeignClientæ³¨è§£çš„fallbackå±žæ€§æ¥æŒ‡å®šå¯¹åº”çš„æœåŠ¡é™çº§å®žçŽ°ç±»:1234@FeignClient(value = "Server-Provider", fallback = UserServiceFallback.class)public interface UserService &#123; ...&#125;é‡å¯Feign-Consumerï¼Œå¹¶å…³é—­Eureka ClientæœåŠ¡ï¼Œè®¿é—®http://localhost:9000/user/1ï¼Œç”±äºŽEureka-ClientæœåŠ¡æä¾›è€…éƒ½å…³é—­äº†ï¼Œæ‰€ä»¥è¿™é‡Œä¼šç›´æŽ¥è§¦å‘æœåŠ¡é™çº§ï¼Œå“åº”ç»“æžœå¦‚ä¸‹ï¼šå¯çœ‹åˆ°å“åº”ä¿¡æ¯ä¸ºæœåŠ¡é™çº§æ–¹æ³•ä¸­çš„è¿”å›žç»“æžœã€‚å…¶ä½™Feigné…ç½®é™¤äº†Ribbonå’ŒHystrixé…ç½®ä¹‹å¤–ï¼ŒFeignä¹Ÿæœ‰ä¸€äº›è‡ªä¸ªå„¿çš„é…ç½®ã€‚è¯·æ±‚åŽ‹ç¼©Spring Cloud Feignæ”¯æŒå¯¹è¯·æ±‚ä¸Žå“åº”è¿›è¡ŒGZIPåŽ‹ç¼©ï¼Œä»¥å‡å°‘é€šä¿¡è¿‡ç¨‹ä¸­çš„æ€§èƒ½æŸè€—ï¼š123456feign: compression: request: enabled: true response: enabled: trueåŒæ—¶ï¼Œæˆ‘ä»¬è¿˜èƒ½å¯¹è¯·æ±‚åŽ‹ç¼©åšä¸€äº›æ›´ç»†è‡´çš„è®¾ç½®ï¼Œæ¯”å¦‚ä¸‹é¢çš„é…ç½®å†…å®¹æŒ‡å®šäº†åŽ‹ç¼©çš„è¯·æ±‚æ•°æ®ç±»åž‹ï¼Œå¹¶è®¾ç½®äº†è¯·æ±‚åŽ‹ç¼©çš„å¤§å°ä¸‹é™ï¼Œåªæœ‰è¶…è¿‡è¿™ä¸ªå¤§å°çš„è¯·æ±‚æ‰ä¼šå¯¹å…¶è¿›è¡ŒåŽ‹ç¼©:123456feign: compression: request: enabled: true mime-types: text/xml,application/xml,application/json min-request-size: 2048æ—¥å¿—é…ç½®Feignæä¾›äº†æ—¥å¿—æ‰“å°çš„åŠŸèƒ½ï¼ŒFeignçš„æ—¥å¿—çº§åˆ«åˆ†ä¸ºå››ç§ï¼šNONE: ä¸è®°å½•ä»»ä½•ä¿¡æ¯ã€‚BASIC: ä»…è®°å½•è¯·æ±‚æ–¹æ³•ã€URLä»¥åŠå“åº”çŠ¶æ€ç å’Œæ‰§è¡Œæ—¶é—´ã€‚HEADERS: é™¤äº†è®°å½•BASICçº§åˆ«çš„ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜ä¼šè®°å½•è¯·æ±‚å’Œå“åº”çš„å¤´ä¿¡æ¯ã€‚FULL: è®°å½•æ‰€æœ‰è¯·æ±‚ä¸Žå“åº”çš„æ˜Žç»†ï¼ŒåŒ…æ‹¬å¤´ä¿¡æ¯ã€è¯·æ±‚ä½“ã€å…ƒæ•°æ®ç­‰ã€‚æ—¥å¿—çº§åˆ«é»˜è®¤ä¸ºNONEï¼Œè¦æ”¹å˜çº§åˆ«å¯ä»¥åœ¨å…¥å£ç±»ä¸­å®šä¹‰ä¸€ä¸ªæ—¥å¿—é…ç½®Beanï¼š123456789101112@EnableDiscoveryClient@EnableFeignClients@SpringBootApplicationpublic class DemoApplication &#123; @Bean Logger.Level feignLoggerLevel() &#123; return Logger.Level.FULL; &#125; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;ç„¶åŽåœ¨ymlä¸­é…ç½®Feignå®¢æˆ·ç«¯çš„æ—¥å¿—çº§åˆ«ä¸ºdebugï¼ŒFeignæ—¥å¿—è®°å½•ä»…å“åº”debugçº§åˆ«ï¼š1234567logging: level: com: example: demo: service: UserService: debugé‡å¯é¡¹ç›®è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°æŽ§åˆ¶å°æ‰“å°æ—¥å¿—å¦‚ä¸‹ï¼š12345678[UserService#get] &lt;--- HTTP/1.1 200 (506ms)[UserService#get] content-type: application/json;charset=UTF-8[UserService#get] date: Stu, 10 Jun 2018 01:44:45 GMT[UserService#get] transfer-encoding: chunked[UserService#get] [UserService#get] &#123;&quot;id&quot;:1,&quot;username&quot;:&quot;mrbird&quot;,&quot;password&quot;:&quot;123456&quot;&#125;[UserService#get] &lt;--- END HTTP (48-byte body)Flipping property: Server-Provider.ribbon.ActiveConnectionsLimit to use NEXT property: niws.loadbalancer.availabilityFilteringRule.activeConnectionsLimit = 2147483647æºç é“¾æŽ¥ https://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/33.Spring-Cloud-Feign-Declarative-REST-Client]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Cloud</tag>
        <tag>Feign</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud Hystrix Dashboardä»ªè¡¨ç›˜]]></title>
    <url>%2FSpring-Cloud-Hystrix-Dashboard.html</url>
    <content type="text"><![CDATA[Hystrixæä¾›äº†Hystrix Dashboardæ¥å®žæ—¶ç›‘æŽ§Hystrixçš„è¿è¡Œæƒ…å†µï¼Œé€šè¿‡Hystrix Dashboardåé¦ˆçš„å®žæ—¶ä¿¡æ¯ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå‘çŽ°ç³»ç»Ÿä¸­å­˜åœ¨çš„é—®é¢˜ï¼Œä»Žè€ŒåŠæ—¶åœ°é‡‡å–åº”å¯¹æŽªæ–½ã€‚Spring Cloudå¯¹Hystrix Dashboardè¿›è¡Œäº†æ•´åˆï¼Œè¿™é‡Œå°†ä»‹ç»å¦‚ä½•ä½¿ç”¨Hystrix Dashboardç›‘æŽ§å•ä¸ªå’Œå¤šä¸ªHystrixå®žä¾‹ã€‚ç›‘æŽ§å•ä¸ªHystrixå®žä¾‹åˆ›å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼ŒSpring Bootç‰ˆæœ¬ä¸º1.5.13.RELEASEï¼ŒartifactIdå¡«Hystrix-Dashboardï¼Œç„¶åŽå¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š12345678910111213141516171819202122232425&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-hystrix-dashboard&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;ç¨å¾®é…ç½®ä¸‹ymlï¼š12345spring: application: name: Hystrix-Dashboardserver: port: 9002ç„¶åŽåœ¨å…¥å£ç±»ä¸ŠåŠ å…¥æ³¨è§£@EnableHystrixDashboardæ¥å¯ç”¨Hystrix Dashboardçš„åŠŸèƒ½ã€‚å¯åŠ¨é¡¹ç›®è®¿é—®http://localhost:9002/hystrixå°±å¯ä»¥çœ‹åˆ°å¦‚ä¸‹é¡µé¢äº†ï¼šå¯ä»¥çœ‹åˆ°é¡µé¢ä¸Šæä¾›äº†ä¸‰ç§ç›‘æŽ§çš„æ¨¡å¼ï¼šCluster via Turbine(default cluster)ã€Cluster via Turbine(custom cluster)å’ŒSingle Hystrix Appï¼šå‰ä¸¤ç§éƒ½æ˜¯é›†ç¾¤ç›‘æŽ§çš„ï¼Œä¸‹é¢å†ä»‹ç»ï¼Œè¿™é‡Œå…ˆä»‹ç»ç¬¬ä¸‰ç§å•æœºç›‘æŽ§ã€‚åœ¨ä¸Šä¸€èŠ‚Spring Cloud HystrixæœåŠ¡å®¹é”™çš„åŸºç¡€ä¸Šï¼Œè¦å¯¹Ribbon-Consumerè¿›è¡Œç›‘æŽ§è¿˜å¿…é¡»åŠ å…¥spring-boot-starter-actuatorä¾èµ–ï¼Œç„¶åŽåˆ†åˆ«å¯åŠ¨Eureka-Serveé›†ç¾¤ï¼ŒEureka-Clientï¼ŒRibbon-Consumerï¼Œå¯åŠ¨åŽåœ¨åˆšåˆšçš„ç›‘æŽ§é¡µé¢ä¸Šè¾“å…¥ï¼šhttp://localhost:9000/hystrix.stream ï¼Œç„¶åŽå¾€Ribbon-Consumerå‘å‡ æ¡è¯·æ±‚ï¼Œä¾¿å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç›‘æŽ§é¡µé¢ï¼šè‡³äºŽè¿™å¼ å›¾ä¸Šé¢çš„æŒ‡æ ‡ä»£è¡¨ä»€ä¹ˆå«ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒå®˜æ–¹ç»™çš„å›¾ä¾‹ï¼šåˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å®žçŽ°äº†ä½¿ç”¨Hystrix Dashboardå¯¹å•ä¸ªHystrixå®žä¾‹è¿›è¡Œç›‘æŽ§äº†ï¼Œç„¶è€Œå®žé™…ä¸­ä¸€èˆ¬ä¼šæœ‰å¤šä¸ªHystrixå®žä¾‹éœ€è¦åŒæ—¶è¿›è¡Œç›‘æŽ§ï¼Œä¸‹é¢æˆ‘ä»¬ä½¿ç”¨Turbineæ¥å®žçŽ°é›†ç¾¤ç›‘æŽ§ã€‚Turbineé›†ç¾¤ç›‘æŽ§ä½¿ç”¨Turbineå®žçŽ°å¯¹Hystrixçš„é›†ç¾¤ç›‘æŽ§çš„æ€è·¯æ˜¯ï¼šTurbineä»ŽEurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒé€šè¿‡æœåŠ¡åRibbon-ConsumerèŽ·å–æœåŠ¡å®žä¾‹ï¼Œç„¶åŽHystrix Dashboardå¯¹Turbineè¿›è¡Œç›‘æŽ§ï¼Œè¿™æ ·å°±å®žçŽ°äº†Hystrix DashboardåŒæ—¶å¯¹å¤šä¸ªHystrixï¼ˆRibbon-consumerï¼‰å®žä¾‹åŒæ—¶è¿›è¡Œç›‘æŽ§çš„åŠŸèƒ½ã€‚åˆ›å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼ŒSpring Bootç‰ˆæœ¬ä¸º1.5.13.RELEASEï¼ŒartifactIdå¡«Turbineï¼Œç„¶åŽå¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š1234567891011121314151617181920212223242526&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-turbine&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;ç„¶åŽåœ¨å…¥å£ç±»ä¸­åŠ å…¥@EnableTurbineæ¥å¼€å¯Turbineçš„åŠŸèƒ½ï¼Œå¹¶ä¸”åŠ å…¥@EnableDiscoveryClientæ³¨è§£ï¼Œå¼€å¯æœåŠ¡èŽ·å–åŠŸèƒ½ã€‚æœ€åŽåœ¨ymlä¸­åŠ å…¥ä¸€äº›é…ç½®ï¼š1234567891011121314spring: application: name: Turbineserver: port: 9003eureka: client: serviceUrl: defaultZone: http://mrbird:123456@peer1:8080/eureka/,http://mrbird:123456@peer2:8081/eureka/turbine: app-config: Ribbon-Consumer cluster-name-expression: new String('default') combine-host-port: trueä¸Šé¢é…ç½®äº†Eureka-Serverçš„é›†ç¾¤åœ°å€ï¼Œå¹¶ä¸”æŒ‡å®šäº†ç«¯å£å·ä¸º9003ï¼Œåº”ç”¨åç§°ä¸ºTurbineã€‚å‰©ä¸‹çš„é…ç½®ä¸ºTurbineçš„é…ç½®ï¼Œå«ä¹‰å¦‚ä¸‹ï¼šturbine.app-configæŒ‡å®šäº†éœ€è¦æ”¶é›†ç›‘æŽ§ä¿¡æ¯çš„æœåŠ¡åï¼Œè¿™é‡Œä¸ºRibbon-Consumerï¼›turbine.cluster-name-expressionå‚æ•°æŒ‡å®šäº†é›†ç¾¤åç§°ä¸ºdefault, å½“æœåŠ¡æ•°é‡éžå¸¸å¤šçš„æ—¶å€™ï¼Œå¯ä»¥å¯åŠ¨å¤šä¸ªTurbine æœåŠ¡æ¥æž„å»ºä¸åŒçš„èšåˆé›†ç¾¤ï¼Œ è€Œè¯¥å‚æ•°å¯ä»¥ç”¨æ¥åŒºåˆ†è¿™äº›ä¸åŒçš„èšåˆé›†ç¾¤ï¼ŒåŒæ—¶è¯¥å‚æ•°å€¼å¯ä»¥åœ¨Hystrixä»ªè¡¨ç›˜ä¸­ç”¨æ¥å®šä½ä¸åŒçš„èšåˆé›†ç¾¤ï¼Œåªéœ€åœ¨Hystrix Streamçš„URLä¸­é€šè¿‡clusterå‚æ•°æ¥æŒ‡å®š(å³Cluster via Turbine(custom cluster))ï¼›turbine.combine-host-portå‚æ•°è®¾ç½®ä¸ºä¸ƒrue, å¯ä»¥è®©åŒä¸€ä¸»æœºä¸Šçš„æœåŠ¡é€šè¿‡ä¸»æœºåä¸Žç«¯å£å·çš„ç»„åˆæ¥è¿›è¡ŒåŒºåˆ†ï¼Œ é»˜è®¤æƒ…å†µä¸‹ä¼šä»¥hostæ¥åŒºåˆ†ä¸åŒçš„æœåŠ¡ï¼Œè¿™ä¼šä½¿å¾—åœ¨æœ¬åœ°è°ƒè¯•çš„æ—¶å€™ï¼Œæœ¬æœºä¸Šçš„ä¸åŒæœåŠ¡èšåˆæˆä¸€ä¸ªæœåŠ¡æ¥ç»Ÿè®¡ã€‚é…ç½®å®Œæ¯•åŽï¼Œæˆ‘ä»¬åˆ†åˆ«å¯åŠ¨ä¸‹é¢è¿™äº›æœåŠ¡ï¼šå¯åŠ¨Eureka-Serveré›†ç¾¤ï¼Œç«¯å£å·ä¸º8080å’Œ8081ï¼›å¯åŠ¨ä¸€ä¸ªEureka-Clientï¼Œç«¯å£å·ä¸º8082ï¼›å¯åŠ¨ä¸¤ä¸ªRibbon-Consumerï¼Œç«¯å£å·ä¸º9000å’Œ9001ï¼›å¯åŠ¨TurbineæœåŠ¡ï¼Œç«¯å£å·ä¸º9003ï¼›æœ€åŽå¯åŠ¨Hystrix-DashboardæœåŠ¡ï¼Œç«¯å£å·ä¸º9002ã€‚å¯åŠ¨å¥½è¿™äº›æœåŠ¡åŽï¼Œè®¿é—®Eureka-serverçš„http://localhost:8080å¯çœ‹åˆ°è¿™äº›å®žä¾‹ï¼šè¯´æ˜ŽæœåŠ¡éƒ½å·²å¯åŠ¨æˆåŠŸï¼Œæˆ‘ä»¬è§‚å¯ŸTurbineçš„æŽ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æ—¥å¿—ä¿¡æ¯ï¼šå³Turbineå·²ç»ä»ŽæœåŠ¡æ³¨å†Œä¸­å¿ƒæ‰¾åˆ°äº†9000å’Œ9001ç«¯å£çš„Ribbon-Consumerå®žä¾‹ã€‚è¿™æ—¶å€™æˆ‘ä»¬è®¿é—®Hystrix-dashboardçš„åœ°å€http://localhost:9002/hystrixï¼Œåœ¨é¡µé¢çš„åœ°å€æ è¾“å…¥http://localhost:9003/turbine.streamï¼Œç„¶åŽåˆ†åˆ«å¾€9000å’Œ9001ç«¯å£çš„Ribbon-Consumerå®žä¾‹å‘é€ä¸€äº›è¯·æ±‚ï¼Œè¿™æ—¶å€™å¯ä»¥çœ‹åˆ°Dashboardçš„ç”»é¢å¦‚ä¸‹ï¼šå¯ä»¥çœ‹åˆ°Hostsçš„å€¼å·²ç»æ˜¯2äº†ï¼Œå¹¶ä¸”ç”±äºŽä¸¤ä¸ªHystrixå®žä¾‹çš„åç§°éƒ½æ˜¯Ribbon-Consumerï¼Œæ‰€ä»¥Turbine ä¼šå°†ç›¸åŒåç§°çš„æœåŠ¡ä½œä¸ºæ•´ä½“æ¥çœ‹å¾…ï¼Œæ±‡æ€»æˆä¸€ä¸ªç›‘æŽ§å›¾ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/31.Spring-Cloud-Hystrix-Dashboard-Turbineä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶é™¤äº†ç›´æŽ¥ç”¨Turbineä»ŽæœåŠ¡æ³¨å†Œä¸­å¿ƒèŽ·å–Ribbon-Consumerå®žä¾‹ç›‘æŽ§æ•°æ®å¤–ï¼Œè¿˜å¯ä»¥å°†Ribbon-Consumerçš„ç›‘æŽ§æ•°æ®å‘é€åˆ°æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œç„¶åŽTurbineä»Žæ¶ˆæ¯ä¸­é—´ä»¶ä¸­èŽ·å–ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©RabbitMQä½œä¸ºæ¶ˆæ¯ä¸­é—´ä»¶ã€‚åœ¨å®‰è£…RabbitMQä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…Erlang/OTPï¼Œä¸‹è½½åœ°å€ä¸ºï¼šhttp://www.erlang.org/downloads/ï¼Œä¸‹è½½exeæ–‡ä»¶å®‰è£…å³å¯ã€‚å®‰è£…å®Œæ¯•åŽï¼Œä¸‹è½½RabbitMQï¼Œä¸‹è½½åœ°å€ä¸ºhttp://www.rabbitmq.com/install-windows.htmlï¼Œä¸‹è½½exeæ–‡ä»¶å®‰è£…å³å¯ã€‚å®‰è£…å®ŒRabbitMQä¹‹åŽï¼Œæˆ‘ä»¬åˆ°RabbitMQå®‰è£…ç›®å½•çš„sbinä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š1rabbitmq-plugins enable rabbitmq_managementç„¶åŽåœ¨æµè§ˆå™¨ä¸­è¾“å…¥http://localhost:15672ï¼Œç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯guestï¼Œç™»å½•åŽå¯çœ‹åˆ°ï¼šè¯´æ˜Žå¯åŠ¨æˆåŠŸã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬å¯¹Ribbon-Consumerè¿›è¡Œæ”¹é€ ï¼Œå®žçŽ°å…¶å°†ç›‘æŽ§ä¿¡æ¯è¾“å‡ºåˆ°RabbitMQï¼Œåœ¨pomä¸­æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-netflix-hystrix-stream&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-stream-rabbit&lt;/artifactId&gt;&lt;/dependency&gt;ä¿®æ”¹Ribbon-Consumerçš„ymlé…ç½®æ–‡ä»¶ï¼ŒåŠ å…¥RabbitMQçš„è¿žæŽ¥é…ç½®ï¼š123456spring: rabbitmq: host: localhost port: 5672 username: guest password: guestæœ€åŽæˆ‘ä»¬æ¥ä¿®æ”¹Turbineï¼Œè®©å…¶ä»ŽRabbitMQä¸­è¯»å–ç›‘æŽ§ä¿¡æ¯ã€‚åœ¨Turbineé¡¹ç›®ä¸­å¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-turbine-stream&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-stream-rabbit&lt;/artifactId&gt;&lt;/dependency&gt;åŒæ—¶åˆ é™¤spring-cloud-starter-eurekaå’Œspring-cloud-starter-turbineä¾èµ–ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å†ä»ŽæœåŠ¡æ³¨å†Œä¸­å¿ƒåŽ»èŽ·å–ç›‘æŽ§çš„æœåŠ¡ä¿¡æ¯äº†ï¼Œå¹¶ä¸”spring-cloud-starter-turbine-streamå·²ç»åŒ…å«äº†spring-cloud-starter-turbineä¾èµ–ã€‚ä¿®æ”¹Turbineçš„å…¥å£ç±»ï¼Œåˆ é™¤@EnableTurbineå’Œ@EnableDiscoveryClientæ³¨è§£ï¼Œæ·»åŠ @EnableTurbineStreamæ³¨è§£ã€‚å°†Turbineçš„ymlé…ç½®ä¿®æ”¹ä¸ºï¼š12345678910spring: application: name: Turbine rabbitmq: host: localhost port: 5672 username: guest password: guestserver: port: 9003ä¿®æ”¹å®Œæ¯•åŽï¼Œæˆ‘ä»¬åˆ†åˆ«å¯åŠ¨ä¸‹é¢è¿™äº›æœåŠ¡ï¼šå¯åŠ¨Eureka-Serveré›†ç¾¤ï¼Œç«¯å£å·ä¸º8080å’Œ8081ï¼›å¯åŠ¨ä¸€ä¸ªEureka-Clientï¼Œç«¯å£å·ä¸º8082ï¼›å¯åŠ¨ä¸¤ä¸ªRibbon-Consumerï¼Œç«¯å£å·ä¸º9000å’Œ9001ï¼›å¯åŠ¨TurbineæœåŠ¡ï¼Œç«¯å£å·ä¸º9003ï¼›æœ€åŽå¯åŠ¨Hystrix-DashboardæœåŠ¡ï¼Œç«¯å£å·ä¸º9002ã€‚åŒæ ·çš„æˆ‘ä»¬è®¿é—®Hystrix-dashboardçš„åœ°å€http://localhost:9002/hystrixï¼Œåœ¨é¡µé¢çš„åœ°å€æ è¾“å…¥http://localhost:9003/turbine.streamï¼Œç„¶åŽåˆ†åˆ«å¾€9000å’Œ9001ç«¯å£çš„Ribbon-Consumerå®žä¾‹å‘é€ä¸€äº›è¯·æ±‚ï¼Œè¿™æ—¶å€™å¯ä»¥çœ‹åˆ°Dashboardçš„ç”»é¢å¦‚ä¸‹ï¼šæ•ˆæžœå’Œä»ŽæœåŠ¡æ³¨å†Œä¸­å¿ƒèŽ·å–æœåŠ¡çš„ç›‘æŽ§ä¿¡æ¯ä¸€è‡´ã€‚å¹¶ä¸”è¿™æ—¶å€™è§‚å¯ŸRabbitMQçš„é¡µé¢ï¼šå¯çœ‹åˆ°Queued messageså·²ç»æœ‰æ•°æ®äº†ã€‚è‡³æ­¤æˆ‘ä»¬å®Œæˆäº†Turbineä»Žæ¶ˆæ¯ä¸­é—´ä»¶RabbitMQæ¥æ”¶é›†ç›‘æŽ§ä¿¡æ¯çš„è¿‡ç¨‹ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/32.Spring-Cloud-Hystrix-Dashboard-Turbine-RabbitMQ]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Cloud</tag>
        <tag>Hystrix</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud HystrixæœåŠ¡å®¹é”™]]></title>
    <url>%2FSpring-Cloud-Hystrix-Circuit-Breaker.html</url>
    <content type="text"><![CDATA[åœ¨å¾®æœåŠ¡çš„æž¶æž„ä¸­ï¼ŒæœåŠ¡é—´é€šå¸¸ä¼šå½¢æˆç›¸äº’ä¾èµ–çš„å…³ç³»ï¼Œæ¯”å¦‚çŽ°åœ¨æœ‰ä¸‰ä¸ªå¾®æœåŠ¡èŠ‚ç‚¹ï¼šAï¼ŒBå’ŒCï¼ŒBä¸ºAçš„æ¶ˆè´¹è€…ï¼ŒCä¸ºBçš„æ¶ˆè´¹è€…ã€‚å‡å¦‚ç”±äºŽç½‘ç»œæ³¢åŠ¨æˆ–è€…AæœåŠ¡è‡ªèº«æ•…éšœï¼Œå¯¼è‡´Bè°ƒç”¨AæœåŠ¡çš„çº¿ç¨‹è¢«æŒ‚èµ·è¿›å…¥é•¿æ—¶é—´çš„ç­‰å¾…ã€‚åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹å¯èƒ½å¯¼è‡´Bçš„èµ„æºè¢«è€—ç«­éšä¹‹å´©æºƒï¼Œä»Žè€Œå¯¼è‡´CæœåŠ¡ä¹Ÿä¸å¯ç”¨ã€‚è¿™ç§è¿žçŽ¯å¼çš„é›ªå´©æ•ˆåº”åœ¨å¾®æœåŠ¡ä¸­è¾ƒä¸ºå¸¸è§ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒæœåŠ¡ç†”æ–­æŠ€æœ¯åº”è¿è€Œå‡ºã€‚ç†”æ–­ä¸€è¯æ¥è‡ªç”µè·¯å­¦ï¼ŒæŒ‡çš„æ˜¯ç”µè·¯åœ¨å‡ºçŽ°çŸ­è·¯çŠ¶å†µæ—¶ï¼Œâ€œæ–­è·¯å™¨â€èƒ½å¤ŸåŠæ—¶åœ°åˆ‡æ–­æ•…éšœç”µè·¯ï¼Œé¿å…ç”µè·¯è¿‡è½½å‘çƒ­å¼•å‘ç«ç¾ã€‚ç±»ä¼¼çš„ï¼Œå¾®æœåŠ¡æž¶æž„ä¸­çš„æ–­è·¯å™¨èƒ½å¤ŸåŠæ—¶åœ°å‘çŽ°æ•…éšœæœåŠ¡ï¼Œå¹¶å‘æœåŠ¡è°ƒç”¨æ–¹è¿”å›žé”™è¯¯å“åº”ï¼Œè€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…ã€‚Spring Cloud Hystrixåœ¨Hystrixï¼ˆåˆæ˜¯ä¸€æ¬¾ç”±Netflixå¼€å‘çš„å¼€æºè½¯ä»¶ï¼ŒGithubåœ°å€https://github.com/Netflix/Hystrixï¼‰çš„åŸºç¡€ä¸Šè¿›è¡Œäº†å°è£…ï¼Œæä¾›äº†æœåŠ¡ç†”æ–­ï¼ŒæœåŠ¡é™çº§ï¼Œçº¿ç¨‹éš”ç¦»ç­‰åŠŸèƒ½ï¼Œé€šè¿‡è¿™äº›åŠŸèƒ½å¯ä»¥æä¾›æœåŠ¡çš„å®¹é”™çŽ‡ã€‚ä½¿ç”¨Hystrixè¿™é‡Œå°†åœ¨ä¸Šä¸€èŠ‚Spring Cloud Ribbonå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡æºç çš„åŸºç¡€ä¸Šé…ç½®Hystrixã€‚æˆ‘ä»¬å…ˆçœ‹ä¸‹åœ¨æ²¡æœ‰é…ç½®Hystrixä¹‹å‰ï¼Œå…³é—­Eureka-Clientæ˜¯ä»€ä¹ˆæ•ˆæžœã€‚åˆ†åˆ«ä½¿ç”¨peer1å’Œpeer2é…ç½®å¯åŠ¨Eureka-Serveré›†ç¾¤ï¼Œç„¶åŽå¯åŠ¨ä¸¤ä¸ªEureka-Clientå®žä¾‹ï¼Œç«¯å£åˆ†åˆ«ä¸º8082å’Œ8083ï¼Œæœ€åŽå¯åŠ¨Ribbon-Consumerã€‚å‡†å¤‡å®Œæ¯•åŽï¼Œæˆ‘ä»¬å…³é—­ç«¯å£ä¸º8082çš„Eureka-Clientï¼Œç„¶åŽå‘é€GETè¯·æ±‚http://localhost:9000/user/1ï¼Œè¿”å›žç»“æžœå¦‚ä¸‹ï¼šä¸‹é¢å¼€å§‹ä½¿ç”¨ä½¿ç”¨Spring Cloud Hystrixï¼Œåœ¨é¡¹ç›®Ribbon-Consumerä¸­å¼•å…¥Spring Cloud Hystrixä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-hystrix&lt;/artifactId&gt;&lt;/dependency&gt;åœ¨å…¥å£ç±»ä¸ŠåŠ å…¥@EnableHystrixæˆ–è€…@EnableCircuitBreakeræ³¨è§£ã€‚è¿™ä¸¤ä¸ªæ³¨è§£æ˜¯ç­‰ä»·çš„ï¼ŒæŸ¥çœ‹@EnableHystrixæ³¨è§£æºç å°±å¯ä»¥è¯å®žè¿™ä¸€ç‚¹ï¼š1234567@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Inherited@EnableCircuitBreakerpublic @interface EnableHystrix &#123;&#125;åœ¨å¼•å…¥@EnableHystrixæˆ–è€…@EnableCircuitBreakeræ³¨è§£åŽï¼Œæˆ‘ä»¬çš„å…¥å£ç±»ä»£ç å¦‚ä¸‹ï¼š12345678910111213@EnableCircuitBreaker@EnableDiscoveryClient@SpringBootApplicationpublic class DemoApplication &#123; @Bean @LoadBalanced RestTemplate restTemplate() &#123; return new RestTemplate(); &#125; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;å…¥å£ç±»ä¸Šæ€»å…±åŒ…å«äº†ä¸‰ä¸ªæ³¨è§£@EnableCircuitBreakerã€@EnableDiscoveryClientå’Œ@SpringBootApplicationï¼Œè¿™ä¸‰ä¸ªæ³¨è§£çš„ç»„åˆå¯ä»¥ä½¿ç”¨@SpringCloudApplicationæ¥ä»£æ›¿ï¼Œ@SpringCloudApplicationæºç å¦‚ä¸‹ï¼š123456789@Target(&#123;ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Documented@Inherited@SpringBootApplication@EnableDiscoveryClient@EnableCircuitBreakerpublic @interface SpringCloudApplication &#123;&#125;æŽ¥ç€å°†UserControllerä¸­çš„æ–¹æ³•æå–å‡ºæ¥ï¼Œåˆ›å»ºä¸€ä¸ªUserServiceï¼ˆä¸ºäº†ç®€å•èµ·è§ï¼Œä¸å†åˆ›å»ºServiceæŽ¥å£ï¼‰ï¼š12345678910111213141516171819202122232425262728293031323334@Service("userService")public class UserService &#123; private Logger log = LoggerFactory.getLogger(this.getClass()); @Autowired private RestTemplate restTemplate; public User getUser(@PathVariable Long id) &#123; return restTemplate.getForObject("http://Server-Provider/user/&#123;id&#125;", User.class, id); &#125; public List&lt;User&gt; getUsers() &#123; return this.restTemplate.getForObject("http://Server-Provider/user", List.class); &#125; public String addUser() &#123; User user = new User(1L, "mrbird", "123456"); HttpStatus status = this.restTemplate.postForEntity("http://Server-Provider/user", user, null).getStatusCode(); if (status.is2xxSuccessful()) &#123; return "æ–°å¢žç”¨æˆ·æˆåŠŸ"; &#125; else &#123; return "æ–°å¢žç”¨æˆ·å¤±è´¥"; &#125; &#125; public void updateUser() &#123; User user = new User(1L, "mrbird", "123456"); this.restTemplate.put("http://Server-Provider/user", user); &#125; public void deleteUser(@PathVariable Long id) &#123; this.restTemplate.delete("http://Server-Provider/user/&#123;1&#125;", id); &#125;&#125;æŽ¥ç€æ”¹é€ UserServiceçš„getUseræ–¹æ³•ï¼š1234567891011@HystrixCommand(fallbackMethod = "getUserDefault")public User getUser(@PathVariable Long id) &#123; return restTemplate.getForObject("http://Server-Provider/user/&#123;id&#125;", User.class, id);&#125;public User getUserDefault(Long id) &#123; User user = new User(); user.setId(-1L); user.setUsername("defaultUser"); user.setPassword("123456"); return user;&#125;æˆ‘ä»¬åœ¨getUseræ–¹æ³•ä¸ŠåŠ å…¥äº†@HystrixCommandæ³¨è§£ï¼Œæ³¨è§£çš„fallbackMethodå±žæ€§æŒ‡å®šäº†è¢«è°ƒç”¨çš„æ–¹æ³•ä¸å¯ç”¨æ—¶çš„å›žè°ƒæ–¹æ³•ï¼ˆæœåŠ¡ç†”æ–­æ—¶çš„å›žè°ƒå¤„ç†é€»è¾‘ï¼Œå³æœåŠ¡é™çº§ï¼‰ï¼Œè¿™é‡Œä¸ºgetUserDefaultæ–¹æ³•ï¼ˆå¿…é¡»ä¸ŽgetUseræ–¹æ³•çš„å‚æ•°åŠè¿”å›žå€¼ç±»åž‹ä¸€è‡´ï¼‰ã€‚åœ¨UserControllerä¸­è°ƒç”¨UserServiceçš„getUseræ–¹æ³•ï¼š123456789101112@RestControllerpublic class TestController &#123; private Logger log = LoggerFactory.getLogger(this.getClass()); @Autowired private UserService userService; @GetMapping("user/&#123;id&#125;") public User getUser(@PathVariable Long id) &#123; return userService.getUser(id); &#125;&#125;ä¿®æ”¹å®ŒåŽå¯åŠ¨Ribbon-Consumerå¹¶é‡é‡æ–°å¯åŠ¨8082ç«¯å£çš„Eureka-Clientï¼Œå‘é€æ•°æ¬¡GETè¯·æ±‚http://localhost:9000/user/1åŽï¼Œå†æ¬¡å…³é—­8082ç«¯å£çš„Eureka-Clientã€‚æ–­å¼€åŽï¼Œç»§ç»­å‘é€GETè¯·æ±‚http://localhost:9000/user/1ï¼Œå½“è½®è¯¢åˆ°8082ç«¯å£æ—¶è¿”å›žæ•°æ®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¯ä»¥çœ‹åˆ°ï¼Œå½“è½®è¯¢åˆ°æœåŠ¡ä¸å¯ç”¨æ—¶ï¼Œè§¦å‘äº†ç†”æ–­æœºåˆ¶ï¼ŒæŽ¥å£å›žè°ƒäº†fallbackMethodæŒ‡å®šçš„æ–¹æ³•ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ¨¡æ‹ŸæœåŠ¡è¶…æ—¶çš„æƒ…å†µï¼Œå¯ä»¥åœ¨Eureka-Clientæä¾›çš„æŽ¥å£æ–¹æ³•ä¸­è®¾ç½®çº¿ç¨‹ç­‰å¾…ï¼Œç­‰å¾…æ—¶é—´å¤§äºŽ2000ï¼ˆHystrixé»˜è®¤è¶…æ—¶æ—¶é—´ä¸º2000 æ¯«ç§’ï¼‰å³å¯è§¦å‘è°ƒç”¨æ–¹Ribbon-Consumerçš„æœåŠ¡ç†”æ–­ã€‚@HystrixCommandè¯¦è§£@HystrixCommandæ³¨è§£è¿˜åŒ…å«è®¸å¤šåˆ«çš„å±žæ€§åŠŸèƒ½ï¼Œä¸‹é¢ä»‹ç»ä¸€äº›å¸¸ç”¨çš„å±žæ€§é…ç½®ã€‚æœåŠ¡é™çº§ä¸Šé¢TestControllerä¸­çš„getUserä¸­æˆ‘ä»¬ç”¨@HystrixCommandæ³¨è§£æŒ‡å®šäº†æœåŠ¡é™çº§æ–¹æ³•getUserDefaultã€‚å¦‚æžœgetUserDefaultæ–¹æ³•ä¹ŸæŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†æ¬¡ä½¿ç”¨@HystrixCommandæ³¨è§£æŒ‡å®šgetUserDefaultæ–¹æ³•é™çº§çš„æ–¹æ³•ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ªgetUserDefault2æ–¹æ³•ï¼š12345678910111213141516171819@HystrixCommand(fallbackMethod = "getUserDefault2")public User getUserDefault(Long id) &#123; String a = null; // æµ‹è¯•æœåŠ¡é™çº§ a.toString(); User user = new User(); user.setId(-1L); user.setUsername("defaultUser"); user.setPassword("123456"); return user;&#125;public User getUserDefault2(Long id) &#123; User user = new User(); user.setId(-2L); user.setUsername("defaultUser2"); user.setPassword("123456"); return user;&#125;é‡å¯Ribbon-Consumerï¼Œå¹¶å…³é—­8082ç«¯å£çš„Eureka ClientæœåŠ¡ï¼Œè®¿é—®http://localhost:9000/user/1ï¼šå¼‚å¸¸å¤„ç†åœ¨ä½¿ç”¨@HystrixCommandæ³¨è§£æ ‡æ³¨çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†HystrixBadRequestExceptionå¼‚å¸¸å¤–ï¼Œåˆ«çš„å¼‚å¸¸éƒ½ä¼šè§¦å‘æœåŠ¡é™çº§ã€‚å‡å¦‚æˆ‘ä»¬æƒ³æŒ‡å®šæŸä¸ªå¼‚å¸¸ä¸è§¦å‘æœåŠ¡é™çº§ï¼Œå¯ä»¥ä½¿ç”¨@HystrixCommandæ³¨è§£çš„ignoreExceptionså±žæ€§è¿›è¡Œå¿½ç•¥ã€‚å¦‚ï¼š123456789101112@HystrixCommand(fallbackMethod = "getUserDefault2", ignoreExceptions = &#123;NullPointerException.class&#125;)public User getUserDefault(Long id) &#123; String a = null; // æµ‹è¯•æœåŠ¡é™çº§ a.toString(); User user = new User(); user.setId(-1L); user.setUsername("defaultUser"); user.setPassword("123456"); throw new HystrixBadRequestException() return user;&#125;æ­¤å¤–ï¼Œå¯¹äºŽæ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡é™çº§çš„æ–¹æ³•ä¸­ä½¿ç”¨Throwableå¯¹è±¡èŽ·å–ï¼Œå¦‚ï¼š123456789@HystrixCommand(fallbackMethod = "getUserDefault2")public User getUserDefault(Long id, Throwable e) &#123; System.out.println(e.getMessage()); User user = new User(); user.setId(-2L); user.setUsername("defaultUser2"); user.setPassword("123456"); return user;&#125;å‘½åä¸Žåˆ†ç»„é€šè¿‡æŒ‡å®š@HystrixCommandæ³¨è§£çš„commandKeyã€groupKeyä»¥åŠthreadPoolKeyå±žæ€§å¯ä»¥è®¾ç½®å‘½ä»¤åç§°ã€åˆ†ç»„ä»¥åŠçº¿ç¨‹æ± åˆ’åˆ†ï¼Œå¦‚ï¼š123456@HystrixCommand(fallbackMethod = "getUserDefault", commandKey = "getUserById", groupKey = "userGroup", threadPoolKey = "getUserThread")public User getUser(@PathVariable Long id) &#123; log.info("èŽ·å–ç”¨æˆ·ä¿¡æ¯"); return restTemplate.getForObject("http://Server-Provider/user/&#123;id&#125;", User.class, id);&#125;ä¸Šé¢çš„é…ç½®æŒ‡å®šäº†å‘½ä»¤çš„åç§°ä¸ºgetUserByIdï¼Œç»„åä¸ºuserGroupï¼Œçº¿ç¨‹æ± åç§°ä¸ºgetUserThreadã€‚é€šè¿‡è®¾ç½®å‘½ä»¤ç»„ï¼ŒHystrixä¼šæ ¹æ®ç»„æ¥ç»„ç»‡å’Œç»Ÿè®¡å‘½ä»¤çš„å‘Šè­¦ã€ä»ªè¡¨ç›˜ç­‰ä¿¡æ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒHystrixå‘½ä»¤é€šè¿‡ç»„åæ¥åˆ’åˆ†çº¿ç¨‹æ± ï¼Œå³ç»„åç›¸åŒçš„å‘½ä»¤æ”¾åˆ°åŒä¸€ä¸ªçº¿ç¨‹æ± é‡Œï¼Œå¦‚æžœé€šè¿‡threadPoolKeyè®¾ç½®äº†çº¿ç¨‹æ± åç§°ï¼Œåˆ™æŒ‰ç…§çº¿ç¨‹æ± åç§°åˆ’åˆ†ã€‚å½“getUseræ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œæ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š12018-06-06 15:32:55.945 INFO 16192 --- [getUserThread-1] com.example.demo.Service.UserService : èŽ·å–ç”¨æˆ·ä¿¡æ¯å¯çœ‹åˆ°çº¿ç¨‹åç§°ä¸ºgetUserThread-1ã€‚Hystrixç¼“å­˜æˆ‘ä»¬åœ¨Controllerä¸­è°ƒç”¨ä¸‰æ¬¡getUseræ–¹æ³•ï¼Œå‚æ•°éƒ½ä¸º1Lï¼š12345678910111213@RestControllerpublic class TestController &#123; @Autowired private UserService userService; @GetMapping("testCache") public void testCache()&#123; userService.getUser(1L); userService.getUser(1L); userService.getUser(1L); &#125;&#125;å½“è®¿é—®http://localhost:9000/testCacheæ—¶ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š å¼€å¯ç¼“å­˜å¯ä»¥è®©getUseræ–¹æ³•åªè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå‰©ä¸‹ä¸¤æ¬¡ç›´æŽ¥ä»Žç¼“å­˜é‡ŒèŽ·å–ã€‚å¼€å¯ç¼“å­˜è¦åœ¨Hystrixä¸­å¼€å¯ç¼“å­˜å¾ˆç®€å•ï¼Œåªéœ€ä½¿ç”¨@CacheResultæ³¨è§£å³å¯ï¼Œä¿®æ”¹UserServiceçš„getUseræ–¹æ³•ï¼š1234@CacheResultpublic User getUser(@PathVariable Long id) &#123; return restTemplate.getForObject("http://Server-Provider/user/&#123;id&#125;", User.class, id);&#125;é€šè¿‡ä¸Šé¢çš„è®¾å®šï¼ŒHystrixä¼šå°†è¿”å›žçš„Userå¯¹è±¡è¿›è¡Œç¼“å­˜ï¼Œç¼“å­˜çš„keyé»˜è®¤ä¸ºæ–¹æ³•çš„æ‰€æœ‰å‚æ•°ï¼Œè¿™é‡Œåªæœ‰ä¸€ä¸ªidå‚æ•°ï¼Œæ‰€ä»¥ç¼“å­˜çš„keyä¸ºç”¨æˆ·idã€‚è¿™é‡Œåœ¨æµ‹è¯•çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªå¼‚å¸¸ï¼šjava.lang.IllegalStateException: Request caching is not available. Maybe you need to initialize the HystrixRequestContext? at com.netflix.hystrix.HystrixRequestCache.get(HystrixRequestCache.java:104) ~[hystrix-core-1.5.12.jar:1.5.12] at com.netflix.hystrix.AbstractCommand$7.call(AbstractCommand.java:478) ~[hystrix-core-1.5.12.jar:1.5.12] at com.netflix.hystrix.AbstractCommand$7.call(AbstractCommand.java:454) ~[hystrix-core-1.5.12.jar:1.5.12] â€¦åœ¨Hystrixçš„issueä¸­æ‰¾åˆ°äº†ç±»ä¼¼çš„æé—®ï¼šhttps://github.com/Netflix/Hystrix/issues/1314ã€‚å¤§è‡´æ„æ€æ˜¯åœ¨ä½¿ç”¨Hytrixç¼“å­˜ä¹‹å‰ï¼Œéœ€è¦é€šè¿‡HystrixRequestContext.initializeContextåˆå§‹åŒ–Hystrixè¯·æ±‚ä¸Šä¸‹æ–‡ï¼Œè¯·æ±‚ç»“æŸä¹‹åŽéœ€è¦è°ƒç”¨shutdownæ–¹æ³•å…³é—­è¯·æ±‚ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªè¿‡æ»¤å™¨æ¥å®žçŽ°è¿™ä¸ªè¿‡ç¨‹ï¼š123456789101112131415161718@Component@WebFilter(filterName = "hystrixRequestContextServletFilter", urlPatterns = "/*", asyncSupported = true)public class HystrixRequestContextServletFilter implements Filter &#123; @Override public void init(FilterConfig filterConfig) &#123; &#125; @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123; HystrixRequestContext context = HystrixRequestContext.initializeContext(); filterChain.doFilter(servletRequest, servletResponse); context.close(); &#125; @Override public void destroy() &#123; &#125;&#125;åˆ°è¿™é‡Œï¼Œæˆ‘æ‰æ„è¯†åˆ°ï¼Œå…¶å®žHystrixçš„ç¼“å­˜è¿˜æ˜¯è›®é¸¡è‚‹çš„ï¼Œè¯·æ±‚ç¼“å­˜ä¸æ˜¯åªå†™å…¥ä¸€æ¬¡ç»“æžœå°±ä¸å†å˜åŒ–çš„ï¼Œè€Œæ˜¯æ¯æ¬¡è¯·æ±‚åˆ°è¾¾Controllerçš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½éœ€è¦ä¸ºHystrixRequestContextè¿›è¡Œåˆå§‹åŒ–ï¼Œä¹‹å‰çš„ç¼“å­˜ä¹Ÿå°±æ˜¯ä¸å­˜åœ¨äº†ï¼Œæˆ‘ä»¬æ˜¯åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­ä¿è¯ç»“æžœç›¸åŒï¼ŒåŒä¸€æ¬¡è¯·æ±‚ä¸­çš„ç¬¬ä¸€æ¬¡è®¿é—®åŽå¯¹ç»“æžœè¿›è¡Œç¼“å­˜ï¼Œç¼“å­˜çš„ç”Ÿå‘½å‘¨æœŸåªæœ‰ä¸€æ¬¡è¯·æ±‚ï¼æ”¹é€ å®Œæ¯•åŽï¼Œé‡å¯é¡¹ç›®å†æ¬¡è®¿é—®http://localhost:9000/testCacheï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šè®¾å®škeyå€¼æˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜Žç¡®çš„æŒ‡å®šç¼“å­˜çš„keyå€¼æ˜¯ä»€ä¹ˆã€‚æŒ‡å®škeyçš„å€¼æœ‰ä¸¤ç§æ–¹å¼ï¼šé€šè¿‡@CacheKeyæ³¨è§£æŒ‡å®šï¼Œå¦‚ï¼š1234567@CacheResult@HystrixCommand(fallbackMethod = "getUserDefault", commandKey = "getUserById", groupKey = "userGroup", threadPoolKey = "getUserThread")public User getUser(@CacheKey("id") @PathVariable Long id) &#123; log.info("èŽ·å–ç”¨æˆ·ä¿¡æ¯"); return restTemplate.getForObject("http://Server-Provider/user/&#123;id&#125;", User.class, id);&#125;ä¹Ÿå¯ä»¥æŒ‡å®šå‚æ•°å¯¹è±¡å†…éƒ¨å±žæ€§ä¸ºkeyå€¼ï¼š1234567@CacheResult@HystrixCommand(fallbackMethod = "getUserDefault", commandKey = "getUserById", groupKey = "userGroup", threadPoolKey = "getUserThread")public User getUser(@CacheKey("id") User user) &#123; log.info("èŽ·å–ç”¨æˆ·ä¿¡æ¯"); return restTemplate.getForObject("http://Server-Provider/user/&#123;id&#125;", User.class, user.getId());&#125;é€šè¿‡æ–¹æ³•æ¥æŒ‡å®šï¼Œæ–¹æ³•çš„è¿”å›žå€¼å¿…é¡»æ˜¯Stringç±»åž‹ï¼š1234567891011public String getCacheKey(Long id) &#123; return String.valueOf(id);&#125;@CacheResult(cacheKeyMethod = "getCacheKey")@HystrixCommand(fallbackMethod = "getUserDefault", commandKey = "getUserById", groupKey = "userGroup", threadPoolKey = "getUserThread")public User getUser(Long id) &#123; log.info("èŽ·å–ç”¨æˆ·ä¿¡æ¯"); return restTemplate.getForObject("http://Server-Provider/user/&#123;id&#125;", User.class, id);&#125;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ–¹æ³•2çš„ä¼˜å…ˆçº§æ¯”æ–¹æ³•1é«˜ã€‚ç¼“å­˜æ¸…é™¤åœ¨æ¶‰åŠåˆ°æ›´æ–°Userä¿¡æ¯çš„æ–¹æ³•ä¸Šï¼Œæˆ‘ä»¬è¦åŠæ—¶çš„æ¸…é™¤ç›¸åº”çš„ç¼“å­˜ï¼Œå¦åˆ™å°†ä¼šå¯¼è‡´ç¼“å­˜æ•°æ®å’Œå®žé™…æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚æˆ‘ä»¬åœ¨UserServiceçš„updateUseræ–¹æ³•ä¸Šåšç¼“å­˜æ¸…é™¤æ“ä½œï¼š12345@CacheRemove(commandKey = "getUserById")@HystrixCommandpublic void updateUser(@CacheKey("id") User user) &#123; this.restTemplate.put("http://Server-Provider/user", user);&#125;@CacheRemoveçš„commandKeyå±žæ€§å’ŒgetUseré‡Œå®šä¹‰çš„ä¸€è‡´ã€‚è¯·æ±‚åˆå¹¶è¯·æ±‚åˆå¹¶å°±æ˜¯å°†å¤šä¸ªå•ä¸ªè¯·æ±‚åˆå¹¶æˆä¸€ä¸ªè¯·æ±‚ï¼ŒåŽ»è°ƒç”¨æœåŠ¡æä¾›è€…ï¼Œä»Žè€Œé™ä½ŽæœåŠ¡æä¾›è€…è´Ÿè½½çš„ï¼Œä¸€ç§åº”å¯¹é«˜å¹¶å‘çš„è§£å†³åŠžæ³•ã€‚Hystrixä¸­æä¾›äº†ä¸€ä¸ª@HystrixCollapseræ³¨è§£ï¼Œè¯¥æ³¨è§£å¯ä»¥å°†å¤„äºŽä¸€ä¸ªå¾ˆçŸ­çš„æ—¶é—´æ®µï¼ˆé»˜è®¤10 æ¯«ç§’ï¼‰å†…å¯¹åŒä¸€ä¾èµ–æœåŠ¡çš„å¤šä¸ªè¯·æ±‚è¿›è¡Œæ•´åˆå¹¶ä»¥æ‰¹é‡æ–¹å¼å‘èµ·è¯·æ±‚ã€‚ä¸ºäº†æ¼”ç¤º@HystrixCollapseræ³¨è§£çš„ä½¿ç”¨æ–¹æ³•ï¼Œæˆ‘ä»¬æ”¹é€ ä¸‹Eureka-Clientï¼ˆæœåŠ¡æä¾›è€…ï¼‰çš„UserControlleræŽ¥å£ï¼Œæä¾›ä¸€ä¸ªæ‰¹é‡å¤„ç†çš„æ–¹æ³•ï¼š12345678910111213141516@RestController@RequestMapping("user")public class UserController &#123; private Logger log = LoggerFactory.getLogger(this.getClass()); @GetMapping("users") public List&lt;User&gt; get(String ids) &#123; log.info("æ‰¹é‡èŽ·å–ç”¨æˆ·ä¿¡æ¯"); List&lt;User&gt; list = new ArrayList&lt;&gt;(); for (String id : ids.split(",")) &#123; list.add(new User(Long.valueOf(id), "user" + id, "123456")); &#125; return list; &#125; ...&#125;ç„¶åŽåœ¨Ribbon-Consumerçš„UserServiceé‡Œæ·»åŠ ä¸¤ä¸ªæ–¹æ³•ï¼š12345678910111213141516171819@HystrixCollapser(batchMethod = "findUserBatch", collapserProperties = &#123; @HystrixProperty(name = "timerDelayInMilliseconds", value = "100")&#125;)public Future&lt;User&gt; findUser(Long id) &#123; log.info("èŽ·å–å•ä¸ªç”¨æˆ·ä¿¡æ¯"); return new AsyncResult&lt;User&gt;() &#123; @Override public User invoke() &#123; return restTemplate.getForObject("http://Server-Provider/user/&#123;id&#125;", User.class, id); &#125; &#125;;&#125;@HystrixCommandpublic List&lt;User&gt; findUserBatch(List&lt;Long&gt; ids) &#123; log.info("æ‰¹é‡èŽ·å–ç”¨æˆ·ä¿¡æ¯,ids: " + ids); User[] users = restTemplate.getForObject("http://Server-Provider/user/users?ids=&#123;1&#125;", User[].class, StringUtils.join(ids, ",")); return Arrays.asList(users);&#125;@HystrixCollapseræ³¨è§£çš„batchMethodå±žæ€§æŒ‡å®šäº†æ‰¹é‡å¤„ç†çš„æ–¹æ³•ä¸ºä¸‹é¢å®šä¹‰çš„findUserBatchæ–¹æ³•ï¼ŒtimerDelayInMillisecondsçš„å€¼ä¸º100ï¼ˆæ¯«ç§’ï¼‰ï¼Œæ„æ€æ˜¯åœ¨100æ¯«ç§’è¿™ä¸ªæ—¶é—´èŒƒå›´å†…çš„æ‰€æœ‰å¯¹findUserçš„è°ƒç”¨ï¼Œéƒ½å°†è¢«åˆå¹¶ä¸ºä¸€ä¸ªæ‰¹é‡å¤„ç†æ“ä½œï¼Œè¿›è¡Œæ‰¹é‡å¤„ç†æ“ä½œçš„æ–¹æ³•å°±æ˜¯findUserBatchã€‚æˆ‘ä»¬åœ¨TestControllerä¸­æ·»åŠ ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼š123456789101112@GetMapping("testRequestMerge")public void testRequerstMerge() throws InterruptedException, ExecutionException &#123; Future&lt;User&gt; f1 = userService.findUser(1L); Future&lt;User&gt; f2 = userService.findUser(2L); Future&lt;User&gt; f3 = userService.findUser(3L); f1.get(); f2.get(); f3.get(); Thread.sleep(200); Future&lt;User&gt; f4 = userService.findUser(4L); f4.get();&#125;ä¸Šé¢çš„æµ‹è¯•æ–¹æ³•ä¸­å¯¹findUseræ–¹æ³•è¿›è¡Œäº†4æ¬¡çš„è°ƒç”¨ï¼Œæœ€åŽä¸€æ¬¡è°ƒç”¨ï¼ˆf4ï¼‰ä¹‹å‰å…ˆè®©çº¿ç¨‹ç­‰å¾…200æ¯«ç§’ï¼ˆå¤§äºŽtimerDelayInMillisecondsä¸­å®šä¹‰çš„100æ¯«ç§’ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„é¢„æœŸæ˜¯å‰ä¸‰æ¬¡è°ƒç”¨ä¼šè¢«åˆå¹¶ï¼Œè€Œæœ€åŽä¸€æ¬¡è°ƒç”¨ä¸ä¼šè¢«åˆå¹¶è¿›åŽ»ã€‚å¯åŠ¨Ribbon-Consumerï¼Œè®¿é—®http://localhost:9000/testRequestMerge,æŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼šå¯ä»¥çœ‹åˆ°ï¼ŒæŽ§åˆ¶å°çš„è¾“å‡ºç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œf1ã€f2å’Œf3è¢«åˆå¹¶æˆäº†ä¸€ä¸ªè¯·æ±‚ã€‚è€Œä¸”å¯ä»¥çœ‹åˆ°ï¼ŒæŽ§åˆ¶å°å¹¶æ²¡æœ‰æ‰“å°å‡ºfindUseræ–¹æ³•ä¸­çš„èŽ·å–å•ä¸ªç”¨æˆ·ä¿¡æ¯çš„æ—¥å¿—ï¼Œå®žé™…ä¸ŠfindUseræ–¹æ³•å¹¶ä¸ä¼šè¢«è°ƒç”¨ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç å¯ä»¥ç®€åŒ–ä¸ºï¼š1234567891011121314 @HystrixCollapser(batchMethod = "findUserBatch", collapserProperties = &#123; @HystrixProperty(name = "timerDelayInMilliseconds", value = "100")&#125;)public Future&lt;User&gt; findUser(Long id) &#123; log.info("èŽ·å–å•ä¸ªç”¨æˆ·ä¿¡æ¯"); return null;&#125;@HystrixCommandpublic List&lt;User&gt; findUserBatch(List&lt;Long&gt; ids) &#123; log.info("æ‰¹é‡èŽ·å–ç”¨æˆ·ä¿¡æ¯,ids: " + ids); User[] users = restTemplate.getForObject("http://Server-Provider/user/users?ids=&#123;1&#125;", User[].class, StringUtils.join(ids, ",")); return Arrays.asList(users);&#125;è™½ç„¶é€šè¿‡è¯·æ±‚çš„åˆå¹¶å¯ä»¥å‡è½»å¸¦å®½å’ŒæœåŠ¡çš„åŽ‹åŠ›ï¼Œä½†åˆå¹¶è¯·æ±‚çš„è¿‡ç¨‹ä¹Ÿä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ã€‚å°±æ‹¿ä¸Šé¢çš„testCacheæ¥è¯´ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯¹å•ä¸ªfindUserçš„æ–¹æ³•è°ƒç”¨è€—æ—¶5msï¼Œé‚£ä¹ˆè°ƒç”¨4æ¬¡è€—æ—¶å¯ä»¥ç²—ç•¥çš„ä¼°ç®—ä¸º20msã€‚å½“æˆ‘ä»¬ä½¿ç”¨Hystrixçš„è¯·æ±‚åˆå¹¶åŠŸèƒ½åŽï¼Œå‰3æ¬¡è¯·æ±‚ï¼ˆf1ã€f2å’Œf3ï¼‰è¿›è¡Œäº†åˆå¹¶ï¼Œç¬¬4æ¬¡è¯·æ±‚ï¼ˆf4ï¼‰æ²¡æœ‰è¿›è¡Œåˆå¹¶ï¼Œé‚£ä¹ˆè€—æ—¶å¯ä»¥ç²—ç•¥çš„ä¼°ç®—ä¸º3*5+100+5=120msï¼ˆ100ä¸ºä¸Šé¢timerDelayInMillisecondsä¸­æŒ‡å®šçš„æ—¶é—´èŒƒå›´ï¼Œåœ¨è¯¥æ—¶é—´æ®µè¿‡åŽï¼Œæ‰ä¼šè°ƒç”¨ç¬¬4æ¬¡è¯·æ±‚ï¼‰ï¼Œç»“æžœæ˜Žæ˜¾æ¯”å•ç‹¬è°ƒç”¨4æ¬¡æ¥å¾—é«˜ã€‚æ‰€ä»¥å®žé™…ä¸­æ˜¯å¦è¯¥ä½¿ç”¨Hystrixçš„è¯·æ±‚åˆå¹¶åŠŸèƒ½ï¼Œéœ€ç»“åˆå®žé™…éœ€æ±‚è¿›è¡ŒæŠ‰æ‹©ã€‚Hystrixå±žæ€§é™¤äº†ä¸Šé¢æ¶‰åŠåˆ°çš„Hystrixå±žæ€§é…ç½®å¤–ï¼Œå…¶è¿˜åŒ…å«äº†å¤§é‡çš„åˆ«çš„å¯ç”¨é…ç½®ã€‚é…ç½®å¯ä»¥åˆ†ä¸ºå››ä¸ªçº§åˆ«ï¼Œä¼˜å…ˆçº§ä»Žä½Žåˆ°é«˜åˆ†åˆ«ä¸ºï¼šå…¨å±€é»˜è®¤é…ç½®ã€å…¨å±€é…ç½®ã€å®žä¾‹é»˜è®¤å€¼ã€å®žä¾‹é…ç½®ã€‚Commondexecutionexecution.isolation.strategyï¼š è¯¥å±žæ€§ç”¨æ¥è®¾ç½®æ‰§è¡Œçš„éš”ç¦»ç­–ç•¥ï¼Œå®ƒæœ‰å¦‚ä¸‹ä¸¤ä¸ªé€‰é¡¹ã€‚THREAD: é€šè¿‡çº¿ç¨‹æ± éš”ç¦»çš„ç­–ç•¥ã€‚å®ƒåœ¨ç‹¬ç«‹çš„çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œ å¹¶ä¸”å®ƒçš„å¹¶å‘é™åˆ¶å—çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°é‡çš„é™åˆ¶ã€‚SEMAPHORE: é€šè¿‡ä¿¡å·é‡éš”ç¦»çš„ç­–ç•¥ã€‚å®ƒåœ¨è°ƒç”¨çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œ å¹¶ä¸”å®ƒçš„å¹¶å‘é™åˆ¶å—ä¿¡å·é‡è®¡æ•°çš„é™åˆ¶ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®THREADå…¨å±€é…ç½®hystrix.command.default.execution.isolation.strategyå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€execution.isolation.strategyâ€, value=â€THREADâ€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.execution.isolation.strategyå®žä¾‹é…ç½®ä¸­çš„HystrixCommandKeyå¯¹åº”@HystrixCommandæ³¨è§£ä¸­commandKey å±žæ€§æŒ‡å®šçš„å€¼ã€‚execution.isolation.thread.timeoutinMillisecondsï¼š è¯¥å±žæ€§ç”¨æ¥é…ç½®HystrixCommandæ‰§è¡Œçš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ã€‚å½“HystrixCommandæ‰§è¡Œæ—¶é—´è¶…è¿‡è¯¥é…ç½®å€¼ä¹‹åŽï¼Œ Hystrixä¼šå°†è¯¥æ‰§è¡Œå‘½ä»¤æ ‡è®°ä¸ºTIMEOUTå¹¶è¿›å…¥æœåŠ¡é™çº§å¤„ç†é€»è¾‘ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®1000äº³ç§’å…¨å±€é…ç½®hystrix.command.default.execution.isolation.thread. timeoutinMillisecondså®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€execution.isolation.thread.timeoutinMillisecondsâ€,value=â€2000â€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.execution.isolation.thread.timeoutinMillisecondsexecution.timeout.enabled: è¯¥å±žæ€§ç”¨æ¥é…ç½®HystrixCommandçš„æ‰§è¡Œæ˜¯å¦å¯ç”¨è¶…æ—¶æ—¶é—´ã€‚é»˜è®¤ä¸ºtrue, å¦‚æžœè®¾ç½®ä¸ºfalse, é‚£ä¹ˆexecution.isolation.thread.timeoutinMillisecondså±žæ€§çš„é…ç½®å°†ä¸å†èµ·ä½œç”¨ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®trueå…¨å±€é…ç½®hystrix.command.default.execution.timeout.enabledå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€execution.timeout.enabledâ€, value=â€falseâ€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.execution.timeout.enabledexecution.isolation.thread.interruptOnTimeout: è¯¥å±žæ€§ç”¨æ¥é…ç½®å½“HystrixCommandæ‰§è¡Œè¶…æ—¶çš„æ—¶å€™æ˜¯å¦è¦å°†å®ƒä¸­æ–­ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®trueå…¨å±€é…ç½®hystrix.command.default.execution.isolation.thread.interruptOnTimeoutå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€execution.isolation.thread.interruptOnTimeoutâ€,value=â€falseâ€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.execution.isolation.thread.interruptOnTimeoutexecution.isolation.thread.interruptOnCancel: è¯¥å±žæ€§ç”¨æ¥é…ç½®å½“HystrixCommandæ‰§è¡Œè¢«å–æ¶ˆçš„æ—¶å€™æ˜¯å¦è¦å°†å®ƒä¸­æ–­ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®trueå…¨å±€é…ç½®hystrix.command.default.execution.isolation.thread.interruptOnCancelå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€execution.isolation.thread.interruptOnCancelâ€,value= â€œfalseâ€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.execution.isolation.thread.interruptOnCancelexecution.isolation.semaphore.maxConcurrentRequests: å½“HystrixCommandçš„éš”ç¦»ç­–ç•¥ä½¿ç”¨ä¿¡å·é‡çš„æ—¶å€™ï¼Œè¯¥å±žæ€§ç”¨æ¥é…ç½®ä¿¡å·é‡çš„å¤§å°ï¼ˆå¹¶å‘è¯·æ±‚æ•°ï¼‰ã€‚å½“æœ€å¤§å¹¶å‘è¯·æ±‚æ•°è¾¾åˆ°è¯¥è®¾ç½®å€¼æ—¶ï¼ŒåŽç»­çš„è¯·æ±‚å°†ä¼šè¢«æ‹’ç»ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®10å…¨å±€é…ç½®hystrix.command.default.execution.isolation.semaphore.maxConcurrentRequestså®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€execution.isolation.semaphore.maxConcurrentRequestsâ€, value=â€2â€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.execution.isolation.semaphore.maxConcurrentRequestsfallbackfallback.enabled: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®æœåŠ¡é™çº§ç­–ç•¥æ˜¯å¦å¯ç”¨ï¼Œå¦‚æžœè®¾ç½®ä¸ºfalse,é‚£ä¹ˆå½“è¯·æ±‚å¤±è´¥æˆ–è€…æ‹’ç»å‘ç”Ÿæ—¶ï¼Œå°†ä¸ä¼šè°ƒç”¨é™çº§æœåŠ¡ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®trueå…¨å±€é…ç½®hystrix.command.default.fallback.enabledå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name= â€œfallback.enabledâ€, value=â€falseâ€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.fallback.enabledcircuitBreakeræ–­è·¯å™¨circuitBreaker.enabled: è¯¥å±žæ€§ç”¨æ¥ç¡®å®šå½“æœåŠ¡è¯·æ±‚å‘½ä»¤å¤±è´¥æ—¶ï¼Œ æ˜¯å¦ä½¿ç”¨æ–­è·¯å™¨æ¥è·Ÿè¸ªå…¶å¥åº·æŒ‡æ ‡å’Œç†”æ–­è¯·æ±‚ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®trueå…¨å±€é…ç½®hystrix.command.default.circuitBreaker.enabledå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€circutBreaker.enabledâ€,value=â€falseâ€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.circuitBreaker.enabledcircuitBreaker.requestVolumeThreshold: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®åœ¨æ»šåŠ¨æ—¶é—´çª—ä¸­ï¼Œæ–­è·¯å™¨ç†”æ–­çš„æœ€å°è¯·æ±‚æ•°ã€‚ä¾‹å¦‚ï¼Œé»˜è®¤è¯¥å€¼ä¸º20 çš„æ—¶å€™ï¼Œå¦‚æžœæ»šåŠ¨æ—¶é—´çª—ï¼ˆé»˜è®¤10ç§’ï¼‰å†…ä»…æ”¶åˆ°äº†19ä¸ªè¯·æ±‚ï¼Œ å³ä½¿è¿™19ä¸ªè¯·æ±‚éƒ½å¤±è´¥äº†ï¼Œæ–­è·¯å™¨ä¹Ÿä¸ä¼šæ‰“å¼€ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®20å…¨å±€é…ç½®hystrix.command.default.circuitBreaker.requestVolumeThresholdå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€circuitBreaker.requestVolumeThresholdâ€, value=â€30â€)å®žä¾‹é…ç½®hystrix.comrnand.HystrixComrnandKey.circuitBreaker.requestVolumeThresholdcircuitBreaker.sleepWindowinMilliseconds: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®å½“æ–­è·¯å™¨æ‰“å¼€ä¹‹åŽçš„ä¼‘çœ æ—¶é—´çª—ã€‚ä¼‘çœ æ—¶é—´çª—ç»“æŸä¹‹åŽï¼Œä¼šå°†æ–­è·¯å™¨ç½®ä¸ºâ€œåŠå¼€â€ çŠ¶æ€ï¼Œ å°è¯•ç†”æ–­çš„è¯·æ±‚å‘½ä»¤ï¼Œå¦‚æžœä¾ç„¶å¤±è´¥å°±å°†æ–­è·¯å™¨ç»§ç»­è®¾ç½®ä¸ºâ€œæ‰“å¼€â€ çŠ¶æ€ï¼Œå¦‚æžœæˆåŠŸå°±è®¾ç½®ä¸ºâ€œå…³é—­â€ çŠ¶æ€ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®5000å…¨å±€é…ç½®hystrix.command.default.circuitBreaker.sleepWindowinMillisecondså®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€circuitBreaker.sleepWindowinMillisecondsâ€,value=â€3000â€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.circuitBreaker.sleepWindowinMillisecondscircuitBreaker.errorThresholdPercentage: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®æ–­è·¯å™¨æ‰“å¼€çš„é”™è¯¯ç™¾åˆ†æ¯”æ¡ä»¶ã€‚ä¾‹å¦‚ï¼Œé»˜è®¤å€¼ä¸º5000 çš„æƒ…å†µä¸‹ï¼Œè¡¨ç¤ºåœ¨æ»šåŠ¨æ—¶é—´çª—ä¸­ï¼Œåœ¨è¯·æ±‚æ•°é‡è¶…è¿‡circuitBreaker.requestVolumeThresholdé˜…å€¼çš„å‰æä¸‹ï¼Œå¦‚æžœé”™è¯¯è¯·æ±‚æ•°çš„ç™¾åˆ†æ¯”è¶…è¿‡50, å°±æŠŠæ–­è·¯å™¨è®¾ç½®ä¸ºâ€œæ‰“å¼€â€ çŠ¶æ€ï¼Œ å¦åˆ™å°±è®¾ç½®ä¸ºâ€œå…³é—­â€ çŠ¶æ€ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®50å…¨å±€é…ç½®hystrix.command.default.circuitBreaker.errorThresholdPercentageå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€circuitBreaker.errorThresholdPercentageâ€, value=â€40â€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.circuitBreaker.errorThresholdPercentagecircuitBreaker.forceOpen: å¦‚æžœå°†è¯¥å±žæ€§è®¾ç½®ä¸ºtrue, æ–­è·¯å™¨å°†å¼ºåˆ¶è¿›å…¥â€œæ‰“å¼€â€ çŠ¶æ€ï¼Œå®ƒä¼šæ‹’ç»æ‰€æœ‰è¯·æ±‚ã€‚è¯¥å±žæ€§ä¼˜å…ˆäºŽcircuitBreaker.forceClosedå±žæ€§ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®falseå…¨å±€é…ç½®hystrix.command.default.circuitBreaker.forceOpenå®žä¾‹é»˜è®¤å€¼@HystrixProperty (name=â€circuitBreaker.forceOpenâ€, value=â€trueâ€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.circuitBreaker.forceOpencircuitBreaker.forceClosed: å¦‚æžœå°†è¯¥å±žæ€§è®¾ç½®ä¸ºtrue, æ–­è·¯å™¨å°†å¼ºåˆ¶è¿›å…¥â€œå…³é—­â€ çŠ¶æ€ï¼Œ å®ƒä¼šæŽ¥æ”¶æ‰€æœ‰è¯·æ±‚ã€‚å¦‚æžœcircuitBreaker.forceOpenå±žæ€§ä¸ºtrue, è¯¥å±žæ€§ä¸ä¼šç”Ÿæ•ˆã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®falseå…¨å±€é…ç½®hystrix.command.default.circuitBreaker.forceClosedå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€circuiä¸ƒBreaker.forceClosedâ€, value=â€trueâ€)å®žä¾‹é…ç½®hystrix.comrnand.HystrixComrnandKey.circuitBreaker.forceClosedmetricsé…ç½®è¯¥é…ç½®ä¸ŽHystrixCommandæ‰§è¡Œä¸­æ•èŽ·çš„æŒ‡æ ‡ä¿¡æ¯æœ‰å…³ã€‚metrics.rollingStats.timeinMilliseconds: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®æ»šåŠ¨æ—¶é—´çª—çš„é•¿åº¦ï¼Œ å•ä½ä¸ºæ¯«ç§’ã€‚è¯¥æ—¶é—´ç”¨äºŽæ–­è·¯å™¨åˆ¤æ–­å¥åº·åº¦æ—¶éœ€è¦æ”¶é›†ä¿¡æ¯çš„æŒç»­æ—¶é—´ã€‚æ–­è·¯å™¨åœ¨æ”¶é›†æŒ‡æ ‡ä¿¡æ¯çš„æ—¶å€™ä¼šæ ¹æ®è®¾ç½®çš„æ—¶é—´çª—é•¿åº¦æ‹†åˆ†æˆå¤šä¸ªâ€œæ¡¶â€ æ¥ç´¯è®¡å„åº¦é‡å€¼ï¼Œæ¯ä¸ªâ€œæ¡¶â€ è®°å½•äº†ä¸€æ®µæ—¶é—´å†…çš„é‡‡é›†æŒ‡æ ‡ã€‚ä¾‹å¦‚ï¼Œå½“é‡‡ç”¨é»˜è®¤å€¼10000æ¯«ç§’æ—¶ï¼Œ æ–­è·¯å™¨é»˜è®¤å°†å…¶æ‹†åˆ†æˆ10ä¸ªæ¡¶ï¼ˆæ¡¶çš„æ•°é‡ä¹Ÿå¯é€šè¿‡metrics.rollingStats.numBucketså‚æ•°è®¾ç½®ï¼‰ï¼Œæ¯ä¸ªæ¡¶è®°å½•1000æ¯«ç§’å†…çš„æŒ‡æ ‡ä¿¡æ¯ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®10000å…¨å±€é…ç½®hystrix.command.default.metrics.rollingStats.timeinMillisecondså®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€metrics.rollingStats.timeinMillisecondsâ€,value=â€20000â€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.metrics.rollingStats.timeinMillisecondsmetrics.rollingstats.numBuckets: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®æ»šåŠ¨æ—¶é—´çª—ç»Ÿè®¡æŒ‡æ ‡ä¿¡æ¯æ—¶åˆ’åˆ†â€œæ¡¶â€ çš„æ•°é‡ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®10å…¨å±€é…ç½®hystrix.command.default.metrics.rollingStats.numBucketså®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€metrics.rollingStats.numBucketsâ€,value=â€20â€)å®žä¾‹é…ç½®hystrix.comrnand.HystrixComrnandKey.metrics.rollingStats.numBucketsmetrics.rollingPercentile.enabled: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®å¯¹å‘½ä»¤æ‰§è¡Œçš„å»¶è¿Ÿæ˜¯å¦ä½¿ç”¨ç™¾åˆ†ä½æ•°æ¥è·Ÿè¸ªå’Œè®¡ç®—ã€‚å¦‚æžœè®¾ç½®ä¸ºfalseï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ¦‚è¦ç»Ÿè®¡éƒ½å°†è¿”å›ž-1ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®trueå…¨å±€é…ç½®hystrix.command.default.metrics.rollingPercentile.enabledå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€metrics.rollingPercentile.enabledâ€, value=â€falseâ€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.metrics.rollingPercentile.enabledmetrics.rollingPercentile.timeinMilliseconds: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®ç™¾åˆ†ä½ç»Ÿè®¡çš„æ»šåŠ¨çª—å£çš„æŒç»­æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®60000å…¨å±€é…ç½®hystrix.command.default.metrics.rollingPercentile.timeinMillisecondså®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€metrics.rollingPercentile.timeinMillisecondsâ€, value=â€50000â€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.metrics.rollingPercentile.timeinMillisecondsmetrics.rollingPercentile.numBuckets: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®ç™¾åˆ†ä½ç»Ÿè®¡æ»šåŠ¨çª—å£ä¸­ä½¿ç”¨â€œæ¡¶â€çš„æ•°é‡ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®6å…¨å±€é…ç½®hystrix.command.default.metrics.rollingPercentile.numBucketså®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€metrics.rollingPercentilee.numBucketsâ€,value=â€5â€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.metrics.rollingPercentile.numBucketsmetrics.rollingPercentile.bucketSize: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ¯ä¸ªâ€œæ¡¶â€ ä¸­ä¿ç•™çš„æœ€å¤§æ‰§è¡Œæ¬¡æ•°ã€‚å¦‚æžœåœ¨æ»šåŠ¨æ—¶é—´çª—å†…å‘ç”Ÿè¶…è¿‡è¯¥è®¾å®šå€¼çš„æ‰§è¡Œæ¬¡æ•°ï¼Œå°±ä»Žæœ€åˆçš„ä½ç½®å¼€å§‹é‡å†™ã€‚ä¾‹å¦‚ï¼Œå°†è¯¥å€¼è®¾ç½®ä¸º100, æ»šåŠ¨çª—å£ä¸º10ç§’ï¼Œè‹¥åœ¨10ç§’å†…ä¸€ä¸ªâ€œæ¡¶â€ä¸­å‘ç”Ÿäº†500æ¬¡æ‰§è¡Œï¼Œé‚£ä¹ˆè¯¥â€œæ¡¶â€ä¸­åªä¿ç•™æœ€åŽçš„100æ¬¡æ‰§è¡Œçš„ç»Ÿè®¡ã€‚å¦å¤–ï¼Œå¢žåŠ è¯¥å€¼çš„å¤§å°å°†ä¼šå¢žåŠ å†…å­˜é‡çš„æ¶ˆè€—ï¼Œå¹¶å¢žåŠ æŽ’åºç™¾åˆ†ä½æ•°æ‰€éœ€çš„è®¡ç®—æ—¶é—´ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®100å…¨å±€é…ç½®hystrix.command.default.metrics.rollingPercentile.bucketSizeå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€metrics.rollingPercentile.bucketSizeâ€,value= â€œ120â€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.metrics.rollingPercentile.bucketSizemetrics.healthSnapshot.intervalinMilliseconds: è¯¥å±žæ€§ç”¨æ¥è®¾ç½®é‡‡é›†å½±å“æ–­è·¯å™¨çŠ¶æ€çš„å¥åº·å¿«ç…§ï¼ˆè¯·æ±‚çš„æˆåŠŸã€é”™è¯¯ç™¾åˆ†æ¯”ï¼‰çš„é—´éš”ç­‰å¾…æ—¶é—´ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®500å…¨å±€é…ç½®hystrix.comrnand.default.metrics.healthSnapshot.intervalinMillisecondså®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€metrics.healthSnapshot.intervalinMillisecondsâ€,value=â€600â€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.metrics.healthSnapshot.intervalinMillisecondsrequestContextrequestCache.enabled: æ­¤å±žæ€§ç”¨æ¥é…ç½®æ˜¯å¦å¼€å¯è¯·æ±‚ç¼“å­˜ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®trueå…¨å±€é…ç½®hystrix.command.default.requestCache.enabledå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€requestCache.enabledâ€, value=â€falseâ€)å®žä¾‹é…ç½®hystrix.command.HystrixCommandKey.requestCache.enabledcollapsermaxRequestsinBatch: è¯¥å‚æ•°ç”¨æ¥è®¾ç½®ä¸€æ¬¡è¯·æ±‚åˆå¹¶æ‰¹å¤„ç†ä¸­å…è®¸çš„æœ€å¤§è¯·æ±‚æ•°ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®Integer.MAX_VALUEå…¨å±€é…ç½®hystrix.collapser.default.maxRequestsinBatchå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€maxRequestsinBatchâ€,value=â€falseâ€)å®žä¾‹é…ç½®hystrix.collapser.HystrixCollapserKey.maxRequestsinBatchtimerDelayinMilliseconds: è¯¥å‚æ•°ç”¨æ¥è®¾ç½®æ‰¹å¤„ç†è¿‡ç¨‹ä¸­æ¯ä¸ªå‘½ä»¤å»¶è¿Ÿçš„æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®10å…¨å±€é…ç½®hystrix.collapser.default.timerDelayinMillisecondså®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€timerDelayinMillisecondsâ€,value=â€20â€)å®žä¾‹é…ç½®hystrix.collapser.HystrixCollapserKey.timerDelayinMillisecondsrequest Cache.enabled: è¯¥å‚æ•°ç”¨æ¥è®¾ç½®æ‰¹å¤„ç†è¿‡ç¨‹ä¸­æ˜¯å¦å¼€å¯è¯·æ±‚ç¼“å­˜ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®trueå…¨å±€é…ç½®hystrix.collapser.default.requestCache.enabledå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€requestCache.enabledâ€, value=â€falseâ€)å®žä¾‹é…ç½®hystrix.collapser.HystrixCollapserKey.requestCache.enabledthreadPoolcoreSize: è¯¥å‚æ•°ç”¨æ¥è®¾ç½®æ‰§è¡Œå‘½ä»¤çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œè¯¥å€¼ä¹Ÿå°±æ˜¯å‘½ä»¤æ‰§è¡Œçš„æœ€å¤§å¹¶å‘é‡ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®10å…¨å±€é…ç½®hystrix.threadpool.default.coreSizeå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€coreSizeâ€, value=â€falseâ€)å®žä¾‹é…ç½®hystrix.threadpool.HystrixThreadPoolKey.coreSizemaxQueueSize: è¯¥å‚æ•°ç”¨æ¥è®¾ç½®çº¿ç¨‹æ± çš„æœ€å¤§é˜Ÿåˆ—å¤§å°ã€‚å½“è®¾ç½®ä¸º-1æ—¶ï¼Œçº¿ç¨‹æ± å°†ä½¿ç”¨SynchronousQueueå®žçŽ°çš„é˜Ÿåˆ—ï¼Œå¦åˆ™å°†ä½¿ç”¨LinkedBlockingQueueå®žçŽ°çš„é˜Ÿåˆ—ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®-1å…¨å±€é…ç½®hystrix.threadpool.default.maxQueueSizeå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€maxQueueSizeâ€,value=â€lOâ€)å®žä¾‹é…ç½®hystrix.threadpool.HystrixThreadPoolKey.maxQueueSizequeueSizeRejectionThreshold: è¯¥å‚æ•°ç”¨æ¥ä¸ºé˜Ÿåˆ—è®¾ç½®æ‹’ç»é˜ˆå€¼ã€‚é€šè¿‡è¯¥å‚æ•°ï¼Œå³ä½¿é˜Ÿåˆ—æ²¡æœ‰è¾¾åˆ°æœ€å¤§å€¼ä¹Ÿèƒ½æ‹’ç»è¯·æ±‚ã€‚è¯¥å‚æ•°ä¸»è¦æ˜¯å¯¹LinkedBlockingQueueé˜Ÿåˆ—çš„è¡¥å……ï¼Œ å› ä¸ºLinkedBlockingQueueé˜Ÿåˆ—ä¸èƒ½åŠ¨æ€ä¿®æ”¹å®ƒçš„å¯¹è±¡å¤§å°ï¼Œè€Œé€šè¿‡è¯¥å±žæ€§å°±å¯ä»¥è°ƒæ•´æ‹’ç»è¯·æ±‚çš„é˜Ÿåˆ—å¤§å°äº†ã€‚å±žæ€§çº§åˆ«é»˜è®¤å€¼ã€é…ç½®æ–¹å¼ã€é…ç½®å±žæ€§å…¨å±€é»˜è®¤é…ç½®5å…¨å±€é…ç½®hystrix.threadpool.default.queueSizeRejectionThresholdå®žä¾‹é»˜è®¤å€¼@HystrixProperty(name=â€queueSizeRejectionThresholdâ€, value=â€lOâ€å®žä¾‹é…ç½®hystrix.threadpool.HystrixThreadPoolKey.queueSizeRejectionThresholdä¸å¾—ä¸è¯´ï¼Œé…ç½®æ˜¯çœŸçš„å¤šâ€¦â€¦æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/30.Spring-Cloud-Hystrix-Circuit-Breakerå‚è€ƒæ–‡ç«  ã€ŠSpring Cloudå¾®æœåŠ¡å®žæˆ˜ã€‹]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Cloud</tag>
        <tag>Hystrix</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud Ribbonå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡]]></title>
    <url>%2FSpring-Cloud-Ribbon-LoadBalance.html</url>
    <content type="text"><![CDATA[ä¸ºäº†æé«˜æœåŠ¡çš„å¯ç”¨æ€§ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå°†ç›¸åŒçš„æœåŠ¡éƒ¨ç½²å¤šä¸ªå®žä¾‹ï¼Œè´Ÿè½½å‡è¡¡çš„ä½œç”¨å°±æ˜¯ä½¿èŽ·å–æœåŠ¡çš„è¯·æ±‚è¢«å‡è¡¡çš„åˆ†é…åˆ°å„ä¸ªå®žä¾‹ä¸­ã€‚è´Ÿè½½å‡è¡¡ä¸€èˆ¬åˆ†ä¸ºæœåŠ¡ç«¯è´Ÿè½½å‡è¡¡å’Œå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼ŒæœåŠ¡ç«¯çš„è´Ÿè½½å‡è¡¡é€šè¿‡ç¡¬ä»¶ï¼ˆå¦‚F5ï¼‰æˆ–è€…è½¯ä»¶ï¼ˆå¦‚Nginxï¼‰æ¥å®žçŽ°ï¼Œè€ŒRibbonå®žçŽ°çš„æ˜¯å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ã€‚æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡æ˜¯åœ¨ç¡¬ä»¶è®¾å¤‡æˆ–è€…è½¯ä»¶æ¨¡å—ä¸­ç»´æŠ¤ä¸€ä»½å¯ç”¨æœåŠ¡æ¸…å•ï¼Œç„¶åŽå®¢æˆ·ç«¯å‘é€æœåŠ¡è¯·æ±‚åˆ°è¿™äº›è´Ÿè½½å‡è¡¡çš„è®¾å¤‡ä¸Šï¼Œè¿™äº›è®¾å¤‡æ ¹æ®ä¸€äº›ç®—æ³•å‡è¡¡çš„å°†è¯·æ±‚è½¬å‘å‡ºåŽ»ã€‚è€Œå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡åˆ™æ˜¯å®¢æˆ·ç«¯è‡ªå·±ä»ŽæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚ä¹‹å‰æåˆ°çš„Eureka Serverï¼‰ä¸­èŽ·å–æœåŠ¡æ¸…å•ç¼“å­˜åˆ°æœ¬åœ°ï¼Œç„¶åŽé€šè¿‡Ribbonå†…éƒ¨ç®—æ³•å‡è¡¡çš„åŽ»è®¿é—®è¿™äº›æœåŠ¡ã€‚Ribbonç®€ä»‹Ribbonæ˜¯ç”±Netflixå¼€å‘çš„ä¸€æ¬¾åŸºäºŽHTTPå’ŒTCPçš„è´Ÿè½½å‡è¡¡çš„å¼€æºè½¯ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ç›´æŽ¥ç»™Ribboné…ç½®å¥½æœåŠ¡åˆ—è¡¨æ¸…å•ï¼Œä¹Ÿå¯ä»¥é…åˆEurekaä¸»åŠ¨çš„åŽ»èŽ·å–æœåŠ¡æ¸…å•ï¼Œéœ€è¦ä½¿ç”¨åˆ°è¿™äº›æœåŠ¡çš„æ—¶å€™Ribboné€šè¿‡è½®è¯¢æˆ–è€…éšæœºç­‰å‡è¡¡ç®—æ³•åŽ»èŽ·å–æœåŠ¡ã€‚åœ¨Spring Cloud EurekaæœåŠ¡æ²»ç†ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»åœ¨Server-Consumerä¸­é…ç½®äº†Ribbonï¼Œå¹¶é€šè¿‡åŠ äº†@LoadBalancedæ³¨è§£çš„RestTemplateå¯¹è±¡åŽ»å‡è¡¡çš„æ¶ˆè´¹æœåŠ¡ï¼Œæ‰€ä»¥è¿™èŠ‚ä¸»è¦è®°å½•çš„æ˜¯RestTemplateçš„è¯¦ç»†ä½¿ç”¨æ–¹æ³•å’Œä¸€äº›é¢å¤–çš„Ribboné…ç½®ã€‚RestTemplateè¯¦è§£ä»Žåç§°ä¸Šæ¥çœ‹å°±å¯ä»¥çŸ¥é“å®ƒæ˜¯ä¸€ä¸ªç”¨æ¥å‘é€RESTè¯·æ±‚çš„æ‘¸æ¿ï¼Œæ‰€ä»¥åŒ…å«äº†GET,POST,PUT,DELETEç­‰HTTP Methodå¯¹åº”çš„æ–¹æ³•ã€‚å‘é€Getè¯·æ±‚RestTemplateä¸­ä¸ŽGETè¯·æ±‚å¯¹åº”çš„æ–¹æ³•æœ‰getForEntityå’ŒgetForObjectã€‚getForEntitygetForEntityæ–¹æ³•è¿”å›žResponseEntityå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†è¿”å›žæŠ¥æ–‡å¤´ï¼ŒæŠ¥æ–‡ä½“å’ŒçŠ¶æ€ç ç­‰ä¿¡æ¯ã€‚getForEntityæœ‰ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼šgetForEntity(String url, Class&lt;T&gt; responseType, Object... uriVariables)ï¼›getForEntity(String url, Class&lt;T&gt; responseType, Map&lt;String, ?&gt; uriVariables)ï¼›getForEntity(URI url, Class&lt;T&gt; responseType)ï¼›ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºUrlï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¿”å›žå€¼çš„ç±»åž‹ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºè¯·æ±‚çš„å‚æ•°ï¼ˆå¯ä»¥æ˜¯æ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯Mapï¼‰ã€‚ä¸¾ä¸ªgetForEntity(String url, Class&lt;T&gt; responseType, Object... uriVariables)çš„ä½¿ç”¨ä¾‹å­ï¼š1234@GetMapping("user/&#123;id:\\d+&#125;")public User getUser(@PathVariable Long id) &#123; return this.restTemplate.getForEntity("http://Server-Provider/user/&#123;name&#125;", User.class, id).getBody();&#125;{1}ä¸ºå‚æ•°çš„å ä½ç¬¦ï¼ŒåŒ¹é…å‚æ•°æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚å› ä¸ºç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šäº†ç±»åž‹ä¸ºUserï¼Œæ‰€ä»¥è°ƒç”¨getBodyæ–¹æ³•è¿”å›žç±»åž‹ä¹Ÿä¸ºUserã€‚æ–¹æ³•å‚æ•°é™¤äº†å¯ä»¥æ”¾åœ¨æ•°ç»„é‡Œå¤–ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨Mapé‡Œï¼Œä¸¾ä¸ªgetForEntity(String url, Class&lt;T&gt; responseType, Map&lt;String, ?&gt; uriVariables)ä½¿ç”¨ä¾‹å­ï¼š123456@GetMapping("user/&#123;id:\\d+&#125;")public User getUser(@PathVariable Long id) &#123; Map&lt;String, Object&gt; params = new HashMap&lt;&gt;(); params.put("id", id); return this.restTemplate.getForEntity("http://Server-Provider/user/&#123;id&#125;", User.class, params).getBody();&#125;åªæœ‰ä¸¤ä¸ªå‚æ•°çš„é‡è½½æ–¹æ³•getForEntity(URI url, Class&lt;T&gt; responseType)ç¬¬ä¸€ä¸ªå‚æ•°æŽ¥æ”¶java.net.URIç±»åž‹ï¼Œå¯ä»¥é€šè¿‡org.springframework.web.util.UriComponentsBuilderæ¥åˆ›å»ºï¼Œä¸¾ä¸ªè¯¥æ–¹æ³•çš„ä½¿ç”¨ä¾‹å­ï¼š12345678@GetMapping("user/&#123;id:\\d+&#125;")public User getUser(@PathVariable Long id) &#123; Map&lt;String, Object&gt; params = new HashMap&lt;&gt;(); params.put("id", id); URI uri = UriComponentsBuilder.fromUriString("http://Server-Provider/user/&#123;id&#125;") .build().expand(params).encode().toUri(); return this.restTemplate.getForEntity(uri, User.class).getBody();&#125;å…¶ä¸­expandæ–¹æ³•ä¹Ÿå¯ä»¥æŽ¥æ”¶æ•°ç»„å’ŒMapä¸¤ç§ç±»åž‹çš„å‚æ•°ã€‚getForObjectgetForObjectæ–¹æ³•å’ŒgetForEntityæ–¹æ³•ç±»ä¼¼ï¼ŒgetForObjectæ–¹æ³•ç›¸å½“äºŽgetForEntityæ–¹æ³•è°ƒç”¨äº†getBodyæ–¹æ³•ï¼Œç›´æŽ¥è¿”å›žç»“æžœå¯¹è±¡ï¼Œä¸ºä¸æ˜¯ResponseEntityå¯¹è±¡ã€‚getForObjectæ–¹æ³•å’ŒgetForEntityæ–¹æ³•ä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼Œå‚æ•°ç±»åž‹å’ŒgetForEntityæ–¹æ³•ä¸€è‡´ï¼Œæ‰€ä»¥ä¸å†åˆ—å‡ºã€‚å‘é€POSTè¯·æ±‚ä½¿ç”¨RestTemplateå‘é€POSTè¯·æ±‚ä¸»è¦æœ‰postForEntityï¼ŒpostForObjectå’ŒpostForLocationï¼ˆè¿™ä¸ªç›®å‰è¾ƒå°‘ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸åšä»‹ç»ï¼‰ä¸‰ä¸ªæ–¹æ³•ã€‚postForEntityå’ŒpostForObjectä¹Ÿåˆ†åˆ«æœ‰ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼Œæ–¹æ³•å‚æ•°å’Œä½¿ç”¨æ–¹å¼å’Œä¸Šé¢ä»‹ç»çš„getForEntityå’ŒgetForObjectä¸€æ ·ï¼Œæ‰€ä»¥ä¸å†è¯¦ç»†ä»‹ç»ã€‚ç®€å•ä¸¾ä¸ªgetForObjectçš„ä½¿ç”¨ä¾‹å­ï¼š1234 @GetMapping("user")public List&lt;User&gt; getUsers() &#123; return this.restTemplate.getForObject("http://Server-Provider/user", List.class);&#125;å‘é€PUTè¯·æ±‚ä½¿ç”¨RestTemplateå‘é€PUTè¯·æ±‚ï¼Œä½¿ç”¨çš„æ˜¯å®ƒçš„putæ–¹æ³•ï¼Œputæ–¹æ³•è¿”å›žå€¼æ˜¯voidç±»åž‹ï¼Œè¯¥æ–¹æ³•ä¹Ÿæœ‰ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼šput(String url, Object request, Object... uriVariables)ï¼›put(String url, Object request, Map&lt;String, ?&gt; uriVariables)ï¼›put(URI url, Object request)ã€‚ä¸¾ä¸ªä¾‹å­ï¼š12345@GetMapping("user/update")public void updateUser() throws JsonProcessingException &#123; User user = new User(1L, "mrbird", "123456"); this.restTemplate.put("http://Server-Provider/user", user);&#125;åœ¨RESTfulé£Žæ ¼çš„æŽ¥å£ä¸­ï¼Œåˆ¤æ–­æˆåŠŸå¤±è´¥ä¸å†æ˜¯é€šè¿‡è¿”å›žå€¼çš„æŸä¸ªæ ‡è¯†æ¥åˆ¤æ–­çš„ï¼Œè€Œæ˜¯é€šè¿‡è¿”å›žæŠ¥æ–‡çš„çŠ¶æ€ç æ˜¯å¦ä¸º200æ¥åˆ¤æ–­ã€‚å½“è¿™ä¸ªæ–¹æ³•æˆåŠŸæ‰§è¡Œå¹¶è¿”å›žæ—¶ï¼Œè¿”å›žæŠ¥æ–‡çŠ¶æ€ä¸º200ï¼Œå³å¯åˆ¤æ–­æ–¹æ³•æ‰§è¡ŒæˆåŠŸã€‚å‘é€DELETEè¯·æ±‚ä½¿ç”¨RestTemplateå‘é€DELETEè¯·æ±‚ï¼Œä½¿ç”¨çš„æ˜¯å®ƒçš„deleteæ–¹æ³•ï¼Œdeleteæ–¹æ³•è¿”å›žå€¼æ˜¯voidç±»åž‹ï¼Œè¯¥æ–¹æ³•ä¹Ÿæœ‰ä¸‰ä¸ªé‡è½½æ–¹æ³•ï¼šdelete(String url, Object... uriVariables)ï¼›delete(String url, Map&lt;String, ?&gt; uriVariables);delete(URI url)ã€‚ä¸¾ä¸ªä¾‹å­ï¼š1234@GetMapping("user/delete/&#123;id:\\d+&#125;")public void deleteUser(@PathVariable Long id) &#123; this.restTemplate.delete("http://Server-Provider/user/&#123;1&#125;", id);&#125;RestTemplateså®žæˆ˜æˆ‘ä»¬åœ¨Spring Cloud EurekaæœåŠ¡æ²»ç†ä¸­çš„Eurekaå®¢æˆ·ç«¯ï¼ˆServer-Providerï¼‰ä¸­ç¼–å†™ä¸€å¥—RESTfulé£Žæ ¼çš„æµ‹è¯•æŽ¥å£ï¼š1234567891011121314151617181920212223242526272829303132333435@RestController@RequestMapping("user")public class UserController &#123; private Logger log = LoggerFactory.getLogger(this.getClass()); @GetMapping("/&#123;id:\\d+&#125;") public User get(@PathVariable Long id) &#123; log.info("èŽ·å–ç”¨æˆ·idä¸º " + id + "çš„ä¿¡æ¯"); return new User(id, "mrbird", "123456"); &#125; @GetMapping public List&lt;User&gt; get() &#123; List&lt;User&gt; list = new ArrayList&lt;&gt;(); list.add(new User(1L, "mrbird", "123456")); list.add(new User(2L, "scott", "123456")); log.info("èŽ·å–ç”¨æˆ·ä¿¡æ¯ " + list); return list; &#125; @PostMapping public void add(@RequestBody User user) &#123; log.info("æ–°å¢žç”¨æˆ·æˆåŠŸ " + user); &#125; @PutMapping public void update(@RequestBody User user) &#123; log.info("æ›´æ–°ç”¨æˆ·æˆåŠŸ " + user); &#125; @DeleteMapping("/&#123;id:\\d+&#125;") public void delete(@PathVariable Long id) &#123; log.info("åˆ é™¤ç”¨æˆ·æˆåŠŸ " + id); &#125;&#125;Userå¯¹è±¡ä»£ç ï¼š12345678910111213141516171819202122232425public class User implements Serializable &#123; private static final long serialVersionUID = 1339434510787399891L; private Long id; private String username; private String password; public User() &#123; &#125; public User(Long id, String username, String password) &#123; this.id = id; this.username = username; this.password = password; &#125; @Override public String toString() &#123; return "User&#123;" + "id=" + id + ", username='" + username + '\'' + ", password='" + password + '\'' + '&#125;'; &#125; // get,setç•¥&#125;éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒUserå¯¹è±¡å¿…é¡»æœ‰é»˜è®¤çš„æž„é€ æ–¹æ³•ï¼Œå¦åˆ™åœ¨JSONä¸Žå®žä½“å¯¹è±¡è½¬æ¢çš„æ—¶å€™ä¼šæŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸ï¼šJSON parse error: Can not construct instance of model.Class: no suitable constructor foundç„¶åŽåœ¨Server-Consumerä¸­ä½¿ç”¨RestTemplatesåˆ†åˆ«åŽ»èŽ·å–è¿™äº›æœåŠ¡ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142@RestControllerpublic class TestController &#123; @Autowired private RestTemplate restTemplate; @GetMapping("user/&#123;id:\\d+&#125;") public User getUser(@PathVariable Long id) &#123; Map&lt;String, Object&gt; params = new HashMap&lt;&gt;(); params.put("id", id); URI uri = UriComponentsBuilder.fromUriString("http://Server-Provider/user/&#123;id&#125;") .build().expand(params).encode().toUri(); return this.restTemplate.getForEntity(uri, User.class).getBody(); &#125; @GetMapping("user") public List&lt;User&gt; getUsers() &#123; return this.restTemplate.getForObject("http://Server-Provider/user", List.class); &#125; @GetMapping("user/add") public String addUser() &#123; User user = new User(1L, "mrbird", "123456"); HttpStatus status = this.restTemplate.postForEntity("http://Server-Provider/user", user, null).getStatusCode(); if (status.is2xxSuccessful()) &#123; return "æ–°å¢žç”¨æˆ·æˆåŠŸ"; &#125; else &#123; return "æ–°å¢žç”¨æˆ·å¤±è´¥"; &#125; &#125; @GetMapping("user/update") public void updateUser() &#123; User user = new User(1L, "mrbird", "123456"); this.restTemplate.put("http://Server-Provider/user", user); &#125; @GetMapping("user/delete/&#123;id:\\d+&#125;") public void deleteUser(@PathVariable Long id) &#123; this.restTemplate.delete("http://Server-Provider/user/&#123;1&#125;", id); &#125;&#125;æˆ‘ä»¬åˆ†åˆ«å¯åŠ¨ä¸¤ä¸ªEureka Serverç”¨äºŽé›†ç¾¤ï¼Œä¸¤ä¸ªEureka Clientï¼ˆServer-Providerï¼‰å®žä¾‹ï¼Œç„¶åŽå¯åŠ¨Server-Consumerã€‚ä½¿ç”¨Restlet Clientè®¿é—®http://localhost:9000/user/1ï¼ˆåŽé¢æ¯ä¸ªæ–¹æ³•æˆ‘ä»¬éƒ½è®¿é—®ä¸¤æ¬¡ï¼Œç”¨äºŽè§‚å¯Ÿè´Ÿè½½å‡è¡¡ï¼‰ï¼Œè¿”å›žç»“æžœå¦‚ä¸‹ï¼šå‰©ä¸‹çš„æ–¹æ³•æµ‹è¯•ç»“æžœè¿™é‡Œä¸è´´å‡ºæ¥äº†ï¼Œå½“æˆ‘ä»¬åˆ†åˆ«è®¿é—®ä¸‹é¢çš„è¿žæŽ¥åŽï¼šhttp://localhost:9000/user/http://localhost:9000/user/addhttp://localhost:9000/user/updatehttp://localhost:9000/user/delete/1æŸ¥çœ‹Eurekaå®¢æˆ·ç«¯8082å’Œ8083çš„åŽå°æ—¥å¿—ï¼š123456789101112131415161718192021222324252018-06-03 18:17:26.231 INFO 11188 --- [ main] .s.c.n.e.s.EurekaAutoServiceRegistration : Updating port to 80832018-06-03 18:17:26.236 INFO 11188 --- [ main] com.example.demo.DemoApplication : Started DemoApplication in 52.252 seconds (JVM running for 54.321)2018-06-03 18:21:29.097 INFO 11188 --- [io-8083-exec-10] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring FrameworkServlet &apos;dispatcherServlet&apos;2018-06-03 18:21:29.098 INFO 11188 --- [io-8083-exec-10] o.s.web.servlet.DispatcherServlet : FrameworkServlet &apos;dispatcherServlet&apos;: initialization started2018-06-03 18:21:29.177 INFO 11188 --- [io-8083-exec-10] o.s.web.servlet.DispatcherServlet : FrameworkServlet &apos;dispatcherServlet&apos;: initialization completed in 79 ms2018-06-03 18:21:29.312 INFO 11188 --- [io-8083-exec-10] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-03 18:21:50.798 INFO 11188 --- [nio-8083-exec-9] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·ä¿¡æ¯ [User&#123;id=1, username=&apos;mrbird&apos;, password=&apos;123456&apos;&#125;, User&#123;id=2, username=&apos;scott&apos;, password=&apos;123456&apos;&#125;]2018-06-03 18:22:25.351 INFO 11188 --- [trap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver : Resolving eureka endpoints via configuration2018-06-03 18:22:44.718 INFO 11188 --- [nio-8083-exec-8] c.e.demo.controller.UserController : æ–°å¢žç”¨æˆ·æˆåŠŸ User&#123;id=1, username=&apos;mrbird&apos;, password=&apos;123456&apos;&#125;2018-06-03 18:24:34.313 INFO 11188 --- [nio-8083-exec-6] c.e.demo.controller.UserController : åˆ é™¤ç”¨æˆ·æˆåŠŸ 12018-06-03 18:17:21.296 INFO 16188 --- [ main] .s.c.n.e.s.EurekaAutoServiceRegistration : Updating port to 80822018-06-03 18:17:21.303 INFO 16188 --- [ main] com.example.demo.DemoApplication : Started DemoApplication in 57.152 seconds (JVM running for 58.239)2018-06-03 18:21:27.517 INFO 16188 --- [io-8082-exec-10] o.a.c.c.C.[Tomcat].[localhost].[/] : Initializing Spring FrameworkServlet &apos;dispatcherServlet&apos;2018-06-03 18:21:27.517 INFO 16188 --- [io-8082-exec-10] o.s.web.servlet.DispatcherServlet : FrameworkServlet &apos;dispatcherServlet&apos;: initialization started2018-06-03 18:21:27.567 INFO 16188 --- [io-8082-exec-10] o.s.web.servlet.DispatcherServlet : FrameworkServlet &apos;dispatcherServlet&apos;: initialization completed in 50 ms2018-06-03 18:21:27.732 INFO 16188 --- [io-8082-exec-10] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·idä¸º 1çš„ä¿¡æ¯2018-06-03 18:21:49.639 INFO 16188 --- [nio-8082-exec-9] c.e.demo.controller.UserController : èŽ·å–ç”¨æˆ·ä¿¡æ¯ [User&#123;id=1, username=&apos;mrbird&apos;, password=&apos;123456&apos;&#125;, User&#123;id=2, username=&apos;scott&apos;, password=&apos;123456&apos;&#125;]2018-06-03 18:22:12.313 INFO 16188 --- [trap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver : Resolving eureka endpoints via configuration2018-06-03 18:22:46.111 INFO 16188 --- [nio-8082-exec-8] c.e.demo.controller.UserController : æ–°å¢žç”¨æˆ·æˆåŠŸ User&#123;id=1, username=&apos;mrbird&apos;, password=&apos;123456&apos;&#125;2018-06-03 18:23:55.732 INFO 16188 --- [nio-8082-exec-6] c.e.demo.controller.UserController : æ›´æ–°ç”¨æˆ·æˆåŠŸ User&#123;id=1, username=&apos;mrbird&apos;, password=&apos;123456&apos;&#125;2018-06-03 18:23:58.297 INFO 16188 --- [nio-8082-exec-5] c.e.demo.controller.UserController : æ›´æ–°ç”¨æˆ·æˆåŠŸ User&#123;id=1, username=&apos;mrbird&apos;, password=&apos;123456&apos;&#125;2018-06-03 18:24:37.266 INFO 16188 --- [nio-8082-exec-3] c.e.demo.controller.UserController : åˆ é™¤ç”¨æˆ·æˆåŠŸ 12018-06-03 18:27:12.314 INFO 16188 --- [trap-executor-0] c.n.d.s.r.aws.ConfigClusterResolver : Resolving eureka endpoints via configurationå‘çŽ°æ–¹æ³•éƒ½æˆåŠŸè°ƒç”¨ï¼Œå¹¶ä¸”æ˜¯å‡è¡¡çš„ã€‚Spring Cloud Ribboné…ç½®Spring Cloud Ribbonçš„é…ç½®åˆ†ä¸ºå…¨å±€å’ŒæŒ‡å®šæœåŠ¡åç§°ã€‚æ¯”å¦‚æˆ‘è¦æŒ‡å®šå…¨å±€çš„æœåŠ¡è¯·æ±‚è¿žæŽ¥è¶…æ—¶æ—¶é—´ä¸º200æ¯«ç§’ï¼š12ribbon: ConnectTimeout: 200å¦‚æžœåªæ˜¯è®¾ç½®èŽ·å–Server ProvideræœåŠ¡çš„è¯·æ±‚è¿žæŽ¥è¶…æ—¶æ—¶é—´ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨é…ç½®æœ€å‰é¢åŠ ä¸ŠæœåŠ¡åç§°å°±è¡Œäº†ï¼Œå¦‚ï¼š123Server-Provider: ribbon: ConnectTimeout: 200è®¾ç½®èŽ·å–Server-ProvideræœåŠ¡çš„è´Ÿè½½å‡è¡¡ç®—æ³•ä»Žè½®è¯¢æ”¹ä¸ºéšæœºï¼š123Server-Provider: ribbon: NFLoadBalancerRuleClassName: com.netflix.loadbalancer.RandomRuleè®¾ç½®å¤„ç†Server-ProvideræœåŠ¡çš„è¶…æ—¶æ—¶é—´ï¼š123Server-Provider: ribbon: ReadTimeout: 1000å¼€å¯é‡è¯•æœºåˆ¶ï¼Œå³èŽ·å–æœåŠ¡å¤±è´¥æ˜¯å¦ä»Žå¦å¤–ä¸€ä¸ªèŠ‚ç‚¹é‡è¯•ï¼Œé»˜è®¤å€¼ä¸ºfalseï¼š12345spring: cloud: loadbalancer: retry: enabled: trueå¯¹Server-Providerçš„æ‰€æœ‰è¯·æ±‚åœ¨å¤±è´¥çš„æ—¶å€™éƒ½è¿›è¡Œé‡è¯•ï¼š123Server-Provider: ribbon: OkToRetryOnAllOperations: trueåˆ‡æ¢Server-Providerå®žä¾‹çš„é‡è¯•æ¬¡æ•°ï¼š123Server-Provider: ribbon: MaxAutoRetriesNextServer: 1å¯¹Server-Providerå½“å‰å®žä¾‹çš„é‡è¯•æ¬¡æ•°ï¼š123Server-Provider: ribbon: MaxAutoRetries: 1æ ¹æ®å¦‚ä¸Šé…ç½®å½“è®¿é—®Server-ProvideræœåŠ¡å®žä¾‹ï¼ˆæ¯”å¦‚æ˜¯8082ï¼‰é‡åˆ°æ•…éšœçš„æ—¶å€™ï¼ŒRibbonä¼šå†å°è¯•è®¿é—®ä¸€æ¬¡å½“å‰å®žä¾‹ï¼ˆæ¬¡æ•°ç”±MaxAutoRetriesé…ç½®ï¼‰ï¼Œå¦‚æžœä¸è¡Œï¼Œå°±æ¢åˆ°8083å®žä¾‹è¿›è¡Œè®¿é—®ï¼ˆæ›´æ¢æ¬¡æ•°ç”± MaxAutoRetriesNextServerå†³å®šï¼‰ï¼Œå¦‚æžœè¿˜æ˜¯ä¸è¡Œï¼Œé‚£å°±GGæ€å¯†è¾¾ï¼Œè¿”å›žå¤±è´¥ã€‚å¦‚æžœä¸å’ŒEurekaæ­é…ä½¿ç”¨çš„è¯ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰‹åŠ¨æŒ‡å®šæœåŠ¡æ¸…å•ç»™Ribbonï¼š123Server-Provider: ribbon: listOfServers: localhost:8082,localhost:8083ä¸Šé¢é…ç½®äº†åç§°ä¸ºServer-Providerçš„æœåŠ¡ï¼Œæœ‰ä¸¤ä¸ªèŠ‚ç‚¹å¯ä¾›ä½¿ç”¨ï¼ˆ8082å’Œ8083ï¼‰ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/29.Spring-Cloud-Ribbon-LoadBalanceå‚è€ƒæ–‡ç«  ã€ŠSpring Cloudå¾®æœåŠ¡å®žæˆ˜ã€‹]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Cloud</tag>
        <tag>Ribbon</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud EurekaæœåŠ¡æ²»ç†]]></title>
    <url>%2FSpring-Cloud-Eureka.html</url>
    <content type="text"><![CDATA[è€ƒè™‘å½“å‰æœ‰ä¸¤ä¸ªå¾®æœåŠ¡å®žä¾‹Aå’ŒBï¼ŒAæœåŠ¡éœ€è¦è°ƒç”¨BæœåŠ¡çš„æŸä¸ªRESTæŽ¥å£ã€‚å‡å¦‚æŸä¸€å¤©BæœåŠ¡è¿ç§»åˆ°äº†å¦å¤–ä¸€å°æœåŠ¡å™¨ï¼ŒIPå’Œç«¯å£ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä¸å¾—ä¸åŽ»ä¿®æ”¹AæœåŠ¡ä¸­è°ƒç”¨BæœåŠ¡RESTæŽ¥å£çš„é™æ€é…ç½®ã€‚éšç€å…¬å¸ä¸šåŠ¡çš„å‘å±•ï¼Œå¾®æœåŠ¡çš„æ•°é‡ä¹Ÿè¶Šæ¥è¶Šå¤šï¼ŒæœåŠ¡é—´çš„å…³ç³»å¯èƒ½å˜å¾—éžå¸¸å¤æ‚ï¼Œä¼ ç»Ÿçš„å¾®æœåŠ¡ç»´æŠ¤å˜å¾—æ„ˆåŠ å›°éš¾ï¼Œä¹Ÿå¾ˆå®¹æ˜“å‡ºé”™ã€‚æ‰€è°“æœåŠ¡æ²»ç†å°±æ˜¯ç”¨æ¥å®žçŽ°å„ä¸ªå¾®æœåŠ¡å®žä¾‹çš„è‡ªåŠ¨åŒ–æ³¨å†Œä¸Žå‘çŽ°ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒæœåŠ¡é—´çš„è°ƒç”¨ä¸å†é€šè¿‡æŒ‡å®šå…·ä½“çš„å®žä¾‹åœ°å€æ¥å®žçŽ°ï¼Œè€Œæ˜¯é€šè¿‡å‘æœåŠ¡æ³¨å†Œä¸­å¿ƒèŽ·å–æœåŠ¡åå¹¶å‘èµ·è¯·æ±‚è°ƒç”¨å®žçŽ°ã€‚Eurekaæ˜¯ç”±Netflixå¼€å‘çš„ä¸€æ¬¾æœåŠ¡æ²»ç†å¼€æºæ¡†æž¶ï¼ŒSpring-cloudå¯¹å…¶è¿›è¡Œäº†é›†æˆã€‚Eurekaæ—¢åŒ…å«äº†æœåŠ¡ç«¯ä¹ŸåŒ…å«äº†å®¢æˆ·ç«¯ï¼ŒEurekaæœåŠ¡ç«¯æ˜¯ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒ(Eureka Server)ï¼Œæä¾›æœåŠ¡çš„æ³¨å†Œå’Œå‘çŽ°ï¼Œå³å½“å‰æœ‰å“ªäº›æœåŠ¡æ³¨å†Œè¿›æ¥å¯ä¾›ä½¿ç”¨ï¼›Eurekaå®¢æˆ·ç«¯ä¸ºæœåŠ¡æä¾›è€…(Server Provider)ï¼Œå®ƒå°†è‡ªå·±æä¾›çš„æœåŠ¡æ³¨å†Œåˆ°EurekaæœåŠ¡ç«¯ï¼Œå¹¶å‘¨æœŸæ€§åœ°å‘é€å¿ƒè·³æ¥æ›´æ–°å®ƒçš„æœåŠ¡ç§Ÿçº¦ï¼ŒåŒæ—¶ä¹Ÿèƒ½ä»ŽæœåŠ¡ç«¯æŸ¥è¯¢å½“å‰æ³¨å†Œçš„æœåŠ¡ä¿¡æ¯å¹¶æŠŠå®ƒä»¬ç¼“å­˜åˆ°æœ¬åœ°å¹¶å‘¨æœŸæ€§åœ°åˆ·æ–°æœåŠ¡çŠ¶æ€ã€‚è¿™æ ·æœåŠ¡æ¶ˆè´¹è€…(Server Consumer)ä¾¿å¯ä»¥ä»ŽæœåŠ¡æ³¨å†Œä¸­å¿ƒèŽ·å–æœåŠ¡åç§°ï¼Œå¹¶æ¶ˆè´¹æœåŠ¡ã€‚ä¸‰è€…å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤º:æ­å»ºEureka-ServeræœåŠ¡æ³¨å†Œä¸­å¿ƒè¯´äº†é‚£ä¹ˆå¤šï¼Œæˆ‘ä»¬å…ˆæ¥æ­å»ºä¸€ä¸ªEurekaæœåŠ¡ç«¯æ¥å……å½“æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼ŒartifactIdå¡«Eureka-Serviceï¼Œç„¶åŽå¼•å…¥Spring Cloud Edgware.SR3å’Œspring-cloud-starter-eureka-server:123456789101112131415161718&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ @EnableEurekaServeræ³¨è§£ï¼Œè¡¨æ˜Žè¿™æ˜¯ä¸€ä¸ªEurekaæœåŠ¡ç«¯ï¼š1234567@EnableEurekaServer@SpringBootApplicationpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;æŽ¥ç€åœ¨application.ymlä¸­æ·»åŠ ä¸€äº›é…ç½®ï¼š1234567891011server: port: 8080 eureka: instance: hostname: localhost client: register-with-eureka: false fetch-registry: false serviceUrl: defaultZone: http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/ä¸Šé¢é…ç½®äº†æœåŠ¡çš„ç«¯å£ä¸º8080ï¼Œå‰©ä¸‹å‡ ä¸ªä¸ºEurekaé…ç½®ï¼šeureka.instance.hostnameæŒ‡å®šäº†EurekaæœåŠ¡ç«¯çš„IPï¼›eureka.client.register-with-eurekaè¡¨ç¤ºæ˜¯å¦å°†æœåŠ¡æ³¨å†Œåˆ°EurekaæœåŠ¡ç«¯ï¼Œç”±äºŽè‡ªèº«å°±æ˜¯EurekaæœåŠ¡ç«¯ï¼Œæ‰€ä»¥è®¾ç½®ä¸ºfalseï¼›eureka.client.fetch-registryè¡¨ç¤ºæ˜¯å¦ä»ŽEurekaæœåŠ¡ç«¯èŽ·å–æœåŠ¡ä¿¡æ¯ï¼Œå› ä¸ºè¿™é‡Œåªæ­å»ºäº†ä¸€ä¸ªEurekaæœåŠ¡ç«¯ï¼Œå¹¶ä¸éœ€è¦ä»Žåˆ«çš„EurekaæœåŠ¡ç«¯åŒæ­¥æœåŠ¡ä¿¡æ¯ï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®ä¸ºfalseï¼›eureka.client.serviceUrl.defaultZoneæŒ‡å®šEurekaæœåŠ¡ç«¯çš„åœ°å€ï¼Œé»˜è®¤å€¼ä¸ºhttp://localhost:8761/eurekaã€‚é…ç½®å®Œæ¯•åŽå¯åŠ¨æœåŠ¡ï¼Œè®¿é—®http://localhost:8080/ï¼Œå¯çœ‹åˆ°ï¼šç”±äºŽè¿˜æ²¡æœ‰Eurekaå®¢æˆ·ç«¯å°†æœåŠ¡æ³¨å†Œè¿›æ¥ï¼Œæ‰€ä»¥Instances currently registered with Eurekaåˆ—è¡¨æ˜¯ç©ºçš„ã€‚ä¸‹é¢æˆ‘ä»¬æŽ¥ç€æ­å»ºä¸€ä¸ªEurekaå®¢æˆ·ç«¯æ¥æä¾›æœåŠ¡ã€‚æ­å»ºEureka-ClientæœåŠ¡æä¾›è€…æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼ŒartifactIdå¡«Eureka-Clientï¼Œç„¶åŽå¼•å…¥ä»¥ä¸‹ä¾èµ–ï¼š123456789101112131415161718192021&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;æŽ¥ç€ç¼–å†™ä¸€ä¸ªTestControllerï¼Œå¯¹å¤–æä¾›ä¸€äº›RESTæœåŠ¡ï¼š1234567891011121314151617181920@RestControllerpublic class TestController &#123; private Logger log = LoggerFactory.getLogger(this.getClass()); @Autowired private DiscoveryClient client; @GetMapping("/info") public String info() &#123; @SuppressWarnings("deprecation") ServiceInstance instance = client.getLocalServiceInstance(); String info = "hostï¼š" + instance.getHost() + "ï¼Œservice_idï¼š" + instance.getServiceId(); log.info(info); return info; &#125; @GetMapping("/hello") public String hello() &#123; return "hello world"; &#125;&#125;ä¸Šé¢ä»£ç æ³¨å…¥äº†org.springframework.cloud.client.discovery.DiscoveryClientå¯¹è±¡ï¼Œå¯ä»¥èŽ·å–å½“å‰æœåŠ¡çš„ä¸€äº›ä¿¡æ¯ã€‚ç¼–å†™å¯åŠ¨ç±»ï¼Œåœ¨å¯åŠ¨ç±»ä¸ŠåŠ @EnableDiscoveryClientæ³¨è§£ï¼Œè¡¨æ˜Žè¿™æ˜¯ä¸€ä¸ªEurekaå®¢æˆ·ç«¯ï¼š1234567@EnableDiscoveryClient@SpringBootApplicationpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;æœ€åŽé…ç½®application.ymlï¼š12345678910111213server: port: 8082 spring: application: name: Server-Provider eureka: client: register-with-eureka: true fetch-registry: true serviceUrl: defaultZone: http://localhost:8080/eureka/ç¨å¾®è¯´æ˜Žä¸‹è¿™äº›é…ç½®çš„æ„æ€ï¼šserver.portæŒ‡å®šäº†æœåŠ¡çš„ç«¯å£ä¸º8082ï¼›spring.application.nameæŒ‡å®šæœåŠ¡åç§°ä¸ºServer-Providerï¼ŒåŽç»­æœåŠ¡æ¶ˆè´¹è€…è¦èŽ·å–ä¸Šé¢TestControllerä¸­æŽ¥å£çš„æ—¶å€™ä¼šç”¨åˆ°è¿™ä¸ªæœåŠ¡åï¼›eureka.client.serviceUrl.defaultZoneæŒ‡å®šEurekaæœåŠ¡ç«¯çš„åœ°å€ï¼Œè¿™é‡Œä¸ºä¸Šé¢å®šä¹‰çš„EurekaæœåŠ¡ç«¯åœ°å€ï¼›eureka.client.register-with-eurekaå’Œeureka.client.fetch-registryä¸Šé¢å·²ç»è§£é‡Šäº†å…¶æ„æ€ï¼Œè™½ç„¶è¿™ä¸¤ä¸ªé…ç½®çš„é»˜è®¤å€¼å°±æ˜¯trueï¼Œä½†è¿™é‡Œè¿˜æ˜¯æ˜¾å¼é…ç½®ä¸‹ï¼Œä½¿Eurekaå®¢æˆ·ç«¯çš„åŠŸèƒ½æ›´ä¸ºç›´è§‚ï¼ˆå³å‘æœåŠ¡ç«¯æ³¨å†ŒæœåŠ¡å¹¶å®šæ—¶ä»ŽæœåŠ¡ç«¯èŽ·å–æœåŠ¡ç¼“å­˜åˆ°æœ¬åœ°ï¼‰ã€‚é…ç½®å¥½åŽï¼Œå¯åŠ¨Eureka-Clientï¼Œå¯ä»¥ä»ŽæŽ§åˆ¶å°ä¸­çœ‹åˆ°æ³¨å†ŒæˆåŠŸçš„æ¶ˆæ¯ï¼š1234567891011121314Registered Applications size is zero : trueApplication version is -1: trueGetting all instance registry info from the eureka serverThe response status is 200Starting heartbeat executor: renew interval is: 30InstanceInfoReplicator onDemand update allowed rate per min is 4Discovery Client initialized at timestamp 1530667498944 with initial instances Registering application Server-Provider with eureka with status UPSaw local status change event StatusChangeEvent [timestamp=1530667498949, current=UP, previous=STARTING] DiscoveryClient_SERVER-PROVIDER/192.168.73.109:Server-Provider:8082: registering service... DiscoveryClient_SERVER-PROVIDER/192.168.73.109:Server-Provider:8082 - registration status: 204Tomcat started on port(s): 8082 (http)Updating port to 8082Started DemoApplication in 7.007 seconds (JVM running for 8.355)ç¬¬3ï¼Œ4è¡Œè¾“å‡ºè¡¨ç¤ºå·²ç»æˆåŠŸä»ŽEurekaæœåŠ¡ç«¯èŽ·å–åˆ°äº†æœåŠ¡ï¼›ç¬¬5è¡Œè¡¨ç¤ºå‘é€å¿ƒè·³ç»™EurekaæœåŠ¡ç«¯ï¼Œç»­çº¦ï¼ˆrenewï¼‰æœåŠ¡ï¼›ç¬¬8åˆ°11è¡Œè¡¨ç¤ºå·²ç»æˆåŠŸå°†æœåŠ¡æ³¨å†Œåˆ°äº†EurekaæœåŠ¡ç«¯ã€‚å†æ¬¡è®¿é—®http://localhost:8080/ï¼Œå¯çœ‹åˆ°æœåŠ¡åˆ—è¡¨é‡Œå·²ç»å‡ºçŽ°äº†åå­—ä¸ºServer-providerdeæœåŠ¡äº†ï¼šUPè¡¨ç¤ºåœ¨çº¿çš„æ„æ€ï¼ˆå¦‚æžœEurekaå®¢æˆ·ç«¯æ­£å¸¸å…³é—­ï¼Œé‚£ä¹ˆè¿™é‡Œçš„çŠ¶æ€å°†å˜ä¸ºDOWNï¼‰ï¼Œç‚¹å‡»åŽé¢çš„é“¾æŽ¥192.168.73.109:Server-Provider:8082å°†è®¿é—®è¯¥æœåŠ¡çš„/infoæŽ¥å£ï¼šè¿™æ—¶å€™å…³é—­Eurekaå®¢æˆ·ç«¯ï¼Œå†æ¬¡åˆ·æ–°http://localhost:8080/ï¼šå¯çœ‹åˆ°è™½ç„¶Eurekaå®¢æˆ·ç«¯å·²ç»å…³é—­äº†ï¼Œä½†æ˜¯EurekaæœåŠ¡ç«¯é¡µé¢çš„æœåŠ¡æœåŠ¡åˆ—è¡¨ä¸­ä¾ç„¶è¿˜æœ‰è¯¥æœåŠ¡ï¼Œå¹¶ä¸”é¡µé¢çº¢è‰²æ–‡å­—æç¤ºï¼šEMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEYâ€™RE NOT. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE NOT BEING EXPIRED JUST TO BE SAFE.å¤§è‡´æ„æ€æ˜¯Eurekaå·²ç»è¿›å…¥äº†ä¿æŠ¤æ¨¡å¼ã€‚å¾®æœåŠ¡åœ¨éƒ¨ç½²ä¹‹åŽå¯èƒ½ç”±äºŽç½‘ç»œé—®é¢˜é€ æˆEurekaå®¢æˆ·ç«¯æ— æ³•æˆåŠŸçš„å‘é€å¿ƒè·³ç»™EurekaæœåŠ¡ç«¯ï¼Œè¿™æ—¶å€™EurekaæœåŠ¡ç«¯è®¤å®šEurekaå®¢æˆ·ç«¯å·²ç»æŒ‚æŽ‰äº†ï¼Œè™½ç„¶å®žé™…ä¸ŠEurekaå®¢æˆ·ç«¯è¿˜åœ¨æ­£å¸¸çš„è¿è¡Œç€ã€‚è€Œä¿æŠ¤æ¨¡å¼å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå³å½“EurekaæœåŠ¡ç«¯åœ¨çŸ­æ—¶é—´å†…åŒæ—¶ä¸¢å¤±äº†è¿‡å¤šçš„Eurekaå®¢æˆ·ç«¯æ—¶ï¼ŒEurekaæœåŠ¡ç«¯ä¼šè¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼Œä¸åŽ»å‰”é™¤è¿™äº›å®¢æˆ·ç«¯ã€‚å› ä¸ºæˆ‘ä»¬è¿™é‡Œåªéƒ¨ç½²äº†ä¸€ä¸ªEurekaå®¢æˆ·ç«¯æœåŠ¡ï¼Œæ‰€ä»¥å…³é—­å®¢æˆ·ç«¯åŽæ»¡è¶³â€œçŸ­æ—¶é—´å†…ä¸¢å¤±è¿‡å¤šEurekaå®¢æˆ·ç«¯â€çš„æ¡ä»¶ã€‚åœ¨å¼€å‘ä¸­å¯ä»¥å…ˆå°†ä¿æŠ¤æ¨¡å¼ç»™å…³äº†ï¼Œæˆ‘ä»¬åœ¨EurekaæœåŠ¡ç«¯åŠ ä¸Šä¸€æ¡é…ç½®:123eureka: server: enable-self-preservation: falseEureka-Serveré›†ç¾¤EurekaæœåŠ¡ç«¯å……å½“äº†é‡è¦çš„è§’è‰²ï¼Œæ‰€æœ‰Eurekaå®¢æˆ·ç«¯éƒ½å°†è‡ªå·±æä¾›çš„æœåŠ¡æ³¨å†Œåˆ°EurekaæœåŠ¡ç«¯ï¼Œç„¶åŽä¾›æ‰€æœ‰æœåŠ¡æ¶ˆè´¹è€…ä½¿ç”¨ã€‚å¦‚æžœå•èŠ‚ç‚¹çš„EurekaæœåŠ¡ç«¯å®•æœºäº†ï¼Œé‚£ä¹ˆæ‰€æœ‰æœåŠ¡éƒ½æ— æ³•æ­£å¸¸çš„è®¿é—®ï¼Œè¿™å¿…å°†æ˜¯ç¾éš¾æ€§çš„ã€‚ä¸ºäº†æé«˜EurekaæœåŠ¡ç«¯çš„å¯ç”¨æ€§ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå¯¹å…¶é›†ç¾¤éƒ¨ç½²ï¼Œå³åŒæ—¶éƒ¨ç½²å¤šä¸ªEurekaæœåŠ¡ç«¯ï¼Œå¹¶ä¸”å¯ä»¥ç›¸äº’é—´åŒæ­¥æœåŠ¡ã€‚åœ¨æ­å»ºEurekaæœåŠ¡ç«¯çš„æ—¶å€™æˆ‘ä»¬æ›¾æŠŠä¸‹é¢ä¸¤ä¸ªé…ç½®ç»™å…³é—­äº†ï¼š1234eureka: client: register-with-eureka: false fetch-registry: falseå®žé™…ä¸Šåœ¨Eurekaé›†ç¾¤æ¨¡å¼ä¸­ï¼Œå¼€å¯è¿™ä¸¤ä¸ªå‚æ•°å¯ä»¥è®©å½“å‰EurekaæœåŠ¡ç«¯å°†è‡ªå·±ä¹Ÿä½œä¸ºæœåŠ¡æ³¨å†Œåˆ°åˆ«çš„EurekaæœåŠ¡ç«¯ï¼Œå¹¶ä¸”ä»Žåˆ«çš„EurekaæœåŠ¡ç«¯èŽ·å–æœåŠ¡è¿›è¡ŒåŒæ­¥ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°†è¿™ä¸¤ä¸ªå‚æ•°ç½®ä¸ºtrueï¼ˆé»˜è®¤å°±æ˜¯trueï¼‰ï¼Œä¸‹é¢å¼€å§‹æ­å»ºEurekaæœåŠ¡ç«¯é›†ç¾¤ï¼Œä¸ºäº†ç®€å•èµ·è§è¿™é‡Œåªæ­å»ºä¸¤ä¸ªèŠ‚ç‚¹çš„EurekaæœåŠ¡ç«¯é›†ç¾¤ã€‚åœ¨Eureka-Serveré¡¹ç›®çš„src/main/resourceç›®å½•ä¸‹æ–°å»ºapplication-peer1.ymlï¼Œé…ç½®å¦‚ä¸‹ï¼š123456789101112131415server: port: 8080spring: application: name: Eureka-Servereureka: instance: hostname: peer1 client: serviceUrl: defaultZone: http://peer2:8081/eureka/ server: enable-self-preservation: falseserver.port=8080æŒ‡å®šç«¯å£ä¸º8080ï¼›spring.application.name=Eureka-ServeræŒ‡å®šäº†æœåŠ¡åç§°ä¸ºEureka-Serverï¼›eureka.instance.hostname=peer1æŒ‡å®šåœ°å€ä¸ºpeer1ï¼›eureka.client.serviceUrl.defaultZone=http://peer2:8081/eureka/æŒ‡å®šEurekaæœåŠ¡ç«¯çš„åœ°å€ä¸ºå¦å¤–ä¸€ä¸ªEurekaæœåŠ¡ç«¯çš„åœ°å€peer2ã€‚ä¸‹é¢æˆ‘ä»¬åˆ›å»ºå¦å¤–ä¸€ä¸ªEurekaæœåŠ¡ç«¯peer2çš„ymlé…ç½®application-peer2.ymlï¼š123456789101112131415server: port: 8081spring: application: name: Eureka-Servereureka: instance: hostname: peer2 client: serviceUrl: defaultZone: http://peer1:8080/eureka/ server: enable-self-preservation: falsepeer2ä¸­çš„serviceUrlæˆ‘ä»¬æŒ‡å‘EurekaæœåŠ¡ç«¯peer1ã€‚ä¸ºäº†è®©è¿™ç§åœ¨ä¸€å°æœºå™¨ä¸Šé…ç½®ä¸¤ä¸ªhostnameçš„æ–¹å¼ç”Ÿæ•ˆï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸‹hostsæ–‡ä»¶ï¼ˆä½ç½®C:\Windows\System32\drivers\etcï¼‰ï¼š12127.0.0.1 peer1127.0.0.1 peer2æˆ‘ä»¬å°†Eureka-Serveré¡¹ç›®æ‰“åŒ…æˆjarï¼Œç„¶åŽåˆ†åˆ«è¿è¡Œä»¥ä¸‹ä¸¤æ¡å‘½ä»¤æ¥éƒ¨ç½²peer1å’Œpeer2ï¼š12java -jar Eureka-Service-0.0.1-SNAPSHOT.jar --spring.profiles.active=peer1java -jar Eureka-Service-0.0.1-SNAPSHOT.jar --spring.profiles.active=peer2å¯åŠ¨åŽï¼Œæˆ‘ä»¬æ¥è®¿é—®peer1http://localhost:8080/ï¼šå¯çœ‹åˆ°DS Replicas(å‰¯æœ¬)æŒ‡å‘äº†peer2ï¼Œregistered-replicaså’Œavailable-replicaséƒ½æŒ‡å‘äº†http://peer2:8081/eureka/ã€‚è®¿é—®http://localhost:8081/æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ç±»ä¼¼çš„ä¿¡æ¯ã€‚å› ä¸ºEurekaæœåŠ¡ç«¯åšäº†é›†ç¾¤å¤„ç†ï¼Œæ‰€ä»¥Eurekaå®¢æˆ·ç«¯æŒ‡å®šçš„æœåŠ¡ç«¯åœ°å€ä¹Ÿè¦è¿›è¡Œä¿®æ”¹ï¼š1234eureka: client: serviceUrl: defaultZone: http://peer1:8080/eureka/,http://peer2:8081/eureka/æˆ‘ä»¬å°†Eurekaå®¢æˆ·ç«¯ï¼ˆServer-Providerï¼‰æ‰“æˆjaråŒ…ï¼Œç„¶åŽåˆ†åˆ«ç”¨ç«¯å£8082å’Œ8083å¯åŠ¨ä¸¤ä¸ªæœåŠ¡ï¼š12java -jar Eureka-Client-0.0.1-SNAPSHOT.jar --server.port=8082java -jar Eureka-Client-0.0.1-SNAPSHOT.jar --server.port=8083ç„¶åŽè®¿é—®http://peer2:8080/eureka/æˆ–è€…http://peer2:8081/eureka/ï¼š æ­å»ºServer-ConsumeræœåŠ¡æ¶ˆè´¹è€…åœ¨å®žé™…é¡¹ç›®ä¸­ï¼ŒEurekaå®¢æˆ·ç«¯å³æ˜¯æœåŠ¡æä¾›è€…ï¼Œä¹Ÿæ˜¯æœåŠ¡æ¶ˆè´¹è€…ï¼Œå³è‡ªèº«çš„æŽ¥å£å¯èƒ½è¢«åˆ«çš„æœåŠ¡è®¿é—®ï¼ŒåŒæ—¶ä¹Ÿå¯èƒ½è°ƒç”¨åˆ«çš„æœåŠ¡æŽ¥å£ã€‚è¿™é‡Œä¸ºäº†æ›´å¥½çš„æ¼”ç¤ºï¼Œæˆ‘ä»¬æŠŠæœåŠ¡æ¶ˆè´¹è€…å•ç‹¬çš„åˆ†å¼€æ¥æ¼”ç¤ºã€‚æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼ŒartifactIdå¡«Server-Consumerï¼Œå…¶ä¸»è¦çš„ä»»åŠ¡å°±æ˜¯å°†è‡ªèº«çš„æœåŠ¡æ³¨å†Œåˆ°EurekaæœåŠ¡ç«¯ï¼Œå¹¶ä¸”èŽ·å–EurekaæœåŠ¡ç«¯æä¾›çš„æœåŠ¡å¹¶è¿›è¡Œæ¶ˆè´¹ã€‚è¿™é‡ŒæœåŠ¡çš„æ¶ˆè´¹æˆ‘ä»¬ç”¨Ribbonæ¥å®Œæˆï¼ŒRibbonæ˜¯ä¸€æ¬¾å®žçŽ°æœåŠ¡è´Ÿè½½å‡è¡¡çš„å¼€æºè½¯ä»¶ï¼Œè¿™é‡Œä¸åšè¯¦ç»†ä»‹ç»ã€‚å¼•å…¥Eurekaå®¢æˆ·ç«¯å’ŒRibbonä¾èµ–ï¼š12345678910111213141516171819202122232425&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Edgware.SR3&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-ribbon&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;åŒæ ·çš„ï¼Œåœ¨å…¥å£ç±»ä¸­åŠ å…¥@EnableDiscoveryClientæ³¨è§£ç”¨äºŽå‘çŽ°æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡ï¼Œå¹¶é…ç½®ä¸€ä¸ªRestTemplate Beanï¼Œç„¶åŽåŠ ä¸Š@LoadBalancedæ³¨è§£æ¥å¼€å¯è´Ÿè½½å‡è¡¡ï¼š1234567891011121314151617181920import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.cloud.client.discovery.EnableDiscoveryClient;import org.springframework.cloud.client.loadbalancer.LoadBalanced;import org.springframework.context.annotation.Bean;import org.springframework.web.client.RestTemplate;@EnableDiscoveryClient@SpringBootApplicationpublic class DemoApplication &#123; @Bean @LoadBalanced RestTemplate restTemplate() &#123; return new RestTemplate(); &#125; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;æŽ¥ç€ç¼–å†™ä¸€ä¸ªTestControllerï¼Œç”¨äºŽæ¶ˆè´¹æœåŠ¡ï¼š12345678910@RestControllerpublic class TestController &#123; @Autowired private RestTemplate restTemplate; @GetMapping("/info") public String getInfo() &#123; return this.restTemplate.getForEntity("http://Server-Provider/info", String.class).getBody(); &#125;&#125;ä¸Šé¢ä»£ç æ³¨å…¥äº†RestTemplateï¼ŒgetInfoä¸­ä½¿ç”¨RestTemplateå¯¹è±¡å‡è¡¡çš„åŽ»èŽ·å–æœåŠ¡å¹¶æ¶ˆè´¹ã€‚å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä½¿ç”¨æœåŠ¡åç§°ï¼ˆServer-Providerï¼‰åŽ»èŽ·å–æœåŠ¡çš„ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¼ ç»Ÿçš„IPåŠ ç«¯å£çš„å½¢å¼ã€‚è¿™å°±ä½“çŽ°äº†ä½¿ç”¨EurekaåŽ»èŽ·å–æœåŠ¡çš„å¥½å¤„ï¼Œæˆ‘ä»¬åªè¦ä¿è¯è¿™ä¸ªæœåŠ¡åç§°ä¸å˜å³å¯ï¼ŒIPå’Œç«¯å£ä¸å†æ˜¯æˆ‘ä»¬å…³å¿ƒçš„ç‚¹ã€‚æœ€åŽç¼–å†™ä¸‹é…ç½®æ–‡ä»¶application.ymlï¼š1234567891011server: port: 9000 spring: application: name: Server-Consumer eureka: client: serviceUrl: defaultZone: http://peer1:8080/eureka/,http://peer2:8081/eureka/ç«¯å£ä¸º9000ï¼ŒæœåŠ¡åç§°ä¸ºServer-Consumerå¹¶æŒ‡å®šäº†EurekaæœåŠ¡ç«¯çš„åœ°å€ã€‚å¯åŠ¨è¯¥é¡¹ç›®ï¼Œè®¿é—®http://localhost:9000/infoï¼šæˆåŠŸèŽ·å–åˆ°äº†ä¿¡æ¯ï¼Œæˆ‘ä»¬å¤šæ¬¡è®¿é—®è¿™ä¸ªæŽ¥å£ï¼Œç„¶åŽè§‚å¯Ÿ8082å’Œ8083Eurekaå®¢æˆ·ç«¯çš„åŽå°ï¼šå¯ä»¥çœ‹åˆ°å®ƒä»¬çš„åŽå°éƒ½æ‰“å°å‡ºäº†ä¿¡æ¯ï¼Œè¯´æ˜Žæˆ‘ä»¬ä»Ž9000åŽ»èŽ·å–æœåŠ¡æ˜¯å‡è¡¡çš„ã€‚è¿™æ—¶å€™æˆ‘ä»¬å…³é—­ä¸€ä¸ªEurekaæœåŠ¡ç«¯ï¼Œå†æ¬¡è®¿é—®http://localhost:9000/infoï¼Œè¿˜æ˜¯å¯ä»¥æˆåŠŸèŽ·å–åˆ°ä¿¡æ¯ï¼Œè¿™å°±æ˜¯EurekaæœåŠ¡ç«¯é›†ç¾¤çš„å¥½å¤„ã€‚Eureka-Serveræ·»åŠ è®¤è¯å‡ºäºŽå®‰å…¨çš„è€ƒè™‘ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¯¹EurekaæœåŠ¡ç«¯æ·»åŠ ç”¨æˆ·è®¤è¯çš„åŠŸèƒ½ã€‚æˆ‘ä»¬åœ¨Eureka-Serverå¼•å…¥Spring-Securityä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåœ¨application.ymlä¸­é…ç½®ç”¨æˆ·åå’Œå¯†ç ï¼š123456security: basic: enabled: true user: name: mrbird password: 123456EurekaæœåŠ¡ç«¯é…ç½®äº†å¯†ç ä¹‹åŽï¼Œæ‰€æœ‰eureka.client.serviceUrl.defaultZoneçš„é…ç½®ä¹Ÿå¿…é¡»é…ç½®ä¸Šç”¨æˆ·åå’Œå¯†ç ï¼Œæ ¼å¼ä¸ºï¼šeureka.client.serviceUrl.defaultZone=http://${userName}:${password}@${hosetname}:${port}/eureka/ï¼Œå¦‚ï¼š1234eureka: client: serviceUrl: defaultZone: http://mrbird:123456@peer2:8081/eureka/é‡æ–°æ‰“åŒ…å¹¶éƒ¨ç½²åŽï¼Œè®¿é—®http://localhost:8080/ï¼Œé¡µé¢å°†å¼¹å‡ºéªŒè¯çª—å£ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç åŽå³å¯è®¿é—®ã€‚Eurekaé…ç½®ä¸‹é¢æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹åœ¨Eurekaä¸­å¸¸ç”¨çš„é…ç½®é€‰é¡¹åŠä»£è¡¨çš„å«ä¹‰ï¼šé…ç½®å«ä¹‰é»˜è®¤å€¼eureka.client.enabledæ˜¯å¦å¯ç”¨Eureka Clienttrueeureka.client.register-with-eurekaè¡¨ç¤ºæ˜¯å¦å°†è‡ªå·±æ³¨å†Œåˆ°Eureka Servertrueeureka.client.fetch-registryè¡¨ç¤ºæ˜¯å¦ä»ŽEureka ServerèŽ·å–æ³¨å†Œçš„æœåŠ¡ä¿¡æ¯trueeureka.client.serviceUrl.defaultZoneé…ç½®Eureka Serveråœ°å€ï¼Œç”¨äºŽæ³¨å†ŒæœåŠ¡å’ŒèŽ·å–æœåŠ¡http://localhost:8761/eurekaeureka.client.registry-fetch-interval-secondsé»˜è®¤å€¼ä¸º30ç§’ï¼Œå³æ¯30ç§’åŽ»Eureka Serverä¸ŠèŽ·å–æœåŠ¡å¹¶ç¼“å­˜30eureka.instance.lease-renewal-interval-in-secondså‘Eureka Serverå‘é€å¿ƒè·³çš„é—´éš”æ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼Œç”¨äºŽæœåŠ¡ç»­çº¦30eureka.instance.lease-expiration-duration-in-secondså®šä¹‰æœåŠ¡å¤±æ•ˆæ—¶é—´ï¼Œå³Eureka Serveræ£€æµ‹åˆ°Eureka Clientæœ¨æœ‰å¿ƒè·³åŽï¼ˆå®¢æˆ·ç«¯æ„å¤–ä¸‹çº¿ï¼‰å¤šå°‘ç§’å°†å…¶å‰”é™¤90eureka.server.enable-self-preservationç”¨äºŽå¼€å¯Eureka Serverè‡ªæˆ‘ä¿æŠ¤åŠŸèƒ½trueeureka.client.instance-info-replication-interval-secondsæ›´æ–°å®žä¾‹ä¿¡æ¯çš„å˜åŒ–åˆ°EurekaæœåŠ¡ç«¯çš„é—´éš”æ—¶é—´ï¼Œå•ä½ä¸ºç§’30eureka.client.eureka-service-url-poll-interval-secondsè½®è¯¢EurekaæœåŠ¡ç«¯åœ°å€æ›´æ”¹çš„é—´éš”æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚300eureka.instance.prefer-ip-addressè¡¨ç¤ºä½¿ç”¨IPè¿›è¡Œé…ç½®ä¸ºä¸æ˜¯åŸŸåfalseeureka.client.healthcheck.enabledé»˜è®¤Erueka Serveræ˜¯é€šè¿‡å¿ƒè·³æ¥æ£€æµ‹Eureka Clientçš„å¥åº·çŠ¶å†µçš„ï¼Œé€šè¿‡ç½®ä¸ºtrueæ”¹å˜Eeureka Serverå¯¹å®¢æˆ·ç«¯å¥åº·æ£€æµ‹çš„æ–¹å¼ï¼Œæ”¹ç”¨Actuatorçš„/healthç«¯ç‚¹æ¥æ£€æµ‹ã€‚falseEurekaè¿˜æœ‰è®¸å¤šåˆ«çš„é…ç½®ï¼Œå…·ä½“å¯ä»¥å‚è€ƒEurekaClientConfigBeanï¼ŒEurekaServerConfigBeanå’ŒEurekaInstanceConfigBeané…ç½®ç±»çš„æºç ã€‚å‚è€ƒé“¾æŽ¥ï¼šhttp://cloud.spring.io/spring-cloud-netflix/1.4.x/multi/multi__service_discovery_eureka_clients.htmlæºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/28.Spring-Cloud-Eureka-Server-Discovery]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Cloud</tag>
        <tag>Eureka</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Security OAuth2 SSO]]></title>
    <url>%2FSpring-Security-OAuth2-SSO.html</url>
    <content type="text"><![CDATA[SSOï¼ˆSingle Sign Onï¼‰å³å•ç‚¹ç™»å½•ï¼Œæ•ˆæžœæ˜¯å¤šä¸ªç³»ç»Ÿé—´ï¼Œåªè¦ç™»å½•äº†å…¶ä¸­ä¸€ä¸ªç³»ç»Ÿï¼Œåˆ«çš„ç³»ç»Ÿä¸ç”¨ç™»å½•æ“ä½œä¹Ÿèƒ½è®¿é—®ã€‚æ¯”å¦‚åœ¨æµè§ˆå™¨ä¸ŠåŒæ—¶æ‰“å¼€å¤©çŒ«å’Œæ·˜å®é¡µé¢ï¼Œåœ¨å¤©çŒ«é¡µé¢è¿›è¡Œç™»å½•ï¼Œç„¶åŽå›žåˆ°æ·˜å®é¡µé¢åˆ·æ–°åŽä¼šå‘çŽ°æ·˜å®ä¹Ÿå·²ç»æ˜¯ç™»å½•çŠ¶æ€äº†ã€‚è¿™èŠ‚å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨Spring Security OAuth2å®žçŽ°å•ç‚¹ç™»å½•ã€‚æ¡†æž¶æ­å»ºæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªmavenå¤šæ¨¡å—é¡¹ç›®ï¼ŒåŒ…å«è®¤è¯æœåŠ¡å™¨å’Œä¸¤ä¸ªå®¢æˆ·ç«¯ã€‚æ–°å»ºä¸€ä¸ªmavené¡¹ç›®ï¼Œä½œä¸ºé¡¹ç›®çš„çˆ¶æ¨¡å—ï¼Œpomå¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;packaging&gt;pom&lt;/packaging&gt; &lt;modules&gt; &lt;module&gt;sso-application-one&lt;/module&gt; &lt;module&gt;sso-application-two&lt;/module&gt; &lt;module&gt;sso-server&lt;/module&gt; &lt;/modules&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.6.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;sso&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;sso&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;spring-cloud.version&gt;Greenwich.SR1&lt;/spring-cloud.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-security&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-cloud.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;ç„¶åŽåœ¨è¯¥mavené¡¹ç›®ä¸‹æ–°å»ºä¸€ä¸ªmoduleï¼ŒartifactIdä¸ºsso-serverï¼ˆä½œä¸ºè®¤è¯æœåŠ¡å™¨ï¼‰ï¼Œpomå¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;parent&gt; &lt;artifactId&gt;sso&lt;/artifactId&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/parent&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;artifactId&gt;sso-server&lt;/artifactId&gt;&lt;/project&gt;æŽ¥ç€ç»§ç»­æ–°å¢žä¸€ä¸ªmoduleæ¨¡å—ï¼ŒartifactIdä¸ºsso-application-oneï¼ˆä½œä¸ºå®¢æˆ·ç«¯ä¸€ï¼‰ï¼Œpomå¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;parent&gt; &lt;artifactId&gt;sso&lt;/artifactId&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/parent&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;artifactId&gt;sso-application-one&lt;/artifactId&gt;&lt;/project&gt;å¦å¤–ä¸€ä¸ªå®¢æˆ·ç«¯å’Œsso-application-oneä¸€è‡´ï¼Œåªä¸è¿‡artifactIdä¸ºsso-application-twoã€‚è‡³æ­¤ï¼Œé¡¹ç›®çš„åŸºæœ¬æ¡†æž¶æ­å»ºå¥½äº†ï¼Œç»“æž„å¦‚ä¸‹æ‰€ç¤º:è®¤è¯æœåŠ¡å™¨é…ç½®è®¤è¯æœåŠ¡å™¨ä½œç”¨å°±æ˜¯ä½œä¸ºç»Ÿä¸€ä»¤ç‰Œå‘æ”¾å¹¶æ ¡éªŒçš„åœ°æ–¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆè¦ç¼–å†™ä¸€äº›åŸºæœ¬çš„Spring Security å®‰å…¨é…ç½®çš„ä»£ç æŒ‡å®šå¦‚ä½•è¿›è¡Œç”¨æˆ·è®¤è¯ã€‚æ–°å»ºä¸€ä¸ªSpring Securityé…ç½®ç±»ï¼Œç»§æ‰¿WebSecurityConfigurerAdapterï¼š12345678910111213141516@Configurationpublic class WebSecurityConfig extends WebSecurityConfigurerAdapter &#123; @Bean public PasswordEncoder passwordEncoder() &#123; return new BCryptPasswordEncoder(); &#125; @Override protected void configure(HttpSecurity http) throws Exception &#123; http.formLogin() .and() .authorizeRequests() .anyRequest() .authenticated(); &#125;&#125;ä¸Šé¢ç®€å•é…ç½®äº†å¯†ç åŠ å¯†ä½¿ç”¨bcryptæ–¹å¼ï¼Œå¹¶ä¸”æ‰€æœ‰è¯·æ±‚éƒ½éœ€è¦è®¤è¯ï¼Œè®¤è¯æ–¹å¼ä¸ºSpring Securityè‡ªå¸¦çš„ç™»å½•é¡µé¢è®¤è¯ï¼ˆä¹Ÿå¯ä»¥æ ¹æ®å‰é¢æ•™ç¨‹æ¥è‡ªå®šä¹‰ç™»å½•é¡µé¢ï¼Œè¿™é‡Œä¸ºäº†ç®€å•èµ·è§ï¼Œå°±ç›´æŽ¥ç”¨è‡ªå¸¦çš„ç™»å½•é¡µäº†ï¼‰ã€‚æŽ¥ç€éœ€è¦å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰ç”¨æˆ·ç™»å½•è®¤è¯çš„æœåŠ¡ï¼š1234567891011121314151617@Configurationpublic class UserDetailService implements UserDetailsService &#123; @Autowired private PasswordEncoder passwordEncoder; @Override public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException &#123; MyUser user = new MyUser(); user.setUserName(username); user.setPassword(this.passwordEncoder.encode("123456")); return new User(username, user.getPassword(), user.isEnabled(), user.isAccountNonExpired(), user.isCredentialsNonExpired(), user.isAccountNonLocked(), AuthorityUtils.commaSeparatedStringToAuthorityList("user:add")); &#125;&#125;åŸºæœ¬é€»è¾‘æ˜¯ç”¨æˆ·åéšä¾¿å†™ï¼Œå¯†ç ä¸º123456ï¼Œå¹¶ä¸”æ‹¥æœ‰user:addæƒé™ã€‚è¿™äº›å‰é¢éƒ½ä»‹ç»è¿‡äº†ï¼Œå°±ä¸å†è¯¦ç»†è¯´æ˜Žäº†ã€‚MyUserçš„ä»£ç å¦‚ä¸‹ï¼š12345678910111213141516public class MyUser implements Serializable &#123; private static final long serialVersionUID = 3497935890426858541L; private String userName; private String password; private boolean accountNonExpired = true; private boolean accountNonLocked= true; private boolean credentialsNonExpired= true; private boolean enabled= true; // getï¼Œsetç•¥&#125;æŽ¥ç€å¼€å§‹ç¼–å†™è®¤è¯æœåŠ¡å™¨é…ç½®ã€‚æ–°å»ºSsoAuthorizationServerConfigï¼Œç»§æ‰¿AuthorizationServerConfigurerAdapterï¼š1234567891011121314151617181920212223242526272829303132333435363738@Configuration@EnableAuthorizationServerpublic class SsoAuthorizationServerConfig extends AuthorizationServerConfigurerAdapter &#123; @Autowired private PasswordEncoder passwordEncoder; @Autowired private UserDetailService userDetailService; @Bean public TokenStore jwtTokenStore() &#123; return new JwtTokenStore(jwtAccessTokenConverter()); &#125; @Bean public JwtAccessTokenConverter jwtAccessTokenConverter() &#123; JwtAccessTokenConverter accessTokenConverter = new JwtAccessTokenConverter(); accessTokenConverter.setSigningKey("test_key"); return accessTokenConverter; &#125; @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception &#123; // è§ä¸‹æ–¹ &#125; @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) &#123; endpoints.tokenStore(jwtTokenStore()) .accessTokenConverter(jwtAccessTokenConverter()) .userDetailsService(userDetailService); &#125; @Override public void configure(AuthorizationServerSecurityConfigurer security) &#123; security.tokenKeyAccess("isAuthenticated()"); // èŽ·å–å¯†é’¥éœ€è¦èº«ä»½è®¤è¯ &#125;&#125;Tokenä½¿ç”¨JWTï¼Œè¿™äº›é…ç½®éƒ½åœ¨å‰é¢å‡ èŠ‚OAuth2æ•™ç¨‹é‡Œä»‹ç»è¿‡äº†å°±ä¸å†èµ˜è¿°äº†ï¼Œè¿™é‡Œè¯¦ç»†è¯´ä¸‹configure(ClientDetailsServiceConfigurer clients)çš„é…ç½®ï¼š1234567891011121314151617...@Overridepublic void configure(ClientDetailsServiceConfigurer clients) throws Exception &#123; clients.inMemory() .withClient("app-a") .secret(passwordEncoder.encode("app-a-1234")) .authorizedGrantTypes("refresh_token","authorization_code") .accessTokenValiditySeconds(3600) .scopes("all"); .and() .withClient("app-b") .secret(passwordEncoder.encode("app-b-1234")) .authorizedGrantTypes("refresh_token","authorization_code") .accessTokenValiditySeconds(7200) .scopes("all");&#125;...è¿™é‡Œåˆ†é…äº†ä¸¤ä¸ªå®¢æˆ·ç«¯é…ç½®ï¼Œåˆ†åˆ«ä¸ºapp-aå’Œapp-bï¼Œå› ä¸ºä½¿ç”¨é»˜è®¤çš„Spring Securityç™»å½•é¡µé¢æ¥è¿›è¡Œè®¤è¯ï¼Œæ‰€ä»¥éœ€è¦å¼€å¯authorization_codeç±»åž‹è®¤è¯æ”¯æŒã€‚è®¤è¯æœåŠ¡å™¨çš„application.ymlé…ç½®å¦‚ä¸‹ï¼š1234server: port: 8080 servlet: context-path: /serverè®¤è¯æœåŠ¡å™¨çš„æ­å»ºå°±å‘Šä¸€æ®µè½äº†ï¼ŒæŽ¥ä¸‹æ¥å¼€å§‹å®¢æˆ·ç«¯ä»£ç ç¼–å†™ã€‚å®¢æˆ·ç«¯é…ç½®ä¸¤ä¸ªå®¢æˆ·ç«¯çš„ä»£ç åŸºæœ¬ä¸€è‡´ï¼Œæ‰€ä»¥è¿™é‡Œåªä»‹ç»å…¶ä¸­ä¸€ä¸ªï¼Œå¦ä¸€ä¸ªå¯ä»¥å‚è€ƒæºç ã€‚åœ¨å®¢æˆ·ç«¯SpringBootå…¥å£ç±»ä¸Šæ·»åŠ @EnableOAuth2Ssoæ³¨è§£ï¼Œå¼€å¯SSOçš„æ”¯æŒï¼š12345678@EnableOAuth2Sso@SpringBootApplicationpublic class SsoApplicaitonOne &#123; public static void main(String[] args) &#123; new SpringApplicationBuilder(SsoApplicaitonOne.class).run(args); &#125;&#125;æŽ¥ä¸‹æ¥çš„é‡ç‚¹æ˜¯é…ç½®æ–‡ä»¶application.ymlçš„é…ç½®ï¼š1234567891011121314security: oauth2: client: client-id: app-a client-secret: app-a-1234 user-authorization-uri: http://127.0.0.1:8080/server/oauth/authorize access-token-uri: http://127.0.0.1:8080/server/oauth/token resource: jwt: key-uri: http://127.0.0.1:8080/server/oauth/token_keyserver: port: 9090 servlet: context-path: /app1security.oauth2.client.client-idå’Œsecurity.oauth2.client.client-secretæŒ‡å®šäº†å®¢æˆ·ç«¯idå’Œå¯†ç ï¼Œè¿™é‡Œå’Œè®¤è¯æœåŠ¡å™¨é‡Œé…ç½®çš„clientä¸€è‡´ï¼ˆå¦å¤–ä¸€ä¸ªå®¢æˆ·ç«¯ä¸ºapp-bï¼‰ï¼›user-authorization-uriæŒ‡å®šä¸ºè®¤è¯æœåŠ¡å™¨çš„/oauth/authorizeåœ°å€ï¼Œaccess-token-uriæŒ‡å®šä¸ºè®¤è¯æœåŠ¡å™¨çš„/oauth/tokenåœ°å€ï¼Œjwt.key-uriæŒ‡å®šä¸ºè®¤è¯æœåŠ¡å™¨çš„/oauth/token_keyåœ°å€ã€‚è¿™é‡Œç«¯å£æŒ‡å®šä¸º9090ï¼Œcontext-pathä¸ºapp1ï¼Œå¦ä¸€ä¸ªå®¢æˆ·ç«¯ç«¯å£æŒ‡å®šä¸º9091ï¼Œcontext-pathä¸ºapp2ã€‚æŽ¥ç€åœ¨resources/staticä¸‹æ–°å¢žä¸€ä¸ªindex.htmlé¡µé¢ï¼Œç”¨äºŽè·³è½¬åˆ°å¦å¤–ä¸€ä¸ªå®¢æˆ·ç«¯ï¼š1234567891011&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;ç®¡ç†ç³»ç»Ÿä¸€&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;ç®¡ç†ç³»ç»Ÿä¸€&lt;/h1&gt; &lt;a href="http://127.0.0.1:9091/app2/index.html"&gt;è·³è½¬åˆ°ç®¡ç†ç³»ç»ŸäºŒ&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;ä¸ºäº†éªŒè¯æ˜¯å¦è®¤è¯æˆåŠŸï¼Œæˆ‘ä»¬æ–°å¢žä¸€ä¸ªæŽ§åˆ¶å™¨ï¼š12345678@RestControllerpublic class UserController &#123; @GetMapping("user") public Principal user(Principal principal) &#123; return principal; &#125;&#125;å¦å¤–ä¸€ä¸ªå®¢æˆ·ç«¯çš„ä»£ç ç•¥ï¼Œå¯ä»¥å‚è€ƒæºç ã€‚æµ‹è¯•æ•ˆæžœå…ˆå¯åŠ¨è®¤è¯æœåŠ¡å™¨ï¼Œä»»ä½•åœ¨å¯åŠ¨ä¸¤ä¸ªå®¢æˆ·ç«¯ã€‚å¯åŠ¨åŽï¼Œè®¿é—®http://127.0.0.1:9090/app1/index.htmlï¼šå¯ä»¥çœ‹åˆ°é¡µé¢è¢«é‡å®šå‘åˆ°è®¤è¯æœåŠ¡å™¨çš„ç™»å½•é¡µé¢ï¼Œæ ¹æ®æˆ‘ä»¬å®šä¹‰çš„UserDetailServiceï¼Œç”¨æˆ·åéšä¾¿å¡«ï¼Œå¯†ç ä¸º123456ã€‚ç™»å½•åŽé¡µé¢è·³è½¬åˆ°ï¼šè¿™ä¸ªURLä¸º:http://127.0.0.1:8080/server/oauth/authorize?client_id=app-a&amp;redirect_uri=http://127.0.0.1:9090/app1/login&amp;response_type=code&amp;state=7Dqcbré¡µé¢æç¤ºçš„æ„æ€æ˜¯ï¼šéžæ³•è¯·æ±‚ï¼Œè‡³å°‘éœ€è¦ä¸€ä¸ªé‡å®šå‘URLè¢«æ³¨å†Œåˆ°clientã€‚ä»ŽURLä¸­å¯ä»¥çœ‹å‡ºï¼Œredirect_uriä¸ºhttp://127.0.0.1:9090/app1/loginï¼Œæ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹è®¤è¯æœåŠ¡å™¨clientç›¸å…³é…ç½®å¦‚ä¸‹ï¼š1234567891011121314151617@Overridepublic void configure(ClientDetailsServiceConfigurer clients) throws Exception &#123; clients.inMemory() .withClient("app-a") .secret(passwordEncoder.encode("app-a-1234")) .authorizedGrantTypes("refresh_token","authorization_code") .accessTokenValiditySeconds(3600) .scopes("all") .redirectUris("http://127.0.0.1:9090/app1/login") .and() .withClient("app-b") .secret(passwordEncoder.encode("app-b-1234")) .authorizedGrantTypes("refresh_token","authorization_code") .accessTokenValiditySeconds(7200) .scopes("all") .redirectUris("http://127.0.0.1:9091/app2/login");&#125;é‡å¯è®¤è¯æœåŠ¡å™¨ï¼Œé‡å¤ä¸Šé¢çš„è¿‡ç¨‹ï¼Œè¿™æ¬¡ç™»å½•åŽï¼Œé¡µé¢è·³è½¬åˆ°äº†æŽˆæƒé¡µé¢ï¼šç‚¹å‡»Authorizeï¼šè¿™æ—¶å€™app-aå¯¹åº”çš„å®¢æˆ·ç«¯å·²ç»ç™»å½•äº†ï¼Œç‚¹å‡»è·³è½¬åˆ°ç³»ç»ŸäºŒï¼šé¡µé¢ç›´æŽ¥æ¥åˆ°æŽˆæƒé¡µï¼Œè€Œä¸éœ€è¦é‡æ–°è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œç»§ç»­ç‚¹å‡»Authorizeï¼šç³»ç»ŸäºŒä¹Ÿå·²ç»æˆåŠŸç™»å½•ï¼Œè®¿é—®http://127.0.0.1:9091/app2/userçœ‹æ˜¯å¦èƒ½æˆåŠŸèŽ·å–åˆ°ç”¨æˆ·ä¿¡æ¯ï¼šåˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å®žçŽ°äº†å•ç‚¹ç™»å½•çš„åŸºæœ¬åŠŸèƒ½äº†ã€‚ä½†æ˜¯åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦ç”¨æˆ·ç‚¹å‡»AuthorizeæŽˆæƒï¼Œä½“éªŒå¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œæˆ‘ä»¬å¯ä»¥åŽ»æŽ‰å®ƒã€‚ä¿®æ”¹è®¤è¯æœåŠ¡å™¨Clienté…ç½®å¦‚ä¸‹ï¼š12345678910111213141516171819@Overridepublic void configure(ClientDetailsServiceConfigurer clients) throws Exception &#123; clients.inMemory() .withClient("app-a") .secret(passwordEncoder.encode("app-a-1234")) .authorizedGrantTypes("refresh_token","authorization_code") .accessTokenValiditySeconds(3600) .scopes("all") .autoApprove(true) .redirectUris("http://127.0.0.1:9090/app1/login") .and() .withClient("app-b") .secret(passwordEncoder.encode("app-b-1234")) .authorizedGrantTypes("refresh_token","authorization_code") .accessTokenValiditySeconds(7200) .scopes("all") .autoApprove(true) .redirectUris("http://127.0.0.1:9091/app2/login");&#125;autoApprove(true)è‡ªåŠ¨æŽˆæƒã€‚ä¿®æ”¹åŽé‡å¯å³å¯çœ‹åˆ°æ•ˆæžœã€‚æƒé™æ ¡éªŒSpring Securityæƒé™æ ¡éªŒå‰é¢ä»‹ç»è¿‡äº†ï¼Œè¿™é‡Œçœ‹ä¸‹åœ¨å•ç‚¹ç™»å½•æ¨¡å¼ä¸‹å¦‚ä½•è¿›è¡Œæƒé™æ ¡éªŒã€‚åœ¨å®¢æˆ·ç«¯æŽ§åˆ¶å™¨é‡ŒåŠ å…¥å¦‚ä¸‹ä»£ç :1234567891011@GetMapping("auth/test1")@PreAuthorize("hasAuthority('user:add')")public String authTest1()&#123; return "æ‚¨æ‹¥æœ‰'user:add'æƒé™";&#125;@GetMapping("auth/test2")@PreAuthorize("hasAuthority('user:update')")public String authTest2()&#123; return "æ‚¨æ‹¥æœ‰'user:update'æƒé™";&#125;åœ¨å®¢æˆ·ç«¯æ–°å¢žSpring Securityé…ç½®ç±»:1234@Configuration@EnableGlobalMethodSecurity(prePostEnabled = true)public class WebSecurityConfigurer extends WebSecurityConfigurerAdapter &#123;&#125;æ”¹å®ŒåŽï¼Œå…ˆå¯åŠ¨è®¤è¯æœåŠ¡å™¨ï¼Œåœ¨å¯åŠ¨å®¢æˆ·ç«¯ã€‚åœ¨å¯åŠ¨å®¢æˆ·ç«¯çš„æ—¶å€™å‡ºçŽ°å¼‚å¸¸ï¼š12345678910Caused by: java.lang.IllegalStateException: @Order on WebSecurityConfigurers must be unique. Order of 100 was already used on cc.mrbird.sso.client.config.WebSecurityConfigurer$$EnhancerBySpringCGLIB$$aa470b71@34d45ec0, so it cannot be used on org.springframework.boot.autoconfigure.security.oauth2.client.OAuth2SsoDefaultConfiguration$$EnhancerBySpringCGLIB$$6f69df92@18137eab too. at org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration.setFilterChainProxySecurityConfigurer(WebSecurityConfiguration.java:148) ~[spring-security-config-5.1.5.RELEASE.jar:5.1.5.RELEASE] at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_171] at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_171] at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_171] at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_171] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredMethodElement.inject(AutowiredAnnotationBeanPostProcessor.java:708) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE] at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:90) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE] at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessProperties(AutowiredAnnotationBeanPostProcessor.java:374) ~[spring-beans-5.1.8.RELEASE.jar:5.1.8.RELEASE] ... 16 common frames omittedå¤§è‡´æ„æ€æ˜¯ï¼Œè®¤è¯æœåŠ¡å™¨å·²ç»é…ç½®äº†Spring Securityé…ç½®ï¼Œå¹¶ä¸”é¡ºåºä¸º100ï¼Œå’Œå®¢æˆ·ç«¯çš„Spring Securityé…ç½®å†²çªäº†ã€‚æ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹ä¸‹å®¢æˆ·ç«¯çš„Spring Securityé…ç½®é¡ºåºï¼š12345@Order(101)@Configuration@EnableGlobalMethodSecurity(prePostEnabled = true)public class WebSecurityConfigurer extends WebSecurityConfigurerAdapter &#123;&#125;è®©å®ƒçš„ä¼˜å…ˆçº§å°äºŽè®¤è¯æœåŠ¡å™¨çš„Spring Securityé…ç½®ã€‚é‡æ–°å¯åŠ¨å®¢æˆ·ç«¯ï¼Œè¿›è¡Œå•ç‚¹ç™»å½•æ“ä½œï¼Œç™»å½•æˆåŠŸåŽï¼Œè®¿é—®http://127.0.0.1:9090/app1/auth/test1ï¼šè®¿é—®http://127.0.0.1:9090/app1/auth/test2ï¼šè¿”å›ž403ï¼Œæ²¡æƒé™ï¼Œè¯´æ˜Žæƒé™æ³¨è§£ç”Ÿæ•ˆäº†ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/66.Spring-Security-OAuth2-SSO]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Cloud</tag>
        <tag>Spring Security</tag>
        <tag>OAuth2</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ECMAScript 6å­¦ä¹ ç¬”è®°]]></title>
    <url>%2FES2015-Learn-Note.html</url>
    <content type="text"><![CDATA[ECMAScript 6.0ï¼ˆä»¥ä¸‹ç®€ç§° ES6ï¼‰æ˜¯ JavaScript è¯­è¨€çš„ä¸‹ä¸€ä»£æ ‡å‡†ï¼Œå·²ç»åœ¨ 2015 å¹´ 6 æœˆæ­£å¼å‘å¸ƒäº†ã€‚å®ƒçš„ç›®æ ‡ï¼Œæ˜¯ä½¿å¾— JavaScript è¯­è¨€å¯ä»¥ç”¨æ¥ç¼–å†™å¤æ‚çš„å¤§åž‹åº”ç”¨ç¨‹åºï¼Œæˆä¸ºä¼ä¸šçº§å¼€å‘è¯­è¨€ã€‚è¿™é‡Œä¸»è¦è®°å½•ä¸‹å­¦ä¹ ES6ä¸­å€¼å¾—è®°å½•çš„åœ°æ–¹ï¼Œä»¥å¤‡å¿˜ã€‚constæ’é‡conté™åˆ¶çš„ç»™æ’é‡åˆ†é…å€¼å¾—åŠ¨ä½œï¼Œè€Œä¸æ˜¯é™åˆ¶æ’é‡é‡Œçš„å€¼ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­å¤±è´¥çš„ï¼š12345const fruit = 'ðŸŽ'console.log(fruit)const fruit = 'ðŸ‹'console.log(fruit)è€Œä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯å¯è¡Œçš„ï¼š123const fruit = []fruit.push('ðŸ‹')console.log(fruit)è§£æž„è§£æž„å°±æ˜¯å°†ä¸€ä¸ªæ•°æ®ç»“æž„è¿›è¡Œåˆ†è§£ï¼Œé€šå¸¸åˆ†ä¸ºæ•°ç»„è§£æž„ï¼Œå¯¹è±¡è§£æž„å’Œå‚æ•°è§£æž„ã€‚æ•°ç»„è§£æž„åœ¨ES6ä¹‹å‰ï¼Œè¦å°†æ•°ç»„é‡Œçš„æ¯ä¸ªå€¼åˆ†é…ç»™ä¸€ä¸ªå˜é‡ï¼Œéœ€è¦è¿™æ ·åš:123456789function food() &#123; return ['ðŸ°', 'â˜•', 'ðŸ“']&#125;var temp = food()var dessert = temp[0]var drink = temp[1]var fruit = temp[2]console.log(dessert, drink, fruit)ES6åŽå¯ä»¥è¿™æ ·åšï¼š123456function food() &#123; return ['ðŸ°', 'â˜•', 'ðŸ“']&#125;let [dessert, drink, fruit] = food()console.log(dessert, drink, fruit)è¾“å‡ºç»“æžœæ˜¯ä¸€æ ·çš„ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Ÿå¯¹è±¡è§£æž„å°†foodè¿”å›žæ”¹ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åŽè§£æž„ï¼š123456function food() &#123; return &#123;dessert: 'ðŸ°', drink: 'â˜•', fruit: 'ðŸ“'&#125;&#125;let &#123;dessert: dessert1, drink: drink1, fruit: fruit1&#125; = food()console.log(dessert1, drink1, fruit1)è¿™é‡Œåšçš„æ˜¯å°†å¯¹è±¡é‡Œçš„dessertå±žæ€§å€¼èµ‹äºˆç»™dessert1ï¼Œä¾æ­¤ç±»æŽ¨ï¼Œæœ‰ç‚¹é¢ å€’çš„æ„Ÿè§‰ï¼Œç»“æžœå¦‚ä¸‹ï¼šå‚æ•°è§£æž„ä½¿ç”¨å¯¹è±¡è§£æž„çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„ç»™å‡½æ•°ä¼ é€’ä¸€ä¸ªå¯¹è±¡å‚æ•°ï¼š12345function food(dessert, drink, &#123;location, restaurant&#125; = &#123;&#125;) &#123; console.log(dessert, drink, location, restaurant)&#125;food('ðŸŽ‚', 'â˜•', &#123;location: 'fuzhou', restaurant: 'MrBird\'s Restaurant'&#125;)æ¨¡æ¿å­—ç¬¦ä¸²ES6ä¹‹å‰çš„å­—ç¬¦ä¸²æ‹¼æŽ¥ï¼š123456let weather = 'ðŸŒž', mood = 'ðŸ˜„', drink = 'ðŸ¸'let message = "ä»Šå¤©å¤©æ°”ï¼š" + weather + "ï¼Œå–äº†ä¸€æ¯ï¼š" + drink + "ï¼Œå¿ƒæƒ…ï¼š" + moodconsole.log(message)ES6åŽæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼š123456let weather = 'ðŸŒž', mood = 'ðŸ˜„', drink = 'ðŸ¸'let message = `ä»Šå¤©å¤©æ°”ï¼š$&#123;weather&#125; ï¼Œå–äº†ä¸€æ¯ï¼š$&#123;drink&#125; ï¼Œå¿ƒæƒ…ï¼š$&#123;mood&#125;`console.log(message)å¸¦æ ‡ç­¾çš„æ¨¡æ¿å­—ç¬¦ä¸²å¯ä»¥åœ¨æ¨¡æ¿å­—ç¬¦ä¸²å‰åŠ ä¸ªæ ‡ç­¾ï¼Œè¿™ä¸ªæ ‡ç­¾æ˜¯ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°é‡Œè¾“å‡ºä¸€äº›å€¼ï¼š12345678910let weather = 'ðŸŒž', mood = 'ðŸ˜„', drink = 'ðŸ¸'let message = note`ä»Šå¤©å¤©æ°”ï¼š$&#123;weather&#125; ï¼Œå–äº†ä¸€æ¯ï¼š$&#123;drink&#125; ï¼Œå¿ƒæƒ…ï¼š$&#123;mood&#125;`function note(strings, ...params) &#123; console.log(strings) console.log(params)&#125;å¯ä»¥çœ‹åˆ°ï¼Œstringsé‡Œçš„å†…å®¹æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²çš„æ¯ä¸€ä¸ªéƒ¨åˆ†ï¼Œ...paramsåŒ…å«çš„æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²é‡Œçš„æ‰€æœ‰å˜é‡å€¼ã€‚å­—ç¬¦ä¸²å‡ ä¸ªæ–°æ–¹æ³•ä»¥ä»€ä¹ˆå¼€å¤´startsWithï¼Œä»¥ä»€ä¹ˆç»“å°¾endsWithï¼Œæ˜¯å¦åŒ…å«includesï¼š1234567891011let weather = 'ðŸŒž', mood = 'ðŸ˜„', drink = 'ðŸ¸'let message = `ä»Šå¤©å¤©æ°”ï¼š$&#123;weather&#125; ï¼Œå–äº†ä¸€æ¯ï¼š$&#123;drink&#125; ï¼Œå¿ƒæƒ…ï¼š$&#123;mood&#125;`console.log( message.startsWith('ä»Šå¤©'), message.endsWith('ðŸ˜„'), message.includes('ðŸ‰'))å‚æ•°é»˜è®¤å€¼ES6åŽæˆ‘ä»¬å¯ä»¥ç»™å‡½æ•°å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼š123456789function food(dessert = 'ðŸŽ‚', drink = 'ðŸµ') &#123; return `$&#123;dessert&#125; and $&#123;drink&#125;`&#125;console.log( food(), '\n', food('ðŸŒ­', 'ðŸº'))æ“ä½œç¬¦...å±•å¼€æ“ä½œç¬¦åœ¨æ•°ç»„å‰åŠ ...ï¼Œç§°ä¸ºå±•å¼€æ“ä½œç¬¦ï¼Œå¯ä»¥ç”¨äºŽå±•å¼€æ•°ç»„ï¼š123456789101112let fruits = ['ðŸ', 'ðŸŽ'], foods = ['ðŸŸ', ...fruits]console.log( fruits, '\n', ...fruits, '\n', foods, '\n', ...foods)å‰©ä½™æ“ä½œç¬¦åœ¨å‡½æ•°å‚æ•°å‰åŠ ...ï¼Œç§°ä¸ºå‰©ä½™æ“ä½œç¬¦ï¼Œç”¨äºŽæŽ¥æ”¶å‡½æ•°å‰©ä¸‹çš„å‚æ•°ï¼š12345function food(dessert,drink,...foods) &#123; console.log(dessert,drink,foods)&#125;food('ðŸŽ‚','ðŸº','ðŸŸ','ðŸ¤','ðŸ–')å‰©ä½™çš„å‚æ•°è¢«æ”¾åˆ°äº†ä¸€ä¸ªæ•°ç»„é‡Œã€‚å‡½æ•°çš„åå­—ES6å‡½æ•°æ–°å¢žäº†nameå±žæ€§ï¼Œç”¨äºŽè¾“å‡ºå‡½æ•°çš„åå­—:123456789function food() &#123; &#125;var food_1 = function () &#123; &#125;var food_2 = function deliciousFood() &#123; &#125;console.log( food.name, food_1.name, food_2.name)Objectæ–°å¢žæ–¹æ³•Object.is()åˆ¤æ–­ä¸¤ä¸ªä¸œè¥¿æ˜¯ä¸æ˜¯åŒä¸€ä¸ªï¼š12345678console.log(+0 == -0)console.log(+0 === -0)console.log(NaN == NaN)console.log(NaN === NaN)console.log(Object.is(+0, -0))console.log(Object.is(NaN, NaN))Object.assign()ä½œç”¨å°±æ˜¯å°†ä¸€ä¸ªå¯¹è±¡çš„å†…å®¹èµ‹äºˆç»™å¦å¤–ä¸€ä¸ªå¯¹è±¡ï¼š1234let food = &#123;dessert:'ðŸ¦'&#125;Object.assign(food, &#123;drink: 'ðŸ¥£', fruit: 'ðŸ¥'&#125;)console.log(food)ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæŽ¥æ”¶è€…ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºèµ‹äºˆè€…ã€‚Object.setPrototypeOf()è®¾ç½®å¯¹è±¡çš„prototypeï¼Œç»™ä¸ªä¾‹å­ä½“ä¼šï¼š12345678910111213141516171819let breakfast = &#123; getFood() &#123; return 'ðŸ§€' &#125;&#125;let lunch = &#123; getFood() &#123; return 'ðŸœ' &#125;&#125;let dinner = Object.create(lunch)console.log(dinner.getFood())console.log(Object.getPrototypeOf(dinner) === lunch)Object.setPrototypeOf(dinner, breakfast)console.log(dinner.getFood())console.log(Object.getPrototypeOf(dinner) === breakfast)__proto__æˆ‘ä»¬è¿˜å¯ä»¥ç”¨__proto__ï¼ˆå‰åŽå„ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰è®¾ç½®å¯¹è±¡çš„prototypeï¼š123456789101112131415161718192021let breakfast = &#123; getFood() &#123; return 'ðŸ§€' &#125;&#125;let lunch = &#123; getFood() &#123; return 'ðŸœ' &#125;&#125;let dinner = &#123; __proto__: lunch&#125;console.log(dinner.getFood())console.log(Object.getPrototypeOf(dinner) === lunch)dinner.__proto__ = breakfastconsole.log(dinner.getFood())console.log(Object.getPrototypeOf(dinner) === breakfast)superçœ‹ä¸‹superçš„ç”¨æ³•ï¼š12345678910111213let lunch = &#123; getFood() &#123; return 'ðŸœ' &#125;&#125;let dinner = &#123; __proto__: lunch, getFood() &#123; return super.getFood() + ' and ðŸ¥—' &#125;&#125;console.log(dinner.getFood())ç”Ÿæˆè¿­ä»£å™¨ES6ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨function*å’Œyieldç”Ÿæˆä¸€ä¸ªè¿­ä»£å™¨ï¼š1234567891011function* cook(foods) &#123; for (value of foods) &#123; yield value &#125;&#125;let result = cook(['ðŸŒ®', 'ðŸ¿', 'ðŸ¥§'])console.log(result.next())console.log(result.next())console.log(result.next())console.log(result.next())classç±»ES6å…è®¸æˆ‘ä»¬åœ¨JavaScriptä¸­å®šä¹‰ä¸€ä¸ªç±»ï¼š1234567891011class Cook &#123; constructor(food) &#123; this.food = food &#125; make() &#123; console.log(this.food) &#125;&#125;let mrbird = new Cook(['ðŸ¥ž'])mrbird.make()ç±»é‡ŒåŒ…å«äº†ä¸€ä¸ªæœ‰å‚æž„é€ å™¨å’Œæ–¹æ³•ã€‚get &amp;&amp; setæˆ‘ä»¬å¯ä»¥åœ¨ç±»é‡Œå®šä¹‰getå’Œsetï¼š12345678910111213141516171819class Cook &#123; constructor(food) &#123; this.food = food &#125; get foods() &#123; return this.food &#125; set foods(value) &#123; this.food.push(value) &#125;&#125;let mrbird = new Cook(['ðŸ¥ž'])mrbird.foods ='ðŸ£'mrbird.foods ='ðŸ¥£'console.log(mrbird.foods)é™æ€æ–¹æ³•æˆ‘ä»¬å¯ä»¥åœ¨ç±»é‡Œå®šä¹‰é™æ€æ–¹æ³•ï¼Œé™æ€æ–¹æ³•å°±æ˜¯ä¸éœ€è¦å®žä¾‹åŒ–ç±»å°±èƒ½è°ƒç”¨çš„æ–¹æ³•ï¼š12345678910class Cook &#123; constructor(food) &#123; this.food = food &#125; static make(food) &#123; console.log(food) &#125;&#125;Cook.make('ðŸª')ç»§æ‰¿ES6å…è®¸æˆ‘ä»¬ç»§æ‰¿ç±»ï¼š1234567891011121314151617class Person &#123; constructor(name, age) &#123; this.name = name this.age = age &#125; introduce() &#123; console.log(`$&#123;this.name&#125; is $&#123;this.age&#125; years old`) &#125;&#125;class HandsomeBoy extends Person &#123; constructor(name, age) &#123; super(name, age); &#125;&#125;new HandsomeBoy(&apos;MrBird&apos;, &apos;18&apos;).introduce()Setä¸€äº›Setçš„å¸¸ç”¨æ“ä½œï¼š12345678910111213141516let foods = new Set('ðŸ§€ðŸ§ðŸ¨')console.log(foods)foods.add('ðŸ­')foods.add('ðŸ­')console.log(foods)console.log(foods.size)console.log(foods.has('ðŸ¨'))foods.delete('ðŸ§€')console.log(foods)foods.forEach(food =&gt; console.log(food))foods.clear()console.log(foods)Mapä¸€äº›Mapçš„å¸¸ç”¨æ“ä½œï¼š1234567891011121314151617181920212223let food = new Map()let fruit = &#123;&#125;, cook = () =&gt; &#123;&#125;, dessert = 'ç”œç‚¹'food.set(fruit, 'ðŸˆ')food.set(cook, 'ðŸ¥„')food.set(dessert, 'ðŸ¦')console.log(food)console.log(food.size)console.log(food.get(fruit))console.log(food.get(cook))food.forEach((value, key) =&gt; &#123; console.log(`$&#123;key&#125; = $&#123;value&#125;`)&#125;)food.delete(dessert)console.log(food.has(dessert))food.clear()console.log(food)å…ˆåˆ°è¿™é‡Œå§ï¼Œè¯¦ç»†çš„è¿˜æ˜¯å¾—å‚è€ƒhttp://es6.ruanyifeng.com/æˆ–è€…https://babeljs.io/docs/en/learn]]></content>
      <tags>
        <tag>JavaScript</tag>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vueç”Ÿæ€å­¦ä¹ ä¹‹Vuex,Vue-Router]]></title>
    <url>%2Fvuex-vuerouter.html</url>
    <content type="text"><![CDATA[æ–‡ç« å·²åŠ å¯†ï¼Œè¯·è¾“å…¥å¯†ç  ðŸ˜›ï¼š å¯†ç é”™è¯¯ ðŸ˜­ No content to display! U2FsdGVkX185HTIzuNU9kiS7n+dLshXw6itWMBYd4R/Kmal5jL+eVKhkONm8ICKfil7PgVAIOqEs+LzFxjuLi40bHAIf1XTcrQNpY9SyaiOyvpRJLYS3Koxowg+m10xFydFegEjEUoMYtYXHwCaS/EAoq06C3XAQupTvsDVAwdqr5ZY0jS4Ea/hKhxLSsV0TwDTyGTLbZY259D3WxrzFeI2g/7aq+U4n5amxXlDfI2MFJN9mJYlEimqpDI2awe3mdtNXkhU/bXirv4UYNHIwr7XPOYzZklQAZx1jKq5BRLsPELr02kfZJFgclAmOe+5eIdO3UdsWFH6snLBXgv1nybbFPgd62+LCf23Wv7otmVYWFgHgprejAxaeSg/Nt5s00ZsXdVUR+SC8kDAwqNH909TIInF0LaOSxw9/pEtwGVgCITY7DkVUze2sCXblhfQcfMfmHWHrLPuLo5uvID7EmfpTUT/OprG8pWrli2YOZJmOs0c572wHjTsUecEq9H5vgwvtKqYBEylfhELGVgKodhh824NzltcVQf0u2yXE7EenkRm9FLwWo7Wu+4J3P4LVQ8ahpOCh1YIgT1dsgqsyelqP+e6mfP1OVZDxfIoJIQ9fVolsjie9m8w9ZMRrzbBjTYOquCBSLEosx6uo1LdgTk39vOxi/0ulJ4lsoRNGcYQ=]]></content>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Security OAuth2è‡ªå®šä¹‰ä»¤ç‰Œé…ç½®]]></title>
    <url>%2FSpring-Security-OAuth2-Token-Config.html</url>
    <content type="text"><![CDATA[åœ¨å‰é¢å‡ èŠ‚ä¸­ï¼Œæˆ‘ä»¬èŽ·å–åˆ°çš„ä»¤ç‰Œéƒ½æ˜¯åŸºäºŽSpring Security OAuth2é»˜è®¤é…ç½®ç”Ÿæˆçš„ï¼ŒSpring Securityå…è®¸æˆ‘ä»¬è‡ªå®šä¹‰ä»¤ç‰Œé…ç½®ï¼Œæ¯”å¦‚ä¸åŒçš„client_idå¯¹åº”ä¸åŒçš„ä»¤ç‰Œï¼Œä»¤ç‰Œçš„æœ‰æ•ˆæ—¶é—´ï¼Œä»¤ç‰Œçš„å­˜å‚¨ç­–ç•¥ç­‰ï¼›æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨JWTæ¥æ›¿æ¢é»˜è®¤çš„ä»¤ç‰Œã€‚è‡ªå®šä¹‰ä»¤ç‰Œé…ç½®æˆ‘ä»¬è®©è®¤è¯æœåŠ¡å™¨AuthorizationServerConfigç»§æ‰¿AuthorizationServerConfigurerAdapterï¼Œå¹¶é‡å†™å®ƒçš„configure(ClientDetailsServiceConfigurer clients)æ–¹æ³•ï¼š1234567891011121314151617181920212223242526272829303132@Configuration@EnableAuthorizationServerpublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter &#123; ...... @Autowired private AuthenticationManager authenticationManager; @Autowired private UserDetailService userDetailService; @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) &#123; endpoints.authenticationManager(authenticationManager) .userDetailsService(userDetailService); &#125; @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception &#123; clients.inMemory() .withClient("test1") .secret("test1111") .accessTokenValiditySeconds(3600) .refreshTokenValiditySeconds(864000) .scopes("all", "a", "b", "c") .authorizedGrantTypes("password") .and() .withClient("test2") .secret("test2222") .accessTokenValiditySeconds(7200); &#125;&#125;è®¤è¯æœåŠ¡å™¨åœ¨ç»§æ‰¿äº†AuthorizationServerConfigurerAdapteré€‚é…å™¨åŽï¼Œéœ€è¦é‡å†™configure(AuthorizationServerEndpointsConfigurer endpoints)æ–¹æ³•ï¼ŒæŒ‡å®š AuthenticationManagerå’ŒUserDetailServiceã€‚åˆ›å»ºä¸€ä¸ªæ–°çš„é…ç½®ç±»SecurityConfigï¼Œåœ¨é‡Œé¢æ³¨å†Œæˆ‘ä»¬éœ€è¦çš„AuthenticationManagerBeanï¼š123456789@Configurationpublic class SecurityConfig extends WebSecurityConfigurerAdapter &#123; @Bean(name = BeanIds.AUTHENTICATION_MANAGER) @Override public AuthenticationManager authenticationManagerBean() throws Exception &#123; return super.authenticationManagerBean(); &#125;&#125;æ­¤å¤–ï¼Œé‡å†™configure(ClientDetailsServiceConfigurer clients)æ–¹æ³•ä¸»è¦é…ç½®äº†ï¼šå®šä¹‰ä¸¤ä¸ªclient_idï¼ŒåŠå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ä¸åŒçš„client_idæ¥èŽ·å–ä¸åŒçš„ä»¤ç‰Œï¼›client_idä¸ºtest1çš„ä»¤ç‰Œæœ‰æ•ˆæ—¶é—´ä¸º3600ç§’ï¼Œclient_idä¸ºtest2çš„ä»¤ç‰Œæœ‰æ•ˆæ—¶é—´ä¸º7200ç§’ï¼›client_idä¸ºtest1çš„refresh_tokenï¼ˆä¸‹é¢ä¼šä»‹ç»åˆ°ï¼‰æœ‰æ•ˆæ—¶é—´ä¸º864000ç§’ï¼Œå³10å¤©ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿™10å¤©å†…éƒ½å¯ä»¥é€šè¿‡refresh_tokenæ¥æ¢å–æ–°çš„ä»¤ç‰Œï¼›åœ¨èŽ·å–client_idä¸ºtest1çš„ä»¤ç‰Œçš„æ—¶å€™ï¼Œscopeåªèƒ½æŒ‡å®šä¸ºallï¼Œaï¼Œbæˆ–cä¸­çš„æŸä¸ªå€¼ï¼Œå¦åˆ™å°†èŽ·å–å¤±è´¥ï¼›åªèƒ½é€šè¿‡å¯†ç æ¨¡å¼(password)æ¥èŽ·å–client_idä¸ºtest1çš„ä»¤ç‰Œï¼Œè€Œtest2åˆ™æ— é™åˆ¶ã€‚å¯åŠ¨é¡¹ç›®ï¼Œæ¼”ç¤ºå‡ ä¸ªæ•ˆæžœã€‚å¯åŠ¨é¡¹ç›®åŽä½¿ç”¨å¯†ç æ¨¡å¼èŽ·å–test1çš„ä»¤ç‰Œï¼šå’Œå‰é¢ä»‹ç»çš„é‚£æ ·ï¼Œå¤´éƒ¨éœ€è¦ä¼ å…¥test1:test1111ç»è¿‡base64åŠ å¯†åŽçš„å€¼ï¼š ç‚¹å‡»å‘é€åŽï¼Œæ„å¤–çš„è¿”å›žäº†é”™è¯¯ï¼æŽ§åˆ¶å°è¾“å‡ºäº† Encoded password does not look like BCrypt çš„å‘Šè­¦ã€‚æŸ¥é˜…èµ„æ–™åŽå‘çŽ°ï¼Œåœ¨æ–°ç‰ˆæœ¬çš„spring-cloud-starter-oauth2æŒ‡å®šclient_secretçš„æ—¶å€™éœ€è¦è¿›è¡ŒåŠ å¯†å¤„ç†ï¼š123456789101112131415161718192021@Configuration@EnableAuthorizationServerpublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter &#123; ...... @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception &#123; clients.inMemory() .withClient("test1") .secret(new BCryptPasswordEncoder().encode("test1111")) .accessTokenValiditySeconds(3600) .refreshTokenValiditySeconds(864000) .scopes("all", "a", "b", "c") .authorizedGrantTypes("password") .and() .withClient("test2") .secret(new BCryptPasswordEncoder().encode("test2222")) .accessTokenValiditySeconds(7200); &#125;&#125;åœ¨å‰é¢è‡ªå®šä¹‰ç™»å½•è®¤è¯èŽ·å–ä»¤ç‰Œä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬åœ¨MyAuthenticationSucessHandleråˆ¤æ–­äº†client_secretçš„å€¼æ˜¯å¦æ­£ç¡®ã€‚ç”±äºŽæˆ‘ä»¬è¿™é‡Œclient_secretåŠ å¯†äº†ï¼Œæ‰€ä»¥åˆ¤æ–­é€»è¾‘éœ€è¦è°ƒæ•´ä¸ºä¸‹é¢è¿™æ ·:123456...else if (!passwordEncoder.matches(clientSecret, clientDetails.getClientSecret())) &#123; throw new UnapprovedClientAuthenticationException("clientSecretä¸æ­£ç¡®");&#125; ...è¨€å½’æ­£ä¼ ï¼Œä¿®æ”¹åŽé‡å¯é¡¹ç›®ï¼Œé‡æ–°ä½¿ç”¨å¯†ç æ¨¡å¼èŽ·å–ä»¤ç‰Œï¼š123456&#123; "access_token": "c23376b0-efa3-4905-8356-8c9583c2a2a0", "token_type": "bearer", "expires_in": 3599, "scope": "all"&#125;å¯ä»¥çœ‹åˆ°expires_inçš„æ—¶é—´æ˜¯æˆ‘ä»¬å®šä¹‰çš„3600ç§’ã€‚å°†scopeæŒ‡å®šä¸ºdçœ‹çœ‹ä¼šæœ‰ä»€ä¹ˆç»“æžœ:ç”±äºŽæˆ‘ä»¬å®šä¹‰äº†åªèƒ½é€šè¿‡å¯†ç æ¨¡å¼æ¥èŽ·å–client_idä¸ºtest1çš„ä»¤ç‰Œï¼Œæ‰€ä»¥æˆ‘ä»¬çœ‹çœ‹å°†grant_typeæ”¹ä¸ºxxooä¼šæœ‰ä»€ä¹ˆç»“æžœ:é»˜è®¤ä»¤ç‰Œæ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä¿å­˜åˆ°ç¬¬ä¸‰æ–¹å­˜å‚¨ä¸­ï¼Œæ¯”å¦‚Redisã€‚åˆ›å»ºTokenStoreConfigï¼š1234567891011@Configurationpublic class TokenStoreConfig &#123; @Autowired private RedisConnectionFactory redisConnectionFactory; @Bean public TokenStore redisTokenStore ()&#123; return new RedisTokenStore(redisConnectionFactory); &#125;&#125;ç„¶åŽåœ¨è®¤è¯æœåŠ¡å™¨é‡ŒæŒ‡å®šè¯¥ä»¤ç‰Œå­˜å‚¨ç­–ç•¥ã€‚é‡å†™configure(AuthorizationServerEndpointsConfigurer endpoints)æ–¹æ³•ï¼š123456789101112131415@Configuration@EnableAuthorizationServerpublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter &#123; @Autowired private TokenStore redisTokenStore; @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) &#123; endpoints.authenticationManager(authenticationManager) .tokenStore(redisTokenStore); &#125; ......&#125;é‡å¯é¡¹ç›®èŽ·å–ä»¤ç‰ŒåŽï¼ŒæŸ¥çœ‹Redisä¸­æ˜¯å¦å­˜å‚¨äº†ä»¤ç‰Œç›¸å…³ä¿¡æ¯ï¼šå¯ä»¥çœ‹åˆ°ï¼Œä»¤ç‰Œä¿¡æ¯å·²ç»å­˜å‚¨åˆ°Redisé‡Œäº†ã€‚ä½¿ç”¨JWTæ›¿æ¢é»˜è®¤ä»¤ç‰Œä½¿ç”¨JWTæ›¿æ¢é»˜è®¤çš„ä»¤ç‰Œï¼ˆé»˜è®¤ä»¤ç‰Œä½¿ç”¨UUIDç”Ÿæˆï¼‰åªéœ€è¦æŒ‡å®šTokenStoreä¸ºJwtTokenStoreå³å¯ã€‚åˆ›å»ºä¸€ä¸ªJWTokenConfigé…ç½®ç±»ï¼š123456789101112131415@Configurationpublic class JWTokenConfig &#123; @Bean public TokenStore jwtTokenStore() &#123; return new JwtTokenStore(jwtAccessTokenConverter()); &#125; @Bean public JwtAccessTokenConverter jwtAccessTokenConverter() &#123; JwtAccessTokenConverter accessTokenConverter = new JwtAccessTokenConverter(); accessTokenConverter.setSigningKey("test_key"); // ç­¾åå¯†é’¥ return accessTokenConverter; &#125;&#125;ç­¾åå¯†é’¥ä¸ºtest_keyã€‚åœ¨é…ç½®ç±»é‡Œé…ç½®å¥½JwtTokenStoreåŽï¼Œæˆ‘ä»¬åœ¨è®¤è¯æœåŠ¡å™¨é‡ŒæŒ‡å®šå®ƒï¼š1234567891011121314151617@Configuration@EnableAuthorizationServerpublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter &#123; @Autowired private TokenStore jwtTokenStore; @Autowired private JwtAccessTokenConverter jwtAccessTokenConverter; @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) &#123; endpoints.authenticationManager(authenticationManager) .tokenStore(jwtTokenStore) .accessTokenConverter(jwtAccessTokenConverter); &#125; ......&#125;é‡å¯æœåŠ¡èŽ·å–ä»¤ç‰Œï¼Œç³»ç»Ÿå°†è¿”å›žå¦‚ä¸‹æ ¼å¼ä»¤ç‰Œï¼š1234567&#123; "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NjE1MzI1MDEsInVzZXJfbmFtZSI6Im1yYmlyZCIsImF1dGhvcml0aWVzIjpbImFkbWluIl0sImp0aSI6IjJkZjY4MGNhLWFmN2QtNGU4Ni05OTdhLWI1ZmVkYzQxZmYwZSIsImNsaWVudF9pZCI6InRlc3QxIiwic2NvcGUiOltdfQ.dZ4SeuU3VWnSJKy5vELGQ0YkVRddcEydUlJAVovlycg", "token_type": "bearer", "expires_in": 3599, "scope": "all", "jti": "2df680ca-af7d-4e86-997a-b5fedc41ff0e"&#125;å°†access_tokenä¸­çš„å†…å®¹å¤åˆ¶åˆ°https://jwt.io/ç½‘ç«™è§£æžä¸‹ï¼šä½¿ç”¨è¿™ä¸ªtokenè®¿é—®/indexå¯ä»¥æˆåŠŸèŽ·å–åˆ°ä¿¡æ¯ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ã€‚æ‹“å±•JWTä¸Šé¢çš„Tokenè§£æžå¾—åˆ°çš„PAYLOADå†…å®¹ä¸ºï¼š12345678910&#123; "exp": 1561532501, "user_name": "mrbird", "authorities": [ "admin" ], "jti": "2df680ca-af7d-4e86-997a-b5fedc41ff0e", "client_id": "test1", "scope": ["all"]&#125;å¦‚æžœæƒ³åœ¨JWTä¸­æ·»åŠ ä¸€äº›é¢å¤–çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦å®žçŽ°TokenEnhancerï¼ˆTokenå¢žå¼ºå™¨ï¼‰ï¼š123456789public class JWTokenEnhancer implements TokenEnhancer &#123; @Override public OAuth2AccessToken enhance(OAuth2AccessToken oAuth2AccessToken, OAuth2Authentication oAuth2Authentication) &#123; Map&lt;String, Object&gt; info = new HashMap&lt;&gt;(); info.put("message", "hello world"); ((DefaultOAuth2AccessToken) oAuth2AccessToken).setAdditionalInformation(info); return oAuth2AccessToken; &#125;&#125;æˆ‘ä»¬åœ¨Tokenä¸­æ·»åŠ äº†message: hello worldä¿¡æ¯ã€‚ç„¶åŽåœ¨JWTokenConfigé‡Œæ³¨å†Œè¯¥Beanï¼š123456789@Configurationpublic class JWTokenConfig &#123; ...... @Bean public TokenEnhancer tokenEnhancer() &#123; return new JWTokenEnhancer(); &#125;&#125;æœ€åŽåœ¨è®¤è¯æœåŠ¡å™¨é‡Œé…ç½®è¯¥å¢žå¼ºå™¨ï¼š12345678910111213141516171819202122232425@Configuration@EnableAuthorizationServerpublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter &#123; @Autowired private TokenStore jwtTokenStore; @Autowired private JwtAccessTokenConverter jwtAccessTokenConverter; @Autowired private TokenEnhancer tokenEnhancer; @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) &#123; TokenEnhancerChain enhancerChain = new TokenEnhancerChain(); List&lt;TokenEnhancer&gt; enhancers = new ArrayList&lt;&gt;(); enhancers.add(tokenEnhancer); enhancers.add(jwtAccessTokenConverter); enhancerChain.setTokenEnhancers(enhancers); endpoints.tokenStore(jwtTokenStore) .accessTokenConverter(jwtAccessTokenConverter) .tokenEnhancer(enhancerChain); &#125; ......&#125;é‡å¯é¡¹ç›®ï¼Œå†æ¬¡èŽ·å–ä»¤ç‰Œï¼Œç³»ç»Ÿè¿”å›žï¼š1234567&#123; "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJtcmJpcmQiLCJzY29wZSI6W10sImV4cCI6MTU2MTUzNDQ1MCwibWVzc2FnZSI6ImhlbGxvIHdvcmxkIiwiYXV0aG9yaXRpZXMiOlsiYWRtaW4iXSwianRpIjoiY2E1NDA3ZTEtMzBmZS00MzA3LThiYmItYjU2NGY5Y2ViOWUzIiwiY2xpZW50X2lkIjoidGVzdDEifQ.qW92ssifRKi_rxX2XIH2u4D5IUPVcKECv812hTpuUuA", "token_type": "bearer", "expires_in": 3599, "message": "hello world", "jti": "ca5407e1-30fe-4307-8bbb-b564f9ceb9e3"&#125;å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿”å›žçš„JSONå†…å®¹é‡Œå·²ç»å¤šäº†æˆ‘ä»¬æ·»åŠ çš„messageä¿¡æ¯ï¼Œæ­¤å¤–å°†access_tokenå¤åˆ¶åˆ°jwt.ioç½‘ç«™è§£æžï¼Œå†…å®¹å¦‚ä¸‹ï¼š1234567891011&#123; "user_name": "mrbird", "scope": [], "exp": 1561534450, "message": "hello world", "authorities": [ "admin" ], "jti": "ca5407e1-30fe-4307-8bbb-b564f9ceb9e3", "client_id": "test1"&#125;è§£æžåŽçš„JWTä¹ŸåŒ…å«äº†æˆ‘ä»¬æ·»åŠ çš„messageä¿¡æ¯ã€‚Javaä¸­è§£æžJWTè¦åœ¨Javaä»£ç ä¸­è§£æžJWTï¼Œéœ€è¦æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š12345&lt;dependency&gt; &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt; &lt;artifactId&gt;jjwt&lt;/artifactId&gt; &lt;version&gt;0.9.1&lt;/version&gt;&lt;/dependency&gt;ä¿®æ”¹/indexï¼š1234567@GetMapping("index")public Object index(@AuthenticationPrincipal Authentication authentication, HttpServletRequest request) &#123; String header = request.getHeader("Authorization"); String token = StringUtils.substringAfter(header, "bearer "); return Jwts.parser().setSigningKey("test_key".getBytes(StandardCharsets.UTF_8)).parseClaimsJws(token).getBody();&#125;signkeyéœ€è¦å’ŒJwtAccessTokenConverterä¸­æŒ‡å®šçš„ç­¾åå¯†é’¥ä¸€è‡´ã€‚é‡å¯é¡¹ç›®ï¼ŒèŽ·å–ä»¤ç‰ŒåŽè®¿é—®/indexï¼Œè¾“å‡ºå†…å®¹å¦‚ä¸‹ï¼š123456789101112&#123; "exp": 1561557893, "user_name": "mrbird", "authorities": [ "admin" ], "jti": "3c29f89a-1344-40d8-bcfd-1b9c45fb8b89", "client_id": "test1", "scope": [ "all" ]&#125;åˆ·æ–°ä»¤ç‰Œä»¤ç‰Œè¿‡æœŸåŽæˆ‘ä»¬å¯ä»¥ä½¿ç”¨refresh_tokenæ¥ä»Žç³»ç»Ÿä¸­æ¢å–ä¸€ä¸ªæ–°çš„å¯ç”¨ä»¤ç‰Œã€‚ä½†æ˜¯ä»Žå‰é¢çš„ä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è®¤è¯æˆåŠŸåŽè¿”å›žçš„JSONä¿¡æ¯é‡Œå¹¶æ²¡æœ‰åŒ…å«refresh_tokenï¼Œè¦è®©ç³»ç»Ÿè¿”å›žrefresh_tokenï¼Œéœ€è¦åœ¨è®¤è¯æœåŠ¡å™¨è‡ªå®šä¹‰é…ç½®é‡Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š123456789101112131415161718192021@Configuration@EnableAuthorizationServerpublic class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter &#123; ...... @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception &#123; clients.inMemory() .withClient("test1") .secret(new BCryptPasswordEncoder().encode("test1111")) .authorizedGrantTypes("password", "refresh_token") .accessTokenValiditySeconds(3600) .refreshTokenValiditySeconds(864000) .scopes("all", "a", "b", "c") .and() .withClient("test2") .secret(new BCryptPasswordEncoder().encode("test2222")) .accessTokenValiditySeconds(7200); &#125;&#125;æŽˆæƒæ–¹å¼éœ€è¦åŠ ä¸Šrefresh_tokenï¼Œé™¤äº†å››ç§æ ‡å‡†çš„OAuth2èŽ·å–ä»¤ç‰Œæ–¹å¼å¤–ï¼ŒSpring Security OAuth2å†…éƒ¨æŠŠrefresh_tokenå½“ä½œä¸€ç§æ‹“å±•çš„èŽ·å–ä»¤ç‰Œæ–¹å¼ã€‚é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œä½¿ç”¨test1è¿™ä¸ªclient_idèŽ·å–ä»¤ç‰Œæ—¶å°†è¿”å›žrefresh_tokenï¼Œrefresh_tokençš„æœ‰æ•ˆæœŸä¸º10å¤©ï¼Œå³10å¤©ä¹‹å†…éƒ½å¯ä»¥ç”¨å®ƒæ¢å–æ–°çš„å¯ç”¨ä»¤ç‰Œã€‚é‡å¯é¡¹ç›®ï¼Œè®¤è¯æˆåŠŸåŽï¼Œç³»ç»Ÿè¿”å›žå¦‚ï¼š12345678&#123; "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NjE1NTgwOTcsInVzZXJfbmFtZSI6Im1yYmlyZCIsImF1dGhvcml0aWVzIjpbImFkbWluIl0sImp0aSI6Ijg2NTdhMDBlLTFiM2MtNDA5NS1iMjNmLTJlMjUxOWExZmUwMiIsImNsaWVudF9pZCI6InRlc3QxIiwic2NvcGUiOlsiYWxsIl19.hrxKOz3NKY6Eq8k5QeOqKhXUQ4aAbicrb6J5y-LBRA0", "token_type": "bearer", "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJtcmJpcmQiLCJzY29wZSI6WyJhbGwiXSwiYXRpIjoiODY1N2EwMGUtMWIzYy00MDk1LWIyM2YtMmUyNTE5YTFmZTAyIiwiZXhwIjoxNTYyNDE4NDk3LCJhdXRob3JpdGllcyI6WyJhZG1pbiJdLCJqdGkiOiI2MTNjMDVlNS1hNzUzLTRmM2UtOWViOC1hZGE4MTJmY2IyYWQiLCJjbGllbnRfaWQiOiJ0ZXN0MSJ9.efw9OePFUN9X6UGMF3h9BF_KO3zqyIfpvfmE8XklBDs", "expires_in": 3599, "scope": "all", "jti": "8657a00e-1b3c-4095-b23f-2e2519a1fe02"&#125;å‡è®¾çŽ°åœ¨access_tokenè¿‡æœŸäº†ï¼Œæˆ‘ä»¬ç”¨refresh_tokenåŽ»æ¢å–æ–°çš„ä»¤ç‰Œã€‚ä½¿ç”¨postmanå‘é€å¦‚ä¸‹è¯·æ±‚ï¼š12345678&#123; "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1NjE1NTgyMzEsInVzZXJfbmFtZSI6Im1yYmlyZCIsImF1dGhvcml0aWVzIjpbImFkbWluIl0sImp0aSI6ImFmNjU5MTE3LWJkMTItNDNmZS04YzE2LTM0MDQxMTMyZDFlOCIsImNsaWVudF9pZCI6InRlc3QxIiwic2NvcGUiOlsiYWxsIl19.4ZD5bXxsXjSw62_1wVl2QpHUKYcC8_1phdNRP02Iihs", "token_type": "bearer", "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJtcmJpcmQiLCJzY29wZSI6WyJhbGwiXSwiYXRpIjoiYWY2NTkxMTctYmQxMi00M2ZlLThjMTYtMzQwNDExMzJkMWU4IiwiZXhwIjoxNTYyNDE4NDk3LCJhdXRob3JpdGllcyI6WyJhZG1pbiJdLCJqdGkiOiI2MTNjMDVlNS1hNzUzLTRmM2UtOWViOC1hZGE4MTJmY2IyYWQiLCJjbGllbnRfaWQiOiJ0ZXN0MSJ9.e4p3CRyk_cZ82cGzjCBOb4p_0bqRqXElczJjf0nB58o", "expires_in": 3599, "scope": "all", "jti": "af659117-bd12-43fe-8c16-34041132d1e8"&#125;postmanè¯·æ±‚åŠæºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/65.Spring-Security-OAuth2-Config]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Cloud</tag>
        <tag>Spring Security</tag>
        <tag>OAuth2</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Security OAuth2è‡ªå®šä¹‰TokenèŽ·å–æ–¹å¼]]></title>
    <url>%2FSpring-Security-OAuth2-Customize.html</url>
    <content type="text"><![CDATA[åœ¨ä¸Šä¸€èŠ‚Spring Security OAuth2å…¥é—¨ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Spring Security OAuth2å°è£…çš„æŽˆæƒç å’Œå¯†ç æ¨¡å¼æˆåŠŸèŽ·å–äº†ä»¤ç‰Œï¼Œè¿™èŠ‚è®°å½•ä¸‹å¦‚ä½•é€šè¿‡è‡ªå®šä¹‰çš„ç”¨æˆ·åå¯†ç å’Œæ‰‹æœºçŸ­ä¿¡éªŒè¯ç çš„æ–¹å¼æ¥èŽ·å–ä»¤ç‰Œã€‚è‡ªå®šä¹‰ç”¨æˆ·åå¯†ç æ–¹å¼èŽ·å–ä»¤ç‰Œåœ¨ä¸Šä¸€èŠ‚çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å…ˆåœ¨èµ„æºæœåŠ¡å™¨ä¸ŠåŠ å…¥ä¸€äº›åŸºæœ¬çš„Spring Securityé…ç½®:12345678910111213141516171819202122@Configuration@EnableResourceServerpublic class ResourceServerConfig extends ResourceServerConfigurerAdapter &#123; @Autowired private MyAuthenticationSucessHandler authenticationSucessHandler; @Autowired private MyAuthenticationFailureHandler authenticationFailureHandler; @Override public void configure(HttpSecurity http) throws Exception &#123; http.formLogin() // è¡¨å•ç™»å½• .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .successHandler(authenticationSucessHandler) // å¤„ç†ç™»å½•æˆåŠŸ .failureHandler(authenticationFailureHandler) // å¤„ç†ç™»å½•å¤±è´¥ .and() .authorizeRequests() // æŽˆæƒé…ç½® .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and() .csrf().disable(); &#125;&#125;MyAuthenticationFailureHandlerå¤±è´¥å¤„ç†å™¨çš„é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯è®¤è¯å¤±è´¥æ”¾å›žç›¸åº”æç¤ºï¼š12345678910111213@Componentpublic class MyAuthenticationFailureHandler implements AuthenticationFailureHandler &#123; @Autowired private ObjectMapper mapper; @Override public void onAuthenticationFailure(HttpServletRequest request, HttpServletResponse response, AuthenticationException exception) throws IOException &#123; response.setStatus(HttpStatus.INTERNAL_SERVER_ERROR.value()); response.setContentType("application/json;charset=utf-8"); response.getWriter().write(mapper.writeValueAsString(exception.getMessage())); &#125;&#125;é—®é¢˜çš„å…³é”®æ˜¯ï¼Œå¦‚ä½•åœ¨ç™»å½•æˆåŠŸå¤„ç†å™¨é‡Œè¿”å›žä»¤ç‰Œã€‚åœ¨ç ”ç©¶Spring Security OAuth2è‡ªå¸¦çš„ä»¤ç‰ŒèŽ·å–æ–¹å¼åŽï¼Œä¼šå‘çŽ°ä»¤ç‰Œçš„äº§ç”Ÿå¯ä»¥å½’çº³ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼šæˆ‘ä»¬å¯ä»¥å‚è€ƒè¿™ä¸ªæµç¨‹ï¼Œæ¥å®žçŽ°åœ¨ç™»å½•æˆåŠŸå¤„ç†å™¨MyAuthenticationSucessHandleré‡Œç”Ÿæˆä»¤ç‰Œå¹¶è¿”å›žï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970@Componentpublic class MyAuthenticationSucessHandler implements AuthenticationSuccessHandler &#123; private Logger log = LoggerFactory.getLogger(this.getClass()); @Autowired private ClientDetailsService clientDetailsService; @Autowired private AuthorizationServerTokenServices authorizationServerTokenServices; @Override public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException &#123; // 1. ä»Žè¯·æ±‚å¤´ä¸­èŽ·å– ClientId String header = request.getHeader("Authorization"); if (header == null || !header.startsWith("Basic ")) &#123; throw new UnapprovedClientAuthenticationException("è¯·æ±‚å¤´ä¸­æ— clientä¿¡æ¯"); &#125; String[] tokens = this.extractAndDecodeHeader(header, request); String clientId = tokens[0]; String clientSecret = tokens[1]; TokenRequest tokenRequest = null; // 2. é€šè¿‡ ClientDetailsService èŽ·å– ClientDetails ClientDetails clientDetails = clientDetailsService.loadClientByClientId(clientId); // 3. æ ¡éªŒ ClientIdå’Œ ClientSecretçš„æ­£ç¡®æ€§ if (clientDetails == null) &#123; throw new UnapprovedClientAuthenticationException("clientId:" + clientId + "å¯¹åº”çš„ä¿¡æ¯ä¸å­˜åœ¨"); &#125; else if (!StringUtils.equals(clientDetails.getClientSecret(), clientSecret)) &#123; throw new UnapprovedClientAuthenticationException("clientSecretä¸æ­£ç¡®"); &#125; else &#123; // 4. é€šè¿‡ TokenRequestæž„é€ å™¨ç”Ÿæˆ TokenRequest tokenRequest = new TokenRequest(new HashMap&lt;&gt;(), clientId, clientDetails.getScope(), "custom"); &#125; // 5. é€šè¿‡ TokenRequestçš„ createOAuth2Requestæ–¹æ³•èŽ·å– OAuth2Request OAuth2Request oAuth2Request = tokenRequest.createOAuth2Request(clientDetails); // 6. é€šè¿‡ Authenticationå’Œ OAuth2Requestæž„é€ å‡º OAuth2Authentication OAuth2Authentication auth2Authentication = new OAuth2Authentication(oAuth2Request, authentication); // 7. é€šè¿‡ AuthorizationServerTokenServices ç”Ÿæˆ OAuth2AccessToken OAuth2AccessToken token = authorizationServerTokenServices.createAccessToken(auth2Authentication); // 8. è¿”å›ž Token log.info("ç™»å½•æˆåŠŸ"); response.setContentType("application/json;charset=UTF-8"); response.getWriter().write(new ObjectMapper().writeValueAsString(token)); &#125; private String[] extractAndDecodeHeader(String header, HttpServletRequest request) &#123; byte[] base64Token = header.substring(6).getBytes(StandardCharsets.UTF_8); byte[] decoded; try &#123; decoded = Base64.getDecoder().decode(base64Token); &#125; catch (IllegalArgumentException var7) &#123; throw new BadCredentialsException("Failed to decode basic authentication token"); &#125; String token = new String(decoded, StandardCharsets.UTF_8); int delim = token.indexOf(":"); if (delim == -1) &#123; throw new BadCredentialsException("Invalid basic authentication token"); &#125; else &#123; return new String[]&#123;token.substring(0, delim), token.substring(delim + 1)&#125;; &#125; &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼Œä½¿ç”¨postmanå‘é€ç™»å½•è¯·æ±‚localhost:8080/loginï¼šç‚¹å‡»å‘é€åŽä¾¿å¯ä»¥æˆåŠŸèŽ·å–åˆ°ä»¤ç‰Œï¼š123456&#123; "access_token": "88a3dd6c-ab27-41af-95ee-5cd406fe5ab1", "token_type": "bearer", "refresh_token": "b316177d-68e9-4fc9-9f4a-804a7367ebc9", "expires_in": 43199&#125;ä½¿ç”¨è¿™ä¸ªä»¤ç‰Œä¾¿å¯ä»¥æˆåŠŸè®¿é—®/indexæŽ¥å£ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ã€‚çŸ­ä¿¡éªŒè¯ç èŽ·å–ä»¤ç‰Œåœ¨Spring SecurityçŸ­ä¿¡éªŒè¯ç ç™»å½•ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å®žçŽ°äº†é€šè¿‡çŸ­ä¿¡éªŒè¯ç ç™»å½•ç³»ç»Ÿçš„åŠŸèƒ½ï¼Œé€šè¿‡çŸ­ä¿¡éªŒè¯ç èŽ·å–ä»¤ç‰Œå’Œå®ƒå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯éªŒè¯ç çš„å­˜å‚¨ç­–ç•¥ã€‚ä¹‹å‰çš„ä¾‹å­éªŒè¯ç å­˜å‚¨åœ¨Sessionä¸­ï¼ŒçŽ°åœ¨ä½¿ç”¨ä»¤ç‰Œçš„æ–¹å¼å’Œç³»ç»Ÿäº¤äº’åŽSessionå·²ç»ä¸é€‚ç”¨äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹å­˜å‚¨æ¥ä¿å­˜æˆ‘ä»¬çš„éªŒè¯ç ï¼ˆæ— è®ºæ˜¯çŸ­ä¿¡éªŒè¯ç è¿˜æ˜¯å›¾å½¢éªŒè¯ç éƒ½æ˜¯ä¸€ä¸ªé“ç†ï¼‰ï¼Œæ¯”å¦‚Redisç­‰ã€‚å¼•å…¥Redisä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;å®šä¹‰ä¸€ä¸ªRedisCodeServiceï¼Œç”¨äºŽéªŒè¯ç çš„å¢žåˆ æ”¹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849/** * Redisæ“ä½œéªŒè¯ç æœåŠ¡ */@Servicepublic class RedisCodeService &#123; private final static String SMS_CODE_PREFIX = "SMS_CODE:"; private final static Integer TIME_OUT = 300; @Autowired private StringRedisTemplate redisTemplate; /** * ä¿å­˜éªŒè¯ç åˆ° redis * * @param smsCode çŸ­ä¿¡éªŒè¯ç  * @param request ServletWebRequest */ public void save(SmsCode smsCode, ServletWebRequest request, String mobile) throws Exception &#123; redisTemplate.opsForValue().set(key(request, mobile), smsCode.getCode(), TIME_OUT, TimeUnit.SECONDS); &#125; /** * èŽ·å–éªŒè¯ç  * * @param request ServletWebRequest * @return éªŒè¯ç  */ public String get(ServletWebRequest request, String mobile) throws Exception &#123; return redisTemplate.opsForValue().get(key(request, mobile)); &#125; /** * ç§»é™¤éªŒè¯ç  * * @param request ServletWebRequest */ public void remove(ServletWebRequest request, String mobile) throws Exception &#123; redisTemplate.delete(key(request, mobile)); &#125; private String key(ServletWebRequest request, String mobile) throws Exception &#123; String deviceId = request.getHeader("deviceId"); if (StringUtils.isBlank(deviceId)) &#123; throw new Exception("è¯·åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½®deviceId"); &#125; return SMS_CODE_PREFIX + deviceId + ":" + mobile; &#125;&#125;ç„¶åŽå°†Spring SecurityçŸ­ä¿¡éªŒè¯ç ç™»å½•ä¸€èŠ‚ä¸­çš„å®žçŽ°éƒ½æŒªåˆ°çŽ°åœ¨çš„Demoé‡Œï¼Œä¿®æ”¹ç›¸åº”çš„åœ°æ–¹ï¼ˆæ¶‰åŠåˆ°éªŒè¯ç çš„å¢žåˆ æ”¹çš„åœ°æ–¹ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä¸‹é¢çš„æºç ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼‰ã€‚å¯åŠ¨ç³»ç»Ÿï¼Œä½¿ç”¨postmanå‘é€éªŒè¯ç ï¼šè¯·æ±‚å¤´ä¸­å¸¦ä¸ŠdeviceIdï¼ˆè¿™é‡Œä¸ºéšä¾¿å¡«å†™çš„æ¨¡æ‹Ÿå€¼ï¼‰ï¼šç‚¹å‡»å‘é€åŽï¼ŒæŽ§åˆ¶å°è¾“å‡ºï¼š1æ‰‹æœºå·17720202020çš„ç™»å½•éªŒè¯ç ä¸ºï¼š619963ï¼Œæœ‰æ•ˆæ—¶é—´ä¸º120ç§’æŽ¥ç€ç”¨è¿™ä¸ªéªŒè¯ç åŽ»æ¢å–ä»¤ç‰Œï¼Œä½¿ç”¨postmanå‘é€å¦‚ä¸‹è¯·æ±‚ï¼šåŒæ ·è¯·æ±‚å¤´ä¸­è¦å¸¦ä¸ŠdeviceIdå’Œç»è¿‡base64åŠ å¯†çš„client_id:client_secretï¼šç‚¹å‡»å‘é€åŽï¼Œä¾¿å¯ä»¥æˆåŠŸèŽ·å–åˆ°ä»¤ç‰Œï¼š123456&#123; "access_token": "7fe22e67-1a11-4708-8707-0100555a9d1a", "token_type": "bearer", "refresh_token": "7c7a814f-2ace-4171-9748-56cb1994b04b", "expires_in": 41982&#125;æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/64.Spring-Security-OAuth2-Customize]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Cloud</tag>
        <tag>Spring Security</tag>
        <tag>OAuth2</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vueå…¥é—¨å­¦ä¹ ]]></title>
    <url>%2FVue-Learn-Note.html</url>
    <content type="text"><![CDATA[Vue (è¯»éŸ³ /vjuË/ï¼Œç±»ä¼¼äºŽ view) æ˜¯ä¸€å¥—ç”¨äºŽæž„å»ºç”¨æˆ·ç•Œé¢çš„æ¸è¿›å¼æ¡†æž¶ã€‚ä¸Žå…¶å®ƒå¤§åž‹æ¡†æž¶ä¸åŒçš„æ˜¯ï¼ŒVue è¢«è®¾è®¡ä¸ºå¯ä»¥è‡ªåº•å‘ä¸Šé€å±‚åº”ç”¨ã€‚Vue çš„æ ¸å¿ƒåº“åªå…³æ³¨è§†å›¾å±‚ï¼Œä¸ä»…æ˜“äºŽä¸Šæ‰‹ï¼Œè¿˜ä¾¿äºŽä¸Žç¬¬ä¸‰æ–¹åº“æˆ–æ—¢æœ‰é¡¹ç›®æ•´åˆã€‚å¦ä¸€æ–¹é¢ï¼Œå½“ä¸ŽçŽ°ä»£åŒ–çš„å·¥å…·é“¾ä»¥åŠå„ç§æ”¯æŒç±»åº“ç»“åˆä½¿ç”¨æ—¶ï¼ŒVue ä¹Ÿå®Œå…¨èƒ½å¤Ÿä¸ºå¤æ‚çš„å•é¡µåº”ç”¨æä¾›é©±åŠ¨ã€‚æœ¬ç¯‡è®°å½•Vueå­¦ä¹ è¿‡ç¨‹ï¼Œç”¨äºŽå¿ƒå¾—å¤‡å¿˜ï¼Œå¯¹å¤–å¯è¯»æ€§å·®ðŸ™ƒï¼Œå­¦ä¹ Vueè¿˜æ˜¯ä»¥å®˜æ–¹æ–‡æ¡£ä¸ºä¸»ã€‚Vueå…¥é—¨é€šè¿‡ä¸€ä¸ªVueå®žçŽ°çš„todoListæ¥å…¥é—¨ï¼šSee the Pen todo-list by wuyouzhuguli (@mrbird) on CodePen.var app = new Vue({})åˆ›å»ºäº†ä¸€ä¸ªå®žä¾‹ï¼Œé€šè¿‡el: &quot;#app&quot;æŽ¥ç®¡äº†IDä¸ºappçš„divçš„æ‰€æœ‰å†…å®¹ã€‚dataå±žæ€§ç”¨äºŽè£…è½½æ•°æ®ï¼ŒåŒ…å«listå’ŒinputValueã€‚v-foræŒ‡ä»¤ç”¨äºŽéåŽ†é›†åˆï¼Œè¿™é‡Œç”¨äºŽéåŽ†listæ•°ç»„ä¸­çš„å€¼ï¼›v-modelæŒ‡ä»¤ç”¨äºŽåŒå‘æ•°æ®ç»‘å®šï¼Œå³åœ¨&lt;input type=&quot;text&quot; v-model=&quot;inputValue&quot;/&gt;ä¸­è¾“å…¥çš„å€¼ä¼šæ”¹å˜Vueå®žä¾‹ä¸­inputValueçš„å€¼ï¼Œé€šè¿‡JSæ”¹å˜Vueå®žä¾‹inputValueçš„å€¼ä¹Ÿä¼šæ”¹å˜&lt;input type=&quot;text&quot; v-model=&quot;inputValue&quot;/&gt;ä¸­çš„å€¼ã€‚@clickæŒ‡ä»¤ç”¨äºŽç»‘å®šäº‹ä»¶ï¼Œè¿™é‡Œç»‘å®šäº†createTodoListäº‹ä»¶ï¼Œå¯¹åº”Vueå®žä¾‹methodsä¸­çš„createTodoListã€‚Vueç»„ä»¶æˆ‘ä»¬å¯ä»¥å¯¹ä¸€äº›å¸¸ç”¨çš„HTMLç‰‡æ®µæŠ½å–å‡ºæ¥ç»„è£…æˆä¸€ä¸ªVueç»„ä»¶ï¼ŒVueç»„ä»¶åˆ†ä¸ºå…¨å±€ç»„ä»¶å’Œå±€éƒ¨ç»„ä»¶ã€‚å…¨å±€Vueç»„ä»¶å®šä¹‰ä¸€ä¸ªå…¨å±€Vueç»„ä»¶æ”¹é€ ä¸Šé¢çš„todoListï¼šSee the Pen todo-list2 by wuyouzhuguli (@mrbird) on CodePen.è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Vue.component(&#39;TodoItem&#39;,{})å®šä¹‰äº†ä¸€ä¸ªåç§°ä¸ºTodoItemå…¨å±€Vueç»„ä»¶ï¼Œå¯ä»¥åœ¨ä»»ä½•Vueç®¡ç†çš„Domä¸­ä½¿ç”¨ï¼šTodoItemç»„ä»¶å¯ä»¥ä½¿ç”¨&lt;todo-item&gt;çš„æ–¹å¼ä½¿ç”¨ï¼Œå³å¤§å†™å¯ä»¥è½¬æ¢ä¸ºå°å†™ï¼Œç¬¬äºŒä¸ªå¤§å†™å­—æ¯è½¬å°å†™åŽå¿…é¡»åŠ ä¸Š-å‰ç¼€ï¼›v-bindæŒ‡ä»¤ç”¨äºŽç»‘å®šå€¼ï¼Œè¿™é‡Œé€šè¿‡v-bind:contentå°†contentå˜é‡çš„å€¼ç»‘å®šä¸ºitem(å³listä¸­çš„æ¯ä¸ªå…ƒç´ å€¼)ï¼Œé€šè¿‡v-bind:indexå°†indexå˜é‡çš„å€¼ç»‘å®šä¸ºindexï¼ˆå³å½“å‰å¾ªçŽ¯çš„ä¸‹æ ‡ï¼‰ã€‚v-bindå¯ä»¥ç®€å†™ä¸º:ï¼›propså±žæ€§ç”¨äºŽå‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œè¿™é‡ŒæŽ¥æ”¶äº†ç”±:bindæŒ‡ä»¤ä¼ é€’äº†ä»Žçˆ¶ç»„ä»¶ç»‘å®šè¿‡æ¥çš„indexå’Œcontentå˜é‡ï¼›templateå®šä¹‰äº†æ¨¡æ¿ï¼Œå³è¿™ä¸ªVueç»„ä»¶å‘ˆçŽ°çš„æ ·å­ï¼ˆé€šå¸¸éƒ½æ˜¯ä¸€æ®µHTMLåŠ ä¸Šçˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å˜é‡å€¼ï¼‰ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é™¤äº†å­¦ä¼šäº†æ€Žä¹ˆå®šä¹‰å…¨å±€Vueç»„ä»¶å¤–ï¼Œè¿˜å­¦ä¼šäº†æ€Žä¹ˆä»Žçˆ¶ç»„ä»¶ä¸­å¾€å­ç»„ä»¶ä¼ å€¼ã€‚&lt;div id=&quot;app&quot;&gt;è¿™ä¸ªDomç»“æž„å·²ç»è¢«VueæŽ¥ç®¡ï¼Œå…¶å†…éƒ¨åˆåŒ…å«äº†&lt;todo-item&gt;Vueç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†&lt;div id=&quot;app&quot;&gt;ç§°ä¹‹ä¸ºçˆ¶ç»„ä»¶ï¼Œ&lt;todo-item&gt;ç§°ä¹‹ä¸ºå­ç»„ä»¶ã€‚å±€éƒ¨Vueç»„ä»¶å®šä¹‰ä¸€ä¸ªå±€éƒ¨ç»„ä»¶æ¥æ”¹é€ ä¸Šé¢çš„todoListï¼šSee the Pen todo-list3 by wuyouzhuguli (@mrbird) on CodePen.è¿™é‡Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå±€éƒ¨JSå¯¹è±¡TodoItemï¼Œç„¶åŽåœ¨Vueå®žä¾‹appä¸­çš„componentså±žæ€§ä¸­å¼•å…¥äº†è¯¥å¯¹è±¡ï¼Œåç§°ä¾æ—§æ˜¯TodoItemï¼Œè¿™ç§å°±æ˜¯å±€éƒ¨Vueç»„ä»¶ã€‚è¿™é‡Œä¸»è¦è®°å½•ä¸‹è¯¥å±€éƒ¨ç»„ä»¶ä¸­handleItemClickæ–¹æ³•çš„å®žçŽ°è¿‡ç¨‹ï¼šæˆ‘ä»¬åœ¨å­ç»„ä»¶TodoItemä¸­å®šä¹‰äº†ä¸€ä¸ªhandleItemClickæ–¹æ³•ï¼›handleItemClickæ–¹æ³•é‡Œé€šè¿‡this.$emit(&#39;delete&#39;, this.index)å‘çˆ¶ç»„ä»¶ä¼ é€’ä¸€ä¸ªäº‹ä»¶ï¼Œäº‹ä»¶åç§°ä¸ºdelete,äº‹ä»¶åŒ…å«ä¸€ä¸ªindexå‚æ•°ã€‚å­ç»„ä»¶çš„@deleteç›‘å¬äº‹ä»¶å¯¹åº”2ä¸­ä¼ é€’è¿‡æ¥çš„deleteäº‹ä»¶ï¼Œç›‘å¬çš„æ–¹æ³•ä¸ºçˆ¶ç»„ä»¶çš„deleteTodoListæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸­æŽ¥å—äº†2ä¸­ä¼ é€’è¿‡æ¥çš„indexå‚æ•°ï¼Œç„¶åŽå°±å¯ä»¥åœ¨è¯¥æ–¹æ³•ä¸­å®žçŽ°æƒ³è¦çš„é€»è¾‘äº†ï¼ˆè¿™é‡Œä¸ºåˆ é™¤å¯¹åº”çš„ç‚¹å‡»å¯¹è±¡ï¼‰ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é™¤äº†å­¦ä¼šäº†æ€Žä¹ˆå®šä¹‰å±€éƒ¨Vueç»„ä»¶å¤–ï¼Œè¿˜å­¦ä¼šäº†æ€Žä¹ˆä»Žå­ç»„ä»¶ä¸­å¾€çˆ¶ç»„ä»¶ä¼ å€¼ã€‚emit: è‹±[iËˆmÉªt],ç¾Ž[ÉªËˆmÉªt] vt.å‘å‡º; å‘å°„Vueå®žä¾‹ç”Ÿå‘½å‘¨æœŸVueå®žä¾‹ä»Žåˆ›å»ºåˆ°é”€æ¯åŒ…å«äº†å¤šä¸ªç”Ÿå‘½å‘¨æœŸï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šè¿™ä¸ªè¿‡ç¨‹ä¸­åŒ…å«äº†å¥½å‡ ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œåœ¨ç›¸åº”çš„æ—¶é—´ç‚¹ä¼šè‡ªåŠ¨æ‰§è¡Œï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;vueå®žä¾‹ç”Ÿå‘½å‘¨æœŸå‡½æ•°&lt;/title&gt; &lt;script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="app"&gt;&lt;/div&gt;&lt;script&gt; var app = new Vue(&#123; el: "#app", template: '&lt;span&gt;&#123;&#123;test&#125;&#125;&lt;/span&gt;', data: &#123; test: 'hello world' &#125;, beforeCreate: function () &#123; console.log("beforeCreate"); &#125;, created: function () &#123; console.log("created"); &#125;, beforeMount: function () &#123; console.log(this.$el); console.log("beforeMount"); &#125;, mounted: function () &#123; console.log(this.$el); console.log("mounted"); &#125;, beforeUpdate: function () &#123; console.log("beforeUpdate") &#125;, updated: function () &#123; console.log("updated"); &#125;, beforeDestroy: function () &#123; console.log("beforeDestroy") &#125;, destroyed: function () &#123; console.log("destroyed"); &#125;, &#125;);&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;å…¶å®žï¼Œé™¤äº†ä¸Šé¢8ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°å¤–ï¼ŒVueè¿˜åŒ…å«3ä¸ªç‰¹æ®Šçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼šactivatedï¼Œdeactivated å’Œ errorCapturedã€‚è®¡ç®—å±žæ€§ï¼Œæ–¹æ³•å’Œç›‘å¬å™¨è®¡ç®—å±žæ€§ä¸€ä¸ªè®¡ç®—å±žæ€§çš„ä¾‹å­ï¼šSee the Pen è®¡ç®—å±žæ€§ by wuyouzhuguli (@mrbird) on CodePen.ä½¿ç”¨computedè®¡ç®—äº†fullNameå±žæ€§ï¼Œå€¼ä¸ºfirstName+lastNameã€‚è®¡ç®—å±žæ€§å…·æœ‰ç¼“å­˜åŠŸèƒ½ï¼Œå½“firstNameå’ŒlastNameéƒ½ä¸æ”¹å˜çš„æ—¶å€™ï¼ŒfullNameä¸ä¼šé‡æ–°è®¡ç®—ï¼Œæ¯”å¦‚æˆ‘ä»¬æ”¹å˜ageçš„å€¼ï¼ŒfullNameçš„å€¼æ˜¯ä¸éœ€è¦é‡æ–°è®¡ç®—çš„ï¼šæ–¹æ³•ä½¿ç”¨æ–¹æ³•ä¹Ÿå¯ä»¥å®žçŽ°ä¸Šé¢çš„åŠŸèƒ½ï¼šSee the Pen todo-list5 by wuyouzhuguli (@mrbird) on CodePen.ä¸è¿‡methodså¹¶æ²¡æœ‰ç¼“å­˜ç‰¹æ€§ï¼Œæ¯”å¦‚æˆ‘ä»¬æ”¹å˜ageçš„å€¼ï¼ŒfullName()æ–¹æ³•ä¼šè¢«æ‰§è¡Œä¸€éï¼šç›‘å¬å™¨ä½¿ç”¨ç›‘å¬å™¨ä¹Ÿå¯ä»¥å®žçŽ°ä¸Šé¢çš„åŠŸèƒ½ï¼šSee the Pen todo-list6 by wuyouzhuguli (@mrbird) on CodePen.è¿™é‡Œç›‘å¬äº†firstNameå’ŒlastNameçš„å€¼ï¼Œå½“å®ƒä»¬ä»»ä½•ä¸€ä¸ªæ”¹å˜çš„æ—¶ä¾¯fullNameä¹Ÿè·Ÿå˜ï¼Œæˆ‘ä»¬æ”¹å˜ageçš„å€¼ï¼ŒfullNameçš„å€¼ä¸ä¼šè¢«é‡æ–°è®¡ç®—ï¼Œä¹Ÿå…·æœ‰ç¼“å­˜ç‰¹æ€§ï¼ˆä¸è¿‡ä»£ç æ¯”computedå•°å—¦ï¼‰:å½“ä¸€ä¸ªåŠŸèƒ½å¯ä»¥ç”¨ä¸Šé¢ä¸‰ä¸ªæ–¹æ³•æ¥å®žçŽ°çš„æ—¶å€™ï¼Œæ˜Žæ˜¾ä½¿ç”¨computedæ›´åˆé€‚ï¼Œä»£ç ç®€å•ä¹Ÿæœ‰ç¼“å­˜ç‰¹æ€§ã€‚computedçš„getterå’Œsetterå°†ä¸Šé¢è®¡ç®—å±žæ€§çš„ä¾‹å­æ”¹ä¸ºä¸‹é¢çš„å½¢å¼ï¼šSee the Pen get set by wuyouzhuguli (@mrbird) on CodePen.é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ”¹å˜è®¡ç®—å±žæ€§å€¼çš„åŒæ—¶ä¹Ÿæ”¹å˜å’Œè®¡ç®—å±žæ€§ç›¸å…³è”çš„å±žæ€§å€¼ã€‚æ·±å…¥ç†è§£Vueç»„ä»¶iså…ˆæ¥çœ‹ä¸€ä¸ªbugï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„Vueç»„ä»¶ä½¿ç”¨ï¼š123456789101112131415161718192021222324252627&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;title&lt;/title&gt; &lt;script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="app"&gt; &lt;table&gt; &lt;tbody&gt; &lt;row&gt;&lt;/row&gt; &lt;row&gt;&lt;/row&gt; &lt;row&gt;&lt;/row&gt; &lt;/tbody&gt; &lt;/table&gt;&lt;/div&gt;&lt;/body&gt;&lt;script&gt; Vue.component('row', &#123; template: '&lt;tr&gt;&lt;td&gt;hello world&lt;/td&gt;&lt;/tr&gt;' &#125;); var app = new Vue(&#123; el: "#app" &#125;);&lt;/script&gt;&lt;/html&gt;è™½ç„¶å…¶åœ¨é¡µé¢ä¸Šçœ‹ä¸ŠåŽ»æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯æŸ¥çœ‹å™¨DOMç»“æž„å°±èƒ½å‘çŽ°é—®é¢˜ï¼šå¯çœ‹åˆ°tableçš„ç»“æž„æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºHTML5è§„èŒƒåªå…è®¸&lt;tbody&gt;ä¸‹é¢ç´§è·Ÿç€&lt;tr&gt;æ ‡ç­¾ï¼Œç±»ä¼¼çš„&lt;ul&gt;ä¸‹åªèƒ½ç´§è·Ÿç€&lt;li&gt;æ ‡ç­¾ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨isæ¥æ”¹å†™ä»£ç ï¼šSee the Pen is by wuyouzhuguli (@mrbird) on CodePen.å­ç»„ä»¶ä¸­çš„dataåº”è¯¥ä¸ºfunctionæ”¹ä¸€ä¸‹ä¸Šé¢çš„ä¾‹å­ï¼š1234567891011121314151617181920212223242526272829303132&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;title&lt;/title&gt; &lt;script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div id="app"&gt; &lt;table&gt; &lt;tbody&gt; &lt;tr is="row"&gt;&lt;/tr&gt; &lt;tr is="row"&gt;&lt;/tr&gt; &lt;tr is="row"&gt;&lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt;&lt;/div&gt;&lt;/body&gt;&lt;script&gt; Vue.component('row', &#123; data: function()&#123; return &#123; content: 'hello world.' &#125; &#125;, template: '&lt;tr&gt;&lt;td&gt;&#123;&#123;content&#125;&#125;&lt;/td&gt;&lt;/tr&gt;' &#125;); var app = new Vue(&#123; el: "#app" &#125;);&lt;/script&gt;&lt;/html&gt;å¦‚æžœdataåªæ˜¯ä¸€ä¸ªJSå¯¹è±¡çš„è¯ï¼ŒVueå°†æŠ›å‡ºå¼‚å¸¸ï¼Œä¹‹æ‰€ä»¥æœ‰è¿™æ ·çš„é™åˆ¶æ˜¯å› ä¸ºå­ç»„ä»¶å¯èƒ½ä¼šåœ¨ä¸åŒçš„åœ°æ–¹å¤šæ¬¡å¼•ç”¨ï¼Œä¸ºäº†ä¿æŒæ•°æ®çš„ä½œç”¨åŸŸä¸ä¸€æ ·ï¼ˆç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å½±å“ï¼‰ï¼Œæ‰€ä»¥ä½¿ç”¨å‡½æ•°åŒ…è£¹äº†ä¸‹ã€‚refåœ¨ä½¿ç”¨Vueçš„æ—¶å€™ï¼Œæ€»æœ‰ä¸å¾—ä¸åŽ»æ“ä½œDOMçš„æ—¶å€™ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨refæ¥å®Œæˆã€‚åœ¨DOMä¸­ä½¿ç”¨ç›´æŽ¥ä¸¾ä¸ªä¾‹å­ï¼Œä½¿ç”¨refæ¥èŽ·å–divæ ‡ç­¾ä¸­çš„å†…å®¹ï¼šSee the Pen ref1 by wuyouzhuguli (@mrbird) on CodePen.ä½¿ç”¨refè®©divå˜æˆä¸€ä¸ªå¼•ç”¨ï¼Œåç§°ä¸ºdivï¼Œç„¶åŽåœ¨hello()æ–¹æ³•ä¸­ï¼Œthis.$refsè¡¨ç¤ºå½“å‰Vueå®žä¾‹ä¸­çš„æ‰€æœ‰å¼•ç”¨ï¼Œthis.$refs.divè¿™é‡ŒèŽ·å–çš„æ˜¯&lt;div ref=&quot;div&quot;&gt;è¿™ä¸ªDOMå¯¹è±¡ã€‚åœ¨Vueç»„ä»¶ä¸­ä½¿ç”¨ç”¨Vueç¼–å†™ä¸ªæ±‚å’Œçš„ä¾‹å­ï¼šSee the Pen ref2 by wuyouzhuguli (@mrbird) on CodePen.è¿™é‡Œrefçš„å¼•ç”¨æ˜¯ä¸€ä¸ªVueç»„ä»¶ã€‚å¯ä»¥è‡ªä¸ªconsoleæ‰“å°çœ‹çœ‹ã€‚çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ å€¼Vueè§„å®šï¼Œå­ç»„ä»¶ä¸èƒ½ç›´æŽ¥ä¿®æ”¹çˆ¶ç»„ä»¶ä¸­ä¼ é€’è¿‡æ¥çš„å€¼ã€‚å› ä¸ºå¦‚æžœä¼ é€’çš„æ˜¯ä¸€ä¸ªå¯¹è±¡çš„è¯ï¼Œä½ åœ¨ä¸€ä¸ªå­ç»„ä»¶ä¸­ä¿®æ”¹äº†å¯¹è±¡çš„å±žæ€§å€¼ï¼Œå¾ˆæœ‰å¯èƒ½åˆ«çš„å­ç»„ä»¶ä¹Ÿç”¨åˆ°äº†è¿™ä¸ªå±žæ€§ï¼Œé‚£ä¹ˆå°±ä¼šä¸€èµ·ä¿®æ”¹äº†ã€‚å˜é€šçš„æ–¹æ³•æ˜¯ï¼Œå­ç»„ä»¶åŽ»å¤åˆ¶ä¸€ä»½çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ•°æ®ï¼Œç„¶åŽä¿®æ”¹è¿™ä»½æ‹·è´ã€‚ç»„ä»¶å‚æ•°æ ¡éªŒçˆ¶ç»„ä»¶å¾€å­ç»„ä»¶ä¼ é€’å‚æ•°çš„æ—¶å€™ï¼Œå­ç»„ä»¶å¯ä»¥å¯¹è¿™äº›å‚æ•°çš„å€¼è¿›è¡Œä¸€äº›è§„åˆ™æ ¡éªŒï¼Œæ ¡éªŒä¸é€šè¿‡Vueä¼šæŠ›å‡ºè­¦å‘Šï¼š123456789101112131415161718192021222324252627282930313233Vue.component('my-component', &#123; props: &#123; // åŸºç¡€çš„ç±»åž‹æ£€æŸ¥ (`null` åŒ¹é…ä»»ä½•ç±»åž‹) propA: Number, // å¤šä¸ªå¯èƒ½çš„ç±»åž‹ propB: [String, Number], // å¿…å¡«çš„å­—ç¬¦ä¸² propC: &#123; type: String, required: true &#125;, // å¸¦æœ‰é»˜è®¤å€¼çš„æ•°å­— propD: &#123; type: Number, default: 100 &#125;, // å¸¦æœ‰é»˜è®¤å€¼çš„å¯¹è±¡ propE: &#123; type: Object, // å¯¹è±¡æˆ–æ•°ç»„é»˜è®¤å€¼å¿…é¡»ä»Žä¸€ä¸ªå·¥åŽ‚å‡½æ•°èŽ·å– default: function () &#123; return &#123; message: 'hello' &#125; &#125; &#125;, // è‡ªå®šä¹‰éªŒè¯å‡½æ•° propF: &#123; validator: function (value) &#123; // è¿™ä¸ªå€¼å¿…é¡»åŒ¹é…ä¸‹åˆ—å­—ç¬¦ä¸²ä¸­çš„ä¸€ä¸ª return ['success', 'warning', 'danger'].indexOf(value) !== -1 &#125; &#125; &#125;&#125;)ç»™ç»„ä»¶ç»‘å®šåŽŸç”Ÿäº‹ä»¶å¦‚æžœæˆ‘ä»¬åœ¨ç»„ä»¶ä¸Šç»‘å®šä¸€ä¸ªç›‘å¬äº‹ä»¶ï¼Œå…¶å¹¶ä¸ä¼šç›´æŽ¥è°ƒç”¨çˆ¶ç»„ä»¶çš„æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œä¸‹é¢çš„ç‚¹å‡»äº‹ä»¶æ˜¯ä¸ä¼šè¢«è§¦å‘çš„ï¼šSee the Pen .native by wuyouzhuguli (@mrbird) on CodePen.å› ä¸ºè¿™æ ·å†™å®žé™…ä¸Š@clickæ˜¯å­ç»„ä»¶å‘çˆ¶ç»„ä»¶æŠ›å‡ºçš„ä¸€ä¸ªç›‘å¬äº‹ä»¶ï¼Œè¿™é‡Œå­ç»„ä»¶å¹¶æ²¡æœ‰é€šè¿‡this.$emit(&#39;click&#39;)å‘çˆ¶ç»„ä»¶ä¼ é€’è¿™ä¸ªäº‹ä»¶ã€‚å¦‚æžœæƒ³è¦åœ¨ç»„ä»¶ä¸Šç»‘å®šåŽŸç”Ÿçš„äº‹ä»¶ï¼Œåªéœ€è¦æ”¹ä¸º`@click.native`å³å¯ï¼šSee the Pen .native2 by wuyouzhuguli (@mrbird) on CodePen.éžçˆ¶å­ç»„ä»¶ä¼ å€¼çˆ¶å­ç»„ä»¶ä¼ å€¼ä¸Šé¢å·²ç»ä»‹ç»äº†ï¼Œé‚£éžçˆ¶å­ç»„ä»¶ä¼ å€¼ï¼ˆä¸æ˜¯ç›´æŽ¥çš„çˆ¶å­å…³ç³»ï¼‰å‘¢ï¼Ÿæ¯”å¦‚ï¼šç¬¬ä¸€å±‚å¦‚ä½•ä¸Žç¬¬ä¸‰å±‚ä¹‹é—´ä¼ å€¼å‘¢ï¼Ÿç›¸åŒå±‚çº§ä¹‹é—´çš„ç»„ä»¶åˆå¦‚ä½•ç›¸äº’ä¼ å€¼å‘¢ï¼Ÿæœ‰ä¸¤ç§åŠžæ³•ï¼švuexï¼ˆåŽé¢å†è¯´ï¼‰æ€»çº¿æœºåˆ¶ï¼ˆbus/å‘å¸ƒè®¢é˜…æ¨¡å¼/è§‚å¯Ÿè€…æ¨¡å¼ï¼‰çœ‹ä¸€ä¸ªæ€»çº¿æœºåˆ¶çš„ä¾‹å­ï¼ˆç‚¹å‡»child-oneä¼šæŠŠchild-oneçš„innerHTMLå€¼ä¼ é€’ç»™child-twoï¼‰ï¼šSee the Pen bus by wuyouzhuguli (@mrbird) on CodePen.è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„å®žçŽ°è¿‡ç¨‹ï¼šé€šè¿‡Vue.prototype.bus = new Vue()å®žçŽ°äº†åœ¨æ¯ä¸ªVueå®žä¾‹ä¸­æ·»åŠ äº†ä¸€ä¸ªbuså±žæ€§ï¼Œè¿™ä¸ªbuså±žæ€§ä¸ºä¸€ä¸ªVueå®žä¾‹ï¼Œæ‹¥æœ‰Vueçš„æ‰€æœ‰ç‰¹æ€§ã€‚æ‰€ä»¥åœ¨æ¯ä¸ªVueå®žä¾‹ä¸­éƒ½ä¼šæœ‰ä¸€ä¸ªbuså±žæ€§ï¼Œå±žæ€§å€¼éƒ½æŒ‡å‘åŒä¸€ä¸ªVueå®žä¾‹ï¼›åˆ›å»ºäº†ä¸¤ä¸ªå…„å¼Ÿå­ç»„ä»¶child-oneå’Œchild-twoï¼›åœ¨å­ç»„ä»¶child-oneä¸­æœ‰ä¸€ä¸ªhandleClickäº‹ä»¶ï¼Œäº‹ä»¶é‡Œé€šè¿‡this.bus.$emitæŠ›å‡ºäº†ä¸€ä¸ªchangeäº‹ä»¶ï¼Œå¹¶æºå¸¦ä¸€ä¸ªå‚æ•°ï¼Œå€¼ä¸ºchild-oneçš„innerHTMLã€‚ä¹‹æ‰€ä»¥å¯ä»¥é€šè¿‡this.bus.$emitæŠ›å‡ºï¼Œæ˜¯å› ä¸ºå¦‚ä¸Šé¢æ‰€è¯´çš„é‚£æ ·ï¼Œæ¯ä¸ªVueå®žä¾‹éƒ½æºå¸¦äº†ä¸€ä¸ªbuså±žæ€§ï¼Œè¯¥å±žæ€§æŒ‡å‘ä¸€ä¸ªVueå®žä¾‹ï¼›child-oneæŠ›å‡ºçš„changeäº‹ä»¶å¯ä»¥åœ¨ä»»ä½•çš„Vueå®žä¾‹ä¸­é€šè¿‡this.bus.$onæ¥ç›‘å¬åˆ°ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨child-twoé‡Œé€šè¿‡è°ƒç”¨this.bus.$onæ¥ç›‘å¬ï¼Œä½†åœ¨å“ªé‡Œç›‘å¬è¿™ä¸ªäº‹ä»¶å¥½å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å€ŸåŠ©Vueçš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°mountedæ¥ç›‘å¬changeäº‹ä»¶ï¼›ä¸Šé¢ä¸»è¦æœ‰ä¸¤ä¸ªæŠ€å·§ï¼šâ‘  è®©æ‰€æœ‰Vueå®žä¾‹æ‹¥æœ‰åŒä¸€ä¸ªå±žæ€§ï¼›â‘¡ è¿™ä¸ªå±žæ€§ä¹Ÿæ˜¯ä¸€ä¸ªVueå®žä¾‹ã€‚å…¶å®žå°±æ˜¯å¼ºè¡Œè®©éžçˆ¶å­ç»„ä»¶æ‰¯ä¸Šå…³ç³»ï¼Œæ­å»ºè¿™ä¸ªå…³ç³»çš„æ¡¥æ¢å°±æ˜¯ä¸Šé¢å®šä¹‰çš„busã€‚å¦‚æžœåªæ˜¯ç®€å•çš„éžçˆ¶å­ç»„ä»¶ä¹‹é—´çš„å€¼çš„ä¼ é€’çš„è¯ï¼Œå…¨å±€Vueå±žæ€§busä¹Ÿå¯ä»¥æŒ‡å‘ä¸€ä¸ªç®€å•å¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šSee the Pen bus1 by wuyouzhuguli (@mrbird) on CodePen.æ•ˆæžœå°±æ˜¯ï¼Œç›´æŽ¥ç‚¹å‡»child-twoå¼¹å‡ºinitï¼›å…ˆç‚¹å‡»child-oneæ”¹å˜this.bus.nameçš„å€¼ä¸ºoneï¼Œå†ç‚¹å‡»child-twoå°†å¼¹å‡ºoneã€‚æ’æ§½slotæ’æ§½è¦å®žçŽ°çš„æ˜¯çˆ¶ç»„ä»¶ä¼˜é›…çš„å¾€å­ç»„ä»¶ä¼ é€’DOMç»“æž„ã€‚https://cn.vuejs.org/v2/guide/components-slots.htmlã€‚ä½œç”¨åŸŸæ’æ§½æœ‰çš„æ—¶å€™ä½ å¸Œæœ›æä¾›çš„ç»„ä»¶å¸¦æœ‰ä¸€ä¸ªå¯ä»Žå­ç»„ä»¶èŽ·å–æ•°æ®çš„å¯å¤ç”¨çš„æ’æ§½ï¼Œå³ä»Žå­ç»„ä»¶èŽ·å–çš„æ•°æ®åœ¨çˆ¶ç»„ä»¶ä¸­å¯ä»¥ä»¥ä»»ä½•å½¢å¼å±•çŽ°ï¼Œè¿™ç§æ’æ§½å°±æ˜¯ä½œç”¨åŸŸæ’æ§½ï¼Œçœ‹ä¸ªä¾‹å­ï¼šSee the Pen slot1 by wuyouzhuguli (@mrbird) on CodePen.å­ç»„ä»¶é‡Œåœ¨æ’æ§½ä¸­ä½¿ç”¨:item=itemç»‘å®šäº†listä¸­çš„æ¯ä¸€é¡¹æ•°æ®ï¼Œç„¶åŽçˆ¶ç»„ä»¶ä¸­ä½¿ç”¨è¯¥æ’æ§½çš„æ—¶å€™ç”¨slot-scope=&quot;props&quot;æŽ¥æ”¶äº†è¿™äº›æ•°æ®ã€‚åŠ¨æ€ç»„ä»¶çœ‹ä¸ªä¾‹å­ï¼šSee the Pen dynamic by wuyouzhuguli (@mrbird) on CodePen.&lt;component&gt;æ ‡ç­¾ç”¨äºŽåŠ è½½åŠ¨æ€ç»„ä»¶ï¼ŒåŠ è½½å“ªä¸ªåå­—çš„ç»„ä»¶æ ¹æ®:isæŒ‡å®šçš„å€¼æ¥é€‰æ‹©ã€‚è¿™é‡Œé€šè¿‡changeäº‹ä»¶æ¥æ”¹å˜typeçš„å€¼ã€‚VueåŠ¨ç”»ç‰¹æ•ˆVueå®˜æ–¹æ–‡æ¡£å†™çš„å¾ˆè¯¦ç»†ï¼Œhttps://cn.vuejs.org/v2/guide/transitions.htmlã€‚æž„å»ºç¬¬ä¸€ä¸ªVueé¡¹ç›®ç¬¬ä¸€æ­¥ï¼Œå®‰è£…vue-cliï¼š1cnpm install --global vue-cliå®‰è£…å¥½åŽï¼Œåˆå§‹åŒ–ä¸€ä¸ªç®€å•çš„Vueé¡¹ç›®ï¼š1vue init webpack vue-project-testè¿‡ç¨‹ä¸­éœ€è¦æ­¥éª¤ç¡®è®¤ï¼šåˆå§‹åŒ–å®Œæ¯•åŽï¼Œå¯åŠ¨é¡¹ç›®ï¼š12cd vue-project-testnpm run devè®¿é—®http://localhost:8080/ï¼šé¡¹ç›®æž„å»ºæˆåŠŸï¼å‰ç«¯ä¹ŸæŒºå¥½çŽ©çš„ðŸ˜‹é¡¹ç›®ç»“æž„ä»‹ç»æ‰“å¼€ä¸Šé¢åˆ›å»ºå¥½çš„vue-project-testï¼Œé¡¹ç›®ç›®å½•å¦‚ä¸‹æ‰€ç¤ºï¼šå…ˆä»Žå¤–éƒ¨çš„æ–‡ä»¶è¯´èµ·ï¼špackage.jsonï¼šç¬¬ä¸‰æ–¹ä¾èµ–é…ç½®ï¼›package-lock.jsonï¼špackage.jsonçš„é”æ–‡ä»¶ï¼Œç¡®å®šç¬¬ä¸‰æ–¹ä¾èµ–çš„ç‰ˆæœ¬ï¼Œä¿æŒå›¢é˜Ÿåä½œä¸Šç‰ˆæœ¬çš„ç»Ÿä¸€ï¼›index.htmlï¼šé¡¹ç›®é¦–é¡µæ¨¡æ¿ï¼›.postcssrc.jsï¼špostcssé…ç½®é¡¹ï¼ˆæš‚æ—¶ä¸æ‡‚å¹²å˜›çš„ï¼‰ï¼›.eslintrc.jsï¼šjsè¯­æ³•æ£€æŸ¥ï¼›.eslintignoreï¼šé…ç½®æŽ’é™¤jsæ£€æŸ¥ï¼›.editorconfigï¼šç¼–è¾‘é…ç½®ï¼›.babelrcï¼šå°†Vueæ–‡ä»¶è½¬æ¢ä¸ºæµè§ˆå™¨èƒ½å¤Ÿè¯†åˆ«çš„htmlï¼›å†æ¥çœ‹ç›®å½•ï¼šstatic/ï¼šé¡¹ç›®é™æ€èµ„æºå­˜æ”¾ï¼Œé‡Œé¢çš„èµ„æºç›´æŽ¥å¯ä»¥é€šè¿‡URLè®¿é—®ï¼›node_modules/ï¼šé¡¹ç›®ä¾èµ–çš„ç¬¬ä¸‰æ–¹åŒ…ï¼›src/ï¼šåŒ…å«é¡¹ç›®æ–‡ä»¶ï¼Œç»“æž„å¦‚ä¸‹æ‰€ç¤ºï¼šmain.jsï¼šæ•´ä¸ªé¡¹ç›®å…¥å£æ–‡ä»¶ï¼›App.vueï¼šé¡¹ç›®çš„æ ¹ç»„ä»¶ï¼›router/ï¼šé¡¹ç›®è·¯ç”±é…ç½®å¤„ï¼›components/ï¼šå­˜æ”¾é¡¹ç›®æ‰€ç”¨åˆ°çš„ç»„ä»¶ï¼›assets/ï¼šå­˜æ”¾é¡¹ç›®ç”¨åˆ°çš„å›¾ç‰‡èµ„æºï¼›config/ï¼šé¡¹ç›®é…ç½®æ–‡ä»¶ç›®å½•ï¼Œä¿®æ”¹éœ€è¦é‡å¯é¡¹ç›®ï¼›build/ï¼šé¡¹ç›®æ‰“åŒ…webpacké…ç½®å¤„ã€‚å•æ–‡ä»¶Vueç»„ä»¶å½“ä¸€ä¸ªæ–‡ä»¶ä»¥.vueç»“å°¾çš„æ—¶å€™ï¼Œä»–å°±æ˜¯ä¸€ä¸ªå•æ–‡ä»¶Vueç»„ä»¶ï¼Œæ¯”å¦‚ä¸Šé¢çš„App.vue:1234567891011121314151617181920212223&lt;template&gt; &lt;div id="app"&gt; &lt;img src="./assets/logo.png"&gt; &lt;router-view/&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: 'App'&#125;&lt;/script&gt;&lt;style&gt;#app &#123; font-family: 'Avenir', Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-align: center; color: #2c3e50; margin-top: 60px;&#125;&lt;/style&gt;å¯ä»¥çœ‹åˆ°ï¼Œå•æ–‡ä»¶Vueç»„ä»¶ä¸»è¦åŒ…å«äº†ä¸‰ä¸ªéƒ¨åˆ†ï¼štemplageã€scriptå’Œstyleã€‚Vueè·¯ç”±è·¯ç”±å°±æ˜¯æ ¹æ®ä¸åŒçš„URLè¿”å›žä¸åŒçš„å†…å®¹ç»™ç”¨æˆ·ã€‚å¯ä»¥çœ‹åˆ°ä¸Šé¢å•æ–‡ä»¶Vueç»„ä»¶é‡Œæœ‰ä¸ª&lt;router-view/&gt;æ ‡ç­¾ï¼Œå®ƒæ˜¾ç¤ºçš„æ˜¯å½“å‰è·¯ç”±åœ°å€å¯¹åº”çš„å†…å®¹ï¼Œå½“å‰åœ°å€å°±æ˜¯http://localhost:8080/#/ï¼Œå®ƒå¯¹åº”çš„å†…å®¹æ˜¯ä¸‹é¢çº¢æ¡†éƒ¨åˆ†ï¼šé‚£å®ƒä¸ºä»€ä¹ˆå°±ä¼šæ˜¾ç¤ºå‡ºè¿™ä¸ªéƒ¨åˆ†çš„å†…å®¹å‘¢ï¼Ÿä¸‹é¢è®²è§£ä¸‹ï¼šåœ¨main.jsä¸­ï¼š123456789101112131415// The Vue build version to load with the `import` command// (runtime-only or standalone) has been set in webpack.base.conf with an alias.import Vue from 'vue'import App from './App'import router from './router'Vue.config.productionTip = false/* eslint-disable no-new */new Vue(&#123; el: '#app', router, components: &#123; App &#125;, template: '&lt;App/&gt;'&#125;)è¿™é‡Œæˆ‘ä»¬å¼•å…¥äº†routerï¼Œå¹¶åœ¨Vueå®žä¾‹ä¸­ä½¿ç”¨äº†ã€‚ES6è¯­æ³•ï¼Œå½“é”®å€¼å¯¹åç§°ç›¸åŒæ—¶ï¼Œå¯ä»¥ç®€åŒ–ï¼Œæ¯”å¦‚ä¸Šé¢routeræŒ‡çš„æ˜¯router: routerï¼›components: { App }æŒ‡çš„æ˜¯components: { App: App }import router from &#39;./router&#39;ä¼šå¸®æˆ‘ä»¬å¼•å…¥å½“å‰ç›®å½•ä¸‹routeræ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹ï¼Œrouterç›®å½•ä¸‹æ˜¯ä¸€ä¸ªindex.jsï¼š123456789101112131415import Vue from 'vue'import Router from 'vue-router'import HelloWorld from '@/components/HelloWorld'Vue.use(Router)export default new Router(&#123; routes: [ &#123; path: '/', name: 'HelloWorld', component: HelloWorld &#125; ]&#125;)ä¸Šé¢é…ç½®äº†ä¸€ä¸ªè·¯ç”±è§„åˆ™ï¼Œå½“è®¿é—®é¡¹ç›®æ ¹è·¯å¾„çš„æ—¶å€™ï¼Œå¼•å…¥åç§°ä¸ºHelloworldçš„Vueç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶æ¥è‡ª&#39;@/components/HelloWorld&#39;ï¼Œå…¶ä¸­@è¡¨ç¤ºsrcè¿™ä¸ªç›®å½•ã€‚HelloWorld.vueæ–‡ä»¶å†…å®¹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113&lt;template&gt; &lt;div class="hello"&gt; &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;/h1&gt; &lt;h2&gt;Essential Links&lt;/h2&gt; &lt;ul&gt; &lt;li&gt; &lt;a href="https://vuejs.org" target="_blank" &gt; Core Docs &lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="https://forum.vuejs.org" target="_blank" &gt; Forum &lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="https://chat.vuejs.org" target="_blank" &gt; Community Chat &lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="https://twitter.com/vuejs" target="_blank" &gt; Twitter &lt;/a&gt; &lt;/li&gt; &lt;br&gt; &lt;li&gt; &lt;a href="http://vuejs-templates.github.io/webpack/" target="_blank" &gt; Docs for This Template &lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;h2&gt;Ecosystem&lt;/h2&gt; &lt;ul&gt; &lt;li&gt; &lt;a href="http://router.vuejs.org/" target="_blank" &gt; vue-router &lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="http://vuex.vuejs.org/" target="_blank" &gt; vuex &lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="http://vue-loader.vuejs.org/" target="_blank" &gt; vue-loader &lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href="https://github.com/vuejs/awesome-vue" target="_blank" &gt; awesome-vue &lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: 'HelloWorld', data () &#123; return &#123; msg: 'Welcome to Your Vue.js App' &#125; &#125;&#125;&lt;/script&gt;&lt;!-- Add "scoped" attribute to limit CSS to this component only --&gt;&lt;style scoped&gt;h1, h2 &#123; font-weight: normal;&#125;ul &#123; list-style-type: none; padding: 0;&#125;li &#123; display: inline-block; margin: 0 10px;&#125;a &#123; color: #6db33f;&#125;&lt;/style&gt;æ‰€ä»¥é¦–é¡µçº¢æ¡†å†…ä¼šæ˜¾ç¤ºè¿™ä¸ªå†…å®¹ã€‚å‡½æ•°èŠ‚æµæ¯”å¦‚æˆ‘ä»¬çš„åœ¨è¾“å…¥çš„æ—¶å€™éœ€è¦ç›‘æŽ§keypressäº‹ä»¶ï¼Œåœ¨é¡µé¢æ»šåŠ¨çš„æ—¶å€™ç›‘æŽ§é¡µé¢çš„æ»šåŠ¨äº‹ä»¶ï¼Œè¿™æ—¶å€™äº‹ä»¶æ‰§è¡Œçš„é¢‘çŽ‡ä¼šéžå¸¸ä¹‹é«˜ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•æ¥èŠ‚æµï¼š12345678910111213141516data () &#123; return &#123; keyword: '', timer: null &#125;&#125;,watch: &#123; keyword () &#123; if (this.timer) &#123; clearTimeout(this.timer) &#125; this.timer = setTimeout(() =&gt; &#123; // to something &#125;, 100) &#125;&#125;ä¸Šé¢Vueç›‘å¬äº†keywordå˜åŒ–ï¼Œæˆ‘ä»¬åœ¨ç›‘å¬å‡½æ•°é‡Œä½¿ç”¨å®šæ—¶å™¨çš„æ–¹å¼æ¥èŠ‚æµï¼Œè®©é¢‘ç¹è°ƒç”¨çš„æ—¶é—´å»¶è¿Ÿ100æ¯«ç§’ï¼Œè¿™ä¸ªæ—¶é—´èŒƒå›´å†…åªä¼šæ‰§è¡Œä¸€æ¬¡ç›‘æŽ§äº‹ä»¶ã€‚å®žé™…åº”ç”¨æ—¶ï¼Œè¿™ä¸ªæ—¶é—´èŒƒå›´å¸¦æ¥çš„èŠ‚æµå½±å“è‚‰çœ¼ä¸Šçœ‹ä¸å‡ºåŒºåˆ«å³å¯ã€‚Vuexå®žçŽ°æ•°æ®å…±äº«ä¸Šé¢ä»‹ç»äº†ä½¿ç”¨busæ¥è¿›è¡Œéžçˆ¶å­ç»„ä»¶ä¹‹é—´çš„ä¼ å€¼ï¼ŒçŽ°åœ¨æˆ‘ä»¬çœ‹çœ‹æ€Žä¹ˆé€šè¿‡Vuexæ¥å®žçŽ°ï¼ˆå®˜æ–¹æŽ¨èï¼Œæ›´ä¸ºå¼ºå¤§æ–¹ä¾¿ï¼‰ã€‚æ¥çœ‹ä¸‹å›¾:å½“å¤šä¸ªç»„ä»¶ä¹‹é—´éœ€è¦ä¼ é€’å¤æ‚çš„å€¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©Vuexæ¥å®žçŽ°ã€‚Vuexç›¸å½“äºŽæ˜¯ä¸€ä¸ªå­˜å‚¨å…¬å…±æ•°æ®éƒ¨åˆ†çš„åœ°æ–¹ï¼ˆç±»ä¼¼äºŽä»“åº“Storeï¼‰ï¼Œå½“ä¸€ä¸ªå€¼è¢«æ”¹å˜çš„æ—¶å€™ï¼Œåˆ«çš„ç”¨åˆ°è¿™ä¸ªå€¼çš„åœ°æ–¹ä¹Ÿä¼šæ„Ÿåº”åˆ°æ”¹å˜ã€‚ä¸Šå›¾ç»¿è‰²è™šçº¿éƒ¨åˆ†å°±æ˜¯VuexåŒºåŸŸã€‚å…¬å…±æ•°æ®å­˜å‚¨åœ¨Stateéƒ¨åˆ†ï¼Œç»„ä»¶ï¼ˆVue compontentsï¼‰å¯ä»¥ç›´æŽ¥é€šè¿‡Renderæ–¹æ³•å¼•ç”¨ã€‚ç»„ä»¶ä¸èƒ½ç›´æŽ¥æ”¹å˜è¿™ä¸ªæ•°æ®ï¼Œéœ€è¦é€šè¿‡è°ƒç”¨Dispatchæ–¹æ³•æ¥æ”¹å˜Actionsï¼Œç”±å®ƒæ¥é€šè¿‡è°ƒç”¨Commitæ–¹æ³•æ¥æ”¹å˜Mutationsï¼Œæœ€åŽç”±Mutationsè°ƒç”¨Mutateæ–¹æ³•æ¥æ”¹å˜å…¬å…±æ•°æ®ã€‚è¿™ä¸ªè¿‡ç¨‹å°±å¯¹åº”ä¸Šå›¾çš„å¾ªçŽ¯åœˆã€‚è¿™ä¸ªè¿‡ç¨‹ä¹Ÿä¸æ˜¯ç»å¯¹çš„ï¼Œæœ‰çš„æ—¶å€™ç»„ä»¶ä¹Ÿå¯ä»¥ç›´æŽ¥é€šè¿‡è°ƒç”¨Commitæ–¹æ³•æ¥æ”¹å˜Mutationsï¼Œå†ç”±Mutationsè°ƒç”¨Mutateæ–¹æ³•æ¥æ”¹å˜å…¬å…±æ•°æ®ã€‚Vuexå®‰è£…ï¼š1npm install vuexVuexä½¿ç”¨åˆ›å»ºä¸€ä¸ªStoresrcä¸‹æ–°å»ºä¸€ä¸ªstoreç›®å½•ï¼Œç„¶åŽåœ¨ä¸‹é¢åˆ›å»ºindex.jsï¼š12345678910import Vue from 'vue'import Vuex from 'vuex'Vue.use(Vuex)export default new Vuex.Store(&#123; state: &#123; name: 'mrbird' &#125;&#125;)è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªStoreï¼Œå¹¶å®šä¹‰äº†stateï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªnameå±žæ€§ï¼Œå€¼ä¸ºmrbirdã€‚åœ¨main.jsé‡Œå¼•å…¥Store123456789...import store from './store'/* eslint-disable no-new */new Vue(&#123; el: '#app', store, ...&#125;)æˆ‘ä»¬åœ¨main.jsé‡Œå¼•å…¥äº†Storeï¼Œå³æ ¹ç»„ä»¶é‡Œå¼•å…¥äº†ï¼Œæ‰€ä»¥ä»»ä½•å­ç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨äº†ã€‚ä½¿ç”¨Storeé‡Œå­˜çš„å€¼åƒä¸‹é¢è¿™æ ·ä½¿ç”¨ï¼š1this.$store.state.nameè¿™æ ·å°±å¯ä»¥å–å‡ºmrbirdã€‚æ”¹å˜Storeé‡Œå­˜çš„å€¼åœ¨éœ€è¦æ”¹å˜å€¼çš„åœ°æ–¹æ´¾å‘ä¸€ä¸ªæ”¹å˜äº‹ä»¶ï¼š1this.$store.dispatch('changeName', 'newName')ç„¶åŽåœ¨/store/index.jsä¸‹æ·»åŠ actionsï¼š1234567891011121314151617181920import Vue from 'vue'import Vuex from 'vuex'Vue.use(Vuex)export default new Vuex.Store(&#123; state: &#123; name: 'mrbird' &#125;, actions: &#123; changeName (ctx, name) &#123; ctx.commit('changeName', name) &#125; &#125;, mutations: &#123; changeName (state, name) &#123; state.name = name &#125; &#125;&#125;)å¯çœ‹åˆ°ï¼Œactionsé‡Œå®šä¹‰çš„changeNameæ–¹æ³•å¯¹åº”this.$store.dispatch(&#39;changeName&#39;, name)æ´¾å‘çš„æ–¹æ³•ï¼Œé€šè¿‡ç¬¬ä¸€ä¸ªå…¥å‚ctxæ‰§è¡Œctx.commit(&#39;changeName&#39;, name)ï¼Œè¿™é‡Œçš„changeNameå¯¹åº”mutationsé‡Œçš„changeNameæ–¹æ³•ï¼Œæœ€ç»ˆæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•é‡Œæ”¹å˜stateé‡Œçš„nameçš„å€¼ã€‚ä¸Šé¢è¿™ä¸ªè¿‡ç¨‹å¯¹åº”å›¾é‡Œæµç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿå¯ä»¥ç®€åŒ–ðŸ‘‡åœ¨éœ€è¦æ”¹å˜å€¼çš„åœ°æ–¹æ‰§è¡Œä¸‹é¢è¯­å¥ï¼š1this.$store.commit('changeName', 'newName')ç„¶åŽ/store/index.jsä¸‹ç›´æŽ¥è¿™æ ·å†™å³å¯ï¼š123456789101112131415import Vue from 'vue'import Vuex from 'vuex'Vue.use(Vuex)export default new Vuex.Store(&#123; state: &#123; name: 'mrbird' &#125;, mutations: &#123; changeName (state, name) &#123; state.name = name &#125; &#125;&#125;)Vuexé«˜çº§ç‰¹æ€§ä»ŽVuexé‡Œå–å‡ºstateé‡Œçš„å€¼çš„æ—¶å€™ï¼Œä¸Šé¢æ˜¯è¿™æ ·å†™çš„ï¼š1this.$store.state.nameè¿™é‡Œå¯ä»¥ç®€åŒ–ä¸€æ³¢ï¼š123456789import &#123; mapState &#125; from 'vuex'export default &#123; ... computed: &#123; ...mapState(['name']) &#125; ...&#125;ç„¶åŽå–å€¼çš„åœ°æ–¹ç›´æŽ¥this.nameå°±è¡Œäº†ã€‚ä¹Ÿå¯ä»¥è¿™æ ·ï¼š1234567891011import &#123; mapState &#125; from 'vuex'export default &#123; ... computed: &#123; ...mapState(&#123; currentUser: 'user' &#125;) &#125; ...&#125;ç„¶åŽå–å€¼çš„åœ°æ–¹ç›´æŽ¥this.currentUserå°±è¡Œäº†ã€‚å–å€¼çš„åœ°æ–¹å¯ä»¥ç®€åŒ–ï¼Œé‚£ä¹ˆæ”¹å˜å€¼çš„åœ°æ–¹ä¹Ÿå¯ä»¥ç®€åŒ–ï¼ˆimportçš„æ—¶å€™ä¹Ÿå¼•å…¥mapMutationsï¼‰ï¼š1import &#123; mapMutations &#125; from 'vuex'ç„¶åŽåœ¨methodsé‡Œè¿™æ ·ï¼š1234567methods: &#123; handleClick (name) &#123; // this.$store.commit('changeName', name) this.changeName(name) &#125;, ...mapMutations(['changeName'])&#125;å®žé™…é¡¹ç›®ä¸­ï¼Œactionså’Œmutationsé‡Œçš„å†…å®¹ä¸€èˆ¬éƒ½éžå¸¸å¤šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬å‰¥ç¦»å‡ºæ¥ï¼Œç„¶åŽå¼•å…¥å³å¯ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼šæ–°å»ºmutations.jsï¼š123456export default &#123; changeName (state, name) &#123; state.name = name localStorage.name = name &#125;&#125;ç„¶åŽåœ¨store/index.jsé‡Œå¼•å…¥ï¼š12345678910import Vue from 'vue'import Vuex from 'vuex'import mutations from './mutations'Vue.use(Vuex)export default new Vuex.Store(&#123; ... mutations&#125;)Vuex GetterGetterç±»ä¼¼äºŽVuexç‰ˆçš„computedï¼Œåœ¨store/index.jsé‡Œå®šä¹‰Getterï¼š123456789101112131415import Vue from 'vue'import Vuex from 'vuex'Vue.use(Vuex)export default new Vuex.Store(&#123; state: &#123; name: 'mrbird' &#125;, getters: &#123; getMessage (state) &#123; return state.name + 'is so handsome' &#125; &#125;&#125;)å¼•ç”¨çš„åœ°æ–¹ï¼š12345678import &#123; mapGetters &#125; from 'vuex'export default &#123; ... computed: &#123; ...mapGetters(['getMessage']) &#125;&#125;ç„¶åŽthis.getMessageå°±ä¼šå¾—åˆ°mrbird is so handsomeä¿¡æ¯äº†ã€‚Getterè¯¦ç»†æ–‡æ¡£ï¼š https://vuex.vuejs.org/zh/guide/getters.htmlVuex Moduleç”±äºŽä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ä¼šé›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ã€‚å½“åº”ç”¨å˜å¾—éžå¸¸å¤æ‚æ—¶ï¼Œstore å¯¹è±¡å°±æœ‰å¯èƒ½å˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼ŒVuex å…è®¸æˆ‘ä»¬å°† store åˆ†å‰²æˆæ¨¡å—ï¼ˆmoduleï¼‰ã€‚æ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„ stateã€mutationã€actionã€getterã€ç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å—â€”â€”ä»Žä¸Šè‡³ä¸‹è¿›è¡ŒåŒæ ·æ–¹å¼çš„åˆ†å‰²ï¼š12345678910111213141516171819202122const moduleA = &#123; state: &#123; ... &#125;, mutations: &#123; ... &#125;, actions: &#123; ... &#125;, getters: &#123; ... &#125;&#125;const moduleB = &#123; state: &#123; ... &#125;, mutations: &#123; ... &#125;, actions: &#123; ... &#125;&#125;const store = new Vuex.Store(&#123; modules: &#123; a: moduleA, b: moduleB &#125;&#125;)store.state.a // -&gt; moduleA çš„çŠ¶æ€store.state.b // -&gt; moduleB çš„çŠ¶æ€è¯¦ç»†æ–‡æ¡£ï¼š https://vuex.vuejs.org/zh/guide/modules.htmlè·¯ç”±è·³è½¬æˆ‘ä»¬é™¤äº†å¯ä»¥ä½¿ç”¨&lt;router-link&gt;åˆ›å»º a æ ‡ç­¾æ¥å®šä¹‰å¯¼èˆªé“¾æŽ¥ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å€ŸåŠ© router çš„å®žä¾‹æ–¹æ³•ï¼Œé€šè¿‡ç¼–å†™ä»£ç æ¥å®žçŽ°ï¼š1router.push('/home')å…·ä½“ï¼šhttps://router.vuejs.org/zh/guide/essentials/navigation.htmlè·¯ç”±å‚æ•°ä¼ é€’å½“è·¯ç”±pathä¸­åŒ…å«å‚æ•°çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼š123456789export default new Router(&#123; routes: [ &#123; path: '/detail/:id', name: 'Detail', component: Detail &#125; ]&#125;)åœ¨Detailç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨this.$route.params.idæ¥èŽ·å–äº†ã€‚localStorageH5ä¸­æ–°å¢žçš„å¯ä»¥å­˜å‚¨æ•°æ®çš„ä¸œä¸œï¼Œç±»ä¼¼cookieï¼Œä½†æ¯”cookieæ›´ç®€å•ã€‚æ”¹è¿›ä¸€ä¸‹ä¸Šé¢Vuexçš„ä¾‹å­ï¼š1234567891011export default new Vuex.Store(&#123; state: &#123; name: localStorage.name || 'mrbird' &#125;, mutations: &#123; changeName (state, name) &#123; state.name = name localStorage.name = name &#125; &#125;&#125;)åœ¨mutationsä¸­ï¼Œæˆ‘ä»¬ä¸ä½†æ”¹å˜äº†state.nameçš„å€¼ï¼Œè¿˜æŠŠå€¼å­˜åˆ°äº†localStorageä¸­ï¼Œè¿™æ ·å³ä½¿æµè§ˆå™¨åˆ·æ–°ä¹Ÿä¸ä¼šé‡ç½®å›žâ€™mrbirdâ€™ã€‚å’Œcookieç±»ä¼¼ï¼ŒlocalStorageä¹Ÿå¯ä»¥é€šè¿‡æµè§ˆå™¨ç¦ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨localStorageçš„æ—¶å€™è¦ç”¨try{}catch(){}æ¥å¤„ç†ï¼Œé˜²æ­¢ä»£ç æŠ›å‡ºå¼‚å¸¸æ— æ³•æ­£å¸¸è¿è¡Œã€‚keep-alivehttps://cn.vuejs.org/v2/api/#keep-aliveç»„ä»¶çš„é€’å½’å½“ä¸€ä¸ªæ•°æ®å…·æœ‰ä¸Šä¸‹çº§ï¼Œè€Œä¸”çº§æ•°æ— æ³•ç¡®å®šçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é€’å½’ç»„ä»¶æ¥å±•ç¤ºæˆ‘ä»¬çš„å±‚çº§æ•°æ®ï¼Œçœ‹ä¸‹é¢è¿™ä¸ªæ —å­ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;template&gt; &lt;div&gt; &lt;div class="item" v-for="(item, index) of list" :key="index"&gt; &lt;div class="item-title border-bottom"&gt; &lt;span class="item-title-icon"&gt;&lt;/span&gt; &#123;&#123;item.title&#125;&#125; &lt;/div&gt; &lt;div v-if="item.children" class="item-chilren"&gt; &lt;detail-list :list="item.children"&gt;&lt;/detail-list&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: 'DetailList', data() &#123; return &#123; list: [ &#123; title: 'çˆ·çˆ·', children: [ &#123; title: 'çˆ¸çˆ¸' &#125;, &#123; title: 'å¦ˆå¦ˆ', children: [ &#123; title: 'å°æ˜Ž' &#125; ] &#125; ] &#125;, &#123; title: 'å¥¶å¥¶' &#125; ] &#125; &#125;&#125;&lt;/script&gt;è¿™ä¸ªç»„ä»¶å«DetailListï¼Œåœ¨å¾ªçŽ¯ä¸­ï¼Œé€šè¿‡item.childrenæ¥åˆ¤æ–­æ˜¯å¦æœ‰ä¸‹çº§ï¼Œæœ‰çš„è¯è°ƒç”¨ç»„ä»¶è‡ªèº«ã€‚è¿™æ ·å°±å¯ä»¥å¾ˆç®€å•çš„å®žçŽ°é€’å½’äº†ã€‚Vueé¡¹ç›®æ‰“åŒ…ä¸Šçº¿ä¿®æ”¹config/index.jsï¼šçº¢æ¡†éƒ¨åˆ†æˆ‘ä»¬å°†assetsPublicPathæŒ‡å®šä¸º/vueã€‚æŽ¥ç€åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š1npm run buildæ‰“åŒ…å®Œï¼Œå‘½ä»¤è¡Œä¼šæç¤ºï¼šç„¶åŽé¡¹ç›®é‡Œä¼šå‡ºçŽ°ä¸€ä¸ªdistç›®å½•ï¼šæˆ‘ä»¬åœ¨tomcatçš„webappsç›®å½•ä¸‹ä¹Ÿæ–°å»ºä¸€ä¸ªvueç›®å½•ï¼Œç„¶åŽæŠŠdisté‡Œçš„å†…å®¹æ‹·è´è¿›åŽ»ï¼Œç„¶åŽå¯åŠ¨tomcatï¼Œè®¿é—®http://{ip}:{port}/vueå°±èƒ½çœ‹åˆ°é¡¹ç›®äº†ã€‚å¼‚æ­¥ç»„ä»¶åŠ è½½æŸ¥çœ‹æ‰“åŒ…ç›®å½•ä¸‹çš„jsæ–‡ä»¶å¤¹ï¼šé¡¹ç›®æ‰€æœ‰çš„é€»è¾‘éƒ½è¢«æ‰“åŒ…åœ¨äº†appXXXX.jsé‡Œäº†ï¼Œå³åœ¨åŠ è½½é¦–é¡µçš„æ—¶å€™ï¼Œæ•´ä¸ªé¡¹ç›®jsé€»è¾‘éƒ½è¢«åŠ è½½äº†ã€‚å¦‚æžœé¡¹ç›®è§„æ¨¡å¾ˆå¤§ï¼Œè¿™ä¸ªæ–‡ä»¶å°†å¯èƒ½è¾¾åˆ°MBçº§åˆ«ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ç»„ä»¶è¿›è¡Œå¼‚æ­¥çš„åŠ è½½æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚åœ¨è·¯ç”±ä¸­ï¼Œæˆ‘ä»¬è¿™æ ·å¼•ç”¨ç»„ä»¶ï¼š123456789101112131415161718192021222324import Vue from 'vue'import Router from 'vue-router'Vue.use(Router)export default new Router(&#123; routes: [ &#123; path: '/', name: 'home', component: () =&gt; import('@/pages/home/Home') &#125;, &#123; path: '/dept', name: 'dept', component: () =&gt; import('@/pages/dept/Dept') &#125;, &#123; path: '/detail/:id', name: 'Detail', component: () =&gt; import('@/pages/detail/Detail') &#125; ]&#125;)componenté‡Œæˆ‘ä»¬ä½¿ç”¨ç®­å¤´å‡½æ•°æ¥å¼•å…¥å¯¹åº”çš„ç»„ä»¶ï¼Œè¿™æ ·å°±å®žçŽ°äº†å¼‚æ­¥åŠ è½½ï¼Œé‡æ–°æ‰“åŒ…é¡¹ç›®ï¼Œå†æ¬¡æŸ¥çœ‹jsæ–‡ä»¶å¤¹ï¼šå¯ä»¥çœ‹åˆ°appxxxx.jså·²ç»è¢«æ‹†åˆ†äº†ã€‚è‡ªå®šä¹‰Vueæ’ä»¶å…·ä½“å¯æŸ¥çœ‹ï¼šhttps://router.vuejs.org/zh/guide/advanced/lazy-loading.html]]></content>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Security OAuth2å…¥é—¨]]></title>
    <url>%2FSpring-Security-OAuth2-Guide.html</url>
    <content type="text"><![CDATA[OAuthæ˜¯ä¸€ç§ç”¨æ¥è§„èŒƒä»¤ç‰Œï¼ˆTokenï¼‰å‘æ”¾çš„æŽˆæƒæœºåˆ¶ï¼Œä¸»è¦åŒ…å«äº†å››ç§æŽˆæƒæ¨¡å¼ï¼šæŽˆæƒç æ¨¡å¼ã€ç®€åŒ–æ¨¡å¼ã€å¯†ç æ¨¡å¼å’Œå®¢æˆ·ç«¯æ¨¡å¼ã€‚Spring Security OAuth2å¯¹è¿™å››ç§æŽˆæƒæ¨¡å¼è¿›è¡Œäº†å®žçŽ°ã€‚è¿™èŠ‚ä¸»è¦è®°å½•ä¸‹ä»€ä¹ˆæ˜¯OAuth2ä»¥åŠSpring Security OAuth2çš„åŸºæœ¬ä½¿ç”¨ã€‚å››ç§æŽˆæƒæ¨¡å¼åœ¨äº†è§£è¿™å››ç§æŽˆæƒæ¨¡å¼ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå­¦ä¹ ä¸€äº›å’ŒOAuthç›¸å…³çš„åè¯ã€‚ä¸¾ä¸ªç¤¾äº¤ç™»å½•çš„ä¾‹å­å§ï¼Œæ¯”å¦‚åœ¨æµè§ˆå™¨ä¸Šä½¿ç”¨QQè´¦å·ç™»å½•è™Žç‰™ç›´æ’­ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥æå–å‡ºä»¥ä¸‹å‡ ä¸ªåè¯ï¼šThird-party application ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºï¼Œæ¯”å¦‚è¿™é‡Œçš„è™Žç‰™ç›´æ’­ï¼›HTTP service HTTPæœåŠ¡æä¾›å•†ï¼Œæ¯”å¦‚è¿™é‡Œçš„QQï¼ˆè…¾è®¯ï¼‰;Resource Owner èµ„æºæ‰€æœ‰è€…ï¼Œå°±æ˜¯QQçš„æ‰€æœ‰äººï¼Œä½ ï¼›User Agent ç”¨æˆ·ä»£ç†ï¼Œè¿™é‡ŒæŒ‡æµè§ˆå™¨ï¼›Authorization server è®¤è¯æœåŠ¡å™¨ï¼Œè¿™é‡ŒæŒ‡QQæä¾›çš„ç¬¬ä¸‰æ–¹ç™»å½•æœåŠ¡ï¼›Resource server èµ„æºæœåŠ¡å™¨ï¼Œè¿™é‡ŒæŒ‡è™Žç‰™ç›´æ’­æä¾›çš„æœåŠ¡ï¼Œæ¯”å¦‚é«˜æ¸…ç›´æ’­ï¼Œå¼¹å¹•å‘é€ç­‰ï¼ˆéœ€è¦è®¤è¯åŽæ‰èƒ½ä½¿ç”¨ï¼‰ã€‚è®¤è¯æœåŠ¡å™¨å’Œèµ„æºæœåŠ¡å™¨å¯ä»¥åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œæ¯”å¦‚å‰åŽç«¯åˆ†ç¦»çš„æœåŠ¡åŽå°ï¼Œå®ƒå³ä¾›è®¤è¯æœåŠ¡ï¼ˆè®¤è¯æœåŠ¡å™¨ï¼Œæä¾›ä»¤ç‰Œï¼‰ï¼Œå®¢æˆ·ç«¯é€šè¿‡ä»¤ç‰Œæ¥ä»ŽåŽå°èŽ·å–æœåŠ¡ï¼ˆèµ„æºæœåŠ¡å™¨ï¼‰ï¼›å®ƒä»¬ä¹Ÿå¯ä»¥ä¸åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œæ¯”å¦‚ä¸Šé¢ç¬¬ä¸‰æ–¹ç™»å½•çš„ä¾‹å­ã€‚å¤§è‡´äº†è§£äº†è¿™å‡ ä¸ªåè¯åŽï¼Œæˆ‘ä»¬å¼€å§‹äº†è§£å››ç§æŽˆæƒæ¨¡å¼ã€‚æŽˆæƒç æ¨¡å¼æŽˆæƒç æ¨¡å¼æ˜¯æœ€èƒ½ä½“çŽ°OAuth2åè®®ï¼Œæœ€ä¸¥æ ¼ï¼Œæµç¨‹æœ€å®Œæ•´çš„æŽˆæƒæ¨¡å¼ï¼Œæµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼šA. å®¢æˆ·ç«¯å°†ç”¨æˆ·å¯¼å‘è®¤è¯æœåŠ¡å™¨ï¼›B. ç”¨æˆ·å†³å®šæ˜¯å¦ç»™å®¢æˆ·ç«¯æŽˆæƒï¼›C. åŒæ„æŽˆæƒåŽï¼Œè®¤è¯æœåŠ¡å™¨å°†ç”¨æˆ·å¯¼å‘å®¢æˆ·ç«¯æä¾›çš„URLï¼Œå¹¶é™„ä¸ŠæŽˆæƒç ï¼›D. å®¢æˆ·ç«¯é€šè¿‡é‡å®šå‘URLå’ŒæŽˆæƒç åˆ°è®¤è¯æœåŠ¡å™¨æ¢å–ä»¤ç‰Œï¼›E. æ ¡éªŒæ— è¯¯åŽå‘æ”¾ä»¤ç‰Œã€‚å…¶ä¸­Aæ­¥éª¤ï¼Œå®¢æˆ·ç«¯ç”³è¯·è®¤è¯çš„URIï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼šresponse_typeï¼šè¡¨ç¤ºæŽˆæƒç±»åž‹ï¼Œå¿…é€‰é¡¹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸ºâ€codeâ€ï¼Œæ ‡è¯†æŽˆæƒç æ¨¡å¼client_idï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„IDï¼Œå¿…é€‰é¡¹redirect_uriï¼šè¡¨ç¤ºé‡å®šå‘URIï¼Œå¯é€‰é¡¹scopeï¼šè¡¨ç¤ºç”³è¯·çš„æƒé™èŒƒå›´ï¼Œå¯é€‰é¡¹stateï¼šè¡¨ç¤ºå®¢æˆ·ç«¯çš„å½“å‰çŠ¶æ€ï¼Œå¯ä»¥æŒ‡å®šä»»æ„å€¼ï¼Œè®¤è¯æœåŠ¡å™¨ä¼šåŽŸå°ä¸åŠ¨åœ°è¿”å›žè¿™ä¸ªå€¼ã€‚Dæ­¥éª¤ä¸­ï¼Œå®¢æˆ·ç«¯å‘è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œçš„HTTPè¯·æ±‚ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼šgrant_typeï¼šè¡¨ç¤ºä½¿ç”¨çš„æŽˆæƒæ¨¡å¼ï¼Œå¿…é€‰é¡¹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸ºâ€authorization_codeâ€ã€‚codeï¼šè¡¨ç¤ºä¸Šä¸€æ­¥èŽ·å¾—çš„æŽˆæƒç ï¼Œå¿…é€‰é¡¹ã€‚redirect_uriï¼šè¡¨ç¤ºé‡å®šå‘URIï¼Œå¿…é€‰é¡¹ï¼Œä¸”å¿…é¡»ä¸ŽAæ­¥éª¤ä¸­çš„è¯¥å‚æ•°å€¼ä¿æŒä¸€è‡´ã€‚client_idï¼šè¡¨ç¤ºå®¢æˆ·ç«¯IDï¼Œå¿…é€‰é¡¹ã€‚å¯†ç æ¨¡å¼åœ¨å¯†ç æ¨¡å¼ä¸­ï¼Œç”¨æˆ·åƒå®¢æˆ·ç«¯æä¾›ç”¨æˆ·åå’Œå¯†ç ï¼Œå®¢æˆ·ç«¯é€šè¿‡ç”¨æˆ·åå’Œå¯†ç åˆ°è®¤è¯æœåŠ¡å™¨èŽ·å–ä»¤ç‰Œã€‚æµç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼šA. ç”¨æˆ·å‘å®¢æˆ·ç«¯æä¾›ç”¨æˆ·åå’Œå¯†ç ï¼›B. å®¢æˆ·ç«¯å‘è®¤è¯æœåŠ¡å™¨æ¢å–ä»¤ç‰Œï¼›C. å‘æ”¾ä»¤ç‰Œã€‚Bæ­¥éª¤ä¸­ï¼Œå®¢æˆ·ç«¯å‘å‡ºçš„HTTPè¯·æ±‚ï¼ŒåŒ…å«ä»¥ä¸‹å‚æ•°ï¼šgrant_typeï¼šè¡¨ç¤ºæŽˆæƒç±»åž‹ï¼Œæ­¤å¤„çš„å€¼å›ºå®šä¸ºâ€passwordâ€ï¼Œå¿…é€‰é¡¹ã€‚usernameï¼šè¡¨ç¤ºç”¨æˆ·åï¼Œå¿…é€‰é¡¹ã€‚passwordï¼šè¡¨ç¤ºç”¨æˆ·çš„å¯†ç ï¼Œå¿…é€‰é¡¹ã€‚scopeï¼šè¡¨ç¤ºæƒé™èŒƒå›´ï¼Œå¯é€‰é¡¹ã€‚å‰©ä¸‹ä¸¤ç§æŽˆæƒæ¨¡å¼å¯ä»¥å‚è€ƒä¸‹é¢çš„å‚è€ƒé“¾æŽ¥ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚Spring Security OAuth2Springæ¡†æž¶å¯¹OAuth2åè®®è¿›è¡Œäº†å®žçŽ°ï¼Œä¸‹é¢å­¦ä¹ ä¸‹ä¸Šé¢ä¸¤ç§æ¨¡å¼åœ¨Spring Security OAuth2ç›¸å…³æ¡†æž¶çš„ä½¿ç”¨ã€‚Spring Security OAuth2ä¸»è¦åŒ…å«è®¤è¯æœåŠ¡å™¨å’Œèµ„æºæœåŠ¡å™¨è¿™ä¸¤å¤§å—çš„å®žçŽ°ï¼šè®¤è¯æœåŠ¡å™¨ä¸»è¦åŒ…å«äº†å››ç§æŽˆæƒæ¨¡å¼çš„å®žçŽ°å’ŒTokençš„ç”Ÿæˆä¸Žå­˜å‚¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨è®¤è¯æœåŠ¡å™¨ä¸­è‡ªå®šä¹‰èŽ·å–Tokençš„æ–¹å¼ï¼ˆåŽé¢ä¼šä»‹ç»åˆ°ï¼‰ï¼›èµ„æºæœåŠ¡å™¨ä¸»è¦æ˜¯åœ¨Spring Securityçš„è¿‡æ»¤å™¨é“¾ä¸ŠåŠ äº†OAuth2AuthenticationProcessingFilterè¿‡æ»¤å™¨ï¼Œå³ä½¿ç”¨OAuth2åè®®å‘æ”¾ä»¤ç‰Œè®¤è¯çš„æ–¹å¼æ¥ä¿æŠ¤æˆ‘ä»¬çš„èµ„æºã€‚é…ç½®è®¤è¯æœåŠ¡å™¨æ–°å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç‰ˆæœ¬ä¸º2.1.6.RELEASEï¼Œå¹¶å¼•å…¥ç›¸å…³ä¾èµ–ï¼Œpomå¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.6.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt;cc.mrbird&lt;/groupId&gt; &lt;artifactId&gt;security&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;security&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;spring-cloud.version&gt;Greenwich.SR1&lt;/spring-cloud.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-security&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-cloud.version&#125;&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;åœ¨åˆ›å»ºè®¤è¯æœåŠ¡å™¨å‰ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªMyUserå¯¹è±¡ï¼š1234567891011public class MyUser implements Serializable &#123; private static final long serialVersionUID = 3497935890426858541L; private String userName; private String password; private boolean accountNonExpired = true; private boolean accountNonLocked= true; private boolean credentialsNonExpired= true; private boolean enabled= true; // get set ç•¥&#125;æŽ¥ç€å®šä¹‰UserDetailServiceå®žçŽ°org.springframework.security.core.userdetails.UserDetailsServiceæŽ¥å£ï¼š123456789101112131415@Servicepublic class UserDetailService implements UserDetailsService &#123; @Autowired private PasswordEncoder passwordEncoder; @Override public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException &#123; MyUser user = new MyUser(); user.setUserName(username); user.setPassword(this.passwordEncoder.encode("123456")); return new User(username, user.getPassword(), user.isEnabled(), user.isAccountNonExpired(), user.isCredentialsNonExpired(), user.isAccountNonLocked(), AuthorityUtils.commaSeparatedStringToAuthorityList("admin")); &#125;&#125;è¿™é‡Œçš„é€»è¾‘æ˜¯ç”¨ä»€ä¹ˆè´¦å·ç™»å½•éƒ½å¯ä»¥ï¼Œä½†æ˜¯å¯†ç å¿…é¡»ä¸º123456ï¼Œå¹¶ä¸”æ‹¥æœ‰â€adminâ€æƒé™ï¼ˆè¿™äº›éƒ½åœ¨å‰é¢çš„Securityæ•™ç¨‹é‡Œè¯´è¿‡äº†ï¼Œå°±ä¸å†è¯¦ç»†è¯´æ˜Žäº†ï¼‰ã€‚æŽ¥ä¸‹æ¥å¼€å§‹åˆ›å»ºä¸€ä¸ªè®¤è¯æœåŠ¡å™¨ï¼Œå¹¶ä¸”åœ¨é‡Œé¢å®šä¹‰UserDetailServiceéœ€è¦ç”¨åˆ°çš„PasswordEncoderã€‚åˆ›å»ºè®¤è¯æœåŠ¡å™¨å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨Spring Securityçš„é…ç½®ç±»ä¸Šä½¿ç”¨@EnableAuthorizationServeræ³¨è§£æ ‡æ³¨å³å¯ã€‚åˆ›å»ºAuthorizationServerConfigï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š123456789@Configuration@EnableAuthorizationServerpublic class AuthorizationServerConfig extends WebSecurityConfigurerAdapter &#123; @Bean public PasswordEncoder passwordEncoder() &#123; return new BCryptPasswordEncoder(); &#125;&#125;è¿™æ—¶å€™å¯åŠ¨é¡¹ç›®ï¼Œä¼šå‘çŽ°æŽ§åˆ¶å°æ‰“å°å‡ºäº†éšæœºåˆ†é…çš„client-idå’Œclient-secretï¼šä¸ºäº†æ–¹ä¾¿åŽé¢çš„æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æŒ‡å®šè¿™ä¸¤ä¸ªå€¼ã€‚åœ¨Spring Booté…ç½®æ–‡ä»¶application.ymlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®:12345security: oauth2: client: client-id: test client-secret: test1234é‡å¯é¡¹ç›®ï¼Œå‘çŽ°æŽ§åˆ¶å°è¾“å‡ºï¼šè¯´æ˜Žæ›¿æ¢æˆåŠŸã€‚æŽˆæƒç æ¨¡å¼èŽ·å–ä»¤ç‰ŒæŽ¥ä¸‹æ¥å¼€å§‹å¾€è®¤è¯æœåŠ¡å™¨è¯·æ±‚æŽˆæƒç ã€‚æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®http://localhost:8080/oauth/authorize?response_type=code&amp;client_id=test&amp;redirect_uri=http://mrbird.cc&amp;scope=all&amp;state=helloURLä¸­çš„å‡ ä¸ªå‚æ•°åœ¨ä¸Šé¢çš„æŽˆæƒç æ¨¡å¼çš„Aæ­¥éª¤é‡Œéƒ½æœ‰è¯¦ç»†è¯´æ˜Žã€‚è¿™é‡Œresponse_typeå¿…é¡»ä¸ºcodeï¼Œè¡¨ç¤ºæŽˆæƒç æ¨¡å¼ï¼Œclient_idå°±æ˜¯åˆšåˆšåœ¨é…ç½®æ–‡ä»¶ä¸­æ‰‹åŠ¨æŒ‡å®šçš„testï¼Œredirect_uriè¿™é‡Œéšä¾¿æŒ‡å®šä¸€ä¸ªåœ°å€å³å¯ï¼Œä¸»è¦æ˜¯ç”¨æ¥é‡å®šå‘èŽ·å–æŽˆæƒç çš„ï¼ŒscopeæŒ‡å®šä¸ºallï¼Œè¡¨ç¤ºæ‰€æœ‰æƒé™ã€‚è®¿é—®è¿™ä¸ªé“¾æŽ¥åŽï¼Œé¡µé¢å¦‚ä¸‹æ‰€ç¤ºï¼šéœ€è¦ç™»å½•è®¤è¯ï¼Œæ ¹æ®æˆ‘ä»¬å‰é¢å®šä¹‰çš„UserDetailServiceé€»è¾‘ï¼Œè¿™é‡Œç”¨æˆ·åéšä¾¿è¾“ï¼Œå¯†ç ä¸º123456å³å¯ã€‚è¾“å…¥åŽï¼Œé¡µé¢è·³è½¬å¦‚ä¸‹æ‰€ç¤ºï¼šåŽŸå› æ˜¯ä¸Šé¢æŒ‡å®šçš„redirect_uriå¿…é¡»åŒæ—¶åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šï¼Œæˆ‘ä»¬å¾€application.ymlæ·»åŠ é…ç½®ï¼š123456security: oauth2: client: client-id: test client-secret: test1234 registered-redirect-uri: http://mrbird.ccé‡å¯é¡¹ç›®ï¼Œé‡æ–°æ‰§è¡Œä¸Šé¢çš„æ­¥éª¤ï¼Œç™»å½•æˆåŠŸåŽé¡µé¢æˆåŠŸè·³è½¬åˆ°äº†æŽˆæƒé¡µé¢ï¼šé€‰æ‹©åŒæ„Approveï¼Œç„¶åŽç‚¹å‡»AuthorizeæŒ‰é’®åŽï¼Œé¡µé¢è·³è½¬åˆ°äº†æˆ‘ä»¬æŒ‡å®šçš„redirect_uriï¼Œå¹¶ä¸”å¸¦ä¸Šäº†æŽˆæƒç ä¿¡æ¯:åˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ä¸ªæŽˆæƒç ä»Žè®¤è¯æœåŠ¡å™¨èŽ·å–ä»¤ç‰ŒTokenäº†ã€‚ä½¿ç”¨postmanå‘é€å¦‚ä¸‹è¯·æ±‚POSTè¯·æ±‚localhost:8080/oauth/tokenï¼šè¿™é‡Œè¦å¡«çš„å‚æ•°å’Œä¸Šé¢ä»‹ç»çš„æŽˆæƒç æ¨¡å¼Dæ­¥éª¤ä»‹ç»çš„ä¸€è‡´ã€‚grant_typeå›ºå®šå¡«authorization_codeï¼Œcodeä¸ºä¸Šä¸€æ­¥èŽ·å–åˆ°çš„æŽˆæƒç ï¼Œclient_idå’Œredirect_uriå¿…é¡»å’Œæˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„ä¸€è‡´ã€‚é™¤äº†è¿™å‡ ä¸ªå‚æ•°å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­å¡«å†™ï¼škeyä¸ºAuthorizationï¼Œvalueä¸ºBasicåŠ ä¸Šclient_id:client_secretç»è¿‡base64åŠ å¯†åŽçš„å€¼ï¼ˆå¯ä»¥ä½¿ç”¨http://tool.chinaz.com/Tools/Base64.aspxï¼‰:å‚æ•°å¡«å†™æ— è¯¯åŽï¼Œç‚¹å‡»å‘é€ä¾¿å¯ä»¥èŽ·å–åˆ°ä»¤ç‰ŒTokenï¼š1234567&#123; "access_token": "950018df-0199-4936-aa80-a3a66183f634", "token_type": "bearer", "refresh_token": "cc22e8b2-e069-459d-8c24-cfda0bc72128", "expires_in": 42827, "scope": "all"&#125;ä¸€ä¸ªæŽˆæƒç åªèƒ½æ¢ä¸€æ¬¡ä»¤ç‰Œï¼Œå¦‚æžœå†æ¬¡ç‚¹å‡»postmançš„å‘é€æŒ‰é’®ï¼Œå°†è¿”å›žï¼š1234&#123; "error": "invalid_grant", "error_description": "Invalid authorization code: xw8x55"&#125;å¯†ç æ¨¡å¼èŽ·å–ä»¤ç‰Œå’ŒæŽˆæƒç æ¨¡å¼ç›¸æ¯”ï¼Œä½¿ç”¨å¯†ç æ¨¡å¼èŽ·å–ä»¤ç‰Œå°±æ˜¾å¾—ç®€å•å¤šäº†ã€‚åŒæ ·ä½¿ç”¨postmanå‘é€POSTè¯·æ±‚localhost:8080/oauth/tokenï¼šgrant_typeå¡«passwordï¼Œè¡¨ç¤ºå¯†ç æ¨¡å¼ï¼›ç„¶åŽå¡«å†™ç”¨æˆ·åå’Œå¯†ç ï¼Œå¤´éƒ¨ä¹Ÿéœ€è¦å¡«å†™Authorizationä¿¡æ¯ï¼Œå†…å®¹å’ŒæŽˆæƒç æ¨¡å¼ä»‹ç»çš„ä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸æˆªå›¾äº†ã€‚ç‚¹å‡»å‘é€ï¼Œä¹Ÿå¯ä»¥èŽ·å¾—ä»¤ç‰Œï¼š1234567&#123; "access_token": "d612cf50-6499-4a0c-9cd4-9c756839aa12", "token_type": "bearer", "refresh_token": "fdc6c77f-b910-46dc-a349-835dc0587919", "expires_in": 43090, "scope": "all"&#125;é…ç½®èµ„æºæœåŠ¡å™¨ä¸ºä»€ä¹ˆéœ€è¦èµ„æºæœåŠ¡å™¨å‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹åœ¨æ²¡æœ‰å®šä¹‰èµ„æºæœåŠ¡å™¨çš„æ—¶å€™ï¼Œä½¿ç”¨TokenåŽ»èŽ·å–èµ„æºæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚å®šä¹‰ä¸€ä¸ªRESTæŽ¥å£ï¼š12345678@RestControllerpublic class UserController &#123; @GetMapping("index") public Object index(Authentication authentication)&#123; return authentication; &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼Œä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨å¯†ç æ¨¡å¼èŽ·å–ä»¤ç‰Œï¼Œç„¶åŽä½¿ç”¨è¯¥ä»¤ç‰ŒèŽ·å–/indexè¿™ä¸ªèµ„æºï¼šAuthorizationå€¼ä¸ºtoken_type access_tokenï¼Œå‘é€è¯·æ±‚åŽï¼Œè¿”å›žï¼š1234567&#123; "timestamp": "2019-03-24T13:13:43.818+0000", "status": 401, "error": "Unauthorized", "message": "Unauthorized", "path": "/index"&#125;è™½ç„¶ä»¤ç‰Œæ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯å¹¶æ— æ³•è®¿é—®/indexï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»é…ç½®èµ„æºæœåŠ¡å™¨ï¼Œè®©å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡åˆæ³•çš„ä»¤ç‰Œæ¥èŽ·å–èµ„æºã€‚èµ„æºæœåŠ¡å™¨çš„é…ç½®ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨é…ç½®ç±»ä¸Šä½¿ç”¨@EnableResourceServeræ³¨è§£æ ‡æ³¨å³å¯ï¼š12345@Configuration@EnableResourceServerpublic class ResourceServerConfig &#123;&#125;é‡å¯æœåŠ¡ï¼Œé‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œå†æ¬¡è®¿é—®/indexä¾¿å¯ä»¥æˆåŠŸèŽ·å–åˆ°ä¿¡æ¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283&#123; "authorities": [ &#123; "authority": "admin" &#125; ], "details": &#123; "remoteAddress": "0:0:0:0:0:0:0:1", "sessionId": null, "tokenValue": "621f59ba-3161-4c9b-aff8-a8335ce6e3cc", "tokenType": "bearer", "decodedDetails": null &#125;, "authenticated": true, "userAuthentication": &#123; "authorities": [ &#123; "authority": "admin" &#125; ], "details": &#123; "grant_type": "password", "username": "mrbird", "scope": "all" &#125;, "authenticated": true, "principal": &#123; "password": null, "username": "mrbird", "authorities": [ &#123; "authority": "admin" &#125; ], "accountNonExpired": true, "accountNonLocked": true, "credentialsNonExpired": true, "enabled": true &#125;, "credentials": null, "name": "mrbird" &#125;, "credentials": "", "oauth2Request": &#123; "clientId": "test", "scope": [ "all" ], "requestParameters": &#123; "grant_type": "password", "username": "mrbird", "scope": "all" &#125;, "resourceIds": [], "authorities": [ &#123; "authority": "ROLE_USER" &#125; ], "approved": true, "refresh": false, "redirectUri": null, "responseTypes": [], "extensions": &#123;&#125;, "refreshTokenRequest": null, "grantType": "password" &#125;, "clientOnly": false, "principal": &#123; "password": null, "username": "mrbird", "authorities": [ &#123; "authority": "admin" &#125; ], "accountNonExpired": true, "accountNonLocked": true, "credentialsNonExpired": true, "enabled": true &#125;, "name": "mrbird"&#125;åœ¨åŒæ—¶å®šä¹‰äº†è®¤è¯æœåŠ¡å™¨å’Œèµ„æºæœåŠ¡å™¨åŽï¼Œå†åŽ»ä½¿ç”¨æŽˆæƒç æ¨¡å¼èŽ·å–ä»¤ç‰Œå¯èƒ½ä¼šé‡åˆ° Full authentication is required to access this resource çš„é—®é¢˜ï¼Œè¿™æ—¶å€™åªè¦ç¡®ä¿è®¤è¯æœåŠ¡å™¨å…ˆäºŽèµ„æºæœåŠ¡å™¨é…ç½®å³å¯ï¼Œæ¯”å¦‚åœ¨è®¤è¯æœåŠ¡å™¨çš„é…ç½®ç±»ä¸Šä½¿ç”¨@Order(1)æ ‡æ³¨ï¼Œåœ¨èµ„æºæœåŠ¡å™¨çš„é…ç½®ç±»ä¸Šä½¿ç”¨@Order(2)æ ‡æ³¨ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/63.Spring-Security-OAuth2-Guideå‚è€ƒé“¾æŽ¥https://tools.ietf.org/html/rfc6749#section-4.1http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Cloud</tag>
        <tag>Spring Security</tag>
        <tag>OAuth2</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Securityæƒé™æŽ§åˆ¶]]></title>
    <url>%2FSpring-Security-Permission.html</url>
    <content type="text"><![CDATA[Spring Securityæƒé™æŽ§åˆ¶å¯ä»¥é…åˆæŽˆæƒæ³¨è§£ä½¿ç”¨ï¼Œå…·ä½“æœ‰å“ªäº›æ³¨è§£å¯ä»¥å‚è€ƒSpring-Securityä¿æŠ¤æ–¹æ³•ã€‚æŽ¥ç€ä¸Šä¸€èŠ‚ï¼Œè¦å¼€å¯è¿™äº›æ³¨è§£ï¼Œåªéœ€è¦åœ¨Spring Securityé…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹æ³¨è§£ï¼š12345@Configuration@EnableGlobalMethodSecurity(prePostEnabled = true)public class BrowserSecurityConfig extends WebSecurityConfigurerAdapter &#123; ...&#125;åœ¨UserDetailServiceä¸­ï¼Œæˆ‘ä»¬ç»™å½“å‰ç™»å½•ç”¨æˆ·æŽˆäºˆäº†â€adminâ€çš„æƒé™ï¼Œæˆ‘ä»¬å°†è¿™å—ä»£ç æ”¹é€ ä¸€ä¸‹ï¼šå½“ç™»å½•ç”¨æˆ·ä¸ºmrbirdçš„æ—¶å€™ï¼Œå…¶æ‹¥æœ‰â€adminâ€æƒé™ï¼Œå…¶ä»–ç”¨æˆ·åˆ™åªæœ‰â€testâ€æƒé™ï¼š12345678910111213141516171819202122232425@Configurationpublic class UserDetailService implements UserDetailsService &#123; @Autowired private PasswordEncoder passwordEncoder; @Override public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException &#123; // æ¨¡æ‹Ÿä¸€ä¸ªç”¨æˆ·ï¼Œæ›¿ä»£æ•°æ®åº“èŽ·å–é€»è¾‘ MyUser user = new MyUser(); user.setUserName(username); user.setPassword(this.passwordEncoder.encode("123456")); // è¾“å‡ºåŠ å¯†åŽçš„å¯†ç  System.out.println(user.getPassword()); List&lt;GrantedAuthority&gt; authorities = new ArrayList&lt;&gt;(); if (StringUtils.equalsIgnoreCase("mrbird", username)) &#123; authorities = AuthorityUtils.commaSeparatedStringToAuthorityList("admin"); &#125; else &#123; authorities = AuthorityUtils.commaSeparatedStringToAuthorityList("test"); &#125; return new User(username, user.getPassword(), user.isEnabled(), user.isAccountNonExpired(), user.isCredentialsNonExpired(), user.isAccountNonLocked(), authorities); &#125;&#125;æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”ä½¿ç”¨æƒé™æ³¨è§£æ ‡æ˜Žåªæœ‰æ‹¥æœ‰â€œadminâ€æƒé™çš„äººæ‰èƒ½è®¿é—®ï¼š12345@GetMapping("/auth/admin")@PreAuthorize("hasAuthority('admin')")public String authenticationTest() &#123; return "æ‚¨æ‹¥æœ‰adminæƒé™ï¼Œå¯ä»¥æŸ¥çœ‹";&#125;å¯åŠ¨ç³»ç»Ÿï¼Œä½¿ç”¨mrbirdè´¦å·ç™»å½•ï¼šå¯çœ‹åˆ°ï¼Œmrbirdå¯ä»¥è®¿é—®è¯¥èµ„æºã€‚ä½¿ç”¨scottè´¦å·ç™»å½•ï¼šå¯ä»¥çœ‹åˆ°ï¼Œsocttæ²¡æœ‰æƒé™è®¿é—®ï¼Œè¿”å›ž403é”™è¯¯ç ã€‚æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æƒé™ä¸è¶³å¤„ç†å™¨æ¥å¤„ç†æƒé™ä¸è¶³æ—¶å€™çš„æ“ä½œã€‚æ–°å¢žä¸€ä¸ªå¤„ç†å™¨MyAuthenticationAccessDeniedHandlerï¼Œå®žçŽ°AccessDeniedHandleræŽ¥å£ï¼š12345678910@Componentpublic class MyAuthenticationAccessDeniedHandler implements AccessDeniedHandler &#123; @Override public void handle(HttpServletRequest request, HttpServletResponse response, AccessDeniedException accessDeniedException) throws IOException &#123; response.setStatus(HttpStatus.INTERNAL_SERVER_ERROR.value()); response.setContentType("application/json;charset=utf-8"); response.getWriter().write("å¾ˆæŠ±æ­‰ï¼Œæ‚¨æ²¡æœ‰è¯¥è®¿é—®æƒé™"); &#125;&#125;ç„¶åŽå°†è¿™ä¸ªå¤„ç†å™¨æ·»åŠ åˆ°Spring Securityé…ç½®é“¾ä¸­: @Autowired private MyAuthenticationAccessDeniedHandler authenticationAccessDeniedHandler;1234567 @Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.exceptionHandling() .accessDeniedHandler(authenticationAccessDeniedHandler) .and() ......&#125;é‡å¯ç³»ç»Ÿï¼Œå†æ¬¡ä½¿ç”¨scottè´¦å·è®¿é—®/auth/adminï¼š æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/61.Spring-security-Permission]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Securityé€€å‡ºç™»å½•]]></title>
    <url>%2FSpring-Security-logout.html</url>
    <content type="text"><![CDATA[Spring Securityé»˜è®¤çš„é€€å‡ºç™»å½•URLä¸º/logoutï¼Œé€€å‡ºç™»å½•åŽï¼ŒSpring Securityä¼šåšå¦‚ä¸‹å¤„ç†ï¼šæ˜¯å½“å‰çš„Sesionå¤±æ•ˆï¼›æ¸…é™¤ä¸Žå½“å‰ç”¨æˆ·å…³è”çš„RememberMeè®°å½•ï¼›æ¸…ç©ºå½“å‰çš„SecurityContextï¼›é‡å®šå‘åˆ°ç™»å½•é¡µã€‚Spring Securityå…è®¸æˆ‘ä»¬é€šè¿‡é…ç½®æ¥æ›´æ”¹ä¸Šé¢è¿™äº›é»˜è®¤è¡Œä¸ºã€‚è‡ªå®šä¹‰é€€å‡ºç™»å½•è¡Œä¸ºæˆ‘ä»¬åœ¨Spring Securityé…ç½®ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®:12345678.......and() .logout() .logoutUrl("/signout") .logoutSuccessUrl("/signout/success") .deleteCookies("JSESSIONID").and()......ä¸Šé¢é…ç½®äº†é€€å‡ºç™»å½•çš„URLä¸º/signoutï¼Œé€€å‡ºæˆåŠŸåŽè·³è½¬çš„URLä¸º/signout/successï¼Œé€€å‡ºæˆåŠŸåŽåˆ é™¤åç§°ä¸ºJSESSIONIDçš„cookieã€‚åœ¨Controllerä¸­æ·»åŠ å’Œ/signout/successå¯¹åº”çš„æ–¹æ³•ï¼š1234@GetMapping("/signout/success")public String signout() &#123; return "é€€å‡ºæˆåŠŸï¼Œè¯·é‡æ–°ç™»å½•";&#125;æŽ¥ç€å°†/signout/successæ·»åŠ åˆ°å…è®¤è¯è·¯å¾„é‡Œã€‚å¯åŠ¨é¡¹ç›®ï¼Œç™»å½•åŽè®¿é—®/signoutï¼šå¯çœ‹åˆ°é€€å‡ºæˆåŠŸï¼Œå¹¶ä¸”è¯·æ±‚é‡å®šå‘åˆ°äº†/signout/successã€‚é™¤äº†æŒ‡å®šlogoutUrlå¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡logoutSuccessHandleræŒ‡å®šé€€å‡ºæˆåŠŸå¤„ç†å™¨æ¥å¤„ç†é€€å‡ºæˆåŠŸåŽçš„é€»è¾‘ï¼š123456789101112@Autowiredprivate MyLogOutSuccessHandler logOutSuccessHandler;.......and() .logout() .logoutUrl("/signout") // .logoutSuccessUrl("/signout/success") .logoutSuccessHandler(logOutSuccessHandler) .deleteCookies("JSESSIONID").and()......MyLogOutSuccessHandlerå®žçŽ°LogoutSuccessHandlerï¼š123456789@Componentpublic class MyLogOutSuccessHandler implements LogoutSuccessHandler &#123; @Override public void onLogoutSuccess(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Authentication authentication) throws IOException, ServletException &#123; httpServletResponse.setStatus(HttpStatus.UNAUTHORIZED.value()); httpServletResponse.setContentType("application/json;charset=utf-8"); httpServletResponse.getWriter().write("é€€å‡ºæˆåŠŸï¼Œè¯·é‡æ–°ç™»å½•"); &#125;&#125;æ•ˆæžœå’Œä¸Šé¢ä¸€æ ·ï¼š æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/60.Spring-Security-Logout]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Security Sessionç®¡ç†]]></title>
    <url>%2FSpring-Security-Session-Manage.html</url>
    <content type="text"><![CDATA[ç”¨æˆ·ç™»å½•æˆåŠŸåŽï¼Œä¿¡æ¯ä¿å­˜åœ¨æœåŠ¡å™¨Sessionä¸­ï¼Œè¿™èŠ‚å­¦ä¹ ä¸‹å¦‚ä½•ç®¡ç†è¿™äº›Sessionã€‚è¿™èŠ‚å°†åœ¨Spring SecurityçŸ­ä¿¡éªŒè¯ç ç™»å½•çš„åŸºç¡€ä¸Šç»§ç»­æ‰©å±•ã€‚Sessionè¶…æ—¶è®¾ç½®Sessionè¶…æ—¶æ—¶é—´ä¹Ÿå°±æ˜¯ç”¨æˆ·ç™»å½•çš„æœ‰æ•ˆæ—¶é—´ã€‚è¦è®¾ç½®Sessionè¶…æ—¶æ—¶é—´å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š123server: session: timeout: 3600å•ä½ä¸ºç§’ï¼Œé€šè¿‡ä¸Šé¢çš„é…ç½®ï¼ŒSessionçš„æœ‰æ•ˆæœŸä¸ºä¸€ä¸ªå°æ—¶ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒSessionçš„æœ€å°æœ‰æ•ˆæœŸä¸º60ç§’ï¼Œä¹Ÿå°±æ˜¯è¯´å³ä½¿ä½ è®¾ç½®ä¸ºå°äºŽ60ç§’çš„å€¼ï¼Œå…¶æœ‰æ•ˆæœŸè¿˜æ˜¯ä¸º60ç§’ã€‚æŸ¥çœ‹TomcatEmbeddedServletContainerFactoryçš„æºç å³å¯å‘çŽ°åŽŸå› ï¼šSessionå¤±æ•ˆåŽï¼Œåˆ·æ–°é¡µé¢åŽå°†è·³è½¬åˆ°è®¤è¯é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥å†æ·»åŠ ä¸€äº›é…ç½®ï¼Œè‡ªå®šä¹‰Sessionå¤±æ•ˆåŽçš„ä¸€äº›è¡Œä¸ºã€‚åœ¨Spring Securityä¸­é…ç½®Sessionç®¡ç†å™¨ï¼Œå¹¶é…ç½®Sessionå¤±æ•ˆåŽè¦è·³è½¬çš„URLï¼š1234567891011121314151617181920@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.addFilterBefore(validateCodeFilter, UsernamePasswordAuthenticationFilter.class) // æ·»åŠ éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨ .addFilterBefore(smsCodeFilter,UsernamePasswordAuthenticationFilter.class) // æ·»åŠ çŸ­ä¿¡éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨ .formLogin() // è¡¨å•ç™»å½• .loginPage("/authentication/require") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .successHandler(authenticationSucessHandler) // å¤„ç†ç™»å½•æˆåŠŸ .failureHandler(authenticationFailureHandler) // å¤„ç†ç™»å½•å¤±è´¥ .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/authentication/require", "/login.html", "/code/image","/code/sms","/session/invalid").permitAll() // æ— éœ€è®¤è¯çš„è¯·æ±‚è·¯å¾„ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and() .sessionManagement() // æ·»åŠ  Sessionç®¡ç†å™¨ .invalidSessionUrl("/session/invalid") // Sessionå¤±æ•ˆåŽè·³è½¬åˆ°è¿™ä¸ªé“¾æŽ¥ ......&#125;ä¸Šé¢é…ç½®äº†Sessionå¤±æ•ˆåŽè·³è½¬åˆ°/session/invalidï¼Œå¹¶ä¸”å°†è¿™ä¸ªURLæ·»åŠ åˆ°äº†å…è®¤è¯è·¯å¾„ä¸­ã€‚åœ¨Controlleré‡Œæ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œæ˜ å°„è¯¥è¯·æ±‚ï¼š12345@GetMapping("session/invalid")@ResponseStatus(HttpStatus.UNAUTHORIZED)public String sessionInvalid()&#123; return "sessionå·²å¤±æ•ˆï¼Œè¯·é‡æ–°è®¤è¯";&#125;ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬å°†Sessionçš„è¶…æ—¶æ—¶é—´è®¾ç½®ä¸ºæœ€å°å€¼60ç§’ï¼Œé‡å¯é¡¹ç›®ï¼Œè®¤è¯åŽç­‰å¾…60ç§’å¹¶åˆ·æ–°é¡µé¢ï¼šå¯çœ‹åˆ°è¯·æ±‚è·³è½¬åˆ°äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„/session/invalidURLä¸Šã€‚Sessionå¹¶å‘æŽ§åˆ¶Sessionå¹¶å‘æŽ§åˆ¶å¯ä»¥æŽ§åˆ¶ä¸€ä¸ªè´¦å·åŒä¸€æ—¶åˆ»æœ€å¤šèƒ½ç™»å½•å¤šå°‘ä¸ªã€‚æˆ‘ä»¬åœ¨Spring Securityé…ç½®ä¸­ç»§ç»­æ·»åŠ Sessionç›¸å…³é…ç½®:12345678910111213141516171819202122232425@Autowiredprivate MySessionExpiredStrategy sessionExpiredStrategy;@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.addFilterBefore(validateCodeFilter, UsernamePasswordAuthenticationFilter.class) // æ·»åŠ éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨ .addFilterBefore(smsCodeFilter,UsernamePasswordAuthenticationFilter.class) // æ·»åŠ çŸ­ä¿¡éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨ .formLogin() // è¡¨å•ç™»å½• .loginPage("/authentication/require") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .successHandler(authenticationSucessHandler) // å¤„ç†ç™»å½•æˆåŠŸ .failureHandler(authenticationFailureHandler) // å¤„ç†ç™»å½•å¤±è´¥ .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/authentication/require", "/login.html", "/code/image","/code/sms","/session/invalid").permitAll() // æ— éœ€è®¤è¯çš„è¯·æ±‚è·¯å¾„ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and() .sessionManagement() // æ·»åŠ  Sessionç®¡ç†å™¨ .invalidSessionUrl("/session/invalid") // Sessionå¤±æ•ˆåŽè·³è½¬åˆ°è¿™ä¸ªé“¾æŽ¥ .maximumSessions(1) .expiredSessionStrategy(sessionExpiredStrategy) .and() ......maximumSessionsé…ç½®äº†æœ€å¤§Sessionå¹¶å‘æ•°é‡ä¸º1ä¸ªï¼Œå¦‚æžœmrbirdè¿™ä¸ªè´¦æˆ·ç™»å½•åŽï¼Œåœ¨å¦ä¸€ä¸ªå®¢æˆ·ç«¯ä¹Ÿä½¿ç”¨mrbirdè´¦æˆ·ç™»å½•ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªä½¿ç”¨mrbirdç™»å½•çš„è´¦æˆ·å°†ä¼šå¤±æ•ˆï¼Œç±»ä¼¼äºŽä¸€ä¸ªå…ˆå…¥å…ˆå‡ºé˜Ÿåˆ—ã€‚expiredSessionStrategyé…ç½®äº†Sessionåœ¨å¹¶å‘ä¸‹å¤±æ•ˆåŽçš„å¤„ç†ç­–ç•¥ï¼Œè¿™é‡Œä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„ç­–ç•¥MySessionExpiredStrategyã€‚MySessionExpiredStrategyå®žçŽ°SessionInformationExpiredStrategyï¼š1234567891011@Componentpublic class MySessionExpiredStrategy implements SessionInformationExpiredStrategy &#123; @Override public void onExpiredSessionDetected(SessionInformationExpiredEvent event) throws IOException, ServletException &#123; HttpServletResponse response = event.getResponse(); response.setStatus(HttpStatus.UNAUTHORIZED.value()); response.setContentType("application/json;charset=utf-8"); response.getWriter().write("æ‚¨çš„è´¦å·å·²ç»åœ¨åˆ«çš„åœ°æ–¹ç™»å½•ï¼Œå½“å‰ç™»å½•å·²å¤±æ•ˆã€‚å¦‚æžœå¯†ç é­åˆ°æ³„éœ²ï¼Œè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼"); &#125;&#125;ä¸ºäº†æ¼”ç¤ºè¿™ä¸ªæ•ˆæžœï¼Œæˆ‘ä»¬å…ˆå°†Sessionè¶…æ—¶æ—¶é—´è®¾ç½®ä¹…ä¸€ç‚¹ï¼Œæ¯”å¦‚3600ç§’ï¼Œç„¶åŽé‡å¯é¡¹ç›®ï¼Œåœ¨Chromeé‡Œä½¿ç”¨mrbirdè´¦æˆ·ç™»å½•ã€‚ç™»å½•æˆåŠŸåŽï¼Œåœ¨firefoxä¸Šä¹Ÿæ˜¯ç”¨mrbirdè´¦æˆ·ç™»å½•ï¼Œç™»å½•æˆåŠŸåŽå›žåˆ°chromeï¼Œåˆ·æ–°é¡µé¢ï¼Œæ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼šé™¤äº†åŽè€…å°†å‰è€…è¸¢å‡ºçš„ç­–ç•¥ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŽ§åˆ¶å½“Sessionè¾¾åˆ°æœ€å¤§æœ‰æ•ˆæ•°çš„æ—¶å€™ï¼Œä¸å†å…è®¸ç›¸åŒçš„è´¦æˆ·ç™»å½•ã€‚è¦å®žçŽ°è¿™ä¸ªåŠŸèƒ½åªéœ€è¦åœ¨ä¸Šé¢çš„é…ç½®ä¸­æ·»åŠ ï¼š123456789.......and() .sessionManagement() // æ·»åŠ  Sessionç®¡ç†å™¨ .invalidSessionUrl("/session/invalid") // Sessionå¤±æ•ˆåŽè·³è½¬åˆ°è¿™ä¸ªé“¾æŽ¥ .maximumSessions(1) .maxSessionsPreventsLogin(true) .expiredSessionStrategy(sessionExpiredStrategy) .and()......é‡å¯ç³»ç»Ÿï¼Œåœ¨chromeä¸Šç™»å½•mrbirdè´¦æˆ·åŽï¼Œåœ¨firefoxä¸Šå°è¯•ä½¿ç”¨mrbirdè´¦æˆ·ç™»å½•ï¼šå¯ä»¥çœ‹åˆ°ç™»å½•å—é™ã€‚åœ¨å®žé™…å¼€å‘ä¸­ï¼Œå‘çŽ°Sessionå¹¶å‘æŽ§åˆ¶åªå¯¹Spring Securityé»˜è®¤çš„ç™»å½•æ–¹å¼â€”â€”è´¦å·å¯†ç ç™»å½•æœ‰æ•ˆï¼Œè€ŒåƒçŸ­ä¿¡éªŒè¯ç ç™»å½•ï¼Œç¤¾äº¤è´¦å·ç™»å½•å¹¶ä¸ç”Ÿæ•ˆï¼Œè§£å†³æ–¹æ¡ˆå¯ä»¥å‚è€ƒæˆ‘çš„å¼€æºé¡¹ç›®https://github.com/wuyouzhuguli/FEBS-SecuritySessioné›†ç¾¤å¤„ç†Sessioné›†ç¾¤å¬ç€é«˜å¤§ä¸Šï¼Œå…¶å®žå®žçŽ°èµ·æ¥å¾ˆç®€å•ã€‚å½“æˆ‘ä»¬ç™»å½•æˆåŠŸåŽï¼Œç”¨æˆ·è®¤è¯çš„ä¿¡æ¯å­˜å‚¨åœ¨Sessionä¸­ï¼Œè€Œè¿™äº›Sessioné»˜è®¤æ˜¯å­˜å‚¨åœ¨è¿è¡Œè¿ç”¨çš„æœåŠ¡å™¨ä¸Šçš„ï¼Œæ¯”å¦‚Tomcatï¼Œnettyç­‰ã€‚å½“åº”ç”¨é›†ç¾¤éƒ¨ç½²çš„æ—¶å€™ï¼Œç”¨æˆ·åœ¨Aåº”ç”¨ä¸Šç™»å½•è®¤è¯äº†ï¼ŒåŽç»­é€šè¿‡è´Ÿè½½å‡è¡¡å¯èƒ½ä¼šæŠŠè¯·æ±‚å‘é€åˆ°Båº”ç”¨ï¼Œè€ŒBåº”ç”¨æœåŠ¡å™¨ä¸Šå¹¶æ²¡æœ‰ä¸Žè¯¥è¯·æ±‚åŒ¹é…çš„è®¤è¯Sessionä¿¡æ¯ï¼Œæ‰€ä»¥ç”¨æˆ·å°±éœ€è¦é‡æ–°è¿›è¡Œè®¤è¯ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠSessionä¿¡æ¯å­˜å‚¨åœ¨ç¬¬ä¸‰æ–¹å®¹å™¨é‡Œï¼ˆå¦‚Redisé›†ç¾¤ï¼‰ï¼Œè€Œä¸æ˜¯å„è‡ªçš„æœåŠ¡å™¨ï¼Œè¿™æ ·åº”ç”¨é›†ç¾¤å°±å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹å®¹å™¨æ¥å…±äº«Sessionäº†ã€‚æˆ‘ä»¬å¼•å…¥Rediså’ŒSpring Sessionä¾èµ–ï¼š12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.session&lt;/groupId&gt; &lt;artifactId&gt;spring-session&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåœ¨ymlä¸­é…ç½®Sessionå­˜å‚¨æ–¹å¼ä¸ºRedisï¼š123spring: session: store-type: redisä¸ºäº†æ–¹ä¾¿ï¼ŒRedisé…ç½®é‡‡ç”¨é»˜è®¤é…ç½®å³å¯ã€‚å¼€å¯Redisï¼Œå¹¶ä¸”å¯åŠ¨ä¸¤ä¸ªåº”ç”¨å®žä¾‹ï¼Œä¸€ä¸ªç«¯å£ä¸º8080ï¼Œå¦ä¸€ä¸ªç«¯å£ä¸º9090ã€‚æˆ‘ä»¬çŽ°åœ¨8080ç«¯å£åº”ç”¨ä¸Šç™»å½•ï¼šç„¶åŽè®¿é—®9090ç«¯å£åº”ç”¨çš„ä¸»é¡µï¼šå¯ä»¥çœ‹åˆ°ç™»å½•ä¹Ÿæ˜¯ç”Ÿæ•ˆçš„ã€‚è¿™å°±å®žçŽ°äº†é›†ç¾¤åŒ–Sessionç®¡ç†ã€‚å…¶ä»–æ“ä½œSessionRegistryåŒ…å«äº†ä¸€äº›ä½¿ç”¨çš„æ“ä½œSessionçš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼šè¸¢å‡ºç”¨æˆ·ï¼ˆè®©Sessionå¤±æ•ˆï¼‰ï¼š12String currentSessionId = request.getRequestedSessionId();sessionRegistry.getSessionInformation(sessionId).expireNow();èŽ·å–æ‰€æœ‰Sessionä¿¡æ¯ï¼š1List&lt;Object&gt; principals = sessionRegistry.getAllPrincipals();æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/59.Spring-Security-SessionManager]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring SecurityçŸ­ä¿¡éªŒè¯ç ç™»å½•]]></title>
    <url>%2FSpring-Security-SmsCode.html</url>
    <content type="text"><![CDATA[åœ¨Spring Securityæ·»åŠ å›¾å½¢éªŒè¯ç ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»å®žçŽ°äº†åŸºäºŽSpring Boot + Spring Securityçš„è´¦å·å¯†ç ç™»å½•ï¼Œå¹¶é›†æˆäº†å›¾å½¢éªŒè¯ç åŠŸèƒ½ã€‚æ—¶ä¸‹å¦ä¸€ç§éžå¸¸å¸¸è§çš„ç½‘ç«™ç™»å½•æ–¹å¼ä¸ºæ‰‹æœºçŸ­ä¿¡éªŒè¯ç ç™»å½•ï¼Œä½†Spring Securityé»˜è®¤åªæä¾›äº†è´¦å·å¯†ç çš„ç™»å½•è®¤è¯é€»è¾‘ï¼Œæ‰€ä»¥è¦å®žçŽ°æ‰‹æœºçŸ­ä¿¡éªŒè¯ç ç™»å½•è®¤è¯åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡ä»¿Spring Securityè´¦å·å¯†ç ç™»å½•é€»è¾‘ä»£ç æ¥å®žçŽ°ä¸€å¥—è‡ªå·±çš„è®¤è¯é€»è¾‘ã€‚çŸ­ä¿¡éªŒè¯ç ç”Ÿæˆæˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚Spring Securityæ·»åŠ å›¾å½¢éªŒè¯ç çš„åŸºç¡€ä¸Šæ¥é›†æˆçŸ­ä¿¡éªŒè¯ç ç™»å½•çš„åŠŸèƒ½ã€‚å’Œå›¾å½¢éªŒè¯ç ç±»ä¼¼ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªçŸ­ä¿¡éªŒè¯ç å¯¹è±¡SmsCodeï¼š12345678910111213141516171819public class SmsCode &#123; private String code; private LocalDateTime expireTime; public SmsCode(String code, int expireIn) &#123; this.code = code; this.expireTime = LocalDateTime.now().plusSeconds(expireIn); &#125; public SmsCode(String code, LocalDateTime expireTime) &#123; this.code = code; this.expireTime = expireTime; &#125; boolean isExpire() &#123; return LocalDateTime.now().isAfter(expireTime); &#125; // get,setç•¥&#125;SmsCodeå¯¹è±¡åŒ…å«äº†ä¸¤ä¸ªå±žæ€§ï¼šcodeéªŒè¯ç å’ŒexpireTimeè¿‡æœŸæ—¶é—´ã€‚isExpireæ–¹æ³•ç”¨äºŽåˆ¤æ–­çŸ­ä¿¡éªŒè¯ç æ˜¯å¦å·²è¿‡æœŸã€‚æŽ¥ç€åœ¨ValidateCodeControllerä¸­åŠ å…¥ç”ŸæˆçŸ­ä¿¡éªŒè¯ç ç›¸å…³è¯·æ±‚å¯¹åº”çš„æ–¹æ³•ï¼š1234567891011121314151617181920@RestControllerpublic class ValidateController &#123; public final static String SESSION_KEY_SMS_CODE = "SESSION_KEY_SMS_CODE"; private SessionStrategy sessionStrategy = new HttpSessionSessionStrategy(); @GetMapping("/code/sms") public void createSmsCode(HttpServletRequest request, HttpServletResponse response, String mobile) throws IOException &#123; SmsCode smsCode = createSMSCode(); sessionStrategy.setAttribute(new ServletWebRequest(request), SESSION_KEY_SMS_CODE + mobile, smsCode); // è¾“å‡ºéªŒè¯ç åˆ°æŽ§åˆ¶å°ä»£æ›¿çŸ­ä¿¡å‘é€æœåŠ¡ System.out.println("æ‚¨çš„ç™»å½•éªŒè¯ç ä¸ºï¼š" + smsCode.getCode() + "ï¼Œæœ‰æ•ˆæ—¶é—´ä¸º60ç§’"); &#125; private SmsCode createSMSCode() &#123; String code = RandomStringUtils.randomNumeric(6); return new SmsCode(code, 60); &#125;&#125;è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨createSMSCodeæ–¹æ³•ç”Ÿæˆäº†ä¸€ä¸ª6ä½çš„çº¯æ•°å­—éšæœºæ•°ï¼Œæœ‰æ•ˆæ—¶é—´ä¸º60ç§’ã€‚ç„¶åŽé€šè¿‡SessionStrategyå¯¹è±¡çš„setAttributeæ–¹æ³•å°†çŸ­ä¿¡éªŒè¯ç ä¿å­˜åˆ°äº†Sessionä¸­ï¼Œå¯¹åº”çš„keyä¸ºSESSION_KEY_SMS_CODEã€‚è‡³æ­¤ï¼ŒçŸ­ä¿¡éªŒè¯ç ç”Ÿæˆæ¨¡å—ç¼–å†™å®Œæ¯•ï¼Œä¸‹é¢å¼€å§‹æ”¹é€ ç™»å½•é¡µé¢ã€‚æ”¹é€ ç™»å½•é¡µæˆ‘ä»¬åœ¨ç™»å½•é¡µé¢ä¸­åŠ å…¥ä¸€ä¸ªä¸Žæ‰‹æœºçŸ­ä¿¡éªŒè¯ç è®¤è¯ç›¸å…³çš„Formè¡¨å•ï¼š1234567891011&lt;form class="login-page" action="/login/mobile" method="post"&gt; &lt;div class="form"&gt; &lt;h3&gt;çŸ­ä¿¡éªŒè¯ç ç™»å½•&lt;/h3&gt; &lt;input type="text" placeholder="æ‰‹æœºå·" name="mobile" value="17777777777" required="required"/&gt; &lt;span style="display: inline"&gt; &lt;input type="text" name="smsCode" placeholder="çŸ­ä¿¡éªŒè¯ç " style="width: 50%;"/&gt; &lt;a href="/code/sms?mobile=17777777777"&gt;å‘é€éªŒè¯ç &lt;/a&gt; &lt;/span&gt; &lt;button type="submit"&gt;ç™»å½•&lt;/button&gt; &lt;/div&gt;&lt;/form&gt;å…¶ä¸­aæ ‡ç­¾çš„hrefå±žæ€§å€¼å¯¹åº”æˆ‘ä»¬çš„çŸ­ä¿¡éªŒè¯ç ç”Ÿæˆæ–¹æ³•çš„è¯·æ±‚URLã€‚Formçš„actionå¯¹åº”å¤„ç†çŸ­ä¿¡éªŒè¯ç ç™»å½•æ–¹æ³•çš„è¯·æ±‚URLï¼Œè¿™ä¸ªæ–¹æ³•ä¸‹é¢åœ¨è¿›è¡Œå…·ä½“å®žçŽ°ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨Spring Securityä¸­é…ç½®/code/smsè·¯å¾„å…éªŒè¯ï¼š12345678910111213141516171819@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.addFilterBefore(validateCodeFilter, UsernamePasswordAuthenticationFilter.class) // æ·»åŠ éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨ .formLogin() // è¡¨å•ç™»å½• // http.httpBasic() // HTTP Basic .loginPage("/authentication/require") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .successHandler(authenticationSucessHandler) // å¤„ç†ç™»å½•æˆåŠŸ .failureHandler(authenticationFailureHandler) // å¤„ç†ç™»å½•å¤±è´¥ .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/authentication/require", "/login.html", "/code/image","/code/sms").permitAll() // æ— éœ€è®¤è¯çš„è¯·æ±‚è·¯å¾„ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and() .csrf().disable();&#125;é‡å¯é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/login.htmlï¼šç‚¹å‡»å‘é€éªŒè¯ç ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š1æ‚¨çš„ç™»å½•éªŒè¯ç ä¸ºï¼š693583ï¼Œæœ‰æ•ˆæ—¶é—´ä¸º60ç§’æŽ¥ä¸‹æ¥å¼€å§‹å®žçŽ°ä½¿ç”¨çŸ­ä¿¡éªŒè¯ç ç™»å½•è®¤è¯é€»è¾‘ã€‚æ·»åŠ çŸ­ä¿¡éªŒè¯ç è®¤è¯åœ¨Spring Securityä¸­ï¼Œä½¿ç”¨ç”¨æˆ·åå¯†ç è®¤è¯çš„è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šSpring Securityä½¿ç”¨UsernamePasswordAuthenticationFilterè¿‡æ»¤å™¨æ¥æ‹¦æˆªç”¨æˆ·åå¯†ç è®¤è¯è¯·æ±‚ï¼Œå°†ç”¨æˆ·åå’Œå¯†ç å°è£…æˆä¸€ä¸ªUsernamePasswordTokenå¯¹è±¡äº¤ç»™AuthenticationManagerå¤„ç†ã€‚AuthenticationManagerå°†æŒ‘å‡ºä¸€ä¸ªæ”¯æŒå¤„ç†è¯¥ç±»åž‹Tokençš„AuthenticationProviderï¼ˆè¿™é‡Œä¸ºDaoAuthenticationProviderï¼ŒAuthenticationProviderçš„å…¶ä¸­ä¸€ä¸ªå®žçŽ°ç±»ï¼‰æ¥è¿›è¡Œè®¤è¯ï¼Œè®¤è¯è¿‡ç¨‹ä¸­DaoAuthenticationProviderå°†è°ƒç”¨UserDetailServiceçš„loadUserByUsernameæ–¹æ³•æ¥å¤„ç†è®¤è¯ï¼Œå¦‚æžœè®¤è¯é€šè¿‡ï¼ˆå³UsernamePasswordTokenä¸­çš„ç”¨æˆ·åå’Œå¯†ç ç›¸ç¬¦ï¼‰åˆ™è¿”å›žä¸€ä¸ªUserDetailsç±»åž‹å¯¹è±¡ï¼Œå¹¶å°†è®¤è¯ä¿¡æ¯ä¿å­˜åˆ°Sessionä¸­ï¼Œè®¤è¯åŽæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡Authenticationå¯¹è±¡èŽ·å–åˆ°è®¤è¯çš„ä¿¡æ¯äº†ã€‚ç”±äºŽSpring Securityå¹¶æ²¡ç”¨æä¾›çŸ­ä¿¡éªŒè¯ç è®¤è¯çš„æµç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä»¿ç…§ä¸Šé¢è¿™ä¸ªæµç¨‹æ¥å®žçŽ°ï¼šåœ¨è¿™ä¸ªæµç¨‹ä¸­ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€ä¸ªåä¸ºSmsAuthenticationFitlerçš„è¿‡æ»¤å™¨æ¥æ‹¦æˆªçŸ­ä¿¡éªŒè¯ç ç™»å½•è¯·æ±‚ï¼Œå¹¶å°†æ‰‹æœºå·ç å°è£…åˆ°ä¸€ä¸ªå«SmsAuthenticationTokençš„å¯¹è±¡ä¸­ã€‚åœ¨Spring Securityä¸­ï¼Œè®¤è¯å¤„ç†éƒ½éœ€è¦é€šè¿‡AuthenticationManageræ¥ä»£ç†ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä¾æ—§å°†SmsAuthenticationTokenäº¤ç”±AuthenticationManagerå¤„ç†ã€‚æŽ¥ç€æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªæ”¯æŒå¤„ç†SmsAuthenticationTokenå¯¹è±¡çš„SmsAuthenticationProviderï¼ŒSmsAuthenticationProviderè°ƒç”¨UserDetailServiceçš„loadUserByUsernameæ–¹æ³•æ¥å¤„ç†è®¤è¯ã€‚ä¸Žç”¨æˆ·åå¯†ç è®¤è¯ä¸ä¸€æ ·çš„æ˜¯ï¼Œè¿™é‡Œæ˜¯é€šè¿‡SmsAuthenticationTokenä¸­çš„æ‰‹æœºå·åŽ»æ•°æ®åº“ä¸­æŸ¥è¯¢æ˜¯å¦æœ‰ä¸Žä¹‹å¯¹åº”çš„ç”¨æˆ·ï¼Œå¦‚æžœæœ‰ï¼Œåˆ™å°†è¯¥ç”¨æˆ·ä¿¡æ¯å°è£…åˆ°UserDetailså¯¹è±¡ä¸­è¿”å›žå¹¶å°†è®¤è¯åŽçš„ä¿¡æ¯ä¿å­˜åˆ°Authenticationå¯¹è±¡ä¸­ã€‚ä¸ºäº†å®žçŽ°è¿™ä¸ªæµç¨‹ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰SmsAuthenticationFitlerã€SmsAuthenticationTokenå’ŒSmsAuthenticationProviderï¼Œå¹¶å°†è¿™äº›ç»„å»ºç»„åˆèµ·æ¥æ·»åŠ åˆ°Spring Securityä¸­ã€‚ä¸‹é¢æˆ‘ä»¬æ¥é€æ­¥å®žçŽ°è¿™ä¸ªè¿‡ç¨‹ã€‚å®šä¹‰SmsAuthenticationTokenæŸ¥çœ‹UsernamePasswordAuthenticationTokençš„æºç ï¼Œå°†å…¶å¤åˆ¶å‡ºæ¥é‡å‘½åä¸ºSmsAuthenticationTokenï¼Œå¹¶ç¨ä½œä¿®æ”¹ï¼Œä¿®æ”¹åŽçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940public class SmsAuthenticationToken extends AbstractAuthenticationToken &#123; private static final long serialVersionUID = SpringSecurityCoreVersion.SERIAL_VERSION_UID; private final Object principal; public SmsAuthenticationToken(String mobile) &#123; super(null); this.principal = mobile; setAuthenticated(false); &#125; public SmsAuthenticationToken(Object principal, Collection&lt;? extends GrantedAuthority&gt; authorities) &#123; super(authorities); this.principal = principal; super.setAuthenticated(true); // must use super, as we override &#125; @Override public Object getCredentials() &#123; return null; &#125; public Object getPrincipal() &#123; return this.principal; &#125; public void setAuthenticated(boolean isAuthenticated) throws IllegalArgumentException &#123; if (isAuthenticated) &#123; throw new IllegalArgumentException( "Cannot set this token to trusted - use constructor which takes a GrantedAuthority list instead"); &#125; super.setAuthenticated(false); &#125; @Override public void eraseCredentials() &#123; super.eraseCredentials(); &#125;&#125;SmsAuthenticationTokenåŒ…å«ä¸€ä¸ªprincipalå±žæ€§ï¼Œä»Žå®ƒçš„ä¸¤ä¸ªæž„é€ å‡½æ•°å¯ä»¥çœ‹å‡ºï¼Œåœ¨è®¤è¯ä¹‹å‰principalå­˜çš„æ˜¯æ‰‹æœºå·ï¼Œè®¤è¯ä¹‹åŽå­˜çš„æ˜¯ç”¨æˆ·ä¿¡æ¯ã€‚UsernamePasswordAuthenticationTokenåŽŸæ¥è¿˜åŒ…å«ä¸€ä¸ªcredentialså±žæ€§ç”¨äºŽå­˜æ”¾å¯†ç ï¼Œè¿™é‡Œä¸éœ€è¦å°±åŽ»æŽ‰äº†ã€‚å®šä¹‰SmsAuthenticationFilterå®šä¹‰å®ŒSmsAuthenticationTokenåŽï¼Œæˆ‘ä»¬æŽ¥ç€å®šä¹‰ç”¨äºŽå¤„ç†çŸ­ä¿¡éªŒè¯ç ç™»å½•è¯·æ±‚çš„è¿‡æ»¤å™¨SmsAuthenticationFilterï¼ŒåŒæ ·çš„å¤åˆ¶UsernamePasswordAuthenticationFilteræºç å¹¶ç¨ä½œä¿®æ”¹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556public class SmsAuthenticationFilter extends AbstractAuthenticationProcessingFilter &#123; public static final String MOBILE_KEY = "mobile"; private String mobileParameter = MOBILE_KEY; private boolean postOnly = true; public SmsAuthenticationFilter() &#123; super(new AntPathRequestMatcher("/login/mobile", "POST")); &#125; public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) throws AuthenticationException &#123; if (postOnly &amp;&amp; !request.getMethod().equals("POST")) &#123; throw new AuthenticationServiceException( "Authentication method not supported: " + request.getMethod()); &#125; String mobile = obtainMobile(request); if (mobile == null) &#123; mobile = ""; &#125; mobile = mobile.trim(); SmsAuthenticationToken authRequest = new SmsAuthenticationToken(mobile); setDetails(request, authRequest); return this.getAuthenticationManager().authenticate(authRequest); &#125; protected String obtainMobile(HttpServletRequest request) &#123; return request.getParameter(mobileParameter); &#125; protected void setDetails(HttpServletRequest request, SmsAuthenticationToken authRequest) &#123; authRequest.setDetails(authenticationDetailsSource.buildDetails(request)); &#125; public void setMobileParameter(String mobileParameter) &#123; Assert.hasText(mobileParameter, "mobile parameter must not be empty or null"); this.mobileParameter = mobileParameter; &#125; public void setPostOnly(boolean postOnly) &#123; this.postOnly = postOnly; &#125; public final String getMobileParameter() &#123; return mobileParameter; &#125;&#125;æž„é€ å‡½æ•°ä¸­æŒ‡å®šäº†å½“è¯·æ±‚ä¸º/login/mobileï¼Œè¯·æ±‚æ–¹æ³•ä¸ºPOSTçš„æ—¶å€™è¯¥è¿‡æ»¤å™¨ç”Ÿæ•ˆã€‚mobileParameterå±žæ€§å€¼ä¸ºmobileï¼Œå¯¹åº”ç™»å½•é¡µé¢æ‰‹æœºå·è¾“å…¥æ¡†çš„nameå±žæ€§ã€‚attemptAuthenticationæ–¹æ³•ä»Žè¯·æ±‚ä¸­èŽ·å–åˆ°mobileå‚æ•°å€¼ï¼Œå¹¶è°ƒç”¨SmsAuthenticationTokençš„SmsAuthenticationToken(String mobile)æž„é€ æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªSmsAuthenticationTokenã€‚ä¸‹ä¸€æ­¥å°±å¦‚æµç¨‹å›¾ä¸­æ‰€ç¤ºçš„é‚£æ ·ï¼ŒSmsAuthenticationFilterå°†SmsAuthenticationTokenäº¤ç»™AuthenticationManagerå¤„ç†ã€‚å®šä¹‰SmsAuthenticationProvideråœ¨åˆ›å»ºå®ŒSmsAuthenticationFilteråŽï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ”¯æŒå¤„ç†è¯¥ç±»åž‹Tokençš„ç±»ï¼Œå³SmsAuthenticationProviderï¼Œè¯¥ç±»éœ€è¦å®žçŽ°AuthenticationProviderçš„ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼š1234567891011121314151617181920212223242526272829303132public class SmsAuthenticationProvider implements AuthenticationProvider &#123; private UserDetailService userDetailService; @Override public Authentication authenticate(Authentication authentication) throws AuthenticationException &#123; SmsAuthenticationToken authenticationToken = (SmsAuthenticationToken) authentication; UserDetails userDetails = userDetailService.loadUserByUsername((String) authenticationToken.getPrincipal()); if (userDetails == null) throw new InternalAuthenticationServiceException("æœªæ‰¾åˆ°ä¸Žè¯¥æ‰‹æœºå·å¯¹åº”çš„ç”¨æˆ·"); SmsAuthenticationToken authenticationResult = new SmsAuthenticationToken(userDetails, userDetails.getAuthorities()); authenticationResult.setDetails(authenticationToken.getDetails()); return authenticationResult; &#125; @Override public boolean supports(Class&lt;?&gt; aClass) &#123; return SmsAuthenticationToken.class.isAssignableFrom(aClass); &#125; public UserDetailService getUserDetailService() &#123; return userDetailService; &#125; public void setUserDetailService(UserDetailService userDetailService) &#123; this.userDetailService = userDetailService; &#125;&#125;å…¶ä¸­supportsæ–¹æ³•æŒ‡å®šäº†æ”¯æŒå¤„ç†çš„Tokenç±»åž‹ä¸ºSmsAuthenticationTokenï¼Œauthenticateæ–¹æ³•ç”¨äºŽç¼–å†™å…·ä½“çš„èº«ä»½è®¤è¯é€»è¾‘ã€‚åœ¨authenticateæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä»ŽSmsAuthenticationTokenä¸­å–å‡ºäº†æ‰‹æœºå·ä¿¡æ¯ï¼Œå¹¶è°ƒç”¨äº†UserDetailServiceçš„loadUserByUsernameæ–¹æ³•ã€‚è¯¥æ–¹æ³•åœ¨ç”¨æˆ·åå¯†ç ç±»åž‹çš„è®¤è¯ä¸­ï¼Œä¸»è¦é€»è¾‘æ˜¯é€šè¿‡ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æžœå­˜åœ¨è¯¥ç”¨æˆ·å¹¶ä¸”å¯†ç ä¸€è‡´åˆ™è®¤è¯æˆåŠŸï¼›è€Œåœ¨çŸ­ä¿¡éªŒè¯ç è®¤è¯çš„è¿‡ç¨‹ä¸­ï¼Œè¯¥æ–¹æ³•éœ€è¦é€šè¿‡æ‰‹æœºå·åŽ»æŸ¥è¯¢ç”¨æˆ·ï¼Œå¦‚æžœå­˜åœ¨è¯¥ç”¨æˆ·åˆ™è®¤è¯é€šè¿‡ã€‚è®¤è¯é€šè¿‡åŽæŽ¥ç€è°ƒç”¨SmsAuthenticationTokençš„SmsAuthenticationToken(Object principal, Collection&lt;? extends GrantedAuthority&gt; authorities)æž„é€ å‡½æ•°æž„é€ ä¸€ä¸ªè®¤è¯é€šè¿‡çš„Tokenï¼ŒåŒ…å«äº†ç”¨æˆ·ä¿¡æ¯å’Œç”¨æˆ·æƒé™ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆè¿™ä¸€æ­¥æ²¡æœ‰è¿›è¡ŒçŸ­ä¿¡éªŒè¯ç çš„æ ¡éªŒå‘¢ï¼Ÿå®žé™…ä¸ŠçŸ­ä¿¡éªŒè¯ç çš„æ ¡éªŒæ˜¯åœ¨SmsAuthenticationFilterä¹‹å‰å®Œæˆçš„ï¼Œå³åªæœ‰å½“çŸ­ä¿¡éªŒè¯ç æ­£ç¡®ä»¥åŽæ‰å¼€å§‹èµ°è®¤è¯çš„æµç¨‹ã€‚æ‰€ä»¥æŽ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å®šä¸€ä¸ªè¿‡æ»¤å™¨æ¥æ ¡éªŒçŸ­ä¿¡éªŒè¯ç çš„æ­£ç¡®æ€§ã€‚å®šä¹‰SmsCodeFilterçŸ­ä¿¡éªŒè¯ç çš„æ ¡éªŒé€»è¾‘å…¶å®žå’Œå›¾å½¢éªŒè¯ç çš„æ ¡éªŒé€»è¾‘åŸºæœ¬ä¸€è‡´ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å›¾å½¢éªŒè¯ç è¿‡æ»¤å™¨çš„åŸºç¡€ä¸Šç¨ä½œä¿®æ”¹ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445@Componentpublic class SmsCodeFilter extends OncePerRequestFilter &#123; @Autowired private AuthenticationFailureHandler authenticationFailureHandler; private SessionStrategy sessionStrategy = new HttpSessionSessionStrategy(); @Override protected void doFilterInternal(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, FilterChain filterChain) throws ServletException, IOException &#123; if (StringUtils.equalsIgnoreCase("/login/mobile", httpServletRequest.getRequestURI()) &amp;&amp; StringUtils.equalsIgnoreCase(httpServletRequest.getMethod(), "post")) &#123; try &#123; validateCode(new ServletWebRequest(httpServletRequest)); &#125; catch (ValidateCodeException e) &#123; authenticationFailureHandler.onAuthenticationFailure(httpServletRequest, httpServletResponse, e); return; &#125; &#125; filterChain.doFilter(httpServletRequest, httpServletResponse); &#125; private void validateSmsCode(ServletWebRequest servletWebRequest) throws ServletRequestBindingException &#123; String smsCodeInRequest = ServletRequestUtils.getStringParameter(servletWebRequest.getRequest(), "smsCode"); String mobile = ServletRequestUtils.getStringParameter(servletWebRequest.getRequest(), "mobile"); ValidateCode codeInSession = (ValidateCode) sessionStrategy.getAttribute(servletWebRequest, FebsConstant.SESSION_KEY_SMS_CODE + mobile); if (StringUtils.isBlank(smsCodeInRequest)) &#123; throw new ValidateCodeException("éªŒè¯ç ä¸èƒ½ä¸ºç©ºï¼"); &#125; if (codeInSession == null) &#123; throw new ValidateCodeException("éªŒè¯ç ä¸å­˜åœ¨ï¼Œè¯·é‡æ–°å‘é€ï¼"); &#125; if (codeInSession.isExpire()) &#123; sessionStrategy.removeAttribute(servletWebRequest, FebsConstant.SESSION_KEY_SMS_CODE + mobile); throw new ValidateCodeException("éªŒè¯ç å·²è¿‡æœŸï¼Œè¯·é‡æ–°å‘é€ï¼"); &#125; if (!StringUtils.equalsIgnoreCase(codeInSession.getCode(), smsCodeInRequest)) &#123; throw new ValidateCodeException("éªŒè¯ç ä¸æ­£ç¡®ï¼"); &#125; sessionStrategy.removeAttribute(servletWebRequest, FebsConstant.SESSION_KEY_SMS_CODE + mobile); &#125;&#125;æ–¹æ³•çš„åŸºæœ¬é€»è¾‘å’Œä¹‹å‰å®šä¹‰çš„ValidateCodeFilterä¸€è‡´ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚é…ç½®ç”Ÿæ•ˆåœ¨å®šä¹‰å®Œæ‰€éœ€çš„ç»„ä»¶åŽï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€äº›é…ç½®ï¼Œå°†è¿™äº›ç»„ä»¶ç»„åˆèµ·æ¥å½¢æˆä¸€ä¸ªå’Œä¸Šé¢æµç¨‹å›¾å¯¹åº”çš„æµç¨‹ã€‚åˆ›å»ºä¸€ä¸ªé…ç½®ç±»SmsAuthenticationConfigï¼š123456789101112131415161718192021222324252627@Componentpublic class SmsAuthenticationConfig extends SecurityConfigurerAdapter&lt;DefaultSecurityFilterChain, HttpSecurity&gt; &#123; @Autowired private AuthenticationSuccessHandler authenticationSuccessHandler; @Autowired private AuthenticationFailureHandler authenticationFailureHandler; @Autowired private UserDetailService userDetailService; @Override public void configure(HttpSecurity http) throws Exception &#123; SmsAuthenticationFilter smsAuthenticationFilter = new SmsAuthenticationFilter(); smsAuthenticationFilter.setAuthenticationManager(http.getSharedObject(AuthenticationManager.class)); smsAuthenticationFilter.setAuthenticationSuccessHandler(authenticationSuccessHandler); smsAuthenticationFilter.setAuthenticationFailureHandler(authenticationFailureHandler); SmsAuthenticationProvider smsAuthenticationProvider = new SmsAuthenticationProvider(); smsAuthenticationProvider.setUserDetailService(userDetailService); http.authenticationProvider(smsAuthenticationProvider) .addFilterAfter(smsAuthenticationFilter, UsernamePasswordAuthenticationFilter.class); &#125;&#125;åœ¨æµç¨‹ä¸­ç¬¬ä¸€æ­¥éœ€è¦é…ç½®SmsAuthenticationFilterï¼Œåˆ†åˆ«è®¾ç½®äº†AuthenticationManagerã€AuthenticationSuccessHandlerå’ŒAuthenticationFailureHandlerå±žæ€§ã€‚è¿™äº›å±žæ€§éƒ½æ˜¯æ¥è‡ªSmsAuthenticationFilterç»§æ‰¿çš„AbstractAuthenticationProcessingFilterç±»ä¸­ã€‚ç¬¬äºŒæ­¥é…ç½®SmsAuthenticationProviderï¼Œè¿™ä¸€æ­¥åªéœ€è¦å°†æˆ‘ä»¬è‡ªä¸ªçš„UserDetailServiceæ³¨å…¥è¿›æ¥å³å¯ã€‚æœ€åŽè°ƒç”¨HttpSecurityçš„authenticationProvideræ–¹æ³•æŒ‡å®šäº†AuthenticationProviderä¸ºSmsAuthenticationProviderï¼Œå¹¶å°†SmsAuthenticationFilterè¿‡æ»¤å™¨æ·»åŠ åˆ°äº†UsernamePasswordAuthenticationFilteråŽé¢ã€‚åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å°†çŸ­ä¿¡éªŒè¯ç è®¤è¯çš„å„ä¸ªç»„ä»¶ç»„åˆèµ·æ¥äº†ï¼Œæœ€åŽä¸€æ­¥éœ€è¦åšçš„æ˜¯é…ç½®çŸ­ä¿¡éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨ï¼Œå¹¶ä¸”å°†çŸ­ä¿¡éªŒè¯ç è®¤è¯æµç¨‹åŠ å…¥åˆ°Spring Securityä¸­ã€‚åœ¨BrowserSecurityConfigçš„configureæ–¹æ³•ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546@Configurationpublic class BrowserSecurityConfig extends WebSecurityConfigurerAdapter &#123; @Autowired private MyAuthenticationSucessHandler authenticationSucessHandler; @Autowired private MyAuthenticationFailureHandler authenticationFailureHandler; @Autowired private ValidateCodeFilter validateCodeFilter; @Autowired private SmsCodeFilter smsCodeFilter; @Autowired private SmsAuthenticationConfig smsAuthenticationConfig; @Bean public PasswordEncoder passwordEncoder() &#123; return new BCryptPasswordEncoder(); &#125; @Override protected void configure(HttpSecurity http) throws Exception &#123; http.addFilterBefore(validateCodeFilter, UsernamePasswordAuthenticationFilter.class) // æ·»åŠ éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨ .addFilterBefore(smsCodeFilter, UsernamePasswordAuthenticationFilter.class) // æ·»åŠ çŸ­ä¿¡éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨ .formLogin() // è¡¨å•ç™»å½• // http.httpBasic() // HTTP Basic .loginPage("/authentication/require") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .successHandler(authenticationSucessHandler) // å¤„ç†ç™»å½•æˆåŠŸ .failureHandler(authenticationFailureHandler) // å¤„ç†ç™»å½•å¤±è´¥ .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/authentication/require", "/login.html", "/code/image","/code/sms").permitAll() // æ— éœ€è®¤è¯çš„è¯·æ±‚è·¯å¾„ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and() .csrf().disable() .apply(smsAuthenticationConfig); // å°†çŸ­ä¿¡éªŒè¯ç è®¤è¯é…ç½®åŠ åˆ° Spring Security ä¸­ &#125;&#125;å…·ä½“å«ä¹‰è§æ³¨é‡Šï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚æµ‹è¯•é‡å¯é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/login.htmlï¼Œç‚¹å‡»å‘é€éªŒè¯ç ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š1æ‚¨çš„ç™»å½•éªŒè¯ç ä¸ºï¼š169638ï¼Œæœ‰æ•ˆæ—¶é—´ä¸º60ç§’è¾“å…¥è¯¥éªŒè¯ç ï¼Œç‚¹å‡»ç™»å½•åŽé¡µé¢å¦‚ä¸‹æ‰€ç¤ºï¼šè®¤è¯æˆåŠŸã€‚æºç é“¾æŽ¥ https://github.com/wuyouzhuguli/SpringAll/tree/master/38.Spring-Security-SmsCode]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Securityæ·»åŠ è®°ä½æˆ‘åŠŸèƒ½]]></title>
    <url>%2FSpring-Security-RememberMe.html</url>
    <content type="text"><![CDATA[åœ¨ç½‘ç«™çš„ç™»å½•é¡µé¢ä¸­ï¼Œè®°ä½æˆ‘é€‰é¡¹æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„åŠŸèƒ½ï¼Œå‹¾é€‰è®°ä½æˆ‘åŽåœ¨ä¸€æ®µæ—¶é—´å†…ï¼Œç”¨æˆ·æ— éœ€è¿›è¡Œç™»å½•æ“ä½œå°±å¯ä»¥è®¿é—®ç³»ç»Ÿèµ„æºã€‚åœ¨Spring Securityä¸­æ·»åŠ è®°ä½æˆ‘åŠŸèƒ½å¾ˆç®€å•ï¼Œå¤§è‡´è¿‡ç¨‹æ˜¯ï¼šå½“ç”¨æˆ·å‹¾é€‰äº†è®°ä½æˆ‘é€‰é¡¹å¹¶ç™»å½•æˆåŠŸåŽï¼ŒSpring Securityä¼šç”Ÿæˆä¸€ä¸ªtokenæ ‡è¯†ï¼Œç„¶åŽå°†è¯¥tokenæ ‡è¯†æŒä¹…åŒ–åˆ°æ•°æ®åº“ï¼Œå¹¶ä¸”ç”Ÿæˆä¸€ä¸ªä¸Žè¯¥tokenç›¸å¯¹åº”çš„cookieè¿”å›žç»™æµè§ˆå™¨ã€‚å½“ç”¨æˆ·è¿‡æ®µæ—¶é—´å†æ¬¡è®¿é—®ç³»ç»Ÿæ—¶ï¼Œå¦‚æžœè¯¥cookieæ²¡æœ‰è¿‡æœŸï¼ŒSpring Securityä¾¿ä¼šæ ¹æ®cookieåŒ…å«çš„ä¿¡æ¯ä»Žæ•°æ®åº“ä¸­èŽ·å–ç›¸åº”çš„tokenä¿¡æ¯ï¼Œç„¶åŽå¸®ç”¨æˆ·è‡ªåŠ¨å®Œæˆç™»å½•æ“ä½œã€‚tokenæŒä¹…åŒ–Spring Securityçš„è®°ä½æˆ‘åŠŸèƒ½çš„å®žçŽ°éœ€è¦ä½¿ç”¨æ•°æ®åº“æ¥æŒä¹…åŒ–tokenã€‚æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚Spring Securityæ·»åŠ å›¾å½¢éªŒè¯ç çš„åŸºç¡€ä¸Šæ¥æ·»åŠ è®°ä½æˆ‘çš„åŠŸèƒ½ã€‚åœ¨application.ymlä¸­æ·»åŠ æ•°æ®æºé…ç½®ï¼š123456spring: datasource: driver-class-name: com.mysql.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/security?useUnicode=yes&amp;characterEncoding=UTF-8&amp;useSSL=false username: root password: 123456æ·»åŠ æ•°æ®åº“ä¾èµ–ï¼š12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽæˆ‘ä»¬åœ¨BrowserSecurityConfigä¸­é…ç½®ä¸ªtokenæŒä¹…åŒ–å¯¹è±¡ï¼š12345678910111213141516@Configurationpublic class BrowserSecurityConfig extends WebSecurityConfigurerAdapter &#123; @Autowired private UserDetailService userDetailService; @Autowired private DataSource dataSource; @Bean public PersistentTokenRepository persistentTokenRepository() &#123; JdbcTokenRepositoryImpl jdbcTokenRepository = new JdbcTokenRepositoryImpl(); jdbcTokenRepository.setDataSource(dataSource); jdbcTokenRepository.setCreateTableOnStartup(false); return jdbcTokenRepository; &#125; ...&#125;PersistentTokenRepositoryä¸ºä¸€ä¸ªæŽ¥å£ç±»ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯æ•°æ®åº“æŒä¹…åŒ–ï¼Œæ‰€ä»¥å®žä¾‹ç”¨çš„æ˜¯PersistentTokenRepositoryçš„å®žçŽ°ç±»JdbcTokenRepositoryImplã€‚JdbcTokenRepositoryImpléœ€è¦æŒ‡å®šæ•°æ®æºï¼Œæ‰€ä»¥æˆ‘ä»¬å°†é…ç½®å¥½çš„æ•°æ®æºå¯¹è±¡DataSourceæ³¨å…¥è¿›æ¥å¹¶é…ç½®åˆ°JdbcTokenRepositoryImplçš„dataSourceå±žæ€§ä¸­ã€‚createTableOnStartupå±žæ€§ç”¨äºŽæ˜¯å¦å¯åŠ¨é¡¹ç›®æ—¶åˆ›å»ºä¿å­˜tokenä¿¡æ¯çš„æ•°æ®è¡¨ï¼Œè¿™é‡Œè®¾ç½®ä¸ºfalseï¼Œæˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨åˆ›å»ºã€‚æŸ¥çœ‹JdbcTokenRepositoryImplçš„æºç ï¼Œå¯ä»¥çœ‹åˆ°å…¶åŒ…å«äº†ä¸€ä¸ªCREATE_TABLE_SQLå±žæ€§ï¼šè¿™ä¸ªå…¶å®žå°±æ˜¯ç”¨äºŽä¿å­˜tokenå¯¹è±¡æ•°æ®è¡¨çš„SQLè¯­å¥ï¼Œæˆ‘ä»¬å¤åˆ¶å‡ºæ¥æ‰‹åŠ¨æ‰§è¡Œåˆ›å»ºè¡¨ï¼š123456CREATE TABLE persistent_logins ( username VARCHAR (64) NOT NULL, series VARCHAR (64) PRIMARY KEY, token VARCHAR (64) NOT NULL, last_used TIMESTAMP NOT NULL)ä¿®æ”¹ç™»å½•é¡µå®Œæˆä¸Šè¿°é…ç½®åŽï¼Œæˆ‘ä»¬ç¨å¾®æ”¹é€ ä¸‹ç™»å½•é¡µï¼ŒåŠ å…¥è®°ä½æˆ‘çš„å‹¾é€‰é€‰é¡¹ï¼š1&lt;input type="checkbox" name="remember-me"/&gt; è®°ä½æˆ‘å…¶ä¸­nameå±žæ€§å¿…é¡»ä¸ºremember-meã€‚é…ç½®ç”Ÿæ•ˆæœ€åŽæˆ‘ä»¬éœ€è¦åœ¨Spring Securityçš„è®¤è¯æµç¨‹ä¸­å¯ç”¨è®°ä½æˆ‘çš„åŠŸèƒ½ï¼Œåœ¨BrowserSecurityConfigçš„configureæ–¹æ³•ä¸­å¼€å¯è®°ä½æˆ‘åŠŸèƒ½ï¼š123456789101112131415161718192021222324@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.addFilterBefore(validateCodeFilter, UsernamePasswordAuthenticationFilter.class) // æ·»åŠ éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨ .formLogin() // è¡¨å•ç™»å½• // http.httpBasic() // HTTP Basic .loginPage("/authentication/require") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .successHandler(authenticationSucessHandler) // å¤„ç†ç™»å½•æˆåŠŸ .failureHandler(authenticationFailureHandler) // å¤„ç†ç™»å½•å¤±è´¥ .and() .rememberMe() .tokenRepository(persistentTokenRepository()) // é…ç½® token æŒä¹…åŒ–ä»“åº“ .tokenValiditySeconds(3600) // remember è¿‡æœŸæ—¶é—´ï¼Œå•ä¸ºç§’ .userDetailsService(userDetailService) // å¤„ç†è‡ªåŠ¨ç™»å½•é€»è¾‘ .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/authentication/require", "/login.html", "/image/code").permitAll() // æ— éœ€è®¤è¯çš„è¯·æ±‚è·¯å¾„ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and() .csrf().disable();&#125;rememberMe()ç”¨äºŽå¼€å¯è®°ä½æˆ‘åŠŸèƒ½ï¼›tokenRepository(persistentTokenRepository())ç”¨äºŽæŒ‡å®štokenæŒä¹…åŒ–æ–¹æ³•ï¼›tokenValiditySecondsé…ç½®äº†tokençš„æœ‰æ•ˆæ—¶é•¿ï¼Œå•ä¸ºä¸ºç§’ï¼›userDetailsService(userDetailService)ç”¨äºŽå¤„ç†é€šè¿‡tokenå¯¹è±¡è‡ªåŠ¨ç™»å½•ï¼Œè¿™é‡Œä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„UserDetailsServiceæŽ¥å£å®žçŽ°ã€‚é…ç½®å¥½åŽï¼Œé‡å¯é¡¹ç›®ï¼Œç™»å½•é¡µé¢å¦‚ä¸‹æ‰€ç¤ºï¼šæ¯”è¾ƒéš¾çœ‹ï¼Œæ— ä¼¤å¤§é›…ã€‚å‹¾é€‰å¹¶æˆåŠŸç™»å½•åŽï¼Œå¯ä»¥çœ‹åˆ°ç½‘é¡µå¤šäº†ä¸ªremember-meçš„cookieå¯¹è±¡ï¼šæŸ¥çœ‹æ•°æ®åº“è¡¨persistent_loginsï¼šå¯ä»¥çœ‹åˆ°tokenä¿¡æ¯å·²ç»æˆåŠŸæŒä¹…åŒ–äº†ï¼Œå¹¶ä¸”æµè§ˆå™¨ä¹ŸæˆåŠŸç”Ÿæˆäº†ç›¸åº”çš„cookieã€‚åœ¨cookieæœªå¤±æ•ˆä¹‹å‰ï¼Œæ— è®ºæ˜¯é‡å¼€æµè§ˆå™¨æˆ–è€…é‡å¯é¡¹ç›®ï¼Œç”¨æˆ·éƒ½æ— éœ€å†æ¬¡ç™»å½•å°±å¯ä»¥è®¿é—®ç³»ç»Ÿèµ„æºäº†ã€‚æºç é“¾æŽ¥ https://github.com/wuyouzhuguli/SpringAll/tree/master/37.Spring-Security-RememberMe]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Securityæ·»åŠ å›¾å½¢éªŒè¯ç ]]></title>
    <url>%2FSpring-Security-ValidateCode.html</url>
    <content type="text"><![CDATA[æ·»åŠ éªŒè¯ç å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šæ ¹æ®éšæœºæ•°ç”ŸæˆéªŒè¯ç å›¾ç‰‡ï¼›å°†éªŒè¯ç å›¾ç‰‡æ˜¾ç¤ºåˆ°ç™»å½•é¡µé¢ï¼›è®¤è¯æµç¨‹ä¸­åŠ å…¥éªŒè¯ç æ ¡éªŒã€‚Spring Securityçš„è®¤è¯æ ¡éªŒæ˜¯ç”±UsernamePasswordAuthenticationFilterè¿‡æ»¤å™¨å®Œæˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„éªŒè¯ç æ ¡éªŒé€»è¾‘åº”è¯¥åœ¨è¿™ä¸ªè¿‡æ»¤å™¨ä¹‹å‰ã€‚ä¸‹é¢ä¸€èµ·å­¦ä¹ ä¸‹å¦‚ä½•åœ¨ä¸Šä¸€èŠ‚Spring Securityè‡ªå®šä¹‰ç”¨æˆ·è®¤è¯çš„åŸºç¡€ä¸ŠåŠ å…¥éªŒè¯ç æ ¡éªŒåŠŸèƒ½ã€‚ç”Ÿæˆå›¾å½¢éªŒè¯ç éªŒè¯ç åŠŸèƒ½éœ€è¦ç”¨åˆ°spring-social-configä¾èµ–ï¼š1234 &lt;dependency&gt; &lt;groupId&gt;org.springframework.social&lt;/groupId&gt; &lt;artifactId&gt;spring-social-config&lt;/artifactId&gt;&lt;/dependency&gt;é¦–å…ˆå®šä¹‰ä¸€ä¸ªéªŒè¯ç å¯¹è±¡ImageCodeï¼š12345678910111213141516171819202122232425public class ImageCode &#123; private BufferedImage image; private String code; private LocalDateTime expireTime; public ImageCode(BufferedImage image, String code, int expireIn) &#123; this.image = image; this.code = code; this.expireTime = LocalDateTime.now().plusSeconds(expireIn); &#125; public ImageCode(BufferedImage image, String code, LocalDateTime expireTime) &#123; this.image = image; this.code = code; this.expireTime = expireTime; &#125; boolean isExpire() &#123; return LocalDateTime.now().isAfter(expireTime); &#125; // get,set ç•¥&#125;ImageCodeå¯¹è±¡åŒ…å«äº†ä¸‰ä¸ªå±žæ€§ï¼šimageå›¾ç‰‡ï¼ŒcodeéªŒè¯ç å’ŒexpireTimeè¿‡æœŸæ—¶é—´ã€‚isExpireæ–¹æ³•ç”¨äºŽåˆ¤æ–­éªŒè¯ç æ˜¯å¦å·²è¿‡æœŸã€‚æŽ¥ç€å®šä¹‰ä¸€ä¸ªValidateCodeControllerï¼Œç”¨äºŽå¤„ç†ç”ŸæˆéªŒè¯ç è¯·æ±‚ï¼š1234567891011121314@RestControllerpublic class ValidateController &#123; public final static String SESSION_KEY_IMAGE_CODE = "SESSION_KEY_IMAGE_CODE"; private SessionStrategy sessionStrategy = new HttpSessionSessionStrategy(); @GetMapping("/code/image") public void createCode(HttpServletRequest request, HttpServletResponse response) throws IOException &#123; ImageCode imageCode = createImageCode(); sessionStrategy.setAttribute(new ServletWebRequest(request), SESSION_KEY, imageCode); ImageIO.write(imageCode.getImage(), "jpeg", response.getOutputStream()); &#125;&#125;createImageCodeæ–¹æ³•ç”¨äºŽç”ŸæˆéªŒè¯ç å¯¹è±¡ï¼Œorg.springframework.social.connect.web.HttpSessionSessionStrategyå¯¹è±¡å°è£…äº†ä¸€äº›å¤„ç†Sessionçš„æ–¹æ³•ï¼ŒåŒ…å«äº†setAttributeã€getAttributeå’ŒremoveAttributeæ–¹æ³•ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹è¯¥ç±»çš„æºç ã€‚ä½¿ç”¨sessionStrategyå°†ç”Ÿæˆçš„éªŒè¯ç å¯¹è±¡å­˜å‚¨åˆ°Sessionä¸­ï¼Œå¹¶é€šè¿‡IOæµå°†ç”Ÿæˆçš„å›¾ç‰‡è¾“å‡ºåˆ°ç™»å½•é¡µé¢ä¸Šã€‚å…¶ä¸­createImageCodeæ–¹æ³•ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748private ImageCode createImageCode() &#123; int width = 100; // éªŒè¯ç å›¾ç‰‡å®½åº¦ int height = 36; // éªŒè¯ç å›¾ç‰‡é•¿åº¦ int length = 4; // éªŒè¯ç ä½æ•° int expireIn = 60; // éªŒè¯ç æœ‰æ•ˆæ—¶é—´ 60s BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB); Graphics g = image.getGraphics(); Random random = new Random(); g.setColor(getRandColor(200, 250)); g.fillRect(0, 0, width, height); g.setFont(new Font("Times New Roman", Font.ITALIC, 20)); g.setColor(getRandColor(160, 200)); for (int i = 0; i &lt; 155; i++) &#123; int x = random.nextInt(width); int y = random.nextInt(height); int xl = random.nextInt(12); int yl = random.nextInt(12); g.drawLine(x, y, x + xl, y + yl); &#125; StringBuilder sRand = new StringBuilder(); for (int i = 0; i &lt; length; i++) &#123; String rand = String.valueOf(random.nextInt(10)); sRand.append(rand); g.setColor(new Color(20 + random.nextInt(110), 20 + random.nextInt(110), 20 + random.nextInt(110))); g.drawString(rand, 13 * i + 6, 16); &#125; g.dispose(); return new ImageCode(image, sRand.toString(), expireIn);&#125;private Color getRandColor(int fc, int bc) &#123; Random random = new Random(); if (fc &gt; 255) &#123; fc = 255; &#125; if (bc &gt; 255) &#123; bc = 255; &#125; int r = fc + random.nextInt(bc - fc); int g = fc + random.nextInt(bc - fc); int b = fc + random.nextInt(bc - fc); return new Color(r, g, b);&#125;ç”ŸæˆéªŒè¯ç çš„æ–¹æ³•å†™å¥½åŽï¼ŒæŽ¥ä¸‹æ¥å¼€å§‹æ”¹é€ ç™»å½•é¡µé¢ã€‚æ”¹é€ ç™»å½•é¡µåœ¨ç™»å½•é¡µé¢åŠ ä¸Šå¦‚ä¸‹ä»£ç ï¼š1234&lt;span style="display: inline"&gt; &lt;input type="text" name="imageCode" placeholder="éªŒè¯ç " style="width: 50%;"/&gt; &lt;img src="/code/image"/&gt;&lt;/span&gt;&lt;img&gt;æ ‡ç­¾çš„srcå±žæ€§å¯¹åº”ValidateControllerçš„createImageCodeæ–¹æ³•ã€‚è¦ä½¿ç”ŸæˆéªŒè¯ç çš„è¯·æ±‚ä¸è¢«æ‹¦æˆªï¼Œéœ€è¦åœ¨BrowserSecurityConfigçš„configureæ–¹æ³•ä¸­é…ç½®å…æ‹¦æˆªï¼š1234567891011121314151617@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.formLogin() // è¡¨å•ç™»å½• // http.httpBasic() // HTTP Basic .loginPage("/authentication/require") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .successHandler(authenticationSucessHandler) // å¤„ç†ç™»å½•æˆåŠŸ .failureHandler(authenticationFailureHandler) // å¤„ç†ç™»å½•å¤±è´¥ .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/authentication/require", "/login.html", "/code/image").permitAll() // æ— éœ€è®¤è¯çš„è¯·æ±‚è·¯å¾„ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and().csrf().disable();&#125;é‡å¯é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/login.htmlï¼Œæ•ˆæžœå¦‚ä¸‹ï¼šè®¤è¯æµç¨‹æ·»åŠ éªŒè¯ç æ ¡éªŒåœ¨æ ¡éªŒéªŒè¯ç çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šæŠ›å‡ºå„ç§éªŒè¯ç ç±»åž‹çš„å¼‚å¸¸ï¼Œæ¯”å¦‚â€œéªŒè¯ç é”™è¯¯â€ã€â€œéªŒè¯ç å·²è¿‡æœŸâ€ç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªéªŒè¯ç ç±»åž‹çš„å¼‚å¸¸ç±»ï¼š1234567public class ValidateCodeException extends AuthenticationException &#123; private static final long serialVersionUID = 5022575393500654458L; ValidateCodeException(String message) &#123; super(message); &#125;&#125;æ³¨æ„ï¼Œè¿™é‡Œç»§æ‰¿çš„æ˜¯AuthenticationExceptionè€Œä¸æ˜¯Exceptionã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒSpring Securityå®žé™…ä¸Šæ˜¯ç”±è®¸å¤šè¿‡æ»¤å™¨ç»„æˆçš„è¿‡æ»¤å™¨é“¾ï¼Œå¤„ç†ç”¨æˆ·ç™»å½•é€»è¾‘çš„è¿‡æ»¤å™¨ä¸ºUsernamePasswordAuthenticationFilterï¼Œè€ŒéªŒè¯ç æ ¡éªŒè¿‡ç¨‹åº”è¯¥æ˜¯åœ¨è¿™ä¸ªè¿‡æ»¤å™¨ä¹‹å‰çš„ï¼Œå³åªæœ‰éªŒè¯ç æ ¡éªŒé€šè¿‡åŽé‡‡åŽ»æ ¡éªŒç”¨æˆ·åå’Œå¯†ç ã€‚ç”±äºŽSpring Securityå¹¶æ²¡æœ‰ç›´æŽ¥æä¾›éªŒè¯ç æ ¡éªŒç›¸å…³çš„è¿‡æ»¤å™¨æŽ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªå·±å®šä¹‰ä¸€ä¸ªéªŒè¯ç æ ¡éªŒçš„è¿‡æ»¤å™¨ValidateCodeFilterï¼š12345678910111213141516171819202122232425262728@Componentpublic class ValidateCodeFilter extends OncePerRequestFilter &#123; @Autowired private AuthenticationFailureHandler authenticationFailureHandler; private SessionStrategy sessionStrategy = new HttpSessionSessionStrategy(); @Override protected void doFilterInternal(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, FilterChain filterChain) throws ServletException, IOException &#123; if (StringUtils.equalsIgnoreCase("/login", httpServletRequest.getRequestURI()) &amp;&amp; StringUtils.equalsIgnoreCase(httpServletRequest.getMethod(), "post")) &#123; try &#123; validateCode(new ServletWebRequest(httpServletRequest)); &#125; catch (ValidateCodeException e) &#123; authenticationFailureHandler.onAuthenticationFailure(httpServletRequest, httpServletResponse, e); return; &#125; &#125; filterChain.doFilter(httpServletRequest, httpServletResponse); &#125; private void validateCode(ServletWebRequest servletWebRequest) throws ServletRequestBindingException &#123; ... &#125; &#125;ValidateCodeFilterç»§æ‰¿äº†org.springframework.web.filter.OncePerRequestFilterï¼Œè¯¥è¿‡æ»¤å™¨åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚åœ¨doFilterInternalæ–¹æ³•ä¸­æˆ‘ä»¬åˆ¤æ–­äº†è¯·æ±‚URLæ˜¯å¦ä¸º/loginï¼Œè¯¥è·¯å¾„å¯¹åº”ç™»å½•formè¡¨å•çš„actionè·¯å¾„ï¼Œè¯·æ±‚çš„æ–¹æ³•æ˜¯å¦ä¸ºPOSTï¼Œæ˜¯çš„è¯è¿›è¡ŒéªŒè¯ç æ ¡éªŒé€»è¾‘ï¼Œå¦åˆ™ç›´æŽ¥æ‰§è¡ŒfilterChain.doFilterè®©ä»£ç å¾€ä¸‹èµ°ã€‚å½“åœ¨éªŒè¯ç æ ¡éªŒçš„è¿‡ç¨‹ä¸­æ•èŽ·åˆ°å¼‚å¸¸æ—¶ï¼Œè°ƒç”¨Spring Securityçš„æ ¡éªŒå¤±è´¥å¤„ç†å™¨AuthenticationFailureHandlerè¿›è¡Œå¤„ç†ã€‚validateCodeçš„æ ¡éªŒé€»è¾‘å¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314151617181920private void validateCode(ServletWebRequest servletWebRequest) throws ServletRequestBindingException &#123; ImageCode codeInSession = (ImageCode) sessionStrategy.getAttribute(servletWebRequest, ValidateController.SESSION_KEY); String codeInRequest = ServletRequestUtils.getStringParameter(servletWebRequest.getRequest(), "imageCode"); if (StringUtils.isBlank(codeInRequest)) &#123; throw new ValidateCodeException("éªŒè¯ç ä¸èƒ½ä¸ºç©ºï¼"); &#125; if (codeInSession == null) &#123; throw new ValidateCodeException("éªŒè¯ç ä¸å­˜åœ¨ï¼"); &#125; if (codeInSession.isExpire()) &#123; sessionStrategy.removeAttribute(servletWebRequest, ValidateController.SESSION_KEY); throw new ValidateCodeException("éªŒè¯ç å·²è¿‡æœŸï¼"); &#125; if (!StringUtils.equalsIgnoreCase(codeInSession.getCode(), codeInRequest)) &#123; throw new ValidateCodeException("éªŒè¯ç ä¸æ­£ç¡®ï¼"); &#125; sessionStrategy.removeAttribute(servletWebRequest, ValidateController.SESSION_KEY);&#125;æˆ‘ä»¬åˆ†åˆ«ä»ŽSessionä¸­èŽ·å–äº†ImageCodeå¯¹è±¡å’Œè¯·æ±‚å‚æ•°imageCodeï¼ˆå¯¹åº”ç™»å½•é¡µé¢çš„éªŒè¯ç &lt;input&gt;æ¡†nameå±žæ€§ï¼‰,ç„¶åŽè¿›è¡Œäº†å„ç§åˆ¤æ–­å¹¶æŠ›å‡ºç›¸åº”çš„å¼‚å¸¸ã€‚å½“éªŒè¯ç è¿‡æœŸæˆ–è€…éªŒè¯ç æ ¡éªŒé€šè¿‡æ—¶ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥åˆ é™¤Sessionä¸­çš„ImageCodeå±žæ€§äº†ã€‚éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨å®šä¹‰å¥½äº†ï¼Œæ€Žä¹ˆæ‰èƒ½å°†å…¶æ·»åŠ åˆ°UsernamePasswordAuthenticationFilterå‰é¢å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨BrowserSecurityConfigçš„configureæ–¹æ³•ä¸­æ·»åŠ äº›è®¸é…ç½®å³å¯ï¼š123456789101112131415161718192021@Autowiredprivate ValidateCodeFilter validateCodeFilter;@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.addFilterBefore(validateCodeFilter, UsernamePasswordAuthenticationFilter.class) // æ·»åŠ éªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨ .formLogin() // è¡¨å•ç™»å½• // http.httpBasic() // HTTP Basic .loginPage("/authentication/require") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .successHandler(authenticationSucessHandler) // å¤„ç†ç™»å½•æˆåŠŸ .failureHandler(authenticationFailureHandler) // å¤„ç†ç™»å½•å¤±è´¥ .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/authentication/require", "/login.html", "/code/image").permitAll() // æ— éœ€è®¤è¯çš„è¯·æ±‚è·¯å¾„ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and().csrf().disable();&#125;ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ³¨å…¥äº†ValidateCodeFilterï¼Œç„¶åŽé€šè¿‡addFilterBeforeæ–¹æ³•å°†ValidateCodeFilteréªŒè¯ç æ ¡éªŒè¿‡æ»¤å™¨æ·»åŠ åˆ°äº†UsernamePasswordAuthenticationFilterå‰é¢ã€‚å¤§åŠŸå‘Šæˆï¼Œé‡å¯é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/login.htmlï¼Œå½“ä¸è¾“å…¥éªŒè¯ç æ—¶ç‚¹å‡»ç™»å½•ï¼Œé¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼šå½“è¾“å…¥é”™è¯¯çš„éªŒè¯ç æ—¶ç‚¹å‡»ç™»å½•ï¼Œé¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼šå½“é¡µé¢åŠ è½½60ç§’åŽå†è¾“å…¥éªŒè¯ç ç‚¹å‡»ç™»å½•ï¼Œé¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼šå½“éªŒè¯ç é€šè¿‡ï¼Œå¹¶ä¸”ç”¨æˆ·åå¯†ç æ­£ç¡®æ—¶ï¼Œé¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼šæºç é“¾æŽ¥ https://github.com/wuyouzhuguli/SpringAll/tree/master/36.Spring-Security-ValidateCode]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Securityè‡ªå®šä¹‰ç”¨æˆ·è®¤è¯]]></title>
    <url>%2FSpring-Security-Authentication.html</url>
    <content type="text"><![CDATA[åœ¨Spring Bootä¸­å¼€å¯Spring Securityä¸€èŠ‚ä¸­æˆ‘ä»¬ç®€å•æ­å»ºäº†ä¸ªSpring Boot + Spring Securityçš„é¡¹ç›®ï¼Œè®¤è¯çš„ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯ç”±Spring Securityç”Ÿæˆã€‚Spring Securityæ”¯æŒæˆ‘ä»¬è‡ªå®šä¹‰è®¤è¯çš„è¿‡ç¨‹ï¼Œå¦‚å¤„ç†ç”¨æˆ·ä¿¡æ¯èŽ·å–é€»è¾‘ï¼Œä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„ç™»å½•é¡µé¢æ›¿æ¢Spring Securityé»˜è®¤çš„ç™»å½•é¡µåŠè‡ªå®šä¹‰ç™»å½•æˆåŠŸæˆ–å¤±è´¥åŽçš„å¤„ç†é€»è¾‘ç­‰ã€‚è¿™é‡Œå°†åœ¨ä¸Šä¸€èŠ‚çš„æºç åŸºç¡€ä¸Šè¿›è¡Œæ”¹é€ ã€‚è‡ªå®šä¹‰è®¤è¯è¿‡ç¨‹è‡ªå®šä¹‰è®¤è¯çš„è¿‡ç¨‹éœ€è¦å®žçŽ°Spring Securityæä¾›çš„UserDetailServiceæŽ¥å£ï¼Œè¯¥æŽ¥å£åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•loadUserByUsernameï¼Œæºç å¦‚ä¸‹ï¼š123public interface UserDetailsService &#123; UserDetails loadUserByUsername(String username) throws UsernameNotFoundException;&#125;loadUserByUsernameæ–¹æ³•è¿”å›žä¸€ä¸ªUserDetailå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªæŽ¥å£ï¼ŒåŒ…å«ä¸€äº›ç”¨äºŽæè¿°ç”¨æˆ·ä¿¡æ¯çš„æ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š12345678910111213141516public interface UserDetails extends Serializable &#123; Collection&lt;? extends GrantedAuthority&gt; getAuthorities(); String getPassword(); String getUsername(); boolean isAccountNonExpired(); boolean isAccountNonLocked(); boolean isCredentialsNonExpired(); boolean isEnabled();&#125;è¿™äº›æ–¹æ³•çš„å«ä¹‰å¦‚ä¸‹ï¼šgetAuthoritiesèŽ·å–ç”¨æˆ·åŒ…å«çš„æƒé™ï¼Œè¿”å›žæƒé™é›†åˆï¼Œæƒé™æ˜¯ä¸€ä¸ªç»§æ‰¿äº†GrantedAuthorityçš„å¯¹è±¡ï¼›getPasswordå’ŒgetUsernameç”¨äºŽèŽ·å–å¯†ç å’Œç”¨æˆ·åï¼›isAccountNonExpiredæ–¹æ³•è¿”å›žbooleanç±»åž‹ï¼Œç”¨äºŽåˆ¤æ–­è´¦æˆ·æ˜¯å¦æœªè¿‡æœŸï¼Œæœªè¿‡æœŸè¿”å›žtrueåä¹‹è¿”å›žfalseï¼›isAccountNonLockedæ–¹æ³•ç”¨äºŽåˆ¤æ–­è´¦æˆ·æ˜¯å¦æœªé”å®šï¼›isCredentialsNonExpiredç”¨äºŽåˆ¤æ–­ç”¨æˆ·å‡­è¯æ˜¯å¦æ²¡è¿‡æœŸï¼Œå³å¯†ç æ˜¯å¦æœªè¿‡æœŸï¼›isEnabledæ–¹æ³•ç”¨äºŽåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å¯ç”¨ã€‚å®žé™…ä¸­æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰UserDetailsæŽ¥å£çš„å®žçŽ°ç±»ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥ä½¿ç”¨Spring Securityæä¾›çš„UserDetailsæŽ¥å£å®žçŽ°ç±»org.springframework.security.core.userdetails.Userã€‚è¯´äº†é‚£ä¹ˆå¤šï¼Œä¸‹é¢æˆ‘ä»¬æ¥å¼€å§‹å®žçŽ°UserDetailServiceæŽ¥å£çš„loadUserByUsernameæ–¹æ³•ã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ªMyUserå¯¹è±¡ï¼Œç”¨äºŽå­˜æ”¾æ¨¡æ‹Ÿçš„ç”¨æˆ·æ•°æ®ï¼ˆå®žé™…ä¸­ä¸€èˆ¬ä»Žæ•°æ®åº“èŽ·å–ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿ç›´æŽ¥æ¨¡æ‹Ÿï¼‰ï¼š1234567891011121314151617public class MyUser implements Serializable &#123; private static final long serialVersionUID = 3497935890426858541L; private String userName; private String password; private boolean accountNonExpired = true; private boolean accountNonLocked= true; private boolean credentialsNonExpired= true; private boolean enabled= true; // get,setç•¥&#125;æŽ¥ç€åˆ›å»ºMyUserDetailServiceå®žçŽ°UserDetailServiceï¼š1234567891011121314151617181920@Configurationpublic class UserDetailService implements UserDetailsService &#123; @Autowired private PasswordEncoder passwordEncoder; @Override public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException &#123; // æ¨¡æ‹Ÿä¸€ä¸ªç”¨æˆ·ï¼Œæ›¿ä»£æ•°æ®åº“èŽ·å–é€»è¾‘ MyUser user = new MyUser(); user.setUserName(username); user.setPassword(this.passwordEncoder.encode("123456")); // è¾“å‡ºåŠ å¯†åŽçš„å¯†ç  System.out.println(user.getPassword()); return new User(username, user.getPassword(), user.isEnabled(), user.isAccountNonExpired(), user.isCredentialsNonExpired(), user.isAccountNonLocked(), AuthorityUtils.commaSeparatedStringToAuthorityList("admin")); &#125;&#125;è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†org.springframework.security.core.userdetails.Userç±»åŒ…å«7ä¸ªå‚æ•°çš„æž„é€ å™¨ï¼Œå…¶è¿˜åŒ…å«ä¸€ä¸ªä¸‰ä¸ªå‚æ•°çš„æž„é€ å™¨User(String username, String password,Collection&lt;? extends GrantedAuthority&gt; authorities)ï¼Œç”±äºŽæƒé™å‚æ•°ä¸èƒ½ä¸ºç©ºï¼Œæ‰€ä»¥è¿™é‡Œå…ˆä½¿ç”¨AuthorityUtils.commaSeparatedStringToAuthorityListæ–¹æ³•æ¨¡æ‹Ÿä¸€ä¸ªadminçš„æƒé™ï¼Œè¯¥æ–¹æ³•å¯ä»¥å°†é€—å·åˆ†éš”çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºæƒé™é›†åˆã€‚æ­¤å¤–æˆ‘ä»¬è¿˜æ³¨å…¥äº†PasswordEncoderå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ç”¨äºŽå¯†ç åŠ å¯†ï¼Œæ³¨å…¥å‰éœ€è¦æ‰‹åŠ¨é…ç½®ã€‚æˆ‘ä»¬åœ¨BrowserSecurityConfigä¸­é…ç½®å®ƒï¼š123456789@Configurationpublic class BrowserSecurityConfig extends WebSecurityConfigurerAdapter &#123; @Bean public PasswordEncoder passwordEncoder() &#123; return new BCryptPasswordEncoder(); &#125; ...&#125;PasswordEncoderæ˜¯ä¸€ä¸ªå¯†ç åŠ å¯†æŽ¥å£ï¼Œè€ŒBCryptPasswordEncoderæ˜¯Spring Securityæä¾›çš„ä¸€ä¸ªå®žçŽ°æ–¹æ³•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±å®žçŽ°PasswordEncoderã€‚ä¸è¿‡Spring Securityå®žçŽ°çš„BCryptPasswordEncoderå·²ç»è¶³å¤Ÿå¼ºå¤§ï¼Œå®ƒå¯¹ç›¸åŒçš„å¯†ç è¿›è¡ŒåŠ å¯†åŽå¯ä»¥ç”Ÿæˆä¸åŒçš„ç»“æžœã€‚è¿™æ—¶å€™é‡å¯é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/loginï¼Œä¾¿å¯ä»¥ä½¿ç”¨ä»»æ„ç”¨æˆ·åä»¥åŠ123456ä½œä¸ºå¯†ç ç™»å½•ç³»ç»Ÿã€‚æˆ‘ä»¬å¤šæ¬¡è¿›è¡Œç™»å½•æ“ä½œï¼Œå¯ä»¥çœ‹åˆ°æŽ§åˆ¶å°è¾“å‡ºçš„åŠ å¯†åŽçš„å¯†ç å¦‚ä¸‹ï¼šå¯ä»¥çœ‹åˆ°ï¼ŒBCryptPasswordEncoderå¯¹ç›¸åŒçš„å¯†ç ç”Ÿæˆçš„ç»“æžœæ¯æ¬¡éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚æ›¿æ¢é»˜è®¤ç™»å½•é¡µé»˜è®¤çš„ç™»å½•é¡µé¢è¿‡äºŽç®€é™‹ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šä¹‰ä¸€ä¸ªç™»å½•é¡µé¢ã€‚ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬ç›´æŽ¥åœ¨src/main/resources/resourcesç›®å½•ä¸‹å®šä¹‰ä¸€ä¸ªlogin.htmlï¼ˆä¸éœ€è¦Controllerè·³è½¬ï¼‰ï¼š123456789101112131415161718&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;ç™»å½•&lt;/title&gt; &lt;link rel="stylesheet" href="css/login.css" type="text/css"&gt;&lt;/head&gt;&lt;body&gt; &lt;form class="login-page" action="/login" method="post"&gt; &lt;div class="form"&gt; &lt;h3&gt;è´¦æˆ·ç™»å½•&lt;/h3&gt; &lt;input type="text" placeholder="ç”¨æˆ·å" name="username" required="required" /&gt; &lt;input type="password" placeholder="å¯†ç " name="password" required="required" /&gt; &lt;button type="submit"&gt;ç™»å½•&lt;/button&gt; &lt;/div&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;è¦æ€Žä¹ˆåšæ‰èƒ½è®©Spring Securityè·³è½¬åˆ°æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ç™»å½•é¡µé¢å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨BrowserSecurityConfigçš„configureä¸­æ·»åŠ ä¸€äº›é…ç½®ï¼š123456789101112@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.formLogin() // è¡¨å•ç™»å½• // http.httpBasic() // HTTP Basic .loginPage("/login.html") .loginProcessingUrl("/login") .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/login.html").permitAll() .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated(); // éƒ½éœ€è¦è®¤è¯&#125;ä¸Šé¢ä»£ç ä¸­.loginPage(&quot;/login.html&quot;)æŒ‡å®šäº†è·³è½¬åˆ°ç™»å½•é¡µé¢çš„è¯·æ±‚URLï¼Œ.loginProcessingUrl(&quot;/login&quot;)å¯¹åº”ç™»å½•é¡µé¢formè¡¨å•çš„action=&quot;/login&quot;ï¼Œ.antMatchers(&quot;/login.html&quot;).permitAll()è¡¨ç¤ºè·³è½¬åˆ°ç™»å½•é¡µé¢çš„è¯·æ±‚ä¸è¢«æ‹¦æˆªï¼Œå¦åˆ™ä¼šè¿›å…¥æ— é™å¾ªçŽ¯ã€‚è¿™æ—¶å€™å¯åŠ¨ç³»ç»Ÿï¼Œè®¿é—®http://localhost:8080/helloï¼Œä¼šçœ‹åˆ°é¡µé¢å·²ç»è¢«é‡å®šå‘åˆ°äº†http://localhost:8080/login.htmlï¼šè¾“å…¥ç”¨æˆ·åå’Œå¯†ç å‘çŽ°é¡µé¢æŠ¥é”™ï¼šæˆ‘ä»¬å…ˆæŠŠCSRFæ”»å‡»é˜²å¾¡å…³äº†ï¼Œä¿®æ”¹BrowserSecurityConfigçš„configureï¼š12345678910111213Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.formLogin() // è¡¨å•ç™»å½• // http.httpBasic() // HTTP Basic .loginPage("/login.html") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/login.html").permitAll() // ç™»å½•è·³è½¬ URL æ— éœ€è®¤è¯ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and().csrf().disable();&#125;é‡å¯é¡¹ç›®ä¾¿å¯æ­£å¸¸ç™»å½•ã€‚å‡å¦‚çŽ°åœ¨æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šåœ¨æœªç™»å½•çš„æƒ…å†µä¸‹ï¼Œå½“ç”¨æˆ·è®¿é—®htmlèµ„æºçš„æ—¶å€™è·³è½¬åˆ°ç™»å½•é¡µï¼Œå¦åˆ™è¿”å›žJSONæ ¼å¼æ•°æ®ï¼ŒçŠ¶æ€ç ä¸º401ã€‚è¦å®žçŽ°è¿™ä¸ªåŠŸèƒ½æˆ‘ä»¬å°†loginPageçš„URLæ”¹ä¸º/authentication/requireï¼Œå¹¶ä¸”åœ¨antMatchersæ–¹æ³•ä¸­åŠ å…¥è¯¥URLï¼Œè®©å…¶å…æ‹¦æˆª:12345678910111213@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; http.formLogin() // è¡¨å•ç™»å½• // http.httpBasic() // HTTP Basic .loginPage("/authentication/require") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/authentication/require", "/login.html").permitAll() // ç™»å½•è·³è½¬ URL æ— éœ€è®¤è¯ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and().csrf().disable();&#125;ç„¶åŽå®šä¹‰ä¸€ä¸ªæŽ§åˆ¶å™¨BrowserSecurityControllerï¼Œå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼š1234567891011121314151617@RestControllerpublic class BrowserSecurityController &#123; private RequestCache requestCache = new HttpSessionRequestCache(); private RedirectStrategy redirectStrategy = new DefaultRedirectStrategy(); @GetMapping("/authentication/require") @ResponseStatus(HttpStatus.UNAUTHORIZED) public String requireAuthentication(HttpServletRequest request, HttpServletResponse response) throws IOException &#123; SavedRequest savedRequest = requestCache.getRequest(request, response); if (savedRequest != null) &#123; String targetUrl = savedRequest.getRedirectUrl(); if (StringUtils.endsWithIgnoreCase(targetUrl, ".html")) redirectStrategy.sendRedirect(request, response, "/login.html"); &#125; return "è®¿é—®çš„èµ„æºéœ€è¦èº«ä»½è®¤è¯ï¼"; &#125;&#125;å…¶ä¸­HttpSessionRequestCacheä¸ºSpring Securityæä¾›çš„ç”¨äºŽç¼“å­˜è¯·æ±‚çš„å¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨å®ƒçš„getRequestæ–¹æ³•å¯ä»¥èŽ·å–åˆ°æœ¬æ¬¡è¯·æ±‚çš„HTTPä¿¡æ¯ã€‚DefaultRedirectStrategyçš„sendRedirectä¸ºSpring Securityæä¾›çš„ç”¨äºŽå¤„ç†é‡å®šå‘çš„æ–¹æ³•ã€‚ä¸Šé¢ä»£ç èŽ·å–äº†å¼•å‘è·³è½¬çš„è¯·æ±‚ï¼Œæ ¹æ®è¯·æ±‚æ˜¯å¦ä»¥.htmlä¸ºç»“å°¾æ¥å¯¹åº”ä¸åŒçš„å¤„ç†æ–¹æ³•ã€‚å¦‚æžœæ˜¯ä»¥.htmlç»“å°¾ï¼Œé‚£ä¹ˆé‡å®šå‘åˆ°ç™»å½•é¡µé¢ï¼Œå¦åˆ™è¿”å›žâ€è®¿é—®çš„èµ„æºéœ€è¦èº«ä»½è®¤è¯ï¼â€ä¿¡æ¯ï¼Œå¹¶ä¸”HTTPçŠ¶æ€ç ä¸º401ï¼ˆHttpStatus.UNAUTHORIZEDï¼‰ã€‚è¿™æ ·å½“æˆ‘ä»¬è®¿é—®http://localhost:8080/helloçš„æ—¶å€™é¡µé¢ä¾¿ä¼šè·³è½¬åˆ°http://localhost:8080/authentication/requireï¼Œå¹¶ä¸”è¾“å‡ºâ€è®¿é—®çš„èµ„æºéœ€è¦èº«ä»½è®¤è¯ï¼â€ï¼Œå½“æˆ‘ä»¬è®¿é—®http://localhost:8080/hello.htmlçš„æ—¶å€™ï¼Œé¡µé¢å°†ä¼šè·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚å¤„ç†æˆåŠŸå’Œå¤±è´¥Spring Securityæœ‰ä¸€å¥—é»˜è®¤çš„å¤„ç†ç™»å½•æˆåŠŸå’Œå¤±è´¥çš„æ–¹æ³•ï¼šå½“ç”¨æˆ·ç™»å½•æˆåŠŸæ—¶ï¼Œé¡µé¢ä¼šè·³è½¬ä¼šå¼•å‘ç™»å½•çš„è¯·æ±‚ï¼Œæ¯”å¦‚åœ¨æœªç™»å½•çš„æƒ…å†µä¸‹è®¿é—®http://localhost:8080/helloï¼Œé¡µé¢ä¼šè·³è½¬åˆ°ç™»å½•é¡µï¼Œç™»å½•æˆåŠŸåŽå†è·³è½¬å›žæ¥ï¼›ç™»å½•å¤±è´¥æ—¶åˆ™æ˜¯è·³è½¬åˆ°Spring Securityé»˜è®¤çš„é”™è¯¯æç¤ºé¡µé¢ã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€äº›è‡ªå®šä¹‰é…ç½®æ¥æ›¿æ¢è¿™å¥—é»˜è®¤çš„å¤„ç†æœºåˆ¶ã€‚è‡ªå®šä¹‰ç™»å½•æˆåŠŸé€»è¾‘è¦æ”¹å˜é»˜è®¤çš„å¤„ç†æˆåŠŸé€»è¾‘å¾ˆç®€å•ï¼Œåªéœ€è¦å®žçŽ°org.springframework.security.web.authentication.AuthenticationSuccessHandleræŽ¥å£çš„onAuthenticationSuccessæ–¹æ³•å³å¯ï¼š123456789@Componentpublic class MyAuthenticationSucessHandler implements AuthenticationSuccessHandler &#123; @Override public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException, ServletException &#123; response.setContentType("application/json;charset=utf-8"); response.getWriter().write(mapper.writeValueAsString(authentication)); &#125;&#125;å…¶ä¸­Authenticationå‚æ•°æ—¢åŒ…å«äº†è®¤è¯è¯·æ±‚çš„ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚IPï¼Œè¯·æ±‚çš„SessionIdç­‰ï¼Œä¹ŸåŒ…å«äº†ç”¨æˆ·ä¿¡æ¯ï¼Œå³å‰é¢æåˆ°çš„Userå¯¹è±¡ã€‚é€šè¿‡ä¸Šé¢è¿™ä¸ªé…ç½®ï¼Œç”¨æˆ·ç™»å½•æˆåŠŸåŽé¡µé¢å°†æ‰“å°å‡ºAuthenticationå¯¹è±¡çš„ä¿¡æ¯ã€‚è¦ä½¿è¿™ä¸ªé…ç½®ç”Ÿæ•ˆï¼Œæˆ‘ä»¬è¿˜çš„åœ¨BrowserSecurityConfigçš„configureä¸­é…ç½®å®ƒï¼š12345678910111213141516171819202122232425@Configurationpublic class BrowserSecurityConfig extends WebSecurityConfigurerAdapter &#123; @Autowired private MyAuthenticationSucessHandler authenticationSucessHandler; @Bean public PasswordEncoder passwordEncoder() &#123; return new BCryptPasswordEncoder(); &#125; @Override protected void configure(HttpSecurity http) throws Exception &#123; http.formLogin() // è¡¨å•ç™»å½• // http.httpBasic() // HTTP Basic .loginPage("/authentication/require") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .successHandler(authenticationSucessHandler) // å¤„ç†ç™»å½•æˆåŠŸ .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/authentication/require", "/login.html").permitAll() // ç™»å½•è·³è½¬ URL æ— éœ€è®¤è¯ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and().csrf().disable(); &#125;&#125;æˆ‘ä»¬å°†MyAuthenticationSucessHandleræ³¨å…¥è¿›æ¥ï¼Œå¹¶é€šè¿‡successHandleræ–¹æ³•è¿›è¡Œé…ç½®ã€‚è¿™æ—¶å€™é‡å¯é¡¹ç›®ç™»å½•åŽé¡µé¢å°†ä¼šè¾“å‡ºå¦‚ä¸‹JSONä¿¡æ¯ï¼š123456789101112131415161718192021222324252627&#123; "authorities": [ &#123; "authority": "admin" &#125; ], "details": &#123; "remoteAddress": "0:0:0:0:0:0:0:1", "sessionId": "8D50BAF811891F4397E21B4B537F0544" &#125;, "authenticated": true, "principal": &#123; "password": null, "username": "mrbird", "authorities": [ &#123; "authority": "admin" &#125; ], "accountNonExpired": true, "accountNonLocked": true, "credentialsNonExpired": true, "enabled": true &#125;, "credentials": null, "name": "mrbird"&#125;åƒpasswordï¼Œcredentialsè¿™äº›æ•æ„Ÿä¿¡æ¯ï¼ŒSpring Securityå·²ç»å°†å…¶å±è”½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ç™»å½•æˆåŠŸåŽåšé¡µé¢çš„è·³è½¬ï¼Œä¿®æ”¹MyAuthenticationSucessHandlerï¼š123456789101112131415@Componentpublic class MyAuthenticationSucessHandler implements AuthenticationSuccessHandler &#123; private RequestCache requestCache = new HttpSessionRequestCache(); private RedirectStrategy redirectStrategy = new DefaultRedirectStrategy(); @Autowired private ObjectMapper mapper; @Override public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException &#123; SavedRequest savedRequest = requestCache.getRequest(request, response); redirectStrategy.sendRedirect(request, response, savedRequest.getRedirectUrl()); &#125;&#125;é€šè¿‡ä¸Šé¢é…ç½®ï¼Œç™»å½•æˆåŠŸåŽé¡µé¢å°†è·³è½¬å›žå¼•å‘è·³è½¬çš„é¡µé¢ã€‚å¦‚æžœæƒ³æŒ‡å®šè·³è½¬çš„é¡µé¢ï¼Œæ¯”å¦‚è·³è½¬åˆ°/indexï¼Œå¯ä»¥å°†savedRequest.getRedirectUrl()ä¿®æ”¹ä¸º/indexï¼š12345678910@Componentpublic class MyAuthenticationSucessHandler implements AuthenticationSuccessHandler &#123; private RedirectStrategy redirectStrategy = new DefaultRedirectStrategy(); @Override public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException &#123; redirectStrategy.sendRedirect(request, response, "/index"); &#125;&#125;ç„¶åŽåœ¨TestControllerä¸­å®šä¹‰ä¸€ä¸ªå¤„ç†è¯¥è¯·æ±‚çš„æ–¹æ³•ï¼š1234567@RestControllerpublic class TestController &#123; @GetMapping("index") public Object index()&#123; return SecurityContextHolder.getContext().getAuthentication(); &#125;&#125;ç™»å½•æˆåŠŸåŽï¼Œä¾¿å¯ä»¥ä½¿ç”¨SecurityContextHolder.getContext().getAuthentication()èŽ·å–åˆ°Authenticationå¯¹è±¡ä¿¡æ¯ã€‚é™¤äº†é€šè¿‡è¿™ç§æ–¹å¼èŽ·å–Authenticationå¯¹è±¡ä¿¡æ¯å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ç§æ–¹å¼:1234567@RestControllerpublic class TestController &#123; @GetMapping("index") public Object index(Authentication authentication) &#123; return authentication; &#125;&#125;é‡å¯é¡¹ç›®ï¼Œç™»å½•æˆåŠŸåŽï¼Œé¡µé¢å°†è·³è½¬åˆ°http://localhost:8080/indexï¼šè‡ªå®šä¹‰ç™»å½•å¤±è´¥é€»è¾‘å’Œè‡ªå®šä¹‰ç™»å½•æˆåŠŸå¤„ç†é€»è¾‘ç±»ä¼¼ï¼Œè‡ªå®šä¹‰ç™»å½•å¤±è´¥å¤„ç†é€»è¾‘éœ€è¦å®žçŽ°org.springframework.security.web.authentication.AuthenticationFailureHandlerçš„onAuthenticationFailureæ–¹æ³•ï¼š1234567@Componentpublic class MyAuthenticationFailureHandler implements AuthenticationFailureHandler &#123; @Override public void onAuthenticationFailure(HttpServletRequest request, HttpServletResponse response, AuthenticationException exception) throws IOException &#123; &#125;&#125;onAuthenticationFailureæ–¹æ³•çš„AuthenticationExceptionå‚æ•°æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼ŒSpring Securityæ ¹æ®ç™»å½•å¤±è´¥çš„åŽŸå› å°è£…äº†è®¸å¤šå¯¹åº”çš„å®žçŽ°ç±»ï¼ŒæŸ¥çœ‹AuthenticationExceptionçš„Hierarchyï¼šä¸åŒçš„å¤±è´¥åŽŸå› å¯¹åº”ä¸åŒçš„å¼‚å¸¸ï¼Œæ¯”å¦‚ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯å¯¹åº”çš„æ˜¯BadCredentialsExceptionï¼Œç”¨æˆ·ä¸å­˜åœ¨å¯¹åº”çš„æ˜¯UsernameNotFoundExceptionï¼Œç”¨æˆ·è¢«é”å®šå¯¹åº”çš„æ˜¯LockedExceptionç­‰ã€‚å‡å¦‚æˆ‘ä»¬éœ€è¦åœ¨ç™»å½•å¤±è´¥çš„æ—¶å€™è¿”å›žå¤±è´¥ä¿¡æ¯ï¼Œå¯ä»¥è¿™æ ·å¤„ç†ï¼š1234567891011121314@Componentpublic class MyAuthenticationFailureHandler implements AuthenticationFailureHandler &#123; @Autowired private ObjectMapper mapper; @Override public void onAuthenticationFailure(HttpServletRequest request, HttpServletResponse response, AuthenticationException exception) throws IOException &#123; response.setStatus(HttpStatus.INTERNAL_SERVER_ERROR.value()); response.setContentType("application/json;charset=utf-8"); response.getWriter().write(mapper.writeValueAsString(exception.getMessage())); &#125;&#125;çŠ¶æ€ç å®šä¹‰ä¸º500ï¼ˆHttpStatus.INTERNAL_SERVER_ERROR.value()ï¼‰ï¼Œå³ç³»ç»Ÿå†…éƒ¨å¼‚å¸¸ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬éœ€è¦åœ¨BrowserSecurityConfigçš„configureä¸­é…ç½®å®ƒï¼š123456789101112131415161718192021222324@Configurationpublic class BrowserSecurityConfig extends WebSecurityConfigurerAdapter &#123; @Autowired private MyAuthenticationSucessHandler authenticationSucessHandler; @Autowired private MyAuthenticationFailureHandler authenticationFailureHandler; @Override protected void configure(HttpSecurity http) throws Exception &#123; http.formLogin() // è¡¨å•ç™»å½• // http.httpBasic() // HTTP Basic .loginPage("/authentication/require") // ç™»å½•è·³è½¬ URL .loginProcessingUrl("/login") // å¤„ç†è¡¨å•ç™»å½• URL .successHandler(authenticationSucessHandler) // å¤„ç†ç™»å½•æˆåŠŸ .failureHandler(authenticationFailureHandler) // å¤„ç†ç™»å½•å¤±è´¥ .and() .authorizeRequests() // æŽˆæƒé…ç½® .antMatchers("/authentication/require", "/login.html").permitAll() // ç™»å½•è·³è½¬ URL æ— éœ€è®¤è¯ .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated() // éƒ½éœ€è¦è®¤è¯ .and().csrf().disable(); &#125;&#125;é‡å¯é¡¹ç›®ï¼Œå½“è¾“å…¥é”™è¯¯çš„å¯†ç æ—¶ï¼Œé¡µé¢è¾“å‡ºå¦‚ä¸‹ï¼šæºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/SpringAll/tree/master/35.Spring-Security-Authentication]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootä¸­å¼€å¯Spring Security]]></title>
    <url>%2FSpring-Boot%26Spring-Security.html</url>
    <content type="text"><![CDATA[Spring Securityæ˜¯ä¸€æ¬¾åŸºäºŽSpringçš„å®‰å…¨æ¡†æž¶ï¼Œä¸»è¦åŒ…å«è®¤è¯å’ŒæŽˆæƒä¸¤å¤§å®‰å…¨æ¨¡å—ï¼Œå’Œå¦å¤–ä¸€æ¬¾æµè¡Œçš„å®‰å…¨æ¡†æž¶Apache Shiroç›¸æ¯”ï¼Œå®ƒæ‹¥æœ‰æ›´ä¸ºå¼ºå¤§çš„åŠŸèƒ½ã€‚Spring Securityä¹Ÿå¯ä»¥è½»æ¾çš„è‡ªå®šä¹‰æ‰©å±•ä»¥æ»¡è¶³å„ç§éœ€æ±‚ï¼Œå¹¶ä¸”å¯¹å¸¸è§çš„Webå®‰å…¨æ”»å‡»æä¾›äº†é˜²æŠ¤æ”¯æŒã€‚å¦‚æžœä½ çš„Webæ¡†æž¶é€‰æ‹©çš„æ˜¯Springï¼Œé‚£ä¹ˆåœ¨å®‰å…¨æ–¹é¢Spring Securityä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Spring Bootæ¥é›†æˆSpring Securityï¼ŒSpring Bootç‰ˆæœ¬ä¸º1.5.14.RELEASEï¼ŒSpring Securityç‰ˆæœ¬ä¸º4.2.7RELEASEã€‚å¼€å¯Spring Securityåˆ›å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç„¶åŽå¼•å…¥spring-boot-starter-securityï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt;æŽ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªTestControllerï¼Œå¯¹å¤–æä¾›ä¸€ä¸ª/helloæœåŠ¡ï¼š1234567@RestControllerpublic class TestController &#123; @GetMapping("hello") public String hello() &#123; return "hello spring security"; &#125;&#125;è¿™æ—¶å€™æˆ‘ä»¬ç›´æŽ¥å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/helloï¼Œå¯çœ‹åˆ°é¡µé¢å¼¹å‡ºäº†ä¸ªHTTP Basicè®¤è¯æ¡†ï¼šå½“Springé¡¹ç›®ä¸­å¼•å…¥äº†Spring Securityä¾èµ–çš„æ—¶å€™ï¼Œé¡¹ç›®ä¼šé»˜è®¤å¼€å¯å¦‚ä¸‹é…ç½®ï¼š123security: basic: enabled: trueè¿™ä¸ªé…ç½®å¼€å¯äº†ä¸€ä¸ªHTTP basicç±»åž‹çš„è®¤è¯ï¼Œæ‰€æœ‰æœåŠ¡çš„è®¿é—®éƒ½å¿…é¡»å…ˆè¿‡è¿™ä¸ªè®¤è¯ï¼Œé»˜è®¤çš„ç”¨æˆ·åä¸ºuserï¼Œå¯†ç ç”±Sping Securityè‡ªåŠ¨ç”Ÿæˆï¼Œå›žåˆ°IDEçš„æŽ§åˆ¶å°ï¼Œå¯ä»¥æ‰¾åˆ°å¯†ç ä¿¡æ¯ï¼š1Using default security password: e9ed391c-93de-4611-ac87-d871d9e749acè¾“å…¥ç”¨æˆ·åuserï¼Œå¯†ç e9ed391c-93de-4611-ac87-d871d9e749acåŽï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥æˆåŠŸè®¿é—®/helloæŽ¥å£ã€‚åŸºäºŽè¡¨å•è®¤è¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›é…ç½®å°†HTTP Basicè®¤è¯ä¿®æ”¹ä¸ºåŸºäºŽè¡¨å•çš„è®¤è¯æ–¹å¼ã€‚åˆ›å»ºä¸€ä¸ªé…ç½®ç±»BrowserSecurityConfigç»§æ‰¿org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapterè¿™ä¸ªæŠ½è±¡ç±»å¹¶é‡å†™configure(HttpSecurity http)æ–¹æ³•ã€‚WebSecurityConfigurerAdapteræ˜¯ç”±Spring Securityæä¾›çš„Webåº”ç”¨å®‰å…¨é…ç½®çš„é€‚é…å™¨ï¼š1234567891011@Configurationpublic class BrowserSecurityConfig extends WebSecurityConfigurerAdapter &#123; @Override protected void configure(HttpSecurity http) throws Exception &#123; http.formLogin() // è¡¨å•æ–¹å¼ .and() .authorizeRequests() // æŽˆæƒé…ç½® .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated(); // éƒ½éœ€è¦è®¤è¯ &#125;&#125;Spring Securityæä¾›äº†è¿™ç§é“¾å¼çš„æ–¹æ³•è°ƒç”¨ã€‚ä¸Šé¢é…ç½®æŒ‡å®šäº†è®¤è¯æ–¹å¼ä¸ºè¡¨å•ç™»å½•ï¼Œå¹¶ä¸”æ‰€æœ‰è¯·æ±‚éƒ½éœ€è¦è¿›è¡Œè®¤è¯ã€‚è¿™æ—¶å€™æˆ‘ä»¬é‡å¯é¡¹ç›®ï¼Œå†æ¬¡è®¿é—®http://localhost:8080/helloï¼Œå¯ä»¥çœ‹åˆ°è®¤è¯æ–¹å¼å·²ç»æ˜¯formè¡¨å•çš„æ–¹å¼äº†ï¼šç”¨æˆ·åä¾æ—§æ˜¯userï¼Œå¯†ç ç”±Spring Securityè‡ªåŠ¨ç”Ÿæˆã€‚å½“è¾“å…¥å‡­è¯é”™è¯¯æ—¶ï¼Œé¡µé¢ä¸Šå°†æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼šå¦‚æžœéœ€è¦æ¢å›žHTTP Basicçš„è®¤è¯æ–¹å¼ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•ä¿®æ”¹configureæ–¹æ³•ä¸­çš„é…ç½®ï¼š123456789@Overrideprotected void configure(HttpSecurity http) throws Exception &#123; // http.formLogin() // è¡¨å•æ–¹å¼ http.httpBasic() // HTTP Basicæ–¹å¼ .and() .authorizeRequests() // æŽˆæƒé…ç½® .anyRequest() // æ‰€æœ‰è¯·æ±‚ .authenticated(); // éƒ½éœ€è¦è®¤è¯&#125;åŸºæœ¬åŽŸç†ä¸Šé¢æˆ‘ä»¬å¼€å¯äº†ä¸€ä¸ªæœ€ç®€å•çš„Spring Securityå®‰å…¨é…ç½®ï¼Œä¸‹é¢æˆ‘ä»¬æ¥äº†è§£ä¸‹Spring Securityçš„åŸºæœ¬åŽŸç†ã€‚é€šè¿‡ä¸Šé¢çš„çš„é…ç½®ï¼Œä»£ç çš„æ‰§è¡Œè¿‡ç¨‹å¯ä»¥ç®€åŒ–ä¸ºä¸‹å›¾è¡¨ç¤ºï¼šå¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒSpring SecurityåŒ…å«äº†ä¼—å¤šçš„è¿‡æ»¤å™¨ï¼Œè¿™äº›è¿‡æ»¤å™¨å½¢æˆäº†ä¸€æ¡é“¾ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¿…é¡»é€šè¿‡è¿™äº›è¿‡æ»¤å™¨åŽæ‰èƒ½æˆåŠŸè®¿é—®åˆ°èµ„æºã€‚å…¶ä¸­UsernamePasswordAuthenticationFilterè¿‡æ»¤å™¨ç”¨äºŽå¤„ç†åŸºäºŽè¡¨å•æ–¹å¼çš„ç™»å½•è®¤è¯ï¼Œè€ŒBasicAuthenticationFilterç”¨äºŽå¤„ç†åŸºäºŽHTTP Basicæ–¹å¼çš„ç™»å½•éªŒè¯ï¼ŒåŽé¢è¿˜å¯èƒ½åŒ…å«ä¸€ç³»åˆ—åˆ«çš„è¿‡æ»¤å™¨ï¼ˆå¯ä»¥é€šè¿‡ç›¸åº”é…ç½®å¼€å¯ï¼‰ã€‚åœ¨è¿‡æ»¤å™¨é“¾çš„æœ«å°¾æ˜¯ä¸€ä¸ªåä¸ºFilterSecurityInterceptorçš„æ‹¦æˆªå™¨ï¼Œç”¨äºŽåˆ¤æ–­å½“å‰è¯·æ±‚èº«ä»½è®¤è¯æ˜¯å¦æˆåŠŸï¼Œæ˜¯å¦æœ‰ç›¸åº”çš„æƒé™ï¼Œå½“èº«ä»½è®¤è¯å¤±è´¥æˆ–è€…æƒé™ä¸è¶³çš„æ—¶å€™ä¾¿ä¼šæŠ›å‡ºç›¸åº”çš„å¼‚å¸¸ã€‚ExceptionTranslateFilteræ•èŽ·å¹¶å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ExceptionTranslateFilterè¿‡æ»¤å™¨ç”¨äºŽå¤„ç†äº†FilterSecurityInterceptoræŠ›å‡ºçš„å¼‚å¸¸å¹¶è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚éœ€è¦èº«ä»½è®¤è¯æ—¶å°†è¯·æ±‚é‡å®šå‘åˆ°ç›¸åº”çš„è®¤è¯é¡µé¢ï¼Œå½“è®¤è¯å¤±è´¥æˆ–è€…æƒé™ä¸è¶³æ—¶è¿”å›žç›¸åº”çš„æç¤ºä¿¡æ¯ã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡debugæ¥éªŒè¯è¿™ä¸ªè¿‡ç¨‹ï¼ˆç™»å½•æ–¹å¼æ”¹å›žè¡¨å•çš„æ–¹å¼ï¼‰ã€‚æˆ‘ä»¬åœ¨/helloæœåŠ¡ä¸Šæ‰“ä¸ªæ–­ç‚¹ï¼šåœ¨FilterSecurityInterceptorçš„invokeæ–¹æ³•çš„super.beforeInvocationä¸Šæ‰“ä¸ªæ–­ç‚¹ï¼šå½“è¿™è¡Œä»£ç æ‰§è¡Œé€šè¿‡åŽï¼Œä¾¿å¯ä»¥è°ƒç”¨ä¸‹ä¸€è¡Œçš„doFilteræ–¹æ³•æ¥çœŸæ­£è°ƒç”¨/helloæœåŠ¡ï¼Œå¦åˆ™å°†æŠ›å‡ºç›¸åº”çš„å¼‚å¸¸ã€‚å½“FilterSecurityInterceptoræŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œå¼‚å¸¸å°†ç”±ExceptionTranslateFilteræ•èŽ·å¹¶å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ExceptionTranslateFilterçš„doFilteræ–¹æ³•catchä»£ç å—ç¬¬ä¸€è¡Œæ‰“ä¸ªæ–­ç‚¹ï¼šæˆ‘ä»¬å¾…ä¼šæ¨¡æ‹Ÿçš„æ˜¯ç”¨æˆ·æœªç™»å½•ç›´æŽ¥è®¿é—®/helloï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æŠ›å‡ºç”¨æˆ·æœªè®¤è¯çš„å¼‚å¸¸ï¼Œæ‰€ä»¥æŽ¥ä¸‹æ¥åº”è¯¥è·³è½¬åˆ°UsernamePasswordAuthenticationFilterå¤„ç†è¡¨å•æ–¹å¼çš„ç”¨æˆ·è®¤è¯ã€‚åœ¨UsernamePasswordAuthenticationFilterçš„attemptAuthenticationæ–¹æ³•ä¸Šæ‰“ä¸ªæ–­ç‚¹ï¼šå‡†å¤‡å®Œæ¯•åŽï¼Œæˆ‘ä»¬å¯åŠ¨é¡¹ç›®ï¼Œç„¶åŽè®¿é—®http://localhost:8080/helloï¼Œä»£ç ç›´æŽ¥è·³è½¬åˆ°FilterSecurityInteceptorçš„æ–­ç‚¹ä¸Šï¼šå¾€ä¸‹æ‰§è¡Œï¼Œå› ä¸ºå½“å‰è¯·æ±‚æ²¡æœ‰ç»è¿‡èº«ä»½è®¤è¯ï¼Œæ‰€ä»¥å°†æŠ›å‡ºå¼‚å¸¸å¹¶è¢«ExceptionTranslateFilteræ•èŽ·ï¼šæ•èŽ·å¼‚å¸¸åŽé‡å®šå‘åˆ°ç™»å½•è¡¨å•ç™»å½•é¡µé¢ï¼Œå½“æˆ‘ä»¬åœ¨è¡¨å•ç™»å½•é¡µé¢è¾“å…¥ä¿¡æ¯ç‚¹loginåŽï¼Œä»£ç è·³è½¬åˆ°UsernamePasswordAuthenticationFilterè¿‡æ»¤å™¨çš„attemptAuthenticationæ–¹æ³•ä¸Šï¼šåˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®ä¹‹åŽï¼Œä»£ç åˆè·³å›žFilterSecurityInterceptorçš„beforeInvocationæ–¹æ³•æ‰§è¡Œä¸Šï¼šå½“è®¤è¯é€šè¿‡æ—¶ï¼ŒFilterSecurityInterceptorä»£ç å¾€ä¸‹æ‰§è¡ŒdoFilterï¼Œç„¶åŽä»£ç æœ€ç»ˆè·³è½¬åˆ°/helloä¸Šï¼šæµè§ˆå™¨é¡µé¢å°†æ˜¾ç¤ºhello spring securityä¿¡æ¯ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/34.Start-Spring-Security]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Security</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootä¸­ä½¿ç”¨è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨]]></title>
    <url>%2FSpring-Boot-Filter-Interceptor.html</url>
    <content type="text"><![CDATA[è¿‡æ»¤å™¨ï¼ˆFilterï¼‰å’Œæ‹¦æˆªå™¨ï¼ˆInterceptorï¼‰æ˜¯Webé¡¹ç›®ä¸­å¸¸ç”¨çš„ä¸¤ä¸ªåŠŸèƒ½ï¼Œæœ¬æ–‡å°†ç®€å•ä»‹ç»åœ¨Spring Bootä¸­ä½¿ç”¨è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨æ¥è®¡ç®—Controllerä¸­æ–¹æ³•çš„æ‰§è¡Œæ—¶é•¿ï¼Œå¹¶ä¸”ç®€å•å¯¹æ¯”ä¸¤è€…çš„åŒºåˆ«ã€‚çŽ°æœ‰å¦‚ä¸‹Controllerï¼š123456789@RestController@RequestMapping("user")public class UserController &#123; @GetMapping("/&#123;id:\\d+&#125;") public void get(@PathVariable String id) &#123; System.out.println(id); &#125;&#125;ä¸‹é¢é€šè¿‡é…ç½®è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨æ¥å®žçŽ°å¯¹getæ–¹æ³•æ‰§è¡Œæ—¶é—´è®¡ç®—çš„åŠŸèƒ½ã€‚è¿‡æ»¤å™¨å®šä¹‰ä¸€ä¸ªTimeFilterç±»ï¼Œå®žçŽ°javax.servlet.Filterï¼š1234567891011121314151617181920public class TimeFilter implements Filter&#123; @Override public void init(FilterConfig filterConfig) throws ServletException &#123; System.out.println("è¿‡æ»¤å™¨åˆå§‹åŒ–"); &#125; @Override public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123; System.out.println("å¼€å§‹æ‰§è¡Œè¿‡æ»¤å™¨"); Long start = new Date().getTime(); filterChain.doFilter(servletRequest, servletResponse); System.out.println("ã€è¿‡æ»¤å™¨ã€‘è€—æ—¶ " + (new Date().getTime() - start)); System.out.println("ç»“æŸæ‰§è¡Œè¿‡æ»¤å™¨"); &#125; @Override public void destroy() &#123; System.out.println("è¿‡æ»¤å™¨é”€æ¯"); &#125;&#125;TimeFilteré‡å†™äº†Filterçš„ä¸‰ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•åç§°å·²ç»å¾ˆç›´ç™½çš„æè¿°äº†å…¶ä½œç”¨ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚è¦ä½¿è¯¥è¿‡æ»¤å™¨åœ¨Spring Bootä¸­ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦ä¸€äº›é…ç½®ã€‚è¿™é‡Œä¸»è¦æœ‰ä¸¤ç§é…ç½®æ–¹å¼ã€‚é…ç½®æ–¹å¼ä¸€å¯é€šè¿‡åœ¨TimeFilterä¸ŠåŠ ä¸Šå¦‚ä¸‹æ³¨è§£ï¼š12345@Component@WebFilter(urlPatterns = &#123;"/*"&#125;)public class TimeFilter implements Filter &#123; ...&#125;@Componentæ³¨è§£è®©TimeFilteræˆä¸ºSpringä¸Šä¸‹æ–‡ä¸­çš„ä¸€ä¸ªBeanï¼Œ@WebFilteræ³¨è§£çš„urlPatternså±žæ€§é…ç½®äº†å“ªäº›è¯·æ±‚å¯ä»¥è¿›å…¥è¯¥è¿‡æ»¤å™¨ï¼Œ/*è¡¨ç¤ºæ‰€æœ‰è¯·æ±‚ã€‚å¯åŠ¨é¡¹ç›®æ—¶å¯ä»¥çœ‹åˆ°æŽ§åˆ¶å°è¾“å‡ºäº†è¿‡æ»¤å™¨åˆå§‹åŒ–ï¼Œå¯åŠ¨åŽè®¿é—®http://localhost:8080/user/1ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š1234å¼€å§‹æ‰§è¡Œè¿‡æ»¤å™¨1ã€è¿‡æ»¤å™¨ã€‘è€—æ—¶ 31ç»“æŸæ‰§è¡Œè¿‡æ»¤å™¨é…ç½®æ–¹å¼äºŒé™¤äº†åœ¨è¿‡æ»¤å™¨ç±»ä¸ŠåŠ æ³¨è§£å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡FilterRegistrationBeanæ¥æ³¨å†Œè¿‡æ»¤å™¨ã€‚å®šä¹‰ä¸€ä¸ªWebConfigç±»ï¼ŒåŠ ä¸Š@Configurationæ³¨è§£è¡¨æ˜Žå…¶ä¸ºé…ç½®ç±»ï¼Œç„¶åŽé€šè¿‡FilterRegistrationBeanæ¥æ³¨å†Œè¿‡æ»¤å™¨:123456789101112131415@Configurationpublic class WebConfig &#123; @Bean public FilterRegistrationBean timeFilter() &#123; FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean(); TimeFilter timeFilter = new TimeFilter(); filterRegistrationBean.setFilter(timeFilter); List&lt;String&gt; urlList = new ArrayList&lt;&gt;(); urlList.add("/*"); filterRegistrationBean.setUrlPatterns(urlList); return filterRegistrationBean; &#125;&#125;FilterRegistrationBeané™¤äº†æ³¨å†Œè¿‡æ»¤å™¨TimeFilterå¤–è¿˜é€šè¿‡setUrlPatternsæ–¹æ³•é…ç½®äº†URLåŒ¹é…è§„åˆ™ã€‚é‡å¯é¡¹ç›®è®¿é—®http://localhost:8080/user/1ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å’Œä¸Šé¢ä¸€æ ·çš„æ•ˆæžœã€‚é€šè¿‡è¿‡æ»¤å™¨æˆ‘ä»¬åªå¯ä»¥èŽ·å–åˆ°servletRequestå¯¹è±¡ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½èŽ·å–åˆ°æ–¹æ³•çš„åç§°ï¼Œæ‰€å±žç±»ï¼Œå‚æ•°ç­‰é¢å¤–çš„ä¿¡æ¯ã€‚æ‹¦æˆªå™¨å®šä¹‰ä¸€ä¸ªTimeInterceptorç±»ï¼Œå®žçŽ°org.springframework.web.servlet.HandlerInterceptoræŽ¥å£:12345678910111213141516171819202122232425public class TimeInterceptor implements HandlerInterceptor &#123; @Override public boolean preHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o) throws Exception &#123; System.out.println("å¤„ç†æ‹¦æˆªä¹‹å‰"); httpServletRequest.setAttribute("startTime", new Date().getTime()); System.out.println(((HandlerMethod) o).getBean().getClass().getName()); System.out.println(((HandlerMethod) o).getMethod().getName()); return true; &#125; @Override public void postHandle(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, ModelAndView modelAndView) throws Exception &#123; System.out.println("å¼€å§‹å¤„ç†æ‹¦æˆª"); Long start = (Long) httpServletRequest.getAttribute("startTime"); System.out.println("ã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ " + (new Date().getTime() - start)); &#125; @Override public void afterCompletion(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Object o, Exception e) throws Exception &#123; System.out.println("å¤„ç†æ‹¦æˆªä¹‹åŽ"); Long start = (Long) httpServletRequest.getAttribute("startTime"); System.out.println("ã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ " + (new Date().getTime() - start)); System.out.println("å¼‚å¸¸ä¿¡æ¯ " + e); &#125;&#125;TimeInterceptorå®žçŽ°äº†HandlerInterceptoræŽ¥å£çš„ä¸‰ä¸ªæ–¹æ³•ã€‚preHandleæ–¹æ³•åœ¨å¤„ç†æ‹¦æˆªä¹‹å‰æ‰§è¡Œï¼ŒpostHandleåªæœ‰å½“è¢«æ‹¦æˆªçš„æ–¹æ³•æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸æˆåŠŸæ—¶æ‰ä¼šå¤„ç†ï¼ŒafterCompletionæ–¹æ³•æ— è®ºè¢«æ‹¦æˆªçš„æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ä¸Žå¦éƒ½ä¼šæ‰§è¡Œã€‚é€šè¿‡è¿™ä¸‰ä¸ªæ–¹æ³•çš„å‚æ•°å¯ä»¥çœ‹åˆ°ï¼Œç›¸è¾ƒäºŽè¿‡æ»¤å™¨ï¼Œæ‹¦æˆªå™¨å¤šäº†Objectå’ŒExceptionå¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥èŽ·å–çš„ä¿¡æ¯æ¯”è¿‡æ»¤å™¨è¦å¤šçš„å¤šã€‚ä½†è¿‡æ»¤å™¨ä»æ— æ³•èŽ·å–åˆ°æ–¹æ³•çš„å‚æ•°ç­‰ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ‡é¢ç¼–ç¨‹æ¥å®žçŽ°è¿™ä¸ªç›®çš„ï¼Œå…·ä½“å¯å‚è€ƒhttps://mrbird.cc/Spring-Boot-AOP%20log.htmlã€‚è¦ä½¿æ‹¦æˆªå™¨åœ¨Spring Bootä¸­ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦å¦‚ä¸‹ä¸¤æ­¥é…ç½®ï¼š1.åœ¨æ‹¦æˆªå™¨ç±»ä¸ŠåŠ å…¥@Componentæ³¨è§£ï¼›2.åœ¨WebConfigä¸­é€šè¿‡InterceptorRegistryæ³¨å†Œè¿‡æ»¤å™¨:12345678910@Configurationpublic class WebConfig extends WebMvcConfigurerAdapter &#123; @Autowired private TimeInterceptor timeInterceptor; @Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(timeInterceptor); &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/user/1ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š123456789å¤„ç†æ‹¦æˆªä¹‹å‰cc.mrbird.controller.UserControllerget1å¼€å§‹å¤„ç†æ‹¦æˆªã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ 24å¤„ç†æ‹¦æˆªä¹‹åŽã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ 24å¼‚å¸¸ä¿¡æ¯ nullä»Žè¾“å‡ºä¸­æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ä¸‰ä¸ªæ–¹æ³•çš„æ‰§è¡Œé¡ºåºï¼Œå¹¶ä¸”ä¸‰ä¸ªæ–¹æ³•éƒ½è¢«æ‰§è¡Œäº†ã€‚æˆ‘ä»¬åœ¨UserControllerçš„getæ–¹æ³•ä¸­æ‰‹åŠ¨æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼š12345 @GetMapping("/&#123;id:\\d+&#125;")public void get(@PathVariable String id) &#123; System.out.println(id); throw new RuntimeException("user not exist");&#125;é‡å¯é¡¹ç›®åŽï¼Œè®¿é—®http://localhost:8080/user/1ï¼ŒæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š1234567å¤„ç†æ‹¦æˆªä¹‹å‰cc.mrbird.controller.UserControllerget1å¤„ç†æ‹¦æˆªä¹‹åŽã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ 0å¼‚å¸¸ä¿¡æ¯ java.lang.RuntimeException: user not existå¯çœ‹åˆ°ï¼ŒpostHandleæ–¹æ³•å¹¶æ²¡æœ‰è¢«æ‰§è¡Œã€‚æ‰§è¡Œæ—¶æœºå¯¹æ¯”æˆ‘ä»¬å°†è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨éƒ½é…ç½®ä¸Šï¼Œç„¶åŽå¯åŠ¨é¡¹ç›®è®¿é—®http://localhost:8080/user/1ï¼š123456789101112å¼€å§‹æ‰§è¡Œè¿‡æ»¤å™¨å¤„ç†æ‹¦æˆªä¹‹å‰cc.mrbird.controller.UserControllerget1å¼€å§‹å¤„ç†æ‹¦æˆªã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ 25å¤„ç†æ‹¦æˆªä¹‹åŽã€æ‹¦æˆªå™¨ã€‘è€—æ—¶ 25å¼‚å¸¸ä¿¡æ¯ nullã€è¿‡æ»¤å™¨ã€‘è€—æ—¶ 34ç»“æŸæ‰§è¡Œè¿‡æ»¤å™¨å¯çœ‹åˆ°è¿‡æ»¤å™¨è¦å…ˆäºŽæ‹¦æˆªå™¨æ‰§è¡Œï¼Œæ™šäºŽæ‹¦æˆªå™¨ç»“æŸã€‚ä¸‹å›¾å¾ˆå¥½çš„æè¿°äº†å®ƒä»¬çš„æ‰§è¡Œæ—¶é—´åŒºåˆ«ï¼šæºç é“¾æŽ¥https://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/26.Spring-Boot-Filter-Interceptor]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootå¼‚å¸¸å¤„ç†]]></title>
    <url>%2FSpring-Boot-Exception.html</url>
    <content type="text"><![CDATA[Spring Bootå¯¹å¼‚å¸¸çš„å¤„ç†æœ‰ä¸€å¥—é»˜è®¤çš„æœºåˆ¶ï¼šå½“åº”ç”¨ä¸­äº§ç”Ÿå¼‚å¸¸æ—¶ï¼ŒSpring Bootæ ¹æ®å‘é€è¯·æ±‚å¤´ä¸­çš„acceptæ˜¯å¦åŒ…å«text/htmlæ¥åˆ†åˆ«è¿”å›žä¸åŒçš„å“åº”ä¿¡æ¯ã€‚å½“ä»Žæµè§ˆå™¨åœ°å€æ ä¸­è®¿é—®åº”ç”¨æŽ¥å£æ—¶ï¼Œè¯·æ±‚å¤´ä¸­çš„acceptä¾¿ä¼šåŒ…å«text/htmlä¿¡æ¯ï¼Œäº§ç”Ÿå¼‚å¸¸æ—¶ï¼ŒSpring Booté€šè¿‡org.springframework.web.servlet.ModelAndViewå¯¹è±¡æ¥è£…è½½å¼‚å¸¸ä¿¡æ¯ï¼Œå¹¶ä»¥HTMLçš„æ ¼å¼è¿”å›žï¼›è€Œå½“ä»Žå®¢æˆ·ç«¯è®¿é—®åº”ç”¨æŽ¥å£äº§ç”Ÿå¼‚å¸¸æ—¶ï¼ˆå®¢æˆ·ç«¯è®¿é—®æ—¶ï¼Œè¯·æ±‚å¤´ä¸­çš„acceptä¸åŒ…å«text/htmlï¼‰ï¼ŒSpring Bootåˆ™ä»¥JSONçš„æ ¼å¼è¿”å›žå¼‚å¸¸ä¿¡æ¯ã€‚ä¸‹é¢æ¥éªŒè¯ä¸€ä¸‹ã€‚é»˜è®¤å¼‚å¸¸å¤„ç†æœºåˆ¶å‡è®¾åº”ç”¨ä¸­æœ‰å¦‚ä¸‹ä¸€ä¸ªControllerï¼š123456789@RestController@RequestMapping("user")public class UserController &#123; @GetMapping("/&#123;id:\\d+&#125;") public void get(@PathVariable String id) &#123; throw new RuntimeException("user not exist"); &#125;&#125;åœ¨ä»£ç ä¸­æˆ‘ä»¬ä¸»åŠ¨çš„æŠ›å‡ºäº†ä¸€ä¸ªRuntimeExceptionï¼Œä½¿ç”¨æµè§ˆå™¨è®¿é—®http://localhost:8080/user/1ï¼š å¯çœ‹åˆ°é¡µé¢è¿”å›žäº†ä¸€äº›å¼‚å¸¸æè¿°ï¼Œå¹¶ä¸”è¯·æ±‚å¤´çš„accpetåŒ…å«äº†text/htmlç‰‡æ®µã€‚æŽ¥ç€ä½¿ç”¨æ¨¡æ‹Ÿå‘é€RESTè¯·æ±‚çš„Chromeæ’ä»¶Restlet Clientå‘é€http://localhost:8080/user/1ï¼šå¯ä»¥çœ‹åˆ°è¯·æ±‚å¤´çš„acceptå€¼ä¸º*/*ï¼Œå¹¶ä¸”è¿”å›žä¸€æ®µJSONæ ¼å¼çš„ä¿¡æ¯ã€‚æŸ¥çœ‹Spring Bootçš„BasicErrorControllerç±»ä¾¿å¯çœ‹åˆ°è¿™ä¸€é»˜è®¤æœºåˆ¶çš„å…·ä½“å®žçŽ°ï¼šå¯çœ‹åˆ°errorHtmlå’Œerroræ–¹æ³•çš„è¯·æ±‚åœ°å€å’Œæ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯errorHtmlé€šè¿‡produces = {&quot;text/html&quot;}åˆ¤æ–­è¯·æ±‚å¤´çš„accpetå±žæ€§ä¸­æ˜¯å¦åŒ…å«text/htmlï¼Œå¦‚æžœåŒ…å«ï¼Œä¾¿èµ°è¯¥æ–¹æ³•ã€‚è‡ªå®šä¹‰htmlå¼‚å¸¸é¡µé¢æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨src/main/resources/resources/errorè·¯å¾„ä¸‹å®šä¹‰å‹å¥½çš„å¼‚å¸¸é¡µé¢ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ª500.htmlé¡µé¢ï¼š12345678910&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;500&lt;/title&gt;&lt;/head&gt;&lt;body&gt; ç³»ç»Ÿå†…éƒ¨å¼‚å¸¸&lt;/body&gt;&lt;/html&gt;ç„¶åŽå†æ¬¡é€šè¿‡æµè§ˆå™¨è®¿é—®:http://localhost:8080/user/1ï¼šåŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰404.htmlç­‰å¸¸è§çš„HTTPçŠ¶æ€ç å¯¹åº”çš„å¼‚å¸¸é¡µé¢ã€‚é€šè¿‡è‡ªå®šä¹‰htmlå¼‚å¸¸é¡µé¢å¹¶ä¸ä¼šå½±å“å®¢æˆ·ç«¯å‘é€è¯·æ±‚å¼‚å¸¸è¿”å›žçš„ç»“æžœã€‚è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†é™¤äº†å¯ä»¥é€šè¿‡è‡ªå®šä¹‰htmlå¼‚å¸¸é¡µé¢æ¥æ”¹å˜æµè§ˆå™¨è®¿é—®æŽ¥å£æ—¶äº§ç”Ÿçš„å¼‚å¸¸ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†æ¥æ”¹è¡¨é»˜è®¤çš„å®¢æˆ·ç«¯è®¿é—®æŽ¥å£äº§ç”Ÿçš„å¼‚å¸¸ä¿¡æ¯ã€‚æˆ‘ä»¬æ‰‹åŠ¨å®šä¹‰ä¸€ä¸ªUserNotExistExceptionï¼Œç»§æ‰¿RuntimeExceptionã€‚12345678910111213141516171819public class UserNotExistException extends RuntimeException&#123; private static final long serialVersionUID = -1574716826948451793L; private String id; public UserNotExistException(String id)&#123; super("user not exist"); this.id = id; &#125; public String getId() &#123; return id; &#125; public void setId(String id) &#123; this.id = id; &#125;&#125;ç„¶åŽå®šä¹‰ä¸€ä¸ªControllerå¼‚å¸¸å¤„ç†ç±»ControllerExceptionHandlerï¼š12345678910111213@ControllerAdvicepublic class ControllerExceptionHandler &#123; @ExceptionHandler(UserNotExistException.class) @ResponseBody @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR) public Map&lt;String, Object&gt; handleUserNotExistsException(UserNotExistException e) &#123; Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put("id", e.getId()); map.put("message", e.getMessage()); return map; &#125;&#125;å…¶ä¸­æ³¨è§£@ExceptionHandleræŒ‡å®šäº†è¦å¤„ç†çš„å¼‚å¸¸ç±»åž‹ï¼Œæ³¨è§£@ResponseStatusæŒ‡å®šå¼‚å¸¸å¤„ç†æ–¹æ³•è¿”å›žçš„HTTPçŠ¶æ€ç ä¸ºHttpStatus.INTERNAL_SERVER_ERRORï¼Œå³500ã€‚HttpStatusæ˜¯ä¸€ä¸ªspringè‡ªå¸¦çš„æžšä¸¾ç±»åž‹ï¼Œå°è£…äº†å¸¸è§çš„HTTPçŠ¶æ€ç åŠæè¿°ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485public enum HttpStatus &#123; CONTINUE(100, "Continue"), SWITCHING_PROTOCOLS(101, "Switching Protocols"), PROCESSING(102, "Processing"), CHECKPOINT(103, "Checkpoint"), OK(200, "OK"), CREATED(201, "Created"), ACCEPTED(202, "Accepted"), NON_AUTHORITATIVE_INFORMATION(203, "Non-Authoritative Information"), NO_CONTENT(204, "No Content"), RESET_CONTENT(205, "Reset Content"), PARTIAL_CONTENT(206, "Partial Content"), MULTI_STATUS(207, "Multi-Status"), ALREADY_REPORTED(208, "Already Reported"), IM_USED(226, "IM Used"), MULTIPLE_CHOICES(300, "Multiple Choices"), MOVED_PERMANENTLY(301, "Moved Permanently"), FOUND(302, "Found"), /** @deprecated */ @Deprecated MOVED_TEMPORARILY(302, "Moved Temporarily"), SEE_OTHER(303, "See Other"), NOT_MODIFIED(304, "Not Modified"), /** @deprecated */ @Deprecated USE_PROXY(305, "Use Proxy"), TEMPORARY_REDIRECT(307, "Temporary Redirect"), PERMANENT_REDIRECT(308, "Permanent Redirect"), BAD_REQUEST(400, "Bad Request"), UNAUTHORIZED(401, "Unauthorized"), PAYMENT_REQUIRED(402, "Payment Required"), FORBIDDEN(403, "Forbidden"), NOT_FOUND(404, "Not Found"), METHOD_NOT_ALLOWED(405, "Method Not Allowed"), NOT_ACCEPTABLE(406, "Not Acceptable"), PROXY_AUTHENTICATION_REQUIRED(407, "Proxy Authentication Required"), REQUEST_TIMEOUT(408, "Request Timeout"), CONFLICT(409, "Conflict"), GONE(410, "Gone"), LENGTH_REQUIRED(411, "Length Required"), PRECONDITION_FAILED(412, "Precondition Failed"), PAYLOAD_TOO_LARGE(413, "Payload Too Large"), /** @deprecated */ @Deprecated REQUEST_ENTITY_TOO_LARGE(413, "Request Entity Too Large"), URI_TOO_LONG(414, "URI Too Long"), /** @deprecated */ @Deprecated REQUEST_URI_TOO_LONG(414, "Request-URI Too Long"), UNSUPPORTED_MEDIA_TYPE(415, "Unsupported Media Type"), REQUESTED_RANGE_NOT_SATISFIABLE(416, "Requested range not satisfiable"), EXPECTATION_FAILED(417, "Expectation Failed"), I_AM_A_TEAPOT(418, "I'm a teapot"), /** @deprecated */ @Deprecated INSUFFICIENT_SPACE_ON_RESOURCE(419, "Insufficient Space On Resource"), /** @deprecated */ @Deprecated METHOD_FAILURE(420, "Method Failure"), /** @deprecated */ @Deprecated DESTINATION_LOCKED(421, "Destination Locked"), UNPROCESSABLE_ENTITY(422, "Unprocessable Entity"), LOCKED(423, "Locked"), FAILED_DEPENDENCY(424, "Failed Dependency"), UPGRADE_REQUIRED(426, "Upgrade Required"), PRECONDITION_REQUIRED(428, "Precondition Required"), TOO_MANY_REQUESTS(429, "Too Many Requests"), REQUEST_HEADER_FIELDS_TOO_LARGE(431, "Request Header Fields Too Large"), UNAVAILABLE_FOR_LEGAL_REASONS(451, "Unavailable For Legal Reasons"), INTERNAL_SERVER_ERROR(500, "Internal Server Error"), NOT_IMPLEMENTED(501, "Not Implemented"), BAD_GATEWAY(502, "Bad Gateway"), SERVICE_UNAVAILABLE(503, "Service Unavailable"), GATEWAY_TIMEOUT(504, "Gateway Timeout"), HTTP_VERSION_NOT_SUPPORTED(505, "HTTP Version not supported"), VARIANT_ALSO_NEGOTIATES(506, "Variant Also Negotiates"), INSUFFICIENT_STORAGE(507, "Insufficient Storage"), LOOP_DETECTED(508, "Loop Detected"), BANDWIDTH_LIMIT_EXCEEDED(509, "Bandwidth Limit Exceeded"), NOT_EXTENDED(510, "Not Extended"), NETWORK_AUTHENTICATION_REQUIRED(511, "Network Authentication Required"); ...&#125;ç¼–å†™å®Œè‡ªå®šä¹‰å¼‚å¸¸å¤„ç†é€»è¾‘åŽï¼Œæˆ‘ä»¬å°†UserControllerä¸­çš„æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸æ”¹ä¸ºUserNotExistExceptionï¼š1234 @GetMapping("/&#123;id:\\d+&#125;")public void get(@PathVariable String id) &#123; throw new UserNotExistException(id);&#125;é‡å¯é¡¹ç›®ï¼Œä½¿ç”¨Restlet Clientå†æ¬¡è®¿é—®http://localhost:8080/user/1ï¼Œå“åº”å¦‚ä¸‹ï¼š æºç é“¾æŽ¥ https://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/25.Spring-Boot-Exception]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€Java8å®žæˆ˜ã€‘æ–°çš„æ—¥æœŸå’Œæ—¶é—´API]]></title>
    <url>%2Fjava8-new-time-date-api.html</url>
    <content type="text"><![CDATA[Java 8ä¹‹å‰çš„åº“å¯¹æ—¥æœŸå’Œæ—¶é—´çš„æ”¯æŒå¹¶ä¸ç†æƒ³ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJava 8å¼•å…¥äº†ä¸€å¥—å…¨æ–°çš„æ—¶é—´æ—¥æœŸAPIï¼Œä½äºŽjava.timeè·¯å¾„ä¸‹ã€‚LocalDateLocalDateç±»åž‹åŒ…å«äº†å¹´æœˆæ—¥ä¿¡æ¯ï¼Œä¸‹é¢ä¸¾äº›LocalDateçš„ä½¿ç”¨ç¤ºä¾‹ï¼š12345678LocalDate date = LocalDate.of(2018, 4, 20); // 2018-04-20int year = date.getYear(); // 2018int month = date.getMonth().getValue(); // 4int day = date.getDayOfMonth(); // 20// æŸ¥çœ‹è¯¥æœˆæœ‰å¤šå°‘å¤©int days = date.lengthOfMonth(); // 30// æ˜¯å¦æ˜¯é—°å¹´boolean isLeap = date.isLeapYear(); // falseå¯ä»¥ä½¿ç”¨LocalDate.now()èŽ·å–å½“å¤©çš„æ—¥æœŸä¿¡æ¯ï¼š12// æŸ¥çœ‹å½“å¤© å¹´æœˆæ—¥LocalDate today = LocalDate.now(); // 2018-04-20é™¤äº†è°ƒç”¨LocalDateçš„getYearæ–¹æ³•å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ChronoFieldæžšä¸¾ç±»åž‹æ¥å®žçŽ°ç›¸åŒçš„åŠŸèƒ½ï¼š12345int year1 = date.get(ChronoField.YEAR); // 2018int month1 = date.get(ChronoField.MONTH_OF_YEAR); // 4int day1 = date.get(ChronoField.DAY_OF_MONTH); // 20// å½“å‰æ—¥æœŸå±žäºŽè¯¥æœˆç¬¬å‡ å‘¨int weekOfMonth = date.get(ChronoField.ALIGNED_WEEK_OF_MONTH); // 3ChronoFieldæžšä¸¾ç±»åž‹åŒ…å«äº†è¯¸å¤šçš„å±žæ€§å¯ä¾›é€‰æ‹©ï¼š æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¿®æ”¹LocalDateå¯¹è±¡ï¼š1234567LocalDate date3 = LocalDate.of(2018, 4, 20); // 2018-04-20LocalDate date4 = date3.withDayOfMonth(22); // 2018-04-22LocalDate date5 = date3.with(ChronoField.DAY_OF_MONTH, 22); // 2018-04-22LocalDate date6 = date3.withYear(2019); // 2019-04-20LocalDate date7 = date3.plusDays(5); // 2018-04-25LocalDate date8 = date3.plus(5, ChronoUnit.DAYS); // 2018-04-25LocalDate date9 = date3.minusYears(10); // 2008-04-20TemporalAdjustersç±»æä¾›äº†è®¸å¤šé™æ€æ–¹æ³•æ¥ä¿®æ”¹LocalDateå¯¹è±¡ã€‚å½“æˆ‘ä»¬éœ€è¦èŽ·å–ä¸‹ä¸€ä¸ªå‘¨å¤©ï¼Œä¸‹ä¸€ä¸ªå·¥ä½œæ—¥ï¼Œæœ¬æœˆçš„æœ€åŽä¸€å¤©ç­‰ä¿¡æ¯æ—¶ï¼ŒTemporalAdjustersç±»ä¾¿å¯æ´¾ä¸Šç”¨åœºï¼š12345import static java.time.temporal.TemporalAdjusters.*;LocalDate date10 = date3.with(nextOrSame(DayOfWeek.MONDAY)); // 2018-04-23LocalDate date11 = date3.with(lastDayOfMonth()); // 2018-04-30LocalDate date12 = date3.with(previous(DayOfWeek.SATURDAY)); // 2018-04-14å¯å‚è€ƒ4æœˆçš„æ—¥åŽ†æ¥ç†è§£ä¸Šé¢çš„ç»“æžœï¼š æˆ‘ä»¬è¿˜å¯ä»¥å¯¹LocalDateè¿›è¡Œæ ¼å¼åŒ–æ“ä½œï¼š123456String str1 = date.format(DateTimeFormatter.BASIC_ISO_DATE); // 20180420String str2 = date.format(DateTimeFormatter.ISO_LOCAL_DATE); // 2018-04-20DateTimeFormatter dtf = DateTimeFormatter.ofPattern("yyyy-MM-dd");String str5 = date.format(dtf); // 2018-04-20LocalDate date13 = LocalDate.parse(str5, dtf); // 2018-04-20LocalDateå’Œä¸‹é¢è¦ä»‹ç»çš„LocalTimeï¼ŒLocalDateTimeä¹‹é—´å…±äº«äº†è®¸å¤šç±»ä¼¼çš„æ–¹æ³•ï¼Œä¸Šé¢ä»‹ç»çš„LocalDateä¿®æ”¹ã€æ ¼å¼åŒ–ç­‰æ–¹æ³•é€šç”¨é€‚ç”¨äºŽLocalTimeå’ŒLocalDateTimeã€‚LocalTimeLocalTimeå’ŒLocalDateç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºŽLocalTimeåŒ…å«çš„æ˜¯æ—¶åˆ†ç§’ï¼ˆæ¯«ç§’ï¼‰ä¿¡æ¯ã€‚ä¸¾äº›LocalTimeçš„ä¾‹å­ï¼š1234LocalTime time = LocalTime.of(20, 13, 54); // 20:13:54int hour = time.getHour(); // 20int minute = time.getMinute(); // 13int second = time.getSecond(); // 54LocalDateå’ŒLocalTimeéƒ½å¯ä»¥é€šè¿‡å­—ç¬¦ä¸²æ¥åˆ›å»ºï¼š12LocalDate date = LocalDate.parse("2018-04-20");LocalTime time = LocalTime.parse("20:13:54");LocalDateTimeLocalDateTimeæ˜¯LocalDateå’ŒLocalTimeçš„ç»„åˆå½¢å¼ï¼ŒåŒ…å«äº†å¹´æœˆæ—¥æ—¶åˆ†ç§’ä¿¡æ¯ã€‚ä¸¾äº›LocalDateTimeçš„ä½¿ç”¨ç¤ºä¾‹ï¼š12LocalDateTime ldt1 = LocalDateTime.of(2018, 4, 20, 20, 13, 54); // 2018-04-20T20:13:54LocalDateTime ldt2 = LocalDateTime.of(date, time); // 2018-04-20T20:13:54LocalDateTimeå¯ä»¥è½¬æ¢ä¸ºLocalDateå’ŒLocalTimeï¼Œè½¬æ¢åŽåŒ…å«çš„ä¿¡æ¯å‡å°‘äº†ï¼š12LocalDate date1 = ldt1.toLocalDate(); // 2018-04-20LocalTime time1 = ldt1.toLocalTime(); // 20:13:54åŒæ ·çš„ï¼ŒLocalDateå’ŒLocalTimeä¹Ÿå¯ä»¥è½¬æ¢ä¸ºLocalDateTimeï¼Œåªéœ€è¦è¡¥ä¸Šæ—¥æœŸæˆ–è€…æ—¶é—´ï¼š123LocalDateTime ldt3 = date.atTime(time); // 2018-04-20T20:13:54LocalDateTime ldt4 = date.atTime(20, 13, 54); // 2018-04-20T20:13:54LocalDateTime ldt5 = time.atDate(date); // 2018-04-20T20:13:54DurationDurationç”¨äºŽè®¡ç®—ä¸¤ä¸ªLocalTimeæˆ–è€…LocalDateTimeçš„æ—¶é—´å·®ï¼Œä¾‹å¦‚ï¼š123LocalTime time2 = LocalTime.of(23, 59, 59);Duration duration = Duration.between(time1, time2);long seconds = duration.getSeconds(); // 13565time1å’Œtime2ä¹‹é—´ç›¸å·®äº†13565ç§’ã€‚æ‰‹åŠ¨åˆ›å»ºDurationå¯¹è±¡ï¼š12Duration threeMinutes = Duration.ofMinutes(3);threeMinutes = Duration.of(3, ChronoUnit.MINUTES); // åˆ›å»ºäº†ä¸€ä¸ª3åˆ†é’Ÿçš„Durationï¼Œä¸¤ç§åˆ›å»ºæ–¹å¼ç­‰ä»·PeriodPeriodç”¨äºŽè®¡ç®—ä¸¤ä¸ªLocalDateä¹‹é—´çš„æ—¶é•¿ã€‚ä¸¾äº›ä¾‹å­ï¼š1234LocalDate date2 = LocalDate.of(2018, 5, 21);Period period = Period.between(date1, date2);int monthsBetween = period.getMonths(); // 1int daysBetween = period.getDays(); // 12018-04-21å’Œ2018-04-20ä¹‹é—´æœˆä»½ç›¸å·®1ï¼Œå¤©æ•°ç›¸å·®1ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ›å»ºPeriodå¯¹è±¡ï¼š123Period tenDays = Period.ofDays(10);Period threeWeeks = Period.ofWeeks(3);Period twoYearsSixMonthsOneDay = Period.of(2, 6, 1);å…¶ä»–ä¸€äº›å¸¸ç”¨çš„æ–¹æ³•æ¯”è¾ƒä¸¤ä¸ªæ—¶é—´çš„å…ˆåŽ1234LocalDate date15 = LocalDate.of(2018,4,21);date.isEqual(date15); // falsedate.isAfter(date15); // falsedate.isBefore(date15); // trueMonthDayç±»çš„ä½¿ç”¨MonthDayåªåŒ…å«æœˆæ—¥ä¿¡æ¯ï¼Œå¯ä»¥ç”¨äºŽå­˜æ”¾ç±»ä¼¼äºŽç”Ÿæ—¥ï¼Œç»“å©šçºªå¿µæ—¥ç­‰ä¿¡æ¯ã€‚ä¸¾ä¸ªä½¿ç”¨MonthDayçš„ä¾‹å­ï¼š123456LocalDate birthday = LocalDate.of(1999, 9, 9);MonthDay monthDay = MonthDay.of(birthday.getMonth(), birthday.getDayOfMonth());MonthDay currentMonthDay = MonthDay.from(LocalDate.now());if (currentMonthDay.equals(monthDay)) &#123; System.out.println("happy birthday!");&#125;å‡å¦‚ç”¨æˆ·çš„ç”Ÿæ—¥æ˜¯1999å¹´9æœˆ9å·ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è¿™ç§æ–¹æ³•æ¥åˆ¤æ–­ä»Šå¤©æ˜¯å¦æ˜¯ç”¨æˆ·çš„ç”Ÿæ—¥ï¼Œå¦‚æžœæ˜¯çš„è¯ä¾¿å‘é€ç”Ÿæ—¥ç¥ç¦ã€‚åŒæ ·çš„ä¹Ÿæœ‰YearMonthç±»ã€‚Java 8 æ–°çš„æ—¥æœŸæ—¶é—´APIè¿˜æä¾›äº†ä¸åŒæ—¶åŒºå’ŒåŽ†æ³•çš„èŽ·å–æ–¹æ³•ï¼Œç”±äºŽè¾ƒå°‘ä½¿ç”¨è€Œä¸”ä¸æ˜“äºŽç†è§£ï¼Œè¿™é‡Œä¸å†åˆ—å‡ºã€‚ðŸ˜•]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Java 8</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€Java8å®žæˆ˜ã€‘ä½¿ç”¨Optionalå–ä»£null]]></title>
    <url>%2Fjava8-optional-null.html</url>
    <content type="text"><![CDATA[åœ¨Javaä¸­å¯¹ä¸€ä¸ªç©ºå¯¹è±¡è¿›è¡Œæ“ä½œæ—¶ï¼Œä¾¿ä¼šæŠ›å‡ºæœ€å¸¸è§çš„å¼‚å¸¸NullPointerExceptionã€‚ä¸ºäº†æ”¹å–„è¿™ä¸ªé—®é¢˜ï¼ŒJava 8ä¸­æä¾›äº†ä¸€ä¸ªjava.util.Optional&lt;T&gt;ç±»åž‹ã€‚Optionalç±»çš„Javadocæè¿°å¦‚ä¸‹ï¼šè¿™æ˜¯ä¸€ä¸ªå¯ä»¥ä¸ºnullçš„å®¹å™¨å¯¹è±¡ã€‚å¦‚æžœå€¼å­˜åœ¨åˆ™isPresent()æ–¹æ³•ä¼šè¿”å›žtrueï¼Œè°ƒç”¨get()æ–¹æ³•ä¼šè¿”å›žè¯¥å¯¹è±¡ã€‚ä¸‹é¢ä»‹ç»Optionalç±»çš„ä½¿ç”¨æ–¹æ³•ã€‚ å‡å¦‚æœ‰ä¸€ä¸ªåƒä¸‹é¢è¿™æ ·çš„ç±»å±‚æ¬¡ç»“æž„ï¼š1234567891011121314151617181920212223242526272829class Department &#123; private Employee employee; public Department(Employee employee) &#123; this.employee = employee; &#125; Employee getEmployee() &#123; return employee; &#125;&#125;class Employee &#123; private Girl girlFriend; public Employee(Girl girlFriend) &#123; this.girlFriend = girlFriend; &#125; Girl getGirlFriend() &#123; return girlFriend; &#125;&#125;class Girl &#123; private String name; public Girl(String name) &#123; this.name = name; &#125; String getName() &#123; return name; &#125;&#125;éƒ¨é—¨Departmentç±»åŒ…å«ä¸€ä¸ªå‘˜å·¥employeeå±žæ€§ï¼Œç±»åž‹ä¸ºEmployeeï¼Œå‘˜å·¥Employeeç±»åŒ…å«girlFriendå±žæ€§ï¼Œç±»åž‹ä¸ºGirlã€‚å‡å¦‚çŽ°åœ¨è¦èŽ·å–éƒ¨é—¨æŸä¸ªå‘˜å·¥çš„å¥³æœ‹å‹ï¼Œæˆ‘ä»¬é€šå¸¸æ˜¯è¿™æ ·èŽ·å–çš„ï¼š1234567891011121314static String getGirlFriendName(Department department) &#123; if (department != null) &#123; Employee employee = department.getEmployee(); if (employee != null) &#123; Girl girl = employee.getGirlFriend(); if (girl != null) &#123; return girl.getName(); &#125; return "å•èº«æ±ª"; &#125; return "æ²¡æœ‰å‘˜å·¥"; &#125; return "éƒ¨é—¨ä¸ºç©º";&#125;å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ¯æ¬¡å¼•ç”¨å˜é‡çš„å±žæ€§æ—¶ï¼Œéƒ½è¦å…ˆåˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æžœä¸åšè¯¥æ£€æŸ¥å°†å¯èƒ½å¯¼è‡´NullPointerExceptionã€‚ä¸‹é¢æˆ‘ä»¬å°†ä½¿ç”¨Optionalæ¥æ”¹å–„è¿™ç§å±‚å±‚åµŒå¥—ï¼Œå•°å—¦çš„ä»£ç ã€‚åˆ›å»ºOptionalåˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡æœ‰å¥½å‡ ç§æ–¹å¼ï¼šåˆ›å»ºä¸€ä¸ªç©ºçš„Optionalæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é™æ€å·¥åŽ‚æ–¹æ³•Optional.emptyï¼Œåˆ›å»ºä¸€ä¸ªç©ºçš„Optionalå¯¹è±¡ï¼š1Optional&lt;Department&gt; department = Optional.empty();æ ¹æ®éžç©ºå€¼åˆ›å»ºOptionalæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨é™æ€å·¥åŽ‚æ–¹æ³•Optional.ofæ¥åˆ›å»ºä¸€ä¸ªéžç©ºå¯¹è±¡çš„Optionalå¯¹è±¡ï¼š1Optional&lt;Employee&gt; optEmployee = Optional.of(employee);å¦‚æžœemployeeä¸ºç©ºï¼Œè¿™æ®µä»£ç ä¼šç«‹å³æŠ›å‡ºä¸€ä¸ªNullPointerExceptionã€‚åˆ›å»ºå¯ä»¥ä¸ºnullçš„Optionalä½¿ç”¨é™æ€å·¥åŽ‚æ–¹æ³•Optional.ofNullableï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå…è®¸nullå€¼çš„Optionalå¯¹è±¡ï¼š1Optional&lt;Employee&gt; optEmployee = Optional.ofNullable(employee);å¦‚æžœemployeeä¸ºç©ºï¼Œå¯¹å…¶è°ƒç”¨getæ–¹æ³•å°†æŠ›å‡ºNoSuchElementExceptionã€‚Optionalæ–¹æ³•Optionalç±»åŒ…å«äº†è®¸å¤šæ–¹æ³•ï¼Œä¸‹é¢ä»‹ç»è¿™äº›æ–¹æ³•çš„ä½¿ç”¨ã€‚isPresenté¡¾åæ€ä¹‰ï¼Œå¦‚æžœå€¼å­˜åœ¨è¿”å›žtrueï¼Œå¦åˆ™è¿”å›žfalseã€‚å¦‚ï¼š1234 Optional&lt;Department&gt; opt = Optional.ofNullable(department);if(opt.isPresent())&#123; System.out.println(opt.get().getEmployee());&#125;getå¦‚æžœOptionalæœ‰å€¼åˆ™å°†å…¶è¿”å›žï¼Œå¦åˆ™æŠ›å‡ºNoSuchElementExceptionã€‚ä¸‹é¢ä¸¾ä¸ªæŠ›å‡ºNoSuchElementExceptionçš„ä¾‹å­ï¼š12345try &#123; Optional.empty().get();&#125; catch (Exception e) &#123; e.printStackTrace();&#125;ä»£ç å°†æ•èŽ·åˆ° java.util.NoSuchElementException: No value present å¼‚å¸¸ã€‚ifPresentå¦‚æžœOptionalå®žä¾‹æœ‰å€¼åˆ™ä¸ºå…¶è°ƒç”¨Consumerï¼ˆå‡½æ•°æè¿°ç¬¦ä¸ºT -&gt; voidï¼‰ï¼Œå¦åˆ™ä¸åšå¤„ç†ã€‚å¦‚ï¼š1girl.ifPresent(g -&gt; System.out.println("æˆ‘æœ‰å¥³æœ‹å‹ï¼Œåå­—æ˜¯ï¼š" + g.getName()));orElseå¦‚æžœOptionalå®žä¾‹æœ‰å€¼åˆ™å°†å…¶è¿”å›žï¼Œå¦åˆ™è¿”å›žorElseæ–¹æ³•ä¼ å…¥çš„å‚æ•°ã€‚å¦‚ï¼š1System.out.println(Optional.empty().orElse("There is no value present!"));ç¨‹åºå°†è¾“å‡ºThere is no value present!ã€‚orElseGetorElseGetä¸ŽorElseæ–¹æ³•ç±»ä¼¼ï¼ŒorElseæ–¹æ³•å°†ä¼ å…¥çš„å­—ç¬¦ä¸²ä½œä¸ºé»˜è®¤å€¼ï¼Œè€ŒorElseGetæ–¹æ³•å¯ä»¥æŽ¥å—Supplierï¼ˆå‡½æ•°æè¿°ç¬¦ä¸º() -&gt; Tï¼‰æ¥ç”Ÿæˆé»˜è®¤å€¼ã€‚å¦‚ï¼š1System.out.println(Optional.empty().orElseGet(() -&gt; "There is no value present!"));ç¨‹åºåŒæ ·è¾“å‡ºThere is no value present!ã€‚orElseThrowå¦‚æžœæœ‰å€¼åˆ™å°†å…¶è¿”å›žï¼Œå¦åˆ™æŠ›å‡ºSupplieræŽ¥å£åˆ›å»ºçš„å¼‚å¸¸ã€‚å¦‚ï¼š12345try &#123; Optional.empty().orElseThrow(NoSuchElementException::new);&#125; catch (Exception e) &#123; e.printStackTrace();&#125;ä»£ç å°†æ•èŽ·åˆ° java.util.NoSuchElementException: No value present å¼‚å¸¸ã€‚mapå¦‚æžœOptionalæœ‰å€¼ï¼Œåˆ™å¯¹å…¶æ‰§è¡Œè°ƒç”¨Functionå‡½æ•°æè¿°ç¬¦ä¸ºï¼ˆT -&gt; Rï¼‰å¾—åˆ°è¿”å›žå€¼ã€‚å¦‚æžœè¿”å›žå€¼ä¸ä¸ºnullï¼Œåˆ™åˆ›å»ºåŒ…å«Functionå›žå€¼çš„Optionalä½œä¸ºmapæ–¹æ³•è¿”å›žå€¼ï¼Œå¦åˆ™è¿”å›žç©ºOptionalã€‚12Optional&lt;String&gt; upperName = name.map(String::toUpperCase);System.out.println(upperName.orElse("No value found"));flatMapå¦‚æžœæœ‰å€¼ï¼Œä¸ºå…¶æ‰§è¡ŒFunctionå‡½æ•°è¿”å›žOptionalç±»åž‹è¿”å›žå€¼ï¼Œå¦åˆ™è¿”å›žç©ºOptionalã€‚flatMapä¸Žmapæ–¹æ³•ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºŽflatMapä¸­çš„Functionå‡½æ•°è¿”å›žå€¼å¿…é¡»æ˜¯Optionalã€‚è°ƒç”¨ç»“æŸæ—¶ï¼ŒflatMapä¸ä¼šå¯¹ç»“æžœç”¨Optionalå°è£…ã€‚å¦‚ï¼š12upperName = name.flatMap((value) -&gt; Optional.of(value.toUpperCase()));System.out.println(upperName.orElse("No value found"));filterfilterä¸ªæ–¹æ³•é€šè¿‡ä¼ å…¥Predicateï¼ˆå‡½æ•°æè¿°ç¬¦ä¸ºT -&gt; Booleanï¼‰å¯¹Optionalå®žä¾‹çš„å€¼è¿›è¡Œè¿‡æ»¤ã€‚å¦‚ï¼š123Optional&lt;String&gt; name = Optional.of("Jane");Optional&lt;String&gt; LongName = name.filter((value) -&gt; value.length() &gt;= 3);System.out.println(LongName.orElse("åå­—é•¿åº¦å°äºŽ3ä¸ªå­—ç¬¦"));æ–¹æ³•è¾“å‡ºJaneã€‚å®žæˆ˜ä»‹ç»å®ŒOptionalç±»çš„æ–¹æ³•åŽï¼Œæˆ‘ä»¬ä½¿ç”¨Optionalæ”¹å–„ä¸€å¼€å§‹çš„ä»£ç ï¼š1234567static String getGirlFriendName(Department department) &#123; Optional&lt;Department&gt; opt = Optional.ofNullable(department); return opt.map(Department::getEmployee) .map(Employee::getGirlFriend) .map(Girl::getName) .orElseThrow(NoSuchElementException::new);&#125;æ•´æ´è€Œåˆä¸å¤±é€¼æ ¼ã€‚ã€ŠJava 8å®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Java 8</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€Java8å®žæˆ˜ã€‘ä½¿ç”¨å¹¶è¡Œæµ]]></title>
    <url>%2FJava8-parallelStream.html</url>
    <content type="text"><![CDATA[é™¤äº†é¡ºåºæµå¤–ï¼ŒJava 8ä¸­ä¹Ÿå¯ä»¥å¯¹é›†åˆå¯¹è±¡è°ƒç”¨parallelStreamæ–¹æ³•æˆ–è€…å¯¹é¡ºåºæµè°ƒç”¨parallelæ–¹æ³•æ¥ç”Ÿæˆå¹¶è¡Œæµã€‚å¹¶è¡Œæµå°±æ˜¯ä¸€ä¸ªæŠŠå†…å®¹åˆ†æˆå¤šä¸ªæ•°æ®å—ï¼Œå¹¶ç”¨ä¸åŒçš„çº¿ç¨‹åˆ†åˆ«å¤„ç†æ¯ä¸ªæ•°æ®å—çš„æµã€‚è¿™æ ·åœ¨ä½¿ç”¨æµå¤„ç†æ•°æ®è§„æ¨¡è¾ƒå¤§çš„é›†åˆå¯¹è±¡æ—¶å¯ä»¥å……åˆ†çš„åˆ©ç”¨å¤šæ ¸CPUæ¥æé«˜å¤„ç†æ•ˆçŽ‡ã€‚ä¸è¿‡åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œå¹¶è¡Œæµæœªå¿…ä¼šæ¯”é¡ºåºæµå¿«ï¼Œç”šè‡³ä¼šæ…¢å¾ˆå¤šï¼Œæ‰€ä»¥äº†è§£å¦‚ä½•é«˜æ•ˆçš„ä½¿ç”¨å¹¶è¡Œæµä¹Ÿè‡³å…³é‡è¦ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è°ƒç”¨æµçš„sequentialæ–¹æ³•ï¼Œå°†å¹¶è¡Œæµè½¬æ¢ä¸ºé¡ºåºæµã€‚æµ‹è¯•å¹¶è¡Œæµçš„æ€§èƒ½ä¸¾ä¸ªä¾‹å­ï¼Œå¯¹1åˆ°1000çš„æ•´æ•°æ±‚å’Œï¼Œè§‚å¯Ÿé¡ºåºæµå’Œå¹¶è¡Œæµçš„å¤„ç†æ—¶é—´ï¼š1234567891011121314public class StreamExample &#123; public static void main(String[] args) &#123; StreamExample.test((n) -&gt; LongStream.rangeClosed(1L, n).reduce(0L, Long::sum), 1000L); StreamExample.test((n) -&gt; LongStream.rangeClosed(1L, n).parallel().reduce(0L, Long::sum), 1000L); &#125; static void test(LongConsumer c, Long n) &#123; long start = System.currentTimeMillis(); c.accept(n); long end = System.currentTimeMillis(); System.out.println("å¤„ç†æ—¶é—´ï¼š" + (end - start) + "msc"); &#125;&#125;è¿è¡Œç»“æžœï¼š12å¤„ç†æ—¶é—´ï¼š9mscå¤„ç†æ—¶é—´ï¼š484mscç»“æžœå’Œæˆ‘ä»¬é¢„æœŸçš„ä¸ä¸€è‡´ï¼Œè¿™æ˜¯å› ä¸ºåœ¨å¤„ç†æ•°æ®é›†è§„æ¨¡ä¸å¤§çš„æƒ…å†µä¸‹ï¼Œå°†æµå¹¶è¡ŒåŒ–æ‰€å¸¦æ¥çš„é¢å¤–å¼€é”€æ¯”é€»è¾‘ä»£ç å¼€é”€è¿˜å¤§ã€‚æˆ‘ä»¬å°†æ•°æ®é›†æ‰©å¤§ï¼š12StreamExample.test((n) -&gt; LongStream.rangeClosed(1L, n).reduce(0L, Long::sum), 1000000000L);StreamExample.test((n) -&gt; LongStream.rangeClosed(1L, n).parallel().reduce(0L, Long::sum), 1000000000L);è¿è¡Œç»“æžœï¼š12å¤„ç†æ—¶é—´ï¼š2775mscå¤„ç†æ—¶é—´ï¼š725mscå¯¹äºŽè¾ƒå°çš„æ•°æ®é‡ï¼Œé€‰æ‹©å¹¶è¡Œæµä¸æ˜¯ä¸€ä¸ªå¥½çš„å†³å®šã€‚å¹¶è¡Œå¤„ç†å°‘æ•°å‡ ä¸ªå…ƒç´ çš„å¥½å¤„è¿˜æŠµä¸ä¸Šå¹¶è¡ŒåŒ–é€ æˆçš„é¢å¤–å¼€é”€ã€‚è®¾Næ˜¯è¦å¤„ç†çš„å…ƒç´ çš„æ€»æ•°ï¼ŒQæ˜¯ä¸€ä¸ªå…ƒç´ é€šè¿‡æµæ°´çº¿çš„å¤§è‡´å¤„ç†æˆæœ¬ï¼Œåˆ™N*Qå°±æ˜¯è¿™ä¸ªå¯¹æˆæœ¬çš„ä¸€ä¸ªç²—ç•¥çš„å®šæ€§ä¼°è®¡ã€‚Qå€¼è¾ƒé«˜å°±æ„å‘³ç€ä½¿ç”¨å¹¶è¡Œæµæ—¶æ€§èƒ½å¥½çš„å¯èƒ½æ€§æ¯”è¾ƒå¤§ã€‚æŽ¥ç€å¯¹æ¯”ä¸‹ä½¿ç”¨å¹¶è¡Œæµå¤„ç†åŒ…è£…ç±»åž‹çš„æ±‚å’Œä¸ŽåŽŸå§‹ç±»åž‹çš„æ±‚å’Œè¿è¡Œæ—¶é—´å¯¹æ¯”ï¼š12StreamExample.test((n) -&gt; Stream.iterate(1L, a -&gt; a + 1L).limit(n).reduce(0L, Long::sum), 1000000000L);StreamExample.test((n) -&gt; LongStream.rangeClosed(1L, n).parallel().reduce(0L, Long::sum), 1000000000L);è¿è¡Œç»“æžœï¼š12å¤„ç†æ—¶é—´ï¼š21915mscå¤„ç†æ—¶é—´ï¼š920mscå› ä¸ºiterateç”Ÿæˆçš„æ˜¯åŒ…è£…ç±»åž‹çš„å¯¹è±¡ï¼Œå¿…é¡»æ‹†ç®±æˆåŽŸå§‹ç±»åž‹æ‰èƒ½æ±‚å’Œï¼Œè€Œä¸”æˆ‘ä»¬å¾ˆéš¾æŠŠiterateåˆ†æˆå¤šä¸ªç‹¬ç«‹å—æ¥å¹¶è¡Œæ‰§è¡Œã€‚æ‰€ä»¥å¯ä»¥çœ‹åˆ°æ¥ä¸¤è€…é—´çš„è¿è¡Œæ•ˆçŽ‡å·®äº†å°†è¿‘24å€ï¼åœ¨å®žé™…ä¸­åº”é¿å…é¢‘ç¹æ‹†è£…ç®±ï¼›æœ‰äº›æ“ä½œæœ¬èº«åœ¨å¹¶è¡Œæµä¸Šçš„æ€§èƒ½å°±æ¯”é¡ºåºæµå·®ã€‚ç‰¹åˆ«æ˜¯limitå’ŒfindFirstç­‰ä¾èµ–äºŽå…ƒ ç´ é¡ºåºçš„æ“ä½œï¼Œå®ƒä»¬åœ¨å¹¶è¡Œæµä¸Šæ‰§è¡Œçš„ä»£ä»·éžå¸¸å¤§ã€‚ä¾‹å¦‚ï¼ŒfindAnyä¼šæ¯”findFirstæ€§ èƒ½å¥½ï¼Œå› ä¸ºå®ƒä¸ä¸€å®šè¦æŒ‰é¡ºåºæ¥æ‰§è¡Œã€‚å†çœ‹ä¸€ä¸ªä¾‹å­ï¼š12345678910111213141516171819202122public class StreamExample &#123; public static void main(String[] args) &#123; ArrayList&lt;Long&gt; arrayList = Stream.iterate(1L, a -&gt; a + 1L).limit(10000000L).collect(toCollection(ArrayList::new)); LinkedList&lt;Long&gt; linkedList = Stream.iterate(1L, a -&gt; a + 1L).limit(10000000L).collect(toCollection(LinkedList::new)); StreamExample.test(() -&gt; arrayList.parallelStream().reduce(0L, Long::sum)); StreamExample.test(() -&gt; linkedList.parallelStream().reduce(0L, Long::sum)); &#125; static void test(Runner r) &#123; long start = System.currentTimeMillis(); r.run(); long end = System.currentTimeMillis(); System.out.println("å¤„ç†æ—¶é—´ï¼š" + (end - start) + "msc"); &#125;&#125;@FunctionalInterfaceinterface Runner &#123; void run();&#125;ä¸Šé¢ä»£ç å¯¹æ¯”äº†ä½¿ç”¨å¹¶è¡Œæµå¤„ç†ArrayListå’Œä½¿ç”¨å¹¶è¡Œæµå¤„ç†LinkedListçš„æ€§èƒ½å¯¹æ¯”ï¼Œè¿è¡Œç»“æžœå¦‚ä¸‹ï¼š12å¤„ç†æ—¶é—´ï¼š1258mscå¤„ç†æ—¶é—´ï¼š7933mscä¹‹æ‰€ä»¥å‡ºçŽ°è¿™ä¸ªç»“æžœï¼Œæ˜¯å› ä¸ºArrayListçš„æ‹†åˆ†æ•ˆçŽ‡æ¯”LinkedListé«˜å¾—å¤šï¼Œå‰è€…ç”¨ä¸ç€éåŽ†å°±å¯ä»¥å¹³å‡æ‹†åˆ†ï¼Œè€ŒåŽè€…åˆ™å¿…é¡»éåŽ†ã€‚ä½¿ç”¨å¹¶è¡Œæµè¦è€ƒè™‘æµèƒŒåŽçš„æ•°æ®ç»“æž„æ˜¯å¦æ˜“äºŽåˆ†è§£ã€‚ç”¨rangeæ–¹æ³•åˆ›å»ºçš„åŽŸå§‹ç±»åž‹æµä¹Ÿå¯ä»¥å¿«é€Ÿåˆ†è§£ã€‚ä¸‹è¡¨åˆ—å‡ºäº†æµçš„æ•°æ®æºå’Œå¯åˆ†è§£æ€§ï¼šæ•°æ®æºå¯åˆ†è§£æ€§ArrayListå¾ˆå¥½LinkedListå¾ˆå·®IntStream.rangeå¾ˆå¥½Stream.iterateå¾ˆå·®HashSetå¥½TreeSetå¥½æ€»ç»“æ€»è€Œè¨€ä¹‹ï¼Œä½¿ç”¨å¹¶è¡Œæµåº”è¯¥è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼šç•™æ„æ‹†è£…ç®±æˆæœ¬ï¼›æµä¸­ä¾èµ–äºŽå…ƒç´ é¡ºåºçš„æ“ä½œï¼Œåœ¨å¹¶è¡Œæµä¸Šæ‰§è¡Œçš„ä»£ä»·éžå¸¸å¤§ï¼›è€ƒè™‘æµçš„æµæ°´çº¿æ“ä½œæ€»æˆæœ¬ï¼Œå¯¹äºŽè¾ƒå°çš„æ•°æ®é‡ï¼Œå¹¶ä¸é€‚åˆä½¿ç”¨å¹¶è¡Œæµï¼›è€ƒè™‘æµèƒŒåŽçš„æ•°æ®ç»“æž„æ˜¯å¦æ˜“äºŽåˆ†è§£ï¼Œä¸æ˜“åˆ†è§£çš„æ•°æ®ç»“æž„ä¸é€‚åˆä½¿ç”¨å¹¶è¡Œæµã€‚ã€ŠJava 8å®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Java 8</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€Java8å®žæˆ˜ã€‘ä½¿ç”¨æµæ”¶é›†æ•°æ®]]></title>
    <url>%2Fjava8stream2.html</url>
    <content type="text"><![CDATA[åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°ç»ˆç«¯æ“ä½œcollectæ–¹æ³•ç”¨äºŽæ”¶é›†æµä¸­çš„å…ƒç´ ï¼Œå¹¶æ”¾åˆ°ä¸åŒç±»åž‹çš„ç»“æžœä¸­ï¼Œæ¯”å¦‚Listã€Setæˆ–è€…Mapã€‚å…¶å®žcollectæ–¹æ³•å¯ä»¥æŽ¥å—å„ç§CollectorsæŽ¥å£çš„é™æ€æ–¹æ³•ä½œä¸ºå‚æ•°æ¥å®žçŽ°æ›´ä¸ºå¼ºå¤§çš„è§„çº¦æ“ä½œï¼Œæ¯”å¦‚æŸ¥æ‰¾æœ€å¤§å€¼æœ€å°å€¼ï¼Œæ±‡æ€»ï¼Œåˆ†åŒºå’Œåˆ†ç»„ç­‰ç­‰ã€‚å‡†å¤‡å·¥ä½œä¸ºäº†æ¼”ç¤ºCollectorsæŽ¥å£ä¸­çš„é™æ€æ–¹æ³•ä½¿ç”¨ï¼Œè¿™é‡Œåˆ›å»ºä¸€ä¸ªDishç±»ï¼ˆèœè°±ç±»ï¼‰ï¼š12345678910111213141516171819202122232425public class Dish &#123; public enum Type &#123;MEAT, FISH, OTHER&#125; /** é£Ÿç‰©åç§° */ private final String name; /** æ˜¯å¦æ˜¯ç´ é£Ÿ */ private final boolean vegetarian; /** å¡è·¯é‡Œ */ private final int calories; /** ç±»åž‹ï¼šè‚‰ï¼Œæµ·é²œï¼Œå…¶ä»– */ private final Type type; public Dish(String name, boolean vegetarian, int calories, Type type) &#123; this.name = name; this.vegetarian = vegetarian; this.calories = calories; this.type = type; &#125; @Override public String toString() &#123; return this.getName(); &#125; // get,setç•¥&#125;ç„¶åŽåˆ›å»ºä¸€ä¸ªListï¼ŒåŒ…å«å„ç§é£Ÿæï¼š12345678910List&lt;Dish&gt; list = Arrays.asList( new Dish("pork", false, 800, Dish.Type.MEAT), new Dish("beef", false, 700, Dish.Type.MEAT), new Dish("chicken", false, 400, Dish.Type.MEAT), new Dish("french fries", true, 530, Dish.Type.OTHER), new Dish("rice", true, 350, Dish.Type.OTHER), new Dish("season fruit", true, 120, Dish.Type.OTHER), new Dish("pizza", true, 550, Dish.Type.OTHER), new Dish("prawns", false, 300, Dish.Type.FISH), new Dish("salmon", false, 450, Dish.Type.FISH) );åœ¨æµ‹è¯•ç±»ä¸­å¯¼å…¥æ‰€æœ‰CollectorsæŽ¥å£çš„é™æ€æ–¹æ³•ï¼š1import static java.util.stream.Collectors.*;è§„çº¦ä¸Žæ±‡æ€»æœ€å¤§æœ€å°å€¼Collectors.maxByå’ŒCollectors.minByç”¨æ¥è®¡ç®—æµä¸­çš„æœ€å¤§æˆ–æœ€å°å€¼ï¼Œæ¯”å¦‚æŒ‰å¡è·¯é‡Œçš„å¤§å°æ¥ç­›é€‰å‡ºå¡è·¯é‡Œæœ€é«˜çš„é£Ÿæï¼š123list.stream() .collect(maxBy(Comparator.comparingInt(Dish::getCalories))) .ifPresent(System.out::println);è¾“å‡ºporkã€‚æ±‡æ€»Collectors.summingIntå¯ä»¥ç”¨äºŽæ±‚å’Œï¼Œå‚æ•°ç±»åž‹ä¸ºintç±»åž‹ã€‚ç›¸åº”çš„åŸºæœ¬ç±»åž‹å¯¹åº”çš„æ–¹æ³•è¿˜æœ‰Collectors.summingLongå’ŒCollectors.summingDoubleã€‚æ¯”å¦‚æ±‚æ‰€æœ‰é£Ÿæçš„å¡è·¯é‡Œï¼š1list.stream().collect(summingInt(Dish::getCalories)); // 4200Collectors.averagingIntæ–¹æ³•ç”¨äºŽæ±‚å¹³å‡å€¼ï¼Œå‚æ•°ç±»åž‹ä¸ºintç±»åž‹ã€‚ç›¸åº”çš„åŸºæœ¬ç±»åž‹å¯¹åº”çš„æ–¹æ³•è¿˜æœ‰Collectors.averagingLongå’ŒCollectors.averagingDoubleã€‚æ¯”å¦‚æ±‚æ‰€æœ‰é£Ÿæçš„å¹³å‡å¡è·¯é‡Œ:1list.stream().collect(averagingInt(Dish::getCalories)); // 466.6666666666667Collectors.summarizingIntæ–¹æ³•å¯ä»¥ä¸€æ¬¡æ€§è¿”å›žå…ƒç´ ä¸ªæ•°ï¼Œæœ€å¤§å€¼ï¼Œæœ€å°å€¼ï¼Œå¹³å‡å€¼å’Œæ€»å’Œï¼š12IntSummaryStatistics iss = list.stream().collect(summarizingInt(Dish::getCalories));System.out.println(iss); // IntSummaryStatistics&#123;count=9, sum=4200, min=120, average=466.666667, max=800&#125;åŒæ ·ï¼Œç›¸åº”çš„summarizingLongå’ŒsummarizingDoubleæ–¹æ³•æœ‰ç›¸å…³çš„LongSummaryStatisticså’ŒDoubleSummaryStatisticsç±»åž‹ï¼Œé€‚ç”¨äºŽæ”¶é›†çš„å±žæ€§æ˜¯åŽŸå§‹ç±»åž‹longæˆ–doubleçš„æƒ…å†µã€‚æ‹¼æŽ¥Collectors.joiningæ–¹æ³•ä¼šæŠŠæµä¸­æ¯ä¸€ä¸ªå¯¹è±¡åº”ç”¨toStringæ–¹æ³•å¾—åˆ°çš„æ‰€æœ‰å­—ç¬¦ä¸²è¿žæŽ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚ï¼š12list.stream().map(Dish::getName).collect(joining()); // porkbeefchickenfrench friesriceseason fruitpizzaprawnssalmonå†…éƒ¨æ‹¼æŽ¥é‡‡ç”¨äº†StringBuilderã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ‹¼æŽ¥ç¬¦ï¼š12list.stream().map(Dish::getName).collect(joining("ï¼Œ"));// porkï¼Œbeefï¼Œchickenï¼Œfrench friesï¼Œriceï¼Œseason fruitï¼Œpizzaï¼Œprawnsï¼ŒsalmonreducingCollectors.reducingæ–¹æ³•å¯ä»¥å®žçŽ°æ±‚å’Œï¼Œæœ€å¤§å€¼æœ€å°å€¼ç­›é€‰ï¼Œæ‹¼æŽ¥ç­‰æ“ä½œã€‚ä¸Šé¢ä»‹ç»çš„æ–¹æ³•åœ¨ç¼–ç¨‹ä¸Šæ›´æ–¹ä¾¿å¿«æ·ï¼Œä½†reducingçš„å¯è¯»æ€§æ›´é«˜ï¼Œå®žé™…ä½¿ç”¨å“ªç§æˆ‘è§‰å¾—è¿˜æ˜¯çœ‹ä¸ªäººå–œå¥½ã€‚ä¸¾ä¸ªä½¿ç”¨reducingæ±‚æœ€å¤§å€¼çš„ä¾‹å­ï¼š1list.stream().collect(reducing(0, Dish::getCalories, Integer::max)); // 800æˆ–è€…ï¼š1list.stream().map(Dish::getCalories).collect(reducing(0, Integer::max)); // 800åˆ†ç»„åˆ†ç»„åŠŸèƒ½ç±»ä¼¼äºŽSQLé‡Œçš„group byï¼Œå¯ä»¥å¯¹æµä¸­çš„å…ƒç´ æŒ‰ç…§æŒ‡å®šåˆ†ç»„è§„åˆ™è¿›è¡Œåˆ†ç»„ã€‚æ™®é€šåˆ†ç»„Collectors.groupingByæ–¹æ³•å¯ä»¥è½»æ¾çš„å®Œæˆåˆ†ç»„æ“ä½œã€‚æ¯”å¦‚çŽ°åœ¨å¯¹Listä¸­çš„é£ŸææŒ‰ç…§ç±»åž‹è¿›è¡Œåˆ†ç»„ï¼š12Map&lt;Dish.Type, List&lt;Dish&gt;&gt; dishesByType = list.stream().collect(groupingBy(Dish::getType));System.out.println(dishesByType);è¾“å‡ºç»“æžœ{OTHER=[french fries, rice, season fruit, pizza], FISH=[prawns, salmon], MEAT=[pork, beef, chicken]}ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰åˆ†ç»„è§„åˆ™ï¼Œæ¯”å¦‚æŒ‰ç…§å¡è·¯é‡Œçš„é«˜ä½Žåˆ†ä¸ºé«˜çƒ­é‡ï¼Œæ­£å¸¸å’Œä½Žçƒ­é‡ï¼šé¦–å…ˆå®šä¹‰ä¸€ä¸ªå¡è·¯é‡Œé«˜ä½Žçš„æžšä¸¾ç±»åž‹1public enum CaloricLevel &#123; DIET, NORMAL, FAT &#125;;ç„¶åŽç¼–å†™åˆ†ç»„è§„åˆ™ï¼š12345678Map&lt;CaloricLevel, List&lt;Dish&gt;&gt; dishesByCalories = list.stream().collect( groupingBy(d -&gt; &#123; if (d.getCalories() &lt;= 400) return CaloricLevel.DIET; else if (d.getCalories() &lt;= 700) return CaloricLevel.NORMAL; else return CaloricLevel.FAT; &#125;));System.out.println(dishesByCalories);è¾“å‡ºç»“æžœï¼š{DIET=[chicken, rice, season fruit, prawns], NORMAL=[beef, french fries, pizza, salmon], FAT=[pork]}ã€‚å¤šçº§åˆ†ç»„Collectors.groupingByæ”¯æŒåµŒå¥—å®žçŽ°å¤šçº§åˆ†ç»„ï¼Œæ¯”å¦‚å°†é£ŸææŒ‰ç…§ç±»åž‹åˆ†ç±»ï¼Œç„¶åŽå†æŒ‰ç…§å¡è·¯é‡Œçš„é«˜ä½Žåˆ†ç±»ï¼š12345678 Map&lt;Dish.Type, Map&lt;CaloricLevel, List&lt;Dish&gt;&gt;&gt; dishesGroup = list.stream().collect( groupingBy(Dish::getType, groupingBy(d -&gt; &#123; if (d.getCalories() &lt;= 400) return CaloricLevel.DIET; else if (d.getCalories() &lt;= 700) return CaloricLevel.NORMAL; else return CaloricLevel.FAT; &#125;) ));System.out.println(dishesGroup);è¿”å›žç»“æžœæ˜¯ä¸€ä¸ªäºŒçº§Mapï¼Œè¾“å‡ºç»“æžœ{FISH={DIET=[prawns], NORMAL=[salmon]}, OTHER={DIET=[rice, season fruit], NORMAL=[french fries, pizza]}, MEAT={DIET=[chicken], FAT=[pork], NORMAL=[beef]}}ã€‚å®žé™…ä¸Šï¼Œç¬¬äºŒä¸ªå‚æ•°é™¤äº†Collectors.groupingByå¤–ï¼Œä¹Ÿå¯ä»¥ä¼ é€’å…¶ä»–è§„çº¦æ“ä½œï¼Œè§„çº¦çš„ç»“æžœç±»åž‹å¯¹åº”Mapé‡Œçš„ç¬¬äºŒä¸ªæ³›åž‹ã€‚ä¸¾äº›ä¾‹å­ï¼Œå°†é£ŸææŒ‰ç…§ç±»åž‹åˆ†ï¼Œç„¶åŽç»Ÿè®¡å„ä¸ªç±»åž‹å¯¹åº”çš„æ•°é‡ï¼š12Map&lt;Dish.Type, Long&gt; dishesCountByType = list.stream().collect(groupingBy(Dish::getType,counting()));System.out.println(dishesCountByType);å› ä¸ºCollectors.countingæ–¹æ³•è¿”å›žLongç±»åž‹ï¼Œæ‰€ä»¥Mapç¬¬äºŒä¸ªæ³›åž‹ä¹Ÿå¿…é¡»æŒ‡å®šä¸ºLongã€‚è¾“å‡ºç»“æžœï¼š{OTHER=4, FISH=2, MEAT=3}ã€‚æˆ–è€…å¯¹é£ŸææŒ‰ç…§ç±»åž‹åˆ†ï¼Œç„¶åŽé€‰å‡ºå¡è·¯é‡Œæœ€é«˜çš„é£Ÿç‰©ï¼š1234Map&lt;Dish.Type, Optional&lt;Dish&gt;&gt; map = list.stream().collect(groupingBy( Dish::getType, maxBy(Comparator.comparing(Dish::getCalories))));System.out.println(map);è¾“å‡ºç»“æžœï¼š{OTHER=Optional[pizza], MEAT=Optional[pork], FISH=Optional[salmon]}ã€‚å¦‚æžœä¸å¸Œæœ›è¾“å‡ºç»“æžœåŒ…å«Optionalï¼Œå¯ä»¥ä½¿ç”¨Collectors.collectingAndThenæ–¹æ³•ï¼š1234Map&lt;Dish.Type, Dish&gt; map = list.stream().collect(groupingBy( Dish::getType, collectingAndThen(maxBy(Comparator.comparing(Dish::getCalories)), Optional::get)));System.out.println(map);è¾“å‡ºç»“æžœï¼š{OTHER=pizza, FISH=salmon, MEAT=pork}ã€‚å¸¸ä¸ŽCollectors.groupingByç»„åˆä½¿ç”¨çš„æ–¹æ³•è¿˜æœ‰Collectors.mappingã€‚Collectors.mappingæ–¹æ³•æŽ¥å—ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªå‡½æ•°å¯¹æµä¸­çš„å…ƒç´ åšå˜æ¢ï¼Œå¦ä¸€ä¸ªåˆ™å°†å˜æ¢çš„ç»“æžœå¯¹è±¡æ”¶é›†èµ·æ¥ï¼Œæ¯”å¦‚å¯¹é£ŸææŒ‰ç…§ç±»åž‹åˆ†ç±»ï¼Œç„¶åŽè¾“å‡ºå„ç§ç±»åž‹é£Ÿæä¸‹å¡è·¯é‡Œç­‰çº§æƒ…å†µï¼š12345678910Map&lt;Dish.Type, HashSet&lt;CaloricLevel&gt;&gt; map = list.stream().collect(groupingBy( Dish::getType, mapping( d -&gt; &#123; if (d.getCalories() &lt;= 400) return CaloricLevel.DIET; else if (d.getCalories() &lt;= 700) return CaloricLevel.NORMAL; else return CaloricLevel.FAT; &#125;, toCollection(HashSet::new) )));System.out.println(map);Collectors.toCollectionæ–¹æ³•å¯ä»¥æ–¹ä¾¿çš„æž„é€ å„ç§ç±»åž‹çš„é›†åˆã€‚è¾“å‡ºç»“æžœï¼š{FISH=[DIET, NORMAL], MEAT=[DIET, NORMAL, FAT], OTHER=[DIET, NORMAL]}ã€‚åˆ†åŒºåˆ†åŒºç±»ä¼¼äºŽåˆ†ç»„ï¼Œåªä¸è¿‡åˆ†åŒºæœ€å¤šä¸¤ç§ç»“æžœã€‚Collectors.partitioningByæ–¹æ³•ç”¨äºŽåˆ†åŒºæ“ä½œï¼ŒæŽ¥æ”¶ä¸€ä¸ªPredicate&lt;T&gt;ç±»åž‹çš„Lambdaè¡¨è¾¾å¼ä½œä¸ºå‚æ•°ã€‚æ¯”å¦‚å°†é£ŸææŒ‰ç…§ç´ é£Ÿä¸Žå¦åˆ†ç±»ï¼š12Map&lt;Boolean, List&lt;Dish&gt;&gt; map = list.stream().collect(partitioningBy(Dish::isVegetarian));System.out.println(map);è¾“å‡ºç»“æžœï¼š{false=[pork, beef, chicken, prawns, salmon], true=[french fries, rice, season fruit, pizza]}ã€‚Collectors.partitioningByæ–¹æ³•è¿˜æ”¯æŒä¼ å…¥åˆ†ç»„å‡½æ•°æˆ–è€…å…¶ä»–è§„çº¦æ“ä½œï¼Œæ¯”å¦‚å°†é£ŸææŒ‰ç…§ç´ é£Ÿä¸Žå¦åˆ†ç±»ï¼Œç„¶åŽæŒ‰ç…§é£Ÿæç±»åž‹è¿›è¡Œåˆ†ç±»ï¼š123Map&lt;Boolean, Map&lt;Dish.Type, List&lt;Dish&gt;&gt;&gt; map = list.stream().collect( partitioningBy(Dish::isVegetarian, groupingBy(Dish::getType)));System.out.println(map);è¾“å‡ºç»“æžœï¼š{false={MEAT=[pork, beef, chicken], FISH=[prawns, salmon]}, true={OTHER=[french fries, rice, season fruit, pizza]}}ã€‚å†å¦‚å°†é£ŸææŒ‰ç…§ç´ é£Ÿä¸Žå¦åˆ†ç±»ï¼Œç„¶åŽç­›é€‰å‡ºå„è‡ªç±»åž‹ä¸­å¡è·¯é‡Œå«é‡æœ€ä½Žçš„é£Ÿæï¼š12345Map&lt;Boolean, Dish&gt; map = list.stream().collect( partitioningBy(Dish::isVegetarian, collectingAndThen( minBy(Comparator.comparing(Dish::getCalories)), Optional::get )));System.out.println(map);è¾“å‡ºç»“æžœï¼š{false=prawns, true=season fruit}ã€‚ã€ŠJava 8å®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Java 8</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€Java8å®žæˆ˜ã€‘å¼€å§‹ä½¿ç”¨æµ]]></title>
    <url>%2Fjava8stream1.html</url>
    <content type="text"><![CDATA[Java 8 ä¸­çš„ Stream ä¿—ç§°ä¸ºæµï¼Œå®ƒä¸Ž java.io åŒ…é‡Œçš„ InputStream å’Œ OutputStream æ˜¯å®Œå…¨ä¸åŒçš„æ¦‚å¿µã€‚Stream ç”¨äºŽå¯¹é›†åˆå¯¹è±¡è¿›è¡Œå„ç§éžå¸¸ä¾¿åˆ©ã€é«˜æ•ˆçš„èšåˆæ“ä½œï¼Œæˆ–è€…å¤§æ‰¹é‡æ•°æ®æ“ä½œã€‚Stream API å€ŸåŠ©äºŽLambda è¡¨è¾¾å¼ï¼Œæžå¤§çš„æé«˜ç¼–ç¨‹æ•ˆçŽ‡å’Œç¨‹åºå¯è¯»æ€§ã€‚åŒæ—¶å®ƒæä¾›ä¸²è¡Œå’Œå¹¶è¡Œä¸¤ç§æ¨¡å¼è¿›è¡Œæ±‡èšæ“ä½œï¼Œå¹¶å‘æ¨¡å¼èƒ½å¤Ÿå……åˆ†åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨çš„ä¼˜åŠ¿ã€‚é€šè¿‡ä¸‹é¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥åˆæ­¥ä½“ä¼šåˆ°ä½¿ç”¨ Stream å¤„ç†é›†åˆçš„ä¾¿åˆ©æ€§ã€‚åˆæŽ¢Streamæœ‰å¦‚ä¸‹ä¸€ä¸ªListï¼ŒçŽ°è¦ä»Žä¸­ç­›é€‰å‡ºä»¥Jå¼€å¤´çš„å…ƒç´ ï¼Œç„¶åŽè½¬æ¢ä¸ºå¤§å†™ï¼Œæœ€åŽè¾“å‡ºç»“æžœã€‚Java 8ä¹‹å‰æˆ‘ä»¬æ˜¯è¿™æ ·åšçš„ï¼š12345678910List&lt;String&gt; list = Arrays.asList("Java", "JavaScript", "python", "PHP", "C#", "Golang", "Swift");List&lt;String&gt; filterList = new ArrayList&lt;&gt;();for (String str : list) &#123; if (str.startsWith("J")) &#123; filterList.add(str.toUpperCase()); &#125;&#125;for (String str : filterList) &#123; System.out.println(str);&#125;ä¸ºäº†ç­›é€‰é›†åˆæˆ‘ä»¬è¿›è¡Œäº†ä¸¤æ¬¡å¤–éƒ¨è¿­ä»£ï¼Œå¹¶ä¸”è¿˜åˆ›å»ºäº†ä¸€ä¸ªç”¨æ¥ä¸´æ—¶å­˜æ”¾ç­›é€‰å…ƒç´ çš„é›†åˆå¯¹è±¡ã€‚å€ŸåŠ©Java 8ä¸­çš„Streamæˆ‘ä»¬å¯ä»¥æžå¤§çš„ç®€åŒ–è¿™ä¸ªå¤„ç†è¿‡ç¨‹ï¼š12345List&lt;String&gt; list = Arrays.asList("Java", "JavaScript", "python", "PHP", "C#", "Golang", "Swift");list.stream() .filter(s -&gt; s.startsWith("J")) .map(String::toUpperCase) .forEach(System.out::println);æ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Ÿä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé›†åˆä½¿ç”¨streamæ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªæµï¼Œç„¶åŽä½¿ç”¨filterå’Œmapæ–¹æ³•æ¥å¤„ç†è¿™ä¸ªé›†åˆï¼Œå®ƒä»¬ç»Ÿç§°ä¸ºä¸­é—´æ“ä½œã€‚ä¸­é—´æ“ä½œéƒ½ä¼šè¿”å›žå¦ä¸€ä¸ªæµï¼Œä»¥ä¾¿äºŽå°†å„ç§å¯¹é›†åˆçš„æ“ä½œè¿žæŽ¥èµ·æ¥å½¢æˆä¸€æ¡æµæ°´çº¿ã€‚æœ€åŽæˆ‘ä»¬ä½¿ç”¨äº†forEachæ–¹æ³•è¿­ä»£ç­›é€‰ç»“æžœï¼Œè¿™ç§ä½äºŽæµçš„æœ«ç«¯ï¼Œå¯¹æµè¿›è¡Œå¤„ç†å¹¶ä¸”ç”Ÿæˆç»“æžœçš„æ–¹æ³•ç§°ä¸ºç»ˆç«¯æ“ä½œã€‚æ€»è€Œè¨€ä¹‹ï¼Œæµçš„ä½¿ç”¨ä¸€èˆ¬åŒ…æ‹¬ä¸‰ä»¶äº‹æƒ…ï¼šä¸€ä¸ªæ•°æ®æºï¼ˆå¦‚é›†åˆï¼‰æ¥æ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢ï¼›ä¸€ä¸ªä¸­é—´æ“ä½œé“¾ï¼Œå½¢æˆä¸€æ¡æµçš„æµæ°´çº¿ï¼›ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰§è¡Œæµæ°´çº¿ï¼Œå¹¶èƒ½ç”Ÿæˆç»“æžœã€‚ä¸‹è¡¨åˆ—å‡ºäº†æµä¸­å¸¸è§çš„ä¸­é—´æ“ä½œå’Œç»ˆç«¯æ“ä½œï¼šæ“ä½œç±»åž‹è¿”å›žç±»åž‹ä½¿ç”¨çš„ç±»åž‹/å‡½æ•°å¼æŽ¥å£å‡½æ•°æè¿°ç¬¦filterä¸­é—´Stream&lt;T&gt;Predicate&lt;T&gt;T -&gt; booleandistinctä¸­é—´Stream&lt;T&gt;skipä¸­é—´Stream&lt;T&gt;longlimitä¸­é—´Stream&lt;T&gt;longmapä¸­é—´Stream&lt;R&gt;Function&lt;T, R&gt;T -&gt; RflatMapä¸­é—´Stream&lt;R&gt;Function&lt;T, Stream&lt;R&gt;&gt;T -&gt; Stream&lt;R&gt;sortedä¸­é—´Stream&lt;T&gt;Comparator&lt;T&gt;(T, T) -&gt; intanyMatchç»ˆç«¯booleanPredicate&lt;T&gt;T -&gt; booleannoneMatchç»ˆç«¯booleanPredicate&lt;T&gt;T -&gt; booleanallMatchç»ˆç«¯booleanPredicate&lt;T&gt;T -&gt; booleanfindAnyç»ˆç«¯Optional&lt;T&gt;findFirstç»ˆç«¯Optional&lt;T&gt;forEachç»ˆç«¯voidConsumer&lt;T&gt;T -&gt; voidcollectç»ˆç«¯RCollector&lt;T, A, R&gt;reduceç»ˆç«¯Optional&lt;T&gt;BinaryOperator&lt;T&gt;(T, T) -&gt; Tcountç»ˆç«¯longä¸‹é¢è¯¦ç»†ä»‹ç»è¿™äº›æ“ä½œçš„ä½¿ç”¨ã€‚é™¤äº†ç‰¹æ®Šè¯´æ˜Žï¼Œé»˜è®¤ä½¿ç”¨ä¸‹é¢è¿™ä¸ªé›†åˆä½œä¸ºæ¼”ç¤ºï¼š1List&lt;String&gt; list = Arrays.asList("Java", "JavaScript", "python", "PHP", "C#", "Golang", "Swift", "C++", "Ruby");ä¸­é—´æ“ä½œfilterStreamsæŽ¥å£æ”¯æŒÂ·filteræ–¹æ³•ï¼Œè¯¥æ–¹æ³•æŽ¥æ”¶ä¸€ä¸ªPredicate&lt;T&gt;ï¼Œå‡½æ•°æè¿°ç¬¦ä¸ºT -&gt; booleanï¼Œç”¨äºŽå¯¹é›†åˆè¿›è¡Œç­›é€‰ï¼Œè¿”å›žæ‰€æœ‰æ»¡è¶³çš„å…ƒç´ ï¼š123list.stream() .filter(s -&gt; s.contains("#")) .forEach(System.out::println);ç»“æžœè¾“å‡ºC#ã€‚distinctdistinctæ–¹æ³•ç”¨äºŽæŽ’é™¤æµä¸­é‡å¤çš„å…ƒç´ ï¼Œç±»ä¼¼äºŽSQLä¸­çš„distinctæ“ä½œã€‚æ¯”å¦‚ç­›é€‰ä¸­é›†åˆä¸­æ‰€æœ‰çš„å¶æ•°ï¼Œå¹¶æŽ’é™¤é‡å¤çš„ç»“æžœï¼š12345List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 1, 3, 3, 2, 4);numbers.stream() .filter(i -&gt; i % 2 == 0) .distinct() .forEach(System.out::println);ç»“æžœè¾“å‡º2 4ã€‚skipskip(n)æ–¹æ³•ç”¨äºŽè·³è¿‡æµä¸­çš„å‰nä¸ªå…ƒç´ ï¼Œå¦‚æžœé›†åˆå…ƒç´ å°äºŽnï¼Œåˆ™è¿”å›žç©ºæµã€‚æ¯”å¦‚ç­›é€‰å‡ºä»¥Jå¼€å¤´çš„å…ƒç´ ï¼Œå¹¶æŽ’é™¤ç¬¬ä¸€ä¸ªï¼š1234list.stream() .filter(s -&gt; s.startsWith("J")) .skip(1) .forEach(System.out::println);ç»“æžœè¾“å‡ºJavaScriptã€‚limitlimit(n)æ–¹æ³•è¿”å›žä¸€ä¸ªé•¿åº¦ä¸è¶…è¿‡nçš„æµï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­å°†è¾“å‡ºJava JavaScript pythonï¼š123list.stream() .limit(3) .forEach(System.out::println);mapmapæ–¹æ³•æŽ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šè¢«åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šï¼Œå¹¶å°†å…¶æ˜ å°„æˆä¸€ä¸ªæ–°çš„å…ƒç´ ã€‚å¦‚ï¼š123list.stream() .map(String::length) .forEach(System.out::println);ç»“æžœè¾“å‡º4 10 6 3 2 6 5 3 4ã€‚mapè¿˜æ”¯æŒå°†æµç‰¹åŒ–ä¸ºæŒ‡å®šåŽŸå§‹ç±»åž‹çš„æµï¼Œå¦‚é€šè¿‡mapToIntï¼ŒmapToDoubleå’ŒmapToLongæ–¹æ³•ï¼Œå¯ä»¥å°†æµè½¬æ¢ä¸ºIntStreamï¼ŒDoubleStreamå’ŒLongStreamã€‚ç‰¹åŒ–åŽçš„æµæ”¯æŒsumï¼Œminå’Œmaxæ–¹æ³•æ¥å¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œè®¡ç®—ã€‚æ¯”å¦‚ï¼š123List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 1, 3, 3, 2, 4);IntStream intStream = numbers.stream().mapToInt(a -&gt; a);System.out.println(intStream.sum()); // 16ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•ï¼Œå°†IntStreamè½¬æ¢ä¸ºStreamï¼š1Stream&lt;Integer&gt; s = intStream.boxed();flatMapflatMapç”¨äºŽå°†å¤šä¸ªæµåˆå¹¶æˆä¸€ä¸ªæµï¼Œä¿—ç§°æµçš„æ‰å¹³åŒ–ã€‚è¿™ä¹ˆè¯´æœ‰ç‚¹æŠ½è±¡ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚çŽ°åœ¨éœ€è¦å°†listä¸­çš„å„ä¸ªå…ƒç´ æ‹†åˆ†ä¸ºä¸€ä¸ªä¸ªå­—æ¯ï¼Œå¹¶è¿‡æ»¤æŽ‰é‡å¤çš„ç»“æžœï¼Œä½ å¯èƒ½ä¼šè¿™æ ·åšï¼š1234list.stream() .map(s -&gt; s.split("")) .distinct() .forEach(System.out::println);è¾“å‡ºå¦‚ä¸‹ï¼š123456789[Ljava.lang.String;@e9e54c2[Ljava.lang.String;@65ab7765[Ljava.lang.String;@1b28cdfa[Ljava.lang.String;@eed1f14[Ljava.lang.String;@7229724f[Ljava.lang.String;@4c873330[Ljava.lang.String;@119d7047[Ljava.lang.String;@776ec8df[Ljava.lang.String;@4eec7777è¿™æ˜Žæ˜¾ä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚å®žé™…ä¸Šåœ¨map(s -&gt; s.split(&quot;&quot;))æ“ä½œåŽï¼Œè¿”å›žäº†ä¸€ä¸ªStream&lt;String[]&gt;ç±»åž‹çš„æµï¼Œæ‰€ä»¥è¾“å‡ºç»“æžœä¸ºæ¯ä¸ªæ•°ç»„å¯¹è±¡çš„å¥æŸ„ï¼Œè€Œæˆ‘ä»¬çœŸæ­£æƒ³è¦çš„ç»“æžœæ˜¯Stream&lt;String&gt;ï¼åœ¨Streamä¸­ï¼Œå¯ä»¥ä½¿ç”¨Arrays.stream()æ–¹æ³•æ¥å°†æ•°ç»„è½¬æ¢ä¸ºæµï¼Œæ”¹é€ ä¸Šé¢çš„æ–¹æ³•ï¼š12345list.stream() .map(s -&gt; s.split("")) .map(Arrays::stream) .distinct() .forEach(System.out::println);è¾“å‡ºå¦‚ä¸‹ï¼š123456789java.util.stream.ReferencePipeline$Head@eed1f14java.util.stream.ReferencePipeline$Head@7229724fjava.util.stream.ReferencePipeline$Head@4c873330java.util.stream.ReferencePipeline$Head@119d7047java.util.stream.ReferencePipeline$Head@776ec8dfjava.util.stream.ReferencePipeline$Head@4eec7777java.util.stream.ReferencePipeline$Head@3b07d329java.util.stream.ReferencePipeline$Head@41629346java.util.stream.ReferencePipeline$Head@404b9385å› ä¸ºä¸Šé¢çš„æµç»è¿‡map(Arrays::stream)å¤„ç†åŽï¼Œå°†æ¯ä¸ªæ•°ç»„å˜æˆäº†ä¸€ä¸ªæ–°çš„æµï¼Œè¿”å›žç»“æžœä¸ºæµçš„æ•°ç»„Stream&lt;String&gt;[]ï¼Œæ‰€ä»¥è¾“å‡ºæ˜¯å„ä¸ªæµçš„å¥æŸ„ã€‚æˆ‘ä»¬è¿˜éœ€å°†è¿™äº›æ–°çš„æµè¿žæŽ¥æˆä¸€ä¸ªæµï¼Œä½¿ç”¨flatMapæ¥æ”¹å†™ä¸Šé¢çš„ä¾‹å­ï¼š12345list.stream() .map(s -&gt; s.split("")) .flatMap(Arrays::stream) .distinct() .forEach(s -&gt; System.out.print(s + " "));è¾“å‡ºå¦‚ä¸‹ï¼š1J a v S c r i p t y h o n P H C # G l g w f + R u bå’Œmapç±»ä¼¼ï¼ŒflatMapæ–¹æ³•ä¹Ÿæœ‰ç›¸åº”çš„åŽŸå§‹ç±»åž‹ç‰¹åŒ–æ–¹æ³•ï¼Œå¦‚flatMapToIntç­‰ã€‚ç»ˆç«¯æ“ä½œanyMatchanyMatchæ–¹æ³•ç”¨äºŽåˆ¤æ–­æµä¸­æ˜¯å¦æœ‰ç¬¦åˆåˆ¤æ–­æ¡ä»¶çš„å…ƒç´ ï¼Œè¿”å›žå€¼ä¸ºbooleanç±»åž‹ã€‚æ¯”å¦‚åˆ¤æ–­listä¸­æ˜¯å¦å«æœ‰SQLå…ƒç´ ï¼š12list.stream() .anyMatch(s -&gt; "SQL".equals(s)); // falseallMatchallMatchæ–¹æ³•ç”¨äºŽåˆ¤æ–­æµä¸­æ˜¯å¦æ‰€æœ‰å…ƒç´ éƒ½æ»¡è¶³ç»™å®šçš„åˆ¤æ–­æ¡ä»¶ï¼Œè¿”å›žå€¼ä¸ºbooleanç±»åž‹ã€‚æ¯”å¦‚åˆ¤æ–­listä¸­æ˜¯å¦æ‰€æœ‰å…ƒç´ é•¿åº¦éƒ½ä¸å¤§äºŽ10ï¼š12list.stream() .allMatch(s -&gt; s.length() &lt;= 10); // truenoneMatchnoneMatchæ–¹æ³•ç”¨äºŽåˆ¤æ–­æµä¸­æ˜¯å¦æ‰€æœ‰å…ƒç´ éƒ½ä¸æ»¡è¶³ç»™å®šçš„åˆ¤æ–­æ¡ä»¶ï¼Œè¿”å›žå€¼ä¸ºbooleanç±»åž‹ã€‚æ¯”å¦‚åˆ¤æ–­listä¸­ä¸å­˜åœ¨é•¿åº¦å¤§äºŽ10çš„å…ƒç´ ï¼š12list.stream() .noneMatch(s -&gt; s.length() &gt; 10); // truefindAnyfindAnyæ–¹æ³•ç”¨äºŽè¿”å›žæµä¸­çš„ä»»æ„å…ƒç´ çš„Optionalç±»åž‹ï¼Œä¾‹å¦‚ç­›é€‰å‡ºlistä¸­ä»»æ„ä¸€ä¸ªä»¥Jå¼€å¤´çš„å…ƒç´ ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¾“å‡ºå®ƒï¼š1234list.stream() .filter(s -&gt; s.startsWith("J")) .findAny() .ifPresent(System.out::println); // JavafindFirstfindFirstæ–¹æ³•ç”¨äºŽè¿”å›žæµä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„Optionalç±»åž‹ï¼Œä¾‹å¦‚ç­›é€‰å‡ºlistä¸­é•¿åº¦å¤§äºŽ5çš„å…ƒç´ ï¼Œå¦‚æžœå­˜åœ¨ï¼Œåˆ™è¾“å‡ºç¬¬ä¸€ä¸ªï¼š1234list.stream() .filter(s -&gt; s.length() &gt; 5) .findFirst() .ifPresent(System.out::println); // JavaScriptreducereduceå‡½æ•°ä»Žå­—é¢ä¸Šæ¥çœ‹å°±æ˜¯åŽ‹ç¼©ï¼Œç¼©å‡çš„æ„æ€ï¼Œå®ƒå¯ä»¥ç”¨äºŽæ•°å­—ç±»åž‹çš„æµçš„æ±‚å’Œï¼Œæ±‚æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚å¦‚å¯¹numbersä¸­çš„å…ƒç´ æ±‚å’Œï¼š123List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 1, 3, 3, 2, 4);numbers.stream() .reduce(0, Integer::sum); // 16reduceå‡½æ•°ä¹Ÿå¯ä»¥ä¸æŒ‡å®šåˆå§‹å€¼ï¼Œä½†è¿™æ—¶å€™å°†è¿”å›žä¸€ä¸ªOptionalå¯¹è±¡ï¼Œæ¯”å¦‚æ±‚æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼š1234567numbers.stream() .reduce(Integer::max) .ifPresent(System.out::println); // 4numbers.stream() .reduce(Integer::min) .ifPresent(System.out::println); // 1forEachforEachç”¨äºŽè¿­ä»£æµä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œæœ€ä¸ºå¸¸è§çš„å°±æ˜¯è¿­ä»£è¾“å‡ºï¼Œå¦‚ï¼š1list.stream().forEach(System.out::println);countcountæ–¹æ³•ç”¨äºŽç»Ÿè®¡æµä¸­å…ƒç´ çš„ä¸ªæ•°ï¼Œæ¯”å¦‚ï¼š1list.stream().count(); // 9collectcollectæ–¹æ³•ç”¨äºŽæ”¶é›†æµä¸­çš„å…ƒç´ ï¼Œå¹¶æ”¾åˆ°ä¸åŒç±»åž‹çš„ç»“æžœä¸­ï¼Œæ¯”å¦‚Listã€Setæˆ–è€…Mapã€‚ä¸¾ä¸ªä¾‹å­ï¼š12List&lt;String&gt; filterList = list.stream() .filter(s -&gt; s.startsWith("J")).collect(Collectors.toList());å¦‚æžœéœ€è¦ä»¥Setæ¥æ›¿ä»£Listï¼Œåªéœ€è¦ä½¿ç”¨Collectors.toSet()å°±å¥½äº†ã€‚æµçš„æž„å»ºé™¤äº†ä½¿ç”¨é›†åˆå¯¹è±¡çš„streamæ–¹æ³•æž„å»ºæµä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æž„å»ºä¸€äº›æµã€‚æ•°å€¼èŒƒå›´æž„å»ºIntStreamå’ŒLongStreamå¯¹è±¡æ”¯æŒrangeå’ŒrangeClosedæ–¹æ³•æ¥æž„å»ºæ•°å€¼æµã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æŽ¥å—èµ·å§‹å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æŽ¥å—ç»“æŸå€¼ã€‚ä½†rangeæ˜¯ä¸åŒ…å«ç»“æŸå€¼çš„ï¼Œè€ŒrangeClosedåˆ™åŒ…å«ç»“æŸå€¼ã€‚æ¯”å¦‚å¯¹1åˆ°100çš„æ•´æ•°æ±‚å’Œï¼š1IntStream.rangeClosed(1, 100).sum(); // 5050ç”±å€¼æž„å»ºé™æ€æ–¹æ³•Stream.ofå¯ä»¥æ˜¾å¼å€¼åˆ›å»ºä¸€ä¸ªæµã€‚å®ƒå¯ä»¥æŽ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ç›´æŽ¥ä½¿ç”¨Stream.ofåˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²æµ:1Stream&lt;String&gt; s = Stream.of("Java", "JavaScript", "C++", "Ruby");ä¹Ÿå¯ä»¥ä½¿ç”¨Stream.empty()æž„å»ºä¸€ä¸ªç©ºæµï¼š1Stream&lt;Object&gt; emptyStream = Stream.empty();ç”±æ•°ç»„æž„å»ºé™æ€æ–¹æ³•Arrays.streamå¯ä»¥é€šè¿‡æ•°ç»„åˆ›å»ºä¸€ä¸ªæµã€‚å®ƒæŽ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ã€‚ä¾‹å¦‚ï¼š12int[] arr = &#123;1, 2, 3, 4, 5&#125;;IntStream intStream = Arrays.stream(arr);ç”±æ–‡ä»¶ç”Ÿæˆæµjava.nio.file.Filesä¸­çš„å¾ˆå¤šé™æ€æ–¹æ³•éƒ½ä¼šè¿”å›žä¸€ä¸ªæµã€‚ä¾‹å¦‚Files.linesæ–¹æ³•ä¼šè¿”å›žä¸€ä¸ªç”±æŒ‡å®šæ–‡ä»¶ä¸­çš„å„è¡Œæž„æˆçš„å­—ç¬¦ä¸²æµã€‚æ¯”å¦‚ç»Ÿè®¡ä¸€ä¸ªæ–‡ä»¶ä¸­å…±æœ‰å¤šå°‘ä¸ªå­—ï¼š123456long wordCout = 0L;try (Stream&lt;String&gt; lines = Files.lines(Paths.get("file.txt"), Charset.defaultCharset())) &#123; wordCout = lines.map(l -&gt; l.split("")) .flatMap(Arrays::stream) .count();&#125; catch (Exception ignore) &#123;&#125;ç”±å‡½æ•°æž„é€ Stream APIæä¾›äº†ä¸¤ä¸ªé™æ€æ–¹æ³•æ¥ä»Žå‡½æ•°ç”Ÿæˆæµï¼šStream.iterateå’ŒStream.generateã€‚è¿™ä¸¤ä¸ªæ“ä½œå¯ä»¥åˆ›å»ºæ‰€è°“çš„æ— é™æµã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­æž„å»ºäº†10ä¸ªå¶æ•°ï¼š12Stream.iterate(0, n -&gt; n + 2) .limit(10).forEach(System.out::println);iterateæ–¹æ³•æŽ¥å—ä¸€ä¸ªåˆå§‹å€¼ï¼ˆåœ¨è¿™é‡Œæ˜¯0ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ªä¾æ¬¡åº”ç”¨åœ¨æ¯ä¸ªäº§ç”Ÿçš„æ–°å€¼ä¸Šçš„Lambdaï¼ˆUnaryOperatorç±»åž‹ï¼‰ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨Lambda n -&gt; n + 2ï¼Œè¿”å›žçš„æ˜¯å‰ä¸€ä¸ªå…ƒ ç´ åŠ ä¸Š2ã€‚å› æ­¤ï¼Œiterateæ–¹æ³•ç”Ÿæˆäº†ä¸€ä¸ªæ‰€æœ‰æ­£å¶æ•°çš„æµï¼šæµçš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯åˆå§‹å€¼0ã€‚ç„¶åŽåŠ ä¸Š2æ¥ç”Ÿæˆæ–°çš„å€¼2ï¼Œå†åŠ ä¸Š2æ¥å¾—åˆ°æ–°çš„å€¼4ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚ä¸Žiterateæ–¹æ³•ç±»ä¼¼ï¼Œgenerateæ–¹æ³•ä¹Ÿå¯è®©ä½ æŒ‰éœ€ç”Ÿæˆä¸€ä¸ªæ— é™æµã€‚ä½†generateä¸æ˜¯ä¾æ¬¡å¯¹æ¯ä¸ªæ–°ç”Ÿæˆçš„å€¼åº”ç”¨å‡½æ•°ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ç”Ÿæˆäº†5ä¸ª0åˆ°1ä¹‹é—´çš„éšæœºåŒç²¾åº¦æ•°ï¼š123Stream.generate(Math::random) .limit(5) .forEach(System.out::println);è¾“å‡ºç»“æžœå¦‚ä¸‹ï¼š123450.63346468505878630.41901476418340090.43619683945154750.69117964568386550.08156838267267075ã€ŠJava 8å®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Java 8</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RHELç¦»çº¿å®‰è£…Rubyå’ŒRubyGems]]></title>
    <url>%2FRHELinstallRuby%26RubyGems.html</url>
    <content type="text"><![CDATA[æ­å»ºRedisé›†ç¾¤è¿‡ç¨‹ä¸­éœ€è¦å®‰è£…RubyçŽ¯å¢ƒï¼Œè¿™é‡Œè®°å½•ä¸‹åœ¨RHELä¸‹ç¦»çº¿å®‰è£…Rubyå’ŒRubyGemsçš„æ–¹æ³•ã€‚Rubyçš„åœ¨çº¿ä¸‹è½½åœ°å€ä¸ºhttps://www.ruby-lang.org/en/downloads/ï¼Œä¸‹è½½å¥½åŽä¸Šä¼ åˆ°/usr/loaclç›®å½•ä¸‹ã€‚å¦‚æžœä¹‹å‰å·²ç»å®‰è£…è¿‡ä½Žç‰ˆæœ¬çš„Rubyçš„è¯å¯ä»¥å…ˆä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤å¸è½½:1sudo yum remove ruby ruby-develè¿™é‡Œæˆ‘ä»¬ä¸‹è½½çš„Rubyç‰ˆæœ¬ä¸º2.5.1ï¼Œè§£åŽ‹ruby-2.5.1.tar.gzï¼š1tar -zxvf ruby-2.5.1.tar.gzæŽ¥ç€ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š1234cd /usr/local/ruby-2.5.1./configuremakesudo make installå®‰è£…å¥½åŽæŸ¥çœ‹Rubyçš„ç‰ˆæœ¬ï¼š1ruby -vå¦‚æžœæç¤º-bash: /usr/local/bin/ruby: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è¯ï¼Œå¯ä»¥å°†Rubyç›®å½•ä¸‹çš„rubyæ–‡ä»¶æ‹·è´åˆ°/usr/local/binç›®å½•ä¸‹ï¼š123cp /usr/local/ruby-2.5.1/ruby /usr/local/bin/ruby -vruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux]å®‰è£…å¥½RubyåŽï¼Œæˆ‘ä»¬æŽ¥ç€å®‰è£…RubyGemsã€‚RubyGemsæ˜¯Rubyçš„ä¸€ä¸ªåŒ…ç®¡ç†å™¨ï¼Œå®ƒæä¾›ä¸€ä¸ªåˆ†å‘Rubyç¨‹åºå’Œåº“çš„æ ‡å‡†æ ¼å¼ï¼Œè¿˜æä¾›ä¸€ä¸ªç®¡ç†ç¨‹åºåŒ…å®‰è£…çš„å·¥å…·ã€‚RubyGemsæ—¨åœ¨æ–¹ä¾¿åœ°ç®¡ç†gemå®‰è£…çš„å·¥å…·ï¼Œä»¥åŠç”¨äºŽåˆ†å‘gemçš„æœåŠ¡å™¨ã€‚è¿™ç±»ä¼¼äºŽUbuntuä¸‹çš„apt-getï¼ŒCentos çš„yumï¼ŒPythonçš„pipã€‚RubyGemsçš„ä¸‹è½½åœ°å€ä¸ºï¼šhttps://rubygems.org/pages/downloadï¼Œè¿™é‡Œæˆ‘ä»¬ä¸‹è½½çš„ç‰ˆæœ¬ä¸º2.7.7ã€‚ä¸‹è½½å¥½åŽï¼Œä¸Šä¼ åˆ°/usr/localç›®å½•ä¸‹ï¼Œç„¶åŽè§£åŽ‹ï¼š1tar -zxvf rubygems-2.7.7.tgzæŽ¥ç€åˆ‡æ¢åˆ°è§£åŽ‹åŽçš„ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š1ruby setup.rbå®‰è£…å¥½åŽï¼ŒæŸ¥çœ‹RubyGemsç‰ˆæœ¬ï¼š12gem -v2.7.7å®‰è£…ç»“æŸã€‚]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>Ruby</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxä¸‹æ­å»ºRedisé›†ç¾¤]]></title>
    <url>%2Flinux-redis-cluster.html</url>
    <content type="text"><![CDATA[é€šè¿‡Redisçš„é›†ç¾¤ï¼Œæˆ‘ä»¬å¯ä»¥å®žçŽ°å¤šä¸ªRedisèŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®å…±äº«ï¼Œå¹¶ä¸”æ”¯æŒè‡ªåŠ¨åˆ†å‰²æ•°æ®åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Šã€‚åœ¨é›†ç¾¤è¿‡ç¨‹ä¸­é€šè¿‡ä¸»ä»Žçš„åˆ†é…å¯ä»¥æé«˜Redisçš„å¯ç”¨æ€§ï¼Œä¸ä¼šå› ä¸ºæŸä¸ªèŠ‚ç‚¹å®•æŽ‰æˆ–è€…ä¸å¯è¾¾è€Œå¯¼è‡´æ•´ä¸ªé›†ç¾¤ç½‘ç»œçš„ä¸å¯ç”¨ã€‚Redis 3.0ç‰ˆæœ¬åŽæ”¯æŒä½¿ç”¨Redis-Clusteræ¥æ­å»ºé›†ç¾¤ï¼Œæœ¬æ–‡å°†ä»‹ç»åœ¨Ubuntu 16.04ä¸‹ä»Žé›¶å¼€å§‹æ­å»ºRedisé›†ç¾¤ã€‚å› ä¸ºRedisé›†ç¾¤ä¸­è‡³å°‘åº”è¯¥æœ‰å¥‡æ•°ä¸ªä¸»èŠ‚ç‚¹ï¼Œæ‰€ä»¥æœ¬æ–‡å°†åˆ›å»º6ä¸ªRedisèŠ‚ç‚¹ï¼Œå…¶ä¸­3ä¸ªä¸ºä¸»èŠ‚ç‚¹ï¼Œ3ä¸ªä¸ºä»Žå±žèŠ‚ç‚¹ï¼Œç”¨äºŽä»Žä¸»èŠ‚ç‚¹æ‹‰å–æ•°æ®è¿›è¡Œå¤‡ä»½ã€‚å®‰è£…Redisä»Žhttps://redis.io/downloadä¸ŠèŽ·å–æœ€æ–°çš„Stableç‰ˆæœ¬Redisï¼Œä¸‹è½½åˆ°/usr/local/ç›®å½•ä¸‹å¹¶è§£åŽ‹ï¼š12wget http://download.redis.io/releases/redis-4.0.9.tar.gztar -zxvf redis-4.0.9.tar.gzè¿›è¡Œç¼–è¯‘å’Œå®‰è£…ï¼š12cd redis-4.0.9/make &amp;&amp; make installå®‰è£…æˆåŠŸåŽå¼€å§‹è¿›è¡Œé›†ç¾¤æ­å»ºã€‚æ­å»ºé›†ç¾¤ç¼–è¯‘å®‰è£…åŽï¼Œåœ¨Reidsçš„srcç›®å½•ä¸‹æœ‰ä¸ªredis-trib.rbæ–‡ä»¶ï¼Œå°†å…¶å¤åˆ¶åˆ°/usr/local/bin/ç›®å½•ä¸‹ï¼Œæ–¹ä¾¿åŽæœŸæ­å»ºé›†ç¾¤ä½¿ç”¨ï¼š æŽ¥ä¸‹æ¥å¼€å§‹åˆ›å»ºèŠ‚ç‚¹ã€‚åœ¨redisç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªclusterç›®å½•ï¼š1mkdir clusterç„¶åŽåœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºå…­ä¸ªç›®å½•ï¼Œåˆ†åˆ«å‘½åä¸º7000ã€7001ã€7002ã€7003ã€7004å’Œ7005ï¼š12cd cluster/mkdir 7000 7001 7002 7003 7004 7005åœ¨7000ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªRedisé…ç½®æ–‡ä»¶redis.confï¼Œå†…å®¹å¦‚ä¸‹ï¼š12345678port 7000bind 172.16.0.4daemonize yespidfile /var/run/redis_7000.pidcluster-enabled yescluster-config-file nodes_7000.confcluster-node-timeout 15000appendonly yesä¸Šè¿°é…ç½®æ˜¯å¼€å¯Redisé›†ç¾¤çš„æœ€ç®€é…ç½®ï¼Œå„é¡¹é…ç½®çš„å«ä¹‰å¦‚ä¸‹ï¼šport 7000ï¼šRedisèŠ‚ç‚¹çš„ç«¯å£å·ä¸º7000ï¼›bind 172.16.0.4ï¼šç»‘å®šæœ¬æœºçš„IPåœ°å€ï¼›daemonize yesï¼šä»¥åŽå°æœåŠ¡çš„å½¢å¼å¼€å¯Redisï¼›pidfile /var/run/redis_7000.pidï¼šä»¥è¯¥é…ç½®å¯åŠ¨RedisåŽå°†åœ¨/var/run/ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªredis_port.pidæ–‡ä»¶ï¼›cluster-enabled yesï¼šæ˜¯å¦å¼€å¯é›†ç¾¤ï¼Œyesï¼›cluster-config-file nodes_7000.confï¼šé›†ç¾¤é…ç½®æ–‡ä»¶ï¼Œå¯åŠ¨åŽè‡ªåŠ¨ç”Ÿæˆï¼Œæ–‡ä»¶åç§°ä¸ºnodes_7000.confã€‚è¯¥æ–‡ä»¶å°†ä¿æŒé›†ç¾¤é…ç½®ä¿¡æ¯ï¼Œä»¥ä¿è¯é‡å¯è¯¥RedisèŠ‚ç‚¹åŽèƒ½å¤Ÿä¿æŒé›†ç¾¤çŠ¶æ€ï¼›cluster-node-timeout 15000ï¼šè¯·æ±‚è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º15ç§’ï¼›appendonly yesï¼šæ˜¯å¦å¼€å¯aofæ—¥å¿—ï¼Œå¼€å¯åŽæ¯æ¬¡å†™æ“ä½œéƒ½è®°å½•ä¸€æ¡æ—¥å¿—ã€‚å‰©ä¸‹çš„7001~7005çš„é…ç½®æ–‡ä»¶é™¤äº†ç«¯å£å·æ”¹ä¸ºç›¸åº”çš„å¤–ï¼Œå…¶ä»–é…ç½®ä¿æŒä¸€è‡´ã€‚é…ç½®å¥½7000~7005ç«¯å£çš„Redisé…ç½®æ–‡ä»¶åŽï¼Œå¯åŠ¨è¿™äº›èŠ‚ç‚¹ï¼š123456redis-server cluster/7000/redis.confredis-server cluster/7001/redis.confredis-server cluster/7002/redis.confredis-server cluster/7003/redis.confredis-server cluster/7004/redis.confredis-server cluster/7005/redis.confæŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸï¼šçŽ°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†6ä¸ªæ­£åœ¨è¿è¡Œä¸­çš„Rediså®žä¾‹ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨è¿™äº›å®žä¾‹æ¥åˆ›å»ºé›†ç¾¤ã€‚æŽ¥ç€ä½¿ç”¨redis-trib.rbåˆ›å»ºé›†ç¾¤ï¼Œè¯¥æ–‡ä»¶ä½¿ç”¨rubyç¼–å†™ï¼Œæ‰€ä»¥ä½¿ç”¨redis-trib.rbä¹‹å‰å¾—å…ˆå®‰è£…rubyï¼š12apt-get install rubygem install rediså®‰è£…å¥½rubyåŽï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤å¼€å¯é›†ç¾¤ï¼š1redis-trib.rb create --replicas 1 172.16.0.4:7000 172.16.0.4:7001 172.16.0.4:7002 172.16.0.4:7003 172.16.0.4:7004 172.16.0.4:7005é€‰é¡¹--replicas 1è¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›ä¸ºé›†ç¾¤ä¸­çš„æ¯ä¸ªä¸»èŠ‚ç‚¹åˆ›å»ºä¸€ä¸ªä»ŽèŠ‚ç‚¹ï¼Œä¹‹åŽè·Ÿç€çš„å…¶ä»–å‚æ•°åˆ™æ˜¯è¿™ä¸ªé›†ç¾¤å®žä¾‹çš„åœ°å€åˆ—è¡¨ï¼š3ä¸ªä¸»èŠ‚ç‚¹ï¼ˆMasterï¼Œå³7000~7002ï¼‰3ä¸ªä»ŽèŠ‚ç‚¹ï¼ˆSlaveï¼Œå³7003~7005ï¼‰ã€‚è¾“å…¥è¯¥å‘½ä»¤åŽï¼Œç»ˆç«¯æ‰“å°å‡ºå¦‚ä¸‹é…ç½®ï¼šå…¶ä¸­Må¼€å¤´çš„èŠ‚ç‚¹ä¸ºä¸»èŠ‚ç‚¹ï¼ŒSå¼€å¤´çš„ä¸ºä»ŽèŠ‚ç‚¹ã€‚ä»Žä»ŽèŠ‚ç‚¹çš„replicatesï¼ˆå¤åˆ¶çš„æ„æ€ï¼‰ä¿¡æ¯å¯ä»¥çœ‹å‡º7000çš„ä»ŽèŠ‚ç‚¹ä¸º7004ï¼Œ7001çš„ä»ŽèŠ‚ç‚¹ä¸º7005ï¼Œ7002çš„ä»ŽèŠ‚ç‚¹ä¸º7003ã€‚ç¡®è®¤æ— è¯¯åŽè¾“å…¥yesç‚¹å‡»å›žè½¦ç»§ç»­ï¼šå¯çœ‹åˆ°7000èŠ‚ç‚¹çš„æ‹¥æœ‰5461ä¸ªå“ˆå¸Œæ§½ï¼ˆ0 - 6460 slotsï¼‰ï¼Œ7001èŠ‚ç‚¹æ‹¥æœ‰5462ä¸ªå“ˆå¸Œæ§½ï¼ˆ5461 - 10922 slotsï¼‰ï¼Œ7002èŠ‚ç‚¹æ‹¥æœ‰5461ä¸ªå“ˆå¸Œæ§½ï¼ˆ10923 - 16383 slotsï¼‰ï¼Œè€Œä»Žå±žèŠ‚ç‚¹å¹¶æ²¡æœ‰åˆ†é…å“ˆå¸Œæ§½ã€‚ä»Žæœ€åŽä¸€è¡Œçš„è¾“å‡ºä¿¡æ¯å¯ä»¥çœ‹å‡ºï¼ŒRedisé›†ç¾¤æ€»å…±æœ‰16384ä¸ªå“ˆå¸Œæ§½ï¼ˆslotsï¼‰ã€‚æ­¤å¤–ï¼Œé‚£äº›ä¸€å¤§ä¸²çš„å­—ç¬¦ç§°ä¸ºèŠ‚ç‚¹IDã€‚é›†ç¾¤æµ‹è¯•é€šè¿‡ä¸Šé¢çš„é›†ç¾¤é…ç½®ï¼Œè¿™6ä¸ªRedisèŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤ºï¼šé¢œè‰²æ·±çš„èŠ‚ç‚¹ä¸ºé¢œè‰²æµ…çš„èŠ‚ç‚¹çš„ä¸»èŠ‚ç‚¹ï¼Œæ‰€æœ‰èŠ‚ç‚¹å½¼æ­¤ä¹‹é—´äº’è”ï¼ˆping-pongï¼‰ã€‚ä¸‹é¢å¯¹è¿™äº›é›†ç¾¤èŠ‚ç‚¹è¿›è¡Œä¸€äº›æµ‹è¯•ã€‚æµ‹è¯•å­˜å–ä½¿ç”¨å®¢æˆ·ç«¯è¿žæŽ¥é›†ç¾¤åŽçš„RedisèŠ‚ç‚¹éœ€è¦å¸¦ä¸Š-cæ ‡è¯†ï¼Œæ¯”å¦‚çŽ°åœ¨æˆ‘ä»¬è¿žæŽ¥ç«¯å£ä¸º7003çš„ä»ŽèŠ‚ç‚¹ï¼š1redis-cli -h 172.16.0.4 -c -p 7003ä½¿ç”¨setå‘½ä»¤å¾€Rediså­˜å…¥ä¸€äº›key-vaueï¼Œç»“æžœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¯å‘çŽ°ï¼Œå­˜å€¼çš„æ“ä½œå¹¶ä¸æ˜¯åœ¨7003èŠ‚ç‚¹å®Œæˆçš„ï¼Œå­˜å€¼çš„è¿‡ç¨‹åªåœ¨ä¸»èŠ‚ç‚¹ä¸‹å®Œæˆï¼Œå¹¶ä¸”æ¯æ¬¡setæ“ä½œRediséƒ½ä¼šè¾“å‡ºRedirected to slot [xxxx] located atçš„æç¤ºã€‚Redisé›†ç¾¤æœ‰16384ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯æ¬¡set keyæ—¶ï¼ŒRediså†…éƒ¨é€šè¿‡CRC16æ ¡éªŒåŽå¯¹16384å–æ¨¡æ¥å†³å®šæ”¾ç½®å“ªä¸ªå“ˆå¸Œæ§½ã€‚æ­£å¦‚ä¸Šé¢æ‰€è¯´çš„ï¼Œé›†ç¾¤çš„æ¯ä¸ªä¸»èŠ‚ç‚¹è´Ÿè´£ä¸€éƒ¨åˆ†å“ˆå¸Œæ§½ã€‚æ¯”å¦‚ç¬¬ä¸€æ¡å‘½ä»¤set a 1è®¡ç®—å‡ºæ¥çš„å“ˆå¸Œç ä¸º15495ï¼Œä»‹äºŽ11001åˆ°16384ä¹‹é—´ï¼Œæ‰€ä»¥ä¾¿å­˜å‚¨åœ¨äº†7002èŠ‚ç‚¹ä¸­ã€‚ä¸Šé¢æˆ‘ä»¬æåˆ°7000èŠ‚ç‚¹çš„ä»ŽèŠ‚ç‚¹ä¸º7004ï¼Œä¸‹é¢æ¥éªŒè¯ä¸€ä¸‹ï¼šå¯çœ‹åˆ°å®ƒä»¬å­˜å‚¨çš„keyæ˜¯ç›¸åŒçš„ã€‚å°è¯•ä»Ž7004èŠ‚ç‚¹åˆ é™¤keyï¼šå‘çŽ°7000èŠ‚ç‚¹çš„bä¹Ÿè¢«åˆ é™¤ã€‚æŽ¥ä¸‹æ¥ä»Ž7000èŠ‚ç‚¹èŽ·å–açš„å€¼ï¼ˆaå­˜å‚¨åœ¨7002èŠ‚ç‚¹ä¸­ï¼‰ï¼šå¯çœ‹åˆ°Redisè‡ªå·±redirectedåˆ°äº†7002èŠ‚ç‚¹èŽ·å–açš„å€¼ï¼Œè¿™å°±æ˜¯é›†ç¾¤çš„ç‰¹ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„ï¼Œå¯ä»¥ç›¸äº’é—´å–å€¼ã€‚æµ‹è¯•ä¸»ä»Žå¼€å¤´è¯´è¿‡ï¼Œåœ¨é›†ç¾¤è¿‡ç¨‹ä¸­å¯ä»¥é€šè¿‡ä¸»ä»Žçš„åˆ†é…æ¥æé«˜Redisçš„å¯ç”¨æ€§ã€‚æ¯”å¦‚è¿™ä¸ªä¾‹å­ï¼Œé›†ç¾¤æœ‰7000ã€7001å’Œ7002 3ä¸ªä¸»èŠ‚ç‚¹ï¼Œå¦‚æžœè¿™3ä¸ªèŠ‚ç‚¹éƒ½æ²¡æœ‰ä»ŽèŠ‚ç‚¹ï¼Œå‡è®¾7001å®•æœºäº†ï¼Œé‚£ä¹ˆæ•´ä¸ªé›†ç¾¤å°±ä¼šå› ä¸ºç¼ºå°‘5501-11000è¿™ä¸ªèŒƒå›´çš„å“ˆå¸Œæ§½è€Œå˜å¾—ä¸å¯ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨é›†ç¾¤å»ºç«‹çš„æ—¶å€™ï¼Œä¸€å®šè¦ä¸ºæ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½æ·»åŠ äº†ä»ŽèŠ‚ç‚¹, æ¯”å¦‚åƒä¸Šé¢çš„ä¾‹å­é‚£æ ·ï¼Œé›†ç¾¤åŒ…å«ä¸»èŠ‚ç‚¹7000ã€7001å’Œ7002ä»¥åŠä»ŽèŠ‚ç‚¹7003ã€7004å’Œ7005, é‚£ä¹ˆå³ä½¿7001å®•ç³»ç»Ÿä¹Ÿå¯ä»¥ç»§ç»­æ­£å¸¸å·¥ä½œã€‚å½“7001è¿™ä¸ªä¸»èŠ‚ç‚¹å®•æœºåŽï¼ŒRedisé›†ç¾¤å°†ä¼šé€‰æ‹©7001çš„ä»ŽèŠ‚ç‚¹7005ä½œä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ä»¥ç¡®ä¿é›†ç¾¤æ­£å¸¸çš„å·¥ä½œã€‚å½“é‡æ–°å¯åŠ¨7001åŽï¼Œå…¶è‡ªåŠ¨å˜ä¸ºäº†7005çš„ä»ŽèŠ‚ç‚¹ï¼Œè§’è‰²å®Œæˆäº†è½¬æ¢ã€‚ä¸ºäº†éªŒè¯è¿™ä¸ªç†è®ºï¼Œä¸‹é¢å°†7001èŠ‚ç‚¹æ€æ­»ï¼Œç„¶åŽè§‚å¯Ÿï¼šå¯çœ‹åˆ°7005å·²ç»æ™‹å‡ä¸ºäº†ä¸»èŠ‚ç‚¹ã€‚æŽ¥ç€æµ‹è¯•ä»Ž7000èŠ‚ç‚¹èŽ·å–cçš„å€¼ï¼ˆcå­˜å‚¨åœ¨7001èŠ‚ç‚¹ä¸­ï¼Œ7005ä¹‹å‰ä¸º7001çš„ä»ŽèŠ‚ç‚¹ï¼Œæ‰€ä»¥ä¹Ÿå­˜æœ‰è¿™ä¸ªå€¼ï¼‰ï¼šRedisè‡ªåŠ¨redirectedåˆ°äº†7005ï¼Œå¹¶æˆåŠŸèŽ·å–åˆ°äº†cçš„å€¼ã€‚çŽ°åœ¨é‡æ–°å¯åŠ¨7001èŠ‚ç‚¹ï¼Œç„¶åŽè§‚å¯Ÿï¼š7001å·²ç»æˆä¸ºäº†7005çš„ä»ŽèŠ‚ç‚¹äº†ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå‡å¦‚7005å’Œ7001åŒæ—¶å®•æœºï¼Œé‚£ä¹ˆé›†ç¾¤å°†ä¸å¯ç”¨ã€‚]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>Redis</tag>
        <tag>é›†ç¾¤</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€Java8å®žæˆ˜ã€‘Lambdaè¡¨è¾¾å¼ï¼ˆäºŒï¼‰]]></title>
    <url>%2Fjava8lambda2.html</url>
    <content type="text"><![CDATA[åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸ºäº†ä½¿ç”¨Lambdaè¡¨è¾¾å¼ä¸å¾—ä¸åˆ›å»ºäº†å„ç§å‡½æ•°æè¿°ç¬¦çš„å‡½æ•°å¼æŽ¥å£ï¼Œå…¶å®žJava 8å·²ç»ç»™æˆ‘ä»¬æä¾›äº†ä¸€å¥—èƒ½å¤Ÿæè¿°å¸¸è§å‡½æ•°æè¿°ç¬¦çš„å‡½æ•°å¼æŽ¥å£ã€‚æ¯”å¦‚Predicate&lt;T&gt;ã€Consumer&lt;T&gt;ã€Function&lt;T,R&gt;ã€Supplier&lt;T&gt;ç­‰ï¼Œè¿™äº›å‡½æ•°å¼æŽ¥å£ä½äºŽjava.util.functionåŒ…ã€‚è¿™ä¸€èŠ‚ä¸»è¦è®°å½•è¿™äº›å‡½æ•°å¼æŽ¥å£çš„åº”ç”¨ã€‚Java8ä¸­çš„å‡½æ•°å¼æŽ¥å£ä¸‹è¡¨åˆ—å‡ºäº†Java8ä¸­å¸¸è§çš„å‡½æ•°å¼æŽ¥å£ï¼šå‡½æ•°å¼æŽ¥å£å‡½æ•°æè¿°ç¬¦åŽŸå§‹ç±»åž‹ç‰¹åŒ–PredicateT-&gt;booleanIntPredicate,LongPredicate, DoublePredicateConsumerT-&gt;voidIntConsumer,LongConsumer, DoubleConsumerFunction&lt;T,R&gt;T-&gt;RIntFunction, IntToDoubleFunction, IntToLongFunction,LongFunction, LongToDoubleFunction, LongToIntFunction,DoubleFunction, ToIntFunction, ToDoubleFunction, ToLongFunctionSupplier()-&gt;TBooleanSupplier,IntSupplier, LongSupplier,DoubleSupplierUnaryOperatorT-&gt;TIntUnaryOperator, LongUnaryOperator, DoubleUnaryOperatorBinaryOperator(T,T)-&gt;TIntBinaryOperator, LongBinaryOperator, DoubleBinaryOperatorBiPredicate&lt;L,R&gt;(L,R)-&gt;booleanBiConsumer&lt;T,U&gt;(T,U)-&gt;voidObjIntConsumer, ObjLongConsumer, ObjDoubleConsumerBiFunction&lt;T,U,R&gt;(T,U)-&gt;RToIntBiFunction&lt;T,U&gt;, ToLongBiFunction&lt;T,U&gt;, ToDoubleBiFunction&lt;T,U&gt;Predicatepredicate: è‹± [ËˆpredÉªkÉ™t] ç¾Ž [ËˆpredÉªkÉ™t] æ–­è¨€ï¼Œæ–­å®šçš„æ„æ€ã€‚ä»ŽæŽ¥å£çš„åç§°å°±å¯ä»¥æŽ¨æ–­å‡ºè¿™ä¸ªå‡½æ•°å¼æŽ¥å£çš„ä¸»è¦ä½œç”¨å°±æ˜¯ç”¨äºŽåˆ¤æ–­ä½œç”¨ï¼ŒPredicateæºç å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021@FunctionalInterfacepublic interface Predicate&lt;T&gt; &#123; boolean test(T t); default Predicate&lt;T&gt; and(Predicate&lt;? super T&gt; other) &#123; Objects.requireNonNull(other); return (t) -&gt; test(t) &amp;&amp; other.test(t); &#125; default Predicate&lt;T&gt; negate() &#123; return (t) -&gt; !test(t); &#125; default Predicate&lt;T&gt; or(Predicate&lt;? super T&gt; other) &#123; Objects.requireNonNull(other); return (t) -&gt; test(t) || other.test(t); &#125; static &lt;T&gt; Predicate&lt;T&gt; isEqual(Object targetRef) &#123; return (null == targetRef) ? Objects::isNull : object -&gt; targetRef.equals(object); &#125;&#125;å¯çœ‹åˆ°java.util.function.Predicate&lt;T&gt;æŽ¥å£å®šä¹‰äº†ä¸€ä¸ªåå«testçš„æŠ½è±¡æ–¹æ³•ï¼Œå®ƒæŽ¥å—æ³›åž‹Tå¯¹è±¡ï¼Œå¹¶è¿”å›žä¸€ä¸ªbooleanï¼Œå‡½æ•°æè¿°ç¬¦ä¸º(T) -&gt; booleanä¸¾å‡ ä¸ªä¾‹å­ï¼š1234567// å¶æ•°åˆ¤æ–­Predicate&lt;Integer&gt; isEven = (in) -&gt; in % 2 == 0;isEven.test(17); // false// åˆ¤æ–­å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯å¦ä¸º0Predicate&lt;String&gt; isEmptyString = String::isEmpty;isEmptyString.test(""); // trueé™¤äº†æŠ½è±¡æ–¹æ³•å¤–ï¼Œjava.util.function.Predicate&lt;T&gt;æŽ¥å£è¿˜å®šä¹‰äº†ä¸‰ä¸ªé»˜è®¤æ–¹æ³•ï¼šandï¼Œnegateå’Œorï¼Œå¯¹åº”â€œä¸Žâ€ï¼Œâ€œéžâ€å’Œâ€œæˆ–â€æ“ä½œï¼Œè¿™æ ·æˆ‘ä»¬ä¾¿å¯ä»¥å¤åˆLambdaè¡¨è¾¾å¼äº†ï¼Œæ¯”å¦‚ï¼š12345678// åˆ¤æ–­æ˜¯å¶æ•°ï¼Œå¹¶ä¸”å¤§äºŽ30Predicate&lt;Integer&gt; isEven = (in) -&gt; in % 2 == 0;isEven.and((in) -&gt; in &gt; 30).test(40); // true// å¥‡æ•°åˆ¤æ–­Predicate&lt;Integer&gt; isEven = (in) -&gt; in % 2 == 0;Predicate&lt;Integer&gt; isOdd = isEven.negate();isOdd.test(17); // trueConsumerè‹± [kÉ™nËˆsju:mÉ™(r)] ç¾Ž [kÉ™nËˆsu:mÉ™(r)] n.æ¶ˆè´¹è€…ã€‚è¯¥å‡½æ•°å¼æŽ¥å£ç”¨äºŽæ¶ˆè´¹ä¸€ä¸ªå¯¹è±¡ï¼Œå³æŽ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹å…¶æ‰§è¡ŒæŸäº›æ“ä½œï¼Œç„¶åŽæ²¡æœ‰è¿”å›žå€¼ã€‚Consumeræºç å¦‚ä¸‹æ‰€ç¤ºï¼š12345678@FunctionalInterfacepublic interface Consumer&lt;T&gt; &#123; void accept(T t); default Consumer&lt;T&gt; andThen(Consumer&lt;? super T&gt; after) &#123; Objects.requireNonNull(after); return (T t) -&gt; &#123; accept(t); after.accept(t); &#125;; &#125;&#125;å¯çœ‹åˆ°java.util.function.Consumer&lt;T&gt;å®šä¹‰äº†ä¸€ä¸ªåå«acceptçš„æŠ½è±¡æ–¹æ³•ï¼Œå®ƒæŽ¥å—æ³›åž‹Tçš„å¯¹è±¡ï¼Œæ²¡æœ‰è¿”å›ž(void)ï¼Œå‡½æ•°æè¿°ç¬¦ä¸º(T) -&gt; voidã€‚å…¶è¿˜æä¾›äº†ä¸€ä¸ªé»˜è®¤æ–¹æ³•andThenã€‚ä¸¾ä¸ªä¾‹å­ï¼š1234Consumer&lt;Apple&gt; printAppleColor = (a)-&gt; System.out.println(a.getColor());printAppleColor.accept(new Apple("red",17)); // redprintAppleColor.andThen((a) -&gt; System.out.println(a.getWeight())).accept(new Apple("red", 17)); // red 17.0Suppliersupplier è‹± [sÉ™ËˆplaÉªÉ™(r)] ç¾Ž [sÉ™ËˆplaÉªÉ™r] n.ä¾›åº”å•†;ä¾›åº”è€…;ä¾›ç»™è€…ã€‚å…¶æºç å¦‚ä¸‹ï¼š1234@FunctionalInterfacepublic interface Supplier&lt;T&gt; &#123; T get();&#125;å¯çœ‹åˆ°java.util.function.Supplier&lt;T&gt;å®šä¹‰äº†ä¸€ä¸ªåå«getçš„æŠ½è±¡æ–¹æ³•ï¼Œå®ƒä¸æŽ¥æ”¶å‚æ•°ï¼Œè¿”å›žæ³›åž‹Tçš„å¯¹è±¡ï¼Œå‡½æ•°æè¿°ç¬¦ä¸º() -&gt; Tã€‚ä¸¾ä¸ªä¾‹å­ï¼š12Supplier&lt;Person&gt; personSupplier = Person::new;personSupplier.get(); // new PersonFunctionsFunctionsæºç å¦‚ä¸‹ï¼š123456789101112131415161718@FunctionalInterfacepublic interface Function&lt;T, R&gt; &#123; R apply(T t); default &lt;V&gt; Function&lt;V, R&gt; compose(Function&lt;? super V, ? extends T&gt; before) &#123; Objects.requireNonNull(before); return (V v) -&gt; apply(before.apply(v)); &#125; default &lt;V&gt; Function&lt;T, V&gt; andThen(Function&lt;? super R, ? extends V&gt; after) &#123; Objects.requireNonNull(after); return (T t) -&gt; after.apply(apply(t)); &#125; static &lt;T&gt; Function&lt;T, T&gt; identity() &#123; return t -&gt; t; &#125;&#125;java.util.function.Function&lt;T, R&gt;æŽ¥å£å®šä¹‰äº†ä¸€ä¸ªå«ä½œapplyçš„æ–¹æ³•ï¼Œå®ƒæŽ¥å—ä¸€ä¸ªæ³›åž‹Tçš„å¯¹è±¡ï¼Œå¹¶è¿”å›žä¸€ä¸ªæ³›åž‹Rçš„å¯¹è±¡ï¼Œå‡½æ•°æè¿°ç¬¦ä¸º(T) -&gt; Rã€‚ä¸¾ä¸ªä¾‹å­ï¼š1234Function&lt;Apple, Double&gt; getAppleWeight = (a) -&gt; &#123; return a.getWeight();&#125;;getAppleWeight.apply(new Apple(17)); // 17.0FunctionsæŽ¥å£è¿˜æä¾›äº†ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•composeå’ŒandThenï¼Œä»Žæºç å¯ä»¥çœ‹å‡ºä¸¤è€…çš„æ ¹æœ¬åŒºåˆ«ã€‚ä¸¾ä¸ªcomposeä¾‹å­ï¼š123Function&lt;Integer, Integer&gt; f = (x) -&gt; x + 1;Function&lt;Integer, Integer&gt; g = (x) -&gt; x * 2;f.compose(g).apply(2); // 5è¿‡ç¨‹ä¸ºï¼šf(g(2))ï¼Œä¹Ÿå°±æ˜¯1+(2*2)ã€‚ä¸¾ä¸ªandThençš„ä¾‹å­ï¼š123Function&lt;Integer, Integer&gt; f = (x) -&gt; x + 1;Function&lt;Integer, Integer&gt; g = (x) -&gt; x * 2;f.andThen(g).apply(2); // 6è¿‡ç¨‹ä¸ºï¼šg(f(2))ï¼Œä¹Ÿå°±æ˜¯(2+1)*2ã€‚åŽŸå§‹ç±»åž‹ç‰¹åŒ–åœ¨å­¦ä¹ FunctionæŽ¥å£çš„æ—¶å€™ï¼Œæˆ‘ä»¬å®šä¹‰äº†få‡½æ•°ï¼š1Function&lt;Integer, Integer&gt; f = (x) -&gt; x + 1;xçš„ç±»åž‹ä¸ºIntegerç±»åž‹ï¼Œ1ä¸ºintç±»åž‹ï¼Œè¿”å›žå€¼ä¸ºIntegerç±»åž‹ï¼Œæ•´ä¸ªè¿‡ç¨‹å®žé™…ä¸Šä¸ºInteger.valueOf(x.intValue() + 1)ã€‚è™½ç„¶ç¼–è¯‘å™¨å¯ä»¥è‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆæ‹†è£…ç®±ï¼Œä½†è¿™ä¼šé€ æˆä¸å¿…è¦çš„æ€§èƒ½æ¶ˆè€—ã€‚è€ƒè™‘åˆ°äº†è¿™ä¸€ç‚¹ï¼ŒJava8ä¸ºæˆ‘ä»¬æä¾›äº†intç±»åž‹çš„FunctionæŽ¥å£ï¼šIntFunction:1234@FunctionalInterfacepublic interface IntFunction&lt;R&gt; &#123; R apply(int value);&#125;æ‰€ä»¥fæœ€å¥½é‡æž„ä¸ºï¼š1IntFunction&lt;Integer&gt; f = (x) -&gt; x + 1;å‰©ä½™çš„åŽŸå§‹ç±»åž‹ç‰¹åŒ–å‡½æ•°å¼æŽ¥å£å¯å‚è€ƒä¸Šé¢çš„è¡¨æ ¼ã€‚Java8ä¸­å¢žå¼ºçš„Comparatoråœ¨Java8ä¹‹å‰ï¼ŒComparatoræŽ¥å£ç”¨äºŽå®žçŽ°ç®€å•çš„æ¯”è¾ƒæŽ’åºç®—æ³•ã€‚æ¯”å¦‚æœ‰å¦‚ä¸‹Listï¼š123456List&lt;Double&gt; list = new ArrayList&lt;&gt;();list.add(12.3);list.add(100.2);list.add(3.14);list.add(27.7);list.add(-9.8);ä½¿ç”¨ComparatoræŽ¥å£å¯¹å…¶ä»Žå°åˆ°å¤§æŽ’åºï¼š123456Collections.sort(list, new Comparator&lt;Double&gt;() &#123; @Override public int compare(Double o1, Double o2) &#123; return o1.compareTo(o2); &#125;&#125;);ComparatoræŽ¥å£ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°å¼æŽ¥å£ï¼Œå‡½æ•°æè¿°ç¬¦ä¸º(T,T) -&gt; intï¼ŒJava8ä¸­å¯ä»¥ä½¿ç”¨Lambdaæ”¹é€ ä¸Šé¢çš„æŽ’åºæ–¹æ³•ï¼š1Collections.sort(list, (o1, o2) -&gt; o1.compareTo(o2));Java8å¯¹Listæä¾›äº†sortæ–¹æ³•ï¼Œå¯ä»¥æ›¿ä»£Collections.sortï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç å¯ä»¥ç®€åŒ–ä¸ºï¼š1list.sort((o1, o2) -&gt; o1.compareTo(o2));ä½¿ç”¨æ–¹æ³•çš„å¼•ç”¨æ¥è¿›ä¸€æ­¥ç®€åŒ–ï¼š1list.sort(Double::compareTo);Java8å¯¹Comparatorè¿›è¡Œäº†å¢žå¼ºï¼ŒåŠ å…¥äº†ä¸€äº›å®žç”¨çš„é»˜è®¤æ–¹æ³•ï¼Œæ¯”å¦‚å¯¹æŽ’åºç»“æžœåè½¬ï¼š12Comparator&lt;Double&gt; comparator = Double::compareTo;list.sort(comparator.reversed());æ›´å¤šæ–¹æ³•å¯ä»¥å‚è€ƒComparatoræŽ¥å£çš„JavaDocã€‚æŸ¥çœ‹Comparatorçš„æ—¶å€™å‘çŽ°å…¶è™½ç„¶æ˜¯å‡½æ•°å¼æŽ¥å£ï¼Œä½†æ˜¯å´åŒ…å«äº†compareå’Œequalsè¿™ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œé¡¿æ—¶æœ‰ç‚¹æ‡µé€¼ï¼Œå‡½æ•°å¼æŽ¥å£ä¸æ˜¯åªèƒ½æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ä¹ˆï¼ŸæŸ¥æ‰¾èµ„æ–™åŽå‘çŽ°ï¼šå‡½æ•°å¼æŽ¥å£ä¸­å¯ä»¥é¢å¤–å®šä¹‰å¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä½†è¿™äº›æŠ½è±¡æ–¹æ³•ç­¾åå¿…é¡»å’ŒObjectçš„publicæ–¹æ³•ä¸€æ ·ï¼ŒæŽ¥å£æœ€ç»ˆæœ‰ç¡®å®šçš„ç±»å®žçŽ°ï¼Œè€Œç±»çš„æœ€ç»ˆçˆ¶ç±»æ˜¯Objectã€‚å› æ­¤å‡½æ•°å¼æŽ¥å£å¯ä»¥å®šä¹‰Objectçš„publicæ–¹æ³•ã€‚ã€ŠJava 8å®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Java 8</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ã€Java8å®žæˆ˜ã€‘Lambdaè¡¨è¾¾å¼ï¼ˆä¸€ï¼‰]]></title>
    <url>%2Fjava8lambda1.html</url>
    <content type="text"><![CDATA[Java 8çš„Lambdaè¡¨è¾¾å¼å€Ÿé‰´äº†C#å’ŒScalaç­‰è¯­è¨€ä¸­çš„ç±»ä¼¼ç‰¹æ€§ï¼Œç®€åŒ–äº†åŒ¿åå‡½æ•°çš„è¡¨è¾¾æ–¹å¼ã€‚Lambdaè¡¨è¾¾å¼å¯ä»¥ç›´æŽ¥ä»¥å†…è”çš„å½¢å¼ä¸ºå‡½æ•°å¼æŽ¥å£çš„æŠ½è±¡æ–¹æ³•æä¾›å®žçŽ°ï¼Œå¹¶æŠŠæ•´ä¸ªè¡¨è¾¾å¼ä½œä¸ºå‡½æ•°å¼æŽ¥å£çš„å®žä¾‹ã€‚ä»€ä¹ˆæ˜¯å‡½æ•°å¼æŽ¥å£ï¼Ÿç®€å•æ¥è¯´å°±æ˜¯åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æŽ¥å£ï¼Œå…è®¸æœ‰é»˜è®¤çš„å®žçŽ°ï¼ˆä½¿ç”¨defaultå…³é”®å­—æè¿°æ–¹æ³•ï¼‰ã€‚å‡½æ•°å¼æŽ¥å£å»ºè®®ä½¿ç”¨@FunctionalInterfaceæ³¨è§£æ ‡æ³¨ï¼Œè™½ç„¶è¿™ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯è¿™æ ·åšæ›´ç¬¦åˆè§„èŒƒã€‚åœ¨Java 8ä¹‹å‰ï¼Œå®žçŽ°Runnableå¸¸ç”¨æ–¹å¼æ˜¯ç¼–å†™ä¸€ä¸ªåŒ¿åç±»ï¼š1234567Thread thread = new Thread(new Runnable() &#123; @Override public void run() &#123; System.out.println("hello"); &#125;&#125;);thread.start();ä½¿ç”¨Lambdaè¡¨è¾¾å¼åŽï¼Œä¸Šé¢çš„ä»£ç å¯ä»¥æ”¹é€ ä¸ºï¼š12Thread thread = new Thread(() -&gt; System.out.println("hello"));thread.start();æ˜¯ä¸æ˜¯å¾ˆç¥žå¥‡ï¼Ÿï¼å¾ˆç®€æ´ï¼Ÿï¼Lambdaè¡¨è¾¾å¼è§£æžLambdaè¡¨è¾¾å¼çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š123(parameters) -&gt; expression or(parameters) -&gt; &#123; statements; &#125;ç”±è¯­æ³•å¯ä»¥çœ‹åˆ°ï¼ŒLambdaè¡¨è¾¾å¼åŒ…å«äº†ä¸‰ä¸ªéƒ¨åˆ†ï¼šå‚æ•°åˆ—è¡¨ï¼›ç®­å¤´-&gt;æŠŠå‚æ•°åˆ—è¡¨ä¸ŽLambdaä¸»ä½“åˆ†éš”å¼€ï¼›Lambdaä¸»ä½“ï¼Œåªæœ‰ä¸€è¡Œä»£ç çš„æ—¶å€™å¯ä»¥çœç•¥å¤§æ‹¬å·å’Œreturnå…³é”®å­—ã€‚æ¯”å¦‚ä¸‹é¢è¿™äº›Lambdaè¡¨è¾¾å¼éƒ½æ˜¯åˆæ³•çš„ï¼š123456789101112(String str) -&gt; str.length()(String str) -&gt; &#123; return str.length(); &#125;() -&gt; System.out.println("hello")() -&gt; &#123;&#125;() -&gt; 17(int x, int y) -&gt; &#123; System.out.println(x); System.out.println(y);&#125;Lambdaçš„ä½¿ç”¨åœºåˆä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Ÿä½¿ç”¨Lambdaå¿…é¡»æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼šå®žçŽ°çš„å¯¹è±¡æ˜¯å‡½æ•°å¼æŽ¥å£çš„æŠ½è±¡æ–¹æ³•ï¼›å‡½æ•°å¼æŽ¥å£çš„æŠ½è±¡æ–¹æ³•çš„å‡½æ•°æè¿°ç¬¦å’ŒLambdaè¡¨è¾¾å¼çš„å‡½æ•°æè¿°ç¬¦ä¸€è‡´ã€‚å‡½æ•°å¼æŽ¥å£å‡½æ•°å¼æŽ¥å£çš„å®šä¹‰å¼€å¤´å·²ç»è¯´äº†ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚åœ¨Java 8ä¹‹å‰ï¼Œå¸¸è§çš„å‡½æ•°å¼æŽ¥å£æœ‰java.util.Comparatorï¼Œjava.lang.Runnableç­‰ã€‚æ‹¿java.util.Runnableæ¥è¯´ï¼ŒæŸ¥çœ‹å…¶æºç å¦‚ä¸‹ï¼š1234@FunctionalInterfacepublic interface Runnable &#123; public abstract void run();&#125;è¿™ä¸ªæŽ¥å£åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå¹¶ä¸”ä½¿ç”¨@FunctionalInterfaceæ³¨è§£æ ‡æ³¨ã€‚æŽ¥å£çŽ°åœ¨è¿˜å¯ä»¥æ‹¥æœ‰é»˜è®¤æ–¹æ³•ï¼ˆå³åœ¨ç±»æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡Œå®žçŽ°æ—¶ï¼Œå…¶ä¸»ä½“ä¸ºæ–¹æ³•æä¾›é»˜è®¤å®žçŽ°çš„æ–¹æ³•ï¼‰ã€‚å“ªæ€•æœ‰å¾ˆå¤šé»˜è®¤æ–¹æ³•ï¼Œåªè¦æŽ¥å£åªå®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®ƒå°±ä»ç„¶æ˜¯ä¸€ä¸ªå‡½æ•°å¼æŽ¥å£ã€‚å‡½æ•°æè¿°ç¬¦å‡½æ•°æè¿°ç¬¦å…¶å®žä¹Ÿå¯ä»¥ç†è§£ä¸ºæ–¹æ³•çš„ç­¾åã€‚æ¯”å¦‚ä¸Šè¿°çš„RunnableæŠ½è±¡æ–¹æ³•ä¸æŽ¥å—å‚æ•°ï¼Œå¹¶ä¸”è¿”å›žvoidï¼Œæ‰€ä»¥å…¶å‡½æ•°æè¿°ç¬¦ä¸º() -&gt; voidã€‚è€Œ() -&gt; System.out.println(&quot;hello&quot;)Lambdaè¡¨è¾¾å¼ä¹Ÿæ˜¯ä¸æŽ¥å—å‚æ•°ï¼Œå¹¶ä¸”è¿”å›žvoidï¼Œå³å…¶å‡½æ•°æè¿°ç¬¦ä¹Ÿæ˜¯() -&gt; voidã€‚æ‰€ä»¥ä»£ç Runnable r = () -&gt; System.out.println(&quot;hello&quot;);æ˜¯åˆæ³•çš„ã€‚ç‰¹æ®Šçš„voidå…¼å®¹è§„åˆ™å¦‚æžœä¸€ä¸ªLambdaçš„ä¸»ä½“æ˜¯ä¸€ä¸ªè¯­å¥è¡¨è¾¾å¼ï¼Œ å®ƒå°±å’Œä¸€ä¸ªè¿”å›žvoidçš„å‡½æ•°æè¿°ç¬¦å…¼å®¹ï¼ˆå½“ç„¶éœ€è¦å‚æ•°åˆ—è¡¨ä¹Ÿå…¼å®¹ï¼‰ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹Lambdaæ˜¯åˆæ³•çš„ï¼Œå°½ç®¡Listçš„addæ–¹æ³•è¿”å›žäº†ä¸€ä¸ª booleanï¼Œè€Œä¸æ˜¯RunnableæŠ½è±¡æ–¹æ³•å‡½æ•°æè¿°ç¬¦() -&gt; voidæ‰€è¦æ±‚çš„voidï¼š12List&lt;String&gt; list = new ArrayList&lt;&gt;();Runnable r = () -&gt; list.add(&quot;hello&quot;);æ›´ç®€æ´çš„Lambdaç¼–å†™ä¸€ä¸ªç±»åž‹è½¬æ¢çš„å‡½æ•°å¼æŽ¥å£ï¼š1234@FunctionalInterfacepublic interface TransForm&lt;T, R&gt; &#123; R transForm(T t);&#125;ç¼–å†™ä¸€ä¸ªLambdaè¡¨è¾¾å¼å®žçŽ°è¯¥å‡½æ•°å¼æŽ¥å£ï¼Œç”¨äºŽå®žçŽ°Stringè½¬æ¢ä¸ºIntegerï¼Œä»£ç å¦‚ä¸‹ï¼š12TransForm&lt;String, Integer&gt; t = (String str) -&gt; Integer.valueOf(str);System.out.println(t.transForm("123"));ä¸Šé¢çš„Lambdaè¡¨è¾¾å¼å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–ä¸ºå¦‚ä¸‹æ–¹å¼ï¼š12TransForm&lt;String, Integer&gt; t = (str) -&gt; Integer.valueOf(str);System.out.println(t.transForm("123"));å› ä¸ºJavaç¼–è¯‘å™¨ä¼šä»Žä¸Šä¸‹æ–‡ï¼ˆç›®æ ‡ç±»åž‹ï¼‰æŽ¨æ–­å‡ºç”¨ä»€ä¹ˆå‡½æ•°å¼æŽ¥å£æ¥é…åˆLambdaè¡¨è¾¾å¼ï¼Œè¿™æ„å‘³ç€å®ƒä¹Ÿå¯ä»¥æŽ¨æ–­å‡ºé€‚åˆLambdaçš„ç­¾åã€‚å°±æ‹¿è¿™ä¸ªä¾‹å­æ¥è¯´ï¼ŒTransFormçš„æŠ½è±¡æ–¹æ³•transFormåœ¨æœ¬ä¾‹ä¸­çš„å‡½æ•°æè¿°ç¬¦ä¸º(String) -&gt; Integerï¼Œæ‰€ä»¥å¯¹åº”çš„Lambdaçš„ç­¾åä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå³Lambdaçš„å‚æ•°å³ä½¿ä¸å£°åç±»åž‹ï¼ŒJavaç¼–è¯‘å™¨å¯ä»¥çŸ¥é“å…¶å‚æ•°å®žé™…ä¸Šä¸ºStringç±»åž‹ã€‚å…¶å®žï¼Œä¸Šé¢çš„Labmdaè¡¨è¾¾å¼è¿˜ä¸æ˜¯æœ€ç®€æ´çš„ï¼Œå…¶è¿˜å¯ä»¥æ›´è¿›ä¸€æ­¥åœ°ç®€åŒ–ä¸ºå¦‚ä¸‹å†™æ³•ï¼š12TransForm&lt;String, Integer&gt; t = Integer::valueOf;System.out.println(t.transForm("123"));ä½ è‚¯å®šå¾ˆå›°æƒ‘ï¼Œè¿™è¿˜æ˜¯Lambdaè¡¨è¾¾å¼å—ï¼Œç®­å¤´åŽ»å“ªé‡Œäº†ï¼ŸåŒå†’å·åˆæ˜¯ä»€ä¹ˆé¬¼ï¼Ÿå…¶å®žè¿™ç§å†™æ³•æœ‰ä¸€ä¸ªæ–°çš„åç§°ï¼Œå«åšæ–¹æ³•çš„å¼•ç”¨ã€‚æ–¹æ³•å¼•ç”¨å¯ä»¥è¢«çœ‹ä½œä»…ä»…è°ƒç”¨ç‰¹å®šæ–¹æ³•çš„Lambdaçš„ä¸€ç§å¿«æ·å†™æ³•ã€‚å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¦‚æžœä¸€ä¸ªLambdaä»£è¡¨çš„åªæ˜¯â€œç›´æŽ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•â€ï¼Œé‚£æœ€å¥½è¿˜æ˜¯ç”¨åç§°æ¥è°ƒç”¨å®ƒï¼Œè€Œä¸æ˜¯åŽ»æè¿°å¦‚ä½•è°ƒç”¨å®ƒï¼Œè¿™æ ·ä»£ç å¯è¯»æ€§æ›´å¥½ã€‚åŸºæœ¬å†™æ³•å°±æ˜¯ç›®æ ‡å¼•ç”¨æ”¾åœ¨åˆ†éš”ç¬¦::å‰ï¼Œæ–¹æ³•çš„åç§°æ”¾åœ¨åŽé¢ã€‚ä¸¾å‡ ä¸ªLambdaåŠå…¶ç­‰æ•ˆæ–¹æ³•å¼•ç”¨çš„ä¾‹å­ï¼šLambdaè¡¨è¾¾å¼ç­‰æ•ˆæ–¹æ³•å¼•ç”¨(String s) -&gt; System.out.println(s)System.out::println(str, i) -&gt; str.substring(i)String::substring() -&gt; Thread.currentThread().dumpStack()Thread.currentThread()::dumpStackç¬¦å·::é™¤äº†å‡ºçŽ°åœ¨æ–¹æ³•çš„å¼•ç”¨å¤–ï¼Œå®ƒè¿˜å¸¸è§äºŽæž„é€ å‡½æ•°çš„å¼•ç”¨ä¸­ã€‚ä¸ºäº†æ¼”ç¤ºä»€ä¹ˆæ˜¯æž„é€ å‡½æ•°çš„å¼•ç”¨ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°å¼æŽ¥å£ï¼š1234@FunctionalInterfacepublic interface Generator&lt;T, R&gt; &#123; R create(T t);&#125;åˆ›å»ºä¸€ä¸ªAppleç±»ï¼š12345678910111213public class Apple &#123; public Apple(String color) &#123; this.color = color; &#125; private String color; public String getColor() &#123; return color; &#125; public void setColor(String color) &#123; this.color = color; &#125;&#125;çŽ°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼æ¥åˆ›é€ ä¸€ä¸ªAppleå®žä¾‹ï¼š12Generator&lt;String, Apple&gt; g = Apple::new;Apple apple = g.create("red");è¿™ç§é€šè¿‡ClassName::newçš„å†™æ³•å°±æ˜¯æž„é€ å‡½æ•°çš„å¼•ç”¨ã€‚åœ¨è¿™é‡ŒGeneratorçš„æŠ½è±¡æ–¹æ³•æŽ¥æ”¶ä¸€ä¸ªStringç±»åž‹å‚æ•°ï¼Œè¿”å›žå€¼ç±»åž‹ä¸ºAppleï¼Œè¿™å’ŒAppleç±»çš„æž„é€ å‡½æ•°ç›¸ç¬¦åˆï¼Œæ‰€ä»¥è¿™é‡Œç¼–è¯‘å¯ä»¥é€šè¿‡ã€‚å®ƒç­‰ä»·äºŽä¸‹é¢çš„å†™æ³•ï¼š12Generator&lt;String, Apple&gt; g = (color) -&gt; new Apple(color);Apple apple = g.create("red");Lambdaè¡¨è¾¾å¼è®¿é—®å˜é‡Lambdaè¡¨è¾¾å¼å¯ä»¥è®¿é—®å±€éƒ¨finalå˜é‡ï¼Œæˆå‘˜å˜é‡å’Œé™æ€å˜é‡ã€‚è¿™é‡Œä¸»è¦è¯´ä¸‹å±€éƒ¨finalå˜é‡ã€‚æœ‰æ— finalå…³é”®å­—ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯ç¡®ä¿è¯¥å˜é‡çš„å€¼ä¸ä¼šè¢«æ”¹å˜å°±è¡Œäº†ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­å¯ä»¥ç¼–è¯‘é€šè¿‡ï¼š12String hello = "hello lambda";Runnable r = () -&gt; System.out.println(hello);è€Œä¸‹é¢çš„è¿™ä¸ªå°±ä¼šç¼–è¯‘å‡ºé”™ï¼Œå› ä¸ºå˜é‡helloçš„å€¼è¢«æ”¹å˜äº†ï¼šLambdaè¡¨è¾¾å¼å®žæˆ˜å‡å¦‚çŽ°åœ¨æœ‰å¦‚ä¸‹éœ€æ±‚ï¼šçŽ°æœ‰ä¸€ä¸ªåŒ…å«äº†å„ç§é¢œè‰²ä¸åŒé‡é‡çš„è‹¹æžœçš„Listï¼Œç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼Œä»Žä¸­ç­›é€‰å‡ºæ»¡è¶³è¦æ±‚çš„è‹¹æžœã€‚æ¯”å¦‚ç­›é€‰å‡ºçº¢è‰²çš„è‹¹æžœã€çº¢è‰²å¹¶ä¸”é‡é‡å¤§äºŽ1kgçš„è‹¹æžœã€ç»¿è‰²é‡é‡å°äºŽ0.5kgçš„è‹¹æžœæˆ–è€…çº¢è‰²å¤§äºŽ0.5kgçš„è‹¹æžœç­‰ç­‰ã€‚ä¸ä½¿ç”¨Lambdaåœ¨æ²¡æœ‰æŽ¥è§¦Lambdaä¹‹å‰ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šè¿™æ ·åšï¼šå®šä¹‰ä¸€ä¸ªç­›é€‰çš„æŽ¥å£12345import cc.mrbird.java8.domain.Apple;public interface AppleFilter &#123; boolean test(Apple apple);&#125;ç„¶åŽæ ¹æ®ç­›é€‰çš„æ¡ä»¶æ¥ç¼–å†™å„ä¸ªä¸åŒçš„å®žçŽ°ç±»ï¼šç­›é€‰å‡ºçº¢è‰²è‹¹æžœçš„å®žçŽ°æ–¹æ³•ï¼š12345678import cc.mrbird.java8.domain.Apple;public class RedApple implements AppleFilter &#123; @Override public boolean test(Apple apple) &#123; return "red".equalsIgnoreCase(apple.getColor()); &#125;&#125;ç­›é€‰å‡ºçº¢è‰²å¹¶ä¸”é‡é‡å¤§äºŽ1kgçš„è‹¹æžœçš„å®žçŽ°æ–¹æ³•ï¼š12345678import cc.mrbird.java8.domain.Apple;public class RedAndMoreThan1kgApple implements AppleFilter &#123; @Override public boolean test(Apple apple) &#123; return "red".equalsIgnoreCase(apple.getColor()) &amp;&amp; apple.getWeight() &gt; 1.0; &#125;&#125;ç­›é€‰å‡ºç»¿è‰²é‡é‡å°äºŽ0.5kgçš„è‹¹æžœæˆ–è€…çº¢è‰²å¤§äºŽ0.5kgçš„è‹¹æžœçš„å®žçŽ°æ–¹æ³•ï¼š123456789import cc.mrbird.java8.domain.Apple;public class GreenAndLessThan05OrRedAndMoreThan05Apple implements AppleFilter &#123; @Override public boolean test(Apple apple) &#123; return ("green".equalsIgnoreCase(apple.getColor()) &amp;&amp; apple.getWeight() &lt; 0.5) || ("red".equalsIgnoreCase(apple.getColor()) &amp;&amp; apple.getWeight() &gt; 0.5); &#125;&#125;ç­›é€‰è‹¹æžœçš„æ–¹æ³•ï¼š123456789101112131415import cc.mrbird.java8.domain.Apple;import java.util.ArrayList;import java.util.List;public class AppleFilterMethod &#123; public static List&lt;Apple&gt; filterApple(List&lt;Apple&gt; list, AppleFilter filter) &#123; List&lt;Apple&gt; filterList = new ArrayList&lt;&gt;(); for (Apple apple : list) &#123; if (filter.test(apple)) &#123; filterList.add(apple); &#125; &#125; return filterList; &#125;&#125;å¼€å§‹ç­›é€‰è‹¹æžœï¼š123456789101112List&lt;Apple&gt; appleList = new ArrayList&lt;&gt;();appleList.add(new Apple("red", 0.4));appleList.add(new Apple("red", 0.6));appleList.add(new Apple("red", 1.3));appleList.add(new Apple("green", 0.2));appleList.add(new Apple("green", 0.35));appleList.add(new Apple("green", 1.1));List&lt;Apple&gt; appleFilterList = AppleFilterMethod.filterApple(appleList, new RedApple());for (Apple apple : appleFilterList) &#123; System.out.println(apple.getColor() + " apple,weight:" + apple.getWeight());&#125;è¾“å‡ºï¼š123red apple,weight:0.4red apple,weight:0.6red apple,weight:1.3å‰©ä¸‹çš„ç•¥ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¸ºäº†æ»¡è¶³å„ç§ç­›é€‰æ¡ä»¶åˆ›é€ äº†å„ç§ç­›é€‰æŽ¥å£çš„å®žçŽ°ç±»ï¼ŒçœŸæ­£èµ·ä½œç”¨çš„åªæœ‰ç­›é€‰æ–¹æ³•ä¸­returné‚£ä¸€è¡Œä»£ç ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯ä¸€äº›é‡å¤çš„æ¨¡æ¿ä»£ç ã€‚ä½¿ç”¨Java 8ä¸­çš„Lambdaå¯ä»¥å¾ˆå¥½çš„æ¶ˆé™¤è¿™äº›æ¨¡æ¿ä»£ç ã€‚ä½¿ç”¨LambdaAppleFilteræŽ¥å£å®žé™…ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°å¼æŽ¥å£ï¼Œæ‰€ä»¥å®ƒçš„å„ç§å®žçŽ°å¯ä»¥ç”¨Lambdaè¡¨è¾¾å¼æ¥æ›¿ä»£ï¼Œè€Œæ— éœ€çœŸæ­£çš„åŽ»å†™å®žçŽ°æ–¹æ³•ã€‚å®šä¹‰ç­›é€‰æŽ¥å£ï¼š12345import cc.mrbird.java8.domain.Apple;public interface AppleFilter &#123; boolean test(Apple apple);&#125;ç­›é€‰è‹¹æžœçš„æ–¹æ³•ï¼š123456789101112131415import cc.mrbird.java8.domain.Apple;import java.util.ArrayList;import java.util.List;public class AppleFilterMethod &#123; public static List&lt;Apple&gt; filterApple(List&lt;Apple&gt; list, AppleFilter filter) &#123; List&lt;Apple&gt; filterList = new ArrayList&lt;&gt;(); for (Apple apple : list) &#123; if (filter.test(apple)) &#123; filterList.add(apple); &#125; &#125; return filterList; &#125;&#125;æŽ¥ä¸‹æ¥ä¾¿å¯ä»¥å¼€å§‹ç­›é€‰äº†ï¼šç­›é€‰çº¢è‰²çš„è‹¹æžœï¼š12345List&lt;Apple&gt; appleFilterList = AppleFilterMethod.filterApple(appleList, (apple) -&gt; "red".equalsIgnoreCase(apple.getColor()));for (Apple apple : appleFilterList) &#123; System.out.println(apple.getColor() + " apple,weight:" + apple.getWeight());&#125;è¾“å‡ºï¼š123red apple,weight:0.4red apple,weight:0.6red apple,weight:1.3ç­›é€‰å‡ºçº¢è‰²å¹¶ä¸”é‡é‡å¤§äºŽ1kgçš„è‹¹æžœ:12345 List&lt;Apple&gt; appleFilterList = AppleFilterMethod.filterApple(appleList, (apple) -&gt; "red".equalsIgnoreCase(apple.getColor()) &amp;&amp; apple.getWeight() &gt; 1.0);for (Apple apple : appleFilterList) &#123; System.out.println(apple.getColor() + " apple,weight:" + apple.getWeight());&#125;è¾“å‡ºï¼š1red apple,weight:1.3ç­›é€‰å‡ºç»¿è‰²é‡é‡å°äºŽ0.5kgçš„è‹¹æžœæˆ–è€…çº¢è‰²å¤§äºŽ0.5kgçš„è‹¹æžœ:123456List&lt;Apple&gt; appleFilterList = AppleFilterMethod.filterApple(appleList, (apple) -&gt; ("green".equalsIgnoreCase(apple.getColor()) &amp;&amp; apple.getWeight() &lt; 0.5) || ("red".equalsIgnoreCase(apple.getColor()) &amp;&amp; apple.getWeight() &gt; 0.5));for (Apple apple : appleFilterList) &#123; System.out.println(apple.getColor() + " apple,weight:" + apple.getWeight());&#125;è¾“å‡ºï¼š1234red apple,weight:0.6red apple,weight:1.3green apple,weight:0.2green apple,weight:0.35ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ¶ˆé™¤äº†å¤§é‡çš„æ ·æ¿ä»£ç ï¼Œå¹¶ä¸”å¯ä»¥çµæ´»çš„æž„é€ ç­›é€‰æ¡ä»¶ï¼ã€ŠJava 8å®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Java 8</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆè¯†Spring Cloudä¸Žå¾®æœåŠ¡]]></title>
    <url>%2FSpring-Cloud%20and%20MicroService.html</url>
    <content type="text"><![CDATA[åœ¨ä¼ ç»Ÿçš„è½¯ä»¶æž¶æž„ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸é‡‡ç”¨çš„æ˜¯å•ä½“åº”ç”¨æ¥æž„å»ºä¸€ä¸ªç³»ç»Ÿï¼Œä¸€ä¸ªå•ä½“åº”ç”¨ç³…åˆäº†å„ç§ä¸šåŠ¡æ¨¡å—ã€‚èµ·åˆåœ¨ä¸šåŠ¡è§„æ¨¡ä¸æ˜¯å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œå¯¹äºŽå•ä½“åº”ç”¨çš„å¼€å‘ç»´æŠ¤ä¹Ÿç›¸å¯¹å®¹æ˜“ã€‚ä½†éšç€ä¼ä¸šçš„å‘å±•ï¼Œä¸šåŠ¡è§„æ¨¡ä¸Žæ—¥é€’å¢žï¼Œå•ä½“åº”ç”¨å˜å¾—æ„ˆå‘è‡ƒè‚¿ã€‚ç”±äºŽå•ä½“åº”ç”¨å°†å„ç§ä¸šåŠ¡æ¨¡å—èšåˆåœ¨ä¸€èµ·ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨ä¸€ä¸ªè¿›ç¨‹å†…ï¼Œæ‰€ä»¥é€šå¸¸æˆ‘ä»¬å¯¹å…¶ä¸­ä¸€ä¸ªä¸šåŠ¡æ¨¡å—çš„ä¿®æ”¹ä¹Ÿå¿…é¡»å°†æ•´ä¸ªåº”ç”¨é‡æ–°æ‰“åŒ…ä¸Šçº¿ã€‚ä¸ºäº†è§£å†³å•ä½“åº”ç”¨å˜å¾—åºžå¤§è„¯è‚¿ä¹‹åŽäº§ç”Ÿçš„éš¾ä»¥ç»´æŠ¤çš„é—®é¢˜ï¼Œå¾®æœåŠ¡æž¶æž„ä¾¿å‡ºçŽ°åœ¨äº†å¤§å®¶çš„è§†çº¿é‡Œã€‚ä»€ä¹ˆæ˜¯å¾®æœåŠ¡å¾®æœåŠ¡ (Microservices) æ˜¯ä¸€ç§è½¯ä»¶æž¶æž„é£Žæ ¼ï¼Œèµ·æºäºŽPeter Rodgersåšå£«äºŽ 2005 å¹´åº¦äº‘ç«¯è¿ç®—åšè§ˆä¼šæå‡ºçš„å¾® Web æœåŠ¡ (Micro-Web-Service) ã€‚å¾®æœåŠ¡ä¸»æ—¨æ˜¯å°†ä¸€ä¸ªåŽŸæœ¬ç‹¬ç«‹çš„ç³»ç»Ÿ æ‹†åˆ†æˆå¤šä¸ªå°åž‹æœåŠ¡ï¼Œè¿™äº›å°åž‹æœåŠ¡éƒ½åœ¨å„è‡ªç‹¬ç«‹çš„è¿›ç¨‹ä¸­è¿è¡Œï¼ŒæœåŠ¡ä¹‹é—´é€šè¿‡åŸºäºŽHTTPçš„RESTful APIè¿›è¡Œé€šä¿¡åä½œã€‚ä¸‹å›¾å±•ç¤ºäº†å•ä½“åº”ç”¨å’Œå¾®æœåŠ¡ä¹‹é—´çš„åŒºåˆ«ï¼šåœ¨å¾®æœåŠ¡çš„æž¶æž„ä¸‹ï¼Œå•ä½“åº”ç”¨çš„å„ä¸ªä¸šåŠ¡æ¨¡å—è¢«æ‹†åˆ†ä¸ºä¸€ä¸ªä¸ªå•ç‹¬çš„æœåŠ¡å¹¶éƒ¨ç½²åœ¨å•ç‹¬çš„è¿›ç¨‹é‡Œï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥å•ç‹¬çš„éƒ¨ç½²å’Œå‡çº§ã€‚è¿™ç§åŽ»ä¸­å¿ƒåŒ–çš„æ¨¡å¼ä½¿å¾—åŽæœŸç»´æŠ¤å’Œå¼€å‘å˜å¾—æ›´åŠ çµæ´»å’Œæ–¹ä¾¿ã€‚ç”±äºŽå„ä¸ªæœåŠ¡å•ç‹¬éƒ¨ç½²ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯­å¥æ¥å¼€å‘å„ä¸ªä¸šåŠ¡æœåŠ¡æ¨¡å—ã€‚ä»€ä¹ˆæ˜¯Spring CloudSpring Cloudæ˜¯ä¸€ä¸ªåŸºåƒSpring Bootå®žçŽ°çš„å¾®æœåŠ¡æž¶æž„å¼€å‘å·¥å…·ã€‚å®ƒä¸ºå¾®æœåŠ¡æž¶æž„ä¸­æ¶‰åŠçš„é…ç½®ç®¡ç†ã€æœåŠ¡æ²»ç†ã€æ–­è·¯å™¨ã€æ™ºèƒ½è·¯ç”±ã€å¾®ä»£ç†ã€æŽ§åˆ¶æ€»çº¿ã€å…¨å±€é”ã€å†³ç­–ç«žé€‰ã€åˆ†å¸ƒå¼ä¼šè¯å’Œé›†ç¾¤çŠ¶æ€ç®¡ç†ç­‰æ“ä½œæä¾›äº†ä¸€ç§ç®€å•çš„å¼€å‘æ–¹å¼ã€‚Spring Cloudçš„è¯žç”Ÿå¹¶ä¸æ˜¯ä¸ºäº†è§£å†³å¾®æœåŠ¡ä¸­çš„æŸä¸€ä¸ªé—®é¢˜ï¼Œè€Œæ˜¯æä¾›äº†ä¸€å¥—è§£å†³å¾®æœåŠ¡æž¶æž„å®žæ–½çš„ç»¼åˆæ€§è§£å†³æ–¹æ¡ˆã€‚Spring Cloudæ˜¯ä¸€ä¸ªç”±å„ä¸ªç‹¬ç«‹é¡¹ç›®ç»„æˆçš„ç»¼åˆé¡¹ç›®ï¼Œæ¯ä¸ªç‹¬ç«‹é¡¹ç›®æœ‰ç€ä¸åŒçš„å‘å¸ƒèŠ‚å¥ï¼Œä¸ºäº†ç®¡ç†æ¯ä¸ªç‰ˆæœ¬çš„å­é¡¹ç›®æ¸…å•ï¼Œé¿å…Spring Cloudçš„ç‰ˆæœ¬å·ä¸Žå…¶å­é¡¹ç›®çš„ç‰ˆæœ¬å·ç›¸æ··æ·†ï¼Œæ²¡æœ‰é‡‡ç”¨ç‰ˆæœ¬å·çš„æ–¹å¼ï¼Œè€Œæ˜¯é€šè¿‡å‘½åçš„æ–¹å¼ã€‚è¿™äº›ç‰ˆæœ¬çš„åå­—é‡‡ç”¨äº†ä¼¦æ•¦åœ°é“ç«™çš„åå­—ï¼Œæ ¹æ®å­—æ¯è¡¨çš„é¡ºåºæ¥å¯¹åº”ç‰ˆæœ¬æ—¶é—´é¡ºåºã€‚æ¯”å¦‚â€Angelâ€æ˜¯Spring Cloudçš„ç¬¬ä¸€ä¸ªå‘è¡Œç‰ˆåç§°, â€œBrixtonâ€æ˜¯Spring Cloudçš„ç¬¬äºŒä¸ªå‘è¡Œç‰ˆåç§°ã€‚å½“ä¸€ä¸ªç‰ˆæœ¬çš„Spring Cloudé¡¹ç›®çš„å‘å¸ƒå†…å®¹ç§¯ç´¯åˆ°ä¸´ç•Œç‚¹æˆ–è€…ä¸€ä¸ªä¸¥é‡bugè§£å†³å¯ç”¨åŽï¼Œå°±ä¼šå‘å¸ƒä¸€ä¸ªâ€service releasesâ€ç‰ˆæœ¬ï¼Œç®€ç§°SRXç‰ˆæœ¬ï¼Œå…¶ä¸­Xæ˜¯ä¸€ä¸ªé€’å¢žçš„æ•°å­—ï¼Œæ‰€ä»¥Brixton.SR5å°±æ˜¯Brixtonçš„ç¬¬5ä¸ªReleaseç‰ˆæœ¬ã€‚æˆªè‡³2018å¹´4æœˆ02æ—¥ï¼ŒSpring Cloudå·²ç»å‘å¸ƒäº†ä»£å·ä¸ºFinchleyçš„å¿«ç…§ç‰ˆæœ¬ï¼Œé‡‡ç”¨çš„Spring Bootç‰ˆæœ¬ä¸º2.0.1.RELEASEã€‚Spring Cloudçš„ç‰ˆæœ¬å’ŒSpring Bootçš„ç‰ˆæœ¬å…³ç³»å¯ä»¥æŸ¥çœ‹å®˜ç½‘ç»™çš„ä¾‹å­ã€‚ä»¥ä¸‹æ˜¯Spring Cloudç‰ˆæœ¬ä¸Žå„ä¸ªç‹¬ç«‹é¡¹ç›®ç‰ˆæœ¬å¯¹åº”å…³ç³»è¡¨ï¼šComponentEdgware.SR3Finchley.RC1Finchley.BUILD-SNAPSHOTspring-cloud-aws1.2.2.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-bus1.3.2.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-cli1.4.1.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-commons1.3.3.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-contract1.2.4.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-config1.4.3.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-netflix1.4.4.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-security1.2.2.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-cloudfoundry1.1.1.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-consul1.3.3.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-sleuth1.3.3.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-streamDitmars.SR3Elmhurst.RELEASEElmhurst.BUILD-SNAPSHOTspring-cloud-zookeeper1.2.1.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-boot1.5.10.RELEASE2.0.1.RELEASE2.0.0.BUILD-SNAPSHOTspring-cloud-task1.2.2.RELEASE2.0.0.RC12.0.0.RELEASEspring-cloud-vault1.1.0.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-gateway1.0.1.RELEASE2.0.0.RC12.0.0.BUILD-SNAPSHOTspring-cloud-openfeign&nbsp;2.0.0.RC12.0.0.BUILD-SNAPSHOTFinchleyä½¿ç”¨Spring Boot 2.0.xæž„å»ºï¼Œä¸å»ºè®®ä¸ŽSpring Boot 1.5.xä¸€èµ·ä½¿ç”¨ã€‚Dalstonå’ŒEdgwareå‘è¡Œç‰ˆå»ºç«‹åœ¨Spring Boot 1.5.xä¹‹ä¸Šï¼Œä¸å»ºè®®ä¸ŽSpring Boot 2.0.xä¸€èµ·ä½¿ç”¨ã€‚ä¹‹åŽåšæ–‡çš„ä¾‹å­å°†é‡‡ç”¨Spring Cloud Edgware SR3ç‰ˆæœ¬ï¼Œå¯¹åº”çš„Spring Bootç‰ˆæœ¬ä¸º1.5.13.RELEASEã€‚å‚è€ƒæ–‡ç« http://blog.cuicc.com/blog/2015/07/22/microservices/https://www.ibm.com/developerworks/community/blogs/https://projects.spring.io/spring-cloud/ã€ŠSpring Cloudå¾®æœåŠ¡å®žæˆ˜ã€‹]]></content>
      <tags>
        <tag>Spring Cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot Devtoolsçƒ­éƒ¨ç½²]]></title>
    <url>%2FSpring-Boot-Devtools.html</url>
    <content type="text"><![CDATA[å¹³æ—¥é‡Œå¼€å‘é¡¹ç›®ä¸­ï¼Œä¿®æ”¹äº†Javaä»£ç æˆ–è€…é…ç½®æ–‡ä»¶çš„æ—¶å€™ï¼Œå¿…é¡»æ‰‹åŠ¨é‡å¯é¡¹ç›®æ‰èƒ½ç”Ÿæ•ˆã€‚æ‰€è°“çš„çƒ­éƒ¨ç½²å°±æ˜¯åœ¨ä½ ä¿®æ”¹äº†åŽç«¯ä»£ç åŽä¸éœ€è¦æ‰‹åŠ¨é‡å¯ï¼Œå·¥å…·ä¼šå¸®ä½ å¿«é€Ÿçš„è‡ªåŠ¨é‡å¯æ˜¯ä¿®æ”¹ç”Ÿæ•ˆã€‚å…¶æ·±å±‚åŽŸç†æ˜¯ä½¿ç”¨äº†ä¸¤ä¸ªClassLoaderï¼Œä¸€ä¸ªClassloaderåŠ è½½é‚£äº›ä¸ä¼šæ”¹å˜çš„ç±»ï¼ˆç¬¬ä¸‰æ–¹JaråŒ…ï¼‰ï¼Œå¦ä¸€ä¸ªClassLoaderåŠ è½½ä¼šæ›´æ”¹çš„ç±»ï¼Œç§°ä¸ºrestart ClassLoaderï¼Œè¿™æ ·åœ¨æœ‰ä»£ç æ›´æ”¹çš„æ—¶å€™ï¼ŒåŽŸæ¥çš„restart ClassLoader è¢«ä¸¢å¼ƒï¼Œé‡æ–°åˆ›å»ºä¸€ä¸ªrestart ClassLoaderï¼Œç”±äºŽéœ€è¦åŠ è½½çš„ç±»ç›¸æ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥å®žçŽ°äº†è¾ƒå¿«çš„é‡å¯æ—¶é—´ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•é€šè¿‡ä½¿ç”¨Spring-Boot-devtoolsæ¥å®žçŽ°Spring Booté¡¹ç›®çš„çƒ­éƒ¨ç½²ã€‚IDEä½¿ç”¨çš„æ˜¯Eclipse Oxygenï¼Œå¹¶ä¸”ä½¿ç”¨Mavenæž„å»ºã€‚å¼•å…¥Devtoolsæ­å»ºä¸€ä¸ªç®€å•çš„Spring Booté¡¹ç›®ï¼Œç„¶åŽå¼•å…¥Spring-Boot-devtoolsï¼š12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt;&lt;/dependency&gt;devtoolsä¼šç›‘å¬classpathä¸‹çš„æ–‡ä»¶å˜åŠ¨ï¼Œå¹¶ä¸”ä¼šç«‹å³é‡å¯åº”ç”¨ï¼ˆå‘ç”Ÿåœ¨ä¿å­˜æ—¶æœºï¼‰ï¼Œå› ä¸ºå…¶é‡‡ç”¨çš„è™šæ‹Ÿæœºæœºåˆ¶ï¼Œè¯¥é¡¹é‡å¯æ˜¯å¾ˆå¿«çš„ã€‚åœ¨Eclipseä¸­ç”Ÿæ•ˆè¿˜éœ€è¦ä¿®æ”¹spring-boot-maven-pluginæ’ä»¶ï¼š1234567891011&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;fork&gt;true&lt;/fork&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt;å¹¶ä¸”å¼€å¯Build Automaticallyï¼šæµ‹è¯•çƒ­éƒ¨ç½²åœ¨å…¥å£ç±»ä¸­æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºŽçƒ­éƒ¨ç½²æµ‹è¯•ï¼š12345678910111213141516import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@SpringBootApplicationpublic class DemoApplication &#123; @RequestMapping("/") String index() &#123; return "hello spring boot"; &#125; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;å¯åŠ¨é¡¹ç›®è®¿é—®http://localhost:8080/ï¼Œé¡µé¢è¾“å‡ºhello spring bootã€‚å°†æ–¹æ³•çš„è¿”å›žå€¼ä¿®æ”¹ä¸ºhello worldå¹¶åœ¨ä¿å­˜çš„çž¬é—´ï¼Œåº”ç”¨ä¾¿é‡å¯å¥½äº†ï¼Œåˆ·æ–°é¡µé¢ï¼Œå†…å®¹ä¹Ÿå°†å¾—åˆ°æ›´æ”¹ã€‚æ‰€æœ‰é…ç½®ä¸‹é¢æ˜¯æ‰€æœ‰Devtoolsåœ¨Spring Bootä¸­çš„å¯é€‰é…ç½®:1234567891011121314151617181920212223242526272829# Whether to enable a livereload.com-compatible server.spring.devtools.livereload.enabled=true # Server port.spring.devtools.livereload.port=35729 # Additional patterns that should be excluded from triggering a full restart.spring.devtools.restart.additional-exclude= # Additional paths to watch for changes.spring.devtools.restart.additional-paths= # Whether to enable automatic restart.spring.devtools.restart.enabled=true# Patterns that should be excluded from triggering a full restart.spring.devtools.restart.exclude=META-INF/maven/**,META-INF/resources/**,resources/**,static/**,public/**,templates/**,**/*Test.class,**/*Tests.class,git.properties,META-INF/build-info.properties# Whether to log the condition evaluation delta upon restart.spring.devtools.restart.log-condition-evaluation-delta=true # Amount of time to wait between polling for classpath changes.spring.devtools.restart.poll-interval=1s # Amount of quiet time required without any classpath changes before a restart is triggered.spring.devtools.restart.quiet-period=400ms # Name of a specific file that, when changed, triggers the restart check. If not specified, any classpath file change triggers the restart.spring.devtools.restart.trigger-file=æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/24.Spring-Boot-Devtoolså‚è€ƒè‡ªï¼š http://412887952-qq-com.iteye.com/blog/2300313]]></content>
      <tags>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨Spring Boot Adminç›‘æŽ§æœåŠ¡]]></title>
    <url>%2FSpring-Boot-Admin.html</url>
    <content type="text"><![CDATA[åœ¨ä½¿ç”¨Actuatorç›‘æŽ§Spring Bootåº”ç”¨ä¸€èŠ‚ä¸­æˆ‘ä»¬ä»‹ç»äº†ä½¿ç”¨Actuatoræ¥ç›‘æŽ§Spring Bootåº”ç”¨ï¼Œå…¶æä¾›äº†è®¸å¤šRESTæŽ¥å£æ¥æŸ¥çœ‹åº”ç”¨çš„ä¿¡æ¯ã€‚ä½†å…¶è¿”å›žçš„æ˜¯å¤§é‡çš„JSONæ ¼å¼æ•°æ®ï¼Œä¿¡æ¯çœ‹ä¸ŠåŽ»ä¸ç›´è§‚ä¹Ÿä¸æ˜“äºŽç†è§£ã€‚è€ŒSpring Boot Adminï¼ˆSBAï¼‰æ˜¯ä¸€æ¬¾åŸºäºŽActuatorå¼€å‘çš„å¼€æºè½¯ä»¶ï¼šhttps://github.com/codecentric/spring-boot-adminï¼Œä»¥å›¾å½¢åŒ–ç•Œé¢çš„æ–¹å¼å±•ç¤ºSpring Bootåº”ç”¨çš„é…ç½®ä¿¡æ¯ã€Beansä¿¡æ¯ã€çŽ¯å¢ƒå±žæ€§ã€çº¿ç¨‹ä¿¡æ¯ã€JVMçŠ¶å†µç­‰ã€‚æœ¬æ–‡ä½¿ç”¨çš„Spring Boot Adminç‰ˆæœ¬ä¸º1.5.7ï¼Œæœ‰èƒ½åŠ›çš„æœ‹å‹å¯ä»¥ç›´æŽ¥é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼šhttp://codecentric.github.io/spring-boot-admin/1.5.7ã€‚æ­å»ºSBAæœåŠ¡ç«¯æ­å»ºä¸€ä¸ªSBAæœåŠ¡ç«¯ï¼ˆServerï¼‰ï¼Œå…¶ä»–è¢«ç›‘æŽ§çš„Spring Bootåº”ç”¨ä½œä¸ºå®¢æˆ·ç«¯ï¼ˆClientï¼‰ï¼Œå®¢æˆ·ç«¯é€šè¿‡HTTPçš„æ–¹å¼å°†è‡ªå·±æ³¨å†Œåˆ°æœåŠ¡ç«¯ï¼Œä»¥ä¾›æœåŠ¡ç«¯è¿›è¡Œç›‘æŽ§æœåŠ¡ã€‚å¤§è‡´å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¼•å…¥SBA Serverä¾èµ–ä½¿ç”¨http://start.spring.io/å¼€å¯ä¸€ä¸ªç®€å•çš„Spring Booté¡¹ç›®ï¼Œç„¶åŽå¼•å…¥spring-boot-admin-serverç›¸å…³ä¾èµ–ï¼š12345678910&lt;dependency&gt; &lt;groupId&gt;de.codecentric&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-admin-server&lt;/artifactId&gt; &lt;version&gt;1.5.7&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;de.codecentric&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-admin-server-ui&lt;/artifactId&gt; &lt;version&gt;1.5.7&lt;/version&gt;Â·&lt;/dependency&gt;å¼€å¯Adminç›‘æŽ§åœ¨Spring Bootå…¥å£ç±»ä¸­åŠ å…¥@EnableAutoConfigurationï¼Œ@EnableAdminServeræ³¨è§£å¼€å¯ç›‘æŽ§åŠŸèƒ½ï¼š1234567891011121314import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.EnableAutoConfiguration;import org.springframework.boot.autoconfigure.SpringBootApplication;import de.codecentric.boot.admin.config.EnableAdminServer;@SpringBootApplication@EnableAutoConfiguration@EnableAdminServerpublic class DemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;ç„¶åŽåœ¨ymlä¸­å¯¹é¡¹ç›®è¿›è¡Œç®€å•çš„é…ç½®ï¼š123server: port: 8080 context-path: /admin-serverå¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/admin-serverï¼šå› ä¸ºè¿˜æ²¡æ·»åŠ å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥ç›‘æŽ§åˆ—è¡¨é‡Œæ˜¯ç©ºçš„ï¼ŒæŽ¥ä¸‹æ¥åˆ›å»ºä¸€ä¸ªSpring Bootåº”ç”¨ä½œä¸ºå®¢æˆ·ç«¯ã€‚SBAå®¢æˆ·ç«¯å¼•å…¥SBA Clientä¾èµ–åŒæ ·çš„ï¼Œä½¿ç”¨http://start.spring.io/æ­å»ºä¸€ä¸ªç®€å•çš„Spring Booté¡¹ç›®ä½œä¸ºSBAå®¢æˆ·ç«¯ï¼Œç„¶åŽå¼•å…¥Clientä¾èµ–ï¼š12345&lt;dependency&gt; &lt;groupId&gt;de.codecentric&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-admin-starter-client&lt;/artifactId&gt; &lt;version&gt;1.5.7&lt;/version&gt;&lt;/dependency&gt;ymlé…ç½®ï¼š1234567891011management: security: enabled: false server: port: 8081 spring: boot: admin: url: http://localhost:8080/admin-serverspring.boot.admin.urlé…ç½®çš„æ˜¯SBAæœåŠ¡ç«¯çš„åœ°å€ï¼Œmanagement.security.enabled: falseè¿™é‡Œå…ˆå…³é—­å®‰å…¨éªŒè¯ã€‚å¯åŠ¨å®¢æˆ·ç«¯åŽæŸ¥çœ‹http://localhost:8080/admin-serveråœ°å€ï¼šå¯çœ‹åˆ°SBAå®¢æˆ·ç«¯å·²ç»è¢«æ³¨å†Œåˆ°SBAæœåŠ¡ç«¯äº†ï¼ŒæŽ¥ä¸‹æ¥ä¾¿å¯ä»¥åœ¨SBAæœåŠ¡ç«¯é¡µé¢ä¸ŠæŸ¥çœ‹å„ç§SBAå®¢æˆ·ç«¯ä¿¡æ¯ï¼šå®¢æˆ·ç«¯é¢å¤–ä¿¡æ¯é»˜è®¤å®¢æˆ·ç«¯åœ¨æœåŠ¡ç«¯ç›‘æŽ§åˆ—è¡¨å‘ˆçŽ°çš„ä¿¡æ¯å¹¶ä¸å¤šï¼šæˆ‘ä»¬å¯ä»¥åœ¨SBAå®¢æˆ·ç«¯ymlé‡Œé…ç½®æ›´ä¸ºè¯¦ç»†çš„ä¿¡æ¯ï¼š123456info: app: name: "@project.name@" description: "@project.description@" version: "@project.version@" spring-boot-version: "@project.parent.version@"ç„¶åŽä¾¿å¯ä»¥åœ¨SBAæœåŠ¡ç«¯çœ‹åˆ°è¾ƒä¸ºè¯¦ç»†çš„å®¢æˆ·ç«¯ä¿¡æ¯ï¼š æ·»åŠ é‚®ä»¶é¢„è­¦SBAæœåŠ¡ç«¯ä¹Ÿå¯ä»¥é…ç½®é‚®ä»¶é¢„è­¦æœåŠ¡ï¼Œé»˜è®¤æƒ…å†µä¸‹å¯¹äºŽè¢«æ£€æµ‹çš„åº”ç”¨å¯åŠ¨æˆ–è€…åœæ­¢çš„æ—¶å€™ä¼šè§¦å‘é¢„è­¦ã€‚é¦–å…ˆæ·»åŠ é‚®ä»¶ä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;&lt;/dependency&gt;ç„¶åŽåœ¨SBAæœåŠ¡ç«¯çš„ymlä¸­é…ç½®é‚®ä»¶é¢„è­¦ï¼š12345678910111213141516171819spring: mail: host: smtp.163.com username: xxx@163.com password: xxx properties: mail: smtp: auth: true starttls: enable: true required: true boot: admin: notify: mail: from: xxx@163.com to: xxx@qq.comé‚®ä»¶çš„å…·ä½“ä½¿ç”¨æ–¹æ³•å¯å‚è€ƒhttps://mrbird.cc/Spring-Boot-Email.htmlã€‚å½“è¢«æ£€æµ‹çš„åº”ç”¨å…³åœçš„æ—¶å€™ï¼Œæ”¶åˆ°å¦‚ä¸‹é‚®ä»¶ï¼šé™„å½•SBA Serveré…ç½®è¯´æ˜ŽProperty nameDescriptionDefault valueä¸­æ–‡è¯´æ˜Žspring.boot.admin.context-pathThe context-path prefixes the path where the Admin Serverâ€™s statics assets and API should be served. Relative to the Dispatcher-Servlet.Admin Server ä¿ç•™çš„é™æ€è®¿é—®å’ŒAPIçš„å‰ç¼€ï¼ˆå½“ä½ åœ¨ä¸šåŠ¡åº”ç”¨ä¸­ä½¿ç”¨è€Œä¸æ˜¯å•ç‹¬ä½¿ç”¨æ—¶å°±å¾ˆæœ‰å¿…è¦äº†ï¼‰spring.boot.admin.monitor.periodTime interval in ms to update the status of applications with expired status-informations.10.000æ›´æ–°åº”ç”¨ä¿¡æ¯çš„é¢‘çŽ‡ï¼Œå•ä½æ¯«ç§’spring.boot.admin.monitor.status-lifetimeLifetime of application statuses in ms. The applications /health-endpoint will not be queried until the lifetime has expired.10.000è¢«ç›‘æŽ§çš„åº”ç”¨ä¿¡æ¯çš„è¿‡æœŸæ—¶é—´ï¼Œå•ä½æ¯«ç§’SBA Clienté…ç½®è¯´æ˜ŽProperty nameDescriptionDefault valueä¸­æ–‡è¯´æ˜Žspring.boot.admin.client.enabledEnables the Spring Boot Admin Client.trueé»˜è®¤å¼€å¯spring.boot.admin.urlList of URLs of the Spring Boot Admin server to register at. This triggers the AutoConfiguration. Mandatory.admin server çš„åœ°å€åˆ—è¡¨ï¼Œæ­¤è®¾ç½®ä¼šè§¦å‘è‡ªåŠ¨é…ç½®ï¼Œå¿…é¡»spring.boot.admin.api-pathHttp-path of registration endpoint at your admin server.â€œapi/applicationsâ€æ³¨å†Œåˆ° admin server ç«¯ç‚¹çš„ Http-pathspring.boot.admin.username spring.boot.admin.passwordUsername and password for http-basic authentication. If set the registration uses http-basic-authentication when registering at the admin server.æ³¨å†Œåˆ° admin server çš„è´¦å·å¯†ç spring.boot.admin.periodInterval for repeating the registration (in ms).10.000é‡è¯•æ³¨å†Œçš„é—´éš”æ—¶é—´spring.boot.admin.auto-registrationIf set to true the periodic task to register the application is automatically scheduled after the application is ready.trueåº”ç”¨å¯åŠ¨åŽè‡ªåŠ¨æ‰§è¡Œå‘¨æœŸæ€§çš„æ³¨å†Œä»»åŠ¡spring.boot.admin.auto-deregistrationSwitch to enable auto-deregistration at Spring Boot Admin server when context is closed.falseå½“åº”ç”¨å…³é—­æ—¶ï¼Œè‡ªåŠ¨å–æ¶ˆæ³¨å†Œspring.boot.admin.client.health-urlClient-health-url to register with. Can be overridden in case the reachable URL is different (e.g. Docker). Must be unique in registry.Guessed based on management-url and endpoints.health.id.spring.boot.admin.client.management-urlClient-management-url to register with. Can be overridden in case the reachable url is different (e.g. Docker).Guessed based on service-url, server.servlet-path, management.port and management.context-path.spring.boot.admin.client.service-urlClient-service-url to register with. Can be overridden in case the reachable url is different (e.g. Docker).Guessed based on hostname, server.port and server.context-path.spring.boot.admin.client.nameName to register with.${spring.application.name} if set, â€œspring-boot-applicationâ€ otherwise.æ³¨å†Œæ—¶çš„åå­—spring.boot.admin.client.prefer-ipUse the ip-address rather then the hostname in the guessed urls. If server.address / management.address is set, it get used. Otherwise the IP address returned from InetAddress.getLocalHost() gets used.falseé‚®ä»¶é…ç½®é€‰é¡¹Property nameDescriptionDefault valueä¸­æ–‡è¯´æ˜Žspring.boot.admin.notify.mail.enabledEnable mail notificationstrueé»˜è®¤å¯ç”¨spring.boot.admin.notify.mail.ignore-changesComma-delimited list of status changes to be ignored. Format: â€œ:â€. Wildcards allowed.â€œUNKNOWN:UPâ€éœ€è¦å¿½ç•¥çš„çŠ¶æ€æ”¹å˜é€šçŸ¥ï¼Œé€—å·åˆ†éš”spring.boot.admin.notify.mail.toComma-delimited list of mail recipientsâ€œroot@localhostâ€æŽ¥æ”¶é€šçŸ¥çš„é‚®ç®±åœ°å€ï¼Œé€—å·åˆ†éš”spring.boot.admin.notify.mail.ccComma-delimited list of carbon-copy recipientsæŠ„é€spring.boot.admin.notify.mail.fromMail senderå‘é€äººspring.boot.admin.notify.mail.subjectMail subject. SpEL-expressions are supportedâ€œ#{application.name} (#{application.id}) is #{to.status}â€ä¸»é¢˜spring.boot.admin.notify.mail.textMail body. SpEL-expressions are supportedâ€œ#{application.name} (#{application.id})\nstatus changed from #{from.status} to #{to.status}\n\n#{application.healthUrl}â€å†…å®¹å‚è€ƒåšæ–‡ï¼šhttps://blog.csdn.net/kinginblue/article/details/52132113#t26æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/23.Spring-Boot-Adminã€‚]]></content>
      <tags>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨Spring Bootå‘é€é‚®ä»¶]]></title>
    <url>%2FSpring-Boot-Email.html</url>
    <content type="text"><![CDATA[åœ¨é¡¹ç›®çš„ç»´æŠ¤è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šåœ¨åº”ç”¨ä¸­åŠ å…¥çŸ­ä¿¡æˆ–è€…é‚®ä»¶é¢„è­¦åŠŸèƒ½ï¼Œæ¯”å¦‚å½“åº”ç”¨å‡ºçŽ°å¼‚å¸¸å®•æœºæ—¶åº”è¯¥åŠæ—¶åœ°å°†é¢„è­¦ä¿¡æ¯å‘é€ç»™è¿ç»´æˆ–è€…å¼€å‘äººå‘˜ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åœ¨Spring Bootä¸­å‘é€é‚®ä»¶ã€‚åœ¨Spring Bootä¸­å‘é€é‚®ä»¶ä½¿ç”¨çš„æ˜¯Springæä¾›çš„org.springframework.mail.javamail.JavaMailSenderï¼Œå…¶æä¾›äº†è®¸å¤šç®€å•æ˜“ç”¨çš„æ–¹æ³•ï¼Œå¯å‘é€ç®€å•çš„é‚®ä»¶ã€HTMLæ ¼å¼çš„é‚®ä»¶ã€å¸¦é™„ä»¶çš„é‚®ä»¶ï¼Œå¹¶ä¸”å¯ä»¥åˆ›å»ºé‚®ä»¶æ¨¡æ¿ã€‚å¼•å…¥ä¾èµ–åœ¨Spring Bootä¸­å‘é€é‚®ä»¶ï¼Œéœ€è¦ç”¨åˆ°spring-boot-starter-mailï¼Œå¼•å…¥spring-boot-starter-mailï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;&lt;/dependency&gt;é‚®ä»¶é…ç½®åœ¨application.ymlä¸­è¿›è¡Œç®€å•çš„é…ç½®ï¼ˆä»¥163é‚®ä»¶ä¸ºä¾‹ï¼‰ï¼š123456789101112131415server: port: 80spring: mail: host: smtp.163.com username: ä½ çš„è´¦å· password: ä½ çš„å¯†ç  properties: mail: smtp: auth: true starttls: enable: true required: truespring.mail.usernameï¼Œspring.mail.passwordå¡«å†™è‡ªå·±çš„é‚®ç®±è´¦å·å¯†ç å³å¯ã€‚å‘é€ç®€å•çš„é‚®ä»¶ç¼–å†™EmailControllerï¼Œæ³¨å…¥JavaMailSender:123456789101112131415161718192021222324252627282930313233import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Value;import org.springframework.mail.SimpleMailMessage;import org.springframework.mail.javamail.JavaMailSender;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping("/email")public class EmailController &#123; @Autowired private JavaMailSender jms; @Value("$&#123;spring.mail.username&#125;") private String from; @RequestMapping("sendSimpleEmail") public String sendSimpleEmail() &#123; try &#123; SimpleMailMessage message = new SimpleMailMessage(); message.setFrom(from); message.setTo("888888@qq.com"); // æŽ¥æ”¶åœ°å€ message.setSubject("ä¸€å°ç®€å•çš„é‚®ä»¶"); // æ ‡é¢˜ message.setText("ä½¿ç”¨Spring Bootå‘é€ç®€å•é‚®ä»¶ã€‚"); // å†…å®¹ jms.send(message); return "å‘é€æˆåŠŸ"; &#125; catch (Exception e) &#123; e.printStackTrace(); return e.getMessage(); &#125; &#125;&#125;å¯åŠ¨é¡¹ç›®è®¿é—®http://localhost/email/sendSimpleEmailï¼Œæç¤ºå‘é€æˆåŠŸï¼šå‘é€HTMLæ ¼å¼çš„é‚®ä»¶æ”¹é€ EmailControllerï¼ŒSimpleMailMessageæ›¿æ¢ä¸ºMimeMessageï¼š12345678910111213141516171819202122232425262728293031323334353637383940import javax.mail.internet.MimeMessage;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Value;import org.springframework.mail.SimpleMailMessage;import org.springframework.mail.javamail.JavaMailSender;import org.springframework.mail.javamail.MimeMessageHelper;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping("/email")public class EmailController &#123; @Autowired private JavaMailSender jms; @Value("$&#123;spring.mail.username&#125;") private String from; @RequestMapping("sendHtmlEmail") public String sendHtmlEmail() &#123; MimeMessage message = null; try &#123; message = jms.createMimeMessage(); MimeMessageHelper helper = new MimeMessageHelper(message, true); helper.setFrom(from); helper.setTo("888888@qq.com"); // æŽ¥æ”¶åœ°å€ helper.setSubject("ä¸€å°HTMLæ ¼å¼çš„é‚®ä»¶"); // æ ‡é¢˜ // å¸¦HTMLæ ¼å¼çš„å†…å®¹ StringBuffer sb = new StringBuffer("&lt;p style='color:#6db33f'&gt;ä½¿ç”¨Spring Bootå‘é€HTMLæ ¼å¼é‚®ä»¶ã€‚&lt;/p&gt;"); helper.setText(sb.toString(), true); jms.send(message); return "å‘é€æˆåŠŸ"; &#125; catch (Exception e) &#123; e.printStackTrace(); return e.getMessage(); &#125; &#125;&#125;helper.setText(sb.toString(), true);ä¸­çš„trueè¡¨ç¤ºå‘é€HTMLæ ¼å¼é‚®ä»¶ã€‚å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost/email/sendHtmlEmailï¼Œæç¤ºå‘é€æˆåŠŸï¼Œå¯çœ‹åˆ°æ–‡æœ¬å·²ç»åŠ ä¸Šäº†é¢œè‰²#6db33fï¼šå‘é€å¸¦é™„ä»¶çš„é‚®ä»¶å‘é€å¸¦é™„ä»¶çš„é‚®ä»¶å’Œæ™®é€šé‚®ä»¶ç›¸æ¯”ï¼Œå…¶å®žå°±åªæ˜¯å¤šäº†ä¸ªä¼ å…¥é™„ä»¶çš„è¿‡ç¨‹ã€‚ä¸è¿‡ä½¿ç”¨çš„ä»æ˜¯MimeMessageï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546package com.springboot.demo.controller;import java.io.File;import javax.mail.internet.MimeMessage;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Value;import org.springframework.core.io.FileSystemResource;import org.springframework.mail.SimpleMailMessage;import org.springframework.mail.javamail.JavaMailSender;import org.springframework.mail.javamail.MimeMessageHelper;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping("/email")public class EmailController &#123; @Autowired private JavaMailSender jms; @Value("$&#123;spring.mail.username&#125;") private String from; @RequestMapping("sendAttachmentsMail") public String sendAttachmentsMail() &#123; MimeMessage message = null; try &#123; message = jms.createMimeMessage(); MimeMessageHelper helper = new MimeMessageHelper(message, true); helper.setFrom(from); helper.setTo("888888@qq.com"); // æŽ¥æ”¶åœ°å€ helper.setSubject("ä¸€å°å¸¦é™„ä»¶çš„é‚®ä»¶"); // æ ‡é¢˜ helper.setText("è¯¦æƒ…å‚è§é™„ä»¶å†…å®¹ï¼"); // å†…å®¹ // ä¼ å…¥é™„ä»¶ FileSystemResource file = new FileSystemResource(new File("src/main/resources/static/file/é¡¹ç›®æ–‡æ¡£.docx")); helper.addAttachment("é¡¹ç›®æ–‡æ¡£.docx", file); jms.send(message); return "å‘é€æˆåŠŸ"; &#125; catch (Exception e) &#123; e.printStackTrace(); return e.getMessage(); &#125; &#125;&#125;å¯åŠ¨é¡¹ç›®è®¿é—®http://localhost/email/sendAttachmentsMailï¼Œæç¤ºå‘é€æˆåŠŸï¼šå‘é€å¸¦é™æ€èµ„æºçš„é‚®ä»¶å‘é€å¸¦é™æ€èµ„æºçš„é‚®ä»¶å…¶å®žå°±æ˜¯åœ¨å‘é€HTMLé‚®ä»¶çš„åŸºç¡€ä¸ŠåµŒå…¥é™æ€èµ„æºï¼ˆæ¯”å¦‚å›¾ç‰‡ï¼‰ï¼ŒåµŒå…¥é™æ€èµ„æºçš„è¿‡ç¨‹å’Œä¼ å…¥é™„ä»¶ç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºŽéœ€è¦æ ‡è¯†èµ„æºçš„cidï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546package com.springboot.demo.controller;import java.io.File;import javax.mail.internet.MimeMessage;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Value;import org.springframework.core.io.FileSystemResource;import org.springframework.mail.SimpleMailMessage;import org.springframework.mail.javamail.JavaMailSender;import org.springframework.mail.javamail.MimeMessageHelper;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping("/email")public class EmailController &#123; @Autowired private JavaMailSender jms; @Value("$&#123;spring.mail.username&#125;") private String from; @RequestMapping("sendInlineMail") public String sendInlineMail() &#123; MimeMessage message = null; try &#123; message = jms.createMimeMessage(); MimeMessageHelper helper = new MimeMessageHelper(message, true); helper.setFrom(from); helper.setTo("888888@qq.com"); // æŽ¥æ”¶åœ°å€ helper.setSubject("ä¸€å°å¸¦é™æ€èµ„æºçš„é‚®ä»¶"); // æ ‡é¢˜ helper.setText("&lt;html&gt;&lt;body&gt;åšå®¢å›¾ï¼š&lt;img src='cid:img'/&gt;&lt;/body&gt;&lt;/html&gt;", true); // å†…å®¹ // ä¼ å…¥é™„ä»¶ FileSystemResource file = new FileSystemResource(new File("src/main/resources/static/img/sunshine.png")); helper.addInline("img", file); jms.send(message); return "å‘é€æˆåŠŸ"; &#125; catch (Exception e) &#123; e.printStackTrace(); return e.getMessage(); &#125; &#125;&#125;helper.addInline(&quot;img&quot;, file);ä¸­çš„imgå’Œå›¾ç‰‡æ ‡ç­¾é‡ŒcidåŽçš„åç§°ç›¸å¯¹åº”ã€‚å¯åŠ¨é¡¹ç›®è®¿é—®http://localhost/email/sendInlineMailï¼Œæç¤ºå‘é€æˆåŠŸï¼šä½¿ç”¨æ¨¡æ¿å‘é€é‚®ä»¶åœ¨å‘é€éªŒè¯ç ç­‰æƒ…å†µä¸‹å¯ä»¥åˆ›å»ºä¸€ä¸ªé‚®ä»¶çš„æ¨¡æ¿ï¼Œå”¯ä¸€çš„å˜é‡ä¸ºéªŒè¯ç ã€‚è¿™ä¸ªä¾‹å­ä¸­ä½¿ç”¨çš„æ¨¡æ¿è§£æžå¼•æ“Žä¸ºThymeleafï¼Œæ‰€ä»¥é¦–å…ˆå¼•å…¥Thymeleafä¾èµ–ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&lt;/dependency&gt;åœ¨templateç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªemailTemplate.htmlæ¨¡æ¿ï¼š1234567891011&lt;!DOCTYPE html&gt;&lt;html lang="zh" xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;meta charset="UTF-8" /&gt; &lt;title&gt;æ¨¡æ¿&lt;/title&gt;&lt;/head&gt;&lt;body&gt; æ‚¨å¥½ï¼Œæ‚¨çš„éªŒè¯ç ä¸º&#123;code&#125;ï¼Œè¯·åœ¨ä¸¤åˆ†é’Ÿå†…ä½¿ç”¨å®Œæˆæ“ä½œã€‚&lt;/body&gt;&lt;/html&gt;å‘é€æ¨¡æ¿é‚®ä»¶ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯å‘é€HTMLé‚®ä»¶ï¼Œåªä¸è¿‡å¤šäº†ç»‘å®šå˜é‡çš„è¿‡ç¨‹ï¼Œè¯¦ç»†å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152package com.springboot.demo.controller;import java.io.File;import javax.mail.internet.MimeMessage;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Value;import org.springframework.core.io.FileSystemResource;import org.springframework.mail.SimpleMailMessage;import org.springframework.mail.javamail.JavaMailSender;import org.springframework.mail.javamail.MimeMessageHelper;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;import org.thymeleaf.TemplateEngine;import org.thymeleaf.context.Context;@RestController@RequestMapping("/email")public class EmailController &#123; @Autowired private JavaMailSender jms; @Value("$&#123;spring.mail.username&#125;") private String from; @Autowired private TemplateEngine templateEngine; @RequestMapping("sendTemplateEmail") public String sendTemplateEmail(String code) &#123; MimeMessage message = null; try &#123; message = jms.createMimeMessage(); MimeMessageHelper helper = new MimeMessageHelper(message, true); helper.setFrom(from); helper.setTo("888888@qq.com"); // æŽ¥æ”¶åœ°å€ helper.setSubject("é‚®ä»¶æ‘¸æ¿æµ‹è¯•"); // æ ‡é¢˜ // å¤„ç†é‚®ä»¶æ¨¡æ¿ Context context = new Context(); context.setVariable("code", code); String template = templateEngine.process("emailTemplate", context); helper.setText(template, true); jms.send(message); return "å‘é€æˆåŠŸ"; &#125; catch (Exception e) &#123; e.printStackTrace(); return e.getMessage(); &#125; &#125;&#125;å…¶ä¸­codeå¯¹åº”æ¨¡æ¿é‡Œçš„${code}å˜é‡ã€‚å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost/email/sendTemplateEmail?code=EOS9ï¼Œé¡µé¢æç¤ºå‘é€æˆåŠŸï¼šæºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/22.Spring-Boot-Email]]></content>
      <tags>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨Actuatorç›‘æŽ§Spring Bootåº”ç”¨]]></title>
    <url>%2FAcutator-Spring-Boot.html</url>
    <content type="text"><![CDATA[æˆ‘ä»¬éƒ½çŸ¥é“Spring Bootæ˜¯ä¸€ä¸ªç”¨äºŽå¿«é€Ÿå¼€å‘Java Webçš„æ¡†æž¶ï¼Œä¸éœ€è¦å¤ªå¤šçš„é…ç½®å³å¯ä½¿ç”¨Springçš„å¤§é‡åŠŸèƒ½ã€‚Spring Bootéµå¾ªç€â€œçº¦å®šå¤§äºŽé…ç½®â€çš„åŽŸåˆ™ï¼Œè®¸å¤šåŠŸèƒ½ä½¿ç”¨é»˜è®¤çš„é…ç½®å³å¯ã€‚è¿™æ ·çš„åšæ³•å¥½å¤„åœ¨äºŽæˆ‘ä»¬ä¸éœ€è¦åƒä½¿ç”¨Springé‚£æ ·ç¼–å†™ä¸€å¤§å †çš„XMLé…ç½®ä»£ç ï¼Œä½†è¿‡äºŽç®€å•çš„é…ç½®è¿‡ç¨‹ä¼šè®©æˆ‘ä»¬åœ¨äº†è§£å„ç§ä¾èµ–ï¼Œé…ç½®ä¹‹é—´çš„å…³ç³»è¿‡ç¨‹ä¸Šå¸¦æ¥ä¸€äº›å›°éš¾ã€‚ä¸è¿‡æ²¡å…³ç³»ï¼Œåœ¨Spring Bootä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Actuatoræ¥ç›‘æŽ§åº”ç”¨ï¼ŒActuatoræä¾›äº†ä¸€ç³»åˆ—çš„RESTful APIè®©æˆ‘ä»¬å¯ä»¥æ›´ä¸ºç»†è‡´çš„äº†è§£å„ç§ä¿¡æ¯ã€‚å¼•å…¥Actuator1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;é…ç½®Actuator1234567891011server: port: 80management: security: enabled: false #å…³æŽ‰å®‰å…¨è®¤è¯ port: 80 context-path: /monitor #actuatorçš„è®¿é—®è·¯å¾„endpoints: shutdown: enabled: trueé…ç½®ä¸­å…³é—­äº†å®‰å…¨è®¤è¯çš„åŠŸèƒ½ï¼Œå¦‚æžœéœ€è¦å¼€å¯è¿™ä¸ªåŠŸèƒ½çš„è¯è¿˜éœ€å¼•å…¥spring-boot-starter-securityä¾èµ–ã€‚é™¤äº†ä½¿ç”¨Spring Securityæ¥å¼€å¯ç›‘æŽ§è·¯å¾„å®‰å…¨è®¤è¯å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨Shiroå¯¹ç›‘æŽ§è·¯å¾„è¿›è¡Œæƒé™æŽ§åˆ¶ã€‚ç›‘æŽ§çš„ç«¯å£å’Œåº”ç”¨ä¸€è‡´ï¼Œé…ç½®context-pathä¸º/monitorï¼Œè¿™æ ·å¯ä»¥é¿å…å’Œè‡ªå·±åº”ç”¨çš„è·¯å¾„æ˜ å°„åœ°å€é‡å¤ã€‚endpoints.shutdown.enabled: trueæä¾›äº†ä½¿ç”¨postè¯·æ±‚æ¥å…³é—­Spring Bootåº”ç”¨çš„åŠŸèƒ½ã€‚ActuatoræŽ¥å£åˆ—è¡¨Actuatoræä¾›äº†13ä¸ªæŽ¥å£ï¼Œå¯ä»¥åˆ†ä¸ºä¸‰å¤§ç±»ï¼šé…ç½®æŽ¥å£ã€åº¦é‡æŽ¥å£å’Œå…¶å®ƒæŽ¥å£ï¼Œå…·ä½“å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šHTTP æ–¹æ³•è·¯å¾„æè¿°GET/autoconfigæä¾›äº†ä¸€ä»½è‡ªåŠ¨é…ç½®æŠ¥å‘Šï¼Œè®°å½•å“ªäº›è‡ªåŠ¨é…ç½®æ¡ä»¶é€šè¿‡äº†ï¼Œå“ªäº›æ²¡é€šè¿‡GET/configpropsæè¿°é…ç½®å±žæ€§(åŒ…å«é»˜è®¤å€¼)å¦‚ä½•æ³¨å…¥BeanGET/beansæè¿°åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡é‡Œå…¨éƒ¨çš„Beanï¼Œä»¥åŠå®ƒä»¬çš„å…³ç³»GET/dumpèŽ·å–çº¿ç¨‹æ´»åŠ¨çš„å¿«ç…§GET/envèŽ·å–å…¨éƒ¨çŽ¯å¢ƒå±žæ€§GET/env/{name}æ ¹æ®åç§°èŽ·å–ç‰¹å®šçš„çŽ¯å¢ƒå±žæ€§å€¼GET/healthæŠ¥å‘Šåº”ç”¨ç¨‹åºçš„å¥åº·æŒ‡æ ‡ï¼Œè¿™äº›å€¼ç”±HealthIndicatorçš„å®žçŽ°ç±»æä¾›GET/infoèŽ·å–åº”ç”¨ç¨‹åºçš„å®šåˆ¶ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ç”±infoæ‰“å¤´çš„å±žæ€§æä¾›GET/mappingsæè¿°å…¨éƒ¨çš„URIè·¯å¾„ï¼Œä»¥åŠå®ƒä»¬å’ŒæŽ§åˆ¶å™¨(åŒ…å«Actuatorç«¯ç‚¹)çš„æ˜ å°„å…³ç³»GET/metricsæŠ¥å‘Šå„ç§åº”ç”¨ç¨‹åºåº¦é‡ä¿¡æ¯ï¼Œæ¯”å¦‚å†…å­˜ç”¨é‡å’ŒHTTPè¯·æ±‚è®¡æ•°GET/metrics/{name}æŠ¥å‘ŠæŒ‡å®šåç§°çš„åº”ç”¨ç¨‹åºåº¦é‡å€¼POST/shutdownå…³é—­åº”ç”¨ç¨‹åºï¼Œè¦æ±‚endpoints.shutdown.enabledè®¾ç½®ä¸ºtrueGET/traceæä¾›åŸºæœ¬çš„HTTPè¯·æ±‚è·Ÿè¸ªä¿¡æ¯(æ—¶é—´æˆ³ã€HTTPå¤´ç­‰)æŽ¥å£ä½¿ç”¨ç¤ºä¾‹autoconfigæ˜¾ç¤ºæ‰€æœ‰è‡ªåŠ¨è£…é…ç±»çš„æŠ¥å‘Šï¼Œä»¥åŠæ˜¯ä»€ä¹ˆåŽŸå› å¯¼è‡´è‡ªåŠ¨è£…é…æˆåŠŸæˆ–è€…ä¸æˆåŠŸã€‚åœ¨æµè§ˆå™¨è¾“å…¥ï¼šhttp://localhost/monitor/autoconfigï¼Œè¾“å‡ºå¦‚ä¸‹ï¼ˆæˆªå–éƒ¨åˆ†ï¼‰ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&#123; "positiveMatches": &#123; "AuditAutoConfiguration#auditListener": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.audit.listener.AbstractAuditListener; SearchStrategy: all) did not find any beans" &#125;], "AuditAutoConfiguration.AuditEventRepositoryConfiguration": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.audit.AuditEventRepository; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration#autoConfigurationReportEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnBean (types: org.springframework.boot.autoconfigure.condition.ConditionEvaluationReport; SearchStrategy: all) found bean 'autoConfigurationReport'; @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.AutoConfigurationReportEndpoint; SearchStrategy: current) did not find any beans" &#125;], "EndpointAutoConfiguration#beansEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.BeansEndpoint; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration#configurationPropertiesReportEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.ConfigurationPropertiesReportEndpoint; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration#dumpEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.DumpEndpoint; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration#environmentEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.EnvironmentEndpoint; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration#healthEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.HealthEndpoint; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration#infoEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.InfoEndpoint; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration#loggersEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnBean (types: org.springframework.boot.logging.LoggingSystem; SearchStrategy: all) found bean 'springBootLoggingSystem'; @ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.LoggersEndpoint; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration#metricsEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.MetricsEndpoint; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration#shutdownEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.ShutdownEndpoint; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration#traceEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.TraceEndpoint; SearchStrategy: all) did not find any beans" &#125;], "EndpointAutoConfiguration.RequestMappingEndpointConfiguration": [&#123; "condition": "OnClassCondition", "message": "@ConditionalOnClass found required class 'org.springframework.web.servlet.handler.AbstractHandlerMethodMapping'; @ConditionalOnMissingClass did not find unwanted class" &#125;], "EndpointAutoConfiguration.RequestMappingEndpointConfiguration#requestMappingEndpoint": [&#123; "condition": "OnBeanCondition", "message": "@ConditionalOnMissingBean (types: org.springframework.boot.actuate.endpoint.RequestMappingEndpoint; SearchStrategy: all) did not find any beans" &#125;],...&#125;beansæŸ¥çœ‹Spring å®¹å™¨ç®¡ç†çš„Bean,è®¿é—®http://localhost/monitor/beansï¼Œè¾“å‡ºå¦‚ä¸‹ï¼ˆæˆªå–éƒ¨åˆ†ï¼‰ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238[&#123; "context": "application:80", "parent": null, "beans": [&#123; "bean": "demoApplication", "aliases": [], "scope": "singleton", "type": "com.springboot.demo.DemoApplication$$EnhancerBySpringCGLIB$$77e6b2b4", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.internalCachingMetadataReaderFactory", "aliases": [], "scope": "singleton", "type": "org.springframework.core.type.classreading.CachingMetadataReaderFactory", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.context.PropertyPlaceholderAutoConfiguration$$EnhancerBySpringCGLIB$$dc9af024", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.condition.BeanTypeRegistry", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.condition.BeanTypeRegistry", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "propertySourcesPlaceholderConfigurer", "aliases": [], "scope": "singleton", "type": "org.springframework.context.support.PropertySourcesPlaceholderConfigurer", "resource": "class path resource [org/springframework/boot/autoconfigure/context/PropertyPlaceholderAutoConfiguration.class]", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration$$EnhancerBySpringCGLIB$$a4dba584", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "standardJacksonObjectMapperBuilderCustomizer", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration$StandardJackson2ObjectMapperBuilderCustomizer", "resource": "class path resource [org/springframework/boot/autoconfigure/jackson/JacksonAutoConfiguration$Jackson2ObjectMapperBuilderCustomizerConfiguration.class]", "dependencies": ["org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@78f30883", "spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties"] &#125;, &#123; "bean": "spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.jackson.JacksonProperties", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.context.properties.ConfigurationPropertiesBindingPostProcessor", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.context.properties.ConfigurationPropertiesBindingPostProcessor", "resource": "null", "dependencies": ["org.springframework.boot.context.properties.ConfigurationPropertiesBindingPostProcessor.store"] &#125;, &#123; "bean": "org.springframework.boot.context.properties.ConfigurationPropertiesBindingPostProcessor.store", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.context.properties.ConfigurationBeanFactoryMetaData", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperBuilderConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperBuilderConfiguration$$EnhancerBySpringCGLIB$$e9c4bf95", "resource": "null", "dependencies": ["org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@78f30883"] &#125;, &#123; "bean": "jacksonObjectMapperBuilder", "aliases": [], "scope": "singleton", "type": "org.springframework.http.converter.json.Jackson2ObjectMapperBuilder", "resource": "class path resource [org/springframework/boot/autoconfigure/jackson/JacksonAutoConfiguration$JacksonObjectMapperBuilderConfiguration.class]", "dependencies": ["standardJacksonObjectMapperBuilderCustomizer"] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$JacksonObjectMapperConfiguration$$EnhancerBySpringCGLIB$$3777fd7c", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "jacksonObjectMapper", "aliases": [], "scope": "singleton", "type": "com.fasterxml.jackson.databind.ObjectMapper", "resource": "class path resource [org/springframework/boot/autoconfigure/jackson/JacksonAutoConfiguration$JacksonObjectMapperConfiguration.class]", "dependencies": ["jacksonObjectMapperBuilder"] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.jackson.JacksonAutoConfiguration$$EnhancerBySpringCGLIB$$19839b0b", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "jsonComponentModule", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.jackson.JsonComponentModule", "resource": "class path resource [org/springframework/boot/autoconfigure/jackson/JacksonAutoConfiguration.class]", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.websocket.WebSocketAutoConfiguration$TomcatWebSocketConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.websocket.WebSocketAutoConfiguration$TomcatWebSocketConfiguration$$EnhancerBySpringCGLIB$$ab6fe14", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "websocketContainerCustomizer", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.websocket.TomcatWebSocketContainerCustomizer", "resource": "class path resource [org/springframework/boot/autoconfigure/websocket/WebSocketAutoConfiguration$TomcatWebSocketConfiguration.class]", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.websocket.WebSocketAutoConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.websocket.WebSocketAutoConfiguration$$EnhancerBySpringCGLIB$$ee951243", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.web.EmbeddedServletContainerAutoConfiguration$EmbeddedTomcat", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.web.EmbeddedServletContainerAutoConfiguration$EmbeddedTomcat$$EnhancerBySpringCGLIB$$8f67c107", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "tomcatEmbeddedServletContainerFactory", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.context.embedded.tomcat.TomcatEmbeddedServletContainerFactory", "resource": "class path resource [org/springframework/boot/autoconfigure/web/EmbeddedServletContainerAutoConfiguration$EmbeddedTomcat.class]", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.web.EmbeddedServletContainerAutoConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.web.EmbeddedServletContainerAutoConfiguration$$EnhancerBySpringCGLIB$$48514e2b", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "embeddedServletContainerCustomizerBeanPostProcessor", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.context.embedded.EmbeddedServletContainerCustomizerBeanPostProcessor", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "errorPageRegistrarBeanPostProcessor", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.web.servlet.ErrorPageRegistrarBeanPostProcessor", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration$DispatcherServletConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration$DispatcherServletConfiguration$$EnhancerBySpringCGLIB$$824a2d3d", "resource": "null", "dependencies": ["spring.mvc-org.springframework.boot.autoconfigure.web.WebMvcProperties"] &#125;, &#123; "bean": "dispatcherServlet", "aliases": [], "scope": "singleton", "type": "org.springframework.web.servlet.DispatcherServlet", "resource": "class path resource [org/springframework/boot/autoconfigure/web/DispatcherServletAutoConfiguration$DispatcherServletConfiguration.class]", "dependencies": [] &#125;, &#123; "bean": "spring.mvc-org.springframework.boot.autoconfigure.web.WebMvcProperties", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.web.WebMvcProperties", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration$DispatcherServletRegistrationConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration$DispatcherServletRegistrationConfiguration$$EnhancerBySpringCGLIB$$fd39bc64", "resource": "null", "dependencies": ["serverProperties", "spring.mvc-org.springframework.boot.autoconfigure.web.WebMvcProperties"] &#125;, &#123; "bean": "dispatcherServletRegistration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.web.servlet.ServletRegistrationBean", "resource": "class path resource [org/springframework/boot/autoconfigure/web/DispatcherServletAutoConfiguration$DispatcherServletRegistrationConfiguration.class]", "dependencies": ["dispatcherServlet"] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration$$EnhancerBySpringCGLIB$$d158c03f", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.validation.ValidationAutoConfiguration$$EnhancerBySpringCGLIB$$4ce40e75", "resource": "null", "dependencies": [] &#125;, &#123; "bean": "methodValidationPostProcessor", "aliases": [], "scope": "singleton", "type": "org.springframework.validation.beanvalidation.MethodValidationPostProcessor", "resource": "class path resource [org/springframework/boot/autoconfigure/validation/ValidationAutoConfiguration.class]", "dependencies": ["environment"] &#125;, ...... &#123; "bean": "org.springframework.boot.autoconfigure.web.WebClientAutoConfiguration", "aliases": [], "scope": "singleton", "type": "org.springframework.boot.autoconfigure.web.WebClientAutoConfiguration$$EnhancerBySpringCGLIB$$ec83a29e", "resource": "null", "dependencies": [] &#125;]&#125;]configpropsæ‰€æœ‰ï¼ ConfigurationPropertiesæ³¨è§£çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚æ–‡ä»¶ä¸Šä¼ çš„æœ€å¤§å…è®¸é…ç½®ç­‰ã€‚è®¿é—®http://localhost/monitor/configpropsï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440&#123; "environmentMvcEndpoint": &#123; "prefix": "endpoints.env", "properties": &#123; "path": "/env" &#125; &#125;, "heapdumpMvcEndpoint": &#123; "prefix": "endpoints.heapdump", "properties": &#123; "enabled": true, "path": "/heapdump", "sensitive": true &#125; &#125;, "managementServerProperties": &#123; "prefix": "management", "properties": &#123; "port": 80, "addApplicationContextHeader": true, "address": null, "contextPath": "/monitor", "ssl": null, "security": &#123; "enabled": false, "roles": ["ACTUATOR"], "sessions": "STATELESS" &#125; &#125; &#125;, "spring.mvc-org.springframework.boot.autoconfigure.web.WebMvcProperties": &#123; "prefix": "spring.mvc", "properties": &#123; "locale": null, "mediaTypes": &#123;&#125;, "localeResolver": "ACCEPT_HEADER", "messageCodesResolverFormat": null, "async": &#123; "requestTimeout": null &#125;, "dispatchOptionsRequest": true, "servlet": &#123; "loadOnStartup": -1 &#125;, "ignoreDefaultModelOnRedirect": true, "dispatchTraceRequest": false, "staticPathPattern": "/**", "dateFormat": null, "view": &#123; "prefix": null, "suffix": null &#125;, "logResolvedException": false, "throwExceptionIfNoHandlerFound": false &#125; &#125;, "spring.http.multipart-org.springframework.boot.autoconfigure.web.MultipartProperties": &#123; "prefix": "spring.http.multipart", "properties": &#123; "enabled": true, "maxRequestSize": "10MB", "location": null, "resolveLazily": false, "fileSizeThreshold": "0", "maxFileSize": "1MB" &#125; &#125;, "spring.http.encoding-org.springframework.boot.autoconfigure.web.HttpEncodingProperties": &#123; "prefix": "spring.http.encoding", "properties": &#123; "charset": "UTF-8", "mapping": null, "force": false, "forceResponse": false, "forceRequest": false &#125; &#125;, "endpoints.health-org.springframework.boot.actuate.autoconfigure.HealthMvcEndpointProperties": &#123; "prefix": "endpoints.health", "properties": &#123; "mapping": &#123;&#125; &#125; &#125;, "spring.resources-org.springframework.boot.autoconfigure.web.ResourceProperties": &#123; "prefix": "spring.resources", "properties": &#123; "staticLocations": ["/", "classpath:/META-INF/resources/", "classpath:/resources/", "classpath:/static/", "classpath:/public/"], "addMappings": true, "chain": &#123; "cache": true, "htmlApplicationCache": false, "gzipped": false, "strategy": &#123; "fixed": &#123; "enabled": false, "paths": ["/**"], "version": null &#125;, "content": &#123; "enabled": false, "paths": ["/**"] &#125; &#125; &#125;, "cachePeriod": null &#125; &#125;, "shutdownMvcEndpoint": &#123; "prefix": "endpoints.shutdown", "properties": &#123; "path": "/shutdown" &#125; &#125;, "requestMappingEndpoint": &#123; "prefix": "endpoints.mappings", "properties": &#123; "id": "mappings", "enabled": true, "sensitive": true &#125; &#125;, "autoConfigurationReportEndpoint": &#123; "prefix": "endpoints.autoconfig", "properties": &#123; "id": "autoconfig", "enabled": true, "sensitive": true &#125; &#125;, "management.trace-org.springframework.boot.actuate.trace.TraceProperties": &#123; "prefix": "management.trace", "properties": &#123; "include": ["TIME_TAKEN", "ERRORS", "REQUEST_HEADERS", "COOKIES", "RESPONSE_HEADERS"] &#125; &#125;, "management.info-org.springframework.boot.actuate.autoconfigure.InfoContributorProperties": &#123; "prefix": "management.info", "properties": &#123; "git": &#123; "mode": "SIMPLE" &#125; &#125; &#125;, "loggersEndpoint": &#123; "prefix": "endpoints.loggers", "properties": &#123; "id": "loggers", "enabled": true, "sensitive": true &#125; &#125;, "spring.jackson-org.springframework.boot.autoconfigure.jackson.JacksonProperties": &#123; "prefix": "spring.jackson", "properties": &#123; "deserialization": &#123;&#125;, "defaultPropertyInclusion": null, "propertyNamingStrategy": null, "locale": null, "serialization": &#123;&#125;, "jodaDateTimeFormat": null, "mapper": &#123;&#125;, "generator": &#123;&#125;, "timeZone": null, "dateFormat": null, "parser": &#123;&#125; &#125; &#125;, "shutdownEndpoint": &#123; "prefix": "endpoints.shutdown", "properties": &#123; "id": "shutdown", "enabled": true, "sensitive": true &#125; &#125;, "endpoints.metrics.filter-org.springframework.boot.actuate.autoconfigure.MetricFilterProperties": &#123; "prefix": "endpoints.metrics.filter", "properties": &#123; "counterSubmissions": ["MERGED"], "gaugeSubmissions": ["MERGED"] &#125; &#125;, "loggersMvcEndpoint": &#123; "prefix": "endpoints.loggers", "properties": &#123; "path": "/loggers" &#125; &#125;, "dumpEndpoint": &#123; "prefix": "endpoints.dump", "properties": &#123; "id": "dump", "enabled": true, "sensitive": true &#125; &#125;, "endpoints-org.springframework.boot.actuate.endpoint.EndpointProperties": &#123; "prefix": "endpoints", "properties": &#123; "enabled": true, "sensitive": null &#125; &#125;, "metricsMvcEndpoint": &#123; "prefix": "endpoints.metrics", "properties": &#123; "path": "/metrics" &#125; &#125;, "metricsEndpoint": &#123; "prefix": "endpoints.metrics", "properties": &#123; "id": "metrics", "enabled": true, "sensitive": true &#125; &#125;, "healthEndpoint": &#123; "prefix": "endpoints.health", "properties": &#123; "id": "health", "enabled": true, "timeToLive": 1000, "sensitive": false &#125; &#125;, "auditEventMvcEndpoint": &#123; "prefix": "endpoints.auditevents", "properties": &#123; "enabled": true, "path": "/auditevents", "sensitive": true &#125; &#125;, "healthMvcEndpoint": &#123; "prefix": "endpoints.health", "properties": &#123; "path": "/health" &#125; &#125;, "endpoints.cors-org.springframework.boot.actuate.autoconfigure.EndpointCorsProperties": &#123; "prefix": "endpoints.cors", "properties": &#123; "maxAge": 1800, "exposedHeaders": [], "allowedHeaders": [], "allowedOrigins": [], "allowedMethods": [], "allowCredentials": null &#125; &#125;, "diskSpaceHealthIndicatorProperties": &#123; "prefix": "management.health.diskspace", "properties": &#123; "path": "C:\\Users\\Administrator\\Desktop\\01.Start-Spring-Boot\\.", "threshold": 10485760 &#125; &#125;, "beansEndpoint": &#123; "prefix": "endpoints.beans", "properties": &#123; "id": "beans", "enabled": true, "sensitive": true &#125; &#125;, "traceEndpoint": &#123; "prefix": "endpoints.trace", "properties": &#123; "id": "trace", "enabled": true, "sensitive": true &#125; &#125;, "auditEventsEndpoint": &#123; "prefix": "endpoints.auditevents", "properties": &#123; "enabled": true &#125; &#125;, "endpoints.jmx-org.springframework.boot.actuate.autoconfigure.EndpointMBeanExportProperties": &#123; "prefix": "endpoints.jmx", "properties": &#123; "enabled": true, "uniqueNames": false, "domain": "", "staticNames": &#123;&#125; &#125; &#125;, "spring.metrics.export-org.springframework.boot.actuate.metrics.export.MetricExportProperties": &#123; "prefix": "spring.metrics.export", "properties": &#123; "enabled": true, "redis": &#123; "prefix": "spring.metrics.application.7f8f2ef33a0f173c075f96c8f5c5b4fd", "key": "******" &#125;, "aggregate": &#123; "prefix": "application.7f8f2ef33a0f173c075f96c8f5c5b4fd", "keyPattern": "k.d" &#125;, "excludes": null, "statsd": &#123; "host": null, "port": 8125, "prefix": null &#125;, "triggers": &#123;&#125;, "includes": null &#125; &#125;, "configurationPropertiesReportEndpoint": &#123; "prefix": "endpoints.configprops", "properties": &#123; "id": "configprops", "enabled": true, "sensitive": true &#125; &#125;, "spring.info-org.springframework.boot.autoconfigure.info.ProjectInfoProperties": &#123; "prefix": "spring.info", "properties": &#123; "git": &#123; "location": &#123;&#125; &#125;, "build": &#123; "location": &#123;&#125; &#125; &#125; &#125;, "infoEndpoint": &#123; "prefix": "endpoints.info", "properties": &#123; "id": "info", "enabled": true, "sensitive": false &#125; &#125;, "serverProperties": &#123; "prefix": "server", "properties": &#123; "undertow": &#123; "maxHttpPostSize": 0, "bufferSize": null, "buffersPerRegion": null, "ioThreads": null, "workerThreads": null, "directBuffers": null, "accesslog": &#123; "enabled": null, "pattern": "common", "prefix": "access_log.", "suffix": "log", "dir": "C:\\Users\\Administrator\\Desktop\\01.Start-Spring-Boot\\logs", "rotate": true &#125; &#125;, "port": 80, "error": &#123; "path": "/error", "includeStacktrace": "NEVER" &#125;, "maxHttpHeaderSize": 0, "jspServlet": null, "ssl": null, "maxHttpPostSize": 0, "jetty": &#123; "maxHttpPostSize": 0, "acceptors": null, "selectors": null &#125;, "servletPath": "/", "tomcat": &#123; "accesslog": &#123; "enabled": false, "pattern": "common", "directory": "logs", "prefix": "access_log", "suffix": ".log", "rotate": true, "renameOnRotate": false, "fileDateFormat": ".yyyy-MM-dd", "requestAttributesEnabled": false, "buffered": true &#125;, "internalProxies": "10\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;|192\\.168\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;|169\\.254\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;|127\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;|172\\.1[6-9]&#123;1&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;|172\\.2[0-9]&#123;1&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;|172\\.3[0-1]&#123;1&#125;\\.\\d&#123;1,3&#125;\\.\\d&#123;1,3&#125;", "protocolHeader": null, "protocolHeaderHttpsValue": "https", "portHeader": "X-Forwarded-Port", "remoteIpHeader": null, "basedir": null, "backgroundProcessorDelay": 30, "maxThreads": 0, "minSpareThreads": 0, "maxHttpPostSize": 0, "redirectContextRoot": null, "uriEncoding": null, "maxConnections": 0, "acceptCount": 0, "additionalTldSkipPatterns": [] &#125;, "connectionTimeout": null, "session": &#123; "timeout": null, "trackingModes": null, "persistent": false, "storeDir": null, "cookie": &#123; "name": null, "domain": null, "path": null, "comment": null, "httpOnly": null, "secure": null, "maxAge": null &#125; &#125;, "address": null, "contextParameters": &#123;&#125;, "serverHeader": null, "useForwardHeaders": null, "contextPath": null, "displayName": "application" &#125; &#125;, "management.health.status-org.springframework.boot.actuate.autoconfigure.HealthIndicatorProperties": &#123; "prefix": "management.health.status", "properties": &#123; "order": null &#125; &#125;, "environmentEndpoint": &#123; "prefix": "endpoints.env", "properties": &#123; "id": "env", "enabled": true, "sensitive": true &#125; &#125;&#125;trace/traceæŽ¥å£èƒ½æŸ¥çœ‹æœ€è¿‘çš„HTTP è¯·æ±‚å’Œå“åº”ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥ï¼šhttp://localhost/monitor/traceï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105[&#123; "timestamp": 1525657638444, "info": &#123; "method": "GET", "path": "/login;JSESSIONID=c1d0a83c-05fd-479c-ae6b-2ecc9b878a4a", "headers": &#123; "request": &#123; "host": "localhost", "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0", "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8", "accept-language": "zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "upgrade-insecure-requests": "1", "pragma": "no-cache", "cache-control": "no-cache" &#125;, "response": &#123; "X-Application-Context": "application:80", "status": "404" &#125; &#125;, "timeTaken": "11" &#125;&#125;, &#123; "timestamp": 1525657495017, "info": &#123; "method": "GET", "path": "/monitor/beans", "headers": &#123; "request": &#123; "host": "localhost", "connection": "keep-alive", "upgrade-insecure-requests": "1", "user-agent": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.10 Safari/537.36", "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8", "accept-encoding": "gzip, deflate, br", "accept-language": "zh-CN,zh;q=0.9,en;q=0.8" &#125;, "response": &#123; "X-Application-Context": "application:80", "Content-Type": "application/vnd.spring-boot.actuator.v1+json;charset=UTF-8", "Transfer-Encoding": "chunked", "Date": "Mon, 07 May 2018 01:44:55 GMT", "status": "200" &#125; &#125;, "timeTaken": "609" &#125;&#125;, &#123; "timestamp": 1525657402454, "info": &#123; "method": "GET", "path": "/favicon.ico", "headers": &#123; "request": &#123; "host": "localhost", "connection": "keep-alive", "pragma": "no-cache", "cache-control": "no-cache", "user-agent": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.10 Safari/537.36", "accept": "image/webp,image/apng,image/*,*/*;q=0.8", "referer": "http://localhost/monitor/autoconfig", "accept-encoding": "gzip, deflate, br", "accept-language": "zh-CN,zh;q=0.9,en;q=0.8" &#125;, "response": &#123; "X-Application-Context": "application:80", "Last-Modified": "Wed, 29 Nov 2017 01:54:48 GMT", "Accept-Ranges": "bytes", "Content-Type": "application/octet-stream", "Content-Length": "946", "Date": "Mon, 07 May 2018 01:43:22 GMT", "status": "200" &#125; &#125;, "timeTaken": "21" &#125;&#125;, &#123; "timestamp": 1525657402076, "info": &#123; "method": "GET", "path": "/monitor/autoconfig", "headers": &#123; "request": &#123; "host": "localhost", "connection": "keep-alive", "cache-control": "max-age=0", "upgrade-insecure-requests": "1", "user-agent": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.10 Safari/537.36", "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8", "accept-encoding": "gzip, deflate, br", "accept-language": "zh-CN,zh;q=0.9,en;q=0.8" &#125;, "response": &#123; "X-Application-Context": "application:80", "Content-Type": "application/vnd.spring-boot.actuator.v1+json;charset=UTF-8", "Transfer-Encoding": "chunked", "Date": "Mon, 07 May 2018 01:43:22 GMT", "status": "200" &#125; &#125;, "timeTaken": "300" &#125;&#125;]dumpèŽ·å–æŸä¸€æ—¶åˆ»è™šæ‹Ÿæœºçº¿ç¨‹æ ˆä¿¡æ¯ã€‚çº¿ç¨‹æ ˆè¡¨ç¤ºæŸä¸€æ—¶åˆ»è™šæ‹Ÿæœºæ­£åœ¨åšçš„äº‹æƒ…ï¼Œè®¿é—®http://localhost/monitor/dumpï¼Œè¾“å‡ºå¦‚ä¸‹ï¼ˆæˆªå–éƒ¨åˆ†ï¼‰ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249[&#123; "threadName": "DestroyJavaVM", "threadId": 32, "blockedTime": -1, "blockedCount": 0, "waitedTime": -1, "waitedCount": 0, "lockName": null, "lockOwnerId": -1, "lockOwnerName": null, "inNative": false, "suspended": false, "threadState": "RUNNABLE", "stackTrace": [], "lockedMonitors": [], "lockedSynchronizers": [], "lockInfo": null&#125;, &#123; "threadName": "http-nio-80-AsyncTimeout", "threadId": 30, "blockedTime": -1, "blockedCount": 0, "waitedTime": -1, "waitedCount": 14903, "lockName": null, "lockOwnerId": -1, "lockOwnerName": null, "inNative": false, "suspended": false, "threadState": "TIMED_WAITING", "stackTrace": [&#123; "methodName": "sleep", "fileName": "Thread.java", "lineNumber": -2, "className": "java.lang.Thread", "nativeMethod": true &#125;, &#123; "methodName": "run", "fileName": "AbstractProtocol.java", "lineNumber": 1211, "className": "org.apache.coyote.AbstractProtocol$AsyncTimeout", "nativeMethod": false &#125;, &#123; "methodName": "run", "fileName": "Thread.java", "lineNumber": 745, "className": "java.lang.Thread", "nativeMethod": false &#125;], "lockedMonitors": [], "lockedSynchronizers": [], "lockInfo": null&#125;, &#123; "threadName": "http-nio-80-Acceptor-0", "threadId": 29, "blockedTime": -1, "blockedCount": 0, "waitedTime": -1, "waitedCount": 0, "lockName": null, "lockOwnerId": -1, "lockOwnerName": null, "inNative": true, "suspended": false, "threadState": "RUNNABLE", "stackTrace": [&#123; "methodName": "accept0", "fileName": "ServerSocketChannelImpl.java", "lineNumber": -2, "className": "sun.nio.ch.ServerSocketChannelImpl", "nativeMethod": true &#125;, &#123; "methodName": "accept", "fileName": "ServerSocketChannelImpl.java", "lineNumber": 250, "className": "sun.nio.ch.ServerSocketChannelImpl", "nativeMethod": false &#125;, &#123; "methodName": "run", "fileName": "NioEndpoint.java", "lineNumber": 455, "className": "org.apache.tomcat.util.net.NioEndpoint$Acceptor", "nativeMethod": false &#125;, &#123; "methodName": "run", "fileName": "Thread.java", "lineNumber": 745, "className": "java.lang.Thread", "nativeMethod": false &#125;], "lockedMonitors": [&#123; "className": "java.lang.Object", "identityHashCode": 1985974129, "lockedStackDepth": 1, "lockedStackFrame": &#123; "methodName": "accept", "fileName": "ServerSocketChannelImpl.java", "lineNumber": 250, "className": "sun.nio.ch.ServerSocketChannelImpl", "nativeMethod": false &#125; &#125;], "lockedSynchronizers": [], "lockInfo": null&#125;, &#123; "threadName": "http-nio-80-ClientPoller-1", "threadId": 28, "blockedTime": -1, "blockedCount": 6, "waitedTime": -1, "waitedCount": 0, "lockName": null, "lockOwnerId": -1, "lockOwnerName": null, "inNative": true, "suspended": false, "threadState": "RUNNABLE", "stackTrace": [&#123; "methodName": "poll0", "fileName": "WindowsSelectorImpl.java", "lineNumber": -2, "className": "sun.nio.ch.WindowsSelectorImpl$SubSelector", "nativeMethod": true &#125;, &#123; "methodName": "poll", "fileName": "WindowsSelectorImpl.java", "lineNumber": 296, "className": "sun.nio.ch.WindowsSelectorImpl$SubSelector", "nativeMethod": false &#125;, &#123; "methodName": "access$400", "fileName": "WindowsSelectorImpl.java", "lineNumber": 278, "className": "sun.nio.ch.WindowsSelectorImpl$SubSelector", "nativeMethod": false &#125;, &#123; "methodName": "doSelect", "fileName": "WindowsSelectorImpl.java", "lineNumber": 159, "className": "sun.nio.ch.WindowsSelectorImpl", "nativeMethod": false &#125;, &#123; "methodName": "lockAndDoSelect", "fileName": "SelectorImpl.java", "lineNumber": 87, "className": "sun.nio.ch.SelectorImpl", "nativeMethod": false &#125;, &#123; "methodName": "select", "fileName": "SelectorImpl.java", "lineNumber": 98, "className": "sun.nio.ch.SelectorImpl", "nativeMethod": false &#125;, &#123; "methodName": "run", "fileName": "NioEndpoint.java", "lineNumber": 793, "className": "org.apache.tomcat.util.net.NioEndpoint$Poller", "nativeMethod": false &#125;, &#123; "methodName": "run", "fileName": "Thread.java", "lineNumber": 745, "className": "java.lang.Thread", "nativeMethod": false &#125;], "lockedMonitors": [&#123; "className": "sun.nio.ch.Util$2", "identityHashCode": 511554453, "lockedStackDepth": 4, "lockedStackFrame": &#123; "methodName": "lockAndDoSelect", "fileName": "SelectorImpl.java", "lineNumber": 87, "className": "sun.nio.ch.SelectorImpl", "nativeMethod": false &#125; &#125;, &#123; "className": "java.util.Collections$UnmodifiableSet", "identityHashCode": 563515370, "lockedStackDepth": 4, "lockedStackFrame": &#123; "methodName": "lockAndDoSelect", "fileName": "SelectorImpl.java", "lineNumber": 87, "className": "sun.nio.ch.SelectorImpl", "nativeMethod": false &#125; &#125;, &#123; "className": "sun.nio.ch.WindowsSelectorImpl", "identityHashCode": 761235575, "lockedStackDepth": 4, "lockedStackFrame": &#123; "methodName": "lockAndDoSelect", "fileName": "SelectorImpl.java", "lineNumber": 87, "className": "sun.nio.ch.SelectorImpl", "nativeMethod": false &#125; &#125;], "lockedSynchronizers": [], "lockInfo": null&#125;,...... &#123; "threadName": "Finalizer", "threadId": 3, "blockedTime": -1, "blockedCount": 202, "waitedTime": -1, "waitedCount": 51, "lockName": "java.lang.ref.ReferenceQueue$Lock@bd5f3f3", "lockOwnerId": -1, "lockOwnerName": null, "inNative": false, "suspended": false, "threadState": "WAITING", "stackTrace": [&#123; "methodName": "wait", "fileName": "Object.java", "lineNumber": -2, "className": "java.lang.Object", "nativeMethod": true &#125;, &#123; "methodName": "remove", "fileName": "ReferenceQueue.java", "lineNumber": 135, "className": "java.lang.ref.ReferenceQueue", "nativeMethod": false &#125;, &#123; "methodName": "remove", "fileName": "ReferenceQueue.java", "lineNumber": 151, "className": "java.lang.ref.ReferenceQueue", "nativeMethod": false &#125;, &#123; "methodName": "run", "fileName": "Finalizer.java", "lineNumber": 209, "className": "java.lang.ref.Finalizer$FinalizerThread", "nativeMethod": false &#125;], "lockedMonitors": [], "lockedSynchronizers": [], "lockInfo": &#123; "className": "java.lang.ref.ReferenceQueue$Lock", "identityHashCode": 198570995 &#125;&#125;]envæ˜¾ç¤ºSpring BootçŽ¯å¢ƒå˜é‡ï¼Œå¦‚ä½¿ç”¨çš„JDKç‰ˆæœ¬ã€åŠ è½½çš„jaråŒ…ã€é…ç½®æ–‡ä»¶ä¿¡æ¯ã€æ—¥å¿—æ–‡ä»¶ä¿¡æ¯ã€‚è®¿é—®ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124&#123; "profiles": [], "server.ports": &#123; "local.server.port": 80 &#125;, "servletContextInitParams": &#123;&#125;, "systemProperties": &#123; "java.runtime.name": "Java(TM) SE Runtime Environment", "sun.boot.library.path": "C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\bin", "java.vm.version": "24.80-b11", "java.vm.vendor": "Oracle Corporation", "java.vendor.url": "http://java.oracle.com/", "path.separator": ";", "java.vm.name": "Java HotSpot(TM) 64-Bit Server VM", "file.encoding.pkg": "sun.io", "user.country": "CN", "user.script": "", "sun.java.launcher": "SUN_STANDARD", "sun.os.patch.level": "", "PID": "15184", "java.vm.specification.name": "Java Virtual Machine Specification", "user.dir": "C:\\Users\\Administrator\\Desktop\\01.Start-Spring-Boot", "java.runtime.version": "1.7.0_80-b15", "java.awt.graphicsenv": "sun.awt.Win32GraphicsEnvironment", "org.jboss.logging.provider": "slf4j", "java.endorsed.dirs": "C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\endorsed", "os.arch": "amd64", "java.io.tmpdir": "C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\", "line.separator": "\r\n", "java.vm.specification.vendor": "Oracle Corporation", "user.variant": "", "os.name": "Windows 8.1", "sun.jnu.encoding": "GBK", "spring.beaninfo.ignore": "true", "java.library.path": "C:\\Program Files\\Java\\jdk1.7.0_80\\bin;C:\\Windows\\Sun\\Java\\bin;C:\\Windows\\system32;C:\\Windows;C:/Program Files/Java/jre1.8.0_31/bin/server;C:/Program Files/Java/jre1.8.0_31/bin;C:/Program Files/Java/jre1.8.0_31/lib/amd64;f:\\app\\Administrator\\product\\11.2.0\\client_1\\bin;f:\\app\\Administrator\\product\\11.2.0\\dbhome_1\\bin;C:\\ProgramData\\Oracle\\Java\\javapath;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Program Files\\nodejs\\;C:\\Program Files\\Git\\cmd;\"%JAVA_HOME%\\bin;%JAVA_HOME%\\jre\\bin\";%M2_HOME%\\bin;C:\\Program Files\\TortoiseSVN\\bin;C:\\Program Files\\PuTTY\\;C:\\ProgramData\\chocolatey\\bin;C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\Administrator\\AppData\\Roaming\\npm;\"C:\\Program Files\\Java\\jdk1.8.0_31\\bin;C:\\Program Files\\Java\\jdk1.8.0_31\\jre\\bin\";D:\\Program Files\\apache-maven-3.3.9-bin\\apache-maven-3.3.9\\bin;C:\\Program Files\\cmder;;D:\\Program Files\\Oxygen;;.", "java.specification.name": "Java Platform API Specification", "java.class.version": "51.0", "sun.management.compiler": "HotSpot 64-Bit Tiered Compilers", "os.version": "6.3", "user.home": "C:\\Users\\Administrator", "catalina.useNaming": "false", "user.timezone": "Asia/Shanghai", "java.awt.printerjob": "sun.awt.windows.WPrinterJob", "file.encoding": "UTF-8", "java.specification.version": "1.7", "catalina.home": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\tomcat.2042919348800278549.80", "java.class.path": "C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\resources.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\rt.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\jsse.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\jce.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\charsets.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\jfr.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\ext\\access-bridge-64.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\ext\\dnsns.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\ext\\jaccess.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\ext\\localedata.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\ext\\sunec.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\ext\\sunjce_provider.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\ext\\sunmscapi.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\ext\\zipfs.jar;C:\\Users\\Administrator\\Desktop\\01.Start-Spring-Boot\\target\\classes;D:\\m2\\repository\\org\\springframework\\boot\\spring-boot-starter-web\\1.5.9.RELEASE\\spring-boot-starter-web-1.5.9.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\boot\\spring-boot-starter\\1.5.9.RELEASE\\spring-boot-starter-1.5.9.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\boot\\spring-boot\\1.5.9.RELEASE\\spring-boot-1.5.9.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\boot\\spring-boot-autoconfigure\\1.5.9.RELEASE\\spring-boot-autoconfigure-1.5.9.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\boot\\spring-boot-starter-logging\\1.5.9.RELEASE\\spring-boot-starter-logging-1.5.9.RELEASE.jar;D:\\m2\\repository\\ch\\qos\\logback\\logback-classic\\1.1.11\\logback-classic-1.1.11.jar;D:\\m2\\repository\\ch\\qos\\logback\\logback-core\\1.1.11\\logback-core-1.1.11.jar;D:\\m2\\repository\\org\\slf4j\\jcl-over-slf4j\\1.7.25\\jcl-over-slf4j-1.7.25.jar;D:\\m2\\repository\\org\\slf4j\\jul-to-slf4j\\1.7.25\\jul-to-slf4j-1.7.25.jar;D:\\m2\\repository\\org\\slf4j\\log4j-over-slf4j\\1.7.25\\log4j-over-slf4j-1.7.25.jar;D:\\m2\\repository\\org\\yaml\\snakeyaml\\1.17\\snakeyaml-1.17.jar;D:\\m2\\repository\\org\\springframework\\boot\\spring-boot-starter-tomcat\\1.5.9.RELEASE\\spring-boot-starter-tomcat-1.5.9.RELEASE.jar;D:\\m2\\repository\\org\\apache\\tomcat\\embed\\tomcat-embed-core\\8.5.23\\tomcat-embed-core-8.5.23.jar;D:\\m2\\repository\\org\\apache\\tomcat\\tomcat-annotations-api\\8.5.23\\tomcat-annotations-api-8.5.23.jar;D:\\m2\\repository\\org\\apache\\tomcat\\embed\\tomcat-embed-el\\8.5.23\\tomcat-embed-el-8.5.23.jar;D:\\m2\\repository\\org\\apache\\tomcat\\embed\\tomcat-embed-websocket\\8.5.23\\tomcat-embed-websocket-8.5.23.jar;D:\\m2\\repository\\org\\hibernate\\hibernate-validator\\5.3.6.Final\\hibernate-validator-5.3.6.Final.jar;D:\\m2\\repository\\javax\\validation\\validation-api\\1.1.0.Final\\validation-api-1.1.0.Final.jar;D:\\m2\\repository\\org\\jboss\\logging\\jboss-logging\\3.3.1.Final\\jboss-logging-3.3.1.Final.jar;D:\\m2\\repository\\com\\fasterxml\\classmate\\1.3.4\\classmate-1.3.4.jar;D:\\m2\\repository\\com\\fasterxml\\jackson\\core\\jackson-databind\\2.8.10\\jackson-databind-2.8.10.jar;D:\\m2\\repository\\com\\fasterxml\\jackson\\core\\jackson-annotations\\2.8.0\\jackson-annotations-2.8.0.jar;D:\\m2\\repository\\com\\fasterxml\\jackson\\core\\jackson-core\\2.8.10\\jackson-core-2.8.10.jar;D:\\m2\\repository\\org\\springframework\\spring-web\\4.3.13.RELEASE\\spring-web-4.3.13.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\spring-aop\\4.3.13.RELEASE\\spring-aop-4.3.13.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\spring-beans\\4.3.13.RELEASE\\spring-beans-4.3.13.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\spring-context\\4.3.13.RELEASE\\spring-context-4.3.13.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\spring-webmvc\\4.3.13.RELEASE\\spring-webmvc-4.3.13.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\spring-expression\\4.3.13.RELEASE\\spring-expression-4.3.13.RELEASE.jar;D:\\m2\\repository\\org\\slf4j\\slf4j-api\\1.7.25\\slf4j-api-1.7.25.jar;D:\\m2\\repository\\org\\springframework\\spring-core\\4.3.13.RELEASE\\spring-core-4.3.13.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\boot\\spring-boot-starter-actuator\\1.5.9.RELEASE\\spring-boot-starter-actuator-1.5.9.RELEASE.jar;D:\\m2\\repository\\org\\springframework\\boot\\spring-boot-actuator\\1.5.9.RELEASE\\spring-boot-actuator-1.5.9.RELEASE.jar", "user.name": "Administrator", "java.vm.specification.version": "1.7", "sun.java.command": "com.springboot.demo.DemoApplication", "java.home": "C:\\Program Files\\Java\\jdk1.7.0_80\\jre", "sun.arch.data.model": "64", "user.language": "zh", "java.specification.vendor": "Oracle Corporation", "awt.toolkit": "sun.awt.windows.WToolkit", "java.vm.info": "mixed mode", "java.version": "1.7.0_80", "java.ext.dirs": "C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\ext;C:\\Windows\\Sun\\Java\\lib\\ext", "sun.boot.class.path": "C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\resources.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\rt.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\sunrsasign.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\jsse.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\jce.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\charsets.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\lib\\jfr.jar;C:\\Program Files\\Java\\jdk1.7.0_80\\jre\\classes", "java.awt.headless": "true", "java.vendor": "Oracle Corporation", "catalina.base": "C:\\Users\\Administrator\\AppData\\Local\\Temp\\tomcat.2042919348800278549.80", "file.separator": "\\", "java.vendor.url.bug": "http://bugreport.sun.com/bugreport/", "sun.io.unicode.encoding": "UnicodeLittle", "sun.cpu.endian": "little", "sun.desktop": "windows", "sun.cpu.isalist": "amd64" &#125;, "systemEnvironment": &#123; "USERPROFILE": "C:\\Users\\Administrator", "ProgramData": "C:\\ProgramData", "PATHEXT": ".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC", "JAVA_HOME": "C:\\Program Files\\Java\\jdk1.8.0_31", "ProgramFiles(x86)": "C:\\Program Files (x86)", "ChocolateyLastPathUpdate": "å‘¨å›› 4æœˆ 26 09:03:47 2018", "TEMP": "C:\\Users\\ADMINI~1\\AppData\\Local\\Temp", "SystemDrive": "C:", "ProgramFiles": "C:\\Program Files", "Path": "C:/Program Files/Java/jre1.8.0_31/bin/server;C:/Program Files/Java/jre1.8.0_31/bin;C:/Program Files/Java/jre1.8.0_31/lib/amd64;f:\\app\\Administrator\\product\\11.2.0\\client_1\\bin;f:\\app\\Administrator\\product\\11.2.0\\dbhome_1\\bin;C:\\ProgramData\\Oracle\\Java\\javapath;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Program Files\\nodejs\\;C:\\Program Files\\Git\\cmd;\"%JAVA_HOME%\\bin;%JAVA_HOME%\\jre\\bin\";%M2_HOME%\\bin;C:\\Program Files\\TortoiseSVN\\bin;C:\\Program Files\\PuTTY\\;C:\\ProgramData\\chocolatey\\bin;C:\\Users\\Administrator\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\Administrator\\AppData\\Roaming\\npm;\"C:\\Program Files\\Java\\jdk1.8.0_31\\bin;C:\\Program Files\\Java\\jdk1.8.0_31\\jre\\bin\";D:\\Program Files\\apache-maven-3.3.9-bin\\apache-maven-3.3.9\\bin;C:\\Program Files\\cmder;;D:\\Program Files\\Oxygen;", "HOMEDRIVE": "C:", "PROCESSOR_REVISION": "4e03", "=C:": "C:\\", "USERDOMAIN": "SC-201802012049", "ALLUSERSPROFILE": "C:\\ProgramData", "ProgramW6432": "C:\\Program Files", "PROCESSOR_IDENTIFIER": "Intel64 Family 6 Model 78 Stepping 3, GenuineIntel", "SESSIONNAME": "Console", "FPS_BROWSER_USER_PROFILE_STRING": "Default", "TMP": "C:\\Users\\ADMINI~1\\AppData\\Local\\Temp", "PROCESSOR_ARCHITECTURE": "AMD64", "CommonProgramFiles": "C:\\Program Files\\Common Files", "CLASSPATH": ".;C:\\Program Files\\Java\\jdk1.8.0_31\\lib;C:\\Program Files\\Java\\jdk1.8.0_31\\lib\\tools.jar", "=::": "::\\", "LOGONSERVER": "\\\\SC-201802012049", "M2_HOME": "D:\\Program Files\\apache-maven-3.3.9-bin\\apache-maven-3.3.9", "OS": "Windows_NT", "HOMEPATH": "\\Users\\Administrator", "PROCESSOR_LEVEL": "6", "FPS_BROWSER_APP_PROFILE_STRING": "Internet Explorer", "CommonProgramW6432": "C:\\Program Files\\Common Files", "USERDOMAIN_ROAMINGPROFILE": "SC-201802012049", "LOCALAPPDATA": "C:\\Users\\Administrator\\AppData\\Local", "COMPUTERNAME": "SC-201802012049", "windir": "C:\\Windows", "SystemRoot": "C:\\Windows", "asl.log": "Destination=file", "NUMBER_OF_PROCESSORS": "4", "USERNAME": "Administrator", "PUBLIC": "C:\\Users\\Public", "PSModulePath": "C:\\Program Files\\WindowsPowerShell\\Modules;C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules", "CommonProgramFiles(x86)": "C:\\Program Files (x86)\\Common Files", "ComSpec": "C:\\Windows\\system32\\cmd.exe", "ChocolateyInstall": "C:\\ProgramData\\chocolatey", "APPDATA": "C:\\Users\\Administrator\\AppData\\Roaming" &#125;, "applicationConfig: [classpath:/application.yml]": &#123; "server.port": 80, "management.security.enabled": false, "management.port": 80, "management.context-path": "/monitor", "endpoints.shutdown.enabled": true &#125;&#125;healthæŸ¥çœ‹æ‰€åœ¨åº”ç”¨çš„å¥åº·çŠ¶æ€ï¼Œ å¦‚ç£ç›˜ã€æ•°æ®æºã€Redis ã€Elasticsearchç­‰ã€‚å¥åº·çŠ¶æ€åˆ†ä¸ºUPï¼ˆæ­£å¸¸ï¼‰å’ŒDOWNï¼ˆæ•…éšœï¼‰çŠ¶æ€ã€‚è®¿é—®http://localhost/monitor/healthï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š123456789&#123; "status": "UP", "diskSpace": &#123; "status": "UP", "total": 107380994048, "free": 63853707264, "threshold": 10485760 &#125;&#125;mappingsè¾“å‡ºæ‰€æœ‰é€šè¿‡æ³¨è§£ï¼ RequestMappingè®¾ç½®çš„URLæ˜ å°„ï¼Œå¯ä»¥é€šè¿‡æ­¤æ¥æŸ¥çœ‹URLå¯¹åº”çš„Controllerã€‚è®¿é—®http://localhost/monitor/mappingsï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495&#123; "/webjars/**": &#123; "bean": "resourceHandlerMapping" &#125;, "/**": &#123; "bean": "resourceHandlerMapping" &#125;, "/**/favicon.ico": &#123; "bean": "faviconHandlerMapping" &#125;, "&#123;[/]&#125;": &#123; "bean": "requestMappingHandlerMapping", "method": "java.lang.String com.springboot.demo.DemoApplication.index()" &#125;, "&#123;[/error]&#125;": &#123; "bean": "requestMappingHandlerMapping", "method": "public org.springframework.http.ResponseEntity&lt;java.util.Map&lt;java.lang.String, java.lang.Object&gt;&gt; org.springframework.boot.autoconfigure.web.BasicErrorController.error(javax.servlet.http.HttpServletRequest)" &#125;, "&#123;[/error],produces=[text/html]&#125;": &#123; "bean": "requestMappingHandlerMapping", "method": "public org.springframework.web.servlet.ModelAndView org.springframework.boot.autoconfigure.web.BasicErrorController.errorHtml(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)" &#125;, "&#123;[/monitor/loggers/&#123;name:.*&#125;],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.LoggersMvcEndpoint.get(java.lang.String)" &#125;, "&#123;[/monitor/loggers/&#123;name:.*&#125;],methods=[POST],consumes=[application/vnd.spring-boot.actuator.v1+json || application/json],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.LoggersMvcEndpoint.set(java.lang.String,java.util.Map&lt;java.lang.String, java.lang.String&gt;)" &#125;, "&#123;[/monitor/loggers || /monitor/loggers.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()" &#125;, "&#123;[/monitor/shutdown || /monitor/shutdown.json],methods=[POST],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.ShutdownMvcEndpoint.invoke()" &#125;, "&#123;[/monitor/trace || /monitor/trace.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()" &#125;, "&#123;[/monitor/heapdump || /monitor/heapdump.json],methods=[GET],produces=[application/octet-stream]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public void org.springframework.boot.actuate.endpoint.mvc.HeapdumpMvcEndpoint.invoke(boolean,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.io.IOException,javax.servlet.ServletException" &#125;, "&#123;[/monitor/autoconfig || /monitor/autoconfig.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()" &#125;, "&#123;[/monitor/beans || /monitor/beans.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()" &#125;, "&#123;[/monitor/mappings || /monitor/mappings.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()" &#125;, "&#123;[/monitor/health || /monitor/health.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.HealthMvcEndpoint.invoke(javax.servlet.http.HttpServletRequest,java.security.Principal)" &#125;, "&#123;[/monitor/metrics/&#123;name:.*&#125;],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.MetricsMvcEndpoint.value(java.lang.String)" &#125;, "&#123;[/monitor/metrics || /monitor/metrics.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()" &#125;, "&#123;[/monitor/dump || /monitor/dump.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()" &#125;, "&#123;[/monitor/env/&#123;name:.*&#125;],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EnvironmentMvcEndpoint.value(java.lang.String)" &#125;, "&#123;[/monitor/env || /monitor/env.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()" &#125;, "&#123;[/monitor/info || /monitor/info.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()" &#125;, "&#123;[/monitor/configprops || /monitor/configprops.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()" &#125;, "&#123;[/monitor/auditevents || /monitor/auditevents.json],methods=[GET],produces=[application/vnd.spring-boot.actuator.v1+json || application/json]&#125;": &#123; "bean": "endpointHandlerMapping", "method": "public org.springframework.http.ResponseEntity&lt;?&gt; org.springframework.boot.actuate.endpoint.mvc.AuditEventsMvcEndpoint.findByPrincipalAndAfterAndType(java.lang.String,java.util.Date,java.lang.String)" &#125;&#125;metricsæ˜¾ç¤ºSpring Bootçš„æ€§èƒ½æŒ‡æ ‡ï¼Œå¦‚å·±æœ‰å†…å­˜ã€æœªå ç”¨å†…å­˜ã€åžƒåœ¾å›žæ”¶æ¬¡æ•°ã€ç±»ä¿¡æ¯ç­‰ã€‚è®¿é—®http://localhost/monitor/metricsï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&#123; "mem": 245361, "mem.free": 76255, "processors": 4, "instance.uptime": 15927377, "uptime": 15932920, "systemload.average": -1.0, "heap.committed": 209408, "heap.init": 122659, "heap.used": 133152, "heap": 1745920, "nonheap.committed": 36480, "nonheap.init": 24000, "nonheap.used": 35953, "nonheap": 133120, "threads.peak": 24, "threads.daemon": 20, "threads.totalStarted": 27, "threads": 22, "classes": 6107, "classes.loaded": 6107, "classes.unloaded": 0, "gc.ps_scavenge.count": 5, "gc.ps_scavenge.time": 73, "gc.ps_marksweep.count": 0, "gc.ps_marksweep.time": 0, "httpsessions.max": -1, "httpsessions.active": 0, "counter.status.200.monitor.autoconfig": 2, "counter.status.200.monitor.beans": 2, "counter.status.200.monitor.configprops": 1, "counter.status.200.monitor.dump": 4, "counter.status.200.monitor.env": 1, "counter.status.200.monitor.health": 1, "counter.status.200.monitor.info": 1, "counter.status.200.monitor.loggers": 1, "counter.status.200.monitor.mappings": 1, "counter.status.200.monitor.trace": 3, "counter.status.200.star-star.favicon.ico": 3, "counter.status.404.star-star": 2, "gauge.response.monitor.autoconfig": 14.0, "gauge.response.monitor.beans": 42.0, "gauge.response.monitor.configprops": 440.0, "gauge.response.monitor.dump": 62.0, "gauge.response.monitor.env": 14.0, "gauge.response.monitor.health": 22.0, "gauge.response.monitor.info": 26.0, "gauge.response.monitor.loggers": 237.0, "gauge.response.monitor.mappings": 7.0, "gauge.response.monitor.trace": 8.0, "gauge.response.star-star": 12.0, "gauge.response.star-star.favicon.ico": 6.0&#125;å¯¹/metricsæŽ¥å£æä¾›çš„ä¿¡æ¯è¿›è¡Œç®€å•åˆ†ç±»å¦‚ä¸‹è¡¨ï¼šåˆ†ç±»å‰ç¼€æŠ¥å‘Šå†…å®¹åžƒåœ¾æ”¶é›†å™¨gc.å·²ç»å‘ç”Ÿè¿‡çš„åžƒåœ¾æ”¶é›†æ¬¡æ•°ï¼Œä»¥åŠåžƒåœ¾æ”¶é›†æ‰€è€—è´¹çš„æ—¶é—´ï¼Œé€‚ç”¨äºŽæ ‡è®°-æ¸…ç†åžƒåœ¾æ”¶é›†å™¨å’Œå¹¶è¡Œåžƒåœ¾æ”¶é›†å™¨(æ•°æ®æºè‡ªjava.lang.management. GarbageCollectorMXBean)å†…å­˜mem.åˆ†é…ç»™åº”ç”¨ç¨‹åºçš„å†…å­˜æ•°é‡å’Œç©ºé—²çš„å†…å­˜æ•°é‡(æ•°æ®æºè‡ªjava.lang. Runtime)å †heap.å½“å‰å†…å­˜ç”¨é‡(æ•°æ®æºè‡ªjava.lang.management.MemoryUsage)ç±»åŠ è½½å™¨classes.JVMç±»åŠ è½½å™¨åŠ è½½ä¸Žå¸è½½çš„ç±»çš„æ•°é‡(æ•°æ®æºè‡ªjava.lang. management.ClassLoadingMXBean)ç³»ç»Ÿprocessorsã€instance.uptimeã€uptimeã€systemload.averageç³»ç»Ÿä¿¡æ¯ï¼Œä¾‹å¦‚å¤„ç†å™¨æ•°é‡(æ•°æ®æºè‡ªjava.lang.Runtime)ã€è¿è¡Œæ—¶é—´(æ•°æ®æºè‡ªjava.lang.management.RuntimeMXBean)ã€å¹³å‡è´Ÿè½½(æ•°æ®æºè‡ªjava.lang.management.OperatingSystemMXBean)çº¿ç¨‹æ± thread.çº¿ç¨‹ã€å®ˆæŠ¤çº¿ç¨‹çš„æ•°é‡ï¼Œä»¥åŠJVMå¯åŠ¨åŽçš„çº¿ç¨‹æ•°é‡å³°å€¼(æ•°æ®æºè‡ª java.lang .management.ThreadMXBean)æ•°æ®æºdatasource.æ•°æ®æºè¿žæŽ¥çš„æ•°é‡(æºè‡ªæ•°æ®æºçš„å…ƒæ•°æ®ï¼Œä»…å½“Springåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡é‡Œå­˜åœ¨ DataSource Bean çš„æ—¶å€™æ‰ä¼šæœ‰è¿™ä¸ªä¿¡æ¯)Tomcat ä¼šè¯httpsessions.*Tomcatçš„æ´»è·ƒä¼šè¯æ•°å’Œæœ€å¤§ä¼šè¯æ•°(æ•°æ®æºè‡ªåµŒå…¥å¼Tomcatçš„Beanï¼Œä»…åœ¨ä½¿ç”¨åµŒå…¥å¼TomcatæœåŠ¡å™¨è¿è¡Œåº”ç”¨ç¨‹åºæ—¶æ‰æœ‰è¿™ä¸ªä¿¡æ¯)HTTPcounter.status.ã€gauge.response.å¤šç§åº”ç”¨ç¨‹åºæœåŠ¡HTTPè¯·æ±‚çš„åº¦é‡å€¼ä¸Žè®¡æ•°å™¨HTTPçš„è®¡æ•°å™¨å’Œåº¦é‡å€¼éœ€è¦åšä¸€ç‚¹è¯´æ˜Žã€‚counter.statusåŽçš„å€¼æ˜¯HTTPçŠ¶æ€ç ï¼ŒéšåŽæ˜¯æ‰€è¯·æ±‚çš„è·¯å¾„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œcounter.status.200.metrics è¡¨æ˜Ž/metricsç«¯ç‚¹è¿”å›ž 200(OK) çŠ¶æ€ç çš„æ¬¡æ•°ã€‚HTTPçš„åº¦é‡ä¿¡æ¯åœ¨ç»“æž„ä¸Šä¹Ÿå·®ä¸å¤šï¼Œå´åœ¨æŠ¥å‘Šå¦ä¸€ç±»ä¿¡æ¯ã€‚å®ƒä»¬å…¨éƒ¨ä»¥gauge.responseå¼€å¤´ï¼Œè¡¨æ˜Žè¿™æ˜¯HTTPå“åº”çš„åº¦é‡ä¿¡æ¯ã€‚å‰ç¼€åŽæ˜¯å¯¹åº”çš„è·¯å¾„ã€‚åº¦é‡å€¼æ˜¯ä»¥æ¯«ç§’ä¸ºå•ä½çš„æ—¶é—´ï¼Œåæ˜ äº†æœ€è¿‘å¤„ç†è¯¥è·¯å¾„è¯·æ±‚çš„è€—æ—¶ã€‚è¿™é‡Œè¿˜æœ‰å‡ ä¸ªç‰¹æ®Šçš„å€¼éœ€è¦æ³¨æ„ã€‚rootè·¯å¾„æŒ‡å‘çš„æ˜¯æ ¹è·¯å¾„æˆ–/ã€‚star-starä»£è¡¨äº†é‚£äº›Springè®¤ä¸ºæ˜¯é™æ€èµ„æºçš„è·¯å¾„ï¼ŒåŒ…æ‹¬å›¾ç‰‡ã€JavaScriptå’Œæ ·å¼è¡¨ï¼Œå…¶ä¸­è¿˜åŒ…å«äº†é‚£äº›æ‰¾ä¸åˆ°çš„èµ„æºã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ ç»å¸¸ä¼šçœ‹åˆ°counter.status.404.star-starï¼Œè¿™æ˜¯è¿”å›žäº†HTTP 404 (NOT FOUND)çŠ¶æ€çš„è¯·æ±‚æ•°ã€‚/metricsæŽ¥å£ä¼šè¿”å›žæ‰€æœ‰çš„å¯ç”¨åº¦é‡å€¼ï¼Œä½†ä½ ä¹Ÿå¯èƒ½åªå¯¹æŸä¸ªå€¼æ„Ÿå…´è¶£ã€‚è¦èŽ·å–å•ä¸ªå€¼ï¼Œè¯·æ±‚æ—¶å¯ä»¥åœ¨URLåŽåŠ ä¸Šå¯¹åº”çš„é”®åã€‚ä¾‹å¦‚ï¼Œè¦æŸ¥çœ‹ç©ºé—²å†…å­˜å¤§å°,å¯ä»¥å‘/metrics/mem.freeå‘ä¸€ä¸ªGETè¯·æ±‚ã€‚å®šåˆ¶Actuatorä¿®æ”¹æŽ¥å£IDæ¯ä¸ªActuatoræŽ¥å£éƒ½æœ‰ä¸€ä¸ªIDç”¨æ¥å†³å®šæŽ¥å£çš„è·¯å¾„ï¼Œæ¯”æ–¹è¯´ï¼Œ/beansæŽ¥å£çš„é»˜è®¤IDå°±æ˜¯beansã€‚æ¯”å¦‚è¦ä¿®æ”¹/beansä¸º /instancesï¼Œåˆ™è®¾ç½®å¦‚ä¸‹ï¼š123endpoints: beans: id: instanceså¯ç”¨å’Œç¦ç”¨æŽ¥å£è™½ç„¶Actuatorçš„æŽ¥å£éƒ½å¾ˆæœ‰ç”¨ï¼Œä½†ä½ ä¸ä¸€å®šéœ€è¦å…¨éƒ¨è¿™äº›æŽ¥å£ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æŽ¥å£ï¼ˆé™¤äº†/shutdownï¼‰éƒ½å¯ç”¨ã€‚æ¯”å¦‚è¦ç¦ç”¨ /metrics æŽ¥å£ï¼Œåˆ™å¯ä»¥è®¾ç½®å¦‚ä¸‹ï¼š123endpoints: metrics: enabled: falseå¦‚æžœä½ åªæƒ³æ‰“å¼€ä¸€ä¸¤ä¸ªæŽ¥å£ï¼Œé‚£å°±å…ˆç¦ç”¨å…¨éƒ¨æŽ¥å£ï¼Œç„¶åŽå¯ç”¨é‚£å‡ ä¸ªä½ è¦çš„ï¼Œè¿™æ ·æ›´æ–¹ä¾¿ã€‚1234endpoints: enabled: false metrics: enabled: trueå‚è€ƒæ–‡ç« ï¼šhttps://www.jianshu.com/p/af9738634a21ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/21.Spring-Boot-Actuatorã€‚]]></content>
      <tags>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootæ•´åˆSwagger2æž„å»ºRESTful API]]></title>
    <url>%2FSpring-Boot-Swagger2-RESTful-API.html</url>
    <content type="text"><![CDATA[Swaggeræ˜¯ä¸€æ¬¾å¯ä»¥å¿«é€Ÿç”Ÿæˆç¬¦åˆRESTfulé£Žæ ¼APIå¹¶è¿›è¡Œåœ¨çº¿è°ƒè¯•çš„æ’ä»¶ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åœ¨Spring Bootä¸­æ•´åˆSwaggerã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆèŠèŠä»€ä¹ˆæ˜¯RESTã€‚RESTå®žé™…ä¸Šä¸ºRepresentational State Transferçš„ç¼©å†™ï¼Œç¿»è¯‘ä¸ºâ€œè¡¨çŽ°å±‚çŠ¶æ€è½¬åŒ–â€ ã€‚å¦‚æžœä¸€ä¸ªæž¶æž„ç¬¦åˆREST åŽŸåˆ™ï¼Œå°±ç§°å®ƒä¸ºRESTfulæž¶æž„ã€‚å®žé™…ä¸Šï¼Œâ€œè¡¨çŽ°å±‚çŠ¶æ€è½¬åŒ–â€çœç•¥äº†ä¸»è¯­ï¼Œå®Œæ•´çš„è¯´åº”è¯¥æ˜¯â€œèµ„æºè¡¨çŽ°å±‚çŠ¶æ€è½¬åŒ–â€ã€‚ä»€ä¹ˆæ˜¯èµ„æºï¼ˆResourceï¼‰ï¼Ÿèµ„æºæŒ‡çš„æ˜¯ç½‘ç»œä¸­ä¿¡æ¯çš„è¡¨çŽ°å½¢å¼ï¼Œæ¯”å¦‚ä¸€æ®µæ–‡æœ¬ï¼Œä¸€é¦–æ­Œï¼Œä¸€ä¸ªè§†é¢‘æ–‡ä»¶ç­‰ç­‰ï¼›ä»€ä¹ˆæ˜¯è¡¨çŽ°å±‚ï¼ˆReresentationalï¼‰ï¼Ÿè¡¨çŽ°å±‚å³èµ„æºçš„å±•çŽ°åœ¨ä½ é¢å‰çš„å½¢å¼ï¼Œæ¯”å¦‚æ–‡æœ¬å¯ä»¥æ˜¯JSONæ ¼å¼çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯XMLå½¢å¼çš„ï¼Œç”šè‡³ä¸ºäºŒè¿›åˆ¶å½¢å¼çš„ã€‚å›¾ç‰‡å¯ä»¥æ˜¯gifï¼Œä¹Ÿå¯ä»¥æ˜¯PNGï¼›ä»€ä¹ˆæ˜¯çŠ¶æ€è½¬æ¢ï¼ˆState Transferï¼‰ï¼Ÿç”¨æˆ·å¯ä½¿ç”¨URLé€šè¿‡HTTPåè®®æ¥èŽ·å–å„ç§èµ„æºï¼ŒHTTPåè®®åŒ…å«äº†ä¸€äº›æ“ä½œèµ„æºçš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼šGET ç”¨æ¥èŽ·å–èµ„æºï¼Œ POST ç”¨æ¥æ–°å»ºèµ„æº , PUT ç”¨æ¥æ›´æ–°èµ„æºï¼Œ DELETE ç”¨æ¥åˆ é™¤èµ„æºï¼Œ PATCH ç”¨æ¥æ›´æ–°èµ„æºçš„éƒ¨åˆ†å±žæ€§ã€‚é€šè¿‡è¿™äº›HTTPåè®®çš„æ–¹æ³•æ¥æ“ä½œèµ„æºçš„è¿‡ç¨‹å³ä¸ºçŠ¶æ€è½¬æ¢ã€‚ä¸‹é¢å¯¹æ¯”ä¸‹ä¼ ç»ŸURLè¯·æ±‚å’ŒRESTfulé£Žæ ¼è¯·æ±‚çš„åŒºåˆ«ï¼šæè¿°ä¼ ç»Ÿè¯·æ±‚æ–¹æ³•RESTfulè¯·æ±‚æ–¹æ³•æŸ¥è¯¢/user/query?name=mrbirdGET/user?name=mrbirdGETè¯¦æƒ…/user/getInfo?id=1GET/user/1GETåˆ›å»º/user/create?name=mrbirdPOST/userPOSTä¿®æ”¹/user/update?name=mrbird&amp;id=1POST/user/1PUTåˆ é™¤/user/delete?id=1GET/user/1DELETEä»Žä¸Šé¢è¿™å¼ è¡¨ï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥æ€»ç»“ä¸‹ä¼ ç»Ÿè¯·æ±‚å’ŒRESTfulè¯·æ±‚çš„å‡ ä¸ªåŒºåˆ«ï¼šä¼ ç»Ÿè¯·æ±‚é€šè¿‡URLæ¥æè¿°è¡Œä¸ºï¼Œå¦‚createï¼Œdeleteç­‰ï¼›RESTfulè¯·æ±‚é€šè¿‡URLæ¥æè¿°èµ„æºã€‚RESTfulè¯·æ±‚é€šè¿‡HTTPè¯·æ±‚çš„æ–¹æ³•æ¥æè¿°è¡Œä¸ºï¼Œæ¯”å¦‚DELETEï¼ŒPOSTï¼ŒPUTç­‰ï¼Œå¹¶ä¸”ä½¿ç”¨HTTPçŠ¶æ€ç æ¥è¡¨ç¤ºä¸åŒçš„ç»“æžœã€‚RESTfulè¯·æ±‚é€šè¿‡JSONæ¥äº¤æ¢æ•°æ®ã€‚RESTfulåªæ˜¯ä¸€ç§é£Žæ ¼ï¼Œå¹¶ä¸æ˜¯ä¸€ç§å¼ºåˆ¶æ€§çš„æ ‡å‡†ã€‚å¼•å…¥Swaggerä¾èµ–æœ¬æ–‡ä½¿ç”¨çš„Swaggerç‰ˆæœ¬ä¸º2.6.1ï¼š12345678910&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;version&gt;2.6.1&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;version&gt;2.6.1&lt;/version&gt;&lt;/dependency&gt;é…ç½®SwaggerConfigä½¿ç”¨JavaConfigçš„å½¢å¼é…ç½®Swaggerï¼š1234567891011121314151617181920212223242526272829303132import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import springfox.documentation.builders.ApiInfoBuilder;import springfox.documentation.builders.PathSelectors;import springfox.documentation.builders.RequestHandlerSelectors;import springfox.documentation.service.ApiInfo;import springfox.documentation.service.Contact;import springfox.documentation.spi.DocumentationType;import springfox.documentation.spring.web.plugins.Docket;import springfox.documentation.swagger2.annotations.EnableSwagger2;@Configuration@EnableSwagger2public class SwaggerConfig &#123; @Bean public Docket buildDocket() &#123; return new Docket(DocumentationType.SWAGGER_2) .apiInfo(buildApiInf()) .select() .apis(RequestHandlerSelectors.basePackage("com.example.demo.controller")) .paths(PathSelectors.any()) .build(); &#125; private ApiInfo buildApiInf() &#123; return new ApiInfoBuilder() .title("ç³»ç»ŸRESTful APIæ–‡æ¡£") .contact(new Contact("mrbird", "https://mrbird.cc", "852252810@qq.com")) .version("1.0") .build(); &#125;&#125;åœ¨é…ç½®ç±»ä¸­æ·»åŠ @EnableSwagger2æ³¨è§£æ¥å¯ç”¨Swagger2ï¼Œapis()å®šä¹‰äº†æ‰«æçš„åŒ…è·¯å¾„ã€‚é…ç½®è¾ƒä¸ºç®€å•ï¼Œå…¶ä»–ä¸åšè¿‡å¤šè¯´æ˜Žã€‚Swaggerå¸¸ç”¨æ³¨è§£@Apiï¼šä¿®é¥°æ•´ä¸ªç±»ï¼Œæè¿°Controllerçš„ä½œç”¨ï¼›@ApiOperationï¼šæè¿°ä¸€ä¸ªç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ–è€…è¯´ä¸€ä¸ªæŽ¥å£ï¼›@ApiParamï¼šå•ä¸ªå‚æ•°æè¿°ï¼›@ApiModelï¼šç”¨å¯¹è±¡æ¥æŽ¥æ”¶å‚æ•°ï¼›@ApiPropertyï¼šç”¨å¯¹è±¡æŽ¥æ”¶å‚æ•°æ—¶ï¼Œæè¿°å¯¹è±¡çš„ä¸€ä¸ªå­—æ®µï¼›@ApiResponseï¼šHTTPå“åº”å…¶ä¸­1ä¸ªæè¿°ï¼›@ApiResponsesï¼šHTTPå“åº”æ•´ä½“æè¿°ï¼›@ApiIgnoreï¼šä½¿ç”¨è¯¥æ³¨è§£å¿½ç•¥è¿™ä¸ªAPIï¼›@ApiError ï¼šå‘ç”Ÿé”™è¯¯è¿”å›žçš„ä¿¡æ¯ï¼›@ApiImplicitParamï¼šä¸€ä¸ªè¯·æ±‚å‚æ•°ï¼›@ApiImplicitParamsï¼šå¤šä¸ªè¯·æ±‚å‚æ•°ã€‚ç¼–å†™RESTful APIæŽ¥å£Spring Bootä¸­åŒ…å«äº†ä¸€äº›æ³¨è§£ï¼Œå¯¹åº”äºŽHTTPåè®®ä¸­çš„æ–¹æ³•ï¼š@GetMappingå¯¹åº”HTTPä¸­çš„GETæ–¹æ³•ï¼›@PostMappingå¯¹åº”HTTPä¸­çš„POSTæ–¹æ³•ï¼›@PutMappingå¯¹åº”HTTPä¸­çš„PUTæ–¹æ³•ï¼›@DeleteMappingå¯¹åº”HTTPä¸­çš„DELETEæ–¹æ³•ï¼›@PatchMappingå¯¹åº”HTTPä¸­çš„PATCHæ–¹æ³•ã€‚æˆ‘ä»¬ä½¿ç”¨è¿™äº›æ³¨è§£æ¥ç¼–å†™ä¸€ä¸ªRESTfulæµ‹è¯•Controllerï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192import java.util.ArrayList;import java.util.HashMap;import java.util.List;import java.util.Map;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.DeleteMapping;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.PutMapping;import org.springframework.web.bind.annotation.RequestBody;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import com.example.demo.domain.User;import io.swagger.annotations.Api;import io.swagger.annotations.ApiImplicitParam;import io.swagger.annotations.ApiImplicitParams;import io.swagger.annotations.ApiOperation;import springfox.documentation.annotations.ApiIgnore;@Api(value = "ç”¨æˆ·Controller")@Controller@RequestMapping("user")public class UserController &#123; @ApiIgnore @GetMapping("hello") public @ResponseBody String hello() &#123; return "hello"; &#125; @ApiOperation(value = "èŽ·å–ç”¨æˆ·ä¿¡æ¯", notes = "æ ¹æ®ç”¨æˆ·idèŽ·å–ç”¨æˆ·ä¿¡æ¯") @ApiImplicitParam(name = "id", value = "ç”¨æˆ·id", required = true, dataType = "Long", paramType = "path") @GetMapping("/&#123;id&#125;") public @ResponseBody User getUserById(@PathVariable(value = "id") Long id) &#123; User user = new User(); user.setId(id); user.setName("mrbird"); user.setAge(25); return user; &#125; @ApiOperation(value = "èŽ·å–ç”¨æˆ·åˆ—è¡¨", notes = "èŽ·å–ç”¨æˆ·åˆ—è¡¨") @GetMapping("/list") public @ResponseBody List&lt;User&gt; getUserList() &#123; List&lt;User&gt; list = new ArrayList&lt;&gt;(); User user1 = new User(); user1.setId(1l); user1.setName("mrbird"); user1.setAge(25); list.add(user1); User user2 = new User(); user2.setId(2l); user2.setName("scott"); user2.setAge(29); list.add(user2); return list; &#125; @ApiOperation(value = "æ–°å¢žç”¨æˆ·", notes = "æ ¹æ®ç”¨æˆ·å®žä½“åˆ›å»ºç”¨æˆ·") @ApiImplicitParam(name = "user", value = "ç”¨æˆ·å®žä½“", required = true, dataType = "User") @PostMapping("/add") public @ResponseBody Map&lt;String, Object&gt; addUser(@RequestBody User user) &#123; Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put("result", "success"); return map; &#125; @ApiOperation(value = "åˆ é™¤ç”¨æˆ·", notes = "æ ¹æ®ç”¨æˆ·idåˆ é™¤ç”¨æˆ·") @ApiImplicitParam(name = "id", value = "ç”¨æˆ·id", required = true, dataType = "Long", paramType = "path") @DeleteMapping("/&#123;id&#125;") public @ResponseBody Map&lt;String, Object&gt; deleteUser(@PathVariable(value = "id") Long id) &#123; Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put("result", "success"); return map; &#125; @ApiOperation(value = "æ›´æ–°ç”¨æˆ·", notes = "æ ¹æ®ç”¨æˆ·idæ›´æ–°ç”¨æˆ·") @ApiImplicitParams(&#123; @ApiImplicitParam(name = "id", value = "ç”¨æˆ·id", required = true, dataType = "Long", paramType = "path"), @ApiImplicitParam(name = "user", value = "ç”¨æˆ·å®žä½“", required = true, dataType = "User") &#125;) @PutMapping("/&#123;id&#125;") public @ResponseBody Map&lt;String, Object&gt; updateUser(@PathVariable(value = "id") Long id, @RequestBody User user) &#123; Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); map.put("result", "success"); return map; &#125;&#125;å¯¹äºŽä¸éœ€è¦ç”ŸæˆAPIçš„æ–¹æ³•æˆ–è€…ç±»ï¼Œåªéœ€è¦åœ¨ä¸Šé¢æ·»åŠ @ApiIgnoreæ³¨è§£å³å¯ã€‚å¯åŠ¨&amp;æµ‹è¯•å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/swagger-ui.htmlå³å¯çœ‹åˆ°Swaggerç»™æˆ‘ä»¬ç”Ÿæˆçš„APIé¡µé¢ï¼šç‚¹å‡»æŽ¥å£ä¸‹çš„â€œTry it outâ€Swaggerä¼šç”¨curlå‘½ä»¤å‘é€è¯·æ±‚ï¼Œå¹¶ä¸”è¿”å›žå“åº”ä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤º:æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/20.Spring-Boot-Swagger2]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>Swagger</tag>
        <tag>RESTful</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootä¸­ç¼–å†™å•å…ƒæµ‹è¯•]]></title>
    <url>%2FSpring-Boot%20TESTing.html</url>
    <content type="text"><![CDATA[ç¼–å†™å•å…ƒæµ‹è¯•å¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜ç¼–å†™é«˜è´¨é‡çš„ä»£ç ï¼Œæå‡ä»£ç è´¨é‡ï¼Œå‡å°‘Bugï¼Œä¾¿äºŽé‡æž„ã€‚Spring Bootæä¾›äº†ä¸€äº›å®žç”¨ç¨‹åºå’Œæ³¨è§£ï¼Œç”¨æ¥å¸®åŠ©æˆ‘ä»¬æµ‹è¯•åº”ç”¨ç¨‹åºï¼Œåœ¨Spring Bootä¸­å¼€å¯å•å…ƒæµ‹è¯•åªéœ€å¼•å…¥spring-boot-starter-testå³å¯ï¼Œå…¶åŒ…å«äº†ä¸€äº›ä¸»æµçš„æµ‹è¯•åº“ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»åŸºäºŽ Serviceå’ŒControllerçš„å•å…ƒæµ‹è¯•ã€‚å¼•å…¥spring-boot-starter-testï¼š12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt;&lt;/dependency&gt;è¿è¡ŒMavenå‘½ä»¤dependency:treeå¯çœ‹åˆ°å…¶åŒ…å«äº†ä»¥ä¸‹ä¾èµ–ï¼š123456789101112131415161718[INFO] +- org.springframework.boot:spring-boot-starter-test:jar:1.5.9.RELEASE:test[INFO] | +- org.springframework.boot:spring-boot-test:jar:1.5.9.RELEASE:test[INFO] | +- org.springframework.boot:spring-boot-test-autoconfigure:jar:1.5.9.RELEASE:test[INFO] | +- com.jayway.jsonpath:json-path:jar:2.2.0:test[INFO] | | +- net.minidev:json-smart:jar:2.2.1:test[INFO] | | | \- net.minidev:accessors-smart:jar:1.1:test[INFO] | | | \- org.ow2.asm:asm:jar:5.0.3:test[INFO] | | \- org.slf4j:slf4j-api:jar:1.7.25:compile[INFO] | +- junit:junit:jar:4.12:test[INFO] | +- org.assertj:assertj-core:jar:2.6.0:test[INFO] | +- org.mockito:mockito-core:jar:1.10.19:test[INFO] | | \- org.objenesis:objenesis:jar:2.1:test[INFO] | +- org.hamcrest:hamcrest-core:jar:1.3:test[INFO] | +- org.hamcrest:hamcrest-library:jar:1.3:test[INFO] | +- org.skyscreamer:jsonassert:jar:1.4.0:test[INFO] | | \- com.vaadin.external.google:android-json:jar:0.0.20131108.vaadin1:test[INFO] | +- org.springframework:spring-core:jar:4.3.13.RELEASE:compile[INFO] | \- org.springframework:spring-test:jar:4.3.13.RELEASE:testJUnitï¼Œæ ‡å‡†çš„å•å…ƒæµ‹è¯•Javaåº”ç”¨ç¨‹åºï¼›Spring Test &amp; Spring Boot Testï¼Œå¯¹Spring Bootåº”ç”¨ç¨‹åºçš„å•å…ƒæµ‹è¯•æä¾›æ”¯æŒï¼›Mockito, Java mockingæ¡†æž¶ï¼Œç”¨äºŽæ¨¡æ‹Ÿä»»ä½•Springç®¡ç†çš„Beanï¼Œæ¯”å¦‚åœ¨å•å…ƒæµ‹è¯•ä¸­æ¨¡æ‹Ÿä¸€ä¸ªç¬¬ä¸‰æ–¹ç³»ç»ŸServiceæŽ¥å£è¿”å›žçš„æ•°æ®ï¼Œè€Œä¸ä¼šåŽ»çœŸæ­£è°ƒç”¨ç¬¬ä¸‰æ–¹ç³»ç»Ÿï¼›AssertJï¼Œä¸€ä¸ªæµç•…çš„assertionåº“ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†æ›´å¤šçš„æœŸæœ›å€¼ä¸Žæµ‹è¯•è¿”å›žå€¼çš„æ¯”è¾ƒæ–¹å¼ï¼›Hamcrestï¼Œåº“çš„åŒ¹é…å¯¹è±¡ï¼ˆä¹Ÿç§°ä¸ºçº¦æŸæˆ–è°“è¯ï¼‰ï¼›JsonPathï¼Œæä¾›ç±»ä¼¼XPathé‚£æ ·çš„ç¬¦å·æ¥èŽ·å–JSONæ•°æ®ç‰‡æ®µï¼›JSONassertï¼Œå¯¹JSONå¯¹è±¡æˆ–è€…JSONå­—ç¬¦ä¸²æ–­è¨€çš„åº“ã€‚ä¸€ä¸ªæ ‡å‡†çš„Spring Bootæµ‹è¯•å•å…ƒåº”æœ‰å¦‚ä¸‹çš„ä»£ç ç»“æž„ï¼š123456789import org.junit.runner.RunWith;import org.springframework.boot.test.context.SpringBootTest;import org.springframework.test.context.junit4.SpringRunner;@RunWith(SpringRunner.class)@SpringBootTestpublic class ApplicationTest &#123; &#125;çŸ¥è¯†å‡†å¤‡JUnit4æ³¨è§£JUnit4ä¸­åŒ…å«äº†å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„æ³¨è§£ï¼š@BeforeClassã€@AfterClassã€@Beforeã€@Afterå’Œ@Testã€‚å…¶ä¸­ï¼Œ @BeforeClasså’Œ@AfterClassåœ¨æ¯ä¸ªç±»åŠ è½½çš„å¼€å§‹å’Œç»“æŸæ—¶è¿è¡Œï¼Œå¿…é¡»ä¸ºé™æ€æ–¹æ³•ï¼›è€Œ@Beforeå’Œ@Afteråˆ™åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•å¼€å§‹ä¹‹å‰å’Œç»“æŸä¹‹åŽè¿è¡Œã€‚è§å¦‚ä¸‹ä¾‹å­ï¼š123456789101112131415161718192021222324252627282930313233343536@RunWith(SpringRunner.class)@SpringBootTestpublic class TestApplicationTests &#123; @BeforeClass public static void beforeClassTest() &#123; System.out.println("before class test"); &#125; @Before public void beforeTest() &#123; System.out.println("before test"); &#125; @Test public void Test1() &#123; System.out.println("test 1+1=2"); Assert.assertEquals(2, 1 + 1); &#125; @Test public void Test2() &#123; System.out.println("test 2+2=4"); Assert.assertEquals(4, 2 + 2); &#125; @After public void afterTest() &#123; System.out.println("after test"); &#125; @AfterClass public static void afterClassTest() &#123; System.out.println("after class test"); &#125;&#125;è¿è¡Œè¾“å‡ºå¦‚ä¸‹ï¼š12345678910...before class testbefore testtest 1+1=2after testbefore testtest 2+2=4after testafter class test...ä»Žä¸Šé¢çš„è¾“å‡ºå¯ä»¥çœ‹å‡ºå„ä¸ªæ³¨è§£çš„è¿è¡Œæ—¶æœºã€‚Assertä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Assertç±»æä¾›çš„assertå£æ–¹æ³•ï¼Œä¸‹é¢åˆ—å‡ºäº†ä¸€äº›å¸¸ç”¨çš„assertæ–¹æ³•ï¼šassertEquals(&quot;message&quot;,A,B)ï¼Œåˆ¤æ–­Aå¯¹è±¡å’ŒBå¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œè¿™ä¸ªåˆ¤æ–­åœ¨æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ—¶è°ƒç”¨äº†equals()æ–¹æ³•ã€‚assertSame(&quot;message&quot;,A,B)ï¼Œåˆ¤æ–­Aå¯¹è±¡ä¸ŽBå¯¹è±¡æ˜¯å¦ç›¸åŒï¼Œä½¿ç”¨çš„æ˜¯==æ“ä½œç¬¦ã€‚assertTrue(&quot;message&quot;,A)ï¼Œåˆ¤æ–­Aæ¡ä»¶æ˜¯å¦ä¸ºçœŸã€‚assertFalse(&quot;message&quot;,A)ï¼Œåˆ¤æ–­Aæ¡ä»¶æ˜¯å¦ä¸ä¸ºçœŸã€‚assertNotNull(&quot;message&quot;,A)ï¼Œåˆ¤æ–­Aå¯¹è±¡æ˜¯å¦ä¸ä¸ºnullã€‚assertArrayEquals(&quot;message&quot;,A,B)ï¼Œåˆ¤æ–­Aæ•°ç»„ä¸ŽBæ•°ç»„æ˜¯å¦ç›¸ç­‰ã€‚MockMvcä¸‹æ–‡ä¸­ï¼Œå¯¹Controllerçš„æµ‹è¯•éœ€è¦ç”¨åˆ°MockMvcæŠ€æœ¯ã€‚MockMvcï¼Œä»Žå­—é¢ä¸Šæ¥çœ‹æŒ‡çš„æ˜¯æ¨¡æ‹Ÿçš„MVCï¼Œå³å…¶å¯ä»¥æ¨¡æ‹Ÿä¸€ä¸ªMVCçŽ¯å¢ƒï¼Œå‘Controllerå‘é€è¯·æ±‚ç„¶åŽå¾—åˆ°å“åº”ã€‚åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œä½¿ç”¨MockMvcå‰éœ€è¦è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š123456789private MockMvc mockMvc;@Autowiredprivate WebApplicationContext wac;@Beforepublic void setupMockMvc()&#123; mockMvc = MockMvcBuilders.webAppContextSetup(wac).build();&#125;MockMvcæ¨¡æ‹ŸMVCè¯·æ±‚æ¨¡æ‹Ÿä¸€ä¸ªgetè¯·æ±‚ï¼š1mockMvc.perform(MockMvcRequestBuilders.get("/hello?name=&#123;name&#125;","mrbird"));æ¨¡æ‹Ÿä¸€ä¸ªpostè¯·æ±‚ï¼š1mockMvc.perform(MockMvcRequestBuilders.post("/user/&#123;id&#125;", 1));æ¨¡æ‹Ÿæ–‡ä»¶ä¸Šä¼ ï¼š1mockMvc.perform(MockMvcRequestBuilders.fileUpload("/fileupload").file("file", "æ–‡ä»¶å†…å®¹".getBytes("utf-8")));æ¨¡æ‹Ÿè¯·æ±‚å‚æ•°ï¼š1234// æ¨¡æ‹Ÿå‘é€ä¸€ä¸ªmessageå‚æ•°ï¼Œå€¼ä¸ºhellomockMvc.perform(MockMvcRequestBuilders.get("/hello").param("message", "hello"));// æ¨¡æ‹Ÿæäº¤ä¸€ä¸ªcheckboxå€¼ï¼Œnameä¸ºhobbyï¼Œå€¼ä¸ºsleepå’ŒeatmockMvc.perform(MockMvcRequestBuilders.get("/saveHobby").param("hobby", "sleep", "eat"));ä¹Ÿå¯ä»¥ç›´æŽ¥ä½¿ç”¨MultiValueMapæž„å»ºå‚æ•°ï¼š12345MultiValueMap&lt;String, String&gt; params = new LinkedMultiValueMap&lt;String, String&gt;();params.add("name", "mrbird");params.add("hobby", "sleep");params.add("hobby", "eat");mockMvc.perform(MockMvcRequestBuilders.get("/hobby/save").params(params));æ¨¡æ‹Ÿå‘é€JSONå‚æ•°ï¼š12String jsonStr = "&#123;\"username\":\"Dopa\",\"passwd\":\"ac3af72d9f95161a502fd326865c2f15\",\"status\":\"1\"&#125;";mockMvc.perform(MockMvcRequestBuilders.post("/user/save").content(jsonStr.getBytes()));å®žé™…æµ‹è¯•ä¸­ï¼Œè¦æ‰‹åŠ¨ç¼–å†™è¿™ä¹ˆé•¿çš„JSONæ ¼å¼å­—ç¬¦ä¸²å¾ˆç¹çä¹Ÿå¾ˆå®¹æ˜“å‡ºé”™ï¼Œå¯ä»¥å€ŸåŠ©Spring Bootè‡ªå¸¦çš„JacksonæŠ€æœ¯æ¥åºåˆ—åŒ–ä¸€ä¸ªJavaå¯¹è±¡ï¼ˆå¯å‚è€ƒSpring Bootä¸­çš„JSONæŠ€æœ¯ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š1234567User user = new User();user.setUsername("Dopa");user.setPasswd("ac3af72d9f95161a502fd326865c2f15");user.setStatus("1");String userJson = mapper.writeValueAsString(user);mockMvc.perform(MockMvcRequestBuilders.post("/user/save").content(userJson.getBytes()));å…¶ä¸­ï¼Œmapperä¸ºcom.fasterxml.jackson.databind.ObjectMapperå¯¹è±¡ã€‚æ¨¡æ‹ŸSessionå’ŒCookieï¼š12mockMvc.perform(MockMvcRequestBuilders.get("/index").sessionAttr(name, value));mockMvc.perform(MockMvcRequestBuilders.get("/index").cookie(new Cookie(name, value)));è®¾ç½®è¯·æ±‚çš„Content-Typeï¼š1mockMvc.perform(MockMvcRequestBuilders.get("/index").contentType(MediaType.APPLICATION_JSON_UTF8));è®¾ç½®è¿”å›žæ ¼å¼ä¸ºJSONï¼š1mockMvc.perform(MockMvcRequestBuilders.get("/user/&#123;id&#125;", 1).accept(MediaType.APPLICATION_JSON));æ¨¡æ‹ŸHTTPè¯·æ±‚å¤´ï¼š1mockMvc.perform(MockMvcRequestBuilders.get("/user/&#123;id&#125;", 1).header(name, values));MockMvcå¤„ç†è¿”å›žç»“æžœæœŸæœ›æˆåŠŸè°ƒç”¨ï¼Œå³HTTP Statusä¸º200ï¼š12mockMvc.perform(MockMvcRequestBuilders.get("/user/&#123;id&#125;", 1)) .andExpect(MockMvcResultMatchers.status().isOk());æœŸæœ›è¿”å›žå†…å®¹æ˜¯application/jsonï¼š12mockMvc.perform(MockMvcRequestBuilders.get("/user/&#123;id&#125;", 1)) .andExpect(MockMvcResultMatchers.content().contentType(MediaType.APPLICATION_JSON));æ£€æŸ¥è¿”å›žJSONæ•°æ®ä¸­æŸä¸ªå€¼çš„å†…å®¹ï¼š12mockMvc.perform(MockMvcRequestBuilders.get("/user/&#123;id&#125;", 1)) .andExpect(MockMvcResultMatchers.jsonPath("$.username").value("mrbird"));è¿™é‡Œä½¿ç”¨åˆ°äº†jsonPathï¼Œ$ä»£è¡¨äº†JSONçš„æ ¹èŠ‚ç‚¹ã€‚æ›´å¤šå…³äºŽjsonPathçš„ä»‹ç»å¯å‚è€ƒ https://github.com/json-path/JsonPathã€‚åˆ¤æ–­Controlleræ–¹æ³•æ˜¯å¦è¿”å›žæŸè§†å›¾ï¼š12mockMvc.perform(MockMvcRequestBuilders.post("/index")) .andExpect(MockMvcResultMatchers.view().name("index.html"));æ¯”è¾ƒModelï¼š1234mockMvc.perform(MockMvcRequestBuilders.get("/user/&#123;id&#125;", 1)) .andExpect(MockMvcResultMatchers.model().size(1)) .andExpect(MockMvcResultMatchers.model().attributeExists("password")) .andExpect(MockMvcResultMatchers.model().attribute("username", "mrbird"));æ¯”è¾ƒforwardæˆ–è€…redirectï¼š12345mockMvc.perform(MockMvcRequestBuilders.get("/index")) .andExpect(MockMvcResultMatchers.forwardedUrl("index.html"));// æˆ–è€…mockMvc.perform(MockMvcRequestBuilders.get("/index")) .andExpect(MockMvcResultMatchers.redirectedUrl("index.html"));æ¯”è¾ƒè¿”å›žå†…å®¹ï¼Œä½¿ç”¨content()ï¼š1234567891011// è¿”å›žå†…å®¹ä¸ºhellomockMvc.perform(MockMvcRequestBuilders.get("/index")) .andExpect(MockMvcResultMatchers.content().string("hello"));// è¿”å›žå†…å®¹æ˜¯XMLï¼Œå¹¶ä¸”ä¸ŽxmlCotentä¸€æ ·mockMvc.perform(MockMvcRequestBuilders.get("/index")) .andExpect(MockMvcResultMatchers.content().xml(xmlContent));// è¿”å›žå†…å®¹æ˜¯JSON ï¼Œå¹¶ä¸”ä¸ŽjsonContentä¸€æ ·mockMvc.perform(MockMvcRequestBuilders.get("/index")) .andExpect(MockMvcResultMatchers.content().json(jsonContent));è¾“å‡ºå“åº”ç»“æžœï¼š12mockMvc.perform(MockMvcRequestBuilders.get("/index")) .andDo(MockMvcResultHandlers.print());æµ‹è¯•ServiceçŽ°æœ‰å¦‚ä¸‹Serviceï¼š1234567891011121314@Repository("userService")public class UserServiceImpl extends BaseService&lt;User&gt; implements UserService &#123; @Override public User findByName(String userName) &#123; Example example = new Example(User.class); example.createCriteria().andCondition("username=", userName); List&lt;User&gt; userList = this.selectByExample(example); if (userList.size() != 0) return userList.get(0); else return null; &#125;&#125;ç¼–å†™ä¸€ä¸ªè¯¥Serviceçš„å•å…ƒæµ‹è¯•ï¼Œæµ‹è¯•findByNameæ–¹æ³•æ˜¯å¦æœ‰æ•ˆï¼š12345678910111213@RunWith(SpringRunner.class)@SpringBootTestpublic class UserServiceTest &#123; @Autowired UserService userService; @Test public void test() &#123; User user = this.userService.findByName("scott"); Assert.assertEquals("ç”¨æˆ·åä¸ºscott", "scott", user.getUsername()); &#125;&#125;è¿è¡ŒåŽï¼ŒJUnitæ²¡æœ‰æŠ¥é”™è¯´æ˜Žæµ‹è¯•é€šè¿‡ï¼Œå³UserServiceçš„findByNameæ–¹æ³•å¯è¡Œã€‚ æ­¤å¤–ï¼Œå’Œåœ¨Controllerä¸­å¼•ç”¨Serviceç›¸æ¯”ï¼Œåœ¨æµ‹è¯•å•å…ƒä¸­å¯¹Serviceæµ‹è¯•å®Œæ¯•åŽï¼Œæ•°æ®èƒ½è‡ªåŠ¨å›žæ»šï¼Œåªéœ€è¦åœ¨æµ‹è¯•æ–¹æ³•ä¸ŠåŠ ä¸Š@Transactionalæ³¨è§£ï¼Œæ¯”å¦‚:1234567891011@Test@Transactionalpublic void test() &#123; User user = new User(); user.setId(this.userService.getSequence("seq_user")); user.setUsername("JUnit"); user.setPasswd("123456"); user.setStatus("1"); user.setCreateTime(new Date()); this.userService.save(user);&#125;è¿è¡Œï¼Œæµ‹è¯•é€šè¿‡ï¼ŒæŸ¥çœ‹æ•°æ®åº“å‘çŽ°æ•°æ®å¹¶æ²¡æœ‰è¢«æ’å…¥ï¼Œè¿™æ ·å¾ˆå¥½çš„é¿å…äº†ä¸å¿…è¦çš„æ•°æ®æ±¡æŸ“ã€‚æµ‹è¯•ControllerçŽ°æœ‰å¦‚ä¸‹Controllerï¼š123456789101112131415@RestControllerpublic class UserController &#123; @Autowired UserService userService; @GetMapping("user/&#123;userName&#125;") public User getUserByName(@PathVariable(value = "userName") String userName) &#123; return this.userService.findByName(userName); &#125; @PostMapping("user/save") public void saveUser(@RequestBody User user) &#123; this.userService.saveUser(user); &#125;&#125;çŽ°åœ¨ç¼–å†™ä¸€ä¸ªé’ˆå¯¹äºŽè¯¥ControllergetUserByName(@PathVariable(value = &quot;userName&quot;) String userName)æ–¹æ³•çš„æµ‹è¯•ç±»ï¼š123456789101112131415161718192021222324@RunWith(SpringRunner.class)@SpringBootTestpublic class UserControllerTest &#123; private MockMvc mockMvc; @Autowired private WebApplicationContext wac; @Before public void setupMockMvc()&#123; mockMvc = MockMvcBuilders.webAppContextSetup(wac).build(); &#125; @Test public void test() throws Exception &#123; mockMvc.perform( MockMvcRequestBuilders.get("/user/&#123;userName&#125;", "scott") .contentType(MediaType.APPLICATION_JSON_UTF8)) .andExpect(MockMvcResultMatchers.status().isOk()) .andExpect(MockMvcResultMatchers.jsonPath("$.username").value("scott")) .andDo(MockMvcResultHandlers.print()); &#125;&#125;è¿è¡ŒåŽï¼ŒJUnité€šè¿‡ï¼ŒæŽ§åˆ¶å°è¾“å‡ºè¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334MockHttpServletRequest: HTTP Method = GET Request URI = /user/scott Parameters = &#123;&#125; Headers = &#123;Content-Type=[application/json;charset=UTF-8]&#125;Handler: Type = demo.springboot.test.controller.UserController Method = public demo.springboot.test.domain.User demo.springboot.test.controller.UserController.getUserByName(java.lang.String)Async: Async started = false Async result = nullResolved Exception: Type = nullModelAndView: View name = null View = null Model = nullFlashMap: Attributes = nullMockHttpServletResponse: Status = 200 Error message = null Headers = &#123;Content-Type=[application/json;charset=UTF-8]&#125; Content type = application/json;charset=UTF-8 Body = &#123;&quot;id&quot;:23,&quot;username&quot;:&quot;scott&quot;,&quot;passwd&quot;:&quot;ac3af72d9f95161a502fd326865c2f15&quot;,&quot;createTime&quot;:1514535399000,&quot;status&quot;:&quot;1&quot;&#125; Forwarded URL = null Redirected URL = null Cookies = []ç»§ç»­ç¼–å†™ä¸€ä¸ªé’ˆå¯¹äºŽè¯¥ControllersaveUser(@RequestBody User user)æ–¹æ³•çš„æµ‹è¯•ç±»ï¼š1234567891011121314151617181920212223242526272829303132333435@RunWith(SpringRunner.class)@SpringBootTestpublic class UserControllerTest &#123; private MockMvc mockMvc; @Autowired private WebApplicationContext wac; @Autowired ObjectMapper mapper; @Before public void setupMockMvc()&#123; mockMvc = MockMvcBuilders.webAppContextSetup(wac).build(); &#125; @Test @Transactional public void test() throws Exception &#123; User user = new User(); user.setUsername("Dopa"); user.setPasswd("ac3af72d9f95161a502fd326865c2f15"); user.setStatus("1"); String userJson = mapper.writeValueAsString(user); mockMvc.perform( MockMvcRequestBuilders.post("/user/save") .contentType(MediaType.APPLICATION_JSON_UTF8) .content(userJson.getBytes())) .andExpect(MockMvcResultMatchers.status().isOk()) .andDo(MockMvcResultHandlers.print()); &#125;&#125;è¿è¡Œè¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334MockHttpServletRequest: HTTP Method = POST Request URI = /user/save Parameters = &#123;&#125; Headers = &#123;Content-Type=[application/json;charset=UTF-8]&#125;Handler: Type = demo.springboot.test.controller.UserController Method = public void demo.springboot.test.controller.UserController.saveUser(demo.springboot.test.domain.User)Async: Async started = false Async result = nullResolved Exception: Type = nullModelAndView: View name = null View = null Model = nullFlashMap: Attributes = nullMockHttpServletResponse: Status = 200 Error message = null Headers = &#123;&#125; Content type = null Body = Forwarded URL = null Redirected URL = null Cookies = []å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿä¸­ç¼–å†™æµ‹è¯•å•å…ƒæ—¶ï¼Œå¯èƒ½éœ€è¦æ¨¡æ‹Ÿä¸€ä¸ªç™»å½•ç”¨æˆ·ä¿¡æ¯Sessionï¼ŒMockMvcä¹Ÿæä¾›äº†è§£å†³æ–¹æ¡ˆï¼Œå¯åœ¨åˆå§‹åŒ–çš„æ—¶å€™æ¨¡æ‹Ÿä¸€ä¸ªHttpSessionï¼š123456789101112131415private MockMvc mockMvc;private MockHttpSession session;@Autowiredprivate WebApplicationContext wac;@Beforepublic void setupMockMvc()&#123; mockMvc = MockMvcBuilders.webAppContextSetup(wac).build(); session = new MockHttpSession(); User user =new User(); user.setUsername("Dopa"); user.setPasswd("ac3af72d9f95161a502fd326865c2f15"); session.setAttribute("user", user); &#125;æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/19.Spring-Boot-Testing]]></content>
      <tags>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootä¸­çš„JSONæŠ€æœ¯]]></title>
    <url>%2FSpring-Boot%20JSON.html</url>
    <content type="text"><![CDATA[å¹³æ—¥é‡Œåœ¨é¡¹ç›®ä¸­å¤„ç†JSONä¸€èˆ¬ç”¨çš„éƒ½æ˜¯é˜¿é‡Œå·´å·´çš„Fastjsonï¼ŒåŽæ¥å‘çŽ°ä½¿ç”¨Spring Bootå†…ç½®çš„Jacksonæ¥å®ŒæˆJSONçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œä¹ŸæŒºæ–¹ä¾¿ã€‚Jacksonä¸ä½†å¯ä»¥å®Œæˆç®€å•çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œï¼Œä¹Ÿèƒ½å®žçŽ°å¤æ‚çš„ä¸ªæ€§åŒ–çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œã€‚è‡ªå®šä¹‰ObjectMapperæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨Springä¸­ä½¿ç”¨@ResponseBodyæ³¨è§£å¯ä»¥å°†æ–¹æ³•è¿”å›žçš„å¯¹è±¡åºåˆ—åŒ–æˆJSONï¼Œæ¯”å¦‚ï¼š12345678@RequestMapping("getuser")@ResponseBodypublic User getUser() &#123; User user = new User(); user.setUserName("mrbird"); user.setBirthday(new Date()); return user;&#125;Userç±»ï¼š123456789public class User implements Serializable &#123; private static final long serialVersionUID = 6222176558369919436L; private String userName; private int age; private String password; private Date birthday; ...&#125;è®¿é—®getuseré¡µé¢è¾“å‡ºï¼š1&#123;"userName":"mrbird","age":0,"password":null,"birthday":1522634892365&#125;å¯çœ‹åˆ°æ—¶é—´é»˜è®¤ä»¥æ—¶é—´æˆ³çš„å½¢å¼è¾“å‡ºï¼Œå¦‚æžœæƒ³è¦æ”¹å˜è¿™ä¸ªé»˜è®¤è¡Œä¸ºï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªObjectMapperæ¥æ›¿ä»£ï¼š12345678910111213141516import java.text.SimpleDateFormat;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import com.fasterxml.jackson.databind.ObjectMapper;@Configurationpublic class JacksonConfig &#123; @Bean public ObjectMapper getObjectMapper()&#123; ObjectMapper mapper = new ObjectMapper(); mapper.setDateFormat(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss")); return mapper; &#125;&#125;ä¸Šé¢é…ç½®èŽ·å–äº†ObjectMapperå¯¹è±¡ï¼Œå¹¶ä¸”è®¾ç½®äº†æ—¶é—´æ ¼å¼ã€‚å†æ¬¡è®¿é—®getuserï¼Œé¡µé¢è¾“å‡ºï¼š1&#123;"userName":"mrbird","age":0,"password":null,"birthday":"2018-04-02 10:14:24"&#125;åºåˆ—åŒ–Jacksoné€šè¿‡ä½¿ç”¨mapperçš„writeValueAsStringæ–¹æ³•å°†Javaå¯¹è±¡åºåˆ—åŒ–ä¸ºJSONæ ¼å¼å­—ç¬¦ä¸²ï¼š1234567891011121314151617@AutowiredObjectMapper mapper;@RequestMapping("serialization")@ResponseBodypublic String serialization() &#123; try &#123; User user = new User(); user.setUserName("mrbird"); user.setBirthday(new Date()); String str = mapper.writeValueAsString(user); return str; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return null;&#125;ååºåˆ—åŒ–ä½¿ç”¨@ResponseBodyæ³¨è§£å¯ä»¥ä½¿å¯¹è±¡åºåˆ—åŒ–ä¸ºJSONæ ¼å¼å­—ç¬¦ä¸²ï¼Œé™¤æ­¤ä¹‹å¤–ï¼ŒJacksonä¹Ÿæä¾›äº†ååºåˆ—åŒ–æ–¹æ³•ã€‚æ ‘éåŽ†å½“é‡‡ç”¨æ ‘éåŽ†çš„æ–¹å¼æ—¶ï¼ŒJSONè¢«è¯»å…¥åˆ°JsonNodeå¯¹è±¡ä¸­ï¼Œå¯ä»¥åƒæ“ä½œXML DOMé‚£æ ·è¯»å–JSONã€‚æ¯”å¦‚ï¼š1234567891011121314151617@AutowiredObjectMapper mapper;@RequestMapping("readjsonstring")@ResponseBodypublic String readJsonString() &#123; try &#123; String json = "&#123;\"name\":\"mrbird\",\"age\":26&#125;"; JsonNode node = this.mapper.readTree(json); String name = node.get("name").asText(); int age = node.get("age").asInt(); return name + " " + age; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return null;&#125;readTreeæ–¹æ³•å¯ä»¥æŽ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…å­—èŠ‚æ•°ç»„ã€æ–‡ä»¶ã€InputStreamç­‰ï¼Œ è¿”å›žJsonNodeä½œä¸ºæ ¹èŠ‚ç‚¹ï¼Œä½ å¯ä»¥åƒæ“ä½œXML DOMé‚£æ ·æ“ä½œéåŽ†JsonNodeä»¥èŽ·å–æ•°æ®ã€‚è§£æžå¤šçº§JSONä¾‹å­ï¼š1234String json = "&#123;\"name\":\"mrbird\",\"hobby\":&#123;\"first\":\"sleep\",\"second\":\"eat\"&#125;&#125;";;JsonNode node = this.mapper.readTree(json);JsonNode hobby = node.get("hobby");String first = hobby.get("first").asText();ç»‘å®šå¯¹è±¡æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†Javaå¯¹è±¡å’ŒJSONæ•°æ®è¿›è¡Œç»‘å®šï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314151617@AutowiredObjectMapper mapper;@RequestMapping("readjsonasobject")@ResponseBodypublic String readJsonAsObject() &#123; try &#123; String json = "&#123;\"name\":\"mrbird\",\"age\":26&#125;"; User user = mapper.readValue(json, User.class); String name = user.getUserName(); int age = user.getAge(); return name + " " + age; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return null;&#125;Jacksonæ³¨è§£JacksonåŒ…å«äº†ä¸€äº›å®žç”¨çš„æ³¨è§£ï¼š@JsonProperty@JsonPropertyï¼Œä½œç”¨åœ¨å±žæ€§ä¸Šï¼Œç”¨æ¥ä¸ºJSON KeyæŒ‡å®šä¸€ä¸ªåˆ«åã€‚12@JsonProperty("bth")private Date birthday;å†æ¬¡è®¿é—®getuseré¡µé¢è¾“å‡ºï¼š1&#123;"userName":"mrbird","age":0,"password":null,"bth":"2018-04-02 10:38:37"&#125;key birthdayå·²ç»è¢«æ›¿æ¢ä¸ºäº†bthã€‚@Jsonlgnore@Jsonlgnoreï¼Œä½œç”¨åœ¨å±žæ€§ä¸Šï¼Œç”¨æ¥å¿½ç•¥æ­¤å±žæ€§ã€‚12@JsonIgnoreprivate String password;å†æ¬¡è®¿é—®getuseré¡µé¢è¾“å‡ºï¼š1&#123;"userName":"mrbird","age":0,"bth":"2018-04-02 10:40:45"&#125;passwordå±žæ€§å·²è¢«å¿½ç•¥ã€‚@JsonIgnoreProperties@JsonIgnorePropertiesï¼Œå¿½ç•¥ä¸€ç»„å±žæ€§ï¼Œä½œç”¨äºŽç±»ä¸Šï¼Œæ¯”å¦‚JsonIgnoreProperties({ &quot;password&quot;, &quot;age&quot; })ã€‚1234@JsonIgnoreProperties(&#123; "password", "age" &#125;)public class User implements Serializable &#123; ...&#125;å†æ¬¡è®¿é—®getuseré¡µé¢è¾“å‡ºï¼š1&#123;"userName":"mrbird","bth":"2018-04-02 10:45:34"&#125;@JsonFormat@JsonFormatï¼Œç”¨äºŽæ—¥æœŸæ ¼å¼åŒ–ï¼Œå¦‚ï¼š12@JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")private Date birthday;@JsonNaming@JsonNamingï¼Œç”¨äºŽæŒ‡å®šä¸€ä¸ªå‘½åç­–ç•¥ï¼Œä½œç”¨äºŽç±»æˆ–è€…å±žæ€§ä¸Šã€‚Jacksonè‡ªå¸¦äº†å¤šç§å‘½åç­–ç•¥ï¼Œä½ å¯ä»¥å®žçŽ°è‡ªå·±çš„å‘½åç­–ç•¥ï¼Œæ¯”å¦‚è¾“å‡ºçš„key ç”±Javaå‘½åæ–¹å¼è½¬ä¸ºä¸‹é¢çº¿å‘½åæ–¹æ³• â€”â€” userNameè½¬åŒ–ä¸ºuser-nameã€‚1234@JsonNaming(PropertyNamingStrategy.LowerCaseWithUnderscoresStrategy.class)public class User implements Serializable &#123; ...&#125;å†æ¬¡è®¿é—®getuseré¡µé¢è¾“å‡ºï¼š1&#123;"user_name":"mrbird","bth":"2018-04-02 10:52:12"&#125;@JsonSerialize@JsonSerializeï¼ŒæŒ‡å®šä¸€ä¸ªå®žçŽ°ç±»æ¥è‡ªå®šä¹‰åºåˆ—åŒ–ã€‚ç±»å¿…é¡»å®žçŽ°JsonSerializeræŽ¥å£ï¼Œä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718import java.io.IOException;import com.example.pojo.User;import com.fasterxml.jackson.core.JsonGenerator;import com.fasterxml.jackson.core.JsonProcessingException;import com.fasterxml.jackson.databind.JsonSerializer;import com.fasterxml.jackson.databind.SerializerProvider;public class UserSerializer extends JsonSerializer&lt;User&gt; &#123; @Override public void serialize(User user, JsonGenerator generator, SerializerProvider provider) throws IOException, JsonProcessingException &#123; generator.writeStartObject(); generator.writeStringField("user-name", user.getUserName()); generator.writeEndObject(); &#125;&#125;ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬ä»…ä»…åºåˆ—åŒ–userNameå±žæ€§ï¼Œä¸”è¾“å‡ºçš„keyæ˜¯user-nameã€‚ ä½¿ç”¨æ³¨è§£@JsonSerializeæ¥æŒ‡å®šUserå¯¹è±¡çš„åºåˆ—åŒ–æ–¹å¼ï¼š1234@JsonSerialize(using = UserSerializer.class)public class User implements Serializable &#123; ...&#125;å†æ¬¡è®¿é—®getuseré¡µé¢è¾“å‡ºï¼š1&#123;"user-name":"mrbird"&#125;@JsonDeserialize@JsonDeserializeï¼Œç”¨æˆ·è‡ªå®šä¹‰ååºåˆ—åŒ–ï¼ŒåŒ@JsonSerialize ï¼Œç±»éœ€è¦å®žçŽ°JsonDeserializeræŽ¥å£ã€‚123456789101112131415161718192021import java.io.IOException;import com.example.pojo.User;import com.fasterxml.jackson.core.JsonParser;import com.fasterxml.jackson.core.JsonProcessingException;import com.fasterxml.jackson.databind.DeserializationContext;import com.fasterxml.jackson.databind.JsonDeserializer;import com.fasterxml.jackson.databind.JsonNode;public class UserDeserializer extends JsonDeserializer&lt;User&gt; &#123; @Override public User deserialize(JsonParser parser, DeserializationContext context) throws IOException, JsonProcessingException &#123; JsonNode node = parser.getCodec().readTree(parser); String userName = node.get("user-name").asText(); User user = new User(); user.setUserName(userName); return user; &#125;&#125;ä½¿ç”¨æ³¨è§£@JsonDeserializeæ¥æŒ‡å®šUserå¯¹è±¡çš„åºåˆ—åŒ–æ–¹å¼ï¼š1234@JsonDeserialize (using = UserDeserializer.class)public class User implements Serializable &#123; ...&#125;æµ‹è¯•ï¼š12345678910111213141516@AutowiredObjectMapper mapper;@RequestMapping("readjsonasobject")@ResponseBodypublic String readJsonAsObject() &#123; try &#123; String json = "&#123;\"user-name\":\"mrbird\"&#125;"; User user = mapper.readValue(json, User.class); String name = user.getUserName(); return name; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return null;&#125;è®¿é—®readjsonasobjectï¼Œé¡µé¢è¾“å‡ºï¼š1mrbird@JsonView@JsonViewï¼Œä½œç”¨åœ¨ç±»æˆ–è€…å±žæ€§ä¸Šï¼Œç”¨æ¥å®šä¹‰ä¸€ä¸ªåºåˆ—åŒ–ç»„ã€‚ æ¯”å¦‚å¯¹äºŽUserå¯¹è±¡ï¼ŒæŸäº›æƒ…å†µä¸‹åªè¿”å›žuserNameå±žæ€§å°±è¡Œï¼Œè€ŒæŸäº›æƒ…å†µä¸‹éœ€è¦è¿”å›žå…¨éƒ¨å±žæ€§ã€‚ å› æ­¤Userå¯¹è±¡å¯ä»¥å®šä¹‰æˆå¦‚ä¸‹ï¼š12345678910111213141516171819public class User implements Serializable &#123; private static final long serialVersionUID = 6222176558369919436L; public interface UserNameView &#123;&#125;; public interface AllUserFieldView extends UserNameView &#123;&#125;; @JsonView(UserNameView.class) private String userName; @JsonView(AllUserFieldView.class) private int age; @JsonView(AllUserFieldView.class) private String password; @JsonView(AllUserFieldView.class) private Date birthday; ... &#125;Userå®šä¹‰äº†ä¸¤ä¸ªæŽ¥å£ç±»ï¼Œä¸€ä¸ªä¸ºuserNameViewï¼Œå¦å¤–ä¸€ä¸ªä¸ºAllUserFieldViewç»§æ‰¿äº†userNameViewæŽ¥å£ã€‚è¿™ä¸¤ä¸ªæŽ¥å£ä»£è¡¨äº†ä¸¤ä¸ªåºåˆ—åŒ–ç»„çš„åç§°ã€‚å±žæ€§userNameä½¿ç”¨äº†@JsonView(UserNameView.class)ï¼Œè€Œå‰©ä¸‹å±žæ€§ä½¿ç”¨äº†@JsonView(AllUserFieldView.class)ã€‚Springä¸­Controlleræ–¹æ³•å…è®¸ä½¿ç”¨@JsonViewæŒ‡å®šä¸€ä¸ªç»„åï¼Œè¢«åºåˆ—åŒ–çš„å¯¹è±¡åªæœ‰åœ¨è¿™ä¸ªç»„çš„å±žæ€§æ‰ä¼šè¢«åºåˆ—åŒ–ï¼Œä»£ç å¦‚ä¸‹ï¼š1234567891011@JsonView(User.UserNameView.class)@RequestMapping("getuser")@ResponseBodypublic User getUser() &#123; User user = new User(); user.setUserName("mrbird"); user.setAge(26); user.setPassword("123456"); user.setBirthday(new Date()); return user;&#125;è®¿é—®getuseré¡µé¢è¾“å‡ºï¼š1&#123;"userName":"mrbird"&#125;å¦‚æžœå°†@JsonView(User.UserNameView.class)æ›¿æ¢ä¸º@JsonView(User.AllUserFieldView.class)ï¼Œè¾“å‡ºï¼š1&#123;"userName":"mrbird","age":26,"password":"123456","birthday":"2018-04-02 11:24:00"&#125;å› ä¸ºæŽ¥å£AllUserFieldViewç»§æ‰¿äº†æŽ¥å£UserNameViewæ‰€ä»¥userNameä¹Ÿä¼šè¢«è¾“å‡ºã€‚é›†åˆçš„ååºåˆ—åŒ–åœ¨Controlleræ–¹æ³•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ï¼ RequestBodyå°†æäº¤çš„JSONè‡ªåŠ¨æ˜ å°„åˆ°æ–¹æ³•å‚æ•°ä¸Šï¼Œæ¯”å¦‚ï¼š12345@RequestMapping("updateuser")@ResponseBodypublic int updateUser(@RequestBody List&lt;User&gt; list)&#123; return list.size();&#125;ä¸Šé¢æ–¹æ³•å¯ä»¥æŽ¥å—å¦‚ä¸‹ä¸€ä¸ªJSONè¯·æ±‚ï¼Œå¹¶è‡ªåŠ¨æ˜ å°„åˆ°Userå¯¹è±¡ä¸Šï¼š1[&#123;"userName":"mrbird","age":26&#125;,&#123;"userName":"scott","age":27&#125;]Spring Boot èƒ½è‡ªåŠ¨è¯†åˆ«å‡ºListå¯¹è±¡åŒ…å«çš„æ˜¯Userç±»ï¼Œå› ä¸ºåœ¨æ–¹æ³•ä¸­å®šä¹‰çš„æ³›åž‹çš„ç±»åž‹ä¼šè¢«ä¿ç•™åœ¨å­—èŠ‚ç ä¸­ï¼Œæ‰€ä»¥Spring Bootèƒ½è¯†åˆ«ListåŒ…å«çš„æ³›åž‹ç±»åž‹ä»Žè€Œèƒ½æ­£ç¡®ååºåˆ—åŒ–ã€‚æœ‰äº›æƒ…å†µä¸‹ï¼Œé›†åˆå¯¹è±¡å¹¶æ²¡æœ‰åŒ…å«æ³›åž‹å®šä¹‰ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œååºåˆ—åŒ–å¹¶ä¸èƒ½å¾—åˆ°æœŸæœ›çš„ç»“æžœã€‚1234567891011121314@AutowiredObjectMapper mapper;@RequestMapping("customize")@ResponseBodypublic String customize() throws JsonParseException, JsonMappingException, IOException &#123; String jsonStr = "[&#123;\"userName\":\"mrbird\",\"age\":26&#125;,&#123;\"userName\":\"scott\",\"age\":27&#125;]"; List&lt;User&gt; list = mapper.readValue(jsonStr, List.class); String msg = ""; for (User user : list) &#123; msg += user.getUserName(); &#125; return msg;&#125;è®¿é—®customizeï¼ŒæŽ§åˆ¶å°æŠ›å‡ºå¼‚å¸¸ï¼šjava.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to com.example.pojo.Userè¿™æ˜¯å› ä¸ºåœ¨è¿è¡Œæ—¶åˆ»ï¼Œæ³›åž‹å·±ç»è¢«æ“¦é™¤äº†ï¼ˆä¸åŒäºŽæ–¹æ³•å‚æ•°å®šä¹‰çš„æ³›åž‹ï¼Œä¸ä¼šè¢«æ“¦é™¤ï¼‰ã€‚ä¸ºäº†æä¾›æ³›åž‹ä¿¡æ¯ï¼ŒJacksonæä¾›äº†JavaType ï¼Œç”¨æ¥æŒ‡æ˜Žé›†åˆç±»åž‹ï¼Œå°†ä¸Šè¿°æ–¹æ³•æ”¹ä¸ºï¼š123456789101112131415@AutowiredObjectMapper mapper;@RequestMapping("customize")@ResponseBodypublic String customize() throws JsonParseException, JsonMappingException, IOException &#123; String jsonStr = "[&#123;\"userName\":\"mrbird\",\"age\":26&#125;,&#123;\"userName\":\"scott\",\"age\":27&#125;]"; JavaType type = mapper.getTypeFactory().constructParametricType(List.class, User.class); List&lt;User&gt; list = mapper.readValue(jsonStr, type); String msg = ""; for (User user : list) &#123; msg += user.getUserName(); &#125; return msg;&#125;è®¿é—®customizeï¼Œé¡µé¢è¾“å‡ºï¼šmrbirdscottã€‚æºç è¿žæŽ¥https://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/18.Spring-Boot-Jackson]]></content>
      <tags>
        <tag>JSON</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨Jsoupé˜²å¾¡XSSæ”»å‡»]]></title>
    <url>%2FJsoup%20XSS.html</url>
    <content type="text"><![CDATA[è·¨ç«™è„šæœ¬æ”»å‡»(Cross Site Scripting)ï¼Œä¸ºäº†ä¸å’Œå±‚å æ ·å¼è¡¨(Cascading Style Sheets, CSS)çš„ç¼©å†™æ··æ·†ï¼Œæ•…å°†è·¨ç«™è„šæœ¬æ”»å‡»ç¼©å†™ä¸ºXSSã€‚æ¶æ„æ”»å‡»è€…å¾€Webé¡µé¢é‡Œæ’å…¥æ¶æ„Scriptä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­Webé‡Œé¢çš„Scriptä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»Žè€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚ä½¿ç”¨Jsoupå¯ä»¥æœ‰æ•ˆçš„è¿‡æ»¤ä¸å®‰å…¨çš„ä»£ç ã€‚Jsoupä½¿ç”¨ç™½åå•çš„æœºåˆ¶æ¥é¢„é˜²XSSæ”»å‡»ï¼Œæ¯”å¦‚ç™½åå•ä¸­è§„å®šåªå…è®¸&lt;span&gt;æ ‡ç­¾çš„å­˜åœ¨ï¼Œé‚£ä¹ˆå…¶ä»–æ ‡ç­¾éƒ½ä¼šè¢«è¿‡æ»¤æŽ‰ã€‚å¸¸è§çš„XSSæ”»å‡»æ¯”å¦‚é¡µé¢çš„æŸä¸ªè¡¨å•å…è®¸ç”¨æˆ·è¾“å…¥ä»»æ„å†…å®¹ï¼Œå½“æŸä¸ªè°ƒçš®çš„ç”¨æˆ·è¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š ä¿å­˜åŽï¼Œä½ ä¼šå‘çŽ°é¡µé¢æ–‡å­—éƒ½å˜æˆäº†çº¢è‰²ï¼æˆ–è€…è¾“å…¥&lt;script&gt;for(var i=0;i&lt;10;i++){alert(&quot;fuck you&quot;);}&lt;/script&gt;ï¼Œä¿å­˜åŽé¡µé¢å°†å¼¹çª—10æ¬¡ï¼å¼•å…¥Jsoupä½¿ç”¨Mavenæž„å»ºä¸€ä¸ªç®€å•çš„Spring Booté¡¹ç›®ï¼Œåœ¨pomä¸­å¼•å…¥ï¼š12345&lt;dependency&gt; &lt;groupId&gt;org.jsoup&lt;/groupId&gt; &lt;artifactId&gt;jsoup&lt;/artifactId&gt; &lt;version&gt;1.9.2&lt;/version&gt;&lt;/dependency&gt;JsoupUtilåˆ›å»ºä¸€ä¸ªJsoupUtilå·¥å…·ç±»ï¼š1234567891011121314151617181920212223242526272829import java.io.FileNotFoundException;import java.io.IOException;import org.jsoup.Jsoup;import org.jsoup.nodes.Document;import org.jsoup.safety.Whitelist;/** * Xssè¿‡æ»¤å·¥å…· * */public class JsoupUtil &#123; private static final Whitelist whitelist = Whitelist.basicWithImages(); /* * é…ç½®è¿‡æ»¤åŒ–å‚æ•°,ä¸å¯¹ä»£ç è¿›è¡Œæ ¼å¼åŒ– */ private static final Document.OutputSettings outputSettings = new Document.OutputSettings().prettyPrint(false); static &#123; /* * å¯Œæ–‡æœ¬ç¼–è¾‘æ—¶ä¸€äº›æ ·å¼æ˜¯ä½¿ç”¨styleæ¥è¿›è¡Œå®žçŽ°çš„ æ¯”å¦‚çº¢è‰²å­—ä½“ style="color:red;" æ‰€ä»¥éœ€è¦ç»™æ‰€æœ‰æ ‡ç­¾æ·»åŠ styleå±žæ€§ */ whitelist.addAttributes(":all", "style"); &#125; public static String clean(String content) &#123; return Jsoup.clean(content, "", whitelist, outputSettings); &#125;&#125;è¿™é‡Œé‡‡ç”¨çš„ç™½åå•ä¸ºbasicWithImagesï¼ŒJsoupå†…ç½®äº†å‡ ç§å¸¸è§çš„ç™½åå•ä¾›æˆ‘ä»¬é€‰æ‹©ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šç™½åå•å¯¹è±¡æ ‡ç­¾è¯´æ˜Žnoneæ— åªä¿ç•™æ ‡ç­¾å†…æ–‡æœ¬å†…å®¹simpleTextb,em,i,strong,uç®€å•çš„æ–‡æœ¬æ ‡ç­¾basica,b,blockquote,br,cite,code,dd,dl,dt,em,i,li,ol,p,pre,q,small,span,strike,strong,sub,sup,u,ulåŸºæœ¬ä½¿ç”¨çš„æ ‡ç­¾basicWithImagesbasic çš„åŸºç¡€ä¸Šæ·»åŠ äº† img æ ‡ç­¾åŠ img æ ‡ç­¾çš„ src,align,alt,height,width,title å±žæ€§åŸºæœ¬ä½¿ç”¨çš„åŠ ä¸Š img æ ‡ç­¾relaxeda,b,blockquote,br,caption,cite,code,col,colgroup,dd,div,dl,dt,em,h1,h2,h3,h4,h5,h6,i,img,li,ol,p,pre,q,small,span,strike,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,u,ulåœ¨ basicWithImages çš„åŸºç¡€ä¸Šåˆå¢žåŠ äº†ä¸€éƒ¨åˆ†éƒ¨åˆ†æ ‡ç­¾XssHttpServletRequestWrapperåˆ›å»ºä¸€ä¸ªXssHttpServletRequestWrapperï¼ŒåŒè¿‡é‡å†™getParameter()ï¼ŒgetParameterValues()å’ŒgetHeader()æ–¹æ³•æ¥è¿‡æ»¤HTTPè¯·æ±‚ä¸­å‚æ•°åŒ…å«çš„æ¶æ„å­—ç¬¦ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletRequestWrapper;import org.apache.commons.lang.StringUtils;import cc.mrbird.common.util.JsoupUtil;/** * Jsoupè¿‡æ»¤httpè¯·æ±‚ï¼Œé˜²æ­¢Xssæ”»å‡» * */public class XssHttpServletRequestWrapper extends HttpServletRequestWrapper &#123; HttpServletRequest orgRequest = null; private boolean isIncludeRichText = false; public XssHttpServletRequestWrapper(HttpServletRequest request, boolean isIncludeRichText) &#123; super(request); orgRequest = request; this.isIncludeRichText = isIncludeRichText; &#125; /** * è¦†ç›–getParameteræ–¹æ³•ï¼Œå°†å‚æ•°åå’Œå‚æ•°å€¼éƒ½åšxssè¿‡æ»¤å¦‚æžœéœ€è¦èŽ·å¾—åŽŸå§‹çš„å€¼ï¼Œåˆ™é€šè¿‡super.getParameterValues(name)æ¥èŽ·å– * getParameterNames,getParameterValueså’ŒgetParameterMapä¹Ÿå¯èƒ½éœ€è¦è¦†ç›– */ @Override public String getParameter(String name) &#123; if (("content".equals(name) || name.endsWith("WithHtml")) &amp;&amp; !isIncludeRichText) &#123; return super.getParameter(name); &#125; name = JsoupUtil.clean(name); String value = super.getParameter(name); if (StringUtils.isNotBlank(value)) &#123; value = JsoupUtil.clean(value); &#125; return value; &#125; @Override public String[] getParameterValues(String name) &#123; String[] arr = super.getParameterValues(name); if (arr != null) &#123; for (int i = 0; i &lt; arr.length; i++) &#123; arr[i] = JsoupUtil.clean(arr[i]); &#125; &#125; return arr; &#125; /** * è¦†ç›–getHeaderæ–¹æ³•ï¼Œå°†å‚æ•°åå’Œå‚æ•°å€¼éƒ½åšxssè¿‡æ»¤å¦‚æžœéœ€è¦èŽ·å¾—åŽŸå§‹çš„å€¼ï¼Œåˆ™é€šè¿‡super.getHeaders(name)æ¥èŽ·å– * getHeaderNames ä¹Ÿå¯èƒ½éœ€è¦è¦†ç›– */ @Override public String getHeader(String name) &#123; name = JsoupUtil.clean(name); String value = super.getHeader(name); if (StringUtils.isNotBlank(value)) &#123; value = JsoupUtil.clean(value); &#125; return value; &#125; /** * èŽ·å–åŽŸå§‹çš„request */ public HttpServletRequest getOrgRequest() &#123; return orgRequest; &#125; /** * èŽ·å–åŽŸå§‹çš„requestçš„é™æ€æ–¹æ³• */ public static HttpServletRequest getOrgRequest(HttpServletRequest req) &#123; if (req instanceof XssHttpServletRequestWrapper) &#123; return ((XssHttpServletRequestWrapper) req).getOrgRequest(); &#125; return req; &#125;&#125;XssFilteråˆ›å»ºXssFilterï¼ŒåŒè¿‡ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„XssHttpServletRequestWrapperç±»ä¸­çš„getParameter()ç­‰æ–¹æ³•æ¥ä¿è¯å‚æ•°å¾—åˆ°äº†è¿‡æ»¤ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081import java.io.IOException;import java.util.ArrayList;import java.util.List;import java.util.regex.Matcher;import java.util.regex.Pattern;import javax.servlet.Filter;import javax.servlet.FilterChain;import javax.servlet.FilterConfig;import javax.servlet.ServletException;import javax.servlet.ServletRequest;import javax.servlet.ServletResponse;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import org.apache.commons.lang.BooleanUtils;import org.apache.commons.lang.StringUtils;import org.slf4j.Logger;import org.slf4j.LoggerFactory;/** * Xssæ”»å‡»æ‹¦æˆªå™¨ * */public class XssFilter implements Filter &#123; private static Logger logger = LoggerFactory.getLogger(XssFilter.class); // æ˜¯å¦è¿‡æ»¤å¯Œæ–‡æœ¬å†…å®¹ private static boolean IS_INCLUDE_RICH_TEXT = false; public List&lt;String&gt; excludes = new ArrayList&lt;String&gt;(); @Override public void init(FilterConfig filterConfig) throws ServletException &#123; logger.info("------------ xss filter init ------------"); String isIncludeRichText = filterConfig.getInitParameter("isIncludeRichText"); if (StringUtils.isNotBlank(isIncludeRichText)) &#123; IS_INCLUDE_RICH_TEXT = BooleanUtils.toBoolean(isIncludeRichText); &#125; String temp = filterConfig.getInitParameter("excludes"); if (temp != null) &#123; String[] url = temp.split(","); for (int i = 0; url != null &amp;&amp; i &lt; url.length; i++) &#123; excludes.add(url[i]); &#125; &#125; &#125; @Override public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123; HttpServletRequest req = (HttpServletRequest) request; HttpServletResponse resp = (HttpServletResponse) response; if (handleExcludeURL(req, resp)) &#123; chain.doFilter(request, response); return; &#125; XssHttpServletRequestWrapper xssRequest = new XssHttpServletRequestWrapper((HttpServletRequest) request, IS_INCLUDE_RICH_TEXT); chain.doFilter(xssRequest, response); &#125; @Override public void destroy() &#123; &#125; private boolean handleExcludeURL(HttpServletRequest request, HttpServletResponse response) &#123; if (excludes == null || excludes.isEmpty()) &#123; return false; &#125; String url = request.getServletPath(); for (String pattern : excludes) &#123; Pattern p = Pattern.compile("^" + pattern); Matcher m = p.matcher(url); if (m.find()) return true; &#125; return false; &#125;&#125;Spring Bootä¸­é…ç½®XssFilterä½¿ç”¨JavaConfigçš„å½¢å¼é…ç½®ï¼š12345678910111213@Beanpublic FilterRegistrationBean xssFilterRegistrationBean() &#123; FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean(); filterRegistrationBean.setFilter(new XssFilter()); filterRegistrationBean.setOrder(1); filterRegistrationBean.setEnabled(true); filterRegistrationBean.addUrlPatterns("/*"); Map&lt;String, String&gt; initParameters = new HashMap&lt;String, String&gt;(); initParameters.put("excludes", "/favicon.ico,/img/*,/js/*,/css/*"); initParameters.put("isIncludeRichText", "true"); filterRegistrationBean.setInitParameters(initParameters); return filterRegistrationBean;&#125;å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/u014411966/article/details/78164752https://www.jianshu.com/p/32abc12a175a?nomobile=yes]]></content>
      <tags>
        <tag>Security</tag>
        <tag>Jsoup</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è…¾è®¯äº‘éƒ¨ç½²Java Webé¡¹ç›®å°è®°]]></title>
    <url>%2Ftecent%20cloud%20Java-Web.html</url>
    <content type="text"><![CDATA[è¿‘æœŸè…¾è®¯äº‘æŽ¨å‡ºäº‘æœåŠ¡å™¨å›¢è´­ä¼˜æƒ ï¼Œåˆšå¥½æ‰“ç®—æ­å»ºä¸ªFEBSçš„æ¼”ç¤ºçŽ¯å¢ƒï¼ŒäºŽæ˜¯ä¹°äº†å°120/å¹´çš„äº‘æœåŠ¡å™¨ï¼Œé…ç½®ä¸º1æ ¸2Gã€1Må¸¦å®½ï¼ŒåŠ èµ 50GBå¯¹è±¡å­˜å‚¨ç©ºé—´ï¼Œç³»ç»Ÿä¸ºUbuntu 16.04ã€‚éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°ä¸€äº›æ–°çš„é—®é¢˜ï¼Œåœ¨è¿™è®°å½•ä¸€ä¸‹ã€‚å·¥å…·å‡†å¤‡æ­å»ºå‰å…ˆå‡†å¤‡å¥½è¿œç¨‹ç™»å½•è½¯ä»¶ï¼Œè¿™ç±»è½¯ä»¶å¾ˆå¤šï¼Œè¿™é‡ŒæŽ¨èçš„æ˜¯MobaXtermï¼›æ–‡ä»¶çš„ä¸Šä¼ ä¸‹è½½æŽ¨èä½¿ç”¨FileZillaï¼›æ•°æ®åº“è¿žæŽ¥æŽ¨èä½¿ç”¨Navicat Premiumã€‚JavaçŽ¯å¢ƒæ­å»ºJavaçŽ¯å¢ƒçš„æ­å»ºå¯å‚è€ƒï¼ˆåŒ…æ‹¬å®‰è£…JDKï¼ŒMySQLï¼‰ï¼šubuntu16-04æ­å»ºJavaå¼€å‘çŽ¯å¢ƒã€‚Tomcatä¸‹è½½åŽè§£åŽ‹å³å¯ã€‚è¿œç¨‹è¿žæŽ¥MySQLå¼€å¯MySQLè¿œç¨‹è¿žæŽ¥çš„å‰ææ˜¯åœ¨å®‰è£…MySQLåˆå§‹åŒ–çš„æ—¶å€™å…è®¸è¿œç¨‹è¿žæŽ¥ï¼Œç„¶åŽè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š1mysql&gt; GRANT ALL PRIVILEGES ON *.* TO 'root'@'%'IDENTIFIED BY '123456' WITH GRANT OPTION;è¿™æ®µè¯çš„æ„æ€æ˜¯å…è®¸ä»»ä½•IPä»¥rootè´¦æˆ·è¿œç¨‹è®¿é—®ï¼Œå¯†ç ä¸º123456ã€‚è¿™é‡Œçš„å¯†ç è®¾å®šåªæ˜¯ä¸ºäº†æ¼”ç¤ºï¼Œå®žé™…å¿…é¡»æ»¡è¶³åœ¨åˆå§‹åŒ–MySQLæ—¶å¯†ç å¼ºåº¦çš„è®¾å®šï¼Œå³validate_password_policyï¼šPolicyTests Performed0&nbsp;or&nbsp;LOWLength1&nbsp;or&nbsp;MEDIUMLength; numeric, lowercase/uppercase, and special characters2&nbsp;or&nbsp;STRONGLength; numeric, lowercase/uppercase, and special characters; dictionary fileå½“å¯†ç å¼ºåº¦å’Œè®¾å®šçš„ä¸ä¸€è‡´æ—¶ï¼ŒMySQLæç¤º Your password does not satisfy the current policy requirementsé”™è¯¯ã€‚ç„¶åŽæ‰§è¡Œä¸€ä¸‹è¯­å¥ï¼Œä½¿å¾—è®¾å®šç”Ÿæ•ˆï¼š1mysql&gt; FLUSH PRIVILEGES;æŽ¥ä¸‹æ¥ä½¿ç”¨Navicatè¿œç¨‹è¿žæŽ¥MySQLï¼Œæ‰“å¼€Navicatï¼Œæ–°å»ºMySQLè¿žæŽ¥ï¼šIPå¡«äº‘æœåŠ¡å™¨çš„å…¬ç½‘IPåœ°å€ï¼Œç”¨æˆ·åå’Œå¯†ç ä¸ºä¸Šé¢è®¾å®šçš„rootå’Œ123456ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¾—å¡«å†™SSHè¿žæŽ¥ä¿¡æ¯ï¼šIPå¡«äº‘æœåŠ¡å™¨çš„å…¬ç½‘IPåœ°å€ï¼Œç”¨æˆ·åå’Œå¯†ç ä¸ºäº‘æœåŠ¡å™¨çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ç‚¹å‡»è¿žæŽ¥æµ‹è¯•åŽå‘çŽ°NavicatæŠ¥é”™ï¼šLost connection to MySQL server at &#39;reading initial communication packet&#39;, system error: 0æ‰“å¼€MySQLé…ç½®ï¼š1vim /etc/mysql/mysql.conf.d/mysqld.cnfæ‰¾åˆ°[mysqld]ï¼Œæ·»åŠ skip-name-resolveï¼Œå¹¶å°†bind-address= 127.0.0.1é…ç½®æ³¨é‡ŠæŽ‰å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šç„¶åŽå†æ¬¡ç‚¹å‡»Navicatè¿žæŽ¥æµ‹è¯•å³å¯æˆåŠŸã€‚é¡¹ç›®éƒ¨ç½²åœ¨æœ¬åœ°å°†é¡¹ç›®æ‰“åŒ…åŽï¼Œä½¿ç”¨FileZillaå°†é¡¹ç›®ä¸Šä¼ åˆ°Tomcatçš„webappç›®å½•ä¸‹ï¼Œè¿è¡Œbinç›®å½•ä¸‹çš„startup.shè„šæœ¬å³å¯ã€‚åŸŸåç»‘å®šå¦‚ä¸‹æ–°å¢žåŸŸåè§£æžï¼šè®°å½•å€¼ä¸ºäº‘æœåŠ¡å™¨çš„å…¬ç½‘IPåœ°å€ã€‚é…ç½®è§£æžåŽï¼Œå°±å¯ä½¿ç”¨ åŸŸå:ç«¯å£å·/é¡¹ç›®å çš„å½¢å¼è®¿é—®äº†ã€‚æ¯”å¦‚http://demo.mrbird.cc:80/febs/loginï¼Œç«¯å£å·é»˜è®¤å°±æ˜¯80ï¼Œæ‰€ä»¥å¯ä»¥ç®€å†™ä¸ºhttp://demo.mrbird.cc/febs/loginã€‚]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>äº‘æœåŠ¡å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŸºäºŽSpring Bootå’ŒShiroçš„åŽå°ç®¡ç†ç³»ç»ŸFEBS]]></title>
    <url>%2FSpring-Boot%20Shiro%20FEBS.html</url>
    <content type="text"><![CDATA[FEBSæ˜¯ä¸€ä¸ªç®€å•é«˜æ•ˆçš„åŽå°æƒé™ç®¡ç†ç³»ç»Ÿã€‚é¡¹ç›®åŸºç¡€æ¡†æž¶é‡‡ç”¨å…¨æ–°çš„Java Webå¼€å‘æ¡†æž¶ â€”â€” Spring Boot2.0.3ï¼Œæ¶ˆé™¤äº†ç¹æ‚çš„XMLé…ç½®ï¼Œä½¿å¾—äºŒæ¬¡å¼€å‘æ›´ä¸ºç®€å•ï¼›æ•°æ®è®¿é—®å±‚é‡‡ç”¨Mybatisï¼ŒåŒæ—¶å¼•å…¥äº†é€šç”¨Mapperå’ŒPageHelperæ’ä»¶ï¼Œå¯å¿«é€Ÿé«˜æ•ˆçš„å¯¹å•è¡¨è¿›è¡Œå¢žåˆ æ”¹æŸ¥æ“ä½œï¼Œæ¶ˆé™¤äº†å¤§é‡ä¼ ç»ŸXMLé…ç½®SQLçš„ä»£ç ï¼›å®‰å…¨æ¡†æž¶é‡‡ç”¨æ—¶ä¸‹æµè¡Œçš„Apache Shiroï¼Œå¯å®žçŽ°å¯¹æŒ‰é’®çº§åˆ«çš„æƒé™æŽ§åˆ¶ï¼›å‰ç«¯é¡µé¢ä½¿ç”¨Bootstrapæž„å»ºï¼Œä¸»é¢˜é£Žæ ¼ä¸ºæ—¶ä¸‹Googleæœ€æ–°è®¾è®¡è¯­è¨€Material Designï¼Œå¹¶æä¾›å¤šå¥—é…è‰²ä»¥ä¾›é€‰æ‹©ã€‚FEBSæ„æŒ‡ï¼šFastï¼ŒEasy useï¼ŒBeautifulå’ŒSafeã€‚åŠŸèƒ½æ¨¡å—ç³»ç»ŸåŠŸèƒ½æ¨¡å—ç»„æˆå¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314151617181920212223242526272829303132|-------------------------------------------|| ______ ______ ____ _____ || | ____| ____| _ \ / ____| || | |__ | |__ | |_) | (___ || | __| | __| | _ &lt; \___ \ || | | | |____| |_) |____) | || |_| |______|____/|_____/ || Spring-Boot-Version: 2.0.3.RELEASE ||-------------------------------------------|â”œâ”€ç³»ç»Ÿç®¡ç†â”‚ â”œâ”€å­—å…¸ç®¡ç†â”‚ â”œâ”€ç”¨æˆ·ç®¡ç†â”‚ â”œâ”€èœå•ç®¡ç†â”‚ â”œâ”€è§’è‰²ç®¡ç†â”‚ â””â”€éƒ¨é—¨ç®¡ç†â”œâ”€ç³»ç»Ÿç›‘æŽ§â”‚ â”œâ”€åœ¨çº¿ç”¨æˆ·â”‚ â””â”€ç³»ç»Ÿæ—¥å¿—â”œâ”€ä»»åŠ¡è°ƒåº¦â”‚ â”œâ”€å®šæ—¶ä»»åŠ¡â”‚ â””â”€è°ƒåº¦æ—¥å¿—â””â”€ç½‘ç»œèµ„æº â”œâ”€Oneä¸€ä¸ª â”‚ â”œâ”€æ•£æ–‡ â”‚ â”œâ”€ç»˜ç”» â”‚ â””â”€è¯­æ–‡ â”œâ”€å¤©æ°”æŸ¥è¯¢ â”œâ”€å½±è§†èµ„è®¯ â”‚ â”œâ”€å³å°†ä¸Šæ˜  â”‚ â””â”€æ­£åœ¨çƒ­æ˜  â””â”€æ¯æ—¥ä¸€æ–‡æŠ€æœ¯é€‰åž‹åŽç«¯åŸºç¡€æ¡†æž¶ï¼šSpring Boot 2.0.3.RELEASEæŒä¹…å±‚æ¡†æž¶ï¼šMybatis 3.4.5å®‰å…¨æ¡†æž¶ï¼šApache Shiro 1.4.0æ‘¸æ¿å¼•æ“Žï¼šThymeleaf 3.0.9.RELEASEæ•°æ®åº“è¿žæŽ¥æ± ï¼šé˜¿é‡Œå·´å·´Druid 1.1.10ç¼“å­˜æ¡†æž¶ï¼šEhcacheæ—¥å¿—æ‰“å°ï¼šlogbackå…¶ä»–ï¼šfastjsonï¼Œpoiï¼Œjavacsvï¼Œquartzç­‰ã€‚å‰ç«¯åŸºç¡€æ¡†æž¶ï¼šBootstrap 4JavaScriptæ¡†æž¶ï¼šjQueryæ¶ˆæ¯ç»„ä»¶ï¼šBootstrap notifyæç¤ºæ¡†æ’ä»¶ï¼šSweetAlert2æ ‘å½¢æ’ä»¶ï¼šjsTreeæ ‘å½¢è¡¨æ ¼æ’ä»¶ï¼šjqTreeGridè¡¨æ ¼æ’ä»¶ï¼šBootstrapTableè¡¨å•æ ¡éªŒæ’ä»¶ï¼šjQuery-validateå¤šé€‰ä¸‹æ‹‰æ¡†æ’ä»¶ï¼šmultiple-selectå›¾è¡¨æ’ä»¶ï¼šHighchartsæ—¶é—´æ’ä»¶ï¼šdaterangepickerå¼€å‘çŽ¯å¢ƒè¯­è¨€ï¼šJava 8IDEï¼šEclipse Oxygen &amp; IDEA 2018.1.4(Ultimate Edition)ä¾èµ–ç®¡ç†ï¼šMavenæ•°æ®åº“ï¼šOracle 11g &amp; MySQL5.7ç‰ˆæœ¬ç®¡ç†ï¼šSVNï¼Œgitç³»ç»Ÿé¢„è§ˆä¸»é¢˜é¢„è§ˆä¸‹è½½éƒ¨ç½²ç äº‘åœ°å€ï¼š https://gitee.com/github-16661027/projectGitHub åœ°å€ï¼š https://github.com/wuyouzhuguli/FEBSä¸‹è½½åŽä»¥Mavené¡¹ç›®çš„æ–¹å¼å¯¼å…¥Eclipseæˆ–è€…IDEAã€‚å¼€å‘æ—¶ç›´æŽ¥ä½¿ç”¨Spring Bootçš„å…¥å£ç±»cc.mrbird.Applicationå¯åŠ¨å³å¯ï¼Œè®¿é—®åœ°å€localhost:8080ï¼Œè´¦å·mrbirdï¼Œå¯†ç 123456ã€‚éƒ¨ç½²æ—¶ï¼Œä½¿ç”¨Mavenå°†é¡¹ç›®æ‰“åŒ…æˆfebs.jarï¼Œç„¶åŽä½¿ç”¨å‘½ä»¤java -jar febs.jarå¯åŠ¨å³å¯ã€‚åœ¨Linuxä¸‹éƒ¨ç½²Spring Boot jarï¼Œå¹¶ç¼–å†™å¯åœè„šæœ¬å¯å‚è€ƒé“¾æŽ¥https://mrbird.cc/Linux%20Spring-Boot-jar.htmlã€‚å¸¸è§é—®é¢˜å¦‚ä½•ä¸‹è½½ä»£ç æ‰‹åŠ¨ä¸‹è½½ä¸‹è½½Oracleç‰ˆæœ¬ï¼šåˆ†æ”¯é€‰æ‹©masterï¼Œç„¶åŽç‚¹å‡» download zipå³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šä¸‹è½½MySQLç‰ˆæœ¬ï¼šåˆ†æ”¯é€‰æ‹©mysqlï¼Œç„¶åŽç‚¹å‡» download zipå³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šGitå‘½ä»¤ä¸‹è½½oracleç‰ˆæœ¬ï¼š1git clone https://github.com/wuyouzhuguli/FEBS.gitä¸‹è½½mysqlç‰ˆæœ¬ï¼š1git clone -b mysql https://github.com/wuyouzhuguli/FEBS.gitServletä¾èµ–é—®é¢˜å¯åŠ¨é¡¹ç›®åŽæŠ¥Servletä¾èµ–æœªæ‰¾åˆ°ï¼Œæ¯”å¦‚ï¼šPost-processing of merged bean definition failed; nested exception is java.lang.NoClassDefFoundError: javax/servlet/ServletRequestå‡ºçŽ°è¿™ä¸ªé—®é¢˜ä¸€èˆ¬æ˜¯ä½¿ç”¨IDEAçš„åŒå­¦ï¼Œè§£å†³åŠžæ³•ï¼šæ‰“å¼€pomæ–‡ä»¶ï¼Œç„¶åŽä¸‹å›¾ä¸­çš„&lt;scope&gt;provided&lt;/scope&gt;åŽ»æŽ‰ï¼šè¡¨ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ä¸€èˆ¬å‡ºçŽ°åœ¨LinuxçŽ¯å¢ƒä¸‹çš„MySQLæ•°æ®åº“ä¸­ï¼ŒLinuxä¸‹çš„MySQLæ•°æ®åº“é»˜è®¤å¼€å¯äº†å¤§å°å†™æ•æ„Ÿï¼Œå³t_userå’ŒT_USERæ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„è¡¨ã€‚è§£å†³åŠžæ³•ï¼šå°†ä»£ç ä¸­çš„è¡¨åå¤§å°å†™æ”¹ä¸ºå’Œæ•°æ®åº“ä¸€è‡´ï¼ˆä¸æŽ¨èï¼ç¹çåˆå®¹æ˜“å‡ºé”™ï¼‰ï¼›å…³é—­MySQLå¤§å°å†™æ•æ„Ÿï¼Œå¯å‚è€ƒï¼šhttps://blog.csdn.net/fdipzone/article/details/73692929ã€‚Oracleé©±åŠ¨ä¾èµ–é—®é¢˜ä»¥ojdbc6ä¸ºä¾‹ï¼Œç”±äºŽç‰ˆæƒçš„åŽŸå› ï¼Œæˆ‘ä»¬éœ€è¦å°†ojdbc6.jarä¾èµ–å®‰è£…åˆ°æœ¬åœ°çš„mavenä»“åº“ï¼Œç„¶åŽæ‰å¯ä»¥åœ¨pomä¸­è¿›è¡Œé…ç½®ã€‚ä¸‹è½½ojdbc6.jaræ–‡ä»¶åŽï¼Œå°†å…¶æ”¾åˆ°æ¯”è¾ƒå¥½æ‰¾çš„ç›®å½•ä¸‹ï¼Œæ¯”å¦‚Dç›˜æ ¹ç›®å½•ã€‚ç„¶åŽè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š1234567891011121314C:\Users\Administrator&gt;mvn install:install-file -Dfile=D:/ojdbc6.jar -DgroupId=com.oracle -DartifactId=ojdbc6 -Dversion=6.0 -Dpackaging=jar -DgeneratePom=true...[INFO] --- maven-install-plugin:2.4:install-file (default-cli) @ standalone-pom ---[INFO] Installing D:\ojdbc6.jar to D:\m2\repository\com\oracle\ojdbc6\6.0\ojdbc6-6.0.jar[INFO] Installing C:\Users\ADMINI~1\AppData\Local\Temp\mvninstall9103688544010617483.pom to D:\m2\repository\com\oracle\ojdbc6\6.0\ojdbc6-6.0.pom[INFO] ------------------------------------------------------------------------[INFO] BUILD SUCCESS[INFO] ------------------------------------------------------------------------[INFO] Total time: 0.940 s[INFO] Finished at: 2017-08-13T15:06:38+08:00[INFO] Final Memory: 6M/145M[INFO] ------------------------------------------------------------------------æŽ¥ç€åœ¨pomä¸­å¼•å…¥ï¼š12345&lt;dependency&gt; &lt;groupId&gt;com.oracle&lt;/groupId&gt; &lt;artifactId&gt;ojdbc6&lt;/artifactId&gt; &lt;version&gt;6.0&lt;/version&gt;&lt;/dependency&gt;è¿™é‡Œçš„groupidå°±æ˜¯ä½ ä¹‹å‰å®‰è£…æ—¶æŒ‡å®šçš„-Dgroupidçš„å€¼ï¼Œartifactidå°±æ˜¯ä½ å®‰è£…æ—¶æŒ‡å®šçš„-Dartifactidçš„å€¼ï¼Œversionä¹Ÿä¸€æ ·ã€‚]]></content>
      <tags>
        <tag>Shiro</tag>
        <tag>Java</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ ‘å½¢æ’ä»¶jsTree]]></title>
    <url>%2F%E6%A0%91%E5%BD%A2%E6%8F%92%E4%BB%B6jsTree.html</url>
    <content type="text"><![CDATA[jsTreeæ˜¯ä¸€æ¬¾åŸºäºŽjQueryçš„æ ‘å½¢æŽ§ä»¶ï¼Œå…·æœ‰æ‰©å±•æ€§å¼ºï¼Œå¯ç¼–è¾‘å’Œå¯é…ç½®çš„ç‰¹æ€§ï¼Œæ”¯æŒHTMLï¼ŒJSONå’ŒAjaxæ•°æ®åŠ è½½ã€‚jsTreeå®˜ç½‘åœ°å€ï¼šhttps://www.jstree.com/ã€‚è¿™é‡Œä¸»è¦ä»‹ç»çš„æ˜¯åŸºäºŽAjaxä»Žæ•°æ®åº“èŽ·å–æ•°æ®ï¼Œç„¶åŽç”Ÿæˆæ ‘å½¢èœå•çš„ç”¨æ³•ã€‚jsTreeçš„çš®è‚¤å¯ä»¥è‡ªç”±å®šåˆ¶ï¼Œæœ¬æ–‡ä½¿ç”¨çš„æ˜¯ä¸€æ¬¾ç¬¬ä¸‰æ–¹jsTreeçš®è‚¤ã€‚å¼•å…¥ä¾èµ–å› ä¸ºå…¶åŸºäºŽjQueryï¼Œæ‰€ä»¥å¼•å…¥jsTreeä¾èµ–å‰å¾—å…ˆå¼•å…¥jQueryï¼š1234&lt;!-- jQuery --&gt;&lt;script src="https://cdn.bootcss.com/jquery/2.2.0/jquery.min.js"&gt;&lt;/script&gt;&lt;!-- jsTree --&gt;&lt;script src="https://cdn.bootcss.com/jstree/3.3.5/jstree.min.js"&gt;&lt;/script&gt;ç”±äºŽç¬¬ä¸‰æ–¹çš®è‚¤æ²¡æœ‰CDNåœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸‹è½½åˆ°æœ¬åœ°åŽæ‰‹åŠ¨å¼•å…¥ï¼ˆå¯åœ¨æ–‡æœ«å¾—æºç ä¸­èŽ·å–ï¼‰ï¼š1&lt;link rel="stylesheet" data-th-href="@&#123;css/jsTree/style.min.css&#125;"&gt;çš®è‚¤é¢„è§ˆï¼š æ•°æ®å‡†å¤‡æœ¬æ–‡ç”¨åˆ°çš„æ•°æ®è¡¨ï¼š12345678910111213141516171819202122-- ------------------------------ Table structure for T_DEPT-- ----------------------------DROP TABLE "MRBIRD"."T_DEPT";CREATE TABLE "MRBIRD"."T_DEPT" ("DEPT_ID" NUMBER NOT NULL ,"PARENT_ID" NUMBER NOT NULL ,"DEPT_NAME" VARCHAR2(100 BYTE) NOT NULL ,"ORDER_NUM" NUMBER NULL ,"CREATE_TIME" DATE NULL );-- ------------------------------ Records of T_DEPT-- ----------------------------INSERT INTO "MRBIRD"."T_DEPT" VALUES ('1', '0', 'å¼€å‘éƒ¨', null, TO_DATE('2018-01-04 15:42:26', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('3', '1', 'å¼€å‘äºŒéƒ¨', null, TO_DATE('2018-01-04 15:42:29', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('5', '0', 'äººäº‹éƒ¨', null, TO_DATE('2018-01-04 15:42:32', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('2', '1', 'å¼€å‘ä¸€éƒ¨', null, TO_DATE('2018-01-04 15:42:34', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('4', '0', 'å¸‚åœºéƒ¨', null, TO_DATE('2018-01-04 15:42:36', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('6', '0', 'æµ‹è¯•éƒ¨', null, TO_DATE('2018-01-04 15:42:38', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('7', '2', 'ä¸€éƒ¨åˆ†éƒ¨', null, TO_DATE('2018-03-16 10:46:31', 'YYYY-MM-DD HH24:MI:SS'));åŽç«¯æ¡†æž¶ä¸ºSpring Boot + Mybatisï¼ˆé€šç”¨mapperï¼‰ï¼Œç”±äºŽæœ¬æ–‡çš„é‡ç‚¹æ˜¯jsTreeçš„ä½¿ç”¨ï¼Œæ‰€ä»¥èŽ·å–æ•°æ®çš„ç»†èŠ‚å’Œæ•°æ®æ ¼å¼çš„å¤„ç†è¿™é‡Œä¸åšé˜è¿°ï¼Œå…·ä½“å¯å‚è€ƒæ–‡æœ«çš„æºç ã€‚æœ€ç»ˆé€šè¿‡AjaxèŽ·å–åˆ°çš„JSONæ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102&#123; "code": 0, "msg": &#123; "id": "0", "icon": null, "url": null, "text": "æ ¹èŠ‚ç‚¹", "state": &#123; "opened": true &#125;, "checked": true, "attributes": null, "children": [&#123; "id": "1", "icon": null, "url": null, "text": "å¼€å‘éƒ¨", "state": null, "checked": false, "attributes": null, "children": [&#123; "id": "3", "icon": null, "url": null, "text": "å¼€å‘äºŒéƒ¨", "state": null, "checked": false, "attributes": null, "children": [], "parentId": "1", "hasParent": true, "hasChildren": false &#125;, &#123; "id": "2", "icon": null, "url": null, "text": "å¼€å‘ä¸€éƒ¨", "state": null, "checked": false, "attributes": null, "children": [&#123; "id": "7", "icon": null, "url": null, "text": "ä¸€éƒ¨åˆ†éƒ¨", "state": null, "checked": false, "attributes": null, "children": [], "parentId": "2", "hasParent": true, "hasChildren": false &#125;], "parentId": "1", "hasParent": true, "hasChildren": true &#125;], "parentId": "0", "hasParent": false, "hasChildren": true &#125;, &#123; "id": "5", "icon": null, "url": null, "text": "äººäº‹éƒ¨", "state": null, "checked": false, "attributes": null, "children": [], "parentId": "0", "hasParent": false, "hasChildren": false &#125;, &#123; "id": "4", "icon": null, "url": null, "text": "å¸‚åœºéƒ¨", "state": null, "checked": false, "attributes": null, "children": [], "parentId": "0", "hasParent": false, "hasChildren": false &#125;, &#123; "id": "6", "icon": null, "url": null, "text": "æµ‹è¯•éƒ¨", "state": null, "checked": false, "attributes": null, "children": [], "parentId": "0", "hasParent": false, "hasChildren": false &#125;], "parentId": "", "hasParent": false, "hasChildren": true &#125;&#125;åŸºæœ¬ä½¿ç”¨æ–¹æ³•ä½¿ç”¨Ajaxä»ŽåŽå°èŽ·å–åˆ°å¦‚ä¸Šæ‰€ç¤ºæ ¼å¼çš„JSONæ•°æ®ï¼ˆä¹Ÿå°±æ˜¯r.msgï¼‰,ç„¶åŽä½¿ç”¨jsTreeç”Ÿæˆæ ‘å½¢æŽ§ä»¶ï¼šHTML:1&lt;div id="deptTree"&gt;&lt;/div&gt;JavaScript:1234567891011121314151617&lt;script data-th-inline="javascript"&gt;var ctx = [[@&#123;/&#125;]];$(function() &#123; createDeptTree();&#125;);function createDeptTree() &#123; $.post(ctx + "dept/tree", &#123;&#125;, function(r) &#123; var data = r.msg; $('#deptTree').jstree(&#123; "core": &#123; 'data': data.children &#125; &#125;); &#125;)&#125;&lt;/script&gt;æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼šdiv.deptTree{padding:1rem;width:25%;border:1px solid #efefef}$("#deptTree1").jstree({core:{data:[{id:"1",icon:null,url:null,text:"å¼€å‘éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"3",icon:null,url:null,text:"å¼€å‘äºŒéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"1",hasParent:!0,hasChildren:!1},{id:"2",icon:null,url:null,text:"å¼€å‘ä¸€éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"7",icon:null,url:null,text:"ä¸€éƒ¨åˆ†éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"2",hasParent:!0,hasChildren:!1}],parentId:"1",hasParent:!0,hasChildren:!0}],parentId:"0",hasParent:!1,hasChildren:!0},{id:"5",icon:null,url:null,text:"äººäº‹éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"4",icon:null,url:null,text:"å¸‚åœºéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"6",icon:null,url:null,text:"æµ‹è¯•éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1}]}})å¸¸ç”¨æ“ä½œä¸Šé¢ä»‹ç»äº†æœ€åŸºæœ¬çš„jsTreeä½¿ç”¨æ–¹æ³•ï¼Œä¸‹é¢å¼€å§‹ä»‹ç»ä¸€äº›å¸¸ç”¨çš„jsTreeæ“ä½œã€‚æ˜¾ç¤ºCheckboxJavaScriptä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š123456$('#deptTree').jstree(&#123; "core": &#123; 'data': data.children &#125;, "plugins" : [ "checkbox" ]&#125;);æ˜¾ç¤ºæ•ˆæžœå¦‚ä¸‹ï¼š$("#deptTree2").jstree({core:{data:[{id:"1",icon:null,url:null,text:"å¼€å‘éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"3",icon:null,url:null,text:"å¼€å‘äºŒéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"1",hasParent:!0,hasChildren:!1},{id:"2",icon:null,url:null,text:"å¼€å‘ä¸€éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"7",icon:null,url:null,text:"ä¸€éƒ¨åˆ†éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"2",hasParent:!0,hasChildren:!1}],parentId:"1",hasParent:!0,hasChildren:!0}],parentId:"0",hasParent:!1,hasChildren:!0},{id:"5",icon:null,url:null,text:"äººäº‹éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"4",icon:null,url:null,text:"å¸‚åœºéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"6",icon:null,url:null,text:"æµ‹è¯•éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1}]},plugins:["checkbox"]})æ­¤æ—¶ï¼Œè¢«é€‰ä¸­çš„é€‰é¡¹é»˜è®¤ä¼šæœ‰æµ…è“è‰²çš„èƒŒæ™¯ï¼Œå¦‚æžœæƒ³è¦åŽ»é™¤ï¼Œåªéœ€å°†jsä»£ç æ”¹ä¸ºï¼š123456789$('#deptTree').jstree(&#123; "core": &#123; 'data': data.children &#125;, "plugins" : [ "checkbox" ], "checkbox" : &#123; "keep_selected_style" : false &#125;&#125;);æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼š$("#deptTree3").jstree({core:{data:[{id:"1",icon:null,url:null,text:"å¼€å‘éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"3",icon:null,url:null,text:"å¼€å‘äºŒéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"1",hasParent:!0,hasChildren:!1},{id:"2",icon:null,url:null,text:"å¼€å‘ä¸€éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"7",icon:null,url:null,text:"ä¸€éƒ¨åˆ†éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"2",hasParent:!0,hasChildren:!1}],parentId:"1",hasParent:!0,hasChildren:!0}],parentId:"0",hasParent:!1,hasChildren:!0},{id:"5",icon:null,url:null,text:"äººäº‹éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"4",icon:null,url:null,text:"å¸‚åœºéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"6",icon:null,url:null,text:"æµ‹è¯•éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1}]},plugins:["checkbox"],checkbox:{keep_selected_style:!1}})Wholerowæ’ä»¶è¯¥æ’ä»¶å¯ä»¥ç»™é€‰ä¸­çš„é¡¹ç›®æˆ–è€…hoverçš„é¡¹ç›®æ·»åŠ ä¸€ä¸ªè¡Œçº§åˆ«çš„èƒŒæ™¯è‰²ï¼Œjsä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š123456$('#deptTree').jstree(&#123; "core": &#123; 'data': data.children &#125;, "plugins" : [ "checkbox", "wholerow" ]&#125;);æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼š$("#deptTree4").jstree({core:{data:[{id:"1",icon:null,url:null,text:"å¼€å‘éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"3",icon:null,url:null,text:"å¼€å‘äºŒéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"1",hasParent:!0,hasChildren:!1},{id:"2",icon:null,url:null,text:"å¼€å‘ä¸€éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"7",icon:null,url:null,text:"ä¸€éƒ¨åˆ†éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"2",hasParent:!0,hasChildren:!1}],parentId:"1",hasParent:!0,hasChildren:!0}],parentId:"0",hasParent:!1,hasChildren:!0},{id:"5",icon:null,url:null,text:"äººäº‹éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"4",icon:null,url:null,text:"å¸‚åœºéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"6",icon:null,url:null,text:"æµ‹è¯•éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1}]},plugins:["checkbox","wholerow"]})æ·»åŠ è¯¥æ’ä»¶åŽï¼ŒæŽ§ä»¶å‰çš„è™šçº¿æ²¡äº†ï¼Œå…·ä½“åŽŸå› æœªçŸ¥=ã€‚=å–æ¶ˆçˆ¶å­å…³è”é»˜è®¤æƒ…å†µä¸‹ï¼Œé€‰ä¸­çˆ¶èŠ‚ç‚¹åŽï¼Œå…¶ä¸‹çš„æ‰€æœ‰å­èŠ‚ç‚¹ä¹Ÿä¼šè·Ÿç€è¢«é€‰ä¸­ï¼Œå–æ¶ˆçˆ¶å­èŠ‚ç‚¹å…³è”åªéœ€æ·»åŠ &quot;checkbox&quot;: {&quot;three_state&quot;: false}å³å¯ï¼š123456789$('#deptTree').jstree(&#123; "core": &#123; 'data': data.children &#125;, "plugins" : [ "checkbox" ], "checkbox": &#123; "three_state": false // å–æ¶ˆé€‰æ‹©çˆ¶èŠ‚ç‚¹åŽé€‰ä¸­æ‰€æœ‰å­èŠ‚ç‚¹ &#125;,&#125;);æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼š$("#deptTree5").jstree({core:{data:[{id:"1",icon:null,url:null,text:"å¼€å‘éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"3",icon:null,url:null,text:"å¼€å‘äºŒéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"1",hasParent:!0,hasChildren:!1},{id:"2",icon:null,url:null,text:"å¼€å‘ä¸€éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"7",icon:null,url:null,text:"ä¸€éƒ¨åˆ†éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"2",hasParent:!0,hasChildren:!1}],parentId:"1",hasParent:!0,hasChildren:!0}],parentId:"0",hasParent:!1,hasChildren:!0},{id:"5",icon:null,url:null,text:"äººäº‹éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"4",icon:null,url:null,text:"å¸‚åœºéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"6",icon:null,url:null,text:"æµ‹è¯•éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1}]},plugins:["checkbox"],checkbox:{three_state:!1}})è®¾ç½®å•é€‰è®¾ç½®å•é€‰çš„å‰ææ˜¯å¿…é¡»å…ˆå–æ¶ˆçˆ¶å­å…³è”ï¼Œç„¶åŽåœ¨coreé‡Œæ·»åŠ ï¼š12345678910$('#deptTree').jstree(&#123; "core": &#123; 'data': data.children, 'multiple': false // å–æ¶ˆå¤šé€‰ &#125;, "plugins" : [ "checkbox" ], "checkbox": &#123; "three_state": false // å–æ¶ˆé€‰æ‹©çˆ¶èŠ‚ç‚¹åŽé€‰ä¸­æ‰€æœ‰å­èŠ‚ç‚¹ &#125;,&#125;);æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼š$("#deptTree6").jstree({core:{data:[{id:"1",icon:null,url:null,text:"å¼€å‘éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"3",icon:null,url:null,text:"å¼€å‘äºŒéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"1",hasParent:!0,hasChildren:!1},{id:"2",icon:null,url:null,text:"å¼€å‘ä¸€éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"7",icon:null,url:null,text:"ä¸€éƒ¨åˆ†éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"2",hasParent:!0,hasChildren:!1}],parentId:"1",hasParent:!0,hasChildren:!0}],parentId:"0",hasParent:!1,hasChildren:!0},{id:"5",icon:null,url:null,text:"äººäº‹éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"4",icon:null,url:null,text:"å¸‚åœºéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"6",icon:null,url:null,text:"æµ‹è¯•éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1}],multiple:!1},plugins:["checkbox"],checkbox:{three_state:!1}})å…¨éƒ¨å±•å¼€å¦‚æžœéœ€è¦åˆå§‹åŒ–æŽ§ä»¶çš„æ—¶å€™å±•å¼€æ ‘ï¼Œå¯è°ƒç”¨jsTreeçš„open_all()æ–¹æ³•ï¼š12345678$('#deptTree').jstree(&#123; "core": &#123; 'data': data.children &#125;, "plugins" : [ "checkbox" ]&#125;).on("loaded.jstree", function (event, data) &#123; $('#deptTree').jstree().open_all();&#125;);æˆ–è€…è®¾ç½®stateï¼š123456789$('#deptTree').jstree(&#123; "core": &#123; 'data': data.children &#125;, "plugins" : [ "checkbox", "state" ], 'state': &#123; "opened": true, &#125;&#125;);æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼š$("#deptTree7").jstree({core:{state:{opened:!0},data:[{id:"1",icon:null,url:null,text:"å¼€å‘éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"3",icon:null,url:null,text:"å¼€å‘äºŒéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"1",hasParent:!0,hasChildren:!1},{id:"2",icon:null,url:null,text:"å¼€å‘ä¸€éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"7",icon:null,url:null,text:"ä¸€éƒ¨åˆ†éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"2",hasParent:!0,hasChildren:!1}],parentId:"1",hasParent:!0,hasChildren:!0}],parentId:"0",hasParent:!1,hasChildren:!0},{id:"5",icon:null,url:null,text:"äººäº‹éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"4",icon:null,url:null,text:"å¸‚åœºéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"6",icon:null,url:null,text:"æµ‹è¯•éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1}]},plugins:["checkbox"]}).on("loaded.jstree",function(e,l){$("#deptTree7").jstree().open_all()})é»˜è®¤é€‰ä¸­jsTreeå¯ä»¥åœ¨åˆå§‹åŒ–åŽé»˜è®¤é€‰ä¸­æŸäº›èŠ‚ç‚¹ï¼š12345678910111213$('#deptTree').jstree(&#123; "core": &#123; 'data': data.children &#125;, "plugins" : [ "checkbox" ], "checkbox": &#123; "three_state": false &#125;,&#125;).on("loaded.jstree", function (event, data) &#123; $('#deptTree').jstree().open_all(); $('#deptTree').jstree('select_node', [5, 7], true); console.log($('#deptTree').jstree(true).get_selected()); // ["5", "7"]&#125;);æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼š$("#deptTree8").jstree({core:{data:[{id:"1",icon:null,url:null,text:"å¼€å‘éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"3",icon:null,url:null,text:"å¼€å‘äºŒéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"1",hasParent:!0,hasChildren:!1},{id:"2",icon:null,url:null,text:"å¼€å‘ä¸€éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"7",icon:null,url:null,text:"ä¸€éƒ¨åˆ†éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"2",hasParent:!0,hasChildren:!1}],parentId:"1",hasParent:!0,hasChildren:!0}],parentId:"0",hasParent:!1,hasChildren:!0},{id:"5",icon:null,url:null,text:"äººäº‹éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"4",icon:null,url:null,text:"å¸‚åœºéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"6",icon:null,url:null,text:"æµ‹è¯•éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1}]},plugins:["checkbox"],checkbox:{three_state:!1}}).on("loaded.jstree",function(e,l){$("#deptTree8").jstree().open_all(),$("#deptTree8").jstree("select_node",[5,7],!0)})ç»‘å®šé€‰å–ç›‘å¬jsTreeå¯ä»¥åœ¨é€‰ä¸­å’Œå–æ¶ˆé€‰ä¸­çš„æ—¶å€™ç»‘å®šç›‘å¬äº‹ä»¶ï¼š123456789$('#deptTree').jstree(&#123; "core": &#123; 'data': data.children &#125;, "plugins" : [ "checkbox" ]&#125;).on("changed.jstree", function (e, data) &#123; console.log(data.changed.selected); // newly selected console.log(data.changed.deselected); // newly deselected&#125;);æ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼š$("#deptTree9").jstree({core:{data:[{id:"1",icon:null,url:null,text:"å¼€å‘éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"3",icon:null,url:null,text:"å¼€å‘äºŒéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"1",hasParent:!0,hasChildren:!1},{id:"2",icon:null,url:null,text:"å¼€å‘ä¸€éƒ¨",state:null,checked:!1,attributes:null,children:[{id:"7",icon:null,url:null,text:"ä¸€éƒ¨åˆ†éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"2",hasParent:!0,hasChildren:!1}],parentId:"1",hasParent:!0,hasChildren:!0}],parentId:"0",hasParent:!1,hasChildren:!0},{id:"5",icon:null,url:null,text:"äººäº‹éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"4",icon:null,url:null,text:"å¸‚åœºéƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1},{id:"6",icon:null,url:null,text:"æµ‹è¯•éƒ¨",state:null,checked:!1,attributes:null,children:[],parentId:"0",hasParent:!1,hasChildren:!1}]},plugins:["checkbox","changed"],checkbox:{three_state:!1}}).on("loaded.jstree",function(e,l){$("#deptTree9").jstree().open_all()}).on("changed.jstree",function(e,l){l.changed.selected.length&&alert("é€‰ä¸­èŠ‚ç‚¹IDï¼š"+l.changed.selected),l.changed.deselected.length&&alert("å–æ¶ˆé€‰ä¸­èŠ‚ç‚¹IDï¼š"+l.changed.deselected)})é™„å½•å…¶ä»–æ–¹æ³•å’Œå±žæ€§å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼ˆå®˜æ–¹æ–‡æ¡£å†™çš„æ¯”è¾ƒæŠ½è±¡=ã€‚=ï¼‰ï¼šhttps://www.jstree.com/api/ã€‚æºç é“¾æŽ¥ï¼šhttps://drive.google.com/open?id=17rdibWmH9CunPP9vs9sQrJPj5FefzoHj]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQuery Validateè¡¨å•æ ¡éªŒæ’ä»¶]]></title>
    <url>%2FjQuery-Validate.html</url>
    <content type="text"><![CDATA[jQuery Validate æ’ä»¶ä¸ºè¡¨å•æä¾›äº†å¼ºå¤§çš„éªŒè¯åŠŸèƒ½ï¼Œè®©å®¢æˆ·ç«¯è¡¨å•éªŒè¯å˜å¾—æ›´ç®€å•ï¼ŒåŒæ—¶æä¾›äº†å¤§é‡çš„å®šåˆ¶é€‰é¡¹ï¼Œæ»¡è¶³åº”ç”¨ç¨‹åºå„ç§éœ€æ±‚ã€‚è¯¥æ’ä»¶æ†ç»‘äº†ä¸€å¥—æœ‰ç”¨çš„éªŒè¯æ–¹æ³•ï¼ŒåŒ…æ‹¬ URL å’Œç”µå­é‚®ä»¶éªŒè¯ï¼ŒåŒæ—¶æä¾›äº†ä¸€ä¸ªç”¨æ¥ç¼–å†™ç”¨æˆ·è‡ªå®šä¹‰æ–¹æ³•çš„ APIã€‚å®˜ç½‘åœ°å€ä¸ºï¼šhttps://jqueryvalidation.org/ã€‚å¼•å…¥ä¾èµ–å¼•å…¥Bootstrapï¼ˆjQuery Validateå¹¶ä¸ä¾èµ–äºŽBootstapï¼Œè¿™é‡Œå¼•å…¥Bootstrapæ˜¯ä¸ºäº†ç”¨äºŽæž„å»ºè¡¨å•ï¼‰ï¼š1234567&lt;link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css"&gt;&lt;!-- jQuery --&gt;&lt;script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-2.0.0.min.js"&gt;&lt;/script&gt;&lt;!-- popper --&gt;&lt;script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js"&gt;&lt;/script&gt;&lt;!-- bootstrap --&gt;&lt;script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js"&gt;&lt;/script&gt;å¼•å…¥jQuery Validateä¾èµ–ï¼š1234&lt;!-- jquery-validate --&gt;&lt;script src="https://cdn.bootcss.com/jquery-validate/1.17.0/jquery.validate.js"&gt;&lt;/script&gt;&lt;script src="https://cdn.bootcss.com/jquery-validate/1.17.0/additional-methods.js"&gt;&lt;/script&gt;&lt;script src="https://cdn.bootcss.com/jquery-validate/1.17.0/localization/messages_zh.js"&gt;&lt;/script&gt;jquery.validate.jsä¸ºæ ¸å¿ƒä»£ç ï¼›additional-methods.jsä¸ºæ‰©å±•çš„æ ¡éªŒæ–¹æ³•ï¼Œä¸€èˆ¬æˆ‘ä»¬è‡ªå®šä¹‰çš„æ ¡éªŒæ–¹æ³•éƒ½æ”¾åˆ°è¿™ä¸ªæ–‡ä»¶é‡Œï¼›messages_zh.jsä¸ºä¸­æ–‡æ±‰åŒ–åŒ…ã€‚é»˜è®¤æ ¡éªŒè§„åˆ™jquery.validate.jsä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç³»åˆ—çš„é»˜è®¤æ ¡éªŒè§„åˆ™ï¼šåºå·è§„åˆ™æè¿°1required:trueå¿…é¡»è¾“å…¥çš„å­—æ®µã€‚2remote:â€check.phpâ€ä½¿ç”¨ ajax æ–¹æ³•è°ƒç”¨ check.php éªŒè¯è¾“å…¥å€¼ã€‚3email:trueå¿…é¡»è¾“å…¥æ­£ç¡®æ ¼å¼çš„ç”µå­é‚®ä»¶ã€‚4url:trueå¿…é¡»è¾“å…¥æ­£ç¡®æ ¼å¼çš„ç½‘å€ã€‚5date:trueå¿…é¡»è¾“å…¥æ­£ç¡®æ ¼å¼çš„æ—¥æœŸã€‚æ—¥æœŸæ ¡éªŒ ie6 å‡ºé”™ï¼Œæ…Žç”¨ã€‚6dateISO:trueå¿…é¡»è¾“å…¥æ­£ç¡®æ ¼å¼çš„æ—¥æœŸï¼ˆISOï¼‰ï¼Œä¾‹å¦‚ï¼š2009-06-23ï¼Œ1998/01/22ã€‚åªéªŒè¯æ ¼å¼ï¼Œä¸éªŒè¯æœ‰æ•ˆæ€§ã€‚7number:trueå¿…é¡»è¾“å…¥åˆæ³•çš„æ•°å­—ï¼ˆè´Ÿæ•°ï¼Œå°æ•°ï¼‰ã€‚8digits:trueå¿…é¡»è¾“å…¥æ•´æ•°ã€‚9creditcard:å¿…é¡»è¾“å…¥åˆæ³•çš„ä¿¡ç”¨å¡å·ã€‚10equalTo:â€#fieldâ€è¾“å…¥å€¼å¿…é¡»å’Œ #field ç›¸åŒã€‚11accept:è¾“å…¥æ‹¥æœ‰åˆæ³•åŽç¼€åçš„å­—ç¬¦ä¸²ï¼ˆä¸Šä¼ æ–‡ä»¶çš„åŽç¼€ï¼‰ã€‚12maxlength:5è¾“å…¥é•¿åº¦æœ€å¤šæ˜¯ 5 çš„å­—ç¬¦ä¸²ï¼ˆæ±‰å­—ç®—ä¸€ä¸ªå­—ç¬¦ï¼‰ã€‚å½“ä¸ºcheckboxæ—¶ï¼ŒæŒ‡é€‰ä¸­ä¸ªæ•°ã€‚13minlength:10è¾“å…¥é•¿åº¦æœ€å°æ˜¯ 10 çš„å­—ç¬¦ä¸²ï¼ˆæ±‰å­—ç®—ä¸€ä¸ªå­—ç¬¦ï¼‰ã€‚å½“ä¸ºcheckboxæ—¶ï¼ŒæŒ‡é€‰ä¸­ä¸ªæ•°ã€‚14rangelength:[5,10]è¾“å…¥é•¿åº¦å¿…é¡»ä»‹äºŽ 5 å’Œ 10 ä¹‹é—´çš„å­—ç¬¦ä¸²ï¼ˆæ±‰å­—ç®—ä¸€ä¸ªå­—ç¬¦ï¼‰ã€‚å½“ä¸ºcheckboxæ—¶ï¼ŒæŒ‡é€‰ä¸­ä¸ªæ•°ã€‚15range:[5,10]è¾“å…¥å€¼å¿…é¡»ä»‹äºŽ 5 å’Œ 10 ä¹‹é—´ã€‚16max:5è¾“å…¥å€¼ä¸èƒ½å¤§äºŽ 5ã€‚17min:10è¾“å…¥å€¼ä¸èƒ½å°äºŽ 10ã€‚é»˜è®¤çš„æç¤ºï¼ˆmessages_zh.jsï¼‰ï¼š12345678910111213141516171819$.extend($.validator.messages, &#123; required: "è¿™æ˜¯å¿…å¡«å­—æ®µ", remote: "è¯·ä¿®æ­£æ­¤å­—æ®µ", email: "è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ä»¶åœ°å€", url: "è¯·è¾“å…¥æœ‰æ•ˆçš„ç½‘å€", date: "è¯·è¾“å…¥æœ‰æ•ˆçš„æ—¥æœŸ", dateISO: "è¯·è¾“å…¥æœ‰æ•ˆçš„æ—¥æœŸ (YYYY-MM-DD)", number: "è¯·è¾“å…¥æœ‰æ•ˆçš„æ•°å­—", digits: "åªèƒ½è¾“å…¥æ•°å­—", creditcard: "è¯·è¾“å…¥æœ‰æ•ˆçš„ä¿¡ç”¨å¡å·ç ", equalTo: "ä½ çš„è¾“å…¥ä¸ç›¸åŒ", extension: "è¯·è¾“å…¥æœ‰æ•ˆçš„åŽç¼€", maxlength: $.validator.format("æœ€å¤šå¯ä»¥è¾“å…¥ &#123;0&#125; ä¸ªå­—ç¬¦"), minlength: $.validator.format("æœ€å°‘è¦è¾“å…¥ &#123;0&#125; ä¸ªå­—ç¬¦"), rangelength: $.validator.format("è¯·è¾“å…¥é•¿åº¦åœ¨ &#123;0&#125; åˆ° &#123;1&#125; ä¹‹é—´çš„å­—ç¬¦ä¸²"), range: $.validator.format("è¯·è¾“å…¥èŒƒå›´åœ¨ &#123;0&#125; åˆ° &#123;1&#125; ä¹‹é—´çš„æ•°å€¼"), max: $.validator.format("è¯·è¾“å…¥ä¸å¤§äºŽ &#123;0&#125; çš„æ•°å€¼"), min: $.validator.format("è¯·è¾“å…¥ä¸å°äºŽ &#123;0&#125; çš„æ•°å€¼")&#125;);è‡ªå®šä¹‰æ ¡éªŒé™¤äº†ä½¿ç”¨è‡ªå¸¦çš„æ ¡éªŒæ–¹æ³•å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ·»åŠ è‡ªå·±çš„æ ¡éªŒæ–¹æ³•ï¼Œæ¯”å¦‚æ·»åŠ æ‰‹æœºå·ç æ ¼å¼çš„æ ¡éªŒæ–¹æ³•ï¼š1234jQuery.validator.addMethod("checkPhone", function(value, element, params) &#123; var checkPhone = /^0?(13[0-9]|15[012356789]|17[013678]|18[0-9]|14[57])[0-9]&#123;8&#125;$/; return this.optional(element) || (checkPhone.test(value));&#125;, "è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·");valueå€¼å½“å‰æ ¡éªŒçš„å€¼ï¼Œelementä¸ºæ ¡éªŒçš„å…ƒç´ ï¼Œparamsä¸ºæ ¡éªŒå‚æ•°ã€‚è‡ªå®šä¹‰çš„æ ¡éªŒæ–¹æ³•ä¸€èˆ¬éƒ½æ·»åŠ åˆ°additional-methods.jsã€‚é”™è¯¯ä¿¡æ¯æç¤ºå½“æ ¡éªŒä¸é€šè¿‡æ—¶ï¼Œé»˜è®¤é”™è¯¯ä¿¡æ¯ä¼šæ’å…¥åˆ°æ ¡éªŒå…ƒç´ çš„åŽé¢ï¼Œä½†å½“æ ¡éªŒå…ƒç´ æ˜¯radioæˆ–è€…checkboxçš„æ—¶å€™ï¼Œé”™è¯¯ä¿¡æ¯çš„ä½ç½®éœ€è¦è¿›è¡Œè°ƒæ•´ï¼šè°ƒæ•´æ–¹æ³•ï¼š12345678errorPlacement: function(error, element) &#123; //æŒ‡å®šé”™è¯¯ä¿¡æ¯ä½ç½® if (element.is(':radio') || element.is(':checkbox')) &#123; //å¦‚æžœæ˜¯radioæˆ–checkbox var eid = element.attr('name'); //èŽ·å–å…ƒç´ çš„nameå±žæ€§ error.appendTo(element.parent().parent()); //å°†é”™è¯¯ä¿¡æ¯æ·»åŠ å½“å‰å…ƒç´ çš„çˆ¶å…ƒç´ çš„çˆ¶å…ƒç´ åŽé¢(æ ¹æ®å®žé™…htmlç»“æž„è¿›è¡Œè°ƒæ•´) &#125; else &#123; error.insertAfter(element); &#125;&#125;è°ƒæ•´åŽï¼š åŽç«¯æ ¡éªŒremoteé€‰é¡¹ç”¨äºŽåŽç«¯æ ¡éªŒï¼Œæ¯”å¦‚æ ¡éªŒç”¨æˆ·åçš„å”¯ä¸€æ€§ç­‰ï¼š12345678910remote: &#123; url: "user/checkUserName", type: "get", dataType: "json", data: &#123; username: function() &#123; return $("input[name='username']").val(); &#125; &#125;&#125;åŽç«¯è¿”å›žbooleanç±»åž‹å³å¯ã€‚å®žä¾‹ç¼–å†™ä¸ªformè¡¨å•ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980&lt;form class="form"&gt; &lt;div class="form-group"&gt; &lt;label&gt;ç”¨æˆ·å&lt;/label&gt; &lt;input type="text" class="form-control" name="userName" placeholder="ç”¨æˆ·å"&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label&gt;å¯†ç &lt;/label&gt; &lt;input type="password" class="form-control" name="password" placeholder="å¯†ç "&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label&gt;ç¡®è®¤å¯†ç &lt;/label&gt; &lt;input type="password" class="form-control" name="confirm_password" placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç "&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label&gt;æ‰‹æœºå·&lt;/label&gt; &lt;input type="text" class="form-control" name="phone" placeholder="æ‰‹æœºå·"&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label&gt;é‚®ç®±&lt;/label&gt; &lt;input type="text" class="form-control" name="email" placeholder="é‚®ç®±"&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label&gt;åœ°å€&lt;/label&gt; &lt;select class="form-control" name="address"&gt; &lt;option value=""&gt;- è¯·é€‰æ‹© -&lt;/option&gt; &lt;option value="1"&gt;ç¦å·ž&lt;/option&gt; &lt;option value="2"&gt;åŽ¦é—¨&lt;/option&gt; &lt;option value="3"&gt;é¾™å²©&lt;/option&gt; &lt;/select&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label&gt;çˆ±å¥½&lt;/label&gt; &lt;div class="form-check form-check-inline"&gt; &lt;input class="form-check-input" type="checkbox" name="hobby" value="1"&gt; &lt;label class="form-check-label"&gt;æ¸¸æ³³&lt;/label&gt; &lt;/div&gt; &lt;div class="form-check form-check-inline"&gt; &lt;input class="form-check-input" type="checkbox" name="hobby" value="2"&gt; &lt;label class="form-check-label"&gt;å”±æ­Œ&lt;/label&gt; &lt;/div&gt; &lt;div class="form-check form-check-inline"&gt; &lt;input class="form-check-input" type="checkbox" name="hobby" value="3"&gt; &lt;label class="form-check-label"&gt;ç¡è§‰&lt;/label&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label&gt;æ€§åˆ«&lt;/label&gt; &lt;div class="form-check form-check-inline"&gt; &lt;input class="form-check-input" type="radio" name="sex" value="1"&gt; &lt;label class="form-check-label"&gt;ç”·&lt;/label&gt; &lt;/div&gt; &lt;div class="form-check form-check-inline"&gt; &lt;input class="form-check-input" type="radio" name="sex" value="2"&gt; &lt;label class="form-check-label"&gt;å¥³&lt;/label&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label&gt;ä¸Šä¼ å›¾ç‰‡&lt;/label&gt; &lt;input type="file" class="form-control-file" name="file"&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;div class="form-check form-check-inline"&gt; &lt;input type="checkbox" class="form-check-input" name="subscribe"&gt; &lt;label class="form-check-label"&gt;è®¢é˜…&lt;/label&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label&gt;è®¢é˜…æ–¹å¼&lt;/label&gt; &lt;div class="form-check form-check-inline"&gt; &lt;input class="form-check-input" type="radio" name="stype" value="1"&gt; &lt;label class="form-check-label"&gt;RSS&lt;/label&gt; &lt;/div&gt; &lt;div class="form-check form-check-inline"&gt; &lt;input class="form-check-input" type="radio" name="stype" value="2"&gt; &lt;label class="form-check-label"&gt;é‚®ç®±è®¢é˜…&lt;/label&gt; &lt;/div&gt; &lt;/div&gt;&lt;/form&gt;&lt;button id="submit" class="btn btn-primary"&gt;Submit&lt;/button&gt;&lt;button id="reset" class="btn btn-danger"&gt;Reset&lt;/button&gt;ç»‘å®šæ ¡éªŒè§„åˆ™ç­‰ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111jQuery.validator.addMethod("checkPhone", function(value, element, params) &#123; var checkPhone = /^0?(13[0-9]|15[012356789]|17[013678]|18[0-9]|14[57])[0-9]&#123;8&#125;$/; return this.optional(element) || (checkPhone.test(value));&#125;, "è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·");$(function() &#123; validateRule(); $("#submit").on('click', function() &#123; var validator = $(".form").validate(); var flag = validator.form(); if (flag) &#123; alert("true"); &#125; else &#123; alert("false"); &#125; &#125;); $("#reset").on('click', function() &#123; var validator = $(".form").validate(); validator.resetForm(); &#125;);&#125;);function validateRule() &#123; $(".form").validate(&#123; rules: &#123; userName: &#123; required: true, minlength: 3, maxlength: 10 &#125;, password: &#123; required: true, minlength: 5 &#125;, confirm_password: &#123; required: true, minlength: 5, equalTo: "[name='password']" &#125;, address: &#123; required: true &#125;, phone: &#123; checkPhone: true &#125;, email: &#123; required: true, email: true &#125;, hobby: &#123; required: true, minlength: 2 &#125;, sex: &#123; required: true &#125;, file: &#123; required: true, accept: "image/jpg,image/jpeg,image/png,image/gif" &#125;, stype: &#123; required: "[name='subscribe']:checked" &#125; &#125;, messages: &#123; userName: &#123; required: "è¯·è¾“å…¥ç”¨æˆ·å", minlength: "ç”¨æˆ·åé•¿åº¦ä¸èƒ½å°‘äºŽ&#123;0&#125;ä¸ªå­—ç¬¦", maxlength: "ç”¨æˆ·åé•¿åº¦ä¸èƒ½è¶…è¿‡&#123;0&#125;ä¸ªå­—ç¬¦" &#125;, password: &#123; required: "è¯·è¾“å…¥å¯†ç ", minlength: "å¯†ç é•¿åº¦ä¸èƒ½å°äºŽ&#123;0&#125;ä¸ªå­—æ¯" &#125;, confirm_password: &#123; required: "è¯·è¾“å…¥å¯†ç ", minlength: "å¯†ç é•¿åº¦ä¸èƒ½å°äºŽ&#123;0&#125;ä¸ªå­—æ¯", equalTo: "ä¸¤æ¬¡å¯†ç è¾“å…¥ä¸ä¸€è‡´" &#125;, address: &#123; required: "è¯·é€‰æ‹©åœ°å€" &#125;, email: &#123; required: "è¯·è¾“å…¥é‚®ç®±", email: "é‚®ç®±æ ¼å¼ä¸æ­£ç¡®" &#125;, hobby: &#123; required: "è¯·é€‰æ‹©çˆ±å¥½", minlength: "è‡³å°‘é€‰æ‹©&#123;0&#125;é¡¹çˆ±å¥½" &#125;, sex: &#123; required: "è¯·é€‰æ‹©æ€§åˆ«" &#125;, file: &#123; required: "è¯·ä¸Šä¼ é™„ä»¶", accept: "åªæ”¯æŒjpgï¼Œjpegï¼Œpngæˆ–gifåŽç¼€çš„å›¾ç‰‡" &#125;, stype: &#123; required: "è¯·é€‰æ‹©è®¢é˜…æ–¹å¼" &#125; &#125;, errorPlacement: function(error, element) &#123; if (element.is(':radio') || element.is(':checkbox')) &#123; var eid = element.attr('name'); error.appendTo(element.parent().parent()); &#125; else &#123; error.insertAfter(element); &#125; &#125; &#125;);&#125;è¿™é‡Œæä¸‹å…³äºŽé™„ä»¶çš„æ ¼å¼é—®é¢˜ï¼Œå…¶é™å®šçš„ä¸æ˜¯æ–‡ä»¶æ ¼å¼åŽç¼€ï¼Œè€Œæ˜¯æ–‡ä»¶çš„MIMEç±»åž‹ï¼Œå…·ä½“å¯å‚è€ƒï¼šBootstrapValidatoræŒ‡å—ä¸­åˆ—ä¸¾çš„MIMEç±»åž‹ã€‚æ¼”ç¤ºæ•ˆæžœå¦‚ä¸‹ï¼šSee the Pen jquery-validation by wuyouzhuguli (@mrbird) on CodePen.æºç åœ°å€ï¼šhttps://drive.google.com/open?id=1lyUVNyX5VkxN3GqQz0_y_oBX3twMxPAhå…¶ä»–ä½¿ç”¨äº‹é¡¹å¯å‚è€ƒï¼šhttp://www.runoob.com/jquery/jquery-plugin-validate.htmlhttps://jqueryvalidation.org/documentation/]]></content>
      <tags>
        <tag>Bootstrap</tag>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ ‘å½¢è¡¨æ ¼æ’ä»¶jQuery TreeGrid]]></title>
    <url>%2FjQuery-TreeGrid.html</url>
    <content type="text"><![CDATA[å€ŸåŠ©æ ‘å½¢è¡¨æ ¼æ’ä»¶jQuery TreeGridï¼Œæˆ‘ä»¬å¯ä»¥ä»¥è¡¨æ ¼çš„å½¢å¼æ¥å±•çŽ°é‚£äº›å¸¦æœ‰å±‚çº§å…³ç³»çš„æ•°æ®ï¼Œæ¯”å¦‚éƒ¨é—¨ä¸Šä¸‹çº§ï¼Œèœå•è¡¨ç­‰ã€‚jQuery TreeGridçš„å®˜æ–¹åœ°å€ä¸ºï¼šhttp://maxazan.github.io/jquery-treegrid/ã€‚ç”±äºŽè¿™é‡Œçš„ä½¿ç”¨çŽ¯å¢ƒä¸ºbootstrapï¼ŒåŽŸå§‹çš„jQuery TreeGridæ’ä»¶æ˜¾å¾—ä¸æ˜¯é‚£ä¹ˆçš„çµæ´»å’Œç¾Žè§‚ï¼Œä¸ºäº†åœ¨bootstrapä¸­æ— ç¼çš„ä½¿ç”¨è¯¥æ’ä»¶ï¼Œè¿™é‡Œå¼•ç”¨äº†ç»è¿‡äºŒæ¬¡å°è£…çš„jQuery TreeGridæ’ä»¶jquery.treegrid.extension.jsï¼Œä½œè€…ä¸ºï¼šhttp://www.cnblogs.com/landeanfen/p/6776152.htmlã€‚å¼•å…¥ä¾èµ–é¦–å…ˆå…ˆå¼•å…¥bootstrapç›¸å…³çš„ä¾èµ–ï¼š1234&lt;link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css"&gt;&lt;script src="http://code.jquery.com/jquery-2.0.0.min.js"&gt;&lt;/script&gt;&lt;script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js"&gt;&lt;/script&gt;&lt;script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js"&gt;&lt;/script&gt;ç„¶åŽå¼•å…¥jQuery TreeGridä¾èµ–ä»¥åŠjquery.treegrid.extension.js ï¼š12345&lt;!-- jquery.treegrid --&gt;&lt;link rel="stylesheet" data-th-href="@&#123;css/jqTreeGrid/jquery.treegrid.css&#125;"&gt;&lt;script data-th-src="@&#123;js/jqTreeGrid/jquery.treegrid.js&#125;"&gt;&lt;/script&gt;&lt;!-- jquery.treegrid.extension --&gt;&lt;script data-th-src="@&#123;js/jqTreeGrid/jquery.treegrid.extension.js&#125;"&gt;&lt;/script&gt;å› ä¸ºbootstrapæ²¡æœ‰è‡ªå¸¦å›¾æ ‡ç»„ä»¶ï¼Œä¸ºäº†ä¸‹æ–‡çš„ä½¿ç”¨ï¼Œè¿™é‡Œå¼•å…¥font-awesome:1&lt;link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet"&gt;æ•°æ®ä½¿ç”¨çš„æ•°æ®è¡¨ï¼š12345678910111213141516171819202122-- ------------------------------ Table structure for T_DEPT-- ----------------------------DROP TABLE "MRBIRD"."T_DEPT";CREATE TABLE "MRBIRD"."T_DEPT" ("DEPT_ID" NUMBER NOT NULL ,"PARENT_ID" NUMBER NOT NULL ,"DEPT_NAME" VARCHAR2(100 BYTE) NOT NULL ,"ORDER_NUM" NUMBER NULL ,"CREATE_TIME" DATE NULL );-- ------------------------------ Records of T_DEPT-- ----------------------------INSERT INTO "MRBIRD"."T_DEPT" VALUES ('7', '2', 'å¼€å‘ä¸€éƒ¨ç¦å·žåˆ†éƒ¨', null, TO_DATE('2018-03-15 09:32:15', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('1', '0', 'å¼€å‘éƒ¨', null, TO_DATE('2018-01-04 15:42:26', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('3', '1', 'å¼€å‘äºŒéƒ¨', null, TO_DATE('2018-01-04 15:42:29', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('5', '0', 'äººäº‹éƒ¨', null, TO_DATE('2018-01-04 15:42:32', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('2', '1', 'å¼€å‘ä¸€éƒ¨', null, TO_DATE('2018-01-04 15:42:34', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('4', '0', 'å¸‚åœºéƒ¨', null, TO_DATE('2018-01-04 15:42:36', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_DEPT" VALUES ('6', '0', 'æµ‹è¯•éƒ¨', null, TO_DATE('2018-01-04 15:42:38', 'YYYY-MM-DD HH24:MI:SS'));åŽç«¯æ¡†æž¶ä¸ºSpring Boot + MyBatisï¼ˆé€šç”¨mapperå’Œpagehelperæ’ä»¶ï¼‰ï¼ŒèŽ·å–æ•°æ®çš„å…·ä½“ç»†èŠ‚è¿™é‡Œä¸å†æè¿°ï¼Œå¯å‚è€ƒæ–‡æœ«çš„æºç ã€‚ä½¿ç”¨ç¼–å†™ä¸€ä¸ªç®€å•çš„é¡µé¢ï¼š1234567891011121314151617&lt;form class="form"&gt; &lt;div class="row"&gt; &lt;div class="col"&gt; &lt;div class="input-group"&gt; &lt;span class="input-group-addon"&gt;éƒ¨é—¨åç§°ï¼š&lt;/span&gt; &lt;div class="form-group"&gt; &lt;input type="text" name="deptName" class="form-control"&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="col"&gt; &lt;button type="button" class="btn btn-success" onclick="refresh()"&gt;é‡ç½®&lt;/button&gt; &lt;button type="button" class="btn btn-primary" onclick="search()"&gt;æœç´¢&lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/form&gt;&lt;table id="deptTreeTable" data-mobile-responsive="true" class="mb-bootstrap-table text-nowrap"&gt;&lt;/table&gt;jQuery TreeGridæ’ä»¶çš„ä½¿ç”¨ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354var ctx = [[@&#123;/&#125;]];$(function() &#123; initDeptTreeTable();&#125;);function initDeptTreeTable() &#123; $('#deptTreeTable').bootstrapTreeTable(&#123; id: 'deptId', // é€‰å–è®°å½•è¿”å›žçš„å€¼ code: 'deptId', // ç”¨äºŽè®¾ç½®çˆ¶å­å…³ç³» parentCode: 'parentId', // ç”¨äºŽè®¾ç½®çˆ¶å­å…³ç³» rootCodeValue: null, //è®¾ç½®æ ¹èŠ‚ç‚¹codeå€¼----å¯æŒ‡å®šæ ¹èŠ‚ç‚¹ï¼Œé»˜è®¤ä¸ºnull,"",0,"0" data: [], // æž„é€ tableçš„æ•°æ®é›†åˆï¼Œå¦‚æžœæ˜¯ajaxè¯·æ±‚åˆ™ä¸å¿…å¡«å†™ type: "GET", // è¯·æ±‚æ•°æ®çš„ajaxç±»åž‹ url: ctx + 'dept/list', // è¯·æ±‚æ•°æ®çš„ajaxçš„url ajaxParams: &#123; deptName: $(".form").find("input[name='deptName']").val().trim() &#125;, // è¯·æ±‚æ•°æ®çš„ajaxçš„dataå±žæ€§ expandColumn: 2, // åœ¨å“ªä¸€åˆ—ä¸Šé¢æ˜¾ç¤ºå±•å¼€æŒ‰é’® expandAll: true, // æ˜¯å¦å…¨éƒ¨å±•å¼€ striped: true, // æ˜¯å¦å„è¡Œæ¸å˜è‰² columns: [&#123; field: 'selectItem', checkbox: true &#125;, &#123; title: 'ç¼–å·', field: 'deptId', width: '50px' &#125;, &#123; title: 'åç§°', field: 'deptName' &#125;, &#123; title: 'åˆ›å»ºæ—¶é—´', field: 'createTime' &#125; ], // è®¾ç½®åˆ— toolbar: null, //é¡¶éƒ¨å·¥å…·æ¡ height: 0, expanderExpandedClass: 'fa fa-chevron-down', // å±•å¼€çš„æŒ‰é’®çš„å›¾æ ‡ expanderCollapsedClass: 'fa fa-chevron-up' // ç¼©èµ·çš„æŒ‰é’®çš„å›¾æ ‡ &#125;);&#125;// æœç´¢æ–¹æ³•function search() &#123; initDeptTreeTable();&#125;// é‡ç½®æ–¹æ³•function refresh() &#123; $(".form")[0].reset(); search();&#125;å‚æ•°è¯´æ˜Žå¦‚æ³¨è§£æ‰€ç¤ºï¼Œå…¶ä¸­expanderExpandedClasså’ŒexpanderCollapsedClassä¸ºå±•å¼€å’Œç¼©èµ·çš„å›¾æ ‡ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯æ–‡ç« å¼€å§‹å¼•å…¥çš„font-awesomeã€‚åŽç«¯è¿”å›žçš„JSONæ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243[&#123; "deptId": 1, "parentId": 0, "deptName": "å¼€å‘éƒ¨", "orderNum": null, "createTime": 1515051746000&#125;, &#123; "deptId": 2, "parentId": 1, "deptName": "å¼€å‘ä¸€éƒ¨", "orderNum": null, "createTime": 1515051754000&#125;, &#123; "deptId": 3, "parentId": 1, "deptName": "å¼€å‘äºŒéƒ¨", "orderNum": null, "createTime": 1515051749000&#125;, &#123; "deptId": 4, "parentId": 0, "deptName": "å¸‚åœºéƒ¨", "orderNum": null, "createTime": 1515051756000&#125;, &#123; "deptId": 5, "parentId": 0, "deptName": "äººäº‹éƒ¨", "orderNum": null, "createTime": 1515051752000&#125;, &#123; "deptId": 6, "parentId": 0, "deptName": "æµ‹è¯•éƒ¨", "orderNum": null, "createTime": 1515051758000&#125;, &#123; "deptId": 7, "parentId": 2, "deptName": "å¼€å‘ä¸€éƒ¨ç¦å·žåˆ†éƒ¨", "orderNum": null, "createTime": 1521077535000&#125;]é¡µé¢æ˜¾ç¤ºæ•ˆæžœå¦‚ä¸‹ï¼š å…¶å®žï¼Œåœ¨å®žé™…ä½¿ç”¨ä¸­æˆ‘ä»¬å¹¶ä¸éœ€è¦é…ç½®é‚£ä¹ˆå¤šå‚æ•°ï¼ŒæŸ¥çœ‹jquery.treegrid.extension.jsæºç å¯å‘çŽ°ï¼Œå…¶é»˜è®¤å‚æ•°ä¸ºï¼š12345678910111213141516171819$.fn.bootstrapTreeTable.defaults = &#123; id: 'menuId', code: 'menuId', parentCode: 'parentId', rootCodeValue: null, data: [], type: "GET", url: null, ajaxParams: &#123;&#125;, expandColumn: null, expandAll: true, striped: false, columns: [], toolbar: null, height: 0, expanderExpandedClass: 'fa fa-chevron-down', expanderCollapsedClass: 'fa fa-chevron-up'&#125;;æ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™åªéœ€é…ç½®å‡ ä¸ªæˆ‘ä»¬å…³æ³¨çš„å‚æ•°å³å¯ï¼š1234567891011121314151617181920212223242526272829$('#deptTreeTable').bootstrapTreeTable(&#123; id: 'deptId', code: 'deptId', parentCode: 'parentId', url: ctx + 'dept/list', ajaxParams: &#123; deptName: $(".form").find("input[name='deptName']").val().trim() &#125;, expandColumn: 2, striped: true, columns: [&#123; field: 'selectItem', checkbox: true &#125;, &#123; title: 'ç¼–å·', field: 'deptId', width: '50px' &#125;, &#123; title: 'åç§°', field: 'deptName' &#125;, &#123; title: 'åˆ›å»ºæ—¶é—´', field: 'createTime' &#125; ]&#125;);jquery.treegrid.extension.jsè¿˜å°è£…äº†ä¸€äº›æ–¹æ³•ï¼š12345678910111213141516171819202122232425262728293031$.fn.bootstrapTreeTable.methods = &#123; // è¿”å›žé€‰ä¸­è®°å½•çš„idï¼ˆè¿”å›žçš„idç”±é…ç½®ä¸­çš„idå±žæ€§æŒ‡å®šï¼‰ // ä¸ºäº†å…¼å®¹bootstrap-tableçš„å†™æ³•ï¼Œç»Ÿä¸€è¿”å›žæ•°ç»„ï¼Œè¿™é‡Œåªè¿”å›žäº†æŒ‡å®šçš„id getSelections: function(target, data) &#123; // æ‰€æœ‰è¢«é€‰ä¸­çš„è®°å½•input var _ipt = target.find("tbody").find("tr").find("input[name='select_item']:checked"); var chk_value = []; // å¦‚æžœæ˜¯radio if (_ipt.attr("type") == "radio") &#123; chk_value.push(&#123; id: _ipt.val() &#125;); &#125; else &#123; _ipt.each(function(_i, _item) &#123; chk_value.push(&#123; id: $(_item).val() &#125;); &#125;); &#125; return chk_value; &#125;, // åˆ·æ–°è®°å½• refresh: function(target, parms) &#123; if (parms) &#123; target.load(parms); &#125; else &#123; target.load(); &#125; &#125;, // é‡ç½®è¡¨æ ¼è§†å›¾ resetHeight: function(target, height) &#123; target.find("tbody").css("height", height + 'px'); &#125; // ç»„ä»¶çš„å…¶ä»–æ–¹æ³•ä¹Ÿå¯ä»¥è¿›è¡Œç±»ä¼¼å°è£…........&#125;;æ¯”å¦‚èŽ·å–é€‰ä¸­è¡Œçš„æ•°æ®å¯ä½¿ç”¨getSelectionsï¼š1$("#deptTreeTable").bootstrapTreeTable("getSelections");é™„å½•æºç é“¾æŽ¥ï¼šhttps://drive.google.com/open?id=1fgYRpD5CNCn4gj06_MiLm-g2fCjsSYtk]]></content>
      <tags>
        <tag>Bootstrap</tag>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Bootstrap Tableå­¦ä¹ æŒ‡å—]]></title>
    <url>%2FBootstrap-Table%20guide.html</url>
    <content type="text"><![CDATA[Bootstrap Tableæ˜¯ä¸€æ¬¾åŸºäºŽBootstrapçš„jQueryè¡¨æ ¼æ’ä»¶ï¼Œé€šè¿‡ç®€å•çš„è®¾ç½®ï¼Œå°±å¯ä»¥æ‹¥æœ‰å¼ºå¤§çš„å•é€‰ã€å¤šé€‰ã€æŽ’åºã€åˆ†é¡µï¼Œä»¥åŠç¼–è¾‘ã€å¯¼å‡ºã€è¿‡æ»¤ã€æ‰©å±•ç­‰ç­‰çš„åŠŸèƒ½ã€‚ä½œè€…åœ°å€ï¼šhttps://github.com/wenzhixin/bootstrap-tableã€‚è¿™é‡Œç®€å•ä»‹ç»ä¸‹ä½¿ç”¨æ–¹æ³•ä»¥åŠå¯¹å…¶è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œæ–¹ä¾¿æ—¥å¸¸å¼€å‘ä½¿ç”¨ã€‚å‡†å¤‡å·¥ä½œå› ä¸ºåŸºäºŽBootstrapï¼Œæ‰€ä»¥å…ˆå¼•å…¥Bootstrapä¾èµ–ï¼š1234&lt;link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css"&gt;&lt;script src="http://code.jquery.com/jquery-2.0.0.min.js"&gt;&lt;/script&gt;&lt;script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js"&gt;&lt;/script&gt;&lt;script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js"&gt;&lt;/script&gt;ç„¶åŽå¼•å…¥Bootstrap Tableä¾èµ–ï¼š123456&lt;!-- Latest compiled and minified CSS --&gt;&lt;link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.9.0/bootstrap-table.min.css"&gt;&lt;!-- Latest compiled and minified JavaScript --&gt;&lt;script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.9.0/bootstrap-table.min.js"&gt;&lt;/script&gt;&lt;!-- Latest compiled and minified Locales --&gt;&lt;script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.9.0/locale/bootstrap-table-zh-CN.min.js"&gt;&lt;/script&gt;æ•°æ®å‡†å¤‡æœ¬ä¾‹ä¸­ä½¿ç”¨åˆ°çš„æ•°æ®è¡¨SQLå¦‚ä¸‹ï¼š123456789101112131415161718192021222324-- ------------------------------ Table structure for T_ROLE-- ----------------------------DROP TABLE "MRBIRD"."T_ROLE";CREATE TABLE "MRBIRD"."T_ROLE" ("ROLE_ID" NUMBER NOT NULL ,"ROLE_NAME" VARCHAR2(100 BYTE) NOT NULL ,"REMARK" VARCHAR2(100 BYTE) NULL ,"CREATE_TIME" DATE NOT NULL ,"MODIFY_TIME" DATE NULL );-- ------------------------------ Records of T_ROLE-- ----------------------------INSERT INTO "MRBIRD"."T_ROLE" VALUES ('23', 'ç”¨æˆ·ç®¡ç†å‘˜', 'è´Ÿè´£ç”¨æˆ·çš„å¢žåˆ æ”¹æ“ä½œ', TO_DATE('2018-01-09 15:32:41', 'YYYY-MM-DD HH24:MI:SS'), null);INSERT INTO "MRBIRD"."T_ROLE" VALUES ('1', 'ç®¡ç†å‘˜', 'ç®¡ç†å‘˜', TO_DATE('2017-12-27 16:23:11', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('2018-02-24 16:01:45', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_ROLE" VALUES ('2', 'æµ‹è¯•è´¦å·', 'æµ‹è¯•è´¦å·', TO_DATE('2017-12-27 16:25:09', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('2018-01-23 09:11:11', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_ROLE" VALUES ('3', 'æ³¨å†Œè´¦æˆ·', 'æ³¨å†Œè´¦æˆ·ï¼Œåªå¯æŸ¥çœ‹ï¼Œä¸å¯æ“ä½œ', TO_DATE('2017-12-29 16:00:15', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('2018-02-24 17:33:45', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_ROLE" VALUES ('24', 'ç³»ç»Ÿç›‘æŽ§å‘˜', 'å¯æŸ¥çœ‹ç³»ç»Ÿç›‘æŽ§ä¿¡æ¯ï¼Œä½†ä¸å¯æ“ä½œ', TO_DATE('2018-01-09 15:52:01', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('2018-03-07 19:05:33', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_ROLE" VALUES ('25', 'ç”¨æˆ·æŸ¥çœ‹', 'æŸ¥çœ‹ç”¨æˆ·ï¼Œæ— ç›¸åº”æ“ä½œæƒé™', TO_DATE('2018-01-09 15:56:30', 'YYYY-MM-DD HH24:MI:SS'), null);INSERT INTO "MRBIRD"."T_ROLE" VALUES ('63', 'å½±é™¢å·¥ä½œè€…', 'å¯æŸ¥çœ‹å½±è§†ä¿¡æ¯', TO_DATE('2018-02-06 08:48:28', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('2018-03-07 19:05:26', 'YYYY-MM-DD HH24:MI:SS'));INSERT INTO "MRBIRD"."T_ROLE" VALUES ('64', 'å¤©æ°”é¢„æŠ¥å‘˜', 'å¯æŸ¥çœ‹å¤©æ°”é¢„æŠ¥ä¿¡æ¯', TO_DATE('2018-02-27 08:47:04', 'YYYY-MM-DD HH24:MI:SS'), null);INSERT INTO "MRBIRD"."T_ROLE" VALUES ('65', 'æ–‡ç« å®¡æ ¸', 'æ–‡ç« ç±»', TO_DATE('2018-02-27 08:48:01', 'YYYY-MM-DD HH24:MI:SS'), TO_DATE('2018-03-13 11:20:34', 'YYYY-MM-DD HH24:MI:SS'));åŽç«¯æ¡†æž¶ä¸ºSpring Boot + MyBatisï¼ˆé€šç”¨mapperå’Œpagehelperæ’ä»¶ï¼‰ï¼ŒèŽ·å–æ•°æ®çš„å…·ä½“ç»†èŠ‚è¿™é‡Œä¸å†æè¿°ï¼Œå¯å‚è€ƒæ–‡æœ«çš„æºç ã€‚ä½¿ç”¨ç¼–å†™ä¸€ä¸ªç®€å•çš„é¡µé¢ï¼š123456789101112131415161718&lt;form class="form"&gt; &lt;div class="row"&gt; &lt;div class="col"&gt; &lt;div class="input-group"&gt; &lt;span class="input-group-addon"&gt;è§’è‰²ï¼š&lt;/span&gt; &lt;div class="form-group"&gt; &lt;input type="text" name="roleName" class="form-control"&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="col"&gt;&lt;/div&gt; &lt;div class="col"&gt; &lt;button type="button" class="btn btn-success" onclick="refresh()"&gt;é‡ç½®&lt;/button&gt; &lt;button type="button" class="btn btn-primary" onclick="search()"&gt;æœç´¢&lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/form&gt;&lt;table id="roleTable" data-mobile-responsive="true" class="mb-bootstrap-table text-nowrap"&gt;&lt;/table&gt;Bootstrap Tableæ’ä»¶çš„ä½¿ç”¨ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253$('#roleTable').bootstrapTable(&#123; method: 'get', // æœåŠ¡å™¨æ•°æ®çš„è¯·æ±‚æ–¹å¼ get or post url: ctx + "bootstrap-table/list", // æœåŠ¡å™¨æ•°æ®çš„åŠ è½½åœ°å€ striped: true, //æ˜¯å¦æ˜¾ç¤ºè¡Œé—´éš”è‰² cache: false, //æ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼Œé»˜è®¤ä¸ºtrueï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹éœ€è¦è®¾ç½®ä¸€ä¸‹è¿™ä¸ªå±žæ€§ï¼ˆ*ï¼‰ pagination: true, //æ˜¯å¦æ˜¾ç¤ºåˆ†é¡µï¼ˆ*ï¼‰ sortable: false, //æ˜¯å¦å¯ç”¨æŽ’åº sidePagination: "server", //åˆ†é¡µæ–¹å¼ï¼šclientå®¢æˆ·ç«¯åˆ†é¡µï¼ŒserveræœåŠ¡ç«¯åˆ†é¡µï¼ˆ*ï¼‰ pageNumber: 1, //åˆå§‹åŒ–åŠ è½½ç¬¬ä¸€é¡µï¼Œé»˜è®¤ç¬¬ä¸€é¡µ pageSize: 5, //æ¯é¡µçš„è®°å½•è¡Œæ•°ï¼ˆ*ï¼‰ pageList: [5, 25, 50, 100], //å¯ä¾›é€‰æ‹©çš„æ¯é¡µçš„è¡Œæ•°ï¼ˆ*ï¼‰ strictSearch: true, minimumCountColumns: 2, //æœ€å°‘å…è®¸çš„åˆ—æ•° clickToSelect: true, //æ˜¯å¦å¯ç”¨ç‚¹å‡»é€‰ä¸­è¡Œ uniqueId: "ID", //æ¯ä¸€è¡Œçš„å”¯ä¸€æ ‡è¯†ï¼Œä¸€èˆ¬ä¸ºä¸»é”®åˆ— cardView: false, detailView: false, //æ˜¯å¦æ˜¾ç¤ºè¯¦ç»†è§†å›¾ smartDisplay: false, queryParams: function(params) &#123; return &#123; pageSize: params.limit, pageNum: params.offset / params.limit + 1, roleName: $(".form").find("input[name='roleName']").val().trim(), &#125;; &#125;, columns: [&#123; checkbox: true &#125;,&#123; field: 'roleId', title: 'è§’è‰²ID' &#125;,&#123; field: 'roleName', title: 'è§’è‰²' &#125;, &#123; field: 'remark', title: 'æè¿°' &#125;, &#123; field: 'createTime', title: 'åˆ›å»ºæ—¶é—´' &#125;, &#123; field: 'modifyTime', title: 'ä¿®æ”¹æ—¶é—´' &#125;]&#125;);// æœç´¢æ–¹æ³•function search() &#123; $('#roleTable').bootstrapTable('refresh');&#125;// é‡ç½®æ–¹æ³•function refresh() &#123; $(".form")[0].reset(); search();&#125;åŽç«¯è¿”å›žçš„JSONæ•°æ®å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&#123; "total": 9, "rows": [&#123; "roleId": 1, "roleName": "ç®¡ç†å‘˜", "remark": "ç®¡ç†å‘˜", "createTime": 1514362991000, "modifyTime": 1519459305000 &#125;, &#123; "roleId": 2, "roleName": "æµ‹è¯•è´¦å·", "remark": "æµ‹è¯•è´¦å·", "createTime": 1514363109000, "modifyTime": 1516669871000 &#125;, &#123; "roleId": 3, "roleName": "æ³¨å†Œè´¦æˆ·", "remark": "æ³¨å†Œè´¦æˆ·ï¼Œåªå¯æŸ¥çœ‹ï¼Œä¸å¯æ“ä½œ", "createTime": 1514534415000, "modifyTime": 1519464825000 &#125;, &#123; "roleId": 23, "roleName": "ç”¨æˆ·ç®¡ç†å‘˜", "remark": "è´Ÿè´£ç”¨æˆ·çš„å¢žåˆ æ”¹æ“ä½œ", "createTime": 1515483161000, "modifyTime": null &#125;, &#123; "roleId": 24, "roleName": "ç³»ç»Ÿç›‘æŽ§å‘˜", "remark": "å¯æŸ¥çœ‹ç³»ç»Ÿç›‘æŽ§ä¿¡æ¯ï¼Œä½†ä¸å¯æ“ä½œ", "createTime": 1515484321000, "modifyTime": 1520420733000 &#125;, &#123; "roleId": 25, "roleName": "ç”¨æˆ·æŸ¥çœ‹", "remark": "æŸ¥çœ‹ç”¨æˆ·ï¼Œæ— ç›¸åº”æ“ä½œæƒé™", "createTime": 1515484590000, "modifyTime": null &#125;, &#123; "roleId": 63, "roleName": "å½±é™¢å·¥ä½œè€…", "remark": "å¯æŸ¥çœ‹å½±è§†ä¿¡æ¯", "createTime": 1517878108000, "modifyTime": 1520420726000 &#125;, &#123; "roleId": 64, "roleName": "å¤©æ°”é¢„æŠ¥å‘˜", "remark": "å¯æŸ¥çœ‹å¤©æ°”é¢„æŠ¥ä¿¡æ¯", "createTime": 1519692424000, "modifyTime": null &#125;, &#123; "roleId": 65, "roleName": "æ–‡ç« å®¡æ ¸", "remark": "æ–‡ç« ç±»", "createTime": 1519692481000, "modifyTime": 1520911234000 &#125;]&#125;é¡µé¢æ˜¾ç¤ºæ•ˆæžœå¦‚ä¸‹ï¼š äºŒæ¬¡å°è£…å®žé™…ä½¿ç”¨ä¸­é™¤äº†å‡ ä¸ªå¸¸ç”¨çš„å‚æ•°æ¯”å¦‚urlï¼ŒqueryParamsï¼Œcolumnsç­‰ç­‰ä¹‹å¤–ï¼Œå‰©ä¸‹çš„å‚æ•°ä¸€èˆ¬é»˜è®¤å°±å¥½ï¼Œæ‰€ä»¥æŽ¥ä¸‹æ¥å¯¹å…¶è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œä½¿å¾—å¼€å‘ä¸­æ›´ä¸ºæ–¹ä¾¿ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445var $Mrbird = (function() &#123; var bootstrapTable_default = &#123; method: 'get', striped: true, cache: false, pagination: true, sortable: false, sidePagination: "server", pageNumber: 1, pageSize: 5, pageList: [5, 10, 25, 50, 100], strictSearch: true, showColumns: false, minimumCountColumns: 2, clickToSelect: true, uniqueId: "ID", cardView: false, detailView: false, smartDisplay: false, queryParams: function(params) &#123; return &#123; pageSize: params.limit, pageNum: params.offset / params.limit + 1, &#125;; &#125; &#125; function _initTable(id, settings) &#123; var params = $.extend(&#123;&#125;, bootstrapTable_default, settings); if (typeof params.url == 'undefined') &#123; throw 'åˆå§‹åŒ–è¡¨æ ¼å¤±è´¥ï¼Œè¯·é…ç½®urlå‚æ•°ï¼'; &#125; if (typeof params.columns == 'undefined') &#123; throw 'åˆå§‹åŒ–è¡¨æ ¼å¤±è´¥ï¼Œè¯·é…ç½®columnså‚æ•°ï¼'; &#125; $('#' + id).bootstrapTable(params); &#125; return &#123; initTable: function(id, settings) &#123; _initTable(id, settings); &#125;, refreshTable: function(id) &#123; $('#' + id).bootstrapTable('refresh'); &#125; &#125;&#125;)($);è¿™æ ·ï¼Œåœ¨ä½¿ç”¨Bootstap Tableæ’ä»¶çš„æ—¶å€™åªéœ€è¦åƒä¸‹é¢è¿™æ ·ä¹¦å†™å³å¯ï¼š123456789101112131415161718192021222324252627282930313233$(function() &#123; var settings = &#123; url: ctx + "bootstrap-table/list", queryParams: function(params) &#123; return &#123; pageSize: params.limit, pageNum: params.offset / params.limit + 1, roleName: $(".form").find("input[name='roleName']").val().trim(), &#125;; &#125;, columns: [&#123; checkbox: true &#125;, &#123; field: 'roleId', title: 'è§’è‰²ID' &#125;, &#123; field: 'roleName', title: 'è§’è‰²' &#125;, &#123; field: 'remark', title: 'æè¿°' &#125;, &#123; field: 'createTime', title: 'åˆ›å»ºæ—¶é—´' &#125;, &#123; field: 'modifyTime', title: 'ä¿®æ”¹æ—¶é—´' &#125; ] &#125; $Mrbird.initTable('roleTable', settings);&#125;);é™„å½•Bootstap Tableé™¤äº†ä¸Šé¢ä»‹ç»çš„å†…å®¹å¤–ï¼Œå…¶è¿˜åŒ…å«äº†è®¸å¤šåˆ«çš„ç‰¹æ€§ï¼Œå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttp://bootstrap-table.wenzhixin.net.cn/zh-cn/documentation/ã€‚æºç é“¾æŽ¥ï¼šhttps://drive.google.com/open?id=1qEVgDDBfbdaVJ1FSckzQr6RAUyGF7k6J]]></content>
      <tags>
        <tag>Bootstrap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxä¸‹éƒ¨ç½²Spring Boot jar]]></title>
    <url>%2FLinux%20Spring-Boot-jar.html</url>
    <content type="text"><![CDATA[éƒ¨ç½²Spring Booté¡¹ç›®å¯ä»¥ä½¿ç”¨Mavenå‘½ä»¤mvn:clean packageå°†é¡¹ç›®æ‰“åŒ…æˆåªæ‰§è¡Œçš„jaræ–‡ä»¶ï¼Œç„¶åŽä½¿ç”¨å‘½ä»¤java -jar XX.jaræ¥æ‰§è¡Œã€‚ä½†è¿™æ ·åšæ— æ³•å°†shellå‘½ä»¤è¡Œé‡Šæ”¾ï¼Œå…³é—­terminalåŽé¡¹ç›®ä¹Ÿéšä¹‹å…³é—­äº†ã€‚è¿™é‡Œä»‹ç»åœ¨Linuxç³»ç»Ÿä¸­åŽå°è¿è¡ŒSpring Boot jaræ–‡ä»¶çš„æ–¹æ³•ã€‚å®žçŽ°è¿™ä¸ªåŠŸèƒ½ä¸»è¦ä¾èµ–äºŽLinuxçš„nohupå‘½ä»¤ã€‚nohupå‘½ä»¤å¯ä»¥å°†ç¨‹åºä»¥å¿½ç•¥æŒ‚èµ·ä¿¡å·çš„æ–¹å¼è¿è¡Œèµ·æ¥ï¼Œè¢«è¿è¡Œçš„ç¨‹åºçš„è¾“å‡ºä¿¡æ¯å°†ä¸ä¼šæ˜¾ç¤ºåˆ°ç»ˆç«¯ã€‚nohupè¯­æ³•ï¼š123nohup å‘½ä»¤ç”¨é€”ï¼šä¸æŒ‚æ–­åœ°è¿è¡Œå‘½ä»¤ã€‚è¯­æ³•ï¼šnohup Command [ Arg â€¦ ][ &amp; ]æ‰€ä»¥åªéœ€è¦åœ¨å¯åŠ¨å‘½ä»¤å‰åŠ ä¸Šnohupå‘½ä»¤ï¼Œæœ«å°¾åŠ ä¸Š&amp;å³å¯ï¼šnohup java -jar XX.jar &amp;ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™å¯åŠ¨è„šæœ¬start.shï¼š1nohup java -jar XX.jar &amp;å…³åœè„šæœ¬stop.shï¼š12345678PID=`ps -ef | grep sms-2.0.jar | grep -v grep | awk '&#123;print $2&#125;'`if [ -z "$PID" ]then echo Application is already stoppedelse echo kill $PID kill -9 $PIDfié‡å¯è„šæœ¬run.shï¼š1234echo stop applicationsource stop.shecho start applicationsource start.shåœ¨ç¼–å†™shellè„šæœ¬çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜ï¼šæ‰§è¡Œ.shæ–‡ä»¶æç¤ºæƒé™ä¸è¶³ï¼šè§£å†³åŠžæ³•ï¼šæ‰§è¡Œå‘½ä»¤chmod u+x XX.shèµ‹äºˆå½“å‰ç”¨äºŽå¯æ‰§è¡Œçš„æƒé™å³å¯ã€‚æç¤º/bin/bash^M: bad interpreter: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•ã€‚é—®é¢˜å‡ºçŽ°çš„åŽŸå› æ˜¯shellè„šæœ¬æ˜¯åœ¨windowsä¸­ç¼–å†™çš„ç„¶åŽä¸Šä¼ åˆ°Linuxä¸­çš„ï¼Œå‡ºçŽ°äº†å…¼å®¹æ€§é—®é¢˜ã€‚è§£å†³åŠžæ³•ï¼šæ‰§è¡Œvim XX.shæ‰“å¼€shellæ–‡ä»¶ï¼Œç„¶åŽåˆ‡æ¢åˆ°å‘½ä»¤æ¨¡å¼ï¼Œæ‰§è¡Œ:set fileformat=unixåŽä¿å­˜é€€å‡ºå³å¯ã€‚ä½¿ç”¨äº†nohupå‘½ä»¤åŽï¼Œä¼šåœ¨jaræ–‡ä»¶ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªnohup.outæ–‡ä»¶ï¼Œå¯é€šè¿‡å…¶è§‚å¯Ÿå½“å‰é¡¹ç›®çš„è¿è¡Œæƒ…å†µï¼š1234567891011121314151617181920$ llæ€»ç”¨é‡ 76612drwxrwxr-x 2 zjrun zjrun 4096 2æœˆ 8 08:49 log-rw------- 1 zjrun zjrun 58695723 2æœˆ 8 10:15 nohup.out-rwxrw-r-- 1 zjrun zjrun 88 2æœˆ 7 15:17 run.sh-rw-rw-r-- 1 zjrun zjrun 19730199 2æœˆ 8 10:11 sms-1.0.jar-rwxrw-r-- 1 zjrun zjrun 60 2æœˆ 7 15:22 start.sh-rwxrw-r-- 1 zjrun zjrun 184 2æœˆ 7 15:19 stop.sh$ tail -10f nohup.out 10:14:31.309 logback [main] INFO o.s.j.e.a.AnnotationMBeanExporter - Registering beans for JMX exposure on startup10:14:31.478 logback [main] INFO o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8963"]10:14:31.498 logback [main] INFO o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8963"]10:14:31.506 logback [main] INFO o.a.tomcat.util.net.NioSelectorPool - Using a shared selector for servlet write/read10:14:31.634 logback [main] INFO o.s.b.c.e.t.TomcatEmbeddedServletContainer - Tomcat started on port(s): 8963 (http)10:14:31.644 logback [main] INFO com.xingyi.sms.SmsApplication - Started SmsApplication in 7.213 seconds (JVM running for 8.03)complete!10:15:26.978 logback [http-nio-8963-exec-1] INFO o.a.c.c.C.[.[localhost].[/mobilePre] - Initializing Spring FrameworkServlet 'dispatcherServlet'10:15:26.979 logback [http-nio-8963-exec-1] INFO o.s.web.servlet.DispatcherServlet - FrameworkServlet 'dispatcherServlet': initialization started10:15:27.004 logback [http-nio-8963-exec-1] INFO o.s.web.servlet.DispatcherServlet - FrameworkServlet 'dispatcherServlet': initialization completed in 25 mså‚è€ƒè‡ªï¼š http://blog.didispace.com/spring-boot-run-backend/]]></content>
      <tags>
        <tag>Spring Boot</tag>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot logbackæ—¥å¿—é…ç½®[è½¬]]]></title>
    <url>%2FSpring-Boot-logback.html</url>
    <content type="text"><![CDATA[Spring Bootåœ¨æ‰€æœ‰å†…éƒ¨æ—¥å¿—ä¸­ä½¿ç”¨Commons Loggingï¼Œä½†æ˜¯é»˜è®¤é…ç½®ä¹Ÿæä¾›äº†å¯¹å¸¸ç”¨æ—¥å¿—çš„æ”¯æŒï¼Œå¦‚ï¼šJava Util Loggingï¼ŒLog4J, Log4J2å’ŒLogbackã€‚æ¯ç§Loggeréƒ½å¯ä»¥é€šè¿‡é…ç½®ä½¿ç”¨æŽ§åˆ¶å°æˆ–è€…æ–‡ä»¶è¾“å‡ºæ—¥å¿—å†…å®¹ã€‚SLF4J â€”â€” Simple Logging Facade For Javaï¼Œå®ƒæ˜¯ä¸€ä¸ªé’ˆå¯¹äºŽå„ç±»Javaæ—¥å¿—æ¡†æž¶çš„ç»Ÿä¸€FacadeæŠ½è±¡ã€‚Javaæ—¥å¿—æ¡†æž¶ä¼—å¤šâ€”â€”å¸¸ç”¨çš„æœ‰java.util.logging, log4j, logbackï¼Œcommons-logging, Springæ¡†æž¶ä½¿ç”¨çš„æ˜¯Jakarta Commons Logging APIï¼ˆJCLï¼‰ã€‚è€ŒSLF4Jå®šä¹‰äº†ç»Ÿä¸€çš„æ—¥å¿—æŠ½è±¡æŽ¥å£ï¼Œè€ŒçœŸæ­£çš„æ—¥å¿—å®žçŽ°åˆ™æ˜¯åœ¨è¿è¡Œæ—¶å†³å®šçš„â€”â€”å®ƒæä¾›äº†å„ç±»æ—¥å¿—æ¡†æž¶çš„ç»‘å®šã€‚Logbackæ˜¯log4jæ¡†æž¶çš„ä½œè€…å¼€å‘çš„æ–°ä¸€ä»£æ—¥å¿—æ¡†æž¶ï¼Œå®ƒæ•ˆçŽ‡æ›´é«˜ã€èƒ½å¤Ÿé€‚åº”è¯¸å¤šçš„è¿è¡ŒçŽ¯å¢ƒï¼ŒåŒæ—¶å¤©ç„¶æ”¯æŒSLF4Jã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Bootä¼šç”¨Logbackæ¥è®°å½•æ—¥å¿—ï¼Œå¹¶ç”¨INFOçº§åˆ«è¾“å‡ºåˆ°æŽ§åˆ¶å°ã€‚åœ¨è¿è¡Œåº”ç”¨ç¨‹åºå’Œå…¶ä»–ä¾‹å­æ—¶ï¼Œä½ åº”è¯¥å·²ç»çœ‹åˆ°å¾ˆå¤šINFOçº§åˆ«çš„æ—¥å¿—äº†ã€‚123456789101112 _ _ _ _ _ _ / \ / \ / \ / \ / \ / \ ( m | r | b | i | r | d ) \_/ \_/ \_/ \_/ \_/ \_/ 2018-02-08 15:05:03.368 INFO 14404 --- [ main] cc.mrbird.Application : Starting Application on SC-201802012049 with PID 14404 (D:\neonWorkspace\mrbird\target\classes started by Administrator in D:\neonWorkspace\mrbird)2018-02-08 15:05:03.375 INFO 14404 --- [ main] cc.mrbird.Application : No active profile set, falling back to default profiles: default2018-02-08 15:05:03.777 INFO 14404 --- [ main] ationConfigEmbeddedWebApplicationContext : Refreshing org.springframework.boot.context.embedded.AnnotationConfigEmbeddedWebApplicationContext@31321838: startup date [Thu Feb 08 15:05:03 CST 2018]; root of context hierarchy2018-02-08 15:05:05.083 INFO 14404 --- [ main] o.s.b.f.s.DefaultListableBeanFactory : Overriding bean definition for bean &apos;advisorAutoProxyCreator&apos; with a different definition: replacing [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=shiroConfig; factoryMethodName=advisorAutoProxyCreator; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [cc/mrbird/config/ShiroConfig.class]] with [Root bean: class [null]; scope=; abstract=false; lazyInit=false; autowireMode=3; dependencyCheck=0; autowireCandidate=true; primary=false; factoryBeanName=com.alibaba.druid.spring.boot.autoconfigure.stat.DruidSpringAopConfiguration; factoryMethodName=advisorAutoProxyCreator; initMethodName=null; destroyMethodName=(inferred); defined in class path resource [com/alibaba/druid/spring/boot/autoconfigure/stat/DruidSpringAopConfiguration.class]]2018-02-08 15:05:05.554 INFO 14404 --- [ main] trationDelegate$BeanPostProcessorChecker : Bean &apos;shiroConfig&apos; of type [cc.mrbird.config.ShiroConfig$$EnhancerBySpringCGLIB$$b7e43ac8] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)2018-02-08 15:05:05.600 INFO 14404 --- [ main] trationDelegate$BeanPostProcessorChecker : Bean &apos;com.alibaba.druid.spring.boot.autoconfigure.stat.DruidSpringAopConfiguration&apos; of type [com.alibaba.druid.spring.boot.autoconfigure.stat.DruidSpringAopConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)2018-02-08 15:05:06.231 INFO 14404 --- [ main] trationDelegate$BeanPostProcessorChecker : Bean &apos;mybatis-org.mybatis.spring.boot.autoconfigure.MybatisProperties&apos; of type [org.mybatis.spring.boot.autoconfigure.MybatisProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)...ä»Žä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œæ—¥å¿—è¾“å‡ºå†…å®¹å…ƒç´ å…·ä½“å¦‚ä¸‹ï¼šæ—¶é—´æ—¥æœŸï¼šç²¾ç¡®åˆ°æ¯«ç§’ï¼›æ—¥å¿—çº§åˆ«ï¼šERROR, WARN, INFO, DEBUG or TRACEï¼›è¿›ç¨‹IDï¼›åˆ†éš”ç¬¦ï¼š---æ ‡è¯†å®žé™…æ—¥å¿—çš„å¼€å§‹ï¼›çº¿ç¨‹åï¼šæ–¹æ‹¬å·æ‹¬èµ·æ¥ï¼ˆå¯èƒ½ä¼šæˆªæ–­æŽ§åˆ¶å°è¾“å‡ºï¼‰ï¼›Loggeråï¼šé€šå¸¸ä½¿ç”¨æºä»£ç çš„ç±»åï¼›æ—¥å¿—å†…å®¹ã€‚æ·»åŠ æ—¥å¿—ä¾èµ–å‡å¦‚mavenä¾èµ–ä¸­æ·»åŠ äº†spring-boot-starter-loggingï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;&lt;/dependency&gt;é‚£ä¹ˆï¼Œæˆ‘ä»¬çš„Spring Bootåº”ç”¨å°†è‡ªåŠ¨ä½¿ç”¨logbackä½œä¸ºåº”ç”¨æ—¥å¿—æ¡†æž¶ï¼ŒSpring Bootå¯åŠ¨çš„æ—¶å€™ï¼Œç”±org.springframework.boot.logging.Logging-Application-Listeneræ ¹æ®æƒ…å†µåˆå§‹åŒ–å¹¶ä½¿ç”¨ã€‚é»˜è®¤é…ç½®å±žæ€§æ”¯æŒSpring Bootä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¤šé»˜è®¤çš„æ—¥å¿—é…ç½®ï¼Œæ‰€ä»¥ï¼Œåªè¦å°†spring-boot-starter-loggingä½œä¸ºä¾èµ–åŠ å…¥åˆ°å½“å‰åº”ç”¨çš„classpathï¼Œåˆ™â€œå¼€ç®±å³ç”¨â€ã€‚ ä¸‹é¢ä»‹ç»å‡ ç§åœ¨application.propertieså°±å¯ä»¥é…ç½®çš„æ—¥å¿—ç›¸å…³å±žæ€§ã€‚æŽ§åˆ¶å°è¾“å‡ºæ—¥å¿—çº§åˆ«ä»Žä½Žåˆ°é«˜åˆ†ä¸ºTRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATALï¼Œå¦‚æžœè®¾ç½®ä¸ºWARNï¼Œåˆ™ä½ŽäºŽWARNçš„ä¿¡æ¯éƒ½ä¸ä¼šè¾“å‡ºã€‚ Spring Bootä¸­é»˜è®¤é…ç½®ERRORã€WARNå’ŒINFOçº§åˆ«çš„æ—¥å¿—è¾“å‡ºåˆ°æŽ§åˆ¶å°ã€‚æ‚¨è¿˜å¯ä»¥é€šè¿‡å¯åŠ¨æ‚¨çš„åº”ç”¨ç¨‹åºâ€“debugæ ‡å¿—æ¥å¯ç”¨â€œè°ƒè¯•â€æ¨¡å¼ï¼ˆå¼€å‘çš„æ—¶å€™æŽ¨èå¼€å¯ï¼‰,ä»¥ä¸‹ä¸¤ç§æ–¹å¼çš†å¯ï¼šåœ¨è¿è¡Œå‘½ä»¤åŽåŠ å…¥â€“debugæ ‡å¿—ï¼Œå¦‚ï¼š$ java -jar springTest.jar --debugã€‚åœ¨application.propertiesä¸­é…ç½®debug=trueï¼Œè¯¥å±žæ€§ç½®ä¸ºtrueçš„æ—¶å€™ï¼Œæ ¸å¿ƒLoggerï¼ˆåŒ…å«åµŒå…¥å¼å®¹å™¨ã€hibernateã€springï¼‰ä¼šè¾“å‡ºæ›´å¤šå†…å®¹ï¼Œä½†æ˜¯ä½ è‡ªå·±åº”ç”¨çš„æ—¥å¿—å¹¶ä¸ä¼šè¾“å‡ºä¸ºDEBUGçº§åˆ«ã€‚æ–‡ä»¶è¾“å‡ºé»˜è®¤æƒ…å†µä¸‹ï¼ŒSpring Bootå°†æ—¥å¿—è¾“å‡ºåˆ°æŽ§åˆ¶å°ï¼Œä¸ä¼šå†™åˆ°æ—¥å¿—æ–‡ä»¶ã€‚å¦‚æžœè¦ç¼–å†™é™¤æŽ§åˆ¶å°è¾“å‡ºä¹‹å¤–çš„æ—¥å¿—æ–‡ä»¶ï¼Œåˆ™éœ€åœ¨application.propertiesä¸­è®¾ç½®logging.fileæˆ–logging.pathå±žæ€§ã€‚logging.fileï¼Œè®¾ç½®æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ã€‚å¦‚ï¼šlogging.file=my.logã€‚logging.pathï¼Œè®¾ç½®ç›®å½•ï¼Œä¼šåœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºspring.logæ–‡ä»¶ï¼Œå¹¶å†™å…¥æ—¥å¿—å†…å®¹ï¼Œå¦‚ï¼šlogging.path=/var/logã€‚å¦‚æžœåªé…ç½® logging.fileï¼Œä¼šåœ¨é¡¹ç›®çš„å½“å‰è·¯å¾„ä¸‹ç”Ÿæˆä¸€ä¸ª xxx.log æ—¥å¿—æ–‡ä»¶ã€‚å¦‚æžœåªé…ç½® logging.pathï¼Œåœ¨ /var/logæ–‡ä»¶å¤¹ç”Ÿæˆä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ä¸º spring.logã€‚çº§åˆ«æŽ§åˆ¶æ‰€æœ‰æ”¯æŒçš„æ—¥å¿—è®°å½•ç³»ç»Ÿéƒ½å¯ä»¥åœ¨SpringçŽ¯å¢ƒä¸­è®¾ç½®è®°å½•çº§åˆ«ï¼ˆä¾‹å¦‚åœ¨application.propertiesä¸­ï¼‰ æ ¼å¼ä¸ºï¼šâ€™logging.level.* = LEVELâ€™logging.levelï¼šæ—¥å¿—çº§åˆ«æŽ§åˆ¶å‰ç¼€ï¼Œ*ä¸ºåŒ…åæˆ–LoggeråLEVELï¼šé€‰é¡¹TRACE, DEBUG, INFO, WARN, ERROR, FATAL, OFFä¸¾ä¾‹ï¼šlogging.level.com.mrbird=DEBUGï¼šcom.mrbirdåŒ…ä¸‹æ‰€æœ‰classä»¥DEBUGçº§åˆ«è¾“å‡ºã€‚logging.level.root=WARNï¼šrootæ—¥å¿—ä»¥WARNçº§åˆ«è¾“å‡ºã€‚è‡ªå®šä¹‰æ—¥å¿—é…ç½®ç”±äºŽæ—¥å¿—æœåŠ¡ä¸€èˆ¬éƒ½åœ¨ApplicationContextåˆ›å»ºå‰å°±åˆå§‹åŒ–äº†ï¼Œå®ƒå¹¶ä¸æ˜¯å¿…é¡»é€šè¿‡Springçš„é…ç½®æ–‡ä»¶æŽ§åˆ¶ã€‚å› æ­¤é€šè¿‡ç³»ç»Ÿå±žæ€§å’Œä¼ ç»Ÿçš„Spring Bootå¤–éƒ¨é…ç½®æ–‡ä»¶ä¾ç„¶å¯ä»¥å¾ˆå¥½çš„æ”¯æŒæ—¥å¿—æŽ§åˆ¶å’Œç®¡ç†ã€‚æ ¹æ®ä¸åŒçš„æ—¥å¿—ç³»ç»Ÿï¼Œä½ å¯ä»¥æŒ‰å¦‚ä¸‹è§„åˆ™ç»„ç»‡é…ç½®æ–‡ä»¶åï¼Œå°±èƒ½è¢«æ­£ç¡®åŠ è½½ï¼šLogbackï¼šlogback-spring.xml, logback-spring.groovy, logback.xml, logback.groovyLog4jï¼šlog4j-spring.properties, log4j-spring.xml, log4j.properties, log4j.xmlLog4j2ï¼šlog4j2-spring.xml, log4j2.xmlJDK (Java Util Logging)ï¼šlogging.propertiesSpring Bootå®˜æ–¹æŽ¨èä¼˜å…ˆä½¿ç”¨å¸¦æœ‰-springçš„æ–‡ä»¶åä½œä¸ºä½ çš„æ—¥å¿—é…ç½®ï¼ˆå¦‚ä½¿ç”¨logback-spring.xmlï¼Œè€Œä¸æ˜¯logback.xmlï¼‰ï¼Œå‘½åä¸ºlogback-spring.xmlçš„æ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œspring bootå¯ä»¥ä¸ºå®ƒæ·»åŠ ä¸€äº›spring bootç‰¹æœ‰çš„é…ç½®é¡¹ï¼ˆä¸‹é¢ä¼šæåˆ°ï¼‰ã€‚ä¸Šé¢æ˜¯é»˜è®¤çš„å‘½åè§„åˆ™ï¼Œå¹¶ä¸”æ”¾åœ¨src/main/resourcesä¸‹é¢å³å¯ã€‚å¦‚æžœä½ å³æƒ³å®Œå…¨æŽŒæŽ§æ—¥å¿—é…ç½®ï¼Œä½†åˆä¸æƒ³ç”¨logback.xmlä½œä¸ºLogbacké…ç½®çš„åå­—ï¼Œå¯ä»¥åœ¨application.propertiesé…ç½®æ–‡ä»¶é‡Œé¢é€šè¿‡logging.configå±žæ€§æŒ‡å®šè‡ªå®šä¹‰çš„åå­—ï¼š1logging.config=classpath:logging-config.xmlè™½ç„¶ä¸€èˆ¬å¹¶ä¸éœ€è¦æ”¹å˜é…ç½®æ–‡ä»¶çš„åå­—ï¼Œä½†æ˜¯å¦‚æžœä½ æƒ³é’ˆå¯¹ä¸åŒè¿è¡Œæ—¶Profileä½¿ç”¨ä¸åŒçš„æ—¥ å¿—é…ç½®ï¼Œè¿™ä¸ªåŠŸèƒ½ä¼šå¾ˆæœ‰ç”¨ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€ä¸ªæ™®é€šçš„logback-spring.xmlä¾‹å­:12345678910111213141516171819202122232425262728293031323334353637&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE xml&gt;&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt; &lt;contextName&gt;logback&lt;/contextName&gt; &lt;property name="log.path" value="log" /&gt; &lt;!--è¾“å‡ºåˆ°æŽ§åˆ¶å°--&gt; &lt;appender name="console" class="ch.qos.logback.core.ConsoleAppender"&gt; &lt;!-- &lt;filter class="ch.qos.logback.classic.filter.ThresholdFilter"&gt; &lt;level&gt;ERROR&lt;/level&gt; &lt;/filter&gt;--&gt; &lt;encoder&gt; &lt;pattern&gt;%d&#123;HH:mm:ss.SSS&#125; %contextName [%thread] %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!--è¾“å‡ºåˆ°æ–‡ä»¶--&gt; &lt;appender name="file" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;fileNamePattern&gt;$&#123;log.path&#125;/logback.%d&#123;yyyy-MM-dd&#125;.log&lt;/fileNamePattern&gt; &lt;/rollingPolicy&gt; &lt;encoder&gt; &lt;pattern&gt;%d&#123;HH:mm:ss.SSS&#125; %contextName [%thread] %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;root level="info"&gt; &lt;appender-ref ref="console" /&gt; &lt;appender-ref ref="file" /&gt; &lt;/root&gt; &lt;!-- logbackä¸ºjavaä¸­çš„åŒ… --&gt; &lt;logger name="com.mrbird.controller"/&gt; &lt;!--logback.LogbackDemoï¼šç±»çš„å…¨è·¯å¾„ --&gt; &lt;logger name="com.mrbird.controller.LoginController" level="WARN" additivity="false"&gt; &lt;appender-ref ref="console"/&gt; &lt;/logger&gt;&lt;/configuration&gt;æ ¹èŠ‚ç‚¹&lt;configuration&gt;åŒ…å«çš„å±žæ€§scanï¼šå½“æ­¤å±žæ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æžœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrueã€‚scanPeriodï¼šè®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æžœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚å½“scanä¸ºtrueæ—¶ï¼Œæ­¤å±žæ€§ç”Ÿæ•ˆã€‚é»˜è®¤çš„æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿã€‚debugï¼šå½“æ­¤å±žæ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡ºlogbackå†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®žæ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸ºfalseã€‚æ ¹èŠ‚ç‚¹&lt;configuration&gt;çš„å­èŠ‚ç‚¹ï¼š&lt;configuration&gt;ä¸‹é¢ä¸€å…±æœ‰2ä¸ªå±žæ€§ï¼Œ3ä¸ªå­èŠ‚ç‚¹ï¼Œåˆ†åˆ«æ˜¯ï¼šå±žæ€§ä¸€ï¼šè®¾ç½®ä¸Šä¸‹æ–‡åç§°&lt;contextName&gt;æ¯ä¸ªloggeréƒ½å…³è”åˆ°loggerä¸Šä¸‹æ–‡ï¼Œé»˜è®¤ä¸Šä¸‹æ–‡åç§°ä¸ºâ€œdefaultâ€ã€‚ä½†å¯ä»¥ä½¿ç”¨è®¾ç½®æˆå…¶ä»–åå­—ï¼Œç”¨äºŽåŒºåˆ†ä¸åŒåº”ç”¨ç¨‹åºçš„è®°å½•ã€‚ä¸€æ—¦è®¾ç½®ï¼Œä¸èƒ½ä¿®æ”¹,å¯ä»¥é€šè¿‡%contextNameæ¥æ‰“å°æ—¥å¿—ä¸Šä¸‹æ–‡åç§°ã€‚1&lt;contextName&gt;logback&lt;/contextName&gt;å±žæ€§äºŒï¼šè®¾ç½®å˜é‡&lt;property&gt; ç”¨æ¥å®šä¹‰å˜é‡å€¼çš„æ ‡ç­¾ï¼Œæœ‰ä¸¤ä¸ªå±žæ€§ï¼Œnameå’Œvalueï¼›å…¶ä¸­nameçš„å€¼æ˜¯å˜é‡çš„åç§°ï¼Œvalueçš„å€¼æ—¶å˜é‡å®šä¹‰çš„å€¼ã€‚é€šè¿‡å®šä¹‰çš„å€¼ä¼šè¢«æ’å…¥åˆ°loggerä¸Šä¸‹æ–‡ä¸­ã€‚å®šä¹‰å˜é‡åŽï¼Œå¯ä»¥ä½¿â€œ${}â€æ¥ä½¿ç”¨å˜é‡ã€‚1&lt;property name="log.path" value="log" /&gt;å­èŠ‚ç‚¹ä¸€&lt;appender&gt;appenderç”¨æ¥æ ¼å¼åŒ–æ—¥å¿—è¾“å‡ºèŠ‚ç‚¹ï¼Œæœ‰ä¿©ä¸ªå±žæ€§nameå’Œclassï¼Œclassç”¨æ¥æŒ‡å®šå“ªç§è¾“å‡ºç­–ç•¥ï¼Œå¸¸ç”¨å°±æ˜¯æŽ§åˆ¶å°è¾“å‡ºç­–ç•¥å’Œæ–‡ä»¶è¾“å‡ºç­–ç•¥ã€‚æŽ§åˆ¶å°è¾“å‡ºConsoleAppenderï¼š123456789&lt;!--è¾“å‡ºåˆ°æŽ§åˆ¶å°--&gt;&lt;appender name="console" class="ch.qos.logback.core.ConsoleAppender"&gt; &lt;filter class="ch.qos.logback.classic.filter.ThresholdFilter"&gt; &lt;level&gt;ERROR&lt;/level&gt; &lt;/filter&gt; &lt;encoder&gt; &lt;pattern&gt;%d&#123;HH:mm:ss.SSS&#125; %contextName [%thread] %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt; &lt;/encoder&gt;&lt;/appender&gt;&lt;encoder&gt;è¡¨ç¤ºå¯¹æ—¥å¿—è¿›è¡Œç¼–ç ï¼š%d{HH: mm:ss.SSS}â€”â€”æ—¥å¿—è¾“å‡ºæ—¶é—´ã€‚%threadâ€”â€”è¾“å‡ºæ—¥å¿—çš„è¿›ç¨‹åå­—ï¼Œè¿™åœ¨Webåº”ç”¨ä»¥åŠå¼‚æ­¥ä»»åŠ¡å¤„ç†ä¸­å¾ˆæœ‰ç”¨ã€‚%-5levelâ€”â€”æ—¥å¿—çº§åˆ«ï¼Œå¹¶ä¸”ä½¿ç”¨5ä¸ªå­—ç¬¦é å·¦å¯¹é½ã€‚%logger{36}â€”â€”æ—¥å¿—è¾“å‡ºè€…çš„åå­—ã€‚%msgâ€”â€”æ—¥å¿—æ¶ˆæ¯ã€‚%nâ€”â€”å¹³å°çš„æ¢è¡Œç¬¦ã€‚ThresholdFilterä¸ºç³»ç»Ÿå®šä¹‰çš„æ‹¦æˆªå™¨ï¼Œä¾‹å¦‚æˆ‘ä»¬ç”¨ThresholdFilteræ¥è¿‡æ»¤æŽ‰ERRORçº§åˆ«ä»¥ä¸‹çš„æ—¥å¿—ä¸è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ã€‚å¦‚æžœä¸ç”¨è®°å¾—æ³¨é‡ŠæŽ‰ï¼Œä¸ç„¶ä½ æŽ§åˆ¶å°ä¼šå‘çŽ°æ²¡æ—¥å¿—~è¾“å‡ºåˆ°æ–‡ä»¶RollingFileAppenderï¼šå¦ä¸€ç§å¸¸è§çš„æ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œéšç€åº”ç”¨çš„è¿è¡Œæ—¶é—´è¶Šæ¥è¶Šé•¿ï¼Œæ—¥å¿—ä¹Ÿä¼šå¢žé•¿çš„è¶Šæ¥è¶Šå¤šï¼Œå°†ä»–ä»¬è¾“å‡ºåˆ°åŒä¸€ä¸ªæ–‡ä»¶å¹¶éžä¸€ä¸ªå¥½åŠžæ³•ã€‚RollingFileAppenderç”¨äºŽåˆ‡åˆ†æ–‡ä»¶æ—¥å¿—ï¼š1234567891011&lt;!--è¾“å‡ºåˆ°æ–‡ä»¶--&gt;&lt;appender name="file" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;fileNamePattern&gt;$&#123;log.path&#125;/logback.%d&#123;yyyy-MM-dd&#125;.log&lt;/fileNamePattern&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;totalSizeCap&gt;1GB&lt;/totalSizeCap&gt; &lt;/rollingPolicy&gt; &lt;encoder&gt; &lt;pattern&gt;%d&#123;HH:mm:ss.SSS&#125; %contextName [%thread] %-5level %logger&#123;36&#125; - %msg%n&lt;/pattern&gt; &lt;/encoder&gt;&lt;/appender&gt;å…¶ä¸­é‡è¦çš„æ˜¯rollingPolicyçš„å®šä¹‰ï¼š&lt;fileNamePattern&gt;${log.path}/logback.%d{yyyy-MM-dd}.log&lt;/fileNamePattern&gt;å®šä¹‰äº†æ—¥å¿—çš„åˆ‡åˆ†æ–¹å¼â€”â€”æŠŠæ¯ä¸€å¤©çš„æ—¥å¿—å½’æ¡£åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼›&lt;maxHistory&gt;30&lt;/maxHistory&gt;è¡¨ç¤ºåªä¿ç•™æœ€è¿‘30å¤©çš„æ—¥å¿—ï¼Œä»¥é˜²æ­¢æ—¥å¿—å¡«æ»¡æ•´ä¸ªç£ç›˜ç©ºé—´ã€‚åŒç†ï¼Œå¯ä»¥ä½¿ç”¨%d{yyyy-MM-dd_HH-mm}æ¥å®šä¹‰ç²¾ç¡®åˆ°åˆ†çš„æ—¥å¿—åˆ‡åˆ†æ–¹å¼ï¼›&lt;totalSizeCap&gt;1GB&lt;/totalSizeCap&gt;ç”¨æ¥æŒ‡å®šæ—¥å¿—æ–‡ä»¶çš„ä¸Šé™å¤§å°ï¼Œä¾‹å¦‚è®¾ç½®ä¸º1GBçš„è¯ï¼Œé‚£ä¹ˆåˆ°äº†è¿™ä¸ªå€¼ï¼Œå°±ä¼šåˆ é™¤æ—§çš„æ—¥å¿—ã€‚logback æ¯å¤©ç”Ÿæˆå’Œå¤§å°ç”Ÿæˆå†²çªçš„é—®é¢˜å¯ä»¥çœ‹è¿™ä¸ªè§£ç­”ï¼šhttp://blog.csdn.net/wujianmin577/article/details/68922545ã€‚å­èŠ‚ç‚¹äºŒ&lt;root&gt;rootèŠ‚ç‚¹æ˜¯å¿…é€‰èŠ‚ç‚¹ï¼Œç”¨æ¥æŒ‡å®šæœ€åŸºç¡€çš„æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼Œåªæœ‰ä¸€ä¸ªlevelå±žæ€§ï¼Œç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œä¸èƒ½è®¾ç½®ä¸ºINHERITEDæˆ–è€…åŒä¹‰è¯NULLã€‚é»˜è®¤æ˜¯DEBUGã€‚å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œæ ‡è¯†è¿™ä¸ªappenderå°†ä¼šæ·»åŠ åˆ°è¿™ä¸ªloggerã€‚1234&lt;root level="debug"&gt; &lt;appender-ref ref="console" /&gt; &lt;appender-ref ref="file" /&gt;&lt;/root&gt;å­èŠ‚ç‚¹ä¸‰&lt;logger&gt;&lt;logger&gt;ç”¨æ¥è®¾ç½®æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»çš„æ—¥å¿—æ‰“å°çº§åˆ«ã€ä»¥åŠæŒ‡å®š&lt;appender&gt;ã€‚&lt;logger&gt;ä»…æœ‰ä¸€ä¸ªnameå±žæ€§ï¼Œä¸€ä¸ªå¯é€‰çš„levelå’Œä¸€ä¸ªå¯é€‰çš„addtivityå±žæ€§ã€‚nameï¼šç”¨æ¥æŒ‡å®šå—æ­¤loggerçº¦æŸçš„æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»ã€‚levelï¼šç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹ä¿—å€¼INHERITEDæˆ–è€…åŒä¹‰è¯NULLï¼Œä»£è¡¨å¼ºåˆ¶æ‰§è¡Œä¸Šçº§çš„çº§åˆ«ã€‚å¦‚æžœæœªè®¾ç½®æ­¤å±žæ€§ï¼Œé‚£ä¹ˆå½“å‰loggerå°†ä¼šç»§æ‰¿ä¸Šçº§çš„çº§åˆ«ã€‚addtivityï¼šæ˜¯å¦å‘ä¸Šçº§loggerä¼ é€’æ‰“å°ä¿¡æ¯ã€‚é»˜è®¤æ˜¯trueã€‚loggeråœ¨å®žé™…ä½¿ç”¨çš„æ—¶å€™æœ‰ä¸¤ç§æƒ…å†µï¼šå…ˆæ¥çœ‹ä¸€çœ‹ä»£ç ä¸­å¦‚ä½•ä½¿ç”¨ï¼š12345678910111213141516171819202122232425262728package com.mrbird.controller;@Controllerpublic class LearnController &#123; private Logger logger = LoggerFactory.getLogger(this.getClass()); @RequestMapping(value = "/login",method = RequestMethod.POST) @ResponseBody public Map&lt;String,Object&gt; login(HttpServletRequest request, HttpServletResponse response)&#123; //æ—¥å¿—çº§åˆ«ä»Žä½Žåˆ°é«˜åˆ†ä¸ºTRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATALï¼Œå¦‚æžœè®¾ç½®ä¸ºWARNï¼Œåˆ™ä½ŽäºŽWARNçš„ä¿¡æ¯éƒ½ä¸ä¼šè¾“å‡ºã€‚ logger.trace("æ—¥å¿—è¾“å‡º trace"); logger.debug("æ—¥å¿—è¾“å‡º debug"); logger.info("æ—¥å¿—è¾“å‡º info"); logger.warn("æ—¥å¿—è¾“å‡º warn"); logger.error("æ—¥å¿—è¾“å‡º error"); Map&lt;String,Object&gt; map =new HashMap&lt;String,Object&gt;(); String userName=request.getParameter("userName"); String password=request.getParameter("password"); if(!userName.equals("") &amp;&amp; password!="")&#123; User user =new User(userName,password); request.getSession().setAttribute("user",user); map.put("result","1"); &#125;else&#123; map.put("result","0"); &#125; return map; &#125;&#125;è¿™æ˜¯ä¸€ä¸ªç™»å½•çš„åˆ¤æ–­çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¼•å…¥æ—¥å¿—ï¼Œå¹¶ä¸”æ‰“å°ä¸åŒçº§åˆ«çš„æ—¥å¿—ï¼Œç„¶åŽæ ¹æ®logback-spring.xmlä¸­çš„é…ç½®æ¥çœ‹çœ‹æ‰“å°äº†å“ªå‡ ç§çº§åˆ«æ—¥å¿—ã€‚ç¬¬ä¸€ç§ï¼šå¸¦æœ‰loggerçš„é…ç½®ï¼Œä¸æŒ‡å®šçº§åˆ«ï¼Œä¸æŒ‡å®šappenderï¼š1&lt;logger name="com.mrbird.controller"/&gt;&lt;logger name=&quot;com.mrbird.controller&quot; /&gt;å°†æŽ§åˆ¶controlleråŒ…ä¸‹çš„æ‰€æœ‰ç±»çš„æ—¥å¿—çš„æ‰“å°ï¼Œä½†æ˜¯å¹¶æ²¡ç”¨è®¾ç½®æ‰“å°çº§åˆ«ï¼Œæ‰€ä»¥ç»§æ‰¿ä»–çš„ä¸Šçº§çš„æ—¥å¿—çº§åˆ«â€œinfoâ€ï¼›æ²¡æœ‰è®¾ç½®addtivityï¼Œé»˜è®¤ä¸ºtrueï¼Œå°†æ­¤loggerçš„æ‰“å°ä¿¡æ¯å‘ä¸Šçº§ä¼ é€’ï¼›æ²¡æœ‰è®¾ç½®appenderï¼Œæ­¤loggeræœ¬èº«ä¸æ‰“å°ä»»ä½•ä¿¡æ¯ã€‚&lt;root level=&quot;info&quot;&gt;å°†rootçš„æ‰“å°çº§åˆ«è®¾ç½®ä¸ºâ€œinfoâ€ï¼ŒæŒ‡å®šäº†åå­—ä¸ºâ€œconsoleâ€çš„appenderã€‚å½“æ‰§è¡Œcom.mrbird.controller.LearnControllerç±»çš„loginæ–¹æ³•æ—¶ï¼ŒLearnController åœ¨åŒ…com.mrbird.controllerä¸­ï¼Œæ‰€ä»¥é¦–å…ˆæ‰§è¡Œ&lt;logger name=&quot;com.mrbird.controller&quot;/&gt;ï¼Œå°†çº§åˆ«ä¸ºâ€œinfoâ€åŠå¤§äºŽâ€œinfoâ€çš„æ—¥å¿—ä¿¡æ¯ä¼ é€’ç»™rootï¼Œæœ¬èº«å¹¶ä¸æ‰“å°ï¼› rootæŽ¥åˆ°ä¸‹çº§ä¼ é€’çš„ä¿¡æ¯ï¼Œäº¤ç»™å·²ç»é…ç½®å¥½çš„åä¸ºâ€œconsoleâ€çš„appenderå¤„ç†ï¼Œâ€œconsoleâ€appenderå°†ä¿¡æ¯æ‰“å°åˆ°æŽ§åˆ¶å°ï¼›æ‰“å°ç»“æžœå¦‚ä¸‹ï¼š12316:00:17.407 logback [http-nio-8080-exec-8] INFO com.mrbird.controller.LearnController - æ—¥å¿—è¾“å‡º info16:00:17.408 logback [http-nio-8080-exec-8] WARN com.mrbird.controller.LearnController - æ—¥å¿—è¾“å‡º warn16:00:17.408 logback [http-nio-8080-exec-8] ERROR com.mrbird.controller.LearnController - æ—¥å¿—è¾“å‡º errorç¬¬äºŒç§ï¼šå¸¦æœ‰å¤šä¸ªloggerçš„é…ç½®ï¼ŒæŒ‡å®šçº§åˆ«ï¼ŒæŒ‡å®šappenderï¼›1234&lt;!--logback.LogbackDemoï¼šç±»çš„å…¨è·¯å¾„ --&gt;&lt;logger name="com.mrbird.controller.LearnController" level="WARN" additivity="false"&gt; &lt;appender-ref ref="console"/&gt;&lt;/logger&gt;æŽ§åˆ¶com.mrbird.controller.LearnControllerç±»çš„æ—¥å¿—æ‰“å°ï¼Œæ‰“å°çº§åˆ«ä¸ºâ€œWARNâ€;additivityå±žæ€§ä¸ºfalseï¼Œè¡¨ç¤ºæ­¤loggerçš„æ‰“å°ä¿¡æ¯ä¸å†å‘ä¸Šçº§ä¼ é€’ï¼›æŒ‡å®šäº†åå­—ä¸ºâ€œconsoleâ€çš„appenderã€‚è¿™æ—¶å€™æ‰§è¡Œcom.mrbird.controller.LearnControllerç±»çš„loginæ–¹æ³•æ—¶ï¼Œå…ˆæ‰§è¡Œ&lt;logger name=&quot;com.mrbird.controller.LearnController&quot; level=&quot;WARN&quot; additivity=&quot;false&quot;&gt;, å°†çº§åˆ«ä¸ºâ€œWARNâ€åŠå¤§äºŽâ€œWARNâ€çš„æ—¥å¿—ä¿¡æ¯äº¤ç»™æ­¤loggeræŒ‡å®šçš„åä¸ºâ€œconsoleâ€çš„appenderå¤„ç†ï¼Œåœ¨æŽ§åˆ¶å°ä¸­æ‰“å‡ºæ—¥å¿—ï¼Œä¸å†å‘ä¸Šçº§rootä¼ é€’æ‰“å°ä¿¡æ¯ã€‚æ‰“å°ç»“æžœå¦‚ä¸‹ï¼š1216:00:17.408 logback [http-nio-8080-exec-8] WARN com.mrbird.controller.LearnController - æ—¥å¿—è¾“å‡º warn16:00:17.408 logback [http-nio-8080-exec-8] ERROR com.mrbird.controller.LearnController - æ—¥å¿—è¾“å‡º errorå½“ç„¶å¦‚æžœä½ æŠŠadditivity=â€falseâ€æ”¹æˆadditivity=â€trueâ€çš„è¯ï¼Œå°±ä¼šæ‰“å°ä¸¤æ¬¡ï¼Œå› ä¸ºæ‰“å°ä¿¡æ¯å‘ä¸Šçº§ä¼ é€’ï¼Œloggeræœ¬èº«æ‰“å°ä¸€æ¬¡ï¼ŒrootæŽ¥åˆ°åŽåˆæ‰“å°ä¸€æ¬¡ã€‚è½¬è½½è‡ªï¼š http://tengj.top/2017/04/05/springboot7/]]></content>
      <tags>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Bootstrap Modalé®ç½©é—®é¢˜]]></title>
    <url>%2FBootstrap-Moda%20error.html</url>
    <content type="text"><![CDATA[å½“åŒæ—¶æ‰“å¼€å¤šå±‚Modalå¹¶å…³é—­çš„æ—¶å€™ï¼Œå‘çŽ°é¡µé¢çš„é®ç½©å±‚å¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ‰‹åŠ¨åˆ é™¤ï¼š123$("modal").bind('hide.bs.modal', function() &#123; $(".modal-backdrop").remove();&#125;)]]></content>
      <tags>
        <tag>Bootstrap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MyBatisé€šç”¨Mapperå’ŒPageHelper]]></title>
    <url>%2FMyBatis%20common%20Mapper%20PageHelper.html</url>
    <content type="text"><![CDATA[å¦‚æžœé¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº†MyBatisæ¡†æž¶ï¼Œé‚£ä¹ˆä½¿ç”¨é€šç”¨Mapperå’ŒPageHelperåˆ†é¡µæ’ä»¶å°†æžå¤§çš„ç®€åŒ–æˆ‘ä»¬çš„æ“ä½œã€‚é€šç”¨Mapperå¯ä»¥ç®€åŒ–å¯¹å•è¡¨çš„CRUDæ“ä½œï¼ŒPageHelperåˆ†é¡µæ’ä»¶å¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨æ‹¼æŽ¥åˆ†é¡µSQLï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨MyBatis Geneatoræ¥è‡ªåŠ¨ç”Ÿæˆå®žä½“ç±»ï¼ŒMapperæŽ¥å£å’ŒMapper xmlä»£ç ï¼Œéžå¸¸çš„æ–¹ä¾¿ã€‚æ’ä»¶åœ°å€åŠä½œè€…é“¾æŽ¥https://gitee.com/freeã€‚å¼•å…¥ä¾èµ–è¿™é‡Œä½¿ç”¨Spring Bootæ¥æž„å»ºï¼Œå¯å‚è€ƒSpring-Bootä¸­ä½¿ç”¨Mybatis.htmlæ­å»ºä¸€ä¸ªSpring boot + MyBatisçš„æ¡†æž¶ï¼Œç„¶åŽåœ¨pomä¸­å¼•å…¥ï¼š123456789101112131415161718&lt;!-- mybatis --&gt;&lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.3.1&lt;/version&gt;&lt;/dependency&gt;&lt;!-- é€šç”¨mapper --&gt;&lt;dependency&gt; &lt;groupId&gt;tk.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mapper-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.5&lt;/version&gt;&lt;/dependency&gt;&lt;!-- pagehelper åˆ†é¡µæ’ä»¶ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt; &lt;artifactId&gt;pagehelper-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.2.3&lt;/version&gt;&lt;/dependency&gt;æŽ¥ç€åœ¨pomä¸­é…ç½®MyBatis Geneatorï¼š123456789101112131415161718192021222324252627282930313233343536373839&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.3.5&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;!-- æ•°æ®åº“è¿žæŽ¥é©±åŠ¨ --&gt; &lt;groupId&gt;com.oracle&lt;/groupId&gt; &lt;artifactId&gt;ojdbc6&lt;/artifactId&gt; &lt;version&gt;6.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;tk.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mapper&lt;/artifactId&gt; &lt;version&gt;3.4.0&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;Generate MyBatis Artifacts&lt;/id&gt; &lt;phase&gt;package&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;generate&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;configuration&gt; &lt;!--å…è®¸ç§»åŠ¨ç”Ÿæˆçš„æ–‡ä»¶ --&gt; &lt;verbose&gt;true&lt;/verbose&gt; &lt;!-- æ˜¯å¦è¦†ç›– --&gt; &lt;overwrite&gt;true&lt;/overwrite&gt; &lt;!-- è‡ªåŠ¨ç”Ÿæˆçš„é…ç½® --&gt; &lt;configurationFile&gt;src/main/resources/mybatis-generator.xml&lt;/configurationFile&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt;src/main/resources/mybatis-generator.xmlä¸ºç”Ÿæˆå™¨çš„é…ç½®ï¼Œä¸‹æ–‡ä¼šä»‹ç»åˆ°ã€‚é…ç½®æ’ä»¶åœ¨Spring Booté…ç½®æ–‡ä»¶application.ymlä¸­é…ç½®MyBatisï¼š1234567mybatis: # type-aliasesæ‰«æè·¯å¾„ type-aliases-package: com.springboot.bean # mapper xmlå®žçŽ°æ‰«æè·¯å¾„ mapper-locations: classpath:mapper/*.xml property: order: BEFOREæŽ¥ä¸‹æ¥å¼€å§‹é…ç½®æ’ä»¶ã€‚é…ç½®é€šç”¨Mapperåœ¨Spring Booté…ç½®æ–‡ä»¶application.ymlä¸­é…ç½®é€šç”¨Mapperï¼š12345#mappers å¤šä¸ªæŽ¥å£æ—¶é€—å·éš”å¼€mapper: mappers: com.springboot.config.MyMapper not-empty: false identity: oracleå…³äºŽå‚æ•°çš„è¯´æ˜Žï¼Œå‚è€ƒhttps://gitee.com/free/Mapper/blob/master/wiki/mapper3/2.Integration.mdä¸­çš„å¯é…å‚æ•°ä»‹ç»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªMyMapperæŽ¥å£ï¼š123456import tk.mybatis.mapper.common.Mapper;import tk.mybatis.mapper.common.MySqlMapper;public interface MyMapper&lt;T&gt; extends Mapper&lt;T&gt;, MySqlMapper&lt;T&gt; &#123; &#125;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¯¥æŽ¥å£ä¸èƒ½è¢«æ‰«æåˆ°ï¼Œåº”è¯¥å’Œè‡ªå·±å®šä¹‰çš„Mapperåˆ†å¼€ã€‚è‡ªå·±å®šä¹‰çš„Mapperéƒ½éœ€è¦ç»§æ‰¿è¿™ä¸ªæŽ¥å£ã€‚é…ç½®PageHelperåœ¨Spring Booté…ç½®æ–‡ä»¶application.ymlä¸­é…ç½®é€šç”¨é…ç½®PageHelperï¼š123456#pagehelperpagehelper: helperDialect: oracle reasonable: true supportMethodsArguments: true params: count=countSqlå‚æ•°ç›¸å…³è¯´æ˜Žå‚è€ƒhttps://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.mdä¸­çš„åˆ†é¡µæ’ä»¶å‚æ•°ä»‹ç»ã€‚é…ç½®Geneator*åœ¨è·¯å¾„src/main/resources/ä¸‹æ–°å»ºmybatis-generator.xmlï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE generatorConfiguration PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN" "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;&lt;generatorConfiguration&gt; &lt;context id="oracle" targetRuntime="MyBatis3Simple" defaultModelType="flat"&gt; &lt;plugin type="tk.mybatis.mapper.generator.MapperPlugin"&gt; &lt;!-- è¯¥é…ç½®ä¼šä½¿ç”Ÿäº§çš„Mapperè‡ªåŠ¨ç»§æ‰¿MyMapper --&gt; &lt;property name="mappers" value="com.springboot.config.MyMapper" /&gt; &lt;!-- caseSensitiveé»˜è®¤falseï¼Œå½“æ•°æ®åº“è¡¨ååŒºåˆ†å¤§å°å†™æ—¶ï¼Œå¯ä»¥å°†è¯¥å±žæ€§è®¾ç½®ä¸ºtrue --&gt; &lt;property name="caseSensitive" value="false"/&gt; &lt;/plugin&gt; &lt;!-- é˜»æ­¢ç”Ÿæˆè‡ªåŠ¨æ³¨é‡Š --&gt; &lt;commentGenerator&gt; &lt;property name="javaFileEncoding" value="UTF-8"/&gt; &lt;property name="suppressDate" value="true"/&gt; &lt;property name="suppressAllComments" value="true"/&gt; &lt;/commentGenerator&gt; &lt;!-- æ•°æ®åº“é“¾æŽ¥åœ°å€è´¦å·å¯†ç  --&gt; &lt;jdbcConnection driverClass="oracle.jdbc.driver.OracleDriver" connectionURL="jdbc:oracle:thin:@localhost:1521:ORCL" userId="scott" password="6742530"&gt; &lt;/jdbcConnection&gt; &lt;javaTypeResolver&gt; &lt;property name="forceBigDecimals" value="false"/&gt; &lt;/javaTypeResolver&gt; &lt;!-- ç”ŸæˆModelç±»å­˜æ”¾ä½ç½® --&gt; &lt;javaModelGenerator targetPackage="com.springboot.bean" targetProject="src/main/java"&gt; &lt;property name="enableSubPackages" value="true"/&gt; &lt;property name="trimStrings" value="true"/&gt; &lt;/javaModelGenerator&gt; &lt;!-- ç”Ÿæˆæ˜ å°„æ–‡ä»¶å­˜æ”¾ä½ç½® --&gt; &lt;sqlMapGenerator targetPackage="mapper" targetProject="src/main/resources"&gt; &lt;property name="enableSubPackages" value="true"/&gt; &lt;/sqlMapGenerator&gt; &lt;!-- ç”ŸæˆDaoç±»å­˜æ”¾ä½ç½® --&gt; &lt;!-- å®¢æˆ·ç«¯ä»£ç ï¼Œç”Ÿæˆæ˜“äºŽä½¿ç”¨çš„é’ˆå¯¹Modelå¯¹è±¡å’ŒXMLé…ç½®æ–‡ä»¶çš„ä»£ç  type="ANNOTATEDMAPPER",ç”ŸæˆJava Model å’ŒåŸºäºŽæ³¨è§£çš„Mapperå¯¹è±¡ type="XMLMAPPER",ç”ŸæˆSQLMap XMLæ–‡ä»¶å’Œç‹¬ç«‹çš„MapperæŽ¥å£ --&gt; &lt;javaClientGenerator type="XMLMAPPER" targetPackage="com.springboot.mapper" targetProject="src/main/java"&gt; &lt;property name="enableSubPackages" value="true"/&gt; &lt;/javaClientGenerator&gt; &lt;!-- é…ç½®éœ€è¦ç”Ÿæˆçš„è¡¨ --&gt; &lt;table tableName="T_USER" domainObjectName="User" enableCountByExample="false" enableUpdateByExample="false" enableDeleteByExample="false" enableSelectByExample="false" selectByExampleQueryId="false"&gt; &lt;generatedKey column="id" sqlStatement="oralce" identity="true"/&gt; &lt;/table&gt; &lt;/context&gt;&lt;/generatorConfiguration&gt;æ›´è¯¦ç»†çš„è¯´æ˜Žå¯å‚è€ƒé“¾æŽ¥ï¼šhttp://blog.csdn.net/isea533/article/details/42102297ã€‚ä»£ç ç”Ÿæˆé…ç½®å¥½MyBatis GeneatoråŽï¼Œåœ¨eclipseä¸­è¿è¡Œå‘½ä»¤mybatis-generator:generateï¼šä»¥ä¸‹ä¸ºè‡ªåŠ¨æˆæˆçš„ä»£ç ï¼šUserï¼š123456789101112131415161718192021@Table(name = "T_USER")public class User &#123; @Id @Column(name = "ID") @GeneratedValue(strategy = GenerationType.IDENTITY) private Long id; @Column(name = "USERNAME") private String username; @Column(name = "PASSWD") private String passwd; @Column(name = "CREATE_TIME") private Date createTime; @Column(name = "STATUS") private String status; ...&#125;å› ä¸ºè¿™é‡Œæ•°æ®åº“è¯•ç”¨çš„æ˜¯Oracleï¼Œå…¶æ²¡æœ‰ä¸»é”®è‡ªåŠ¨è‡ªå¢žçš„åŠŸèƒ½ï¼Œè¿™é‡Œå…ˆå°†@GeneratedValue(strategy = GenerationType.IDENTITY)åŽ»æŽ‰ï¼Œä¸»é”®çš„ç”Ÿæˆä¸‹é¢ä¼šä»‹ç»åˆ°ã€‚ç”Ÿæˆçš„ä¸»é”®æ˜¯BigDecimalç±»åž‹çš„ï¼Œæˆ‘ä»¬å°†å…¶æ”¹ä¸ºLongç±»åž‹ã€‚UserMapperï¼š12345import com.springboot.bean.User;import com.springboot.config.MyMapper;public interface UserMapper extends MyMapper&lt;User&gt; &#123;&#125;UserMapper.xmlï¼š1234567891011121314&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;&lt;mapper namespace="com.springboot.mapper.UserMapper"&gt; &lt;resultMap id="BaseResultMap" type="com.springboot.bean.User"&gt; &lt;!-- WARNING - @mbg.generated --&gt; &lt;id column="ID" jdbcType="DECIMAL" property="id" /&gt; &lt;result column="USERNAME" jdbcType="VARCHAR" property="username" /&gt; &lt;result column="PASSWD" jdbcType="VARCHAR" property="passwd" /&gt; &lt;result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" /&gt; &lt;result column="STATUS" jdbcType="CHAR" property="status" /&gt; &lt;/resultMap&gt;&lt;/mapper&gt;æžå…¶æ–¹ä¾¿çš„è¯´ï¼Mapperè¦è®©Spring Bootæ‰«æåˆ°MapperæŽ¥å£ï¼Œéœ€è¦åœ¨Spring Bootå…¥å£ç±»ä¸­åŠ å…¥@MapperScan(&quot;com.springboot.mapper&quot;)æ³¨è§£ã€‚ä¸ºäº†èŽ·å–åˆ°Oracle ä¸­åºåˆ—çš„å€¼ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªSeqenceMapperæŽ¥å£ï¼š1234public interface SeqenceMapper &#123; @Select("select $&#123;seqName&#125;.nextval from dual") Long getSequence(@Param("seqName") String seqName);&#125;å› ä¸ºè¿™é‡Œä»…ä»‹ç»Mapperè‡ªå¸¦çš„CRUDæ–¹æ³•ï¼Œæ‰€ä»¥UserMapperæŽ¥å£ä¸­æ— éœ€å®šä¹‰ä»»ä½•æ–¹æ³•ã€‚é€šç”¨Serviceæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªé€šç”¨çš„Serviceï¼Œåœ¨å…¶ä¸­å®šä¹‰ä¸€äº›é€šç”¨çš„æ–¹æ³•ï¼šIServiceï¼š12345678910111213141516171819@Servicepublic interface IService&lt;T&gt; &#123; Long getSequence(@Param("seqName") String seqName); List&lt;T&gt; selectAll(); T selectByKey(Object key); int save(T entity); int delete(Object key); int updateAll(T entity); int updateNotNull(T entity); List&lt;T&gt; selectByExample(Object example);&#125;å…¶å®žçŽ°ç±»BaseServiceï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758public abstract class BaseService&lt;T&gt; implements IService&lt;T&gt; &#123; @Autowired protected Mapper&lt;T&gt; mapper; @Autowired protected SeqenceMapper seqenceMapper; public Mapper&lt;T&gt; getMapper() &#123; return mapper; &#125; @Override public Long getSequence(@Param("seqName") String seqName)&#123; return seqenceMapper.getSequence(seqName); &#125; @Override public List&lt;T&gt; selectAll() &#123; //è¯´æ˜Žï¼šæŸ¥è¯¢æ‰€æœ‰æ•°æ® return mapper.selectAll(); &#125; @Override public T selectByKey(Object key) &#123; //è¯´æ˜Žï¼šæ ¹æ®ä¸»é”®å­—æ®µè¿›è¡ŒæŸ¥è¯¢ï¼Œæ–¹æ³•å‚æ•°å¿…é¡»åŒ…å«å®Œæ•´çš„ä¸»é”®å±žæ€§ï¼ŒæŸ¥è¯¢æ¡ä»¶ä½¿ç”¨ç­‰å· return mapper.selectByPrimaryKey(key); &#125; @Override public int save(T entity) &#123; //è¯´æ˜Žï¼šä¿å­˜ä¸€ä¸ªå®žä½“ï¼Œnullçš„å±žæ€§ä¹Ÿä¼šä¿å­˜ï¼Œä¸ä¼šä½¿ç”¨æ•°æ®åº“é»˜è®¤å€¼ return mapper.insert(entity); &#125; @Override public int delete(Object key) &#123; //è¯´æ˜Žï¼šæ ¹æ®ä¸»é”®å­—æ®µè¿›è¡Œåˆ é™¤ï¼Œæ–¹æ³•å‚æ•°å¿…é¡»åŒ…å«å®Œæ•´çš„ä¸»é”®å±žæ€§ return mapper.deleteByPrimaryKey(key); &#125; @Override public int updateAll(T entity) &#123; //è¯´æ˜Žï¼šæ ¹æ®ä¸»é”®æ›´æ–°å®žä½“å…¨éƒ¨å­—æ®µï¼Œnullå€¼ä¼šè¢«æ›´æ–° return mapper.updateByPrimaryKey(entity); &#125; @Override public int updateNotNull(T entity) &#123; //æ ¹æ®ä¸»é”®æ›´æ–°å±žæ€§ä¸ä¸ºnullçš„å€¼ return mapper.updateByPrimaryKeySelective(entity); &#125; @Override public List&lt;T&gt; selectByExample(Object example) &#123; //è¯´æ˜Žï¼šæ ¹æ®Exampleæ¡ä»¶è¿›è¡ŒæŸ¥è¯¢ //é‡ç‚¹ï¼šè¿™ä¸ªæŸ¥è¯¢æ”¯æŒé€šè¿‡Exampleç±»æŒ‡å®šæŸ¥è¯¢åˆ—ï¼Œé€šè¿‡selectPropertiesæ–¹æ³•æŒ‡å®šæŸ¥è¯¢åˆ— return mapper.selectByExample(example); &#125;&#125;æŽ¥ä¸‹æ¥è®©UserServiceæŽ¥å£ç»§æ‰¿IServiceæŽ¥å£ï¼š123public interface UserService extends IService&lt;User&gt;&#123; &#125;å…¶å®žçŽ°ç±»UserServiceImplï¼š1234@Repository("userService")public class UserServiceImpl extends BaseService&lt;User&gt; implements UserService&#123; &#125;è¿™æ ·å³å¯åœ¨UserServiceä¸­ä½¿ç”¨BaseServiceä¸­çš„é€šç”¨æ–¹æ³•äº†ã€‚æµ‹è¯•æµ‹è¯•æ’å…¥ï¼š1234567891011121314151617@RunWith(SpringJUnit4ClassRunner.class)@SpringBootTest(classes = Application.class)public class ApplicationTest &#123; @Autowired private UserService userService; @Test public void test() throws Exception &#123; User user = new User(); user.setId(userService.getSequence("seq_user")); user.setUsername("scott"); user.setPasswd("ac089b11709f9b9e9980e7c497268dfa"); user.setCreateTime(new Date()); user.setStatus("0"); this.userService.save(user); &#125;&#125;è¿è¡Œä»£ç ï¼ŒæŸ¥çœ‹æ•°æ®åº“ï¼šæµ‹è¯•æŸ¥è¯¢ï¼š1234567891011121314151617Example example = new Example(User.class);example.createCriteria().andCondition("username like '%i%'");example.setOrderByClause("id desc");List&lt;User&gt; userList = this.userService.selectByExample(example);for (User u : userList) &#123; System.out.println(u.getUsername());&#125;List&lt;User&gt; all = this.userService.selectAll();for (User u : all) &#123; System.out.println(u.getUsername());&#125;User user = new User();user.setId(1l);user = this.userService.selectByKey(user);System.out.println(user.getUsername());æµ‹è¯•åˆ é™¤ï¼š123User user = new User();user.setId(4l);this.userService.delete(user);åˆ†é¡µæµ‹è¯•ï¼Œä»Žç¬¬äºŒé¡µå¼€å§‹ï¼Œæ¯é¡µ2æ¡æ•°æ®ï¼š1234567PageHelper.startPage(2, 2);List&lt;User&gt; list = userService.selectAll();PageInfo&lt;User&gt; pageInfo = new PageInfo&lt;User&gt;(list);List&lt;User&gt; result = pageInfo.getList();for (User u : result) &#123; System.out.println(u.getUsername());&#125;æŸ¥çœ‹æ—¥å¿—æ‰“å°å‡ºçš„SQLï¼š12342017-12-28 10:25:14.033 DEBUG 11116 --- [main] c.s.mapper.UserMapper.selectAll : ==&gt; Preparing: SELECT * FROM ( SELECT TMP_PAGE.*, ROWNUM ROW_ID FROM ( SELECT ID,USERNAME,PASSWD,CREATE_TIME,STATUS FROM T_USER ) TMP_PAGE WHERE ROWNUM &lt;= ? ) WHERE ROW_ID &gt; ? 2017-12-28 10:25:14.068 DEBUG 11116 --- [main] c.s.mapper.UserMapper.selectAll : ==&gt; Parameters: 4(Integer), 2(Integer)2017-12-28 10:25:14.073 DEBUG 11116 --- [main] c.s.mapper.UserMapper.selectAll : &lt;== Total: 2æ’ä»¶å·²ç»å¸®æˆ‘è‡ªåŠ¨æ‹¼æŽ¥å¥½äº†ã€‚å…¶ä»–æ³¨æ„äº‹é¡¹å‚è€ƒå®˜æ–¹è¯´æ˜Žã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/27.Spring-Boot-Mapper-PageHelper]]></content>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot Shiroåœ¨çº¿ä¼šè¯ç®¡ç†]]></title>
    <url>%2FSpring-Boot-Shiro%20session.html</url>
    <content type="text"><![CDATA[åœ¨Shiroä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡org.apache.shiro.session.mgt.eis.SessionDAOå¯¹è±¡çš„getActiveSessions()æ–¹æ³•æ–¹ä¾¿çš„èŽ·å–åˆ°å½“å‰æ‰€æœ‰æœ‰æ•ˆçš„Sessionå¯¹è±¡ã€‚é€šè¿‡è¿™äº›Sessionå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å®žçŽ°ä¸€äº›æ¯”è¾ƒæœ‰è¶£çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„åœ¨çº¿äººæ•°ï¼ŒæŸ¥çœ‹è¿™äº›åœ¨çº¿ç”¨æˆ·çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œå¼ºåˆ¶è®©æŸä¸ªç”¨æˆ·ä¸‹çº¿ç­‰ã€‚ä¸ºäº†è¾¾åˆ°è¿™å‡ ä¸ªç›®æ ‡ï¼Œæˆ‘ä»¬åœ¨çŽ°æœ‰çš„Spring Boot Shiroé¡¹ç›®åŸºç¡€ä¸Šè¿›è¡Œä¸€äº›æ”¹é€ ï¼ˆç¼“å­˜ä½¿ç”¨Ehcacheï¼‰ã€‚æ›´æ”¹ShiroConfigä¸ºäº†èƒ½å¤Ÿåœ¨Spring Bootä¸­ä½¿ç”¨SessionDaoï¼Œæˆ‘ä»¬åœ¨ShiroConfigä¸­é…ç½®è¯¥Beanï¼š12345@Beanpublic SessionDAO sessionDAO() &#123; MemorySessionDAO sessionDAO = new MemorySessionDAO(); return sessionDAO;&#125;å¦‚æžœä½¿ç”¨çš„æ˜¯Redisä½œä¸ºç¼“å­˜å®žçŽ°ï¼Œé‚£ä¹ˆSessionDAOåˆ™ä¸ºRedisSessionDAOï¼š123456@Beanpublic RedisSessionDAO sessionDAO() &#123; RedisSessionDAO redisSessionDAO = new RedisSessionDAO(); redisSessionDAO.setRedisManager(redisManager()); return redisSessionDAO;&#125;åœ¨Shiroä¸­ï¼ŒSessionDaoé€šè¿‡org.apache.shiro.session.mgt.SessionManagerè¿›è¡Œç®¡ç†ï¼Œæ‰€ä»¥ç»§ç»­åœ¨ShiroConfigä¸­é…ç½®SessionManagerï¼š123456789@Beanpublic SessionManager sessionManager() &#123; DefaultWebSessionManager sessionManager = new DefaultWebSessionManager(); Collection&lt;SessionListener&gt; listeners = new ArrayList&lt;SessionListener&gt;(); listeners.add(new ShiroSessionListener()); sessionManager.setSessionListeners(listeners); sessionManager.setSessionDAO(sessionDAO()); return sessionManager;&#125;å…¶ä¸­ShiroSessionListenerä¸ºorg.apache.shiro.session.SessionListeneræŽ¥å£çš„æ‰‹åŠ¨å®žçŽ°ï¼Œæ‰€ä»¥æŽ¥ä¸‹æ¥å®šä¹‰ä¸€ä¸ªè¯¥æŽ¥å£çš„å®žçŽ°ï¼š123456789101112131415161718public class ShiroSessionListener implements SessionListener&#123; private final AtomicInteger sessionCount = new AtomicInteger(0); @Override public void onStart(Session session) &#123; sessionCount.incrementAndGet(); &#125; @Override public void onStop(Session session) &#123; sessionCount.decrementAndGet(); &#125; @Override public void onExpiration(Session session) &#123; sessionCount.decrementAndGet(); &#125;&#125;å…¶ç»´æŠ¤ç€ä¸€ä¸ªåŽŸå­ç±»åž‹çš„Integerå¯¹è±¡ï¼Œç”¨äºŽç»Ÿè®¡åœ¨çº¿Sessionçš„æ•°é‡ã€‚å®šä¹‰å®ŒSessionManageråŽï¼Œè¿˜éœ€å°†å…¶æ³¨å…¥åˆ°SecurityManagerä¸­ï¼š12345678@Bean public SecurityManager securityManager()&#123; DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager(); securityManager.setRealm(shiroRealm()); ... securityManager.setSessionManager(sessionManager()); return securityManager; &#125;UserOnlineé…ç½®å®ŒShiroConfigåŽï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªUserOnlineå®žä½“ç±»ï¼Œç”¨äºŽæè¿°æ¯ä¸ªåœ¨çº¿ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼š1234567891011121314151617181920212223public class UserOnline implements Serializable&#123; private static final long serialVersionUID = 3828664348416633856L; // session id private String id; // ç”¨æˆ·id private String userId; // ç”¨æˆ·åç§° private String username; // ç”¨æˆ·ä¸»æœºåœ°å€ private String host; // ç”¨æˆ·ç™»å½•æ—¶ç³»ç»ŸIP private String systemHost; // çŠ¶æ€ private String status; // sessionåˆ›å»ºæ—¶é—´ private Date startTimestamp; // sessionæœ€åŽè®¿é—®æ—¶é—´ private Date lastAccessTime; // è¶…æ—¶æ—¶é—´ private Long timeout; // get setç•¥&#125;Serviceåˆ›å»ºä¸€ä¸ªServiceæŽ¥å£ï¼ŒåŒ…å«æŸ¥çœ‹æ‰€æœ‰åœ¨çº¿ç”¨æˆ·å’Œæ ¹æ®SessionIdè¸¢å‡ºç”¨æˆ·æŠ½è±¡æ–¹æ³•ï¼š1234public interface SessionService &#123; List&lt;UserOnline&gt; list(); boolean forceLogout(String sessionId);&#125;å…¶å…·ä½“å®žçŽ°ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445@Service("sessionService")public class SessionServiceImpl implements SessionService &#123; @Autowired private SessionDAO sessionDAO; @Override public List&lt;UserOnline&gt; list() &#123; List&lt;UserOnline&gt; list = new ArrayList&lt;&gt;(); Collection&lt;Session&gt; sessions = sessionDAO.getActiveSessions(); for (Session session : sessions) &#123; UserOnline userOnline = new UserOnline(); User user = new User(); SimplePrincipalCollection principalCollection = new SimplePrincipalCollection(); if (session.getAttribute(DefaultSubjectContext.PRINCIPALS_SESSION_KEY) == null) &#123; continue; &#125; else &#123; principalCollection = (SimplePrincipalCollection) session .getAttribute(DefaultSubjectContext.PRINCIPALS_SESSION_KEY); user = (User) principalCollection.getPrimaryPrincipal(); userOnline.setUsername(user.getUserName()); userOnline.setUserId(user.getId().toString()); &#125; userOnline.setId((String) session.getId()); userOnline.setHost(session.getHost()); userOnline.setStartTimestamp(session.getStartTimestamp()); userOnline.setLastAccessTime(session.getLastAccessTime()); Long timeout = session.getTimeout(); if (timeout == 0l) &#123; userOnline.setStatus("ç¦»çº¿"); &#125; else &#123; userOnline.setStatus("åœ¨çº¿"); &#125; userOnline.setTimeout(timeout); list.add(userOnline); &#125; return list; &#125; @Override public boolean forceLogout(String sessionId) &#123; Session session = sessionDAO.readSession(sessionId); session.setTimeout(0); return true; &#125;&#125;é€šè¿‡SessionDaoçš„getActiveSessions()æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥èŽ·å–æ‰€æœ‰æœ‰æ•ˆçš„Sessionï¼Œé€šè¿‡è¯¥Sessionï¼Œæˆ‘ä»¬è¿˜å¯ä»¥èŽ·å–åˆ°å½“å‰ç”¨æˆ·çš„Principalä¿¡æ¯ã€‚å€¼å¾—è¯´æ˜Žçš„æ˜¯ï¼Œå½“æŸä¸ªç”¨æˆ·è¢«è¸¢å‡ºåŽï¼ˆSession Timeç½®ä¸º0ï¼‰ï¼Œè¯¥Sessionå¹¶ä¸ä¼šç«‹åˆ»ä»ŽActiveSessionsä¸­å‰”é™¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶timeoutä¿¡æ¯æ¥åˆ¤æ–­è¯¥ç”¨æˆ·åœ¨çº¿ä¸Žå¦ã€‚å¦‚æžœä½¿ç”¨çš„Redisä½œä¸ºç¼“å­˜å®žçŽ°ï¼Œé‚£ä¹ˆï¼ŒforceLogout()æ–¹æ³•éœ€è¦ç¨ä½œä¿®æ”¹ï¼š123456@Overridepublic boolean forceLogout(String sessionId) &#123; Session session = sessionDAO.readSession(sessionId); sessionDAO.delete(session); return true;&#125;Controllerå®šä¹‰ä¸€ä¸ªSessionContollerï¼Œç”¨äºŽå¤„ç†Sessionçš„ç›¸å…³æ“ä½œï¼š1234567891011121314151617181920212223242526272829@Controller@RequestMapping("/online")public class SessionController &#123; @Autowired SessionService sessionService; @RequestMapping("index") public String online() &#123; return "online"; &#125; @ResponseBody @RequestMapping("list") public List&lt;UserOnline&gt; list() &#123; return sessionService.list(); &#125; @ResponseBody @RequestMapping("forceLogout") public ResponseBo forceLogout(String id) &#123; try &#123; sessionService.forceLogout(id); return ResponseBo.ok(); &#125; catch (Exception e) &#123; e.printStackTrace(); return ResponseBo.error("è¸¢å‡ºç”¨æˆ·å¤±è´¥"); &#125; &#125;&#125;é¡µé¢æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªonline.htmlé¡µé¢ï¼Œç”¨äºŽå±•ç¤ºæ‰€æœ‰åœ¨çº¿ç”¨æˆ·çš„ä¿¡æ¯ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;åœ¨çº¿ç”¨æˆ·ç®¡ç†&lt;/title&gt; &lt;script th:src="@&#123;/js/jquery-1.11.1.min.js&#125;"&gt;&lt;/script&gt; &lt;script th:src="@&#123;/js/dateFormat.js&#125;"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;h3&gt;åœ¨çº¿ç”¨æˆ·æ•°ï¼š&lt;span id="onlineCount"&gt;&lt;/span&gt;&lt;/h3&gt; &lt;table&gt; &lt;tr&gt; &lt;th&gt;åºå·&lt;/th&gt; &lt;th&gt;ç”¨æˆ·åç§°&lt;/th&gt; &lt;th&gt;ç™»å½•æ—¶é—´&lt;/th&gt; &lt;th&gt;æœ€åŽè®¿é—®æ—¶é—´&lt;/th&gt; &lt;th&gt;ä¸»æœº&lt;/th&gt; &lt;th&gt;çŠ¶æ€&lt;/th&gt; &lt;th&gt;æ“ä½œ&lt;/th&gt; &lt;/tr&gt; &lt;/table&gt; &lt;a th:href="@&#123;/index&#125;"&gt;è¿”å›ž&lt;/a&gt;&lt;/body&gt;&lt;script th:inline="javascript"&gt; var ctx = [[@&#123;/&#125;]]; $.get(ctx + "online/list", &#123;&#125;, function(r)&#123; var length = r.length; $("#onlineCount").text(length); var html = ""; for(var i = 0; i &lt; length; i++)&#123; html += "&lt;tr&gt;" + "&lt;td&gt;" + (i+1) + "&lt;/td&gt;" + "&lt;td&gt;" + r[i].username + "&lt;/td&gt;" + "&lt;td&gt;" + new Date(r[i].startTimestamp).Format("yyyy-MM-dd hh:mm:ss") + "&lt;/td&gt;" + "&lt;td&gt;" + new Date(r[i].lastAccessTime).Format("yyyy-MM-dd hh:mm:ss") + "&lt;/td&gt;" + "&lt;td&gt;" + r[i].host + "&lt;/td&gt;" + "&lt;td&gt;" + r[i].status + "&lt;/td&gt;" + "&lt;td&gt;&lt;a href='#' onclick='offline(\"" + r[i].id + "\",\"" + r[i].status +"\")'&gt;ä¸‹çº¿&lt;/a&gt;&lt;/td&gt;" + "&lt;/tr&gt;"; &#125; $("table").append(html); &#125;,"json"); function offline(id,status)&#123; if(status == "ç¦»çº¿")&#123; alert("è¯¥ç”¨æˆ·å·²æ˜¯ç¦»çº¿çŠ¶æ€ï¼ï¼"); return; &#125; $.get(ctx + "online/forceLogout", &#123;"id": id&#125;, function(r)&#123; if (r.code == 0) &#123; alert('è¯¥ç”¨æˆ·å·²å¼ºåˆ¶ä¸‹çº¿ï¼'); location.href = ctx + 'online/index'; &#125; else &#123; alert(r.msg); &#125; &#125;,"json"); &#125;&lt;/script&gt;&lt;/html&gt;åœ¨index.htmlä¸­åŠ å…¥è¯¥é¡µé¢çš„å…¥å£ï¼š1234567891011121314...&lt;body&gt; &lt;p&gt;ä½ å¥½ï¼[[$&#123;user.userName&#125;]]&lt;/p&gt; &lt;p shiro:hasRole="admin"&gt;ä½ çš„è§’è‰²ä¸ºè¶…çº§ç®¡ç†å‘˜&lt;/p&gt; &lt;p shiro:hasRole="test"&gt;ä½ çš„è§’è‰²ä¸ºæµ‹è¯•è´¦æˆ·&lt;/p&gt; &lt;div&gt; &lt;a shiro:hasPermission="user:user" th:href="@&#123;/user/list&#125;"&gt;èŽ·å–ç”¨æˆ·ä¿¡æ¯&lt;/a&gt; &lt;a shiro:hasPermission="user:add" th:href="@&#123;/user/add&#125;"&gt;æ–°å¢žç”¨æˆ·&lt;/a&gt; &lt;a shiro:hasPermission="user:delete" th:href="@&#123;/user/delete&#125;"&gt;åˆ é™¤ç”¨æˆ·&lt;/a&gt; &lt;/div&gt; &lt;a shiro:hasRole="admin" th:href="@&#123;/online/index&#125;"&gt;åœ¨çº¿ç”¨æˆ·ç®¡ç†&lt;/a&gt; &lt;a th:href="@&#123;/logout&#125;"&gt;æ³¨é”€&lt;/a&gt;&lt;/body&gt;...æµ‹è¯•å¯åŠ¨é¡¹ç›®ï¼Œåœ¨Operaæµè§ˆå™¨ä¸­ä½¿ç”¨mrbirdè´¦æˆ·è®¿é—®ï¼šåœ¨FireFoxæµè§ˆå™¨ä¸­ä½¿ç”¨testerè´¦æˆ·è®¿é—®ï¼šç„¶åŽåœ¨mrbirdä¸»ç•Œé¢ç‚¹å‡»â€œåœ¨çº¿ç”¨æˆ·ç®¡ç†â€ï¼šæ˜¾ç¤ºçš„ä¿¡æ¯ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œç‚¹å‡»testerçš„ä¸‹çº¿æŒ‰é’®ï¼Œå¼ºåˆ¶å°†å…¶è¸¢å‡ºï¼šå›žåˆ°testerç”¨æˆ·çš„ä¸»ç•Œé¢ï¼Œç‚¹å‡»â€œæŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯â€ï¼Œä¼šå‘çŽ°é¡µé¢å·²ç»è¢«é‡å®šå‘åˆ°loginé¡µé¢ï¼Œå› ä¸ºå…¶Sessionå·²ç»å¤±æ•ˆï¼å†æ¬¡åˆ·æ–°mrbirdçš„onlineé¡µé¢ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼šæºç é“¾æŽ¥ï¼ˆEhcacheç‰ˆï¼‰ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/17.Spring-Boot-Shiro-Sessionæºç é“¾æŽ¥ï¼ˆRedisç‰ˆï¼‰ï¼šhttps://drive.google.com/open?id=1GHJxnoX2rZuQXtMYpNv-TE5SHRwyqSN7]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Shiro</tag>
        <tag>Security</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot Thymeleafä¸­ä½¿ç”¨Shiroæ ‡ç­¾]]></title>
    <url>%2FSpring-Boot-Themeleaf%20Shiro%20tag.html</url>
    <content type="text"><![CDATA[åœ¨ã€ŠSpring-Boot-shiroæƒé™æŽ§åˆ¶ã€‹ä¸­ï¼Œå½“ç”¨æˆ·è®¿é—®æ²¡æœ‰æƒé™çš„èµ„æºæ—¶ï¼Œæˆ‘ä»¬é‡‡å–çš„åšæ³•æ˜¯è·³è½¬åˆ°403é¡µé¢ï¼Œä½†åœ¨å®žé™…é¡¹ç›®ä¸­æ›´ä¸ºå¸¸è§çš„åšæ³•æ˜¯åªæ˜¾ç¤ºå½“å‰ç”¨æˆ·æ‹¥æœ‰è®¿é—®æƒé™çš„èµ„æºé“¾æŽ¥ã€‚é…åˆThymeleafä¸­çš„Shiroæ ‡ç­¾å¯ä»¥å¾ˆç®€å•çš„å®žçŽ°è¿™ä¸ªç›®æ ‡ã€‚å®žé™…ä¸ŠThymeleafå®˜æ–¹å¹¶æ²¡æœ‰æä¾›Shiroçš„æ ‡ç­¾ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥ç¬¬ä¸‰æ–¹å®žçŽ°ï¼Œåœ°å€ä¸ºhttps://github.com/theborakompanioni/thymeleaf-extras-shiroã€‚å¼•å…¥thymeleaf-extras-shiroåœ¨pomä¸­å¼•å…¥ï¼š12345&lt;dependency&gt; &lt;groupId&gt;com.github.theborakompanioni&lt;/groupId&gt; &lt;artifactId&gt;thymeleaf-extras-shiro&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt;&lt;/dependency&gt;ShiroConfigé…ç½®å¼•å…¥ä¾èµ–åŽï¼Œéœ€è¦åœ¨ShiroConfigä¸­é…ç½®è¯¥æ–¹è¨€æ ‡ç­¾ï¼š1234 @Beanpublic ShiroDialect shiroDialect() &#123; return new ShiroDialect();&#125;é¦–é¡µæ”¹é€ æ›´æ”¹index.htmlï¼Œç”¨äºŽæµ‹è¯•Shiroæ ‡ç­¾çš„ä½¿ç”¨ï¼š12345678910111213141516171819 &lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro" &gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;é¦–é¡µ&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;ä½ å¥½ï¼[[$&#123;user.userName&#125;]]&lt;/p&gt; &lt;p shiro:hasRole="admin"&gt;ä½ çš„è§’è‰²ä¸ºè¶…çº§ç®¡ç†å‘˜&lt;/p&gt; &lt;p shiro:hasRole="test"&gt;ä½ çš„è§’è‰²ä¸ºæµ‹è¯•è´¦æˆ·&lt;/p&gt; &lt;div&gt; &lt;a shiro:hasPermission="user:user" th:href="@&#123;/user/list&#125;"&gt;èŽ·å–ç”¨æˆ·ä¿¡æ¯&lt;/a&gt; &lt;a shiro:hasPermission="user:add" th:href="@&#123;/user/add&#125;"&gt;æ–°å¢žç”¨æˆ·&lt;/a&gt; &lt;a shiro:hasPermission="user:delete" th:href="@&#123;/user/delete&#125;"&gt;åˆ é™¤ç”¨æˆ·&lt;/a&gt; &lt;/div&gt; &lt;a th:href="@&#123;/logout&#125;"&gt;æ³¨é”€&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨htmlé¡µé¢ä¸­ä½¿ç”¨Shiroæ ‡ç­¾éœ€è¦ç»™htmlæ ‡ç­¾æ·»åŠ xmlns:shiro=&quot;http://www.pollix.at/thymeleaf/shiro&quot;ã€‚æµ‹è¯•å¯åŠ¨é¡¹ç›®ï¼Œä½¿ç”¨mrbirdï¼ˆè§’è‰²ä¸ºadminï¼Œå…·æœ‰user:userï¼Œuser:addï¼Œuser:deleteæƒé™ï¼‰è´¦æˆ·ç™»å½•ï¼šä½¿ç”¨testerï¼ˆè§’è‰²ä¸ºtesterï¼Œä»…æœ‰user:useræƒé™ï¼‰è´¦æˆ·ç™»å½•ï¼šæ›´å¤šæ ‡ç­¾The following examples show how to integrate the tags in your Thymeleaf templates. These are all implementations of the examples given in the JSP / GSP Tag Library Section of the Apache Shiro documentation.Tags can be written in attribute or element notation:Attribute123&lt;p shiro:anyTag&gt; Goodbye cruel World!&lt;/p&gt;Element123&lt;shiro:anyTag&gt; &lt;p&gt;Hello World!&lt;/p&gt;&lt;/shiro:anyTag&gt;The guest tag123&lt;p shiro:guest=""&gt; Please &lt;a href="login.html"&gt;Login&lt;/a&gt;&lt;/p&gt;The user tag123&lt;p shiro:user=""&gt; Welcome back John! Not John? Click &lt;a href="login.html"&gt;here&lt;a&gt; to login.&lt;/p&gt;The authenticated tag1&lt;a shiro:authenticated="" href="updateAccount.html"&gt;Update your contact information&lt;/a&gt;The notAuthenticated tag123&lt;p shiro:notAuthenticated=""&gt; Please &lt;a href="login.html"&gt;login&lt;/a&gt; in order to update your credit card information.&lt;/p&gt;The principal tag1&lt;p&gt;Hello, &lt;span shiro:principal=""&gt;&lt;/span&gt;, how are you today?&lt;/p&gt;or1&lt;p&gt;Hello, &lt;shiro:principal/&gt;, how are you today?&lt;/p&gt;Typed principal and principal property are also supported.The hasRole tag1&lt;a shiro:hasRole="administrator" href="admin.html"&gt;Administer the system&lt;/a&gt;The lacksRole tag123&lt;p shiro:lacksRole="administrator"&gt; Sorry, you are not allowed to administer the system.&lt;/p&gt;The hasAllRoles tag123&lt;p shiro:hasAllRoles="developer, project manager"&gt; You are a developer and a project manager.&lt;/p&gt;The hasAnyRoles tag123&lt;p shiro:hasAnyRoles="developer, project manager, administrator"&gt; You are a developer, project manager, or administrator.&lt;/p&gt;The hasPermission tag1&lt;a shiro:hasPermission="user:create" href="createUser.html"&gt;Create a new User&lt;/a&gt;The lacksPermission tag123&lt;p shiro:lacksPermission="user:delete"&gt; Sorry, you are not allowed to delete user accounts.&lt;/p&gt;The hasAllPermissions tag123&lt;p shiro:hasAllPermissions="user:create, user:delete"&gt; You can create and delete users.&lt;/p&gt;The hasAnyPermissions tag123&lt;p shiro:hasAnyPermissions="user:create, user:delete"&gt; You can create or delete users.&lt;/p&gt;æºç åœ°å€ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/16.Spring-Boot-Shiro-Thymeleaf-Tag]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Shiro</tag>
        <tag>Security</tag>
        <tag>Spring Boot</tag>
        <tag>Thymeleaf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot Shiroä¸­ä½¿ç”¨ç¼“å­˜]]></title>
    <url>%2FSpring-Boot-Shiro%20cache.html</url>
    <content type="text"><![CDATA[åœ¨Shiroä¸­åŠ å…¥ç¼“å­˜å¯ä»¥ä½¿æƒé™ç›¸å…³æ“ä½œå°½å¯èƒ½å¿«ï¼Œé¿å…é¢‘ç¹è®¿é—®æ•°æ®åº“èŽ·å–æƒé™ä¿¡æ¯ï¼Œå› ä¸ºå¯¹äºŽä¸€ä¸ªç”¨æˆ·æ¥è¯´ï¼Œå…¶æƒé™åœ¨çŸ­æ—¶é—´å†…åŸºæœ¬æ˜¯ä¸ä¼šå˜åŒ–çš„ã€‚Shiroæä¾›äº†Cacheçš„æŠ½è±¡ï¼Œå…¶å¹¶æ²¡æœ‰ç›´æŽ¥æä¾›ç›¸åº”çš„å®žçŽ°ï¼Œå› ä¸ºè¿™å·²ç»è¶…å‡ºäº†ä¸€ä¸ªå®‰å…¨æ¡†æž¶çš„èŒƒå›´ã€‚åœ¨Shiroä¸­å¯ä»¥é›†æˆå¸¸ç”¨çš„ç¼“å­˜å®žçŽ°ï¼Œè¿™é‡Œä»‹ç»åŸºäºŽRediså’ŒEhcacheç¼“å­˜çš„å®žçŽ°ã€‚åœ¨ã€ŠSpring-Boot-shiroæƒé™æŽ§åˆ¶ã€‹ä¸­ï¼Œå½“ç”¨æˆ·è®¿é—®â€èŽ·å–ç”¨æˆ·ä¿¡æ¯â€ã€â€æ–°å¢žç”¨æˆ·â€å’Œâ€åˆ é™¤ç”¨æˆ·â€çš„æ—¶å€™ï¼ŒåŽå°è¾“å‡ºäº†ä¸‰æ¬¡æ‰“å°ä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š123ç”¨æˆ·mrbirdèŽ·å–æƒé™-----ShiroRealm.doGetAuthorizationInfoç”¨æˆ·mrbirdèŽ·å–æƒé™-----ShiroRealm.doGetAuthorizationInfoç”¨æˆ·mrbirdèŽ·å–æƒé™-----ShiroRealm.doGetAuthorizationInfoè¯´æ˜Žåœ¨è¿™ä¸‰æ¬¡è®¿é—®ä¸­ï¼ŒShiroéƒ½ä¼šä»Žæ•°æ®åº“ä¸­èŽ·å–ç”¨æˆ·çš„æƒé™ä¿¡æ¯ï¼Œé€šè¿‡Druidæ•°æ®æºSQLç›‘æŽ§åŽå°ä¹Ÿå¯ä»¥è¯å®žè¿™ä¸€ç‚¹ï¼šè¿™å¯¹æ•°æ®åº“æ¥è¯´æ˜¯æ²¡å¿…è¦çš„æ¶ˆè€—ã€‚æŽ¥ä¸‹æ¥ä½¿ç”¨ç¼“å­˜æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚Rediså¼•å…¥Redisä¾èµ–ç½‘ç»œä¸Šå·²ç»æœ‰å…³äºŽShiroé›†æˆRedisçš„å®žçŽ°ï¼Œæˆ‘ä»¬å¼•å…¥å³å¯ï¼š123456&lt;!-- shiro-redis --&gt;&lt;dependency&gt; &lt;groupId&gt;org.crazycake&lt;/groupId&gt; &lt;artifactId&gt;shiro-redis&lt;/artifactId&gt; &lt;version&gt;2.4.2.1-RELEASE&lt;/version&gt;&lt;/dependency&gt;é…ç½®Redisæˆ‘ä»¬åœ¨application.ymlé…ç½®æ–‡ä»¶ä¸­åŠ å…¥Redisé…ç½®ï¼š12345678910spring: redis: host: localhost port: 6379 pool: max-active: 8 max-wait: -1 max-idle: 8 min-idle: 0 timeout: 0æŽ¥ç€åœ¨ShiroConfigä¸­é…ç½®Redisï¼š12345678910public RedisManager redisManager() &#123; RedisManager redisManager = new RedisManager(); return redisManager;&#125;public RedisCacheManager cacheManager() &#123; RedisCacheManager redisCacheManager = new RedisCacheManager(); redisCacheManager.setRedisManager(redisManager()); return redisCacheManager;&#125;ä¸Šé¢ä»£ç é…ç½®äº†RedisManagerï¼Œå¹¶å°†å…¶æ³¨å…¥åˆ°äº†RedisCacheManagerä¸­ï¼Œæœ€åŽåœ¨SecurityManagerä¸­åŠ å…¥RedisCacheManagerï¼š1234567@Bean public SecurityManager securityManager()&#123; DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager(); ... securityManager.setCacheManager(cacheManager()); return securityManager; &#125;é…ç½®å®Œæ¯•å¯åŠ¨é¡¹ç›®ï¼Œåˆ†åˆ«è®¿é—®è®¿é—®â€èŽ·å–ç”¨æˆ·ä¿¡æ¯â€ã€â€æ–°å¢žç”¨æˆ·â€å’Œâ€åˆ é™¤ç”¨æˆ·â€ï¼Œå¯å‘çŽ°åŽå°åªæ‰“å°ä¸€æ¬¡èŽ·å–æƒé™ä¿¡æ¯ï¼š1ç”¨æˆ·mrbirdèŽ·å–æƒé™-----ShiroRealm.doGetAuthorizationInfoæŸ¥çœ‹Druidæ•°æ®æºSQLç›‘æŽ§ï¼šæºç ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/14.Spring-Boot-Shiro-RedisEhcacheEhcacheä¾èµ–åŠ å…¥Ehcacheç›¸å…³ä¾èµ–ï¼š123456789101112131415&lt;!-- shiro ehcache --&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt; &lt;artifactId&gt;shiro-ehcache&lt;/artifactId&gt; &lt;version&gt;1.3.2&lt;/version&gt;&lt;/dependency&gt;&lt;!-- ehchache --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt; &lt;artifactId&gt;ehcache&lt;/artifactId&gt;&lt;/dependency&gt;Ehcacheé…ç½®åœ¨src/main/resource/configè·¯å¾„ä¸‹æ–°å¢žä¸€ä¸ªEhcacheé…ç½®â€”â€”shiro-ehcache.xmlï¼š123456789101112131415161718192021222324&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ehcache.org/ehcache.xsd" updateCheck="false"&gt; &lt;diskStore path="java.io.tmpdir/Tmp_EhCache" /&gt; &lt;defaultCache maxElementsInMemory="10000" eternal="false" timeToIdleSeconds="120" timeToLiveSeconds="120" overflowToDisk="false" diskPersistent="false" diskExpiryThreadIntervalSeconds="120" /&gt; &lt;!-- ç™»å½•è®°å½•ç¼“å­˜é”å®š1å°æ—¶ --&gt; &lt;cache name="passwordRetryCache" maxEntriesLocalHeap="2000" eternal="false" timeToIdleSeconds="3600" timeToLiveSeconds="0" overflowToDisk="false" statistics="true" /&gt;&lt;/ehcache&gt;ShiroConfigé…ç½®EhcacheæŽ¥ç€åœ¨ShiroConfigä¸­æ³¨å…¥Ehcacheç¼“å­˜ï¼š123456@Beanpublic EhCacheManager getEhCacheManager() &#123; EhCacheManager em = new EhCacheManager(); em.setCacheManagerConfigFile("classpath:config/shiro-ehcache.xml"); return em;&#125;å°†ç¼“å­˜å¯¹è±¡æ³¨å…¥åˆ°SecurityManagerä¸­ï¼š12345678@Bean public SecurityManager securityManager()&#123; DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager(); securityManager.setRealm(shiroRealm()); securityManager.setRememberMeManager(rememberMeManager()); securityManager.setCacheManager(getEhCacheManager()); return securityManager; &#125;é…ç½®å®Œæ¯•å¯åŠ¨é¡¹ç›®ï¼Œåˆ†åˆ«è®¿é—®è®¿é—®â€èŽ·å–ç”¨æˆ·ä¿¡æ¯â€ã€â€æ–°å¢žç”¨æˆ·â€å’Œâ€åˆ é™¤ç”¨æˆ·â€ï¼Œå¯å‘çŽ°åŽå°åªæ‰“å°ä¸€æ¬¡èŽ·å–æƒé™ä¿¡æ¯ï¼š1ç”¨æˆ·mrbirdèŽ·å–æƒé™-----ShiroRealm.doGetAuthorizationInfoæŸ¥çœ‹Druidæ•°æ®æºSQLç›‘æŽ§ï¼šSQLåªæ‰§è¡Œäº†ä¸€æ¬¡ï¼Œè¯´æ˜Žç¼“å­˜æˆåŠŸã€‚æºç è¿žæŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/15.Spring-Boot-Shiro-Ehcache]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Shiro</tag>
        <tag>Security</tag>
        <tag>Spring Boot</tag>
        <tag>Ehcache</tag>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot Shiroæƒé™æŽ§åˆ¶]]></title>
    <url>%2FSpring-Boot-Shiro%20Authorization.html</url>
    <content type="text"><![CDATA[åœ¨ã€ŠSpring-Boot-shiroç”¨æˆ·è®¤è¯ã€‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ç»§æ‰¿AuthorizingRealmæŠ½è±¡ç±»å®žçŽ°äº†doGetAuthenticationInfo()æ–¹æ³•å®Œæˆäº†ç”¨æˆ·è®¤è¯æ“ä½œã€‚æŽ¥ä¸‹æ¥ç»§ç»­å®žçŽ°doGetAuthorizationInfo()æ–¹æ³•å®ŒæˆShiroçš„æƒé™æŽ§åˆ¶åŠŸèƒ½ã€‚æŽˆæƒä¹Ÿç§°ä¸ºè®¿é—®æŽ§åˆ¶ï¼Œæ˜¯ç®¡ç†èµ„æºè®¿é—®çš„è¿‡ç¨‹ã€‚å³æ ¹æ®ä¸åŒç”¨æˆ·çš„æƒé™åˆ¤æ–­å…¶æ˜¯å¦æœ‰è®¿é—®ç›¸åº”èµ„æºçš„æƒé™ã€‚åœ¨Shiroä¸­ï¼Œæƒé™æŽ§åˆ¶æœ‰ä¸‰ä¸ªæ ¸å¿ƒçš„å…ƒç´ ï¼šæƒé™ï¼Œè§’è‰²å’Œç”¨æˆ·ã€‚åº“æ¨¡åž‹è®¾è®¡åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨RBACï¼ˆRole-Based Access Controlï¼ŒåŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶ï¼‰æ¨¡åž‹è®¾è®¡ç”¨æˆ·ï¼Œè§’è‰²å’Œæƒé™é—´çš„å…³ç³»ã€‚ç®€å•åœ°è¯´ï¼Œä¸€ä¸ªç”¨æˆ·æ‹¥æœ‰è‹¥å¹²è§’è‰²ï¼Œæ¯ä¸€ä¸ªè§’è‰²æ‹¥æœ‰è‹¥å¹²æƒé™ã€‚è¿™æ ·ï¼Œå°±æž„é€ æˆâ€œç”¨æˆ·-è§’è‰²-æƒé™â€çš„æŽˆæƒæ¨¡åž‹ã€‚åœ¨è¿™ç§æ¨¡åž‹ä¸­ï¼Œç”¨æˆ·ä¸Žè§’è‰²ä¹‹é—´ï¼Œè§’è‰²ä¸Žæƒé™ä¹‹é—´ï¼Œä¸€èˆ¬è€…æ˜¯å¤šå¯¹å¤šçš„å…³ç³»ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šæ ¹æ®è¿™ä¸ªæ¨¡åž‹ï¼Œè®¾è®¡æ•°æ®åº“è¡¨ï¼Œå¹¶æ’å…¥ä¸€äº›æµ‹è¯•æ•°æ®ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394-- ------------------------------ Table structure for T_PERMISSION-- ----------------------------CREATE TABLE "SCOTT"."T_PERMISSION" ( "ID" NUMBER(10) NOT NULL , "URL" VARCHAR2(256 BYTE) NULL , "NAME" VARCHAR2(64 BYTE) NULL );COMMENT ON COLUMN "SCOTT"."T_PERMISSION"."URL" IS 'urlåœ°å€';COMMENT ON COLUMN "SCOTT"."T_PERMISSION"."NAME" IS 'urlæè¿°';-- ------------------------------ Records of T_PERMISSION-- ----------------------------INSERT INTO "SCOTT"."T_PERMISSION" VALUES ('1', '/user', 'user:user');INSERT INTO "SCOTT"."T_PERMISSION" VALUES ('2', '/user/add', 'user:add');INSERT INTO "SCOTT"."T_PERMISSION" VALUES ('3', '/user/delete', 'user:delete');-- ------------------------------ Table structure for T_ROLE-- ----------------------------CREATE TABLE "SCOTT"."T_ROLE" ( "ID" NUMBER NOT NULL , "NAME" VARCHAR2(32 BYTE) NULL , "MEMO" VARCHAR2(32 BYTE) NULL );COMMENT ON COLUMN "SCOTT"."T_ROLE"."NAME" IS 'è§’è‰²åç§°';COMMENT ON COLUMN "SCOTT"."T_ROLE"."MEMO" IS 'è§’è‰²æè¿°';-- ------------------------------ Records of T_ROLE-- ----------------------------INSERT INTO "SCOTT"."T_ROLE" VALUES ('1', 'admin', 'è¶…çº§ç®¡ç†å‘˜');INSERT INTO "SCOTT"."T_ROLE" VALUES ('2', 'test', 'æµ‹è¯•è´¦æˆ·');-- ------------------------------ Table structure for T_ROLE_PERMISSION-- ----------------------------CREATE TABLE "SCOTT"."T_ROLE_PERMISSION" ( "RID" NUMBER(10) NULL , "PID" NUMBER(10) NULL );COMMENT ON COLUMN "SCOTT"."T_ROLE_PERMISSION"."RID" IS 'è§’è‰²id';COMMENT ON COLUMN "SCOTT"."T_ROLE_PERMISSION"."PID" IS 'æƒé™id';-- ------------------------------ Records of T_ROLE_PERMISSION-- ----------------------------INSERT INTO "SCOTT"."T_ROLE_PERMISSION" VALUES ('1', '2');INSERT INTO "SCOTT"."T_ROLE_PERMISSION" VALUES ('1', '3');INSERT INTO "SCOTT"."T_ROLE_PERMISSION" VALUES ('2', '1');INSERT INTO "SCOTT"."T_ROLE_PERMISSION" VALUES ('1', '1');-- ------------------------------ Table structure for T_USER-- ----------------------------CREATE TABLE "SCOTT"."T_USER" ( "ID" NUMBER NOT NULL , "USERNAME" VARCHAR2(20 BYTE) NOT NULL , "PASSWD" VARCHAR2(128 BYTE) NOT NULL , "CREATE_TIME" DATE NULL , "STATUS" CHAR(1 BYTE) NOT NULL );COMMENT ON COLUMN "SCOTT"."T_USER"."USERNAME" IS 'ç”¨æˆ·å';COMMENT ON COLUMN "SCOTT"."T_USER"."PASSWD" IS 'å¯†ç ';COMMENT ON COLUMN "SCOTT"."T_USER"."CREATE_TIME" IS 'åˆ›å»ºæ—¶é—´';COMMENT ON COLUMN "SCOTT"."T_USER"."STATUS" IS 'æ˜¯å¦æœ‰æ•ˆ 1ï¼šæœ‰æ•ˆ 0ï¼šé”å®š';-- ------------------------------ Records of T_USER-- ----------------------------INSERT INTO "SCOTT"."T_USER" VALUES ('2', 'tester', '243e29429b340192700677d48c09d992', TO_DATE('2017-12-11 17:20:21', 'YYYY-MM-DD HH24:MI:SS'), '1');INSERT INTO "SCOTT"."T_USER" VALUES ('1', 'mrbird', '42ee25d1e43e9f57119a00d0a39e5250', TO_DATE('2017-12-11 10:52:48', 'YYYY-MM-DD HH24:MI:SS'), '1');-- ------------------------------ Table structure for T_USER_ROLE-- ----------------------------CREATE TABLE "SCOTT"."T_USER_ROLE" ( "USER_ID" NUMBER(10) NULL , "RID" NUMBER(10) NULL );COMMENT ON COLUMN "SCOTT"."T_USER_ROLE"."USER_ID" IS 'ç”¨æˆ·id';COMMENT ON COLUMN "SCOTT"."T_USER_ROLE"."RID" IS 'è§’è‰²id';-- ------------------------------ Records of T_USER_ROLE-- ----------------------------INSERT INTO "SCOTT"."T_USER_ROLE" VALUES ('1', '1');INSERT INTO "SCOTT"."T_USER_ROLE" VALUES ('2', '2');ä¸€äº›éžç©ºçº¦æŸè¿™é‡Œå°±ä¸è´´äº†ï¼Œå¯å‚è€ƒæºç ä¸­çš„init.sqlã€‚ä¸Šé¢çš„sqlåˆ›å»ºäº†äº”å¼ è¡¨ï¼šç”¨æˆ·è¡¨T_USERã€è§’è‰²è¡¨T_ROLEã€ç”¨æˆ·è§’è‰²å…³è”è¡¨T_USER_ROLEã€æƒé™è¡¨T_PERMISSIONå’Œæƒé™è§’è‰²å…³è”è¡¨T_ROLE_PERMISSIONã€‚ç”¨æˆ·mrbirdè§’è‰²ä¸ºadminï¼Œç”¨æˆ·testerè§’è‰²ä¸ºtestã€‚adminè§’è‰²æ‹¥æœ‰ç”¨æˆ·çš„æ‰€æœ‰æƒé™ï¼ˆuser:user,user:add,user:deleteï¼‰ï¼Œè€Œtestè§’è‰²åªæ‹¥æœ‰ç”¨æˆ·çš„æŸ¥çœ‹æƒé™ï¼ˆuser:userï¼‰ã€‚å¯†ç éƒ½æ˜¯123456ï¼Œç»è¿‡Shiroæä¾›çš„MD5åŠ å¯†ã€‚Daoå±‚åˆ›å»ºä¸¤ä¸ªå®žä½“ç±»ï¼Œå¯¹åº”ç”¨æˆ·è§’è‰²è¡¨Roleå’Œç”¨æˆ·æƒé™è¡¨Permissionï¼šRole:12345678public class Role implements Serializable&#123; private static final long serialVersionUID = -227437593919820521L; private Integer id; private String name; private String memo; // get setç•¥&#125;Permission:12345678public class Permission implements Serializable&#123; private static final long serialVersionUID = 7160557680614732403L; private Integer id; private String url; private String name; // get,setç•¥ &#125;åˆ›å»ºä¸¤ä¸ªdaoæŽ¥å£ï¼Œåˆ†åˆ«ç”¨æˆ·æŸ¥è¯¢ç”¨æˆ·çš„æ‰€æœ‰è§’è‰²å’Œç”¨æˆ·çš„æ‰€æœ‰æƒé™ï¼šUserRoleMapperï¼š1234@Mapperpublic interface UserRoleMapper &#123; List&lt;Role&gt; findByUserName(String userName);&#125;UserPermissionMapperï¼š1234@Mapperpublic interface UserPermissionMapper &#123; List&lt;Permission&gt; findByUserName(String userName);&#125;å…¶xmlå®žçŽ°ï¼šUserRoleMapper.xmlï¼š123456789101112131415&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;&lt;mapper namespace="com.springboot.dao.UserRoleMapper"&gt; &lt;resultMap type="com.springboot.pojo.Role" id="role"&gt; &lt;id column="id" property="id" javaType="java.lang.Integer" jdbcType="NUMERIC"/&gt; &lt;id column="name" property="name" javaType="java.lang.String" jdbcType="VARCHAR"/&gt; &lt;id column="memo" property="memo" javaType="java.lang.String" jdbcType="VARCHAR"/&gt; &lt;/resultMap&gt; &lt;select id="findByUserName" resultMap="role"&gt; select r.id,r.name,r.memo from t_role r left join t_user_role ur on(r.id = ur.rid) left join t_user u on(u.id = ur.user_id) where u.username = #&#123;userName&#125; &lt;/select&gt;&lt;/mapper&gt;UserPermissionMapper.xmlï¼š1234567891011121314151617&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;&lt;mapper namespace="com.springboot.dao.UserPermissionMapper"&gt; &lt;resultMap type="com.springboot.pojo.Permission" id="permission"&gt; &lt;id column="id" property="id" javaType="java.lang.Integer" jdbcType="NUMERIC"/&gt; &lt;id column="url" property="url" javaType="java.lang.String" jdbcType="VARCHAR"/&gt; &lt;id column="name" property="name" javaType="java.lang.String" jdbcType="VARCHAR"/&gt; &lt;/resultMap&gt; &lt;select id="findByUserName" resultMap="permission"&gt; select p.id,p.url,p.name from t_role r left join t_user_role ur on(r.id = ur.rid) left join t_user u on(u.id = ur.user_id) left join t_role_permission rp on(rp.rid = r.id) left join t_permission p on(p.id = rp.pid ) where u.username = #&#123;userName&#125; &lt;/select&gt;&lt;/mapper&gt;æ•°æ®å±‚å‡†å¤‡å¥½åŽï¼ŒæŽ¥ä¸‹æ¥å¯¹Realmè¿›è¡Œæ”¹é€ ã€‚Realmåœ¨Shiroä¸­ï¼Œç”¨æˆ·è§’è‰²å’Œæƒé™çš„èŽ·å–æ˜¯åœ¨Realmçš„doGetAuthorizationInfo()æ–¹æ³•ä¸­å®žçŽ°çš„ï¼Œæ‰€ä»¥æŽ¥ä¸‹æ¥æ‰‹åŠ¨å®žçŽ°è¯¥æ–¹æ³•ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445public class ShiroRealm extends AuthorizingRealm &#123; @Autowired private UserMapper userMapper; @Autowired private UserRoleMapper userRoleMapper; @Autowired private UserPermissionMapper userPermissionMapper; /** * èŽ·å–ç”¨æˆ·è§’è‰²å’Œæƒé™ */ @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principal) &#123; User user = (User) SecurityUtils.getSubject().getPrincipal(); String userName = user.getUserName(); System.out.println("ç”¨æˆ·" + userName + "èŽ·å–æƒé™-----ShiroRealm.doGetAuthorizationInfo"); SimpleAuthorizationInfo simpleAuthorizationInfo = new SimpleAuthorizationInfo(); // èŽ·å–ç”¨æˆ·è§’è‰²é›† List&lt;Role&gt; roleList = userRoleMapper.findByUserName(userName); Set&lt;String&gt; roleSet = new HashSet&lt;String&gt;(); for (Role r : roleList) &#123; roleSet.add(r.getName()); &#125; simpleAuthorizationInfo.setRoles(roleSet); // èŽ·å–ç”¨æˆ·æƒé™é›† List&lt;Permission&gt; permissionList = userPermissionMapper.findByUserName(userName); Set&lt;String&gt; permissionSet = new HashSet&lt;String&gt;(); for (Permission p : permissionList) &#123; permissionSet.add(p.getName()); &#125; simpleAuthorizationInfo.setStringPermissions(permissionSet); return simpleAuthorizationInfo; &#125; /** * ç™»å½•è®¤è¯ */ @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException &#123; // ç™»å½•è®¤è¯å·²ç»å®žçŽ°è¿‡ï¼Œè¿™é‡Œä¸å†è´´ä»£ç  &#125;&#125;åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ–¹æ³•userRoleMapper.findByUserName(userName)å’ŒuserPermissionMapper.findByUserName(userName)èŽ·å–äº†å½“å‰ç™»å½•ç”¨æˆ·çš„è§’è‰²å’Œæƒé™é›†ï¼Œç„¶åŽä¿å­˜åˆ°SimpleAuthorizationInfoå¯¹è±¡ä¸­ï¼Œå¹¶è¿”å›žç»™Shiroï¼Œè¿™æ ·Shiroä¸­å°±å­˜å‚¨äº†å½“å‰ç”¨æˆ·çš„è§’è‰²å’Œæƒé™ä¿¡æ¯äº†ã€‚é™¤äº†å¯¹Realmè¿›è¡Œæ”¹é€ å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€ä¿®æ”¹ShiroConfigé…ç½®ã€‚ShiroConfigShiroä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›å’Œæƒé™ç›¸å…³çš„æ³¨è§£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š1234567891011121314// è¡¨ç¤ºå½“å‰Subjectå·²ç»é€šè¿‡loginè¿›è¡Œäº†èº«ä»½éªŒè¯ï¼›å³Subject.isAuthenticated()è¿”å›žtrueã€‚@RequiresAuthentication // è¡¨ç¤ºå½“å‰Subjectå·²ç»èº«ä»½éªŒè¯æˆ–è€…é€šè¿‡è®°ä½æˆ‘ç™»å½•çš„ã€‚@RequiresUser // è¡¨ç¤ºå½“å‰Subjectæ²¡æœ‰èº«ä»½éªŒè¯æˆ–é€šè¿‡è®°ä½æˆ‘ç™»å½•è¿‡ï¼Œå³æ˜¯æ¸¸å®¢èº«ä»½ã€‚@RequiresGuest // è¡¨ç¤ºå½“å‰Subjectéœ€è¦è§’è‰²adminå’Œuserã€‚ @RequiresRoles(value=&#123;"admin", "user"&#125;, logical= Logical.AND) // è¡¨ç¤ºå½“å‰Subjectéœ€è¦æƒé™user:aæˆ–user:bã€‚@RequiresPermissions (value=&#123;"user:a", "user:b"&#125;, logical= Logical.OR)è¦å¼€å¯è¿™äº›æ³¨è§£çš„ä½¿ç”¨ï¼Œéœ€è¦åœ¨ShiroConfigä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š12345678...@Beanpublic AuthorizationAttributeSourceAdvisor authorizationAttributeSourceAdvisor(SecurityManager securityManager) &#123; AuthorizationAttributeSourceAdvisor authorizationAttributeSourceAdvisor = new AuthorizationAttributeSourceAdvisor(); authorizationAttributeSourceAdvisor.setSecurityManager(securityManager); return authorizationAttributeSourceAdvisor;&#125;...Controllerç¼–å†™ä¸€ä¸ªUserControllerï¼Œç”¨äºŽå¤„ç†Userç±»çš„è®¿é—®è¯·æ±‚ï¼Œå¹¶ä½¿ç”¨Shiroæƒé™æ³¨è§£æŽ§åˆ¶æƒé™ï¼š12345678910111213141516171819202122232425@Controller@RequestMapping("/user")public class UserController &#123; @RequiresPermissions("user:user") @RequestMapping("list") public String userList(Model model) &#123; model.addAttribute("value", "èŽ·å–ç”¨æˆ·ä¿¡æ¯"); return "user"; &#125; @RequiresPermissions("user:add") @RequestMapping("add") public String userAdd(Model model) &#123; model.addAttribute("value", "æ–°å¢žç”¨æˆ·"); return "user"; &#125; @RequiresPermissions("user:delete") @RequestMapping("delete") public String userDelete(Model model) &#123; model.addAttribute("value", "åˆ é™¤ç”¨æˆ·"); return "user"; &#125;&#125;åœ¨LoginControllerä¸­æ·»åŠ ä¸€ä¸ª/403è·³è½¬ï¼š1234@GetMapping("/403")public String forbid() &#123; return "403";&#125;å‰ç«¯é¡µé¢å¯¹index.htmlè¿›è¡Œæ”¹é€ ï¼Œæ·»åŠ ä¸‰ä¸ªç”¨æˆ·æ“ä½œçš„é“¾æŽ¥ï¼š1234567891011121314151617&lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;é¦–é¡µ&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;ä½ å¥½ï¼[[$&#123;user.userName&#125;]]&lt;/p&gt; &lt;h3&gt;æƒé™æµ‹è¯•é“¾æŽ¥&lt;/h3&gt; &lt;div&gt; &lt;a th:href="@&#123;/user/list&#125;"&gt;èŽ·å–ç”¨æˆ·ä¿¡æ¯&lt;/a&gt; &lt;a th:href="@&#123;/user/add&#125;"&gt;æ–°å¢žç”¨æˆ·&lt;/a&gt; &lt;a th:href="@&#123;/user/delete&#125;"&gt;åˆ é™¤ç”¨æˆ·&lt;/a&gt; &lt;/div&gt; &lt;a th:href="@&#123;/logout&#125;"&gt;æ³¨é”€&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;å½“ç”¨æˆ·å¯¹ç”¨æˆ·çš„æ“ä½œæœ‰ç›¸åº”æƒé™çš„æ—¶å€™ï¼Œè·³è½¬åˆ°user.htmlï¼š1234567891011&lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;[[$&#123;value&#125;]]&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;[[$&#123;value&#125;]]&lt;/p&gt; &lt;a th:href="@&#123;/index&#125;"&gt;è¿”å›ž&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;403é¡µé¢ï¼š12345678910&lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;æš‚æ— æƒé™&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;æ‚¨æ²¡æœ‰æƒé™è®¿é—®è¯¥èµ„æºï¼ï¼&lt;/p&gt; &lt;a th:href="@&#123;/index&#125;"&gt;è¿”å›ž&lt;/a&gt;&lt;/body&gt;æµ‹è¯•å¯åŠ¨é¡¹ç›®ï¼Œä½¿ç”¨mrbirdçš„è´¦æˆ·ç™»å½•åŽä¸»é¡µå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šç‚¹å‡»â€èŽ·å–ç”¨æˆ·ä¿¡æ¯è¿žæŽ¥â€ï¼šå› ä¸ºmrbirdè§’è‰²ä¸ºadminï¼Œå¯¹ç€ä¸‰ä¸ªé“¾æŽ¥éƒ½ç”±è®¿é—®æƒé™ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ã€‚æŽ¥ç€ä½¿ç”¨testerç”¨æˆ·ç™»å½•ã€‚å› ä¸ºtesterç”¨æˆ·è§’è‰²ä¸ºtestï¼Œåªæ‹¥æœ‰ï¼ˆuser:userï¼‰æƒé™ï¼Œæ‰€ä»¥å½“å…¶ç‚¹å‡»â€æ–°å¢žç”¨æˆ·â€å’Œâ€åˆ é™¤ç”¨æˆ·â€çš„æ—¶å€™ï¼šåŽå°æŠ›å‡ºorg.apache.shiro.authz.AuthorizationException: Not authorized to invoke method:â€¦å¼‚å¸¸ï¼ï¼ï¼è¿™é‡Œæœ‰ç‚¹å‡ºä¹Žæ„æ–™ï¼Œæœ¬ä»¥ä¸ºåœ¨ShiroConfigä¸­é…ç½®äº†shiroFilterFactoryBean.setUnauthorizedUrl(&quot;/403&quot;);ï¼Œæ²¡æœ‰æƒé™çš„è®¿é—®ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°/403ï¼Œç»“æžœè¯æ˜Žå¹¶ä¸æ˜¯è¿™æ ·ã€‚åŽæ¥ç ”ç©¶å‘çŽ°ï¼Œè¯¥è®¾ç½®åªå¯¹filterChainèµ·ä½œç”¨ï¼Œæ¯”å¦‚åœ¨filterChainä¸­è®¾ç½®äº†filterChainDefinitionMap.put(&quot;/user/update&quot;, &quot;perms[user:update]&quot;);ï¼Œå¦‚æžœç”¨æˆ·æ²¡æœ‰user:updateæƒé™ï¼Œé‚£ä¹ˆå½“å…¶è®¿é—®/user/updateçš„æ—¶å€™ï¼Œé¡µé¢ä¼šè¢«é‡å®šå‘åˆ°/403ã€‚é‚£ä¹ˆå¯¹äºŽä¸Šé¢è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªå…¨å±€å¼‚å¸¸æ•èŽ·ç±»ï¼š12345678@ControllerAdvice@Order(value = Ordered.HIGHEST_PRECEDENCE)public class GlobalExceptionHandler &#123; @ExceptionHandler(value = AuthorizationException.class) public String handleAuthorizationException() &#123; return "403"; &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼Œå†æ¬¡ä½¿ç”¨testerçš„è´¦å·ç‚¹å‡»â€æ–°å¢žç”¨æˆ·â€å’Œâ€åˆ é™¤ç”¨æˆ·â€é“¾æŽ¥çš„æ—¶å€™ï¼Œé¡µé¢å¦‚ä¸‹æ‰€ç¤ºï¼šé¡µé¢å·²ç»æˆåŠŸé‡å®šå‘åˆ°/403ã€‚æºç é“¾æŽ¥https://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/13.Spring-Boot-Shiro-Authorization]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Shiro</tag>
        <tag>Security</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot Shiro Remember Me]]></title>
    <url>%2FSpring-Boot-Shiro%20Remember-Me.html</url>
    <content type="text"><![CDATA[æŽ¥ç€ã€ŠSpring-Boot-shiroç”¨æˆ·è®¤è¯ã€‹ï¼Œå½“ç”¨æˆ·æˆåŠŸç™»å½•åŽï¼Œå…³é—­æµè§ˆå™¨ç„¶åŽå†æ‰“å¼€æµè§ˆå™¨è®¿é—®http://localhost:8080/web/indexï¼Œé¡µé¢ä¼šè·³è½¬åˆ°ç™»å½•é¡µï¼Œä¹‹å‰çš„ç™»å½•å› ä¸ºæµè§ˆå™¨çš„å…³é—­å·²ç»å¤±æ•ˆã€‚Shiroä¸ºæˆ‘ä»¬æä¾›äº†Remember Meçš„åŠŸèƒ½ï¼Œç”¨æˆ·çš„ç™»å½•çŠ¶æ€ä¸ä¼šå› ä¸ºæµè§ˆå™¨çš„å…³é—­è€Œå¤±æ•ˆï¼Œç›´åˆ°Cookieè¿‡æœŸã€‚æ›´æ”¹ ShiroConfigç»§ç»­ç¼–è¾‘ShiroConfigï¼ŒåŠ å…¥ï¼š1234567891011121314151617181920212223/** * cookieå¯¹è±¡ * @return */public SimpleCookie rememberMeCookie() &#123; // è®¾ç½®cookieåç§°ï¼Œå¯¹åº”login.htmlé¡µé¢çš„&lt;input type="checkbox" name="rememberMe"/&gt; SimpleCookie cookie = new SimpleCookie("rememberMe"); // è®¾ç½®cookieçš„è¿‡æœŸæ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼Œè¿™é‡Œä¸ºä¸€å¤© cookie.setMaxAge(86400); return cookie;&#125;/** * cookieç®¡ç†å¯¹è±¡ * @return */public CookieRememberMeManager rememberMeManager() &#123; CookieRememberMeManager cookieRememberMeManager = new CookieRememberMeManager(); cookieRememberMeManager.setCookie(rememberMeCookie()); // rememberMe cookieåŠ å¯†çš„å¯†é’¥ cookieRememberMeManager.setCipherKey(Base64.decode("4AvVhmFLUs0KTA3Kprsdag==")); return cookieRememberMeManager;&#125;æŽ¥ä¸‹æ¥å°†cookieç®¡ç†å¯¹è±¡è®¾ç½®åˆ°SecurityManagerä¸­ï¼š1234567@Bean public SecurityManager securityManager()&#123; DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager(); securityManager.setRealm(shiroRealm()); securityManager.setRememberMeManager(rememberMeManager()); return securityManager; &#125;æœ€åŽä¿®æ”¹æƒé™é…ç½®ï¼Œå°†ShiroFilterFactoryBeançš„filterChainDefinitionMap.put(&quot;/**&quot;, &quot;authc&quot;);æ›´æ”¹ä¸ºfilterChainDefinitionMap.put(&quot;/**&quot;, &quot;user&quot;);ã€‚useræŒ‡çš„æ˜¯ç”¨æˆ·è®¤è¯é€šè¿‡æˆ–è€…é…ç½®äº†Remember Meè®°ä½ç”¨æˆ·ç™»å½•çŠ¶æ€åŽå¯è®¿é—®ã€‚æ›´æ”¹ login.htmlåœ¨login.htmlä¸­åŠ å…¥Remember Me checkboxï¼š12345678910111213141516171819202122232425262728293031323334353637383940&lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;ç™»å½•&lt;/title&gt; &lt;link rel="stylesheet" th:href="@&#123;/css/login.css&#125;" type="text/css"&gt; &lt;script th:src="@&#123;/js/jquery-1.11.1.min.js&#125;"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="login-page"&gt; &lt;div class="form"&gt; &lt;input type="text" placeholder="ç”¨æˆ·å" name="username" required="required"/&gt; &lt;input type="password" placeholder="å¯†ç " name="password" required="required"/&gt; &lt;p&gt;&lt;input type="checkbox" name="rememberMe" /&gt;è®°ä½æˆ‘&lt;/p&gt; &lt;button onclick="login()"&gt;ç™»å½•&lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;script th:inline="javascript"&gt; var ctx = [[@&#123;/&#125;]]; function login() &#123; var username = $("input[name='username']").val(); var password = $("input[name='password']").val(); var rememberMe = $("input[name='rememberMe']").is(':checked'); $.ajax(&#123; type: "post", url: ctx + "login", data: &#123;"username": username,"password": password,"rememberMe": rememberMe&#125;, dataType: "json", success: function (r) &#123; if (r.code == 0) &#123; location.href = ctx + 'index'; &#125; else &#123; alert(r.msg); &#125; &#125; &#125;); &#125;&lt;/script&gt;&lt;/html&gt;æ›´æ”¹ LoginControlleræ›´æ”¹LoginControllerçš„login()æ–¹æ³•ï¼š12345678910111213141516171819@PostMapping("/login")@ResponseBodypublic ResponseBo login(String username, String password, Boolean rememberMe) &#123; password = MD5Utils.encrypt(username, password); UsernamePasswordToken token = new UsernamePasswordToken(username, password, rememberMe); Subject subject = SecurityUtils.getSubject(); try &#123; subject.login(token); return ResponseBo.ok(); &#125; catch (UnknownAccountException e) &#123; return ResponseBo.error(e.getMessage()); &#125; catch (IncorrectCredentialsException e) &#123; return ResponseBo.error(e.getMessage()); &#125; catch (LockedAccountException e) &#123; return ResponseBo.error(e.getMessage()); &#125; catch (AuthenticationException e) &#123; return ResponseBo.error("è®¤è¯å¤±è´¥ï¼"); &#125;&#125;å½“rememberMeå‚æ•°ä¸ºtrueçš„æ—¶å€™ï¼ŒShiroå°±ä¼šå¸®æˆ‘ä»¬è®°ä½ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚å¯åŠ¨é¡¹ç›®å³å¯çœ‹åˆ°æ•ˆæžœã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/12.Spring-Boot-Shiro-RememberMe]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Shiro</tag>
        <tag>Security</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot Shiroç”¨æˆ·è®¤è¯]]></title>
    <url>%2FSpring-Boot-shiro%20Authentication.html</url>
    <content type="text"><![CDATA[åœ¨Spring Bootä¸­é›†æˆShiroè¿›è¡Œç”¨æˆ·çš„è®¤è¯è¿‡ç¨‹ä¸»è¦å¯ä»¥å½’çº³ä¸ºä»¥ä¸‹ä¸‰ç‚¹ï¼š1ã€å®šä¹‰ä¸€ä¸ªShiroConfigï¼Œç„¶åŽé…ç½®SecurityManager Beanï¼ŒSecurityManagerä¸ºShiroçš„å®‰å…¨ç®¡ç†å™¨ï¼Œç®¡ç†ç€æ‰€æœ‰Subjectï¼›2ã€åœ¨ShiroConfigä¸­é…ç½®ShiroFilterFactoryBeanï¼Œå…¶ä¸ºShiroè¿‡æ»¤å™¨å·¥åŽ‚ç±»ï¼Œä¾èµ–äºŽSecurityManagerï¼›3ã€è‡ªå®šä¹‰Realmå®žçŽ°ï¼ŒRealmåŒ…å«doGetAuthorizationInfo()å’ŒdoGetAuthenticationInfo()æ–¹æ³•ï¼Œå› ä¸ºæœ¬æ–‡åªæ¶‰åŠç”¨æˆ·è®¤è¯ï¼Œæ‰€ä»¥åªå®žçŽ°doGetAuthenticationInfo()æ–¹æ³•ã€‚å¼•å…¥ä¾èµ–é¦–å…ˆå¯æ ¹æ®æ–‡ç« ã€Šå¼€å¯Spring Bootã€‹æ­å»ºä¸€ä¸ªSpring Boot Webç¨‹åºï¼Œç„¶åŽå¼•å…¥Shiroã€MyBatisã€æ•°æ®åº“å’Œthymeleafä¾èµ–ï¼š123456789101112131415161718192021222324252627282930313233&lt;!-- MyBatis --&gt;&lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.3.1&lt;/version&gt;&lt;/dependency&gt;&lt;!-- thymeleaf --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!-- shiro-spring --&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt; &lt;artifactId&gt;shiro-spring&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt;&lt;/dependency&gt;&lt;!-- oracleé©±åŠ¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.oracle&lt;/groupId&gt; &lt;artifactId&gt;ojdbc6&lt;/artifactId&gt; &lt;version&gt;6.0&lt;/version&gt;&lt;/dependency&gt;&lt;!-- druidæ•°æ®æºé©±åŠ¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.6&lt;/version&gt;&lt;/dependency&gt;ShiroConfigå®šä¹‰ä¸€ä¸ªShiroé…ç½®ç±»ï¼Œåç§°ä¸ºShiroConfigï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748@Configurationpublic class ShiroConfig &#123; @Bean public ShiroFilterFactoryBean shiroFilterFactoryBean(SecurityManager securityManager) &#123; ShiroFilterFactoryBean shiroFilterFactoryBean = new ShiroFilterFactoryBean(); // è®¾ç½®securityManager shiroFilterFactoryBean.setSecurityManager(securityManager); // ç™»å½•çš„url shiroFilterFactoryBean.setLoginUrl("/login"); // ç™»å½•æˆåŠŸåŽè·³è½¬çš„url shiroFilterFactoryBean.setSuccessUrl("/index"); // æœªæŽˆæƒurl shiroFilterFactoryBean.setUnauthorizedUrl("/403"); LinkedHashMap&lt;String, String&gt; filterChainDefinitionMap = new LinkedHashMap&lt;&gt;(); // å®šä¹‰filterChainï¼Œé™æ€èµ„æºä¸æ‹¦æˆª filterChainDefinitionMap.put("/css/**", "anon"); filterChainDefinitionMap.put("/js/**", "anon"); filterChainDefinitionMap.put("/fonts/**", "anon"); filterChainDefinitionMap.put("/img/**", "anon"); // druidæ•°æ®æºç›‘æŽ§é¡µé¢ä¸æ‹¦æˆª filterChainDefinitionMap.put("/druid/**", "anon"); // é…ç½®é€€å‡ºè¿‡æ»¤å™¨ï¼Œå…¶ä¸­å…·ä½“çš„é€€å‡ºä»£ç Shiroå·²ç»æ›¿æˆ‘ä»¬å®žçŽ°äº† filterChainDefinitionMap.put("/logout", "logout"); filterChainDefinitionMap.put("/", "anon"); // é™¤ä¸Šä»¥å¤–æ‰€æœ‰urléƒ½å¿…é¡»è®¤è¯é€šè¿‡æ‰å¯ä»¥è®¿é—®ï¼Œæœªé€šè¿‡è®¤è¯è‡ªåŠ¨è®¿é—®LoginUrl filterChainDefinitionMap.put("/**", "authc"); shiroFilterFactoryBean.setFilterChainDefinitionMap(filterChainDefinitionMap); return shiroFilterFactoryBean; &#125; @Bean public SecurityManager securityManager()&#123; // é…ç½®SecurityManagerï¼Œå¹¶æ³¨å…¥shiroRealm DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager(); securityManager.setRealm(shiroRealm()); return securityManager; &#125; @Bean public ShiroRealm shiroRealm()&#123; // é…ç½®Realmï¼Œéœ€è‡ªå·±å®žçŽ° ShiroRealm shiroRealm = new ShiroRealm(); return shiroRealm; &#125; &#125;éœ€è¦æ³¨æ„çš„æ˜¯filterChainåŸºäºŽçŸ­è·¯æœºåˆ¶ï¼Œå³æœ€å…ˆåŒ¹é…åŽŸåˆ™ï¼Œå¦‚ï¼š12/user/**=anon/user/aa=authc æ°¸è¿œä¸ä¼šæ‰§è¡Œå…¶ä¸­anonã€authcç­‰ä¸ºShiroä¸ºæˆ‘ä»¬å®žçŽ°çš„è¿‡æ»¤å™¨ï¼Œå…·ä½“å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šFilter NameClassDescriptionanonorg.apache.shiro.web.filter.authc.AnonymousFilteråŒ¿åæ‹¦æˆªå™¨ï¼Œå³ä¸éœ€è¦ç™»å½•å³å¯è®¿é—®ï¼›ä¸€èˆ¬ç”¨äºŽé™æ€èµ„æºè¿‡æ»¤ï¼›ç¤ºä¾‹/static/**=anonauthcorg.apache.shiro.web.filter.authc.FormAuthenticationFilteråŸºäºŽè¡¨å•çš„æ‹¦æˆªå™¨ï¼›å¦‚/**=authcï¼Œå¦‚æžœæ²¡æœ‰ç™»å½•ä¼šè·³åˆ°ç›¸åº”çš„ç™»å½•é¡µé¢ç™»å½•authcBasicorg.apache.shiro.web.filter.authc.BasicHttpAuthenticationFilterBasic HTTPèº«ä»½éªŒè¯æ‹¦æˆªå™¨logoutorg.apache.shiro.web.filter.authc.LogoutFilteré€€å‡ºæ‹¦æˆªå™¨ï¼Œä¸»è¦å±žæ€§ï¼šredirectUrlï¼šé€€å‡ºæˆåŠŸåŽé‡å®šå‘çš„åœ°å€ï¼ˆ/ï¼‰ï¼Œç¤ºä¾‹/logout=logoutnoSessionCreationorg.apache.shiro.web.filter.session.NoSessionCreationFilterä¸åˆ›å»ºä¼šè¯æ‹¦æˆªå™¨ï¼Œè°ƒç”¨subject.getSession(false)ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æžœsubject.getSession(true)å°†æŠ›å‡ºDisabledSessionExceptionå¼‚å¸¸permsorg.apache.shiro.web.filter.authz.PermissionsAuthorizationFilteræƒé™æŽˆæƒæ‹¦æˆªå™¨ï¼ŒéªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼›å±žæ€§å’Œrolesä¸€æ ·ï¼›ç¤ºä¾‹/user/**=perms[&quot;user:create&quot;]portorg.apache.shiro.web.filter.authz.PortFilterç«¯å£æ‹¦æˆªå™¨ï¼Œä¸»è¦å±žæ€§port(80)ï¼šå¯ä»¥é€šè¿‡çš„ç«¯å£ï¼›ç¤ºä¾‹/test= port[80]ï¼Œå¦‚æžœç”¨æˆ·è®¿é—®è¯¥é¡µé¢æ˜¯éž80ï¼Œå°†è‡ªåŠ¨å°†è¯·æ±‚ç«¯å£æ”¹ä¸º80å¹¶é‡å®šå‘åˆ°è¯¥80ç«¯å£ï¼Œå…¶ä»–è·¯å¾„/å‚æ•°ç­‰éƒ½ä¸€æ ·restorg.apache.shiro.web.filter.authz.HttpMethodPermissionFilterresté£Žæ ¼æ‹¦æˆªå™¨ï¼Œè‡ªåŠ¨æ ¹æ®è¯·æ±‚æ–¹æ³•æž„å»ºæƒé™å­—ç¬¦ä¸²ï¼›ç¤ºä¾‹/users=rest[user]ï¼Œä¼šè‡ªåŠ¨æ‹¼å‡ºuser:read,user:create,user:update,user:deleteæƒé™å­—ç¬¦ä¸²è¿›è¡Œæƒé™åŒ¹é…ï¼ˆæ‰€æœ‰éƒ½å¾—åŒ¹é…ï¼ŒisPermittedAllï¼‰rolesorg.apache.shiro.web.filter.authz.RolesAuthorizationFilterè§’è‰²æŽˆæƒæ‹¦æˆªå™¨ï¼ŒéªŒè¯ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æ‰€æœ‰è§’è‰²ï¼›ç¤ºä¾‹/admin/**=roles[admin]sslorg.apache.shiro.web.filter.authz.SslFilterSSLæ‹¦æˆªå™¨ï¼Œåªæœ‰è¯·æ±‚åè®®æ˜¯httpsæ‰èƒ½é€šè¿‡ï¼›å¦åˆ™è‡ªåŠ¨è·³è½¬ä¼šhttpsç«¯å£443ï¼›å…¶ä»–å’Œportæ‹¦æˆªå™¨ä¸€æ ·ï¼›userorg.apache.shiro.web.filter.authc.UserFilterç”¨æˆ·æ‹¦æˆªå™¨ï¼Œç”¨æˆ·å·²ç»èº«ä»½éªŒè¯/è®°ä½æˆ‘ç™»å½•çš„éƒ½å¯ï¼›ç¤ºä¾‹/**=useré…ç½®å®ŒShiroConfigåŽï¼ŒæŽ¥ä¸‹æ¥å¯¹Realmè¿›è¡Œå®žçŽ°ï¼Œç„¶åŽæ³¨å…¥åˆ°SecurityManagerä¸­ã€‚Realmè‡ªå®šä¹‰Realmå®žçŽ°åªéœ€ç»§æ‰¿AuthorizingRealmç±»ï¼Œç„¶åŽå®žçŽ°doGetAuthorizationInfo()å’ŒdoGetAuthenticationInfo()æ–¹æ³•å³å¯ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•åä¹çœ‹æœ‰ç‚¹åƒï¼Œauthorizationå‘éŸ³[ËŒÉ”:Î¸É™raÉªËˆzeÉªÊƒn]ï¼Œä¸ºæŽˆæƒï¼Œæ‰¹å‡†çš„æ„æ€ï¼Œå³èŽ·å–ç”¨æˆ·çš„è§’è‰²å’Œæƒé™ç­‰ä¿¡æ¯ï¼›authenticationå‘éŸ³[É”:ËŒÎ¸entÉªâ€™keÉªÊƒn]ï¼Œè®¤è¯ï¼Œèº«ä»½éªŒè¯çš„æ„æ€ï¼Œå³ç™»å½•æ—¶éªŒè¯ç”¨æˆ·çš„åˆæ³•æ€§ï¼Œæ¯”å¦‚éªŒè¯ç”¨æˆ·åå’Œå¯†ç ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041public class ShiroRealm extends AuthorizingRealm &#123; @Autowired private UserMapper userMapper; /** * èŽ·å–ç”¨æˆ·è§’è‰²å’Œæƒé™ */ @Override protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principal) &#123; return null; &#125; /** * ç™»å½•è®¤è¯ */ @Override protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken token) throws AuthenticationException &#123; // èŽ·å–ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç  String userName = (String) token.getPrincipal(); String password = new String((char[]) token.getCredentials()); System.out.println("ç”¨æˆ·" + userName + "è®¤è¯-----ShiroRealm.doGetAuthenticationInfo"); // é€šè¿‡ç”¨æˆ·ååˆ°æ•°æ®åº“æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ User user = userMapper.findByUserName(userName); if (user == null) &#123; throw new UnknownAccountException("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼"); &#125; if (!password.equals(user.getPassword())) &#123; throw new IncorrectCredentialsException("ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼"); &#125; if (user.getStatus().equals("0")) &#123; throw new LockedAccountException("è´¦å·å·²è¢«é”å®š,è¯·è”ç³»ç®¡ç†å‘˜ï¼"); &#125; SimpleAuthenticationInfo info = new SimpleAuthenticationInfo(user, password, getName()); return info; &#125;&#125;å› ä¸ºæœ¬èŠ‚åªè®²è¿°ç”¨æˆ·è®¤è¯ï¼Œæ‰€ä»¥doGetAuthorizationInfo()æ–¹æ³•å…ˆä¸è¿›è¡Œå®žçŽ°ã€‚å…¶ä¸­UnknownAccountExceptionç­‰å¼‚å¸¸ä¸ºShiroè‡ªå¸¦å¼‚å¸¸ï¼ŒShiroå…·æœ‰ä¸°å¯Œçš„è¿è¡Œæ—¶AuthenticationExceptionå±‚æ¬¡ç»“æž„ï¼Œå¯ä»¥å‡†ç¡®æŒ‡å‡ºå°è¯•å¤±è´¥çš„åŽŸå› ã€‚ä½ å¯ä»¥åŒ…è£…åœ¨ä¸€ä¸ªtry/catchå—ï¼Œå¹¶æ•æ‰ä»»ä½•ä½ å¸Œæœ›çš„å¼‚å¸¸ï¼Œå¹¶ä½œå‡ºç›¸åº”çš„ååº”ã€‚ä¾‹å¦‚ï¼š12345678910try &#123; currentUser.login(token);&#125; catch ( UnknownAccountException uae ) &#123; ...&#125; catch ( IncorrectCredentialsException ice ) &#123; ...&#125; catch ( LockedAccountException lae ) &#123; ...&#125; catch ( ExcessiveAttemptsException eae ) &#123; ...&#125; ... catch your own ...&#125; catch ( AuthenticationException ae ) &#123; //unexpected error?&#125;è™½ç„¶æˆ‘ä»¬å¯ä»¥å‡†ç¡®çš„èŽ·å–å¼‚å¸¸ä¿¡æ¯ï¼Œå¹¶æ ¹æ®è¿™äº›ä¿¡æ¯ç»™ç”¨æˆ·æç¤ºå…·ä½“é”™è¯¯ï¼Œä½†æœ€å®‰å…¨çš„åšæ³•æ˜¯åœ¨ç™»å½•å¤±è´¥æ—¶ä»…å‘ç”¨æˆ·æ˜¾ç¤ºé€šç”¨é”™è¯¯æç¤ºä¿¡æ¯ï¼Œä¾‹å¦‚â€œç”¨æˆ·åæˆ–å¯†ç é”™è¯¯â€ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ•°æ®åº“è¢«æ¶æ„æ‰«æã€‚åœ¨Realmä¸­UserMapperä¸ºDaoå±‚ï¼Œæ ‡å‡†çš„åšæ³•åº”è¯¥è¿˜æœ‰Serviceå±‚ï¼Œä½†è¿™é‡Œä¸ºäº†æ–¹ä¾¿å°±ä¸å†å®šä¹‰Serviceå±‚äº†ã€‚æŽ¥ä¸‹æ¥ç¼–å†™å’Œæ•°æ®åº“æ‰“äº¤é“çš„Daoå±‚ã€‚æ•°æ®å±‚é¦–å…ˆåˆ›å»ºä¸€å¼ ç”¨æˆ·è¡¨ï¼Œç”¨äºŽå­˜å‚¨ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼ˆåŸºäºŽOracle 11gï¼‰ï¼š1234567891011121314151617181920212223242526-- ------------------------------ Table structure for T_USER-- ----------------------------CREATE TABLE "SCOTT"."T_USER" ( "ID" NUMBER NOT NULL , "USERNAME" VARCHAR2(20 BYTE) NOT NULL , "PASSWD" VARCHAR2(128 BYTE) NOT NULL , "CREATE_TIME" DATE NULL , "STATUS" CHAR(1 BYTE) NOT NULL );COMMENT ON COLUMN "SCOTT"."T_USER"."USERNAME" IS 'ç”¨æˆ·å';COMMENT ON COLUMN "SCOTT"."T_USER"."PASSWD" IS 'å¯†ç ';COMMENT ON COLUMN "SCOTT"."T_USER"."CREATE_TIME" IS 'åˆ›å»ºæ—¶é—´';COMMENT ON COLUMN "SCOTT"."T_USER"."STATUS" IS 'æ˜¯å¦æœ‰æ•ˆ 1ï¼šæœ‰æ•ˆ 0ï¼šé”å®š';-- ------------------------------ Records of T_USER-- ----------------------------INSERT INTO "SCOTT"."T_USER" VALUES ('2', 'test', '7a38c13ec5e9310aed731de58bbc4214', TO_DATE('2017-11-19 17:20:21', 'YYYY-MM-DD HH24:MI:SS'), '0');INSERT INTO "SCOTT"."T_USER" VALUES ('1', 'mrbird', '42ee25d1e43e9f57119a00d0a39e5250', TO_DATE('2017-11-19 10:52:48', 'YYYY-MM-DD HH24:MI:SS'), '1');-- ------------------------------ Primary Key structure for table T_USER-- ----------------------------ALTER TABLE "SCOTT"."T_USER" ADD PRIMARY KEY ("ID");æ•°æ®æºçš„é…ç½®è¿™é‡Œå°±ä¸è´´å‡ºæ¥äº†ï¼Œå…·ä½“å¯å‚è€ƒæºç ï¼Œæˆ–è€…å‚è€ƒhttps://mrbird.cc/Spring-Boot%E4%B8%AD%E4%BD%BF%E7%94%A8Mybatis.htmlã€‚åº“è¡¨å¯¹åº”çš„å®žä½“ç±»ï¼š123456789101112public class User implements Serializable&#123; private static final long serialVersionUID = -5440372534300871944L; private Integer id; private String userName; private String password; private Date createTime; private String status; // get,setç•¥&#125;å®šä¹‰æŽ¥å£UserMapperï¼š1234@Mapperpublic interface UserMapper &#123; User findByUserName(String userName);&#125;xmlå®žçŽ°ï¼š1234567891011121314&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;&lt;mapper namespace="com.springboot.dao.UserMapper"&gt; &lt;resultMap type="com.springboot.pojo.User" id="User"&gt; &lt;id column="id" property="id" javaType="java.lang.Integer" jdbcType="NUMERIC"/&gt; &lt;id column="username" property="userName" javaType="java.lang.String" jdbcType="VARCHAR"/&gt; &lt;id column="passwd" property="password" javaType="java.lang.String" jdbcType="VARCHAR"/&gt; &lt;id column="create_time" property="createTime" javaType="java.util.Date" jdbcType="DATE"/&gt; &lt;id column="status" property="status" javaType="java.lang.String" jdbcType="VARCHAR"/&gt; &lt;/resultMap&gt; &lt;select id="findByUserName" resultMap="User"&gt; select * from t_user where username = #&#123;userName&#125; &lt;/select&gt;&lt;/mapper&gt;æ•°æ®å±‚å‡†å¤‡å®Œäº†ï¼ŒæŽ¥ä¸‹æ¥ç¼–å†™login.htmlå’Œindex.htmlé¡µé¢ã€‚é¡µé¢å‡†å¤‡ç¼–å†™ç™»å½•é¡µé¢login.htmlï¼š1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;ç™»å½•&lt;/title&gt; &lt;link rel="stylesheet" th:href="@&#123;/css/login.css&#125;" type="text/css"&gt; &lt;script th:src="@&#123;/js/jquery-1.11.1.min.js&#125;"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="login-page"&gt; &lt;div class="form"&gt; &lt;input type="text" placeholder="ç”¨æˆ·å" name="username" required="required"/&gt; &lt;input type="password" placeholder="å¯†ç " name="password" required="required"/&gt; &lt;button onclick="login()"&gt;ç™»å½•&lt;/button&gt; &lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;script th:inline="javascript"&gt; var ctx = [[@&#123;/&#125;]]; function login() &#123; var username = $("input[name='username']").val(); var password = $("input[name='password']").val(); $.ajax(&#123; type: "post", url: ctx + "login", data: &#123;"username": username,"password": password&#125;, dataType: "json", success: function (r) &#123; if (r.code == 0) &#123; location.href = ctx + 'index'; &#125; else &#123; alert(r.msg); &#125; &#125; &#125;); &#125;&lt;/script&gt;&lt;/html&gt;ä¸»é¡µindex.htmlï¼š1234567891011&lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;é¦–é¡µ&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;ä½ å¥½ï¼[[$&#123;user.userName&#125;]]&lt;/p&gt; &lt;a th:href="@&#123;/logout&#125;"&gt;æ³¨é”€&lt;/a&gt;&lt;/body&gt;&lt;/html&gt;é¡µé¢å‡†å¤‡å®Œæ¯•ï¼ŒæŽ¥ä¸‹æ¥ç¼–å†™LoginControllerã€‚ControllerLoginControllerä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243@Controllerpublic class LoginController &#123; @GetMapping("/login") public String login() &#123; return "login"; &#125; @PostMapping("/login") @ResponseBody public ResponseBo login(String username, String password) &#123; // å¯†ç MD5åŠ å¯† password = MD5Utils.encrypt(username, password); UsernamePasswordToken token = new UsernamePasswordToken(username, password); // èŽ·å–Subjectå¯¹è±¡ Subject subject = SecurityUtils.getSubject(); try &#123; subject.login(token); return ResponseBo.ok(); &#125; catch (UnknownAccountException e) &#123; return ResponseBo.error(e.getMessage()); &#125; catch (IncorrectCredentialsException e) &#123; return ResponseBo.error(e.getMessage()); &#125; catch (LockedAccountException e) &#123; return ResponseBo.error(e.getMessage()); &#125; catch (AuthenticationException e) &#123; return ResponseBo.error("è®¤è¯å¤±è´¥ï¼"); &#125; &#125; @RequestMapping("/") public String redirectIndex() &#123; return "redirect:/index"; &#125; @RequestMapping("/index") public String index(Model model) &#123; // ç™»å½•æˆåŽï¼Œå³å¯é€šè¿‡SubjectèŽ·å–ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ User user = (User) SecurityUtils.getSubject().getPrincipal(); model.addAttribute("user", user); return "index"; &#125;&#125;ç™»å½•æˆåŠŸåŽï¼Œæ ¹æ®ä¹‹å‰åœ¨ShiroConfigä¸­çš„é…ç½®shiroFilterFactoryBean.setSuccessUrl(&quot;/index&quot;)ï¼Œé¡µé¢ä¼šè‡ªåŠ¨è®¿é—®/indexè·¯å¾„ã€‚æµ‹è¯•æœ€ç»ˆé¡¹ç›®ç›®å½•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¯åŠ¨é¡¹ç›®ï¼Œåˆ†åˆ«è®¿é—®ï¼šhttp://localhost:8080/web/http://localhost:8080/web/indexhttp://localhost:8080/web/aaaaaaahttp://localhost:8080/webå¯å‘çŽ°é¡µé¢éƒ½è¢«é‡å®šå‘åˆ°http://localhost:8080/web/loginï¼šå½“è¾“å…¥é”™è¯¯çš„ç”¨æˆ·ä¿¡æ¯æ—¶ï¼šç”¨testçš„è´¦æˆ·ç™»å½•ï¼ˆtestè´¦æˆ·çš„statusä¸º0ï¼Œå·²è¢«é”å®šï¼‰ï¼šå½“è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå¯†ç æ—¶å€™ï¼šç‚¹å‡»æ³¨é”€è¿žæŽ¥ï¼Œæ ¹æ®ShiroConfigçš„é…ç½®filterChainDefinitionMap.put(&quot;/logout&quot;, &quot;logout&quot;)ï¼ŒShiroä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ³¨é”€ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶é‡å®šå‘åˆ°/è·¯å¾„ã€‚Spring Booté›†æˆShiroè¿›è¡Œç”¨æˆ·è®¤è¯åˆ°æ­¤å°±ç»“æŸäº†ï¼Œæºç å‚è§https://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/11.Spring-Boot-Shiro-Authentication]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Shiro</tag>
        <tag>Security</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Apache Shiroç®€ä»‹]]></title>
    <url>%2FApache%20Shiro%E7%AE%80%E4%BB%8B.html</url>
    <content type="text"><![CDATA[Apache Shiroï¼ˆå‘éŸ³ä¸ºshee-rohï¼Œæ—¥è¯­å ¡åž’ï¼ˆCastleï¼‰çš„æ„æ€ï¼‰æ˜¯ä¸€ä¸ªå¼ºå¤§æ˜“ç”¨çš„Javaå®‰å…¨æ¡†æž¶ï¼Œæä¾›äº†è®¤è¯ã€æŽˆæƒã€åŠ å¯†å’Œä¼šè¯ç®¡ç†åŠŸèƒ½ï¼Œå¯ä¸ºä»»ä½•åº”ç”¨æä¾›å®‰å…¨ä¿éšœ - ä»Žå‘½ä»¤è¡Œåº”ç”¨ã€ç§»åŠ¨åº”ç”¨åˆ°å¤§åž‹ç½‘ç»œåŠä¼ä¸šåº”ç”¨ã€‚ç›¸è¾ƒäºŽSpring Securityæ¥è¯´è¾ƒä¸ºç®€å•ï¼Œæ˜“äºŽä¸Šæ‰‹ã€‚Apache Shiroæœ‰ä¸‰ä¸ªæ ¸å¿ƒçš„æ¦‚å¿µSubjectï¼ŒSecurityManagerå’ŒRealmsï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š1ã€Subjectï¼šä¸»ä½“ï¼Œä»£è¡¨äº†å½“å‰â€œç”¨æˆ·â€ï¼Œè¿™ä¸ªç”¨æˆ·ä¸ä¸€å®šæ˜¯ä¸€ä¸ªå…·ä½“çš„äººï¼Œä¸Žå½“å‰åº”ç”¨äº¤äº’çš„ä»»ä½•ä¸œè¥¿éƒ½æ˜¯Subjectï¼Œå¦‚ç½‘ç»œçˆ¬è™«ï¼Œæœºå™¨äººç­‰ï¼Œå³ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µã€‚æ‰€æœ‰Subject éƒ½ç»‘å®šåˆ°SecurityManagerï¼Œä¸ŽSubjectçš„æ‰€æœ‰äº¤äº’éƒ½ä¼šå§”æ‰˜ç»™SecurityManagerã€‚å¯ä»¥æŠŠSubjectè®¤ä¸ºæ˜¯ä¸€ä¸ªé—¨é¢ï¼ŒSecurityManageræ‰æ˜¯å®žé™…çš„æ‰§è¡Œè€…ã€‚åœ¨shiroä¸­é€šè¿‡org.apache.shiro.SecurityUtilsç±»æ¥èŽ·å–Subjectå¯¹è±¡ï¼š1234import org.apache.shiro.subject.Subject;import org.apache.shiro.SecurityUtils;...Subject currentUser = SecurityUtils.getSubject();æ›´å¤šå…³äºŽSubjectçš„ä¿¡æ¯å¯è®¿é—®http://shiro.apache.org/static/1.3.2/apidocs/org/apache/shiro/subject/Subject.html2ã€SecurityManagerï¼šå®‰å…¨ç®¡ç†å™¨ï¼Œå³æ‰€æœ‰ä¸Žå®‰å…¨æœ‰å…³çš„æ“ä½œéƒ½ä¼šä¸ŽSecurityManageräº¤äº’ï¼Œä¸”å®ƒç®¡ç†ç€æ‰€æœ‰Subjectï¼Œå¯ä»¥çœ‹å‡ºå®ƒæ˜¯Shiroçš„æ ¸å¿ƒã€‚å®ƒè´Ÿè´£ä¸ŽåŽè¾¹ä»‹ç»çš„å…¶ä»–ç»„ä»¶è¿›è¡Œ äº¤äº’ï¼Œç±»ä¼¼äºŽSpring MVCä¸­çš„DispatcherServletå‰ç«¯æŽ§åˆ¶å™¨ã€‚3ã€Realmï¼šåŸŸï¼ŒShiroä»ŽRealmèŽ·å–å®‰å…¨æ•°æ®ï¼ˆå¦‚ç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰ï¼Œå°±æ˜¯è¯´SecurityManagerè¦éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œé‚£ä¹ˆå®ƒéœ€è¦ä»ŽRealmèŽ·å–ç›¸åº”çš„ç”¨æˆ·è¿›è¡Œæ¯”è¾ƒä»¥ç¡®å®šç”¨æˆ·èº«ä»½æ˜¯å¦åˆæ³•ã€‚ ä¹Ÿéœ€è¦ä»ŽRealmå¾—åˆ°ç”¨æˆ·ç›¸åº”çš„è§’è‰²/æƒé™è¿›è¡ŒéªŒè¯ç”¨æˆ·æ˜¯å¦èƒ½è¿›è¡Œæ“ä½œã€‚ç®€è€Œè¨€ä¹‹ï¼Œåˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„Shiroåº”ç”¨è¿‡ç¨‹ä¸ºï¼šåº”ç”¨ä»£ç é€šè¿‡Subjectæ¥è¿›è¡Œè®¤è¯å’ŒæŽˆæƒï¼Œè€ŒSubjectåˆå§”æ‰˜ç»™SecurityManagerï¼›æˆ‘ä»¬éœ€è¦ç»™Shiroçš„SecurityManageræ³¨å…¥Realmï¼Œä»Žè€Œè®©SecurityManagerèƒ½å¾—åˆ°åˆæ³•çš„ç”¨æˆ·åŠå…¶æƒé™è¿›è¡Œåˆ¤æ–­ã€‚Shiroå¹¶æ²¡æœ‰ä¸ºæˆ‘ä»¬æä¾›Realmçš„å®žçŽ°ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ç¼–å†™å®žçŽ°ã€‚åŸºæœ¬è¿‡ç¨‹ä¸ºç»§æ‰¿org.apache.shiro.realm.AuthorizingRealmæŠ½è±¡ç±»ï¼Œå®žçŽ°doGetAuthorizationInfoå’ŒdoGetAuthenticationInfoæ–¹æ³•ã€‚äº†è§£äº†Shiroçš„æ ¸å¿ƒç»„ä»¶åŽï¼ŒæŽ¥ä¸‹æ¥çœ‹çœ‹Shiroä¸ºæˆ‘ä»¬å¸¦æ¥äº†å“ªäº›åŠŸèƒ½æ¨¡å—ï¼šShiroæä¾›äº†å››å¤§åŸºæœ¬å®‰å…¨åŠŸèƒ½ï¼šè®¤è¯ï¼ŒæŽˆæƒï¼Œä¼šè¯ç®¡ç†å’ŒåŠ å¯†ã€‚èº«ä»½éªŒè¯(Authentication)ï¼šä¹Ÿç§°ä¸ºç™»å½•éªŒè¯ï¼Œå³éªŒè¯ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®ï¼›æŽˆæƒ(Authorization)ï¼šæ ¹æ®ç”¨æˆ·çš„è§’è‰²å’Œæƒé™æ¥æŽ§åˆ¶ç”¨æˆ·å¯è®¿é—®çš„èµ„æºï¼›ä¼šè¯ç®¡ç†(Session Management)ï¼šå³ä½¿åœ¨éžWebæˆ–EJBåº”ç”¨ç¨‹åºä¸­ï¼Œä¹Ÿå¯ä»¥ç®¡ç†ç”¨æˆ·ç‰¹å®šçš„SESSIONä¼šè¯ï¼›å¯†ç å­¦(Cryptography)ï¼šä½¿ç”¨åŠ å¯†ç®—æ³•ä¿è¯æ•°æ®å®‰å…¨ï¼ŒåŒæ—¶æ˜“äºŽä½¿ç”¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒShiroä¹Ÿæ”¯æŒä»¥ä¸‹ç‰¹æ€§ï¼šWebæ”¯æŒ(Web Support)ï¼šShiroæä¾›çš„webç¨‹åºAPIå¯ä»¥å¸®åŠ©è½»æ¾ä¿æŠ¤Webåº”ç”¨ç¨‹åºï¼›ç¼“å­˜(Caching)ï¼šç¼“å­˜å¯ç¡®ä¿å®‰å…¨éªŒè¯æ“ä½œä¿æŒå¿«é€Ÿé«˜æ•ˆï¼›å¹¶å‘æ€§(Concurrency)ï¼šApache Shiroæ”¯æŒå…·æœ‰å¹¶å‘åŠŸèƒ½çš„å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºï¼›æµ‹è¯•(Testing)ï¼šæµ‹è¯•APIå¸®åŠ©æ‚¨ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼›è¿è¡Œæ–¹å¼(Run As)ï¼šå…è®¸ç”¨æˆ·ä»¥åˆ«çš„ç”¨æˆ·èº«ä»½ï¼ˆå¦‚æžœå…è®¸ï¼‰ç™»å½•ï¼›è®°ä½æˆ‘(Remember Me)ï¼šåœ¨ä¼šè¯ä¸­è®°ä½ç”¨æˆ·çš„èº«ä»½ï¼Œåªæœ‰åœ¨å¼ºåˆ¶ç™»å½•æ—¶æ‰éœ€è¦ç™»å½•ã€‚å‚è€ƒè‡ª:http://shiro.apache.org/introduction.htmlhttp://www.infoq.com/cn/articles/apache-shiro]]></content>
      <tags>
        <tag>Shiro</tag>
        <tag>Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Booté¡¹ç›®æ‰“åŒ…æˆwaråŒ…]]></title>
    <url>%2FSpring-Boot%20war.html</url>
    <content type="text"><![CDATA[åœ¨pom.xmlæ–‡ä»¶ä¸­ï¼Œå°†æ‰“åŒ…æ–¹å¼æ”¹ä¸ºwarï¼š1&lt;packaging&gt;war&lt;/packaging&gt;ç„¶åŽæ·»åŠ å¦‚ä¸‹çš„Tomcatä¾èµ–é…ç½®ï¼Œè¦†ç›–Spring Bootè‡ªå¸¦çš„Tomcatä¾èµ–ï¼š12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;scope&gt;provided&lt;/scope&gt;&lt;/dependency&gt;åœ¨&lt;build&gt;&lt;/build&gt;æ ‡ç­¾å†…é…ç½®é¡¹ç›®åï¼ˆè¯¥é…ç½®ç±»ä¼¼äºŽserver.context-path=mrbirdï¼‰ï¼š123456...&lt;build&gt; ... &lt;finalName&gt;mrbird&lt;/finalName&gt;&lt;/build&gt;...æ·»åŠ å¯åŠ¨ç±»ServletInitializerï¼š123456789import org.springframework.boot.builder.SpringApplicationBuilder;import org.springframework.boot.web.support.SpringBootServletInitializer;public class ServletInitializer extends SpringBootServletInitializer &#123; @Override protected SpringApplicationBuilder configure(SpringApplicationBuilder application) &#123; return application.sources(Application.class); &#125;&#125;å…¶ä¸­Applicationä¸ºSpring Bootçš„å¯åŠ¨ç±»ã€‚å‡†å¤‡å®Œæ¯•åŽï¼Œè¿è¡Œmvn clean packageå‘½ä»¤å³å¯åœ¨targetç›®å½•ä¸‹ç”Ÿäº§waråŒ…ï¼š]]></content>
      <tags>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootä¸­ä½¿ç”¨ç¼“å­˜]]></title>
    <url>%2FSpring-Boot%20cache.html</url>
    <content type="text"><![CDATA[åœ¨ç¨‹åºä¸­å¯ä»¥ä½¿ç”¨ç¼“å­˜çš„æŠ€æœ¯æ¥èŠ‚çœå¯¹æ•°æ®åº“çš„å¼€é”€ã€‚Spring Bootå¯¹ç¼“å­˜æä¾›äº†å¾ˆå¥½çš„æ”¯æŒï¼Œæˆ‘ä»¬å‡ ä¹Žä¸ç”¨åšè¿‡å¤šçš„é…ç½®å³å¯ä½¿ç”¨å„ç§ç¼“å­˜å®žçŽ°ã€‚è¿™é‡Œä¸»è¦ä»‹ç»å¹³æ—¥é‡Œä¸ªäººæŽ¥è§¦è¾ƒå¤šçš„Ehcacheå’ŒRedisç¼“å­˜å®žçŽ°ã€‚å‡†å¤‡å·¥ä½œå¯æ ¹æ®Spring-Bootä¸­ä½¿ç”¨Mybatis.htmlæ­å»ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œç„¶åŽymlä¸­é…ç½®æ—¥å¿—è¾“å‡ºçº§åˆ«ä»¥è§‚å¯ŸSQLçš„æ‰§è¡Œæƒ…å†µï¼š12345logging: level: com: springboot: mapper: debugå…¶ä¸­com.spring.mapperä¸ºMyBatisçš„MapperæŽ¥å£è·¯å¾„ã€‚ç„¶åŽç¼–å†™å¦‚ä¸‹æµ‹è¯•æ–¹æ³•ï¼š12345678910111213141516@RunWith(SpringJUnit4ClassRunner.class)@SpringBootTest(classes = Application.class)public class ApplicationTest &#123; @Autowired private StudentService studentService; @Test public void test() throws Exception &#123; Student student1 = this.studentService.queryStudentBySno("001"); System.out.println("å­¦å·" + student1.getSno() + "çš„å­¦ç”Ÿå§“åä¸ºï¼š" + student1.getName()); Student student2 = this.studentService.queryStudentBySno("001"); System.out.println("å­¦å·" + student2.getSno() + "çš„å­¦ç”Ÿå§“åä¸ºï¼š" + student2.getName()); &#125;&#125;å³é”®run as junit testï¼š123456782017-11-17 16:34:26.535 DEBUG 9932 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Preparing: select * from student where sno=? 2017-11-17 16:34:26.688 DEBUG 9932 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Parameters: 001(String)2017-11-17 16:34:26.716 DEBUG 9932 --- [main] c.s.m.StudentMapper.queryStudentBySno : &lt;== Total: 1å­¦å·001çš„å­¦ç”Ÿå§“åä¸ºï¼šKangKang2017-11-17 16:34:26.720 DEBUG 9932 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Preparing: select * from student where sno=? 2017-11-17 16:34:26.720 DEBUG 9932 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Parameters: 001(String)2017-11-17 16:34:26.721 DEBUG 9932 --- [main] c.s.m.StudentMapper.queryStudentBySno : &lt;== Total: 1å­¦å·001çš„å­¦ç”Ÿå§“åä¸ºï¼šKangKangå¯å‘çŽ°ç¬¬äºŒä¸ªæŸ¥è¯¢è™½ç„¶å’Œç¬¬ä¸€ä¸ªæŸ¥è¯¢å®Œå…¨ä¸€æ ·ï¼Œä½†å…¶è¿˜æ˜¯å¯¹æ•°æ®åº“è¿›è¡Œäº†æŸ¥è¯¢ã€‚æŽ¥ä¸‹æ¥å¼•å…¥ç¼“å­˜æ¥æ”¹å–„è¿™ä¸ªç»“æžœã€‚ä½¿ç”¨ç¼“å­˜è¦å¼€å¯Spring Bootçš„ç¼“å­˜åŠŸèƒ½ï¼Œéœ€è¦åœ¨pomä¸­å¼•å…¥spring-boot-starter-cacheï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;&lt;/dependency&gt;æŽ¥ç€åœ¨Spring Bootå…¥å£ç±»ä¸­åŠ å…¥@EnableCachingæ³¨è§£å¼€å¯ç¼“å­˜åŠŸèƒ½ï¼š1234567@SpringBootApplication@EnableCachingpublic class Application &#123; public static void main(String[] args) &#123; SpringApplication.run(Application.class,args); &#125;&#125;åœ¨StudentServiceæŽ¥å£ä¸­åŠ å…¥ç¼“å­˜æ³¨è§£ï¼š123456789101112@CacheConfig(cacheNames = "student")@Repositorypublic interface StudentService &#123; @CachePut(key = "#p0.sno") Student update(Student student); @CacheEvict(key = "#p0", allEntries = true) void deleteStudentBySno(String sno); @Cacheable(key = "#p0") Student queryStudentBySno(String sno);&#125;æˆ‘ä»¬åœ¨StudentServiceæŽ¥å£ä¸­åŠ å…¥äº†@CacheConfigæ³¨è§£ï¼ŒqueryStudentBySnoæ–¹æ³•ä½¿ç”¨äº†æ³¨è§£@Cacheable(key=&quot;#p0&quot;)ï¼Œå³å°†idä½œä¸ºredisä¸­çš„keyå€¼ã€‚å½“æˆ‘ä»¬æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œåº”è¯¥ä½¿ç”¨@CachePut(key=&quot;#p0.sno&quot;)è¿›è¡Œç¼“å­˜æ•°æ®çš„æ›´æ–°ï¼Œå¦åˆ™å°†æŸ¥è¯¢åˆ°è„æ•°æ®ï¼Œå› ä¸ºè¯¥æ³¨è§£ä¿å­˜çš„æ˜¯æ–¹æ³•çš„è¿”å›žå€¼ï¼Œæ‰€ä»¥è¿™é‡Œåº”è¯¥è¿”å›žStudentã€‚å…¶å®žçŽ°ç±»ï¼š123456789101112131415161718192021@Repository("studentService")public class StudentServiceImpl implements StudentService&#123; @Autowired private StudentMapper studentMapper; @Override public Student update(Student student) &#123; this.studentMapper.update(student); return this.studentMapper.queryStudentBySno(student.getSno()); &#125; @Override public void deleteStudentBySno(String sno) &#123; this.studentMapper.deleteStudentBySno(sno); &#125; @Override public Student queryStudentBySno(String sno) &#123; return this.studentMapper.queryStudentBySno(sno); &#125;&#125;åœ¨Spring Bootä¸­å¯ä½¿ç”¨çš„ç¼“å­˜æ³¨è§£æœ‰ï¼šç¼“å­˜æ³¨è§£@CacheConfigï¼šä¸»è¦ç”¨äºŽé…ç½®è¯¥ç±»ä¸­ä¼šç”¨åˆ°çš„ä¸€äº›å…±ç”¨çš„ç¼“å­˜é…ç½®ã€‚åœ¨è¿™é‡Œ@CacheConfig(cacheNames = &quot;student&quot;)ï¼šé…ç½®äº†è¯¥æ•°æ®è®¿é—®å¯¹è±¡ä¸­è¿”å›žçš„å†…å®¹å°†å­˜å‚¨äºŽåä¸ºstudentçš„ç¼“å­˜å¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨è¯¥æ³¨è§£ï¼Œç›´æŽ¥é€šè¿‡@Cacheableè‡ªå·±é…ç½®ç¼“å­˜é›†çš„åå­—æ¥å®šä¹‰ï¼›@Cacheableï¼šé…ç½®äº†queryStudentBySnoå‡½æ•°çš„è¿”å›žå€¼å°†è¢«åŠ å…¥ç¼“å­˜ã€‚åŒæ—¶åœ¨æŸ¥è¯¢æ—¶ï¼Œä¼šå…ˆä»Žç¼“å­˜ä¸­èŽ·å–ï¼Œè‹¥ä¸å­˜åœ¨æ‰å†å‘èµ·å¯¹æ•°æ®åº“çš„è®¿é—®ã€‚è¯¥æ³¨è§£ä¸»è¦æœ‰ä¸‹é¢å‡ ä¸ªå‚æ•°ï¼švalueã€cacheNamesï¼šä¸¤ä¸ªç­‰åŒçš„å‚æ•°ï¼ˆcacheNamesä¸ºSpring 4æ–°å¢žï¼Œä½œä¸ºvalueçš„åˆ«åï¼‰ï¼Œç”¨äºŽæŒ‡å®šç¼“å­˜å­˜å‚¨çš„é›†åˆåã€‚ç”±äºŽSpring 4ä¸­æ–°å¢žäº†@CacheConfigï¼Œå› æ­¤åœ¨Spring 3ä¸­åŽŸæœ¬å¿…é¡»æœ‰çš„valueå±žæ€§ï¼Œä¹Ÿæˆä¸ºéžå¿…éœ€é¡¹äº†ï¼›keyï¼šç¼“å­˜å¯¹è±¡å­˜å‚¨åœ¨Mapé›†åˆä¸­çš„keyå€¼ï¼Œéžå¿…éœ€ï¼Œç¼ºçœæŒ‰ç…§å‡½æ•°çš„æ‰€æœ‰å‚æ•°ç»„åˆä½œä¸ºkeyå€¼ï¼Œè‹¥è‡ªå·±é…ç½®éœ€ä½¿ç”¨SpELè¡¨è¾¾å¼ï¼Œæ¯”å¦‚ï¼š@Cacheable(key = &quot;#p0&quot;)ï¼šä½¿ç”¨å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºç¼“å­˜çš„keyå€¼ï¼Œæ›´å¤šå…³äºŽSpELè¡¨è¾¾å¼çš„è¯¦ç»†å†…å®¹å¯å‚è€ƒhttps://docs.spring.io/spring/docs/current/spring-framework-reference/integration.html#cacheï¼›conditionï¼šç¼“å­˜å¯¹è±¡çš„æ¡ä»¶ï¼Œéžå¿…éœ€ï¼Œä¹Ÿéœ€ä½¿ç”¨SpELè¡¨è¾¾å¼ï¼Œåªæœ‰æ»¡è¶³è¡¨è¾¾å¼æ¡ä»¶çš„å†…å®¹æ‰ä¼šè¢«ç¼“å­˜ï¼Œæ¯”å¦‚ï¼š@Cacheable(key = &quot;#p0&quot;, condition = &quot;#p0.length() &lt; 3&quot;)ï¼Œè¡¨ç¤ºåªæœ‰å½“ç¬¬ä¸€ä¸ªå‚æ•°çš„é•¿åº¦å°äºŽ3çš„æ—¶å€™æ‰ä¼šè¢«ç¼“å­˜ï¼›unlessï¼šå¦å¤–ä¸€ä¸ªç¼“å­˜æ¡ä»¶å‚æ•°ï¼Œéžå¿…éœ€ï¼Œéœ€ä½¿ç”¨SpELè¡¨è¾¾å¼ã€‚å®ƒä¸åŒäºŽconditionå‚æ•°çš„åœ°æ–¹åœ¨äºŽå®ƒçš„åˆ¤æ–­æ—¶æœºï¼Œè¯¥æ¡ä»¶æ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨ä¹‹åŽæ‰åšåˆ¤æ–­çš„ï¼Œæ‰€ä»¥å®ƒå¯ä»¥é€šè¿‡å¯¹resultè¿›è¡Œåˆ¤æ–­ï¼›keyGeneratorï¼šç”¨äºŽæŒ‡å®škeyç”Ÿæˆå™¨ï¼Œéžå¿…éœ€ã€‚è‹¥éœ€è¦æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰çš„keyç”Ÿæˆå™¨ï¼Œæˆ‘ä»¬éœ€è¦åŽ»å®žçŽ°org.springframework.cache.interceptor.KeyGeneratoræŽ¥å£ï¼Œå¹¶ä½¿ç”¨è¯¥å‚æ•°æ¥æŒ‡å®šï¼›cacheManagerï¼šç”¨äºŽæŒ‡å®šä½¿ç”¨å“ªä¸ªç¼“å­˜ç®¡ç†å™¨ï¼Œéžå¿…éœ€ã€‚åªæœ‰å½“æœ‰å¤šä¸ªæ—¶æ‰éœ€è¦ä½¿ç”¨ï¼›cacheResolverï¼šç”¨äºŽæŒ‡å®šä½¿ç”¨é‚£ä¸ªç¼“å­˜è§£æžå™¨ï¼Œéžå¿…éœ€ã€‚éœ€é€šè¿‡org.springframework.cache.interceptor.CacheResolveræŽ¥å£æ¥å®žçŽ°è‡ªå·±çš„ç¼“å­˜è§£æžå™¨ï¼Œå¹¶ç”¨è¯¥å‚æ•°æŒ‡å®šï¼›@CachePutï¼šé…ç½®äºŽå‡½æ•°ä¸Šï¼Œèƒ½å¤Ÿæ ¹æ®å‚æ•°å®šä¹‰æ¡ä»¶æ¥è¿›è¡Œç¼“å­˜ï¼Œå…¶ç¼“å­˜çš„æ˜¯æ–¹æ³•çš„è¿”å›žå€¼ï¼Œå®ƒä¸Ž@Cacheableä¸åŒçš„æ˜¯ï¼Œå®ƒæ¯æ¬¡éƒ½ä¼šçœŸå®žè°ƒç”¨å‡½æ•°ï¼Œæ‰€ä»¥ä¸»è¦ç”¨äºŽæ•°æ®æ–°å¢žå’Œä¿®æ”¹æ“ä½œä¸Šã€‚å®ƒçš„å‚æ•°ä¸Ž@Cacheableç±»ä¼¼ï¼Œå…·ä½“åŠŸèƒ½å¯å‚è€ƒä¸Šé¢å¯¹@Cacheableå‚æ•°çš„è§£æžï¼›@CacheEvictï¼šé…ç½®äºŽå‡½æ•°ä¸Šï¼Œé€šå¸¸ç”¨åœ¨åˆ é™¤æ–¹æ³•ä¸Šï¼Œç”¨æ¥ä»Žç¼“å­˜ä¸­ç§»é™¤ç›¸åº”æ•°æ®ã€‚é™¤äº†åŒ@Cacheableä¸€æ ·çš„å‚æ•°ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰ä¸‹é¢ä¸¤ä¸ªå‚æ•°ï¼šallEntriesï¼šéžå¿…éœ€ï¼Œé»˜è®¤ä¸ºfalseã€‚å½“ä¸ºtrueæ—¶ï¼Œä¼šç§»é™¤æ‰€æœ‰æ•°æ®ï¼›beforeInvocationï¼šéžå¿…éœ€ï¼Œé»˜è®¤ä¸ºfalseï¼Œä¼šåœ¨è°ƒç”¨æ–¹æ³•ä¹‹åŽç§»é™¤æ•°æ®ã€‚å½“ä¸ºtrueæ—¶ï¼Œä¼šåœ¨è°ƒç”¨æ–¹æ³•ä¹‹å‰ç§»é™¤æ•°æ®ã€‚ç¼“å­˜å®žçŽ°è¦ä½¿ç”¨ä¸ŠSpring Bootçš„ç¼“å­˜åŠŸèƒ½ï¼Œè¿˜éœ€è¦æä¾›ä¸€ä¸ªç¼“å­˜çš„å…·ä½“å®žçŽ°ã€‚Spring Bootæ ¹æ®ä¸‹é¢çš„é¡ºåºåŽ»ä¾¦æµ‹ç¼“å­˜å®žçŽ°ï¼šGenericJCache (JSR-107)EhCache 2.xHazelcastInfinispanRedisGuavaSimpleé™¤äº†æŒ‰é¡ºåºä¾¦æµ‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®å±žæ€§spring.cache.typeæ¥å¼ºåˆ¶æŒ‡å®šã€‚æŽ¥ä¸‹æ¥ä¸»è¦ä»‹ç»åŸºäºŽRediså’ŒEhcacheçš„ç¼“å­˜å®žçŽ°ã€‚RedisRedisçš„ä¸‹è½½åœ°å€ä¸ºhttps://github.com/MicrosoftArchive/redis/releasesï¼ŒRedis æ”¯æŒ 32 ä½å’Œ 64 ä½ã€‚è¿™ä¸ªéœ€è¦æ ¹æ®ä½ ç³»ç»Ÿå¹³å°çš„å®žé™…æƒ…å†µé€‰æ‹©ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸‹è½½ Redis-x64-xxx.zipåŽ‹ç¼©åŒ…åˆ°Cç›˜ã€‚æ‰“å¼€ä¸€ä¸ªCMDçª—å£ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š123456789101112131415161718192021222324C:\Users\Administrator&gt;cd c:\Redis-x64-3.2.100c:\Redis-x64-3.2.100&gt;redis-server.exe redis.windows.conf _._ _.-``__ ''-._ _.-`` `. `_. ''-._ Redis 3.2.100 (00000000/0) 64 bit .-`` .-```. ```\/ _.,_ ''-._ ( ' , .-` | `, ) Running in standalone mode |`-._`-...-` __...-.``-._|'` _.-'| Port: 6379 | `-._ `._ / _.-' | PID: 6404 `-._ `-._ `-./ _.-' _.-' |`-._`-._ `-.__.-' _.-'_.-'| | `-._`-._ _.-'_.-' | http://redis.io `-._ `-._`-.__.-'_.-' _.-' |`-._`-._ `-.__.-' _.-'_.-'| | `-._`-._ _.-'_.-' | `-._ `-._`-.__.-'_.-' _.-' `-._ `-.__.-' _.-' `-._ _.-' `-.__.-'[6404] 25 Dec 09:47:58.890 # Server started, Redis version 3.2.100[6404] 25 Dec 09:47:58.898 * DB loaded from disk: 0.007 seconds[6404] 25 Dec 09:47:58.898 * The server is now ready to accept connections on port 6379ç„¶åŽæ‰“å¼€å¦å¤–ä¸€ä¸ªCMDç»ˆç«¯ï¼Œè¾“å…¥ï¼š1234C:\Users\Administrator&gt;cd c:\Redis-x64-3.2.100c:\Redis-x64-3.2.100&gt;redis-cli.exe -p 6379127.0.0.1:6379&gt;å‡†å¤‡å·¥ä½œåšå®ŒåŽï¼ŒæŽ¥ä¸‹æ¥å¼€å§‹åœ¨Spring Booté¡¹ç›®é‡Œå¼•å…¥Redisï¼š12345&lt;!-- spring-boot redis --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;åœ¨application.ymlä¸­é…ç½®Redisï¼š12345678910111213141516171819spring: redis: # Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰ database: 0 # RedisæœåŠ¡å™¨åœ°å€ host: localhost # RedisæœåŠ¡å™¨è¿žæŽ¥ç«¯å£ port: 6379 pool: # è¿žæŽ¥æ± æœ€å¤§è¿žæŽ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ max-active: 8 # è¿žæŽ¥æ± æœ€å¤§é˜»å¡žç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ max-wait: -1 # è¿žæŽ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿žæŽ¥ max-idle: 8 # è¿žæŽ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿žæŽ¥ min-idle: 0 # è¿žæŽ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ timeout: 0æ›´å¤šå…³äºŽSpring Boot Redisé…ç½®å¯å‚è€ƒï¼šhttps://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html# REDISæŽ¥ç€åˆ›å»ºä¸€ä¸ªRedisé…ç½®ç±»ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647@Configurationpublic class RedisConfig extends CachingConfigurerSupport &#123; // è‡ªå®šä¹‰ç¼“å­˜keyç”Ÿæˆç­–ç•¥ @Bean public KeyGenerator keyGenerator() &#123; return new KeyGenerator() &#123; @Override public Object generate(Object target, java.lang.reflect.Method method, Object... params) &#123; StringBuffer sb = new StringBuffer(); sb.append(target.getClass().getName()); sb.append(method.getName()); for (Object obj : params) &#123; sb.append(obj.toString()); &#125; return sb.toString(); &#125; &#125;; &#125; // ç¼“å­˜ç®¡ç†å™¨ @Bean public CacheManager cacheManager(@SuppressWarnings("rawtypes") RedisTemplate redisTemplate) &#123; RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate); // è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ cacheManager.setDefaultExpiration(3600); return cacheManager; &#125; @Bean public RedisTemplate&lt;String, String&gt; redisTemplate(RedisConnectionFactory factory) &#123; StringRedisTemplate template = new StringRedisTemplate(factory); setSerializer(template);// è®¾ç½®åºåˆ—åŒ–å·¥å…· template.afterPropertiesSet(); return template; &#125; private void setSerializer(StringRedisTemplate template) &#123; @SuppressWarnings(&#123; "rawtypes", "unchecked" &#125;) Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class); ObjectMapper om = new ObjectMapper(); om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY); om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL); jackson2JsonRedisSerializer.setObjectMapper(om); template.setValueSerializer(jackson2JsonRedisSerializer); &#125;&#125;è¿è¡Œæµ‹è¯•ï¼ŒæŽ§åˆ¶å°è¾“å‡ºï¼š123452017-11-17 18:17:06.995 DEBUG 8836 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Preparing: select * from student where sno=? 2017-11-17 18:17:07.128 DEBUG 8836 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Parameters: 001(String)2017-11-17 18:17:07.152 DEBUG 8836 --- [main] c.s.m.StudentMapper.queryStudentBySno : &lt;== Total: 1å­¦å·001çš„å­¦ç”Ÿå§“åä¸ºï¼šKangKangå­¦å·001çš„å­¦ç”Ÿå§“åä¸ºï¼šKangKangç¬¬äºŒæ¬¡æŸ¥è¯¢æ²¡æœ‰è®¿é—®æ•°æ®åº“ï¼Œè€Œæ˜¯ä»Žç¼“å­˜ä¸­èŽ·å–çš„ï¼Œåœ¨redisä¸­æŸ¥çœ‹è¯¥å€¼ï¼š12345127.0.0.1:6379&gt; keys *1) "student~keys"2) "001"127.0.0.1:6379&gt; get 001"[\"com.springboot.bean.Student\",&#123;\"sno\":\"001\",\"name\":\"KangKang\",\"sex\":\"M \"&#125;]"åœ¨æµ‹è¯•æ–¹æ³•ä¸­æµ‹è¯•æ›´æ–°ï¼š1234567891011@Testpublic void test() throws Exception &#123; Student student1 = this.studentService.queryStudentBySno("001"); System.out.println("å­¦å·" + student1.getSno() + "çš„å­¦ç”Ÿå§“åä¸ºï¼š" + student1.getName()); student1.setName("åº·åº·"); this.studentService.update(student1); Student student2 = this.studentService.queryStudentBySno("001"); System.out.println("å­¦å·" + student2.getSno() + "çš„å­¦ç”Ÿå§“åä¸ºï¼š" + student2.getName());&#125;æŽ§åˆ¶å°è¾“å‡ºï¼š123456789å­¦å·001çš„å­¦ç”Ÿå§“åä¸ºï¼šKangKang2017-11-17 19:30:05.813 INFO 11244 --- [main] com.alibaba.druid.pool.DruidDataSource : &#123;dataSource-1&#125; inited2017-11-17 19:30:05.823 DEBUG 11244 --- [main] c.s.mapper.StudentMapper.update : ==&gt; Preparing: update student set sname=?,ssex=? where sno=? 2017-11-17 19:30:05.941 DEBUG 11244 --- [main] c.s.mapper.StudentMapper.update : ==&gt; Parameters: åº·åº·(String), M (String), 001(String)2017-11-17 19:30:05.953 DEBUG 11244 --- [main] c.s.mapper.StudentMapper.update : &lt;== Updates: 12017-11-17 19:30:05.957 DEBUG 11244 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Preparing: select * from student where sno=? 2017-11-17 19:30:05.959 DEBUG 11244 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Parameters: 001(String)2017-11-17 19:30:05.976 DEBUG 11244 --- [main] c.s.m.StudentMapper.queryStudentBySno : &lt;== Total: 1å­¦å·001çš„å­¦ç”Ÿå§“åä¸ºï¼šåº·åº·åœ¨redisä¸­æŸ¥çœ‹ï¼š12127.0.0.1:6379&gt; get 001"[\"com.springboot.bean.Student\",&#123;\"sno\":\"001\",\"name\":\"\xe5\xba\xb7\xe5\xba\xb7\",\"sex\":\"M \"&#125;]"å¯è§æ›´æ–°æ•°æ®åº“çš„åŒæ—¶ï¼Œç¼“å­˜ä¹Ÿå¾—åˆ°äº†æ›´æ–°ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/09.Spring-Boot-Redis-CacheEhcacheå¼•å…¥Ehcacheä¾èµ–ï¼š12345&lt;!-- ehcache --&gt;&lt;dependency&gt; &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt; &lt;artifactId&gt;ehcache&lt;/artifactId&gt;&lt;/dependency&gt;åœ¨src/main/resourcesç›®å½•ä¸‹æ–°å»ºehcache.xmlï¼š123456789101112131415161718192021&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="ehcache.xsd"&gt; &lt;defaultCache maxElementsInMemory="10000" eternal="false" timeToIdleSeconds="3600" timeToLiveSeconds="0" overflowToDisk="false" diskPersistent="false" diskExpiryThreadIntervalSeconds="120" /&gt; &lt;cache name="student" maxEntriesLocalHeap="2000" eternal="false" timeToIdleSeconds="3600" timeToLiveSeconds="0" overflowToDisk="false" statistics="true"/&gt;&lt;/ehcache&gt;å…³äºŽEhcaheçš„ä¸€äº›è¯´æ˜Žï¼šnameï¼šç¼“å­˜åç§°ã€‚maxElementsInMemoryï¼šç¼“å­˜æœ€å¤§æ•°ç›®maxElementsOnDiskï¼šç¡¬ç›˜æœ€å¤§ç¼“å­˜ä¸ªæ•°ã€‚eternalï¼šå¯¹è±¡æ˜¯å¦æ°¸ä¹…æœ‰æ•ˆï¼Œä¸€ä½†è®¾ç½®äº†ï¼Œtimeoutå°†ä¸èµ·ä½œç”¨ã€‚overflowToDiskï¼šæ˜¯å¦ä¿å­˜åˆ°ç£ç›˜ã€‚timeToIdleSeconds:è®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰çš„å…è®¸é—²ç½®æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œå¯é€‰å±žæ€§ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å¯é—²ç½®æ—¶é—´æ— ç©·å¤§ã€‚timeToLiveSecondsï¼šè®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰å…è®¸å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚æœ€å¤§æ—¶é—´ä»‹äºŽåˆ›å»ºæ—¶é—´å’Œå¤±æ•ˆæ—¶é—´ä¹‹é—´ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡å­˜æ´»æ—¶é—´æ— ç©·å¤§ã€‚diskPersistentï¼šæ˜¯å¦ç¼“å­˜è™šæ‹Ÿæœºé‡å¯æœŸæ•°æ®ï¼Œé»˜è®¤å€¼ä¸ºfalseã€‚diskSpoolBufferSizeMBï¼šè¿™ä¸ªå‚æ•°è®¾ç½®DiskStoreï¼ˆç£ç›˜ç¼“å­˜ï¼‰çš„ç¼“å­˜åŒºå¤§å°ã€‚é»˜è®¤æ˜¯30MBã€‚æ¯ä¸ªCacheéƒ½åº”è¯¥æœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²åŒºã€‚diskExpiryThreadIntervalSecondsï¼šç£ç›˜å¤±æ•ˆçº¿ç¨‹è¿è¡Œæ—¶é—´é—´éš”ï¼Œé»˜è®¤æ˜¯120ç§’ã€‚memoryStoreEvictionPolicyï¼šå½“è¾¾åˆ°maxElementsInMemoryé™åˆ¶æ—¶ï¼ŒEhcacheå°†ä¼šæ ¹æ®æŒ‡å®šçš„ç­–ç•¥åŽ»æ¸…ç†å†…å­˜ã€‚é»˜è®¤ç­–ç•¥æ˜¯LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ã€‚ä½ å¯ä»¥è®¾ç½®ä¸ºFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æˆ–æ˜¯LFUï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰ã€‚clearOnFlushï¼šå†…å­˜æ•°é‡æœ€å¤§æ—¶æ˜¯å¦æ¸…é™¤ã€‚memoryStoreEvictionPolicyï¼šEhcacheçš„ä¸‰ç§æ¸…ç©ºç­–ç•¥ï¼šFIFOï¼Œfirst in first outï¼Œè¿™ä¸ªæ˜¯å¤§å®¶æœ€ç†Ÿçš„ï¼Œå…ˆè¿›å…ˆå‡ºã€‚LFUï¼Œ Less Frequently Usedï¼Œå°±æ˜¯ä¸Šé¢ä¾‹å­ä¸­ä½¿ç”¨çš„ç­–ç•¥ï¼Œç›´ç™½ä¸€ç‚¹å°±æ˜¯è®²ä¸€ç›´ä»¥æ¥æœ€å°‘è¢«ä½¿ç”¨çš„ã€‚å¦‚ä¸Šé¢æ‰€è®²ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªhitå±žæ€§ï¼Œhitå€¼æœ€å°çš„å°†ä¼šè¢«æ¸…å‡ºç¼“å­˜ã€‚LRUï¼ŒLeast Recently Usedï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ï¼Œç¼“å­˜çš„å…ƒç´ æœ‰ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå½“ç¼“å­˜å®¹é‡æ»¡äº†ï¼Œè€Œåˆéœ€è¦è…¾å‡ºåœ°æ–¹æ¥ç¼“å­˜æ–°çš„å…ƒç´ çš„æ—¶å€™ï¼Œé‚£ä¹ˆçŽ°æœ‰ç¼“å­˜å…ƒç´ ä¸­æ—¶é—´æˆ³ç¦»å½“å‰æ—¶é—´æœ€è¿œçš„å…ƒç´ å°†è¢«æ¸…å‡ºç¼“å­˜ã€‚æŽ¥ç€åœ¨application.ymlä¸­æŒ‡å®šehcacheé…ç½®çš„è·¯å¾„ï¼š1234spring: cache: ehcache: config: 'classpath:ehcache.xml'è¿™æ ·å°±å¯ä»¥å¼€å§‹ä½¿ç”¨ehcacheäº†ï¼Œè¿è¡Œæµ‹è¯•ç±»ï¼Œè§‚å¯ŸæŽ§åˆ¶å°ï¼š123452017-11-18 09:10:40.201 DEBUG 3364 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Preparing: select * from student where sno=? 2017-11-18 09:10:40.343 DEBUG 3364 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Parameters: 001(String)2017-11-18 09:10:40.364 DEBUG 3364 --- [main] c.s.m.StudentMapper.queryStudentBySno : &lt;== Total: 1å­¦å·001çš„å­¦ç”Ÿå§“åä¸ºï¼šKangKangå­¦å·001çš„å­¦ç”Ÿå§“åä¸ºï¼šKangKangå¯çœ‹åˆ°ç¬¬äºŒæ¬¡æ˜¯ä»Žç¼“å­˜ä¸­èŽ·å–çš„ã€‚æµ‹è¯•æ›´æ–°ï¼š12345678910112017-11-18 09:18:04.230 DEBUG 11556 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Preparing: select * from student where sno=? 2017-11-18 09:18:04.397 DEBUG 11556 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Parameters: 001(String)2017-11-18 09:18:04.427 DEBUG 11556 --- [main] c.s.m.StudentMapper.queryStudentBySno : &lt;== Total: 1å­¦å·001çš„å­¦ç”Ÿå§“åä¸ºï¼šKangKang2017-11-18 09:18:04.433 DEBUG 11556 --- [main] c.s.mapper.StudentMapper.update : ==&gt; Preparing: update student set sname=?,ssex=? where sno=? 2017-11-18 09:18:04.438 DEBUG 11556 --- [main] c.s.mapper.StudentMapper.update : ==&gt; Parameters: åº·åº·(String), M (String), 001(String)2017-11-18 09:18:04.440 DEBUG 11556 --- [main] c.s.mapper.StudentMapper.update : &lt;== Updates: 12017-11-18 09:18:04.440 DEBUG 11556 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Preparing: select * from student where sno=? 2017-11-18 09:18:04.441 DEBUG 11556 --- [main] c.s.m.StudentMapper.queryStudentBySno : ==&gt; Parameters: 001(String)2017-11-18 09:18:04.442 DEBUG 11556 --- [main] c.s.m.StudentMapper.queryStudentBySno : &lt;== Total: 1å­¦å·001çš„å­¦ç”Ÿå§“åä¸ºï¼šåº·åº·å¯è§ï¼Œå³ä½¿æ›´æ–°æ–¹æ³•åŠ äº†@CachePutæ³¨è§£ï¼Œç¬¬äºŒæ¬¡æŸ¥è¯¢å› ä¸ºStudentå¯¹è±¡æ›´æ–°äº†ï¼Œå…¶æ˜¯ä»Žæ•°æ®åº“èŽ·å–æ•°æ®çš„ï¼Œæ‰€ä»¥å¯¹äºŽEhcacheæ¥è¯´ï¼Œæ›´æ–°æ–¹æ³•åŠ ä¸åŠ @CachePutæ³¨è§£ï¼Œç»“æžœéƒ½ä¸€æ ·ã€‚æºç é“¾æŽ¥ï¼šhttps://github.com/wuyouzhuguli/Spring-Boot-Demos/tree/master/10.Spring-Boot-Ehcache-Cache]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
        <tag>Ehcache</tag>
        <tag>Redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracle Mergeè¯­å¥]]></title>
    <url>%2FOracle-Merge%E8%AF%AD%E5%8F%A5.html</url>
    <content type="text"><![CDATA[Mergeè¯­å¥æ˜¯Oracle 9iæ–°å¢žçš„è¯­æ³•ï¼Œç”¨æ¥åˆå¹¶Updateå’ŒInsertè¯­å¥ã€‚é€šè¿‡Mergeè¯­å¥ï¼Œæ ¹æ®ä¸€å¼ è¡¨æˆ–å­æŸ¥è¯¢çš„è¿žæŽ¥æ¡ä»¶å¯¹å¦å¤–ä¸€å¼ è¡¨è¿›è¡ŒæŸ¥è¯¢ï¼Œè¿žæŽ¥æ¡ä»¶åŒ¹é…ä¸Šçš„è¿›è¡ŒUpdateï¼Œæ— æ³•åŒ¹é…çš„æ‰§è¡ŒInsertã€‚è¿™ä¸ªè¯­æ³•ä»…éœ€è¦ä¸€æ¬¡å…¨è¡¨æ‰«æå°±å®Œæˆäº†å…¨éƒ¨å·¥ä½œï¼Œæ‰§è¡Œæ•ˆçŽ‡è¦é«˜äºŽInsert+Updateã€‚mergeè¯­å¥è¯­æ³•å¦‚ä¸‹ï¼š1234merge into table_name tusing (subquery) s on (s.column = t.column)when matched then update ...when not matched then insert ...onå…³é”®å­—å£°æ˜Žäº†å…³è”æ¡ä»¶ï¼Œå½“æœ‰è®°å½•åŒ¹é…æ—¶æ‰§è¡ŒUpdateè¯­å¥ï¼Œæ²¡æœ‰åŒ¹é…æ—¶ï¼Œæ‰§è¡ŒInsertè¯­å¥ã€‚ç¤ºä¾‹åˆ›å»ºä¸€å¼ studentè¡¨ï¼š1234567create table student( sno varchar2(3) not null, -- å­¦ç”Ÿç¼–å· sname varchar(9) not null, -- å­¦ç”Ÿå§“å ssex char(2) not null -- æ€§åˆ«);è¡¨å·²åˆ›å»ºã€‚æ’å…¥ä¸€æ¡å­¦ç”Ÿæ ‡å·ä¸º001çš„æ•°æ®ï¼š123456789101112131415SQL&gt; merge into student s using (select '001' sno,'KangKang' sname,'M' ssex from dual) t on (s.sno = t.sno) when matched then update set s.sname = t.sname,s.ssex = t.ssex when not matched then insert (s.sno,s.sname,s.ssex) values(t.sno,t.sname,t.ssex);1 è¡Œå·²åˆå¹¶ã€‚SQL&gt; select * from student;SNO SNAME SS--- --------- --001 KangKang Må†æ¬¡æ’å…¥ä¸€æ¡å­¦ç”Ÿç¼–å·ä¸º001çš„æ•°æ®ï¼Œä¸è¿‡snameå’Œssexä¸ä¸€æ ·ï¼š123456789101112131415SQL&gt; merge into student s using (select '001' sno,'Maria' sname,'F' ssex from dual) t on (s.sno = t.sno) when matched then update set s.sname = t.sname,s.ssex = t.ssex when not matched then insert (s.sno,s.sname,s.ssex) values(t.sno,t.sname,t.ssex);1 è¡Œå·²åˆå¹¶ã€‚SQL&gt; select * from student;SNO SNAME SS--- --------- --001 Maria F]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracleåˆ†æžå‡½æ•°ï¼ˆçª—å£å‡½æ•°ï¼‰]]></title>
    <url>%2Foracle%20Window%20function.html</url>
    <content type="text"><![CDATA[Oracle ä¸­çš„åˆ†æžå‡½æ•°åŸºäºŽå¯¹æ•°æ®è¡Œçš„åˆ†ç»„æ¥è®¡ç®—ç›¸å…³å€¼ï¼Œç±»ä¼¼äºŽèšåˆå‡½æ•°ã€‚å…¶å’Œèšåˆå‡½æ•°ä¸»è¦çš„åŒºåˆ«åœ¨äºŽï¼šåˆ†æžå‡½æ•°å¯¹äºŽæ¯ä¸ªåˆ†ç»„è¿”å›žå¤šè¡Œæ•°æ®ï¼Œè€Œèšåˆå‡½æ•°æ¯ä¸ªåˆ†ç»„åªèƒ½å¯¹åº”ä¸€è¡Œæ•°æ®ã€‚åˆ†æžå‡½æ•°ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šåˆ†åŒºå­å¥ã€æŽ’åºå­å¥å’Œå¼€çª—å­å¥ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š12function(arg1,arg2,...argN)over([partition-by-clause] [order-by-clause] [windowing-clause])å¼€çª—å­å¥windowing-clause æŒ‡å®šäº†åˆ†æžå‡½æ•°è¿›è¡Œè¿ç®—çš„æ•°æ®å­é›†ã€‚å¼€çª—å­å¥çš„å…·ä½“è¯­æ³•å¦‚ä¸‹ï¼š1234[rows | range] between &lt;start expr&gt; and &lt;end expr&gt;&lt;start expr&gt; is [unbounded preceding | current row | n preceding | n following]&lt;end expr&gt; is [unbounded following | current row | n preceding | n following]unbounded precedingè¡¨ç¤ºä»¥åˆ†ç»„æ•°æ®çš„ç¬¬ä¸€è¡Œæœ€ä¸ºä¸Šè¾¹ç•Œï¼›unbounded followingè¡¨ç¤ºä»¥åˆ†ç»„æ•°æ®çš„æœ€åŽä¸€è¡Œæœ€ä¸ºä¸‹è¾¹ç•Œï¼›current rowè¡¨ç¤ºå½“å‰æ•°æ®è¡Œï¼›n precedingè¡¨ç¤ºå½“å‰æ•°æ®è¡Œçš„å‰n è¡Œï¼›n followingè¡¨ç¤ºå½“å‰æ•°æ®è¡Œçš„åŽn è¡Œã€‚ä¸ºäº†æ¼”ç¤ºåˆ†æžå‡½æ•°ï¼Œé¦–å…ˆåœ¨SHç”¨æˆ·ä¸‹åˆ›å»ºä¸€å¼ sales_factè¡¨ï¼š12345678910111213141516171819SQL&gt; create table sales_fact as select country_name country,country_subRegion region,prod_name product, calendar_year year,calendar_week_number week, sum(amount_sold) sale, sum(amount_sold*( case when mod(rownum,10)=0 then 1.4 when mod(rownum,5)=0 then 0.6 when mod(rownum,2)=0 then 0.9 when mod(rownum,2)=1 then 1.2 else 1 end)) receipts from sales,times,customers,countries,products where sales.time_id=times.time_id and sales.prod_id = products.prod_id and sales.cust_id = customers.cust_id and customers.country_id = countries.country_id group by country_name,country_subRegion,prod_name,calendar_year,calendar_week_number;è¡¨å·²åˆ›å»ºã€‚åˆ†æžæ¨¡å¼ä¸‹çš„èšåˆå‡½æ•°å‰é¢æ‰€è¯´èšåˆå‡½æ•°æ¯ä¸ªåˆ†ç»„åªèƒ½å¯¹åº”ä¸€è¡Œæ•°æ®æ˜¯åœ¨ä¼ ç»Ÿçš„éžåˆ†æžæ¨¡å¼ä¸‹çš„ç»“æžœã€‚åˆ†æžæ¨¡å¼ä¸‹çš„èšåˆå‡½æ•°åˆ™æ²¡æœ‰æ­¤é™åˆ¶ã€‚æ¯”å¦‚ä¸‹é¢çš„SQLè¯­å¥è®¡ç®—äº†saleåˆ—æŒ‰ç…§äº§å“ï¼Œå›½å®¶ï¼Œåœ°åŒºå’Œå¹´ä»½ä¸ºä¸€ç»„ï¼Œä»Žæ¯å¹´å¹´åˆå¼€å§‹åˆ°è¯¥å¹´ä»½æ¯ä¸€å‘¨çš„åŠ¨æ€æ±‚å’Œå€¼ã€‚ï¼ˆä¸ºäº†èŠ‚çº¦ç¯‡å¹…ï¼Œä¸‹é¢ç»“æžœåªå–å‰10å‘¨ç»“æžœé›†ï¼‰ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546SQL&gt; select year,week,sale, sum(sale) over( partition by product,country,region,year order by week rows between unbounded preceding and current row ) running_sum_sale from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by year,week; YEAR WEEK SALE RUNNING_SUM_SALE---------- ---------- ---------- ---------------- 1998 1 58.15 58.15 1998 2 29.39 87.54 1998 3 29.49 117.03 1998 4 29.49 146.52 1998 5 29.8 176.32 1998 6 58.78 235.1 1998 9 58.78 293.88 1998 10 117.76 411.64 1999 1 53.52 53.52 1999 3 94.6 148.12 1999 4 40.5 188.62 1999 5 80.01 268.63 1999 6 40.5 309.13 1999 8 103.11 412.24 1999 9 53.34 465.58 1999 10 72 537.58 2000 1 46.7 46.7 2000 3 93.41 140.11 2000 4 46.54 186.65 2000 5 46.7 233.35 2000 7 70.8 304.15 2000 8 46.54 350.69 2001 1 92.26 92.26 2001 2 118.38 210.64 2001 3 47.24 257.88 2001 4 256.7 514.58 2001 5 93.44 608.02 2001 6 22.44 630.46 2001 7 69.96 700.42 2001 8 46.06 746.48 2001 9 92.67 839.15 2001 10 69.05 908.2å·²é€‰æ‹©32è¡Œã€‚èšåˆå‡½æ•°sum(sale)å£°æ˜Žè¦æ±‚å’Œçš„åˆ—ï¼Œpartition by product,country,region,yearåˆ†åŒºå­å¥å£°æ˜Žäº†åˆ†ç»„çš„åˆ—ï¼Œorder by weekæŽ’åºå­å¥å£°æ˜Žäº†åˆ†ç»„çš„æ•°æ®è¡ŒæŒ‰ç…§weekåˆ—æ¥è¿›è¡ŒæŽ’åºï¼Œrows between unbounded preceding and current rowå¼€çª—å­å¥å£°æ˜Žäº†è®¡ç®—çš„çª—å£èŒƒå›´ä¸ºåˆ†ç»„çš„ç¬¬ä¸€è¡Œåˆ°å½“å‰è¡Œã€‚ä¸‹é¢ä¾‹å­çš„çª—å£èŒƒå›´ä¸ºæ•´ä¸ªåˆ†ç»„ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546SQL&gt; select year,week,sale, max(sale) over( partition by product,country,region,year order by week rows between unbounded preceding and unbounded following ) max_sal_per_year from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by year,week; YEAR WEEK SALE MAX_SAL_PER_YEAR---------- ---------- ---------- ---------------- 1998 1 58.15 117.76 1998 2 29.39 117.76 1998 3 29.49 117.76 1998 4 29.49 117.76 1998 5 29.8 117.76 1998 6 58.78 117.76 1998 9 58.78 117.76 1998 10 117.76 117.76 1999 1 53.52 103.11 1999 3 94.6 103.11 1999 4 40.5 103.11 1999 5 80.01 103.11 1999 6 40.5 103.11 1999 8 103.11 103.11 1999 9 53.34 103.11 1999 10 72 103.11 2000 1 46.7 93.41 2000 3 93.41 93.41 2000 4 46.54 93.41 2000 5 46.7 93.41 2000 7 70.8 93.41 2000 8 46.54 93.41 2001 1 92.26 256.7 2001 2 118.38 256.7 2001 3 47.24 256.7 2001 4 256.7 256.7 2001 5 93.44 256.7 2001 6 22.44 256.7 2001 7 69.96 256.7 2001 8 46.06 256.7 2001 9 92.67 256.7 2001 10 69.05 256.7å·²é€‰æ‹©32è¡Œã€‚ä¸‹é¢ä¾‹å­çš„çª—å£èŒƒå›´ä¸ºå½“å‰å‘¨çš„å‰ä¸¤å‘¨å’ŒåŽä¸¤å‘¨ï¼Œä¹Ÿå°±æ˜¯äº”å‘¨ã€‚åœ¨åˆ†ç»„çš„è¾¹ç•Œå¤„ï¼Œçª—å£ä¼šè‡ªåŠ¨ç¼©å°ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546SQL&gt; select year,week,sale, max(sale) over( partition by product,country,region,year order by week rows between 2 preceding and 2 following ) max_sal_per_year from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by year,week; YEAR WEEK SALE MAX_SAL_PER_YEAR---------- ---------- ---------- ---------------- 1998 1 58.15 58.15 1998 2 29.39 58.15 1998 3 29.49 58.15 1998 4 29.49 58.78 1998 5 29.8 58.78 1998 6 58.78 117.76 1998 9 58.78 117.76 1998 10 117.76 117.76 1999 1 53.52 94.6 1999 3 94.6 94.6 1999 4 40.5 94.6 1999 5 80.01 103.11 1999 6 40.5 103.11 1999 8 103.11 103.11 1999 9 53.34 103.11 1999 10 72 103.11 2000 1 46.7 93.41 2000 3 93.41 93.41 2000 4 46.54 93.41 2000 5 46.7 93.41 2000 7 70.8 70.8 2000 8 46.54 70.8 2001 1 92.26 118.38 2001 2 118.38 256.7 2001 3 47.24 256.7 2001 4 256.7 256.7 2001 5 93.44 256.7 2001 6 22.44 256.7 2001 7 69.96 93.44 2001 8 46.06 92.67 2001 9 92.67 92.67 2001 10 69.05 92.67å·²é€‰æ‹©32è¡Œã€‚é»˜è®¤çš„çª—å£å­å¥æ˜¯rows between unbounded preceding and current rowã€‚lagå’Œleadlagå’Œleadå‡½æ•°èƒ½å¤Ÿå®žçŽ°è·¨è¡Œå¼•ç”¨ã€‚lagèƒ½å¤Ÿè®¿é—®ç»“æžœé›†ä¸­å‰é¢è¡Œå†…å®¹ï¼Œleadèƒ½å¤Ÿè®¿é—®ç»“æžœé›†ä¸­åŽé¢è¡Œå†…å®¹ã€‚lagå’Œleadå‡½æ•°ä¸æ”¯æŒå¼€çª—å­å¥ï¼Œä»…æ”¯æŒpartition byå’Œorder byå­å¥ã€‚laglagå‡½æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š1lag(expression, offset, default) over(partition-clause order-by-clause)expressionè¡¨ç¤ºè¿”å›žçš„åˆ—ï¼Œoffsetè¡¨ç¤ºç›¸éš”çš„è¡Œæ•°ï¼ˆä¸èƒ½ä¸ºè´Ÿæ•°ï¼‰ï¼Œdefaultè¡¨ç¤ºé»˜è®¤å€¼ã€‚æ¯”å¦‚ï¼Œä»Žå‰ä¸€è¡Œä¸­è¿”å›žä¸€ä¸ªå€¼ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445SQL&gt; select year,week,sale, lag(sale) over( partition by product,country,region,year order by week ) prior_wk_sales from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by product,country,year,week; YEAR WEEK SALE PRIOR_WK_SALES---------- ---------- ---------- -------------- 1998 1 58.15 1998 2 29.39 58.15 1998 3 29.49 29.39 1998 4 29.49 29.49 1998 5 29.8 29.49 1998 6 58.78 29.8 1998 9 58.78 58.78 1998 10 117.76 58.78 1999 1 53.52 1999 3 94.6 53.52 1999 4 40.5 94.6 1999 5 80.01 40.5 1999 6 40.5 80.01 1999 8 103.11 40.5 1999 9 53.34 103.11 1999 10 72 53.34 2000 1 46.7 2000 3 93.41 46.7 2000 4 46.54 93.41 2000 5 46.7 46.54 2000 7 70.8 46.7 2000 8 46.54 70.8 2001 1 92.26 2001 2 118.38 92.26 2001 3 47.24 118.38 2001 4 256.7 47.24 2001 5 93.44 256.7 2001 6 22.44 93.44 2001 7 69.96 22.44 2001 8 46.06 69.96 2001 9 92.67 46.06 2001 10 69.05 92.67å·²é€‰æ‹©32è¡Œã€‚å¯è§lagå‡½æ•°åœ¨åˆ†åŒºçš„ä¸Šè¾¹ç•Œè¿”å›žç©ºå€¼ï¼Œé»˜è®¤è¡Œæ•°ä¸º1ã€‚æŒ‡å®šlagå‡½æ•°çš„é»˜è®¤å€¼ï¼Œå¹¶æŒ‡å®šè¡Œæ•°ä¸º3ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445SQL&gt; select year,week,sale, lag(sale,3,sale) over( partition by product,country,region,year order by week ) prior_wk_sales from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by product,country,year,week; YEAR WEEK SALE PRIOR_WK_SALES---------- ---------- ---------- -------------- 1998 1 58.15 58.15 1998 2 29.39 29.39 1998 3 29.49 29.49 1998 4 29.49 58.15 1998 5 29.8 29.39 1998 6 58.78 29.49 1998 9 58.78 29.49 1998 10 117.76 29.8 1999 1 53.52 53.52 1999 3 94.6 94.6 1999 4 40.5 40.5 1999 5 80.01 53.52 1999 6 40.5 94.6 1999 8 103.11 40.5 1999 9 53.34 80.01 1999 10 72 40.5 2000 1 46.7 46.7 2000 3 93.41 93.41 2000 4 46.54 46.54 2000 5 46.7 46.7 2000 7 70.8 93.41 2000 8 46.54 46.54 2001 1 92.26 92.26 2001 2 118.38 118.38 2001 3 47.24 47.24 2001 4 256.7 92.26 2001 5 93.44 118.38 2001 6 22.44 47.24 2001 7 69.96 256.7 2001 8 46.06 93.44 2001 9 92.67 22.44 2001 10 69.05 69.96å·²é€‰æ‹©32è¡Œã€‚leadleadå’Œlagç±»ä¼¼ã€‚ä¸å†èµ˜è¿°ã€‚first_valueå’Œlast_valuefirst_valueå’Œlast_valueå‡½æ•°é€šå¸¸ä¸Žorder byè¯­å¥é…åˆæ¥ç­›é€‰å‡ºåˆ†åŒºä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚å®ƒä»¬éƒ½æ”¯æŒå¼€çª—å­å¥ã€‚first_valuefirst_valueè¿”å›žçª—å£ä¸­çš„ç¬¬ä¸€ä¸ªå€¼ã€‚ignore nullsè¡¨ç¤ºå¿½ç•¥ç©ºå€¼ï¼Œå¦‚æžœç¬¬ä¸€ä¸ªæ˜¯ç©ºå€¼è¿”å›žç¬¬äºŒä¸ªï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546SQL&gt; select year,week,sale, first_value(sale ignore nulls) over( partition by product,country,region,year order by sale desc rows between unbounded preceding and unbounded following ) max_sale from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by product,country,year,week; YEAR WEEK SALE MAX_SALE---------- ---------- ---------- ---------- 1998 1 58.15 117.76 1998 2 29.39 117.76 1998 3 29.49 117.76 1998 4 29.49 117.76 1998 5 29.8 117.76 1998 6 58.78 117.76 1998 9 58.78 117.76 1998 10 117.76 117.76 1999 1 53.52 103.11 1999 3 94.6 103.11 1999 4 40.5 103.11 1999 5 80.01 103.11 1999 6 40.5 103.11 1999 8 103.11 103.11 1999 9 53.34 103.11 1999 10 72 103.11 2000 1 46.7 93.41 2000 3 93.41 93.41 2000 4 46.54 93.41 2000 5 46.7 93.41 2000 7 70.8 93.41 2000 8 46.54 93.41 2001 1 92.26 256.7 2001 2 118.38 256.7 2001 3 47.24 256.7 2001 4 256.7 256.7 2001 5 93.44 256.7 2001 6 22.44 256.7 2001 7 69.96 256.7 2001 8 46.06 256.7 2001 9 92.67 256.7 2001 10 69.05 256.7å·²é€‰æ‹©32è¡Œã€‚last_valuelast_valueè¿”å›žçª—å£ä¸­çš„æœ€åŽä¸€ä¸ªå€¼ã€‚respect nullsè¡¨ç¤ºè¯†åˆ«ç©ºå€¼ï¼Œå¦‚æžœæœ€åŽä¸€ä¸ªæ˜¯ç©ºå€¼ä¹Ÿå°†å…¶è¿”å›žã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546SQL&gt; select year,week,sale, last_value(sale respect nulls) over( partition by product,country,region,year order by sale desc rows between unbounded preceding and unbounded following ) min_sale from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by product,country,year,week; YEAR WEEK SALE MIN_SALE---------- ---------- ---------- ---------- 1998 1 58.15 29.39 1998 2 29.39 29.39 1998 3 29.49 29.39 1998 4 29.49 29.39 1998 5 29.8 29.39 1998 6 58.78 29.39 1998 9 58.78 29.39 1998 10 117.76 29.39 1999 1 53.52 40.5 1999 3 94.6 40.5 1999 4 40.5 40.5 1999 5 80.01 40.5 1999 6 40.5 40.5 1999 8 103.11 40.5 1999 9 53.34 40.5 1999 10 72 40.5 2000 1 46.7 46.54 2000 3 93.41 46.54 2000 4 46.54 46.54 2000 5 46.7 46.54 2000 7 70.8 46.54 2000 8 46.54 46.54 2001 1 92.26 22.44 2001 2 118.38 22.44 2001 3 47.24 22.44 2001 4 256.7 22.44 2001 5 93.44 22.44 2001 6 22.44 22.44 2001 7 69.96 22.44 2001 8 46.06 22.44 2001 9 92.67 22.44 2001 10 69.05 22.44å·²é€‰æ‹©32è¡Œã€‚nth_valuenth_valueå‡½æ•°ç”¨äºŽè¿”å›žä»»æ„è¡Œçš„æ•°æ®ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š12nth_value(measure, n) [from first | from last] [respect nulls | ignore nulls]over(partition-clause order-by-clause windowing-clause)æ¯”å¦‚first_value(sale)ç­‰ä»·äºŽnth_value(sale,1)ï¼›first_value(sale ignore nulls)ç­‰ä»·äºŽnth_value(sale,1) from first ignore nullsã€‚æ¯”å¦‚æ±‚å¾—åˆ†åŒºå†…ç¬¬äºŒå¤§çš„saleå€¼å¤§å°ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546SQL&gt; select year,week,sale, nth_value(sale,2) ignore nulls over( partition by product,country,region,year order by sale desc rows between unbounded preceding and unbounded following ) second_max_sale from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by product,country,year,week; YEAR WEEK SALE SECOND_MAX_SALE---------- ---------- ---------- --------------- 1998 1 58.15 58.78 1998 2 29.39 58.78 1998 3 29.49 58.78 1998 4 29.49 58.78 1998 5 29.8 58.78 1998 6 58.78 58.78 1998 9 58.78 58.78 1998 10 117.76 58.78 1999 1 53.52 94.6 1999 3 94.6 94.6 1999 4 40.5 94.6 1999 5 80.01 94.6 1999 6 40.5 94.6 1999 8 103.11 94.6 1999 9 53.34 94.6 1999 10 72 94.6 2000 1 46.7 70.8 2000 3 93.41 70.8 2000 4 46.54 70.8 2000 5 46.7 70.8 2000 7 70.8 70.8 2000 8 46.54 70.8 2001 1 92.26 118.38 2001 2 118.38 118.38 2001 3 47.24 118.38 2001 4 256.7 118.38 2001 5 93.44 118.38 2001 6 22.44 118.38 2001 7 69.96 118.38 2001 8 46.06 118.38 2001 9 92.67 118.38 2001 10 69.05 118.38å·²é€‰æ‹©32è¡Œã€‚rankrankå‡½æ•°ä»¥æ•°å€¼çš„å½¢å¼è¿”å›žä¸€ä¸ªæ•°æ®è¡Œåœ¨æŽ’åºåŽçš„ç»“æžœé›†ä¸­çš„ä½ç½®ã€‚åœ¨æŽ’åå¹¶åˆ—çš„æƒ…å†µä¸‹ï¼Œå…·æœ‰ç›¸åŒå€¼çš„è¡Œå°†å…·æœ‰ç›¸åŒçš„æŽ’åï¼Œå¹¶ä¸”æŽ¥ä¸‹æ¥çš„æŽ’åä¼šè¢«è·³è¿‡ã€‚rankå‡½æ•°ä¸æ”¯æŒå¼€çª—å­å¥ï¼Œä½œç”¨äºŽæ•´ä¸ªåˆ†åŒºï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647SQL&gt; select * from ( select year,week,sale, rank() over( partition by product,country,region,year order by sale desc ) sales_rank from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by product,country,year,week ) order by year,sales_rank; YEAR WEEK SALE SALES_RANK---------- ---------- ---------- ---------- 1998 10 117.76 1 1998 6 58.78 2 1998 9 58.78 2 1998 1 58.15 4 1998 5 29.8 5 1998 4 29.49 6 1998 3 29.49 6 1998 2 29.39 8 1999 8 103.11 1 1999 3 94.6 2 1999 5 80.01 3 1999 10 72 4 1999 1 53.52 5 1999 9 53.34 6 1999 4 40.5 7 1999 6 40.5 7 2000 3 93.41 1 2000 7 70.8 2 2000 1 46.7 3 2000 5 46.7 3 2000 4 46.54 5 2000 8 46.54 5 2001 4 256.7 1 2001 2 118.38 2 2001 5 93.44 3 2001 9 92.67 4 2001 1 92.26 5 2001 7 69.96 6 2001 10 69.05 7 2001 3 47.24 8 2001 8 46.06 9 2001 6 22.44 10å·²é€‰æ‹©32è¡Œã€‚dense_rankdense_rankå‡½æ•°æ˜¯rankå‡½æ•°çš„å˜ä½“ï¼ŒåŒºåˆ«åœ¨äºŽdense_rankå‡½æ•°çš„æŽ’åå€¼æ˜¯è¿žç»­çš„ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647SQL&gt; select * from ( select year,week,sale, dense_rank() over( partition by product,country,region,year order by sale desc ) sales_dense_rank from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by product,country,year,week ) order by year,sales_dense_rank; YEAR WEEK SALE SALES_DENSE_RANK---------- ---------- ---------- ---------------- 1998 10 117.76 1 1998 6 58.78 2 1998 9 58.78 2 1998 1 58.15 3 1998 5 29.8 4 1998 4 29.49 5 1998 3 29.49 5 1998 2 29.39 6 1999 8 103.11 1 1999 3 94.6 2 1999 5 80.01 3 1999 10 72 4 1999 1 53.52 5 1999 9 53.34 6 1999 4 40.5 7 1999 6 40.5 7 2000 3 93.41 1 2000 7 70.8 2 2000 1 46.7 3 2000 5 46.7 3 2000 4 46.54 4 2000 8 46.54 4 2001 4 256.7 1 2001 2 118.38 2 2001 5 93.44 3 2001 9 92.67 4 2001 1 92.26 5 2001 7 69.96 6 2001 10 69.05 7 2001 3 47.24 8 2001 8 46.06 9 2001 6 22.44 10å·²é€‰æ‹©32è¡Œã€‚row_numberrow_numberå‡½æ•°ä¸ºç»“æžœé›†ä¸­çš„æ¯ä¸€è¡Œåˆ†é…ä¸€ä¸ªé€’å¢žè¡Œç¼–å·ï¼Œæ”¯æŒå¼€çª—å­å¥ã€‚å¦‚æžœå­˜åœ¨å€¼ç›¸åŒçš„æ•°æ®è¡Œï¼Œè°å…ˆè°åŽå…·æœ‰ä¸ç¡®å®šæ€§ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445SQL&gt; select year,week,sale, row_number() over( partition by product,country,region,year order by sale ) sales_rn from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by product,country,year,sale; YEAR WEEK SALE SALES_RN---------- ---------- ---------- ---------- 1998 2 29.39 1 1998 3 29.49 2 1998 4 29.49 3 1998 5 29.8 4 1998 1 58.15 5 1998 9 58.78 6 1998 6 58.78 7 1998 10 117.76 8 1999 4 40.5 1 1999 6 40.5 2 1999 9 53.34 3 1999 1 53.52 4 1999 10 72 5 1999 5 80.01 6 1999 3 94.6 7 1999 8 103.11 8 2000 4 46.54 1 2000 8 46.54 2 2000 5 46.7 3 2000 1 46.7 4 2000 7 70.8 5 2000 3 93.41 6 2001 6 22.44 1 2001 8 46.06 2 2001 3 47.24 3 2001 10 69.05 4 2001 7 69.96 5 2001 1 92.26 6 2001 9 92.67 7 2001 5 93.44 8 2001 2 118.38 9 2001 4 256.7 10å·²é€‰æ‹©32è¡Œã€‚ratio_to_reportratio_to_reportå‡½æ•°ç”¨äºŽè®¡ç®—å½“å‰è¡Œçš„å€¼å åˆ†åŒºæ€»å’Œçš„å€¼çš„ç™¾åˆ†æ¯”ï¼Œè¯¥å‡½æ•°æ²¡æœ‰æŽ’åºå’Œå¼€çª—å­å¥ã€‚æ¯”å¦‚è®¡ç®—å½“å‰å‘¨çš„é”€å”®é¢åœ¨è¯¥å¹´ä»¥åŠæ‰€æœ‰é”€å”®é¢ä¸­çš„ç™¾åˆ†æ¯”ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243SQL&gt; select year,week,sale, trunc(100*ratio_to_report(sale) over(partition by product,country,region,year),2) || '%' p1, trunc(100*ratio_to_report(sale) over(partition by product,country,region),2) || '%' p2 from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week &lt;= 10 order by product,country,year,week; YEAR WEEK SALE P1 P2 ---------- ---------- ---------- --------------- ----------------- 1998 1 58.15 14.12% 2.63% 1998 2 29.39 7.13% 1.33% 1998 3 29.49 7.16% 1.33% 1998 4 29.49 7.16% 1.33% 1998 5 29.8 7.23% 1.34% 1998 6 58.78 14.27% 2.66% 1998 9 58.78 14.27% 2.66% 1998 10 117.76 28.6% 5.33% 1999 1 53.52 9.95% 2.42% 1999 3 94.6 17.59% 4.28% 1999 4 40.5 7.53% 1.83% 1999 5 80.01 14.88% 3.62% 1999 6 40.5 7.53% 1.83% 1999 8 103.11 19.18% 4.66% 1999 9 53.34 9.92% 2.41% 1999 10 72 13.39% 3.26% 2000 1 46.7 13.31% 2.11% 2000 3 93.41 26.63% 4.23% 2000 4 46.54 13.27% 2.1% 2000 5 46.7 13.31% 2.11% 2000 7 70.8 20.18% 3.2% 2000 8 46.54 13.27% 2.1% 2001 1 92.26 10.15% 4.17% 2001 2 118.38 13.03% 5.36% 2001 3 47.24 5.2% 2.13% 2001 4 256.7 28.26% 11.62% 2001 5 93.44 10.28% 4.23% 2001 6 22.44 2.47% 1.01% 2001 7 69.96 7.7% 3.16% 2001 8 46.06 5.07% 2.08% 2001 9 92.67 10.2% 4.19% 2001 10 69.05 7.6% 3.12%å·²é€‰æ‹©32è¡Œã€‚ntilentileå‡½æ•°å¯¹ä¸€ä¸ªåˆ†åŒºä¸­çš„æœ‰åºç»“æžœé›†è¿›è¡Œåˆ’åˆ†ï¼Œåˆ†ä¸ºè‹¥å¹²ä¸ªç»„ï¼Œå¦‚æžœä¸èƒ½å¤Ÿç­‰åˆ†ï¼Œåˆ™æ¯ä¸ªç»„ä¸­ç›¸å·®çš„æ•°æ®è¡Œä¸èƒ½è¶…è¿‡ä¸€è¡Œï¼Œå¹¶ä¸ºæ¯ä¸ªå°ç»„åˆ†é…å”¯ä¸€çš„ç»„ç¼–å·ã€‚è¯¥å‡½æ•°ä¸æ”¯æŒå¼€çª—å­å¥ã€‚æ¯”å¦‚å°†2001å¹´çš„é”€å”®é¢æ•°æ®è¡Œåˆ†ä¸ºåä¸ªå°ç»„ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657SQL&gt; select year,week,sale, ntile(10) over( partition by product,country,region,year order by sale ) group# from sales_fact where country in ('Australia') and product = 'Xtend Memory' and year=2001; YEAR WEEK SALE GROUP#---------- ---------- ---------- ---------- 2001 18 22.37 1 2001 23 22.38 1 2001 6 22.44 1 2001 52 23.14 1 2001 50 23.14 1 2001 44 23.29 2 2001 40 45.18 2 2001 49 45.26 2 2001 8 46.06 2 2001 3 47.24 2 2001 41 67.19 3 2001 34 68.9 3 2001 32 68.9 3 2001 10 69.05 3 2001 7 69.96 3 2001 11 71.57 4 2001 36 91.12 4 2001 15 91.98 4 2001 31 92.21 4 2001 1 92.26 4 2001 9 92.67 5 2001 37 93.16 5 2001 5 93.44 5 2001 46 93.58 5 2001 27 94.48 5 2001 51 114.82 6 2001 33 115.52 6 2001 39 115.57 6 2001 13 116.81 6 2001 12 116.81 7 2001 29 116.85 7 2001 20 118.03 7 2001 2 118.38 7 2001 24 136.92 8 2001 42 136.98 8 2001 38 139 8 2001 25 139.28 8 2001 43 139.58 9 2001 22 141.78 9 2001 14 162.91 9 2001 30 162.91 9 2001 48 182.96 10 2001 21 233.7 10 2001 4 256.7 10 2001 16 278.44 10å·²é€‰æ‹©45è¡Œã€‚stddevstddevå‡½æ•°ç”¨äºŽè®¡ç®—æŸäº›æ•°æ®è¡Œåœ¨åˆ†åŒºä¸­çš„æ ‡å‡†å·®ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243SQL&gt; select year,week,sale, stddev(sale) over( partition by product,country,region,year order by sale rows between unbounded preceding and unbounded following ) stddev from sales_fact where country in ('Australia') and product = 'Xtend Memory' and week&lt;10 order by product,country,year,week; YEAR WEEK SALE STDDEV---------- ---------- ---------- ---------- 1998 1 58.15 15.517783 1998 2 29.39 15.517783 1998 3 29.49 15.517783 1998 4 29.49 15.517783 1998 5 29.8 15.517783 1998 6 58.78 15.517783 1998 9 58.78 15.517783 1999 1 53.52 25.8395281 1999 3 94.6 25.8395281 1999 4 40.5 25.8395281 1999 5 80.01 25.8395281 1999 6 40.5 25.8395281 1999 8 103.11 25.8395281 1999 9 53.34 25.8395281 2000 1 46.7 19.670004 2000 3 93.41 19.670004 2000 4 46.54 19.670004 2000 5 46.7 19.670004 2000 7 70.8 19.670004 2000 8 46.54 19.670004 2001 1 92.26 68.235866 2001 2 118.38 68.235866 2001 3 47.24 68.235866 2001 4 256.7 68.235866 2001 5 93.44 68.235866 2001 6 22.44 68.235866 2001 7 69.96 68.235866 2001 8 46.06 68.235866 2001 9 92.67 68.235866å·²é€‰æ‹©29è¡Œã€‚listagglistaggå‡½æ•°å°†åˆ†åŒºä¸­å¤šä¸ªæ•°æ®è¡Œä¸­çš„æŸåˆ—çš„å€¼ä»¥æŸä¸ªç¬¦å·æ‹¼æŽ¥æˆä¸€è¡Œï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1listagg(string,separator) within group(order-by-clause) over(partition-by-clause)within group(order-by-clause)å­å¥å£°æ˜ŽæŽ’åºé¡ºåºã€‚æ¯”å¦‚å°†sales_factæ•°æ®è¡¨ä¸­çš„countryè½¬åŒ–ä¸ºä»¥é€—å·åˆ†éš”çš„ä¸€è¡Œå€¼ï¼š12345678910111213SQL&gt; col country_string for a50SQL&gt; select listagg(country,',') within group(order by country desc) country_string from( select distinct country from sales_fact );COUNTRY_STRING--------------------------------------------------United States of America,United Kingdom,Turkey,Spain,Singapore,Saudi Arabia,Poland,New Zealand,Japan,Italy,Germany,France,Denmark,China,Canada,Brazil,Australia,Argentina]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracleå¯¹è±¡ç±»åž‹]]></title>
    <url>%2FOracle-Object-Type.html</url>
    <content type="text"><![CDATA[åœ¨Oracleæ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„å¯¹è±¡ç±»åž‹ï¼ˆObject Typeï¼‰ã€‚æ•°æ®åº“çš„å¯¹è±¡ç±»åž‹å’ŒJavaä¸­çš„ç±»ç›¸ä¼¼ï¼Œå¯ä»¥åŒ…å«å±žæ€§å’Œæ–¹æ³•ï¼ˆå‡½æ•°å’Œå­˜å‚¨è¿‡ç¨‹ï¼‰ã€‚å¯¹è±¡ç±»åž‹åŒ…æ‹¬å¯¹è±¡ç±»åž‹è§„èŒƒï¼ˆObject Type Specificationï¼‰å’Œå¯¹è±¡ç±»åž‹ä¸»ä½“ï¼ˆObject Type Bodyï¼‰ã€‚å¯¹è±¡ç±»åž‹è§„èŒƒç”¨äºŽå®šä¹‰å¯¹è±¡çš„å±žæ€§å’Œä¸åŒ…å«å®žçŽ°çš„æ–¹æ³•ã€‚å¯¹è±¡ç±»åž‹ä¸»ä½“ç”¨äºŽå®žçŽ°å¯¹è±¡ç±»åž‹è§„èŒƒä¸­å®šä¹‰çš„æ–¹æ³•ã€‚å¦‚æžœå¯¹è±¡ç±»åž‹è§„èŒƒä¸­æ²¡æœ‰å®šä¹‰æ–¹æ³•ï¼Œåˆ™å¯ä»¥ä¸ç”¨å®šä¹‰å¯¹è±¡ç±»åž‹ä¸»ä½“ã€‚åˆ›å»ºç®€å•çš„å¯¹è±¡ç±»åž‹ç®€å•çš„å¯¹è±¡ç±»åž‹å°±æ˜¯ä¸åŒ…å«æ–¹æ³•çš„å¯¹è±¡ç±»åž‹ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1234create [or replace] type type_name as object ( column_name data_type [,column_name data_type, ... ]);æ¯”å¦‚åˆ›å»ºä¸€ä¸ªåœ°å€å¯¹è±¡ç±»åž‹ï¼š1234567SQL&gt; create or replace type address as object ( province varchar2(10), city varchar2(10) ) not final; /ç±»åž‹å·²åˆ›å»ºã€‚not finalå…³é”®å­—è¯´æ˜Žè¯¥å¯¹è±¡ç±»åž‹å¯ä»¥è¢«ç»§æ‰¿ï¼ŒæŽ¥ä¸‹æ¥å®šä¹‰ä¸€ä¸ªå­ç±»åž‹addressDetail ç»§æ‰¿è‡ªaddress ç±»åž‹ï¼š1234567891011121314SQL&gt; create or replace type addressdetail under address ( street varchar2(20) ); /ç±»åž‹å·²åˆ›å»ºã€‚SQL&gt; desc addressdetail; addressdetail æ‰©å±• SCOTT.ADDRESS åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- PROVINCE VARCHAR2(10) CITY VARCHAR2(10) STREET VARCHAR2(20)å¯è§addressdetail ç»§æ‰¿äº†address çš„province å’Œcity å±žæ€§ã€‚åˆ›å»ºå¸¦æœ‰æ–¹æ³•çš„å¯¹è±¡ç±»åž‹å¯ä»¥åœ¨å®šä¹‰å¯¹è±¡ç±»åž‹è§„èŒƒçš„æ—¶å€™åŒ…å«å‡½æ•°æˆ–è€…å­˜å‚¨è¿‡ç¨‹ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1234567create [or replace] type type_name as object ( column_name data_type, ..., [ map|order ]member function method_name(args_list) return return_type, [ map|order ]member procedure pro_name(aggs_list), ...)å…¶ä¸­map æˆ–order å…³é”®å­—è¡¨ç¤ºå¯¹ç»“æžœè¿›è¡ŒæŽ’åºã€‚æ¯”å¦‚åˆ›å»ºä¸€ä¸ªå­¦ç”Ÿä¿¡æ¯å¯¹è±¡ç±»åž‹studentï¼š123456789SQL&gt; create or replace type student as object ( name varchar2(20), sex char(2), birthday date, member function get_age return number ); /ç±»åž‹å·²åˆ›å»ºã€‚å‡½æ•°get_age()ç”¨äºŽè¿”å›žå­¦ç”Ÿå¹´é¾„ã€‚æŽ¥ä¸‹æ¥åˆ›å»ºstudent å¯¹è±¡ä¸»ä½“ï¼š1234567891011SQL&gt; create or replace type body student as member function get_age return number as var_age number; begin select floor(months_between(sysdate,birthday)/12) into var_age from dual; return var_age; end; end; /ç±»åž‹ä¸»ä½“å·²åˆ›å»ºã€‚å¯¹è±¡ç±»åž‹çš„åº”ç”¨åˆ›å»ºå¯¹è±¡ç±»åž‹åŽï¼Œå¯ä»¥åœ¨æ•°æ®åº“ä¸­ä½¿ç”¨å¯¹è±¡ç±»åž‹ã€‚ä¸€èˆ¬æ¥è¯´æ ¹æ®ä½¿ç”¨æƒ…å†µçš„ä¸åŒï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç§ç±»åž‹ï¼šåˆ—å¯¹è±¡ã€å¯¹è±¡è¡¨ã€å¯å˜æ•°ç»„ä¸ŽåµŒå¥—è¡¨ã€‚åˆ—å¯¹è±¡åˆ—å¯¹è±¡æŒ‡çš„æ˜¯æ•°æ®è¡¨ä¸­çš„å•ä¸ªåˆ—çš„ç±»åž‹ä¸ºå¯¹è±¡ç±»åž‹ã€‚åˆ›å»ºå‘˜å·¥ä¿¡æ¯è¡¨ï¼Œå…¶ä¸­addresså±žæ€§ç±»åž‹ä¸ºä¸Šè¿°å®šä¹‰çš„addressdetailç±»åž‹ï¼š12345678SQL&gt; create table empinfo ( eName varchar2(20), eSex char(2), eAge int, eAddress addressdetail );è¡¨å·²åˆ›å»ºã€‚æŸ¥çœ‹empinfoè¡¨çš„ç»“æž„ï¼š123456789101112SQL&gt; set desc depth 2SQL&gt; desc empinfo åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- ENAME VARCHAR2(20) ESEX CHAR(2) EAGE NUMBER(38) EADDRESS ADDRESSDETAIL ADDRESSDETAIL æ‰©å±• SCOTT.ADDRESS PROVINCE VARCHAR2(10) CITY VARCHAR2(10) STREET VARCHAR2(20)åœ¨å¾€åŒ…å«åˆ—å¯¹è±¡çš„æ•°æ®è¡¨æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œåªèƒ½ä½¿ç”¨å¯¹è±¡ç±»åž‹çš„æž„é€ æ–¹æ³•ï¼š123SQL&gt; insert into empinfo values('KangKang','M',25,addressdetail('ç¦å»º','ç¦å·ž','é¼“æ¥¼åŒº'));å·²åˆ›å»º 1 è¡Œã€‚æŸ¥è¯¢studentè¡¨ä¿¡æ¯çš„æ—¶å€™ï¼Œå¦‚æžœä»¥å¯¹è±¡ç±»åž‹ä¸­çš„æŸä¸ªå±žæ€§ä¸ºæŸ¥è¯¢æ¡ä»¶æ—¶ï¼Œå¿…é¡»ä½¿ç”¨è¡¨çš„åˆ«åçš„å½¢å¼ï¼Œæ¯”å¦‚ï¼š1234567891011SQL&gt; select * from empinfo where eAddress.city='ç¦å·ž';select * from empinfo where eAddress.city='ç¦å·ž' *ç¬¬ 1 è¡Œå‡ºçŽ°é”™è¯¯:ORA-00904: "EADDRESS"."CITY": æ ‡è¯†ç¬¦æ— æ•ˆSQL&gt; select * from empinfo e where e.eAddress.city='ç¦å·ž';ENAME ES EAGE EADDRESS(PROVINCE, CITY, STREET)-------------------- -- ---------- ----------------------------------------KangKang M 25 ADDRESSDETAIL('ç¦å»º', 'ç¦å·ž', 'é¼“æ¥¼åŒº')æ›´æ–°åŒ…å«ä¸¤ç§æ–¹å¼ï¼šæ•´ä½“æ›´æ–°å’Œåªæ›´åˆ—å¯¹è±¡çš„æŸä¸€åˆ—ã€‚1.æ›´æ–°æ•´ä½“ï¼š123 SQL&gt; update empinfo e set e.eAddress = addressdetail('ç¦å»º','ç¦å·ž','å°æ±ŸåŒº');å·²æ›´æ–° 1 è¡Œã€‚2.æ›´æ–°åˆ—å¯¹è±¡çš„æŸä¸€åˆ—ï¼š123SQL&gt; update empinfo e set e.eAddress.city='åŽ¦é—¨' where e.eName='KangKang';å·²æ›´æ–° 1 è¡Œã€‚å¯¹è±¡è¡¨å¦‚æžœéœ€è¦ä½¿ç”¨å¯¹è±¡ç±»åž‹æ¥å®šä¹‰æ•´ä¸ªè¡¨ï¼Œé‚£ä¹ˆå¯ä»¥å°†è¿™ä¸ªè¡¨åˆ›å»ºä¸ºå¯¹è±¡è¡¨ï¼Œå¯¹è±¡è¡¨ä¸­çš„æ¯ä¸€ç»„æ•°æ®éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1create table table_name of type_name;åˆ›å»ºä¸€ä¸ªä¸Šè¿°å®šä¹‰çš„student å¯¹è±¡è¡¨ï¼š12345678910SQL&gt; create table studentinfo of student;è¡¨å·²åˆ›å»ºã€‚SQL&gt; desc studentinfo åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- NAME VARCHAR2(20) SEX CHAR(2) BIRTHDAY DATEå‘å¯¹è±¡è¡¨æ’å…¥æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼šå½“æ™®é€šè¡¨æ’å…¥å’Œä½¿ç”¨æž„é€ æ–¹æ³•æ’å…¥ï¼š1.å½“æ™®é€šè¡¨æ’å…¥ï¼š123SQL&gt; insert into studentinfo values('KangKang','M',to_date('19920314','yyyyMMdd'));å·²åˆ›å»º 1 è¡Œã€‚2.ä½¿ç”¨æž„é€ æ–¹æ³•æ’å…¥ï¼š123SQL&gt; insert into studentinfo values(student('Jane','F',to_date('19930905','yyyyMMdd')));å·²åˆ›å»º 1 è¡Œã€‚æŸ¥è¯¢æ•°æ®å’ŒæŸ¥è¯¢æ™®é€šè¡¨æ²¡æœ‰åŒºåˆ«ã€‚å› ä¸ºstudentå¯¹è±¡åŒ…å«äº†get_age()å‡½æ•°ï¼Œè¿™é‡Œæ¼”ç¤ºè¯¥å‡½æ•°çš„ä½¿ç”¨ï¼š123456SQL&gt; select s.name,s.birthday,s.get_age() age from studentinfo s;NAME BIRTHDAY AGE-------------------- -------------- ----------KangKang 14-3æœˆ -92 25Jane 05-9æœˆ -93 24å¯¹è±¡æ ‡è¯†ç¬¦å’Œå¯¹è±¡å¼•ç”¨å¯¹è±¡è¡¨ä¸­çš„æ¯ä¸ªå¯¹è±¡éƒ½å…·æœ‰ä¸€ä¸ªå”¯ä¸€çš„å¯¹è±¡æ ‡è¯†ç¬¦ï¼ˆObject Identifierï¼ŒOIDï¼‰ï¼Œå¯ä»¥å­˜å‚¨åœ¨åä¸ºref çš„åˆ—ä¸­ï¼š1234567891011SQL&gt; col ref for a60SQL&gt; set linesize 120SQL&gt; select s.name,ref(s) ref from studentinfo s;NAME REF-------------------- ------------------------------------------------------------KangKang 00002802093C3B2A8DC8BD4ED991B4D78B90B44F1A293F80C3178D48158B B3E126560AE7120100023F0000Jane 0000280209E237A8A6E6A844AE87A66B0F284E7231293F80C3178D48158B B3E126560AE7120100023F0001é‚£ä¸ªä¸€å¤§ä¸²çš„å­—ç¬¦ä¾¿æ˜¯OIDã€‚å¯¹è±¡çš„å¼•ç”¨ä½¿ç”¨ref å…³é”®å­—æ¥å®Œæˆï¼Œå¼•ç”¨çš„å€¼å®žé™…ä¸Šä¸ºå¯¹è±¡è¡¨ä¸­çš„OIDã€‚æ¯”å¦‚åˆ›å»ºä¸€ä¸ªæˆç»©è¡¨ï¼Œå…¶ä¸­stu å±žæ€§ä¸ºstudentinfo å¯¹è±¡è¡¨ä¸­å¯¹è±¡çš„å¼•ç”¨ï¼š123456SQL&gt; create table stuScore ( stu ref student, score number );è¡¨å·²åˆ›å»ºã€‚å¾€è¯¥è¡¨æ’å…¥ä¿¡æ¯ï¼š123456SQL&gt; insert into stuScore select ref(s),98 from studentinfo s where s.name='KangKang';å·²åˆ›å»º 1 è¡Œã€‚SQL&gt; insert into stuScore select ref(s),100 from studentinfo s where s.name='Jane';å·²åˆ›å»º 1 è¡Œã€‚ref(s)å¯ä»¥èŽ·å–å¯¹å½“å‰å¯¹è±¡è¡¨ä¸­å¯¹è±¡çš„OIDã€‚æŸ¥è¯¢ï¼š12345678910SQL&gt; col stu for a60SQL&gt; select stu,score from stuScore;STU SCORE------------------------------------------------------------ ----------00002202083C3B2A8DC8BD4ED991B4D78B90B44F1A293F80C3178D48158B 98B3E126560AE7120000220208E237A8A6E6A844AE87A66B0F284E7231293F80C3178D48158B 100B3E126560AE712è¿™é‡Œè™½ç„¶å…³è”äº†å­¦ç”Ÿä¿¡æ¯è¡¨studentinfoï¼Œä½†æ˜¯é»˜è®¤æŸ¥è¯¢å‡ºæ¥stu çš„å€¼ä¸ºOIDï¼Œå¦‚æžœéœ€è¦æŸ¥çœ‹è¯¦ç»†çš„å­¦ç”Ÿä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨deref()å‡½æ•°ï¼š123456SQL&gt; select deref(stu) stu,score from stuScore;STU(NAME, SEX, BIRTHDAY) SCORE------------------------------------------------------------ ----------STUDENT('KangKang', 'M ', '14-3æœˆ -92') 98STUDENT('Jane', 'F ', '05-9æœˆ -93') 100ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ä¹Ÿå¯ä»¥æŸ¥è¯¢å‡ºå…³è”ä¿¡æ¯ï¼š123456SQL&gt; select s.stu.name,s.stu.birthday,s.stu.get_age(),s.score from stuScore s;STU.NAME STU.BIRTHDAY S.STU.GET_AGE() SCORE-------------------- -------------- --------------- ----------KangKang 14-3æœˆ -92 25 98Jane 05-9æœˆ -93 24 100å¯å˜æ•°ç»„Oralceä¸­çš„å¯å˜æ•°ç»„å°±æ˜¯ä¸€ä¸ªå¯ä»¥å­˜å‚¨å¤šä¸ªå€¼çš„æœ‰æœ€å¤§é•¿åº¦çš„æ•°ç»„ï¼Œæ•°ç»„çš„æˆå‘˜å¯ä»¥æ˜¯ä»»æ„ç±»åž‹ã€‚åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º10çš„å¯å˜æ•°ç»„ï¼Œå­˜æ”¾æ•°æ®ç±»åž‹æ˜¯scoreType1234567891011SQL&gt; create or replace type scoreType as object ( subName varchar2(10), score int ); /ç±»åž‹å·²åˆ›å»ºã€‚SQL&gt; create or replace type arrScoreType as varray(10) of scoreType; /ç±»åž‹å·²åˆ›å»ºã€‚åˆ›å»ºä¸€ä¸ªå­¦ç”Ÿä¿¡æ¯è¡¨ï¼š123456SQL&gt; create table stuInfo ( stuId int primary key, score arrScoreType );è¡¨å·²åˆ›å»ºã€‚ä½¿ç”¨å¯å˜æ•°ç»„çš„æž„é€ å‡½æ•°å¾€stuInfo è¡¨æ’å…¥æ•°æ®ï¼š123456789SQL&gt; insert into stuInfo values(1, arrScoreType(scoreType('sql', 50), scoreType('C#', 80), scoreType('java', 90)));å·²åˆ›å»º 1 è¡Œã€‚SQL&gt; insert into stuInfo values(2, arrScoreType(scoreType('sql', 60), scoreType('C#', 85), scoreType('java', 95), scoreType('html', 60)));å·²åˆ›å»º 1 è¡Œã€‚ç›´æŽ¥æŸ¥è¯¢stuInfo è¡¨æ•°æ®ï¼š1234567SQL&gt; col score for a100SQL&gt; select stuid, score from stuInfo; STUID SCORE(SUBNAME, SCORE)---------- ---------------------------------------------------------------------------------------------------- 1 ARRSCORETYPE(SCORETYPE('sql', 50), SCORETYPE('C#', 80), SCORETYPE('java', 90)) 2 ARRSCORETYPE(SCORETYPE('sql', 60), SCORETYPE('C#', 85), SCORETYPE('java', 95), SCORETYPE('html', 60))æŸ¥è¯¢ç»“æžœæ˜¯é›†åˆã€‚å¦‚ä½•æ‰èƒ½æŸ¥è¯¢å‡ºå¯å˜æ•°ç»„é‡Œçš„æ•°æ®å‘¢ï¼Ÿæ€è·¯æ˜¯ï¼šç”¨tableå‡½æ•°æŠŠé›†åˆè½¬åŒ–ä¸ºè¡¨ï¼Œç„¶åŽå†ä»Žè¿™ä¸ªè¡¨æŸ¥è¯¢æ•°æ®ï¼š12345678910111213SQL&gt; select s.stuid,t.* from stuinfo s,table(select score from stuinfo where stuid = s.stuid) t; STUID SUBNAME SCORE---------- ---------- ---------- 1 sql 50 1 C# 80 1 java 90 2 sql 60 2 C# 85 2 java 95 2 html 60å·²é€‰æ‹©7è¡Œã€‚tableå‡½æ•°é‡Œé¢åªèƒ½æ˜¯ä¸€ä¸ªå¯å˜æ•°ç»„æˆ–åµŒå¥—è¡¨ã€‚æ›´æ–°å€¼ã€‚æ›´æ–°stuinfoåªèƒ½æ•´ä¸ªå¯å˜æ•°ç»„ä¸€èµ·æ›´æ–°ï¼Œä¸èƒ½åªæ›´æ–°æ•°ç»„çš„æŸä¸ªå…ƒç´ ï¼š123update stuInfo set score = arrScoreType(scoreType('sql', 50), scoreType('C#', 80)) where stuId = 1;å·²æ›´æ–° 1 è¡Œã€‚åµŒå¥—è¡¨åˆ›å»ºä¸€ä¸ªåµŒå¥—è¡¨ç±»åž‹ï¼Œç±»åž‹ä¸ºscoreTypeï¼š1234SQL&gt; create or replace type nestTableType is table of scoreType; /ç±»åž‹å·²åˆ›å»ºã€‚æŽ¥ç€åˆ›å»ºåŒ…å«åµŒå¥—è¡¨çš„å­¦ç”Ÿä¿¡æ¯è¡¨ï¼š123456SQL&gt; create table stuInfo ( stuid int, score nestTableType ) nested table score store as nestTable;è¡¨å·²åˆ›å»ºã€‚nested table score store as nestTableæ„æ€æ˜¯ï¼šstuInfoè¿™ä¸ªè¡¨ä¸­çš„scoreè¿™ä¸€åˆ—æ˜¯åµŒå¥—è¡¨ç±»åž‹ï¼ŒåµŒå¥—è¡¨å®žé™…æ˜¯å­˜åœ¨nestTableè¿™ä¸ªè¡¨ä¸­ã€‚æ’å…¥å€¼çš„æ–¹å¼å’Œå¯å˜æ•°ç»„ä¸€æ ·ï¼š123SQL&gt; insert into stuInfo values(3, nestTableType(scoreType('sql', 70), scoreType('java', 93)));å·²åˆ›å»º 1 è¡Œã€‚æŸ¥è¯¢æ–¹å¼ä¹Ÿå’Œå¯å˜æ•°ç»„ä¸€æ ·ï¼š123456SQL&gt; select s.stuid,t.* from stuinfo s,table(select score from stuinfo where stuid = s.stuid) t; STUID SUBNAME SCORE---------- ---------- ---------- 3 sql 70 3 java 93åµŒå¥—è¡¨æ›´æ–°å’Œå¯å˜æ•°ç»„ä¸ä¸€æ ·ï¼ŒåµŒå¥—è¡¨æ›´æ–°å¯ä»¥åªæ›´æ–°éƒ¨åˆ†æ•°æ®ï¼š123SQL&gt; update table(select score from stuinfo where stuid = 3) t set t.score = 80 where t.subname = 'sql';å·²æ›´æ–° 1 è¡Œã€‚å¯å˜æ•°ç»„å’ŒåµŒå¥—è¡¨çš„å¼‚åŒï¼šç›¸åŒç‚¹ï¼šéƒ½æ˜¯å¯¹è±¡ç±»åž‹ï¼›éƒ½å¯ä»¥ä½œä¸ºè¡¨ä¸­æŸåˆ—çš„æ•°æ®ç±»åž‹ï¼ˆrecordå’Œå¿«è¡¨æ˜¯ä¸èƒ½ä½œä¸ºåˆ—çš„æ•°æ®ç±»åž‹çš„ï¼‰ã€‚ä¸åŒç‚¹ï¼šå¯å˜æ•°ç»„æœ¬èº«å°±å­˜æ”¾åœ¨åŽŸè¡¨ä¸­ï¼Œè€ŒåµŒå¥—è¡¨å­˜æ”¾åœ¨å¦å¤–çš„è¡¨ä¸­ï¼›å¯å˜æ•°ç»„æœ‰å¤§å°é™åˆ¶ï¼Œè€ŒåµŒå¥—è¡¨æ²¡æœ‰ï¼›å¯å˜æ•°ç»„æ›´æ–°æ—¶å¿…é¡»æ›´æ–°æ•´ä¸ªå¯å˜æ•°ç»„ï¼Œè€ŒåµŒå¥—è¡¨æ›´æ–°æ—¶å¯ä»¥åªæ›´æ–°åµŒå¥—è¡¨ä¸­çš„éƒ¨åˆ†è®°å½•ã€‚å‚è€ƒè‡ªhttps://my.oschina.net/u/2273582/blog/493931]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracleç¨‹åºåŒ…]]></title>
    <url>%2FOracle%E7%A8%8B%E5%BA%8F%E5%8C%85.html</url>
    <content type="text"><![CDATA[ç¨‹åºåŒ…ç”±PL/SQL ç¨‹åºå…ƒç´ ï¼ˆå¦‚å˜é‡ã€ç±»åž‹ï¼‰å’ŒåŒ¿åPL/SQL å—ï¼ˆå¦‚æ¸¸æ ‡ï¼‰ã€å‘½åPL/SQL å—ï¼ˆå¦‚å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°ï¼‰ç»„æˆã€‚ä¸€ä¸ªå®Œæ•´çš„ç¨‹åºåŒ…åŒ…å«ç¨‹åºåŒ…è§„èŒƒå’Œç¨‹åºåŒ…ä¸»ä½“ï¼Œç¨‹åºåŒ…è§„èŒƒç”¨äºŽè§„å®šåœ¨ç¨‹åºåŒ…ä¸­å¯ä»¥ä½¿ç”¨å“ªäº›å˜é‡ã€ç±»åž‹ã€æ¸¸æ ‡å’Œå­ç¨‹åºï¼ˆåªåŒ…å«åç§°æ²¡æœ‰å…·ä½“å®žçŽ°ï¼‰ï¼›ç¨‹åºåŒ…çš„ä¸»ä½“åŒ…å«äº†åœ¨è§„èŒƒä¸­å£°æ˜Žçš„æ¸¸æ ‡ã€è¿‡ç¨‹å’Œå‡½æ•°çš„å®žçŽ°ä»£ç ã€‚è¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼äºŽåœ¨Javaä¸­å®šä¹‰ä¸€ä¸ªåŒ…å«æŠ½è±¡æ–¹æ³•çš„æŽ¥å£ï¼Œç„¶åŽåˆ›å»ºä¸€ä¸ªè¯¥æŽ¥å£çš„å®žçŽ°ç±»ã€‚ç¨‹åºåŒ…çš„è§„èŒƒç¨‹åºåŒ…çš„è¯­æ³•å¦‚ä¸‹ï¼š1234567create [or replace ] package pack_name is [declare_variable]; [declare_type]; [declare_cursor]; [declare_function]; [declare_ procedure];end [pack_name];æ¯”å¦‚åˆ›å»ºä¸€ä¸ªç¨‹åºåŒ…è§„èŒƒï¼Œå¹¶å£°æ˜Žä¸€ä¸ªèŽ·å–æŒ‡å®šéƒ¨é—¨å¹³å‡å·¥èµ„å‡½æ•°å’Œä¸€ä¸ªæé«˜æŒ‡å®šéƒ¨é—¨æŒ‡å®šç™¾åˆ†æ¯”å·¥èµ„çš„å­˜å‚¨è¿‡ç¨‹ï¼š1234567SQL&gt; create or replace package pack_test is function avg_sal(var_deptno number) return number; procedure rise_sal(var_job varchar2,percent number); end; /ç¨‹åºåŒ…å·²åˆ›å»ºã€‚åœ¨â€œè§„èŒƒâ€ä¸­å£°æ˜Žçš„å‡½æ•°å’Œå­˜å‚¨è¿‡ç¨‹åªæœ‰å¤´éƒ¨çš„å£°æ˜Žï¼Œè€Œæ²¡æœ‰å‡½æ•°ä½“å’Œå­˜å‚¨è¿‡ç¨‹ä¸»ä½“ã€‚ç¨‹åºåŒ…ä¸»ä½“ç¨‹åºåŒ…çš„è¯­æ³•å¦‚ä¸‹ï¼š1234567891011121314151617create [or replace] package body pack_name is [inner_variable] [cursor_body] [function_title] &#123;begin fun_plsql; [exception] [dowith _ sentences;] end [fun_name]&#125; [procedure_title] &#123;begin pro_plsql; [exception] [dowith _ sentences;] end [pro_name]&#125; â€¦end [pack_name];åˆ›å»ºpack_testçš„ä¸»ä½“ï¼š1234567891011121314151617181920SQL&gt; create or replace package body pack_test is function avg_sal(var_deptno number) return number is //å‡½æ•°å®žçŽ° num_avg_sal number; begin select avg(sal) into num_avg_sal from emp where deptno = var_deptno; return num_avg_sal; exception when no_data_found then dbms_output.put_line('æ²¡æœ‰è¯¥éƒ¨é—¨'); return 0; end; procedure rise_sal(var_job varchar2,percent number) is //å­˜å‚¨è¿‡ç¨‹å®žçŽ° begin update emp set sal=sal*(1+percent) where job = var_job; end; end; /ç¨‹åºåŒ…ä½“å·²åˆ›å»ºã€‚åœ¨PL/SQLä»£ç å—ä¸­è°ƒç”¨ç¨‹åºåŒ…çš„avg_salå‡½æ•°å’Œrise_salå­˜å‚¨è¿‡ç¨‹ï¼š123456789101112SQL&gt; set serveroutput onSQL&gt; declare num_avg_sal number; begin num_avg_sal:=pack_test.avg_sal(10); dbms_output.put_line('10å·éƒ¨é—¨çš„å¹³å‡å·¥èµ„ä¸ºï¼š'||num_avg_sal); pack_test.rise_sal('SALESMAN',0.2); end; /10å·éƒ¨é—¨çš„å¹³å‡å·¥èµ„ä¸ºï¼š2916.666666666666666666666666666666666667PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracleè§¦å‘å™¨]]></title>
    <url>%2FOracle%E8%A7%A6%E5%8F%91%E5%99%A8.html</url>
    <content type="text"><![CDATA[è§¦å‘å™¨å¯ä»¥çœ‹åšä¸€ç§â€œç‰¹æ®Šâ€çš„å­˜å‚¨è¿‡ç¨‹ï¼Œç”±â€œè§¦å‘äº‹ä»¶â€è§¦å‘ã€‚æ‰€è°“çš„â€œè§¦å‘äº‹ä»¶â€æŒ‡èƒ½å¤Ÿå¼•èµ·è§¦å‘å™¨è¿è¡Œçš„æ“ä½œï¼ŒåŒ…æ‹¬ï¼š1.æ‰§è¡ŒDML è¯­å¥ï¼ˆä½¿ç”¨INSERTã€UPDATEã€DELETE è¯­å¥å¯¹è¡¨æˆ–è§†å›¾æ‰§è¡Œæ•°æ®å¤„ç†æ“ä½œï¼‰ï¼›2.æ‰§è¡ŒDDLè¯­å¥ï¼ˆä½¿ç”¨CREATEã€ALTERã€DROPè¯­å¥åœ¨æ•°æ®åº“ä¸­åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤æ¨¡å¼å¯¹è±¡ï¼‰ï¼›3.å¼•å‘æ•°æ®åº“ç³»ç»Ÿäº‹ä»¶ï¼ˆå¦‚ç³»ç»Ÿå¯åŠ¨æˆ–é€€å‡ºã€äº§ç”Ÿå¼‚å¸¸é”™è¯¯ç­‰ï¼‰ï¼›4.å¼•å‘ç”¨æˆ·äº‹ä»¶ï¼ˆå¦‚ç™»å½•æˆ–é€€å‡ºæ•°æ®åº“æ“ä½œï¼‰ã€‚ è§¦å‘å™¨çš„è¯­æ³•å¦‚ä¸‹ï¼š1234567create [or replace] trigger tri_name [before | after | instead of] tri_event on table_name | view_name | user_name | db_name [for each row] [when tri_condition]begin plsql_sentences;end tri_name;before | after | instead ofï¼šè¡¨ç¤ºâ€œè§¦å‘æ—¶æœºâ€çš„å…³é”®å­—ã€‚before è¡¨ç¤ºåœ¨æ‰§è¡ŒDML ç­‰æ“ä½œä¹‹å‰è§¦å‘ï¼›after è¡¨ç¤ºåœ¨DMLç­‰æ“ä½œä¹‹åŽå‘ç”Ÿï¼›instead of è¡¨ç¤ºè§¦å‘å™¨ä¸º æ›¿ä»£è§¦å‘å™¨ã€‚onï¼šè¡¨ç¤ºæ“ä½œçš„æ•°æ®è¡¨ã€è§†å›¾ã€ç”¨æˆ·æ¨¡å¼å’Œæ•°æ®åº“ç­‰ï¼Œå¯¹å®ƒä»¬æ‰§è¡ŒæŸç§æ•°æ®æ“ä½œï¼ˆæ¯”å¦‚å¯¹è¡¨æ‰§è¡ŒINSERTã€ALTERã€DROP ç­‰æ“ä½œï¼‰ï¼Œå°†å¼•èµ·è§¦å‘å™¨çš„è¿è¡Œã€‚for each rowï¼šæŒ‡å®šè§¦å‘å™¨ä¸ºè¡Œçº§è§¦å‘å™¨ï¼Œå½“DMLè¯­å¥å¯¹æ¯ä¸€è¡Œæ•°æ®è¿›è¡Œæ“ä½œæ—¶éƒ½ä¼šå¼•èµ·è¯¥è§¦å‘å™¨çš„è¿è¡Œã€‚å¦‚æžœæœªæŒ‡å®šè¯¥æ¡ä»¶ï¼Œåˆ™è¡¨ç¤ºåˆ›å»ºè¯­å¥çº§è§¦å‘å™¨ï¼Œè¿™æ—¶æ— è®ºæ•°æ®æ“ä½œå½±å“å¤šå°‘è¡Œï¼Œè§¦å‘å™¨éƒ½åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚tri_conditionï¼šè¡¨ç¤ºè§¦å‘æ¡ä»¶è¡¨è¾¾å¼ã€‚æ ¹æ®è§¦å‘å™¨çš„è§¦å‘äº‹ä»¶å’Œè§¦å‘å™¨çš„æ‰§è¡Œæƒ…å†µï¼Œå°†Oracle æ‰€æ”¯æŒçš„è§¦å‘å™¨åˆ†ä¸ºä»¥ä¸‹4 ç§ç±»åž‹ï¼šè¯­å¥çº§è§¦å‘å™¨è¯­å¥çº§è§¦å‘å™¨ï¼Œå°±æ˜¯é’ˆå¯¹ä¸€æ¡DML è¯­å¥è€Œå¼•èµ·çš„è§¦å‘å™¨æ‰§è¡Œã€‚åœ¨è¯­å¥çº§è§¦å‘å™¨ä¸­ï¼Œä¸ä½¿ç”¨for each row å­å¥ï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®ºæ•°æ®æ“ä½œå½±å“å¤šå°‘è¡Œï¼Œè§¦å‘å™¨éƒ½åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚æ¯”å¦‚è®¾è®¡ä¸€ä¸ªè§¦å‘å™¨ï¼Œç”¨äºŽè®°å½•å¯¹soctt.deptè¡¨çš„å¢žåˆ æ”¹æŸ¥æ“ä½œï¼š1.åˆ›å»ºdept_log æ•°æ®è¡¨ï¼Œç”¨äºŽè®°å½•æ“ä½œç±»åž‹å’Œæ—¶é—´ï¼š123456SQL&gt; create table dept_log( operate_tag varchar2(10), operate_time date );è¡¨å·²åˆ›å»ºã€‚2.åˆ›å»ºä¸€ä¸ªå…³äºŽdept è¡¨çš„è¯­å¥çº§è§¦å‘å™¨ï¼Œå°†ç”¨æˆ·å¯¹dept è¡¨çš„æ“ä½œä¿¡æ¯ä¿å­˜åˆ°dept_log è¡¨ä¸­ï¼š123456789101112131415161718SQL&gt; create or replace trigger tir_dept before insert or update or delete on dept declare var_tag varchar2(10); begin if inserting then var_tag:='insert'; elsif updating then var_tag:='update'; elsif deleting then var_tag:='delete'; end if; insert into dept_log values(var_tag,sysdate); end; /è§¦å‘å™¨å·²åˆ›å»ºç”¨æˆ·ç”šè‡³è¿˜å¯ä»¥åœ¨å…¶ä¸­åˆ¤æ–­ç‰¹å®šåˆ—æ˜¯å¦è¢«æ›´æ–°ã€‚ä¾‹å¦‚ï¼Œè¦åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å¯¹dept è¡¨ä¸­dname åˆ—è¿›è¡Œäº†ä¿®æ”¹ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¯­å¥ï¼š123if updating(dname) then //è‹¥ä¿®æ”¹äº†dept è¡¨ä¸­çš„dname åˆ— do something about update dnameend if;3.æ‰§è¡ŒDML è¯­å¥æ¥è§¦å‘tri_deptï¼š123456789SQL&gt; delete from dept where deptno = 90;å·²åˆ é™¤ 1 è¡Œã€‚SQL&gt; insert into dept values(90,'æ¸…ç®—é£ŽæŽ§éƒ¨é—¨','ç¦å·ž');å·²åˆ›å»º 1 è¡Œã€‚SQL&gt; update dept set loc='åŽ¦é—¨' where deptno = 90;å·²æ›´æ–° 1 è¡Œã€‚4.åˆ°dept_log è¡¨ä¸­æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯ï¼š1234567SQL&gt; select * from dept_log;OPERATE_TA OPERATE_TIME---------- --------------delete 13-11æœˆ-17insert 13-11æœˆ-17update 13-11æœˆ-17è¡Œçº§è§¦å‘å™¨è¡Œçº§è§¦å‘å™¨ä¼šé’ˆå¯¹DML æ“ä½œæ‰€å½±å“çš„æ¯ä¸€è¡Œæ•°æ®éƒ½æ‰§è¡Œä¸€æ¬¡è§¦å‘å™¨ã€‚åˆ›å»ºè¿™ç§è§¦å‘å™¨æ—¶ï¼Œå¿…é¡»åœ¨è¯­æ³•ä¸­ä½¿ç”¨for each rowã€‚ä½¿ç”¨è¡Œçº§è§¦å‘å™¨çš„ä¸€ä¸ªå…¸åž‹åº”ç”¨å°±æ˜¯ç»™æ•°æ®è¡¨ç”Ÿæˆä¸»é”®å€¼ã€‚ä¸¾ä¸ªä¾‹å­ï¼š1.åˆ›å»ºä¸€ä¸ªç”¨äºŽå­˜å‚¨å•†å“ç§ç±»çš„æ•°æ®è¡¨ï¼Œå…¶ä¸­åŒ…æ‹¬å•†å“åºå·åˆ—å’Œå•†å“åç§°åˆ—ï¼Œå…¶ä¸­å•†å“åºå·ä¸ºä¸»é”®ï¼š123456SQL&gt; create table goods( id int not null primary key, good_name varchar2(50) );è¡¨å·²åˆ›å»ºã€‚2.ä¸ºä¸»é”®åˆ›å»ºä¸€ä¸ªåºåˆ—ï¼š123SQL&gt; create sequence seq_goods_id;åºåˆ—å·²åˆ›å»ºã€‚3.åˆ›å»ºä¸€ä¸ªè§¦å‘å™¨ï¼Œç”¨äºŽè‡ªåŠ¨ä¸ºgoods è¡¨çš„id åˆ—èµ‹å€¼ï¼š12345678910SQL&gt; create or replace trigger tri_save_good before insert on goods for each row begin select seq_goods_id.nextval into :new.id from dual; end; /è§¦å‘å™¨å·²åˆ›å»ºè¿™é‡Œä½¿ç”¨äº†:new.idå…³é”®å­—â€”â€”åˆ—æ ‡è¯†ç¬¦ï¼Œè¿™ä¸ªåˆ—æ ‡è¯†ç¬¦ç”¨æ¥æŒ‡å‘æ–°è¡Œçš„id åˆ—ï¼Œç»™å®ƒèµ‹å€¼ã€‚åˆ—æ ‡è¯†ç¬¦å¯ä»¥åˆ†ä¸ºåŽŸå€¼æ ‡è¯†ç¬¦å’Œæ–°å€¼æ ‡è¯†ç¬¦ï¼šåŽŸå€¼æ ‡è¯†ç¬¦ç”¨äºŽæ ‡è¯†å½“å‰è¡ŒæŸä¸ªåˆ—çš„åŽŸå§‹å€¼ï¼Œè®°ä½œ:old.column_nameï¼ˆå¦‚ï¼Œ:old.idï¼‰ï¼Œé€šå¸¸åœ¨update è¯­å¥å’Œdelete è¯­å¥ä¸­ä½¿ç”¨ï¼›æ–°å€¼æ ‡è¯†ç¬¦ç”¨äºŽæ ‡è¯†å½“å‰è¡ŒæŸä¸ªåˆ—çš„æ–°å€¼ï¼Œè®°ä½œ:new.column_nameï¼ˆå¦‚ï¼Œ:new.idï¼‰ï¼Œé€šå¸¸åœ¨insert è¯­å¥å’Œupdate è¯­å¥ä¸­ä½¿ç”¨ã€‚4.å‘ goods è¡¨ä¸­æ’å…¥ä¸¤æ¡è®°å½•ï¼Œå…¶ä¸­ä¸€æ¡è®°å½•ä¸æŒ‡å®šid åˆ—çš„å€¼ï¼Œç”±åºåˆ—seq_goods_id æ¥äº§ç”Ÿï¼›å¦ä¸€æ¡è®°å½•æŒ‡å®šid çš„å€¼ï¼š123456SQL&gt; insert into goods(good_name) values('apple');å·²åˆ›å»º 1 è¡Œã€‚SQL&gt; insert into goods(id,good_name) values(100,'banana');å·²åˆ›å»º 1 è¡Œã€‚5.æŸ¥çœ‹goodsè¡¨ç»“æžœï¼š123456SQL&gt; select * from goods; ID GOOD_NAME---------- ---------------------- 1 apple 2 bananaå¯è§æ‰‹åŠ¨æŒ‡å®šçš„idå€¼ï¼ˆ100ï¼‰æ— æ³•è¦†ç›–è§¦å‘å™¨ä¸­æŒ‡å®šçš„seq_goods_id.nextvalå€¼ã€‚æ›¿æ¢è§¦å‘å™¨æ›¿æ¢è§¦å‘å™¨â€”â€”instead of è§¦å‘å™¨æ˜¯å®šä¹‰åœ¨è§†å›¾viewä¸Šçš„ã€‚Oracleä¸­ä¸€èˆ¬ä¸è®©ç›´æŽ¥å¯¹è§†å›¾è¿›è¡ŒDMLæ“ä½œï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ›¿æ¢è§¦å‘å™¨æ¥å®žçŽ°ã€‚1.åˆ›å»ºä¸€ä¸ªåŒ…å«deptè¡¨å’Œempè¡¨ä¿¡æ¯çš„è§†å›¾ï¼š123456SQL&gt; create view view_emp_dept as select empno,ename,dept.deptno,dname,job,hiredate from emp,dept where emp.deptno = dept.deptno;è§†å›¾å·²åˆ›å»ºã€‚ç›´æŽ¥å¾€è§†å›¾é‡Œæ’å…¥æ•°æ®ï¼š123456SQL&gt; insert into view_emp_dept values(7966,'Jane',70,'å¸‚åœºéƒ¨','ç»ç†',sysdate);insert into view_emp_dept values(*ç¬¬ 1 è¡Œå‡ºçŽ°é”™è¯¯:ORA-01776: æ— æ³•é€šè¿‡è”æŽ¥è§†å›¾ä¿®æ”¹å¤šä¸ªåŸºè¡¨2.ç›´æŽ¥å¾€è§†å›¾é‡Œæ’å…¥æ•°æ®æŠ¥é”™ï¼Œæ­¤æ—¶ç¼–å†™ä¸€ä¸ªå…³äºŽview_emp_dept è§†å›¾åœ¨insert äº‹ä»¶ä¸­çš„è§¦å‘å™¨ï¼š12345678910111213141516SQL&gt; create or replace trigger tri_insert_view_emp_dept instead of insert on view_emp_dept declare row_dept dept%rowtype; begin select * into row_dept from dept where deptno=:new.deptno; if sql%notfound then insert into dept(deptno,dname) values(:new.deptno,:new.dname); end if; insert into emp(empno,ename,deptno,job,hiredate) values(:new.empno,:new.ename,:new.deptno,:new.job,:new.hiredate); end; /è§¦å‘å™¨å·²åˆ›å»ºåœ¨ä¸Šé¢è§¦å‘å™¨çš„ä¸»ä½“ä»£ç ä¸­ï¼Œå¦‚æžœæ–°æ’å…¥è¡Œçš„éƒ¨é—¨ç¼–å·ï¼ˆdeptnoï¼‰ä¸åœ¨dept è¡¨ä¸­ï¼Œåˆ™é¦–å…ˆå‘deptè¡¨ä¸­æ’å…¥å…³äºŽæ–°éƒ¨é—¨ç¼–å·çš„æ•°æ®è¡Œï¼Œç„¶åŽå†å‘emp è¡¨ä¸­æ’å…¥è®°å½•è¡Œï¼Œè¿™æ˜¯å› ä¸ºemp è¡¨çš„å¤–é”®å€¼ï¼ˆemp.deptnoï¼‰æ˜¯dept è¡¨çš„ä¸»é”®å€¼ï¼ˆdept.deptnoï¼‰ã€‚3.å†æ¬¡æ‰§è¡Œinsert into view_emp_dept values(7966,&#39;Jane&#39;,70,&#39;å¸‚åœºéƒ¨&#39;,&#39;ç»ç†&#39;,sysdate);ï¼š12345678SQL&gt; insert into view_emp_dept values(7966,'Jane',70,'å¸‚åœºéƒ¨','ç»ç†',sysdate);å·²åˆ›å»º 1 è¡Œã€‚SQL&gt; select * from view_emp_dept where empno=7966; EMPNO ENAME DEPTNO DNAME JOB HIREDATE---------- ---------- ---------- -------------- --------- -------------- 7966 Jane 70 å¸‚åœºéƒ¨ ç»ç† 13-11æœˆ-17ç”¨æˆ·äº‹ä»¶è§¦å‘å™¨ç”¨æˆ·äº‹ä»¶è§¦å‘å™¨æ˜¯å› è¿›è¡Œ DDL æ“ä½œæˆ–ç”¨æˆ·ç™»å½•ã€é€€å‡ºç­‰æ“ä½œè€Œå¼•èµ·è¿è¡Œçš„ä¸€ç§è§¦å‘å™¨ï¼Œå¼•èµ·è¯¥ç±»åž‹è§¦å‘å™¨è¿è¡Œçš„å¸¸è§ç”¨æˆ·äº‹ä»¶åŒ…æ‹¬ï¼šCREATEã€ALTERã€DROPã€ANALYZEã€COMMENTã€GRANTã€REVOKEã€RENAMEã€TRUNCATEã€SUSPENDã€LOGON å’ŒLOGOFF ç­‰ã€‚1.åˆ›å»ºä¸€ä¸ªæ—¥å¿—ä¿¡æ¯è¡¨ï¼Œç”¨äºŽä¿å­˜DDL æ“ä½œçš„ä¿¡æ¯:123456789SQL&gt; create table ddl_oper_log( db_obj_name varchar2(20), //æ•°æ®å¯¹è±¡åç§° db_obj_type varchar2(20), //æ•°æ®å¯¹è±¡ç±»åž‹ oper_action varchar2(20), //æ“ä½œè¡Œä¸º oper_user varchar2(20), //æ“ä½œç”¨æˆ· oper_time date //æ“ä½œæ—¶é—´ );è¡¨å·²åˆ›å»ºã€‚2.åˆ›å»ºä¸€ä¸ªç”¨æˆ·è§¦å‘å™¨ï¼Œç”¨äºŽå°†å½“å‰æ¨¡å¼ä¸‹çš„DDL æ“ä½œä¿¡æ¯ä¿å­˜åˆ°ä¸Šé¢æ‰€åˆ›å»ºçš„ddl_oper_logæ—¥å¿—ä¿¡æ¯è¡¨ä¸­ï¼š1234567891011121314SQL&gt; create or replace trigger tri_ddl_oper before create or alter or drop on scott.schema begin insert into ddl_oper_log values( ora_dict_obj_name, ora_dict_obj_type, ora_sysevent, ora_login_user, sysdate); end; /è§¦å‘å™¨å·²åˆ›å»ºora_dict_obj_nameï¼šèŽ·å–DDL æ“ä½œæ‰€å¯¹åº”çš„æ•°æ®åº“å¯¹è±¡ã€‚ora_dict_obj_typeï¼šèŽ·å–DDL æ“ä½œæ‰€å¯¹åº”çš„æ•°æ®åº“å¯¹è±¡çš„ç±»åž‹ã€‚ora_syseventï¼šèŽ·å–è§¦å‘å™¨çš„ç³»ç»Ÿäº‹ä»¶åã€‚ora_login_userï¼šèŽ·å–ç™»å½•ç”¨æˆ·åã€‚3.æ‰§è¡Œä¸€äº›DDL æ“ä½œï¼š123456789101112SQL&gt; create table tb_test(id number);è¡¨å·²åˆ›å»ºã€‚SQL&gt; create view v_test as select * from tb_test;è§†å›¾å·²åˆ›å»ºã€‚SQL&gt; drop view v_test;è§†å›¾å·²åˆ é™¤ã€‚SQL&gt; drop table tb_test;è¡¨å·²åˆ é™¤ã€‚4.æŸ¥çœ‹ddl_oper_logæ—¥å¿—è¡¨ï¼š12345678SQL&gt; select * from ddl_oper_log;DB_OBJ_NAME DB_OBJ_TYPE OPER_ACTION OPER_USER OPER_TIME-------------------- -------------------- -------------------- -------------------- -------------TB_TEST TABLE CREATE SCOTT 13-11æœˆ-17V_TEST VIEW CREATE SCOTT 13-11æœˆ-17V_TEST VIEW DROP SCOTT 13-11æœˆ-17TB_TEST TABLE DROP SCOTT 13-11æœˆ-17]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracleå­˜å‚¨è¿‡ç¨‹ä¸Žå‡½æ•°]]></title>
    <url>%2FOracle%20Stored%20procedure%20function.html</url>
    <content type="text"><![CDATA[å­˜å‚¨è¿‡ç¨‹å­˜å‚¨è¿‡ç¨‹æ˜¯ä¸€ç§å‘½åçš„PL/SQLç¨‹åºå—ï¼Œå®ƒæ—¢å¯ä»¥æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿå¯ä»¥æœ‰è‹¥å¹²ä¸ªè¾“å…¥ã€è¾“å‡ºå‚æ•°ï¼Œç”šè‡³å¯ä»¥æœ‰å¤šä¸ªæ—¢ä½œè¾“å…¥åˆä½œè¾“å‡ºçš„å‚æ•°ï¼Œä½†å®ƒé€šå¸¸æ²¡æœ‰è¿”å›žå€¼ã€‚å­˜å‚¨è¿‡ç¨‹è¢«ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå®ƒä¸å¯ä»¥è¢«SQL è¯­å¥ç›´æŽ¥æ‰§è¡Œæˆ–è°ƒç”¨ï¼Œåªèƒ½é€šè¿‡EXECUT å‘½ä»¤æ‰§è¡Œæˆ–åœ¨PL/SQL ç¨‹åºå—å†…éƒ¨è¢«è°ƒç”¨ã€‚ç”±äºŽå­˜å‚¨è¿‡ç¨‹æ˜¯å·²ç»ç¼–è¯‘å¥½çš„ä»£ç ï¼Œæ‰€ä»¥å…¶è¢«è°ƒç”¨æˆ–å¼•ç”¨æ—¶ï¼Œæ‰§è¡Œæ•ˆçŽ‡éžå¸¸é«˜ã€‚åˆ›å»ºå­˜å‚¨è¿‡ç¨‹åˆ›å»ºå­˜å‚¨è¿‡ç¨‹çš„è¯­æ³•å¦‚ä¸‹ï¼š123456create [or replace] procedure pro_name [(parameter1[,parameter2]â€¦)] is|asbegin plsql_sentences;[exception] [dowith _ sentences;]end [pro_name];pro_nameï¼šå­˜å‚¨è¿‡ç¨‹çš„åç§°ï¼Œå¦‚æžœæ•°æ®åº“ä¸­å·²ç»å­˜åœ¨äº†æ­¤åç§°ï¼Œåˆ™å¯ä»¥æŒ‡å®šâ€œor replaceâ€å…³é”®å­—ï¼Œè¿™æ ·æ–°çš„å­˜å‚¨è¿‡ç¨‹å°†è¦†ç›–æŽ‰åŽŸæ¥çš„å­˜å‚¨è¿‡ç¨‹ã€‚parameter1ï¼šå­˜å‚¨è¿‡ç¨‹çš„å‚æ•°ï¼Œè‹¥æ˜¯è¾“å…¥å‚æ•°ï¼Œåˆ™éœ€è¦åœ¨å…¶åŽæŒ‡å®šâ€œinâ€å…³é”®å­—ï¼›è‹¥æ˜¯è¾“å‡ºå‚æ•°ï¼Œåˆ™éœ€è¦åœ¨å…¶åŽé¢æŒ‡å®šâ€œoutâ€å…³é”®å­—ã€‚åœ¨inæˆ–outå…³é”®å­—çš„åŽé¢æ˜¯å‚æ•°çš„æ•°æ®ç±»åž‹ï¼Œä½†ä¸èƒ½æŒ‡å®šè¯¥ç±»åž‹çš„é•¿åº¦ã€‚åˆ›å»ºä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼Œè¯¥å­˜å‚¨è¿‡ç¨‹å®žçŽ°å‘deptè¡¨ä¸­æ’å…¥ä¸€æ¡è®°å½•ï¼š123456789SQL&gt; create or replace procedure save_dept is begin insert into dept values(50,'å¼€å‘ä¸€éƒ¨','ç¦å·ž'); commit; dbms_output.put_line('æ’å…¥æ•°æ®æˆåŠŸï¼'); end; /è¿‡ç¨‹å·²åˆ›å»ºã€‚åˆ›å»ºè¿‡ç¨‹ä¸­å¦‚æžœå‡ºçŽ°é”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨show erræŒ‡ä»¤æŸ¥çœ‹ã€‚è‹¥è¦æ‰§è¡Œè¿™ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼Œåˆ™éœ€è¦åœ¨SQL*Plus çŽ¯å¢ƒä¸­ä½¿ç”¨EXECUTEå‘½ä»¤æ¥æ‰§è¡Œè¯¥å­˜å‚¨è¿‡ç¨‹ï¼Œæˆ–è€…åœ¨PL/SQL ç¨‹åºå—ä¸­è°ƒç”¨è¯¥å­˜å‚¨è¿‡ç¨‹ã€‚12345SQL&gt; set serveroutput onSQL&gt; execute save_deptæ’å…¥æ•°æ®æˆåŠŸï¼PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚æˆ–è€…åœ¨ PL/SQL å—ä¸­è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ï¼š123456789101112SQL&gt; delete from dept where deptno=50;å·²åˆ é™¤ 1 è¡Œã€‚SQL&gt; set serveroutput onSQL&gt; begin save_dept; end; /æ’å…¥æ•°æ®æˆåŠŸï¼PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚å­˜å‚¨è¿‡ç¨‹çš„å‚æ•°å­˜å‚¨è¿‡ç¨‹å¯ä»¥æŽ¥å—å¤šä¸ªå‚æ•°ï¼Œå‚æ•°æ¨¡å¼åŒ…æ‹¬INã€OUT å’ŒIN OUT 3 ç§ï¼š1.INæ¨¡å¼å‚æ•°è¿™æ˜¯ä¸€ç§è¾“å…¥ç±»åž‹çš„å‚æ•°ï¼Œå‚æ•°å€¼ç”±è°ƒç”¨æ–¹ä¼ å…¥ï¼Œå¹¶ä¸”åªèƒ½è¢«å­˜å‚¨è¿‡ç¨‹è¯»å–ï¼Œæ˜¯é»˜è®¤çš„å‚æ•°æ¨¡å¼ã€‚æ¯”å¦‚åˆ›å»ºä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼Œå¹¶å®šä¹‰ 3 ä¸ªin æ¨¡å¼çš„å˜é‡ï¼Œç„¶åŽå°†è¿™3 ä¸ªå˜é‡çš„å€¼æ’å…¥åˆ°deptè¡¨ä¸­ï¼š1234567891011SQL&gt; create or replace procedure save_dept( deptno in number, dname in varchar2, loc in varchar2) is begin insert into dept values(deptno,dname,loc); commit; end; /è¿‡ç¨‹å·²åˆ›å»ºã€‚è°ƒç”¨è¯¥å­˜å‚¨è¿‡ç¨‹æ—¶ä¼ å‚æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼šæŒ‡å®šåç§°ä¼ é€’ï¼š1pro_name(parameter1=&gt;value1[,parameter2=&gt;value2]â€¦)ä½¿ç”¨è¿™ç§æ–¹å¼è°ƒç”¨ä¸Šé¢å®šä¹‰çš„å­˜å‚¨è¿‡ç¨‹ï¼š123456SQL&gt; begin save_dept(dname=&gt;'å¼€å‘äºŒéƒ¨',loc=&gt;'ç¦å·ž',deptno=&gt;60); end; /PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚ä½¿ç”¨â€œæŒ‡å®šåç§°â€çš„æ–¹å¼ä¼ é€’å‚æ•°å€¼ä¸Žå‚æ•°çš„å®šä¹‰é¡ºåºæ— å…³ï¼Œä½†ä¸Žå‚æ•°ä¸ªæ•°æœ‰å…³ã€‚æŒ‰ä½ç½®ä¼ é€’ï¼šé‡‡ç”¨è¿™ç§æ–¹å¼æ—¶ï¼Œç”¨æˆ·æä¾›çš„å‚æ•°å€¼é¡ºåºå¿…é¡»ä¸Žå­˜å‚¨è¿‡ç¨‹ä¸­å®šä¹‰çš„å‚æ•°é¡ºåºç›¸åŒï¼š123456SQL&gt; begin save_dept(70,'å¸‚åœºéƒ¨','ç¦å·ž'); end; /PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚æ··åˆæ–¹å¼ä¼ é€’ï¼šæ··åˆæ–¹å¼å°±æ˜¯å°†å‰ä¸¤ç§æ–¹å¼ç»“åˆåˆ°ä¸€èµ·ï¼š12345678 PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚SQL&gt; begin save_dept(80,loc=&gt;'ç¦å·ž',dname=&gt;'è´¢åŠ¡ç®¡ç†éƒ¨'); end; /PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚æœ‰æ—¶å€™å‚æ•°è¿‡å¤šï¼Œç”¨æˆ·ä¸å®¹æ˜“è®°ä½å‚æ•°çš„é¡ºåºå’Œç±»åž‹ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡descå‘½ä»¤æ¥æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹ä¸­å‚æ•°çš„å®šä¹‰ä¿¡æ¯ï¼š1234567SQL&gt; desc save_deptPROCEDURE save_deptå‚æ•°åç§° ç±»åž‹ è¾“å…¥/è¾“å‡ºé»˜è®¤å€¼?------------------------------ ----------------------- ------ -------- DEPTNO NUMBER IN DNAME VARCHAR2 IN LOC VARCHAR2 IN2.OUT æ¨¡å¼å‚æ•°è¿™æ˜¯ä¸€ç§è¾“å‡ºç±»åž‹çš„å‚æ•°ï¼Œè¡¨ç¤ºè¿™ä¸ªå‚æ•°åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­å·²ç»è¢«èµ‹å€¼ï¼Œå¹¶ä¸”è¿™ä¸ªå‚æ•°å€¼å¯ä»¥ä¼ é€’åˆ°å½“å‰å­˜å‚¨è¿‡ç¨‹ä»¥å¤–çš„çŽ¯å¢ƒä¸­ï¼š1234567891011SQL&gt; create or replace procedure select_dept( var_deptno in number, var_dname out dept.dname%type, var_loc out dept.loc%type) is begin select dname,loc into var_dname,var_loc from dept where deptno = var_deptno; end; /è¿‡ç¨‹å·²åˆ›å»ºã€‚ä¸Šè¿°å­˜å‚¨è¿‡ç¨‹å®šä¹‰äº†ä¸¤ä¸ªout å‚æ•°ï¼Œç”±äºŽå­˜å‚¨è¿‡ç¨‹è¦é€šè¿‡out å‚æ•°è¿”å›žå€¼ï¼Œæ‰€ä»¥å½“è°ƒç”¨æˆ–æ‰§è¡Œè¿™ä¸ªå­˜å‚¨è¿‡ç¨‹æ—¶ï¼Œéƒ½éœ€è¦å®šä¹‰å˜é‡æ¥ä¿å­˜è¿™ä¸¤ä¸ªoutå‚æ•°å€¼ã€‚ä½¿ç”¨EXECUTEå‘½ä»¤æ¥æ‰§è¡Œè¯¥å­˜å‚¨è¿‡ç¨‹ï¼š123456789101112131415161718192021222324SQL&gt; variable var_dname varchar2(50);SQL&gt; variable var_loc varchar2(50);SQL&gt; execute select_dept(50,:var_dname,:var_loc);PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚SQL&gt; print var_dname var_loc;VAR_DNAME--------------------------------------------------------------------------------å¼€å‘ä¸€éƒ¨VAR_LOC--------------------------------------------------------------------------------ç¦å·žSQL&gt; select :var_dname,:var_loc from dual;:VAR_DNAME--------------------------------------------------------------------------------:VAR_LOC--------------------------------------------------------------------------------å¼€å‘ä¸€éƒ¨ç¦å·žåœ¨PL/SQL ç¨‹åºå—ä¸­è°ƒç”¨è¯¥å­˜å‚¨è¿‡ç¨‹ï¼š123456789101112SQL&gt; set serveroutput onSQL&gt; declare var_dname dept.dname%type; var_loc dept.loc%type; begin save_dept(50,var_dname,var_loc); dbms_output.put_line(var_dname||'ä½äºŽ'||var_loc); end; /å¼€å‘ä¸€éƒ¨ä½äºŽç¦å·žPL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚3.IN OUTæ¨¡å¼å‚æ•°åœ¨è°ƒç”¨å­˜å‚¨è¿‡ç¨‹æ—¶ï¼ŒIN OUTæ¨¡å¼å‚æ•°å¯ä»¥ä»Žå¤–ç•Œå‘è¯¥ç±»åž‹çš„å‚æ•°ä¼ å…¥å€¼ï¼›åœ¨æ‰§è¡Œå®Œå­˜å‚¨è¿‡ç¨‹ä¹‹åŽï¼Œå¯ä»¥å°†è¯¥å‚æ•°çš„è¿”å›žå€¼ä¼ ç»™å¤–ç•Œï¼š12345678SQL&gt; create or replace procedure square( num in out number) is begin num:=power(num,2); end; /è¿‡ç¨‹å·²åˆ›å»ºã€‚ä¸Šé¢çš„å­˜å‚¨è¿‡ç¨‹ä¸­å®šä¹‰äº†ä¸€ä¸ªin outæ¨¡å¼çš„å‚æ•°numï¼Œå…¶æ—¢æ˜¯è¾“å…¥å‚æ•°ä¹Ÿæ˜¯è¾“å‡ºå‚æ•°ï¼Œä¸‹é¢ç”¨PL/SQLç¨‹åºå—è°ƒç”¨è¯¥å­˜å‚¨è¿‡ç¨‹ï¼š12345678910111213SQL&gt; declare var_number number; var_temp number; begin var_temp:=3; var_number:=var_temp; square(var_number); dbms_output.put_line(var_temp||'çš„å¹³æ–¹ä¸ºï¼š'||var_number); end; /3çš„å¹³æ–¹ä¸ºï¼š9PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚ä»Žä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œå˜é‡var_number åœ¨è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ä¹‹å‰æ˜¯3ï¼Œè€Œå­˜å‚¨è¿‡ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åŽï¼Œè¯¥å˜é‡çš„å€¼å˜ä¸ºå…¶å¹³æ–¹æ ¹9ã€‚IN å‚æ•°çš„é»˜è®¤å€¼å‰é¢çš„ IN å‚æ•°çš„å€¼éƒ½æ˜¯åœ¨è°ƒç”¨å­˜å‚¨è¿‡ç¨‹æ—¶ä¼ å…¥çš„ï¼Œå®žé™…ä¸Šï¼ŒOracle æ”¯æŒåœ¨å£°æ˜ŽIN å‚æ•°çš„åŒæ—¶ç»™å…¶åˆå§‹åŒ–é»˜è®¤å€¼ï¼Œè¿™æ ·åœ¨å­˜å‚¨è¿‡ç¨‹è°ƒç”¨æ—¶ï¼Œå¦‚æžœæ²¡æœ‰å‘INå‚æ•°ä¼ å…¥å€¼ï¼Œåˆ™å­˜å‚¨è¿‡ç¨‹å¯ä»¥ä½¿ç”¨é»˜è®¤å€¼è¿›è¡Œæ“ä½œï¼š12345678910SQL&gt; create or replace procedure save_dept( var_deptno in number, var_dname in varchar2 default 'äº§å“åˆ›æ–°ä¸­å¿ƒ', var_loc in varchar2 default 'ç¦å·ž') is begin insert into dept values(var_deptno,var_dname,var_loc); end; /è¿‡ç¨‹å·²åˆ›å»ºã€‚var_dnameå’Œvar_locå®šä¹‰äº†é»˜è®¤å€¼ï¼Œä¸‹é¢è°ƒç”¨è¯¥å­˜å‚¨è¿‡ç¨‹ï¼š123456789SQL&gt; execute save_dept(90,var_dname=&gt;'äººäº‹è¡Œæ”¿éƒ¨');PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚SQL&gt; select * from dept where deptno = 90; DEPTNO DNAME LOC---------- -------------- ------------- 90 äººäº‹è¡Œæ”¿éƒ¨ ç¦å·žè¿™é‡Œvar_locé‡‡ç”¨äº†é»˜è®¤å€¼â€œç¦å·žâ€ã€‚åˆ é™¤å­˜å‚¨è¿‡ç¨‹åˆ é™¤å­˜å‚¨è¿‡ç¨‹çš„è¯­æ³•å¾ˆç®€å•ï¼š1drop procedure procedure_name;æ¯”å¦‚åˆ é™¤save_deptè¿™ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼š123SQL&gt; drop procedure save_dept;è¿‡ç¨‹å·²åˆ é™¤ã€‚å‡½æ•°å‡½æ•°ä¸€èˆ¬ç”¨äºŽè®¡ç®—å’Œè¿”å›žä¸€ä¸ªå€¼ï¼Œå¯ä»¥å°†ç»å¸¸éœ€è¦ä½¿ç”¨çš„è®¡ç®—æˆ–åŠŸèƒ½å†™æˆä¸€ä¸ªå‡½æ•°ã€‚åˆ›å»ºå‡½æ•°å‡½æ•°çš„åˆ›å»ºè¯­æ³•ä¸Žå­˜å‚¨è¿‡ç¨‹æ¯”è¾ƒç±»ä¼¼ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å‘½åç¨‹åºå—ï¼Œå‡½æ•°å¯ä»¥æŽ¥å—é›¶æˆ–å¤šä¸ªè¾“å…¥å‚æ•°ï¼Œå¹¶ä¸”å‡½æ•°å¿…é¡»æœ‰è¿”å›žå€¼ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1234567create [or replace] function fun_name[(parameter1[,parameter2]â€¦) return data_type is [inner_variable]begin plsql_ sentence;[exception] [dowith _ sentences;]end [fun_name];ç”±äºŽå‡½æ•°æœ‰è¿”å›žå€¼ï¼Œæ‰€ä»¥åœ¨å‡½æ•°ä¸»ä½“éƒ¨åˆ†ï¼ˆå³begin éƒ¨åˆ†ï¼‰å¿…é¡»ä½¿ç”¨return è¯­å¥è¿”å›žå‡½æ•°å€¼ï¼Œå¹¶ä¸”è¦æ±‚è¿”å›žå€¼çš„ç±»åž‹è¦ä¸Žå‡½æ•°å£°æ˜Žæ—¶çš„è¿”å›žå€¼ç±»åž‹ï¼ˆå³data_typeï¼‰ç›¸åŒã€‚å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºŽè®¡ç®—emp è¡¨ä¸­æŒ‡å®šæŸä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„ï¼š1234567891011121314SQL&gt; create or replace function avg_sal(var_deptno number) return number is var_result number; begin select avg(sal) into var_result from emp where deptno = var_deptno; return var_result; exception when no_data_found then dbms_output.put_line('æ²¡æœ‰è¯¥éƒ¨é—¨'); return 0; end; /å‡½æ•°å·²åˆ›å»ºã€‚è°ƒç”¨å‡½æ•°ç”±äºŽå‡½æ•°æœ‰è¿”å›žå€¼ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥ä¿å­˜å‡½æ•°çš„è¿”å›žå€¼ï¼š1234567891011SQL&gt; set serveroutput onSQL&gt; declare var_result number; begin var_result:=avg_sal(10); dbms_output.put_line('ç¼–å·ä¸º10çš„éƒ¨é—¨å¹³å‡å·¥èµ„ä¸ºï¼š'||var_result); end; /ç¼–å·ä¸º10çš„éƒ¨é—¨å¹³å‡å·¥èµ„ä¸ºï¼š2916.666666666666666666666666666666666667PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚åˆ é™¤å‡½æ•°åˆ é™¤avg_salå‡½æ•°ï¼š123SQL&gt; drop function avg_sal;å‡½æ•°å·²åˆ é™¤ã€‚]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracle PL/SQLç¼–ç¨‹]]></title>
    <url>%2FOracle-PL-SQL%E7%BC%96%E7%A8%8B.html</url>
    <content type="text"><![CDATA[PL/SQL(Procedural Language/SQL)æ˜¯ä¸€ç§è¿‡ç¨‹åŒ–è¯­è¨€ï¼Œåœ¨PL/SQL ä¸­å¯ä»¥é€šè¿‡IF è¯­å¥æˆ–LOOP è¯­å¥å®žçŽ°æŽ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œç”šè‡³å¯ä»¥å®šä¹‰å˜é‡ï¼Œä»¥ä¾¿åœ¨è¯­å¥ä¹‹é—´ä¼ é€’æ•°æ®ä¿¡æ¯ï¼Œè¿™æ ·PL/SQL è¯­è¨€å°±èƒ½å¤Ÿå®žçŽ°æ“æŽ§ç¨‹åºå¤„ç†çš„ç»†èŠ‚è¿‡ç¨‹ã€‚PL/SQL ç¨‹åºéƒ½æ˜¯ä»¥å—ï¼ˆBLOCKï¼‰ä¸ºåŸºæœ¬å•ä½ï¼Œæ•´ä¸ªPL/SQL å—åˆ†3 éƒ¨åˆ†ï¼šå£°æ˜Žéƒ¨åˆ†ï¼ˆç”¨DECLAREå¼€å¤´ï¼‰ã€æ‰§è¡Œéƒ¨åˆ†ï¼ˆä»¥BEGIN å¼€å¤´ï¼‰å’Œå¼‚å¸¸å¤„ç†éƒ¨åˆ†ï¼ˆä»¥EXCEPTION å¼€å¤´ï¼‰ï¼š1234567[DECLARE] --å£°æ˜Žéƒ¨åˆ†ï¼Œå¯é€‰BEGIN --æ‰§è¡Œéƒ¨åˆ†ï¼Œå¿…é¡»[EXCEPTION] --å¼‚å¸¸å¤„ç†éƒ¨åˆ†ï¼Œå¯é€‰ENDå¯¹äºŽ PL/SQL å—ä¸­çš„è¯­å¥ï¼Œéœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼šæ¯ä¸€æ¡è¯­å¥éƒ½å¿…é¡»ä»¥åˆ†å·ç»“æŸï¼Œæ¯æ¡SQL è¯­å¥å¯ä»¥å†™æˆå¤šè¡Œçš„å½¢å¼ï¼ŒåŒæ ·å¿…é¡»ä½¿ç”¨åˆ†å·æ¥ç»“æŸã€‚å¦å¤–ï¼Œä¸€è¡Œä¸­ä¹Ÿå¯ä»¥æœ‰å¤šæ¡SQL è¯­å¥ï¼Œä½†æ˜¯å®ƒä»¬ä¹‹é—´å¿…é¡»ä»¥åˆ†å·åˆ†éš”ã€‚æ¯”å¦‚ï¼š12345678910111213141516SQL&gt; set serveroutput onSQL&gt; declare a int:=100; b int:=200; c number; begin c:=(a+b)/(a-b); dbms_output.put_line(c); exception when zero_divide then dbms_output.put_line('é™¤æ•°ä¸èƒ½ä¸ºé›¶'); end; /-3PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚å…¶ä¸­ï¼Œâ€œset serveroutput onâ€å‘½ä»¤æ¥å®žçŽ°åœ¨æœåŠ¡ç«¯æ˜¾ç¤ºæ‰§è¡Œç»“æžœï¼›â€œdbms_output.put_line(c);â€è¯­å¥ç”¨äºŽè¾“å‡ºä¿¡æ¯ã€‚æ•°æ®ç±»åž‹åŸºæœ¬æ•°æ®ç±»åž‹1.æ•°å€¼ç±»åž‹æ•°å€¼ç±»åž‹ä¸»è¦åŒ…æ‹¬NUMBERã€PLS_INTEGER å’ŒBINARY_INTEGER 3 ç§åŸºæœ¬ç±»åž‹ã€‚å…¶ä¸­ï¼ŒNUMBER ç±»åž‹çš„å˜é‡å¯ä»¥å­˜å‚¨æ•´æ•°æˆ–æµ®ç‚¹æ•°ï¼›è€ŒBINARY_INTEGERæˆ–PLS_INTEGER ç±»åž‹çš„å˜é‡åªå­˜å‚¨æ•´æ•°ã€‚NUMBER ç±»åž‹è¿˜å¯ä»¥é€šè¿‡NUMBER(P,S)çš„å½¢å¼æ¥æ ¼å¼åŒ–æ•°å­—ï¼Œå…¶ä¸­ï¼Œå‚æ•°Pè¡¨ç¤ºç²¾åº¦ï¼Œå‚æ•°Sè¡¨ç¤ºåˆ»åº¦èŒƒå›´ã€‚ç²¾åº¦æ˜¯æŒ‡æ•°å€¼ä¸­æ‰€æœ‰æœ‰æ•ˆæ•°å­—çš„ä¸ªæ•°ã€‚æ¯”å¦‚ï¼š1money number(9,2);2.å­—ç¬¦ç±»åž‹å­—ç¬¦ç±»åž‹ä¸»è¦åŒ…æ‹¬ VARCHAR2ã€CHARã€LONGã€NCHAR å’ŒNVARCHAR2 ç­‰ã€‚è¿™äº›ç±»åž‹çš„å˜é‡ç”¨æ¥å­˜å‚¨å­—ç¬¦ä¸²æˆ–å­—ç¬¦æ•°æ®ã€‚VARCHAR2 ç±»åž‹ï¼šç”¨äºŽå­˜å‚¨å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œå…¶è¯­æ³•æ ¼å¼ä¸ºï¼š1VARCHAR2(maxlength)å‚æ•° maxlengthè¡¨ç¤ºå¯ä»¥å­˜å‚¨å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ï¼Œmaxlengthçš„æœ€å¤§å€¼å¯ä»¥æ˜¯32767 å­—èŠ‚ã€‚CHAR ç±»åž‹ï¼šCHAR ç±»åž‹è¡¨ç¤ºæŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œå…¶è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š1CHAR(maxlength)å‚æ•° maxlength æ˜¯æŒ‡å¯å­˜å‚¨å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œæœ€å¤§ä¸º32767å­—èŠ‚ï¼ŒCHAR ç±»åž‹çš„é»˜è®¤æœ€å¤§é•¿åº¦ä¸º1å­—èŠ‚ã€‚LONG ç±»åž‹ï¼šLONG ç±»åž‹è¡¨ç¤ºä¸€ä¸ªå¯å˜çš„å­—ç¬¦ä¸²ï¼Œæœ€å¤§é•¿åº¦æ˜¯32767 å­—èŠ‚ã€‚NCHAR å’ŒNVARCHAR2ç±»åž‹ï¼šè¿™ä¸¤ç§æ•°æ®ç±»åž‹çš„é•¿åº¦è¦æ ¹æ®å„å›½å­—ç¬¦é›†æ¥ç¡®å®šï¼Œåªèƒ½å…·ä½“æƒ…å†µå…·ä½“åˆ†æžã€‚3.æ—¥æœŸç±»åž‹æ—¥æœŸç±»åž‹åªæœ‰ä¸€ç§â€”â€”DATE ç±»åž‹ï¼Œç”¨æ¥å­˜å‚¨æ—¥æœŸå’Œæ—¶é—´ä¿¡æ¯ï¼ŒDATEç±»åž‹çš„å­˜å‚¨ç©ºé—´æ˜¯7ä¸ªå­—èŠ‚ï¼Œåˆ†åˆ«ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚å­˜å‚¨ä¸–çºªã€å¹´ã€æœˆã€å¤©ã€å°æ—¶ã€åˆ†é’Ÿå’Œç§’ã€‚4.å¸ƒå°”ç±»åž‹å¸ƒå°”ç±»åž‹ä¹Ÿåªæœ‰ä¸€ç§â€”â€”BOOLEANç±»åž‹ï¼Œå…¶å˜é‡å€¼å¯ä»¥æ˜¯TRUEã€FALSE æˆ–NULL ä¸­çš„ä¸€ç§ã€‚ç‰¹æ®Šæ•°æ®ç±»åž‹1.%TYPE ç±»åž‹ä½¿ç”¨%TYPEå…³é”®å­—å¯ä»¥å£°æ˜Žä¸€ä¸ªä¸ŽæŒ‡å®šåˆ—åç§°ç›¸åŒçš„æ•°æ®ç±»åž‹ï¼Œæ¯”å¦‚å£°æ˜Žä¸€ä¸ªä¸Ž emp è¡¨ä¸­job åˆ—çš„æ•°æ®ç±»åž‹å®Œå…¨ç›¸åŒçš„å˜é‡var_jobï¼š1declare var_job emp.job%type;å¦‚æžœemp.job åˆ—çš„æ•°æ®ç±»åž‹ä¸ºVARCHAR2(10)ï¼Œé‚£ä¹ˆå˜é‡var_job çš„æ•°æ®ç±»åž‹ä¹Ÿæ˜¯ VARCHAR2(10)ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨%type ç±»åž‹çš„å˜é‡è¾“å‡ºemp è¡¨ä¸­ç¼–å·ä¸º7369 çš„å‘˜å·¥åç§°å’ŒèŒåŠ¡ä¿¡æ¯ï¼š1234567891011121314SQL&gt; set serveroutput onSQL&gt; declare var_ename scott.emp.ename%type; var_job scott.emp.job%type; begin select ename,job into var_ename,var_job from scott.emp where empno=7369; dbms_output.put_line(var_ename||'çš„èŒåŠ¡æ˜¯'||var_job); end; /SMITHçš„èŒåŠ¡æ˜¯CLERKPL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚ç”±äºŽintoå­å¥ä¸­çš„å˜é‡åªèƒ½å­˜å‚¨ä¸€ä¸ªå•ç‹¬çš„å€¼ï¼Œæ‰€ä»¥è¦æ±‚select å­å¥åªèƒ½è¿”å›žä¸€è¡Œæ•°æ®ã€‚è‹¥SELECTå­å¥è¿”å›žå¤šè¡Œæ•°æ®ï¼Œåˆ™ä»£ç è¿è¡ŒåŽä¼šè¿”å›žé”™è¯¯ä¿¡æ¯ã€‚2.RECORD ç±»åž‹RECORD ç±»åž‹ä¹Ÿç§°ä½œâ€œè®°å½•ç±»åž‹â€ï¼Œå­˜å‚¨ç”±å¤šä¸ªåˆ—å€¼ç»„æˆçš„ä¸€è¡Œæ•°æ®ã€‚è¯­æ³•ç»“æž„å¦‚ä¸‹ï¼š12345type record_type is record(var_member1 data_type [not null] [:=default_value],â€¦var_membern data_type [not null] [:=default_value])æ¯”å¦‚ï¼Œå£°æ˜Žä¸€ä¸ªè®°å½•ç±»åž‹emp_typeï¼Œç„¶åŽä½¿ç”¨è¯¥ç±»åž‹çš„å˜é‡å­˜å‚¨empè¡¨ä¸­çš„ä¸€æ¡è®°å½•ä¿¡æ¯ï¼Œå¹¶è¾“å‡ºè¿™æ¡è®°å½•ä¿¡æ¯ï¼š12345678910111213141516171819SQL&gt; set serveroutput onSQL&gt; declare type emp_type is record ( var_ename varchar2(20), var_job varchar2(20), var_sal number ); empinfo emp_type; begin select ename,job,sal into empinfo from scott.emp where empno=7369; dbms_output.put_line('é›‡å‘˜'||empinfo.var_ename||'çš„èŒåŠ¡æ˜¯'||empinfo.var_job||'ï¼Œå·¥èµ„æ˜¯'||empinfo.var_sal); end; /é›‡å‘˜SMITHçš„èŒåŠ¡æ˜¯CLERKï¼Œå·¥èµ„æ˜¯800PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚3.%ROWTYPE ç±»åž‹%ROWTYPE ç±»åž‹çš„å˜é‡ç»“åˆäº†%TYPE ç±»åž‹å’ŒRECORD ç±»åž‹å˜é‡çš„ä¼˜ç‚¹ï¼Œå®ƒå¯ä»¥æ ¹æ®æ•°æ®è¡¨ä¸­è¡Œçš„ç»“æž„å®šä¹‰ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç±»åž‹ï¼Œç”¨æ¥å­˜å‚¨ä»Žæ•°æ®è¡¨ä¸­æ£€ç´¢åˆ°çš„ä¸€è¡Œæ•°æ®ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1rowVar_name table_name%rowtype;ä½¿ç”¨%ROWTYPEæ”¹é€ ä¸Šä¸ªRECORDç±»åž‹çš„ä¾‹å­ï¼š123456789101112SQL&gt; set serveroutput onSQL&gt; declare row_emp scott.emp%rowtype; begin select * into row_emp from scott.emp where empno=7369; dbms_output.put_line('é›‡å‘˜'||row_emp.ename||'çš„èŒåŠ¡æ˜¯'||row_emp.job||'ï¼Œå·¥èµ„æ˜¯'||row_emp.sal); end; /é›‡å‘˜SMITHçš„èŒåŠ¡æ˜¯CLERKï¼Œå·¥èµ„æ˜¯800PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚å˜é‡ä¸Žå¸¸é‡å®šä¹‰å˜é‡å®šä¹‰å˜é‡çš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š1&lt;å˜é‡å&gt; &lt;æ•°æ®ç±»åž‹&gt; [(é•¿åº¦):=&lt;åˆå§‹å€¼&gt;];æ¯”å¦‚ï¼š å®šä¹‰ä¸€ä¸ªç”¨äºŽå­˜å‚¨å›½å®¶åç§°çš„å¯å˜å­—ç¬¦ä¸²å˜é‡ var_countrynameï¼Œè¯¥å˜é‡çš„æœ€å¤§é•¿åº¦ æ˜¯50ï¼Œå¹¶ä¸”è¯¥å˜é‡çš„åˆå§‹å€¼ä¸ºâ€œä¸­å›½â€ï¼š1var_countryname varchar2(50):='ä¸­å›½';å®šä¹‰å¸¸é‡å®šä¹‰å¸¸é‡çš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š1&lt;å¸¸é‡å&gt; constant &lt;æ•°æ®ç±»åž‹&gt;:=&lt;å¸¸é‡å€¼&gt;;å®šä¹‰ä¸€ä¸ªå¸¸é‡con_dayï¼Œç”¨æ¥å­˜å‚¨ä¸€å¹´çš„å¤©æ•°ï¼š1con_day constant integer:=365;æµç¨‹æŽ§åˆ¶ifâ€¦thenè¯­å¥å…¶è¯­æ³•å¦‚ä¸‹ï¼š123if &lt; condition_expression&gt; then plsql_sentenceend if;å¦‚æžœ if åŽé¢çš„æ¡ä»¶è¡¨è¾¾å¼å­˜åœ¨â€œå¹¶ä¸”â€ã€â€œæˆ–è€…â€ã€â€œéžâ€ç­‰é€»è¾‘è¿ç®—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨â€œandâ€ã€â€œorâ€ã€â€œnotâ€ç­‰é€»è¾‘è¿ç®—ç¬¦ã€‚å¦å¤–ï¼Œå¦‚æžœè¦åˆ¤æ–­ifåŽé¢çš„æ¡ä»¶è¡¨è¾¾å¼çš„å€¼ä¸ºç©ºå€¼ï¼Œåˆ™éœ€è¦åœ¨æ¡ä»¶è¡¨è¾¾å¼ä¸­ä½¿ç”¨â€œisâ€å’Œâ€œnullâ€å…³é”®å­—ã€‚ifâ€¦thenâ€¦elseè¯­å¥å…¶è¯­æ³•å¦‚ä¸‹ï¼š12345if &lt;condition_expression&gt; then plsql_sentence1;else plsql_sentence2;end if;ifâ€¦thenâ€¦elsifè¯­å¥å…¶è¯­æ³•å¦‚ä¸‹ï¼š12345678if &lt; condition_expression1 &gt; then plsql_sentence_1;elsif &lt; condition_expression2 &gt; then plsql_sentence_2; ...else plsql_sentence_n;end if;caseè¯­å¥å…¶è¯­æ³•å¦‚ä¸‹ï¼š12345678910case &lt; selector&gt; when &lt;expression_1&gt; then plsql_sentence_1; when &lt;expression_2&gt; then plsql_sentence_2; ... when &lt;expression_n&gt; then plsql_sentence_n; [else plsql_sentence;]end case;loopè¯­å¥loop è¯­å¥ä¼šå…ˆæ‰§è¡Œä¸€æ¬¡å¾ªçŽ¯ä½“ï¼Œç„¶åŽå†åˆ¤æ–­â€œexit whenâ€å…³é”®å­—åŽé¢çš„æ¡ä»¶è¡¨è¾¾å¼çš„å€¼æ˜¯true è¿˜æ˜¯falseï¼Œå¦‚æžœæ˜¯trueï¼Œåˆ™ç¨‹åºä¼šé€€å‡ºå¾ªçŽ¯ä½“ï¼Œå¦åˆ™ç¨‹åºå°†å†æ¬¡æ‰§è¡Œå¾ªçŽ¯ä½“ï¼Œè¿™æ ·å°±ä½¿å¾—ç¨‹åºè‡³å°‘èƒ½å¤Ÿæ‰§è¡Œä¸€æ¬¡å¾ªçŽ¯ä½“ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1234loop plsql_sentence; exit when end_condition_ exp;end loop;æ¯”å¦‚è®¡ç®—1åˆ°100è‡ªç„¶æ•°çš„å’Œï¼š12345678910111213141516SQL&gt; set serveroutput onSQL&gt; declare sum_i int:=0; i int:=0; begin loop i:=i+1; sum_i:=sum_i+i; exit when i&gt;=100; end loop; dbms_output.put_line('è‡ªç„¶æ•°1åˆ°100çš„å’Œä¸ºï¼š'||sum_i); end; /è‡ªç„¶æ•°1åˆ°100çš„å’Œä¸ºï¼š5050PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚whileè¯­å¥è¯­æ³•å¦‚ä¸‹ï¼š123while condition_expression loop plsql_sentence;end loop;ä½¿ç”¨ while è¯­å¥æ±‚å¾—å‰100 ä¸ªè‡ªç„¶æ•°çš„å’Œï¼š123456789101112131415SQL&gt; set serveroutput onSQL&gt; declare sum_i int:=0; i int:=0; begin while i&lt;=99 loop i:=i+1; sum_i:=sum_i+i; end loop; dbms_output.put_line('è‡ªç„¶æ•°1åˆ°100çš„å’Œä¸ºï¼š'||sum_i); end; /è‡ªç„¶æ•°1åˆ°100çš„å’Œä¸ºï¼š5050PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚forè¯­å¥è¯­æ³•å¦‚ä¸‹ï¼š123for variable_ counter_name in [reverse] lower_limit..upper_limit loop plsql_sentence;end loop;variable_ counter_nameï¼šè¡¨ç¤ºä¸€ä¸ªå˜é‡ï¼Œé€šå¸¸ä¸ºæ•´æ•°ç±»åž‹ï¼Œç”¨æ¥ä½œä¸ºè®¡æ•°å™¨ã€‚é»˜è®¤æƒ…å†µä¸‹è®¡æ•°å™¨çš„å€¼ä¼šå¾ªçŽ¯é€’å¢žï¼Œå½“åœ¨å¾ªçŽ¯ä¸­ä½¿ç”¨reverseå…³é”®å­—æ—¶ï¼Œè®¡æ•°å™¨çš„å€¼ä¼šéšå¾ªçŽ¯é€’å‡ã€‚lower_limitï¼šè®¡æ•°å™¨çš„ä¸‹é™å€¼ï¼Œå½“è®¡æ•°å™¨çš„å€¼å°äºŽä¸‹é™å€¼æ—¶ï¼Œç¨‹åºç»ˆæ­¢forå¾ªçŽ¯ã€‚upper_limitï¼šè®¡æ•°å™¨çš„ä¸Šé™å€¼ï¼Œå½“è®¡æ•°å™¨çš„å€¼å¤§äºŽä¸Šé™å€¼æ—¶ï¼Œç¨‹åºç»ˆæ­¢forå¾ªçŽ¯ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨ for è¯­å¥æ±‚å¾—å‰100 ä¸ªè‡ªç„¶æ•°ä¸­å¥‡æ•°ä¹‹å’Œï¼Œ12345678910111213141516SQL&gt; set serveroutput onSQL&gt; declare i int:=0; sum_i int:=0; begin for i in reverse 1..100 loop if mod(i,2)!=0 then sum_i:=sum_i+i; end if; end loop; dbms_output.put_line('è‡ªç„¶æ•°1åˆ°100çš„å¥‡æ•°å’Œä¸ºï¼š'||sum_i); end; /è‡ªç„¶æ•°1åˆ°100çš„å¥‡æ•°å’Œä¸ºï¼š2500PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚åœ¨ä¸Šé¢çš„for è¯­å¥ä¸­ï¼Œç”±äºŽä½¿ç”¨äº†å…³é”®å­—â€œreverseâ€ï¼Œè¡¨ç¤ºè®¡æ•°å™¨i çš„å€¼ä¸ºé€’å‡çŠ¶æ€ï¼Œå³i çš„åˆå§‹å€¼ä¸º100ï¼Œéšç€æ¯æ¬¡é€’å‡1ï¼Œæœ€åŽä¸€æ¬¡for å¾ªçŽ¯æ—¶i çš„å€¼å˜ä¸º1ã€‚å¦‚æžœåœ¨for è¯­å¥ä¸­ä¸ä½¿ç”¨å…³é”®å­—â€œreverseâ€ï¼Œåˆ™è¡¨ç¤ºè®¡æ•°å™¨i çš„å€¼ä¸ºé€’å¢žçŠ¶æ€ï¼Œå³i çš„åˆå§‹å€¼ä¸º1ã€‚æ¸¸æ ‡æ¸¸æ ‡åˆ†ä¸ºæ˜¾å¼æ¸¸æ ‡å’Œéšå¼æ¸¸æ ‡ã€‚æ˜¾å¼æ¸¸æ ‡æ˜¾å¼æ¸¸æ ‡æ˜¯ç”±ç”¨æˆ·å£°æ˜Žå’Œæ“ä½œçš„ä¸€ç§æ¸¸æ ‡ï¼Œé€šå¸¸ç”¨äºŽæ“ä½œæŸ¥è¯¢ç»“æžœé›†ï¼Œä½¿ç”¨å®ƒå¤„ç†æ•°æ®çš„æ­¥éª¤åŒ…æ‹¬ï¼šå£°æ˜Žæ¸¸æ ‡ã€æ‰“å¼€æ¸¸æ ‡ã€è¯»å–æ¸¸æ ‡å’Œå…³é—­æ¸¸æ ‡4ä¸ªæ­¥éª¤ã€‚1.å£°æ˜Žæ¸¸æ ‡å£°æ˜Žæ¸¸æ ‡ä¸»è¦åŒ…æ‹¬æ¸¸æ ‡åç§°å’Œä¸ºæ¸¸æ ‡æä¾›ç»“æžœé›†çš„ SELECT è¯­å¥ã€‚è¯­æ³•å¦‚ä¸‹ï¼š123cursor cur_name[(input_parameter1[,input_parameter2]â€¦)] [return ret_type]is select_ sentence;cur_nameï¼šè¡¨ç¤ºæ‰€å£°æ˜Žçš„æ¸¸æ ‡åç§°ã€‚ret_typeï¼šè¡¨ç¤ºæ‰§è¡Œæ¸¸æ ‡æ“ä½œåŽçš„è¿”å›žå€¼ç±»åž‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯é€‰é¡¹ã€‚select_ sentenceï¼šæ¸¸æ ‡æ‰€ä½¿ç”¨çš„SELECT è¯­å¥ï¼Œå®ƒä¸ºæ¸¸æ ‡çš„åå¤è¯»å–æä¾›äº†ç»“æžœé›†ã€‚input_parameter1ï¼šä½œä¸ºæ¸¸æ ‡çš„â€œè¾“å…¥å‚æ•°â€ï¼Œå¯ä»¥æœ‰å¤šä¸ªï¼Œè¿™æ˜¯ä¸€ä¸ªå¯é€‰é¡¹ã€‚æ¯”å¦‚å£°æ˜Žä¸€ä¸ªæ¸¸æ ‡ï¼Œç”¨æ¥è¯»å–emp è¡¨ä¸­èŒåŠ¡ä¸ºé”€å”®å‘˜ï¼ˆSALESMANï¼‰çš„é›‡å‘˜ä¿¡æ¯ï¼š12345SQL&gt; declare cursor cur_emp(var_job in varchar2:='SALESMAN') is select empno,ename,sal from emp where job=var_job;è¾“å…¥å‚æ•°var_jobç±»åž‹ä¸ºvarchar2ï¼Œä½†ä¸å¯ä»¥æŒ‡å®šé•¿åº¦ï¼Œå¦‚ï¼švarchar2(10)ï¼Œå¦åˆ™ç¨‹åºæŠ¥é”™ã€‚2.æ‰“å¼€æ¸¸æ ‡æ‰“å¼€æ¸¸æ ‡çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š1open cur_name[(para_value1[,para_value2]â€¦)];æ¯”å¦‚ï¼š1open cur_emp('MANAGER');ä¸Šé¢è¿™æ¡è¯­å¥è¡¨ç¤ºæ‰“å¼€æ¸¸æ ‡ cur_empï¼Œç„¶åŽç»™æ¸¸æ ‡çš„â€œè¾“å…¥å‚æ•°â€èµ‹å€¼ä¸ºâ€œMANAGERâ€ã€‚å½“ç„¶è¿™é‡Œå¯ä»¥çœç•¥â€œ(â€˜MANAGERâ€™)â€ï¼Œè¿™æ ·è¡¨ç¤ºâ€œè¾“å…¥å‚æ•°â€çš„å€¼ä»ç„¶ä½¿ç”¨å…¶åˆå§‹å€¼ï¼ˆå³SALESMANï¼‰ã€‚3.è¯»å–æ¸¸æ ‡å½“æ‰“å¼€ä¸€ä¸ªæ¸¸æ ‡ä¹‹åŽï¼Œå°±å¯ä»¥è¯»å–æ¸¸æ ‡ä¸­çš„æ•°æ®äº†å…¶è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š1fetch cur_name into &#123;variable&#125;;cur_nameï¼šè¦è¯»å–çš„æ¸¸æ ‡åç§°ã€‚variableï¼š%RECORDç±»åž‹æˆ–è€…%ROWTYPEç±»åž‹å˜é‡ã€‚4.å…³é—­æ¸¸æ ‡æ¸¸æ ‡ä½¿ç”¨å®Œæ¯•åŽéœ€è¦å…³é—­ï¼Œä»¥é‡Šæ”¾ç³»ç»Ÿèµ„æºï¼Œæ¯”å¦‚ SELECT è¯­å¥è¿”å›žçš„ç»“æžœé›†ç­‰ã€‚å®ƒçš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š1close cur_name;æ¸¸æ ‡çš„å±žæ€§æ— è®ºæ˜¯æ˜¾å¼æ¸¸æ ‡è¿˜æ˜¯éšå¼æ¸¸æ ‡ï¼Œéƒ½å…·æœ‰%foundã€%notfoundã€%isopen å’Œ%rowcount4ä¸ªå±žæ€§ï¼Œé€šè¿‡è¿™4ä¸ªå±žæ€§å¯ä»¥èŽ·çŸ¥SQLè¯­å¥çš„æ‰§è¡Œç»“æžœä»¥åŠè¯¥æ¸¸æ ‡çš„çŠ¶æ€ä¿¡æ¯ï¼š%foundï¼šå¸ƒå°”åž‹å±žæ€§ï¼Œå¦‚æžœSQL è¯­å¥è‡³å°‘å½±å“åˆ°ä¸€è¡Œæ•°æ®ï¼Œåˆ™è¯¥å±žæ€§ä¸ºtrueï¼Œå¦åˆ™ä¸ºfasleã€‚%notfoundï¼šå¸ƒå°”åž‹å±žæ€§ï¼Œä¸Ž%found å±žæ€§çš„åŠŸèƒ½ç›¸åã€‚%rowcountï¼šæ•°å­—åž‹å±žæ€§ï¼Œè¿”å›žå—SQL è¯­å¥å½±å“çš„è¡Œæ•°ã€‚%isopenï¼šå¸ƒå°”åž‹å±žæ€§ï¼Œå½“æ¸¸æ ‡å·²ç»æ‰“å¼€æ—¶è¿”å›žtrueï¼Œæ¸¸æ ‡å…³é—­æ—¶åˆ™ä¸ºfalseã€‚ä¸‹é¢ä¸¾ä¸ªä½¿ç”¨æ˜¾å¼æ¸¸æ ‡çš„ä¾‹å­ï¼š12345678910111213141516171819202122SQL&gt; set serveroutput onSQL&gt; declare cursor cur_emp(var_job in varchar2:='SALESMAN') is select * from scott.emp where job=var_job; row_emp scott.emp%rowtype; begin open cur_emp; fetch cur_emp into row_emp; //å…ˆè®©æŒ‡é’ˆæŒ‡å‘ç»“æžœé›†ä¸­çš„ç¬¬ä¸€è¡Œï¼Œå¹¶å°†å€¼ä¿å­˜åˆ°row_empä¸­ while cur_emp%found loop dbms_output.put_line('é›‡å‘˜'||row_emp.ename||'çš„ç¼–å·æ˜¯'||row_emp.empno||'ï¼Œå·¥èµ„æ˜¯ï¼š'||row_emp.sal); fetch cur_emp into row_emp; //è®©æŒ‡é’ˆæŒ‡å‘ç»“æžœé›†ä¸­çš„ä¸‹ä¸€è¡Œï¼Œå¹¶å°†å€¼ä¿å­˜åˆ°row_empä¸­ end loop; close cur_emp; end; /é›‡å‘˜ALLENçš„ç¼–å·æ˜¯7499ï¼Œå·¥èµ„æ˜¯ï¼š1600é›‡å‘˜WARDçš„ç¼–å·æ˜¯7521ï¼Œå·¥èµ„æ˜¯ï¼š1250é›‡å‘˜MARTINçš„ç¼–å·æ˜¯7654ï¼Œå·¥èµ„æ˜¯ï¼š1250é›‡å‘˜TURNERçš„ç¼–å·æ˜¯7844ï¼Œå·¥èµ„æ˜¯ï¼š1500PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚éšå¼æ¸¸æ ‡åœ¨æ‰§è¡Œä¸€ä¸ª SQL è¯­å¥æ—¶ï¼ŒOracle ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªéšå¼æ¸¸æ ‡ã€‚è¿™ä¸ªæ¸¸æ ‡æ˜¯å†…å­˜ä¸­å¤„ç†è¯¥è¯­å¥çš„å·¥ä½œåŒºåŸŸã€‚éšå¼æ¸¸æ ‡ä¸»è¦æ˜¯å¤„ç†æ•°æ®æ“çºµè¯­å¥ï¼ˆå¦‚UPDATEã€DELETE è¯­å¥ï¼‰çš„æ‰§è¡Œç»“æžœï¼Œå½“ç„¶ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥å¤„ç†SELECT è¯­å¥çš„æŸ¥è¯¢ç»“æžœã€‚ç”±äºŽéšå¼æ¸¸æ ‡ä¹Ÿæœ‰å±žæ€§ï¼Œå½“ä½¿ç”¨éšå¼æ¸¸æ ‡çš„å±žæ€§æ—¶ï¼Œéœ€è¦åœ¨å±žæ€§å‰é¢åŠ ä¸Šéšå¼æ¸¸æ ‡çš„é»˜è®¤åç§°â€”â€”sqlã€‚åœ¨å®žé™…çš„ PL/SQL ç¼–ç¨‹ä¸­ï¼Œç»å¸¸ä½¿ç”¨éšå¼æ¸¸æ ‡æ¥åˆ¤æ–­æ›´æ–°æ•°æ®è¡Œæˆ–åˆ é™¤æ•°æ®è¡Œçš„æƒ…å†µã€‚æ¯”å¦‚æŠŠscott.empè¡¨ä¸­é”€å”®å‘˜ï¼ˆå³SALESMANï¼‰çš„å·¥èµ„ä¸Šè°ƒ20%ï¼Œç„¶åŽä½¿ç”¨éšå¼æ¸¸æ ‡sqlçš„%rowcountå±žæ€§è¾“å‡ºä¸Šè°ƒå·¥èµ„çš„å‘˜å·¥æ•°é‡ï¼š1234567891011121314SQL&gt; set serveroutput onSQL&gt; begin update scott.emp set sal=sal*1.2 where job='SALESMAN'; if sql%notfound then dbms_output.put_line('æ²¡æœ‰é›‡å‘˜éœ€è¦ä¸Šè°ƒå·¥èµ„'); else dbms_output.put_line('æœ‰'||sql%rowcount||'ä¸ªé›‡å‘˜å·¥èµ„ä¸Šè°ƒ20%'); end if; end; /æœ‰4ä¸ªé›‡å‘˜å·¥èµ„ä¸Šè°ƒ20%PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚é€šè¿‡forè¯­å¥å¾ªçŽ¯æ¸¸æ ‡åœ¨ä½¿ç”¨éšå¼æ¸¸æ ‡æˆ–æ˜¾å¼æ¸¸æ ‡å¤„ç†å…·æœ‰å¤šè¡Œæ•°æ®çš„ç»“æžœé›†æ—¶ï¼Œç”¨æˆ·å¯ä»¥é…åˆforè¯­å¥æ¥å®Œæˆã€‚åœ¨ä½¿ç”¨forè¯­å¥éåŽ†æ¸¸æ ‡ä¸­çš„æ•°æ®æ—¶ï¼Œå¯ä»¥æŠŠå®ƒçš„è®¡æ—¶å™¨çœ‹åšä¸€ä¸ªè‡ªåŠ¨çš„RECORDç±»åž‹çš„å˜é‡ã€‚æ¯”å¦‚ä½¿ç”¨foréåŽ†ä¸€ä¸ªéšå¼æ¸¸æ ‡ï¼š12345678910111213SQL&gt; set serveroutput onSQL&gt; begin for emp_record in (select * from scott.emp where job='SALESMAN') loop dbms_output.put_line('é›‡å‘˜ç¼–å·ï¼š'||emp_record.empno||'ï¼Œé›‡å‘˜å§“åï¼š'||emp_record.ename||'ï¼Œå·¥èµ„ä¸ºï¼š'||emp_record); end loop; end; /é›‡å‘˜ç¼–å·ï¼š7499ï¼Œé›‡å‘˜å§“åï¼šALLENï¼Œå·¥èµ„ä¸ºï¼š1920é›‡å‘˜ç¼–å·ï¼š7521ï¼Œé›‡å‘˜å§“åï¼šWARDï¼Œå·¥èµ„ä¸ºï¼š1500é›‡å‘˜ç¼–å·ï¼š7654ï¼Œé›‡å‘˜å§“åï¼šMARTINï¼Œå·¥èµ„ä¸ºï¼š1500é›‡å‘˜ç¼–å·ï¼š7844ï¼Œé›‡å‘˜å§“åï¼šTURNERï¼Œå·¥èµ„ä¸ºï¼š1800PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚å¼‚å¸¸åœ¨ç¼–å†™PL/SQLç¨‹åºæ—¶ï¼Œé¿å…ä¸äº†ä¼šå‘ç”Ÿä¸€äº›å¼‚å¸¸ã€‚Oracle ç³»ç»Ÿå¼‚å¸¸åˆ†ä¸ºé¢„å®šä¹‰å¼‚å¸¸å’Œè‡ªå®šä¹‰å¼‚å¸¸ã€‚é¢„å®šä¹‰å¼‚å¸¸Oracleç³»ç»Ÿå¸¸è§çš„é¢„å®šä¹‰å¼‚å¸¸åŠå…¶è¯´æ˜Žå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šç³»ç»Ÿé¢„å®šä¹‰å¼‚å¸¸è¯´æ˜ŽZERO_DIVIDEé™¤æ•°ä¸ºé›¶æ—¶å¼•å‘çš„å¼‚å¸¸ACCESS_INTO_NULLä¼å›¾ä¸ºæŸä¸ªæœªåˆå§‹åŒ–å¯¹è±¡çš„å±žæ€§èµ‹å€¼COLLECTION_IS_NULLä¼å›¾ä½¿ç”¨æœªåˆå§‹åŒ–çš„é›†åˆå…ƒç´ CURSOR_ALREADY_OPENä¼å›¾å†æ¬¡æ‰“å¼€ä¸€ä¸ªå·²ç»æ‰“å¼€è¿‡çš„æ¸¸æ ‡ï¼Œä½†åœ¨é‡æ–°æ‰“å¼€ä¹‹å‰ï¼Œæ¸¸æ ‡æœªå…³é—­INVALID_CURSORæ‰§è¡Œä¸€ä¸ªéžæ³•çš„æ¸¸æ ‡æ“ä½œï¼Œä¾‹å¦‚ï¼Œå…³é—­ä¸€ä¸ªæœªæ‰“å¼€çš„æ¸¸æ ‡INVALID_NUMBERä¼å›¾å°†ä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ªæ— æ•ˆçš„æ•°å­—è€Œå¤±è´¥LOGIN_DENIEDä¼å›¾ä½¿ç”¨æ— æ•ˆçš„ç”¨æˆ·åæˆ–å¯†ç è¿žæŽ¥æ•°æ®åº“NO_DATA_FOUNDSELECT INTO è¯­å¥æ²¡æœ‰è¿”å›žæ•°æ®ROWTYPE_MISMATCHä¸»æ¸¸æ ‡å˜é‡ä¸ŽPL/SQL æ¸¸æ ‡å˜é‡çš„è¿”å›žç±»åž‹ä¸å…¼å®¹SELF_IS_NULLä½¿ç”¨å¯¹è±¡ç±»åž‹æ—¶ï¼Œä½¿ç”¨ç©ºå¯¹è±¡è°ƒç”¨å…¶æ–¹æ³•SUBSCRIPT_BEYOND_COUNTå…ƒç´ ä¸‹æ ‡è¶…è¿‡åµŒå¥—è¡¨æˆ–VARRAY çš„æœ€å¤§å€¼SUBSCRIPT_OUTSIDE_LIMITä¼å›¾ä½¿ç”¨éžæ³•ç´¢å¼•å·å¼•ç”¨åµŒå¥—è¡¨æˆ–VARRAY ä¸­çš„å…ƒç´ SYS_INVALID_ROWIDå­—ç¬¦ä¸²å‘ROWID è½¬æ¢æ—¶çš„é”™è¯¯ï¼Œå› ä¸ºè¯¥å­—ç¬¦ä¸²ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ROWID å€¼TIMEOUT_ON_RESOURCEOracle åœ¨ç­‰å¾…èµ„æºæ—¶è¶…æ—¶TOO_MANY_ROWSæ‰§è¡ŒSELECT INTO è¯­å¥æ—¶ï¼Œç»“æžœé›†è¶…è¿‡ä¸€è¡Œå¼•å‘çš„å¼‚å¸¸æ¯”å¦‚ï¼š1234567891011121314151617181920SQL&gt; set serveroutput onSQL&gt; declare var_empno number; var_ename varchar2(50); begin select empno,ename into var_empno,var_ename from scott.emp where deptno=10; if sql%found then dbms_output.put_line('é›‡å‘˜ç¼–å·ï¼š'||var_empno); end if; exception when too_many_rows then dbms_output.put_line('è¿”å›žè®°å½•è¶…è¿‡ä¸€è¡Œ'); when no_data_found then dbms_output.put_line('æ— æ•°æ®'); end; /è¿”å›žè®°å½•è¶…è¿‡ä¸€è¡ŒPL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚è‡ªå®šä¹‰å¼‚å¸¸Oracleçš„è‡ªå®šä¹‰å¼‚å¸¸å°±å¯ä»¥åˆ†ä¸ºé”™è¯¯ç¼–å·å¼‚å¸¸å’Œä¸šåŠ¡é€»è¾‘å¼‚å¸¸ä¸¤ç§ã€‚1.é”™è¯¯ç¼–å·å¼‚å¸¸é”™è¯¯ç¼–å·å¼‚å¸¸æ˜¯æŒ‡åœ¨Oracleç³»ç»Ÿå‘ç”Ÿé”™è¯¯æ—¶ï¼Œç³»ç»Ÿä¼šæ˜¾ç¤ºé”™è¯¯ç¼–å·å’Œç›¸å…³æè¿°ä¿¡æ¯çš„å¼‚å¸¸ï¼Œæ¯”å¦‚ï¼š12345SQL&gt; insert into scott.dept values(10,'å¼€å‘ä¸€éƒ¨','ç¦å·ž');insert into scott.dept values(10,'å¼€å‘ä¸€éƒ¨','ç¦å·ž')*ç¬¬ 1 è¡Œå‡ºçŽ°é”™è¯¯:ORA-00001: è¿åå”¯ä¸€çº¦æŸæ¡ä»¶ (SCOTT.PK_DEPT)å¯¹äºŽè¿™ç§å¼‚å¸¸ï¼Œé¦–å…ˆåœ¨PL/SQLå—çš„å£°æ˜Žéƒ¨åˆ†ï¼ˆDECLARE éƒ¨åˆ†ï¼‰ä½¿ç”¨EXCEPTIONç±»åž‹å®šä¹‰ä¸€ä¸ªå¼‚å¸¸å˜é‡åï¼Œç„¶åŽä½¿ç”¨è¯­å¥PRAGMA EXCEPTION_INITä¸ºâ€œé”™è¯¯ç¼–å·â€å…³è”è¿™ä¸ªå¼‚å¸¸å˜é‡åï¼ŒæŽ¥ä¸‹æ¥å°±å¯ä»¥åƒå¯¹å¾…ç³»ç»Ÿé¢„å®šä¹‰å¼‚å¸¸ä¸€æ ·å¤„ç†äº†ã€‚æ¯”å¦‚ï¼š1234567891011121314SQL&gt; set serveroutput onSQL&gt; declare primary_iterant exception; pragma exception_init(primary_iterant,-00001); begin insert into scott.dept values(10,'å¼€å‘ä¸€éƒ¨','ç¦å·ž'); exception when primary_iterant then dbms_output.put_line('ä¸»é”®é‡å¤ï¼'); end; /ä¸»é”®é‡å¤ï¼PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚2.ä¸šåŠ¡å¼‚å¸¸ç¨‹åºå¼€å‘äººå‘˜å¯ä»¥æ ¹æ®å…·ä½“çš„ä¸šåŠ¡é€»è¾‘è§„åˆ™è‡ªå®šä¹‰ä¸€ä¸ªå¼‚å¸¸ã€‚ä¸šåŠ¡é€»è¾‘å¼‚å¸¸æ˜¯Oracleç³»ç»Ÿæœ¬èº«æ— æ³•çŸ¥é“çš„ï¼Œè¿™æ ·å°±éœ€è¦æœ‰ä¸€ä¸ªå¼•å‘å¼‚å¸¸çš„æœºåˆ¶ï¼Œå¼•å‘ä¸šåŠ¡é€»è¾‘å¼‚å¸¸é€šå¸¸ä½¿ç”¨RAISE è¯­å¥æ¥å®žçŽ°ã€‚æ¯”å¦‚ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªå¼‚å¸¸å˜é‡ï¼Œåœ¨å‘deptè¡¨ä¸­æ’å…¥æ•°æ®æ—¶ï¼Œè‹¥åˆ¤æ–­locå­—æ®µçš„å€¼ä¸ºnullï¼Œåˆ™ä½¿ç”¨raiseè¯­å¥å¼•å‘å¼‚å¸¸ï¼š123456789101112131415161718192021SQL&gt; set serveroutput onSQL&gt; declare null_exception exception; dept_row scott.dept%rowtype; begin dept_row.deptno:=66; dept_row.dname:='å¼€å‘äºŒéƒ¨'; insert into scott.dept values(dept_row.deptno,dept_row.dname,dept_row.loc); if dept_row.loc is null then raise null_exception; end if; exception when null_exception then dbms_output.put_line('locå­—æ®µä¸èƒ½ä¸ºç©ºï¼'); rollback; end; /locå­—æ®µä¸èƒ½ä¸ºç©ºï¼PL/SQL è¿‡ç¨‹å·²æˆåŠŸå®Œæˆã€‚]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracle SQLPluså‘½ä»¤]]></title>
    <url>%2FOracle-SQLPlus%E5%91%BD%E4%BB%A4.html</url>
    <content type="text"><![CDATA[SQLPlusæ˜¯ä¸€ä¸ªè¢«DBAå’Œå¼€å‘äººå‘˜å¹¿æ³›ä½¿ç”¨çš„åŠŸèƒ½å¼ºå¤§çš„Oracleå·¥å…·ï¼Œå¯ä»¥åœ¨å„ä¸ªå¹³å°ä¸Šæ‹¥æœ‰æ“ä½œçš„ä¸€è‡´æ€§ã€‚SQLPluså¯ä»¥æ‰§è¡Œè¾“å…¥çš„SQLè¯­å¥å’ŒSQLæ–‡ä»¶ï¼Œé€šè¿‡SQLPluså¯ä»¥å’Œæ•°æ®åº“è¿›è¡Œå¯¹è¯ã€‚ä»¥ä¸‹ä¾‹å­åŸºäºŽOracle 11gã€‚setå‘½ä»¤è®¾ç½®è¿è¡ŒçŽ¯å¢ƒåœ¨Oracle 11gä¸­ï¼Œå¯ä»¥ä½¿ç”¨setå‘½ä»¤æ¥è®¾ç½®SQLPlusçš„è¿è¡ŒçŽ¯å¢ƒã€‚setå‘½ä»¤è¯­æ³•å¦‚ä¸‹ï¼š1set variable valuevariableä¸ºå˜é‡åï¼Œvalueä¸ºå˜é‡å€¼ã€‚ä¸‹é¢ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„setå˜é‡ã€‚pagesizeå˜é‡pagesizeå˜é‡ç”¨æ¥è®¾ç½®ä»Žé¡¶éƒ¨æ ‡é¢˜åˆ°é¡µç»“æŸè¡Œï¼ˆåŒ…å«é¡µé¦–çš„ç©ºè¡Œï¼‰ä¹‹é—´çš„è¡Œæ•°ã€‚pagesizeçš„é»˜è®¤å€¼ä¸º14ï¼š12SQL&gt; show pagesizepagesize 14ä½¿ç”¨set pagesizeå‘½ä»¤ä¿®æ”¹ä¸€é¡µçš„è¡Œæ•°ä¸º18ï¼š1234567891011121314151617181920SQL&gt; set pagesize 18;SQL&gt; select user_id,username,account_status from dba_users; USER_ID USERNAME ACCOUNT_STATUS---------- ------------------------------ -------------------------------- 74 MGMT_VIEW OPEN 0 SYS OPEN 5 SYSTEM OPEN 30 DBSNMP OPEN 72 SYSMAN OPEN 84 SCOTT OPEN 9 OUTLN EXPIRED &amp; LOCKED 75 FLOWS_FILES EXPIRED &amp; LOCKED 57 MDSYS EXPIRED &amp; LOCKED 53 ORDSYS EXPIRED &amp; LOCKED 42 EXFSYS EXPIRED &amp; LOCKED 32 WMSYS EXPIRED &amp; LOCKED 31 APPQOSSYS EXPIRED &amp; LOCKED 78 APEX_030200 EXPIRED &amp; LOCKED 83 OWBSYS_AUDIT EXPIRED &amp; LOCKEDå¯æ‰‹åŠ¨æ•°ä¸€ä¸‹æ˜¯ä¸æ˜¯18è¡Œ(lllï¿¢Ï‰ï¿¢)ã€‚newpageå˜é‡è¯¥å˜é‡ç”¨äºŽè®¾ç½®ä¸€é¡µä¸­ç©ºè¡Œçš„æ•°é‡ï¼Œé»˜è®¤å€¼ä¸º1ï¼Œå¯ä»¥ä½¿ç”¨set newpageå‘½ä»¤æ”¹å˜è¯¥å€¼ï¼š12345678910111213141516171819202122SQL&gt; show newpagenewpage 1SQL&gt; set newpage 5SQL&gt; select user_id,username,account_status from dba_users; USER_ID USERNAME ACCOUNT_STATUS---------- ------------------------------ -------------------------------- 74 MGMT_VIEW OPEN 0 SYS OPEN 5 SYSTEM OPEN 30 DBSNMP OPEN 72 SYSMAN OPEN 84 SCOTT OPEN 9 OUTLN EXPIRED &amp; LOCKED 75 FLOWS_FILES EXPIRED &amp; LOCKED 57 MDSYS EXPIRED &amp; LOCKED 53 ORDSYS EXPIRED &amp; LOCKED 42 EXFSYS EXPIRED &amp; LOCKEDlinesizeå˜é‡è¯¥å˜é‡ç”¨äºŽè®¾ç½®SQLPlusçŽ¯å¢ƒä¸­ä¸€è¡Œæ‰€æ˜¾ç¤ºçš„æœ€å¤šå­—ç¬¦æ€»æ•°ï¼Œé»˜è®¤å€¼ä¸º80ï¼Œå½“pagesizeè¿‡å°æ—¶ï¼Œæ•°æ®å°±ä¼šå‡ºçŽ°æŠ˜è¡Œæ˜¾ç¤ºçš„æƒ…å†µã€‚å¯ä»¥ä½¿ç”¨set linesizeå‘½ä»¤æ¥è°ƒæ•´linesizeçš„å€¼ï¼š123SQL&gt; show linesizelinesize 80SQL&gt; set linesize 120pauseå˜é‡ç”¨äºŽè®¾ç½®è¾“å‡ºç»“æžœç¿»é¡µæ—¶ï¼Œæ˜¯å¦æš‚åœï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š1set pause valuevalueå¯å–çš„å€¼æœ‰ï¼šoffï¼Œé»˜è®¤å€¼ï¼Œè¿”å›žç»“æžœä¸€æ¬¡æ€§è¾“å‡ºå®Œæ¯•ï¼Œä¸­é—´ç¿»é¡µä¸ä¼šæš‚åœï¼›onï¼Œè¡¨ç¤ºè¾“å‡ºç»“æžœçš„æ¯ä¸€é¡µéƒ½æš‚åœï¼Œç”¨æˆ·æŒ‰ENTERç»§ç»­ï¼›textï¼Œåœ¨è®¾ç½®ä¸ºonä¹‹åŽï¼Œç»§ç»­è®¾ç½®textçš„å€¼ï¼Œç”¨äºŽæš‚åœæ—¶æ˜¾ç¤ºï¼›æ¯”å¦‚ï¼š1234567891011121314151617181920212223SQL&gt; set pause onSQL&gt; set pause 'æŒ‰&lt;enter&gt;é”®ç»§ç»­'SQL&gt; select user_id,username,account_status from dba_users;æŒ‰&lt;enter&gt;é”®ç»§ç»­ USER_ID USERNAME ACCOUNT_STATUS---------- ------------------------------ -------------------------------- 74 MGMT_VIEW OPEN 0 SYS OPEN 5 SYSTEM OPEN 30 DBSNMP OPEN 72 SYSMAN OPEN 84 SCOTT OPEN 9 OUTLN EXPIRED &amp; LOCKED 75 FLOWS_FILES EXPIRED &amp; LOCKED 57 MDSYS EXPIRED &amp; LOCKED 53 ORDSYS EXPIRED &amp; LOCKED 42 EXFSYS EXPIRED &amp; LOCKED 32 WMSYS EXPIRED &amp; LOCKED 31 APPQOSSYS EXPIRED &amp; LOCKED 78 APEX_030200 EXPIRED &amp; LOCKED 83 OWBSYS_AUDIT EXPIRED &amp; LOCKEDæŒ‰&lt;enter&gt;é”®ç»§ç»­numformatå˜é‡è¯¥å˜é‡å€¼ç”¨äºŽè®¾ç½®æ˜¾ç¤ºæ•°å€¼çš„é»˜è®¤æ ¼å¼ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š1set numformat formatformatä¸ºæ•°å€¼æŽ©ç ï¼Œå¸¸ç”¨å€¼åŠå…¶è¯´æ˜Žå¦‚ä¸‹ï¼šæŽ©ç è¯´æ˜Žä¸¾ä¾‹9æŸ¥è¯¢ç»“æžœä¸­æ•°å­—æ›¿æ¢æ ¼å¼çš„æŽ©ç 9990æ ¼å¼ä¸­çš„æŽ©ç å±è”½æŽ‰æŸ¥è¯¢ç»“æžœä¸­çš„æ•°å­—999.00$åœ¨æŸ¥è¯¢ç»“æžœä¸­çš„æ•°å­—å‰æ·»åŠ ç¾Žå…ƒå‰ç¼€$999Sä¸ºæ•°å­—æ˜¾ç¤ºç¬¦å·ç±»åž‹ï¼Œé€šå¸¸ç”¨äºŽæ˜¾ç¤ºæŸ¥è¯¢ç»“æžœä¸­çš„æ­£è´Ÿæ•°å­—S999,åœ¨å­—ç¬¦,ä½ç½®ä¸Šæ”¾ç½®éƒ½é€—å·/td&gt;999,99æŸ¥çœ‹scott.empè¡¨ä¸­çš„SALå­—æ®µå€¼ï¼Œç„¶åŽä½¿ç”¨â€$999,999,999.00â€æ ¼å¼æ˜¾ç¤º:12345678910111213141516171819202122232425262728293031SQL&gt; select ename,job,sal from scott.emp;ENAME JOB SAL---------- --------- ----------SMITH CLERK 800ALLEN SALESMAN 1600WARD SALESMAN 1250JONES MANAGER 2975MARTIN SALESMAN 1250BLAKE MANAGER 2850CLARK MANAGER 2450SCOTT ANALYST 3000KING PRESIDENT 5000TURNER SALESMAN 1500ADAMS CLERK 1100SQL&gt; set numformat $999,999,999.00SQL&gt; select ename,job,sal from scott.emp;ENAME JOB SAL---------- --------- ----------------SMITH CLERK $800.00ALLEN SALESMAN $1,600.00WARD SALESMAN $1,250.00JONES MANAGER $2,975.00MARTIN SALESMAN $1,250.00BLAKE MANAGER $2,850.00CLARK MANAGER $2,450.00SCOTT ANALYST $3,000.00KING PRESIDENT $5,000.00TURNER SALESMAN $1,500.00ADAMS CLERK $1,100.00timingå˜é‡è¯¥å˜é‡ç”¨äºŽæ˜¾ç¤ºæ‰§è¡ŒSQLè¯­å¥æ‰€èŠ±çš„æ—¶é—´ï¼Œé»˜è®¤å€¼ä¸ºoffï¼š1234567891011121314151617181920212223242526SQL&gt; set timing onSQL&gt; select ename,job,sal from scott.emp;ENAME JOB SAL---------- --------- ----------------SMITH CLERK $800.00ALLEN SALESMAN $1,600.00WARD SALESMAN $1,250.00JONES MANAGER $2,975.00MARTIN SALESMAN $1,250.00BLAKE MANAGER $2,850.00CLARK MANAGER $2,450.00SCOTT ANALYST $3,000.00KING PRESIDENT $5,000.00TURNER SALESMAN $1,500.00ADAMS CLERK $1,100.00ENAME JOB SAL---------- --------- ----------------JAMES CLERK $950.00FORD ANALYST $3,000.00MILLER CLERK $1,300.00å·²é€‰æ‹©14è¡Œã€‚å·²ç”¨æ—¶é—´: 00: 00: 00.04setå‘½ä»¤è¿˜æœ‰å¾ˆå¤šå˜é‡å¯ç”¨ï¼Œå¯ä½¿ç”¨help setå‘½ä»¤æ¥æŸ¥çœ‹ã€‚å¸¸ç”¨SQLPluså‘½ä»¤helpå‘½ä»¤helpå‘½ä»¤ç”¨æ¥å¸®åŠ©ç”¨æˆ·æŸ¥è¯¢æŒ‡å®šå‘½ä»¤è¯¦ç»†ä»‹ç»ï¼Œç±»ä¼¼äºŽLinuxçš„manï¼Œå…¶çš„è¯­æ³•å¦‚ä¸‹ï¼š1help|? [topic]?è¡¨ç¤ºä¸€ä¸ªå‘½ä»¤çš„éƒ¨åˆ†å­—ç¬¦ï¼Œç”¨äºŽæ¨¡ç³ŠæŸ¥è¯¢ï¼›topicå‚æ•°è¡¨ç¤ºè¦æŸ¥è¯¢çš„å‘½ä»¤çš„å®Œæ•´åç§°ã€‚å¦‚æžœç›´æŽ¥è¾“å…¥helpï¼Œåˆ™æ˜¾ç¤ºçš„æ˜¯å‘½ä»¤æœ¬èº«çš„è¯¦ç»†ä¿¡æ¯ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273SQL&gt; help HELP ---- Accesses this command line help system. Enter HELP INDEX or ? INDEX for a list of topics. You can view SQL*Plus resources at http://www.oracle.com/technology/tech/sql_plus/ and the Oracle Database Library at http://www.oracle.com/technology/documentation/ HELP|? [topic]SQL&gt; help set SET --- Sets a system variable to alter the SQL*Plus environment settings for your current session. For example, to: - set the display width for data - customize HTML formatting - enable or disable printing of column headings - set the number of lines per page SET system_variable value where system_variable and value represent one of the following clauses: APPI[NFO]&#123;OFF|ON|text&#125; NEWP[AGE] &#123;1|n|NONE&#125; ARRAY[SIZE] &#123;15|n&#125; NULL text AUTO[COMMIT] &#123;OFF|ON|IMM[EDIATE]|n&#125; NUMF[ORMAT] format AUTOP[RINT] &#123;OFF|ON&#125; NUM[WIDTH] &#123;10|n&#125; AUTORECOVERY &#123;OFF|ON&#125; PAGES[IZE] &#123;14|n&#125; AUTOT[RACE] &#123;OFF|ON|TRACE[ONLY]&#125; PAU[SE] &#123;OFF|ON|text&#125; [EXP[LAIN]] [STAT[ISTICS]] RECSEP &#123;WR[APPED]|EA[CH]|OFF&#125; BLO[CKTERMINATOR] &#123;.|c|ON|OFF&#125; RECSEPCHAR &#123;_|c&#125; CMDS[EP] &#123;;|c|OFF|ON&#125; SERVEROUT[PUT] &#123;ON|OFF&#125; COLSEP &#123;_|text&#125; [SIZE &#123;n | UNLIMITED&#125;] CON[CAT] &#123;.|c|ON|OFF&#125; [FOR[MAT] &#123;WRA[PPED] | COPYC[OMMIT] &#123;0|n&#125; WOR[D_WRAPPED] | COPYTYPECHECK &#123;ON|OFF&#125; TRU[NCATED]&#125;] DEF[INE] &#123;&amp;|c|ON|OFF&#125; SHIFT[INOUT] &#123;VIS[IBLE] | DESCRIBE [DEPTH &#123;1|n|ALL&#125;] INV[ISIBLE]&#125; [LINENUM &#123;OFF|ON&#125;] [INDENT &#123;OFF|ON&#125;] SHOW[MODE] &#123;OFF|ON&#125; ECHO &#123;OFF|ON&#125; SQLBL[ANKLINES] &#123;OFF|ON&#125; EDITF[ILE] file_name[.ext] SQLC[ASE] &#123;MIX[ED] | EMB[EDDED] &#123;OFF|ON&#125; LO[WER] | UP[PER]&#125; ERRORL[OGGING] &#123;ON|OFF&#125; SQLCO[NTINUE] &#123;&gt; | text&#125; [TABLE [schema.]tablename] SQLN[UMBER] &#123;ON|OFF&#125; [TRUNCATE] [IDENTIFIER identifier] SQLPLUSCOMPAT[IBILITY] &#123;x.y[.z]&#125; ESC[APE] &#123;\|c|OFF|ON&#125; SQLPRE[FIX] &#123;#|c&#125; ESCCHAR &#123;@|?|%|$|OFF&#125; SQLP[ROMPT] &#123;SQL&gt;|text&#125; EXITC[OMMIT] &#123;ON|OFF&#125; SQLT[ERMINATOR] &#123;;|c|ON|OFF&#125; FEED[BACK] &#123;6|n|ON|OFF&#125; SUF[FIX] &#123;SQL|text&#125; FLAGGER &#123;OFF|ENTRY|INTERMED[IATE]|FULL&#125; TAB &#123;ON|OFF&#125; FLU[SH] &#123;ON|OFF&#125; TERM[OUT] &#123;ON|OFF&#125; HEA[DING] &#123;ON|OFF&#125; TI[ME] &#123;OFF|ON&#125; HEADS[EP] &#123;||c|ON|OFF&#125; TIMI[NG] &#123;OFF|ON&#125; INSTANCE [instance_path|LOCAL] TRIM[OUT] &#123;ON|OFF&#125; LIN[ESIZE] &#123;80|n&#125; TRIMS[POOL] &#123;OFF|ON&#125; LOBOF[FSET] &#123;1|n&#125; UND[ERLINE] &#123;-|c|ON|OFF&#125; LOGSOURCE [pathname] VER[IFY] &#123;ON|OFF&#125; LONG &#123;80|n&#125; WRA[P] &#123;ON|OFF&#125; LONGC[HUNKSIZE] &#123;80|n&#125; XQUERY &#123;BASEURI text| MARK[UP] HTML [OFF|ON] ORDERING&#123;UNORDERED| [HEAD text] [BODY text] [TABLE text] ORDERED|DEFAULT&#125;| [ENTMAP &#123;ON|OFF&#125;] NODE&#123;BYVALUE|BYREFERENCE| [SPOOL &#123;OFF|ON&#125;] DEFAULT&#125;| [PRE[FORMAT] &#123;OFF|ON&#125;] CONTEXT text&#125;ä¹Ÿå¯ä»¥ä½¿ç”¨help indexå‘½ä»¤æŸ¥çœ‹SQLPluså‘½ä»¤æ¸…å•ï¼š123456789101112131415161718SQL&gt; help indexEnter Help [topic] for help. @ COPY PAUSE SHUTDOWN @@ DEFINE PRINT SPOOL / DEL PROMPT SQLPLUS ACCEPT DESCRIBE QUIT START APPEND DISCONNECT RECOVER STARTUP ARCHIVE LOG EDIT REMARK STORE ATTRIBUTE EXECUTE REPFOOTER TIMING BREAK EXIT REPHEADER TTITLE BTITLE GET RESERVED WORDS (SQL) UNDEFINE CHANGE HELP RESERVED WORDS (PL/SQL) VARIABLE CLEAR HOST RUN WHENEVER OSERROR COLUMN INPUT SAVE WHENEVER SQLERROR COMPUTE LIST SET XQUERY CONNECT PASSWORD SHOWdescribeå‘½ä»¤è¯¥å‘½ä»¤ç”¨äºŽæŸ¥è¯¢æŒ‡å®šæ•°æ®è¡¨çš„ç»„æˆç»“æž„ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1desc[ribe] object_namedescribeå¯ç¼©å†™ä¸ºdescã€‚æ¯”å¦‚æŸ¥è¯¢scott.empè¡¨ä¸­SALESMANçš„ç¼–å·ï¼Œå§“åå’Œå·¥èµ„ï¼Œè¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨#desc scott.empå‘½ä»¤æŸ¥è¯¢scott.empè¡¨ä¸­å·¥èµ„å­—æ®µçš„åç§°ï¼š123456789101112131415161718192021SQL&gt; select empno,ename, 2 #desc scott.emp åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- EMPNO NOT NULL NUMBER(4) ENAME VARCHAR2(10) JOB VARCHAR2(9) MGR NUMBER(4) HIREDATE DATE SAL NUMBER(7,2) COMM NUMBER(7,2) DEPTNO NUMBER(2) 2 sal from scott.emp where job = 'SALESMAN'; EMPNO ENAME SAL---------- ---------- ---------- 7499 ALLEN 1600 7521 WARD 1250 7654 MARTIN 1250 7844 TURNER 1500spoolå‘½ä»¤è¯¥å‘½ä»¤å¯ä»¥å°†æŸ¥è¯¢ç»“æžœè¾“å‡ºåˆ°æŒ‡å®šæ–‡ä»¶ä¸­ï¼Œspoolçš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š1spo[ol] [file_name[.ext] [CRE[ATE] | REP[LACE] | APP[END]] | OFF | OUT]cre[ate]ï¼Œè¡¨ç¤ºåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œé»˜è®¤å€¼ï¼›rep[lace]ï¼Œè¡¨ç¤ºè¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶ï¼›app[end]ï¼Œè¡¨ç¤ºè¿½åŠ åˆ°ä¸€ä¸ªå·²å­˜åœ¨çš„æ–‡ä»¶ä¸­ï¼›off|outï¼Œè¡¨ç¤ºå…³é—­spoolè¾“å‡ºã€‚æ¯”å¦‚ï¼š1234567891011121314151617181920212223242526SQL&gt; spool d:\emp.txtSQL&gt; select empno,ename,job,sal from scott.emp; EMPNO ENAME JOB SAL---------- ---------- --------- ---------- 7369 SMITH CLERK 800 7499 ALLEN SALESMAN 1600 7521 WARD SALESMAN 1250 7566 JONES MANAGER 2975 7654 MARTIN SALESMAN 1250 7698 BLAKE MANAGER 2850 7782 CLARK MANAGER 2450 7788 SCOTT ANALYST 3000 7839 KING PRESIDENT 5000 7844 TURNER SALESMAN 1500 7876 ADAMS CLERK 1100 EMPNO ENAME JOB SAL---------- ---------- --------- ---------- 7900 JAMES CLERK 950 7902 FORD ANALYST 3000 7934 MILLER CLERK 1300å·²é€‰æ‹©14è¡Œã€‚SQL&gt; spool offåˆ°Dç›˜æ‰“å¼€emp.txtå¦‚ä¸‹ï¼šdefineå‘½ä»¤è¯¥å‘½ä»¤ç”¨æ¥å®šä¹‰ä¸€ä¸ªå˜é‡å¹¶èµ‹å€¼ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š1def[ine] [variable] | [variable = text]æ¯”å¦‚ï¼š123SQL&gt; define vjob='SALESMAN'SQL&gt; define vjobDEFINE VJOB = "SALESMAN" (CHAR)showå‘½ä»¤showå‘½ä»¤ç”¨æ¥æ˜¾ç¤ºSQLPlusç³»ç»Ÿå˜é‡çš„å€¼ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1sho[w] optionoptionè¡¨ç¤ºè¦æ˜¾ç¤ºçš„ç³»ç»Ÿé€‰é¡¹ï¼Œå¸¸ç”¨çš„å€¼æœ‰ï¼šallï¼Œparameters [parameter_name]ï¼Œsgaï¼Œspoolå’Œuserç­‰ã€‚1234567891011121314SQL&gt; show parameters db_block_sizeNAME TYPE VALUE------------------------------------ ----------- ------------------------------db_block_size integer 8192SQL&gt; show sgaTotal System Global Area 3373858816 bytesFixed Size 2180424 bytesVariable Size 1862273720 bytesDatabase Buffers 1493172224 bytesRedo Buffers 16232448 bytesSQL&gt; show userUSER ä¸º "SYSTEM"saveå‘½ä»¤è¯¥å‘½ä»¤å°†SQLç¼“å†²åŒºçš„æœ€è¿‘ä¸€æ¡SQLæˆ–PL/SQLå—ä¿å­˜åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1sav[e] [FILE] file_name[.ext] [CRE[ATE] | REP[LACE] | APP[END]]æ¯”å¦‚ï¼š1234567891011SQL&gt; select * from scott.dept; DEPTNO DNAME LOC---------- -------------- ------------- 10 ACCOUNTING NEW YORK 20 RESEARCH DALLAS 30 SALES CHICAGO 40 OPERATIONS BOSTONSQL&gt; save d:\dept.sqlå·²åˆ›å»º file d:\dept.sqlå¦‚æžœä¸æŒ‡å®šæ–‡ä»¶æ‰©å±•åï¼Œé»˜è®¤ä¸º.sqlã€‚getå‘½ä»¤è¯¥å‘½ä»¤å°†ä¸€ä¸ªSQLè„šæœ¬æ–‡ä»¶çš„å†…å®¹æ”¾è¿›SQLçš„ç¼“å†²åŒºï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š1get [FILE] file_name[.ext] [LIST | NOLIST]å…¶ä¸­listè¡¨ç¤ºåŠ è½½åˆ°ç¼“å†²åŒºçš„æ—¶å€™æ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ï¼Œnoliståˆ™è¡¨ç¤ºä¸æ˜¾ç¤ºã€‚æ¯”å¦‚åŠ è½½d:\dept.sqlåˆ°SQLç¼“å†²åŒºï¼Œå¹¶è¿è¡Œå‘½ä»¤/æ‰§è¡Œè¯¥è¯­å¥ï¼š12345678910SQL&gt; get d:\dept.sql list 1* select * from scott.deptSQL&gt; / DEPTNO DNAME LOC---------- -------------- ------------- 10 ACCOUNTING NEW YORK 20 RESEARCH DALLAS 30 SALES CHICAGO 40 OPERATIONS BOSTONstartå’Œ@ä¸¤ä¸ªå‘½ä»¤éƒ½æ˜¯ç”¨äºŽæ‰§è¡Œä¸€ä¸ªsqlè„šæœ¬æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼š1234567891011121314151617SQL&gt; start d:\dept.sql DEPTNO DNAME LOC---------- -------------- ------------- 10 ACCOUNTING NEW YORK 20 RESEARCH DALLAS 30 SALES CHICAGO 40 OPERATIONS BOSTONSQL&gt; @ d:\dept.sql DEPTNO DNAME LOC---------- -------------- ------------- 10 ACCOUNTING NEW YORK 20 RESEARCH DALLAS 30 SALES CHICAGO 40 OPERATIONS BOSTONæ ¼å¼åŒ–æŸ¥è¯¢ç»“æžœcolumnè¯¥å‘½ä»¤å¯ä»¥å®žçŽ°æ ¼å¼åŒ–æŸ¥è¯¢ç»“æžœï¼Œè®¾ç½®åˆ—å®½ï¼Œè®¾ç½®åˆ—æ ‡é¢˜ç­‰ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1col[umn] [column_name|alias|option]column_nameç”¨äºŽæŒ‡å®šè¦è®¾ç½®çš„åˆ—çš„åç§°ï¼Œaliasç”¨äºŽæŒ‡å®šåˆ—çš„åˆ«åï¼Œoptionç”¨äºŽæŒ‡å®šåˆ—çš„æ˜¾ç¤ºæ ¼å¼ï¼Œå…¶å€¼å’Œè¯´æ˜Žå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šoptioné€‰é¡¹çš„å€¼è¯´æ˜Žclearæ¸…é™¤æŒ‡å®šåˆ—æ‰€è®¾ç½®çš„æ ¼å¼ï¼Œæ¢å¤é»˜è®¤å€¼formatæ ¼å¼åŒ–æŒ‡å®šåˆ—headingæŒ‡å®šåˆ—æ ‡é¢˜justifyè°ƒæ•´åˆ—æ ‡é¢˜çš„å¯¹é½æ–¹å¼ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼šæ•°å€¼ç±»åž‹çš„å³å¯¹é½ï¼Œå…¶ä»–ç±»åž‹çš„å·¦å¯¹é½nullæ›¿æ¢nullå€¼print/noprintæ˜¾ç¤ºåˆ—æ ‡é¢˜æˆ–éšè—åˆ—æ ‡é¢˜ï¼Œé»˜è®¤ä¸ºprinton/offæŽ§åˆ¶å®šä¹‰çš„æ˜¾ç¤ºå±žæ€§çŠ¶æ€ï¼Œoffè¡¨ç¤ºå®šä¹‰çš„æ‰€æœ‰æ˜¾ç¤ºå±žæ€§éƒ½ä¸èµ·ä½œç”¨wrappedå½“å­—ç¬¦ä¸²çš„é•¿åº¦è¶…è¿‡æ˜¾ç¤ºå®½åº¦æ—¶ï¼Œå°†å­—ç¬¦ä¸²çš„è¶…å‡ºéƒ¨åˆ†æŠ˜å åˆ°ä¸‹ä¸€è¡Œæ˜¾ç¤ºword_wrappedè¡¨ç¤ºä»Žä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦å¤„æŠ˜å truncatedè¡¨ç¤ºæˆªå–å­—ç¬¦ä¸²å°¾éƒ¨formaté€‰é¡¹ä½¿ç”¨formaté€‰é¡¹æ ¼å¼åŒ–scott.empè¡¨ä¸­çš„salåˆ—ï¼Œæ ¼å¼ä¸º$999,999.00ï¼š123456789101112131415161718192021222324SQL&gt; column sal format $999,999.00SQL&gt; select empno,ename,sal from scott.emp; EMPNO ENAME SAL---------- ---------- ------------ 7369 SMITH $800.00 7499 ALLEN $1,600.00 7521 WARD $1,250.00 7566 JONES $2,975.00 7654 MARTIN $1,250.00 7698 BLAKE $2,850.00 7782 CLARK $2,450.00 7788 SCOTT $3,000.00 7839 KING $5,000.00 7844 TURNER $1,500.00 7876 ADAMS $1,100.00 EMPNO ENAME SAL---------- ---------- ------------ 7900 JAMES $950.00 7902 FORD $3,000.00 7934 MILLER $1,300.00å·²é€‰æ‹©14è¡Œã€‚headingé€‰é¡¹ä½¿ç”¨headingé€‰é¡¹å°†scott.empè¡¨çš„empnoï¼Œenameå’Œsalä¸‰ä¸ªåˆ—åè½¬æ¢ä¸ºä¸­æ–‡ï¼š1234567891011121314151617181920212223242526SQL&gt; column empno heading å‘˜å·¥ç¼–å·SQL&gt; column ename heading å‘˜å·¥å§“åSQL&gt; column sal heading å·¥èµ„SQL&gt; select empno,ename,sal from scott.emp; å‘˜å·¥ç¼–å· å‘˜å·¥å§“å å·¥èµ„---------- ---------- ------------ 7369 SMITH $800.00 7499 ALLEN $1,600.00 7521 WARD $1,250.00 7566 JONES $2,975.00 7654 MARTIN $1,250.00 7698 BLAKE $2,850.00 7782 CLARK $2,450.00 7788 SCOTT $3,000.00 7839 KING $5,000.00 7844 TURNER $1,500.00 7876 ADAMS $1,100.00 å‘˜å·¥ç¼–å· å‘˜å·¥å§“å å·¥èµ„---------- ---------- ------------ 7900 JAMES $950.00 7902 FORD $3,000.00 7934 MILLER $1,300.00å·²é€‰æ‹©14è¡Œã€‚nullé€‰é¡¹ä½¿ç”¨nullé€‰é¡¹å°†scott.empè¡¨ä¸­commåˆ—å€¼ä¸ºnullæ˜¾ç¤ºæˆâ€œç©ºå€¼â€ï¼š1234567891011121314151617SQL&gt; column comm null 'ç©ºå€¼'SQL&gt; select empno,ename,comm from scott.emp where comm is null; å‘˜å·¥ç¼–å· å‘˜å·¥å§“å COMM---------- ---------- ---------- 7369 SMITH ç©ºå€¼ 7566 JONES ç©ºå€¼ 7698 BLAKE ç©ºå€¼ 7782 CLARK ç©ºå€¼ 7788 SCOTT ç©ºå€¼ 7839 KING ç©ºå€¼ 7876 ADAMS ç©ºå€¼ 7900 JAMES ç©ºå€¼ 7902 FORD ç©ºå€¼ 7934 MILLER ç©ºå€¼å·²é€‰æ‹©10è¡Œã€‚wrapped/word_wrappedé€‰é¡¹ä½¿ç”¨wrappedé€‰é¡¹å®žçŽ°æŒ‰ç…§æŒ‡å®šé•¿åº¦æŠ˜è¡Œï¼š12345678910111213141516171819202122232425SQL&gt; create table test( 2 col1 varchar2(100) 3 );è¡¨å·²åˆ›å»ºã€‚SQL&gt; insert into test(col1) values ('HOW ARE YOU?');å·²åˆ›å»º 1 è¡Œã€‚SQL&gt; select col1 from test;COL1--------------------------------------------------------------------------------HOW ARE YOU?SQL&gt; column col1 format a5SQL&gt; column col1 wrappedSQL&gt; select col1 from test;COL1-----HOW ARE YOU?ä½¿ç”¨word_wrappedé€‰é¡¹æŒ‰ç…§å®Œæ•´å­—ç¬¦ä¸²æŠ˜è¡Œ12345678SQL&gt; column col1 word_wrappedSQL&gt; select col1 from test;COL1-----HOWAREYOU?ttitleå’Œbtitleå‘½ä»¤è¿™ä¸¤ä¸ªå‘½ä»¤åˆ†åˆ«ç”¨æ¥è®¾ç½®æ‰“å°æ—¶æ¯é¡µçš„é¡µé¦–å’Œé¡µè„šæ ‡é¢˜ï¼Œå…¶ä¸­ttitleè¯­æ³•å¦‚ä¸‹ï¼ˆbtitleè¯­æ³•ç±»ä¼¼ï¼‰ï¼š1tti[tle] [printspec [text|variable] ...] | [OFF|ON]printspecä½œä¸ºå¤´æ ‡é¢˜çš„ä¿®é¥°æ€§é€‰é¡¹ï¼Œå…¶å€¼å’Œè¯´æ˜Žå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šprintspecé€‰é¡¹çš„å€¼è¯´æ˜ŽcolæŒ‡å®šå½“å‰è¡Œçš„ç¬¬å‡ åˆ—æ‰“å°å¤´æ ‡é¢˜skipè·³åˆ°ä»Žä¸‹ä¸€è¡Œå¼€å§‹çš„ç¬¬å‡ è¡Œï¼Œé»˜è®¤ä¸º1leftåœ¨å½“å‰è¡Œä¸­å·¦å¯¹é½æ‰“å°æ•°æ®centeråœ¨å½“å‰è¡Œä¸­é—´æ‰“å°æ•°æ®rightåœ¨å½“å‰è¡Œä¸­å³å¯¹é½æ‰“å°æ•°æ®boldä»¥é»‘ä½“æ‰“å°æ•°æ®æ¯”å¦‚ï¼šæ‰“å°è¾“å‡ºscott.salgradeæ•°æ®è¡¨ä¸­çš„è®°å½•ï¼Œå¹¶è®¾ç½®æ ‡é¢˜ï¼š1234567891011121314151617181920SQL&gt; set pagesize 8SQL&gt; ttitle left 'é”€å”®æƒ…å†µæŽ’è¡Œè¡¨'SQL&gt; btitle left 'æ‰“å°æ—¥æœŸ2017å¹´11æœˆ5æ—¥ æ‰“å°äºº MrBird'SQL&gt; select * from scott.salgrade;é”€å”®æƒ…å†µæŽ’è¡Œè¡¨ GRADE LOSAL HISAL---------- ---------- ---------- 1 700 1200 2 1201 1400 3 1401 2000æ‰“å°æ—¥æœŸ2017å¹´11æœˆ5æ—¥ æ‰“å°äºº MrBirdé”€å”®æƒ…å†µæŽ’è¡Œè¡¨ GRADE LOSAL HISAL---------- ---------- ---------- 4 2001 3000 5 3001 9999æ‰“å°æ—¥æœŸ2017å¹´11æœˆ5æ—¥ æ‰“å°äºº MrBird]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginx Rewrite]]></title>
    <url>%2FNginx-rewrite.html</url>
    <content type="text"><![CDATA[NginxæœåŠ¡å™¨æä¾›äº†RewriteåŠŸèƒ½ï¼Œç”¨äºŽå®žçŽ°URLçš„é‡å†™ã€‚è¯¥åŠŸèƒ½ç”±ngx_http_rewrite_moduleæ¨¡å—æä¾›ï¼Œè¯¥æ¨¡å—é»˜è®¤å¼€å¯ã€‚NginxæœåŠ¡å™¨çš„RewriteåŠŸèƒ½ä¾èµ–äºŽPCRE(Perl Compatible Regular Expressionsï¼ŒPerlå…¼å®¹çš„æ­£åˆ™è¡¨è¾¾å¼)ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘å®‰è£…Nginxçš„æ—¶å€™éœ€è¦å…ˆå®‰è£…PCREåº“ã€‚RewriteåŠŸèƒ½å°±æ˜¯ï¼Œä½¿ç”¨Nginxæä¾›çš„å…¨å±€å˜é‡æˆ–è‡ªå·±è®¾ç½®çš„å˜é‡ï¼Œç»“åˆæ­£åˆ™è¡¨è¾¾å¼å’Œæ ‡å¿—ä½å®žçŽ°urlé‡å†™ä»¥åŠé‡å®šå‘ã€‚Rewriteåªèƒ½å¯¹åŸŸååŽè¾¹çš„é™¤åŽ»ä¼ é€’çš„å‚æ•°å¤–çš„å­—ç¬¦ä¸²èµ·ä½œç”¨ï¼Œä¾‹å¦‚https://mrbird.cc/page/2/search?type=1&amp;value=nginxåªå¯¹/page/2/searché‡å†™ã€‚ifæŒ‡ä»¤ç”¨äºŽæ ¹æ®ä¸åŒæ¡ä»¶é€‰æ‹©ä¸åŒçš„Nginxé…ç½®ï¼Œå¯åœ¨serverå’Œlocationå—ä¸­é…ç½®ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1if (condition) &#123; &#125;conditionä¸ºåˆ¤æ–­æ¡ä»¶ï¼ˆtrue/falseï¼‰ï¼šå˜é‡åã€‚å¦‚æžœå˜é‡çš„å€¼ä¸ºç©ºå­—ç¬¦ä¸²æˆ–è€…ä»¥0å¼€å¤´çš„ä»»æ„å­—ç¬¦ä¸²ï¼Œä¸ºfalseã€‚å…¶ä½™ä¸ºtrueï¼›æ¯”è¾ƒå˜é‡çš„å†…å®¹æ—¶å€™ï¼Œä½¿ç”¨=æˆ–!=ï¼›ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚~ï¼ˆå¤§å°å†™æ•æ„Ÿï¼‰ï¼Œ~*ï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰ï¼Œ!~å’Œ!~*ã€‚æ­£åˆ™è¡¨è¾¾å¼ä¸€èˆ¬ä¸åŠ åŒå¼•å·ï¼Œé™¤éžåŒ…å«}æˆ–è€…åˆ†å·;å­—ç¬¦ï¼›-få’Œ!-fç”¨æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–‡ä»¶ï¼›-då’Œ!-dç”¨æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç›®å½•ï¼›-eå’Œ!-eç”¨æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–‡ä»¶æˆ–ç›®å½•ï¼›-xå’Œ!-xç”¨æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œã€‚å‡ ä¸ªå®žä¾‹ï¼š123456789101112131415if ($request_method = POST) &#123; return 405; # å¦‚æžœè¯·æ±‚æ–¹æ³•ä¸ºPOSTï¼Œåˆ™ç›´æŽ¥è¿”å›ž405HTTPçŠ¶æ€ç ã€‚&#125;if ($slow) &#123; limit_rate 10k;&#125;if ($http_user_agent ~ MSIE) &#123; rewrite ^(.*)$ /msie/$1 break; # å¦‚æžœUAåŒ…å«"MSIE"ï¼Œrewriteè¯·æ±‚åˆ°/msid/ç›®å½•ä¸‹&#125;if ($http_cookie ~* "id=([^;]+)(?:;|$)") &#123; set $id $1; # å¦‚æžœcookieåŒ¹é…æ­£åˆ™ï¼Œè®¾ç½®å˜é‡$idç­‰äºŽæ­£åˆ™å¼•ç”¨éƒ¨åˆ†&#125;if (!-f $request_filename)&#123; # åˆ¤æ–­è¯·æ±‚çš„æ–‡ä»¶æ˜¯å¦ä¸å­˜åœ¨&#125;breakæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽä¸­æ–­å½“å‰ç›¸åŒä½œç”¨åŸŸçš„Nginxé…ç½®ã€‚Nginxé‡åˆ°è¯¥æŒ‡ä»¤æ—¶ï¼Œå›žåˆ°ä¸Šä¸€å±‚ä½œç”¨åŸŸç»§ç»­å‘ä¸‹è¯»å–é…ç½®ã€‚è¯¥æŒ‡ä»¤å¯åœ¨serverï¼Œlocationå’Œifå—ä¸­ä½¿ç”¨ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1break;æ¯”å¦‚ï¼š12345678location / &#123; if ($slow) &#123; set $id $1; break; # è·³å‡ºifä½œç”¨åŸŸ limit_rate 10k; # æ— æ•ˆ &#125; ... # ç»§ç»­è¯»å–&#125;returnæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽå®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ï¼Œç›´æŽ¥å‘å®¢æˆ·ç«¯è¿”å›žå“åº”çŠ¶æ€ç ï¼Œå¤„äºŽè¯¥æŒ‡ä»¤åŽçš„æ‰€æœ‰Nginxé…ç½®éƒ½æ˜¯æ— æ•ˆçš„ã€‚è¯­æ³•ç»“æž„å¦‚ä¸‹ï¼š123return [text];return code URL;return URL;æ¯”å¦‚ï¼š123location = /404 &#123; return 404 "sorry page not found!\n"&#125;rewriteæŒ‡ä»¤è¯¥æŒ‡ä»¤é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ¥æ”¹å˜URLï¼Œå¯ä»¥åŒæ—¶å­˜åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤ï¼ŒæŒ‰ç…§é¡ºåºä¾æ¬¡å¯¹URLè¿›è¡ŒåŒ¹é…å¤„ç†ã€‚è¯¥æŒ‡ä»¤å¯åœ¨serverï¼Œlocationå’Œifå—ä¸­é…ç½®ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1rewrite regex replacement [flag];regexç”¨äºŽåŒ¹é…URLçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œä½¿ç”¨()æ ‡è®°è¦æˆªå–çš„å†…å®¹ã€‚replacementåŒ¹é…æˆåŠŸåŽç”¨äºŽæ›¿æ¢URLä¸­è¢«æˆªå–çš„éƒ¨åˆ†ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æžœreplacementæ˜¯ç”±http://æˆ–è€…https://å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œåˆ™ç›´æŽ¥å°†é‡å†™åŽçš„URLè¿”å›žå®¢æˆ·ç«¯ã€‚flagæ ‡å¿—ä½ï¼Œå…¶å€¼æœ‰å¦‚ä¸‹å‡ ç§ï¼šlastï¼ŒNginxé‡åˆ°å«æœ‰è¯¥æ ‡å¿—ä½çš„rewriteå‘½ä»¤æ—¶ï¼Œåœæ­¢å‘ä¸‹å¤„ç†ï¼Œç›´æŽ¥ä½¿ç”¨è¯¥rewriteè¿”å›žçš„æ–°çš„URLåŽ»å’Œæ‰€æœ‰çš„locationå—é‡æ–°åŒ¹é…ã€‚breakï¼Œå°†æ­¤å¤„é‡å†™çš„URLä½œä¸ºä¸€ä¸ªæ–°çš„URLï¼Œåœ¨æœ¬å—ä¸­ç»§ç»­è¿›è¡Œå¤„ç†ã€‚è¯¥æ ‡å¿—é‡å†™åŽçš„URLåœ¨å½“å‰locationå—ä¸­æ‰§è¡Œï¼Œä¸ä¼šè½¬å‘åˆ°å…¶ä»–çš„locationå—ã€‚redirectå°†é‡å†™åŽçš„URLè¿”å›žç»™å®¢æˆ·ç«¯ï¼ŒçŠ¶æ€ç ä¸º302ï¼Œè¡¨ç¤ºä¸´æ—¶é‡å®šå‘URLã€‚permanentå°†é‡å†™åŽçš„URLè¿”å›žç»™å®¢æˆ·ç«¯ï¼ŒçŠ¶æ€ç ä¸º301ï¼Œè¡¨ç¤ºæ°¸ä¹…é‡å®šå‘URLã€‚ä¸¾äº›ä¾‹å­ï¼š1234location / &#123; rewrite ^(/myweb/.*)/media/(.*)\..*$ $1/mp3/$2.mp3 last; rewrite ^(/myweb/.*)/audio/(.*)\..*$ $1/mp4/$2.ra last; &#125;å¦‚æžœæŸä¸ªè¯·æ±‚URLåœ¨ç¬¬2è¡Œè¢«åŒ¹é…æˆåŠŸï¼ŒNginxä¸ä¼šç»§ç»­ä½¿ç”¨ç¬¬3è¡Œé…ç½®å¤„ç†æ–°çš„URLï¼Œè€Œæ˜¯è®©æ‰€æœ‰çš„locationé‡æ–°åŒ¹é…æ–°çš„URLã€‚1234location /myweb/ &#123; rewrite ^(/myweb/.*)/media/(.*)\..*$ $1/mp3/$2.mp3 break; rewrite ^(/myweb/.*)/audio/(.*)\..*$ $1/mp4/$2.ra break; &#125;å¦‚æžœæŸä¸ªè¯·æ±‚URLåœ¨ç¬¬2è¡Œè¢«åŒ¹é…æˆåŠŸï¼ŒNginxæœåŠ¡å™¨å°†æ–°çš„URLç»§ç»­ä½¿ç”¨æœ¬å—ä¸­çš„ç¬¬3è¡Œé…ç½®è¿›è¡Œå¤„ç†ï¼Œä¸ä¼šå°†æ–°çš„URLå‘é€åˆ°å…¶ä»–locationå—ã€‚å¦‚æžœè¿™é‡Œå°†breakæ›¿æ¢ä¸ºlastçš„è¯ï¼Œæ–°çš„URLåŒ…å«/myweb/ä¸²ï¼Œæœ¬locationå—å¯èƒ½ç»§ç»­æ•èŽ·åˆ°è¯¥æ–°çš„URLï¼Œè¿™æ ·ä¾¿é€ æˆäº†æ­»å¾ªçŽ¯ã€‚Nginxåœ¨å°è¯•10æ¬¡å¾ªçŽ¯ä¹‹åŽï¼Œè¿”å›ž500 Internal Server Erroré”™è¯¯ã€‚rewrite_logæŒ‡ä»¤è¯¥æŒ‡ä»¤é…ç½®æ˜¯å¦å¼€å¯é‡å†™URLæ—¥å¿—çš„è¾“å‡ºåŠŸèƒ½ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1rewrite_log on | offé»˜è®¤å€¼ä¸ºoffã€‚æ—¥å¿—å°†ä»¥noticeçº§åˆ«è¾“å‡ºåˆ°error_logé…ç½®çš„æ—¥å¿—æ–‡ä»¶ä¸­ã€‚setæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽè®¾ç½®ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1set variable valueå˜é‡åç§°å¿…é¡»ä»¥$å¼€å¤´ï¼Œä¸”ä¸èƒ½å’ŒNginxæœåŠ¡å™¨é¢„è®¾çš„å…¨å±€å˜é‡åŒåï¼Œå˜é‡çš„ä½œç”¨åŸŸä¸ºå…¨å±€ã€‚uninitialized_variable_warnæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽé…ç½®å®žç”¨æœªåˆå§‹åŒ–çš„å˜é‡æ—¶ï¼Œæ˜¯å¦è®°å½•è­¦å‘Šæ—¥å¿—ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1uninitialized_variable_warn on | offé»˜è®¤å€¼ä¸ºonã€‚rewriteå¸¸ç”¨å…¨å±€å˜é‡ä¸‹è¡¨åˆ—å‡ºäº†åœ¨rewriteé…ç½®è¿‡ç¨‹ä¸­å¯èƒ½ä¼šä½¿ç”¨åˆ°çš„Nginxå…¨å±€å˜é‡ï¼šå˜é‡è¯´æ˜Ž$argsè¯·æ±‚URLä¸­çš„è¯·æ±‚å‚æ•°ä¸²ï¼Œå¦‚arg1=value1&amp;arg2=value2$content_lengthè¯·æ±‚å¤´ä¸­çš„Content-lengthå­—æ®µ$content_typeè¯·æ±‚å¤´é‡çš„Content-typeç‰‡æ®µ$document_rootå½“å‰è¯·æ±‚çš„æ ¹è·¯å¾„$document_uriå½“å‰è¯·æ±‚çš„URIï¼Œæ¯”å¦‚https://mrbird.cc/page/2/search?type=1&amp;value=nginxä¸­çš„/page/2/search$hostå½“å‰URLçš„ä¸»æœºéƒ¨åˆ†å­—æ®µï¼Œæ¯”å¦‚https://mrbird.cc/page/2/search?type=1&amp;value=nginxä¸­çš„mrbird.ccã€‚å¦‚æžœä¸ºç©ºï¼Œåˆ™ä¸ºserverå—ä¸­server_nameæŒ‡ä»¤çš„é…ç½®å€¼$http_user_agentå®¢æˆ·ç«¯çš„ä»£ç†ä¿¡æ¯$http_cookieå®¢æˆ·ç«¯çš„cookieä¿¡æ¯$limit_rateNginxæœåŠ¡å™¨å¯¹ç½‘ç»œè¿žæŽ¥é€ŸçŽ‡çš„é™åˆ¶ï¼Œå³Nginxé…ç½®ä¸­çš„limit_rateæŒ‡ä»¤çš„é…ç½®å€¼$remote_addrå®¢æˆ·ç«¯çš„IPåœ°å€$remote_portå®¢æˆ·ç«¯çš„ç«¯å£å·$request_body_fileå‘ç»™åŽç«¯æœåŠ¡å™¨çš„æœ¬åœ°æ–‡ä»¶èµ„æºåç§°$request_methodå®¢æˆ·ç«¯çš„è¯·æ±‚æ–¹å¼ï¼Œå¦‚getï¼Œpostç­‰$request_filenameå½“å‰è¯·æ±‚çš„æ–‡ä»¶è·¯å¾„ï¼Œç”±rootæˆ–aliasæŒ‡ä»¤ä¸ŽURIè¯·æ±‚ç”Ÿæˆã€‚$request_uriåŒ…å«è¯·æ±‚å‚æ•°çš„åŽŸå§‹URIï¼Œä¸åŒ…å«ä¸»æœºåï¼Œå¦‚ï¼šâ€/foo/bar.php?arg=bazâ€$query_stringå’Œ$argsç›¸åŒ$schemeHTTPæ–¹æ³•ï¼ˆå¦‚httpï¼Œhttpsï¼Œftpï¼‰$server_protocolè¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œé€šå¸¸æ˜¯HTTP/1.0æˆ–HTTP/1.1$server_addræœåŠ¡å™¨çš„åœ°å€$server_nameæœåŠ¡å™¨åç§°$server_portè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨çš„ç«¯å£å·$uriåŒ$document_urirewriteå®žä¾‹åŸŸåè·³è½¬123456server &#123; listen 80; server_name jump.myweb.name; rewrite ^/ http://www.myweb.info/; ...&#125;æ¯”å¦‚å®¢æˆ·ç«¯è®¿é—®http://jump.myweb.nameæ—¶ï¼ŒURLå°†è¢«é‡å†™ä¸ºhttp://jump.myweb.infoã€‚12345678server &#123; listen 80; server_name jump.myweb.name jump.myweb.info if ($host ~ myweb\.info) &#123; rewrite ^(.*) http://jump.myweb.name$1 permanent; &#125; ...&#125;å½“å®¢æˆ·ç«¯è®¿é—®http://jump.myweb.info/reqsourceæ—¶ï¼ŒURLå°†è¢«é‡å†™ä¸ºhttp://jump.myweb.name/reqsourceã€‚123456789server &#123; listen 80; server_name jump1.myweb.name jump2.myweb.name; if ($http_host ~* ^(.*)\.myweb\.name$) &#123; rewrite ^(.*) http://jump.myweb.name$1; break; &#125; ...&#125;å½“å®¢æˆ·ç«¯è®¿é—®http://jump1.myweb.name/reponseæˆ–è€…http://jump2.myweb.name/reponseæ—¶ï¼ŒURLéƒ½å°†è¢«Nginxé‡å†™ä¸ºhttp://jump.myweb.name/reponseã€‚ç›®å½•åˆå¹¶123456789server &#123; listen 80; server_name www.myweb.name; location ^~ /server &#123; rewrite ^/server-([0-9]+)-([0-9]+)-([0-9]+)-([0-9]+)-([0-9]+)\.htm$ /server/$1/$2/$3/$4/$5.html last; break; &#125;&#125;...æ­¤æ—¶å¦‚æžœå®¢æˆ·ç«¯è¾“å…¥http://www.myweb.name/server-12-34-56-78-9.htmå³å¯è®¿é—®åˆ°http://www.myweb.name/server/12/34/56/78/9.htmlã€‚è¿™æ ·åšå°†å¤šçº§ç›®å½•ä¸‹çš„èµ„æºæ–‡ä»¶è¯·æ±‚è½¬æ¢ä¸ºäº†ç›®å½•è®¡æ•°å°‘çš„èµ„æºè¯·æ±‚ï¼Œæœ‰åˆ©äºŽSEOã€‚é˜²ç›—é“¾é˜²ç›—é“¾çš„å®žçŽ°åŽŸç†ï¼šé€šè¿‡HTTPåè®®ä¸­çš„è¯·æ±‚å¤´ä¸­çš„Refererå¤´åŸŸï¼Œæˆ‘ä»¬å¯ä»¥æ£€æµ‹åˆ°è®¿é—®ç›®æ ‡èµ„æºçš„æºåœ°å€ï¼Œå¦‚æžœè¯¥åœ°å€ä¸æ˜¯è‡ªå·±ç«™ç‚¹çš„URLï¼Œå°±é‡‡å–ç»„ç»‡æŽªæ–½ã€‚Nginxé…ç½®ä¸­æœ‰ä¸€ä¸ªæŒ‡ä»¤valid_referersï¼Œå¦‚æžœRefererå¤´åŸŸæ²¡æœ‰ç¬¦åˆvalid_referersé…ç½®çš„å€¼ï¼Œ$invalid_refererå˜é‡çš„å€¼å°†è¢«èµ‹å€¼ä¸º1ã€‚valid_referersè¯­æ³•å¦‚ä¸‹ï¼š1valid_referers none | blocked | server_names | string ...;noneæ£€æµ‹Refererå¤´åŸŸä¸å­˜åœ¨çš„æƒ…å†µã€‚blockedæ£€æµ‹Refererå¤´åŸŸçš„å€¼è¢«é˜²ç«å¢™æˆ–è€…ä»£ç†æœåŠ¡å™¨åˆ é™¤æˆ–ä¼ªè£…çš„æƒ…å†µã€‚server_namesè®¾ç½®URLã€‚1234567891011server &#123; listen 80; server_name www.myweb.name; location ~* ^.+\.(gif|jpg|png|swf|flv|rar|zip)$ &#123; ... valid_referers none blocked server_names *.myweb.com; if ($invalid_referer) &#123; rewrite ^/ http://www.myweb.com/images/forbidden.png; &#125; &#125;...]]></content>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginx upstream]]></title>
    <url>%2FNginx-upstream.html</url>
    <content type="text"><![CDATA[upstreamæŒ‡ä»¤ç”¨äºŽé…ç½®NginxåŽç«¯æœåŠ¡å™¨ç»„ã€‚Nginxæ”¯æŒè®¾ç½®ä¸€ç»„æœåŠ¡å™¨ä½œä¸ºåŽç«¯æœåŠ¡å™¨ï¼Œç”±æ ‡å‡†çš„HTTPæ¨¡å—ngx_http_upstream_moduleè¿›è¡Œè§£æžå’Œå¤„ç†ã€‚æœåŠ¡å™¨ç»„çš„è®¾ç½®æ¶‰åŠä»¥ä¸‹å‡ ä¸ªæŒ‡ä»¤ï¼šupstreamæŒ‡ä»¤è¯¥æŒ‡ä»¤ä¸ºè®¾ç½®åŽç«¯æœåŠ¡å™¨ç»„çš„ä¸»è¦æŒ‡ä»¤ï¼Œå…¶ä»–çš„æŒ‡ä»¤éƒ½åœ¨è¯¥æŒ‡ä»¤ä¸­è¿›è¡Œé…ç½®ï¼Œè¯­æ³•ç»“æž„å¦‚ä¸‹ï¼š1upstream name &#123; &#125;å…¶ä¸­nameä¸ºåŽç«¯æœåŠ¡å™¨ç»„çš„åç§°ï¼Œ{}ä¸­åŒ…å«æœåŠ¡å™¨ã€‚æŸä¸ªæœåŠ¡å™¨ç»„æ”¶åˆ°è¯·æ±‚åŽï¼ŒæŒ‰ç…§æƒé‡çš„å¤§å°ä¾æ¬¡é€‰æ‹©ç»„å†…çš„æœåŠ¡å™¨å¤„ç†è¯·æ±‚ã€‚å¦‚æžœå‡ºçŽ°é”™è¯¯ï¼Œåˆ™é¡ºæ¬¡äº¤ç»™ç»„å†…çš„ä¸‹ä¸€ä¸ªæœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼Œä»¥æ­¤ç±»æŽ¨ç›´åˆ°æ­£å¸¸å“åº”ã€‚å¦‚æžœéƒ½å‡ºé”™ï¼Œåˆ™è¿”å›žæœ€åŽä¸€ä¸ªæœåŠ¡å™¨å¤„ç†çš„ç»“æžœã€‚serveræŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽè®¾ç½®ç»„å†…çš„æœåŠ¡å™¨ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1server address [parameters];addressæœåŠ¡å™¨çš„åœ°å€ï¼Œæ”¯æŒIPï¼ŒåŸŸåå’Œunixåœ°å€ï¼›parametersè®¾ç½®æ›´å¤šçš„å±žæ€§ï¼ŒåŒ…æ‹¬ï¼šweight=numberç”¨äºŽè®¾ç½®æƒé‡ï¼Œæƒé‡é«˜çš„ä¼˜å…ˆå¤„ç†ã€‚é»˜è®¤å€¼ä¸º1ã€‚max_fails=numberè®¾ç½®è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°ã€‚åœ¨fail_timeoutæ—¶é—´èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°è¶…è¿‡è¯¥å€¼æ—¶ï¼Œåˆ™å°†è¯¥æœåŠ¡å™¨ç½®ä¸ºdownï¼ˆæ— æ•ˆï¼‰çŠ¶æ€ã€‚fail_timeout=timeé™¤äº†ç”¨åœ¨max_failså¤–ï¼Œè¯¥å±žæ€§è¿˜ç”¨äºŽè®¾ç½®æŸä¸ªdownçŠ¶æ€æœåŠ¡å™¨çš„æŒç»­æ—¶é—´ï¼Œåœ¨è¿™ä¸ªæ—¶é—´æ®µå†…ä¸å†æ£€æŸ¥è¯¥æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œä¸€ç›´è®¤ä¸ºå®ƒæ˜¯downçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸º10sã€‚backupè®¾ç½®æœåŠ¡å™¨ä¸ºå¤‡ç”¨æœåŠ¡å™¨ã€‚å½“æ­£å¸¸çš„æœåŠ¡å™¨å¤„äºŽdownæˆ–è€…busyçŠ¶æ€æ—¶ï¼Œè¯¥æœåŠ¡å™¨æ‰è¢«ç”¨æ¥å¤„ç†è¯·æ±‚ã€‚downå°†æœåŠ¡å™¨æ ‡è®°ä¸ºæ°¸ä¹…downçŠ¶æ€ã€‚ä¸¾ä¸ªä¾‹å­ï¼š12345upstream backend &#123; server www.example.com weight=5; server 127.0.0.1:8080 max_fails=3 fail_timeout=30s; server unix:/tmp/backend3;&#125;ä¸Šè¿°æŒ‡ä»¤è®¾ç½®äº†ä¸€ä¸ªåä¸ºbackendçš„æœåŠ¡å™¨ç»„ï¼ŒåŒ…å«ä¸‰å°æœåŠ¡å™¨ã€‚ç¬¬ä¸€å°æœåŠ¡å™¨æ˜¯åŸºäºŽåŸŸåçš„ï¼Œå¹¶ä¸”æƒé‡ä¸º5ï¼Œå°†ä¼˜å…ˆå¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼›ç¬¬äºŒå°æœåŠ¡å™¨åŸºäºŽIPåœ°å€ï¼Œå¹¶ä¸”è®¾ç½®å¦‚æžœ30så†…è¿žç»­äº§ç”Ÿ3æ¬¡è¯·æ±‚å¤±è´¥ï¼Œåˆ™è¯¥æœåŠ¡å™¨åœ¨ä¹‹åŽçš„30så†…è¢«è®¤ä¸ºæ˜¯downçŠ¶æ€ï¼›ç¬¬ä¸‰å°æœåŠ¡å™¨åŸºäºŽunixåœ°å€ã€‚ip_hashæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽä¿éšœå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å»ºç«‹ç¨³å®šçš„ä¼šè¯ã€‚åªæœ‰å½“è¯¥æœåŠ¡å™¨å¤„äºŽdownçŠ¶æ€æ—¶ï¼Œå®¢æˆ·ç«¯è¯·æ±‚æ‰ä¼šè¢«ä¸‹ä¸€ä¸ªæœåŠ¡å™¨æŽ¥æ”¶å’Œå¤„ç†ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1ip_hash;ip_hashæŒ‡ä»¤ä¸èƒ½å’Œweightä¸€èµ·ä½¿ç”¨ï¼›NginxæœåŠ¡å™¨åº”ä¸ºæœ€å‰ç«¯çš„æœåŠ¡å™¨ã€‚æ¯”å¦‚ï¼š12345upstream backend &#123; ip_hash; server myback1.proxy.com; server myback2.proxy.com;&#125;ä¸Šè¿°é…ç½®ä¼šä½¿å¾—å®¢æˆ·ç«¯çš„è¯·æ±‚éƒ½ç”±ç¬¬ä¸€å°æœåŠ¡å™¨å¤„ç†ï¼ˆå‰ææ˜¯æ²¡æœ‰å‡ºé”™ï¼‰ï¼Œå¦‚æžœåŽ»æŽ‰ip_hashï¼Œåˆ™ç»„å†…çš„ä¸¤å°æœåŠ¡å™¨è½®æµå“åº”è¯·æ±‚ã€‚keep_aliveæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽæŽ§åˆ¶NginxæœåŠ¡å™¨çš„å·¥ä½œè¿›ç¨‹ä¸ºæœåŠ¡å™¨æ‰“å¼€ä¸€å®šèŒƒå›´çš„ç½‘ç»œè¿žæŽ¥ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1keepalive connections;connectionsç”¨äºŽé™å®šè¯¥èŒƒå›´çš„ä¸Šé™å€¼ã€‚å¦‚æžœè¶…è¿‡è¯¥å€¼ï¼Œå·¥ä½œè¿›ç¨‹å°†é‡‡ç”¨LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç®—æ³•æ¥å…³é—­ç½‘ç»œè¿žæŽ¥ã€‚least_connæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽæŽ§åˆ¶æœåŠ¡å™¨ç»„å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼Œé™¤äº†è€ƒè™‘æƒé‡çš„å¤§å°ä¹‹å¤–ï¼Œæ¯æ¬¡é€‰æ‹©çš„æœåŠ¡å™¨éƒ½æ˜¯å½“å‰ç½‘ç»œè¿žæŽ¥æœ€å°‘çš„é‚£å°ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1least_conn;]]></content>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginx GzipåŽ‹ç¼©]]></title>
    <url>%2FNginx-Gzip%E5%8E%8B%E7%BC%A9.html</url>
    <content type="text"><![CDATA[Nginxå¼€å¯GzipåŽ‹ç¼©å¯ä»¥å°†é¡µé¢èµ„æºè¿›è¡ŒåŽ‹ç¼©åŽä¼ è¾“ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨åˆ¤æ–­é¡µé¢èµ„æºæ˜¯å¦æœ‰è¿›è¡ŒåŽ‹ç¼©ï¼Œå¦‚æžœæœ‰ï¼Œåˆ™å…ˆè¿›è¡Œè§£åŽ‹ç„¶åŽå†æ¸²æŸ“é¡µé¢ã€‚ç›®å‰æµè¡Œçš„æµè§ˆå™¨éƒ½æ”¯æŒäº†è¯¥é¡¹æŠ€æœ¯ï¼ˆé™¤äº†è¿œå¤æ—¶ä»£çš„IE6ï¼‰ã€‚GzipåŽ‹ç¼©å¯ä»¥é™ä½Žç½‘ç»œå¸¦å®½æ¶ˆè€—ï¼ŒåŒæ—¶æå‡è®¿é—®é€Ÿåº¦ï¼Œä½¿è®¿é—®è€…æ‹¥æœ‰æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ngx_http_gzip_moduleè¯¥æ¨¡å—é»˜è®¤å¼€å¯ï¼Œä¸»è¦è´Ÿè´£GzipåŠŸèƒ½çš„å¼€å¯ä¸Žè®¾ç½®ï¼Œå¯¹å“åº”æ•°æ®è¿›è¡Œåœ¨çº¿å®žæ—¶åŽ‹ç¼©ã€‚æ¶‰åŠçš„æŒ‡ä»¤ä¸»è¦æœ‰ä»¥ä¸‹9ä¸ªï¼šgzipæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽå¼€å¯æˆ–å…³é—­GzipåŠŸèƒ½ï¼Œè¯­æ³•ç»“æž„å¦‚ä¸‹ï¼š1gzip on | offé»˜è®¤å€¼ä¸ºoffã€‚gzip_buffersæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽè®¾ç½®GzipåŽ‹ç¼©æ–‡ä»¶ä½¿ç”¨ç¼“å­˜ç©ºé—´çš„å¤§å°ï¼Œè¯­æ³•ç»“æž„å¦‚ä¸‹ï¼š1gzip_buffers number size;NginxæœåŠ¡å™¨åœ¨è¿›è¡ŒåŽ‹ç¼©æ—¶ï¼Œéœ€è¦å‘ç³»ç»Ÿç”³è¯·number*sizeå¤§å°çš„ç©ºé—´ç”¨äºŽå­˜å‚¨åŽ‹ç¼©æ•°æ®ã€‚é»˜è®¤æƒ…å†µä¸‹number*sizeçš„å€¼ä¸º128ï¼Œsizeå€¼ä¸ºç³»ç»Ÿå†…å­˜é¡µä¸€é¡µçš„å¤§å°ï¼Œä¸º4Kæˆ–8kï¼Œå³ï¼š1gzip_buffers 32 4k | 16 8kgzip_comp_levelæŒ‡ä»¤ç”¨äºŽè®¾å®šGzipåŽ‹ç¼©çŽ‡ã€‚åŽ‹ç¼©çŽ‡çº§åˆ«ä»Ž1åˆ°9ï¼Œå…¶ä¸­1è¡¨ç¤ºåŽ‹ç¼©çŽ‡æœ€ä½Žï¼ŒåŽ‹ç¼©æ—¶é—´æœ€çŸ­ï¼›9è¡¨ç¤ºåŽ‹ç¼©çŽ‡æœ€é«˜ï¼ŒåŽ‹ç¼©æ—¶é—´æœ€é•¿ã€‚è¯­æ³•ç»“æž„å¦‚ä¸‹ï¼š1gzip_comp_level levelé»˜è®¤å€¼ä¸º1ã€‚gzip_disableæŒ‡ä»¤é’ˆå¯¹ä¸åŒç±»åž‹çš„å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚ï¼Œå¯ä»¥é€‰æ‹©æ€§çš„å¼€å¯æˆ–å…³é—­GzipåŠŸèƒ½ã€‚æ¯”å¦‚IE6å¯¹Gzipçš„æ”¯æŒä¸å¥½ï¼Œæ‰€ä»¥å¦‚æžœå‘é€è¯·æ±‚çš„å®¢æˆ·ç«¯ä¸ºIE6ï¼Œåˆ™å…³é—­Gzipçš„åŠŸèƒ½ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1gzip_disable regex ...å…¶ä¸­regexä¸ºæµè§ˆå™¨çš„UAæ ‡å¿—çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚æ¯”å¦‚ï¼š1gzip_disable MSIE [4-6]\.å³UAå­—ç¬¦ä¸²åŒ…æ‹¬MSIE 4ï¼ŒMSIE 5ï¼ŒMSIE 6çš„æµè§ˆå™¨å‘é€çš„è¯·æ±‚ï¼ŒNginxå°†ä¸è¿›è¡ŒGzipåŽ‹ç¼©ã€‚gzip_http_versionæŒ‡ä»¤æ—©æœŸçš„HTTPå®¢æˆ·ç«¯å¯èƒ½ä¸æ”¯æŒGzipçš„è‡ªè§£åŽ‹ï¼Œæ‰€ä»¥è¯¥æŒ‡ä»¤ç”¨äºŽé™åˆ¶å¼€å¯GzipåŽ‹ç¼©çš„æœ€ä½ŽHTTPåè®®ç‰ˆæœ¬ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1gzip_http_version 1.0 | 1.1é»˜è®¤å€¼ä¸º1.1ã€‚ç›®å‰æ¥è¯´å¤§å¤šæ•°æµè§ˆå™¨éƒ½æ”¯æŒGzipè‡ªè§£åŽ‹ï¼Œæ‰€ä»¥é‡‡ç”¨é»˜è®¤å€¼å³å¯ã€‚gzip_min_lengthæŒ‡ä»¤GzipåŽ‹ç¼©åŠŸèƒ½å¯¹äºŽsizeè¾ƒå¤§çš„æ–‡ä»¶åŽ‹ç¼©æ•ˆæžœæ˜Žæ˜¾ï¼Œè€Œå¯¹äºŽä¸€äº›sizeå¾ˆå°çš„æ–‡ä»¶å¯èƒ½ä¼šå‡ºçŽ°æ•°æ®é‡è¶ŠåŽ‹ç¼©è¶Šå¤§çš„æƒ…å†µã€‚æ‰€ä»¥ä¸ºäº†é˜²æ­¢å‡ºçŽ°è¿™ç§æƒ…å†µï¼Œå¯ç”¨è¯¥æŒ‡ä»¤æ¥é™åˆ¶åŽ‹ç¼©çš„æœ€ä½Žæ•°æ®é‡ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1gzip_min_length lengthé»˜è®¤å€¼ä¸º20ï¼Œä¸º0æ—¶è¡¨ç¤ºä¸è¿›è¡Œé™åˆ¶ã€‚ä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸º1kbå³å¯ã€‚gzip_proxiedæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽè®¾ç½®NginxæœåŠ¡å™¨æ˜¯å¦å¯¹åŽç«¯æœåŠ¡å™¨è¿”å›žçš„ç»“æžœè¿›è¡ŒGzipåŽ‹ç¼©ã€‚è¯¥æŒ‡ä»¤åœ¨ä½¿ç”¨NginxæœåŠ¡å™¨çš„åå‘ä»£ç†åŠŸèƒ½æ—¶æœ‰æ•ˆã€‚è¯­æ³•å¦‚ä¸‹ï¼š1gzip_proxied off | expired | no-cache | no-store | private | no_last_modified | no_etag | auth | any ...offå…³é—­NginxæœåŠ¡å™¨å¯¹åŽç«¯æœåŠ¡å™¨è¿”å›žç»“æžœè¿›è¡ŒGzipåŽ‹ç¼©ï¼Œä¸ºé»˜è®¤å€¼ã€‚expiredå½“åŽç«¯æœåŠ¡å™¨å“åº”é¡µå¤´éƒ¨åŒ…å«ç”¨äºŽæŒ‡ç¤ºå“åº”æ•°æ®è¿‡æœŸæ—¶é—´çš„expiredå¤´åŸŸæ—¶ï¼Œå¼€å¯GzipåŽ‹ç¼©ã€‚no-cacheå½“åŽç«¯æœåŠ¡å™¨å“åº”é¡µå¤´éƒ¨åŒ…å«ç”¨äºŽé€šçŸ¥æ‰€æœ‰ç¼“å­˜æœºåˆ¶æ˜¯å¦ç¼“å­˜çš„Cache-controlå¤´åŸŸä¸”å…¶æŒ‡ä»¤å€¼ä¸ºno-cacheæ—¶ï¼Œå¼€å¯GzipåŽ‹ç¼©ã€‚no-storeå½“åŽç«¯æœåŠ¡å™¨å“åº”é¡µå¤´éƒ¨åŒ…å«ç”¨äºŽé€šçŸ¥æ‰€æœ‰ç¼“å­˜æœºåˆ¶æ˜¯å¦ç¼“å­˜çš„Cache-controlå¤´åŸŸä¸”å…¶æŒ‡ä»¤å€¼ä¸ºno-storeæ—¶ï¼Œå¼€å¯GzipåŽ‹ç¼©ã€‚privateå½“åŽç«¯æœåŠ¡å™¨å“åº”é¡µå¤´éƒ¨åŒ…å«ç”¨äºŽé€šçŸ¥æ‰€æœ‰ç¼“å­˜æœºåˆ¶æ˜¯å¦ç¼“å­˜çš„Cache-controlå¤´åŸŸä¸”å…¶æŒ‡ä»¤å€¼ä¸ºprivateæ—¶ï¼Œå¼€å¯GzipåŽ‹ç¼©ã€‚no_last_modifiedå½“åŽç«¯æœåŠ¡å™¨å“åº”é¡µå¤´éƒ¨ä¸åŒ…å«ç”¨äºŽæŒ‡æ˜Žéœ€è¦èŽ·å–æ•°æ®æœ€åŽä¿®æ”¹æ—¶é—´çš„Last-Modifiedå¤´åŸŸæ—¶ï¼Œå¼€å¯GzipåŽ‹ç¼©ã€‚no-etagå½“åŽç«¯æœåŠ¡å™¨å“åº”é¡µå¤´éƒ¨ä¸åŒ…å«ç”¨äºŽæ ‡è¯†è¢«è¯·æ±‚å˜é‡çš„å®žä½“å€¼çš„ETagå¤´åŸŸæ—¶ï¼Œå¼€å¯GzipåŽ‹ç¼©ã€‚authå½“åŽç«¯æœåŠ¡å™¨å“åº”é¡µå¤´éƒ¨åŒ…å«ç”¨äºŽæ ‡è¯†HTTPæŽˆæƒè¯ä¹¦çš„Authorizationå¤´åŸŸæ—¶ï¼Œå¼€å¯GzipåŽ‹ç¼©ã€‚anyæ— æ¡ä»¶å¼€å¯GzipåŽ‹ç¼©ã€‚gzip_typesæŒ‡ä»¤æ ¹æ®å“åº”é¡µçš„MIMEç±»åž‹é€‰æ‹©æ€§çš„å¼€å¯GzipåŽ‹ç¼©ã€‚è¯­æ³•ä¸ºï¼š1gzip_types mime-types ...é»˜è®¤å€¼ä¸ºtext/htmlï¼Œå˜é‡å€¼è¿˜å¯ä»¥å–*ï¼Œè¡¨ç¤ºå¯¹æ‰€æœ‰MIMEç±»åž‹çš„é¡µé¢æ•°æ®éƒ½è¿›è¡ŒGzipåŽ‹ç¼©ã€‚gzip_varyæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽè®¾ç½®åœ¨ä½¿ç”¨äº†GzipåŠŸèƒ½æ—¶æ˜¯å¦å‘é€å¸¦æœ‰â€œvary:Accept-Encodingâ€å¤´åŸŸçš„å“åº”å¤´éƒ¨ã€‚æ¯”å¦‚æ‰“å¼€ç™¾åº¦é¡µé¢çš„æŽ§åˆ¶å°ï¼Œå¯çœ‹åˆ°ï¼šå…¶è¯­æ³•å¦‚ä¸‹ï¼š1gzip_vary on | offé»˜è®¤å€¼ä¸ºoffã€‚ngx_http_gzip_static_moduleè¯¥æ¨¡å—ä¸»è¦è´Ÿè´£æœç´¢å’Œå‘é€ç»è¿‡GzipåŠŸèƒ½é¢„åŽ‹ç¼©çš„æ•°æ®ã€‚å¦‚æžœå®¢æˆ·ç«¯è¯·æ±‚çš„æ•°æ®åœ¨ä¹‹å‰å°±è¢«åŽ‹ç¼©è¿‡ï¼Œåˆ™ç›´æŽ¥è¿”å›žã€‚å’Œngx_http_gzip_moduleä¸»è¦çš„åŒºåˆ«æ˜¯ï¼Œè¯¥æ¨¡å—ä½¿ç”¨çš„æ˜¯é™æ€åŽ‹ç¼©ï¼Œåœ¨HTTPå“åº”å¤´éƒ¨åŒ…å«Content-Lengthå¤´åŸŸæ¥æŒ‡æ˜ŽæŠ¥æ–‡ä½“çš„é•¿åº¦ï¼Œç”¨äºŽæœåŠ¡å™¨ç¡®å®šå“åº”æ•°æ®çš„é•¿åº¦ã€‚è¯¥æ¨¡å—é»˜è®¤å…³é—­ï¼Œå¦‚æžœéœ€è¦ä½¿ç”¨ï¼Œå¿…é¡»åœ¨Nginxç¨‹åºé…ç½®æ—¶æ·»åŠ â€“with-http_gzip_static_moduleæŒ‡ä»¤ã€‚ä¸Žè¯¥æ¨¡å—æœ‰å…³çš„å‘½ä»¤æœ‰å¦‚ä¸‹å‡ ä¸ªï¼šgzip_staticã€gzip_http_versionã€gzip-proxiedã€gzip_disableå’Œgzip_varyç­‰ã€‚gzip_staticæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽå¼€å¯æˆ–å…³é—­Gzipé™æ€åŽ‹ç¼©ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1gzip_static on | off | alwayså…¶ä½™æŒ‡ä»¤å’Œngx_http_gzip_moduleç±»ä¼¼ã€‚ngx_http_gunzip_moduleè¯¥æ¨¡å—ç”¨æ¥é’ˆå¯¹ä¸æ”¯æŒGzipåŽ‹ç¼©æ•°æ®å¤„ç†çš„å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œå¯¹åŽ‹ç¼©æ•°æ®è¿›è¡Œè§£åŽ‹å¤„ç†ã€‚æœ‰å…³çš„å‘½ä»¤å¦‚ä¸‹ï¼šgunzipã€gunzip_buffersã€gzip_http_versionã€gzip_proxiedã€gzip_disableå’Œgzip_varyç­‰ã€‚è¯¥æ¨¡å—é»˜è®¤å…³é—­ï¼Œå¦‚æžœéœ€è¦ä½¿ç”¨ï¼Œå¿…é¡»åœ¨Nginxç¨‹åºé…ç½®æ—¶æ·»åŠ  â€“with-http_gunzip_moduleæŒ‡ä»¤ã€‚gunzipæŒ‡ä»¤è¯¥æŒ‡ä»¤ç”¨äºŽå¼€å¯æˆ–å…³é—­è¯¥æ¨¡å—çš„åŠŸèƒ½ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1gunzip_static on | offå¯ç”¨è¯¥åŠŸèƒ½åŽï¼Œå¦‚æžœå®¢æˆ·ç«¯æµè§ˆå™¨ä¸æ”¯æŒGzipæ•°æ®å¤„ç†æ—¶ï¼ŒNginxåªæ˜¯åœ¨å°†æ•°æ®è¿”å›žç»™æµè§ˆå™¨å‰è¿›è¡Œäº†è§£åŽ‹å¤„ç†ã€‚å½“Nginxå’ŒåŽç«¯æœåŠ¡å™¨äº¤äº’çš„æ•°æ®æˆ–è€…æœ¬èº«å­˜å‚¨çš„æ•°æ®è¿˜æ˜¯ä½¿ç”¨äº†GzipåŽ‹ç¼©çš„ã€‚è¿™æ ·åšæ˜¯å¯ä»¥ä¿è¯æµè§ˆå™¨è§£æžæ•°æ®ä¸å‡ºçŽ°é—®é¢˜ï¼ŒåŒæ—¶å‡å°‘äº†å’ŒåŽç«¯æœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“é‡ï¼Œé™ä½Žäº†æœ¬åœ°çš„å­˜å‚¨ç©ºé—´å’Œç¼“å­˜çš„ä½¿ç”¨çŽ‡ã€‚å…¶ä½™æŒ‡ä»¤å’Œngx_http_gzip_moduleæ¨¡å—ç±»ä¼¼ã€‚é…ç½®å®žä¾‹ä½¿ç”¨hexoç”Ÿæˆçš„é™æ€é¡µé¢ä¸ºä¾‹å­ï¼Œé…ç½®Nginxå¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748worker_processes 1;error_log logs/error.log;events &#123; worker_connections 1024; use epoll;&#125;http &#123; include mime.types; default_type application/octet-stream; sendfile on; keepalive_timeout 65; gzip on; gzip_min_length 1024; gzip_buffers 4 16k; gzip_comp_level 2; gzip_types text/plain application/x-javascript text/css application/xml; gzip_vary on; gzip_disable "MSIE [1-6]\."; server &#123; listen 80; server_name localhost; charset utf-8; location /index &#123; alias /home/mrbird/mrbirdcc; index index.html; &#125; &#125; server &#123; listen 8082; server_name 192.168.112.130; charset utf-8; gzip off; # å…³é—­GzipåŽ‹ç¼© location /index &#123; alias /home/mrbird/mrbirdcc; index index.html; &#125; &#125;&#125;å¯åŠ¨Nginxï¼Œè®¿é—®å¼€å¯äº†GzipåŽ‹ç¼©çš„locationï¼šhttp://localhost/index/ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼šå¯è§å¼€å¯GzipåŽ‹ç¼©åŽï¼Œæ–‡ä»¶å¤§å°å˜å°äº†ï¼Œå¹¶ä¸”å“åº”å¤´éƒ¨åŒ…å«Content-Encoding: gzipã€‚è®¿é—®æœªå¼€å¯GzipåŽ‹ç¼©çš„locationï¼šhttp://192.168.112.130:8082/index/ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š]]></content>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginxçš„åŸºæœ¬é…ç½®]]></title>
    <url>%2FNginx%20basic%20config.html</url>
    <content type="text"><![CDATA[Nginxé…ç½®æ–‡ä»¶ä¸»è¦åˆ†æˆå››éƒ¨åˆ†ï¼šmainï¼ˆå…¨å±€è®¾ç½®ï¼‰ã€httpï¼ˆHTTPçš„é€šç”¨è®¾ç½®ï¼‰ã€serverï¼ˆè™šæ‹Ÿä¸»æœºè®¾ç½®ï¼‰ã€locationï¼ˆåŒ¹é…URLè·¯å¾„ï¼‰ã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–çš„é…ç½®æ®µï¼Œå¦‚eventï¼Œupstreamç­‰ã€‚ä¸€ä¸ªå®Œæ•´çš„Nginxé…ç½®å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374user www www; ## Default: nobodyworker_processes 5; ## Default: 1error_log logs/error.log;pid logs/nginx.pid;worker_rlimit_nofile 8192;events &#123; worker_connections 4096; ## Default: 1024 multi_accept on; use epoll;&#125;http &#123; include conf/mime.types; include /etc/nginx/proxy.conf; include /etc/nginx/fastcgi.conf; index index.html index.htm index.php; default_type application/octet-stream; log_format main '$remote_addr - $remote_user [$time_local] $status ' '"$request" $body_bytes_sent "$http_referer" ' '"$http_user_agent" "$http_x_forwarded_for"'; access_log logs/access.log main; sendfile on; tcp_nopush on; server_names_hash_bucket_size 128; # this seems to be required for some vhosts server &#123; # php/fastcgi listen 80; server_name domain1.com www.domain1.com; access_log logs/domain1.access.log main; root html; location ~ \.php$ &#123; fastcgi_pass 127.0.0.1:1025; &#125; &#125; server &#123; # simple reverse-proxy listen 80; server_name domain2.com www.domain2.com; access_log logs/domain2.access.log main; # serve static files location ~ ^/(images|javascript|js|css|flash|media|static)/ &#123; root /var/www/virtual/big.server.com/htdocs; expires 30d; &#125; # pass requests for dynamic content to rails/turbogears/zope, et al location / &#123; proxy_pass http://127.0.0.1:8080; &#125; &#125; upstream big_server_com &#123; server 127.0.0.3:8000 weight=5; server 127.0.0.3:8001 weight=5; server 192.168.0.1:8000; server 192.168.0.1:8001; &#125; server &#123; # simple load balancing listen 80; server_name big.server.com; access_log logs/big.server.access.log main; location / &#123; proxy_pass http://big_server_com; &#125; &#125;&#125;NginxåŸºç¡€é…ç½®æŒ‡ä»¤userç”¨äºŽæŒ‡å®šè¿è¡ŒNginxçš„ç”¨æˆ·å’Œç»„ï¼š1user user [group]åªæœ‰è¢«è®¾ç½®çš„ç”¨æˆ·æˆ–è€…ç”¨æˆ·ç»„æˆå‘˜æ‰æœ‰æƒé™å¯åŠ¨NginxæœåŠ¡ã€‚å¦‚æžœå¸Œæœ›æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥å¯åŠ¨Nginxï¼Œåˆ™åªéœ€å°†å…¶æ³¨é‡ŠæŽ‰æˆ–è€…æŒ‡å®šä¸ºï¼š1user nobody nobodyworker_processesæŒ‡å®šNginxçš„å·¥ä½œè¿›ç¨‹çš„ä¸ªæ•°ï¼Œå¯ä»¥è®¾ç½®ä¸ºä¸Ž CPU æ•°é‡ç›¸åŒï¼ŒåŸºæœ¬è¯­æ³•ï¼š1worker_processes number|autoè®¾ç½®ä¸ºautoæ—¶ï¼ŒNginxè¿›ç¨‹å°†è‡ªåŠ¨æ£€æµ‹ã€‚å½“worker_processesè®¾ç½®ä¸º1æ—¶ï¼š12345# sbin/nginx # ps -ef|grep nginxroot 5882 1326 0 13:07 ? 00:00:00 nginx: master process sbin/nginxnobody 5883 5882 0 13:07 ? 00:00:00 nginx: worker processroot 5885 5430 0 13:07 pts/1 00:00:00 grep --color=auto nginxå°†worker_processesè®¾ç½®ä¸º3æ—¶ï¼š123456# ps -ef|grep nginxroot 5919 1326 0 13:09 ? 00:00:00 nginx: master process sbin/nginxnobody 5920 5919 0 13:09 ? 00:00:00 nginx: worker processnobody 5921 5919 0 13:09 ? 00:00:00 nginx: worker processnobody 5922 5919 0 13:09 ? 00:00:00 nginx: worker processroot 5924 5430 0 13:09 pts/1 00:00:00 grep --color=auto nginxworker_processesè¿›ç¨‹æ•°å˜æˆäº†3ä¸ªã€‚error_logç”¨äºŽé…ç½®é”™è¯¯æ—¥å¿—çš„å­˜æ”¾è·¯å¾„ã€‚httpï¼Œserverå’Œlocationå—ä¹Ÿå¯é…ç½®error_logï¼ŒåŒºåˆ«åœ¨äºŽçº§åˆ«ä¸ä¸€æ ·ã€‚åŸºæœ¬è¯­æ³•ï¼š1error_log files|stderr [ debug | info | notice | warn | error | crit | alert | emerg ]debugçº§åˆ«æœ€é«˜ï¼Œemergçº§åˆ«æœ€ä½Žã€‚æ¯”å¦‚è®¾ç½®çº§åˆ«ä¸ºwarnåŽï¼Œwarnï¼Œerrorï¼Œcritï¼Œalertå’Œemergçº§åˆ«çš„æ—¥å¿—éƒ½ä¼šè¢«è®°å½•ã€‚Nginxé»˜è®¤æ—¥å¿—å­˜æ”¾è·¯å¾„ä¸ºï¼šlogs/error.logã€‚pidpidæŒ‡ä»¤ç”¨äºŽæŒ‡å®šå­˜æ”¾Nginxä¸»è¿›ç¨‹å·å­˜æ”¾æ–‡ä»¶çš„è·¯å¾„ã€‚é»˜è®¤çš„è·¯å¾„ä¸ºï¼š123# ./sbin/nginx # cat logs/nginx.pid 101106worker_rlimit_nofileè®¾ç½®æ¯Žä¸ªè¿›ç¨‹çš„æœ€å¤§æ–‡ä»¶æ‰“å¼€æ•°ã€‚å¦‚æžœä¸è®¾çš„è¯ä¸Šé™å°±æ˜¯ç³»ç»Ÿçš„ulimit â€“nçš„æ•°å­—ï¼ˆ1024ï¼‰ã€‚worker_connectionsè®¾å®šä¸€ä¸ªworkerè¿›ç¨‹çš„æœ€å¤§è¿žæŽ¥æ•°ã€‚é»˜è®¤ä¸º512ï¼ŒæŒ‰è‡ªå·±ç³»ç»Ÿçš„ç¡¬ä»¶é…ç½®è°ƒæ•´ï¼Œä¸èƒ½è¶…è¿‡worker_rlimit_nofileã€‚includeincludeæŒ‡ä»¤ç”¨äºŽå¼•å…¥ç¬¬ä¸‰æ–¹é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚å¸¸è§çš„MIMEç±»åž‹ç­‰ã€‚accept_mutexè¯¥æ¡æŒ‡ä»¤ç›®çš„æ˜¯ä¸ºäº†è§£å†³â€œæƒŠç¾¤â€çš„é—®é¢˜ã€‚â€œæƒŠç¾¤â€å¤§è‡´æ„æ€æ˜¯ï¼šå½“æŸä¸ªæ—¶åˆ»åªæœ‰ä¸€ä¸ªç½‘ç»œè¿žæŽ¥æ—¶ï¼Œå¤šä¸ªè¿›ç¨‹ä¼šè¢«åŒæ—¶å”¤é†’ï¼Œä½†æœ€ç»ˆå®žé™…ä¸Šåªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥èŽ·å¾—è¿žæŽ¥ï¼Œç”±äºŽå”¤é†’äº†åˆ«çš„ä¸å¿…è¦çš„è¿›ç¨‹ï¼Œé€ æˆäº†æ€§èƒ½çš„æµªè´¹ã€‚accept_mutexè¯­æ³•å¦‚ä¸‹ï¼š1accept_mutex on | offé»˜è®¤ä¸ºå¼€å¯ï¼ˆonï¼‰çŠ¶æ€ï¼Œåªèƒ½åœ¨eventså—ä¸­è¿›è¡Œè®¾ç½®ã€‚multi_acceptç”¨äºŽè®¾ç½®æ˜¯å¦å…è®¸worker_processåŒæ—¶æŽ¥å—å¤šä¸ªç½‘ç»œè¿žæŽ¥ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1multi_accept on | offå…¶é»˜è®¤ä¸ºå…³é—­ï¼ˆoffï¼‰çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªworker_processä¸€æ¬¡åªèƒ½æŽ¥æ”¶ä¸€ä¸ªæ–°åˆ°è¾¾çš„ç½‘ç»œè¿žæŽ¥ã€‚è¯¥æŒ‡ä»¤åªèƒ½åœ¨eventsæ¨¡å—ä¸­è®¾ç½®ã€‚useuseæŒ‡ä»¤ç”¨äºŽé€‰æ‹©äº‹ä»¶çš„é©±åŠ¨æ¨¡åž‹ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1use methodNginxæä¾›äº†å¤šç§äº‹ä»¶é©±åŠ¨æ¨¡åž‹æ¥å¤„ç†ç½‘ç»œæ¶ˆæ¯ï¼Œmethodå¯é€‰çš„å†…å®¹æœ‰ï¼šselectï¼Œpollï¼Œkqueueï¼Œepollï¼Œrtsigï¼Œ/dev/pollå’Œeventportã€‚è¯¥æŒ‡ä»¤åªèƒ½åœ¨eventsæ¨¡å—ä¸­è®¾ç½®ã€‚worker_connentionsç”¨äºŽè®¾ç½®æ¯ä¸ªworker_processæœ€å¤§çš„è¿žæŽ¥æ•°ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1worker_process numberè¯¥æŒ‡ä»¤åªèƒ½åœ¨eventsæ¨¡å—ä¸­è®¾ç½®ã€‚æŒ‡å®šMIMEåœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¸¤æ¡é…ç½®ï¼š12include conf/mime.types;default_type application/octet-stream;includeæŒ‡ä»¤å¼•å…¥äº†mime.typesæ–‡ä»¶ï¼Œå…¶ä¸­mime.typeså†…å®¹å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930types &#123; text/html html htm shtml; text/css css; text/xml xml; image/gif gif; image/jpeg jpeg jpg; application/javascript js; application/atom+xml atom; application/rss+xml rss; text/mathml mml; text/plain txt; text/vnd.sun.j2me.app-descriptor jad; text/vnd.wap.wml wml; text/x-component htc; ... video/3gpp 3gpp 3gp; video/mp2t ts; video/mp4 mp4; video/mpeg mpeg mpg; video/quicktime mov; video/webm webm; video/x-flv flv; video/x-m4v m4v; video/x-mng mng; video/x-ms-asf asx asf; video/x-ms-wmv wmv; video/x-msvideo avi;&#125;default_type application/octet-streamæŒ‡å®šäº†é»˜è®¤ç±»åž‹ä¸ºäºŒè¿›åˆ¶æµã€‚å¦‚æžœä¸æŒ‡å®šçš„è¯ï¼Œé»˜è®¤å€¼ä¸ºtext/plainã€‚è¯¥æŒ‡ä»¤å¯ä»¥åœ¨httpï¼Œserveræˆ–locationæ¨¡å—ä¸­è®¾ç½®ã€‚è‡ªå®šä¹‰æœåŠ¡æ—¥å¿—error_logç”¨äºŽè®°å½•Nginxè¿è¡Œæ—¶çš„å¸¸è§„æ—¥å¿—ï¼Œè€Œaccess_logï¼ˆæœåŠ¡æ—¥å¿—ï¼‰æ˜¯æŒ‡NginxæœåŠ¡å™¨åœ¨å“åº”å„ç§å‰ç«¯è¯·æ±‚çš„æ—¥å¿—ã€‚åŒ…å«ä¸¤ä¸ªæŒ‡ä»¤ï¼šaccess_logå’Œlog_formatã€‚access_logçš„è¯­æ³•å¦‚ä¸‹ï¼š1access_log ptah[format[buffer=size]]pathç”¨äºŽæŒ‡å®šè¯¥æ—¥å¿—çš„å­˜æ”¾è·¯å¾„ï¼Œformatä¸ºå¯é€‰é¡¹ï¼Œä»£æŒ‡è‡ªå®šä¹‰æœåŠ¡æ—¥å¿—çš„æ ¼å¼å­—ç¬¦ä¸²ã€‚sizeä¸ºå¯é€‰é¡¹ï¼Œç”¨äºŽé…ç½®ä¸´æ—¶å­˜æ”¾æ—¥å¿—çš„å†…å­˜ç¼“å­˜åŒºå¤§å°ã€‚log_formatçš„è¯­æ³•å¦‚ä¸‹ï¼š1log_format name string ...nameç”¨äºŽä¸ºè¯¥æ ¼å¼å®šä¹‰ä¸€ä¸ªå˜é‡åï¼Œä¾›access_logæŒ‡ä»¤ä½¿ç”¨ã€‚stringä¸ºæ ¼å¼å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ï¼š$remote_addr - $remote_user [$time_local] $statuså…¶ä¸­$remote_addrç­‰ä¸ºNginxé¢„è®¾çš„ä¸€äº›å˜é‡ï¼Œå¸¸ç”¨çš„å˜é‡æœ‰ï¼šå‚æ•°è¯´æ˜Žç¤ºä¾‹$remote_addrå®¢æˆ·ç«¯åœ°å€211.28.65.253$remote_userå®¢æˆ·ç«¯ç”¨æˆ·åç§°â€“$time_localè®¿é—®æ—¶é—´å’Œæ—¶åŒº18/Jul/2012:17:00:01 +0800$requestè¯·æ±‚çš„URIå’ŒHTTPåè®®â€œGET /article-10000.html HTTP/1.1â€$http_hostè¯·æ±‚åœ°å€ï¼Œå³æµè§ˆå™¨ä¸­ä½ è¾“å…¥çš„åœ°å€ï¼ˆIPæˆ–åŸŸåï¼‰www.it300.com192.168.100.100$statusHTTPè¯·æ±‚çŠ¶æ€200$upstream_statusupstreamçŠ¶æ€200$body_bytes_sentå‘é€ç»™å®¢æˆ·ç«¯æ–‡ä»¶å†…å®¹å¤§å°1547$http_refererurlè·³è½¬æ¥æºhttps://www.baidu.com/$http_user_agentç”¨æˆ·ç»ˆç«¯æµè§ˆå™¨ç­‰ä¿¡æ¯â€œMozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; SV1; GTB7.0; .NET4.0C;$ssl_protocolSSLåè®®ç‰ˆæœ¬TLSv1$ssl_cipheräº¤æ¢æ•°æ®ä¸­çš„ç®—æ³•RC4-SHA$upstream_addråŽå°upstreamçš„åœ°å€ï¼Œå³çœŸæ­£æä¾›æœåŠ¡çš„ä¸»æœºåœ°å€10.10.10.100:80$request_timeæ•´ä¸ªè¯·æ±‚çš„æ€»æ—¶é—´0.205$upstream_response_timeè¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œupstreamå“åº”æ—¶é—´0.002è¯¥æŒ‡ä»¤åªèƒ½åœ¨httpæ¨¡å—ä¸­è®¾ç½®ã€‚sendfile &amp; sendfile_max_chunksendfileç”¨äºŽå¼€å¯æˆ–å…³é—­ä½¿ç”¨sendfile()ä¼ è¾“æ–‡ä»¶ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1sendfile on | offå¯ä»¥åœ¨httpï¼Œserveræˆ–locationä¸­è¿›è¡Œé…ç½®ã€‚sendfile_max_chunkç”¨äºŽè®¾ç½®Nginxè¿›ç¨‹ä¸­çš„æ¯ä¸ªworker_processæ¯æ¬¡è°ƒç”¨sendfile()ä¼ è¾“çš„æ•°æ®é‡çš„æœ€å¤§å€¼ã€‚é»˜è®¤å€¼ä¸º0ï¼Œè¡¨ç¤ºæ²¡æœ‰é™åˆ¶ã€‚æ¯”å¦‚ï¼š1sendfile_max_chunk 128kè¯¥æŒ‡ä»¤å¯ä»¥åœ¨httpï¼Œserveræˆ–locationå—ä¸­é…ç½®ã€‚keepalive_timeoutç”¨äºŽè®¾ç½®NginxæœåŠ¡å™¨ä¸Žç”¨æˆ·å»ºç«‹ä¼šè¯è¿žæŽ¥ä¿æŒçš„æ—¶é—´ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1keepalive_timeout timeout[header_timeout]timeoutç”¨äºŽè®¾ç½®æœåŠ¡å™¨ç«¯ä¿æŒè¿žæŽ¥çš„æ—¶é—´ï¼›header_timeoutä¸ºå¯é€‰é¡¹ï¼Œç”¨äºŽé…ç½®åº”ç­”æŠ¥æ–‡å¤´éƒ¨çš„Keep-AliveåŸŸçš„å€¼ã€‚è¯¥æŒ‡ä»¤å¯ä»¥åœ¨httpï¼Œserverå’Œlocationå—ä¸­é…ç½®ã€‚keepalive_requestsç”¨äºŽé™åˆ¶ç”¨æˆ·é€šè¿‡æŸä¸€è¿žæŽ¥å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ¬¡æ•°ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1keepalive_requests numberé»˜è®¤å€¼ä¸º100ï¼Œå¯ä»¥åœ¨httpï¼Œserverå’Œlocationå—ä¸­é…ç½®ã€‚listenè¯¥æŒ‡ä»¤ç”¨äºŽé…ç½®ç›‘å¬ã€‚é…ç½®æ–¹æ³•ä¸»è¦æœ‰ä¸‰ç§ï¼š1ã€é…ç½®ç›‘å¬çš„IPåœ°å€ï¼š1listen address[:port] [default_server] [setfib=number] [backlog=number] [rcvbuf=size] [sndbuf=size] [deferred] [accept_filter=filter] [bind] [ssl]2ã€é…ç½®ç›‘å¬ç«¯å£1listen port [default_server] [setfib=number] [backlog=number] [rcvbuf=size] [sndbuf=size] [deferred] [accept_filter=filter] [bind] [ipv6only=on|off] [ssl]3ã€é…ç½®UNIX Domain Socket1listen unix:path [default_server] [setfib=number] [backlog=number] [rcvbuf=size] [sndbuf=size] [deferred] [accept_filter=filter] [bind] [ssl]addressï¼ŒIPåœ°å€ï¼Œå¦‚æžœæ˜¯IPv6çš„åœ°å€ï¼Œéœ€ä½¿ç”¨[]ï¼Œæ¯”å¦‚[fe80 ::1]ã€‚portï¼Œç«¯å£å·ã€‚pathï¼Œsocketæ–‡ä»¶è·¯å¾„ï¼Œå¦‚/var/run/nginx.sockç­‰ã€‚default_serverï¼Œæ ‡è¯†ç¬¦ï¼Œè¡¨ç¤ºè®¾ç½®ä¸ºé»˜è®¤ä¸»æœºã€‚rcvbuf=sizeï¼Œè®¾ç½®ç›‘å¬socketæŽ¥æ”¶ç¼“å­˜åŒºå¤§å°ã€‚sndbuf=sizeï¼Œè®¾ç½®ç›‘å¬socketå‘é€ç¼“å­˜åŒºå¤§å°ã€‚deferredï¼Œæ ‡è¯†ç¬¦ï¼Œå°†accept()è®¾ç½®ä¸ºDeferredæ¨¡å¼ã€‚accept_filter=filterï¼Œè®¾ç½®ç›‘å¬ç«¯å£å¯¹è¯·æ±‚çš„è¿‡æ»¤ ï¼Œè¢«è¿‡æ»¤çš„å†…å®¹ä¸èƒ½è¢«æŽ¥æ”¶å’Œå¤„ç†ã€‚sslï¼Œæ ‡è¯†ç¬¦ï¼Œè®¾ç½®ä¼šè¯è¿žæŽ¥ä½¿ç”¨SSLæ¨¡å¼è¿›è¡Œã€‚ä¸€äº›ä¾‹å­ï¼š1234listen *:80 | *:8080; #ç›‘å¬æ‰€æœ‰80ç«¯å£å’Œ8080ç«¯å£listen 192.168.1.10:8080; #ç›‘å¬å…·ä½“IPå’Œå…·ä½“ç«¯å£ä¸Šçš„è¿žæŽ¥listen 8000; #ç›‘å¬æ‰€æœ‰IPåœ°å€çš„8000ç«¯å£ï¼Œç­‰åŒäºŽ listen *:8000listen 192.168.1.10 default_server; #è®¾ç½®192.168.1.10çš„è¿žæŽ¥è¯·æ±‚é»˜è®¤ç”±æ­¤è™šæ‹Ÿä¸»æœºå¤„ç†server_nameNginxé…ç½®æ–‡ä»¶ä¸­çš„æ¯ä¸ªserverå—å¯¹äºŽä¸€ä¸ªè™šæ‹Ÿä¸»æœºé…ç½®ï¼Œserver_nameç”¨äºŽæŒ‡å®šè™šæ‹Ÿä¸»æœºçš„åç§°ï¼Œç”¨æˆ·å¯é€šè¿‡è¿™ä¸ªåç§°æ¥å‘æ­¤è™šæ‹Ÿä¸»æœºå‘é€è¯·æ±‚ã€‚server_nameçš„é…ç½®åˆ†ä¸ºåç§°å’ŒIPä¸¤ç§æ–¹å¼ã€‚åŸºäºŽåç§°çš„è™šæ‹Ÿä¸»æœºé…ç½®åŸºäºŽåç§°çš„è™šæ‹Ÿä¸»æœºé…ç½®æ—¶ï¼Œserver_nameçš„è¯­æ³•å¦‚ä¸‹ï¼š1server_name name ...nameå¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªåç§°å¹¶åˆ—ï¼Œç”¨ç©ºæ ¼éš”å¼€ã€‚æ¯ä¸ªåç§°å¯¹åº”ä¸€ä¸ªåŸŸåï¼Œç”±ä¸¤æ®µæˆ–è€…ä¸‰æ®µç»„æˆï¼Œä¹‹é—´ç”±.éš”å¼€ã€‚æ¯”å¦‚ï¼š1server_name www.mrbird.cc mrbird.cc;1ã€åœ¨nameä¸­å¯ä»¥ä½¿ç”¨é€šé…ç¬¦*ï¼Œé€šé…ç¬¦å¯ç”¨åœ¨ä¸‰æ®µå¼åŸŸåçš„å¤´æˆ–å°¾ï¼Œæˆ–ä¸¤æ®µå¼åŸŸåçš„å°¾éƒ¨ï¼Œæ¯”å¦‚ï¼š1server_name *.mrbird.cc mrbird.*;2ã€åœ¨nameä¸­è¿˜å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚ä½¿ç”¨~ä½œä¸ºæ­£åˆ™è¡¨è¾¾å¼å¼€å§‹çš„æ ‡è®°ï¼Œæ¯”å¦‚ï¼š1server_name ~^www\d+\.mrbird\.cc$;æ­¤æ—¶æ¯”å¦‚é€šè¿‡www1.mrbird.ccå¯ä»¥è®¿é—®NginxæœåŠ¡ï¼Œè€Œwww.mrbird.ccä¸å¯ä»¥ã€‚nameä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒå­—ç¬¦ä¸²æ•èŽ·åŠŸèƒ½ï¼Œå­—ç¬¦ä¸²æ•èŽ·é€šè¿‡( )æ¥æ‹¾å–åŽé¢ä¸ç´§è·Ÿå…¶ä»–çš„æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ã€‚ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªä¸åµŒå¥—çš„å°æ‹¬å·ï¼Œè¿™äº›å†…å®¹ä¼šä»Žå·¦åˆ°å³ä¾æ¬¡å­˜æ”¾åœ¨å˜é‡$1ã€$2ã€$3â€¦â€¦ä¸­ã€‚ä¸‹æ–‡ä½¿ç”¨æ—¶å°±å¯ç›´æŽ¥ä½¿ç”¨è¿™äº›å˜é‡ï¼Œä½œç”¨åŸŸä¸ºå½“å‰çš„serverå—ã€‚æ¯”å¦‚æœ‰å¦‚ä¸‹çš„server_nameé…ç½®ï¼š1server_name ~^www\.(.+)\.cc$;å½“é€šè¿‡www.mrbird.ccè®¿é—®NginxæœåŠ¡å™¨æ—¶ï¼Œå°†ä¼šè¢«ä¸Šé¢çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æˆåŠŸï¼Œmrbirdå°†ä¼šè¢«æ•èŽ·ï¼Œå¹¶ä¸”èµ‹å€¼ç»™$1ã€‚ç”±äºŽæœ‰ä¸¤ç§åŒ¹é…çš„æ–¹å¼ï¼Œæ‰€ä»¥æœ‰å¯èƒ½å‡ºçŽ°ä¸¤ç§æƒ…å†µéƒ½åŒ¹é…çš„æ—¶å€™ï¼Œè¿™æ—¶å€™NginxæŒ‰ç…§ä»¥ä¸‹çš„ä¼˜å…ˆçº§è¿›è¡Œé€‰æ‹©ï¼šå‡†ç¡®åŒ¹é…server_nameã€‚é€šé…ç¬¦åœ¨å¼€å§‹æ—¶åŒ¹é…server_nameæˆåŠŸã€‚é€šé…ç¬¦åœ¨ç»“æŸæ—¶åŒ¹é…server_nameæˆåŠŸã€‚æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…server_nameæˆåŠŸã€‚æ­¤å¤–ï¼Œå¦‚æžœserver_nameè¢«å¤„äºŽåŒä¸€ä¼˜å…ˆçº§çš„åŒ¹é…æ–¹å¼å¤šæ¬¡åŒ¹é…æˆåŠŸï¼Œåˆ™ä»¥é¦–å…ˆåŒ¹é…æˆåŠŸçš„ä¸ºä¸»ã€‚åŸºäºŽIPçš„è™šæ‹Ÿä¸»æœºé…ç½®Linuxæ“ä½œç³»ç»Ÿæ”¯æŒIPåˆ«åçš„æ·»åŠ ï¼Œé…ç½®åŸºäºŽIPçš„è™šæ‹Ÿä¸»æœºï¼Œå³ä¸ºNginxæœåŠ¡å™¨æä¾›çš„æ¯å°è™šæ‹Ÿä¸»æœºé…ç½®ä¸€ä¸ªä¸åŒçš„IPã€‚æŸ¥çœ‹å½“å‰ç½‘ç»œé…ç½®ï¼š123456789101112131415161718# ifconfigens33 Link encap:Ethernet HWaddr 00:0c:29:25:f3:bb inet addr:192.168.112.128 Bcast:192.168.112.255 Mask:255.255.255.0 inet6 addr: fe80::4fe4:f0e0:9e9b:7ec/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:360100 errors:0 dropped:0 overruns:0 frame:0 TX packets:89081 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:504446360 (504.4 MB) TX bytes:7347923 (7.3 MB)lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:35127 errors:0 dropped:0 overruns:0 frame:0 TX packets:35127 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1 RX bytes:2931450 (2.9 MB) TX byens33ä¸ºæ­£åœ¨ä½¿ç”¨çš„ç½‘å¡ï¼ŒIPä¸º192.168.112.128ï¼Œç»™å…¶æ·»åŠ ä¸¤ä¸ªIPåˆ«å192.168.112.130å’Œ192.168.112.131ï¼š12345678910111213141516171819202122232425262728# ifconfig ens33:0 192.168.112.130 Mask 255.255.255.0 up # ifconfig ens33:1 192.168.112.131 Mask 255.255.255.0 up # ifconfigens33 Link encap:Ethernet HWaddr 00:0c:29:25:f3:bb inet addr:192.168.112.128 Bcast:192.168.112.255 Mask:255.255.255.0 inet6 addr: fe80::4fe4:f0e0:9e9b:7ec/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:360100 errors:0 dropped:0 overruns:0 frame:0 TX packets:89081 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:504446360 (504.4 MB) TX bytes:7347923 (7.3 MB)ens33:0 Link encap:Ethernet HWaddr 00:0c:29:25:f3:bb inet addr:192.168.112.130 Bcast:192.168.112.255 Mask:255.255.255.0 UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1ens33:1 Link encap:Ethernet HWaddr 00:0c:29:25:f3:bb inet addr:192.168.112.131 Bcast:192.168.112.255 Mask:255.255.255.0 UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 inet6 addr: ::1/128 Scope:Host UP LOOPBACK RUNNING MTU:65536 Metric:1 RX packets:221 errors:0 dropped:0 overruns:0 frame:0 TX packets:221 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1 RX bytes:16787 (16.7 KB) TX bytes:16787 (16.7 KB)å…³äºŽç»™ç½‘å¡æ·»åŠ å¤šä¸ªIPåˆ«åå¯ä»¥å‚è€ƒhttp://www.cnblogs.com/biaopei/p/7730517.htmlè¿™æ—¶å€™å°±å¯ä»¥åœ¨Nginxé…ç½®æ–‡ä»¶ä¸­é…ç½®ä¸¤å°åŸºäºŽIPé…ç½®çš„è™šæ‹Ÿä¸»æœºäº†ï¼š12345678910111213... http &#123; ... server &#123; listen: 80; server_name: 192.168.112.130; ... &#125; server &#123; listen: 80; server_name: 192.168.112.131; &#125; &#125;locationå—locationè¯­æ³•å¦‚ä¸‹ï¼š1location [ = | ~ | ~* | ^~ ] uri &#123; ... &#125;uriæ˜¯å¾…åŒ¹é…çš„è¯·æ±‚å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯æ ‡å‡†uriï¼ˆä¸å«æ­£åˆ™è¡¨è¾¾å¼ï¼‰å’Œæ­£åˆ™uriã€‚=ç”¨äºŽæ ‡å‡†uriå‰ï¼Œè¦æ±‚è¯·æ±‚å­—ç¬¦ä¸²ä¸Žuriä¸¥æ ¼åŒ¹é…ï¼Œå¦‚æžœæˆåŠŸï¼Œåˆ™åœæ­¢æœç´¢å¹¶ç«‹å³å¤„ç†æ­¤è¯·æ±‚ã€‚~ç”¨äºŽè¡¨ç¤ºuriå«æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒºåˆ†å¤§å°å†™ã€‚~*ç”¨äºŽè¡¨ç¤ºuriåŒ…å«æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸åŒºåˆ†å¤§å°å†™ã€‚^~ç”¨äºŽæ ‡å‡†uriå‰ï¼Œè¦æ±‚NginxæœåŠ¡å™¨æ‰¾åˆ°å’Œè¯·æ±‚å­—ç¬¦ä¸²åŒ¹é…åº¦æœ€é«˜çš„æ ‡å‡†uriå¯¹åº”çš„locationåŽï¼Œç«‹å³ç”¨æ­¤locationå¤„ç†è¯·æ±‚ï¼Œè€Œä¸å†ä½¿ç”¨locationå—ä¸­çš„æ­£åˆ™uriå’Œè¯·æ±‚å­—ç¬¦ä¸²åšåŒ¹é…ã€‚ä¸€ä¸ªç¤ºä¾‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041location = / &#123; # ç²¾ç¡®åŒ¹é… / ï¼Œä¸»æœºååŽé¢ä¸èƒ½å¸¦ä»»ä½•å­—ç¬¦ä¸² [ configuration A ]&#125;location / &#123; # å› ä¸ºæ‰€æœ‰çš„åœ°å€éƒ½ä»¥ / å¼€å¤´ï¼Œæ‰€ä»¥è¿™æ¡è§„åˆ™å°†åŒ¹é…åˆ°æ‰€æœ‰è¯·æ±‚ # ä½†æ˜¯æ­£åˆ™å’Œæœ€é•¿å­—ç¬¦ä¸²ä¼šä¼˜å…ˆåŒ¹é… [ configuration B ]&#125;location /documents/ &#123; # åŒ¹é…ä»»ä½•ä»¥ /documents/ å¼€å¤´çš„åœ°å€ï¼ŒåŒ¹é…ç¬¦åˆä»¥åŽï¼Œè¿˜è¦ç»§ç»­å¾€ä¸‹æœç´¢ # åªæœ‰åŽé¢çš„æ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰åŒ¹é…åˆ°æ—¶ï¼Œè¿™ä¸€æ¡æ‰ä¼šé‡‡ç”¨è¿™ä¸€æ¡ [ configuration C ]&#125;location ~ /documents/Abc &#123; # åŒ¹é…ä»»ä½•ä»¥ /documents/Abc å¼€å¤´çš„åœ°å€ï¼ŒåŒ¹é…ç¬¦åˆä»¥åŽï¼Œè¿˜è¦ç»§ç»­å¾€ä¸‹æœç´¢ # åªæœ‰åŽé¢çš„æ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰åŒ¹é…åˆ°æ—¶ï¼Œè¿™ä¸€æ¡æ‰ä¼šé‡‡ç”¨è¿™ä¸€æ¡ [ configuration CC ]&#125;location ^~ /images/ &#123; # åŒ¹é…ä»»ä½•ä»¥ /images/ å¼€å¤´çš„åœ°å€ï¼ŒåŒ¹é…ç¬¦åˆä»¥åŽï¼Œåœæ­¢å¾€ä¸‹æœç´¢æ­£åˆ™ï¼Œé‡‡ç”¨è¿™ä¸€æ¡ã€‚ [ configuration D ]&#125;location ~* \.(gif|jpg|jpeg)$ &#123; # åŒ¹é…æ‰€æœ‰ä»¥ gif,jpgæˆ–jpeg ç»“å°¾çš„è¯·æ±‚ # ç„¶è€Œï¼Œæ‰€æœ‰è¯·æ±‚ /images/ ä¸‹çš„å›¾ç‰‡ä¼šè¢« config D å¤„ç†ï¼Œå› ä¸º ^~ åˆ°è¾¾ä¸äº†è¿™ä¸€æ¡æ­£åˆ™ [ configuration E ]&#125;location /images/ &#123; # å­—ç¬¦åŒ¹é…åˆ° /images/ï¼Œç»§ç»­å¾€ä¸‹ï¼Œä¼šå‘çŽ° ^~ å­˜åœ¨ [ configuration F ]&#125;location /images/abc &#123; # æœ€é•¿å­—ç¬¦åŒ¹é…åˆ° /images/abcï¼Œç»§ç»­å¾€ä¸‹ï¼Œä¼šå‘çŽ° ^~ å­˜åœ¨ # Fä¸ŽGçš„æ”¾ç½®é¡ºåºæ˜¯æ²¡æœ‰å…³ç³»çš„ [ configuration G ]&#125;location ~ /images/abc/ &#123; # åªæœ‰åŽ»æŽ‰ config D æ‰æœ‰æ•ˆï¼šå…ˆæœ€é•¿åŒ¹é… config G å¼€å¤´çš„åœ°å€ï¼Œç»§ç»­å¾€ä¸‹æœç´¢ï¼ŒåŒ¹é…åˆ°è¿™ä¸€æ¡æ­£åˆ™ï¼Œé‡‡ç”¨ [ configuration H ]&#125;åŒ¹é…çš„ä¼˜å…ˆçº§ï¼š(location =) &gt; (location å®Œæ•´è·¯å¾„) &gt; (location ^~ è·¯å¾„) &gt; (location ~,~* æ­£åˆ™é¡ºåº) &gt; (location éƒ¨åˆ†èµ·å§‹è·¯å¾„) &gt; (/)æŒ‰ç…§ä¸Šé¢çš„locationå†™æ³•ï¼Œä»¥ä¸‹çš„åŒ¹é…ç¤ºä¾‹æˆç«‹ï¼š/ -&gt; config A ç²¾ç¡®å®Œå…¨åŒ¹é…ï¼Œå³ä½¿/index.htmlä¹ŸåŒ¹é…ä¸äº†ã€‚/downloads/download.html -&gt; config B åŒ¹é…Bä»¥åŽï¼Œå¾€ä¸‹æ²¡æœ‰ä»»ä½•åŒ¹é…ï¼Œé‡‡ç”¨Bã€‚/images/1.gif -&gt; configuration D åŒ¹é…åˆ°Fï¼Œå¾€ä¸‹åŒ¹é…åˆ°Dï¼Œåœæ­¢å¾€ä¸‹ã€‚/images/abc/def -&gt; config D æœ€é•¿åŒ¹é…åˆ°Gï¼Œå¾€ä¸‹åŒ¹é…Dï¼Œåœæ­¢å¾€ä¸‹ã€‚ ä½ å¯ä»¥çœ‹åˆ° ä»»ä½•ä»¥/images/å¼€å¤´çš„éƒ½ä¼šåŒ¹é…åˆ°Då¹¶åœæ­¢ï¼ŒFGå†™åœ¨è¿™é‡Œæ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„ï¼ŒHæ˜¯æ°¸è¿œè½®ä¸åˆ°çš„ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†è¯´æ˜ŽåŒ¹é…é¡ºåº/documents/document.html -&gt; config C åŒ¹é…åˆ°Cï¼Œå¾€ä¸‹æ²¡æœ‰ä»»ä½•åŒ¹é…ï¼Œé‡‡ç”¨Cã€‚/documents/1.jpg -&gt; configuration E åŒ¹é…åˆ°Cï¼Œå¾€ä¸‹æ­£åˆ™åŒ¹é…åˆ°Eã€‚/documents/Abc.jpg -&gt; config CC æœ€é•¿åŒ¹é…åˆ°Cï¼Œå¾€ä¸‹æ­£åˆ™é¡ºåºåŒ¹é…åˆ°CCï¼Œä¸ä¼šå¾€ä¸‹åˆ°Eã€‚å‚è€ƒè‡ªï¼š seanlookâ€™s blogrootrootç”¨äºŽé…ç½®æ ¹ç›®å½•ï¼Œæ¯”å¦‚æœ‰å¦‚ä¸‹locationé…ç½®ï¼š123location /data/ &#123; root /locationtest1;&#125;å½“locationå—æŽ¥æ”¶åˆ°/data/index.htmlçš„è¯·æ±‚åŽï¼Œå°†åœ¨/locationtest1/data/ç›®å½•ä¸‹æ‰¾åˆ°index.htmlã€‚è¯¥æŒ‡ä»¤å¯åœ¨httpï¼Œserveræˆ–locationå—ä¸­é…ç½®ã€‚aliasaliasç”¨äºŽæ”¹å˜locationæŽ¥æ”¶åˆ°çš„URIè¯·æ±‚è·¯å¾„ã€‚æ¯”å¦‚ï¼š123location ~ ^/data/(.+\.html)$ &#123; alias /locationtest1/other/$1;&#125;å½“locationå—æŽ¥æ”¶åˆ°/data/index.htmlçš„è¯·æ±‚åŽï¼Œé€šè¿‡aliasï¼ŒNginxåˆ°/locationtest1/other/ç›®å½•ä¸‹æœå¯»index.htmlã€‚ç›¸å½“äºŽè¯·æ±‚ä»Ž/data/index.htmlæ›´æ”¹ä¸ºäº†/locationtest1/other/index.htmlã€‚indexindexç”¨äºŽè®¾ç½®ç½‘ç«™çš„é»˜è®¤é¦–é¡µã€‚æ¯”å¦‚ï¼š123location ~ ^/data/(.+)/web/ $ &#123; index index.$1.html index.html myindex.html&#125;å½“è¯·æ±‚ä¸º/data/locationtest1/web/æ—¶ï¼ŒNginxä¾æ¬¡æœå¯»index.locationtest1.htmlã€index.htmlå’Œmyindex.htmlé¡µé¢ï¼Œå…ˆæ‰¾åˆ°å“ªä¸ªå°±ç”¨å“ªä¸ªã€‚error_pageè¯¥æŒ‡ä»¤ç”¨äºŽè®¾ç½®ç½‘ç«™çš„é”™è¯¯é¡µé¢ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1error_page code ... [=[response]] uricodeï¼Œè¦å¤„ç†çš„HTTPé”™è¯¯ç ã€‚responseï¼Œå¯é€‰é¡¹ï¼Œå°†codeæŒ‡å®šçš„é”™è¯¯ç è½¬åŒ–ä¸ºæ–°çš„é”™è¯¯ä»£ç responseã€‚uriï¼Œé”™è¯¯é¡µé¢çš„è·¯å¾„æˆ–è€…ç½‘ç«™åœ°å€ã€‚æ¯”å¦‚ï¼š1error_page 404 /404.html;Nginxä½¿ç”¨Nginxå®‰è£…ç›®å½•/html/404.htmlé¡µé¢å“åº”404é”™è¯¯ã€‚1error_page 403 http://somewebsite.com/forbidden.html;Nginxä½¿ç”¨http://somewebsite.com/forbidden.htmlé¡µé¢å“åº”403é”™è¯¯ã€‚1error_page 410 =301 /empty.gif;NginxæœåŠ¡å™¨äº§ç”Ÿ410çš„HTTPæ¶ˆæ¯æ—¶ï¼Œä½¿ç”¨Nginxå®‰è£…ç›®å½•/html/empty.gifè¿”å›žç»™ç”¨æˆ·ï¼ŒHTTPçš„çŠ¶æ€ç ä¸º301ã€‚åŠ å…¥æƒ³è¦æ”¹å˜Nginxå®‰è£…ç›®å½•/html/è¿™ä¸ªé»˜è®¤çš„è·¯å¾„ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªlocaitonå—ï¼š123location /404.html &#123; root /myserver/errorpages/;&#125;è¯¥æŒ‡ä»¤å¯åœ¨httpï¼Œserverå’Œlocationå—ä¸­é…ç½®ã€‚åŸºäºŽIPé…ç½®Nginxè®¿é—®æƒé™allowæŒ‡ä»¤ç”¨äºŽé…ç½®å…è®¸è®¿é—®Nginxçš„å®¢æˆ·ç«¯IPï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1allow address | CIDR | alladdressï¼ŒæŒ‡å®šå…è®¸è®¿é—®çš„IPï¼Œä¸æ”¯æŒå¤šä¸ªå€¼ï¼Œå¦‚éœ€è¦æœ‰å¤šä¸ªIPè®¾ç½®ï¼Œéœ€è¦é‡å¤ä½¿ç”¨allowå‘½ä»¤ã€‚CIDRï¼Œå…è®¸è®¿é—®çš„å®¢æˆ·ç«¯çš„CIDRåœ°å€ã€‚allï¼Œä»£è¡¨å…è®¸æ‰€æœ‰çš„å®¢æˆ·ç«¯è®¿é—®ã€‚denyæŒ‡ä»¤ç”¨äºŽé…ç½®ç¦æ­¢è®¿é—®Nginxçš„å®¢æˆ·ç«¯IPï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1deny address | CIDR | allè¿™ä¸¤ä¸ªæŒ‡ä»¤å¯åœ¨httpï¼Œserverå’Œlocationå—ä¸­é…ç½®ã€‚é…ç½®Nginxå¯†ç auth_basicæŒ‡ä»¤ç”¨äºŽå¼€å¯æˆ–è€…å…³é—­è®¤è¯åŠŸèƒ½ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1auth_basic string | offstirngï¼Œå¼€å¯è®¤è¯åŠŸèƒ½ï¼Œå¹¶é…ç½®äº†éªŒè¯æ—¶çš„ä¿¡æ¯ã€‚offï¼Œå…³é—­è®¤è¯ã€‚auth_basic_user_fileæŒ‡ä»¤æŒ‡å®šäº†åŒ…å«ç”¨æˆ·åå’Œå¯†ç çš„ä¿¡æ¯æ–‡ä»¶è·¯å¾„ï¼Œè¯­æ³•ç»“æž„ä¸ºï¼š1auth_basic_user_file fileå¦‚ï¼Œåœ¨nignx.confé‡Œé…ç½®å¦‚ä¸‹ï¼šç”Ÿäº§htpasswdæ–‡ä»¶ï¼š123# printf "mrbird:$(openssl passwd -crypt 123456)\n" &gt;&gt;conf/htpasswd# cat conf/htpasswdmrbird:vdV.OwMSzfJrQé‡å¯NginxåŽï¼Œè®¿é—®http://localhost/index.htmlï¼Œé¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼šé…ç½®å®žä¾‹å°†conf/nginx.confé…ç½®æˆå¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566worker_processes 1;error_log logs/error.log;events &#123; worker_connections 1024;&#125;http &#123; include mime.types; default_type application/octet-stream; log_format main '$remote_addr - $remote_user [$time_local] "$request" ' '$status $body_bytes_sent "$http_referer" ' '"$http_user_agent" "$http_x_forwarded_for"'; sendfile on; keepalive_timeout 65; # é…ç½®server1 server &#123; listen 8081; server_name localhost; charset utf-8; access_log /myweb/server1/log/access.log main; error_page 404 /myweb/error/404.html; # é…ç½®/server1/location1/è¯·æ±‚çš„location location /server1/location1 &#123; root /myweb; index index.html; &#125; # é…ç½®/server1/location2è¯·æ±‚çš„location location /server1/location2 &#123; root /myweb; index index.html; &#125; &#125; # é…ç½®server2 server &#123; listen 8082; server_name 192.168.112.130; charset utf-8; access_log /myweb/server2/log/access.log main; error_page 404 /404.html; # é…ç½®/server2/location1/è¯·æ±‚çš„locaiton location /server2/location1 &#123; root /myweb; index index.html; &#125; # é…ç½®/server2/location2/è¯·æ±‚çš„location location /svr2/loc2 &#123; alias /myweb/server2/location2; # å¯¹locationçš„uriè¿›è¡Œæ›´æ”¹ index index.html; &#125; # é‡å®šå‘404é¡µé¢åœ°å€ location = /404.html &#123; root /myweb/error; index 404.html; &#125; &#125;&#125;æž„å»ºä¸€ä¸ªé™æ€ç½‘ç«™ï¼Œç›®å½•ç»“æž„å¦‚ä¸‹ï¼š1234567891011121314151617/myweb/â”œâ”€â”€ errorâ”‚ â””â”€â”€ 404.htmlâ”œâ”€â”€ server1â”‚ â”œâ”€â”€ location1â”‚ â”‚ â””â”€â”€ index.htmlâ”‚ â”œâ”€â”€ location2â”‚ â”‚ â””â”€â”€ index.htmlâ”‚ â””â”€â”€ logâ”‚ â””â”€â”€ access.logâ””â”€â”€ server2 â”œâ”€â”€ location1 â”‚ â””â”€â”€ index.html â”œâ”€â”€ location2 â”‚ â””â”€â”€ index.html â””â”€â”€ log â””â”€â”€ access.logå¯åŠ¨NginxæœåŠ¡ï¼š1234# /nginx/sbin/nginx -tnginx: the configuration file /nginx/conf/nginx.conf syntax is oknginx: configuration file /nginx/conf/nginx.conf test is successful# /nginx/sbin/nginxè®¿é—®http://localhost:8081/server1/location1/ï¼šè®¿é—®http://localhost:8081/server1/location2/ï¼šè®¿é—®http://192.168.112.130:8082/server2/location1/ï¼šè®¿é—®http://192.168.112.130:8082/svr2/loc2/ï¼šè®¿é—®http://192.168.112.130:8082/svr2/loc3/ï¼šç»“æžœè¯æ˜Žï¼Œä¸Šè¿°é…ç½®æ­£ç¡®ã€‚]]></content>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginxå®‰è£…ä¸Žéƒ¨ç½²]]></title>
    <url>%2FNginx%20install%20deploy.html</url>
    <content type="text"><![CDATA[ä¸‹è½½NginxNginxå®˜ç½‘ï¼šhttp://nginx.org/en/download.htmlã€‚ç½‘é¡µæä¾›äº†Nginxä¸‰ç§ç‰ˆæœ¬ä¸‹è½½ï¼šå¼€å‘ç‰ˆï¼ˆMainline Versionï¼‰ã€ç¨³å®šç‰ˆï¼ˆStable Versionï¼‰å’Œè¿‡æœŸç‰ˆï¼ˆLegacy Versionï¼‰ã€‚Nignxæä¾›Linuxå’ŒWindowsç‰ˆæœ¬ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯Linuxç‰ˆæœ¬ã€‚æ­¤å¤–ï¼Œhttp://nginx.org/download/æä¾›äº†æ‰€æœ‰ç‰ˆæœ¬çš„Nginxä¸‹è½½ã€‚Nginxæºç çš„ç¼–è¯‘éœ€è¦GCCç¼–è¯‘å™¨ï¼š12345# gcc --versiongcc (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609Copyright (C) 2015 Free Software Foundation, Inc.This is free software; see the source for copying conditions. There is NOwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.æˆªæ­¢2017å¹´10æœˆ15æ—¥ï¼ŒNginxæœ€æ–°ç¨³å®šç‰ˆä¸º1.12.2ï¼Œä¸‹è½½å¹¶è§£åŽ‹ï¼š1234567891011121314151617181920# mkdir nginx-download# cd nginx-download/# wget http://nginx.org/download/nginx-1.12.2.tar.gz# tar -zxvf nginx-1.12.2.tar.gz # cd nginx-1.12.2# lltotal 732drwxr-xr-x 8 1001 1001 4096 Oct 17 21:16 ./drwxr-xr-x 3 root root 4096 Oct 26 14:05 ../-rw-r--r-- 1 1001 1001 278202 Oct 17 21:16 CHANGES-rw-r--r-- 1 1001 1001 423948 Oct 17 21:16 CHANGES.ru-rw-r--r-- 1 1001 1001 1397 Oct 17 21:16 LICENSE-rw-r--r-- 1 1001 1001 49 Oct 17 21:16 READMEdrwxr-xr-x 6 1001 1001 4096 Oct 26 14:05 auto/drwxr-xr-x 2 1001 1001 4096 Oct 26 14:05 conf/-rwxr-xr-x 1 1001 1001 2481 Oct 17 21:16 configure*drwxr-xr-x 4 1001 1001 4096 Oct 26 14:05 contrib/drwxr-xr-x 2 1001 1001 4096 Oct 26 14:05 html/drwxr-xr-x 2 1001 1001 4096 Oct 26 14:05 man/drwxr-xr-x 9 1001 1001 4096 Oct 26 14:05 src/srcç›®å½•ä¸‹å­˜æ”¾äº†Nginxçš„æºä»£ç ï¼›manç›®å½•ä¸‹å­˜æ”¾äº†Nginxçš„å¸®åŠ©æ–‡æ¡£ï¼›htmlç›®å½•å­˜æ”¾äº†ä¸¤ä¸ªHTMLæ–‡ä»¶ï¼Œåˆ†åˆ«ä¸ºNginxæ¬¢è¿Žé¡µå’Œå¼‚å¸¸é¡µé¢ï¼›logsç›®å½•ç”¨äºŽå­˜æ”¾Nginxè¿è¡Œæ—¥å¿—ï¼›autoç›®å½•å­˜æ”¾äº†å¤§é‡çš„è„šæœ¬æ–‡ä»¶ï¼Œå’Œconfigureè„šæœ¬æœ‰å…³ï¼›configureæ–‡ä»¶ä¸ºNginxçš„è‡ªåŠ¨è„šæœ¬ç¨‹åºã€‚Nginxç¼–è¯‘ä¸Žå®‰è£…åœ¨è§£åŽ‹è·¯å¾„ä¸‹ï¼Œè¿è¡Œå‘½ä»¤./configure --prefix=/nginxï¼ˆconfigureè„šæœ¬æ”¯æŒçš„é€‰é¡¹å¯å‚è€ƒé™„å½•ï¼‰é…ç½®Nginxçš„å®‰è£…ç›®å½•å¹¶ç”ŸæˆMakefileæ–‡ä»¶ï¼š1234567891011121314151617181920# ./configure --prefix=/nginx...Configuration summary + using system PCRE library + OpenSSL library is not used + using system zlib library nginx path prefix: "/nginx" nginx binary file: "/nginx/sbin/nginx" nginx modules path: "/nginx/modules" nginx configuration prefix: "/nginx/conf" nginx configuration file: "/nginx/conf/nginx.conf" nginx pid file: "/nginx/logs/nginx.pid" nginx error log file: "/nginx/logs/error.log" nginx http access log file: "/nginx/logs/access.log" nginx http client request body temporary files: "client_body_temp" nginx http proxy temporary files: "proxy_temp" nginx http fastcgi temporary files: "fastcgi_temp" nginx http uwsgi temporary files: "uwsgi_temp" nginx http scgi temporary files: "scgi_temp"è¿‡ç¨‹ä¸­å¯èƒ½å‡ºçŽ°ä¸€äº›ä¾èµ–åº“ç¼ºå¤±é—®é¢˜ï¼Œå¯å‚è€ƒä¸‹é¢çš„å¸¸è§é—®é¢˜ã€‚ç”Ÿæˆäº†Makefileæ–‡ä»¶åŽï¼Œä½¿ç”¨makeå‘½ä»¤è¿›è¡Œç¼–è¯‘ï¼š12345678910111213141516171819# makemake -f objs/Makefilemake[1]: Entering directory '/temp/nginx-download/nginx-1.12.2'cc -c -pipe -O -W -Wall -Wpointer-arith -Wno-unused-parameter -Werror -g -I src/core -I src/event -I src/event/modules -I src/os/unix -I objs \ -o objs/src/core/nginx.o \ src/core/nginx.ccc -c -pipe -O -W -Wall -Wpointer-arith -Wno-unused-parameter -Werror -g -I src/core -I src/event -I src/event/modules -I src/os/unix -I objs \...objs/src/http/modules/ngx_http_upstream_keepalive_module.o \objs/src/http/modules/ngx_http_upstream_zone_module.o \objs/ngx_modules.o \-ldl -lpthread -lcrypt -lpcre -lz \-Wl,-Esed -e "s|%%PREFIX%%|/nginx|" \ -e "s|%%PID_PATH%%|/nginx/logs/nginx.pid|" \ -e "s|%%CONF_PATH%%|/nginx/conf/nginx.conf|" \ -e "s|%%ERROR_LOG_PATH%%|/nginx/logs/error.log|" \ &lt; man/nginx.8 &gt; objs/nginx.8make[1]: Leaving directory '/temp/nginx-download/nginx-1.12.2'ç¼–è¯‘é¡ºåˆ©å®ŒæˆåŽï¼ŒæŽ¥ç€ä½¿ç”¨make installå‘½ä»¤è¿›è¡Œå®‰è£…ï¼š12345678910# make installmake -f objs/Makefile installmake[1]: Entering directory '/temp/nginx-download/nginx-1.12.2'test -d '/nginx' || mkdir -p '/nginx'test -d '/nginx/sbin' \ || mkdir -p '/nginx/sbin'...test -d '/nginx/logs' \ || mkdir -p '/nginx/logs'make[1]: Leaving directory '/temp/nginx-download/nginx-1.12.2'å°†ç›®å½•åˆ‡æ¢åˆ°/nginxä¸‹ï¼Œå¹¶æŸ¥çœ‹ï¼š123456789101112131415161718192021222324# cd /nginx/# lltotal 24drwxr-xr-x 6 root root 4096 Oct 26 14:30 ./drwxr-xr-x 26 root root 4096 Oct 26 14:30 ../drwxr-xr-x 2 root root 4096 Oct 26 14:30 conf/drwxr-xr-x 2 root root 4096 Oct 26 14:30 html/drwxr-xr-x 2 root root 4096 Oct 26 14:30 logs/drwxr-xr-x 2 root root 4096 Oct 26 14:30 sbin/# ls *conf:fastcgi.conf koi-win scgi_paramsfastcgi.conf.default mime.types scgi_params.defaultfastcgi_params mime.types.default uwsgi_paramsfastcgi_params.default nginx.conf uwsgi_params.defaultkoi-utf nginx.conf.default win-utfhtml:50x.html index.htmllogs:sbin:nginxNginxçš„å¯åœNginxå¸¸ç”¨å‘½ä»¤nginxå‘½ä»¤æ‰€æ”¯æŒçš„é€‰é¡¹æœ‰ï¼š123456789101112131415# ./sbin/nginx -hnginx version: nginx/1.12.2Usage: nginx [-?hvVtTq] [-s signal] [-c filename] [-p prefix] [-g directives]Options: -?,-h : this help -v : show version and exit -V : show version and configure options then exit -t : test configuration and exit -T : test configuration, dump it and exit -q : suppress non-error messages during configuration testing -s signal : send signal to a master process: stop, quit, reopen, reload -p prefix : set prefix path (default: /nginx/) -c filename : set configuration file (default: conf/nginx.conf) -g directives : set global directives out of configuration file-vé€‰é¡¹ç”¨æ¥æ˜¾ç¤ºNginxæœåŠ¡å™¨çš„ç‰ˆæœ¬å·ï¼Œ-Vé€‰é¡¹é™¤äº†æ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œè¿˜æ˜¾ç¤ºå…¶ç¼–è¯‘æƒ…å†µï¼š123456# ./sbin/nginx -vnginx version: nginx/1.12.2# ./sbin/nginx -Vnginx version: nginx/1.12.2built by gcc 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.4) configure arguments: --prefix=/nginx-té€‰é¡¹ç”¨äºŽæ£€æŸ¥NginxæœåŠ¡å™¨é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ï¼š123# ./sbin/nginx -tnginx: the configuration file /nginx/conf/nginx.conf syntax is oknginx: configuration file /nginx/conf/nginx.conf test is successfulç­‰ã€‚Nginxå¯åŠ¨å¯åŠ¨NginxæœåŠ¡å™¨å¾ˆç®€å•ï¼Œåªéœ€è¦è¿è¡Œsbinä¸‹çš„nginxè„šæœ¬å°±è¡Œäº†ï¼š12345# ./sbin/nginx # ps -ef|grep nginxroot 74808 1308 0 14:47 ? 00:00:00 nginx: master process ./sbin/nginxnobody 74809 74808 0 14:47 ? 00:00:00 nginx: worker processroot 74811 71675 0 14:47 pts/4 00:00:00 grep --color=auto nginxå¯çœ‹åˆ°Nginxå·²ç»å¯åŠ¨ï¼ŒåŒ…å«äº†ä¸€ä¸ªä¸»è¿›ç¨‹ï¼ˆmaster processï¼‰å’Œä¸€ä¸ªå·¥ä½œè¿›ç¨‹ï¼ˆworker processï¼‰ï¼Œä¸»è¿›ç¨‹å·ä¸º74808ã€‚å¯åŠ¨NginxæœåŠ¡åŽï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŸ¥çœ‹logsç›®å½•ä¸‹çš„nginx.pidæ¥æŸ¥çœ‹ä¸»è¿›ç¨‹å·ï¼š12# cat logs/nginx.pid 74808Nginxçš„é»˜è®¤ç«¯å£å·ä¸º80ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥localhost/index.htmlæŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸï¼šNginxåœæ­¢åœæ­¢NginxæœåŠ¡å¯åˆ†ä¸ºä¸¤ç§ç±»åž‹ï¼š1.å¿«é€Ÿåœæ­¢ï¼šç«‹å³åœæ­¢å½“å‰NginxæœåŠ¡æ­£åœ¨å¤„ç†çš„æ‰€æœ‰ç½‘ç»œè¯·æ±‚ï¼Œé©¬ä¸Šä¸¢å¼ƒè¿žæŽ¥ï¼Œåœæ­¢å·¥ä½œã€‚ç›¸å…³å‘½ä»¤ä¸ºï¼škill -TERM è¿›ç¨‹å·æˆ–è€…kill -INT è¿›ç¨‹å·ï¼›2.å¹³ç¼“åœæ­¢ï¼šå…è®¸NginxæœåŠ¡å°†å½“å‰çš„ç½‘ç»œè¯·æ±‚å¤„ç†å®Œæ¯•ï¼Œä½†ä¸å†æŽ¥å—æ–°è¯·æ±‚ï¼Œä¹‹åŽå…³é—­è¿žæŽ¥ï¼Œåœæ­¢å·¥ä½œã€‚ç›¸å…³çš„å‘½ä»¤ä¸ºï¼škill -QUIT è¿›ç¨‹å·ï¼›åœæ­¢NginxæœåŠ¡ï¼Œé‡‡ç”¨å¿«é€Ÿåœæ­¢æ–¹å¼ï¼š123# kill -TERM 74808# ps -ef|grep nginxroot 74998 71675 0 15:03 pts/4 00:00:00 grep --color=auto nginxNginxé‡å¯Nginxé‡å¯é‡‡ç”¨å¹³æ»‘é‡å¯çš„æ–¹å¼ã€‚NginxæœåŠ¡è¿›ç¨‹å·æŽ¥æ”¶åˆ°é‡å¯ä¿¡å·åŽï¼Œå…ˆè¯»å–æ–°çš„Nginxé…ç½®æ–‡ä»¶ï¼Œå¦‚æžœé…ç½®è¯­æ³•æ­£ç¡®ï¼Œåˆ™å¯åŠ¨æ–°çš„NginxæœåŠ¡ï¼Œç„¶åŽå¹³ç¼“çš„å…³é—­æ—§çš„æœåŠ¡ã€‚å¦‚æžœé…ç½®è¯­æ³•é”™è¯¯ï¼Œåˆ™ç»§ç»­é‡‡ç”¨æ—§çš„Nginxè¿›ç¨‹æä¾›æœåŠ¡ã€‚æœ‰ä¸¤ç§æ–¹å¼è¿›è¡Œå¹³æ»‘é‡å¯ï¼š1.æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æžœæ­£ç¡®è¿›è¡Œé‡å¯ï¼š1234# ./sbin/nginx -tnginx: the configuration file /nginx/conf/nginx.conf syntax is oknginx: configuration file /nginx/conf/nginx.conf test is successful# ./sbin/nginx -s reload2.kill -HUP ä¸»è¿›ç¨‹å·:123# cat logs/nginx.pid 75011# kill -HUP 75011å¸¸è§é—®é¢˜ç¼ºå°‘ä¾èµ–åº“ç¼ºå°‘PCREä¾èµ–åº“./configure: error: the HTTP rewrite module requires the PCRE library. You can either disable the module by using â€“without-http_rewrite_module option, or install the PCRE library into the system, or build the PCRE library statically from the source with nginx by using â€“with-pcre=option.è§£å†³åŠžæ³•ï¼š1sudo apt-get install libpcre3 libpcre3-devç¼ºå°‘zlibä¾èµ–åº“./configure: error: the HTTP gzip module requires the zlib library. You can either disable the module by using â€“without-http_gzip_module option, or install the zlib library into the system, or build the zlib library statically from the source with nginx by using â€“with-zlib=option.è§£å†³åŠžæ³•ï¼š1sudo apt-get install zlib1g-devå…¶ä»–é—®é¢˜apt-getå‘½ä»¤è¢«å ç”¨E: Could not get lock /var/lib/dpkg/lock - open (11: Resource temporarily unavailable) E: Unable to lock the administration directory (/var/lib/dpkg/), is another process using it?è§£å†³åŠžæ³•ï¼šæ‰¾åˆ°å ç”¨è¿›ç¨‹ï¼Œç„¶åŽkillï¼š123ps -A|grep apt 61213 ? 00:00:02 aptdkill -9 61213é™„å½•æ³¨ï¼šç”±äºŽæ¸²æŸ“åŽŸå› â€“å®žé™…ä¸º --ï¼Œå¦‚â€“prefix=â€¦å®žé™…ä¸º --prefix=...configureå¼€å…³é€‰é¡¹é€‰é¡¹&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ç”¨æ³•&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;é»˜è®¤å€¼â€“prefix=â€¦æŒ‡å®šå®‰è£…Nginxçš„åŸºç¡€ç›®å½•/usr/local/nginx, æ³¨æ„ï¼šå¦‚æžœä½ åœ¨é…ç½®æ—¶ä½¿ç”¨äº†ç›¸å¯¹è·¯å¾„ï¼Œåˆ™è¿žæŽ¥åˆ°åŸºç¡€ç›®å½•ã€‚ç¤ºä¾‹ï¼šæŒ‡å®šâ€“conf-path=conf/nginx.conf åˆ™é…ç½®æ–‡ä»¶ä¼šåœ¨ç›®å½•ï¼š/usr/local/nginx/conf/nginx.confâ€“sbin-path=â€¦NginxäºŒè¿›åˆ¶æ–‡ä»¶å®‰è£…çš„è·¯å¾„&lt;prefix&gt;/sbin/nginxâ€“conf-path=â€¦ä¸»è¦é…ç½®æ–‡ä»¶æ”¾ç½®ç›®å½•&lt;prefix&gt;/conf/nginx.confâ€“error-log-path=â€¦é”™è¯¯æ—¥å¿—å­˜æ”¾çš„è·¯å¾„ã€‚é”™è¯¯æ—¥å¿—åœ¨é…ç½®æ–‡ä»¶ä¸­é¡»é…ç½®å¾—éžå¸¸æ­£ç¡®ï¼Œè¯¥è·¯å¾„åªåº”ç”¨äºŽä½ åœ¨é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰æŒ‡å®šä»»ä½•é”™è¯¯çš„æ—¥å¿—æŒ‡ä»¤æ—¶&lt;prefix&gt;/logs/error.logâ€“pid-path=â€¦æŒ‡å®šNginxçš„pidæ–‡ä»¶çš„è·¯å¾„ã€‚å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®špidæ–‡ä»¶çš„è·¯å¾„ï¼Œå¦‚æžœæ²¡æœ‰å…·ä½“çš„æŒ‡å®šï¼Œåˆ™ä½¿ç”¨åœ¨è¿™é‡Œå¯¹è¯¥é€‰é¡¹æŒ‡å®šçš„è¯¥è·¯å¾„&lt;prefix&gt;/logs/nginx.pidæ³¨æ„ï¼šè¯¥pidæ–‡ä»¶æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡ä»¶æ–‡ä»¶ï¼Œå®ƒåŒ…å«è¿›ç¨‹çš„æ ‡è¯†ç¬¦ã€‚è¯¥æ–‡ä»¶åº”è¯¥æ”¾ç½®åœ¨ä¸€ä¸ªæ¸…æ™°å¯è§çš„ä½ç½®ï¼Œä»¥ä¾¿å…¶ä»–åº”ç”¨ç¨‹åºèƒ½å¤Ÿå¾ˆå®¹æ˜“æ‰¾åˆ°è¿è¡Œè¯¥ç¨‹åºçš„pidâ€“lock-path=â€¦é”æ–‡ä»¶ï¼ˆlock fileï¼‰çš„å­˜æ”¾è·¯å¾„ã€‚åŒæ ·ï¼Œè¯¥æ–‡ä»¶ä¹Ÿå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šï¼Œä½†æ˜¯ï¼Œå¦‚æžœåœ¨é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰æŒ‡å®šï¼Œåˆ™ä½¿ç”¨è¯¥å€¼&lt;prefix&gt;/logs/nginx.lockæ³¨æ„ï¼šé”æ–‡ä»¶å…è®¸å…¶ä»–åº”ç”¨ç¨‹åºç¡®å®šæ˜¯å¦ä¸€ä¸ªç¨‹åºåœ¨è¿è¡Œï¼Œå°±Nginxæ¥è¯´ï¼Œå®ƒç”¨äºŽç¡®å®šè¯¥è¿›ç¨‹æ²¡æœ‰è¢«å¯åŠ¨ä¸¤æ¬¡â€“with-perl_modules_path=â€¦å®šä¹‰Perlæ¨¡å—çš„è·¯å¾„ã€‚å¦‚æžœéœ€è¦åŒ…å«å¦å¤–çš„Perlæ¨¡å—ï¼Œå¿…é¡»å®šä¹‰è¯¥å‚æ•°â€“with-perl=â€¦PerläºŒè¿›åˆ¶æ–‡ä»¶çš„è·¯å¾„ã€‚ç”¨äºŽæ‰§è¡ŒPerlè„šæœ¬ã€‚å¦‚æžœæƒ³æ‰§è¡Œä¸€ä¸ªPerlè„šæœ¬ï¼Œå¿…é¡»è®¾ç½®è¯¥è·¯å¾„â€“http-log-path=â€¦å®šä¹‰è¢«è®¿é—®æ–‡ä»¶çš„æ—¥å¿—æ–‡ä»¶å­˜æ”¾è·¯å¾„ã€‚è¯¥è·¯å¾„åªç”¨äºŽåœ¨é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰å®šä¹‰è®¿é—®æ—¥å¿—çš„æƒ…å†µ&lt;prefix&gt;/logs/access.logâ€“http-client-body-temp-path=â€¦è¯¥ç›®å½•ç”¨äºŽå­˜å‚¨å®¢æˆ·ç«¯è¯·æ±‚äº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶&lt;prefix&gt;/client_body_tempâ€“http-proxy-temp-path=â€¦è¯¥ç›®å½•ç”¨äºŽä»£ç†å­˜å‚¨ä¸´æ—¶æ–‡ä»¶&lt;prefix&gt;/proxy_tempâ€“http-fastcgi-temp-path=â€¦æŒ‡å®šç”¨äºŽHTTP FastCGIæ¨¡å—ä½¿ç”¨çš„ä¸´æ—¶æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„&lt;prefix&gt;/fastcgi_tempâ€“builddir=â€¦æŒ‡å®šåˆ›å»ºåº”ç”¨ç¨‹åºçš„ä½ç½®configureå…ˆæ±ºæ¡ä»¶é€‰é¡¹ç¼–è¯‘é€‰é¡¹â€“with-cc=â€¦&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æŒ‡å®šä¸€ä¸ªå¤‡ç”¨çš„Cç¼–è¯‘å™¨çš„ä½ç½®â€“with-cpp=â€¦æŒ‡å®šä¸€ä¸ªå¤‡ç”¨çš„Cé¢„å¤„ç†å™¨çš„ä½ç½®â€“with-cc-opt=â€¦å®šä¹‰é¢å¤–çš„é€‰é¡¹ï¼Œç„¶åŽåœ¨å‘½ä»¤è¡Œä¼ é€’ç»™Cç¼–è¯‘å™¨â€“with-ld-opt=â€¦å®šä¹‰é¢å¤–çš„é€‰é¡¹ï¼Œç„¶åŽåœ¨å‘½ä»¤è¡Œä¼ é€’ç»™Cè¿žæŽ¥å™¨â€“with-cpu-opt=â€¦æŒ‡å®šä¸åŒçš„ç›®æ ‡å¤„ç†å™¨ç»“æž„ï¼Œå¯ä»¥æ˜¯ä¸‹åˆ—å€¼ï¼špentiumï¼Œpentiumproï¼Œpentium3ï¼Œpentium4ï¼Œathlonï¼Œopteronï¼Œsparc32ï¼Œsparc64å’Œppc64PCREé€‰é¡¹â€“without-pcreä¸ä½¿ç”¨PCREåº“ã€‚è¿™ä¸ªè®¾ç½®ä¸æŽ¨èä½¿ç”¨ï¼Œå› ä¸ºå®ƒä¼šç§»é™¤å¯¹æ­£åˆ™è¡¨è¾¾å¼çš„æ”¯æŒï¼Œä»Žè€Œä½¿Rewriteæ¨¡å—å¤±åŽ»ä½œç”¨ã€‚â€“with-pcreå¼ºåˆ¶ä½œç”¨PCREåº“â€“with-pcre=â€¦å…è®¸æŒ‡å®šPCREåº“çš„æºä»£ç â€“with-pcre-opt=â€¦ç”¨äºŽå»ºç«‹PCREåº“çš„å¦å¤–çš„é€‰é¡¹MD5é€‰é¡¹â€“with-md5=â€¦æŒ‡å®šMD5åº“æºä»£ç çš„è·¯å¾„â€“with-md5-opt=â€¦ç”¨äºŽå»ºç«‹MD5åº“çš„å¦å¤–é€‰é¡¹â€“with-md5-asmä¸ºå»ºMD5åº“ä½¿ç”¨æ±‡ç¼–è¯­è¨€æºä»£ç SHA1é€‰é¡¹â€“with-sha1=â€¦æŒ‡å®šSHA1åº“çš„æºä»£ç â€“with-sha1-opt=â€¦ç”¨äºŽå»ºç«‹SHA1åº“çš„å¦å¤–é€‰é¡¹â€“with-sha1-asmä¸ºå»ºç«‹SHA1åº“ä½¿ç”¨æ±‡ç¼–è¯­è¨€æºä»£ç zlibé€‰é¡¹â€“with-zlib=â€¦æŒ‡å®šzlibåº“çš„æºä»£ç â€“with-zlib-opt=â€¦ç”¨äºŽå»ºç«‹zlibåº“çš„å¦å¤–çš„é€‰é¡¹â€“with-zlib-asm=â€¦ä½¿ç”¨æ±‡ç¼–è¯­è¨€æœ€å¤§é™åº¦åœ°ä¼˜åŒ–ä¸‹åˆ—ç›®æ ‡ç»“æž„ï¼šPentium, pentiumproOpenSSLé€‰é¡¹â€“with-openssl=â€¦æŒ‡å®šOpenSSLåº“çš„æºä»£ç è·¯å¾„â€“with-openssl-opt=â€¦ä¸ºå»ºç«‹OpenSSLåº“çš„å¦å¤–çš„é€‰é¡¹configureæ¨¡å—é€‰é¡¹ä»¥ä¸‹æ˜¯Nginxé»˜è®¤å¼€å¯çš„æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨è¡¨æ ¼ä¸­çš„å‘½ä»¤æ¥å…³é—­ç›¸åº”æ¨¡å—ï¼šé»˜è®¤å¼€å¯çš„æ¨¡å—&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æè¿°â€“without-http-charset_moduleç¦ç”¨Charsetæ¨¡å—ï¼Œè¯¥æ¨¡å—ç”¨äºŽå¯¹ç½‘é¡µé‡æ–°ç¼–ç â€“without-http-gzip_moduleç¦ç”¨GzipåŽ‹ç¼©æ¨¡å—â€“without-http_ssi_moduleç¦ç”¨æœåŠ¡å™¨ç«¯åŒ…å«æ¨¡å—â€“without-http_access_moduleç¦ç”¨è®¿é—®æ¨¡å—ï¼Œå¯¹äºŽæŒ‡å®šçš„IPæ®µï¼Œå…è®¸è®¿é—®é…ç½®â€“without-http_userid_moduleç¦ç”¨ç”¨æˆ·IDæ¨¡å—ã€‚è¯¥æ¨¡å—ä¸ºç”¨æˆ·é€šè¿‡cookieéªŒè¯èº«ä»½â€“without-http_auth_basic_moduleç¦ç”¨åŸºæœ¬çš„è®¤è¯æ¨¡å—â€“without-http_autoindex_moduleç¦ç”¨è‡ªåŠ¨ç´¢å¼•æ¨¡å—â€“without-http_geo_moduleç¦ç”¨Geoæ¨¡å—ï¼Œè¯¥æ¨¡å—å…è®¸ä½ å®šä¹‰ä¾èµ–äºŽIPåœ°å€æ®µçš„å˜é‡â€“without-http_map_moduleç¦ç”¨Mapæ¨¡å—ï¼Œè¯¥æ¨¡å—å…è®¸ä½ å£°æ˜ŽmapåŒºæ®µâ€“without-http_referer_moduleç¦ç”¨RefereræŽ§åˆ¶æ¨¡å—â€“without-http_rewrite_moduleç¦ç”¨Rewriteæ¨¡å—â€“without-http_proxy_moduleç¦ç”¨ä»£ç†æ¨¡å—ã€‚è¯¥æ¨¡å—ç”¨äºŽå‘å…¶ä»–æœåŠ¡å™¨ä¼ è¾“è¯·æ±‚â€“without-http_fastcgi_moduleç¦ç”¨FastCGIæ¨¡å—ã€‚è¯¥æ¨¡å—æ˜¯ç”¨äºŽä¸ŽFastCGIè¿›ç¨‹é…åˆå·¥ä½œâ€“without-http_memcached_module&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ç¦ç”¨Memcachedæ¨¡å—ã€‚è¯¥æ¨¡å—æ˜¯ç”¨äºŽä¸Žmemcachedå®ˆæŠ¤è¿›ç¨‹é…åˆå·¥ä½œâ€“without-http_limit_zone_moduleç¦ç”¨Limit Zoneæ¨¡å—ã€‚è¯¥æ¨¡å—æ˜¯ç”¨äºŽæ ¹æ®å®šä¹‰çš„zoneæ¥é™åˆ¶çº¦æŸå¯¹èµ„æºçš„ä½¿ç”¨ã€‚â€“without-http_limit_req_moduleç¦ç”¨Limit Requestsæ¨¡å—ã€‚è¯¥æ¨¡å—å…è®¸ä½ é™åˆ¶æ¯ä¸ªç”¨æˆ·è¯·æ±‚çš„æ€»æ•°â€“without-http_empty_gif_moduleç¦ç”¨Empty Gifæ¨¡å—ã€‚è¯¥æ¨¡å—ç”¨äºŽåœ¨å†…å­˜ä¸­æä¾›ä¸€ä¸ªç©ºç™½çš„GIFå›¾åƒâ€“without-http_browser_moduleç¦ç”¨Browseræ¨¡å—ã€‚è¯¥æ¨¡å—ç”¨äºŽè§£é‡Šç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²â€“without-http_upstream_ip_hash_moduleç¦ç”¨Upstreamæ¨¡å—ã€‚è¯¥æ¨¡å—ç”¨äºŽé…ç½®è´Ÿè½½å‡è¡¡ç»“æž„ä»¥ä¸‹æ˜¯Nginxé»˜è®¤å…³é—­çš„æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨è¡¨æ ¼ä¸­çš„å‘½ä»¤æ¥å¼€å¯ç›¸åº”æ¨¡å—ï¼šé»˜è®¤ç¦ç”¨çš„æ¨¡å—&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æè¿°â€“with-http_ssl_moduleå¼€å¯SSLæ¨¡å—ï¼Œæ”¯æŒä½¿ç”¨HTTPSåè®®çš„ç½‘é¡µâ€“with-http_realip_moduleå¼€å¯Real IPçš„æ”¯æŒï¼Œè¯¥æ¨¡å—ç”¨äºŽä»Žå®¢æˆ·è¯·æ±‚çš„å¤´æ•°æ®ä¸­è¯»å–real IPåœ°å€â€“with-http_addition_moduleå¼€å¯Additionæ¨¡å—ï¼Œè¯¥æ¨¡å—å…è®¸ä½ è¿½åŠ æˆ–å‰ç½®æ•°æ®ï¼ˆprepend dataï¼‰åˆ°å“åº”çš„ä¸»ä½“éƒ¨åˆ†â€“with-http_xslt_moduleå¼€å¯XSLTæ¨¡å—çš„æ”¯æŒï¼Œè¯¥æ¨¡å—å®žçŽ°XSLTè½¬åŒ–ä¸ºXMLæ–‡æ¡£â€“with-http_image_filter_moduleå¼€å¯Image Filteræ¨¡å—ï¼Œè¯¥æ¨¡å—æ˜¯è®©ä½ ä¿®æ”¹å›¾åƒã€‚æ³¨æ„ï¼šå¦‚æžœæƒ³ç¼–è¯‘è¯¥æ¨¡å—ï¼Œéœ€è¦åœ¨ç³»ç»Ÿä¸­å®‰è£…libgdåº“â€“with-http_geoip_moduleå¼€å¯GeoIPæ¨¡å—ï¼Œè¯¥æ¨¡å—é€šè¿‡ä½¿ç”¨MaxMindâ€™s GeoI äºŒè¿›åˆ¶æ•°æ®åº“æ¥èŽ·å–å®¢æˆ·ç«¯åœ¨åœ°ç†ä¸Šçš„åˆ†å¸ƒã€‚æ³¨æ„ï¼šå¦‚æžœå¸Œæœ›ç¼–è¯‘è¯¥æ¨¡å—ï¼Œéœ€è¦åœ¨ç³»ç»Ÿä¸­å®‰è£…libgeoipåº“ã€‚â€“with-http_sub_moduleå¼€å¯Substitutionæ¨¡å—ï¼Œè¯¥æ¨¡å—ç”¨äºŽåœ¨ç½‘é¡µä¸­æ›¿æ¢æ–‡æœ¬â€“with-http_dav_moduleå¼€å¯WebDAVæ¨¡å—â€“with-http_flv_moduleå¼€å¯FLVæ¨¡å—ï¼Œè¯¥æ¨¡å—ç”¨äºŽä¸“é—¨å¤„ç†.flv(flashè§†é¢‘)æ–‡ä»¶â€“with-http_gzip_static_moduleå¼€å¯Gzipé™æ€æ¨¡å—ï¼Œè¯¥æ¨¡å—ç”¨äºŽå‘é€é¢„åŽ‹ç¼©çš„æ–‡ä»¶â€“with-http_random_index_moduleå¼€å¯Random Indexæ¨¡å—ã€‚è¯¥æ¨¡å—ç”¨äºŽæŒ‘é€‰ä¸€ä¸ªéšæœºçš„æ–‡ä»¶ä½œä¸ºè¯¥ç›®å½•çš„indexâ€“with-http_secure_link_moduleå¼€å¯Secure Linkæ¨¡å—ï¼Œè¯¥æ¨¡å—ç”¨äºŽåœ¨URLä¸­æ£€æµ‹å…³é”®å­—çš„å­˜åœ¨â€“with-http_stub_status_moduleå¼€å¯Stub Statusæ¨¡å—ï¼Œè¯¥æ¨¡å—ä¼šäº§ç”Ÿä¸€ä¸ªæœåŠ¡å™¨çŠ¶æ€å’Œä¿¡æ¯é¡µâ€“with-google_perftools_module&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;å¼€å¯googleæ€§èƒ½å·¥å…·æ¨¡å—å…¶å®ƒconfigureé€‰é¡¹é‚®ä»¶æœåŠ¡ä»£ç†â€“with-mailå¼€å¯é‚®ä»¶æœåŠ¡ä»£ç†ï¼ˆmail server proxyï¼‰æ¨¡å—ï¼Œæ”¯æŒPOP3ï¼ŒIMAP4å’ŒSMTPã€‚è¯¥åŠŸèƒ½é»˜è®¤ç¦ç”¨â€“with-mail_ssl_moduleå¼€å¯é‚®ä»¶ä»£ç†æœåŠ¡å¯¹SSLçš„æ”¯æŒã€‚è¯¥åŠŸèƒ½é»˜è®¤ç¦ç”¨â€“without-mail_pop3_moduleåœ¨é‚®ä»¶ä»£ç†ä¸‹ç¦ç”¨POP3åŠŸèƒ½ã€‚åœ¨å¼€å¯é‚®ä»¶ä»£ç†æ¨¡å—åŽè¯¥åŠŸèƒ½é»˜è®¤å¯ç”¨â€“without-mail_imap_moduleå¯¹é‚®ä»¶ä»£ç†æœåŠ¡å™¨ç¦ç”¨IMAP4æ¨¡å—ï¼Œåœ¨å¼€å¯é‚®ä»¶ä»£ç†æ¨¡å—åŽè¯¥åŠŸèƒ½é»˜è®¤å¯ç”¨â€“without-mail_smtp_moduleå¯¹äºŽé‚®ä»¶ä»£ç†æœåŠ¡å™¨ç¦ç”¨SMTPæ¨¡å—ï¼Œåœ¨å¼€å¯é‚®ä»¶ä»£ç†æ¨¡å—åŽè¯¥åŠŸèƒ½é»˜è®¤å¯ç”¨äº‹ä»¶ç®¡ç†â€“with-rtsig_moduleå¼€å¯rtsigæ¨¡å—ï¼Œä½¿ç”¨rtsigä½œä¸ºäº‹ä»¶é€šçŸ¥æœºåˆ¶â€“with-select_moduleå¼€å¯selectæ¨¡å—ï¼Œä½¿ç”¨selectä½œä¸ºäº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥æ¨¡å—æ˜¯å¼€å¯çš„ï¼Œé™¤éžç³»ç»Ÿæœ‰ä¸€ç§æ›´å¥½çš„æ–¹å¼å‘çŽ°â€”â€”kqueue, epoll, rtsig æˆ– pollâ€“without-select_moduleç¦ç”¨selectæ¨¡å—â€“with-poll_moduleå¼€å¯pollæ¨¡å—ï¼Œè¯¥æ¨¡å—ä½¿ç”¨pollä½œä¸ºäº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æžœæœ‰æ•ˆï¼Œè¯¥æ¨¡å—æ˜¯å¼€å¯çš„ï¼Œé™¤éžç³»ç»Ÿä¸Šæœ‰ä¸€ç§æ›´å¥½çš„æ–¹å¼å‘çŽ°â€”â€”kqueue, epollæˆ–rtsigâ€“without-poll_moduleç¦ç”¨pollæ¨¡å—ç”¨æˆ·å’Œç»„é€‰é¡¹â€“user=â€¦æŒ‡å®šå¯åŠ¨Nginxè¿›ç¨‹çš„é»˜è®¤ç”¨æˆ·ã€‚è¿™ä¸ªè®¾ç½®ä»…ç”¨äºŽåœ¨é…ç½®æ–‡ä»¶ä¸­çœç•¥useræŒ‡ä»¤æ¥æŒ‡å®šç”¨æˆ·çš„æƒ…å†µâ€“group=â€¦æŒ‡å®šå¯åŠ¨Nginxè¿›ç¨‹é»˜è®¤çš„ç”¨æˆ·ç»„ã€‚è¿™ä¸ªè®¾ç½®ä»…ç”¨äºŽåœ¨é…ç½®æ–‡ä»¶ä¸­çœç•¥ä½¿ç”¨groupæŒ‡ä»¤æ¥æŒ‡å®šç”¨æˆ·çš„æƒ…å†µå…¶å®ƒé€‰é¡¹â€“with-ipv6å¼€å¯å¯¹IPv6çš„æ”¯æŒâ€“without-httpç¦ç”¨HTTPæœåŠ¡â€“without-http-cacheç¦ç”¨HTTPç¼“å†²åŠŸèƒ½â€“add-module=PATHé€šè¿‡æŒ‡å®šçš„è·¯å¾„ç¼–è¯‘æ·»åŠ ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚å¦‚æžœå¸Œæœ›ç¼–è¯‘å¤šä¸ªæ¨¡å—ï¼Œé‚£ä¹ˆè¯¥é€‰é¡¹å¯ä»¥æ— é™æ¬¡ä½¿ç”¨â€“with-debugå¼€å¯è®°å½•é¢å¤–çš„è°ƒè¯•ä¿¡æ¯]]></content>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootä¸­ä½¿ç”¨thymeleaf]]></title>
    <url>%2FSpring-Boot%E4%BD%BF%E7%94%A8thymeleaf.html</url>
    <content type="text"><![CDATA[Spring Bootæ”¯æŒFreeMarkerã€Groovyã€Thymeleafå’ŒMustacheå››ç§æ¨¡æ¿è§£æžå¼•æ“Žï¼Œå®˜æ–¹æŽ¨èä½¿ç”¨Thymeleafã€‚spring-boot-starter-thymeleafåœ¨Spring Bootä¸­ä½¿ç”¨Thymeleafåªéœ€åœ¨pomä¸­åŠ å…¥Thymeleafçš„starterå³å¯ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;&lt;/dependency&gt;åœ¨Spring Boot 1.5.9.RELEASEç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤çš„Thymeleafç‰ˆæœ¬ä¸º2.1.6.RELEASEç‰ˆæœ¬ï¼Œè¿™é‡ŒæŽ¨èä½¿ç”¨3.0ä»¥ä¸Šç‰ˆæœ¬ã€‚åœ¨pomä¸­å°†Thymeleafçš„ç‰ˆæœ¬ä¿®æ”¹ä¸º3.0.2.RELEASEï¼š1234&lt;properties&gt; &lt;thymeleaf.version&gt;3.0.2.RELEASE&lt;/thymeleaf.version&gt; &lt;thymeleaf-layout-dialect.version&gt;2.0.1&lt;/thymeleaf-layout-dialect.version&gt;&lt;/properties&gt;åœ¨Spring Bootä¸­ï¼Œé»˜è®¤çš„htmlé¡µé¢åœ°å€ä¸ºsrc/main/resources/templatesï¼Œé»˜è®¤çš„é™æ€èµ„æºåœ°å€ä¸ºsrc/main/resources/staticã€‚Thymeleafé»˜è®¤é…ç½®åœ¨Spring Booté…ç½®æ–‡ä»¶ä¸­å¯å¯¹Thymeleafçš„é»˜è®¤é…ç½®è¿›è¡Œä¿®æ”¹ï¼š123456789101112131415161718192021222324#å¼€å¯æ¨¡æ¿ç¼“å­˜ï¼ˆé»˜è®¤å€¼ï¼štrueï¼‰spring.thymeleaf.cache=true #Check that the template exists before rendering it.spring.thymeleaf.check-template=true #æ£€æŸ¥æ¨¡æ¿ä½ç½®æ˜¯å¦æ­£ç¡®ï¼ˆé»˜è®¤å€¼:trueï¼‰spring.thymeleaf.check-template-location=true#Content-Typeçš„å€¼ï¼ˆé»˜è®¤å€¼ï¼štext/htmlï¼‰spring.thymeleaf.content-type=text/html#å¼€å¯MVC Thymeleafè§†å›¾è§£æžï¼ˆé»˜è®¤å€¼ï¼štrueï¼‰spring.thymeleaf.enabled=true#æ¨¡æ¿ç¼–ç spring.thymeleaf.encoding=UTF-8#è¦è¢«æŽ’é™¤åœ¨è§£æžä¹‹å¤–çš„è§†å›¾åç§°åˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”spring.thymeleaf.excluded-view-names=#è¦è¿ç”¨äºŽæ¨¡æ¿ä¹‹ä¸Šçš„æ¨¡æ¿æ¨¡å¼ã€‚å¦è§StandardTemplate-ModeHandlers(é»˜è®¤å€¼ï¼šHTML5)spring.thymeleaf.mode=HTML5#åœ¨æž„å»ºURLæ—¶æ·»åŠ åˆ°è§†å›¾åç§°å‰çš„å‰ç¼€ï¼ˆé»˜è®¤å€¼ï¼šclasspath:/templates/ï¼‰spring.thymeleaf.prefix=classpath:/templates/#åœ¨æž„å»ºURLæ—¶æ·»åŠ åˆ°è§†å›¾åç§°åŽçš„åŽç¼€ï¼ˆé»˜è®¤å€¼ï¼š.htmlï¼‰spring.thymeleaf.suffix=.html#Thymeleafæ¨¡æ¿è§£æžå™¨åœ¨è§£æžå™¨é“¾ä¸­çš„é¡ºåºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæŽ’ç¬¬ä¸€ä½ã€‚é¡ºåºä»Ž1å¼€å§‹ï¼Œåªæœ‰åœ¨å®šä¹‰äº†é¢å¤–çš„TemplateResolver Beanæ—¶æ‰éœ€è¦è®¾ç½®è¿™ä¸ªå±žæ€§ã€‚spring.thymeleaf.template-resolver-order=#å¯è§£æžçš„è§†å›¾åç§°åˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”spring.thymeleaf.view-names=ä¸€èˆ¬å¼€å‘ä¸­å°†spring.thymeleaf.cacheè®¾ç½®ä¸ºfalseï¼Œå…¶ä»–ä¿æŒé»˜è®¤å€¼å³å¯ã€‚ç®€å•ç¤ºä¾‹ç¼–å†™ä¸€ä¸ªç®€å•çš„Controllerï¼š1234567891011121314@Controllerpublic class IndexController &#123; @RequestMapping("/account") public String index(Model m) &#123; List&lt;Account&gt; list = new ArrayList&lt;Account&gt;(); list.add(new Account("KangKang", "åº·åº·", "e10adc3949ba59abbe56e", "è¶…çº§ç®¡ç†å‘˜", "17777777777")); list.add(new Account("Mike", "éº¦å…‹", "e10adc3949ba59abbe56e", "ç®¡ç†å‘˜", "13444444444")); list.add(new Account("Jane","ç®€","e10adc3949ba59abbe56e","è¿ç»´äººå‘˜","18666666666")); list.add(new Account("Maria", "çŽ›åˆ©äºš", "e10adc3949ba59abbe56e", "æ¸…ç®—äººå‘˜", "19999999999")); m.addAttribute("accountList",list); return "account"; &#125;&#125;ç¼–å†™account.htmlé¡µé¢ï¼š12345678910111213141516171819202122232425262728&lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;title&gt;account&lt;/title&gt; &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt; &lt;link rel="stylesheet" th:href="@&#123;/css/style.css&#125;" type="text/css"&gt;&lt;/head&gt;&lt;body&gt; &lt;table&gt; &lt;tr&gt; &lt;th&gt;no&lt;/th&gt; &lt;th&gt;account&lt;/th&gt; &lt;th&gt;name&lt;/th&gt; &lt;th&gt;password&lt;/th&gt; &lt;th&gt;accountType&lt;/th&gt; &lt;th&gt;tel&lt;/th&gt; &lt;/tr&gt; &lt;tr th:each="list,stat : $&#123;accountList&#125;"&gt; &lt;td th:text="$&#123;stat.count&#125;"&gt;&lt;/td&gt; &lt;td th:text="$&#123;list.account&#125;"&gt;&lt;/td&gt; &lt;td th:text="$&#123;list.name&#125;"&gt;&lt;/td&gt; &lt;td th:text="$&#123;list.password&#125;"&gt;&lt;/td&gt; &lt;td th:text="$&#123;list.accountType&#125;"&gt;&lt;/td&gt; &lt;td th:text="$&#123;list.tel&#125;"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt;&lt;/body&gt;&lt;/html&gt;æœ€ç»ˆé¡¹ç›®ç›®å½•å¦‚ä¸‹æ‰€ç¤ºï¼šå¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/web/accountï¼šsource code]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
        <tag>Thymeleaf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Thymeleaf å±€éƒ¨å˜é‡]]></title>
    <url>%2FThymeleaf-%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F.html</url>
    <content type="text"><![CDATA[åœ¨Thymeleafæ¨¡æ¿å¼•æ“Žä¸­ï¼Œä½¿ç”¨ th:withå±žæ€§æ¥å£°æ˜Žä¸€ä¸ªå±€éƒ¨å˜é‡ï¼š123&lt;div th:with="firstPer=$&#123;persons[0]&#125;"&gt; &lt;p&gt;The name of the first person is &lt;span th:text="$&#123;firstPer.name&#125;"&gt;Julius Caesar&lt;/span&gt;.&lt;/p&gt;&lt;/div&gt;åœ¨ä¸Šé¢divä¸­ï¼Œth:widthå±žæ€§å£°æ˜Žäº†ä¸€ä¸ªåä¸ºfirstPerçš„å±€éƒ¨å˜é‡ï¼Œå†…å®¹ä¸º${persons[0]}ã€‚è¯¥å±€éƒ¨å˜é‡çš„ä½œç”¨åŸŸä¸ºæ•´ä¸ªdivå†…ã€‚ä¹Ÿå¯ä»¥ä¸€æ¬¡æ€§å®šä¹‰å¤šä¸ªå˜é‡ï¼š123456789&lt;div th:with="firstPer=$&#123;persons[0]&#125;,secondPer=$&#123;persons[1]&#125;"&gt; &lt;p&gt; The name of the first person is &lt;span th:text="$&#123;firstPer.name&#125;"&gt;Julius Caesar&lt;/span&gt;. &lt;/p&gt; &lt;p&gt; But the name of the second person is &lt;span th:text="$&#123;secondPer.name&#125;"&gt;Marcus Antonius&lt;/span&gt;. &lt;/p&gt;&lt;/div&gt;th:withå±žæ€§å…è®¸é‡ç”¨åœ¨åŒä¸€ä¸ªå±žæ€§ä¸­å®šä¹‰çš„å˜é‡ï¼š1&lt;div th:with="company=$&#123;user.company + ' Co.'&#125;,account=$&#123;accounts[company]&#125;"&gt;...&lt;/div&gt;]]></content>
      <tags>
        <tag>Thymeleaf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Thymeleaf æ¨¡æ¿å¸ƒå±€]]></title>
    <url>%2FThymeleaf-%E6%A8%A1%E6%9D%BF%E5%B8%83%E5%B1%80.html</url>
    <content type="text"><![CDATA[th:include,th:insertå’Œth:replaceåœ¨æ¨¡æ¿çš„ç¼–å†™ä¸­ï¼Œé€šå¸¸å¸Œæœ›èƒ½å¤Ÿå¼•å…¥åˆ«çš„æ¨¡æ¿ç‰‡æ®µï¼Œæ¯”å¦‚é€šç”¨çš„å¤´éƒ¨å’Œé¡µè„šã€‚Thymeleafæ¨¡æ¿å¼•æ“Žçš„th:includeï¼Œth:insertå’Œth:replaceå±žæ€§å¯ä»¥è½»æ¾çš„å®žçŽ°è¯¥éœ€æ±‚ã€‚ä¸è¿‡ä»ŽThymeleaf 3.0ç‰ˆæœ¬åŽï¼Œ ä¸å†æŽ¨èä½¿ç”¨th:includeå±žæ€§ã€‚åœ¨index.htmlé¡µé¢è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªfooter.htmlï¼š12345678&lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt; &lt;body&gt; &lt;footer th:fragment="copy"&gt; &amp;copy; 2016 - 2017 MrBird Powered by Hexo &lt;/footer&gt; &lt;/body&gt;&lt;/html&gt;åœ¨footer.htmlä¸­ï¼Œä½¿ç”¨th:fragmentå±žæ€§å®šä¹‰äº†&lt;footer&gt;ç‰‡æ®µï¼Œç„¶åŽåœ¨index.htmlä¸­å¼•ç”¨å®ƒï¼š123&lt;div th:include="~&#123;footer :: copy&#125;"&gt;&lt;/div&gt; &lt;div th:insert="~&#123;footer :: copy&#125;"&gt;&lt;/div&gt; &lt;div th:replace="~&#123;footer :: copy&#125;"&gt;&lt;/div&gt;å…¶ä¸­footerä¸ºè¢«å¼•ç”¨çš„æ¨¡æ¿åç§°ï¼ˆtemplatenameï¼‰ï¼Œcopyä¸ºth:fragmentæ ‡è®°çš„ç‰‡æ®µåç§°ï¼ˆselectorï¼‰ï¼Œ~{...}ç§°ä¸ºç‰‡æ®µè¡¨è¾¾å¼ï¼Œç”±äºŽå…¶ä¸æ˜¯ä¸€ä¸ªå¤æ‚çš„ç‰‡æ®µè¡¨è¾¾å¼ï¼Œæ‰€ä»¥å¯ä»¥ç®€å†™ä¸ºï¼š1&lt;div th:include="footer :: copy"&gt;&lt;/div&gt;é¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼šé€šè¿‡è§‚å¯Ÿæ¸²æŸ“å‡ºçš„æºç å¯å‘çŽ°th:includeï¼Œth:insertå’Œth:replaceçš„åŒºåˆ«æ‰€åœ¨ï¼š1234567891011&lt;div&gt; &amp;copy; 2016 - 2017 MrBird Powered by Hexo&lt;/div&gt; &lt;div&gt; &lt;footer&gt; &amp;copy; 2016 - 2017 MrBird Powered by Hexo &lt;/footer&gt;&lt;/div&gt; &lt;footer&gt; &amp;copy; 2016 - 2017 MrBird Powered by Hexo&lt;/footer&gt;å¼•ç”¨æœ¬é¡µé¢çš„ç‰‡æ®µå¯ä»¥ç•¥åŽ»templatenameï¼Œæˆ–è€…ä½¿ç”¨thisæ¥ä»£æ›¿ã€‚å¼•ç”¨æ²¡æœ‰th:fragmentçš„ç‰‡æ®µå¦‚æžœç‰‡æ®µä¸åŒ…å«th:fragmentå±žæ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨CSSé€‰æ‹©å™¨æ¥é€‰ä¸­è¯¥ç‰‡æ®µï¼Œå¦‚ï¼š123&lt;div id="copy-section"&gt; &amp;copy; 2011 The Good Thymes Virtual Grocery&lt;/div&gt;å¼•ç”¨æ–¹å¼ï¼š1&lt;div th:insert="~&#123;footer :: #copy-section&#125;"&gt;&lt;/div&gt;åœ¨th:fragmentä¸­ä½¿ç”¨å‚æ•°ä½¿ç”¨th:fragmentå®šä¹‰çš„ç‰‡æ®µå¯ä»¥æŒ‡å®šä¸€ç»„å‚æ•°ï¼š123&lt;div th:fragment="frag (onevar,twovar)"&gt; &lt;p th:text="$&#123;onevar&#125; + ' - ' + $&#123;twovar&#125;"&gt;...&lt;/p&gt;&lt;/div&gt;ç„¶åŽåœ¨å¼•ç”¨çš„æ—¶å€™ç»™è¿™ä¸¤ä¸ªå‚æ•°èµ‹å€¼ï¼Œæœ‰å¦‚ä¸‹ä¸¤ç§æ–¹å¼ï¼š12&lt;div th:replace="this :: frag ('value1','value2')"&gt;&lt;/div&gt;&lt;div th:replace="this :: frag (onevar='value_one',twovar='value_two')"&gt;&lt;/div&gt;å¯¹äºŽç¬¬äºŒç§æ–¹å¼ï¼Œonevarå’Œtwovarçš„é¡ºåºä¸é‡è¦ï¼Œå¹¶ä¸”ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼å¼•ç”¨ç‰‡æ®µæ—¶ï¼Œç‰‡æ®µå¯ä»¥ç®€å†™ä¸ºï¼š123&lt;div th:fragment="frag"&gt; &lt;p th:text="$&#123;onevar&#125; + ' - ' + $&#123;twovar&#125;"&gt;...&lt;/p&gt;&lt;/div&gt;th:removeth:removeç”¨äºŽåˆ é™¤ç‰‡æ®µï¼Œæ”¯æŒçš„å±žæ€§å€¼æœ‰ï¼šallï¼šåˆ é™¤æ ‡ç­¾åŠå…¶æ‰€æœ‰å­æ ‡ç­¾ã€‚bodyï¼šä¸åˆ é™¤åŒ…å«çš„æ ‡ç­¾ï¼Œä½†åˆ é™¤å…¶æ‰€æœ‰å­ä»£ã€‚tagï¼šåˆ é™¤åŒ…å«çš„æ ‡ç­¾ï¼Œä½†ä¸è¦åˆ é™¤å…¶å­æ ‡ç­¾ã€‚all-but-firstï¼šåˆ é™¤é™¤ç¬¬ä¸€ä¸ªä¹‹å¤–çš„æ‰€æœ‰åŒ…å«æ ‡ç­¾çš„å­æ ‡ç­¾ã€‚noneã€‚æ¯”å¦‚æœ‰å¦‚ä¸‹ç‰‡æ®µï¼š1234567891011121314151617&lt;table border="1"&gt; &lt;tr&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;th&gt;PRICE&lt;/th&gt; &lt;th&gt;IN STOCK&lt;/th&gt; &lt;th&gt;COMMENTS&lt;/th&gt; &lt;/tr&gt; &lt;tr th:remove="value"&gt; &lt;td&gt;Mild Cinnamon&lt;/td&gt; &lt;td&gt;1.99&lt;/td&gt; &lt;td&gt;yes&lt;/td&gt; &lt;td&gt; &lt;span&gt;3&lt;/span&gt; comment/s &lt;a href="comments.html"&gt;view&lt;/a&gt; &lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;å½“valueä¸ºallæ—¶ï¼Œé¡µé¢æ¸²æŸ“ä¸ºï¼š12345678&lt;table border="1"&gt; &lt;tr&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;th&gt;PRICE&lt;/th&gt; &lt;th&gt;IN STOCK&lt;/th&gt; &lt;th&gt;COMMENTS&lt;/th&gt; &lt;/tr&gt;&lt;/table&gt;å½“valueä¸ºbodyæ—¶ï¼Œé¡µé¢æ¸²æŸ“ä¸ºï¼š12345678910&lt;table border="1"&gt; &lt;tr&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;th&gt;PRICE&lt;/th&gt; &lt;th&gt;IN STOCK&lt;/th&gt; &lt;th&gt;COMMENTS&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;/tr&gt;&lt;/table&gt;å½“valueä¸ºtagæ—¶ï¼Œé¡µé¢æ¸²æŸ“ä¸ºï¼š123456789101112131415&lt;table border="1"&gt; &lt;tr&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;th&gt;PRICE&lt;/th&gt; &lt;th&gt;IN STOCK&lt;/th&gt; &lt;th&gt;COMMENTS&lt;/th&gt; &lt;/tr&gt; &lt;td&gt;Mild Cinnamon&lt;/td&gt; &lt;td&gt;1.99&lt;/td&gt; &lt;td&gt;yes&lt;/td&gt; &lt;td&gt; &lt;span&gt;3&lt;/span&gt; comment/s &lt;a href="comments.html"&gt;view&lt;/a&gt; &lt;/td&gt;&lt;/table&gt;å½“valueä¸ºall-but-firstæ—¶ï¼Œé¡µé¢æ¸²æŸ“ä¸ºï¼š1234567891011&lt;table border="1"&gt; &lt;tr&gt; &lt;th&gt;NAME&lt;/th&gt; &lt;th&gt;PRICE&lt;/th&gt; &lt;th&gt;IN STOCK&lt;/th&gt; &lt;th&gt;COMMENTS&lt;/th&gt; &lt;/tr&gt; &lt;tr th:remove="value"&gt; &lt;td&gt;Mild Cinnamon&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;]]></content>
      <tags>
        <tag>Thymeleaf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Thymeleaf æ¡ä»¶è¯­å¥]]></title>
    <url>%2FThymeleaf%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5.html</url>
    <content type="text"><![CDATA[if ä¸Ž unlesså‡å¦‚çŽ°åœ¨æœ‰ä¸€ä¸ªå•†å“åˆ—è¡¨ï¼Œå½“å•†å“æœ‰è¯„è®ºæ—¶ï¼Œæ˜¾ç¤ºviewæŒ‰é’®ï¼Œå¦åˆ™ä¸æ˜¾ç¤ºã€‚è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨Thymeleafçš„th:ifæ ‡ç­¾æ¥å®žçŽ°:123&lt;a href="comments.html" th:href="@&#123;/product/comments(prodId=$&#123;prod.id&#125;)&#125;" th:if="$&#123;not #lists.isEmpty(prod.comments)&#125;"&gt;view&lt;/a&gt;å½“prod.commentsä¸ä¸ºç©ºæ—¶ï¼Œé¡µé¢å°†æ¸²æŸ“å‡ºè¯¥&lt;a&gt;æ ‡ç­¾ã€‚å¦å¤–ï¼Œth:ifæœ‰ä¸€ä¸ªåå‘å±žæ€§th:unlessï¼Œç”¨äºŽä»£æ›¿ä¸Šé¢çš„notï¼š123&lt;a href="comments.html" th:href="@&#123;/comments(prodId=$&#123;prod.id&#125;)&#125;" th:unless="$&#123;#lists.isEmpty(prod.comments)&#125;"&gt;view&lt;/a&gt;switchThymeleafä¸­çš„th:switchå’Œå…¶ä»–è¯­è¨€çš„switch caseè¯­å¥å·®ä¸å¤šï¼š1234&lt;div th:switch="$&#123;user.role&#125;"&gt; &lt;p th:case="'admin'"&gt;User is an administrator&lt;/p&gt; &lt;p th:case="'manager'"&gt;User is a manager&lt;/p&gt;&lt;/div&gt;th:case=&quot;*&quot;è¡¨ç¤ºé»˜è®¤é€‰é¡¹ï¼Œç›¸å½“äºŽdefaultï¼š12345&lt;div th:switch="$&#123;user.role&#125;"&gt; &lt;p th:case="'admin'"&gt;User is an administrator&lt;/p&gt; &lt;p th:case="'manager'"&gt;User is a manager&lt;/p&gt; &lt;p th:case="*"&gt;User is some other thing&lt;/p&gt;&lt;/div&gt;]]></content>
      <tags>
        <tag>Thymeleaf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Thymeleaf è¿­ä»£]]></title>
    <url>%2FThymeleaf-%E8%BF%AD%E4%BB%A3.html</url>
    <content type="text"><![CDATA[åœ¨Thymeleafä¸­ï¼Œä½¿ç”¨th:eachæ ‡ç­¾å¯å¯¹é›†åˆç±»åž‹è¿›è¡Œè¿­ä»£ï¼Œæ”¯æŒçš„ç±»åž‹æœ‰ï¼š1.ä»»ä½•å®žçŽ°äº†java.util.Listçš„å¯¹è±¡ï¼›2.ä»»ä½•å®žçŽ°äº†java.util.Iterableçš„å¯¹è±¡ï¼›3.ä»»ä½•å®žçŽ°äº†java.util.Enumerationçš„å¯¹è±¡ï¼›4.ä»»ä½•å®žçŽ°äº†java.util.Iteratorçš„å¯¹è±¡;5.ä»»ä½•å®žçŽ°äº†java.util.Mapçš„å¯¹è±¡ã€‚å½“è¿­ä»£mapsæ—¶ï¼Œè¿­ä»£å˜é‡æ˜¯java.util.Map.Entryç±»åž‹ï¼›6.ä»»ä½•æ•°ç»„ã€‚ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š1234&lt;tr th:each="prod : $&#123;prods&#125;"&gt; &lt;td th:text="$&#123;prod.name&#125;"&gt;Onions&lt;/td&gt; &lt;td th:text="$&#123;prod.price&#125;"&gt;2.41&lt;/td&gt;&lt;/tr&gt;å…¶ä¸­${prods}ä¸ºè¿­ä»£å€¼ï¼Œprodä¸ºè¿­ä»£å˜é‡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡çŠ¶æ€å˜é‡èŽ·å–è¿­ä»£çš„çŠ¶æ€ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š1&lt;tr th:each="prod,stat : $&#123;prods&#125;"&gt; ...å…¶ä¸­statå°±æ˜¯çŠ¶æ€å˜é‡ã€‚é»˜è®¤ä¸ºè¿­ä»£å˜é‡åŠ ä¸ŠStatåŽç¼€ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œä¸ç›´æŽ¥ç”³æ˜Žstatï¼Œåˆ™çŠ¶æ€å˜é‡åç§°ä¸ºprodStatã€‚çŠ¶æ€å˜é‡åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š1.indexï¼Œå½“å‰è¿­ä»£ä¸‹æ ‡ï¼Œä»Ž0å¼€å§‹ï¼›2.countï¼Œå½“å‰è¿­ä»£ä½ç½®ï¼Œä»Ž1å¼€å§‹ï¼›3.sizeï¼Œè¿­ä»£å˜é‡ä¸­çš„æ€»è®¡æ•°é‡ï¼›4.currentï¼Œæ¯æ¬¡è¿­ä»£çš„è¿­ä»£å˜é‡ï¼›5.even/oddï¼Œå½“å‰è¿­ä»£æ˜¯å¶æ•°è¿˜æ˜¯å¥‡æ•°ï¼›6.firstï¼Œå½“å‰è¿­ä»£çš„æ˜¯ä¸æ˜¯ç¬¬ä¸€ä¸ªï¼›7.lastï¼Œå½“å‰è¿­ä»£çš„æ˜¯ä¸æ˜¯æœ€åŽä¸€ä¸ªï¼›ä¾‹å­ï¼š12345678910&lt;div th:each="habbits,stat : $&#123;user.habbit&#125;"&gt; &lt;span th:text="$&#123;habbits&#125;"&gt;&lt;/span&gt; &lt;span th:text="$&#123;stat.index&#125;"&gt;&lt;/span&gt; &lt;span th:text="$&#123;stat.count&#125;"&gt;&lt;/span&gt; &lt;span th:text="$&#123;stat.size&#125;"&gt;&lt;/span&gt; &lt;span th:text="$&#123;stat.current&#125;"&gt;&lt;/span&gt; &lt;span th:text="$&#123;stat.even&#125;"&gt;&lt;/span&gt; &lt;span th:text="$&#123;stat.first&#125;"&gt;&lt;/span&gt; &lt;span th:text="$&#123;stat.last&#125;"&gt;&lt;/span&gt;&lt;/div&gt;é¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼š]]></content>
      <tags>
        <tag>Thymeleaf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Thymeleaf è¡¨è¾¾å¼å·¥å…·ç±»]]></title>
    <url>%2FThymeleaf-%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%B7%A5%E5%85%B7%E7%B1%BB.html</url>
    <content type="text"><![CDATA[Thymeleafé»˜è®¤æä¾›äº†ä¸°å¯Œçš„è¡¨è¾¾å¼å·¥å…·ç±»ï¼Œè¿™é‡Œåˆ—ä¸¾ä¸€äº›å¸¸ç”¨çš„å·¥å…·ç±»ã€‚Objectså·¥å…·ç±»12345678/* * å½“objä¸ä¸ºç©ºæ—¶ï¼Œè¿”å›žobjï¼Œå¦åˆ™è¿”å›ždefaulté»˜è®¤å€¼ * å…¶åŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#objects.nullSafe(obj,default)&#125;$&#123;#objects.arrayNullSafe(objArray,default)&#125;$&#123;#objects.listNullSafe(objList,default)&#125;$&#123;#objects.setNullSafe(objSet,default)&#125;Stringå·¥å…·ç±»123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122/* * Null-safe toString() */$&#123;#strings.toString(obj)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * æ£€æŸ¥Stringæ˜¯å¦ä¸ºç©º(æˆ–null)ã€‚åœ¨æ£€æŸ¥ä¹‹å‰æ‰§è¡Œtrim()æ“ä½œä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#strings.isEmpty(name)&#125;$&#123;#strings.arrayIsEmpty(nameArr)&#125;$&#123;#strings.listIsEmpty(nameList)&#125;$&#123;#strings.setIsEmpty(nameSet)&#125;/* * å¯¹å­—ç¬¦ä¸²æ‰§è¡Œâ€œisEmpty()â€æ£€æŸ¥, å¦‚æžœä¸ºfalseåˆ™è¿”å›žå®ƒ, å¦‚æžœä¸ºtrueåˆ™é»˜è®¤ä¸ºå¦ä¸€ä¸ªæŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#strings.defaultString(text,default)&#125;$&#123;#strings.arrayDefaultString(textArr,default)&#125;$&#123;#strings.listDefaultString(textList,default)&#125;$&#123;#strings.setDefaultString(textSet,default)&#125;/* * æ£€æŸ¥å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«ç‰‡æ®µï¼Œæ¯”å¦‚ $&#123;#strings.containsIgnoreCase(user.name,'kang')&#125; * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#strings.contains(name,'ez')&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.containsIgnoreCase(name,'ez')&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä»¥ç‰‡æ®µå¼€å§‹æˆ–ç»“æŸ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#strings.startsWith(name,'Don')&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.endsWith(name,endingFragment)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * å­ä¸²ç›¸å…³æ“ä½œ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#strings.indexOf(name,frag)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.substring(name,3,5)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.substringAfter(name,prefix)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.substringBefore(name,suffix)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.replace(name,'las','ler')&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * é™„åŠ å’Œå‰ç½® * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#strings.prepend(str,prefix)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.append(str,suffix)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * å¤§å°å†™è½¬æ¢ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#strings.toUpperCase(name)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.toLowerCase(name)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * æ‹†åˆ†å’Œæ‹¼æŽ¥ */$&#123;#strings.arrayJoin(namesArray,',')&#125;$&#123;#strings.listJoin(namesList,',')&#125;$&#123;#strings.setJoin(namesSet,',')&#125;$&#123;#strings.arraySplit(namesStr,',')&#125; // è¿”å›žString []$&#123;#strings.listSplit(namesStr,',')&#125; // è¿”å›žList&lt;String&gt;$&#123;#strings.setSplit(namesStr,',')&#125; // è¿”å›žSet&lt;String&gt;/* * Trim * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#strings.trim(str)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * è®¡ç®—é•¿åº¦ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#strings.length(str)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * ç¼©å†™æ–‡æœ¬, ä½¿å…¶æœ€å¤§å¤§å°ä¸ºnã€‚å¦‚æžœæ–‡æœ¬è¾ƒå¤§, å®ƒå°†è¢«å‰ªè¾‘å¹¶åœ¨æœ«å°¾é™„åŠ â€œ...â€ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#strings.abbreviate(str,10)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * å°†ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå¤§å†™(åä¹‹äº¦ç„¶) */$&#123;#strings.capitalize(str)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.unCapitalize(str)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * å°†æ¯ä¸ªå•è¯çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå¤§å†™ */$&#123;#strings.capitalizeWords(str)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.capitalizeWords(str,delimiters)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * è½¬ä¹‰å­—ç¬¦ä¸² */$&#123;#strings.escapeXml(str)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.escapeJava(str)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.escapeJavaScript(str)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.unescapeJava(str)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*$&#123;#strings.unescapeJavaScript(str)&#125; // ä¹Ÿå¯ä»¥æ˜¯ array*ã€list* æˆ– set*/* * ç©ºå®‰å…¨æ¯”è¾ƒå’Œè¿žæŽ¥ */$&#123;#strings.equals(first, second)&#125;$&#123;#strings.equalsIgnoreCase(first, second)&#125;$&#123;#strings.concat(values...)&#125;$&#123;#strings.concatReplaceNulls(nullValue, values...)&#125;/* * éšæœºæ•° */$&#123;#strings.randomAlphanumeric(count)&#125;Dateså·¥å…·ç±»1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465/* * ä½¿ç”¨æ ‡å‡†åŒºåŸŸè®¾ç½®æ ¼å¼æ ¼å¼åŒ–æ—¥æœŸ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#dates.format(date)&#125;$&#123;#dates.arrayFormat(datesArray)&#125;$&#123;#dates.listFormat(datesList)&#125;$&#123;#dates.setFormat(datesSet)&#125;/* * ä½¿ç”¨ISO8601æ ¼å¼æ ¼å¼åŒ–æ—¥æœŸ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#dates.formatISO(date)&#125;$&#123;#dates.arrayFormatISO(datesArray)&#125;$&#123;#dates.listFormatISO(datesList)&#125;$&#123;#dates.setFormatISO(datesSet)&#125;/* * ä½¿ç”¨æŒ‡å®šçš„æ ¼å¼æ ¼å¼åŒ–æ—¥æœŸï¼Œæ¯”å¦‚ $&#123;#dates.format(date,'yyyy-MM-dd HH:mm:ss')&#125; * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#dates.format(date, 'dd/MMM/yyyy HH:mm')&#125;$&#123;#dates.arrayFormat(datesArray, 'dd/MMM/yyyy HH:mm')&#125;$&#123;#dates.listFormat(datesList, 'dd/MMM/yyyy HH:mm')&#125;$&#123;#dates.setFormat(datesSet, 'dd/MMM/yyyy HH:mm')&#125;/* * èŽ·å–æ—¥æœŸå±žæ€§ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#dates.day(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayDay(...), listDay(...)ä¹‹ç±»çš„$&#123;#dates.month(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayMonth(...), listMonth(...)ä¹‹ç±»çš„$&#123;#dates.monthName(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayMonthName(...), listMonthName(...)ä¹‹ç±»çš„$&#123;#dates.monthNameShort(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayMonthNameShort(...), listMonthNameShort(...)ä¹‹ç±»çš„$&#123;#dates.year(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayYear(...), listYear(...)ä¹‹ç±»çš„$&#123;#dates.dayOfWeek(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayDayOfWeek(...), listDayOfWeek(...)ä¹‹ç±»çš„$&#123;#dates.dayOfWeekName(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayDayOfWeekName(...), listDayOfWeekName(...)ä¹‹ç±»çš„$&#123;#dates.dayOfWeekNameShort(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayDayOfWeekNameShort(...), listDayOfWeekNameShort(...)ä¹‹ç±»çš„$&#123;#dates.hour(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayHour(...), listHour(...)ä¹‹ç±»çš„$&#123;#dates.minute(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayMinute(...), listMinute(...)ä¹‹ç±»çš„$&#123;#dates.second(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arraySecond(...), listSecond(...)ä¹‹ç±»çš„$&#123;#dates.millisecond(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayMillisecond(...), listMillisecond(...)ä¹‹ç±»çš„/* * æ ¹æ®year,month,dayåˆ›å»ºæ—¥æœŸ(java.util.Date)å¯¹è±¡ï¼Œæ¯”å¦‚ $&#123;#dates.create('2008','08','08')&#125; */$&#123;#dates.create(year,month,day)&#125;$&#123;#dates.create(year,month,day,hour,minute)&#125;$&#123;#dates.create(year,month,day,hour,minute,second)&#125;$&#123;#dates.create(year,month,day,hour,minute,second,millisecond)&#125;/* * åˆ›å»ºå½“å‰æ—¥æœŸå’Œæ—¶é—´åˆ›å»ºæ—¥æœŸ(java.util.Date)å¯¹è±¡ï¼Œæ¯”å¦‚ $&#123;#dates.format(#dates.createNow(),'yyyy-MM-dd HH:mm:ss')&#125; */$&#123;#dates.createNow()&#125;$&#123;#dates.createNowForTimeZone()&#125;/* * åˆ›å»ºå½“å‰æ—¥æœŸåˆ›å»ºä¸€ä¸ªæ—¥æœŸ(java.util.Date)å¯¹è±¡(æ—¶é—´è®¾ç½®ä¸º00:00) */$&#123;#dates.createToday()&#125;$&#123;#dates.createTodayForTimeZone()&#125;Calendarså·¥å…·ç±»12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970/* * ä½¿ç”¨æ ‡å‡†åŒºåŸŸè®¾ç½®æ ¼å¼æ ¼å¼åŒ–æ—¥åŽ† * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#calendars.format(cal)&#125;$&#123;#calendars.arrayFormat(calArray)&#125;$&#123;#calendars.listFormat(calList)&#125;$&#123;#calendars.setFormat(calSet)&#125;/* * ä½¿ç”¨ISO8601æ ¼å¼æ ¼å¼åŒ–æ—¥åŽ† * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#calendars.formatISO(cal)&#125;$&#123;#calendars.arrayFormatISO(calArray)&#125;$&#123;#calendars.listFormatISO(calList)&#125;$&#123;#calendars.setFormatISO(calSet)&#125;/* * ä½¿ç”¨æŒ‡å®šçš„æ ¼å¼æ ¼å¼åŒ–æ—¥åŽ† * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#calendars.format(cal, 'dd/MMM/yyyy HH:mm')&#125;$&#123;#calendars.arrayFormat(calArray, 'dd/MMM/yyyy HH:mm')&#125;$&#123;#calendars.listFormat(calList, 'dd/MMM/yyyy HH:mm')&#125;$&#123;#calendars.setFormat(calSet, 'dd/MMM/yyyy HH:mm')&#125;/* * èŽ·å–æ—¥åŽ†å±žæ€§ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#calendars.day(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayDay(...), listDay(...)ä¹‹ç±»çš„$&#123;#calendars.month(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayMonth(...), listMonth(...)ä¹‹ç±»çš„$&#123;#calendars.monthName(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayMonthName(...), listMonthName(...)ä¹‹ç±»çš„$&#123;#calendars.monthNameShort(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayMonthNameShort(...), listMonthNameShort(...)ä¹‹ç±»çš„$&#123;#calendars.year(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayYear(...), listYear(...)ä¹‹ç±»çš„$&#123;#calendars.dayOfWeek(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayDayOfWeek(...), listDayOfWeek(...)ä¹‹ç±»çš„$&#123;#calendars.dayOfWeekName(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayDayOfWeekName(...), listDayOfWeekName(...)ä¹‹ç±»çš„$&#123;#calendars.dayOfWeekNameShort(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayDayOfWeekNameShort(...), listDayOfWeekNameShort(...)ä¹‹ç±»çš„$&#123;#calendars.hour(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayHour(...), listHour(...)ä¹‹ç±»çš„$&#123;#calendars.minute(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayMinute(...), listMinute(...)ä¹‹ç±»çš„$&#123;#calendars.second(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arraySecond(...), listSecond(...)ä¹‹ç±»çš„$&#123;#calendars.millisecond(date)&#125; // ä¹Ÿå¯ä»¥æ˜¯ arrayMillisecond(...), listMillisecond(...)ä¹‹ç±»çš„/* * ä»Žå…¶ç»„ä»¶åˆ›å»ºæ—¥åŽ†(java.util.Calendar)å¯¹è±¡ */$&#123;#calendars.create(year,month,day)&#125;$&#123;#calendars.create(year,month,day,hour,minute)&#125;$&#123;#calendars.create(year,month,day,hour,minute,second)&#125;$&#123;#calendars.create(year,month,day,hour,minute,second,millisecond)&#125;$&#123;#calendars.createForTimeZone(year,month,day,timeZone)&#125;$&#123;#calendars.createForTimeZone(year,month,day,hour,minute,timeZone)&#125;$&#123;#calendars.createForTimeZone(year,month,day,hour,minute,second,timeZone)&#125;$&#123;#calendars.createForTimeZone(year,month,day,hour,minute,second,millisecond,timeZone)&#125;/* * ä¸ºå½“å‰æ—¥æœŸå’Œæ—¶é—´åˆ›å»ºä¸€ä¸ªæ—¥åŽ†(java.util.Calendar)å¯¹è±¡ */$&#123;#calendars.createNow()&#125;$&#123;#calendars.createNowForTimeZone()&#125;/* * ä¸ºå½“å‰æ—¥æœŸåˆ›å»ºæ—¥åŽ†(java.util.Calendar)å¯¹è±¡(æ—¶é—´è®¾ç½®ä¸º00:00) */$&#123;#calendars.createToday()&#125;$&#123;#calendars.createTodayForTimeZone()&#125;Numberså·¥å…·ç±»1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071/* * ========================== * æ ¼å¼åŒ–æ•´æ•° * ========================== *//* * è®¾ç½®æœ€å°æ•´æ•°ä½æ•°ã€‚ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#numbers.formatInteger(num,3)&#125;$&#123;#numbers.arrayFormatInteger(numArray,3)&#125;$&#123;#numbers.listFormatInteger(numList,3)&#125;$&#123;#numbers.setFormatInteger(numSet,3)&#125;/* * è®¾ç½®æœ€å°æ•´æ•°ä½æ•°å’Œåƒä½åˆ†éš”ç¬¦ï¼š * 'POINT'ã€'COMMA'ã€'WHITESPACE'ã€'NONE' æˆ– 'DEFAULT'(æ ¹æ®æœ¬åœ°åŒ–)ã€‚ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#numbers.formatInteger(num,3,'POINT')&#125;$&#123;#numbers.arrayFormatInteger(numArray,3,'POINT')&#125;$&#123;#numbers.listFormatInteger(numList,3,'POINT')&#125;$&#123;#numbers.setFormatInteger(numSet,3,'POINT')&#125;/* * ========================== * æ ¼å¼åŒ–åè¿›åˆ¶æ•° * ========================== *//* * è®¾ç½®æœ€å°æ•´æ•°æ•°å­—å’Œ(ç²¾ç¡®çš„)åè¿›åˆ¶æ•°å­—ã€‚ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#numbers.formatDecimal(num,3,2)&#125;$&#123;#numbers.arrayFormatDecimal(numArray,3,2)&#125;$&#123;#numbers.listFormatDecimal(numList,3,2)&#125;$&#123;#numbers.setFormatDecimal(numSet,3,2)&#125;/* * è®¾ç½®æœ€å°æ•´æ•°æ•°å­—å’Œ(ç²¾ç¡®çš„)å°æ•°ä½æ•°, ä»¥åŠå°æ•°åˆ†éš”ç¬¦ã€‚ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#numbers.formatDecimal(num,3,2,'COMMA')&#125;$&#123;#numbers.arrayFormatDecimal(numArray,3,2,'COMMA')&#125;$&#123;#numbers.listFormatDecimal(numList,3,2,'COMMA')&#125;$&#123;#numbers.setFormatDecimal(numSet,3,2,'COMMA')&#125;/* * è®¾ç½®æœ€å°æ•´æ•°æ•°å­—å’Œ(ç²¾ç¡®çš„)åè¿›åˆ¶æ•°å­—, ä»¥åŠåƒä½å’Œåè¿›åˆ¶åˆ†éš”ç¬¦ã€‚ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#numbers.formatDecimal(num,3,'POINT',2,'COMMA')&#125;$&#123;#numbers.arrayFormatDecimal(numArray,3,'POINT',2,'COMMA')&#125;$&#123;#numbers.listFormatDecimal(numList,3,'POINT',2,'COMMA')&#125;$&#123;#numbers.setFormatDecimal(numSet,3,'POINT',2,'COMMA')&#125;/* * ========================== * å®žç”¨æ–¹æ³• * ========================== *//* * åˆ›å»ºä¸€ä¸ªä»Žxåˆ°yçš„æ•´æ•°åºåˆ—(æ•°ç»„) */$&#123;#numbers.sequence(from,to)&#125;$&#123;#numbers.sequence(from,to,step)&#125;æ¯”å¦‚ï¼š1234&lt;p th:utext="$&#123;#numbers.formatInteger(0.1024,3)&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(1.024,3)&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(10.24,3)&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(102.4,3)&#125;"&gt;&lt;/p&gt;é¡µé¢è¾“å‡ºï¼š1234567891011&lt;p th:utext="$&#123;#numbers.formatInteger(1.024,2,'POINT')&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(1024,3,'POINT')&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(1024,10,'POINT')&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(1.024,2,'COMMA')&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(1024,3,'COMMA')&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(1024,10,'COMMA')&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(1.024,2,'WHITESPACE')&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(1024,3,'WHITESPACE')&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;#numbers.formatInteger(1024,10,'WHITESPACE')&#125;"&gt;&lt;/p&gt;é¡µé¢è¾“å‡ºï¼šPOINTæŒ‡çš„æ˜¯.ï¼ŒCOMMAæŒ‡çš„æ˜¯,ï¼ŒWHITESPACEæŒ‡çš„æ˜¯ç©ºæ ¼ã€‚ä¸‰ä¸ªæ•°ä½ä¸ºä¸€ç»„ï¼Œä½¿ç”¨æŒ‡å®šçš„åˆ†éš”ç¬¦åˆ†å‰²ã€‚æ¯”å¦‚1.024å¹¶ä¸æ˜¯å°æ•°ï¼Œè€Œæ˜¯ä½¿ç”¨äº†.åˆ†éš”çš„1024ã€‚Booleanså·¥å…·ç±»123456789101112131415161718192021222324252627282930313233/* * è¯„ä¼°æ¡ä»¶, ç±»ä¼¼äºŽ th:if æ ‡ç­¾ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#bools.isTrue(obj)&#125;$&#123;#bools.arrayIsTrue(objArray)&#125;$&#123;#bools.listIsTrue(objList)&#125;$&#123;#bools.setIsTrue(objSet)&#125;/* * ç”¨å¦å®šæ¥è¯„ä¼°æ¡ä»¶ * ä¹ŸåŒæ ·é€‚ç”¨äºŽæ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆ */$&#123;#bools.isFalse(cond)&#125;$&#123;#bools.arrayIsFalse(condArray)&#125;$&#123;#bools.listIsFalse(condList)&#125;$&#123;#bools.setIsFalse(condSet)&#125;/* * è¯„ä¼°æ¡ä»¶å¹¶æ‰§è¡Œä¸Žæ“ä½œ * æŽ¥æ”¶æ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆä½œä¸ºå‚æ•° */$&#123;#bools.arrayAnd(condArray)&#125;$&#123;#bools.listAnd(condList)&#125;$&#123;#bools.setAnd(condSet)&#125;/* * è¯„ä¼°æ¡ä»¶å¹¶æ‰§è¡Œæˆ–æ“ä½œ * æŽ¥æ”¶æ•°ç»„ã€åˆ—è¡¨æˆ–é›†åˆä½œä¸ºå‚æ•° */$&#123;#bools.arrayOr(condArray)&#125;$&#123;#bools.listOr(condList)&#125;$&#123;#bools.setOr(condSet)&#125;Arrayså·¥å…·ç±»12345678910111213141516171819202122232425262728293031/* * è½¬æ¢ä¸ºæ•°ç»„, è¯•å›¾æŽ¨æ–­æ•°ç»„ç»„ä»¶ç±»ã€‚æ³¨æ„, å¦‚æžœç»“æžœæ•°ç»„ä¸ºç©º, æˆ–è€…ç›®æ ‡å¯¹è±¡çš„å…ƒç´ ä¸æ˜¯å…¨éƒ¨ç›¸åŒçš„ç±», åˆ™ * æ­¤æ–¹æ³•å°†è¿”å›žObject []ã€‚ */$&#123;#arrays.toArray(object)&#125;/* * è½¬æ¢ä¸ºæŒ‡å®šç»„ä»¶ç±»çš„æ•°ç»„ã€‚ */$&#123;#arrays.toStringArray(object)&#125;$&#123;#arrays.toIntegerArray(object)&#125;$&#123;#arrays.toLongArray(object)&#125;$&#123;#arrays.toDoubleArray(object)&#125;$&#123;#arrays.toFloatArray(object)&#125;$&#123;#arrays.toBooleanArray(object)&#125;/** è®¡ç®—æ•°ç»„é•¿åº¦ */$&#123;#arrays.length(array)&#125;/* * æ£€æŸ¥æ•°ç»„æ˜¯å¦ä¸ºç©º */$&#123;#arrays.isEmpty(array)&#125;/* * æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦åŒ…å«å…ƒç´ æˆ–å…ƒç´ é›†åˆ */$&#123;#arrays.contains(array, element)&#125;$&#123;#arrays.containsAll(array, elements)&#125;Listså·¥å…·ç±»1234567891011121314151617181920212223242526/* * è½¬åŒ–ä¸º list */$&#123;#lists.toList(object)&#125;/* * è®¡ç®—å¤§å° */$&#123;#lists.size(list)&#125;/* */$&#123;#lists.isEmpty(list)&#125;/* * æ£€æŸ¥listä¸­æ˜¯å¦åŒ…å«å…ƒç´ æˆ–å…ƒç´ é›†åˆ */$&#123;#lists.contains(list, element)&#125;$&#123;#lists.containsAll(list, elements)&#125;/* * æŽ’åºç»™å®šåˆ—è¡¨çš„å‰¯æœ¬ã€‚åˆ—è¡¨çš„æˆå‘˜å¿…é¡» * å®žçŽ°comparable, æˆ–è€…å¿…é¡»å®šä¹‰comparatorã€‚ */$&#123;#lists.sort(list)&#125;$&#123;#lists.sort(list, comparator)&#125;Setså·¥å…·ç±»1234567891011121314151617181920/* * è½¬åŒ–ä¸º to set */$&#123;#sets.toSet(object)&#125;/* * è®¡ç®—å¤§å° */$&#123;#sets.size(set)&#125;/* * æ£€æŸ¥setæ˜¯å¦ä¸ºempty */$&#123;#sets.isEmpty(set)&#125;/* * æ£€æŸ¥setä¸­æ˜¯å¦åŒ…å«å…ƒç´ æˆ–å…ƒç´ é›†åˆ */$&#123;#sets.contains(set, element)&#125;$&#123;#sets.containsAll(set, elements)&#125;Mapså·¥å…·ç±»1234567891011121314151617/* * è®¡ç®—å¤§å° */$&#123;#maps.size(map)&#125;/* * æ£€æŸ¥mapæ˜¯å¦ä¸ºç©º */$&#123;#maps.isEmpty(map)&#125;/* * æ£€æŸ¥mapä¸­æ˜¯å¦åŒ…å«key/sæˆ–value/s */$&#123;#maps.containsKey(map, key)&#125;$&#123;#maps.containsAllKeys(map, keys)&#125;$&#123;#maps.containsValue(map, value)&#125;$&#123;#maps.containsAllValues(map, value)&#125;æ³¨æ„äº‹é¡¹å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨å·¥å…·ç±»å¯¹æŸä¸ªè¡¨è¾¾å¼è¿›è¡Œå¤„ç†æ—¶å€™ï¼Œä½ å¯èƒ½ä¼šå†™æˆï¼š1$&#123;#strings.isEmpty($&#123;session.user.name&#125;)&#125;ã€‚å®žé™…ä¸Šè¿™ç§å†™æ³•æ˜¯é”™è¯¯çš„ï¼Œå°†æŠ›å‡ºå¼‚å¸¸ã€‚æ­£ç¡®çš„å†™æ³•ä¸ºï¼š1$&#123;#strings.isEmpty(session.user.name)&#125;ã€‚]]></content>
      <tags>
        <tag>Thymeleaf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Thymeleaf æ ‡å‡†è¡¨è¾¾å¼è¯­æ³•]]></title>
    <url>%2FThymeleaf-Standard-Expression-Syntax.html</url>
    <content type="text"><![CDATA[è®°å½•å‡ ä¸ªæ¯”è¾ƒå®¹æ˜“å¿˜è®°çš„Thymeleafæ ‡å‡†è¡¨è¾¾å¼è¯­æ³•ï¼Œä¾‹å­åŸºäºŽSpring MVCã€‚å˜é‡è¡¨è¾¾å¼${ }åœ¨æŽ§åˆ¶å™¨ä¸­å¾€é¡µé¢ä¼ é€’å‡ ä¸ªå˜é‡ï¼š1234567891011121314@Controllerpublic class IndexController &#123; @RequestMapping(value="/index",method=RequestMethod.GET) public String index(HttpSession session, Model model)&#123; User user = new User(); user.setName("KangKang"); user.setAge(25); user.setHabbit(new String[]&#123;"football","basketball","swim"&#125;); session.setAttribute("user", user); model.addAttribute(user); return "index"; &#125;&#125;åœ¨é¡µé¢ä¸­ä½¿ç”¨å˜é‡è¡¨è¾¾å¼${}æ¥èŽ·å–å®ƒä»¬ï¼š1234&lt;p th:utext="$&#123;user.name&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;session.user.getName()&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;session.user.upcaseName()&#125;"&gt;&lt;/p&gt;&lt;p th:utext="$&#123;user.habbit[0]&#125;"&gt;&lt;/p&gt;å¯ä»¥çœ‹åˆ°å˜é‡è¡¨è¾¾å¼ä¸ä½†å¯ä»¥èŽ·å–å˜é‡çš„å±žæ€§å€¼ï¼Œç”šè‡³è¿˜å¯ä»¥è®¿é—®å˜é‡çš„æ–¹æ³•ï¼ˆgetName()å’ŒupcaseName()ï¼‰ã€‚sessionä»£è¡¨HttpSessionå¯¹è±¡ã€‚é€‰æ‹©è¡¨è¾¾å¼*{ }é€‰æ‹©è¡¨è¾¾å¼çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š12345&lt;div th:object="$&#123;session.user&#125;"&gt; &lt;p&gt;name: &lt;span th:text="*&#123;name&#125;"&gt;&lt;/span&gt;&lt;/p&gt; &lt;p&gt;age: &lt;span th:text="*&#123;age&#125;"&gt;&lt;/span&gt;&lt;/p&gt; &lt;p&gt;habbit: &lt;span th:text="*&#123;habbit[0]&#125;"&gt;&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;*{}ä»£æŒ‡th:objectæ‰€æŒ‡å®šçš„å¯¹è±¡ï¼Œå³${session.user}ã€‚URLé“¾æŽ¥è¡¨è¾¾å¼@{ }URLé“¾æŽ¥è¡¨è¾¾å¼ä¼šç»™URLè‡ªåŠ¨æ·»åŠ ä¸Šä¸‹æ–‡çš„åå­—ã€‚æ¯”å¦‚ï¼š1&lt;a th:href="@&#123;/main&#125;"&gt;main&lt;/a&gt;è§£æžåŽçš„hrefå€¼ä¸ºhttp://localhost:8080/thymeleaf/mainã€‚å½“éœ€è¦åœ¨URLä¸­ä¼ é€’å‚æ•°æ—¶ï¼Œæ¯”å¦‚è¿™æ ·http://localhost:8080/thymeleaf/main?name=KangKangï¼Œå¯ä»¥å¦‚ä¸‹æ“ä½œï¼š1&lt;a th:href="@&#123;/main(name=$&#123;session.user.name&#125;)&#125;"&gt;main&lt;/a&gt;ä¼ é€’å¤šä¸ªå‚æ•°ï¼š1&lt;a th:href="@&#123;/main(name=$&#123;session.user.name&#125;,age=$&#123;session.user.age&#125;)&#125;"&gt;main&lt;/a&gt;è·¯å¾„å˜é‡çš„å†™æ³•ï¼š1&lt;a th:href="@&#123;/main/&#123;name&#125;(name=$&#123;session.user.name&#125;)&#125;"&gt;main&lt;/a&gt;åŽç«¯æŽ¥å—è·¯å¾„å˜é‡ï¼š12345@RequestMapping(value="main/&#123;name&#125;")public String main(@PathVariable String name)&#123; System.out.println("pathValue: "+name); return "main";&#125;å­—é¢é‡æ–‡æœ¬å¸¸é‡æ–‡æœ¬å¸¸é‡æŒ‡çš„æ˜¯å•å¼•å·ä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ï¼š1&lt;p th:text="'Welcome KangKang'"&gt;&lt;/p&gt;æ•°å­—å¸¸é‡12&lt;p&gt;The year is &lt;span th:text="2017"&gt;1492&lt;/span&gt;.&lt;/p&gt;&lt;p&gt;In two years, it will be &lt;span th:text="2017 + 2"&gt;1494&lt;/span&gt;.&lt;/p&gt;Booleanç±»åž‹çš„å¸¸é‡Booleanç±»åž‹çš„å¸¸é‡å°±æ˜¯trueå’Œfalseã€‚ä¾‹å¦‚ï¼š1&lt;div th:if="$&#123;user.isAdmin()&#125; == false"&gt; ...Nullå¸¸é‡1&lt;div th:if="$&#123;variable.something&#125; == null"&gt; ...å­—é¢é‡æ›¿æ¢é™¤äº†ä½¿ç”¨&#39;...&#39; + ${}æ¥è¿žæŽ¥å­—é¢é‡å’Œå˜é‡å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨|...|æ¥ä»£æ›¿ï¼Œæ¯”å¦‚ï¼š1&lt;p th:utext="|hello,$&#123;session.user.name&#125;,your age is $&#123;session.user.age&#125;|"&gt;&lt;/p&gt;ç­‰ä»·äºŽï¼š1&lt;p th:utext="'hello,'+$&#123;session.user.name&#125;+',your age is '+$&#123;session.user.age&#125;"&gt;&lt;/p&gt;åœ¨| ... |å­—é¢æ›¿æ¢ä¸­åªå…è®¸æœ‰å˜é‡è¡¨è¾¾å¼${...}æ¡ä»¶è¡¨è¾¾å¼æ¡ä»¶è¡¨è¾¾å¼å®žé™…ä¸Šå°±æ˜¯ä¸‰ç›®è¿ç®—ç¬¦ã€‚æ¯”å¦‚ï¼š123&lt;tr th:class="$&#123;row.even&#125;? 'even' : 'odd'"&gt; ...&lt;/tr&gt;æ¡ä»¶è¡¨è¾¾å¼ä¹Ÿå¯ä»¥ä½¿ç”¨æ‹¬å·åµŒå¥—ï¼š123&lt;tr th:class="$&#123;row.even&#125;? ($&#123;row.first&#125;? 'first' : 'even') : 'odd'"&gt; ...&lt;/tr&gt;elseè¡¨è¾¾å¼ä¹Ÿå¯ä»¥çœç•¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æžœæ¡ä»¶ä¸ºfalseï¼Œåˆ™è¿”å›žç©ºå€¼ï¼š123&lt;tr th:class="$&#123;row.even&#125;? 'even'"&gt; ...&lt;/tr&gt;é»˜è®¤è¡¨è¾¾å¼é»˜è®¤è¡¨è¾¾å¼æ˜¯ä¸€ç§ç‰¹æ®Šç±»åž‹çš„æ¡ä»¶å€¼ï¼Œä¸å¸¦thenéƒ¨åˆ†ã€‚æ¯”å¦‚ï¼š1&lt;p th:utext="$&#123;session.user.sex&#125; ?: 'sex is unknown'"&gt;&lt;/p&gt;è¡¨ç¤ºï¼Œå½“${session.user.sex}ä¸ºnullæ—¶ï¼Œå€¼ä¸ºsex is unknownï¼Œå¦åˆ™ä¸ºè¡¨è¾¾å¼çš„å€¼ã€‚è¿™å°±å¥½åƒä¸ºè¡¨è¾¾å¼æŒ‡å®šäº†ä¸€ä¸ªé»˜è®¤å€¼ä¸€æ ·ã€‚å…¶ç­‰ä»·äºŽï¼š1&lt;p th:utext=&quot;$&#123;session.user.sex != null&#125; ? $&#123;session.user.sex&#125;: &apos;sex is unknown&apos;&quot;&gt;&lt;/p&gt;æ›´è¯¦ç»†çš„å†…å®¹å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttp://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#standard-expression-syntax]]></content>
      <tags>
        <tag>Thymeleaf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡ªå®šä¹‰annotation]]></title>
    <url>%2F%E8%87%AA%E5%AE%9A%E4%B9%89annotation.html</url>
    <content type="text"><![CDATA[meta-annotationJavaä»ŽJDK5.0å¼€å§‹ä¾¿æä¾›äº†å››ä¸ªmeta-annotationç”¨äºŽè‡ªå®šä¹‰æ³¨è§£çš„æ—¶å€™ä½¿ç”¨ï¼Œè¿™å››ä¸ªæ³¨è§£ä¸ºï¼š@Targetï¼Œ@Retentionï¼Œ@Documented å’Œ@Inheritedã€‚@Targetï¼šç”¨äºŽæè¿°æ³¨è§£çš„ä½¿ç”¨èŒƒå›´ï¼ˆå³ï¼šè¢«æè¿°çš„æ³¨è§£å¯ä»¥ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹ï¼‰ï¼Œå…¶æºç å¦‚ä¸‹ï¼š1234567@Documented@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.ANNOTATION_TYPE)public @interface Target &#123; ElementType[] value();&#125;å¯è§@Target æ³¨è§£åªæœ‰å”¯ä¸€æˆå‘˜valueï¼Œç±»åž‹ä¸ºElementTypeæ•°ç»„ã€‚æŸ¥çœ‹ElementTypeçš„æºç å¯ä»¥å‘çŽ°ï¼ŒElementTypeå¯å–çš„å€¼æœ‰ï¼šCONSTRUCTORï¼šç”¨äºŽæè¿°æž„é€ å™¨ï¼›FIELDï¼šç”¨äºŽæè¿°æˆå‘˜å˜é‡ï¼›LOCAL_VARIABLEï¼šç”¨äºŽæè¿°å±€éƒ¨å˜é‡ï¼›METHODï¼šç”¨äºŽæè¿°æ–¹æ³•ï¼›PACKAGEï¼šç”¨äºŽæè¿°åŒ…ï¼›PARAMETERï¼šç”¨äºŽæè¿°å‚æ•°ï¼›TYPEï¼šç”¨äºŽæè¿°ç±»ã€æŽ¥å£(åŒ…æ‹¬æ³¨è§£ç±»åž‹) æˆ–enumå£°æ˜Žã€‚@Retentionï¼šæŒ‡å®šè¢«æè¿°çš„æ³¨è§£åœ¨ä»€ä¹ˆèŒƒå›´å†…æœ‰æ•ˆã€‚æºç å¦‚ä¸‹ï¼š1234567@Documented@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.ANNOTATION_TYPE)public @interface Retention &#123; RetentionPolicy value();&#125;å…¶ä¸­RetentionPolicyå¯å–çš„å€¼æœ‰ï¼šSOURCEï¼šåœ¨æºæ–‡ä»¶ä¸­æœ‰æ•ˆï¼ˆå³æºæ–‡ä»¶ä¿ç•™ï¼‰ï¼›CLASSï¼šåœ¨classæ–‡ä»¶ä¸­æœ‰æ•ˆï¼ˆå³classä¿ç•™ï¼‰ï¼›RUNTIMEï¼šåœ¨è¿è¡Œæ—¶æœ‰æ•ˆï¼ˆå³è¿è¡Œæ—¶ä¿ç•™ï¼‰ã€‚@Documentedï¼šæ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ï¼Œæœ¨æœ‰æˆå‘˜ï¼Œç”¨äºŽæè¿°å…¶å®ƒç±»åž‹çš„annotationåº”è¯¥è¢«ä½œä¸ºè¢«æ ‡æ³¨çš„ç¨‹åºæˆå‘˜çš„å…¬å…±APIï¼Œå› æ­¤å¯ä»¥è¢«ä¾‹å¦‚javadocæ­¤ç±»çš„å·¥å…·æ–‡æ¡£åŒ–ã€‚@Inheritedï¼šå…ƒæ³¨è§£æ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ï¼Œ@Inheritedé˜è¿°äº†æŸä¸ªè¢«æ ‡æ³¨çš„ç±»åž‹æ˜¯è¢«ç»§æ‰¿çš„ã€‚å¦‚æžœä¸€ä¸ªä½¿ç”¨äº†@Inheritedä¿®é¥°çš„annotationç±»åž‹è¢«ç”¨äºŽä¸€ä¸ªclassï¼Œåˆ™è¿™ä¸ªannotationå°†è¢«ç”¨äºŽè¯¥classçš„å­ç±»ã€‚è‡ªå®šä¹‰annotationç”¨@interface è‡ªå®šä¹‰æ³¨è§£æ—¶ï¼Œè‡ªåŠ¨ç»§æ‰¿äº†java.lang.annotation.AnnotationæŽ¥å£ï¼Œç”±ç¼–è¯‘ç¨‹åºè‡ªåŠ¨å®Œæˆå…¶ä»–ç»†èŠ‚ã€‚åœ¨å®šä¹‰æ³¨è§£æ—¶ï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–çš„æ³¨è§£æˆ–æŽ¥å£ã€‚@interface ç”¨æ¥å£°æ˜Žä¸€ä¸ªæ³¨è§£ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªæ–¹æ³•å®žé™…ä¸Šæ˜¯å£°æ˜Žäº†ä¸€ä¸ªæˆå‘˜ã€‚æ–¹æ³•çš„åç§°å°±æ˜¯æˆå‘˜çš„åç§°ï¼Œè¿”å›žå€¼ç±»åž‹å°±æ˜¯æˆå‘˜çš„ç±»åž‹ã€‚å¯ä»¥é€šè¿‡defaultæ¥å£°æ˜Žå‚æ•°çš„é»˜è®¤å€¼ã€‚è‡ªå®šä¹‰æ³¨è§£çš„åŸºæœ¬æ ¼å¼ä¸ºï¼š123public @interface AnnotationName &#123; // ...&#125;Annotationçš„æˆå‘˜å®šä¹‰å¿…é¡»æ»¡è¶³ä»¥ä¸‹ä¸‰ç‚¹ï¼šæˆå‘˜åªèƒ½ç”¨publicæˆ–é»˜è®¤(default)è¿™ä¸¤ä¸ªè®¿é—®æƒä¿®é¥°ï¼›æˆå‘˜çš„ç±»åž‹åªèƒ½æ˜¯åŸºæœ¬ç±»åž‹ï¼ŒStringï¼ŒEnumï¼ŒClassï¼ŒAnnotationä»¥åŠå®ƒä»¬çš„æ•°ç»„ç±»åž‹ï¼›å¦‚æžœåªæœ‰ä¸€ä¸ªæˆå‘˜ï¼Œæœ€å¥½å°†å…¶åç§°è®¾ä¸ºvalueã€‚AnnotatedElementä»£è¡¨è¢«æ³¨è§£çš„å…ƒç´ ï¼Œå…¶åŒ…å«è®¸å¤šæ–¹æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šâ€¦å…¶ä¸­ä¸»è¦çš„å‡ ä¸ªæ–¹æ³•æœ‰ï¼š1234&lt;T extends Annotation&gt; T getAnnotation(Class&lt;T&gt; annotationType) // æ ¹æ®annotationTypeèŽ·å–æ³¨è§£å¯¹è±¡Annotation[] getAnnotations() // èŽ·å–æ‰€æœ‰æ³¨è§£boolean isAnnotationPresent(Class&lt;T&gt; annotationType) // åˆ¤æ–­å½“å‰å…ƒç´ æ˜¯å¦è¢«annotationTypeæ³¨è§£Annotation[] getDeclareAnnotations() // ä¸ŽgetAnnotations() ç±»ä¼¼ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬çˆ¶ç±»ä¸­è¢«Inheritedä¿®é¥°çš„æ³¨è§£å®žæˆ˜å‡å¦‚çŽ°åœ¨æœ‰ä¸€ä¸ªæ•°æ®åº“è¡¨å¯¹åº”çš„POJOè¢«ä¸€äº›è‡ªå®šä¹‰æ³¨è§£æ‰€æ ‡è®°ï¼ŒçŽ°åœ¨è¦æ ¹æ®è¿™ä¸ªPOJOè‡ªåŠ¨ç”Ÿæˆåˆ›å»ºåº“è¡¨çš„SQLè¯­å¥ã€‚å…¶ä¸­POJOä»£ç å¦‚ä¸‹ï¼š1234567891011@Table(name = "Student")class Bean &#123; @Column(name = "age", length = 3) int age; @Column(name = "userName", length = 10) String name; @Column(name = "birthday", defaultValue = "sysdate") Date birthday;&#125;éœ€è¦ç”Ÿæˆç±»ä¼¼å¦‚ä¸‹çš„SQLè¯­å¥ï¼š1create table Student(age NUMBER(3),userName VARCHAR2(10),birthday DATE default sysdate)Beanç±»è¢«@Table æ³¨è§£æ‰€æ ‡è®°ï¼Œæ‰€ä»¥éœ€è¦å®šä¹‰ä¸€ä¸ªElementType.TYPEçº§åˆ«çš„æ³¨è§£ï¼š12345@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.TYPE)@interface Table &#123; String name(); // nameç”¨æ¥è®¾ç½®è¡¨å&#125;è€Œ@Column æ³¨è§£æ ‡æ³¨äºŽBeançš„æˆå‘˜å˜é‡ï¼Œå¹¶ä¸”åŒ…å«ä¸‰ä¸ªæˆå‘˜ï¼š1234567@Retention(RetentionPolicy.RUNTIME)@Target(ElementType.FIELD)@interface Column &#123; String name() default ""; // nameç”¨æ¥è®¾ç½®å­—æ®µå int length() default 0; // lengthç”¨æ¥è®¾ç½®å­—æ®µé•¿åº¦ String defaultValue() default ""; // defaultValueç”¨æ¥è®¾ç½®é»˜è®¤å€¼&#125;æŽ¥ä¸‹æ¥å®šä¹‰ä¸¤ä¸ªæ–¹æ³•getTableName(Class&lt;?&gt; bean)å’ŒgetColumns(Class&lt;?&gt; bean)ï¼Œåˆ†åˆ«ç”¨äºŽèŽ·å–@Table æ³¨è§£ä¸­çš„è¡¨åå’Œè¢«@Column æ³¨è§£æ ‡è®°çš„æˆå‘˜å˜é‡ä¿¡æ¯ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879private static String getTableName(Class&lt;?&gt; bean) &#123; String name = null; // åˆ¤æ–­beanæ˜¯å¦è¢«@Tableæ³¨è§£ if (bean.isAnnotationPresent(Table.class)) &#123; // èŽ·å–æ³¨è§£å¯¹è±¡ Annotation tableAnnotation = bean.getAnnotation(Table.class); try &#123; // èŽ·å–@Tableæ³¨è§£æ‰€å¯¹åº”çš„name Method method = Table.class.getMethod("name"); name = (String) method.invoke(tableAnnotation); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; return name;&#125;private static List&lt;ColumnBean&gt; getColumns(Class&lt;?&gt; bean) &#123; List&lt;ColumnBean&gt; columns = new ArrayList&lt;ColumnBean&gt;(); Field[] fields = bean.getDeclaredFields(); if (fields != null) &#123; // è¡¨é‡Œæ‰€æœ‰æˆå‘˜å˜é‡ï¼ˆfieldsï¼‰,èŽ·å–å…¶æ³¨è§£ä¿¡æ¯ for (int i = 0; i &lt; fields.length; i++) &#123; Field field = fields[i]; // åˆ¤æ–­æ˜¯å¦è¢«@Columnæ³¨è§£æ ‡è®° if (field.isAnnotationPresent(Column.class)) &#123; String name = null; int length = 0; String defaultValue = null; String type = null; // åˆ†åˆ«èŽ·å–@Columnæ³¨è§£é‡Œæˆå‘˜çš„å€¼ Annotation columnAnnotation = field.getAnnotation(Column.class); try &#123; Method nameMethod = Column.class.getMethod("name"); name = (String) nameMethod.invoke(columnAnnotation); Method rangeMethod = Column.class.getMethod("length"); length = (Integer) rangeMethod.invoke(columnAnnotation); Method defaultValueMethod = Column.class.getMethod("defaultValue"); defaultValue = (String) defaultValueMethod.invoke(columnAnnotation); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; // åˆ¤æ–­ç±»åž‹ï¼ŒJavaç±»åž‹è½¬æ¢ä¸ºæ•°æ®åº“ç±»åž‹ if (int.class.isAssignableFrom(field.getType()) || Integer.class.isAssignableFrom(field.getType())) &#123; type = "NUMBER"; &#125; else if (String.class.isAssignableFrom(field.getType())) &#123; type = "VARCHAR2"; &#125; else if (Date.class.isAssignableFrom(field.getType()))&#123; type = "DATE"; &#125;else &#123; throw new RuntimeException("unspported type=" + field.getType().getSimpleName()); &#125; columns.add(new ColumnBean(type, name, length, defaultValue)); &#125; &#125; &#125; return columns;&#125;// ç”¨äºŽæè¿°Columnprivate static class ColumnBean &#123; final String type; final String name; final int length; final String defaultValue; public ColumnBean(String type, String name, int length, String defaultValue) &#123; this.type = type; this.name = name; this.length = length; this.defaultValue = defaultValue; &#125;&#125;æœ€åŽç¼–å†™ç”ŸæˆSQLçš„æ–¹æ³•ï¼š123456789101112131415161718192021222324252627282930313233343536public static String createTable(Class&lt;?&gt; bean) &#123; String tableName = getTableName(bean); List&lt;ColumnBean&gt; columns = getColumns(bean); if (tableName != null &amp;&amp; !tableName.equals("") &amp;&amp; !columns.isEmpty()) &#123; StringBuilder createTableSql = new StringBuilder("create table "); // æ‹¼æŽ¥è¡¨å createTableSql.append(tableName); createTableSql.append("("); //æ‹¼æŽ¥å­—æ®µä¿¡æ¯ for (int i = 0; i &lt; columns.size(); i++) &#123; ColumnBean column = columns.get(i); createTableSql.append(column.name); createTableSql.append(" "); createTableSql.append(column.type); int length = column.length; if(length != 0)&#123; createTableSql.append("("); createTableSql.append(column.length); createTableSql.append(")"); &#125; String defaultValue = column.defaultValue; if(defaultValue != null &amp;&amp; defaultValue.length() != 0)&#123; createTableSql.append(" default "); createTableSql.append(defaultValue); &#125; if (i != columns.size() - 1) &#123; createTableSql.append(","); &#125; &#125; createTableSql.append(")"); return createTableSql.toString(); &#125;else &#123; throw new RuntimeException("table's name is null"); &#125;&#125;æµ‹è¯•12345public class Test &#123; public static void main(String[] args) &#123; System.out.println(TestUtils.createTable(Bean.class)); &#125;&#125;ç”Ÿæˆçš„ç»“æžœå’Œé¢„æœŸä¸€è‡´æ€»ç»“ä¸Šè¿°çš„è¿‡ç¨‹å¯å½’çº³ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼šåˆ¤æ–­AnnotatedElementæ˜¯å¦è¢«æŸæ³¨è§£æ‰€æ ‡è®°ï¼šAnnotatedElement.isAnnotationPresent(SomeAnnotation.class)ï¼›æ˜¯çš„è¯ï¼ŒèŽ·å–è¯¥æ³¨è§£å¯¹è±¡ï¼šAnnotation annotation = bean.getAnnotation(SomeAnnotation.class);ï¼›æ ¹æ®è¯¥æ³¨è§£å¯¹è±¡èŽ·å–æŸä¸ªæˆå‘˜å‚æ•°ï¼ˆæ¯”å¦‚nameï¼‰ï¼šMethod method = SomeAnnotation.class.getMethod(&quot;name&quot;);ï¼›åˆ©ç”¨åå°„æœºåˆ¶ï¼ŒèŽ·å–è¯¥æ³¨è§£ä¸­çš„æŸæˆå‘˜çš„å€¼ï¼šString name = (String) method.invoke(annotation);ã€‚Source Code]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSVè¯»å†™]]></title>
    <url>%2FCSV%E8%AF%BB%E5%86%99.html</url>
    <content type="text"><![CDATA[CSVæ˜¯ä»¥é€—å·é—´éš”çš„æ–‡æœ¬æ–‡ä»¶ã€‚å½“å¯¼å‡ºçš„æ•°æ®ä¸æ¶‰åŠå…¬å¼å’Œå¤æ‚çš„è¡¨æ ¼æ ·å¼çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨javacsvæ¥ä»£æ›¿POIï¼Œä»¥ä¾¿èŠ‚çœæ€§èƒ½ã€‚å¼•å…¥javacsvä¾èµ–ï¼š123456&lt;!-- https://mvnrepository.com/artifact/net.sourceforge.javacsv/javacsv --&gt;&lt;dependency&gt; &lt;groupId&gt;net.sourceforge.javacsv&lt;/groupId&gt; &lt;artifactId&gt;javacsv&lt;/artifactId&gt; &lt;version&gt;2.0&lt;/version&gt;&lt;/dependency&gt;CsvWriter12345678910111213141516171819202122232425import java.nio.charset.Charset;import com.csvreader.CsvWriter;public class CsvWrite &#123; public static void csvWrite()&#123; String csvFilePath = "D://test.csv"; try &#123; CsvWriter csvWriter = new CsvWriter(csvFilePath, ',', Charset.forName("UTF-8")); // è¡¨å¤´ String[] csvHeaders = &#123; "ç¼–å·", "å§“å", "å¹´é¾„" &#125;; csvWriter.writeRecord(csvHeaders); // å†…å®¹ for (int i = 0; i &lt; 5; i++) &#123; String[] csvContent = &#123; i + "", "userName", "1" + i &#125;; csvWriter.writeRecord(csvContent); &#125; csvWriter.close(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static void main(String[] args) &#123; CsvWrite.csvWrite(); &#125;&#125;ç”Ÿæˆæ–‡ä»¶å¦‚ä¸‹ï¼šCsvReader12345678910111213141516171819202122232425262728293031323334353637import java.io.IOException;import java.nio.charset.Charset;import java.util.ArrayList;import com.csvreader.CsvReader;public class CsvRead &#123; public static void readCSV() &#123; ArrayList&lt;String[]&gt; csvFileList = new ArrayList&lt;String[]&gt;(); String csvFilePath = "D://test.csv"; try &#123; CsvReader reader = new CsvReader(csvFilePath, ',', Charset.forName("UTF-8")); // è·³è¿‡è¡¨å¤´ reader.readHeaders(); // é€è¡Œè¯»å…¥é™¤è¡¨å¤´çš„æ•°æ® while (reader.readRecord()) &#123; System.out.println(reader.getRawRecord()); csvFileList.add(reader.getValues()); &#125; reader.close(); // éåŽ†è¯»å–CSVæ¯è¡Œæ¯åˆ— for (int row = 0; row &lt; csvFileList.size(); row++) &#123; String[] cells = csvFileList.get(row); for(String str : cells)&#123; System.out.print(str+" "); &#125; System.out.println(); &#125; &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125; public static void main(String[] args) &#123; CsvRead.readCSV(); &#125;&#125;è¾“å‡ºï¼š123456789100,userName,101,userName,112,userName,123,userName,134,userName,140 userName 10 1 userName 11 2 userName 12 3 userName 13 4 userName 14javacsv APIï¼šhttp://javacsv.sourceforge.net/]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot AOPè®°å½•ç”¨æˆ·æ“ä½œæ—¥å¿—]]></title>
    <url>%2FSpring-Boot-AOP%20log.html</url>
    <content type="text"><![CDATA[åœ¨Springæ¡†æž¶ä¸­ï¼Œä½¿ç”¨AOPé…åˆè‡ªå®šä¹‰æ³¨è§£å¯ä»¥æ–¹ä¾¿çš„å®žçŽ°ç”¨æˆ·æ“ä½œçš„ç›‘æŽ§ã€‚é¦–å…ˆæ­å»ºä¸€ä¸ªåŸºæœ¬çš„Spring Boot WebçŽ¯å¢ƒå¼€å¯Spring Bootï¼Œç„¶åŽå¼•å…¥å¿…è¦ä¾èµ–ï¼š123456789101112131415161718192021222324&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!-- aopä¾èµ– --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!-- oracleé©±åŠ¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.oracle&lt;/groupId&gt; &lt;artifactId&gt;ojdbc6&lt;/artifactId&gt; &lt;version&gt;6.0&lt;/version&gt;&lt;/dependency&gt;&lt;!-- druidæ•°æ®æºé©±åŠ¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.6&lt;/version&gt;&lt;/dependency&gt;è‡ªå®šä¹‰æ³¨è§£å®šä¹‰ä¸€ä¸ªæ–¹æ³•çº§åˆ«çš„@Logæ³¨è§£ï¼Œç”¨äºŽæ ‡æ³¨éœ€è¦ç›‘æŽ§çš„æ–¹æ³•ï¼š12345@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)public @interface Log &#123; String value() default "";&#125;åˆ›å»ºåº“è¡¨å’Œå®žä½“åœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€å¼ sys_logè¡¨ï¼Œç”¨äºŽä¿å­˜ç”¨æˆ·çš„æ“ä½œæ—¥å¿—ï¼Œæ•°æ®åº“é‡‡ç”¨oracle 11gï¼š1234567891011121314151617181920CREATE TABLE "SCOTT"."SYS_LOG" ( "ID" NUMBER(20) NOT NULL , "USERNAME" VARCHAR2(50 BYTE) NULL , "OPERATION" VARCHAR2(50 BYTE) NULL , "TIME" NUMBER(11) NULL , "METHOD" VARCHAR2(200 BYTE) NULL , "PARAMS" VARCHAR2(500 BYTE) NULL , "IP" VARCHAR2(64 BYTE) NULL , "CREATE_TIME" DATE NULL );COMMENT ON COLUMN "SCOTT"."SYS_LOG"."USERNAME" IS 'ç”¨æˆ·å';COMMENT ON COLUMN "SCOTT"."SYS_LOG"."OPERATION" IS 'ç”¨æˆ·æ“ä½œ';COMMENT ON COLUMN "SCOTT"."SYS_LOG"."TIME" IS 'å“åº”æ—¶é—´';COMMENT ON COLUMN "SCOTT"."SYS_LOG"."METHOD" IS 'è¯·æ±‚æ–¹æ³•';COMMENT ON COLUMN "SCOTT"."SYS_LOG"."PARAMS" IS 'è¯·æ±‚å‚æ•°';COMMENT ON COLUMN "SCOTT"."SYS_LOG"."IP" IS 'IPåœ°å€';COMMENT ON COLUMN "SCOTT"."SYS_LOG"."CREATE_TIME" IS 'åˆ›å»ºæ—¶é—´';CREATE SEQUENCE seq_sys_log START WITH 1 INCREMENT BY 1;åº“è¡¨å¯¹åº”çš„å®žä½“ï¼š1234567891011121314public class SysLog implements Serializable&#123; private static final long serialVersionUID = -6309732882044872298L; private Integer id; private String username; private String operation; private Integer time; private String method; private String params; private String ip; private Date createTime; // get,setç•¥&#125;ä¿å­˜æ—¥å¿—çš„æ–¹æ³•ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡Œç›´æŽ¥ä½¿ç”¨Spring JdbcTemplateæ¥æ“ä½œæ•°æ®åº“ã€‚å®šä¹‰ä¸€ä¸ªSysLogDaoæŽ¥å£ï¼ŒåŒ…å«ä¸€ä¸ªä¿å­˜æ“ä½œæ—¥å¿—çš„æŠ½è±¡æ–¹æ³•ï¼š123public interface SysLogDao &#123; void saveSysLog(SysLog syslog);&#125;å…¶å®žçŽ°æ–¹æ³•ï¼š1234567891011121314151617@Repositorypublic class SysLogDaoImp implements SysLogDao &#123; @Autowired private JdbcTemplate jdbcTemplate; @Override public void saveSysLog(SysLog syslog) &#123; StringBuffer sql = new StringBuffer("insert into sys_log "); sql.append("(id,username,operation,time,method,params,ip,create_time) "); sql.append("values(seq_sys_log.nextval,:username,:operation,:time,:method,"); sql.append(":params,:ip,:createTime)"); NamedParameterJdbcTemplate npjt = new NamedParameterJdbcTemplate(this.jdbcTemplate.getDataSource()); npjt.update(sql.toString(), new BeanPropertySqlParameterSource(syslog)); &#125;&#125;åˆ‡é¢å’Œåˆ‡ç‚¹å®šä¹‰ä¸€ä¸ªLogAspectç±»ï¼Œä½¿ç”¨@Aspectæ ‡æ³¨è®©å…¶æˆä¸ºä¸€ä¸ªåˆ‡é¢ï¼Œåˆ‡ç‚¹ä¸ºä½¿ç”¨@Logæ³¨è§£æ ‡æ³¨çš„æ–¹æ³•ï¼Œä½¿ç”¨@AroundçŽ¯ç»•é€šçŸ¥ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364@Aspect@Componentpublic class LogAspect &#123; @Autowired private SysLogDao sysLogDao; @Pointcut("@annotation(com.springboot.annotation.Log)") public void pointcut() &#123; &#125; @Around("pointcut()") public Object around(ProceedingJoinPoint point) &#123; Object result = null; long beginTime = System.currentTimeMillis(); try &#123; // æ‰§è¡Œæ–¹æ³• result = point.proceed(); &#125; catch (Throwable e) &#123; e.printStackTrace(); &#125; // æ‰§è¡Œæ—¶é•¿(æ¯«ç§’) long time = System.currentTimeMillis() - beginTime; // ä¿å­˜æ—¥å¿— saveLog(point, time); return result; &#125; private void saveLog(ProceedingJoinPoint joinPoint, long time) &#123; MethodSignature signature = (MethodSignature) joinPoint.getSignature(); Method method = signature.getMethod(); SysLog sysLog = new SysLog(); Log logAnnotation = method.getAnnotation(Log.class); if (logAnnotation != null) &#123; // æ³¨è§£ä¸Šçš„æè¿° sysLog.setOperation(logAnnotation.value()); &#125; // è¯·æ±‚çš„æ–¹æ³•å String className = joinPoint.getTarget().getClass().getName(); String methodName = signature.getName(); sysLog.setMethod(className + "." + methodName + "()"); // è¯·æ±‚çš„æ–¹æ³•å‚æ•°å€¼ Object[] args = joinPoint.getArgs(); // è¯·æ±‚çš„æ–¹æ³•å‚æ•°åç§° LocalVariableTableParameterNameDiscoverer u = new LocalVariableTableParameterNameDiscoverer(); String[] paramNames = u.getParameterNames(method); if (args != null &amp;&amp; paramNames != null) &#123; String params = ""; for (int i = 0; i &lt; args.length; i++) &#123; params += " " + paramNames[i] + ": " + args[i]; &#125; sysLog.setParams(params); &#125; // èŽ·å–request HttpServletRequest request = HttpContextUtils.getHttpServletRequest(); // è®¾ç½®IPåœ°å€ sysLog.setIp(IPUtils.getIpAddr(request)); // æ¨¡æ‹Ÿä¸€ä¸ªç”¨æˆ·å sysLog.setUsername("mrbird"); sysLog.setTime((int) time); sysLog.setCreateTime(new Date()); // ä¿å­˜ç³»ç»Ÿæ—¥å¿— sysLogDao.saveSysLog(sysLog); &#125;&#125;æµ‹è¯•TestControllerï¼š1234567891011121314151617@RestControllerpublic class TestController &#123; @Log("æ‰§è¡Œæ–¹æ³•ä¸€") @GetMapping("/one") public void methodOne(String name) &#123; &#125; @Log("æ‰§è¡Œæ–¹æ³•äºŒ") @GetMapping("/two") public void methodTwo() throws InterruptedException &#123; Thread.sleep(2000); &#125; @Log("æ‰§è¡Œæ–¹æ³•ä¸‰") @GetMapping("/three") public void methodThree(String name, String age) &#123; &#125;&#125;æœ€ç»ˆé¡¹ç›®ç›®å½•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¯åŠ¨é¡¹ç›®ï¼Œåˆ†åˆ«è®¿é—®ï¼šhttp://localhost:8080/web/one?name=KangKanghttp://localhost:8080/web/twohttp://localhost:8080/web/three?name=Mike&amp;age=25æŸ¥è¯¢æ•°æ®åº“ï¼š123456789101112SQL&gt; select * from sys_log order by id; ID USERNAME OPERATION TIME METHOD PARAMS IP CREATE_TIME---------- ---------- ---------- ---------- ------------------------------ ------------------------------ ---------- -------------- 11 mrbird æ‰§è¡Œæ–¹æ³•ä¸€ 6 com.springboot.controller.Test name: KangKang 127.0.0.1 08-12æœˆ-17 Controller.methodOne() 12 mrbird æ‰§è¡Œæ–¹æ³•äºŒ 2000 com.springboot.controller.Test 127.0.0.1 08-12æœˆ-17 Controller.methodTwo() 13 mrbird æ‰§è¡Œæ–¹æ³•ä¸‰ 0 com.springboot.controller.Test name: Mike age: 25 127.0.0.1 08-12æœˆ-17 Controller.methodThree()source code]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¾Žå›¢å¤–å–å¼€å‘æ€»ç»“]]></title>
    <url>%2Fmeituan%20waimai.html</url>
    <content type="text"><![CDATA[å‡†å¤‡å·¥ä½œé¦–å…ˆéœ€è¦ç”³è¯·å¼€å‘è€…è´¦å·ï¼Œåœ°å€ï¼šhttp://developer.meituan.com/homeã€‚é€šè¿‡ä¹‹åŽå¯ä»¥å¾—åˆ°developerId:10**16å’ŒSignKey:s9bvk***mjm9xmsä»¥åŠæµ‹è¯•é—¨åº—ä¿¡æ¯ã€‚å¼€å‘è€…å¯ä½¿ç”¨ç¾Žå›¢å¤–å–appç«¯ï¼Œä¿®æ”¹å®šä½åˆ°ï¼š å¢¨è„±åŽ¿â€“æœç´¢è‰²é‡‘æ‹‰â€“æœç´¢æµ‹è¯•é—¨åº—åç§°æµ‹è¯•ä¸‹å•ã€‚é—¨åº—ç®¡ç†å¯ä»¥ä½¿ç”¨ç¾Žå›¢å¤–å–å•†å®¶ç‰ˆAPPè¿›è¡Œç®¡ç†ã€‚å¯¹æŽ¥å¯ä»¥ä½¿ç”¨ç¾Žå›¢å¼€å‘å¹³å°SDKæˆ–è€…UISDKã€‚å¼€å‘å¹³å°SDKä¸‹è½½åœ°å€ï¼šhttps://drive.google.com/open?id=14RkrayTt_MKb2d38FhN8aHop-shEv9nJç»‘å®šä¸Žè§£ç»‘ç¾Žå›¢å¤–å–å•†å®¶ç»‘å®šåœ°å€ä¸ºï¼šhttps://open-erp.meituan.com/login?developerId=101416&amp;businessId=2&amp;ePoiId=123324214214&amp;signKey=s9bvktibcmjm9xmsã€‚é™¤äº†developerIdå’ŒSignKeyä¹‹å¤–ï¼Œè¿˜éœ€ä¼ å…¥businessIdï¼ˆ2è¡¨ç¤ºå¤–å–ä¸šåŠ¡ï¼‰å’ŒePoiIdï¼ˆè¯¥å•†æˆ·åœ¨ERPåŽ‚å•†ä¸Šçš„å”¯ä¸€æ ‡è¯†ç ï¼‰ã€‚ç»‘å®šæˆåŠŸåŽï¼Œç¾Žå›¢ä¼šè¿”å›žä¸€ä¸ªappAuthTokenï¼ˆç»‘å®šé—¨åº—æˆåŠŸåŽå¼€æ”¾å¹³å°ç”Ÿäº§çš„tokenï¼‰ã€‚åœ¨å›žè°ƒæ–¹æ³•ä¸­ï¼ˆä¸‹é¢ä¼šè¯´åˆ°ï¼‰å°†è¯¥tokenä¿å­˜åˆ°æ•°æ®åº“ï¼Œç”¨äºŽåŽç»­è°ƒç”¨æŽ¥å£ã€‚ç¾Žå›¢å¤–å–å•†å®¶è§£ç»‘åœ°å€ä¸ºï¼šhttps://open-erp.meituan.com/releasebinding?signKey=s9bvktibcmjm9xms&amp;businessId=2&amp;appAuthToken=35be4d3e63270abd28b9a320611bbdb616b1bd6ac7e11fce132e11196a4e6c89558b10f5d651d355a135bf7c49da75c2å…¶ä¸­appAuthTokenä¸ºé—¨åº—ç»‘å®šçš„æ—¶å€™ç”Ÿæˆçš„tokenã€‚å›žè°ƒç¾Žå›¢å¼€å‘å¹³å°ä¸ºå¤–å–å„ä¸ªæµç¨‹çŠ¶æ€æä¾›äº†å›žè°ƒURLï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å›žè°ƒURLå¯¹åº”ä¸ºé¡¹ç›®ä¸­æ–¹æ³•çš„è¯·æ±‚åœ°å€ï¼Œæ¯”å¦‚è®¢å•æŽ¨é€URLå¯¹åº”é¡¹ç›®ä¸­çš„ï¼š1234567891011121314151617/** * ç¾Žå›¢å¤–å–è®¢å•æŽ¨é€å›žè°ƒ * @param order * @return */@ResponseBody@RequestMapping(value="/plugpay/mtOrderPush.php",produces=&#123;"application/json;charset=UTF-8"&#125;)public Map&lt;String,String&gt; mtOrderPush(String order)&#123; synchronized (this) &#123; Map&lt;String, String&gt; result = new HashMap&lt;String, String&gt;(); System.out.println(order); System.out.println("æ‚¨æœ‰æ–°çš„ç¾Žå›¢å¤–å–è®¢å•ï¼Œè¯·åŠæ—¶å¤„ç†"); // ä¿å­˜è®¢å•åˆ°æ•°æ®åº“... result.put("data", "OK"); return result; &#125; &#125;è®¢å•æŽ¨é€å›žè°ƒæ–¹æ³•éœ€è¦è¿”å›ž{&quot;data&quot;: &quot;OK&quot;}JSONæ•°æ®ï¼Œä»£è¡¨æŽ¨é€æˆåŠŸï¼Œå¦åˆ™å¼€å‘å¹³å°ä¼šé—´éš”æ—¶é—´è¿žç»­æŽ¨é€ã€‚å…¶ä¸­å…³äºŽå›žè°ƒè¿”å›žçš„å­—æ®µå¯å‚è€ƒç¾Žå›¢å¼€å‘å¹³å°å›žè°ƒAPIï¼šhttp://developer.meituan.com/openapi#7.5.1ã€‚é™¤äº†è®¢å•å›žè°ƒï¼Œç¾Žå›¢å¼€å‘å¹³å°è¿˜æä¾›äº†é—¨åº—ç»‘å®šå’Œè§£ç»‘çš„å›žè°ƒï¼Œå’Œè®¢å•ç±»ä¼¼ï¼Œé…ç½®å¥½å›žè°ƒURLå³å¯ã€‚æ¯”å¦‚é—¨åº—ç»‘å®šå›žè°ƒæ–¹æ³•ï¼š123456789101112131415161718192021/** * é—¨åº—ç»‘å®šæˆåŠŸå›žè°ƒ * @param appAuthToken * @param businessId * @param ePoiId * @param timestamp * @return */@ResponseBody@RequestMapping(value="/plugpay/mtOauth.php",produces=&#123;"application/json;charset=UTF-8"&#125;)public JSONObject saveLogin(String appAuthToken, String businessId, String ePoiId, String timestamp)&#123; synchronized (this) &#123; JSONObject jsonObject = new JSONObject(); System.out.println("appAuthToken: "+appAuthToken+"businessId: "+businessId+"ePoiId: "+ePoiId+ "timestamp: "+timestamp); System.out.println("å•†æˆ·ç»‘å®šæˆåŠŸ"); // ä¿å­˜token... jsonObject.element("data","success"); return jsonObject; &#125;&#125;é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„å›žè°ƒï¼šå¿ƒè·³æ˜¯ç”¨æ¥æ£€æµ‹é¤é¥®å•†æˆ·è®¾å¤‡æ˜¯å¦æ­£å¸¸å·¥ä½œçš„å®šæ—¶æœºåˆ¶ï¼Œå…¶ä¸­é¤é¥®å•†æˆ·çš„è®¾å¤‡åŒ…æ‹¬æ‰€ä½¿ç”¨çš„ERPç³»ç»Ÿçš„äº‘ç«¯ã€posç­‰å„ç±»è®¾å¤‡ã€‚å¿ƒè·³ç”±ERPåŽ‚å•†è´Ÿè´£ä¸ŠæŠ¥ï¼Œèšå®ç›†å¼€æ”¾å¹³å°è´Ÿè´£æ”¶é›†ï¼Œå¹¶å°†æ”¶é›†åˆ°çš„ç»“æžœåº”ç”¨äºŽå¤–å–ã€ç‚¹é¤ç­‰ä¸šåŠ¡çº¿ã€‚å›žè°ƒæ–¹æ³•å¾ˆç®€å•ï¼š12345678910111213/** * å¿ƒè·³ * @param request * @return */@ResponseBody@RequestMapping(value="/plugpay/heartbeat.php",method=&#123;RequestMethod.GET&#125;)public Map&lt;String,String&gt; mtHeartbeatBack(HttpServletRequest request)&#123; Map&lt;String, String&gt; result = new HashMap&lt;String, String&gt;(); result.put("data", "OK"); System.out.println("mtHeartbeat "+System.currentTimeMillis()); return result;&#125;ä½¿ç”¨SDKæ“ä½œè®¢å•SDKä¸­å„ä¸ªAPIå¯¹åº”çš„å°è£…ç±»æŒ‰å¦‚ä¸‹è§„åˆ™å‘½åï¼šé€šç”¨å‰ç¼€ + ä¸šåŠ¡ç±»åž‹å‰ç¼€ + ä¸šåŠ¡äºŒçº§å‰ç¼€ + å…·ä½“æ“ä½œ + é€šç”¨åŽç¼€ã€‚æ¯”å¦‚ç¡®è®¤å¤–å–è®¢å•è¯·æ±‚çš„URLä¸ºï¼šhttp://api.open.cater.meituan.com/waimai/order/confirmã€‚æŽ¥å£å¯¹åº”å®Œæ•´ç±»ä¸ºï¼šCipCater + Takeout + Order + Confirm + Request = CipCaterTakeoutOrderConfirmRequestã€‚è¿”å›žç»“æžœä¸ºJSONå­—ç¬¦ä¸²ã€‚å…·ä½“ä¾‹å­å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627JSONObject result_json = new JSONObject();// å£°æ˜Žå…¬å…±å‚æ•°ï¼ŒRequestSysParamsæž„é€ æ–¹æ³•æŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºsignkeyï¼Œç¬¬äºŒä¸ªä¸ºappAuthTokenRequestSysParams requestSysParams = new RequestSysParams("yourSecret", "yourToken");// å£°æ˜Žæ‰€éœ€requestï¼Œæ­¤Requestå¯¹è±¡ä¸ºæ ¹æ®urlåœ¨è¡¨ä¸­æŸ¥è¯¢èŽ·å¾—CipCaterTakeoutOrderConfirmRequest request = new CipCaterTakeoutOrderConfirmRequest();// è®¾ç½®å…¬å…±å‚æ•°request.setRequestSysParams(requestSysParams);// è®¾ç½®ä¸šåŠ¡çº§å‚æ•°request.setOrderId(orderId);// å‡†å¤‡æŽ¥æ”¶è¿”å›žJsonString resultJson = "";try &#123; // å‘é€è¯·æ±‚ï¼ŒæŽ¥æ”¶Jsonï¼Œæ‰€æœ‰Requestéƒ½æœ‰doRequestæ–¹æ³•ç›´æŽ¥è°ƒç”¨å³å¯ result_json = JSONObject.fromObject(request.doRequest());&#125; catch (IOException e) &#123; // å¤„ç†ioå¼‚å¸¸&#125; catch (URISyntaxException e) &#123; // å¤„ç†URIè¯­æ³•å¼‚å¸¸ &#125;String data = getJsonValueString(result_json, "data");if("OK".equalsIgnoreCase(data))&#123; // æˆåŠŸ&#125;else&#123; JSONObject error = JSONObject.fromObject(getJsonValueString(result_json, "error")); String message = getJsonValueString(error, "message"); //å¤±è´¥&#125;å…¶ä¸­getJsonValueStringæ–¹æ³•ä½œç”¨ä¸ºæ ¹æ®å­—æ®µåä»ŽJSONä¸­èŽ·å–å€¼ï¼š123456789101112131415161718192021222324/** * æ ¹æ®åç§°èŽ·å–Jsoné‡Œçš„å€¼ * @param json * @param name * @return */public String getJsonValueString(JSONObject json,String name) &#123; return json.has(name)?json.getString(name):"";&#125;public int getJsonValueInt(JSONObject json,String name) &#123; return json.has(name)?json.getInt(name):0;&#125;public double getJsonValueDouble(JSONObject json,String name) &#123; return json.has(name)?json.getDouble(name):0.0;&#125;public boolean getJsonValueBoolean(JSONObject json,String name) &#123; return json.has(name)?json.getBoolean(name):false;&#125;public JSONArray getJsonValueArray(JSONObject json,String name) &#123; return json.has(name)?json.getJSONArray(name):new JSONArray();&#125;public JSONObject getJsonValueObj(JSONObject json,String name) &#123; return json.has(name)?json.getJSONObject(name):new JSONObject();&#125;ä½¿ç”¨çš„JSONåŒ…ä¸ºnet.sf.jsonã€‚å…¶ä»–æŽ¥å£çš„ä½¿ç”¨ä»¥æ­¤ç±»æŽ¨ã€‚]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot MyBatisé…ç½®Druidå¤šæ•°æ®æº]]></title>
    <url>%2FSpring-Boot-MyBatis%20Druid.html</url>
    <content type="text"><![CDATA[å›žé¡¾åœ¨Springä¸­é…ç½®MyBatis SqlSessionFactoryçš„é…ç½®ï¼š12345&lt;!-- mybatis çš„SqlSessionFactory --&gt;&lt;bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean" scope="prototype"&gt; &lt;property name="dataSource" ref="dataSource"/&gt; &lt;property name="configLocation" value="classpath:mybatis-config.xml"/&gt;&lt;/bean&gt;æ‰€ä»¥å®žé™…ä¸Šåœ¨Spring Bootä¸­é…ç½®MyBatiså¤šæ•°æ®æºçš„å…³é”®åœ¨äºŽåˆ›å»ºSqlSessionFactoryçš„æ—¶å€™ä¸ºå…¶åˆ†é…ä¸åŒçš„æ•°æ®æºã€‚å¼•å…¥ä¾èµ–å…ˆæ ¹æ®https://mrbird.cc/%E5%BC%80%E5%90%AFSpring-Boot.htmlå¼€å¯ä¸€ä¸ªæœ€ç®€å•çš„Spring Bootåº”ç”¨ï¼Œç„¶åŽå¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š12345678910111213141516171819202122232425&lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.3.1&lt;/version&gt;&lt;/dependency&gt;&lt;!-- oracleé©±åŠ¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.oracle&lt;/groupId&gt; &lt;artifactId&gt;ojdbc6&lt;/artifactId&gt; &lt;version&gt;6.0&lt;/version&gt;&lt;/dependency&gt;&lt;!-- mysqlé©±åŠ¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!-- druidæ•°æ®æºé©±åŠ¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.6&lt;/version&gt;&lt;/dependency&gt;å¤šæ•°æ®æºé…ç½®åœ¨Spring Booté…ç½®æ–‡ä»¶application.ymlä¸­é…ç½®å¤šæ•°æ®æºå’ŒSpring Boot JdbcTemplateé…ç½®Druidå¤šæ•°æ®æºä¸€è‡´ã€‚ç„¶åŽæ ¹æ®application.ymlåˆ›å»ºä¸¤ä¸ªæ•°æ®æºé…ç½®ç±»MysqlDatasourceConfigå’ŒOracleDatasourceConfigï¼šMysqlDatasourceConfigï¼š12345678910111213141516171819202122232425262728293031323334@Configuration@MapperScan(basePackages = MysqlDatasourceConfig.PACKAGE, sqlSessionFactoryRef = "mysqlSqlSessionFactory")public class MysqlDatasourceConfig &#123; // mysqldaoæ‰«æè·¯å¾„ static final String PACKAGE = "com.springboot.mysqldao"; // mybatis mapperæ‰«æè·¯å¾„ static final String MAPPER_LOCATION = "classpath:mapper/mysql/*.xml"; @Primary @Bean(name = "mysqldatasource") @ConfigurationProperties("spring.datasource.druid.mysql") public DataSource mysqlDataSource() &#123; return DruidDataSourceBuilder.create().build(); &#125; @Bean(name = "mysqlTransactionManager") @Primary public DataSourceTransactionManager mysqlTransactionManager() &#123; return new DataSourceTransactionManager(mysqlDataSource()); &#125; @Bean(name = "mysqlSqlSessionFactory") @Primary public SqlSessionFactory mysqlSqlSessionFactory(@Qualifier("mysqldatasource") DataSource dataSource) throws Exception &#123; final SqlSessionFactoryBean sessionFactory = new SqlSessionFactoryBean(); sessionFactory.setDataSource(dataSource); //å¦‚æžœä¸ä½¿ç”¨xmlçš„æ–¹å¼é…ç½®mapperï¼Œåˆ™å¯ä»¥çœåŽ»ä¸‹é¢è¿™è¡Œmapper locationçš„é…ç½®ã€‚ sessionFactory.setMapperLocations(new PathMatchingResourcePatternResolver() .getResources(MysqlDatasourceConfig.MAPPER_LOCATION)); return sessionFactory.getObject(); &#125;&#125;ä¸Šé¢ä»£ç é…ç½®äº†ä¸€ä¸ªåä¸ºmysqldatasourceçš„æ•°æ®æºï¼Œå¯¹åº”application.ymlä¸­spring.datasource.druid.mysqlå‰ç¼€é…ç½®çš„æ•°æ®åº“ã€‚ç„¶åŽåˆ›å»ºäº†ä¸€ä¸ªåä¸ºmysqlSqlSessionFactoryçš„Beanï¼Œå¹¶ä¸”æ³¨å…¥äº†mysqldatasourceã€‚ä¸Žæ­¤åŒæ—¶ï¼Œè¿˜åˆ†åˆ«å®šäº†ä¸¤ä¸ªæ‰«æè·¯å¾„PACKAGEå’ŒMAPPER_LOCATIONï¼Œå‰è€…ä¸ºMysqlæ•°æ®åº“å¯¹åº”çš„mapperæŽ¥å£åœ°å€ï¼ŒåŽè€…ä¸ºå¯¹åº”çš„mapper xmlæ–‡ä»¶è·¯å¾„ã€‚@Primaryæ ‡å¿—è¿™ä¸ªBeanå¦‚æžœåœ¨å¤šä¸ªåŒç±»Beanå€™é€‰æ—¶ï¼Œè¯¥Beanä¼˜å…ˆè¢«è€ƒè™‘ã€‚å¤šæ•°æ®æºé…ç½®çš„æ—¶å€™ï¼Œå¿…é¡»è¦æœ‰ä¸€ä¸ªä¸»æ•°æ®æºï¼Œç”¨@Primaryæ ‡å¿—è¯¥Beanã€‚åŒç†ï¼ŒæŽ¥ç€é…ç½®Oracleæ•°æ®åº“å¯¹åº”çš„é…ç½®ç±»ï¼šOracleDatasourceConfigï¼š1234567891011121314151617181920212223242526272829303132@Configuration@MapperScan(basePackages = OracleDatasourceConfig.PACKAGE, sqlSessionFactoryRef = "oracleSqlSessionFactory")public class OracleDatasourceConfig &#123; // oracledaoæ‰«æè·¯å¾„ static final String PACKAGE = "com.springboot.oracledao"; // mybatis mapperæ‰«æè·¯å¾„ static final String MAPPER_LOCATION = "classpath:mapper/oracle/*.xml"; @Bean(name = "oracledatasource") @ConfigurationProperties("spring.datasource.druid.oracle") public DataSource oracleDataSource() &#123; return DruidDataSourceBuilder.create().build(); &#125; @Bean(name = "oracleTransactionManager") public DataSourceTransactionManager oracleTransactionManager() &#123; return new DataSourceTransactionManager(oracleDataSource()); &#125; @Bean(name = "oracleSqlSessionFactory") public SqlSessionFactory oracleSqlSessionFactory(@Qualifier("oracledatasource") DataSource dataSource) throws Exception &#123; final SqlSessionFactoryBean sessionFactory = new SqlSessionFactoryBean(); sessionFactory.setDataSource(dataSource); //å¦‚æžœä¸ä½¿ç”¨xmlçš„æ–¹å¼é…ç½®mapperï¼Œåˆ™å¯ä»¥çœåŽ»ä¸‹é¢è¿™è¡Œmapper locationçš„é…ç½®ã€‚ sessionFactory.setMapperLocations(new PathMatchingResourcePatternResolver() .getResources(OracleDatasourceConfig.MAPPER_LOCATION)); return sessionFactory.getObject(); &#125;&#125;æµ‹è¯•é…ç½®å®Œå¤šæ•°æ®æºï¼ŒæŽ¥ä¸‹æ¥åˆ†åˆ«åœ¨com.springboot.mysqldaoè·¯å¾„å’Œcom.springboot.oracledaoè·¯å¾„ä¸‹åˆ›å»ºä¸¤ä¸ªmapperæŽ¥å£ï¼šMysqlStudentMapperï¼š12345678910package com.springboot.mysqldao;import java.util.List;import java.util.Map;import org.apache.ibatis.annotations.Mapper;@Mapperpublic interface MysqlStudentMapper &#123; List&lt;Map&lt;String, Object&gt;&gt; getAllStudents();&#125;OracleStudentMapperï¼š12345678910package com.springboot.oracledao;import java.util.List;import java.util.Map;import org.apache.ibatis.annotations.Mapper;@Mapperpublic interface OracleStudentMapper &#123; List&lt;Map&lt;String, Object&gt;&gt; getAllStudents();&#125;æŽ¥ç€åˆ›å»ºmapperæŽ¥å£å¯¹åº”çš„å®žçŽ°ï¼šåœ¨src/main/resource/mapper/mysql/è·¯å¾„ä¸‹åˆ›å»ºMysqlStudentMapper.xmlï¼š12345678&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="com.springboot.mysqldao.MysqlStudentMapper"&gt; &lt;select id="getAllStudents" resultType="java.util.Map"&gt; select * from student &lt;/select&gt;&lt;/mapper&gt;åœ¨src/main/resource/mapper/oracle/è·¯å¾„ä¸‹åˆ›å»ºOracleStudentMapper.xmlï¼š12345678&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="com.springboot.oracledao.OracleStudentMapper"&gt; &lt;select id="getAllStudents" resultType="java.util.Map"&gt; select * from student &lt;/select&gt;&lt;/mapper&gt;Serviceï¼ŒControllerä»¥åŠæµ‹è¯•æ•°æ®åŒSpring Boot JdbcTemplateé…ç½®Druidå¤šæ•°æ®æºï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚æœ€ç»ˆé¡¹ç›®ç›®å½•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®ï¼šhttp://localhost:8080/web/querystudentsfrommysqlï¼šhttp://localhost:8080/web/querystudentsfromoracleï¼šsource code]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
        <tag>MyBatis</tag>
        <tag>Druid</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot JdbcTemplateé…ç½®Druidå¤šæ•°æ®æº]]></title>
    <url>%2FSpring-Boot-JdbcTemplate%20Druid.html</url>
    <content type="text"><![CDATA[JdbcTemplateé…ç½®Druidå¤šæ•°æ®æºçš„æ ¸å¿ƒåœ¨äºŽåˆ›å»ºJdbcTemplateæ—¶å€™ä¸ºå…¶åˆ†é…ä¸åŒçš„æ•°æ®æºï¼Œç„¶åŽåœ¨éœ€è¦è®¿é—®ä¸åŒæ•°æ®åº“çš„æ—¶å€™ä½¿ç”¨å¯¹åº”çš„JdbcTemplateå³å¯ã€‚è¿™é‡Œä»‹ç»åœ¨Spring Bootä¸­åŸºäºŽOracleå’ŒMysqlé…ç½®Druidå¤šæ•°æ®æºã€‚å¼•å…¥ä¾èµ–å…ˆæ ¹æ®https://mrbird.cc/%E5%BC%80%E5%90%AFSpring-Boot.htmlå¼€å¯ä¸€ä¸ªæœ€ç®€å•çš„Spring Bootåº”ç”¨ï¼Œç„¶åŽå¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š123456789101112131415161718192021222324&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!-- oracleé©±åŠ¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.oracle&lt;/groupId&gt; &lt;artifactId&gt;ojdbc6&lt;/artifactId&gt; &lt;version&gt;6.0&lt;/version&gt;&lt;/dependency&gt;&lt;!-- mysqlé©±åŠ¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!-- druidæ•°æ®æºé©±åŠ¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.6&lt;/version&gt;&lt;/dependency&gt;å¤šæ•°æ®æºé…ç½®æŽ¥ç€åœ¨Spring Booté…ç½®æ–‡ä»¶application.ymlä¸­é…ç½®å¤šæ•°æ®æºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273server: context-path: /webspring: datasource: druid: # æ•°æ®åº“è®¿é—®é…ç½®, ä½¿ç”¨druidæ•°æ®æº # æ•°æ®æº1 mysql mysql: type: com.alibaba.druid.pool.DruidDataSource driver-class-name: com.mysql.jdbc.Driver url: jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=UTF-8&amp;rewriteBatchedStatements=true&amp;autoReconnect=true&amp;failOverReadOnly=false&amp;zeroDateTimeBehavior=convertToNull username: root password: 123456 # æ•°æ®æº2 oracle oracle: type: com.alibaba.druid.pool.DruidDataSource driver-class-name: oracle.jdbc.driver.OracleDriver url: jdbc:oracle:thin:@localhost:1521:ORCL username: scott password: 123456 # è¿žæŽ¥æ± é…ç½® initial-size: 5 min-idle: 5 max-active: 20 # è¿žæŽ¥ç­‰å¾…è¶…æ—¶æ—¶é—´ max-wait: 30000 # é…ç½®æ£€æµ‹å¯ä»¥å…³é—­çš„ç©ºé—²è¿žæŽ¥é—´éš”æ—¶é—´ time-between-eviction-runs-millis: 60000 # é…ç½®è¿žæŽ¥åœ¨æ± ä¸­çš„æœ€å°ç”Ÿå­˜æ—¶é—´ min-evictable-idle-time-millis: 300000 validation-query: select '1' from dual test-while-idle: true test-on-borrow: false test-on-return: false # æ‰“å¼€PSCacheï¼Œå¹¶ä¸”æŒ‡å®šæ¯ä¸ªè¿žæŽ¥ä¸ŠPSCacheçš„å¤§å° pool-prepared-statements: true max-open-prepared-statements: 20 max-pool-prepared-statement-per-connection-size: 20 # é…ç½®ç›‘æŽ§ç»Ÿè®¡æ‹¦æˆªçš„filters, åŽ»æŽ‰åŽç›‘æŽ§ç•Œé¢sqlæ— æ³•ç»Ÿè®¡, 'wall'ç”¨äºŽé˜²ç«å¢™ filters: stat,wall # Springç›‘æŽ§AOPåˆ‡å…¥ç‚¹ï¼Œå¦‚x.y.z.service.*,é…ç½®å¤šä¸ªè‹±æ–‡é€—å·åˆ†éš” aop-patterns: com.springboot.servie.* # WebStatFilteré…ç½® web-stat-filter: enabled: true # æ·»åŠ è¿‡æ»¤è§„åˆ™ url-pattern: /* # å¿½ç•¥è¿‡æ»¤çš„æ ¼å¼ exclusions: '*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*' # StatViewServleté…ç½® stat-view-servlet: enabled: true # è®¿é—®è·¯å¾„ä¸º/druidæ—¶ï¼Œè·³è½¬åˆ°StatViewServlet url-pattern: /druid/* # æ˜¯å¦èƒ½å¤Ÿé‡ç½®æ•°æ® reset-enable: false # éœ€è¦è´¦å·å¯†ç æ‰èƒ½è®¿é—®æŽ§åˆ¶å° login-username: druid login-password: druid123 # IPç™½åå• # allow: 127.0.0.1 # IPé»‘åå•ï¼ˆå…±åŒå­˜åœ¨æ—¶ï¼Œdenyä¼˜å…ˆäºŽallowï¼‰ # deny: 192.168.1.218 # é…ç½®StatFilter filter: stat: log-slow-sql: trueç„¶åŽåˆ›å»ºä¸€ä¸ªå¤šæ•°æ®æºé…ç½®ç±»ï¼Œæ ¹æ®application.ymlåˆ†åˆ«é…ç½®ä¸€ä¸ªMysqlå’ŒOracleçš„æ•°æ®æºï¼Œå¹¶ä¸”å°†è¿™ä¸¤ä¸ªæ•°æ®æºæ³¨å…¥åˆ°ä¸¤ä¸ªä¸åŒçš„JdbcTemplateä¸­ï¼š123456789101112131415161718192021222324252627@Configurationpublic class DataSourceConfig &#123; @Primary @Bean(name = "mysqldatasource") @ConfigurationProperties("spring.datasource.druid.mysql") public DataSource dataSourceOne()&#123; return DruidDataSourceBuilder.create().build(); &#125; @Bean(name = "oracledatasource") @ConfigurationProperties("spring.datasource.druid.oracle") public DataSource dataSourceTwo()&#123; return DruidDataSourceBuilder.create().build(); &#125; @Bean(name = "mysqlJdbcTemplate") public JdbcTemplate primaryJdbcTemplate( @Qualifier("mysqldatasource") DataSource dataSource) &#123; return new JdbcTemplate(dataSource); &#125; @Bean(name = "oracleJdbcTemplate") public JdbcTemplate secondaryJdbcTemplate( @Qualifier("oracledatasource") DataSource dataSource) &#123; return new JdbcTemplate(dataSource); &#125;&#125;ä¸Šè¿°ä»£ç æ ¹æ®application.ymlåˆ›å»ºäº†mysqldatasourceå’Œoracledatasourceæ•°æ®æºï¼Œå…¶ä¸­mysqldatasourceç”¨@Primaryæ ‡æ³¨ä¸ºä¸»æ•°æ®æºï¼ŒæŽ¥ç€æ ¹æ®è¿™ä¸¤ä¸ªæ•°æ®æºåˆ›å»ºäº†mysqlJdbcTemplateå’ŒoracleJdbcTemplateã€‚@Primaryæ ‡å¿—è¿™ä¸ªBeanå¦‚æžœåœ¨å¤šä¸ªåŒç±»Beanå€™é€‰æ—¶ï¼Œè¯¥Beanä¼˜å…ˆè¢«è€ƒè™‘ã€‚å¤šæ•°æ®æºé…ç½®çš„æ—¶å€™ï¼Œå¿…é¡»è¦æœ‰ä¸€ä¸ªä¸»æ•°æ®æºï¼Œç”¨@Primaryæ ‡å¿—è¯¥Beanã€‚æ•°æ®æºåˆ›å»ºå®Œæ¯•ï¼ŒæŽ¥ä¸‹æ¥å¼€å§‹è¿›è¡Œæµ‹è¯•ä»£ç ç¼–å†™ã€‚æµ‹è¯•é¦–å…ˆå¾€Mysqlå’ŒOracleä¸­åˆ›å»ºæµ‹è¯•è¡¨ï¼Œå¹¶æ’å…¥ä¸€äº›æµ‹è¯•æ•°æ®ï¼šMysqlï¼š12345678910DROP TABLE IF EXISTS `student`;CREATE TABLE `student` ( `sno` varchar(3) NOT NULL, `sname` varchar(9) NOT NULL, `ssex` char(2) NOT NULL, `database` varchar(10) DEFAULT NULL) DEFAULT CHARSET=utf8;INSERT INTO `student` VALUES ('001', 'åº·åº·', 'M', 'mysql');INSERT INTO `student` VALUES ('002', 'éº¦å…‹', 'M', 'mysql');Oracleï¼š123456789101112DROP TABLE "SCOTT"."STUDENT";CREATE TABLE "SCOTT"."STUDENT" ( "SNO" VARCHAR2(3 BYTE) NOT NULL , "SNAME" VARCHAR2(9 BYTE) NOT NULL , "SSEX" CHAR(2 BYTE) NOT NULL , "database" VARCHAR2(10 BYTE) NULL );INSERT INTO "SCOTT"."STUDENT" VALUES ('001', 'KangKang', 'M ', 'oracle');INSERT INTO "SCOTT"."STUDENT" VALUES ('002', 'Mike', 'M ', 'oracle');INSERT INTO "SCOTT"."STUDENT" VALUES ('003', 'Jane', 'F ', 'oracle');INSERT INTO "SCOTT"."STUDENT" VALUES ('004', 'Maria', 'F ', 'oracle');æŽ¥ç€åˆ›å»ºä¸¤ä¸ªDaoåŠå…¶å®žçŽ°ç±»ï¼Œåˆ†åˆ«ç”¨äºŽä»ŽMysqlå’ŒOracleä¸­èŽ·å–æ•°æ®ï¼šMysqlStudentDaoæŽ¥å£ï¼š123public interface MysqlStudentDao &#123; List&lt;Map&lt;String, Object&gt;&gt; getAllStudents();&#125;MysqlStudentDaoå®žçŽ°ï¼›1234567891011@Repositorypublic class MysqlStudentDaoImp implements MysqlStudentDao&#123; @Autowired @Qualifier("mysqlJdbcTemplate") private JdbcTemplate jdbcTemplate; @Override public List&lt;Map&lt;String, Object&gt;&gt; getAllStudents() &#123; return this.jdbcTemplate.queryForList("select * from student"); &#125;&#125;å¯çœ‹åˆ°ï¼Œåœ¨MysqlStudentDaoImpä¸­æ³¨å…¥çš„æ˜¯mysqlJdbcTemplateã€‚OracleStudentDaoæŽ¥å£ï¼š123public interface OracleStudentDao &#123; List&lt;Map&lt;String, Object&gt;&gt; getAllStudents();&#125;OracleStudentDaoå®žçŽ°ï¼š1234567891011@Repositorypublic class OracleStudentDaoImp implements OracleStudentDao&#123; @Autowired @Qualifier("oracleJdbcTemplate") private JdbcTemplate jdbcTemplate; @Override public List&lt;Map&lt;String, Object&gt;&gt; getAllStudents() &#123; return this.jdbcTemplate.queryForList("select * from student"); &#125;&#125;åœ¨OracleStudentDaoImpä¸­æ³¨å…¥çš„æ˜¯oracleJdbcTemplateã€‚éšåŽç¼–å†™Serviceå±‚ï¼šStudentServiceæŽ¥å£ï¼š1234public interface StudentService &#123; List&lt;Map&lt;String, Object&gt;&gt; getAllStudentsFromOralce(); List&lt;Map&lt;String, Object&gt;&gt; getAllStudentsFromMysql();&#125;StudentServiceå®žçŽ°ï¼š1234567891011121314151617@Service("studentService")public class StudentServiceImp implements StudentService&#123; @Autowired private OracleStudentDao oracleStudentDao; @Autowired private MysqlStudentDao mysqlStudentDao; @Override public List&lt;Map&lt;String, Object&gt;&gt; getAllStudentsFromOralce() &#123; return this.oracleStudentDao.getAllStudents(); &#125; @Override public List&lt;Map&lt;String, Object&gt;&gt; getAllStudentsFromMysql() &#123; return this.mysqlStudentDao.getAllStudents(); &#125;&#125;æœ€åŽç¼–å†™ä¸€ä¸ªControllerï¼š123456789101112131415@RestControllerpublic class StudentController &#123; @Autowired private StudentService studentService; @RequestMapping("querystudentsfromoracle") public List&lt;Map&lt;String, Object&gt;&gt; queryStudentsFromOracle()&#123; return this.studentService.getAllStudentsFromOralce(); &#125; @RequestMapping("querystudentsfrommysql") public List&lt;Map&lt;String, Object&gt;&gt; queryStudentsFromMysql()&#123; return this.studentService.getAllStudentsFromMysql(); &#125;&#125;æœ€ç»ˆé¡¹ç›®ç›®å½•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®ï¼šhttp://localhost:8080/web/querystudentsfrommysqlï¼šhttp://localhost:8080/web/querystudentsfromoracleï¼šsource code]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
        <tag>Druid</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootä¸­ä½¿ç”¨JdbcTemplate]]></title>
    <url>%2FSpring-Boot%20JdbcTemplate.html</url>
    <content type="text"><![CDATA[ä¸ªäººè§‰å¾—JdbcTemplateç›¸è¾ƒäºŽMyBaitsï¼ŒHibernateç­‰æ•°æ®åº“æ¡†æž¶æ›´å®¹æ˜“ä¸Šæ‰‹ï¼Œå¯¹SQLçš„æ“ä½œä¹Ÿæ›´ä¸ºç›´è§‚æ–¹ä¾¿ï¼Œæ‰€ä»¥åœ¨é¡¹ç›®ä¸­ä¹Ÿæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚åœ¨Spring Bootå¼€å¯JdbcTemplateå¾ˆç®€å•ï¼Œåªéœ€è¦å¼•å…¥spring-boot-starter-jdbcä¾èµ–å³å¯ã€‚JdbcTemplateå°è£…äº†è®¸å¤šSQLæ“ä½œï¼Œå…·ä½“å¯æŸ¥é˜…å®˜æ–¹æ–‡æ¡£https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jdbc/core/JdbcTemplate.htmlã€‚å¼•å…¥ä¾èµ–spring-boot-starter-jdbcï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt;æ•°æ®åº“é©±åŠ¨ä¸ºojdbc6ï¼Œæ•°æ®æºé‡‡ç”¨Druidã€‚å…·ä½“å¯å‚è€ƒhttps://mrbird.cc/Spring-Boot%E4%B8%AD%E4%BD%BF%E7%94%A8Mybatis.htmlã€‚ä»£ç ç¼–å†™æ•°æ®å‡†å¤‡ï¼š123456789CREATE TABLE "SCOTT"."STUDENT" ( "SNO" VARCHAR2(3 BYTE) NOT NULL , "SNAME" VARCHAR2(9 BYTE) NOT NULL , "SSEX" CHAR(2 BYTE) NOT NULL );INSERT INTO "SCOTT"."STUDENT" VALUES ('001', 'KangKang', 'M ');INSERT INTO "SCOTT"."STUDENT" VALUES ('002', 'Mike', 'M ');INSERT INTO "SCOTT"."STUDENT" VALUES ('003', 'Jane', 'F ');è¿™é‡Œä¸»è¦æ¼”ç¤ºåœ¨Daoçš„å®žçŽ°ç±»é‡Œä½¿ç”¨JdbcTemplateï¼Œæ‰€ä»¥å…¶å®ƒæ¨¡å—ä»£ç çš„ç¼–å†™å°±ä¸å±•ç¤ºäº†ï¼Œå…·ä½“å¯å‚è€ƒæ–‡æœ«çš„æºç ã€‚StudentDaoImpç±»ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152@Repository("studentDao")public class StudentDaoImp implements StudentDao &#123; @Autowired private JdbcTemplate jdbcTemplate; @Override public int add(Student student) &#123; // String sql = "insert into student(sno,sname,ssex) values(?,?,?)"; // Object[] args = &#123; student.getSno(), student.getName(), student.getSex() &#125;; // int[] argTypes = &#123; Types.VARCHAR, Types.VARCHAR, Types.VARCHAR &#125;; // return this.jdbcTemplate.update(sql, args, argTypes); String sql = "insert into student(sno,sname,ssex) values(:sno,:name,:sex)"; NamedParameterJdbcTemplate npjt = new NamedParameterJdbcTemplate(this.jdbcTemplate.getDataSource()); return npjt.update(sql, new BeanPropertySqlParameterSource(student)); &#125; @Override public int update(Student student) &#123; String sql = "update student set sname = ?,ssex = ? where sno = ?"; Object[] args = &#123; student.getName(), student.getSex(), student.getSno() &#125;; int[] argTypes = &#123; Types.VARCHAR, Types.VARCHAR, Types.VARCHAR &#125;; return this.jdbcTemplate.update(sql, args, argTypes); &#125; @Override public int deleteBysno(String sno) &#123; String sql = "delete from student where sno = ?"; Object[] args = &#123; sno &#125;; int[] argTypes = &#123; Types.VARCHAR &#125;; return this.jdbcTemplate.update(sql, args, argTypes); &#125; @Override public List&lt;Map&lt;String, Object&gt;&gt; queryStudentsListMap() &#123; String sql = "select * from student"; return this.jdbcTemplate.queryForList(sql); &#125; @Override public Student queryStudentBySno(String sno) &#123; String sql = "select * from student where sno = ?"; Object[] args = &#123; sno &#125;; int[] argTypes = &#123; Types.VARCHAR &#125;; List&lt;Student&gt; studentList = this.jdbcTemplate.query(sql, args, argTypes, new StudentMapper()); if (studentList != null &amp;&amp; studentList.size() &gt; 0) &#123; return studentList.get(0); &#125; else &#123; return null; &#125; &#125;&#125;åœ¨å¼•å…¥spring-boot-starter-jdbcé©±åŠ¨åŽï¼Œå¯ç›´æŽ¥åœ¨ç±»ä¸­æ³¨å…¥JdbcTemplateã€‚ç”±ä¸Šé¢ä»£ç å¯å‘çŽ°ï¼Œå¯¹äºŽä¿å­˜æ“ä½œæœ‰ä¸¤ç§ä¸åŒçš„æ–¹æ³•ï¼Œå½“æ’å…¥çš„è¡¨å­—æ®µè¾ƒå¤šçš„æƒ…å†µä¸‹ï¼ŒæŽ¨èä½¿ç”¨NamedParameterJdbcTemplateã€‚å¯¹äºŽè¿”å›žç»“æžœï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨List&lt;Map&lt;String, Object&gt;&gt;æ¥æŽ¥æ”¶ï¼Œè¿™ä¹Ÿæ˜¯ä¸ªäººæ¯”è¾ƒæŽ¨èä½¿ç”¨çš„æ–¹å¼ï¼Œæ¯•ç«Ÿæ¯”è¾ƒç®€å•æ–¹ä¾¿ï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨åº“è¡¨å¯¹åº”çš„å®žä½“å¯¹è±¡æ¥æŽ¥æ”¶ï¼Œä¸è¿‡è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªå®žçŽ°äº†org.springframework.jdbc.core.RowMapperçš„å¯¹è±¡ï¼Œç”¨äºŽå°†å®žä½“å¯¹è±¡å±žæ€§å’Œåº“è¡¨å­—æ®µä¸€ä¸€å¯¹åº”ï¼š12345678910public class StudentMapper implements RowMapper&lt;Student&gt;&#123; @Override public Student mapRow(ResultSet rs, int rowNum) throws SQLException &#123; Student student = new Student(); student.setSno(rs.getString("sno")); student.setName(rs.getString("sname")); student.setSex(rs.getString("ssex")); return student; &#125;&#125;æµ‹è¯•æœ€ç»ˆé¡¹ç›®ç›®å½•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¯åŠ¨é¡¹ç›®ï¼Œæµ‹è¯•æ’å…¥æ•°æ®http://localhost:8080/web/addstudent?sno=004&amp;name=Maria&amp;sex=Fï¼šæŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿæ•°æ®http://localhost:8080/web/queryallstudent:æµ‹è¯•åˆ é™¤http://localhost:8080/web/deletestudent?sno=004ï¼šsource code]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootä¸­ä½¿ç”¨MyBatis]]></title>
    <url>%2FSpring-Boot%20Mybatis.html</url>
    <content type="text"><![CDATA[æ•´åˆMyBatisä¹‹å‰ï¼Œå…ˆæ­å»ºä¸€ä¸ªåŸºæœ¬çš„Spring Booté¡¹ç›®å¼€å¯Spring Bootã€‚ç„¶åŽå¼•å…¥mybatis-spring-boot-starterå’Œæ•°æ®åº“è¿žæŽ¥é©±åŠ¨ï¼ˆè¿™é‡Œä½¿ç”¨å…³ç³»åž‹æ•°æ®åº“Oracle 11gï¼‰ã€‚mybatis-spring-boot-starteråœ¨pomä¸­å¼•å…¥ï¼š12345&lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.3.1&lt;/version&gt;&lt;/dependency&gt;ä¸åŒç‰ˆæœ¬çš„Spring Bootå’ŒMyBatisç‰ˆæœ¬å¯¹åº”ä¸ä¸€æ ·ï¼Œå…·ä½“å¯æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼šhttp://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/ã€‚é€šè¿‡dependency:treeå‘½ä»¤æŸ¥çœ‹mybatis-spring-boot-starteréƒ½æœ‰å“ªäº›éšæ€§ä¾èµ–ï¼š123456789+- org.mybatis.spring.boot:mybatis-spring-boot-starter:jar:1.3.1:compile| +- org.springframework.boot:spring-boot-starter-jdbc:jar:1.5.9.RELEASE:compile| | +- org.apache.tomcat:tomcat-jdbc:jar:8.5.23:compile| | | \- org.apache.tomcat:tomcat-juli:jar:8.5.23:compile| | \- org.springframework:spring-jdbc:jar:4.3.13.RELEASE:compile| | \- org.springframework:spring-tx:jar:4.3.13.RELEASE:compile| +- org.mybatis.spring.boot:mybatis-spring-boot-autoconfigure:jar:1.3.1:compile| +- org.mybatis:mybatis:jar:3.4.5:compile| \- org.mybatis:mybatis-spring:jar:1.3.1:compileå¯å‘çŽ°å…¶åŒ…å«äº†spring-boot-starter-jdbcä¾èµ–ï¼Œé»˜è®¤ä½¿ç”¨tomcat-jdbcæ•°æ®æºã€‚å¼•å…¥ojdbc6ç”±äºŽç‰ˆæƒçš„åŽŸå› ï¼Œæˆ‘ä»¬éœ€è¦å°†ojdbc6.jarä¾èµ–å®‰è£…åˆ°æœ¬åœ°çš„mavenä»“åº“ï¼Œç„¶åŽæ‰å¯ä»¥åœ¨pomä¸­è¿›è¡Œé…ç½®ã€‚ä¸‹è½½ojdbc6.jaræ–‡ä»¶åŽï¼Œå°†å…¶æ”¾åˆ°æ¯”è¾ƒå¥½æ‰¾çš„ç›®å½•ä¸‹ï¼Œæ¯”å¦‚Dç›˜æ ¹ç›®å½•ã€‚ç„¶åŽè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š123456789101112131415C:\Users\Administrator&gt;mvn install:install-file -Dfile=D:/ojdbc6.jar -DgroupId=com.oracle -DartifactId=ojdbc6 -Dversion=6.0 -Dpackaging=jar -DgeneratePom=true...[INFO] --- maven-install-plugin:2.4:install-file (default-cli) @ standalone-pom ---[INFO] Installing D:\ojdbc6.jar to D:\m2\repository\com\oracle\ojdbc6\6.0\ojdbc6-6.0.jar[INFO] Installing C:\Users\ADMINI~1\AppData\Local\Temp\mvninstall9103688544010617483.pom to D:\m2\repository\com\oracle\ojdbc6\6.0\ojdbc6-6.0.pom[INFO] ------------------------------------------------------------------------[INFO] BUILD SUCCESS[INFO] ------------------------------------------------------------------------[INFO] Total time: 0.940 s[INFO] Finished at: 2017-08-13T15:06:38+08:00[INFO] Final Memory: 6M/145M[INFO] ------------------------------------------------------------------------æŽ¥ç€åœ¨pomä¸­å¼•å…¥ï¼š12345&lt;dependency&gt; &lt;groupId&gt;com.oracle&lt;/groupId&gt; &lt;artifactId&gt;ojdbc6&lt;/artifactId&gt; &lt;version&gt;6.0&lt;/version&gt;&lt;/dependency&gt;è¿™é‡Œçš„groupidå°±æ˜¯ä½ ä¹‹å‰å®‰è£…æ—¶æŒ‡å®šçš„-Dgroupidçš„å€¼ï¼Œartifactidå°±æ˜¯ä½ å®‰è£…æ—¶æŒ‡å®šçš„-Dartifactidçš„å€¼ï¼Œversionä¹Ÿä¸€æ ·ã€‚Druidæ•°æ®æºDruidæ˜¯ä¸€ä¸ªå…³ç³»åž‹æ•°æ®åº“è¿žæŽ¥æ± ï¼Œæ˜¯é˜¿é‡Œå·´å·´çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œåœ°å€ï¼šhttps://github.com/alibaba/druidã€‚Druidä¸ä½†æä¾›è¿žæŽ¥æ± çš„åŠŸèƒ½ï¼Œè¿˜æä¾›ç›‘æŽ§åŠŸèƒ½ï¼Œå¯ä»¥å®žæ—¶æŸ¥çœ‹æ•°æ®åº“è¿žæŽ¥æ± å’ŒSQLæŸ¥è¯¢çš„å·¥ä½œæƒ…å†µã€‚é…ç½®Druidä¾èµ–Druidä¸ºSpring Booté¡¹ç›®æä¾›äº†å¯¹åº”çš„starterï¼š12345&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.6&lt;/version&gt;&lt;/dependency&gt;Druidæ•°æ®æºé…ç½®ä¸Šé¢é€šè¿‡æŸ¥çœ‹mybatis starterçš„éšæ€§ä¾èµ–å‘çŽ°ï¼ŒSpring Bootçš„æ•°æ®æºé…ç½®çš„é»˜è®¤ç±»åž‹æ˜¯org.apache.tomcat.jdbc.pool.Datasourceï¼Œä¸ºäº†ä½¿ç”¨Druidè¿žæŽ¥æ± ï¼Œéœ€è¦åœ¨application.ymlä¸‹é…ç½®ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263server: context-path: /webspring: datasource: druid: # æ•°æ®åº“è®¿é—®é…ç½®, ä½¿ç”¨druidæ•°æ®æº type: com.alibaba.druid.pool.DruidDataSource driver-class-name: oracle.jdbc.driver.OracleDriver url: jdbc:oracle:thin:@localhost:1521:ORCL username: scott password: 123456 # è¿žæŽ¥æ± é…ç½® initial-size: 5 min-idle: 5 max-active: 20 # è¿žæŽ¥ç­‰å¾…è¶…æ—¶æ—¶é—´ max-wait: 30000 # é…ç½®æ£€æµ‹å¯ä»¥å…³é—­çš„ç©ºé—²è¿žæŽ¥é—´éš”æ—¶é—´ time-between-eviction-runs-millis: 60000 # é…ç½®è¿žæŽ¥åœ¨æ± ä¸­çš„æœ€å°ç”Ÿå­˜æ—¶é—´ min-evictable-idle-time-millis: 300000 validation-query: select '1' from dual test-while-idle: true test-on-borrow: false test-on-return: false # æ‰“å¼€PSCacheï¼Œå¹¶ä¸”æŒ‡å®šæ¯ä¸ªè¿žæŽ¥ä¸ŠPSCacheçš„å¤§å° pool-prepared-statements: true max-open-prepared-statements: 20 max-pool-prepared-statement-per-connection-size: 20 # é…ç½®ç›‘æŽ§ç»Ÿè®¡æ‹¦æˆªçš„filters, åŽ»æŽ‰åŽç›‘æŽ§ç•Œé¢sqlæ— æ³•ç»Ÿè®¡, 'wall'ç”¨äºŽé˜²ç«å¢™ filters: stat,wall # Springç›‘æŽ§AOPåˆ‡å…¥ç‚¹ï¼Œå¦‚x.y.z.service.*,é…ç½®å¤šä¸ªè‹±æ–‡é€—å·åˆ†éš” aop-patterns: com.springboot.servie.* # WebStatFilteré…ç½® web-stat-filter: enabled: true # æ·»åŠ è¿‡æ»¤è§„åˆ™ url-pattern: /* # å¿½ç•¥è¿‡æ»¤çš„æ ¼å¼ exclusions: '*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*' # StatViewServleté…ç½® stat-view-servlet: enabled: true # è®¿é—®è·¯å¾„ä¸º/druidæ—¶ï¼Œè·³è½¬åˆ°StatViewServlet url-pattern: /druid/* # æ˜¯å¦èƒ½å¤Ÿé‡ç½®æ•°æ® reset-enable: false # éœ€è¦è´¦å·å¯†ç æ‰èƒ½è®¿é—®æŽ§åˆ¶å° login-username: druid login-password: druid123 # IPç™½åå• # allow: 127.0.0.1 # IPé»‘åå•ï¼ˆå…±åŒå­˜åœ¨æ—¶ï¼Œdenyä¼˜å…ˆäºŽallowï¼‰ # deny: 192.168.1.218 # é…ç½®StatFilter filter: stat: log-slow-sql: trueä¸Šè¿°é…ç½®ä¸ä½†é…ç½®äº†Druidä½œä¸ºè¿žæŽ¥æ± ï¼Œè€Œä¸”è¿˜å¼€å¯äº†Druidçš„ç›‘æŽ§åŠŸèƒ½ã€‚ å…¶ä»–é…ç½®å¯å‚è€ƒå®˜æ–¹wikiâ€”â€”https://github.com/alibaba/druid/tree/master/druid-spring-boot-starteræ­¤æ—¶ï¼Œè¿è¡Œé¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/web/druidï¼šè¾“å…¥è´¦å·å¯†ç å³å¯çœ‹åˆ°Druidç›‘æŽ§åŽå°ï¼šå…³äºŽDruidçš„æ›´å¤šè¯´æ˜Žï¼Œå¯æŸ¥çœ‹å®˜æ–¹wikiâ€”â€”https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98ä½¿ç”¨MyBatisä½¿ç”¨çš„åº“è¡¨ï¼š123456789CREATE TABLE "SCOTT"."STUDENT" ( "SNO" VARCHAR2(3 BYTE) NOT NULL , "SNAME" VARCHAR2(9 BYTE) NOT NULL , "SSEX" CHAR(2 BYTE) NOT NULL );INSERT INTO "SCOTT"."STUDENT" VALUES ('001', 'KangKang', 'M ');INSERT INTO "SCOTT"."STUDENT" VALUES ('002', 'Mike', 'M ');INSERT INTO "SCOTT"."STUDENT" VALUES ('003', 'Jane', 'F ');åˆ›å»ºå¯¹åº”å®žä½“ï¼š1234567public class Student implements Serializable&#123; private static final long serialVersionUID = -339516038496531943L; private String sno; private String name; private String sex; // get,setç•¥&#125;åˆ›å»ºä¸€ä¸ªåŒ…å«åŸºæœ¬CRUDçš„StudentMapperï¼š123456public interface StudentMapper &#123; int add(Student student); int update(Student student); int deleteByIds(String sno); Student queryStudentById(Long id);&#125;StudentMapperçš„å®žçŽ°å¯ä»¥åŸºäºŽxmlä¹Ÿå¯ä»¥åŸºäºŽæ³¨è§£ã€‚ä½¿ç”¨æ³¨è§£æ–¹å¼ç»§ç»­ç¼–è¾‘StudentMapperï¼š12345678910111213141516171819@Component@Mapperpublic interface StudentMapper &#123; @Insert("insert into student(sno,sname,ssex) values(#&#123;sno&#125;,#&#123;name&#125;,#&#123;sex&#125;)") int add(Student student); @Update("update student set sname=#&#123;name&#125;,ssex=#&#123;sex&#125; where sno=#&#123;sno&#125;") int update(Student student); @Delete("delete from student where sno=#&#123;sno&#125;") int deleteBysno(String sno); @Select("select * from student where sno=#&#123;sno&#125;") @Results(id = "student",value= &#123; @Result(property = "sno", column = "sno", javaType = String.class), @Result(property = "name", column = "sname", javaType = String.class), @Result(property = "sex", column = "ssex", javaType = String.class) &#125;) Student queryStudentBySno(String sno);ç®€å•çš„è¯­å¥åªéœ€è¦ä½¿ç”¨@Insertã€@Updateã€@Deleteã€@Selectè¿™4ä¸ªæ³¨è§£å³å¯ï¼ŒåŠ¨æ€SQLè¯­å¥éœ€è¦ä½¿ç”¨@InsertProviderã€@UpdateProviderã€@DeleteProviderã€@SelectProviderç­‰æ³¨è§£ã€‚å…·ä½“å¯å‚è€ƒMyBatiså®˜æ–¹æ–‡æ¡£ï¼šhttp://www.mybatis.org/mybatis-3/zh/java-api.htmlã€‚ä½¿ç”¨xmlæ–¹å¼ä½¿ç”¨xmlæ–¹å¼éœ€è¦åœ¨application.ymlä¸­è¿›è¡Œä¸€äº›é¢å¤–çš„é…ç½®ï¼š1234567mybatis: # type-aliasesæ‰«æè·¯å¾„ # type-aliases-package: # mapper xmlå®žçŽ°æ‰«æè·¯å¾„ mapper-locations: classpath:mapper/*.xml property: order: BEFOREæµ‹è¯•æŽ¥ä¸‹æ¥ç¼–å†™Serviceï¼š123456public interface StudentService &#123; int add(Student student); int update(Student student); int deleteBysno(String sno); Student queryStudentBySno(String sno);&#125;å®žçŽ°ç±»ï¼š12345678910111213141516171819202122232425@Service("studentService")public class StudentServiceImp implements StudentService&#123; @Autowired private StudentMapper studentMapper; @Override public int add(Student student) &#123; return this.studentMapper.add(student); &#125; @Override public int update(Student student) &#123; return this.studentMapper.update(student); &#125; @Override public int deleteBysno(String sno) &#123; return this.studentMapper.deleteBysno(sno); &#125; @Override public Student queryStudentBySno(String sno) &#123; return this.studentMapper.queryStudentBySno(sno); &#125;&#125;ç¼–å†™controllerï¼š1234567891011@RestControllerpublic class TestController &#123; @Autowired private StudentService studentService; @RequestMapping( value = "/querystudent", method = RequestMethod.GET) public Student queryStudentBySno(String sno) &#123; return this.studentService.queryStudentBySno(sno); &#125;&#125;å®Œæ•´çš„é¡¹ç›®ç›®å½•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¯åŠ¨é¡¹ç›®è®¿é—®ï¼šhttp://localhost:8080/web/querystudent?sno=001ï¼šæŸ¥çœ‹SQLç›‘æŽ§æƒ…å†µï¼šå¯çœ‹åˆ°å…¶è®°å½•çš„å°±æ˜¯åˆšåˆšè®¿é—®/querystudentå¾—åˆ°çš„SQLã€‚source code]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
        <tag>MyBatis</tag>
        <tag>Druid</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootä¸€äº›åŸºç¡€é…ç½®]]></title>
    <url>%2FSpring-Boot%20basic%20config.html</url>
    <content type="text"><![CDATA[å®šåˆ¶BannerSpring Booté¡¹ç›®åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„å¯åŠ¨å›¾æ¡ˆï¼š1234567 . ____ _ __ _ _ /\\ / ___&apos;_ __ _ _(_)_ __ __ _ \ \ \ \( ( )\___ | &apos;_ | &apos;_| | &apos;_ \/ _` | \ \ \ \ \\/ ___)| |_)| | | | | || (_| | ) ) ) ) &apos; |____| .__|_| |_|_| |_\__, | / / / / =========|_|==============|___/=/_/_/_/ :: Spring Boot :: (v1.5.9.RELEASE)æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªå›¾æ¡ˆä¿®æ”¹ä¸ºè‡ªå·±æƒ³è¦çš„ã€‚åœ¨src/main/resourcesç›®å½•ä¸‹æ–°å»ºbanner.txtæ–‡ä»¶ï¼Œç„¶åŽå°†è‡ªå·±çš„å›¾æ¡ˆé»è´´è¿›åŽ»å³å¯ã€‚ASCIIå›¾æ¡ˆå¯é€šè¿‡ç½‘ç«™http://www.network-science.de/ascii/ä¸€é”®ç”Ÿæˆï¼Œæ¯”å¦‚è¾“å…¥mrbirdç”Ÿæˆå›¾æ¡ˆåŽå¤åˆ¶åˆ°banner.txtï¼Œå¯åŠ¨é¡¹ç›®ï¼ŒeclipseæŽ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹ï¼š12345678 _ _ _ _ _ _ / \ / \ / \ / \ / \ / \ ( m | r | b | i | r | d ) \_/ \_/ \_/ \_/ \_/ \_/ ...2017-08-12 10:11:25.952 INFO 7160 --- [main] o.s.j.e.a.AnnotationMBeanExporter : Registering beans for JMX exposure on startup2017-08-12 10:11:26.057 INFO 7160 --- [main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 8080 (http)2017-08-12 10:11:26.064 INFO 7160 --- [main] com.springboot.demo.DemoApplication : Started DemoApplication in 3.933 seconds (JVM running for 4.241)bannerä¹Ÿå¯ä»¥å…³é—­ï¼Œåœ¨mainæ–¹æ³•ä¸­ï¼š12345public static void main(String[] args) &#123; SpringApplication app = new SpringApplication(DemoApplication.class); app.setBannerMode(Mode.OFF); app.run(args);&#125;å…¨å±€é…ç½®æ–‡ä»¶åœ¨src/main/resourcesç›®å½•ä¸‹ï¼ŒSpring Bootæä¾›äº†ä¸€ä¸ªåä¸ºapplication.propertiesçš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯å¯¹ä¸€äº›é»˜è®¤é…ç½®çš„é…ç½®å€¼è¿›è¡Œä¿®æ”¹ã€‚é™„ï¼šapplication.propertiesä¸­å¯é…ç½®æ‰€æœ‰å®˜æ–¹å±žæ€§è‡ªå®šä¹‰å±žæ€§å€¼Spring Bootå…è®¸æˆ‘ä»¬åœ¨application.propertiesä¸‹è‡ªå®šä¹‰ä¸€äº›å±žæ€§ï¼Œæ¯”å¦‚ï¼š12mrbird.blog.name=mrbird's blogmrbird.blog.title=Spring Bootå®šä¹‰ä¸€ä¸ªBlogProperties Beanï¼Œé€šè¿‡@Value(&quot;${å±žæ€§å}&quot;)æ¥åŠ è½½é…ç½®æ–‡ä»¶ä¸­çš„å±žæ€§å€¼ï¼š1234567891011@Componentpublic class BlogProperties &#123; @Value("$&#123;mrbird.blog.name&#125;") private String name; @Value("$&#123;mrbird.blog.title&#125;") private String title; // get,setç•¥ &#125;ç¼–å†™IndexControllerï¼Œæ³¨å…¥è¯¥Beanï¼š12345678910@RestControllerpublic class IndexController &#123; @Autowired private BlogProperties blogProperties; @RequestMapping("/") String index() &#123; return blogProperties.getName()+"â€”â€”"+blogProperties.getTitle(); &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080ï¼Œé¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼šåœ¨å±žæ€§éžå¸¸å¤šçš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªå’Œé…ç½®æ–‡ä»¶å¯¹åº”çš„Beanï¼š123456@ConfigurationProperties(prefix="mrbird.blog")public class ConfigBean &#123; private String name; private String title; // get,setç•¥&#125;é€šè¿‡æ³¨è§£@ConfigurationProperties(prefix=&quot;mrbird.blog&quot;)æŒ‡æ˜Žäº†å±žæ€§çš„é€šç”¨å‰ç¼€ï¼Œé€šç”¨å‰ç¼€åŠ å±žæ€§åå’Œé…ç½®æ–‡ä»¶çš„å±žæ€§åä¸€ä¸€å¯¹åº”ã€‚é™¤æ­¤ä¹‹å¤–è¿˜éœ€åœ¨Spring Bootå…¥å£ç±»åŠ ä¸Šæ³¨è§£@EnableConfigurationProperties({ConfigBean.class})æ¥å¯ç”¨è¯¥é…ç½®ï¼š12345678@SpringBootApplication@EnableConfigurationProperties(&#123;ConfigBean.class&#125;)public class Application &#123; public static void main(String[] args) &#123; SpringApplication.run(Application.class, args); &#125;&#125;ä¹‹åŽä¾¿å¯åœ¨IndexControllerä¸­æ³¨å…¥è¯¥Beanï¼Œå¹¶ä½¿ç”¨äº†ï¼š12345678910@RestControllerpublic class IndexController &#123; @Autowired private ConfigBean configBean; @RequestMapping("/") String index() &#123; return configBean.getName()+"â€”â€”"+configBean.getTitle(); &#125;&#125;å±žæ€§é—´çš„å¼•ç”¨åœ¨application.propertiesé…ç½®æ–‡ä»¶ä¸­ï¼Œå„ä¸ªå±žæ€§å¯ä»¥ç›¸äº’å¼•ç”¨ï¼Œå¦‚ä¸‹ï¼š123mrbird.blog.name=mrbird&apos;s blogmrbird.blog.title=Spring Bootmrbird.blog.wholeTitle=$&#123;mrbird.blog.name&#125;--$&#123;mrbird.blog.title&#125;è‡ªå®šä¹‰é…ç½®æ–‡ä»¶é™¤äº†å¯ä»¥åœ¨application.propertiesé‡Œé…ç½®å±žæ€§ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚åœ¨src/main/resourcesç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªtest.properties:12test.name=KangKangtest.age=25å®šä¹‰ä¸€ä¸ªå¯¹åº”è¯¥é…ç½®æ–‡ä»¶çš„Beanï¼š123456789@Configuration@ConfigurationProperties(prefix="test")@PropertySource("classpath:test.properties")@Componentpublic class TestConfigBean &#123; private String name; private int age; // get,setç•¥&#125;æ³¨è§£@PropertySource(&quot;classpath:test.properties&quot;)æŒ‡æ˜Žäº†ä½¿ç”¨å“ªä¸ªé…ç½®æ–‡ä»¶ã€‚è¦ä½¿ç”¨è¯¥é…ç½®Beanï¼ŒåŒæ ·ä¹Ÿéœ€è¦åœ¨å…¥å£ç±»é‡Œä½¿ç”¨æ³¨è§£@EnableConfigurationProperties({TestConfigBean.class})æ¥å¯ç”¨è¯¥é…ç½®ã€‚é€šè¿‡å‘½ä»¤è¡Œè®¾ç½®å±žæ€§å€¼åœ¨è¿è¡ŒSpring Boot jaræ–‡ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤java -jar xxx.jar --server.port=8081æ¥æ”¹å˜ç«¯å£çš„å€¼ã€‚è¿™æ¡å‘½ä»¤ç­‰ä»·äºŽæˆ‘ä»¬æ‰‹åŠ¨åˆ°application.propertiesä¸­ä¿®æ”¹ï¼ˆå¦‚æžœæ²¡æœ‰è¿™æ¡å±žæ€§çš„è¯å°±æ·»åŠ ï¼‰server.portå±žæ€§çš„å€¼ä¸º8081ã€‚å¦‚æžœä¸æƒ³é¡¹ç›®çš„é…ç½®è¢«å‘½ä»¤è¡Œä¿®æ”¹ï¼Œå¯ä»¥åœ¨å…¥å£æ–‡ä»¶çš„mainæ–¹æ³•ä¸­è¿›è¡Œå¦‚ä¸‹è®¾ç½®ï¼š12345public static void main(String[] args) &#123; SpringApplication app = new SpringApplication(Application.class); app.setAddCommandLineProperties(false); app.run(args);&#125;ä½¿ç”¨xmlé…ç½®è™½ç„¶Spring Bootå¹¶ä¸æŽ¨èæˆ‘ä»¬ç»§ç»­ä½¿ç”¨xmlé…ç½®ï¼Œä½†å¦‚æžœå‡ºçŽ°ä¸å¾—ä¸ä½¿ç”¨xmlé…ç½®çš„æƒ…å†µï¼ŒSpring Bootå…è®¸æˆ‘ä»¬åœ¨å…¥å£ç±»é‡Œé€šè¿‡æ³¨è§£@ImportResource({&quot;classpath:some-application.xml&quot;})æ¥å¼•å…¥xmlé…ç½®æ–‡ä»¶ã€‚Profileé…ç½®Profileç”¨æ¥é’ˆå¯¹ä¸åŒçš„çŽ¯å¢ƒä¸‹ä½¿ç”¨ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼Œå¤šçŽ¯å¢ƒé…ç½®æ–‡ä»¶å¿…é¡»ä»¥application-{profile}.propertiesçš„æ ¼å¼å‘½ï¼Œå…¶ä¸­{profile}ä¸ºçŽ¯å¢ƒæ ‡è¯†ã€‚æ¯”å¦‚å®šä¹‰ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼šapplication-dev.propertiesï¼šå¼€å‘çŽ¯å¢ƒ1server.port=8080application-prod.propertiesï¼šç”Ÿäº§çŽ¯å¢ƒ1server.port=8081è‡³äºŽå“ªä¸ªå…·ä½“çš„é…ç½®æ–‡ä»¶ä¼šè¢«åŠ è½½ï¼Œéœ€è¦åœ¨application.propertiesæ–‡ä»¶ä¸­é€šè¿‡spring.profiles.activeå±žæ€§æ¥è®¾ç½®ï¼Œå…¶å€¼å¯¹åº”{profile}å€¼ã€‚å¦‚ï¼šspring.profiles.active=devå°±ä¼šåŠ è½½application-dev.propertiesé…ç½®æ–‡ä»¶å†…å®¹ã€‚å¯ä»¥åœ¨è¿è¡Œjaræ–‡ä»¶çš„æ—¶å€™ä½¿ç”¨å‘½ä»¤java -jar xxx.jar --spring.profiles.active={profile}åˆ‡æ¢ä¸åŒçš„çŽ¯å¢ƒé…ç½®ã€‚source code]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¼€å¯Spring Boot]]></title>
    <url>%2F%E5%BC%80%E5%90%AFSpring-Boot.html</url>
    <content type="text"><![CDATA[Spring Bootæ˜¯åœ¨Springæ¡†æž¶ä¸Šåˆ›å»ºçš„ä¸€ä¸ªå…¨æ–°çš„æ¡†æž¶ï¼Œå…¶è®¾è®¡ç›®çš„æ˜¯ç®€åŒ–Springåº”ç”¨çš„æ­å»ºå’Œå¼€å‘è¿‡ç¨‹ã€‚å¼€å¯Spring Bootæœ‰è®¸å¤šç§æ–¹æ³•å¯ä¾›é€‰æ‹©ï¼Œè¿™é‡Œä»…ä»‹ç»ä½¿ç”¨http://start.spring.io/æ¥æž„å»ºä¸€ä¸ªç®€å•çš„Spring Booté¡¹ç›®ã€‚ç”Ÿæˆé¡¹ç›®æ–‡ä»¶è®¿é—®http://start.spring.io/ï¼Œé¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼šè¿™é‡Œé€‰æ‹©ä»¥Mavenæž„å»ºï¼Œè¯­è¨€é€‰æ‹©Javaï¼ŒSpring Bootç‰ˆæœ¬ä¸º1.5.9ã€‚ç„¶åŽç‚¹å‡»Switch to the full versionï¼Œå¯çœ‹åˆ°æ›´å¤šçš„é…ç½®ä»¥åŠä¾èµ–é€‰æ‹©ï¼šåœ¨é¡¹ç›®ä¿¡æ¯é‡Œé€‰æ‹©ä»¥jaråŒ…çš„æ–¹å¼éƒ¨ç½²ï¼ŒJavaç‰ˆæœ¬ä¸º7ã€‚åœ¨é¡µé¢çš„ä¸‹æ–¹è¿˜å¯ä»¥é€‰æ‹©è¯¸å¤šçš„ä¾èµ–ï¼Œè¿™é‡Œä»…é€‰æ‹©webè¿›è¡Œæ¼”ç¤ºï¼šæœ€åŽç‚¹å‡»é¡µé¢çš„generate projectæŒ‰é’®ç”Ÿæˆé¡¹ç›®æ–‡ä»¶ã€‚æ–‡ä»¶ä¸‹è½½åŽæ˜¯ä¸€ä¸ªåŽ‹ç¼©åŒ…ï¼Œè¿›è¡Œè§£åŽ‹ç„¶åŽä½¿ç”¨eclipseä»¥Mavené¡¹ç›®çš„å½¢å¼å¯¼å…¥ã€‚å¯¼å…¥åŽeclipseä¼šè‡ªåŠ¨ç¼–è¯‘é¡¹ç›®å¹¶ä¸‹è½½ç›¸åº”çš„ä¾èµ–ï¼Œé¡¹ç›®ç›®å½•å¦‚ä¸‹æ‰€ç¤ºï¼šç®€å•æ¼”ç¤ºé¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ªartifactId+Applicationå‘½åè§„åˆ™çš„å…¥å£ç±»ï¼Œä¸ºäº†æ¼”ç¤ºç®€å•ï¼Œä¸å†æ–°å»ºæŽ§åˆ¶å™¨ï¼Œç›´æŽ¥åœ¨å…¥å£ç±»ä¸­ç¼–å†™ä»£ç ï¼š1234567891011121314151617181920package com.springboot.demo;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@SpringBootApplicationpublic class DemoApplication &#123; @RequestMapping("/") String index() &#123; return "hello spring boot"; &#125; public static void main(String[] args) &#123; SpringApplication.run(DemoApplication.class, args); &#125;&#125;ç„¶åŽå³é”®ç‚¹å‡»DemoApplictionï¼Œé€‰æ‹©run as â†’ Java Applicationï¼šè®¿é—®http://localhost:8080ï¼Œé¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼šæ‰“åŒ…å‘å¸ƒåœ¨eclipseä¸­å³å‡»é¡¹ç›®ï¼Œé€‰æ‹©run as â†’ Maven buildâ€¦ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šåœ¨Goalsä¸­è¾“å…¥clean packageå‘½ä»¤ï¼Œç„¶åŽç‚¹å‡»ä¸‹æ–¹çš„runå°±å°†é¡¹ç›®æ‰“åŒ…æˆjaråŒ…ï¼ˆåˆæ¬¡æ‰“åŒ…ä¼šè‡ªåŠ¨ä¸‹è½½ä¸€äº›ä¾èµ–ï¼‰ã€‚æ‰“åŒ…å®Œæ¯•åŽå¯çœ‹åˆ°é¡¹ç›®ç›®å½•targetæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆäº†ä¸€ä¸ªjaræ–‡ä»¶ï¼šç”ŸæˆjaråŒ…åŽï¼Œcdåˆ°targetç›®å½•ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼šè®¿é—®http://localhost:8080ï¼Œæ•ˆæžœå¦‚ä¸Šã€‚èŠèŠpom.xmlæ‰“å¼€pom.xmlå¯çœ‹åˆ°é…ç½®å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.springboot&lt;/groupId&gt; &lt;artifactId&gt;demo&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;name&gt;demo&lt;/name&gt; &lt;description&gt;Demo project for Spring Boot&lt;/description&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;1.5.9.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;java.version&gt;1.7&lt;/java.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;/project&gt;spring-boot-starter-parentspring-boot-starter-parentæŒ‡å®šäº†å½“å‰é¡¹ç›®ä¸ºä¸€ä¸ªSpring Booté¡¹ç›®ï¼Œå®ƒæä¾›äº†è¯¸å¤šçš„é»˜è®¤Mavenä¾èµ–ï¼Œå…·ä½“å¯æŸ¥çœ‹ç›®å½•D:\m2\repository\org\springframework\boot\spring-boot-dependencies\1.5.9.RELEASEä¸‹çš„spring-boot-dependencies-1.5.9.RELEASE.pomæ–‡ä»¶ï¼Œè¿™é‡Œä»…æˆªå–ä¸€å°éƒ¨åˆ†ï¼š1234567891011121314151617181920212223&lt;properties&gt;... &lt;spring-security.version&gt;4.2.3.RELEASE&lt;/spring-security.version&gt; &lt;spring-security-jwt.version&gt;1.0.8.RELEASE&lt;/spring-security-jwt.version&gt; &lt;spring-security-oauth.version&gt;2.0.14.RELEASE&lt;/spring-security-oauth.version&gt; &lt;spring-session.version&gt;1.3.1.RELEASE&lt;/spring-session.version&gt; &lt;spring-social.version&gt;1.1.4.RELEASE&lt;/spring-social.version&gt; &lt;spring-social-facebook.version&gt;2.0.3.RELEASE&lt;/spring-social-facebook.version&gt; &lt;spring-social-linkedin.version&gt;1.0.2.RELEASE&lt;/spring-social-linkedin.version&gt; &lt;spring-social-twitter.version&gt;1.1.2.RELEASE&lt;/spring-social-twitter.version&gt; &lt;spring-ws.version&gt;2.4.2.RELEASE&lt;/spring-ws.version&gt; &lt;sqlite-jdbc.version&gt;3.15.1&lt;/sqlite-jdbc.version&gt; &lt;statsd-client.version&gt;3.1.0&lt;/statsd-client.version&gt; &lt;sun-mail.version&gt;$&#123;javax-mail.version&#125;&lt;/sun-mail.version&gt; &lt;thymeleaf.version&gt;2.1.6.RELEASE&lt;/thymeleaf.version&gt; &lt;thymeleaf-extras-springsecurity4.version&gt;2.1.3.RELEASE&lt;/thymeleaf-extras-springsecurity4.version&gt; &lt;thymeleaf-extras-conditionalcomments.version&gt;2.1.2.RELEASE&lt;/thymeleaf-extras-conditionalcomments.version&gt; &lt;thymeleaf-layout-dialect.version&gt;1.4.0&lt;/thymeleaf-layout-dialect.version&gt; &lt;thymeleaf-extras-data-attribute.version&gt;1.3&lt;/thymeleaf-extras-data-attribute.version&gt; &lt;thymeleaf-extras-java8time.version&gt;2.1.0.RELEASE&lt;/thymeleaf-extras-java8time.version&gt; &lt;tomcat.version&gt;8.5.23&lt;/tomcat.version&gt;... &lt;/properties&gt;éœ€è¦è¯´æ˜Žçš„æ˜¯ï¼Œå¹¶éžæ‰€æœ‰åœ¨&lt;properties&gt;æ ‡ç­¾ä¸­é…ç½®äº†ç‰ˆæœ¬å·çš„ä¾èµ–éƒ½æœ‰è¢«å¯ç”¨ï¼Œå…¶å¯ç”¨ä¸Žå¦å–å†³äºŽæ‚¨æ˜¯å¦é…ç½®äº†ç›¸åº”çš„starterã€‚æ¯”å¦‚tomcatè¿™ä¸ªä¾èµ–å°±æ˜¯spring-boot-starter-webçš„ä¼ é€’æ€§ä¾èµ–ï¼ˆä¸‹é¢å°†ä¼šæè¿°åˆ°ï¼‰ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ”¹å˜è¿™äº›ä¾èµ–çš„ç‰ˆæœ¬ã€‚æ¯”å¦‚æˆ‘æƒ³æŠŠthymeleafçš„ç‰ˆæœ¬æ”¹ä¸º3.0.0.RELEASEï¼Œæˆ‘ä»¬å¯ä»¥åœ¨pom.xmlä¸­è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼š123&lt;properties&gt; &lt;thymeleaf.version&gt;3.0.0.RELEASE&lt;/thymeleaf.version&gt;&lt;/properties&gt;spring-boot-starter-webSpring Bootæä¾›äº†è®¸å¤šå¼€ç®±å³ç”¨çš„ä¾èµ–æ¨¡å—ï¼Œè¿™äº›æ¨¡å—éƒ½æ˜¯ä»¥spring-boot-starter-XXå‘½åçš„ã€‚æ¯”å¦‚è¦å¼€å¯Spring Bootçš„webåŠŸèƒ½ï¼Œåªéœ€è¦åœ¨pom.xmlä¸­é…ç½®spring-boot-starter-webå³å¯ï¼š1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;å› ä¸ºå…¶ä¾èµ–äºŽspring-boot-starter-parentï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ä¸ç”¨é…ç½®versionã€‚ä¿å­˜åŽMavenä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ä¸‹è½½spring-boot-starter-webæ¨¡å—æ‰€åŒ…å«çš„jaræ–‡ä»¶ã€‚å¦‚æžœéœ€è¦å…·ä½“æŸ¥çœ‹spring-boot-starter-webåŒ…å«äº†å“ªäº›ä¾èµ–ï¼Œæˆ‘ä»¬å¯ä»¥å³é”®é¡¹ç›®é€‰æ‹©run as â†’ Maven Buildâ€¦ï¼Œåœ¨Goalsä¸­è¾“å…¥å‘½ä»¤dependency:treeï¼Œç„¶åŽç‚¹å‡»runå³å¯åœ¨eclipseæŽ§åˆ¶å°æŸ¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š1234567891011121314151617181920212223242526272829[INFO] +- org.springframework.boot:spring-boot-starter-web:jar:1.5.9.RELEASE:compile[INFO] | +- org.springframework.boot:spring-boot-starter:jar:1.5.9.RELEASE:compile[INFO] | | +- org.springframework.boot:spring-boot:jar:1.5.9.RELEASE:compile[INFO] | | +- org.springframework.boot:spring-boot-autoconfigure:jar:1.5.9.RELEASE:compile[INFO] | | +- org.springframework.boot:spring-boot-starter-logging:jar:1.5.9.RELEASE:compile[INFO] | | | +- ch.qos.logback:logback-classic:jar:1.1.11:compile[INFO] | | | | \- ch.qos.logback:logback-core:jar:1.1.11:compile[INFO] | | | +- org.slf4j:jcl-over-slf4j:jar:1.7.25:compile[INFO] | | | +- org.slf4j:jul-to-slf4j:jar:1.7.25:compile[INFO] | | | \- org.slf4j:log4j-over-slf4j:jar:1.7.25:compile[INFO] | | \- org.yaml:snakeyaml:jar:1.17:runtime[INFO] | +- org.springframework.boot:spring-boot-starter-tomcat:jar:1.5.9.RELEASE:compile[INFO] | | +- org.apache.tomcat.embed:tomcat-embed-core:jar:8.5.23:compile[INFO] | | | \- org.apache.tomcat:tomcat-annotations-api:jar:8.5.23:compile[INFO] | | +- org.apache.tomcat.embed:tomcat-embed-el:jar:8.5.23:compile[INFO] | | \- org.apache.tomcat.embed:tomcat-embed-websocket:jar:8.5.23:compile[INFO] | +- org.hibernate:hibernate-validator:jar:5.3.6.Final:compile[INFO] | | +- javax.validation:validation-api:jar:1.1.0.Final:compile[INFO] | | +- org.jboss.logging:jboss-logging:jar:3.3.1.Final:compile[INFO] | | \- com.fasterxml:classmate:jar:1.3.4:compile[INFO] | +- com.fasterxml.jackson.core:jackson-databind:jar:2.8.10:compile[INFO] | | +- com.fasterxml.jackson.core:jackson-annotations:jar:2.8.0:compile[INFO] | | \- com.fasterxml.jackson.core:jackson-core:jar:2.8.10:compile[INFO] | +- org.springframework:spring-web:jar:4.3.13.RELEASE:compile[INFO] | | +- org.springframework:spring-aop:jar:4.3.13.RELEASE:compile[INFO] | | +- org.springframework:spring-beans:jar:4.3.13.RELEASE:compile[INFO] | | \- org.springframework:spring-context:jar:4.3.13.RELEASE:compile[INFO] | \- org.springframework:spring-webmvc:jar:4.3.13.RELEASE:compile[INFO] | \- org.springframework:spring-expression:jar:4.3.13.RELEASE:compileä¸Šè¿°è¿™äº›ä¾èµ–éƒ½æ˜¯éšå¼ä¾èµ–äºŽspring-boot-starter-webï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨æŽ’é™¤ä¸€äº›æˆ‘ä»¬ä¸éœ€è¦çš„ä¾èµ–ã€‚æ¯”å¦‚spring-boot-starter-webé»˜è®¤é›†æˆäº†tomcatï¼Œå‡å¦‚æˆ‘ä»¬æƒ³æŠŠå®ƒæ¢ä¸ºjettyï¼Œå¯ä»¥åœ¨pom.xmlä¸­spring-boot-starter-webä¸‹æŽ’é™¤tomcatä¾èµ–ï¼Œç„¶åŽæ‰‹åŠ¨å¼•å…¥jettyä¾èµ–ï¼š1234567891011121314151617&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;tipsï¼šä¾èµ–çš„åæ ‡å¯ä»¥åˆ°ä¸Šè¿°çš„spring-boot-dependencies-1.5.9.RELEASE.pomæ–‡ä»¶é‡ŒæŸ¥æ‰¾ã€‚å†æ¬¡è¿è¡Œdependency:treeï¼š123456789101112131415161718192021222324252627282930[INFO] +- org.springframework.boot:spring-boot-starter-web:jar:1.5.9.RELEASE:compile...[INFO] +- org.springframework.boot:spring-boot-starter-jetty:jar:1.5.9.RELEASE:compile[INFO] | +- org.eclipse.jetty:jetty-servlets:jar:9.4.7.v20170914:compile[INFO] | | +- org.eclipse.jetty:jetty-continuation:jar:9.4.7.v20170914:compile[INFO] | | +- org.eclipse.jetty:jetty-http:jar:9.4.7.v20170914:compile[INFO] | | +- org.eclipse.jetty:jetty-util:jar:9.4.7.v20170914:compile[INFO] | | \- org.eclipse.jetty:jetty-io:jar:9.4.7.v20170914:compile[INFO] | +- org.eclipse.jetty:jetty-webapp:jar:9.4.7.v20170914:compile[INFO] | | +- org.eclipse.jetty:jetty-xml:jar:9.4.7.v20170914:compile[INFO] | | \- org.eclipse.jetty:jetty-servlet:jar:9.4.7.v20170914:compile[INFO] | | \- org.eclipse.jetty:jetty-security:jar:9.4.7.v20170914:compile[INFO] | | \- org.eclipse.jetty:jetty-server:jar:9.4.7.v20170914:compile[INFO] | +- org.eclipse.jetty.websocket:websocket-server:jar:9.4.7.v20170914:compile[INFO] | | +- org.eclipse.jetty.websocket:websocket-common:jar:9.4.7.v20170914:compile[INFO] | | | \- org.eclipse.jetty.websocket:websocket-api:jar:9.4.7.v20170914:compile[INFO] | | +- org.eclipse.jetty.websocket:websocket-client:jar:9.4.7.v20170914:compile[INFO] | | | \- org.eclipse.jetty:jetty-client:jar:9.4.7.v20170914:compile[INFO] | | \- org.eclipse.jetty.websocket:websocket-servlet:jar:9.4.7.v20170914:compile[INFO] | | \- javax.servlet:javax.servlet-api:jar:3.1.0:compile[INFO] | +- org.eclipse.jetty.websocket:javax-websocket-server-impl:jar:9.4.7.v20170914:compile[INFO] | | +- org.eclipse.jetty:jetty-annotations:jar:9.4.7.v20170914:compile[INFO] | | | +- org.eclipse.jetty:jetty-plus:jar:9.4.7.v20170914:compile[INFO] | | | +- javax.annotation:javax.annotation-api:jar:1.2:compile[INFO] | | | +- org.ow2.asm:asm:jar:5.1:compile[INFO] | | | \- org.ow2.asm:asm-commons:jar:5.1:compile[INFO] | | | \- org.ow2.asm:asm-tree:jar:5.1:compile[INFO] | | +- org.eclipse.jetty.websocket:javax-websocket-client-impl:jar:9.4.7.v20170914:compile[INFO] | | \- javax.websocket:javax.websocket-api:jar:1.0:compile[INFO] | \- org.mortbay.jasper:apache-el:jar:8.0.33:compileå¯çœ‹åˆ°tomcatå·²è¢«æ›¿æ¢ä¸ºäº†jettyã€‚spring-boot-maven-pluginspring-boot-maven-pluginä¸ºSpring Boot Mavenæ’ä»¶ï¼Œæä¾›äº†ï¼šæŠŠé¡¹ç›®æ‰“åŒ…æˆä¸€ä¸ªå¯æ‰§è¡Œçš„è¶…çº§JARï¼ˆuber-JARï¼‰,åŒ…æ‹¬æŠŠåº”ç”¨ç¨‹åºçš„æ‰€æœ‰ä¾èµ–æ‰“å…¥JARæ–‡ä»¶å†…ï¼Œå¹¶ä¸ºJARæ·»åŠ ä¸€ä¸ªæè¿°æ–‡ä»¶ï¼Œå…¶ä¸­çš„å†…å®¹èƒ½è®©ä½ ç”¨java -jaræ¥è¿è¡Œåº”ç”¨ç¨‹åºã€‚æœç´¢public static void main()æ–¹æ³•æ¥æ ‡è®°ä¸ºå¯è¿è¡Œç±»ã€‚]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring+Thymeleaf3å›½é™…åŒ–]]></title>
    <url>%2FSpring-Tymeleaf3%E5%9B%BD%E9%99%85%E5%8C%96.html</url>
    <content type="text"><![CDATA[Spring+Thymeleaf3å›½é™…åŒ–é…ç½®å›½é™…åŒ–è¿‡ç¨‹å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨src/main/resourcesè·¯å¾„ä¸‹å®šä¹‰ä¸åŒè¯­è¨€çŽ¯å¢ƒçš„é…ç½®æ–‡ä»¶å°±å¥½äº†ï¼Œé…ç½®æ–‡ä»¶éœ€ä»¥messageå¼€å¤´ï¼ŒåŠ ä¸Šè¯­è¨€ç¼©å†™åŽç¼€ã€‚æ¯”å¦‚å®šä¹‰ä¸€ä¸ªè‹±æ–‡é…ç½®ï¼šsrc/main/resources/message_en.propertiesï¼›ä¸­æ–‡çŽ¯å¢ƒï¼šsrc/main/resources/message_zh_CN.propertiesï¼›é»˜è®¤é…ç½®ï¼ˆå°±æ˜¯éƒ½æ²¡åŒ¹é…ä¸Šçš„æ—¶å€™é‡‡ç”¨ï¼‰ï¼šsrc/main/resources/message.propertiesã€‚å®šä¹‰ä¸€ä¸ªç®€å•çš„HTMLé¡µé¢ç”¨äºŽæµ‹è¯•ï¼š12345678910&lt;!DOCTYPE html&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;title&gt;home&lt;/title&gt; &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;&lt;/head&gt;&lt;body&gt; &lt;p data-th-utext="#&#123;home.welcome&#125;"&gt;home&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;å…¶ä¸­message_en.propertiesé…ç½®å¦‚ä¸‹ï¼š1home.welcome=This is &lt;b&gt;home&lt;/b&gt; page.ä¸­æ–‡çŽ¯å¢ƒé…ç½®message_zh_CN.propertiesï¼š1home.welcome=\u4F60\u597D\uFF0C\u8FD9\u662F&lt;b&gt;\u4E3B\u9875&lt;/b&gt;å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®è¯¥é¡µé¢ï¼šå°†æµè§ˆå™¨çš„è¯­è¨€çŽ¯å¢ƒè®¾ç½®ä¸ºè‹±æ–‡ï¼šåˆ·æ–°é¡µé¢å¦‚ä¸‹ï¼šæœ‰äº›ç‰ˆæœ¬å¯èƒ½éœ€è¦æ‰‹åŠ¨é…ç½®MessageConfigurationï¼š1234567891011121314151617import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.context.support.ResourceBundleMessageSource;@Configurationpublic class I18nConfiguration &#123; @Bean public ResourceBundleMessageSource messageSource()&#123; ResourceBundleMessageSource messageSource = new ResourceBundleMessageSource(); messageSource.setUseCodeAsDefaultMessage(true); messageSource.setFallbackToSystemLocale(false); messageSource.setBasenames("message"); messageSource.setDefaultEncoding("UTF-8"); messageSource.setCacheSeconds(2); return messageSource; &#125;&#125;æˆ‘ä»¬è¿˜å¯ä»¥åœ¨propertiesæ–‡ä»¶ä¸­ä½¿ç”¨å ä½ç¬¦ï¼š1home.welcome=hello,&#123;0&#125;é¡µé¢ï¼š1&lt;p data-th-utext="#&#123;home.welcome($&#123;user.name&#125;)&#125;"&gt;home&lt;/p&gt;]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Thymeleaf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring4ä¸­é…ç½®Thymeleaf3è§†å›¾]]></title>
    <url>%2FSpring4%E4%B8%AD%E9%85%8D%E7%BD%AEThymeleaf3%E8%A7%86%E5%9B%BE.html</url>
    <content type="text"><![CDATA[å¼•å…¥å¿…è¦çš„ä¾èµ–æ–‡ä»¶ï¼š123456&lt;!-- https://mvnrepository.com/artifact/org.thymeleaf/thymeleaf-spring4 --&gt;&lt;dependency&gt; &lt;groupId&gt;org.thymeleaf&lt;/groupId&gt; &lt;artifactId&gt;thymeleaf-spring4&lt;/artifactId&gt; &lt;version&gt;3.0.6.RELEASE&lt;/version&gt;&lt;/dependency&gt;é…ç½®Thymeleafè¯•å›¾è§£æžå™¨ï¼š1234567891011121314151617&lt;!-- Thymeleafè§†å›¾è§£æžå™¨ --&gt;&lt;bean id="viewResolver" class="org.thymeleaf.spring4.view.ThymeleafViewResolver" p:templateEngine-ref="templateEngine" p:characterEncoding="UTF-8" /&gt;&lt;!-- æ¨¡æ¿å¼•æ“Ž --&gt;&lt;bean id="templateEngine" class="org.thymeleaf.spring4.SpringTemplateEngine" p:templateResolver-ref="templateResolver" /&gt;&lt;!-- æ¨¡æ¿è§£æžå™¨ --&gt; &lt;bean id="templateResolver" class="org.thymeleaf.templateresolver.ServletContextTemplateResolver" p:prefix="/WEB-INF/templates/" p:suffix=".html" p:templateMode="HTML5" p:cacheable="false" p:characterEncoding="UTF-8"/&gt;]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Thymeleaf</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring4é…ç½®å¤šæ•°æ®æº]]></title>
    <url>%2FSpring4%E9%85%8D%E7%BD%AE%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90.html</url>
    <content type="text"><![CDATA[Springåœ¨æ¯æ¬¡æ“ä½œæ•°æ®åº“çš„æ—¶å€™éƒ½ä¼šé€šè¿‡AbstractRoutingDataSourceç±»ä¸­çš„determineTargetDataSource()æ–¹æ³•èŽ·å–å½“å‰æ•°æ®æºï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ç»§æ‰¿AbstractRoutingDataSourceå¹¶é‡å†™determineTargetDataSource()æ–¹æ³•æ¥å®žçŽ°å¤šæ•°æ®æºçš„é…ç½®ã€‚å®šä¹‰ä¸€ä¸ªDynamicDataSourceç±»ï¼Œç»§æ‰¿AbstractRoutingDataSourceï¼š123456789package cc.mrbird.datasource;import org.springframework.jdbc.datasource.lookup.AbstractRoutingDataSource;public class DynamicDataSource extends AbstractRoutingDataSource &#123; @Override protected Object determineCurrentLookupKey() &#123; return DatabaseContextHolder.getCustomerType(); &#125; &#125;å…¶ä¸­DatabaseContextHolderç”¨äºŽä¿å­˜å½“å‰ä½¿ç”¨çš„æ•°æ®åº“åç§°ï¼š1234567891011121314151617package cc.mrbird.datasource;public class DatabaseContextHolder &#123; private static final ThreadLocal&lt;String&gt; contextHolder = new ThreadLocal&lt;String&gt;(); public static void setCustomerType(String customerType) &#123; contextHolder.set(customerType); &#125; public static String getCustomerType() &#123; return contextHolder.get(); &#125; public static void clearCustomerType() &#123; contextHolder.remove(); &#125; &#125;å®šä¹‰ä¸€ä¸ªæ•°æ®åº“åå¸¸é‡ç±»ï¼š1234567package cc.mrbird.datasource;public class DataSourceConst &#123; public static final String DB1 = "dataSource1"; public static final String DB2 = "dataSource2"; &#125;dataSource1å’ŒdataSource2ä¸ºåœ¨Springä¸Šä¸‹æ–‡é…ç½®æ–‡ä»¶applicationContext.xmlä¸­é…ç½®çš„ä¸¤ä¸ªæ•°æ®æºï¼š123456789101112131415161718192021222324252627&lt;bean id="dataSource1" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt; &lt;property name="driverClass" value="oracle.jdbc.driver.OracleDriver" /&gt; &lt;property name="jdbcUrl" value="jdbc:oracle:thin:@192.168.140.139:1521:orcl"&gt;&lt;/property&gt; &lt;property name="user" value="test"&gt;&lt;/property&gt; &lt;property name="password" value="test_123"&gt;&lt;/property&gt; &lt;property name="maxPoolSize" value="150" /&gt; &lt;property name="minPoolSize" value="5" /&gt; &lt;property name="initialPoolSize" value="10" /&gt; &lt;property name="maxIdleTime" value="60" /&gt; &lt;property name="acquireIncrement" value="3" /&gt; &lt;property name="maxStatements" value="0" /&gt; &lt;property name="idleConnectionTestPeriod" value="60" /&gt;&lt;/bean&gt; &lt;bean id="dataSource2" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt; &lt;property name="driverClass" value="oracle.jdbc.driver.OracleDriver" /&gt; &lt;property name="jdbcUrl" value="jdbc:oracle:thin:@192.168.140.148:1521:PISDATA"&gt;&lt;/property&gt; &lt;property name="user" value="test"&gt;&lt;/property&gt; &lt;property name="password" value="test_456"&gt;&lt;/property&gt; &lt;property name="maxPoolSize" value="150" /&gt; &lt;property name="minPoolSize" value="5" /&gt; &lt;property name="initialPoolSize" value="10" /&gt; &lt;property name="maxIdleTime" value="60" /&gt; &lt;property name="acquireIncrement" value="3" /&gt; &lt;property name="maxStatements" value="0" /&gt; &lt;property name="idleConnectionTestPeriod" value="60" /&gt;&lt;/bean&gt;æŽ¥ç€é…ç½®åŠ¨æ€æ•°æ®æºï¼Œç±»åž‹ä¸ºä¸Šé¢å®šä¹‰çš„DynamicDataSourceç±»ï¼š123456789&lt;bean id="dynamicDataSource" class="cc.mrbird.datasource.DynamicDataSource"&gt; &lt;property name="targetDataSources"&gt; &lt;map key-type="java.lang.String"&gt; &lt;entry value-ref="dataSource1" key="dataSource1"&gt;&lt;/entry&gt; &lt;entry value-ref="dataSource2" key="dataSource2"&gt;&lt;/entry&gt; &lt;/map&gt; &lt;/property&gt; &lt;property name="defaultTargetDataSource" ref="dataSource1" /&gt; &lt;/bean&gt;é»˜è®¤çš„æ•°æ®æºä¸ºdataSource1ã€‚æµ‹è¯•ä½¿ç”¨Springæä¾›çš„jdbcTemplateè¿›è¡Œæµ‹è¯•ï¼Œå®Œæ•´çš„applicationContext.xmlé…ç½®å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:p="http://www.springframework.org/schema/p" xmlns:task="http://www.springframework.org/schema/task" xsi:schemaLocation=" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.3.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.3.xsd http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-4.3.xsd" default-autowire="byName" &gt; &lt;!-- å¼€å¯ç»„ä»¶æ‰«æ --&gt; &lt;context:component-scan base-package="cc.mrbird"/&gt; &lt;bean id="dataSource1" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt; &lt;property name="driverClass" value="oracle.jdbc.driver.OracleDriver" /&gt; &lt;property name="jdbcUrl" value="jdbc:oracle:thin:@192.168.140.139:1521:orcl"&gt;&lt;/property&gt; &lt;property name="user" value="test"&gt;&lt;/property&gt; &lt;property name="password" value="test_123"&gt;&lt;/property&gt; &lt;property name="maxPoolSize" value="150" /&gt; &lt;property name="minPoolSize" value="5" /&gt; &lt;property name="initialPoolSize" value="10" /&gt; &lt;property name="maxIdleTime" value="60" /&gt; &lt;property name="acquireIncrement" value="3" /&gt; &lt;property name="maxStatements" value="0" /&gt; &lt;property name="idleConnectionTestPeriod" value="60" /&gt; &lt;/bean&gt; &lt;bean id="dataSource2" class="com.mchange.v2.c3p0.ComboPooledDataSource"&gt; &lt;property name="driverClass" value="oracle.jdbc.driver.OracleDriver" /&gt; &lt;property name="jdbcUrl" value="jdbc:oracle:thin:@192.168.140.148:1521:PISDATA"&gt;&lt;/property&gt; &lt;property name="user" value="test"&gt;&lt;/property&gt; &lt;property name="password" value="test_456"&gt;&lt;/property&gt; &lt;property name="maxPoolSize" value="150" /&gt; &lt;property name="minPoolSize" value="5" /&gt; &lt;property name="initialPoolSize" value="10" /&gt; &lt;property name="maxIdleTime" value="60" /&gt; &lt;property name="acquireIncrement" value="3" /&gt; &lt;property name="maxStatements" value="0" /&gt; &lt;property name="idleConnectionTestPeriod" value="60" /&gt; &lt;/bean&gt; &lt;bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate" abstract="false" lazy-init="false" autowire="default"&gt; &lt;property name="dataSource"&gt; &lt;ref bean="dynamicDataSource" /&gt; &lt;/property&gt; &lt;/bean&gt; &lt;bean id="dynamicDataSource" class="cc.mrbird.datasource.DynamicDataSource"&gt; &lt;property name="targetDataSources"&gt; &lt;map key-type="java.lang.String"&gt; &lt;entry value-ref="dataSource1" key="dataSource1"&gt;&lt;/entry&gt; &lt;entry value-ref="dataSource2" key="dataSource2"&gt;&lt;/entry&gt; &lt;/map&gt; &lt;/property&gt; &lt;property name="defaultTargetDataSource" ref="dataSource1"/&gt; &lt;/bean&gt; &lt;!-- äº‹ç‰©æ³¨è§£å¼€å¯ --&gt; &lt;bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt; &lt;property name="dataSource" ref="dynamicDataSource" /&gt; &lt;/bean&gt; &lt;tx:annotation-driven transaction-manager="transactionManager" proxy-target-class="true"/&gt;&lt;/beans&gt;ç¼–å†™TestDynamicDataSourceDaoæŽ¥å£ï¼š123456package cc.mrbird.dao;public interface TestDynamicDataSourceDao &#123; String getDataSource1Name(); String getDataSource2Name();&#125;å…¶å®žçŽ°ç±»ï¼š123456789101112131415161718192021222324252627282930313233343536373839package cc.mrbird.dao.impl;import org.springframework.jdbc.core.support.JdbcDaoSupport;import org.springframework.stereotype.Repository;import cc.mrbird.dao.TestDynamicDataSourceDao;import cc.mrbird.datasource.DataSourceConst;import cc.mrbird.datasource.DatabaseContextHolder;@Repository("testDynamicDataSourceDao")public class TestDynamicDataSourceDaoImpl extends JdbcDaoSupport implements TestDynamicDataSourceDao&#123; public String getDataSource1Name() &#123; String sql = ""; try &#123; sql = "select SYS_CONTEXT('USERENV','INSTANCE_NAME') from dual"; return this.getJdbcTemplate().queryForObject(sql, String.class); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return null; &#125; public String getDataSource2Name() &#123; String sql = ""; try &#123; // åˆ‡æ¢åˆ°æ•°æ®æºdatasource2 DatabaseContextHolder.setCustomerType(DataSourceConst.DB2); sql = "select SYS_CONTEXT('USERENV','INSTANCE_NAME') from dual"; return this.getJdbcTemplate().queryForObject(sql, String.class); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; // æ¢å¤åˆ°é»˜è®¤æ•°æ®æºdatasource1 DatabaseContextHolder.clearCustomerType(); &#125; return null; &#125;&#125;ç¼–å†™ServiceæŽ¥å£åŠå…¶å®žçŽ°ç±»ï¼š1234567package cc.mrbird.service;public interface TestDynamicDataSourceService &#123; String getDataSource1Name(); String getDataSource2Name();&#125;12345678910111213141516171819202122package cc.mrbird.service.impl;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import cc.mrbird.dao.TestDynamicDataSourceDao;import cc.mrbird.service.TestDynamicDataSourceService;@Service("testDynamicDataSourceService")public class TestDynamicDataSourceServiceImpl implements TestDynamicDataSourceService&#123; @Autowired private TestDynamicDataSourceDao dao; public String getDataSource1Name() &#123; return dao.getDataSource1Name(); &#125; public String getDataSource2Name() &#123; return dao.getDataSource2Name(); &#125;&#125;åœ¨æŽ§åˆ¶å™¨ä¸­æµ‹è¯•ï¼š123456789101112131415161718192021222324package cc.mrbird.controller;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.web.bind.annotation.RequestMapping;import cc.mrbird.service.TestDynamicDataSourceService;@Controllerpublic class IndexController &#123; @Autowired private TestDynamicDataSourceService service; @RequestMapping("/test") public void test()&#123; String dataSource1Name = service.getDataSource1Name(); String dataSource2Name = service.getDataSource2Name(); System.out.println(dataSource1Name); System.out.println(dataSource2Name); &#125;&#125;é¡µé¢è®¿é—®/testè·¯å¾„ï¼ŒæŽ§åˆ¶å°è¾“å‡ºï¼š12orclpisdataæ€»ç»“é…ç½®JdbcTemplateå¤šæ•°æ®æºçš„æ ¸å¿ƒåœ¨äºŽåˆå§‹åŒ–JdbcTemplateçš„æ—¶å€™æ•°æ®æºé…ç½®ä¸ºåŠ¨æ€æ•°æ®æºï¼Œå°±å¦‚xmlé…ç½®çš„é‚£æ ·ï¼š123456&lt;bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate" abstract="false" lazy-init="false" autowire="default"&gt; &lt;property name="dataSource"&gt; &lt;ref bean="dynamicDataSource" /&gt; &lt;/property&gt;&lt;/bean&gt;å‡å¦‚ä½¿ç”¨çš„æ˜¯MyBatisï¼Œåˆ™åªéœ€è¦åœ¨é…ç½®sqlSessionFactoryçš„æ—¶å€™æŒ‡å®šæ•°æ®æºä¸ºåŠ¨æ€æ•°æ®æºå³å¯ï¼š1234&lt;bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean" scope="prototype"&gt; &lt;property name="dataSource" ref="dataSource"/&gt; &lt;property name="configLocation" value="classpath:mybatis-config.xml"/&gt;&lt;/bean&gt;]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Springä¸­ä½¿ç”¨@Scheduledæ³¨è§£ä»»åŠ¡è°ƒåº¦]]></title>
    <url>%2FSpring%E4%B8%AD%E4%BD%BF%E7%94%A8-Scheduled%E6%B3%A8%E8%A7%A3%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6.html</url>
    <content type="text"><![CDATA[spring-contextåŒ…é‡Œæä¾›çš„@Scheduledæ³¨è§£å¯ä»¥å¾ˆæ–¹ä¾¿çš„å®žçŽ°å®šæ—¶ä»»åŠ¡ï¼Œåœ¨å¼•å…¥spring-contextä¾èµ–åŽï¼Œåœ¨Spring xmlnsä¸­åŠ å…¥ï¼š1xmlns:task="http://www.springframework.org/schema/task"ç„¶åŽåœ¨xsi:schemaLocationä¸­åŠ å…¥ï¼š12http://www.springframework.org/schema/taskhttp://www.springframework.org/schema/task/spring-task-4.3.xsdå®šä¹‰ä¸€ä¸ªç±»ï¼ŒåŒ…å«å®šæ—¶æ‰§è¡Œçš„æ–¹æ³•ï¼š12345678910111213141516package cc.mrbird.timer;import java.text.SimpleDateFormat;import java.util.Date;import org.springframework.scheduling.annotation.Scheduled;import org.springframework.stereotype.Component;@Componentpublic class Timer &#123; @Scheduled(cron="0/5 * * * * ?") public void test()&#123; System.out.println("SimpleJob,triggered is "+ new SimpleDateFormat("HH:mm:ss").format((new Date()))); &#125;&#125;Timerç±»ç”¨@Componentæ³¨è§£æ ‡æ³¨ï¼Œä»¥çº³å…¥Springå®¹å™¨ä¸­ã€‚å®šæ—¶è°ƒç”¨çš„æ–¹æ³•ä½¿ç”¨@Scheduledæ ‡å¿—ï¼Œå¹¶ç”¨cronè¡¨è¾¾å¼å®šä¹‰äº†å®šæ—¶æ‰§è¡Œçš„è§„åˆ™ã€‚ æŽ¥ä¸‹æ¥åœ¨Springä¸Šä¸‹æ–‡é…ç½®ä¸­å¯åŠ¨æ‰«æï¼ŒåŠ è½½å®šæ—¶å™¨ï¼š1234&lt;!-- å¼€å¯ç»„ä»¶æ‰«æ --&gt;&lt;context:component-scan base-package="cc.mrbird"/&gt;&lt;!-- spring å®šæ—¶å™¨ åŠ è½½ --&gt;&lt;task:annotation-driven /&gt;å¯åŠ¨é¡¹ç›®ï¼Œè¾“å‡ºï¼š12345678910111213SimpleJob,triggered is 14:33:10SimpleJob,triggered is 14:33:15SimpleJob,triggered is 14:33:20SimpleJob,triggered is 14:33:25SimpleJob,triggered is 14:33:30SimpleJob,triggered is 14:33:35SimpleJob,triggered is 14:33:40SimpleJob,triggered is 14:33:45SimpleJob,triggered is 14:33:50SimpleJob,triggered is 14:33:55SimpleJob,triggered is 14:34:00SimpleJob,triggered is 14:34:05...]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring4ä¸­ä½¿ç”¨Quartz]]></title>
    <url>%2FSpring4%E4%B8%AD%E4%BD%BF%E7%94%A8Quartz.html</url>
    <content type="text"><![CDATA[Springæä¾›äº†å‡ ä¸ªç±»ç”¨äºŽç®€åŒ–åœ¨Springä¸­ä½¿ç”¨Quartzä»»åŠ¡è°ƒåº¦ã€‚è¿™é‡Œä½¿ç”¨çš„Springç‰ˆæœ¬ä¸º4.3.5ï¼ŒQuartzç‰ˆæœ¬ä¸º2.2.1ã€‚é™¤äº†æ­å»ºSpring MVCçš„å‡ ä¸ªä¾èµ–å¤–ï¼Œè¿˜éœ€å¼•å…¥ï¼š123456789101112131415&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-tx&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt; &lt;artifactId&gt;quartz&lt;/artifactId&gt; &lt;version&gt;2.2.1&lt;/version&gt;&lt;/dependency&gt;åœ¨Quartz Schedulerä¸­é…ç½®Jobæ–°å»ºä¸€ä¸ªquartz-context.xmlï¼Œç”¨äºŽé…ç½®Jobï¼Œè§¦å‘å™¨ç­‰ä¿¡æ¯ã€‚é€šå¸¸ä½¿ç”¨MethodInvokingJobDetailFactoryBeanæ¥é…ç½®Jobï¼š1234&lt;bean id="simpleJobDetail" class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean"&gt; &lt;property name="targetObject" ref="simpleJob" /&gt; &lt;property name="targetMethod" value="printMessage" /&gt;&lt;/bean&gt;targetObjectåˆ¶å®šè°ƒç”¨çš„Beanï¼ŒtargetMethodæŒ‡å®šè°ƒç”¨çš„æ–¹æ³•ã€‚simpleJob Beanå¦‚ä¸‹ï¼š123456789101112import java.text.SimpleDateFormat;import java.util.Date;import org.springframework.stereotype.Component;@Component("simpleJob")public class SimpleJob &#123; public void printMessage() &#123; System.out.println("SimpleJob,triggered is "+ new SimpleDateFormat("HH:mm:ss").format((new Date()))); &#125;&#125;åœ¨Quartz Schedulerä¸­é…ç½®è§¦å‘è§„åˆ™ä¸¤ç§æ–¹å¼é…ç½®è§¦å‘è§„åˆ™ï¼šSimpleTrigger12345&lt;bean id="simpleTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean"&gt; &lt;property name="jobDetail" ref="simpleJobDetail" /&gt; &lt;property name="startDelay" value="1000" /&gt; &lt;property name="repeatInterval" value="2000" /&gt;&lt;/bean&gt;CronTrigger1234&lt;bean id="cronTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean"&gt; &lt;property name="jobDetail" ref="simpleJobDetail" /&gt; &lt;property name="cronExpression" value="0/5 * * * * ?" /&gt;&lt;/bean&gt;é…ç½®SchedulerFactoryBeanä½¿ç”¨SchedulerFactoryBeanå°†jobDetailså’Œtriggersé…ç½®åœ¨ä¸€èµ·ï¼š12345678910111213&lt;bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean"&gt; &lt;property name="jobDetails"&gt; &lt;list&gt; &lt;ref bean="simpleJobDetail" /&gt; &lt;/list&gt; &lt;/property&gt; &lt;property name="triggers"&gt; &lt;list&gt; &lt;ref bean="simpleTrigger" /&gt; &lt;/list&gt; &lt;/property&gt;&lt;/bean&gt;å®Œæ•´çš„quartz-context.xmlé…ç½®å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd"&gt; &lt;context:component-scan base-package="cc.mrbird.scheduling" /&gt; &lt;bean id="simpleJobDetail" class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean"&gt; &lt;property name="targetObject" ref="simpleJob" /&gt; &lt;property name="targetMethod" value="printMessage" /&gt; &lt;/bean&gt; &lt;!-- &lt;bean id="simpleTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean"&gt; --&gt;&lt;!-- &lt;property name="jobDetail" ref="simpleJobDetail" /&gt; --&gt;&lt;!-- &lt;property name="startDelay" value="1000" /&gt; --&gt;&lt;!-- &lt;property name="repeatInterval" value="2000" /&gt; --&gt;&lt;!-- &lt;/bean&gt; --&gt; &lt;bean id="cronTrigger" class="org.springframework.scheduling.quartz.CronTriggerFactoryBean"&gt; &lt;property name="jobDetail" ref="simpleJobDetail" /&gt; &lt;property name="cronExpression" value="0/5 * * * * ?" /&gt; &lt;/bean&gt; &lt;bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean"&gt; &lt;property name="jobDetails"&gt; &lt;list&gt; &lt;ref bean="simpleJobDetail" /&gt; &lt;/list&gt; &lt;/property&gt; &lt;property name="triggers"&gt; &lt;list&gt; &lt;ref bean="cronTrigger" /&gt; &lt;/list&gt; &lt;/property&gt; &lt;/bean&gt; &lt;/beans&gt;åœ¨web.xmlä¸­åŠ å…¥quartz-context.xmlå¯åŠ¨é¡¹ï¼š123456...&lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:applicationContext.xml,classpath:quartz-context.xml&lt;/param-value&gt;&lt;/init-param&gt;...éƒ¨ç½²é¡¹ç›®ï¼Œå¯åŠ¨åŽæŽ§åˆ¶å°è¾“å‡ºï¼š123456789101112131415SimpleJob,triggered is 17:43:35SimpleJob,triggered is 17:43:40SimpleJob,triggered is 17:43:45SimpleJob,triggered is 17:43:50SimpleJob,triggered is 17:43:55SimpleJob,triggered is 17:44:00SimpleJob,triggered is 17:44:05SimpleJob,triggered is 17:44:10SimpleJob,triggered is 17:44:15SimpleJob,triggered is 17:44:20SimpleJob,triggered is 17:44:25SimpleJob,triggered is 17:44:30SimpleJob,triggered is 17:44:35SimpleJob,triggered is 17:44:40...å‚è€ƒè‡ªhttp://websystique.com/spring/spring-4-quartz-scheduler-integration-example/]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Quartz</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Quartz guide]]></title>
    <url>%2FQuartz-guide.html</url>
    <content type="text"><![CDATA[Quartzæ˜¯ä¸€æ¬¾å¼€æºçš„ä»»åŠ¡è°ƒåº¦æ¡†æž¶ï¼Œå¯¹ä»»åŠ¡è°ƒåº¦è¿‡ç¨‹è¿›è¡Œäº†é«˜åº¦çš„æŠ½è±¡ï¼ŒåŒ…å«è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰ï¼Œä»»åŠ¡ï¼ˆJobï¼‰å’Œè§¦å‘å™¨ï¼ˆTriggerï¼‰ã€‚Quartzåœ¨org.quartz.*ä¸­é€šè¿‡æŽ¥å£å’Œç±»å¯¹è¿™ä¸‰ä¸ªæ¦‚å¿µè¿›è¡Œäº†æè¿°ï¼ˆè¿™é‡Œä½¿ç”¨çš„Quartzç‰ˆæœ¬ä¸º1.8.6ï¼‰ï¼šJobï¼šä¸€ä¸ªç®€å•çš„æŽ¥å£ï¼ŒåªåŒ…å«ä¸€ä¸ªvoid execute(JobExecutionContext context)æŠ½è±¡æ–¹æ³•ã€‚å®žé™…å¼€å‘ä¸­ï¼Œé€šè¿‡å®žçŽ°è¯¥æŽ¥å£æ¥å®šä¹‰éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚JobExecutionContextæä¾›äº†è°ƒåº¦ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚1234public interface Job &#123; void execute(JobExecutionContext context) throws JobExecutionException;&#125;JobDetailï¼šåŒ…å«å¤šä¸ªæž„é€ å‡½æ•°ï¼Œæœ€å¸¸ç”¨çš„ä¸ºJobDetail(String name, String group, Class jobClass)jobClassä¸ºå®žçŽ°äº†JobæŽ¥å£çš„ç±»ï¼Œnameä¸ºä»»åŠ¡åœ¨Schedulerä¸­çš„åç§°ï¼Œgroupä¸ºä»»åŠ¡åœ¨Schedulerä¸­çš„ç»„åã€‚ç»„åé»˜è®¤ä¸ºScheduler.DEFAULT_GROUPã€‚Triggerï¼šä¸€ä¸ªç±»ï¼Œç”¨äºŽæè¿°è§¦å‘Jobæ‰§è¡Œçš„æ—¶é—´è§„åˆ™ã€‚åŒ…å«ï¼šSimpleTrigger: ä¸€æ¬¡æˆ–è€…å›ºå®šæ—¶é—´é—´éš”å‘¨æœŸçš„è§¦å‘è§„åˆ™ã€‚CronTriggerï¼šé€šè¿‡cronè¡¨è¾¾å¼æè¿°å‡ºæ›´ä¸ºå¤æ‚çš„è§¦å‘è§„åˆ™ã€‚Calendarï¼šQuartzæä¾›çš„æ—¥åŽ†ç±»ã€‚ä¸€ä¸ªTriggerå¯ä»¥å’Œå¤šä¸ªCalendarå…³è”ï¼Œä»¥æ­¤æ¥æŽ’é™¤ä¸€äº›ç‰¹æ®Šçš„æ—¥æœŸã€‚Schedulerï¼šä»£è¡¨ä¸€ä¸ªQuartzçš„ç‹¬ç«‹è¿è¡Œå®¹å™¨ï¼ŒTriggerå’ŒJobDetailè¢«æ³¨å†Œåˆ°Schedulerä¸­ï¼ŒäºŒè€…åœ¨Schedulerä¸­æ‹¥æœ‰å„è‡ªçš„åç§°ï¼ˆnameï¼‰å’Œç»„åï¼ˆgroupï¼‰ã€‚Triggerå’ŒJobDetailçš„åç§°å’Œç»„åçš„ç»„åˆå¿…é¡»å”¯ä¸€ï¼Œä½†æ˜¯Triggerçš„åç§°å’Œç»„åçš„ç»„åˆå¯ä»¥å’ŒJobDetailçš„ç›¸åŒï¼Œå› ä¸ºå®ƒä»¬ç±»åž‹ä¸åŒã€‚ä¸€ä¸ªJobå¯ä»¥ç»‘å®šå¤šä¸ªTriggerï¼Œåä¹‹ä¸ç„¶ã€‚Jobè¿˜æœ‰ä¸€ä¸ªå­æŽ¥å£ï¼šStatefulJobï¼Œå…¶æ˜¯ä¸€ä¸ªæ²¡æœ‰æ–¹æ³•çš„æ ‡ç­¾æŽ¥å£ï¼Œä»£è¡¨æœ‰çŠ¶æ€çš„ä»»åŠ¡ã€‚æ— çŠ¶æ€ä»»åŠ¡ï¼šæ‹¥æœ‰JobDataMapå¤åˆ¶ï¼Œæ‰€ä»¥å¯ä»¥å¹¶å‘è¿è¡Œï¼›æœ‰çŠ¶æ€ä»»åŠ¡ï¼šå…±äº«ä¸€ä»½JobDataMapï¼Œæ¯æ¬¡å¯¹JobDataMapçš„ä¿®æ”¹ä¼šè¢«ä¿å­˜ä¸‹æ¥ã€‚æ‰€ä»¥å‰æ¬¡çš„StatefulJobä¼šé˜»å¡žä¸‹ä¸€æ¬¡çš„StatefulJobã€‚SimpleTriggerSimpleTriggeråŒ…å«å¤šä¸ªé‡è½½çš„æž„é€ å™¨ï¼Œå¯æ ¹æ®å®žé™…éœ€æ±‚æ¥é€‰æ‹©ã€‚è¿™é‡Œä½¿ç”¨SimpleTriggeræ¥æ¼”ç¤ºè§¦å‘ä¸€ä¸ªJobDetailã€‚é¦–å…ˆå®šä¹‰ä¸€ä¸ªç®€å•çš„Jobå®žçŽ°ç±»ï¼Œä»£è¡¨æˆ‘ä»¬éœ€è¦è¿›è¡Œè°ƒåº¦çš„ä»»åŠ¡ï¼š123456789101112131415import java.text.SimpleDateFormat;import java.util.Date;import org.quartz.Job;import org.quartz.JobExecutionContext;import org.quartz.JobExecutionException;public class SimpleJob implements Job&#123; @Override public void execute(JobExecutionContext context) throws JobExecutionException &#123; System.out.println("TriggerName: "+context.getTrigger().getName()+ " Triggered time is: "+new SimpleDateFormat("HH:mm:ss").format((new Date()))); &#125;&#125;ä¸‹é¢é€šè¿‡SimpleTriggerå¯¹SimpleJobè¿›è¡Œè°ƒåº¦ï¼š12345678910111213141516171819202122232425262728import java.util.Date;import org.quartz.JobDetail;import org.quartz.Scheduler;import org.quartz.SimpleTrigger;import org.quartz.impl.StdSchedulerFactory;public class SimpleTriggerRunner &#123; public static void main(String[] args) &#123; try &#123; JobDetail jobDetail = new JobDetail("job1","job_group1",SimpleJob.class); SimpleTrigger simpleTrigger = new SimpleTrigger("trigger1","trigger_group1"); simpleTrigger.setStartTime(new Date()); simpleTrigger.setRepeatInterval(2000); simpleTrigger.setRepeatCount(10); Scheduler scheduler = new StdSchedulerFactory().getScheduler(); scheduler.scheduleJob(jobDetail, simpleTrigger); scheduler.start(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125;ä¸Šé¢ä»£ç ä¸­åšçš„äº‹æƒ…ä¸»è¦æœ‰ï¼šé€šè¿‡JobDetailå°è£…SimpleJobï¼ŒåŒæ—¶æŒ‡å®šå…¶åç§°ä¸ºjob1ï¼Œç»„åä¸ºjob_group1ï¼›åˆ›å»ºä¸€ä¸ªSimpleTriggerï¼Œå¹¶æŒ‡å®šå…¶åç§°ä¸ºtrigger1ï¼Œç»„åä¸ºtrigger_group1ï¼Œè§¦å‘å¯åŠ¨æ—¶é—´ä¸ºé©¬ä¸Šè§¦å‘ï¼Œæ—¶é—´é—´éš”ä¸º2000æ¯«ç§’ï¼Œé‡å¤10æ¬¡ï¼›æŽ¥ç€åˆ›å»ºäº†ä¸€ä¸ªSchedulerå®žä¾‹ï¼Œå¹¶ä¸”å°†JobDetailå’ŒTriggerå®žä¾‹æ³¨å†Œåˆ°Schedulerä¸­ã€‚è¿è¡Œä»£ç ï¼Œè§‚å¯Ÿè¾“å‡ºï¼š1234567891011TriggerName: trigger1 Triggered time is: 16:27:07TriggerName: trigger1 Triggered time is: 16:27:09TriggerName: trigger1 Triggered time is: 16:27:11TriggerName: trigger1 Triggered time is: 16:27:13TriggerName: trigger1 Triggered time is: 16:27:15TriggerName: trigger1 Triggered time is: 16:27:17TriggerName: trigger1 Triggered time is: 16:27:19TriggerName: trigger1 Triggered time is: 16:27:21TriggerName: trigger1 Triggered time is: 16:27:23TriggerName: trigger1 Triggered time is: 16:27:25TriggerName: trigger1 Triggered time is: 16:27:27CronTriggerCronTriggerçš„è°ƒåº¦è§„åˆ™åŸºäºŽCronè¡¨è¾¾å¼ã€‚Cronè¡¨è¾¾å¼ç”±6ä¸ªæˆ–7ä¸ªç”±ç©ºæ ¼åˆ†éš”çš„æ—¶é—´å­—æ®µï¼šä½ç½®æ—¶é—´åŸŸåå…è®¸å€¼å…è®¸çš„ç‰¹æ®Šå­—ç¬¦1ç§’0-59, - * /2åˆ†é’Ÿ0-59, - * /3å°æ—¶0-23, - * /4æ—¥æœŸ1-31, - * ? / L W C5æœˆä»½1-12, - * /6æ˜ŸæœŸ1-7, - * ? / L C #7å¹´(å¯é€‰)ç©ºå€¼1970-2099, - * /å…¶ä¸­ç‰¹æ®Šå­—ç¬¦çš„å«ä¹‰å¦‚ä¸‹ï¼šæ˜Ÿå·ï¼ˆ*ï¼‰ï¼šå¯ç”¨åœ¨æ‰€æœ‰å­—æ®µä¸­ï¼Œè¡¨ç¤ºå¯¹åº”æ—¶é—´åŸŸçš„æ¯ä¸€ä¸ªæ—¶åˆ»ã€‚ä¾‹å¦‚ï¼Œ*åœ¨åˆ†é’Ÿå­—æ®µæ—¶ï¼Œè¡¨ç¤ºâ€œæ¯åˆ†é’Ÿâ€ï¼›é—®å·ï¼ˆ?ï¼‰ï¼šè¯¥å­—ç¬¦åªåœ¨æ—¥æœŸå’Œæ˜ŸæœŸå­—æ®µä¸­ä½¿ç”¨ï¼Œå®ƒé€šå¸¸æŒ‡å®šä¸ºâ€œæ— æ„ä¹‰çš„å€¼â€ï¼Œç›¸å½“äºŽç‚¹ä½ç¬¦ï¼›å‡å·ï¼ˆ-ï¼‰ï¼šè¡¨è¾¾ä¸€ä¸ªèŒƒå›´ï¼Œå¦‚åœ¨å°æ—¶å­—æ®µä¸­ä½¿ç”¨â€œ10-12â€ï¼Œåˆ™è¡¨ç¤ºä»Ž10åˆ°12ç‚¹ï¼Œå³10,11,12ï¼›é€—å·ï¼ˆ,ï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªåˆ—è¡¨å€¼ï¼Œå¦‚åœ¨æ˜ŸæœŸå­—æ®µä¸­ä½¿ç”¨â€œMON,WED,FRIâ€ï¼Œåˆ™è¡¨ç¤ºæ˜ŸæœŸä¸€ï¼Œæ˜ŸæœŸä¸‰å’Œæ˜ŸæœŸäº”ï¼›æ–œæ ï¼ˆ/ï¼‰ï¼šx/yè¡¨è¾¾ä¸€ä¸ªç­‰æ­¥é•¿åºåˆ—ï¼Œxä¸ºèµ·å§‹å€¼ï¼Œyä¸ºå¢žé‡æ­¥é•¿å€¼ã€‚å¦‚åœ¨åˆ†é’Ÿå­—æ®µä¸­ä½¿ç”¨0/15ï¼Œåˆ™è¡¨ç¤ºä¸º0,15,30å’Œ45ç§’ï¼Œè€Œ5/15åœ¨åˆ†é’Ÿå­—æ®µä¸­è¡¨ç¤º5,20,35,50ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨*/yï¼Œå®ƒç­‰åŒäºŽ0/yï¼›Lï¼šè¯¥å­—ç¬¦åªåœ¨æ—¥æœŸå’Œæ˜ŸæœŸå­—æ®µä¸­ä½¿ç”¨ï¼Œä»£è¡¨â€œLastâ€çš„æ„æ€ï¼Œä½†å®ƒåœ¨ä¸¤ä¸ªå­—æ®µä¸­æ„æ€ä¸åŒã€‚Låœ¨æ—¥æœŸå­—æ®µä¸­ï¼Œè¡¨ç¤ºè¿™ä¸ªæœˆä»½çš„æœ€åŽä¸€å¤©ï¼Œå¦‚ä¸€æœˆçš„31å·ï¼Œéžé—°å¹´äºŒæœˆçš„28å·ï¼›å¦‚æžœLç”¨åœ¨æ˜ŸæœŸä¸­ï¼Œåˆ™è¡¨ç¤ºä¸€ä¸ªæ˜ŸæœŸçš„æœ€åŽä¸€å¤©ï¼ˆä¹Ÿå°±æ˜¯æ˜ŸæœŸå…­ï¼Œå›½å¤–æ˜ŸæœŸç¬¬ä¸€å¤©ä¸ºå‘¨å¤©ï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æžœLå‡ºçŽ°åœ¨æ˜ŸæœŸå­—æ®µé‡Œï¼Œè€Œä¸”åœ¨å‰é¢æœ‰ä¸€ä¸ªæ•°å€¼Xï¼Œåˆ™è¡¨ç¤ºâ€œè¿™ä¸ªæœˆçš„æœ€åŽä¸€ä¸ªæ˜ŸæœŸX-1â€ï¼Œä¾‹å¦‚ï¼Œ6Lè¡¨ç¤ºè¯¥æœˆçš„æœ€åŽä¸€ä¸ªæ˜ŸæœŸäº”ï¼Œ5Lè¡¨ç¤ºè¯¥æœˆçš„æœ€åŽä¸€ä¸ªæ˜ŸæœŸå››ï¼Œä»¥æ­¤ç±»æŽ¨ã€‚Wï¼šè¯¥å­—ç¬¦åªèƒ½å‡ºçŽ°åœ¨æ—¥æœŸå­—æ®µé‡Œï¼Œæ˜¯å¯¹å‰å¯¼æ—¥æœŸçš„ä¿®é¥°ï¼Œè¡¨ç¤ºç¦»è¯¥æ—¥æœŸæœ€è¿‘çš„å·¥ä½œæ—¥ã€‚ä¾‹å¦‚15Wè¡¨ç¤ºç¦»è¯¥æœˆ15å·æœ€è¿‘çš„å·¥ä½œæ—¥ï¼Œå¦‚æžœè¯¥æœˆ15å·æ˜¯æ˜ŸæœŸå…­ï¼Œåˆ™åŒ¹é…14å·æ˜ŸæœŸäº”ï¼›å¦‚æžœ15æ—¥æ˜¯æ˜ŸæœŸæ—¥ï¼Œåˆ™åŒ¹é…16å·æ˜ŸæœŸä¸€ï¼›å¦‚æžœ15å·æ˜¯æ˜ŸæœŸäºŒï¼Œé‚£ç»“æžœå°±æ˜¯15å·æ˜ŸæœŸäºŒã€‚ä½†å¿…é¡»æ³¨æ„å…³è”çš„åŒ¹é…æ—¥æœŸä¸èƒ½å¤Ÿè·¨æœˆï¼Œå¦‚ä½ æŒ‡å®š1Wï¼Œå¦‚æžœ1å·æ˜¯æ˜ŸæœŸå…­ï¼Œç»“æžœåŒ¹é…çš„æ˜¯3å·æ˜ŸæœŸä¸€ï¼Œè€Œéžä¸Šä¸ªæœˆæœ€åŽçš„é‚£å¤©ï¼›LWç»„åˆï¼šåœ¨æ—¥æœŸå­—æ®µå¯ä»¥ç»„åˆä½¿ç”¨LWï¼Œå®ƒçš„æ„æ€æ˜¯å½“æœˆçš„æœ€åŽä¸€ä¸ªå·¥ä½œæ—¥ï¼›äº•å·ï¼ˆ#ï¼‰ï¼šè¯¥å­—ç¬¦åªèƒ½åœ¨æ˜ŸæœŸå­—æ®µä¸­ä½¿ç”¨ï¼Œè¡¨ç¤ºå½“æœˆæŸä¸ªå·¥ä½œæ—¥ã€‚å¦‚6#3è¡¨ç¤ºå½“æœˆçš„ç¬¬ä¸‰ä¸ªæ˜ŸæœŸäº”ï¼ˆ6è¡¨ç¤ºæ˜ŸæœŸäº”ï¼Œ#3è¡¨ç¤ºå½“å‰çš„ç¬¬ä¸‰ä¸ªï¼‰ï¼Œè€Œ4#5è¡¨ç¤ºå½“æœˆçš„ç¬¬äº”ä¸ªæ˜ŸæœŸä¸‰ï¼Œå‡è®¾å½“æœˆæ²¡æœ‰ç¬¬äº”ä¸ªæ˜ŸæœŸä¸‰ï¼Œå¿½ç•¥ä¸è§¦å‘ï¼›Cï¼šè¯¥å­—ç¬¦åªåœ¨æ—¥æœŸå’Œæ˜ŸæœŸå­—æ®µä¸­ä½¿ç”¨ï¼Œä»£è¡¨â€œCalendarâ€çš„æ„æ€ã€‚å®ƒçš„æ„æ€æ˜¯è®¡åˆ’æ‰€å…³è”çš„æ—¥æœŸï¼Œå¦‚æžœæ—¥æœŸæ²¡æœ‰è¢«å…³è”ï¼Œåˆ™ç›¸å½“äºŽæ—¥åŽ†ä¸­æ‰€æœ‰æ—¥æœŸã€‚ä¾‹å¦‚5Cåœ¨æ—¥æœŸå­—æ®µä¸­å°±ç›¸å½“äºŽæ—¥åŽ†5æ—¥ä»¥åŽçš„ç¬¬ä¸€å¤©ã€‚1Cåœ¨æ˜ŸæœŸå­—æ®µä¸­ç›¸å½“äºŽæ˜ŸæœŸæ—¥åŽçš„ç¬¬ä¸€å¤©ã€‚Cronè¡¨è¾¾å¼å¯¹ç‰¹æ®Šå­—ç¬¦çš„å¤§å°å†™ä¸æ•æ„Ÿï¼Œå¯¹ä»£è¡¨æ˜ŸæœŸçš„ç¼©å†™è‹±æ–‡å¤§å°å†™ä¹Ÿä¸æ•æ„Ÿã€‚ä¸‹é¢ç»™å‡ºä¸€äº›å®Œæ•´çš„Cronè¡¨ç¤ºå¼çš„å®žä¾‹ï¼šè¡¨ç¤ºå¼è¯´æ˜Žâ€œ0 0 12 * * ? â€œæ¯å¤©12ç‚¹è¿è¡Œâ€œ0 15 10 ? * *â€œæ¯å¤©10:15è¿è¡Œâ€œ0 15 10 * * ?â€æ¯å¤©10:15è¿è¡Œâ€œ0 15 10 * * ? *â€œæ¯å¤©10:15è¿è¡Œâ€œ0 15 10 * * ? 2008â€åœ¨2008å¹´çš„æ¯å¤©10ï¼š15è¿è¡Œâ€œ0 * 14 * * ?â€æ¯å¤©14ç‚¹åˆ°15ç‚¹ä¹‹é—´æ¯åˆ†é’Ÿè¿è¡Œä¸€æ¬¡ï¼Œå¼€å§‹äºŽ14:00ï¼Œç»“æŸäºŽ14:59ã€‚â€œ0 0/5 14 * * ?â€æ¯å¤©14ç‚¹åˆ°15ç‚¹æ¯5åˆ†é’Ÿè¿è¡Œä¸€æ¬¡ï¼Œå¼€å§‹äºŽ14:00ï¼Œç»“æŸäºŽ14:55ã€‚â€œ0 0/5 14,18 * * ?â€æ¯å¤©14ç‚¹åˆ°15ç‚¹æ¯5åˆ†é’Ÿè¿è¡Œä¸€æ¬¡ï¼Œæ­¤å¤–æ¯å¤©18ç‚¹åˆ°19ç‚¹æ¯5é’Ÿä¹Ÿè¿è¡Œä¸€æ¬¡ã€‚â€œ0 0-5 14 * * ?â€æ¯å¤©14:00ç‚¹åˆ°14:05ï¼Œæ¯åˆ†é’Ÿè¿è¡Œä¸€æ¬¡ã€‚â€œ0 10,44 14 ? 3 WEDâ€3æœˆæ¯å‘¨ä¸‰çš„14:10åˆ†åˆ°14:44ï¼Œæ¯åˆ†é’Ÿè¿è¡Œä¸€æ¬¡ã€‚â€œ0 15 10 ? * MON-FRIâ€æ¯å‘¨ä¸€ï¼ŒäºŒï¼Œä¸‰ï¼Œå››ï¼Œäº”çš„10:15åˆ†è¿è¡Œã€‚â€œ0 15 10 15 * ?â€æ¯æœˆ15æ—¥10:15åˆ†è¿è¡Œã€‚â€œ0 15 10 L * ?â€æ¯æœˆæœ€åŽä¸€å¤©10:15åˆ†è¿è¡Œã€‚â€œ0 15 10 ? * 6Lâ€æ¯æœˆæœ€åŽä¸€ä¸ªæ˜ŸæœŸäº”10:15åˆ†è¿è¡Œã€‚â€œ0 15 10 ? * 6L 2014-2016â€åœ¨2014,2015,2016å¹´æ¯ä¸ªæœˆçš„æœ€åŽä¸€ä¸ªæ˜ŸæœŸäº”çš„10:15åˆ†è¿è¡Œã€‚â€œ0 15 10 ? * 6#3â€æ¯æœˆç¬¬ä¸‰ä¸ªæ˜ŸæœŸäº”çš„10:15åˆ†è¿è¡Œã€‚é™„ï¼šåœ¨çº¿Cronè¡¨è¾¾å¼ç”Ÿæˆå™¨CronTriggerå®žä¾‹ä½¿ç”¨CronTriggerå¯¹simpleJobè¿›è¡Œè°ƒåº¦ï¼Œä½¿ç”¨Cronè¡¨è¾¾å¼åˆ¶å®šè°ƒåº¦è§„åˆ™ï¼Œè®©å…¶æ¯5ç§’è¿è¡Œä¸€æ¬¡ï¼š123456789101112131415161718192021222324import org.quartz.CronExpression;import org.quartz.CronTrigger;import org.quartz.JobDetail;import org.quartz.Scheduler;import org.quartz.impl.StdSchedulerFactory;public class CronTriggerRunner &#123; public static void main(String[] args) &#123; try &#123; JobDetail jobDetail = new JobDetail("job2","job_group2",SimpleJob.class); CronTrigger cronTrigger = new CronTrigger("trigger2","trigger_group2"); CronExpression ce = new CronExpression("0/5 * * * * ?"); cronTrigger.setCronExpression(ce); Scheduler scheduler = new StdSchedulerFactory().getScheduler(); scheduler.scheduleJob(jobDetail, cronTrigger); scheduler.start(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125;è¿è¡Œï¼Œè§‚å¯Ÿè¾“å‡ºï¼š123456789101112131415TriggerName: trigger2 Triggered time is: 09:38:00TriggerName: trigger2 Triggered time is: 09:38:05TriggerName: trigger2 Triggered time is: 09:38:10TriggerName: trigger2 Triggered time is: 09:38:15TriggerName: trigger2 Triggered time is: 09:38:20TriggerName: trigger2 Triggered time is: 09:38:25TriggerName: trigger2 Triggered time is: 09:38:30TriggerName: trigger2 Triggered time is: 09:38:35TriggerName: trigger2 Triggered time is: 09:38:40TriggerName: trigger2 Triggered time is: 09:38:45TriggerName: trigger2 Triggered time is: 09:38:50TriggerName: trigger2 Triggered time is: 09:38:55TriggerName: trigger2 Triggered time is: 09:39:00TriggerName: trigger2 Triggered time is: 09:39:05...Calendarç•¥ã€‚]]></content>
      <tags>
        <tag>Java</tag>
        <tag>Quartz</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆè¯†Flexå¸ƒå±€]]></title>
    <url>%2F%E5%88%9D%E8%AF%86Flex%E5%B8%83%E5%B1%80.html</url>
    <content type="text"><![CDATA[ä¼ ç»Ÿçš„CSSå¸ƒå±€æ–¹æ³•ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨floatå±žæ€§å’Œdisplay:tableæ¥å®žçŽ°å¸ƒå±€ï¼Œä½†åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­æ€»æœ‰ç§æ— æ³•éšå¿ƒæ‰€æ¬²çš„æ„Ÿè§‰ï¼Œå…ƒç´ çš„ä½ç½®æ‘†æ”¾æ€»æ˜¯æ˜¾å¾—ä¸æ˜¯é‚£ä¹ˆçš„ç›´è§‚ï¼Œè€ŒFlexboxå¾ˆå¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚Flexboxä¿—ç§°å¼¹æ€§ç›’å­æ¨¡åž‹ï¼Œåœ¨å¼€å§‹ä½¿ç”¨Flexboxä¹‹å‰ï¼Œé¦–å…ˆè¦å£°æ˜Žä¸€ä¸ªFlexå®¹å™¨ï¼ˆFlex Containerï¼‰ã€‚è€ŒFlexå®¹å™¨ä¸­çš„å…ƒç´ ç§°ä¸ºFlexé¡¹ç›®ï¼ˆFlex Itemï¼‰ã€‚å£°æ˜Žä¸€ä¸ªFlexå®¹å™¨ï¼š1234567div &#123; display: flex;&#125;// å¯¹äºŽè¡Œå†…å…ƒç´ ï¼šdiv &#123; display: inline-flex;&#125;å¯¹äºŽä¸€ä¸ªFlexå®¹å™¨ï¼Œå…¶å­˜åœ¨ä¸¤ä¸ªè½´ã€‚æ°´å¹³æ–¹å‘çš„ç§°ä¸ºä¸»è½´ï¼ˆmain axisï¼‰ï¼Œç«–ç›´æ–¹å‘çš„ç§°ä¸ºäº¤å‰è½´ï¼ˆcross axisï¼‰ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šFlexBoxä¸»è¦åŒ…å«12ä¸ªå±žæ€§ï¼Œå…¶ä¸­Flexå®¹å™¨6ä¸ªï¼ŒFlexé¡¹ç›®6ä¸ªã€‚Flexå®¹å™¨å±žæ€§flex-directionflex-directionå±žæ€§å†³å®šäº†é¡¹ç›®çš„æŽ’åˆ—æ–¹å‘ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1flex-direction: row | row-reverse | column | column-reverse;å¯å–çš„å€¼æœ‰ï¼šrowï¼ˆé»˜è®¤å€¼ï¼‰ï¼šé¡¹ç›®æ°´å¹³æ–¹å‘æŽ’åˆ—ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯ã€‚row-reverseï¼šé¡¹ç›®æ°´å¹³æ–¹å‘æŽ’åˆ—ï¼Œèµ·ç‚¹åœ¨å³ç«¯ã€‚columnï¼šé¡¹ç›®ç«–ç›´æ–¹å‘æŽ’åˆ—ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿ã€‚column-reverseï¼šé¡¹ç›®ç«–ç›´æ–¹å‘æŽ’åˆ—ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œflex-directionçš„å–å€¼ä¸ºrowï¼šSee the Pen xrvQqe by wuyouzhuguli (@mrbird) on CodePen.å½“flex-directionå±žæ€§çš„å€¼ä¸ºrow-reverseæ—¶ï¼Œé¡¹ç›®çš„èµ·ç‚¹åœ¨å³ç«¯ï¼šSee the Pen yoLJYb by wuyouzhuguli (@mrbird) on CodePen.å½“flex-directionå±žæ€§çš„å€¼ä¸ºcolumnæ—¶ï¼Œé¡¹ç›®åž‚ç›´æŽ’åˆ—ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿ï¼šSee the Pen yoLJOX by wuyouzhuguli (@mrbird) on CodePen.å½“flex-directionå±žæ€§çš„å€¼ä¸ºcolumn-reverseæ—¶ï¼Œé¡¹ç›®åž‚ç›´æŽ’åˆ—ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿ï¼šSee the Pen OjJXXV by wuyouzhuguli (@mrbird) on CodePen.flex-wrapflex-wrapå±žæ€§è§„å®šäº†é¡¹ç›®åœ¨ä¸€æ¡è½´çº¿ä¸ŠæŽ’ä¸ä¸‹æ—¶ï¼Œæ˜¯å¦æ¢è¡Œã€‚è¯­æ³•å¦‚ä¸‹ï¼š1flex-wrap: nowrap | wrap | wrap-reverse;å±žæ€§å¯å–çš„å€¼æœ‰ï¼šnowrapï¼ˆé»˜è®¤ï¼‰ï¼šä¸æ¢è¡Œã€‚wrapï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸Šæ–¹ã€‚wrap-reverseï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸‹æ–¹ã€‚flex-wrapé»˜è®¤å–å€¼ä¸ºnowrapï¼Œå³ä¸æ¢è¡Œï¼Œå¦‚æžœé¡¹ç›®æŽ’åˆ—æ–¹å‘ä¸ºæ°´å¹³æ–¹å‘ï¼Œåˆ™é¡¹ç›®å®½åº¦è‡ªåŠ¨æ”¶ç¼©ï¼ˆå› ä¸ºé¡¹ç›®çš„flex-shrinkå±žæ€§å€¼é»˜è®¤ä¸º1ï¼Œå³å¦‚æžœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å®½åº¦å°†ç¼©å°ã€‚ï¼‰ï¼šSee the Pen KvKMNm by wuyouzhuguli (@mrbird) on CodePen.å°†flex-wrapå±žæ€§å€¼è®¾ç½®ä¸ºwarpæ—¶ï¼šSee the Pen zdYBoj by wuyouzhuguli (@mrbird) on CodePen.å°†flex-wrapå±žæ€§å€¼è®¾ç½®ä¸ºwrap-reverseæ—¶ï¼šSee the Pen eEYzgV by wuyouzhuguli (@mrbird) on CodePen.å½“é¡¹ç›®æŽ’åˆ—æ–¹å‘ä¸ºç«–ç›´æ–¹å‘ï¼Œå¦‚æžœä¸€åˆ—æŽ’ä¸ä¸‹å¹¶ä¸”flex-wrapå±žæ€§å€¼ä¸ºno-wrapæ—¶ï¼Œé¡¹ç›®å°†ä¼šè¶…å‡ºå®¹å™¨çš„é«˜åº¦ï¼Œé¡¹ç›®å¹¶ä¸ä¼šæ”¶ç¼©ã€‚flex-flowflex-flowå±žæ€§æ˜¯flex-directionå±žæ€§å’Œflex-wrapå±žæ€§çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸ºrow nowrapã€‚justify-contentjustify-contentå±žæ€§å®šä¹‰äº†é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1justify-content: flex-start | flex-end | center | space-between | space-around;å±žæ€§å¯å–çš„å€¼æœ‰ï¼šflex-startï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå·¦å¯¹é½ã€‚flex-endï¼šå³å¯¹é½ã€‚centerï¼š å±…ä¸­ã€‚space-betweenï¼šä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”éƒ½ç›¸ç­‰ã€‚space-aroundï¼šæ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ã€‚é¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸Žè¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ºå·¦å¯¹é½ï¼Œå½“justify-contentå±žæ€§å€¼è®¾ä¸ºflex-endæ—¶ï¼šSee the Pen vJYKgo by wuyouzhuguli (@mrbird) on CodePen.å½“justify-contentå±žæ€§å€¼ä¸ºcenteræ—¶ï¼šSee the Pen probdW by wuyouzhuguli (@mrbird) on CodePen.å½“justify-contentå±žæ€§å€¼ä¸ºspace-betweenæ—¶ï¼šSee the Pen dzyXZB by wuyouzhuguli (@mrbird) on CodePen.å½“justify-contentå±žæ€§å€¼ä¸ºspace-aroundæ—¶ï¼šSee the Pen QMWEag by wuyouzhuguli (@mrbird) on CodePen.align-itemsalign-itemså±žæ€§å®šä¹‰é¡¹ç›®åœ¨äº¤å‰è½´ä¸Šå¦‚ä½•å¯¹é½ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1align-items: flex-start | flex-end | center | baseline | stretch;å±žæ€§å¯å–çš„å€¼æœ‰ï¼šflex-startï¼šäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚flex-endï¼šäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚centerï¼šäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚baseline: é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½ã€‚stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå¦‚æžœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ã€‚å½“align-itemså±žæ€§å€¼ä¸ºflex-startæ—¶ï¼ˆå°†ç¬¬2ï¼Œ4ä¸ªé¡¹ç›®é«˜åº¦è®¾ç½®ä¸º120pxï¼Œä»¥æ›´å¥½çš„åŒºåˆ†å„å±žæ€§çš„æ•ˆæžœï¼‰ï¼šSee the Pen NvWrYp by wuyouzhuguli (@mrbird) on CodePen.å½“align-itemså±žæ€§å€¼ä¸ºflex-endæ—¶ï¼šSee the Pen jLOrpG by wuyouzhuguli (@mrbird) on CodePen.å½“align-itemså±žæ€§å€¼ä¸ºcenteræ—¶ï¼šSee the Pen XaWKvO by wuyouzhuguli (@mrbird) on CodePen.å½“align-itemså±žæ€§å€¼ä¸ºbaselineæ—¶ï¼Œé¡¹ç›®æ²¿ç€ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½ï¼šSee the Pen YxzWMy by wuyouzhuguli (@mrbird) on CodePen.å½“align-itemså±žæ€§å€¼ä¸ºstretchï¼ˆé»˜è®¤å€¼ï¼‰æ—¶ï¼Œå¦‚æžœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ã€‚See the Pen aybZjX by wuyouzhuguli (@mrbird) on CodePen.align-contentalign-contentå±žæ€§å®šä¹‰äº†å¤šæ ¹è½´çº¿ï¼ˆå¤šè¡Œï¼‰çš„å¯¹é½æ–¹å¼ã€‚å¦‚æžœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿ï¼Œè¯¥å±žæ€§ä¸èµ·ä½œç”¨ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1align-content: flex-start | flex-end | center | space-between | space-around | stretch;å±žæ€§å¯å–çš„å€¼æœ‰ï¼šflex-startï¼šä¸Žäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚flex-endï¼šä¸Žäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚centerï¼šä¸Žäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚space-betweenï¼šä¸Žäº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒã€‚space-aroundï¼šæ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸Žè¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šè½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´ã€‚å½“align-contentå±žæ€§å€¼ä¸ºflex-startæ—¶ï¼Œé¡¹ç›®äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ï¼šSee the Pen oeNzZx by wuyouzhuguli (@mrbird) on CodePen.å½“align-contentå±žæ€§å€¼ä¸ºflex-endæ—¶ï¼Œé¡¹ç›®äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ï¼šSee the Pen PKoGmJ by wuyouzhuguli (@mrbird) on CodePen.å½“align-contentå±žæ€§å€¼ä¸ºcenteræ—¶ï¼Œé¡¹ç›®äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ï¼šSee the Pen proEPQ by wuyouzhuguli (@mrbird) on CodePen.å½“align-contentå±žæ€§å€¼ä¸ºspace-betweenæ—¶ï¼šSee the Pen XaWjRL by wuyouzhuguli (@mrbird) on CodePen.å½“align-contentå±žæ€§å€¼ä¸ºspace-aroundæ—¶ï¼šSee the Pen oeNzwx by wuyouzhuguli (@mrbird) on CodePen.å½“align-contentå±žæ€§å€¼ä¸ºstretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼Œé¡¹ç›®é«˜åº¦ä¸ºautoæ—¶ï¼Œé¡¹ç›®å°†å æ»¡æ•´ä¸ªäº¤å‰è½´ï¼šSee the Pen vJYXZg by wuyouzhuguli (@mrbird) on CodePen.é¡¹ç›®å±žæ€§orderorderå±žæ€§å®šä¹‰é¡¹ç›®çš„æŽ’åˆ—é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼ŒæŽ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º0ï¼Œå®ƒå¯ä»¥æŽ¥å—ä¸€ä¸ªæ­£å€¼ï¼Œä¹Ÿå¯ä»¥æŽ¥å—ä¸€ä¸ªè´Ÿå€¼ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1order: &lt;integer&gt;;é»˜è®¤æƒ…å†µä¸‹ï¼Œå› ä¸ºé¡¹ç›®çš„orderå±žæ€§éƒ½ä¸º0ï¼Œæ‰€ä»¥æŽ’åˆ—é¡ºåºæŒ‰ç…§HTMLæºç è¿›è¡ŒæŽ’åˆ—ï¼Œæ¯”å¦‚ï¼š123456&lt;ul&gt; &lt;li&gt;1&lt;/li&gt; &lt;li&gt;2&lt;/li&gt; &lt;li&gt;3&lt;/li&gt; &lt;li&gt;4&lt;/li&gt;&lt;/ul&gt;åœ¨FlexBoxå¸ƒå±€é‡Œï¼Œlié»˜è®¤æŒ‰1ï¼Œ2ï¼Œ3ï¼Œ4çš„é¡ºåºæŽ’åˆ—ï¼ŒçŽ°åœ¨ä¸æ”¹å˜HTMLæºç çš„æƒ…å†µä¸‹ï¼Œå°†åºå·ä¸º1çš„liç§»åˆ°æœ€æœ«å°¾ï¼šSee the Pen proRge by wuyouzhuguli (@mrbird) on CodePen.è¿™é‡Œåªéœ€å°†ç¬¬ä¸€ä¸ªliçš„orderå±žæ€§å€¼è®¾ä¸ºå¤§äºŽ0çš„æ•°å³å¯ã€‚flex-growflex-growå±žæ€§å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³å¦‚æžœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1flex-grow: &lt;number&gt;å¦‚æžœæ‰€æœ‰é¡¹ç›®çš„flex-growå±žæ€§éƒ½ä¸º1ï¼Œåˆ™å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´ï¼ˆå¦‚æžœæœ‰çš„è¯ï¼‰ï¼šSee the Pen NvWdRr by wuyouzhuguli (@mrbird) on CodePen.ä»Žç»“æžœå¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸‰ä¸ªliçš„å®½åº¦éƒ½å˜å¤§äº†ï¼Œç­‰åˆ†äº†å¤–å±‚ulçš„å‰©ä½™ç©ºé—´ã€‚å¦‚æžœä¸€ä¸ªé¡¹ç›®çš„flex-growå±žæ€§ä¸º2ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™å‰è€…å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å…¶ä»–é¡¹å¤šä¸€å€ï¼šSee the Pen EvxZNR by wuyouzhuguli (@mrbird) on CodePen.flex-shrinkflex-shrinkå±žæ€§å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æžœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1flex-shrink: &lt;number&gt;;å¦‚æžœæ‰€æœ‰é¡¹ç›®çš„flex-shrinkå±žæ€§éƒ½ä¸º1ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°ã€‚å¦‚æžœä¸€ä¸ªé¡¹ç›®çš„flex-shrinkå±žæ€§ä¸º0ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™ç©ºé—´ä¸è¶³æ—¶ï¼Œå‰è€…ä¸ç¼©å°ã€‚è´Ÿå€¼å¯¹è¯¥å±žæ€§æ— æ•ˆï¼šSee the Pen vJYgxo by wuyouzhuguli (@mrbird) on CodePen.flex-basisflex-basiså±žæ€§å®šä¹‰äº†åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰ï¼Œé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´ï¼ˆmain sizeï¼‰ã€‚æµè§ˆå™¨æ ¹æ®è¿™ä¸ªå±žæ€§ï¼Œè®¡ç®—ä¸»è½´æ˜¯å¦æœ‰å¤šä½™ç©ºé—´ã€‚å®ƒçš„é»˜è®¤å€¼ä¸ºautoï¼Œå³é¡¹ç›®çš„æœ¬æ¥å¤§å°ã€‚åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š1flex-basis: &lt;length&gt; | auto;flex-basiså¯ä»¥æ‰‹åŠ¨çš„è®¾ç½®ä¸ºä¸€ä¸ªåˆæ³•çš„pxå€¼ï¼Œè¿™æ ·é¡¹ç›®åŽŸæœ¬çš„widthå°†å¤±æ•ˆã€‚æ¯”å¦‚ï¼Œç¬¬ä¸€ä¸ªliçš„å®½åº¦ä¸º70pxï¼Œåœ¨å°†å…¶flex-basiså±žæ€§è®¾ç½®ä¸º140pxä¹‹åŽï¼šSee the Pen YxzNEm by wuyouzhuguli (@mrbird) on CodePen.flexflexå±žæ€§æ˜¯flex-grow, flex-shrink å’Œ flex-basisçš„ç®€å†™ï¼Œé»˜è®¤å€¼ä¸º0 1 autoã€‚åŽä¸¤ä¸ªå±žæ€§å¯é€‰ã€‚è¯¥å±žæ€§æœ‰ä¸¤ä¸ªå¿«æ·å€¼ï¼šauto (1 1 auto) å’Œ none (0 0 auto)ã€‚align-selfalign-selfå±žæ€§å…è®¸å•ä¸ªé¡¹ç›®æœ‰ä¸Žå…¶ä»–é¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›–align-itemså±žæ€§ã€‚é»˜è®¤å€¼ä¸ºautoï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„align-itemså±žæ€§ï¼Œå¦‚æžœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäºŽstretchã€‚è¯­æ³•å¦‚ä¸‹ï¼š1align-self: auto | flex-start | flex-end | center | baseline | stretch;æ¯”å¦‚ï¼Œå°†ç¬¬äºŒä¸ªliçš„aligh-selfå±žæ€§å€¼è®¾ç½®ä¸ºflex-endï¼šSee the Pen MvWJGV by wuyouzhuguli (@mrbird) on CodePen.]]></content>
      <tags>
        <tag>CSS3</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS3æ»¤é•œfilter]]></title>
    <url>%2FCSS%E6%BB%A4%E9%95%9Cfilter.html</url>
    <content type="text"><![CDATA[CSSæ»¤é•œï¼ˆfilterï¼‰ç”¨äºŽå®šä¹‰æ»¤é•œæ•ˆæžœï¼Œä¹Ÿå°±æ˜¯æ”¹å˜å…ƒç´ çš„é€æ˜Žåº¦ã€å¯¹æ¯”åº¦ã€äº®åº¦å’Œæ¨¡ç³Šåº¦ç­‰æ•ˆæžœã€‚å…¶åŒ…å«ä¸€ç³»åˆ—çš„å‡½æ•°æ¥å®žçŽ°å„ç§æ»¤é•œæ•ˆæžœï¼Œä¹Ÿå¯ä»¥å°†è¿™äº›å‡½æ•°ç»„åˆèµ·æ¥ï¼Œä»¥æ­¤è¾¾åˆ°æ›´å¤æ‚çš„æ»¤é•œæ•ˆæžœã€‚blur()ç»™å›¾åƒè®¾ç½®é«˜æ–¯æ¨¡ç³Šçš„æ•ˆæžœã€‚é»˜è®¤å€¼ä¸º0ï¼ŒæŽ¥å—cssé•¿åº¦å€¼ï¼Œä¸èƒ½ä¸ºç™¾åˆ†æ•°ã€‚æ¯”å¦‚ç»™ä¸‹é¢çš„èƒŒæ™¯å›¾è®¾ç½®ä¸åŒçš„æ¨¡ç³Šåº¦ï¼Œå¹¶å¯¹æ¯”ç»“æžœï¼šSee the Pen gRNgzX by wuyouzhuguli (@mrbird) on CodePen.å¯è§ï¼Œé•¿åº¦å€¼è¶Šå¤§ï¼Œæ•ˆæžœè¶Šæ¨¡ç³Šã€‚brightness()ç”¨äºŽç»™å›¾åƒè®¾ç½®äº®æš—ç¨‹åº¦ï¼Œå€¼ä¸º0%æ—¶ï¼Œå›¾åƒå…¨é»‘ï¼›å€¼ä¸º100%æ—¶ï¼Œå›¾åƒæ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚æ¯”å¦‚ç»™ä¸‹é¢çš„èƒŒæ™¯å›¾è®¾ç½®ä¸åŒçš„äº®åº¦ï¼Œå¹¶å¯¹æ¯”ç»“æžœï¼šSee the Pen rwEyNO by wuyouzhuguli (@mrbird) on CodePen.contrast()è°ƒæ•´å›¾åƒçš„å¯¹æ¯”åº¦ã€‚å€¼æ˜¯0%çš„è¯ï¼Œå›¾åƒä¼šå…¨é»‘ã€‚å€¼æ˜¯100%ï¼Œå›¾åƒä¸å˜ã€‚å€¼å¯ä»¥è¶…è¿‡100%ï¼Œæ„å‘³ç€ä¼šè¿ç”¨æ›´ä½Žçš„å¯¹æ¯”ã€‚è‹¥æ²¡æœ‰è®¾ç½®å€¼ï¼Œé»˜è®¤æ˜¯1ã€‚æ¯”å¦‚ç»™ä¸‹é¢çš„èƒŒæ™¯å›¾è®¾ç½®ä¸åŒçš„å¯¹æ¯”åº¦ï¼Œå¹¶å¯¹æ¯”ç»“æžœï¼šSee the Pen EXBWVg by wuyouzhuguli (@mrbird) on CodePen.grayscale()å°†å›¾åƒè½¬æ¢ä¸ºç°åº¦å›¾åƒã€‚å€¼å®šä¹‰è½¬æ¢çš„æ¯”ä¾‹ã€‚å€¼ä¸º100%åˆ™å®Œå…¨è½¬ä¸ºç°åº¦å›¾åƒï¼Œå€¼ä¸º0%å›¾åƒæ— å˜åŒ–ã€‚å€¼åœ¨0%åˆ°100%ä¹‹é—´ï¼Œåˆ™æ˜¯æ•ˆæžœçš„çº¿æ€§ä¹˜å­ã€‚è‹¥æœªè®¾ç½®ï¼Œå€¼é»˜è®¤æ˜¯0ã€‚æ¯”å¦‚ç»™ä¸‹é¢çš„èƒŒæ™¯å›¾è®¾ç½®ä¸åŒçš„ç°åº¦å€¼ï¼Œå¹¶å¯¹æ¯”ç»“æžœï¼šSee the Pen NgZpYK by wuyouzhuguli (@mrbird) on CodePen.hue-rotate()ç»™å›¾åƒåº”ç”¨è‰²ç›¸æ—‹è½¬ã€‚angleå€¼è®¾å®šå›¾åƒä¼šè¢«è°ƒæ•´çš„è‰²çŽ¯è§’åº¦å€¼ã€‚å€¼ä¸º0degï¼Œåˆ™å›¾åƒæ— å˜åŒ–ã€‚è‹¥å€¼æœªè®¾ç½®ï¼Œé»˜è®¤å€¼æ˜¯0degã€‚è¯¥å€¼è™½ç„¶æ²¡æœ‰æœ€å¤§å€¼ï¼Œè¶…è¿‡360degçš„å€¼ç›¸å½“äºŽåˆç»•ä¸€åœˆã€‚æ¯”å¦‚ç»™ä¸‹é¢çš„èƒŒæ™¯å›¾è®¾ç½®ä¸åŒçš„è‰²ç›¸æ—‹è½¬å€¼ï¼Œå¹¶å¯¹æ¯”ç»“æžœï¼šSee the Pen LLKWJd by wuyouzhuguli (@mrbird) on CodePen.invert()åè½¬å›¾åƒã€‚å€¼å®šä¹‰è½¬æ¢çš„æ¯”ä¾‹ã€‚100%çš„ä»·å€¼æ˜¯å®Œå…¨åè½¬ã€‚å€¼ä¸º0%åˆ™å›¾åƒæ— å˜åŒ–ã€‚è‹¥å€¼æœªè®¾ç½®ï¼Œå€¼é»˜è®¤æ˜¯0ã€‚æ¯”å¦‚ç»™ä¸‹é¢çš„èƒŒæ™¯å›¾è®¾ç½®ä¸åŒçš„åè½¬å€¼ï¼Œå¹¶å¯¹æ¯”ç»“æžœï¼šSee the Pen rwEyQm by wuyouzhuguli (@mrbird) on CodePen.opacity()è½¬åŒ–å›¾åƒçš„é€æ˜Žç¨‹åº¦ã€‚å€¼å®šä¹‰è½¬æ¢çš„æ¯”ä¾‹ã€‚å€¼ä¸º0%åˆ™æ˜¯å®Œå…¨é€æ˜Žï¼Œå€¼ä¸º100%åˆ™å›¾åƒæ— å˜åŒ–ã€‚è‹¥å€¼æœªè®¾ç½®ï¼Œå€¼é»˜è®¤æ˜¯1ã€‚è¯¥å‡½æ•°ä¸Žå·²æœ‰çš„opacityå±žæ€§å¾ˆç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºŽé€šè¿‡filterï¼Œä¸€äº›æµè§ˆå™¨ä¸ºäº†æå‡æ€§èƒ½ä¼šæä¾›ç¡¬ä»¶åŠ é€Ÿã€‚æ¯”å¦‚ç»™ä¸‹é¢çš„èƒŒæ™¯å›¾è®¾ç½®ä¸åŒçš„é€æ˜Žåº¦ï¼Œå¹¶å¯¹æ¯”ç»“æžœï¼šSee the Pen EXBWrb by wuyouzhuguli (@mrbird) on CodePen.saturate()è½¬æ¢å›¾åƒé¥±å’Œåº¦ã€‚å€¼å®šä¹‰è½¬æ¢çš„æ¯”ä¾‹ã€‚å€¼ä¸º0%åˆ™æ˜¯å®Œå…¨ä¸é¥±å’Œï¼Œå€¼ä¸º100%åˆ™å›¾åƒæ— å˜åŒ–ã€‚è¶…è¿‡100%çš„å€¼æ˜¯å…è®¸çš„ï¼Œåˆ™æœ‰æ›´é«˜çš„é¥±å’Œåº¦ã€‚è‹¥å€¼æœªè®¾ç½®ï¼Œå€¼é»˜è®¤æ˜¯1ã€‚æ¯”å¦‚ç»™ä¸‹é¢çš„èƒŒæ™¯å›¾è®¾ç½®ä¸åŒçš„é¥±å’Œåº¦ï¼Œå¹¶å¯¹æ¯”ç»“æžœï¼šSee the Pen XgLMQa by wuyouzhuguli (@mrbird) on CodePen.sepia()å°†å›¾åƒè½¬æ¢ä¸ºæ·±è¤è‰²ã€‚å€¼å®šä¹‰è½¬æ¢çš„æ¯”ä¾‹ã€‚å€¼ä¸º100%åˆ™å®Œå…¨æ˜¯æ·±è¤è‰²çš„ï¼Œå€¼ä¸º0%å›¾åƒæ— å˜åŒ–ã€‚è‹¥æœªè®¾ç½®ï¼Œå€¼é»˜è®¤æ˜¯0ã€‚æ¯”å¦‚ç»™ä¸‹é¢çš„èƒŒæ™¯å›¾è®¾ç½®ä¸åŒçš„è¤è‰²å€¼ï¼Œå¹¶å¯¹æ¯”ç»“æžœï¼šSee the Pen owrZrP by wuyouzhuguli (@mrbird) on CodePen.drop-shadow()ç»™å›¾åƒè®¾ç½®ä¸€ä¸ªé˜´å½±æ•ˆæžœã€‚è¯¥å‡½æ•°ä¸Žå·²æœ‰çš„box-shadowå±žæ€§å¾ˆç›¸ä¼¼ã€‚ä¸åŒä¹‹å¤„åœ¨äºŽï¼Œé€šè¿‡æ»¤é•œï¼Œä¸€äº›æµè§ˆå™¨ä¸ºäº†æ›´å¥½çš„æ€§èƒ½ä¼šæä¾›ç¡¬ä»¶åŠ é€Ÿã€‚å‚æ•°ç±»åž‹å’Œbox-shadowä¸€è‡´ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºå•¦ã€‚url()URLå‡½æ•°æŽ¥å—ä¸€ä¸ªXMLæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶è®¾ç½®äº† ä¸€ä¸ªSVGæ»¤é•œï¼Œä¸”å¯ä»¥åŒ…å«ä¸€ä¸ªé”šç‚¹æ¥æŒ‡å®šä¸€ä¸ªå…·ä½“çš„æ»¤é•œå…ƒç´ ã€‚æ¯”å¦‚é€šè¿‡urlå‡½æ•°å¼•å…¥ä¸€ä¸ªsvgæ»¤é•œèµ„æºï¼š1.effect &#123; filter: url(commonfilters.xml#large-blur) &#125;]]></content>
      <tags>
        <tag>CSS3</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSSåª’ä½“æŸ¥è¯¢]]></title>
    <url>%2FCSS%E5%AA%92%E4%BD%93%E6%9F%A5%E8%AF%A2.html</url>
    <content type="text"><![CDATA[ä¸€ä¸ªåª’ä½“æŸ¥è¯¢ç”±ä¸€ä¸ªå¯é€‰çš„åª’ä½“ç±»åž‹å’Œé›¶ä¸ªæˆ–å¤šä¸ªä½¿ç”¨åª’ä½“åŠŸèƒ½é™åˆ¶æ ·å¼è¡¨èŒƒå›´çš„è¡¨è¾¾å¼ç»„æˆ, ä¾‹å¦‚å®½åº¦ï¼Œé«˜åº¦å’Œé¢œè‰²ç­‰ã€‚è¿™äº›è¡¨è¾¾å¼æè¿°äº†åª’ä½“ç‰¹å¾ï¼Œæœ€ç»ˆä¼šè¢«è§£æžä¸ºtrueæˆ–falseã€‚å¦‚æžœåª’ä½“æŸ¥è¯¢ä¸­æŒ‡å®šçš„åª’ä½“ç±»åž‹åŒ¹é…å±•ç¤ºæ–‡æ¡£æ‰€ä½¿ç”¨çš„è®¾å¤‡ç±»åž‹ï¼Œå¹¶ä¸”æ‰€æœ‰çš„è¡¨è¾¾å¼çš„å€¼éƒ½æ˜¯trueï¼Œé‚£ä¹ˆè¯¥åª’ä½“æŸ¥è¯¢çš„ç»“æžœä¸ºtrueã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š1234567891011&lt;!-- linkå…ƒç´ ä¸­çš„CSSåª’ä½“æŸ¥è¯¢ --&gt;&lt;link rel="stylesheet" media="(max-width: 800px)" href="example.css" /&gt;&lt;!-- æ ·å¼è¡¨ä¸­çš„CSSåª’ä½“æŸ¥è¯¢ --&gt;&lt;style&gt;@media (max-width: 600px) &#123; .facet_sidebar &#123; display: none; &#125;&#125;&lt;/style&gt;å½“åª’ä½“æŸ¥è¯¢ç»“æžœä¸ºtrueæ—¶ï¼Œç›¸åº”çš„æ ·å¼å°±ä¼šè¢«åº”ç”¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿åª’ä½“æŸ¥è¯¢ç»“æžœä¸ºfalseï¼Œlinkè¿˜æ˜¯ä¼šåŠ è½½ç›¸åº”çš„cssæ–‡ä»¶ï¼Œåªä¸è¿‡è¿™ä»½æ ·å¼æ–‡ä»¶ä¸ä¼šè¢«åº”ç”¨ç½¢äº†ã€‚åª’ä½“æŸ¥è¯¢ä¸­ï¼Œé»˜è®¤çš„åª’ä½“ç±»åž‹æ˜¯allã€‚å¸¸è§çš„åª’ä½“ç±»åž‹æœ‰ï¼šåª’ä½“ç±»åž‹æè¿°allç”¨äºŽæ‰€æœ‰çš„åª’ä½“è®¾å¤‡ã€‚auralç”¨äºŽè¯­éŸ³å’ŒéŸ³é¢‘åˆæˆå™¨ã€‚brailleç”¨äºŽç›²äººç”¨ç‚¹å­—æ³•è§¦è§‰å›žé¦ˆè®¾å¤‡ã€‚embossedç”¨äºŽåˆ†é¡µçš„ç›²äººç”¨ç‚¹å­—æ³•æ‰“å°æœºã€‚handheldç”¨äºŽå°çš„æ‰‹æŒçš„è®¾å¤‡ã€‚printç”¨äºŽæ‰“å°æœºã€‚projectionç”¨äºŽæ–¹æ¡ˆå±•ç¤ºï¼Œæ¯”å¦‚å¹»ç¯ç‰‡ã€‚screenç”¨äºŽç”µè„‘æ˜¾ç¤ºå™¨ã€‚ttyç”¨äºŽä½¿ç”¨å›ºå®šå¯†åº¦å­—æ¯æ …æ ¼çš„åª’ä½“ï¼Œæ¯”å¦‚ç”µä¼ æ‰“å­—æœºå’Œç»ˆç«¯ã€‚tvç”¨äºŽç”µè§†æœºç±»åž‹çš„è®¾å¤‡ã€‚é€»è¾‘æ“ä½œç¬¦åª’ä½“æŸ¥è¯¢æ“ä½œç¬¦åŒ…æ‹¬andï¼Œnotï¼Œonlyå’Œorï¼ˆä¹Ÿå¯ä»¥æ˜¯é€—å·â€œï¼Œâ€ï¼‰ã€‚andandæ“ä½œç¬¦åªæœ‰å½“å„ä¸ªæŸ¥è¯¢éƒ½ä¸ºtrueæ—¶ï¼Œæ‰è¿”å›žtrueã€‚æ¯”å¦‚ï¼Œä¸‹é¢çš„åª’ä½“æŸ¥è¯¢ä»…åœ¨å¯è§†åŒºåŸŸå®½åº¦ä¸å°äºŽ700åƒç´ å¹¶ä¸”åœ¨æ¨ªå±æ—¶æœ‰æ•ˆï¼š1@media (min-width: 700px) and (orientation: landscape) &#123; ... &#125;è¿™é‡Œåª’ä½“ç±»åž‹é»˜è®¤ä¸ºallï¼Œå¦‚æžœè¦å°†åª’ä½“ç±»åž‹é™åˆ¶ä¸ºç”µè„‘å±å¹•ï¼Œåˆ™æ”¹å†™åª’ä½“æŸ¥è¯¢ä¸ºï¼š1@media tv and (min-width: 700px) and (orientation: landscape) &#123; ... &#125;notnotå…³é”®å­—åº”ç”¨äºŽæ•´ä¸ªåª’ä½“æŸ¥è¯¢ï¼Œåœ¨åª’ä½“æŸ¥è¯¢ä¸ºå‡æ—¶è¿”å›žçœŸã€‚æ¯”å¦‚ä¸‹é¢çš„åª’ä½“æŸ¥è¯¢åœ¨å±å¹•å®½åº¦å¤§äºŽ700pxå¹¶ä¸”éžæ¨ªå±æ—¶æœ‰æ•ˆï¼š1@media not (min-width: 700px) and (orientation: landscape) &#123; ... &#125;å…¶ç­‰ä»·äºŽï¼š1@media not ((min-width: 700px) and (orientation: landscape)) &#123; ... &#125;é€—å·åˆ†éš”åˆ—è¡¨åª’ä½“æŸ¥è¯¢ä¸­ä½¿ç”¨é€—å·åˆ†éš”æ•ˆæžœç­‰åŒäºŽ or é€»è¾‘æ“ä½œç¬¦ã€‚å½“ä½¿ç”¨é€—å·åˆ†éš”çš„åª’ä½“æŸ¥è¯¢æ—¶ï¼Œå¦‚æžœä»»ä½•ä¸€ä¸ªåª’ä½“æŸ¥è¯¢è¿”å›žçœŸï¼Œæ ·å¼å°±æ˜¯æœ‰æ•ˆçš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœä½ æƒ³åœ¨æœ€å°å®½åº¦ä¸º700åƒç´ æˆ–æ˜¯æ¨ªå±çš„æ‰‹æŒè®¾å¤‡ä¸Šåº”ç”¨ä¸€ç»„æ ·å¼ï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼š1@media (min-width: 700px), handheld and (orientation: landscape) &#123; ... &#125;onlyonly å…³é”®å­—é˜²æ­¢è€æ—§çš„æµè§ˆå™¨ä¸æ”¯æŒå¸¦åª’ä½“å±žæ€§çš„æŸ¥è¯¢è€Œåº”ç”¨åˆ°ç»™å®šçš„æ ·å¼ï¼š1&lt;link rel="stylesheet" media="only screen and (color)" href="example.css" /&gt;å¸¸ç”¨åª’ä½“å±žæ€§å‘æ‰€æœ‰èƒ½æ˜¾ç¤ºé¢œè‰²çš„è®¾å¤‡åº”ç”¨æ ·å¼è¡¨ï¼š1@media all and (color) &#123; ... &#125;å‘æ‰€æœ‰é»‘ç™½è®¾å¤‡åº”ç”¨æ ·å¼è¡¨ï¼š1@media all and (monochrome) &#123; ... &#125;å‘ç«–å±è®¾å¤‡åº”ç”¨æ ·å¼è¡¨ï¼š1@media all and (orientation: portrait) &#123; ... &#125;å‘æ¨ªå±è®¾å¤‡åº”ç”¨æ ·å¼è¡¨ï¼š1@media all and (orientation: landscape) &#123; ... &#125;å‘æœ€å°åƒç´ å¯†åº¦ä¸º300dpiçš„è®¾å¤‡åº”ç”¨æ ·å¼è¡¨ï¼š1@media all and (min-resolution: 300dpi) &#123; ... &#125;å®½åº¦å’Œé«˜åº¦å±žæ€§ä¸Šé¢ä¾‹å­ä¸­æœ‰å‡ºçŽ°ï¼Œä¸å†èµ˜è¿°ã€‚]]></content>
      <tags>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS3 animation]]></title>
    <url>%2FCSS3-animation.html</url>
    <content type="text"><![CDATA[CSS3çš„animationå±žæ€§å¯ä»¥ç»˜åˆ¶å„ç§å¤æ‚çš„åŠ¨ç”»ï¼Œanimationå±žæ€§ç”±ä»¥ä¸‹8ç§å±žæ€§çš„ç®€å†™å½¢å¼ï¼š animation-nameï¼Œanimation-durationï¼Œanimation-timing-functionï¼Œanimation-delayï¼Œanimation-iteration-countï¼Œanimation-direction å’Œ animation-fill-modeã€‚ä¸‹é¢ä¸€ä¸€ä»‹ç»è¿™å…«ç§å±žæ€§ã€‚animation-nameCSS3ä¸­ä½¿ç”¨@keyframeså®šä¹‰åŠ¨ç”»çš„åç§°ä»¥åŠå…·ä½“åŠ¨ç”»çš„å…³é”®å¸§ã€‚è€Œanimation-nameå±žæ€§åˆ™æ˜¯ç”¨äºŽæŒ‡å®šä½¿ç”¨å“ªä¸ªåŠ¨ç”»ï¼Œæ¯”å¦‚ä½¿ç”¨@keyframeså®šä¹‰ä¸€ä¸ªç®€å•çš„åŠ¨ç”»ï¼š1234@-webkit-keyframes demo&#123; from &#123; left: 0; &#125; to &#123; left: 400px ;&#125;&#125;ä¹Ÿå¯ä»¥ä½¿ç”¨ç™¾åˆ†æ¯”æ¥å®šä¹‰å…³é”®å¸§ä½ç½®ï¼š12345@-webkit-keyframes demo&#123; 0% &#123; left: 0; &#125; 50% &#123; left: 200px; &#125; 100% &#123; left: 400px; &#125;&#125;ç„¶åŽä½¿ç”¨animation-nameå±žæ€§æŒ‡å®šä½¿ç”¨demoåŠ¨ç”»ï¼š123div &#123; -webkit-animation-name: demo;&#125;animation-durationanimation-durationæŒ‡å®šå¯¹è±¡åŠ¨ç”»çš„æŒç»­æ—¶é—´ã€‚å±žæ€§å€¼ä¸ºæ­£æ•°ï¼Œå•ä½å¯ä»¥æ˜¯ç§’(s)æˆ–è€…æ¯«ç§’(ms)ã€‚é»˜è®¤å€¼ä¸º0ï¼Œè¡¨æ˜ŽåŠ¨ç”»ä¸æ‰§è¡Œã€‚æ¯”å¦‚ï¼šSee the Pen QgRQgM by wuyouzhuguli (@mrbird) on CodePen.animation-timing-functionè®¾ç½®å¯¹è±¡åŠ¨ç”»çš„è¿‡æ¸¡ç±»åž‹ï¼Œå¦‚æžœæä¾›å¤šä¸ªå±žæ€§å€¼ï¼Œä»¥é€—å·è¿›è¡Œåˆ†éš”ã€‚ç±»ä¼¼äºŽtransition-timing-functionã€‚è¯­æ³•å¦‚ä¸‹ï¼š1animation-timing-function: linear | ease | ease-in | ease-out | ease-in-out | step-start | step-end | steps(&lt;number&gt;[, [ start | end ] ]?) | cubic-bezier(&lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;) [, linear | ease | ease-in | ease-out | ease-in-out | step-start | step-end | steps(&lt;number&gt;[, [ start | end ] ]?) | cubic-bezier(&lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;) ]*;å±žæ€§å¯å–çš„å€¼æœ‰ï¼šeaseï¼šç¼“è§£æ•ˆæžœï¼Œç­‰åŒäºŽcubic-bezier(0.25,0.1,0.25,1.0)å‡½æ•°ï¼Œæ—¢ç«‹æ–¹è´å¡žå°”ã€‚linearï¼šçº¿æ€§æ•ˆæžœï¼Œç­‰åŒäºŽcubic-bezier(0.0,0.0,1.0,1.0)å‡½æ•°ã€‚ease-inï¼šæ¸æ˜¾æ•ˆæžœï¼Œç­‰åŒäºŽcubic-bezier(0.42,0,1.0,1.0)å‡½æ•°ã€‚ease-outï¼šæ¸éšæ•ˆæžœï¼Œç­‰åŒäºŽcubic-bezier(0,0,0.58,1.0)å‡½æ•°ã€‚ease-in-outï¼šæ¸æ˜¾æ¸éšæ•ˆæžœï¼Œç­‰åŒäºŽcubic-bezier(0.42,0,0.58,1.0)å‡½æ•°ã€‚step-startï¼šé©¬ä¸Šè½¬è·³åˆ°åŠ¨ç”»ç»“æŸçŠ¶æ€ã€‚step-endï¼šä¿æŒåŠ¨ç”»å¼€å§‹çŠ¶æ€ï¼Œç›´åˆ°åŠ¨ç”»æ‰§è¡Œæ—¶é—´ç»“æŸï¼Œé©¬ä¸Šè½¬è·³åˆ°åŠ¨ç”»ç»“æŸçŠ¶æ€ã€‚steps(&lt;number&gt;[, [ start | end ] ]?)ï¼šç¬¬ä¸€ä¸ªå‚æ•°numberä¸ºæŒ‡å®šçš„é—´éš”æ•°ï¼Œå³æŠŠåŠ¨ç”»åˆ†ä¸ºnæ­¥é˜¶æ®µæ€§å±•ç¤ºï¼Œç¬¬äºŒä¸ªå‚æ•°é»˜è®¤ä¸ºendï¼Œè®¾ç½®æœ€åŽä¸€æ­¥çš„çŠ¶æ€ï¼Œstartä¸ºç»“æŸæ—¶çš„çŠ¶æ€ï¼Œendä¸ºå¼€å§‹æ—¶çš„çŠ¶æ€ï¼Œè‹¥è®¾ç½®ä¸Žanimation-fill-modeçš„æ•ˆæžœå†²çªï¼Œè€Œä»¥animation-fill-modeçš„è®¾ç½®ä¸ºåŠ¨ç”»ç»“æŸçš„çŠ¶æ€ã€‚cubic-bezier(&lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;)ï¼šç‰¹æ®Šçš„ç«‹æ–¹è´å¡žå°”æ›²çº¿æ•ˆæžœã€‚å„ç§æ•ˆæžœå¯¹æ¯”ï¼šSee the Pen WOBzLm by wuyouzhuguli (@mrbird) on CodePen.animation-delayè®¾ç½®åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´ã€‚é»˜è®¤å€¼0è¡¨ç¤ºç«‹å³æ‰§è¡Œï¼Œæ­£æ•°ä¸ºåŠ¨ç”»å»¶è¿Ÿä¸€å®šæ—¶é—´ï¼Œè´Ÿæ•°ä¸ºæˆªæ–­ä¸€å®šæ—¶é—´å†…çš„åŠ¨ç”»ã€‚å•ä½ä¸ºç§’(s)æˆ–æ¯«ç§’(s)ã€‚å…·ä½“å®žä¾‹ï¼šSee the Pen zzQjOK by wuyouzhuguli (@mrbird) on CodePen.animation-iteration-countæŒ‡å®šå¯¹è±¡åŠ¨ç”»å¾ªçŽ¯æ’­æ”¾çš„æ¬¡æ•°ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1animation-iteration-count: &lt;number&gt;|infinite;å€¼ä¸ºnumberï¼šè‡ªå®šä¹‰åŠ¨ç”»æ‰§è¡Œæ¬¡æ•°ï¼Œè®¾ç½®å€¼å¯ä¸º0æˆ–æ­£æ•´æ•°ã€‚infiniteï¼šæ— é™å¾ªçŽ¯ã€‚See the Pen dREeoJ by wuyouzhuguli (@mrbird) on CodePen.animation-directionç½®å¯¹è±¡åŠ¨ç”»å¾ªçŽ¯æ’­æ”¾æ¬¡æ•°å¤§äºŽ1æ¬¡æ—¶ï¼ŒåŠ¨ç”»æ˜¯å¦åå‘è¿åŠ¨ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1animation-direction: normal | reverse | alternate | alternate-reverse [, normal | reverse | alternate | alternate-reverse ]*;å±žæ€§å¯å–çš„å€¼æœ‰ï¼šnormalï¼šæ­£å¸¸æ–¹å‘ã€‚reverseï¼šåŠ¨ç”»åå‘è¿è¡Œ,æ–¹å‘å§‹ç»ˆä¸Žnormalç›¸åã€‚ï¼ˆFF14.0.1ä»¥ä¸‹ä¸æ”¯æŒï¼‰ã€‚alternateï¼šåŠ¨ç”»ä¼šå¾ªçŽ¯æ­£åæ–¹å‘äº¤æ›¿è¿åŠ¨ï¼Œå¥‡æ•°æ¬¡ï¼ˆ1ã€3ã€5â€¦â€¦ï¼‰ä¼šæ­£å¸¸è¿åŠ¨ï¼Œå¶æ•°æ¬¡ï¼ˆ2ã€4ã€6â€¦â€¦ï¼‰ä¼šåå‘è¿åŠ¨ï¼Œå³æ‰€æœ‰ç›¸å…³è”çš„å€¼éƒ½ä¼šåå‘ã€‚alternate-reverseï¼šåŠ¨ç”»ä»Žåå‘å¼€å§‹ï¼Œå†æ­£åæ–¹å‘äº¤æ›¿è¿åŠ¨ï¼Œè¿åŠ¨æ–¹å‘å§‹ç»ˆä¸Žalternateå®šä¹‰çš„ç›¸åã€‚ï¼ˆFF14.0.1ä»¥ä¸‹ä¸æ”¯æŒï¼‰ã€‚å„ä¸ªæ•ˆæžœå¯¹æ¯”ï¼šSee the Pen QgRrEL by wuyouzhuguli (@mrbird) on CodePen.animation-fill-modeè®¾ç½®å¯¹è±¡åŠ¨ç”»æ—¶é—´ä¹‹å¤–çš„çŠ¶æ€ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1animation-fill-mode: none | forwards | backwards | both;å±žæ€§å¯å–çš„å€¼æœ‰ï¼šnoneï¼šé»˜è®¤å€¼ã€‚ä¸è®¾ç½®å¯¹è±¡åŠ¨ç”»ä¹‹å¤–çš„çŠ¶æ€ã€‚forwardsï¼šç»“æŸåŽä¿æŒåŠ¨ç”»ç»“æŸæ—¶çš„çŠ¶æ€ï¼Œä½†å½“animation-directionä¸º0ï¼Œåˆ™åŠ¨ç”»ä¸æ‰§è¡Œï¼ŒæŒç»­ä¿æŒåŠ¨ç”»å¼€å§‹æ—¶çš„çŠ¶æ€ã€‚backwardsï¼šç»“æŸåŽè¿”å›žåŠ¨ç”»å¼€å§‹æ—¶çš„çŠ¶æ€ã€‚bothï¼šç»“æŸåŽå¯éµå¾ªforwardså’Œbackwardsä¸¤ä¸ªè§„åˆ™ã€‚See the Pen KqLRap by wuyouzhuguli (@mrbird) on CodePen.animation-play-stateè®¾ç½®å¯¹è±¡åŠ¨ç”»çš„çŠ¶æ€ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1animation-play-state: running | pausedå…¶ä¸­runningä¸ºé»˜è®¤å€¼ï¼Œè¡¨ç¤ºè¿è¡ŒåŠ¨ç”»ä¸­ï¼›pausedè¡¨ç¤ºæš‚åœåŠ¨ç”»ã€‚ä¾‹å¦‚ï¼šSee the Pen owRdwd by wuyouzhuguli (@mrbird) on CodePen.å‚è€ƒè‡ªhttp://isux.tencent.com/css3]]></content>
      <tags>
        <tag>CSS3</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS3 transition]]></title>
    <url>%2FCSS3-transition.html</url>
    <content type="text"><![CDATA[transformå‘ˆçŽ°çš„æ˜¯ä¸€ç§å˜å½¢ç»“æžœï¼Œè€ŒTransationå‘ˆçŽ°çš„æ˜¯ä¸€ç§è¿‡æ¸¡ï¼Œé€šä¿—ç‚¹è¯´å°±æ˜¯ä¸€ç§åŠ¨ç”»è½¬æ¢è¿‡ç¨‹ï¼Œå¦‚æ¸æ˜¾ã€æ¸å¼±ã€åŠ¨ç”»å¿«æ…¢ç­‰ã€‚transitionå¯ä»¥å’ŒTransformåŒæ—¶ä½¿ç”¨ã€‚transitionæ˜¯ä¸€ä¸ªå¤åˆå±žæ€§ï¼Œå¯ä»¥åŒæ—¶å®šä¹‰transition-propertyã€transition-durationã€transition-timing-functionã€transition-delayå­å±žæ€§å€¼ã€‚transition-propertytransition-propertyè®¾ç½®è¦ä»¥åŠ¨ç”»æ–¹å¼å˜æ¢çš„CSSå±žæ€§ã€‚é»˜è®¤å€¼allè¡¨ç¤ºå˜æ¢æ‰€æœ‰çš„å±žæ€§ï¼Œå¦‚æžœåªé’ˆå¯¹å•ä¸ªæˆ–è€…å¤šä¸ªCSSå±žæ€§è¿›è¡Œå˜æ¢ï¼Œå°±å¯ä»¥ç”¨è¿™ä¸ªå±žæ€§æ¥è¿›è¡Œå•ç‹¬è®¾ç½®ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1transition-property: all | none | &lt;property&gt;[ ,&lt;property&gt; ]*ä¾‹å¦‚ï¼šSee the Pen ModvYa by wuyouzhuguli (@mrbird) on CodePen.transition-durationtransition-durationç”¨æ¥å®šä¹‰è½¬æ¢åŠ¨ç”»çš„æ—¶é—´é•¿åº¦ï¼Œå³ä»Žæ—§å±žæ€§æ¢åˆ°æ–°å±žæ€§èŠ±è´¹çš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚é»˜è®¤æƒ…å†µä¸‹åŠ¨ç”»è¿‡æ¸¡æ—¶é—´ä¸º0ç§’ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1transition-duration:&lt;time&gt;[ ,&lt;time&gt;]*;ä¾‹å¦‚ï¼šSee the Pen OgYjXq by wuyouzhuguli (@mrbird) on CodePen.transition-delaytransition-delayå¯ä»¥è®¾ç½®åŠ¨ç”»å»¶è¿Ÿæ‰§è¡Œçš„æ—¶é—´ï¼Œé»˜è®¤å€¼0è¡¨ç¤ºç«‹å³æ‰§è¡Œï¼Œæ—¶é—´å¯ä»¥æ˜¯æ­£æ•°ä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°ï¼Œè´Ÿæ•°è¡¨ç¤ºæˆªæ–­è§„å®šæ—¶é—´å†…çš„åŠ¨ç”»ã€‚å•ä½æ˜¯ç§’ï¼Œä¹Ÿå¯ä»¥æ˜¯æ¯«ç§’ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1transition-delay:&lt;time&gt;[ ,&lt;time&gt;]*;timeçš„å–å€¼ï¼š0ï¼šä¸å»¶è¿Ÿï¼Œç›´æŽ¥æ‰§è¡Œã€‚æ­£æ•°ï¼šæŒ‰ç…§è®¾ç½®çš„æ—¶é—´å»¶è¿Ÿã€‚è´Ÿæ•°ï¼šè®¾ç½®æ—¶é—´å‰çš„åŠ¨ç”»å°†è¢«æˆªæ–­ã€‚See the Pen dREzWK by wuyouzhuguli (@mrbird) on CodePen.transition-timing-functiontransition-timing-functionå¯ä»¥è®¾ç½®åŠ¨ç”»çš„è¿‡æ¸¡æ•ˆæžœï¼Œé»˜è®¤å€¼easeã€‚è¯­æ³•å¦‚ä¸‹ï¼š1transition-timing-function: linear | ease | ease-in | ease-out | ease-in-out | cubic-bezier(&lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;)[ ,linear | ease | ease-in | ease-out | ease-in-out | cubic-bezier(&lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;) ]* ;å±žæ€§å¯å–çš„å€¼å¦‚ä¸‹ï¼šeaseï¼šç¼“è§£æ•ˆæžœï¼Œç­‰åŒäºŽcubic-bezier(0.25,0.1,0.25,1.0)å‡½æ•°ï¼Œæ—¢ç«‹æ–¹è´å¡žå°”ã€‚linearï¼šçº¿æ€§æ•ˆæžœï¼Œç­‰åŒäºŽcubic-bezier(0.0,0.0,1.0,1.0)å‡½æ•°ã€‚ease-inï¼šæ¸æ˜¾æ•ˆæžœï¼Œç­‰åŒäºŽcubic-bezier(0.42,0,1.0,1.0)å‡½æ•°ã€‚ease-outï¼šæ¸éšæ•ˆæžœï¼Œç­‰åŒäºŽcubic-bezier(0,0,0.58,1.0)å‡½æ•°ã€‚ease-in-outï¼šæ¸æ˜¾æ¸éšæ•ˆæžœï¼Œç­‰åŒäºŽcubic-bezier(0.42,0,0.58,1.0)å‡½æ•°ã€‚cubic-bezierï¼šç‰¹æ®Šçš„ç«‹æ–¹è´å¡žå°”æ›²çº¿æ•ˆæžœã€‚å„ç§æ•ˆæžœå¯¹æ¯”ï¼šSee the Pen LLojdr by wuyouzhuguli (@mrbird) on CodePen.å¤šä¸ªå€¼çš„è¿ç”¨CSS3é‡Œå¤´çš„åŠ¨ç”»å±žæ€§å¯ä»¥å¯¹åº”å¤šä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥å¯¹è¿›è¡ŒåŠ¨ç”»çš„ä¸åŒçš„å±žæ€§æ¥è®¾ç½®ä¸ä¸€æ ·çš„å€¼ã€‚ä¸¾ä¸ªä¾‹å­è¯´æ˜Žï¼šSee the Pen ZyNXxj by wuyouzhuguli (@mrbird) on CodePen.å¯ä»¥çœ‹å‡ºç¬¬ä¸€ä¸ªå…ƒç´ æ‰€æœ‰çš„å±žæ€§éƒ½æ˜¯åœ¨åŒæ ·çš„æ—¶é—´å†…å®Œæˆäº†åŠ¨ç”»ï¼Œè€Œç¬¬äºŒä¸ªå…ƒç´ çš„left,top,backgroundæ˜¯åœ¨ä¸åŒçš„æ—¶é—´å†…å®ŒæˆåŠ¨ç”»ï¼Œè¿™å°±æ˜¯å¯¹å˜æ¢æ—¶é—´è®¾ç½®äº†å¤šä¸ªå€¼çš„æ•ˆæžœï¼Œæ¯ä¸ªè¿›è¡ŒåŠ¨ç”»çš„å±žæ€§å¯¹åº”äº†ç›¸åº”çš„å˜æ¢æ—¶é—´ã€‚å‚è€ƒè‡ªhttp://isux.tencent.com/css3]]></content>
      <tags>
        <tag>CSS3</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS3 transform]]></title>
    <url>%2FCSS3-transform.html</url>
    <content type="text"><![CDATA[transformå±žæ€§èƒ½å¯¹å…ƒç´ å¯¹è±¡è¿›è¡Œå˜å½¢æ“ä½œï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼šæ—‹è½¬rotateã€ç¼©æ”¾scaleã€ç§»åŠ¨translateã€å€¾æ–œskewä»¥åŠçŸ©é˜µå˜å½¢matrixã€‚åŸºæœ¬è¯­æ³•ï¼š1transform: none | &lt;transform-function&gt;[&lt;transform-function&gt;]*noneè¡¨ç¤ºä¸è¿›è¡Œå˜æ¢ï¼›&lt;transform-function&gt;è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªå˜æ¢å‡½æ•°ï¼Œä»¥ç©ºæ ¼åˆ†å¼€ï¼Œå› æ­¤å¯ä»¥åŒæ—¶å¯¹ä¸€ä¸ªå…ƒç´ è¿›è¡Œtransformçš„å¤šç§å±žæ€§æ“ä½œã€‚åŒ…æ‹¬ï¼šrotate(&lt;angle&gt;)ï¼šæ—‹è½¬å…ƒç´ ã€‚scale(&lt;number&gt;[, &lt;number&gt;])ï¼šç¼©æ”¾å…ƒç´ ã€‚translate(&lt;translation-value&gt;[, &lt;translation-value&gt;])ï¼šç§»åŠ¨å…ƒç´ ã€‚skew(&lt;angle&gt; [,&lt;angle&gt;])ï¼šå€¾æ–œå…ƒç´ ã€‚matrix(&lt;number&gt;,&lt;number&gt;,&lt;number&gt;,&lt;number&gt;,&lt;number&gt;,&lt;number&gt;)ï¼šçŸ©é˜µå˜å½¢ã€‚perspective(length)ï¼šé€è§†ã€‚rotate()rotate()å‡½æ•°èƒ½å¤Ÿæ—‹è½¬å…ƒç´ ï¼Œå®ƒä¸»è¦æ˜¯åœ¨äºŒç»´ç©ºé—´å†…è¿›è¡Œæ“ä½œï¼Œé€šè¿‡ä¸€ä¸ªè§’åº¦å‚æ•°å€¼ï¼Œæ¥è®¾å®šæ—‹è½¬çš„å¹…åº¦ã€‚å¦‚æžœå¯¹å…ƒç´ æœ¬èº«æˆ–è€…å…ƒç´ è®¾ç½®äº†perspectiveå€¼ï¼Œé‚£ä¹ˆrotate3d()å‡½æ•°å¯ä»¥å®žçŽ°ä¸€ä¸ª3ç»´ç©ºé—´å†…çš„æ—‹è½¬ã€‚åŸºæœ¬è¯­æ³•ï¼š1transform:rotate(&lt;angle&gt;);å–å€¼å¦‚ä¸‹ï¼šrotate(&lt;angle&gt;)ï¼š&lt;angle&gt;ä¸ºä¸€ä¸ªè§’åº¦å€¼ï¼Œå•ä½degï¼Œå¯ä»¥ä¸ºæ­£æ•°æˆ–è€…è´Ÿæ•°ï¼Œæ­£æ•°æ˜¯é¡ºæ—¶é’ˆæ—‹è½¬ï¼Œè´Ÿæ•°æ˜¯é€†æ—¶é’ˆæ—‹è½¬ã€‚rotateX(angele)ï¼šç›¸å½“äºŽrotate3d(1,0,0,angle)æŒ‡å®šåœ¨3ç»´ç©ºé—´å†…çš„Xè½´æ—‹è½¬ã€‚rotateY(angele)ï¼šç›¸å½“äºŽrotate3d(0,1,0,angle)æŒ‡å®šåœ¨3ç»´ç©ºé—´å†…çš„Yè½´æ—‹è½¬ã€‚rotateZ(angele)ï¼šç›¸å½“äºŽrotate3d(0,0,1,angle)æŒ‡å®šåœ¨3ç»´ç©ºé—´å†…çš„Zè½´æ—‹è½¬ã€‚å…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼šSee the Pen JJqbzj by wuyouzhuguli (@mrbird) on CodePen.å…³äºŽperspectiveè§ä¸‹æ–‡ä»‹ç»ã€‚scale()scale()å‡½æ•°èƒ½å¤Ÿç¼©æ”¾å…ƒç´ ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1transform:scale(&lt;number&gt;[, &lt;number&gt;]);å–å€¼å¦‚ä¸‹ï¼šscale(&lt;number&gt;[, &lt;number&gt;])è¡¨ç¤ºä½¿å…ƒç´ åœ¨Xè½´å’ŒYè½´åŒæ—¶ç¼©æ”¾ã€‚&lt;number&gt;è¡¨ç¤ºç¼©æ”¾å€æ•°ï¼Œå¯ä»¥æ˜¯æ­£æ•°ï¼Œè´Ÿæ•°å’Œå°æ•°ã€‚è´Ÿæ•°æ˜¯å…ˆç¿»è½¬å…ƒç´ ç„¶åŽå†ç¼©æ”¾ï¼ŒXå€¼ä¸ºè´Ÿï¼Œç»•Yè½´æ—‹è½¬ï¼›Yå€¼ä¸ºè´Ÿï¼Œç»•Xè½´æ—‹è½¬ã€‚åŒ…å«ä¸¤ä¸ªå‚æ•°ï¼Œå¦‚æžœç¼ºå°‘ç¬¬äºŒä¸ªå‚æ•°ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªå‚æ•°çš„å€¼ç­‰äºŽç¬¬ä¸€ä¸ªå‚æ•°ã€‚scaleX(&lt;number&gt;)è¡¨ç¤ºåªåœ¨Xè½´(æ°´å¹³æ–¹å‘)ç¼©æ”¾å…ƒç´ ã€‚scaleY(&lt;number&gt;)è¡¨ç¤ºåªåœ¨Yè½´(åž‚ç›´æ–¹å‘)ç¼©æ”¾å…ƒç´ ã€‚scaleZ(&lt;number&gt;)è¡¨ç¤ºåªåœ¨Zè½´ç¼©æ”¾å…ƒç´ ã€‚å‰ææ˜¯å…ƒç´ æœ¬èº«æˆ–è€…å…ƒç´ çš„çˆ¶å…ƒç´ è®¾å®šäº†é€è§†å€¼ã€‚å…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼šSee the Pen yXWgLG by wuyouzhuguli (@mrbird) on CodePen.translate()translate()å‡½æ•°èƒ½å¤Ÿç§»åŠ¨å…ƒç´ ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1transform:translate(&lt;translation-value&gt;[, &lt;translation-value&gt;]);å–å€¼å¦‚ä¸‹ï¼štranslate(&lt;translation-value&gt;[, &lt;translation-value&gt;])è¡¨ç¤ºä½¿å…ƒç´ åœ¨Xè½´å’ŒYè½´åŒæ—¶ç§»åŠ¨ï¼Œ&lt;translation-value&gt;è¡¨ç¤ºä½ç§»é‡ã€‚åŒ…å«ä¸¤ä¸ªå‚æ•°ï¼Œå¦‚æžœçœç•¥äº†ç¬¬äºŒä¸ªå‚æ•°åˆ™ç¬¬äºŒä¸ªå‚æ•°ä¸º0ï¼›å¦‚æžœå‚æ•°ä¸ºè´Ÿï¼Œåˆ™è¡¨ç¤ºå¾€ç›¸åçš„æ–¹å‘ç§»åŠ¨ã€‚translateX(&lt;translation-value&gt;)è¡¨ç¤ºåªåœ¨Xè½´(æ°´å¹³æ–¹å‘)ç§»åŠ¨å…ƒç´ ã€‚translateY(&lt;translation-value&gt;)è¡¨ç¤ºåªåœ¨Yè½´(åž‚ç›´æ–¹å‘)ç§»åŠ¨å…ƒç´ ã€‚translateZ(&lt;translation-value&gt;)è¡¨ç¤ºåªåœ¨Zè½´ç§»åŠ¨å…ƒç´ ï¼Œå‰ææ˜¯å…ƒç´ æœ¬èº«æˆ–è€…å…ƒç´ çš„çˆ¶å…ƒç´ è®¾å®šäº†é€è§†å€¼ã€‚å…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼šSee the Pen mwYRPw by wuyouzhuguli (@mrbird) on CodePen.skew()skew()å‡½æ•°èƒ½å¤Ÿè®©å…ƒç´ å€¾æ–œæ˜¾ç¤ºã€‚è¯­æ³•å¦‚ä¸‹ï¼š1transform:skew(&lt;angle&gt; [,&lt;angle&gt;]);å–å€¼å¦‚ä¸‹ï¼šskew(&lt;angle&gt; [, &lt;angle&gt;])åŒ…å«ä¸¤ä¸ªå‚æ•°å€¼ï¼Œåˆ†åˆ«è¡¨ç¤ºXè½´å’ŒYè½´å€¾æ–œçš„è§’åº¦ï¼Œå¦‚æžœç¬¬äºŒä¸ªå‚æ•°ä¸ºç©ºï¼Œåˆ™é»˜è®¤ä¸º0ï¼Œå‚æ•°ä¸ºè´Ÿè¡¨ç¤ºå‘ç›¸åæ–¹å‘å€¾æ–œã€‚skewX(&lt;angle&gt;)è¡¨ç¤ºåªåœ¨Xè½´(æ°´å¹³æ–¹å‘)å€¾æ–œã€‚skewY(&lt;angle&gt;)è¡¨ç¤ºåªåœ¨Yè½´(åž‚ç›´æ–¹å‘)å€¾æ–œã€‚See the Pen GEarWO by wuyouzhuguli (@mrbird) on CodePen.perspectiveperspectiveä¸ºé€è§†çš„æ„æ€ï¼Œç”¨äºŽè®¾å®šæŸ¥çœ‹å…ƒç´ çš„ä½ç½®ï¼Œè¥é€ ä¸€ç§3Dçš„ç©ºé—´æ„Ÿï¼Œå€¼è¶Šå¤§ï¼Œæ„Ÿè§‰ä¸Šç¦»å¾—è¶Šè¿œï¼›å€¼è¶Šå°ï¼Œæ„Ÿè§‰æ˜¯ç¦»å¾—è¶Šè¿‘ã€‚è¿™å¯¹3Då˜æ¢çš„å…ƒç´ æ¥è¯´æ˜¯å¿…é¡»çš„å±žæ€§ã€‚å†™æ³•æœ‰ä¸¤ç§ï¼šå•ç‹¬ä½œä¸ºä¸€ä¸ªå±žæ€§ï¼šdiv { perspective: 100px}ã€‚é…åˆtransformï¼šdiv { transform: perspective(100px) rotateX(60deg) }ã€‚å¯¹æ¯”å…·æœ‰perspectiveå€¼åŠæ²¡æœ‰perspectiveå€¼çš„åŒºåˆ«ï¼šSee the Pen webgNR by wuyouzhuguli (@mrbird) on CodePen.å¯¹æ¯”persepctiveå€¼çš„å¤§å°å¯¹3Dæ•ˆæžœçš„å½±å“ï¼šSee the Pen vZwgwR by wuyouzhuguli (@mrbird) on CodePen.ä¸Šé¢ç»“æžœå°è¯äº†ï¼šå€¼è¶Šå¤§ï¼Œæ„Ÿè§‰ä¸Šç¦»å¾—è¶Šè¿œï¼›å€¼è¶Šå°ï¼Œæ„Ÿè§‰æ˜¯ç¦»å¾—è¶Šè¿‘çš„ç»“è®ºã€‚transform-origintransformçš„å‚ç…§ç‚¹é»˜è®¤ä¸ºå…ƒç´ çš„ä¸­å¿ƒç‚¹ï¼Œå¦‚æžœè¦æ”¹å˜è¿™ä¸ªå‚ç…§ç‚¹ï¼Œå¯ä»¥æ˜¯ç”¨transform-originå±žæ€§è¿›è¡Œè‡ªå®šä¹‰ã€‚è¯¥å±žæ€§æä¾›2ä¸ªå‚æ•°å€¼ï¼Œç¬¬ä¸€ä¸ªç”¨äºŽæ¨ªåæ ‡ï¼Œç¬¬äºŒä¸ªç”¨äºŽçºµåæ ‡ï¼›å¦‚æžœåªæä¾›ä¸€ä¸ªï¼Œè¯¥å€¼å°†ç”¨äºŽæ¨ªåæ ‡ï¼Œçºµåæ ‡å°†é»˜è®¤ä¸º50%ï¼špercentageï¼šç”¨ç™¾åˆ†æ¯”æŒ‡å®šåæ ‡å€¼ã€‚å¯ä»¥ä¸ºè´Ÿå€¼ã€‚lengthï¼šç”¨é•¿åº¦å€¼æŒ‡å®šåæ ‡å€¼ã€‚å¯ä»¥ä¸ºè´Ÿå€¼ã€‚left center rightæ˜¯æ°´å¹³æ–¹å‘å–å€¼ï¼Œè€Œtop center bottomæ˜¯åž‚ç›´æ–¹å‘çš„å–å€¼ã€‚æŸ¥çœ‹è®¾ç½®ä¸åŒä¸­å¿ƒç‚¹çš„æ—‹è½¬æ•ˆæžœï¼šSee the Pen OgYpJd by wuyouzhuguli (@mrbird) on CodePen.backface-visibilitybackface-visibilityå±žæ€§å¯ç”¨äºŽéšè—å†…å®¹çš„èƒŒé¢ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒèƒŒé¢å¯è§ï¼Œè¿™æ„å‘³ç€å³ä½¿åœ¨ç¿»è½¬åŽï¼Œå˜æ¢çš„å†…å®¹ä»ç„¶å¯è§ã€‚ä½†å½“backface-visibilityè®¾ç½®ä¸º hidden æ—¶ï¼Œæ—‹è½¬åŽå†…å®¹å°†éšè—ï¼Œå› ä¸ºæ—‹è½¬åŽæ­£é¢å°†ä¸å†å¯è§ã€‚See the Pen OgYpyq by wuyouzhuguli (@mrbird) on CodePen.transform-styleè®¾ç½®å†…åµŒçš„å…ƒç´ åœ¨ 3D ç©ºé—´å¦‚ä½•å‘ˆçŽ°ã€‚æœ‰ä¸¤ä¸ªå€¼ï¼šflatï¼šæ‰€æœ‰å­å…ƒç´ åœ¨ 2D å¹³é¢å‘ˆçŽ°ã€‚preserve-3dï¼šä¿ç•™3Dç©ºé—´ã€‚æ¯”å¦‚ï¼šSee the Pen ZyNeJL by wuyouzhuguli (@mrbird) on CodePen.å‚è€ƒè‡ªhttp://isux.tencent.com/css3/]]></content>
      <tags>
        <tag>CSS3</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS3èƒŒæ™¯å±žæ€§]]></title>
    <url>%2FCSS3%E8%83%8C%E6%99%AF%E5%B1%9E%E6%80%A7.html</url>
    <content type="text"><![CDATA[background-sizebackground-sizeå±žæ€§ç”¨æ¥æŽ§åˆ¶èƒŒæ™¯å›¾ç‰‡çš„å¤§å°ã€‚å‚æ•°çš„å€¼å¯ä»¥æ˜¯æ•°å€¼ä¹Ÿå¯ä»¥æ˜¯ç™¾åˆ†æ•°ï¼Œè¿˜å¯ä»¥æ˜¯coverå’Œcontainã€‚å¦‚æžœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œæ­¤å€¼ç”¨æ¥è§„å®šèƒŒæ™¯å›¾ç‰‡çš„å®½åº¦ï¼Œè¿™ä¸ªæ—¶å€™èƒŒæ™¯å›¾ç‰‡çš„é«˜åº¦æ˜¯æŒ‰ç…§å®½åº¦è¿›è¡Œç­‰æ¯”ä¾‹ç¼©æ”¾ï¼›å¦‚æžœæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥è§„å®šèƒŒæ™¯å›¾ç‰‡çš„å®½åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°ç”¨æ¥è§„å®šèƒŒæ™¯å›¾ç‰‡çš„é«˜åº¦ã€‚æ•°å€¼æˆ–ç™¾åˆ†æ¯”ä¾‹å¦‚ï¼šSee the Pen pwBKrV by wuyouzhuguli (@mrbird) on CodePen.å½“è®¾ç½®background-sizeä¸º120%æ—¶ï¼Œå°ºå¯¸è¶…è¿‡å®¹å™¨ï¼Œå›¾ç‰‡å°†ä¼šè¢«è£åˆ‡ã€‚coverå±žæ€§å€¼è®¾ç½®ä¸ºcoverä¹‹åŽï¼ŒèƒŒæ™¯å›¾åƒä¼šç­‰æ¯”ç¼©æ”¾åˆ°å®Œå…¨è¦†ç›–å®¹å™¨ï¼ŒèƒŒæ™¯å›¾åƒæœ‰å¯èƒ½è¶…å‡ºå®¹å™¨ï¼Œä¸è¿‡è¶…å‡ºçš„éƒ¨åˆ†å°†ä¼šè¢«è£åˆ‡ã€‚ä¾‹å¦‚ï¼šSee the Pen PjgaEp by wuyouzhuguli (@mrbird) on CodePen.containcontainä¸Žcoverçš„åŒºåˆ«æ˜¯ï¼ŒcontainåªæŒ‘æ¨ªå‘æˆ–è€…çºµå‘ä»»æ„ä¸€ä¸ªæ–¹ä½å°†å®¹å™¨å¡«å……æ»¡ï¼šSee the Pen yXrEER by wuyouzhuguli (@mrbird) on CodePen.background-originbackground-originå±žæ€§ç”¨äºŽæŒ‡å®šèƒŒæ™¯å›¾ç‰‡ä»Žä»€ä¹ˆåœ°æ–¹å¼€å§‹ç»˜åˆ¶ï¼Œä½†å¹¶ä¸é™åˆ¶ç»˜åˆ¶åŒºåŸŸã€‚é»˜è®¤å€¼ä¸ºpadding-boxè¯­æ³•å¦‚ä¸‹ï¼š1background-origin:border-box|padding-box|content-boxborder-boxæ­¤å±žæ€§å€¼è§„å®šèƒŒæ™¯å›¾ç‰‡ä»ŽborderåŒºåŸŸå¼€å§‹ç»˜åˆ¶ï¼ˆåŒ…æ‹¬borderï¼‰ã€‚æ¯”å¦‚ï¼šSee the Pen gRyKQR by wuyouzhuguli (@mrbird) on CodePen.å¯ä»¥çœ‹å‡ºèƒŒæ™¯å›¾ç‰‡æ˜¯ä»Žè¾¹æ¡†å¼€å§‹æ¸²æŸ“çš„ï¼ŒåŒ…æ‹¬è¾¹æ¡†åŒºåŸŸã€‚padding-boxè§„å®šèƒŒæ™¯å›¾ç‰‡æ˜¯ä»Žpaddingå¼€å§‹ç»˜åˆ¶çš„ï¼ŒåŒ…æ‹¬paddingåŒºåŸŸï¼Œä¾‹å¦‚ï¼šSee the Pen JJVZzd by wuyouzhuguli (@mrbird) on CodePen.å¯è§èƒŒæ™¯å›¾ç‰‡æ˜¯ä»ŽpaddingåŒºåŸŸå¼€å§‹ç»˜åˆ¶çš„ã€‚content-boxæ­¤å±žæ€§å€¼è§„å®šï¼ŒèƒŒæ™¯å›¾ç‰‡æ˜¯ä»Žå†…å®¹åŒºåŸŸå¼€å§‹ç»˜åˆ¶çš„ï¼Œæ‰€è°“å†…å®¹åŒºåŸŸå°±æ˜¯å‡ºåŽ»borderå’ŒpaddingåŒºåŸŸï¼Œæ¯”å¦‚ï¼šSee the Pen WOWyWy by wuyouzhuguli (@mrbird) on CodePen.å¯è§ï¼ŒèƒŒæ™¯å›¾ç‰‡æ˜¯ä»Žå†…å®¹åŒºåŸŸå¼€å§‹ç»˜åˆ¶çš„ã€‚ä½†å³ä¸‹è§’paddingå’ŒborderåŒºåŸŸéƒ½æœ‰èƒŒæ™¯å›¾ç‰‡çš„æ˜¾ç¤ºï¼Œå› ä¸ºbackground-originå±žæ€§ä»Žåå­—å¯ä»¥çœ‹å‡ºï¼Œå®ƒåªè§„å®šå›¾ç‰‡çš„èµ·æºä½ç½®ï¼Œè€Œå¹¶ä¸å…³å¿ƒå›¾ç‰‡çš„ç»“æŸä½ç½®ã€‚è¦é™åˆ¶å›¾ç‰‡çš„ç»“æŸä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨background-clipå±žæ€§ã€‚background-clipbackground-clipå±žæ€§è§„å®šèƒŒæ™¯å›¾ç‰‡åœ¨å“ªäº›åŒºåŸŸå¯ä»¥æ˜¾ç¤ºã€‚è¯­æ³•å¦‚ä¸‹ï¼š1background-clip:border-box|padding-box|content-box|text|no-clipborder-boxborder-boxå±žæ€§å€¼è§„å®šï¼ŒèƒŒæ™¯å›¾ç‰‡å¯ä»¥åœ¨è¾¹æ¡†èŒƒå›´å†…æ˜¾ç¤ºï¼Œä¾‹å¦‚ï¼šSee the Pen zzXLOY by wuyouzhuguli (@mrbird) on CodePen.å¯çœ‹åˆ°ï¼Œè™½ç„¶è§„å®šèƒŒæ™¯å›¾å¯åœ¨è¾¹æ¡†å†…æ˜¾ç¤ºï¼Œä½†å·¦ä¸ŠåŒºåŸŸè¾¹æ¡†ä¸‹å´æ²¡æœ‰èƒŒæ™¯å›¾ï¼Œå› ä¸ºbackground-originå±žæ€§çš„é»˜è®¤å€¼ä¸ºpadding-boxï¼padding-boxpadding-boxå±žæ€§å€¼è§„å®šï¼ŒèƒŒæ™¯å›¾ç‰‡å¯ä»¥åœ¨paddingèŒƒå›´å†…æ˜¾ç¤ºï¼Œä¸èƒ½åœ¨borderåŒºåŸŸæ˜¾ç¤ºï¼Œä¾‹å¦‚ï¼šSee the Pen LLvBYZ by wuyouzhuguli (@mrbird) on CodePen.content-boxcontent-boxå±žæ€§å€¼è§„å®šèƒŒæ™¯å›¾ç‰‡å¯ä»¥åœ¨contentåŒºåŸŸï¼Œä¹Ÿå°±æ˜¯é™¤åŽ»paddingå’Œborderçš„åŒºåŸŸå†…æ˜¾ç¤ºï¼Œä¾‹å¦‚ï¼šSee the Pen XgQBJr by wuyouzhuguli (@mrbird) on CodePen.å¯ä»¥çœ‹å‡ºï¼ŒèƒŒæ™¯å›¾ç‰‡è¿™ä¸ªæ—¶å€™åªèƒ½å¤Ÿåœ¨contentèŒƒå›´å†…æ˜¾ç¤ºäº†ã€‚textä»Žå‰æ™¯å†…å®¹çš„å½¢çŠ¶ï¼ˆæ¯”å¦‚æ–‡å­—ï¼‰ä½œä¸ºè£å‰ªåŒºåŸŸå‘å¤–è£å‰ªï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰å‰æ™¯å†…å®¹çš„å½¢çŠ¶å†…æ˜¾ç¤ºèƒŒæ™¯å›¾ç‰‡ï¼Œä¾‹å¦‚åªæœ‰æ–‡å­—å†…æ˜¾ç¤ºèƒŒæ™¯ã€‚æ¯”å¦‚ï¼šSee the Pen PjgBqQ by wuyouzhuguli (@mrbird) on CodePen.å‚è€ƒè‡ªï¼šhttp://www.softwhy.com/]]></content>
      <tags>
        <tag>CSS3</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS3è¾¹æ¡†ç›¸å…³å±žæ€§]]></title>
    <url>%2FCSS3%E8%BE%B9%E6%A1%86%E7%9B%B8%E5%85%B3%E5%B1%9E%E6%80%A7.html</url>
    <content type="text"><![CDATA[CSS3æ ‡å‡†å‘å¸ƒä¹‹å‰ï¼Œå¯¹è¾¹æ¡†çš„æ ·å¼çš„è®¾å®šæ˜¯éžå¸¸å•è°ƒçš„ã€‚CSS3æ ‡å‡†å‘å¸ƒä¹‹åŽï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å›¾ç‰‡æ¥å®šåˆ¶è¾¹æ¡†ï¼Œå¯ä»¥è®¾ç½®å…ƒç´ çš„é˜´å½±ä»¥åŠé€‰æ‹©ä½¿ç”¨å“ªç§ç›’å­æ¨¡åž‹ç­‰ã€‚border-imageborder-imageå±žæ€§å¯ä»¥ç”¨å›¾ç‰‡ä½œä¸ºè¾¹æ¡†æ ·å¼ã€‚border-imageå±žæ€§å¯ä»¥æ‹†åˆ†ä¸º5ä¸ªå±žæ€§ï¼š12345border-image-source // è¾¹æ¡†å›¾ç‰‡æºborder-image-slice // è¾¹æ¡†å›¾ç‰‡åˆ‡å‰²å°ºå¯¸border-image-width // è¾¹æ¡†å›¾ç‰‡å®½åº¦border-image-outset // è¾¹æ¡†å›¾ç‰‡åŒºåŸŸè¶…å‡ºå…ƒç´ è¾¹æ¡†çš„å°ºå¯¸border-image-repeat // è¾¹æ¡†å›¾ç‰‡ä¸­é—´éƒ¨åˆ†åœ¨å…ƒç´ å¯¹åº”éƒ¨åˆ†çš„å­˜åœ¨æ–¹å¼border-image-sourceè®¾ç½®è¾¹æ¡†å›¾ç‰‡çš„æºï¼Œç”¨url()æ–¹å¼è§„å®šå›¾ç‰‡è·¯å¾„ï¼Œç›¸å¯¹å’Œç»å¯¹è·¯å¾„éƒ½å¯ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1border-image-source : none | &lt;url&gt;border-image-sliceborder-image-sliceç”¨æ¥è§„å®šå›¾ç‰‡çš„åˆ‡å‰²ä½ç½®ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1border-image-slice: [ &lt;number&gt; | &lt;percentage&gt;]&#123;1,4&#125;å±žæ€§å€¼å¯ä»¥ä¸ºnumberï¼Œä¹Ÿå¯ä»¥æ˜¯percentageã€‚å¦‚æžœæ˜¯percentageæ–¹å¼ï¼Œåˆ™æ˜¯ç›¸å¯¹äºŽå›¾ç‰‡çš„å°ºå¯¸ã€‚æ¯”å¦‚æœ‰å¦‚ä¸‹ä¸€ä¸ªè¾¹æ¡†å›¾ç‰‡ï¼šæ¯ä¸€ä¸ªå°æ–¹å—çš„å°ºå¯¸æ˜¯27pxï¼Œé‚£ä¹ˆæ­¤å›¾ç‰‡çš„é•¿å®½å°ºå¯¸æ˜¯(27*3)åƒç´ ã€‚ä½¿ç”¨å¦‚ä¸‹ä»£ç è¿›è¡Œåˆ‡å‰²ï¼š1border-image-slice:27px 27px 27px 27px;ç»“æžœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå›¾ç‰‡è¢«åˆ‡å‰²åŽï¼Œä¼šè¢«åˆ’åˆ†ä¸ºä¹ä¸ªåŒºåŸŸï¼Œè¿™ä¸ªä¹ä¸ªåŒºåŸŸä¼šä¸Žå…ƒç´ çš„ä¹ä¸ªåŒºåŸŸæ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚border-image-widthborder-image-widthç”¨æ¥è§„å®šè¾¹æ¡†å›¾ç‰‡å®½åº¦ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1border-image-width : [ &lt;length&gt; | &lt;percentage&gt; | &lt;number&gt; | auto ]&#123;1,4&#125;æ­¤å±žæ€§å¯ä»¥çœç•¥ï¼Œæ­¤æ—¶è¾¹æ¡†å›¾ç‰‡åŒºåŸŸä¸Žå…ƒç´ çš„borderå®½åº¦æ˜¯ä¸€è‡´çš„ã€‚æ­¤å±žæ€§å¯ä»¥æœ‰1-4å€¼ï¼Œå–å€¼æ–¹å¼å’Œborder-widthç±»ä¼¼ï¼ŒåŒæ—¶ä¹Ÿéµå¾ªä¸Šå³ä¸‹å·¦æ–¹å¼ã€‚border-image-outsetborder-image-outsetæ­¤å±žæ€§ç”¨æ¥è§„å®šè¾¹æ¡†å›¾ç‰‡åŒºåŸŸè¶…å‡ºå…ƒç´ è¾¹æ¡†çš„å°ºå¯¸ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š1border-image-outset : [ &lt;length&gt; | &lt;number&gt; ]&#123;1,4&#125;border-image-repeatborder-image-repeatç”¨æ¥è§„å®šï¼Œåˆ‡å‰²åŽçš„è¾¹æ¡†å›¾ç‰‡ä¸­é—´éƒ¨åˆ†ï¼ˆæ¼”ç¤ºå›¾ç‰‡ä¸­çš„é»„è‰²éƒ¨åˆ†ï¼‰åœ¨å…ƒç´ å¯¹åº”éƒ¨åˆ†çš„å­˜åœ¨æ–¹å¼ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1border-image-repeat: [ stretch | repeat | round ]&#123;1,2&#125;ä¸‰ç§å€¼çš„å«ä¹‰å¦‚ä¸‹ï¼šstretchï¼šå›¾ç‰‡ä»¥å»¶å±•æ–¹å¼æ¥å¡«å……è¯¥åŒºåŸŸã€‚repeatï¼šå›¾ç‰‡ä»¥é‡å¤å¹³é“ºæ–¹å¼æ¥å¡«å……è¯¥åŒºåŸŸã€‚roundï¼šå›¾ç‰‡ä»¥é‡å¤å¹³é“ºæ–¹å¼æ¥å¡«å……è¯¥åŒºåŸŸã€‚å¦‚æžœæ²¡æœ‰ä»¥æ•´æ•°çš„å€æ•°æ¥å¡«å……è¯¥åŒºåŸŸï¼Œå›¾ç‰‡ä¼šè¿›è¡Œç¼©æ”¾ä»¥ä¾¿äºŽæ•´æ•°æ€§å€æ•°çš„å¹³é“ºå¡«å……ã€‚ä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨roundã€‚å…·ä½“å®žä¾‹ç¤ºä¾‹1ï¼šSee the Pen border-image-one by wuyouzhuguli (@mrbird) on CodePen.ä»¥ä¸Šä»£ç ä¸­ï¼Œborder-image-sliceè®¾ç½®ä¸º27ï¼Œç”±äºŽæ²¡æœ‰è§„å®šborder-image-widthï¼Œé‚£ä¹ˆå°†ä»¥è¾¹æ¡†çš„å°ºå¯¸ä¸ºæ ‡å‡†ï¼Œåˆç”±äºŽæ²¡æœ‰è§„å®šborder-image-repeatå±žæ€§ï¼Œåˆ™é»˜è®¤é‡‡ç”¨stretchæ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æ‹‰ä¼¸è¢«åˆ‡å‰²çš„ä¸­é—´åŒºåŸŸï¼ˆä¹Ÿå³æ˜¯æ¼”ç¤ºå›¾ä¸­çš„é»„è‰²åŒºåŸŸï¼‰ã€‚ç¤ºä¾‹2ï¼šSee the Pen border-image-two by wuyouzhuguli (@mrbird) on CodePen.è¾¹æ¡†è®¾ç½®ä¸º54pxï¼Œè¾¹æ¡†å›¾ç‰‡å°†ä¼šè‡ªé€‚åº”ã€‚ç¤ºä¾‹3ï¼šSee the Pen border-image-three by wuyouzhuguli (@mrbird) on CodePen.roundæ–¹å¼å¯ä»¥è‡ªåŠ¨è°ƒæ•´åˆ‡å‰²åŽè¾¹æ¡†å›¾ç‰‡ä¸­é—´éƒ¨åˆ†ï¼ˆæ¼”ç¤ºå›¾é»„è‰²éƒ¨åˆ†ï¼‰å°ºå¯¸æ–¹å¼å®žçŽ°é‡å¤å¹³é“ºæ•ˆæžœï¼Œæ‰€ä»¥ä¸ä¼šå‡ºçŽ°repeaté‚£æ ·çš„æ®‹ç¼ºçŽ°è±¡ã€‚box-shadowbox-shadowç”¨æ¥è®¾ç½®å…ƒç´ çš„æŠ•å½±æ•ˆæžœã€‚è¯­æ³•å¦‚ä¸‹ï¼š1box-shadow:h-shadow v-shadow blur spread color inset;æ¯ä¸ªå‚æ•°çš„å…·ä½“æ„ä¹‰ï¼šh-shadowï¼šå¿…éœ€ï¼Œè®¾ç½®å…ƒç´ é˜´å½±æ°´å¹³åç§»é‡ï¼Œå¯ä»¥ä¸ºè´Ÿå€¼ï¼Œå•ä½æ˜¯åƒç´ ã€‚v-shadowï¼šå¿…éœ€ï¼Œè®¾ç½®å…ƒç´ é˜´å½±åž‚ç›´åç§»é‡ï¼Œå¯ä»¥ä¸ºè´Ÿå€¼ï¼Œå•ä½æ˜¯åƒç´ ã€‚blurï¼šå¯é€‰ï¼Œé˜´å½±æ¨¡ç³ŠåŠå¾„ï¼Œåªèƒ½å¤Ÿä¸ºæ­£å€¼ï¼Œå¦‚æžœä¸º0ï¼Œè¡¨ç¤ºä¸å…·æœ‰æ¨¡ç³Šæ•ˆæžœï¼Œå•ä½åƒç´ ã€‚spreadï¼šå¯é€‰ï¼Œé˜´å½±çš„æ‰©å±•åŠå¾„å°ºå¯¸ï¼Œå¯ä»¥ä¸ºè´Ÿå€¼ï¼Œå•ä½æ˜¯åƒç´ ã€‚colorï¼šå¯é€‰ï¼Œè®¾ç½®é˜´å½±çš„é¢œè‰²ï¼›çœç•¥æ­¤å‚æ•°ï¼Œæµè§ˆå™¨é€‰å–é»˜è®¤é¢œè‰²ï¼Œå„ä¸ªæµè§ˆå™¨çš„é»˜è®¤å¯èƒ½ä¸åŒï¼Œæœ‰çš„ä¸ºé€æ˜Žã€‚insetï¼šå¯é€‰ï¼Œå¯ä»¥å°†å¤–éƒ¨é˜´å½±æ”¹ä¸ºå†…éƒ¨é˜´å½±ã€‚å…·ä½“å®žä¾‹ç¤ºä¾‹1ï¼Œåªè®¾ç½®æ°´å¹³å’Œåž‚ç›´çš„åç§»é‡ï¼šSee the Pen box-shadow-one by wuyouzhuguli (@mrbird) on CodePen.ç¤ºä¾‹2ï¼Œæ–°å¢žæ¨¡ç³ŠåŠå¾„å’Œé˜´å½±é¢œè‰²ï¼šSee the Pen box-shadow-two by wuyouzhuguli (@mrbird) on CodePen.ç¤ºä¾‹3ï¼Œè®¾ç½®å¤šä¸ªé˜´å½±ï¼šSee the Pen box-shadow-three by wuyouzhuguli (@mrbird) on CodePen.box-sizingbox-sizingå±žæ€§ç”¨äºŽæŒ‡å®šå…ƒç´ é‡‡ç”¨å“ªç§ç›’å­æ¨¡åž‹ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1box-sizing ï¼šcontent-box || border-box || inheritå¦‚æžœå±žæ€§å€¼æ˜¯content-boxï¼Œé‚£ä¹ˆå°†é‡‡ç”¨æ ‡å‡†ç›’æ¨¡åž‹ï¼›å¦‚æžœå±žæ€§å€¼æ˜¯border-boxï¼Œé‚£ä¹ˆå°†é‡‡ç”¨æ€ªå¼‚æ¨¡å¼ç›’æ¨¡åž‹ï¼›å¦‚æžœå±žæ€§å€¼æ˜¯inheritï¼Œé‚£ä¹ˆå°†é‡‡ç”¨ç»§æ‰¿æ–¹å¼ã€‚ç›’å­æ¨¡åž‹ç›®å‰å®‰è£…W3Cçš„æ ‡å‡†å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼šæ ‡å‡†ç›’å­æ¨¡åž‹å’Œæ€ªå¼‚ç›’å­æ¨¡åž‹ã€‚æ ‡å‡†ç›’å­æ¨¡åž‹ï¼Œæœ€å¸¸è§çš„ç›’å­æ¨¡åž‹ï¼Œåœ¨è¿™ç§ç›’å­æ¨¡åž‹ä¸‹ï¼Œå…ƒç´ å®žé™…å å®½ä¸ºï¼šwidth+padding+border+marginï¼›å®žé™…å é«˜ä¸ºï¼šheight+padding+border+marginã€‚æ€ªå¼‚ç›’å­æ¨¡åž‹ï¼Œå®žé™…å å®½ï¼šwidth+marginï¼›å®žé™…å é«˜ï¼šheight+marginã€‚å…¶ä¸­widthå’ŒheightåŒ…å«contentï¼Œpaddingï¼Œborderã€‚æ ‡å‡†ç›’å­æ¨¡åž‹ä¸‹å…ƒç´ çš„widthå’Œheightæž„æˆäº†å…ƒç´ çš„å†…å®¹åŒºåŸŸï¼Œè€Œè¿™ä¸ªåŒºåŸŸå¯¹åº”ç€æ€ªå¼‚ç›’å­æ¨¡åž‹ä¸‹contentã€‚å…·ä½“å®žä¾‹See the Pen box-sizing by wuyouzhuguli (@mrbird) on CodePen.ä»¥ä¸Šä»£ç ä¸­ï¼Œæœ‰ä¸€ä¸ªboxå®¹å™¨å’Œä¸¤ä¸ªå­divï¼Œç”±äºŽç²¾ç¡®è®¾å®šäº†å·¦å³ä¸¤ä¸ªå­divçš„å®½åº¦ï¼Œæ°å¥½å’Œboxå®¹å™¨å®½åº¦ç›¸åŒï¼Œä¸”é‡‡ç”¨æµ®åŠ¨ï¼Œæ‰€ä»¥ä¸¤ä¸ªå­divå¯ä»¥æ°´å¹³æŽ’åˆ—ã€‚çŽ°åœ¨ç»™æµ®åŠ¨çš„ä¸¤ä¸ªå…ƒç´ æ·»åŠ paddingå±žæ€§å€¼ï¼Œè§‚å¯Ÿç»“æžœï¼šSee the Pen box-sizing-two by wuyouzhuguli (@mrbird) on CodePen.ç”±äºŽé»˜è®¤é‡‡ç”¨æ ‡å‡†ç›’å­æ¨¡åž‹ï¼Œç»™å…ƒç´ æ·»åŠ äº†paddingå±žæ€§åŽï¼Œå…ƒç´ å®žé™…å å®½åº¦æ”¹å˜äº†ï¼ˆæ¯”å¦‚å®½åº¦ä¸ºwidth+padding+border+marginï¼Œå› ä¸ºå¢žåŠ äº†paddingï¼Œæ‰€ä»¥æ€»ä½“çš„å€¼å˜å¤§äº†ï¼‰ï¼Œå¹¶ä¸”å¤§äºŽçˆ¶å…ƒç´ çš„å®½åº¦ï¼Œæ‰€ä»¥å¯¼è‡´äº†æ¢è¡Œã€‚æˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ€ªå¼‚ç›’å­æ¨¡åž‹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šSee the Pen RgOMaL by wuyouzhuguli (@mrbird) on CodePen.æ€ªå¼‚ç›’å­æ¨¡åž‹ä¸‹ï¼Œå…ƒç´ çš„widthæ²¡æœ‰æ”¹å˜ï¼Œæ‰€ä»¥å®žé™…å å®½æ²¡å˜ï¼ˆwidth+marginï¼‰ã€‚è€Œwidthåœ¨æ€ªå¼‚ç›’å­æ¨¡åž‹ä¸‹çš„å€¼ä¸ºï¼šcontent+padding+borderï¼Œå› ä¸ºæ€»ä½“çš„å€¼æ²¡å˜ï¼Œborderä¸å˜ï¼Œpaddingå˜å¤§ï¼Œæ‰€ä»¥ä½¿å¾—contentå˜å°ã€‚å‚è€ƒè‡ªï¼šhttp://www.softwhy.com/]]></content>
      <tags>
        <tag>CSS3</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[BootstrapValidatoræŒ‡å—]]></title>
    <url>%2FBootstrapValidator%E6%8C%87%E5%8D%97.html</url>
    <content type="text"><![CDATA[BootstrapValidatoræ˜¯ä¸€æ¬¾åŸºäºŽjQueryçš„Bootstrapè¡¨å•æ ¡éªŒæ’ä»¶ï¼Œæä¾›äº†éžå¸¸ä¸°å¯Œçš„æ ¡éªŒè§„åˆ™ã€‚å‡†å¤‡å·¥ä½œè¦ä½¿ç”¨BootstrapValidatorï¼Œéœ€è¦å…ˆå¼•å…¥å¿…è¦çš„æ–‡ä»¶ï¼š12345&lt;link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap-3.0.3.min.css"/&gt;&lt;link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrapValidator-0.5.2.min.css"/&gt;&lt;script type="text/javascript" src="js/jquery-1.11.1.min.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="bootstrap/js/bootstrap-3.0.3.min.js"&gt;&lt;/script&gt;&lt;script type="text/javascript" src="bootstrap/js/bootstrapValidator-0.5.2.min.js"&gt;&lt;/script&gt;å…¶ä¸­éœ€è¦æ³¨æ„çš„æ˜¯jQueryç‰ˆæœ¬å¿…é¡»å¤§äºŽ1.9.1ã€‚æ–‡ä»¶ä¸‹è½½åœ°å€ï¼šhttps://drive.google.com/open?id=1FVhZT899gewytpLVTwD-4x2uR1tSXFkNã€‚éœ€è¦æ ¡éªŒçš„è¡¨å•å¿…é¡»ç”±&lt;form&gt;&lt;/form&gt;æ ‡ç­¾åŒ…è£¹ï¼Œå¹¶ä¸”éœ€è¦éªŒè¯çš„å­—æ®µç”±&lt;div class=&quot;form-group&quot;&gt;&lt;/div&gt;åŒ…è£¹ï¼Œå¹¶ä¸”æœ‰nameå±žæ€§ã€‚æ¯”å¦‚ï¼š123456&lt;form&gt; &lt;div class="form-group"&gt; &lt;label&gt;labelName&lt;/label&gt; &lt;input type="text" class="form-control" name="fieldName"/&gt; &lt;/div&gt;&lt;/form&gt;ç»‘å®šæ ¡éªŒè§„åˆ™å¯¹formå…ƒç´ ç»‘å®šæ ¡éªŒè§„åˆ™ï¼š1234567891011121314151617181920212223242526272829303132333435363738$("form").bootstrapValidator(&#123; // æŒ‡å®šä¸éªŒè¯çš„æƒ…å†µ // å€¼å¯è®¾ç½®ä¸ºä»¥ä¸‹ä¸‰ç§ç±»åž‹ï¼š // 1ã€String ':disabled, :hidden, :not(:visible)' // 2ã€Array é»˜è®¤å€¼ [':disabled', ':hidden', ':not(:visible)'] // 3ã€å¸¦å›žè°ƒå‡½æ•° // [':disabled', ':hidden', function($field, validator) &#123; // $field å½“å‰éªŒè¯å­—æ®µdomèŠ‚ç‚¹ // validator éªŒè¯å®žä¾‹å¯¹è±¡ // å¯ä»¥å†æ¬¡è‡ªå®šä¹‰ä¸è¦éªŒè¯çš„è§„åˆ™ // å¿…é¡»è¦returnï¼Œreturn true or false; return !$field.is(':visible'); &#125;] // excluded: [':disabled', ':hidden', ':not(:visible)'], // ç”Ÿæ•ˆè§„åˆ™ // enabled:å­—æ®µå€¼å‘ç”Ÿå˜åŒ–å°±è§¦å‘éªŒè¯ // disabled/submitted:ç‚¹å‡»æäº¤æ—¶è§¦å‘éªŒè¯ live: 'disabled', // å›¾æ ‡ feedbackIcons: &#123; valid: 'glyphicon glyphicon-ok', invalid: 'glyphicon glyphicon-remove', validating: 'glyphicon glyphicon-refresh' &#125;, fields: &#123; field1: &#123; // å­—æ®µå validators: &#123; // ... &#125; &#125;, field2: &#123; validators: &#123; // ... &#125; &#125; &#125;&#125;);ä¸‹é¢å…·ä½“ä»‹ç»å„ç§æ ¡éªŒè§„åˆ™ã€‚éžç©ºæ ¡éªŒéžç©ºæ ¡éªŒæ˜¯æœ€å¸¸è§çš„ä¸€ç§æ ¡éªŒä¹‹ä¸€ï¼Œæ¯”å¦‚å¯¹nameå±žæ€§ä¸ºuserNameçš„å­—æ®µè¿›è¡Œéžç©ºæ ¡éªŒï¼š1234567userName: &#123; // nameå±žæ€§å€¼ validators: &#123; notEmpty: &#123; // éžç©ºæ ¡éªŒ message: 'ç”¨æˆ·åä¸èƒ½ä¸ºç©º!' &#125; &#125;&#125;,æ–‡æœ¬é•¿åº¦æ ¡éªŒæ¯”å¦‚å¯¹userNameçš„é•¿åº¦è¿›è¡ŒæŽ§åˆ¶ï¼š123456789userName: &#123; validators: &#123; stringLength: &#123; // é•¿åº¦æ ¡éªŒ min: 3, max: 10, message: 'ç”¨æˆ·åé•¿åº¦%s~%sä¸ªå­—ç¬¦ï¼' &#125; &#125;&#125;,è¿™é‡ŒuserNameçš„é•¿åº¦è¢«é™åˆ¶ä¸º3~10ä¸ªå­—ç¬¦ï¼ˆåŒ…å«3å’Œ10ï¼‰ã€‚%såˆ†åˆ«è¡¨ç¤º3å’Œ10ã€‚æ­£åˆ™æ ¡éªŒBootstrapValidatoræ”¯æŒæ­£åˆ™è¡¨è¾¾å¼æ ¡éªŒï¼Œæ¯”å¦‚ï¼š12345678userName: &#123; validators: &#123; regexp: &#123; //æ­£åˆ™æ ¡éªŒ regexp: /^[a-zA-Z0-9_]+$/, message:'ç”¨æˆ·åä»…æ”¯æ•°å­—ï¼Œå­—æ¯å’Œä¸‹åˆ’çº¿çš„ç»„åˆ' &#125;, &#125;&#125;,è¿œç¨‹æ ¡éªŒè¿œç¨‹æ ¡éªŒä½¿ç”¨Ajaxå¼‚æ­¥è¯·æ±‚ä»ŽæœåŠ¡ç«¯è¿›è¡Œæ ¡éªŒï¼Œæ¯”å¦‚æ ¡éªŒuserNameçš„å€¼æ˜¯å¦å·²ç»å­˜åœ¨ã€‚å¦‚ï¼š1234567891011121314userName: &#123; validators: &#123; remote: &#123; url: "user/confirmUserName.do", message: "ç”¨æˆ·åå·²å­˜åœ¨", type: "get", data: function()&#123; // é¢å¤–çš„æ•°æ®ï¼Œé»˜è®¤ä¸ºå½“å‰æ ¡éªŒå­—æ®µ,ä¸éœ€è¦çš„è¯åŽ»æŽ‰å³å¯ return &#123; "name": $("input[name='userName']").val().trim() &#125;; &#125; &#125; &#125;&#125;,å‡å¦‚userNameå­—æ®µå¡«å†™çš„å€¼ä¸º123ï¼Œåˆ™å‚æ•°æ ¼å¼ä¸ºï¼šuserName=123&amp;name=123ï¼Œæ‰€ä»¥å¦‚æžœæ— éœ€é¢å¤–å‚æ•°çš„è¯ï¼Œdataå±žæ€§å¯ä»¥ç•¥åŽ»ã€‚æœåŠ¡ç«¯ï¼š123456789101112@RequestMapping("user/confirmUserName")@ResponseBodypublic Map&lt;String,Boolean&gt; confirmUserName(String name) &#123; Map&lt;String,Boolean&gt; map = new HashMap&lt;String, Boolean&gt;(); map.put("valid", true); // æ¨¡æ‹Ÿæ•°æ®åº“ä¸­å·²ç»å­˜åœ¨â€œMikeâ€ if(name.equals("Mike"))&#123; // è®¾ç½®æ ¡éªŒä¸é€šè¿‡ map.put("valid", false); &#125; return map;&#125;å½“validä¸ºtrueçš„æ—¶å€™ï¼Œè¡¨ç¤ºMikeç”¨æˆ·åå¯ç”¨ï¼›å½“validä¸ºfalseçš„æ—¶å€™ï¼Œè¡¨ç¤ºMikeå·²è¢«æ³¨å†Œã€‚é‚®ç®±æ ¡éªŒBootstrapValidatoræä¾›äº†é‚®ç®±æ ¡éªŒçš„æ–¹æ³•ï¼Œå¯ä»¥ä¸ç”¨æ‰‹åŠ¨ç¼–å†™é‚®ç®±çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š1234567email: &#123; validators: &#123; emailAddress: &#123; // å¯ä»¥ä¸ç”¨è‡ªå·±å†™æ­£åˆ™ message: 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®' &#125; &#125;&#125;,å¯¹æ¯”æ ¡éªŒå¯¹æ¯”æ ¡éªŒå°±æ˜¯æŒ‡å½“å‰å­—æ®µçš„å€¼å’Œåˆ«çš„å­—æ®µçš„å€¼ç›¸æ¯”è¾ƒï¼Œäº§ç”Ÿæ ¡éªŒç»“æžœã€‚å¸¸ç”¨äºŽå¯†ç å­—æ®µï¼Œæ¯”å¦‚æœ‰å¦‚ä¸‹formè¡¨å•ï¼š12345678910&lt;form&gt; &lt;div class="form-group"&gt; &lt;label&gt;è¯·è¾“å…¥å¯†ç &lt;/label&gt; &lt;input type="text" class="form-control" name="password"/&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;label&gt;è¯·å†æ¬¡è¾“å…¥å¯†ç &lt;/label&gt; &lt;input type="text" class="form-control" name="confirmPassword"/&gt; &lt;/div&gt;&lt;/form&gt;å¸¸ç”¨çš„æ ¡éªŒè§„åˆ™å¦‚ä¸‹ï¼š12345678910111213141516171819202122password: &#123; validators: &#123; notEmpty: &#123; message: 'è¯·è¾“å…¥å¯†ç ' &#125;, different: &#123; // æ¯”è¾ƒæ˜¯å¦ä¸åŒï¼Œå¦çš„è¯æ ¡éªŒä¸é€šè¿‡ field: 'userName', // å’ŒuserNameå­—æ®µæ¯”è¾ƒ message: 'å¯†ç ä¸èƒ½ä¸Žç”¨æˆ·åç›¸åŒï¼' &#125; &#125;&#125;,confirmPassword: &#123; validators: &#123; notEmpty: &#123; message: 'è¯·å†æ¬¡ç¡®è®¤å¯†ç ï¼' &#125;, identical: &#123; // æ¯”è¾ƒæ˜¯å¦ç›¸åŒï¼Œå¦çš„è¯æ ¡éªŒä¸é€šè¿‡ field: 'password', // å’Œpasswordå­—æ®µæ¯”è¾ƒ message: 'ä¸¤æ¬¡å¯†ç è¾“å…¥ä¸ä¸€è‡´' &#125; &#125;&#125;,å¤é€‰æ¡†æ ¡éªŒå¤é€‰æ¡†æ ¡éªŒç”¨äºŽæŽ§åˆ¶å¤é€‰æ¡†çš„é€‰ä¸­ä¸ªæ•°ï¼š1234567891011121314151617181920212223&lt;div class="form-group"&gt; &lt;label&gt;å…´è¶£çˆ±å¥½&lt;/label&gt; &lt;div class="checkbox"&gt; &lt;label&gt; &lt;input type="checkbox" name="hobbies" value="swimming" /&gt; æ¸¸æ³³ &lt;/label&gt; &lt;/div&gt; &lt;div class="checkbox"&gt; &lt;label&gt; &lt;input type="checkbox" name="hobbies" value="fitness" /&gt; å¥èº« &lt;/label&gt; &lt;/div&gt; &lt;div class="checkbox"&gt; &lt;label&gt; &lt;input type="checkbox" name="hobbies" value="football" /&gt; è¶³çƒ &lt;/label&gt; &lt;/div&gt; &lt;div class="checkbox"&gt; &lt;label&gt; &lt;input type="checkbox" name="hobbies" value="sleep" /&gt; ç¡è§‰ &lt;/label&gt; &lt;/div&gt;&lt;/div&gt;æ ¡éªŒè§„åˆ™ï¼š123456789hobbies: &#123; validators: &#123; choice: &#123; min: 1, max: 3, message: 'è¯·é€‰æ‹©1~3é¡¹å…´è¶£çˆ±å¥½' &#125; &#125;&#125;,æ•°å­—èŒƒå›´æ ¡éªŒæ•°å­—èŒƒå›´æ ¡éªŒç±»ä¼¼ä¸Žæ–‡æœ¬é•¿åº¦æ ¡éªŒï¼Œä¸è¿‡å…¶ä¸€èˆ¬ç”¨äºŽæ•°å­—ç±»åž‹çš„é•¿åº¦æ ¡éªŒï¼Œæ¯”å¦‚é™åˆ¶å¹´é¾„èŒƒå›´ä¸º1~150ï¼š123456789age: &#123; validators: &#123; between: &#123; min: 0, max: 150, message: 'è¯·è¾“å…¥æ­£å¸¸çš„å¹´é¾„,èŒƒå›´ä¸º%såˆ°%s', &#125; &#125;&#125;,é™¤äº†ä½¿ç”¨betweenå¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨lessThanå’ŒgreaterThanæ¥å®žçŽ°å’Œbetweenç±»ä¼¼çš„æ•ˆæžœï¼š1234567891011121314age: &#123; validators: &#123; lessThan: &#123; value: 150, inclusive: true, // æ˜¯å¦åŒ…å«150ï¼Œtrueä¸ºåŒ…å« message: 'å¹´é¾„å¿…é¡»å°äºŽç­‰äºŽ%s' &#125;, greaterThan: &#123; value: 0, inclusive: false, ä¸åŒ…å«0 message: 'å¹´é¾„å¿…é¡»å¤§äºŽ%s' &#125; &#125;&#125;,æ–‡ä»¶æ ¡éªŒæ–‡ä»¶æ ¡éªŒç”¨äºŽå¯¹ä¸Šä¼ çš„é™„ä»¶ç±»åž‹ï¼Œå¤§å°ç­‰è¿›è¡Œé™åˆ¶ï¼Œå¸¸ç”¨çš„è§„åˆ™å¦‚ä¸‹ï¼š12345678910files: &#123; validators: &#123; file: &#123; maxSize: 1024*1024, // æ–‡ä»¶å¤§å°ï¼Œå•ä½ä¸ºbï¼Œè¿™é‡Œä¸º1mb extension: 'jpg,png', // æ ¼å¼ type: 'image/jpeg,image/png', // å¯¹åº”çš„MIME type message: 'æ–‡ä»¶ä¸åˆæ³•ï¼Œå¿…é¡»å°äºŽ1MBï¼Œå¹¶ä¸”æ ¼å¼ä¸ºjpgæˆ–png' &#125; &#125;&#125;,æ›´è¯¦ç»†çš„æ ¡éªŒè§„åˆ™å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šé€‰é¡¹HTMLå±žæ€§ç±»åž‹æè¿°extensiondata-fv-file-extensionStringå…è®¸çš„æ‰©å±•åï¼Œç”¨é€—å·åˆ†éš”maxFilesdata-fv-file-maxfilesNumberæœ€å¤§æ–‡ä»¶æ•°maxSizedata-fv-file-maxsizeNumberæœ€å¤§æ–‡ä»¶å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰maxTotalSizedata-fv-file-maxtotalsizeNumberæ‰€æœ‰æ–‡ä»¶çš„æœ€å¤§å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰minFilesdata-fv-file-minfilesNumberæ–‡ä»¶çš„æœ€å°æ•°é‡minSizedata-fv-file-minsizeNumberæœ€å°æ–‡ä»¶å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰minTotalSizedata-fv-file-mintotalsizeNumberæ‰€æœ‰æ–‡ä»¶çš„æœ€å°å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰messagedata-fv-file-messageStringé”™è¯¯æ¶ˆæ¯typedata-fv-file-typeStringå…è®¸çš„MIMEç±»åž‹ï¼Œä»¥é€—å·åˆ†éš”ã€‚ä¾‹å¦‚ï¼šè®¾ç½®image/jpeg,image/png,application/pdfåªå…è®¸ä¸Šä¼ JPEGï¼ŒPNGå›¾åƒå’ŒPDFæ–‡æ¡£ã€‚ä¸‹è¡¨æ˜¾ç¤ºäº†å¸¸è§çš„MIMEç±»åž‹ã€‚å¯¹äºŽå…¶ä»–MIMEç±»åž‹ï¼Œå¯ä»¥å‚è€ƒhttps://www.sitepoint.com/mime-types-complete-list/ã€‚MIMEç±»åž‹æ–‡ä»¶æ‰©å±•åapplication/msworddocapplication/pdfpdfapplication/rtfrtfapplication/vnd.ms-excelxlsapplication/vnd.ms-powerpointpptapplication/x-rar-compressedrarapplication/x-shockwave-flashswfapplication/zipzipaudio/midimid midi karaudio/mpeg,audio/mp3mp3audio/oggoggaudio/x-m4am4aaudio/x-realaudioraimage/gifgifimage/jpegjpeg jpgimage/pngpngimage/tifftif tiffimage/vnd.wap.wbmpwbmpimage/x-iconicoimage/x-jngjngimage/x-ms-bmpbmpimage/svg+xmlsvg svgzimage/webpwebptext/csscsstext/htmlhtml htm shtmltext/plaintxttext/xmlxmlvideo/3gpp3gpp 3gpvideo/mp4mp4video/mpegmpeg mpgvideo/quicktimemovvideo/webmwebmvideo/x-flvflvvideo/x-m4vm4vvideo/x-ms-wmvwmvvideo/x-msvideoavicallbackéªŒè¯callbackç”¨äºŽæ ¡éªŒéªŒè¯ç ç­‰ç±»åž‹ï¼Œæ¯”å¦‚è¦å®žçŽ°ä¸‹é¢è¿™æ ·çš„æ•ˆæžœï¼šHTMLä»£ç ï¼š1234&lt;div class="form-group"&gt; &lt;label id="question"&gt;&lt;/label&gt; &lt;input type="text" class="form-control" name="answer" /&gt;&lt;/div&gt;ç”Ÿæˆæ•°å­¦ç®—å¼ï¼š1234function randomNumber(min, max) &#123; return Math.floor(Math.random() * (max - min + 1) + min);&#125;;$('#question').html([randomNumber(1, 100), '+', randomNumber(1, 200), '='].join(' '));æ ¡éªŒè§„åˆ™ï¼š123456789101112answer: &#123; validators: &#123; callback: &#123; message: "ç­”æ¡ˆä¸æ­£ç¡®ï¼", callback: function(value, validator)&#123; // éªŒè¯ç­”æ¡ˆæ˜¯å¦æ­£ç¡®ï¼Œvalueä¸ºç”¨æˆ·è¾“å…¥çš„å€¼ var items = $('#question').html().split(' '); var sum = parseInt(items[0]) + parseInt(items[2]); return value == sum; &#125; &#125; &#125;&#125;å®žé™…ä¸­ï¼Œå¯ä»¥å°†ä¸Šé¢çš„æ ¡éªŒè§„åˆ™ç»„åˆåœ¨ä¸€èµ·ï¼Œå®žçŽ°æ›´å¤æ‚çš„æ ¡éªŒã€‚å¸¸ç”¨äº‹ä»¶æ‰‹åŠ¨è§¦å‘æ ¡éªŒæ‰‹åŠ¨è§¦å‘æ ¡éªŒåŒ…å«è§¦å‘å•ä¸ªå­—æ®µå’Œè§¦å‘æ•´ä¸ªè¡¨å•ï¼š1234// æ•´ä¸ªè¡¨å•$("form").bootstrapValidator('validate');// å•ä¸ªå­—æ®µ$("form").data('bootstrapValidator').validateField('fieldName');èŽ·å–å½“å‰è¡¨å•æ ¡éªŒç»“æžœèŽ·å–å½“å‰è¡¨å•æ ¡éªŒçŠ¶æ€ï¼Œæ ¡éªŒé€šè¿‡è¿”å›žtrueï¼Œå¦åˆ™è¿”å›žfalseï¼š1234var bootstrapValidators = $("form").data('bootstrapValidator');if(bootstrapValidators.isValid()) &#123; // todo&#125;é‡ç½®æ ¡éªŒ12$('form').data('bootstrapValidator').resetForm(true); // é‡ç½®æ ¡éªŒ$('form')[0].reset();// è¡¨å•æ¸…ç©º]]></content>
      <tags>
        <tag>Bootstrap</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¸­çš„å—çº§ä½œç”¨åŸŸ]]></title>
    <url>%2FJavaScript%E4%B8%AD%E7%9A%84%E5%9D%97%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F.html</url>
    <content type="text"><![CDATA[æ‰€è°“çš„å—çº§ä½œç”¨åŸŸé€šä¿—çš„è®²å°±æ˜¯ä½¿ç”¨{}åˆ›é€ ä¸€ä¸ªä»£ç å—ï¼Œç„¶åŽåœ¨è¿™ä¹‹ä¸­å£°æ˜Žçš„å˜é‡åœ¨ä»£ç å—ä¹‹å¤–éƒ½æ˜¯ä¸å¯è®¿é—®çš„ã€‚åœ¨ES6æ ‡å‡†å‘å¸ƒä¹‹å‰ï¼ŒJavaScriptè¡¨é¢ä¸Šå¹¶æ²¡æœ‰çš„å—çº§ä½œç”¨åŸŸçš„æ¦‚å¿µï¼Œä½†å…¶å®žé™…åŒ…å«ä¸€äº›éšå¼çš„å—çº§ä½œç”¨åŸŸï¼šå‡½æ•°ä½œç”¨åŸŸå’Œtry/catchã€‚ES6ä¸­æ–°å¢žäº†letå…³é”®å­—ï¼Œä¹Ÿå¯ä»¥æ˜¾å¼çš„åˆ›é€ å—çº§ä½œç”¨åŸŸã€‚JavaScriptä¸­ï¼Œforå¾ªçŽ¯å’Œifç­‰è¯­å¥éƒ½å¯ä»¥åˆ›å»ºâ€œå—â€ï¼Œä½†å…¶å¹¶ä¸æ˜¯å—çº§ä½œç”¨åŸŸï¼š123456789101112// for for (var i = 0; i &lt;= 3; i++) &#123; var a = 5;&#125;console.log(i); // 4console.log(a); // 5// ifif (true) &#123; var b = 6;&#125;console.log(b); // 6å¯è§åœ¨å—é‡Œé¢å£°æ˜Žçš„å˜é‡éƒ½è¢«æ³„æ¼åˆ°å¤–éƒ¨ä½œç”¨åŸŸä¸­äº†ã€‚å‡½æ•°ä½œç”¨åŸŸå‡½æ•°ä½œç”¨åŸŸå®žé™…ä¸Šå°±æ˜¯ä¸€ä¸ªå—çº§ä½œç”¨åŸŸï¼š1234function foo() &#123; var a = 3;&#125;console.log(a); // ReferenceError: a is not definedåœ¨å‡½æ•°å¤–éƒ¨å¯¹açš„RHSæŸ¥è¯¢å¤±è´¥ï¼Œæ‰€ä»¥æŠ›å‡ºReferenceErrorå¼‚å¸¸ã€‚try/catchES3 è§„èŒƒä¸­è§„å®štry/catchçš„catchåˆ†å¥ä¼šåˆ›å»ºä¸€ä¸ªå—ä½œç”¨åŸŸï¼Œå…¶ä¸­å£°æ˜Žçš„å˜é‡ä»…åœ¨catchå†…éƒ¨æœ‰æ•ˆã€‚123456try &#123; throw 2;&#125; catch (a) &#123; console.log(a); // 2&#125;console.log(a); // ReferenceError: a is not definedletES6å¼•å…¥çš„letå…³é”®å­—é…åˆ{}å¯ä»¥æ˜¾ç¤ºåœ°åˆ›å»ºå—çº§ä½œç”¨åŸŸï¼š12345&#123; let a = 3; console.log(a); // 3&#125;console.log(a); // ReferenceError: a is not definedconstå…³é”®å­—ä¹Ÿå¯ä»¥åˆ›å»ºå—çº§ä½œç”¨åŸŸï¼Œåªä¸è¿‡constç”¨äºŽå£°æ˜Žå¸¸é‡ç½¢äº†ã€‚]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¸­çš„æå‡]]></title>
    <url>%2FJavaScript%E6%8F%90%E5%8D%87.html</url>
    <content type="text"><![CDATA[å¯¹äºŽvar a = 3æˆ‘ä»¬ä¸€èˆ¬è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå£°æ˜Žï¼Œä½†å®žé™…ä¸ŠJavaScriptå¼•æ“Žå¹¶ä¸è¿™ä¹ˆè®¤ä¸ºã€‚å®ƒå°†var aå’Œa = 2å½“ä½œä¸¤ä¸ªå•ç‹¬çš„å£°æ˜Žï¼Œç¬¬ä¸€ä¸ªæ˜¯ç¼–è¯‘é˜¶æ®µçš„ä»»åŠ¡ï¼Œè€Œç¬¬äºŒä¸ªåˆ™æ˜¯æ‰§è¡Œé˜¶æ®µçš„ä»»åŠ¡ã€‚è¿™æ„å‘³ç€æ— è®ºä½œç”¨åŸŸä¸­çš„å£°æ˜Žå‡ºçŽ°åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œéƒ½å°†åœ¨ä»£ç æœ¬èº«è¢«æ‰§è¡Œå‰é¦–å…ˆè¿›è¡Œå¤„ç†ã€‚å¯ä»¥å°†è¿™ä¸ªè¿‡ç¨‹å½¢è±¡åœ°æƒ³è±¡æˆæ‰€æœ‰çš„å£°æ˜Žï¼ˆå˜é‡å’Œå‡½æ•°ï¼‰éƒ½ä¼šè¢«â€œç§»åŠ¨â€åˆ°å„è‡ªä½œç”¨åŸŸçš„æœ€é¡¶ç«¯ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºæå‡ã€‚ è€ƒè™‘å¦‚ä¸‹ä»£ç æ®µï¼š123a = 3;var a;console.log(a);å¯èƒ½ä½ ä¼šè§‰å¾—ä¸Šè¿°ä»£ç å°†è¾“å‡ºundefinedï¼Œä½†å…¶å®žé™…ä¸Šå®ƒèƒ½å¤Ÿå¦‚æ„¿çš„è¾“å‡º3ã€‚å› ä¸ºä¸Šè¿°ä»£ç åœ¨ç»è¿‡JavaScriptå¼•æ“Žç¼–è¯‘ä¹‹åŽï¼Œå˜æˆäº†è¿™æ ·ï¼š123var a;a = 3;console.log(a);è¿™ç§å¯¹å˜é‡çš„å£°æ˜Žè¢«æ‹‰åˆ°å…¶ä½œç”¨åŸŸçš„æœ€é¡¶ç«¯çš„è¿‡ç¨‹å°±æ˜¯æå‡ã€‚å†å¦‚æœ‰å¦‚ä¸‹ä»£ç æ®µï¼š12console.log(a);var a = 3;ä¸Šè¿°ä»£ç å°†è¾“å‡ºundefinedï¼Œè€ŒéžReferenceErrorå¼‚å¸¸ï¼Œå¦‚ä¸Šæ‰€è¿°ï¼Œåœ¨ç»è¿‡JavaScriptå¼•æ“Žç¼–è¯‘ä¹‹åŽï¼Œvar aè¢«æå‡åˆ°äº†ä½œç”¨äºŽé¡¶éƒ¨ï¼š123var a;console.log(a);a = 3;æ‰€ä»¥å¯¹açš„RHSæŸ¥è¯¢å¹¶ä¸ä¼šå¤±è´¥ï¼Œåªä¸è¿‡aä¸ºundefinedç½¢äº†ã€‚å‡½æ•°çš„å£°æ˜Žä¹Ÿå¯ä»¥è¢«æå‡ï¼Œæ¯”å¦‚ï¼š12345foo(); // 3function foo() &#123; var a = 3; console.log(a);&#125;å®žé™…ä¸Šä¸ºï¼š12345function foo() &#123; var a = 3; console.log(a);&#125;foo(); // 3å‡½æ•°å£°æ˜Žçš„æå‡éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼šå‡½æ•°ä¼˜å…ˆåŽŸåˆ™ï¼šå‡½æ•°å£°æ˜Žå’Œå˜é‡å£°æ˜Žéƒ½ä¼šè¢«æå‡ã€‚ä½†å‡½æ•°å£°æ˜Žå°†å…ˆè¢«æå‡ï¼š123456789foo(); // 4var foo = function() &#123; var a = 3; console.log(a);&#125;function foo() &#123; var a = 4; console.log(a);&#125;ç»è¿‡JavaScriptå¼•æ“Žç¼–è¯‘ä¹‹åŽï¼Œä»£ç å˜æˆï¼š123456789function foo() &#123; var a = 4; console.log(a);&#125;foo();foo = function() &#123; var a = 3; console.log(a);&#125;å…¶ä¸­var fooè¿™ä¸ªé‡å¤çš„å£°æ˜Žå·²ç»è¢«ç•¥åŽ»ã€‚ã€Šä½ ä¸çŸ¥é“çš„JavaScriptä¸Šå·ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¸­çš„IIFE]]></title>
    <url>%2FJavaScript%E4%B8%AD%E7%9A%84IIFE.html</url>
    <content type="text"><![CDATA[IIFE(Immediately Invoked Function Expression)æŒ‡çš„æ˜¯ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼Œå¸¸è§çš„å½¢å¼æœ‰ä¸¤ç§ï¼š(function(){ .. })()å’Œ(function(){ .. }())ã€‚IIFEçš„å­˜åœ¨ä¸€èˆ¬æ˜¯ä¸ºäº†å‡å°‘å‘½åæ±¡æŸ“çš„é—®é¢˜ã€‚è€ƒè™‘å¦‚ä¸‹ä»£ç ï¼š12345function foo() &#123; var a = 3; console.log(a);&#125;foo(); // 3å‡å¦‚å‡½æ•°foo()åªæ‰§è¡Œä¸€æ¬¡ï¼Œæˆ‘ä»¬æ›´åŠ å…³æ³¨çš„æ˜¯å‡½æ•°æ‰€å®žçŽ°çš„åŠŸèƒ½è€Œå¹¶ä¸åœ¨æ„å‡½æ•°å«ä»€ä¹ˆï¼ˆå› ä¸ºå¹¶ä¸éœ€è¦åœ¨åˆ«çš„åœ°æ–¹è¢«è°ƒç”¨ï¼‰ï¼Œè¿™æ—¶å€™å»ºè®®ä½¿ç”¨IIFEæ¥ä»£æ›¿ï¼š1234(function() &#123; var a = 3; console.log(a); // 3&#125;)();æˆ–è€…1234(function()&#123; var a = 3; console.log(a); // 3&#125;());ä¸ºäº†æé«˜å‡½æ•°çš„å¯è¯»æ€§ï¼Œä½ å¯èƒ½ä¼šç»™è¿™ä¸ªåŒ¿åå‡½æ•°è¡¨è¾¾å¼åŠ ä¸Šä¸€ä¸ªåç§°ï¼Œæ¯”å¦‚ï¼š1234(function foo()&#123; var a = 3; console.log(a); // 3&#125;());å¯¹IIFEçš„å…·åå¹¶ä¸ä¼šæ±¡æŸ“å…¶å¤–éƒ¨çš„è¯æ³•ä½œç”¨åŸŸï¼Œä½ å¯ä»¥ç»§ç»­åœ¨å¤–éƒ¨å£°æ˜Žä¸€ä¸ªåç§°ä¸ºfooçš„å‡½æ•°ï¼Œæ¯”å¦‚ï¼š123456789function foo() &#123; var a = 4; console.log(a); &#125;(function foo()&#123; var a = 3; console.log(a); // 3&#125;());foo(); // 4IIFEè¿˜è¢«å¸¸ç”¨äºŽJSæ¨¡å—åŒ–è®¾è®¡ï¼Œæ¯”å¦‚ï¼š123456789101112131415161718192021var modules = (function() &#123; // ç§æœ‰å˜é‡ var msg = "hello world"; var msgArr = ['h', 'e', 'l', 'l', 'o']; function helloWorld() &#123; console.log(msg); &#125; function sayHello() &#123; console.log(msgArr.join('')); &#125; // æš´éœ²æ–¹æ³• return &#123; helloWorld: helloWorld, sayHello: sayHello &#125;&#125;)();modules.helloWorld(); // hello worldmodules.sayHello(); // helloconsole.log(modules.msg); // undefinedå¯è§åœ¨å¤–éƒ¨æ— æ³•è®¿é—®æ¨¡å—åŒ–å†…éƒ¨å‚æ•°ï¼Œè¿™é¿å…äº†å†…éƒ¨å‚æ•°è¢«ç§è‡ªç¯¡æ”¹ä»¥åŠå˜é‡æ±¡æŸ“ç­‰é—®é¢˜ã€‚]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS3æ¸å˜]]></title>
    <url>%2FCSS3%E6%B8%90%E5%8F%98.html</url>
    <content type="text"><![CDATA[åœ¨CSS3æ ‡å‡†å‘å¸ƒä¹‹å‰ï¼Œç½‘é¡µä¸Šçš„æ¸å˜æ•ˆæžœä¸€èˆ¬éƒ½æ˜¯è®¾è®¡å¸ˆä½¿ç”¨å›¾å½¢åŒ–è®¾è®¡è½¯ä»¶ç”Ÿæˆå›¾ç‰‡ï¼Œç„¶åŽä½œä¸ºé¡µé¢èƒŒæ™¯å®žçŽ°çš„ã€‚åœ¨CSS3æ ‡å‡†å‘å¸ƒä¹‹åŽï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥ç¼–å†™CSSä»£ç æ¥è½»æ¾å®žçŽ°æ¸å˜æ•ˆæžœã€‚æ¸å˜ä¸»è¦åŒ…å«çº¿æ€§æ¸å˜å’Œå¾„å‘æ¸å˜ã€‚çº¿æ€§æ¸å˜çº¿æ€§æ¸å˜ï¼ˆLinear Gradientsï¼‰åŒ…å«å‘ä¸‹/å‘ä¸Š/å‘å·¦/å‘å³/å¯¹è§’æ–¹å‘çš„é¢œè‰²æ¸å˜ã€‚åŸºæœ¬è¯­æ³•ï¼š1background: linear-gradient(direction, color-stop1, color-stop2, ...); â€‹directionä¸ºæ¸å˜æ–¹å‘ï¼Œcolor-stop1ä¸ºæ¸å˜èµ·å§‹é¢œè‰²ï¼Œcolor-stop2ä¸ºæ¸å˜ç»“æŸé¢œè‰²ã€‚ä»Žä¸Šåˆ°ä¸‹ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰é»˜è®¤æƒ…å†µä¸‹ï¼Œçº¿æ€§æ¸å˜æ–¹å‘å°±æ˜¯ä»Žå·¦åˆ°å³ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™directionå±žæ€§å¯ä»¥ç•¥åŽ»ã€‚ä¾‹å¦‚ï¼šSee the Pen liner-graident by wuyouzhuguli (@mrbird) on CodePen.ä¸ºäº†å…¼å®¹webkitå†…æ ¸æµè§ˆå™¨ï¼Œå®žé™…çš„ä»£ç åº”è¯¥ä¸ºï¼š123456div &#123; height: 200px; width: 200px; background: linear-gradient(#FFFFCC,#FF6666); background: -webkit-gradient(linear,left top, left bottom,from(#FFFFCC),to(#FF6666));&#125;å…³äºŽCSS3å±žæ€§å…¼å®¹æ€§å‰ç¼€ï¼Œå¯ä»¥ä½¿ç”¨sublime text 3çš„Autoprefixeræ’ä»¶æ¥è‡ªåŠ¨ç”Ÿæˆã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šèµ·æ­¢é¢œè‰²çš„èµ·å§‹ä½ç½®ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼šSee the Pen linear-gradient(location) by wuyouzhuguli (@mrbird) on CodePen.ä»Žæ¸å˜æ–¹å‘10%é•¿åº¦å¼€å§‹åˆ°æ¸å˜æ–¹å‘60%é•¿åº¦ä¹‹é—´ï¼Œé¢œè‰²ä»Ž#FFCæ¸å˜åˆ°#F66ã€‚å°äºŽ10%éƒ¨åˆ†èƒŒæ™¯é¢œè‰²å®Œå…¨ä¸º#FFCï¼Œå¤§äºŽ60%éƒ¨åˆ†èƒŒæ™¯é¢œè‰²å®Œå…¨ä¸º#F66ã€‚ä»Žå·¦åˆ°å³ä»Žå·¦åˆ°å³åªéœ€å°†directionå±žæ€§å€¼è®¾ä¸ºto rightï¼Œä¾‹å¦‚ï¼šSee the Pen liner-gradient(to right) by wuyouzhuguli (@mrbird) on CodePen.å¯¹è§’æ–¹å‘å¯ä»¥é€šè¿‡æŒ‡å®šæ°´å¹³å’Œåž‚ç›´çš„èµ·å§‹ä½ç½®æ¥åˆ¶ä½œä¸€ä¸ªå¯¹è§’æ¸å˜ã€‚ä¾‹å¦‚ä»Žå·¦ä¸Šè§’åˆ°å³ä¸‹è§’æ–¹å‘æ¸å˜ï¼šSee the Pen liner-gradient(å¯¹è§’) by wuyouzhuguli (@mrbird) on CodePen.ä½¿ç”¨ä»»æ„è§’åº¦å¦‚æžœæƒ³è¦åœ¨æ¸å˜çš„æ–¹å‘ä¸Šåšæ›´å¤šçš„æŽ§åˆ¶ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªè§’åº¦ï¼Œè€Œä¸ç”¨é¢„å®šä¹‰æ–¹å‘ï¼ˆto bottomã€to topã€to rightã€to leftã€to bottom rightï¼Œç­‰ç­‰ï¼‰ã€‚è¯­æ³•ï¼š1background: linear-gradient(angle, color-stop1, color-stop2); â€‹angleæŒ‡æ°´å¹³çº¿å’Œæ¸å˜çº¿ä¹‹é—´çš„è§’åº¦ï¼Œé€†æ—¶é’ˆæ–¹å‘è®¡ç®—ã€‚æ¢å¥è¯è¯´ï¼Œ0degå°†åˆ›å»ºä¸€ä¸ªä»Žä¸‹åˆ°ä¸Šçš„æ¸å˜ï¼Œ90degå°†åˆ›å»ºä¸€ä¸ªä»Žå·¦åˆ°å³çš„æ¸å˜ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„å¾ˆå¤šæµè§ˆå™¨(Chrome,Safari,firefoxç­‰)çš„ä½¿ç”¨äº†æ—§çš„æ ‡å‡†ï¼Œå³ 0deg å°†åˆ›å»ºä¸€ä¸ªä»Žå·¦åˆ°å³çš„æ¸å˜ï¼Œ90deg å°†åˆ›å»ºä¸€ä¸ªä»Žä¸‹åˆ°ä¸Šçš„æ¸å˜ã€‚æ¢ç®—å…¬å¼ 90 - x = y å…¶ä¸­ x ä¸ºæ ‡å‡†è§’åº¦ï¼Œyä¸ºéžæ ‡å‡†è§’åº¦ã€‚ä¸‹é¢çš„å®žä¾‹æ¼”ç¤ºäº†å¦‚ä½•åœ¨çº¿æ€§æ¸å˜ä¸Šä½¿ç”¨è§’åº¦ï¼šSee the Pen liner-gradient(use angle) by wuyouzhuguli (@mrbird) on CodePen.ä½¿ç”¨å¤šä¸ªé¢œè‰²ç»“ç‚¹é™¤äº†è®¾ç½®ä¸€ç»„èµ·å§‹é¢œè‰²å’Œç»“æŸé¢œè‰²å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®å¤šç»„æ¸å˜é¢œè‰²ã€‚æ¯”å¦‚ï¼šSee the Pen liner-gradient(repeat) by wuyouzhuguli (@mrbird) on CodePen.ä½¿ç”¨é€æ˜Žåº¦CSS3 æ¸å˜ä¹Ÿæ”¯æŒé€æ˜Žåº¦ï¼ˆtransparencyï¼‰ï¼Œå¯ç”¨äºŽåˆ›å»ºå‡å¼±å˜æ·¡çš„æ•ˆæžœã€‚ä¸ºäº†æ·»åŠ é€æ˜Žåº¦ï¼Œæˆ‘ä»¬ä½¿ç”¨ rgba() å‡½æ•°æ¥å®šä¹‰é¢œè‰²ç»“ç‚¹ã€‚æ¯”å¦‚ï¼šSee the Pen liner-gradient(opacity) by wuyouzhuguli (@mrbird) on CodePen.é‡å¤çš„çº¿æ€§æ¸å˜repeating-linear-gradient()å‡½æ•°ç”¨äºŽé‡å¤çº¿æ€§æ¸å˜ï¼Œè¯­æ³•å’Œlinear-gradient()ç›¸åŒï¼Œä¾‹å¦‚ï¼šSee the Pen repeating-linear-gradient by wuyouzhuguli (@mrbird) on CodePen.ä¸Šé¢ä¾‹å­ä¸­ï¼Œæœ‰ä¸€ä¸ªç™½è‰²æ¡çº¹ä»Ž0åˆ°.25emçº¿æ€§æ¸å˜ï¼ŒæŽ¥ç€ä¸€æ¡#FF6é¢œè‰²æ¡çº¹ä»Ž.25emåˆ°.75emã€‚ï¼ˆ#FF6é¢œè‰²æ¡çº¹å®½åº¦ = .75em - .25em = .5em = ç™½è‰²æ¡çº¹å®½åº¦çš„ä¸¤å€ ï¼ .25em * 2ï¼‰ã€‚å¾„å‘æ¸å˜å¾„å‘æ¸å˜æŒ‡çš„æ˜¯ä»Žåœ†å¿ƒå‘å¤–æ‰©æ•£çš„æ¸å˜ï¼Œä¸ºäº†åˆ›å»ºä¸€ä¸ªå¾„å‘æ¸å˜ï¼Œå¿…é¡»è‡³å°‘å®šä¹‰ä¸¤ç§é¢œè‰²ç»“ç‚¹ã€‚é¢œè‰²ç»“ç‚¹å³ä½ æƒ³è¦å‘ˆçŽ°å¹³ç¨³è¿‡æ¸¡çš„é¢œè‰²ã€‚åŒæ—¶ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‡å®šæ¸å˜çš„ä¸­å¿ƒã€å½¢çŠ¶ï¼ˆåŽŸåž‹æˆ–æ¤­åœ†å½¢ï¼‰ã€å¤§å°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¸å˜çš„ä¸­å¿ƒæ˜¯ centerï¼ˆè¡¨ç¤ºåœ¨ä¸­å¿ƒç‚¹ï¼‰ï¼Œæ¸å˜çš„å½¢çŠ¶æ˜¯ ellipseï¼ˆè¡¨ç¤ºæ¤­åœ†å½¢ï¼‰ï¼Œæ¸å˜çš„å¤§å°æ˜¯ farthest-cornerï¼ˆè¡¨ç¤ºåˆ°æœ€è¿œçš„è§’è½ï¼‰ã€‚é¢œè‰²ç»“ç‚¹å‡åŒ€åˆ†å¸ƒï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰å¦‚ä¸‹æ‰€ç¤ºï¼šSee the Pen radial-gradient by wuyouzhuguli (@mrbird) on CodePen.é¢œè‰²ç»“ç‚¹ä¸å‡åŒ€åˆ†å¸ƒå¦‚ä¸‹æ‰€ç¤ºï¼šSee the Pen radial-gradient1 by wuyouzhuguli (@mrbird) on CodePen.é‡å¤çš„å¾„å‘æ¸å˜å¦‚ä¸‹æ‰€ç¤ºï¼šSee the Pen repeating-dadial-gradient by wuyouzhuguli (@mrbird) on CodePen.]]></content>
      <tags>
        <tag>CSS3</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è°ƒæ•™Sublime Text 3]]></title>
    <url>%2F%E8%B0%83%E6%95%99sublime-text3.html</url>
    <content type="text"><![CDATA[Sublime Text 3 æ˜¯ä¸€æ¬¾ç¼–è¾‘å™¨è½¯ä»¶ï¼Œè‡ªå¸¦è¯­æ³•é«˜äº®ï¼Œä»£ç æç¤ºï¼Œè‡ªåŠ¨è¡¥å…¨ç­‰è®©å¼€å‘è€…çˆ±ä¸é‡Šæ‰‹çš„åŠŸèƒ½ã€‚å¹¶ä¸”å¯åŠ¨é€Ÿåº¦æžå¿«ï¼Œæ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜å’Œå®‰è£…ç¬¬ä¸‰æ–¹æ’ä»¶ã€‚ä¸è¿‡åˆšä¸‹è½½çš„Sublime Textä¸ä»…å›¾æ ‡å·¨ä¸‘ï¼Œä¸»é¢˜è¿˜éš¾çœ‹ï¼Œå»ºè®®å¯¹å…¶è¿›è¡Œä¸€ç•ªè°ƒæ•™ã€‚è°ƒæ•™åŒ…æ‹¬é…ç½®ä¸»é¢˜ï¼Œå®‰è£…æ’ä»¶ï¼Œäº†è§£å¿«æ·é”®å’Œé…ç½®äº‘åŒæ­¥ç­‰ã€‚è°ƒæ•™ä¹‹å‰éœ€è¦å®‰è£…Package Controlã€‚ä½¿ç”¨å¿«æ·é”®Ctrl+Shift+På‘¼å‡ºCommand Paletteï¼Œç„¶åŽè¾“å…¥install Package Controlï¼Œç„¶åŽEnterå³å¯å®‰è£…ã€‚å®˜æ–¹Package Controlå¸‚åœºï¼šhttps://packagecontrol.io/ã€‚å®‰è£…ä¸»é¢˜Sublime TextåŒ…å«å¾ˆå¤šä¼˜ç§€çš„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œä¸è¿‡ä¸ªäººè¿˜æ˜¯æ¯”è¾ƒå–œæ¬¢Boxy Themeã€‚åœ¨Command Paletteä¸­è¾“å…¥installï¼Œé€‰æ‹©Package Control: install Packageï¼šç‚¹å‡»Enterå‘¼å‡ºPackage ControlåŽè¾“å…¥Boxy ThemeåŽç‚¹å‡»Enterå³å¯å®‰è£…ã€‚æŽ§åˆ¶å°æç¤ºå®‰è£…æˆåŠŸåŽï¼Œä½¿ç”¨å¿«æ·é”®Ctrl+Shift+På‘¼å‡ºCommand Paletteï¼Œè¾“å…¥boxyï¼Œé€‰æ‹©Boxy Theme:Activationå³å¯åœ¨Boxy Themeè‡ªå¸¦çš„å‡ æ¬¾ä¸»é¢˜ä¸­è¿›è¡Œåˆ‡æ¢ï¼šä¸ªäººæ¯”è¾ƒå–œæ¬¢Yesterdayè¿™æ¬¾ä¸»é¢˜ï¼šYesterdayç›¸å…³é…ç½®ï¼ˆPreferencesâ†’settingsï¼‰ï¼š12345678910111213141516171819202122232425&#123; "color_scheme": "Packages/Boxy Theme/schemes/Boxy Yesterday.tmTheme", "font_size": 11, "ignored_packages": [ "Vintage" ], "theme": "Boxy Yesterday.sublime-theme", // Settings "theme_accent_sky": true, "theme_button_rounded": true, "theme_find_panel_close_hidden": true, "theme_find_panel_size_xs": true, "theme_grid_border_size_lg": true, "theme_icon_button_highlighted": true, "theme_icons_atomized": true, "theme_popup_border_visible": true, "theme_quick_panel_size_md": true, "theme_scrollbar_rounded": true, "theme_sidebar_disclosure": true, "theme_sidebar_indent_top_level_disabled": true, "theme_statusbar_size_md": true, "theme_tab_rounded": true, "theme_tab_selected_prelined": true&#125;è¿˜å¯ä»¥å®‰è£…ä¸Žè¯¥ä¸»é¢˜é…å¥—çš„Mono File Iconsæ’ä»¶ï¼Œç”¨äºŽç¾ŽåŒ–ä¸åŒæ ¼å¼æ–‡ä»¶çš„å›¾æ ‡æ ·å¼ã€‚å®‰è£…æ–¹æ³•åŒä¸Šï¼Œä¸å†èµ˜è¿°ã€‚æ•ˆæžœå¦‚ä¸‹ï¼šå›¾æ ‡æ›¿æ¢å¯ä»¥åœ¨Dribbbleä¸­æœç´¢Sublime Textï¼Œç„¶åŽä¸‹è½½å–œæ¬¢çš„å›¾æ ‡ã€‚ä¸è¿‡å¤§å¤šæ•°ç´ æéƒ½æ˜¯Macçš„icnsæ ¼å¼çš„ï¼Œå¯ä»¥åœ¨https://iconverticons.com/online/ç½‘ç«™ä¸­åœ¨çº¿è½¬æ¢ä¸ºwindowsä¸­çš„icoæ ¼å¼ã€‚å®‰è£…æ’ä»¶æŽ¨èå‡ æ¬¾å¸¸ç”¨çš„æ’ä»¶ï¼šAutoprefixeråœ¨ç¼–å†™CSSä»£ç çš„æ—¶å€™ï¼Œç»å¸¸éœ€è¦ä¸ºäº†å…¼å®¹ä¸åŒå†…æ ¸çš„æµè§ˆå™¨è€Œåœ¨å±žæ€§å‰ç¼–å†™-webkit-ï¼Œ-ms-,-moz-ç­‰å‰ç¼€ã€‚ä½¿ç”¨è¿™æ¬¾æ’ä»¶å¯ä»¥æ›¿ä»£æˆ‘ä»¬è‡ªåŠ¨å®Œæˆè¿™ä»¶äº‹ã€‚ æ’ä»¶åœ°å€https://packagecontrol.io/packages/Autoprefixerã€‚å®‰è£…æ–¹å¼å’Œä¸»é¢˜çš„å®‰è£…ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ï¼Œä¸‹é¢æ’ä»¶å°†ä¸å†æè¿°å®‰è£…æ–¹æ³•ã€‚å®‰è£…å®ŒæˆåŽï¼Œå¯ä»¥é…ç½®å¿«æ·é”®ï¼ˆPreferencesâ†’key Bindingsï¼‰ï¼š123456[ &#123; "keys": ["alt+shift+p"], "command": "autoprefixer" &#125;]æˆ–è€…ç›´æŽ¥åœ¨Command Paletteä¸­è¾“å…¥autoï¼Œé€‰æ‹©ç¬¬ä¸€é¡¹ï¼šæ•ˆæžœå¦‚ä¸‹ï¼šQuoteHTMLQuoteHTMLå¯å°†HTMLç‰‡æ®µè½¬æ¢ä¸ºå­—ç¬¦ä¸²ç‰‡æ®µï¼Œåœ¨æ“ä½œDOMçš„æ—¶å€™éžå¸¸æ–¹ä¾¿ï¼ŒçœåŽ»äº†è‡ªå·±æ‰‹åŠ¨æ‹¼æŽ¥çš„æ—¶é—´ã€‚æ¯”å¦‚æœ‰å¦‚ä¸‹HTMLç‰‡æ®µï¼š1234567&lt;select class="form-control" id="typeSel" style="width:260px;padding: 0px 6px;"&gt; &lt;option value="1"&gt;option_1&lt;/option&gt; &lt;option value="2"&gt;option_2&lt;/option&gt; &lt;option value="3"&gt;option_3&lt;/option&gt; &lt;option value="4"&gt;option_4&lt;/option&gt; &lt;option value="5"&gt;option_5&lt;/option&gt;&lt;/select&gt;åœ¨Command Paletteä¸­è¾“å…¥qï¼šå¯æ ¹æ®å®žé™…éœ€æ±‚è‡ªç”±é€‰æ‹©ï¼Œè¿™é‡Œé€‰æ‹©ç¬¬äºŒé¡¹ç„¶åŽæ•²å‡»Enterï¼Œæ•ˆæžœå¦‚ä¸‹ï¼šçœŸæ˜¯æžå…¶æ–¹ä¾¿çš„è¯´ï¼ä¹Ÿå¯ä»¥è‡ªå·±è®¾ç½®å¿«æ·é”®ã€‚JsFormatJsFormatæ’ä»¶å¯ä»¥å°†åŽ‹ç¼©åŽçš„JSä»£ç æ ¼å¼åŒ–ï¼Œé»˜è®¤ç»‘å®šå¿«æ·é”®Ctrl+Alt+F,ä¹Ÿå¯ä»¥è‡ªå·±è®¾ç½®å¿«æ·é”®ï¼š123456789&#123; "keys": ["ctrl+alt+f"], "command": "js_format", "context": [&#123; "key": "selector", "operator": "equal", "operand": "source.javascript" &#125;]&#125;æˆ–è€…åœ¨Command Paletteä¸­è¾“å…¥formatï¼šå€¼å¾—ä¸€æçš„æ˜¯ï¼Œå®ƒä¹Ÿå¯ä»¥æ ¼å¼åŒ–JSONæ•°æ®ã€‚CSSFormatå’ŒJsFormatç±»ä¼¼çš„æ˜¯ï¼ŒCSSFormatç”¨äºŽæ ¼å¼åŒ–åŽ‹ç¼©åŽçš„CSSä»£ç ã€‚å®‰è£…å®ŒæˆåŽï¼Œå³é”®é€‰æ‹©CSS Formatå¯çœ‹åˆ°å¯¹åº”çš„å‡ ä¸ªé€‰é¡¹ï¼Œä¸åŒé€‰é¡¹æ ¼å¼åŒ–çš„æ ·å¼ä¸ä¸€æ ·ï¼Œå¯è‡ªè¡Œä½“éªŒã€‚ä¹Ÿå¯ä»¥åœ¨Command Paletteä¸­è¾“å…¥format csså¹¶æŒ‰ä¸‹Enteræ¥æ ¼å¼åŒ–CSSä»£ç ï¼šHTML-CSS-JS PrettifyHTML-CSS-JS Prettifyæ˜¯ä¸€æ¬¾åŸºäºŽnode.jsçš„HTML/CSS/JS ä»£ç ç¾ŽåŒ–æ’ä»¶ã€‚å› ä¸ºæ˜¯åŸºäºŽnode.jsï¼Œæ‰€ä»¥å®‰è£…å‰éœ€è¦é…ç½®å¥½node.jsçŽ¯å¢ƒã€‚å®‰è£…å¥½åŽï¼Œéœ€è¦åœ¨æ’ä»¶è®¾ç½®é‡Œé…ç½®æœ¬åœ°node.jsçš„å®‰è£…è·¯å¾„ï¼Œå³é”®é€‰æ‹©HTML/CSS/JS Prettify â†’ Plugin Options - Defaultï¼šçŽ°æœ‰å¦‚ä¸‹ä¸€æ®µæ ¼å¼æ··ä¹±çš„jsä»£ç ï¼šå³é”®é€‰æ‹©HTML/CSS/JS Prettify â†’ Prettify Codeï¼šæ•ˆæžœå¦‚ä¸‹æ‰€ç¤ºï¼šMinifyMinifyæ˜¯ä¸€æ¬¾å¯ä»¥åŽ‹ç¼©Jsï¼ŒCSSï¼ŒHTMLï¼ŒJSONï¼ŒSVGç­‰æ ¼å¼æ–‡ä»¶çš„æ’ä»¶ã€‚å®‰è£…å®Œæ’ä»¶åŽæ‰“å¼€cmdè¾“å…¥ä¸‹é¢å‘½ä»¤å®‰è£…ï¼š1npm install -g clean-css uglifycss js-beautify html-minifier uglify-js minjson svgoå¦‚æžœä½ å·²ç»å®‰è£…è¿‡å…¶ä¸­çš„ä¸€äº›çš„è¯å¯ä»¥ç”¨ä¸‹é¢å‘½ä»¤æ›´æ–°ï¼š1npm update -g clean-css uglifycss js-beautify html-minifier uglify-js minjson svgoç„¶åŽå³é”®ä¸­å°±æœ‰Minifyçš„é€‰é¡¹äº†ï¼šColorâ€‹HelperColorHelperæä¾›CSSé¢œè‰²é¢„è§ˆï¼Œæä¾›é¢œè‰²è½¬æ¢ï¼Œå¹¶å…è®¸åœ¨è°ƒè‰²æ¿ä¸­å­˜å‚¨å’Œè®¿é—®å–œçˆ±çš„é¢œè‰²ã€‚å®‰è£…è¯¥æ’ä»¶åŽï¼ŒCSSä¸­é¢œè‰²å±žæ€§å€¼å‰ä¼šå‡ºçŽ°ä¸€ä¸ªç›¸åº”é¢œè‰²çš„å°æ–¹å—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šç‚¹å‡»å°æ–¹å—ï¼Œå¯ä»¥è¿›è¡Œé¢œè‰²æ ¼å¼çš„è½¬æ¢ï¼Œå¦‚16è¿›åˆ¶è½¬RGB,RGBA,HSLå’ŒHSLAï¼šä¹Ÿå¯ä»¥åœ¨è°ƒè‰²æ¿ä¸­èŽ·å–è‡ªå·±å–œæ¬¢çš„é¢œè‰²ï¼Œå¹¶æ’å…¥ï¼šBetter Completionç›¸æ¯”Sublime Text 3è‡ªå¸¦çš„ä»£ç è¡¥å…¨åŠŸèƒ½ï¼ŒBetter Completionå¯ä»¥æä¾›æ›´å¥½è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œæ”¯æŒJavaScriptï¼ŒjQueryï¼ŒLodashï¼ŒUnderscoreï¼ŒHTML5ï¼ŒCSS3å’ŒBootstrapç­‰ã€‚å®‰è£…å®ŒåŽåœ¨Command Paletteè¾“å…¥sbcï¼Œç„¶åŽæŒ‰ä¸‹Enteré”®ï¼šåœ¨å¼¹å‡ºçš„æ–‡ä»¶ä¸­è¾“å…¥å¦‚ä¸‹é…ç½®ï¼Œå¹¶ä¸”å°†é‚£äº›éœ€è¦å¼€å¯è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½è¯­è¨€çš„é€‰é¡¹åŽçš„falseæ”¹ä¸ºtrueï¼š123456789101112131415161718192021222324252627282930313233343536&#123; // `true` means enable it. // `false` means disable it. "completion_active_list": &#123; // build-in completions "css-properties": true, "gruntjs-plugins": false, "html": true, "lodash": false, "javascript": true, "jquery": true, "jquery-sq": false, // Single Quote "php": false, "phpci": false, "sql": true, "twitter-bootstrap": true, "twitter-bootstrap-less-variables": true, "twitter-bootstrap3": true, "twitter-bootstrap3-sass-variables": false, "underscorejs": false, "react": false, // Your own completions? // ~/Library/Application\ Support/Sublime\ Text\ 3/Packages/User/sbc-api-my-angularjs.sublime-settings "my-angularjs": false, // ~/Library/Application\ Support/Sublime\ Text\ 3/Packages/User/sbc-api-my-glossary.sublime-settings "my-glossary": false, // ~/Library/Application\ Support/Sublime\ Text\ 3/Packages/User/sbc-api-my-html.sublime-settings "my-html": false, // ~/Library/Application\ Support/Sublime\ Text\ 3/Packages/User/sbc-api-my-javascript.sublime-settings "my-javascript": false &#125;&#125;jQueryè‡ªåŠ¨è¡¥å…¨çš„æ•ˆæžœå›¾å¦‚ä¸‹ï¼šModificModificçªå‡ºæ˜¾ç¤ºè¡Œè‡ªä¸Šæ¬¡æäº¤ä»¥æ¥çš„æ›´æ”¹æƒ…å†µï¼ˆæ”¯æŒGitï¼ŒSVNç­‰ç‰ˆæœ¬æŽ§åˆ¶å·¥å…·ï¼‰ã€‚å®‰è£…å®ŒåŽï¼Œå¦‚æžœåœ¨ç‰ˆæœ¬æŽ§åˆ¶ç®¡ç†ç›®å½•ä¸‹ä¿®æ”¹äº†æ–‡ä»¶è¡Œï¼Œæ–°å¢žçš„éƒ¨åˆ†ä»¥ä¸‰è§’æ ‡æ˜¾ç¤ºï¼Œä¿®æ”¹çš„éƒ¨åˆ†ä»¥è±å½¢æ˜¾ç¤ºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šWakaTimeWakaTimeæ’ä»¶ç”¨äºŽåœ¨Dashboardä¸­æ˜¾ç¤ºä½ è¿™å‘¨çš„ç¼–ç¨‹æ—¶é—´ï¼Œç¼–å†™ä»£ç ç§ç±»å æ¯”ç­‰ä¿¡æ¯ã€‚å®‰è£…å®Œæ’ä»¶åŽï¼Œåœ¨Sublime Textç¼–è¾‘å™¨ä¸‹æ–¹ä¼šè¦æ±‚æ‚¨è¾“å…¥å¯†åŒ™å¹¶æŒ‰ä¸‹Enterå³å¯ï¼Œå¯†åŒ™èŽ·å–åœ°å€ï¼šhttps://wakatime.com/settings/account#apikeyï¼šåœ¨ç¼–å†™ä¸€æ®µæ—¶é—´åŽï¼Œå°±å¯ä»¥åŽ»https://wakatime.com/dashboardä¸­æŸ¥çœ‹ä½ çš„ç¼–ç æƒ…å†µå•¦ï¼šå¸¸ç”¨å¿«æ·é”®è¿™é‡Œåªåˆ—å‡ºäº†Sublime Textåœ¨windowä¸­ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„è‡ªå¸¦å¿«æ·é”®ï¼š12345678910111213141516171819202122232425262728293031323334353637Alt+R : å¼€å¯æ­£åˆ™è¡¨è¾¾å¼åŠŸèƒ½Alt+Enter: æ‰¾åˆ°åŒ¹é…ç›®æ ‡åŽå…¨éƒ¨é€‰æ‹©Ctrl+Rï¼šå‰å¾€ methodCtrl+Mï¼šè·³è½¬åˆ°å¯¹åº”æ‹¬å·æŒ‰Ctrl+Shift+ä¸Šä¸‹é”®ï¼Œå¯æ›¿æ¢è¡ŒCtrl+Dï¼šé€‰æ‹©å•è¯ï¼Œé‡å¤å¯å¢žåŠ é€‰æ‹©ä¸‹ä¸€ä¸ªç›¸åŒçš„å•è¯Ctrl+Lï¼šé€‰æ‹©è¡Œï¼Œé‡å¤å¯ä¾æ¬¡å¢žåŠ é€‰æ‹©ä¸‹ä¸€è¡ŒCtrl+Shift+Pï¼šæ‰“å¼€å‘½ä»¤é¢æ¿Ctrl+Gï¼šè·³è½¬åˆ°ç¬¬å‡ è¡ŒCtrl+Wï¼šå…³é—­å½“å‰æ‰“å¼€æ–‡ä»¶Ctrl+KKï¼šåˆ é™¤å½“å‰è¡Œå…‰æ ‡åŽçš„æ‰€æœ‰å†…å®¹Ctrl+Shift+Wï¼šå…³é—­æ‰€æœ‰æ‰“å¼€æ–‡ä»¶Ctrl+Shift+Vï¼šç²˜è´´å¹¶æ ¼å¼åŒ–Ctrl+Shift+Lï¼šé€‰æ‹©å¤šè¡ŒCtrl+Shift+Enterï¼šåœ¨å½“å‰è¡Œå‰æ’å…¥æ–°è¡ŒCtrl+Shift+Kï¼šåˆ é™¤å½“å‰è¡ŒCtrl+Uï¼šè½¯æ’¤é”€ï¼Œæ’¤é”€å…‰æ ‡ä½ç½®Ctrl+Jï¼šé€‰æ‹©æ ‡ç­¾å†…å®¹Ctrl+Fï¼šæŸ¥æ‰¾å†…å®¹Ctrl+Shift+Fï¼šæŸ¥æ‰¾å¹¶æ›¿æ¢Ctrl+Hï¼šæ›¿æ¢Ctrl+Nï¼šæ–°å»ºçª—å£Ctrl+K+Bï¼šå¼€å…³ä¾§æ Ctrl+Shift+Mï¼šé€‰ä¸­å½“å‰æ‹¬å·å†…å®¹ï¼Œé‡å¤å¯é€‰ç€æ‹¬å·æœ¬èº«Ctrl+F2ï¼šè®¾ç½®/åˆ é™¤æ ‡è®°Ctrl+/ï¼šæ³¨é‡Šå½“å‰è¡ŒCtrl+Shift+/ï¼šå½“å‰ä½ç½®æ’å…¥æ³¨é‡ŠCtrl+Alt+/ï¼šå—æ³¨é‡Šï¼Œå¹¶Focusåˆ°é¦–è¡Œï¼Œå†™æ³¨é‡Šè¯´æ˜Žç”¨çš„Ctrl+Shift+Aï¼šé€‰æ‹©å½“å‰æ ‡ç­¾å‰åŽï¼Œä¿®æ”¹æ ‡ç­¾ç”¨çš„F11ï¼šå…¨å±Shift+F11ï¼šå…¨å±å…æ‰“æ‰°æ¨¡å¼ï¼Œåªç¼–è¾‘å½“å‰æ–‡ä»¶Alt+F3ï¼šé€‰æ‹©æ‰€æœ‰ç›¸åŒçš„è¯Alt+.ï¼šé—­åˆæ ‡ç­¾Alt+Shift+æ•°å­—ï¼šåˆ†å±æ˜¾ç¤ºAlt+æ•°å­—ï¼šåˆ‡æ¢æ‰“å¼€ç¬¬Nä¸ªæ–‡ä»¶Ctrl+shift+D: å¤‡ä»½å¤šä¸ªå½“å‰è¡ŒCtrl+shift+T: æ¢å¤å·²ç»å…³é—­çš„æ ‡ç­¾åœ¨ä¸åŒè®¾å¤‡ä¸‹åŒæ­¥ä¸ªäººé…ç½®å¯ä»¥ä½¿ç”¨GitåŒæ­¥Packages/User/æ–‡ä»¶å¤¹ï¼ˆå¯ä»¥åœ¨Preferencesâ†’Browse Packagesâ€¦æ‰“å¼€ï¼‰ä¸‹çš„å†…å®¹ï¼Œæ­¤æ–‡ä»¶å¤¹åŒ…å«Package Control.sublime-settingsæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰å·²å®‰è£…è½¯ä»¶åŒ…çš„åˆ—è¡¨ã€‚ä½¿ç”¨GitåŒæ­¥åˆ°å¦ä¸€å°æœºå™¨ï¼Œä¸‹æ¬¡å¯åŠ¨Sublime Textæ—¶ï¼ŒPackage Control å°†å®‰è£…ä»»ä½•ä¸¢å¤±çš„è½¯ä»¶åŒ…çš„æ­£ç¡®ç‰ˆæœ¬ã€‚æœ‰äº›æ’ä»¶å®‰è£…åŽéœ€è¦é‡å¯Sublime Textæ‰èƒ½ç”Ÿæ•ˆã€‚æ’ä»¶å®‰è£…å¤šäº†ï¼Œå¯èƒ½å¼•èµ·å¿«æ·é”®çš„å†²çªï¼Œéœ€è¦å¼•èµ·æ³¨æ„ã€‚]]></content>
      <tags>
        <tag>Sublime Text</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitåˆ†æ”¯ç®¡ç†]]></title>
    <url>%2FGit%E5%88%86%E6%94%AF%E7%AE%A1%E7%90%86.html</url>
    <content type="text"><![CDATA[git branchå‘½ä»¤ä¸ä»…ä»…èƒ½åˆ›å»ºå’Œåˆ é™¤åˆ†æ”¯ï¼Œå¦‚æžœä¸åŠ ä»»ä½•å‚æ•°ï¼Œå®ƒä¼šç»™å‡ºå½“å‰æ‰€æœ‰åˆ†æ”¯çš„æ¸…å•ï¼š1234$ git branch develop* master testå¸¦*è¡¨ç¤ºå½“å‰æ‰€åœ¨åˆ†æ”¯ã€‚ä½¿ç”¨å‘½ä»¤git branch -våˆ™å¯ä»¥æŸ¥çœ‹å„ä¸ªåˆ†æ”¯æœ€åŽä¸€ä¸ªæäº¤å¯¹è±¡çš„ä¿¡æ¯ï¼š1234$ git branch -v develop ef993bc update About.html* master 0986092 [ahead 26] update index.html test 19fffc0 add test fileä½¿ç”¨å‘½ä»¤git branch --mergedå¯ä»¥æŸ¥çœ‹å“ªäº›åˆ†æ”¯ä¸Žå½“å‰åˆ†æ”¯è¿›è¡Œäº†åˆå¹¶æ“ä½œï¼š123$ git branch --merged develop* masterä¸Žä¹‹ç›¸åçš„å‘½ä»¤ä¸ºgit branch --no-merged:12$ git branch --no-merged testteståˆ†æ”¯ä¸­è¿˜åŒ…å«ç€å°šæœªåˆå¹¶è¿›æ¥çš„å·¥ä½œæˆæžœï¼Œæ‰€ä»¥ç®€å•åœ°ç”¨git branch -dåˆ é™¤è¯¥åˆ†æ”¯ä¼šæç¤ºé”™è¯¯ï¼Œå› ä¸ºé‚£æ ·åšä¼šä¸¢å¤±æ•°æ®ï¼š123$ git branch -d testerror: The branch 'test' is not fully merged.If you are sure you want to delete it, run 'git branch -D test'.Gitæç¤ºå¯ä»¥ç”¨å¤§å†™çš„åˆ é™¤é€‰é¡¹ -D å¼ºåˆ¶æ‰§è¡Œã€‚]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitåˆ†æ”¯çš„åˆ›å»ºä¸Žåˆå¹¶]]></title>
    <url>%2FGit%E5%88%86%E6%94%AF%E7%9A%84%E5%88%9B%E5%BB%BA%E4%B8%8E%E5%90%88%E5%B9%B6.html</url>
    <content type="text"><![CDATA[å‡è®¾ç›®å‰æ­£åœ¨å¼€å‘å…¬å¸ç½‘ç«™ï¼Œå¹¶ä¸”ä½¿ç”¨Gitç®¡ç†é¡¹ç›®ä»£ç ï¼Œå¸¸è§çš„æµç¨‹å¤§ä½“å¦‚ä¸‹:1.å¼€å‘å…¬å¸ç½‘ç«™ã€‚2.ä¸ºäº†å¼€å‘æŸä¸ªæ–°åŠŸèƒ½æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ˆå‡å¦‚å«developï¼‰ï¼Œå¹¶åœ¨è¯¥åˆ†æ”¯ä¸Šè¿›è¡Œå¼€å‘ã€‚3.æŽ¥åˆ°æµ‹è¯•ç»„çš„Bugåé¦ˆï¼Œè¿”å›žä¸»åˆ†æ”¯ï¼Œæ–°å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯ï¼ˆbugFixï¼‰ï¼Œåœ¨è¯¥åˆ†æ”¯ä¸Šä¿®å¤Bugï¼Œç„¶åŽä¸Žä¸»åˆ†æ”¯masteråˆå¹¶ã€‚4.å°†åˆ†æ”¯åˆ‡æ¢å›ždevelopï¼Œç»§ç»­å¼€å‘æ–°åŠŸèƒ½ï¼Œç»“æŸåŽå’Œä¸»åˆ†æ”¯masteråˆå¹¶ã€‚åˆ†æ”¯çš„æ–°å»ºä¸Žåˆ‡æ¢å‡å¦‚å…¬å¸ç½‘ç«™é¡¹ç›®å·²ç»å¼€å‘äº†ä¸€æ®µæ—¶é—´ï¼Œå¹¶ä¸”ä½¿ç”¨Gitæäº¤äº†å‡ æ¬¡æ›´æ–°ï¼Œæäº¤åŽ†å²å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸ºäº†å¼€å‘æ–°åŠŸèƒ½ï¼Œæ–°å»ºåˆ†æ”¯developå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯ï¼š1234$ git branch develop$ git checkout developSwitched to branch 'develop'ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤git checkout -bç›´æŽ¥æ–°å»ºå¹¶åˆ‡æ¢ï¼š12$ git checkout -b developSwitched to a new branch 'develop'æ‰§è¡Œä¸Šè¿°å‘½ä»¤åŽï¼Œä»“åº“åŽ†å²å¤§è‡´å¦‚ä¸‹æ‰€ç¤ºï¼š Gitæ–°å»ºäº†ä¸€ä¸ªåˆ†æ”¯æŒ‡é’ˆdevelopï¼Œç„¶åŽå°†HEADæŒ‡å‘developã€‚æŽ¥ä¸‹æ¥åœ¨è¯¥åˆ†æ”¯ä¸Šå¼€å¿ƒçš„å¼€å‘æ–°åŠŸèƒ½ï¼Œæ¯”å¦‚æ–°å»ºäº†å…¬å¸ç½‘ç«™Abouté¡µé¢ï¼Œæ·»åŠ äº†å†…å®¹ç„¶åŽæäº¤äº†æ­¤æ¬¡ä¿®æ”¹ï¼š12345678$ vim About.html$ git add About.html$ git commit -a -m "add About.html page"[develop b462691] add About.html page 1 file changed, 12 insertions(+) create mode 100644 About.htmlæ­¤æ—¶ï¼Œä»“åº“åŽ†å²å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™æ—¶å€™æŽ¥åˆ°æµ‹è¯•ç»„å…¬å¸ç½‘ç«™ä¸»é¡µindex.htmlçš„Bugåé¦ˆï¼ŒäºŽæ˜¯å°†åˆ†æ”¯åˆ‡æ¢å›žä¸»åˆ†æ”¯masterï¼Œç„¶åŽæ–°å»ºåˆ†æ”¯bugFixï¼Œä¿®å¤Bugï¼Œå¹¶æäº¤è¯¥ä¿®å¤ï¼š1234567891011$ git checkout masterSwitched to branch 'master'$ git checkout -b "bugFix"Switched to a new branch 'bugFix'$ vim index.html$ git commit -a -m "update index.html page"[bugFix 11a3074] update index.html page 1 file changed, 2 insertions(+), 2 deletions(-)æ­¤æ—¶ï¼Œä»“åº“åŽ†å²å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å‡å¦‚ç¡®å®šBugä¿®å¤åŽï¼Œå¯ä»¥åˆ‡æ¢å›žmasteråˆ†æ”¯ï¼Œç„¶åŽå°†bugFixå’Œmasteråˆ†æ”¯åˆå¹¶ï¼š12345$ git merge bugFixUpdating e7ad858..11a3074Fast-forward index.html | 4 ++-- 1 file changed, 2 insertions(+), 2 deletions(-)åˆå¹¶æ—¶å‡ºçŽ°äº†â€œFast forwardâ€çš„æç¤ºã€‚å¦‚æžœé¡ºç€ä¸€ä¸ªåˆ†æ”¯èµ°ä¸‹åŽ»å¯ä»¥åˆ°è¾¾å¦ä¸€ä¸ªåˆ†æ”¯çš„è¯ï¼Œé‚£ä¹ˆGitåœ¨åˆå¹¶ä¸¤è€…æ—¶ï¼Œåªä¼šç®€å•åœ°æŠŠæŒ‡é’ˆå³ç§»ï¼Œå› ä¸ºè¿™ç§å•çº¿çš„åŽ†å²åˆ†æ”¯ä¸å­˜åœ¨ä»»ä½•éœ€è¦è§£å†³çš„åˆ†æ­§ï¼Œæ‰€ä»¥è¿™ç§åˆå¹¶è¿‡ç¨‹å¯ä»¥ç§°ä¸ºå¿«è¿›ï¼ˆFast forwardï¼‰ã€‚æ­¤æ—¶bugFixåˆ†æ”¯å·²ç»å®Œæˆäº†åŽ†å²ä½¿å‘½ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤git branch -då°†å…¶åˆ é™¤ï¼š12$ git branch -d bugFixDeleted branch bugFix (was 11a3074).åˆå¹¶masterä¸ŽbugFixï¼Œå¹¶åˆ é™¤bugFixåˆ†æ”¯åŽï¼Œä»“åº“åŽ†å²å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Bugä¿®å¤åŽï¼Œåˆ‡æ¢å›ždevelopåˆ†æ”¯ç»§ç»­å¼€å‘æ–°çš„åŠŸèƒ½ï¼Œå¹¶ä¸”æäº¤ï¼š12345678$ git checkout developSwitched to branch &apos;develop&apos;$ vim About.html$ git commit -a -m &quot;add copyright&quot;[develop df8d879] add copyright 1 file changed, 1 insertion(+)æ­¤æ—¶ï¼Œä»“åº“åŽ†å²å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åˆ†æ”¯åˆå¹¶å’Œåˆå¹¶masteråˆ†æ”¯ä¸ŽbugFixåˆ†æ”¯é‚£æ ·ï¼Œåˆå¹¶masterä¸Ždevelopåˆ†æ”¯è¿‡ç¨‹ä¹Ÿå·®ä¸å¤šï¼š1234567$ git checkout masterSwitched to branch 'master'$ git merge developMerge made by the 'recursive' strategy. About.html | 2 +- 1 file changed, 1 insertion(+), 1 deletion(-)ç”±äºŽmasteræŒ‡å‘çš„C4å¹¶ä¸æ˜¯developæŒ‡å‘C5çš„ç›´æŽ¥ç¥–å…ˆC2ï¼Œæ‰€ä»¥åˆå¹¶æ–¹å¼ä¸æ˜¯â€œFast forwardâ€ï¼ŒGit ä¼šç”¨ä¸¤ä¸ªåˆ†æ”¯çš„æœ«ç«¯ï¼ˆC4 å’Œ C5ï¼‰ä»¥åŠå®ƒä»¬çš„å…±åŒç¥–å…ˆï¼ˆC2ï¼‰è¿›è¡Œä¸€æ¬¡ç®€å•çš„ä¸‰æ–¹åˆå¹¶è®¡ç®—ã€‚åˆå¹¶masterå’ŒdevelopåŽï¼Œä»“åº“åŽ†å²å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è§£å†³åˆå¹¶å†²çªå‡å¦‚åœ¨ä¸åŒåˆ†æ”¯ä¸­éƒ½å¯¹åŒä¸€ä¸ªæ–‡ä»¶è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆåˆå¹¶çš„æ—¶å€™å°±ä¼šå‘ç”Ÿå†²çªã€‚æ¯”å¦‚åœ¨masteråˆ†æ”¯å’Œdevelopåˆ†æ”¯ä¸Šéƒ½ä¿®æ”¹äº†About.htmlé¡µé¢ï¼Œç„¶åŽè¿›è¡Œåˆ†æ”¯åˆå¹¶ï¼š1234$ git merge developAuto-merging About.htmlCONFLICT (content): Merge conflict in About.htmlAutomatic merge failed; fix conflicts and then commit the result.Gitä½œäº†åˆå¹¶ï¼Œä½†æ²¡æœ‰æäº¤ï¼Œå®ƒä¼šåœä¸‹æ¥ç­‰ä½ è§£å†³å†²çªã€‚å¯æ˜¯ä½¿ç”¨å‘½ä»¤git statusæŸ¥çœ‹å“ªäº›æ–‡ä»¶å­˜åœ¨å†²çªï¼š123456789101112$ git statusOn branch masterYou have unmerged paths. (fix conflicts and run "git commit") (use "git merge --abort" to abort the merge)Unmerged paths: (use "git add &lt;file&gt;..." to mark resolution) both modified: About.htmlno changes added to commit (use "git add" and/or "git commit -a")ä»»ä½•åŒ…å«æœªè§£å†³å†²çªçš„æ–‡ä»¶éƒ½ä¼šä»¥æœªåˆå¹¶ï¼ˆunmergedï¼‰çš„çŠ¶æ€åˆ—å‡ºã€‚ç¼–è¾‘About.htmlé¡µé¢ï¼Œå¯çœ‹åˆ°æ–‡ä»¶åŒ…å«ç±»ä¼¼ä¸‹é¢éƒ¨åˆ†çš„å†…å®¹ï¼š123456&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD &lt;footer&gt;2016~2017 All Rights Reserved&lt;/footer&gt;======= &lt;footer&gt;&amp;copy;2016~2017&lt;/footer&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; developå¯ä»¥çœ‹åˆ° ======= éš”å¼€çš„ä¸ŠåŠéƒ¨åˆ†ï¼Œæ˜¯HEADï¼ˆå³ master åˆ†æ”¯ï¼Œåœ¨è¿è¡Œmergeå‘½ä»¤æ—¶æ‰€åˆ‡æ¢åˆ°çš„åˆ†æ”¯ï¼‰ä¸­çš„å†…å®¹ï¼Œä¸‹åŠéƒ¨åˆ†æ˜¯åœ¨developåˆ†æ”¯ä¸­çš„å†…å®¹ã€‚è§£å†³å†²çªçš„åŠžæ³•æ— éžæ˜¯äºŒè€…é€‰å…¶ä¸€æˆ–è€…ç”±ä½ äº²è‡ªæ•´åˆåˆ°ä¸€èµ·ã€‚1&lt;footer&gt;&amp;copy; 2016~2017 All Rights Reserved&lt;/footer&gt;ã€Špro gitã€‹å­¦ä¹ ç¬”è®°]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitæ’¤é”€æ“ä½œ]]></title>
    <url>%2FGit%E6%92%A4%E9%94%80%E6%93%8D%E4%BD%9C.html</url>
    <content type="text"><![CDATA[ä¿®æ”¹æœ€åŽä¸€æ¬¡æäº¤å¦‚æžœæäº¤åŽå‘çŽ°æƒ³è¦ä¿®æ”¹æäº¤ä¿¡æ¯ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ git commit --amend å‘½ä»¤ï¼Œä½¿ç”¨è¯¥å‘½ä»¤åŽï¼ŒGitä¼šå¯åŠ¨æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œç„¶åŽå¯çœ‹åˆ°ä¸Šæ¬¡æäº¤æ—¶çš„è¯´æ˜Žï¼Œç¼–è¾‘å®ƒç¡®è®¤æ²¡é—®é¢˜åŽä¿å­˜é€€å‡ºï¼Œå°±ä¼šä½¿ç”¨æ–°çš„æäº¤è¯´æ˜Žè¦†ç›–åˆšæ‰çš„æäº¤ä¿¡æ¯ï¼š1$ git commit --amendå¦‚æžœåˆšæ‰æäº¤æ—¶å¿˜äº†æš‚å­˜æŸäº›ä¿®æ”¹ï¼Œå¯ä»¥å…ˆè¡¥ä¸Šæš‚å­˜æ“ä½œï¼Œç„¶åŽå†è¿è¡Œ --amend æäº¤ï¼š12$ git add forgotten_file$ git commit --amendå–æ¶ˆå·²ç»æš‚å­˜çš„æ–‡ä»¶123456789$ git statusOn branch masterYour branch is ahead of 'origin/master' by 8 commits. (use "git push" to publish your local commits)Changes to be committed: (use "git reset HEAD &lt;file&gt;..." to unstage) modified: README.config modified: README.mdä½¿ç”¨å‘½ä»¤ git reset HEAD README.config å°†README.configç§»å‡ºæš‚å­˜åŒºï¼š123456789101112131415161718$ git reset HEAD README.configUnstaged changes after reset:M README.config$ git statusOn branch masterYour branch is ahead of 'origin/master' by 8 commits. (use "git push" to publish your local commits)Changes to be committed: (use "git reset HEAD &lt;file&gt;..." to unstage) modified: README.mdChanges not staged for commit: (use "git add &lt;file&gt;..." to update what will be committed) (use "git checkout -- &lt;file&gt;..." to discard changes in working directory) modified: README.configå¯çœ‹åˆ°ï¼ŒREADME.configå·²ç»ä¸ºChanges not staged for commitçŠ¶æ€ã€‚å–æ¶ˆå¯¹æ–‡ä»¶çš„ä¿®æ”¹å°†README.configç§»å‡ºæš‚å­˜åŒºåŽï¼Œå¯ä»¥è¿›ä¸€æ­¥ä½¿ç”¨å‘½ä»¤ git checkout -- README.config å–æ¶ˆå¯¹README.configçš„ä¿®æ”¹ã€‚123456789101112131415$ cat README.confighello$ git checkout -- README.config$ git statusOn branch masterYour branch is ahead of 'origin/master' by 8 commits. (use "git push" to publish your local commits)Changes to be committed: (use "git reset HEAD &lt;file&gt;..." to unstage) modified: README.md$ cat README.configã€Špro gitã€‹å­¦ä¹ ç¬”è®°]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitè¿œç¨‹ä»“åº“]]></title>
    <url>%2FGit%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93.html</url>
    <content type="text"><![CDATA[è¿œç¨‹ä»“åº“æ˜¯æŒ‡æ‰˜ç®¡åœ¨ç½‘ç»œä¸Šçš„é¡¹ç›®ä»“åº“ï¼Œå¯èƒ½ä¼šæœ‰å¥½å¤šä¸ªï¼Œå…¶ä¸­æœ‰äº›ä½ åªèƒ½è¯»ï¼Œå¦å¤–æœ‰äº›å¯ä»¥å†™ã€‚åŒä»–äººåä½œå¼€å‘æŸä¸ªé¡¹ç›®æ—¶ï¼Œéœ€è¦ç®¡ç†è¿™äº›è¿œç¨‹ä»“åº“ï¼Œä»¥ä¾¿æŽ¨é€æˆ–æ‹‰å–æ•°æ®ï¼Œåˆ†äº«å„è‡ªçš„å·¥ä½œè¿›å±•ã€‚ ç®¡ç†è¿œç¨‹ä»“åº“çš„å·¥ä½œï¼ŒåŒ…æ‹¬æ·»åŠ è¿œç¨‹åº“ï¼Œç§»é™¤åºŸå¼ƒçš„è¿œç¨‹åº“ï¼Œç®¡ç†å„å¼è¿œç¨‹åº“åˆ†æ”¯ï¼Œå®šä¹‰æ˜¯å¦è·Ÿè¸ªè¿™äº›åˆ†æ”¯ï¼Œç­‰ç­‰ã€‚æŸ¥çœ‹å½“å‰çš„è¿œç¨‹åº“ä½¿ç”¨ git remote å‘½ä»¤ï¼Œå®ƒä¼šåˆ—å‡ºæ¯ä¸ªè¿œç¨‹åº“çš„ç®€çŸ­åå­—ã€‚åœ¨å…‹éš†å®ŒæŸä¸ªé¡¹ç›®åŽï¼Œè‡³å°‘å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåä¸º origin çš„è¿œç¨‹åº“ï¼ŒGit é»˜è®¤ä½¿ç”¨è¿™ä¸ªåå­—æ¥æ ‡è¯†ä½ æ‰€å…‹éš†çš„åŽŸå§‹ä»“åº“ï¼š1234567891011$ git clone git://github.com/schacon/ticgit.gitCloning into 'ticgit'...remote: Counting objects: 1857, done.remote: Total 1857 (delta 0), reused 0 (delta 0), pack-reused 1857Receiving objects: 100% (1857/1857), 331.41 KiB | 89.00 KiB/s, done.Resolving deltas: 100% (837/837), done.$ cd ticgit$ git remoteoriginä½¿ç”¨ git remote -v å‘½ä»¤å¯ä»¥æ˜¾ç¤ºå‡ºè¿œç¨‹ä»“åº“çš„åœ°å€ï¼š123$ git remote -vorigin git://github.com/schacon/ticgit.git (fetch)origin git://github.com/schacon/ticgit.git (push)æ·»åŠ è¿œç¨‹ä»“åº“è¦æ·»åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªç®€å•çš„åå­—ï¼Œä»¥ä¾¿å°†æ¥å¼•ç”¨ï¼Œè¿è¡Œ git remote add [shortname] [url]ï¼š12345$ git remote add paul git://github.com/paulboone/ticgit.git$ git remoteoriginpaulä»Žè¿œç¨‹ä»“åº“æŠ“å–æ•°æ®1.æŠ“å–å¹¶ä½†ä¸åˆå¹¶åˆ†æ”¯ï¼Œä½¿ç”¨å‘½ä»¤ git fetch [remote-name] [branch-name]ã€‚1234567$ git fetch paul masterremote: Counting objects: 19, done.remote: Total 19 (delta 11), reused 11 (delta 11), pack-reused 8Unpacking objects: 100% (19/19), done.From git://github.com/paulboone/ticgit * branch master -&gt; FETCH_HEAD * [new branch] master -&gt; paul/master2.æŠ“å–å¹¶ä¸”è‡ªåŠ¨åˆå¹¶åˆ†æ”¯ï¼Œä½¿ç”¨å‘½ä»¤ git pull [remote-name] [branch-name]ã€‚1234$ git pull origin masterFrom git://github.com/schacon/ticgit * branch master -&gt; FETCH_HEADAlready up-to-date.æŽ¨é€æ•°æ®åˆ°è¿œç¨‹ä»“åº“ä½¿ç”¨å‘½ä»¤ git push [remote-name] [branch-name] æŠŠæœ¬åœ°çš„ master åˆ†æ”¯æŽ¨é€åˆ° origin æœåŠ¡å™¨ä¸Š :1$ git push origin masterç¬¦åˆä¸‹é¢ä¸¤ç§æƒ…å†µæ‰èƒ½æˆåŠŸæŽ¨é€ï¼šæ‹¥æœ‰è¿œç¨‹ä»“åº“å†™çš„æƒé™ã€‚åœ¨ç¬¦åˆ1çš„æƒ…å†µä¸‹ï¼Œå¦‚æžœå…¶ä»–äººå·²ç»å‘è¿œç¨‹ä»“åº“æŽ¨é€äº†æ›´æ–°ï¼Œå¿…é¡»å…ˆæ›´æ–°æŠ“å–åˆ°æœ¬åœ°ï¼Œåˆå¹¶åˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ï¼Œç„¶åŽæ‰å¯ä»¥å†æ¬¡æŽ¨é€ã€‚æŸ¥çœ‹è¿œç¨‹ä»“åº“ä¿¡æ¯123456789101112$ git remote show origin* remote origin Fetch URL: git://github.com/schacon/ticgit.git Push URL: git://github.com/schacon/ticgit.git HEAD branch: master Remote branches: master tracked ticgit tracked Local branch configured for 'git pull': master merges with remote master Local ref configured for 'git push': master pushes to master (up to date)è¿œç¨‹ä»“åº“çš„åˆ é™¤å’Œé‡å‘½åä½¿ç”¨ git remote rename å‘½ä»¤ä¿®æ”¹æŸä¸ªè¿œç¨‹ä»“åº“åœ¨æœ¬åœ°çš„ç®€ç§°ï¼Œæ¯”å¦‚æƒ³æŠŠ paul æ”¹æˆ paulbooneï¼š12345$ git remote rename paul paulboone$ git remoteoriginpaulbooneå¯¹è¿œç¨‹ä»“åº“çš„é‡å‘½åï¼Œä¹Ÿä¼šä½¿å¯¹åº”çš„åˆ†æ”¯åç§°å‘ç”Ÿå˜åŒ–ï¼ŒåŽŸæ¥çš„ paul/master åˆ†æ”¯çŽ°åœ¨æˆäº† paulboone/masterä½¿ç”¨å‘½ä»¤ git remote rm åˆ é™¤åœ¨æœ¬åœ°çš„è¿œç¨‹ä»“åº“åœ°å€ï¼š1234$ git remote rm paulboone$ git remoteoriginã€ŠPro Gitã€‹å­¦ä¹ ç¬”è®°]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitç‰ˆæœ¬å›žé€€]]></title>
    <url>%2FGit%E7%89%88%E6%9C%AC%E5%9B%9E%E9%80%80.html</url>
    <content type="text"><![CDATA[Gitä¸­ï¼Œæ¯æ¬¡commitæäº¤éƒ½ä¼šç”Ÿæˆä¸€ä¸ªåŽ†å²çºªå½•ã€‚ä½¿ç”¨ git log æŸ¥çœ‹commitåŽ†å²ï¼š12345678910$ git log --oneline ec88247 modifyed bar.html,foo.txt add new.txt47384c8 modify bar.html in clone again31e1f6f modify foo.txt in original again8747b24 Merge branch 'master' of /home/mrbird/projects/first-project27b76ec modify foo.txt in original796e40d modify bar.html in clone8e1b132 modify foo.txt,add 'hello msg'94418b1 add bar.html,modify foo.txt,delete bar.txtc2e4810 add foo.txt bar.txtæ¯ä¸ªè®°å½•éƒ½æœ‰ä¸€ä¸ªä¸Žä¹‹å¯¹åº”çš„commit idï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨å‘½ä»¤git reset --hard commit_idæ¥å›žé€€åˆ°ç›¸åº”çš„ç‰ˆæœ¬ã€‚é™¤æ­¤ä¹‹å¡ï¼Œåœ¨Gitä¸­ï¼Œä½¿ç”¨HEADæ¥ä»£è¡¨å½“å‰ç‰ˆæœ¬ï¼Œå¦‚éœ€å›žé€€åˆ°å‰ä¸€ä¸ªç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤git reset --hard HEAD^ï¼Œå‰ä¸¤ä¸ªç‰ˆæœ¬åˆ™ç”¨HEAD~2è¡¨ç¤ºï¼Œä»¥æ­¤ç±»æŽ¨ã€‚å½“å‰ç‰ˆæœ¬idä¸ºec88247â€¦æ¯”å¦‚ï¼ŒçŽ°è¦å›žé€€åˆ°commit_idä¸º47384c8â€¦çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š12$ git reset --hard 47384c8HEAD is now at 47384c8again modify bar.html in cloneæˆ–ï¼š12$ git reset --hard HEAD^HEAD is now at 47384c8 modify bar.html in clone againå†æ¬¡æŸ¥çœ‹commitåŽ†å²ï¼š123456789$ git log --oneline 47384c8 modify bar.html in clone again31e1f6f modify foo.txt in original again8747b24 Merge branch 'master' of /home/mrbird/projects/first-project27b76ec modify foo.txt in original796e40d modify bar.html in clone8e1b132 modify foo.txt,add 'hello msg'94418b1 add bar.html,modify foo.txt,delete bar.txtc2e4810 add foo.txt bar.txtå¯å‘çŽ°ï¼Œcommit_idä¸ºec88247â€¦çš„è®°å½•å·²ç»ä¸è§äº†ï¼Œå¦‚æžœè¦å›žé€€åˆ°è¿™ä¸ªç‰ˆæœ¬ï¼Œåˆå¿˜è®°äº†ä¸Žä¹‹å¯¹åº”çš„commit_idè¯¥æ€Žä¹ˆåŠžå‘¢ã€‚è¿™æ—¶å€™å¯ä»¥ä½¿ç”¨git reflogå‘½ä»¤æ¥æŸ¥çœ‹æ“ä½œåŽ†å²ï¼š1234$ git reflog47384c8 HEAD@&#123;0&#125;: reset: moving to 47384c8ec88247 HEAD@&#123;1&#125;: reset: moving to ec88247...å¯çœ‹åˆ°ï¼Œå›žé€€åˆ°commit_idä¸º47384c8â€¦çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„commit_idä¸ºec88247â€¦ï¼Œæ‰€ä»¥ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å³å¯å›žåˆ°ä¸€å¼€å§‹å›žé€€å‰çš„ç‰ˆæœ¬ï¼š12$ git reset --hard ec88247HEAD is now at ec88247 modifyed bar.html,foo.txt add new.txt]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GitçŠ¶æ€è·Ÿè¸ª]]></title>
    <url>%2FGit%E7%8A%B6%E6%80%81%E8%B7%9F%E8%B8%AA.html</url>
    <content type="text"><![CDATA[å¯¹äºŽä»»ä½•ä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨ Git å†…éƒ½åªæœ‰ä¸‰ç§çŠ¶æ€ï¼šå·²æäº¤ï¼ˆcommittedï¼‰ï¼Œå·²ä¿®æ”¹ï¼ˆmodifiedï¼‰å’Œå·²æš‚å­˜ï¼ˆstagedï¼‰ã€‚1.å·²æäº¤ï¼šè¡¨ç¤ºè¯¥æ–‡ä»¶å·²ç»è¢«å®‰å…¨åœ°ä¿å­˜åœ¨ç‰ˆæœ¬åº“ä¸­äº†ã€‚2.å·²ä¿®æ”¹ï¼šè¡¨ç¤ºä¿®æ”¹äº†æŸä¸ªæ–‡ä»¶ï¼Œä½†è¿˜æ²¡æœ‰æäº¤åˆ°æš‚å­˜åŒºã€‚3.å·²æš‚å­˜ï¼šè¡¨ç¤ºæŠŠå·²ä¿®æ”¹çš„æ–‡ä»¶å·²ç»æ”¾åˆ°æš‚å­˜åŒºäº†ï¼Œä¸‹æ¬¡æäº¤æ—¶ä¸€å¹¶è¢«ä¿å­˜åˆ°ç‰ˆæœ¬åº“ä¸­ã€‚æ£€æŸ¥å½“å‰æ–‡ä»¶çŠ¶æ€è¦ç¡®å®šå“ªäº›æ–‡ä»¶å½“å‰å¤„äºŽä»€ä¹ˆçŠ¶æ€ï¼Œå¯ä»¥ç”¨ git status å‘½ä»¤ã€‚1234$ git statusOn branch masterYour branch is up-to-date with 'origin/master'.nothing to commit, working tree cleanè¯´æ˜ŽçŽ°åœ¨çš„å·¥ä½œç›®å½•ç›¸å½“å¹²å‡€ï¼Œå¹¶ä¸”å½“å‰æ‰€åœ¨åˆ†æ”¯ä¸ºmasterã€‚åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªREADMEæ–‡ä»¶ï¼Œç„¶åŽè¿è¡Œ git status ä¼šçœ‹åˆ°è¯¥æ–‡ä»¶å‡ºçŽ°åœ¨æœªè·Ÿè¸ªæ–‡ä»¶åˆ—è¡¨ä¸­ï¼š123456789$ git statusOn branch masterYour branch is up-to-date with 'origin/master'.Untracked files: (use "git add &lt;file&gt;..." to include in what will be committed) READMEnothing added to commit but untracked files present (use "git add" to track)æœªè·Ÿè¸ªçš„æ–‡ä»¶æ„å‘³ç€Gitåœ¨ä¹‹å‰çš„å¿«ç…§ï¼ˆæäº¤ï¼‰ä¸­æ²¡æœ‰è¿™äº›æ–‡ä»¶ã€‚è·Ÿè¸ªæ–°æ–‡ä»¶ä½¿ç”¨å‘½ä»¤ git add å¼€å§‹è·Ÿè¸ªæ–‡ä»¶READMEï¼š1$ git add READMEå†è¿è¡Œ git status å‘½ä»¤ï¼Œä¼šçœ‹åˆ° README æ–‡ä»¶å·²è¢«è·Ÿè¸ªï¼Œå¹¶å¤„äºŽæš‚å­˜çŠ¶æ€ï¼š1234567$ git statusOn branch masterYour branch is up-to-date with 'origin/master'.Changes to be committed: (use "git reset HEAD &lt;file&gt;..." to unstage) new file: READMEåªè¦åœ¨ â€œChanges to be committedâ€ è¿™è¡Œä¸‹é¢çš„ï¼Œå°±è¯´æ˜Žæ˜¯å·²æš‚å­˜çŠ¶æ€ã€‚git add åŽé¢å¯ä»¥æŒ‡æ˜Žè¦è·Ÿè¸ªçš„æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„ã€‚å¦‚æžœæ˜¯ç›®å½•çš„è¯ï¼Œå°±è¯´æ˜Žè¦é€’å½’è·Ÿè¸ªè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚æš‚å­˜å·²ä¿®æ”¹æ–‡ä»¶ä¿®æ”¹å·²è·Ÿè¸ªè¿‡çš„æ–‡ä»¶ READMEï¼Œç„¶åŽå†æ¬¡è¿è¡Œ git status å‘½ä»¤ï¼š12345678910111213$ git statusOn branch masterYour branch is up-to-date with 'origin/master'.Changes to be committed: (use "git reset HEAD &lt;file&gt;..." to unstage) new file: READMEChanges not staged for commit: (use "git add &lt;file&gt;..." to update what will be committed) (use "git checkout -- &lt;file&gt;..." to discard changes in working directory) modified: READMEREADMEæ–‡ä»¶å‡ºçŽ°äº†ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯æœªæš‚å­˜ï¼Œä¸€æ¬¡æ˜¯ä¸€æš‚å­˜ã€‚å¦‚æžœçŽ°åœ¨æäº¤çš„è¯ï¼Œé‚£ä¹ˆæäº¤çš„å°†æ˜¯å·²æš‚å­˜çš„READMEï¼Œå¯¹READMEçš„ä¿®æ”¹å¹¶ä¸ä¼šè¢«æäº¤ã€‚é‡æ–°è¿è¡Œ git add æŠŠæœ€æ–°ç‰ˆæœ¬READMEé‡æ–°æš‚å­˜èµ·æ¥ï¼š12345678$ git add README$ git statusOn branch masterYour branch is up-to-date with 'origin/master'.Changes to be committed: (use "git reset HEAD &lt;file&gt;..." to unstage) new file: READMEå¿½ç•¥æŸäº›æ–‡ä»¶å¦‚æ—¥å¿—æ–‡ä»¶ï¼Œç¼–è¯‘ç¼“å­˜æ–‡ä»¶ç­‰æ²¡å¿…è¦çº³å…¥Gitç®¡ç†çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª.gitignoreæ–‡ä»¶æ¥å°†è¿™äº›æ–‡ä»¶æŽ’é™¤åœ¨å¤–ã€‚æ¯”å¦‚ï¼š123$ cat .gitignore*.[oa]*~ç¬¬ä¸€è¡Œå‘Šè¯‰ Git å¿½ç•¥æ‰€æœ‰ä»¥ .o æˆ– .a ç»“å°¾çš„æ–‡ä»¶ã€‚ç¬¬äºŒè¡Œå‘Šè¯‰ Git å¿½ç•¥æ‰€æœ‰ä»¥æ³¢æµªç¬¦ï¼ˆ~ï¼‰ç»“å°¾çš„æ–‡ä»¶ã€‚æ–‡ä»¶ .gitignore çš„æ ¼å¼è§„èŒƒå¦‚ä¸‹ï¼šæ‰€æœ‰ç©ºè¡Œæˆ–è€…ä»¥æ³¨é‡Šç¬¦å· ï¼ƒ å¼€å¤´çš„è¡Œéƒ½ä¼šè¢« Git å¿½ç•¥ã€‚å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ glob æ¨¡å¼åŒ¹é…ï¼ˆglobæŒ‡shellç®€åŒ–åŽçš„æ­£åˆ™è¡¨è¾¾å¼ï¼‰ã€‚åŒ¹é…æ¨¡å¼æœ€åŽè·Ÿåæ–œæ ï¼ˆ/ï¼‰è¯´æ˜Žè¦å¿½ç•¥çš„æ˜¯ç›®å½•ã€‚è¦å¿½ç•¥æŒ‡å®šæ¨¡å¼ä»¥å¤–çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¯ä»¥åœ¨æ¨¡å¼å‰åŠ ä¸ŠæƒŠå¹å·ï¼ˆ!ï¼‰å–åã€‚çœ‹ä¸€ä¸ª .gitignore æ–‡ä»¶çš„ä¾‹å­ï¼š12345678910111213# æ­¤ä¸ºæ³¨é‡Š â€“ å°†è¢« Git å¿½ç•¥# å¿½ç•¥æ‰€æœ‰ .a ç»“å°¾çš„æ–‡ä»¶*.a# ä½† lib.a é™¤å¤–!lib.a# ä»…ä»…å¿½ç•¥é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ TODO æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬ subdir/TODO/TODO# å¿½ç•¥ build/ ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶build/# ä¼šå¿½ç•¥ doc/notes.txt ä½†ä¸åŒ…æ‹¬ doc/server/arch.txtdoc/*.txt# ignore all .txt files in the doc/ directorydoc/**/*.txtæŸ¥çœ‹å·²æš‚å­˜å’Œæœªæš‚å­˜çš„æ›´æ–°å†æ¬¡ä¿®æ”¹READMEæ–‡ä»¶ï¼Œä½†ä¸æ·»åŠ åˆ°æš‚å­˜åŒºã€‚çŽ°åœ¨READMEå·²ç»ä¿®æ”¹äº†ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ·»åŠ å†…å®¹â€œhello gitâ€å¹¶ä¸”ä½¿ç”¨ git add æ·»åŠ åˆ°äº†æš‚å­˜åŒºã€‚ç¬¬äºŒæ¬¡æ·»åŠ å†…å®¹â€œhello worldâ€ï¼Œä½†å¹¶æœªæ·»åŠ åˆ°æš‚å­˜åŒºã€‚è‹¥è¦çœ‹å·²ç»æš‚å­˜èµ·æ¥çš„æ–‡ä»¶å’Œä¸Šæ¬¡æäº¤æ—¶çš„å¿«ç…§ä¹‹é—´çš„å·®å¼‚ï¼Œå¯ä»¥ç”¨ git diff --stagedå‘½ä»¤ï¼š12345678$ git diff --stageddiff --git a/README b/READMEnew file mode 100644index 0000000..8d0e412--- /dev/null+++ b/README@@ -0,0 +1 @@+hello gitç›´æŽ¥ä½¿ç”¨ git diff å‘½ä»¤æŸ¥çœ‹å·²æš‚å­˜å’Œæœªæš‚å­˜æ–‡ä»¶ä¹‹é—´çš„å·®å¼‚ï¼š12345678$ git diffdiff --git a/README b/READMEindex 8d0e412..05fe86c 100644--- a/README+++ b/README@@ -1 +1,2 @@ hello git+hello worldå¯çœ‹åˆ°ï¼Œå¯¹äºŽREADMEæ–‡ä»¶æ¥è¯´ï¼Œæœªæš‚å­˜å’Œå·²æš‚å­˜æ–‡ä»¶ç›¸æ¯”ï¼Œæ·»åŠ äº†ä¸€è¡Œâ€œhello worldâ€ã€‚æäº¤æ›´æ–°ä½¿ç”¨ git commit -m å‘½ä»¤æ¥æäº¤æ›´æ–°ï¼š1234$ git commit -m 'åˆ›å»ºREADMEæ–‡ä»¶ï¼Œå†…å®¹ä¸ºhello git'[master 1f9882d] åˆ›å»ºREADMEæ–‡ä»¶ï¼Œå†…å®¹ä¸ºhello git 1 file changed, 1 insertion(+) create mode 100644 READMEè·³è¿‡æš‚å­˜åŒºå‡å¦‚ä½ è§‰å¾— git add è¿‡ç¨‹ç¹çï¼Œå¯ä»¥ä½¿ç”¨ git commit -a å‘½ä»¤æ¥è·³è¿‡æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒºçš„æ­¥éª¤ï¼Œç›´æŽ¥æäº¤ã€‚æ¯”å¦‚ï¼Œå¯¹äºŽREADMEçš„ç¬¬äºŒæ¬¡ä¿®æ”¹ï¼Œæˆ‘ä»¬è¿˜æœªå°†å…¶æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡ä½¿ç”¨ git commit å‘½ä»¤åªæ˜¯æäº¤äº†å¯¹READMEæ–‡ä»¶çš„ç¬¬ä¸€æ¬¡ä¿®æ”¹ï¼š1234567891011$ git statusOn branch masterYour branch is ahead of 'origin/master' by 1 commit. (use "git push" to publish your local commits)Changes not staged for commit: (use "git add &lt;file&gt;..." to update what will be committed) (use "git checkout -- &lt;file&gt;..." to discard changes in working directory) modified: READMEno changes added to commit (use "git add" and/or "git commit -a")ä½¿ç”¨ git commit -a å‘½ä»¤ç›´æŽ¥å°†READMEæ–‡ä»¶çš„ç¬¬äºŒæ¬¡ä¿®æ”¹æäº¤åˆ°ç‰ˆæœ¬åº“ï¼š123$ git commit -a -m "æ·»åŠ hello world"[master db06721] æ·»åŠ hello world 1 file changed, 1 insertion(+)ç§»é™¤æ–‡ä»¶ç§»é™¤æ–‡ä»¶åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼šä»Žç‰ˆæœ¬åº“å’Œæœ¬åœ°å·¥ä½œç›®å½•ä¸­ç§»é™¤ï¼›ä»…ä»Žç‰ˆæœ¬åº“ç§»é™¤ã€‚1.ä»Žç‰ˆæœ¬åº“å’Œæœ¬åœ°å·¥ä½œç›®å½•ä¸­ç§»é™¤ã€‚ä½¿ç”¨ git rm å‘½ä»¤æ¥ç§»é™¤README:123456$ git rm READMErm 'README'$ git commit -m 'åˆ é™¤README'[master 99a0462] åˆ é™¤README 1 file changed, 3 deletions(-) delete mode 100644 READMEåˆ°æœ¬åœ°å·¥ä½œç›®å½•ä¸‹æŸ¥çœ‹ï¼Œä¼šå‘çŽ°READMEæ–‡ä»¶å·²ç»ä¸å­˜åœ¨äº†ã€‚è¿™é‡Œæœ‰ç§æƒ…å†µï¼Œå‡å¦‚READMEæ–‡ä»¶è¿˜åœ¨æš‚å­˜åŒºå¹¶æœªæäº¤ï¼Œä½¿ç”¨ git rm å‘½ä»¤å°†ä¼šå‡ºé”™ï¼š1234$ git rm READMEerror: the following file has changes staged in the index: README(use --cached to keep the file, or -f to force removal)Gitæç¤ºæˆ‘ä»¬ä½¿ç”¨ git rm -f å‘½ä»¤æ¥åˆ é™¤ã€‚12$ git rm -f temp.logrm 'temp.log'2.ä»…ä»Žç‰ˆæœ¬åº“ç§»é™¤ã€‚æ¯”å¦‚çŽ°åœ¨ä¸å°å¿ƒå°†temp.logæ–‡ä»¶æ·»åŠ å¹¶æäº¤åˆ°ç‰ˆæœ¬åº“ä¸­äº†ï¼š12345$ git add temp.log$ git commit -m "add temp.log"[master fa31ea5] add temp.log 1 file changed, 0 insertions(+), 0 deletions(-) create mode 100644 temp.logçŽ°åœ¨æƒ³å°†å…¶ä»Žç‰ˆæœ¬åº“ä¸­åˆ é™¤ï¼Œä½†å¹¶ä¸åˆ é™¤æœ¬åœ°æ–‡ä»¶ï¼Œè€Œæ˜¯éšåŽå°†å…¶æ·»åŠ åˆ°.gitignoreæ–‡ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤git rm --cachedï¼š1234567$ git rm --cached temp.logrm 'temp.log'$ git commit -m "delete temp.log"[master e512a82] delete temp.log 1 file changed, 0 insertions(+), 0 deletions(-) delete mode 100644 temp.logç§»åŠ¨æ–‡ä»¶ï¼ˆé‡å‘½åï¼‰git mv å‘½ä»¤ç”¨æ¥é‡å‘½åæ–‡ä»¶ï¼Œæ¯”å¦‚å°†REAMEæ–‡ä»¶é‡å‘½åä¸ºREADME.configï¼š123456789$ git mv README README.config$ git statusOn branch masterYour branch is ahead of 'origin/master' by 7 commits. (use "git push" to publish your local commits)Changes to be committed: (use "git reset HEAD &lt;file&gt;..." to unstage) renamed: README -&gt; README.configå…¶è¿‡ç¨‹ç±»ä¼¼äºŽï¼š123$ mv README README.config$ git rm README$ git add README.configã€ŠPro Gitã€‹å­¦ä¹ ç¬”è®°]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çˆ¶å­é¡µé¢å…ƒç´ çš„èŽ·å–ä¸Žæ–¹æ³•çš„è°ƒç”¨[è½¬]]]></title>
    <url>%2F%E7%88%B6%E5%AD%90%E9%A1%B5%E9%9D%A2%E5%85%83%E7%B4%A0%E7%9A%84%E8%8E%B7%E5%8F%96%E4%B8%8E%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8.html</url>
    <content type="text"><![CDATA[javaScriptå­é¡µé¢è°ƒç”¨çˆ¶é¡µé¢æ–¹æ³•ï¼šæ ¼å¼ï¼šparent.çˆ¶é¡µé¢æ–¹æ³•å®žä¾‹ï¼šparent.pClick(); // pClick ä¸ºçˆ¶é¡µé¢ js æ–¹æ³•å­é¡µé¢èŽ·å–çˆ¶é¡µé¢å…ƒç´ ï¼šæ ¼å¼ï¼šwindow.parent.document.getElementById(â€œçˆ¶çª—å£å…ƒç´ IDâ€);å®žä¾‹ï¼šwindow.parent.document.getElementById(â€œpBtnOkâ€);// pBtnOkä¸ºçˆ¶é¡µé¢æ ‡ç­¾ idjQueryçˆ¶é¡µé¢èŽ·å–å­é¡µé¢å…ƒç´ ï¼šæ ¼å¼ï¼š$(â€œ#iframeçš„IDâ€).contents().find(â€œ#iframeä¸­çš„æŽ§ä»¶IDâ€).click();å®žä¾‹ï¼š$(â€œ#ifmâ€).contents().find(â€œ#iBtnOkâ€).click(); // ifm ä¸º &lt;iframe&gt; æ ‡ç­¾ id; iBtnOk ä¸ºå­é¡µé¢æŒ‰é’® idçˆ¶é¡µé¢è°ƒç”¨å­é¡µé¢æ–¹æ³•ï¼šæ ¼å¼ï¼š$(â€œ#iframeçš„IDâ€)[0].contentWindow.iframeæ–¹æ³•();å®žä¾‹ï¼š$(â€œ#ifmâ€)[0].contentWindow().iClick(); // ifm ä¸º &lt;iframe&gt; æ ‡ç­¾ id; iClickä¸ºå­é¡µé¢ js æ–¹æ³•å­é¡µé¢èŽ·å–çˆ¶é¡µé¢å…ƒç´ ï¼šæ ¼å¼ï¼š$(â€œ#çˆ¶é¡µé¢å…ƒç´ idâ€ , parent.document);å®žä¾‹ï¼š$(â€œ#pBtnOkâ€ , parent.document).click(); // pBtnOk ä¸ºçˆ¶é¡µé¢æ ‡ç­¾ idè½¬è‡ªhttp://www.cnblogs.com/it-xcn/p/5896231.html]]></content>
      <tags>
        <tag>JavaScript</tag>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS3é¢œè‰²å±žæ€§]]></title>
    <url>%2FCSS3%E9%A2%9C%E8%89%B2%E5%B1%9E%E6%80%A7.html</url>
    <content type="text"><![CDATA[opacityopacityç”¨æ¥è®¾ç½®å…ƒç´ çš„é€æ˜Žåº¦ã€‚å–å€¼èŒƒå›´ä¸º0~1ï¼Œ0è¡¨ç¤ºå®Œå…¨é€æ˜Žï¼Œ1è¡¨ç¤ºä¸é€æ˜Žã€‚RGBARGBAæ˜¯åœ¨RGBåŸºç¡€ä¸Šå¢žåŠ äº†æŽ§åˆ¶alphaé€æ˜Žåº¦çš„å‚æ•°ã€‚åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š1rgba(R,G,B,A)å‚æ•°è§£æž:ï¼ˆ1ï¼‰R(red)ï¼šçº¢è‰²å€¼ã€‚æ­£æ•´æ•° | ç™¾åˆ†æ•°ã€‚ï¼ˆ2ï¼‰G(green)ï¼šç»¿è‰²å€¼ã€‚æ­£æ•´æ•° | ç™¾åˆ†æ•°ã€‚ï¼ˆ3ï¼‰B(blue)ï¼šè“è‰²å€¼ã€‚æ­£æ•´æ•° | ç™¾åˆ†æ•°ã€‚ï¼ˆ4ï¼‰A(Alpha)ï¼šAlphaé€æ˜Žåº¦ï¼Œå–å€¼0~1ä¹‹é—´ã€‚Rã€Gã€Bä¸‰ä¸ªå‚æ•°çš„æ­£æ•´æ•°å–å€¼æ˜¯0-255ï¼Œç™¾åˆ†æ¯”å–å€¼æ˜¯0.0% - 100.0%ã€‚éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œå¹¶éžæ‰€æœ‰çš„æµè§ˆå™¨éƒ½æ”¯æŒç™¾åˆ†æ•°å‚æ•°å€¼ã€‚ç®€å•ç¤ºä¾‹å¦‚ä¸‹ï¼šSee the Pen rgba by wuyouzhuguli (@mrbird) on CodePen.HSL()HSLå°±æ˜¯è‰²è°ƒ(Hue)ã€é¥±å’Œåº¦(Saturation)å’Œäº®åº¦(Lightness)çš„ç¼©å†™ã€‚é€šè¿‡ä¸‰ä¸ªé¢œè‰²é€šé“çš„å åŠ å®žçŽ°è°ƒèŠ‚é¢œè‰²çš„åŠŸèƒ½ã€‚Hï¼š0(æˆ–360)è¡¨ç¤ºçº¢è‰²ï¼Œ120è¡¨ç¤ºç»¿è‰²ï¼Œ240è¡¨ç¤ºè“è‰²ï¼Œä¹Ÿå¯å–å…¶ä»–æ•°å€¼æ¥æŒ‡å®šé¢œè‰²ã€‚å–å€¼ä¸ºï¼š0 - 360ã€‚Sï¼šå–å€¼ä¸ºï¼š0.0% - 100.0%ï¼›0% æ„å‘³ç€ç°è‰²ï¼Œè€Œ 100% æ˜¯å…¨å½©ã€‚Lï¼šå–å€¼ä¸ºï¼š0.0% - 100.0%ï¼›0% æ˜¯é»‘è‰²ï¼Œ100% æ˜¯ç™½è‰²ã€‚HSLA()HSLA()åœ¨HSL()åŸºç¡€ä¸Šå¢žåŠ äº†ä¸€ä¸ªé€æ˜Žåº¦æ•ˆæžœã€‚currentColoræ­¤å±žæ€§ä»£è¡¨å½“å‰å…ƒç´ è¢«åº”ç”¨ä¸Šçš„coloré¢œè‰²å€¼ï¼Œä¹Ÿå¯ä»¥è¯´å½“å‰å…ƒç´ çš„æ–‡æœ¬é¢œè‰²å€¼ã€‚ä¾‹å¦‚ï¼šSee the Pen currentColor by wuyouzhuguli (@mrbird) on CodePen.å‚è€ƒè‡ªèš‚èšéƒ¨è½]]></content>
      <tags>
        <tag>CSS3</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS3æ–‡æœ¬å±žæ€§]]></title>
    <url>%2FCSS3%E6%96%87%E6%9C%AC%E5%B1%9E%E6%80%A7.html</url>
    <content type="text"><![CDATA[text-shadowè¯¥å±žæ€§ç”¨äºŽè®¾ç½®æ–‡å­—é˜´å½±æ•ˆæžœï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š1text-shadow:[é¢œè‰² xè½´ yè½´ æ¨¡ç³ŠåŠå¾„],[é¢œè‰² xè½´ yè½´ æ¨¡ç³ŠåŠå¾„]...è¯­æ³•æ³¨é‡Š:ï¼ˆ1ï¼‰é¢œè‰²ï¼šè¡¨ç¤ºé˜´å½±çš„é¢œè‰²å€¼ã€‚ï¼ˆ2ï¼‰xè½´ï¼šæ°´å¹³æ–¹å‘çš„åç§»é‡ï¼Œå•ä½æ˜¯åƒç´ ã€‚ï¼ˆ3ï¼‰yè½´ï¼šåž‚ç›´æ–¹å‘çš„åç§»é‡ï¼Œå•ä½æ˜¯åƒç´ ã€‚ï¼ˆ4ï¼‰æ¨¡ç³ŠåŠå¾„ï¼šé˜´å½±çš„å½±å“èŒƒå›´ï¼Œä¸èƒ½ä¸ºè´Ÿå€¼ï¼Œå€¼è¶Šå¤§è¶Šæ¨¡ç³Šã€‚ä»£ç å®žä¾‹ï¼šxè½´åç§»é‡æ¼”ç¤ºï¼šSee the Pen text-shadow by wuyouzhuguli (@mrbird) on CodePen.å¤šå±‚é˜´å½±:æ‰€è°“å¤šå±‚å¼•ç”¨ï¼Œå°±æ˜¯ç»™æ–‡å­—æ–½åŠ å¤šä¸ªé˜´å½±æ ·å¼å³å¯ï¼Œä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚text-stroketext-strokeå±žæ€§å¯ä»¥è®¾ç½®æ–‡å­—çš„æè¾¹æ•ˆæžœã€‚è¯­æ³•å¦‚ä¸‹ï¼š1text-strokeï¼š[ text-stroke-width ] || [ text-stroke-color ]è¯­æ³•æ³¨é‡Šï¼šï¼ˆ1ï¼‰text-stroke-widthï¼šè®¾ç½®å…ƒç´ ä¸­æ–‡æœ¬çš„æè¾¹åŽšåº¦ã€‚ï¼ˆ2ï¼‰text-stroke-colorï¼šè®¾ç½®å…ƒç´ ä¸­æ–‡æœ¬çš„æè¾¹é¢œè‰²ã€‚ä»£ç å®žä¾‹ï¼šSee the Pen text-stroke by wuyouzhuguli (@mrbird) on CodePen.text-strokeæ˜¯ä¸€ä¸ªå¤åˆå±žæ€§ï¼Œä¹Ÿå¯ä»¥å°†å®ƒä»¬æ‹†å¼€å•ç‹¬è®¾ç½®ï¼šSee the Pen text-stroke1 by wuyouzhuguli (@mrbird) on CodePen.text-overflowè¯¥å±žæ€§ç”¨äºŽæŽ§åˆ¶æ–‡æœ¬æº¢å‡ºæ ·å¼ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š1text-overflowï¼šclip | ellipsisè¯­æ³•æ³¨é‡Šï¼šï¼ˆ1ï¼‰clipï¼šæ­¤å±žæ€§å€¼è¡¨ç¤ºç›´æŽ¥è£åˆ‡ï¼Œå¹¶ä¸æ˜¾ç¤ºçœç•¥æ ‡è®°(â€¦)ã€‚ï¼ˆ2ï¼‰ellipsisï¼šæ­¤å±žæ€§å¯ä»¥è®¾ç½®å½“æ–‡æœ¬æº¢å‡ºæ—¶å°†æ˜¾ç¤ºçœç•¥æ ‡è®°(â€¦)ã€‚éœ€è¦ä¸Žoverflow:hiddenå’Œwhite-space:nowrapé…åˆä½¿ç”¨æ‰èƒ½å¤Ÿç”Ÿæ•ˆã€‚ä»£ç å®žä¾‹ï¼šSee the Pen text-overflow by wuyouzhuguli (@mrbird) on CodePen.text-fill-colorè®¾ç½®æ–‡å­—çš„å¡«å……é¢œè‰²ï¼ŒåŒæ—¶è®¾ç½®text-fill-colorå’Œcolorï¼Œtext-fill-colorå°†ä¼šè¦†ç›–colorå±žæ€§ã€‚ä»£ç å®žä¾‹ï¼šä½¿ç”¨text-fill-colorå’Œtext-strokeå±žæ€§æ¥åˆ¶é€ é•‚ç©ºæ–‡å­—æ•ˆæžœï¼šSee the Pen text-fill-color by wuyouzhuguli (@mrbird) on CodePen.word-wrapè¯¥å±žæ€§æä¾›æ¢è¡Œçš„åŠŸèƒ½ï¼ŒåŸºæœ¬è¯­æ³•ï¼š1word-wrap: normal | break-wordè¯­æ³•æ³¨é‡Šï¼šï¼ˆ1ï¼‰normalï¼šé»˜è®¤å€¼ï¼Œä¿æŒæµè§ˆå™¨çš„é»˜è®¤å¤„ç†ï¼Œåªåœ¨å…è®¸çš„æ–­å­—ç‚¹æ¢è¡Œï¼Œä¹Ÿå°±æ˜¯éžè¿žç»­çš„è‹±æ–‡å­—ç¬¦æ•°å­—æˆ–è€…æ±‰å­—å¯ä»¥è¿›è¡Œæ¢è¡Œã€‚ï¼ˆ2ï¼‰break-wordï¼šæ­¤å±žæ€§å€¼å¯ä»¥å®žçŽ°å†…å®¹æ¢è¡Œï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å®žçŽ°åœ¨è¾¹ç•Œå†…æ¢è¡Œï¼Œä¸èƒ½å¤Ÿè¶…å‡ºè¾¹ç•Œã€‚ä»£ç å®žä¾‹ï¼šSee the Pen word-wrap by wuyouzhuguli (@mrbird) on CodePen.@font-faceè¯¥å±žæ€§ç”¨äºŽå¼•å…¥ç½‘ç»œä¸­çš„å­—ä½“ï¼ŒåŸºæœ¬è¯­æ³•ï¼š123456@font-face &#123; font-family: &lt;YourWebFontName&gt;; src: &lt;source&gt; [&lt;format&gt;][,&lt;source&gt; [&lt;format&gt;]]*; [font-weight: &lt;weight&gt;]; [font-style: &lt;style&gt;];&#125;è¯­æ³•æ³¨é‡Šï¼šï¼ˆ1ï¼‰YourWebFontNameï¼šå¿…éœ€ï¼Œè‡ªå®šä¹‰å­—ä½“çš„åç§°ã€‚ï¼ˆ2ï¼‰sourceï¼šå¿…éœ€ï¼Œè§„å®šè‡ªå®šä¹‰å­—ä½“çš„è·¯å¾„ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ã€‚ï¼ˆ3ï¼‰formatï¼šå¯é€‰ï¼Œè§„å®šè‡ªå®šä¹‰å­—ä½“çš„æ ¼å¼ï¼Œç”¨æ¥å¸®åŠ©æµè§ˆå™¨è¯†åˆ«ï¼Œä¸»è¦ç±»åž‹:truetype(.ttf)ï¼Œopentype(.otf)ï¼Œtruetype-aatï¼Œembedded-opentype(.eot)ï¼Œsvg(.svg)ç­‰ã€‚ï¼ˆ4ï¼‰font-weightï¼šå¯é€‰ï¼Œè§„å®šå­—ä½“æ˜¯å¦ä¸ºç²—ä½“ã€‚ï¼ˆ5ï¼‰font-styleï¼šå¯é€‰ï¼Œè§„å®šå­—ä½“çš„æ ·å¼ï¼Œæ¯”å¦‚æ–œä½“ã€‚ä»£ç å®žä¾‹ï¼š12345678@font-face &#123; font-family: 'MyWebFont'; src: url('webfont.eot'); /* IE9 Compat Modes */ src: url('webfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */ url('webfont.woff') format('woff'), /* Modern Browsers */ url('webfont.ttf') format('truetype'), /* Safari, Android, iOS */ url('webfont.svg#svgFontName') format('svg'); /* Legacy iOS */&#125;å‚è€ƒè‡ªèš‚èšéƒ¨è½]]></content>
      <tags>
        <tag>CSS3</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Leanoteåšå®¢æ·»åŠ è¿‡æ¸¡åŠ¨ç”»]]></title>
    <url>%2FLeanote%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E8%BF%87%E6%B8%A1%E5%8A%A8%E7%94%BB.html</url>
    <content type="text"><![CDATA[ä¸ºäº†æé«˜åšå®¢ç”¨æˆ·ä½“éªŒï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºå…¶æ·»åŠ ä¸€äº›åŠ¨ç”»æ•ˆæžœã€‚è¿™ç¯‡åšæ–‡ä¸»è¦ä»‹ç»å¦‚ä½•æ·»åŠ é¡µé¢åˆ‡æ¢åŠ¨ç”»ä»¥åŠé¡µé¢åŠ è½½åŠ¨ç”»ã€‚éœ€è¦ç”¨åˆ°çš„æ’ä»¶ï¼šAnimsition.jsï¼šhttp://git.blivesta.com/animsition/Loader.cssï¼šhttps://connoratherton.com/loadersé¡µé¢åˆ‡æ¢åŠ¨ç”»é¦–å…ˆä»Žhttps://github.com/blivesta/animsitionä¸Šä¸‹è½½æ’ä»¶åŒ…ï¼Œè§£åŽ‹åŽåœ¨åšå®¢ä¸»é¢˜ä¸­å¼•å…¥animsition.csså’Œanimsition.jsï¼š12&lt;script src="&#123;&#123;$.themeBaseUrl&#125;&#125;/animsition.js"&gt;&lt;/script&gt;&lt;link href="&#123;&#123;$.themeBaseUrl&#125;&#125;/animsition.css" rel="stylesheet"&gt;è¿™é‡Œä¸å¼•å…¥åŽ‹ç¼©ç‰ˆçš„åŽŸå› æ˜¯ä¸ºäº†æ–¹ä¾¿å¾…ä¼šä¿®æ”¹æºç ã€‚ ç„¶åŽæ‰¾åˆ°åšå®¢ä¸»é¢˜ä¸­çš„bodyæ ‡ç­¾ï¼Œæ·»åŠ  class=&quot;animsition&quot;ï¼š1&lt;body class="animsition"&gt;æŽ¥ç€æ‰¾åˆ°åšå®¢ä¸»é¢˜ä¸­æ‰€æœ‰çš„aæ ‡ç­¾ï¼Œæ·»åŠ class=&quot;animsition-link&quot;ã€‚ æœ€åŽè°ƒç”¨AnimsitionåŠ¨ç”»ï¼š123456789101112131415161718192021$(document).ready(function() &#123; $(".animsition").animsition(&#123; inClass: 'fade-in', outClass: 'fade-out', inDuration: 400, outDuration: 400, linkElement: '.animsition-link', loading: true, loadingParentElement: 'html', loadingClass: 'line-scale-pulse-out-rapid', loadingInner: '', timeout: false, timeoutCountdown: 5000, onLoadEvent: true, browser: [ 'animation-duration', '-webkit-animation-duration'], overlay : false, overlayClass : 'animsition-overlay-slide', overlayParentElement : 'html', transition: function(url)&#123; window.location.href = url; &#125; &#125;); &#125;inClasså’ŒoutClassæŒ‡å®šäº†é¡µé¢è½½å…¥å’Œç¦»å¼€æ—¶å€™æ‰€å±•ç¤ºçš„åŠ¨ç”»ï¼Œè¿™é‡Œä½¿ç”¨æ·¡å…¥æ·¡å‡ºçš„æ•ˆæžœã€‚Animsitionæä¾›äº†è®¸å¤šåŠ¨ç”»æ•ˆæžœï¼Œå¯æ ¹æ®è‡ªå·±çš„å–œå¥½æ›´æ¢ã€‚inDurationå’ŒoutDurationæŒ‡å®šäº†åŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ã€‚linkElementæŒ‡å®šè¶…é“¾æŽ¥å…ƒç´ ï¼Œè¿™é‡Œæ˜¯æˆ‘ä»¬ä¸Šé¢æ·»åŠ äº†class=&quot;animsition-link&quot;çš„aæ ‡ç­¾ã€‚é¡µé¢åŠ è½½åŠ¨ç”»Loader.cssæ˜¯ä¸€ä¸ªçº¯CSSåŠ è½½åŠ¨ç”»æ’ä»¶ã€‚Animsitionæ’ä»¶è‡ªå¸¦çš„åŠ è½½åŠ¨ç”»ä¸å¤ªç¾Žè§‚ï¼Œæ‰€ä»¥ä½¿ç”¨è¯¥æ’ä»¶æ›¿æ¢ã€‚ é¦–å…ˆä»Žhttps://github.com/ConnorAtherton/loaders.cssä¸Šä¸‹è½½æ’ä»¶åŒ…ï¼Œè§£åŽ‹åŽæ‰“å¼€loaders.css-master/demo/demo.htmlå¯çœ‹åˆ°è®¸å¤šç¾Žè§‚çš„åŠ è½½åŠ¨ç”»ã€‚é€‰æ‹©ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„åŠ¨ç”»ï¼Œç„¶åŽF12æŸ¥çœ‹å…¶HTMLæºä»£ç ï¼Œæ¯”å¦‚ï¼šä»Žæºç ä¸­å¯çŸ¥é“ï¼Œè¿™ä¸ªåŠ¨ç”»å¯¹åº”çš„classåç§°ä¸ºline-scale-pulse-out-rapidç„¶åŽä¿®æ”¹ä¸€å¼€å§‹å¼•å…¥çš„animsition.jsï¼Œæ‰¾åˆ°å¹¶ä¿®æ”¹addLoadingå‡½æ•°ï¼š12345addLoading: function(n) &#123; var html = '&lt;div class="' + n.loadingClass + '"&gt;'; html += '&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;'; t(n.loadingParentElement).append(html);&#125;,è¿™é‡ŒloadingClasså±žæ€§åç§°æ˜¯åœ¨ $(&quot;.animsition&quot;).animsition({})å‡½æ•°ä¸­æŒ‡å®šçš„ï¼Œç»†å¿ƒçš„ä½ å¯èƒ½ä¼šå‘çŽ°ï¼Œæˆ‘å·²ç»åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­å°†loadingClasså±žæ€§å€¼æŒ‡å®šä¸ºline-scale-pulse-out-rapidäº†ã€‚æŽ¥ä¸‹æ¥ä¿®æ”¹animsition.cssï¼Œæ‰¾åˆ°å’Œ.animsition-loadingæœ‰å…³çš„ä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253/* loading option */.animsition-loading,.animsition-loading:after &#123; width: 32px; height: 32px; position: fixed; top: 50%; left: 50%; margin-top: -16px; margin-left: -16px; border-radius: 50%; z-index: 100;&#125; .animsition-loading &#123; background-color: transparent; border-top: 5px solid rgba(0, 0, 0, 0.2); border-right: 5px solid rgba(0, 0, 0, 0.2); border-bottom: 5px solid rgba(0, 0, 0, 0.2); border-left: 5px solid #eee; -webkit-transform: translateZ(0); transform: translateZ(0); -webkit-animation-iteration-count:infinite; animation-iteration-count:infinite; -webkit-animation-timing-function: linear; animation-timing-function: linear; -webkit-animation-duration: .8s; animation-duration: .8s; -webkit-animation-name: animsition-loading; animation-name: animsition-loading;&#125; @-webkit-keyframes animsition-loading &#123; 0% &#123; -webkit-transform: rotate(0deg); transform: rotate(0deg); &#125; 100% &#123; -webkit-transform: rotate(360deg); transform: rotate(360deg); &#125;&#125; @keyframes animsition-loading &#123; 0% &#123; -webkit-transform: rotate(0deg); transform: rotate(0deg); &#125; 100% &#123; -webkit-transform: rotate(360deg); transform: rotate(360deg); &#125;&#125;è¿™æ®µä»£ç æ˜¯Animsitionæ’ä»¶è‡ªå¸¦çš„åŠ è½½åŠ¨ç”»ï¼Œå°†å…¶åˆ é™¤ã€‚ç„¶åŽä»Žloaders.css-master/loader.cssä¸­æ‰¾åˆ°å’Œ.line-scale-pulse-out-rapidæœ‰å…³çš„CSSä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940@-webkit-keyframes line-scale-pulse-out-rapid &#123; 0% &#123; -webkit-transform: scaley(1); transform: scaley(1); &#125; 80% &#123; -webkit-transform: scaley(0.3); transform: scaley(0.3); &#125; 90% &#123; -webkit-transform: scaley(1); transform: scaley(1); &#125; &#125; @keyframes line-scale-pulse-out-rapid &#123; 0% &#123; -webkit-transform: scaley(1); transform: scaley(1); &#125; 80% &#123; -webkit-transform: scaley(0.3); transform: scaley(0.3); &#125; 90% &#123; -webkit-transform: scaley(1); transform: scaley(1); &#125; &#125; .line-scale-pulse-out-rapid &gt; div &#123; background-color: #fff; width: 4px; height: 35px; border-radius: 2px; margin: 2px; -webkit-animation-fill-mode: both; animation-fill-mode: both; display: inline-block; vertical-align: middle; -webkit-animation: line-scale-pulse-out-rapid 0.9s -0.5s infinite cubic-bezier(0.11, 0.49, 0.38, 0.78); animation: line-scale-pulse-out-rapid 0.9s -0.5s infinite cubic-bezier(0.11, 0.49, 0.38, 0.78); &#125;.line-scale-pulse-out-rapid &gt; div:nth-child(2), .line-scale-pulse-out-rapid &gt; div:nth-child(4) &#123; -webkit-animation-delay: -0.25s !important; animation-delay: -0.25s !important; &#125;.line-scale-pulse-out-rapid &gt; div:nth-child(1), .line-scale-pulse-out-rapid &gt; div:nth-child(5) &#123; -webkit-animation-delay: 0s !important; animation-delay: 0s !important; &#125;å°†è¿™æ®µä»£ç æ·»åŠ åˆ°animsition.cssä¸­ã€‚è¿™é‡Œ.line-scale-pulse-out-rapid &gt; div çš„èƒŒæ™¯è‰²æ˜¯ç™½è‰²çš„ï¼ˆbackground-color: #fffï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°†å…¶ä¿®æ”¹ä¸ºè‡ªå·±éœ€è¦çš„é¢œè‰²ï¼Œæ¯”å¦‚åšä¸»å°†å…¶æ›¿æ¢ä¸ºæµ…ç»¿è‰²ï¼š1234.line-scale-pulse-out-rapid &gt; div &#123; background-color: #6db33f; ...&#125;æœ€åŽä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹åŠ è½½åŠ¨ç”»æ¨¡å—divçš„å®šä½æ–¹å¼ä¸ºå›ºå®šå®šä½å¹¶ä¸”å±…ä¸­ï¼š12345.line-scale-pulse-out-rapid &#123; position: fixed; top: 50%; left: 50%&#125;å°†ä¸Šé¢çš„æ­¥éª¤ä¾æ¬¡åšå®ŒåŽï¼Œåœ¨åŠ è½½åŒ…å«è¾ƒå¤šå›¾ç‰‡çš„åšå®¢æˆ–è€…ç½‘ç»œä¸ä½³çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„åŠ è½½åŠ¨ç”»ï¼šAnimsitionæ’ä»¶è¿˜æœ‰æ·»åŠ è¦†ç›–ç‰©overlayåŠŸèƒ½ï¼Œåšä¸»æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œæ‰€ä»¥ä¸å†ä»‹ç»ï¼Œå…·ä½“å¯æŸ¥é˜…å®˜æ–¹APIã€‚]]></content>
      <tags>
        <tag>Leanote</tag>
        <tag>theme</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitä½¿ç”¨å…¥é—¨]]></title>
    <url>%2FGit%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8.html</url>
    <content type="text"><![CDATA[å‡†å¤‡GitçŽ¯å¢ƒé¦–å…ˆåœ¨ubuntuä¸­æŸ¥çœ‹æ˜¯å¦å®‰è£…äº†Gitï¼š123$ gitThe program 'git' is currently not installed. You can install it by typing:sudo apt install gitlinuxæç¤ºå°šæœªå®‰è£…Gitï¼Œå¹¶æä¾›äº†å®‰è£…çš„æŒ‡ä»¤ï¼šsudo apt install gitã€‚ç¬¬ä¸€æ¬¡ä½¿ç”¨Gitéœ€è¦è®¾ç½®ä¸ªäººä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·åé‚®ç®±ç­‰ï¼š12$ git config --global user.name "mrbird"$ git config --global user.email "mrbird@leanote.com"åˆ›å»ºGité¡¹ç›®é¦–å…ˆåˆ›å»ºä¸€ä¸ªprojectsç›®å½•ï¼Œç„¶åŽåœ¨projectsä¸‹åˆ›å»ºfirst-projecté¡¹ç›®ï¼ŒåŒ…å«foo.txtå’Œbar.txtä¸¤ä¸ªæ–‡ä»¶ï¼š12345678910111213$ mkdir projects$ cd projects/$ mkdir first-project$ cd first-project/$ vi foo.txt$ vi bar.txt$ tree -A projects/projects/â””â”€â”€ first-project â”œâ”€â”€ bar.txt â””â”€â”€ foo.txt 1 directory, 2 filesåˆ›å»ºç‰ˆæœ¬åº“é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨first-projectä¸‹åˆ›å»ºä¸€ä¸ªGitç‰ˆæœ¬åº“ï¼Œç”¨äºŽå­˜å‚¨é¡¹ç›®æœ¬èº«åŠå…¶åŽ†å²ã€‚å¯¹äºŽä¸€ä¸ªå¸¦æœ‰ç‰ˆæœ¬åº“çš„é¡¹ç›®ç›®å½•ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸ºå·¥ä½œåŒºã€‚123$ cd first-project/$ git initInitialized empty Git repository in /home/mrbird/projects/first-project/.git/å†æ¬¡ä½¿ç”¨treeå‘½ä»¤å°±å¯ä»¥çœ‹åˆ°ï¼Œåœ¨first-projectç›®å½•ä¸‹å¤šäº†ä¸ª.gitéšè—ç›®å½•ï¼Œè¯¥ç›®å½•å°±æ˜¯Gitç”¨äºŽè·Ÿè¸ªå¹¶ç®¡ç†ç‰ˆæœ¬åº“ç”¨çš„ï¼š1234567$ tree -aA projects/projects/â””â”€â”€ first-project â”œâ”€â”€ bar.txt â”œâ”€â”€ foo.txt â””â”€â”€ .git...é¦–æ¬¡æäº¤æŽ¥ä¸‹æ¥ï¼Œéœ€è¦å°†foo.txtå’Œbar.txtæ·»åŠ åˆ°ç‰ˆæœ¬åº“ä¸­åŽ»ã€‚åœ¨Gitä¸­ï¼Œé€šå¸¸å°†é¡¹ç›®çš„ä¸€ä¸ªç‰ˆæœ¬ç§°ä¹‹ä¸ºä¸€æ¬¡æäº¤ã€‚æäº¤åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼šä½¿ç”¨git addå‘½ä»¤æ¥ç¡®å®šä¸‹æ¬¡æäº¤å‰åº”è¯¥åŒ…å«çš„æ–‡ä»¶ï¼›ä½¿ç”¨git commitå‘½ä»¤å°†è¿™äº›æ–‡ä»¶ä¼ é€åˆ°ç‰ˆæœ¬åº“ä¸­ï¼Œå¹¶ç”Ÿæˆæ•£åˆ—å€¼ä»¥æ ‡è¯†è¿™æ¬¡æ›´æ–°ã€‚123456$ git add foo.txt bar.txt $ git commit -m "add foo.txt bar.txt"[master (root-commit) c2e4810] add foo.txt bar.txt 2 files changed, 0 insertions(+), 0 deletions(-) create mode 100644 bar.txt create mode 100644 foo.txtæ£€æŸ¥çŠ¶æ€çŽ°åœ¨å°†first-projectç›®å½•ä¸‹çš„bar.txtæ–‡ä»¶åˆ é™¤ï¼Œæ·»åŠ bar.htmlæ–‡ä»¶ï¼Œä¿®æ”¹foo.txtæ–‡ä»¶å†…å®¹ã€‚ç„¶åŽä½¿ç”¨git statuså‘½ä»¤æŸ¥çœ‹çŠ¶æ€ï¼š123456789101112131415$ git statusOn branch masterChanges not staged for commit: (use "git add/rm &lt;file&gt;..." to update what will be committed) (use "git checkout -- &lt;file&gt;..." to discard changes in working directory) deleted: bar.txt modified: foo.txt Untracked files: (use "git add &lt;file&gt;..." to include in what will be committed) bar.html no changes added to commit (use "git add" and/or "git commit -a")å› ä¸ºè¿˜æ²¡æœ‰ä½¿ç”¨git addå‘½ä»¤å°†bar.htmlæ·»åŠ åˆ°ç‰ˆæœ¬åº“ï¼Œæ‰€ä»¥æ˜¾ç¤ºä¸ºæœªè·Ÿè¸ªçŠ¶æ€ï¼ˆUntrackedï¼‰ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨git diffå‘½ä»¤æ¥æŸ¥çœ‹è¢«ä¿®æ”¹çš„æ–‡ä»¶å…·ä½“ä¿®æ”¹äº†å•¥ï¼š1234567$ git diff foo.txtdiff --git a/foo.txt b/foo.txtindex e69de29..3f9a7b1 100644--- a/foo.txt+++ b/foo.txt@@ -0,0 +1 @@+foo fileå¯ä»¥çœ‹å‡ºï¼Œfoo.txtæ–‡ä»¶æ·»åŠ äº†ä¸€è¡Œå†…å®¹ï¼šfoo fileã€‚æäº¤ä¿®æ”¹å°†ä¸Šè¿°çš„ä¿®æ”¹å½’æ¡£æˆä¸€æ¬¡æ–°çš„æäº¤ï¼Œå³æ·»åŠ foo.txtå’Œæ–°æ–‡ä»¶bar.htmlï¼Œåˆ é™¤bar.txtï¼š123$ git add foo.txt bar.html $ git rm bar.txt rm 'bar.txt'å†æ¬¡ä½¿ç”¨git statuså‘½ä»¤æŸ¥çœ‹å½“å‰çŠ¶æ€ï¼š12345678$ git statusOn branch masterChanges to be committed: (use "git reset HEAD &lt;file&gt;..." to unstage) new file: bar.html deleted: bar.txt modified: foo.txtè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨git commitæ¥æäº¤è¿™äº›ä¿®æ”¹ï¼š12345$ git commit -m "add bar.html,modify foo.txt,delete bar.txt"[master 94418b1] add bar.html,modify foo.txt,delete bar.txt 3 files changed, 2 insertions(+) create mode 100644 bar.html delete mode 100644 bar.txtæ˜¾ç¤ºåŽ†å²ä½¿ç”¨git logå‘½ä»¤å¯ä»¥æŸ¥çœ‹æ‰€æœ‰æäº¤çš„åŽ†å²ï¼Œå¹¶æŒ‰æ—¶é—´é¡ºåºå€’åºæŽ’åˆ—ï¼š123456789101112$ git logcommit 94418b10e64f46bc4f48049037fadcb12efc5d10Author: mrbird &lt;mrbird@leanote.com&gt;Date: Sat May 27 14:09:51 2017 +0800 add bar.html,modify foo.txt,delete bar.txt commit c2e48100c4f2fc8afaed2b1cac90deaf6a7e34ecAuthor: mrbird &lt;mrbird@leanote.com&gt;Date: Sat May 27 11:08:29 2017 +0800 add foo.txt bar.txtGitåä½œåŠŸèƒ½å‡å¦‚çŽ°åœ¨è¿˜æœ‰å¦å¤–ä¸€ä½å¼€å‘è€…ä¹Ÿå‚ä¸Žå¼€å‘first-projectè¿™ä¸ªé¡¹ç›®ï¼Œä¸ºäº†æ–¹ä¾¿å®žéªŒï¼ŒçŽ°åœ¨åœ¨projectsç›®å½•ä¸‹å¼€è¾Ÿå¦å¤–ä¸€ä¸ªå·¥ä½œåŒºfirst-project-cloneï¼Œä¾›ç¬¬äºŒä½å¼€å‘è€…ä½¿ç”¨ã€‚å…‹éš†ç‰ˆæœ¬åº“çŽ°ä½¿ç”¨git cloneæ¥å…‹éš†first-projectï¼Œè¯¥ç‰ˆæœ¬åº“å‰¯æœ¬åŒ…å«äº†æ‰€æœ‰åŽŸå§‹ä¿¡æ¯å’Œæ•´ä¸ªé¡¹ç›®çš„åŽ†å²ä¿¡æ¯ï¼š123$ git clone projects/first-project/ projects/first-project-cloneCloning into 'projects/first-project-clone'...done.å…‹éš†åŽï¼Œè§‚å¯Ÿé¡¹ç›®ç»“æž„ï¼š123456789101112$ tree -aA projects/projects/â”œâ”€â”€ first-projectâ”‚ â”œâ”€â”€ bar.htmlâ”‚ â”œâ”€â”€ foo.txtâ”‚ â””â”€â”€ .gitâ”‚ â”œâ”€â”€ ...â””â”€â”€ first-project-clone â”œâ”€â”€ bar.html â”œâ”€â”€ foo.txt â””â”€â”€ .git â”œâ”€â”€ ...ä»Žå¦ä¸€ä¸ªç‰ˆæœ¬åº“ä¸­èŽ·å–ä¿®æ”¹çŽ°åœ¨ï¼Œåœ¨first-project/foo.txtæ–‡ä»¶ä¸­æ’å…¥ä¸€è¡Œä¿¡æ¯â€hello world,hello gitâ€ï¼Œå¹¶ä¸”æäº¤ä¿®æ”¹ï¼š123456$ cd projects/first-project$ vi foo.txt $ git add foo.txt $ git commit -m "modify foo.txt in original"[master 8e1b132] modify foo.txt in original 1 file changed, 1 insertion(+)åŒæ—¶ä¿®æ”¹å…‹éš†ç‰ˆæœ¬åº“first-project-cloneä¸­çš„bar.htmlï¼Œå¹¶ä¸”æäº¤ä¿®æ”¹ï¼š1234$ git add bar.html$ git commit -m "modify bar.html in clone"[master 796e40d] modify bar.html in clone 1 file changed, 1 insertion(+)çŽ°åœ¨ï¼Œæ–°çš„æäº¤å·²ç»è¢«å­˜å…¥åˆ°äº†first-projectç‰ˆæœ¬åº“ä¸­ï¼Œä½†æ˜¯å…¶å…‹éš†ç‰ˆæœ¬åº“first-project-cloneå¹¶æ²¡æœ‰å–å¾—è¿™æ¬¡ä¿®æ”¹ï¼ˆå³foo.txtè¿˜æ˜¯ä¿æŒåŽŸæ ·ï¼‰ã€‚å¦‚æžœå…‹éš†ç‰ˆæœ¬åº“ä¹Ÿè¦èŽ·å–åŽŸç‰ˆæœ¬åº“ä¸­çš„ä¿®æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨git pullå‘½ä»¤æ¥èŽ·å–ï¼š12345678910111213141516$ cd ../first-project-clone/$ cat foo.txt foo file$ git pullremote: Counting objects: 3, done.remote: Compressing objects: 100% (2/2), done.remote: Total 3 (delta 0), reused 0 (delta 0)Unpacking objects: 100% (3/3), done.From /home/mrbird/projects/first-project 8e1b132..27b76ec master -&gt; origin/masterMerge made by the 'recursive' strategy. foo.txt | 1 + 1 file changed, 1 insertion(+)$ cat foo.txt foo filehello world,hello gitç”±äºŽåœ¨åˆ›å»ºå…‹éš†ç‰ˆæœ¬åº“çš„æ—¶å€™ï¼ŒåŽŸç‰ˆæœ¬åº“çš„è·¯å¾„å°±å·²ç»è¢«å­˜å‚¨åˆ°å…‹éš†ç‰ˆæœ¬åº“ä¸­äº†ã€‚æ‰€ä»¥åœ¨å…‹éš†ç‰ˆæœ¬åº“ä¸­ä½¿ç”¨git pullå‘½ä»¤ï¼Œä¸å¸¦è·¯å¾„çš„è¯ï¼Œé»˜è®¤å°±æ˜¯ä»ŽåŽŸç‰ˆæœ¬åº“ä¸­å–å›žä¿®æ”¹ã€‚ ä»Žç»“æžœä¸­å¯ä»¥çœ‹å‡ºï¼ŒGitä»ŽåŽŸç‰ˆæœ¬åº“ä¸­å–å›žäº†ä¿®æ”¹ï¼Œä¸Žå…‹éš†ä½“ä¸­çš„ä¿®æ”¹è¿›è¡Œäº†æ¯”å¯¹ï¼Œå¹¶ä¸”åˆå¹¶äº†è¿™äº›ä¿®æ”¹ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºåˆå¹¶ï¼ˆmergeï¼‰ã€‚åœ¨pullè¿‡ç¨‹ä¸­ï¼Œå¦‚æžœå‘ç”Ÿäº†å†²çªï¼Œæ¯”å¦‚ä¸¤ä½å¼€å‘è€…åŒæ—¶å¯¹foo.txtæ–‡ä»¶è¿›è¡Œäº†ä¿®æ”¹ï¼ŒGitä¸ä¼šè‡ªåŠ¨åŽ»å¤„ç†è¿™äº›å†²çªï¼Œå¿…é¡»æ‰‹åŠ¨åŽ»åšä¿®æ”¹ã€‚åœ¨pullå–å›žä¿®æ”¹ï¼Œå¹¶ä¸”mergeåˆå¹¶ä¹‹åŽï¼Œå¯ä»¥ä½¿ç”¨git log --graphå‘½ä»¤æ¥æŸ¥çœ‹å›¾å½¢åŒ–æ—¥å¿—ï¼š12345678 $ git log --graph --oneline * 8747b24 Merge branch 'master' of /home/mrbird/projects/first-project|\ | * 27b76ec modify foo.txt in original* | 796e40d modify bar.html in clone|/ * 94418b1 add bar.html,modify foo.txt,delete bar.txt* c2e4810 add foo.txt bar.txtä»Žä¸Šé¢å¯ä»¥æ¸…æ™°çš„çœ‹å‡ºï¼Œåˆ†æ”¯åˆå¹¶çš„æƒ…å†µã€‚ä»Žä»»æ„ç‰ˆæœ¬åº“ä¸­å–å›žä¿®æ”¹git pullå¸¦ä¸Šä»“åº“è·¯å¾„çš„è¯å°±å¯ä»¥ä»Žä»»æ„ä¸€ä¸ªç‰ˆæœ¬åº“ä¸­å–å›žä¿®æ”¹äº†ï¼ŒçŽ°åœ¨åœ¨åŽŸç‰ˆæœ¬åº“first-projectä¸­å–å›žå…¶å…‹éš†ç‰ˆæœ¬åº“first-project-cloneå¯¹bar.htmlçš„ä¿®æ”¹ï¼š1234567891011$ git pull ../first-project-clone/remote: Counting objects: 5, done.remote: Compressing objects: 100% (4/4), done.remote: Total 5 (delta 0), reused 0 (delta 0)Unpacking objects: 100% (5/5), done.From ../first-project-clone * branch HEAD -&gt; FETCH_HEADUpdating 27b76ec..8747b24Fast-forward bar.html | 1 + 1 file changed, 1 insertion(+)åˆ›å»ºå…±äº«ç‰ˆæœ¬åº“é™¤äº†ä½¿ç”¨git pullå‘½ä»¤ä»Žåˆ«çš„ç‰ˆæœ¬åº“å–å›žä¿®æ”¹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨git pushå‘½ä»¤å°†æœ¬åœ°ä¿®æ”¹ä¼ é€ç»™å…¶ä»–ç‰ˆæœ¬åº“ã€‚ ä¸è¿‡ï¼Œgit pushå‘½ä»¤åªé€‚ç”¨äºŽé‚£äº›æ²¡æœ‰å¼€å‘è€…åœ¨ä¸Šé¢å…·ä½“å·¥ä½œçš„ç‰ˆæœ¬åº“ã€‚é€šå¸¸çš„åšæ³•æ˜¯åˆ›å»ºä¸€ä¸ªæ²¡æœ‰å·¥ä½œåŒºçš„ç‰ˆæœ¬åº“ï¼Œä¹Ÿç§°ä¹‹ä¸ºè£¸ç‰ˆæœ¬åº“ã€‚è£¸ç‰ˆæœ¬åº“å°±æ˜¯å•çº¯ç”¨äºŽå­˜æ”¾å„ä¸ªå¼€å‘è¿™æäº¤ï¼ˆpushï¼‰çš„ä¿®æ”¹ï¼Œæ–¹ä¾¿åˆ«çš„å¼€å‘è€…å–å›žï¼ˆpullï¼‰è¿™äº›ä¿®æ”¹ã€‚çŽ°ä½¿ç”¨git clone --bareå‘½ä»¤æ¥åˆ›å»ºè£¸ç‰ˆæœ¬åº“ï¼š123$ git clone --bare first-project first-project-bareCloning into bare repository 'first-project-bare'...done.ä½¿ç”¨pushå‘è£¸ç‰ˆæœ¬åº“æäº¤ä¿®æ”¹å†æ¬¡ä¿®æ”¹åŽŸç‰ˆæœ¬åº“first-projectä¸­çš„foo.txtæ–‡ä»¶ï¼Œå¹¶ä¸”æäº¤ä¿®æ”¹ï¼š1234$ git add foo.txt $ git commit -m "modify foo.txt in original again"[master 31e1f6f] modify foo.txt in original again 1 file changed, 1 insertion(+), 1 deletion(-)çŽ°åœ¨ä½¿ç”¨git pushå‘è£¸ç‰ˆæœ¬åº“æäº¤è¿™æ¬¡ä¿®æ”¹ï¼Œpushéœ€è¦æŒ‡å®šç›®æ ‡ç‰ˆæœ¬åº“è·¯å¾„ä»¥åŠå…¶åˆ†æ”¯ã€‚1234567$ git push ../first-project-bare/ masterCounting objects: 3, done.Compressing objects: 100% (2/2), done.Writing objects: 100% (3/3), 316 bytes | 0 bytes/s, done.Total 3 (delta 0), reused 0 (delta 0)To ../first-project-bare/ 8747b24..31e1f6f master -&gt; masterå¦‚æžœå¦ä¸€ä½å¼€å‘è€…åœ¨æˆ‘ä»¬ä¹‹å‰å°±å·²ç»pushäº†ä¿®æ”¹ï¼Œé‚£æ­¤æ¬¡çš„pushæ“ä½œå°†ä¼šè¢«æ‹’ç»ï¼Œå¿…é¡»å…ˆpullå›žä¿®æ”¹ï¼Œæ‰èƒ½pushæˆ‘ä»¬çš„ä¿®æ”¹ã€‚ä½¿ç”¨pullä»Žè£¸ç‰ˆæœ¬åº“å–å›žä¿®æ”¹123456789101112$ cd ../first-project$ git pull ../first-project-bare/ masterremote: Counting objects: 3, done.remote: Compressing objects: 100% (2/2), done.remote: Total 3 (delta 0), reused 0 (delta 0)Unpacking objects: 100% (3/3), done.From ../first-project-bare * branch master -&gt; FETCH_HEADUpdating 8747b24..31e1f6fFast-forward foo.txt | 2 +- 1 file changed, 1 insertion(+), 1 deletion(-)]]></content>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQueryä¸­çš„Deferredå’ŒPromise]]></title>
    <url>%2FjQuery%E4%B8%AD%E7%9A%84Deferred%E5%92%8CPromise.html</url>
    <content type="text"><![CDATA[jQueryä¸­çš„Deferredå’ŒPromiseæœ‰åŠ©äºŽæˆ‘ä»¬å¤„ç†Ajaxè¿™æ ·çš„å¼‚æ­¥è¿‡ç¨‹ï¼Œä»¥jQueryä¸­çš„\$.ajax()ä¸ºä¾‹ï¼Œå½“åµŒå¥—å¤šä¸ª\$.ajax()å¼‚æ­¥å‡½æ•°æ—¶ï¼Œä»£ç å°±æˆäº†ä¸‹é¢è¿™æ ·ï¼š12345678910111213141516171819202122$.ajax(&#123; url: "myUrl1.do", success:function()&#123; $.ajax(&#123; url: "myUrl2.do", success:function()&#123; $.ajax(&#123; url: "myUrl3.do", success:function()&#123; $.ajax(&#123; url: "myUrl4.do", success:function(r)&#123; console.log("å‡å¦‚ä½ æ„¿æ„ä¸€å±‚ä¸€å±‚å‰¥å¼€æˆ‘çš„å¿ƒ...") console.log(r); &#125; &#125;); &#125; &#125;); &#125; &#125;); &#125;&#125;);è¿™ç§â€œé‡‘å­—å¡”â€å¼çš„ä»£ç å°±æ˜¯æ‰€è°“çš„â€œå›žè°ƒåœ°ç‹±â€ã€‚è¿™ç§é£Žæ ¼çš„ä»£ç ä½¿å¾—è°ƒè¯•å˜å¾—å¾ˆå›°éš¾ï¼Œä½¿ç”¨jQueryä¸­Promiseå¯¹è±¡å¯ä»¥å¾ˆå¥½çš„å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚ä½¿ç”¨Promiseæ”¹å†™\$.ajax()å›žè°ƒå®žé™…ä¸Šï¼Œ$.ajax()è¿”å›žçš„å°±æ˜¯Promiseå¯¹è±¡ï¼Œå¦‚ï¼š12345678910var promise = $.ajax(&#123;url:'myUrl.do'&#125;);promise.done(function()&#123; // æˆåŠŸæ—¶ï¼Œæ‰§è¡Œè¯¥å‡½æ•°&#125;)promise.fail(function()&#123; // å¤±è´¥æ—¶ï¼Œæ‰§è¡Œè¯¥å‡½æ•°&#125;)promise.always(function()&#123; // æ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼Œéƒ½æ‰§è¡Œè¯¥å‡½æ•°&#125;)æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨then()æ–¹æ³•æŠŠdone()å’Œfail()åˆå¹¶åˆ°ä¸€èµ·ã€‚12345promise.then(function()&#123; // done&#125;, function()&#123; // fail&#125;)ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºdoneæ–¹æ³•ï¼Œç¬¬äºŒä¸ªæ–¹æ³•è¡¨ç¤ºfailæ–¹æ³•ï¼›å¦‚æžœåªä¼ é€’ä¸€ä¸ªå‚æ•°çš„è¯ï¼Œå°±è¡¨ç¤ºdoneæ–¹æ³•ã€‚æ‰€ä»¥ï¼ŒçŽ°åœ¨æ¥æ”¹å†™ä¸€ä¸‹ä¸Šé¢çš„â€œé‡‘å­—å¡”â€ä»£ç ï¼š1234567891011var promise1 = $.ajax(&#123;url:"myUrl1.do"&#125;);var promise2 = promise1.then(function()&#123; return $.ajax(&#123;url:"myUrl2.do"&#125;);&#125;);var promise3 = promise2.then(function()&#123; return $.ajax(&#123;url:"myUrl3.do"&#125;);&#125;);var promise4 = promise3.then(function()&#123; return $.ajax(&#123;url:"myUrl4.do"&#125;);&#125;);promise4.then(function(r)&#123;console.log(r);&#125;);æ˜¯ä¸æ˜¯å¥½äº†å¾ˆå¤šï¼ŸjQueryä¸­çš„$.when()å½“å¤šä¸ªAjaxè¯·æ±‚éƒ½æˆåŠŸçš„æ—¶å€™ï¼Œæ‰§è¡ŒæŸä¸ªå›žè°ƒå‡½æ•°ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨$.when()æ–¹æ³•ã€‚å¦‚ï¼š123456789$.when( $.ajax(&#123;url:'myUrl1.do'&#125;), $.ajax(&#123;url:'myUrl2.do'&#125;)).done(function(result1, result2)&#123; console.log(result1); console.log(result2);&#125;).fail(function(r)&#123; console.log("error");&#125;)åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåªæœ‰å½“ä¸¤ä¸ªAjaxè¯·æ±‚éƒ½æˆåŠŸæ—¶ï¼Œæ‰ä¼šè°ƒç”¨doneæ–¹æ³•ã€‚å¦åˆ™å°±è°ƒç”¨failæ–¹æ³•ã€‚$.Deferred()$.Deferred().promise()æ–¹æ³•å¯ä»¥è¿”å›žä¸€ä¸ªPromiseå¯¹è±¡ã€‚$.Deferred()åŒ…å«äº†ä¸‰ç§çŠ¶æ€ï¼špendingï¼šç­‰å¾…çŠ¶æ€resolvedï¼šæˆåŠŸï¼ˆè§£å†³ï¼‰çŠ¶æ€rejectedï¼šå¤±è´¥ï¼ˆæ‹’ç»ï¼‰çŠ¶æ€é»˜è®¤çš„çŠ¶æ€ä¸ºpendingï¼Œå¯ä»¥ä½¿ç”¨resolveå’Œrejectæ–¹æ³•æ¥æ”¹å˜çŠ¶æ€ï¼š12345var deferred = $.Deferred();console.log(deferred.state()); //pendingdeferred.reject();console.log(deferred.state()); //rejectedæˆ–è€…ï¼š12345var deferred = $.Deferred();console.log(deferred.state()); //pendingdeferred.resolve();console.log(deferred.state()); //resolvedå½“çŠ¶æ€ä¸ºrejectedæ—¶ï¼Œæ‰§è¡Œfailæ–¹æ³•ã€‚å½“çŠ¶æ€ä¸ºresolvedæ—¶ï¼Œæ‰§è¡Œdoneæ–¹æ³•ã€‚è€Œalwaysæ–¹æ³•æ— è®ºæˆåŠŸä¸Žå¤±è´¥éƒ½ä¼šæ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œä¸‹é¢è¿™ä¸ªä¾‹å­ä¸‰ç§’åŽå¼¹å‡ºsuccessï¼šSee the Pen deferred by wuyouzhuguli (@mrbird) on CodePen.]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQueryå‡½æ•°attr()å’Œprop()çš„åŒºåˆ« [è½¬]]]></title>
    <url>%2FjQuery%E5%87%BD%E6%95%B0attr-%E5%92%8Cprop-%E7%9A%84%E5%8C%BA%E5%88%AB-%E8%BD%AC.html</url>
    <content type="text"><![CDATA[åœ¨jQueryä¸­ï¼Œattr()å‡½æ•°å’Œprop()å‡½æ•°éƒ½ç”¨äºŽè®¾ç½®æˆ–èŽ·å–æŒ‡å®šçš„å±žæ€§ï¼Œå®ƒä»¬çš„å‚æ•°å’Œç”¨æ³•ä¹Ÿå‡ ä¹Žå®Œå…¨ç›¸åŒã€‚ ä½†ä¸å¾—ä¸è¯´çš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°çš„ç”¨å¤„å´å¹¶ä¸ç›¸åŒã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»è¿™ä¸¤ä¸ªå‡½æ•°ä¹‹é—´çš„åŒºåˆ«ã€‚æ“ä½œå¯¹è±¡ä¸åŒå¾ˆæ˜Žæ˜¾ï¼Œattrå’Œpropåˆ†åˆ«æ˜¯å•è¯attributeå’Œpropertyçš„ç¼©å†™ï¼Œå¹¶ä¸”å®ƒä»¬å‡è¡¨ç¤ºâ€å±žæ€§â€çš„æ„æ€ã€‚ä¸è¿‡ï¼Œåœ¨jQueryä¸­ï¼Œattributeå’Œpropertyå´æ˜¯ä¸¤ä¸ªä¸åŒçš„æ¦‚å¿µã€‚attributeè¡¨ç¤ºHTMLæ–‡æ¡£èŠ‚ç‚¹çš„å±žæ€§ï¼Œpropertyè¡¨ç¤ºJSå¯¹è±¡çš„å±žæ€§ã€‚1234567 &lt;!-- è¿™é‡Œçš„idã€classã€data_idå‡æ˜¯è¯¥å…ƒç´ æ–‡æ¡£èŠ‚ç‚¹çš„attribute --&gt;&lt;div id="message" class="test" data_id="123"&gt;&lt;/div&gt; &lt;script type="text/javascript"&gt;// è¿™é‡Œçš„nameã€ageã€urlå‡æ˜¯objçš„propertyvar obj = &#123; name: "CodePlayer", age: 18, url: "http://www.365mini.com/" &#125;;&lt;/script&gt;åœ¨jQueryä¸­ï¼Œprop()å‡½æ•°çš„è®¾è®¡ç›®æ ‡æ˜¯ç”¨äºŽè®¾ç½®æˆ–èŽ·å–æŒ‡å®šDOMå…ƒç´ ï¼ˆæŒ‡çš„æ˜¯JSå¯¹è±¡ï¼ŒElementç±»åž‹ï¼‰ä¸Šçš„å±žæ€§propertyï¼›attr()å‡½æ•°çš„è®¾è®¡ç›®æ ‡æ˜¯ç”¨äºŽè®¾ç½®æˆ–èŽ·å–æŒ‡å®šDOMå…ƒç´ æ‰€å¯¹åº”çš„æ–‡æ¡£èŠ‚ç‚¹ä¸Šçš„å±žæ€§attributeã€‚12345678&lt;!-- attr()å‡½æ•°é’ˆå¯¹çš„æ˜¯è¯¥æ–‡æ¡£èŠ‚ç‚¹çš„attribute --&gt;&lt;div id="message" class="test" data_id="123"&gt;&lt;/div&gt; &lt;script type="text/javascript"&gt;// prop()å‡½æ•°é’ˆå¯¹çš„æ˜¯è¯¥DOMå…ƒç´ (msg)è‡ªèº«çš„propertyvar msg = document.getElementById("message");var $msg = $(msg);&lt;/script&gt;å½“ç„¶ï¼Œåœ¨jQueryçš„åº•å±‚å®žçŽ°ä¸­ï¼Œå‡½æ•°attr()å’Œprop()çš„åŠŸèƒ½éƒ½æ˜¯é€šè¿‡JSåŽŸç”Ÿçš„Elementå¯¹è±¡ï¼ˆå¦‚ä¸Šè¿°ä»£ç ä¸­çš„msgï¼‰å®žçŽ°çš„ã€‚attr()å‡½æ•°ä¸»è¦ä¾èµ–çš„æ˜¯Elementå¯¹è±¡çš„getAttribute()å’ŒsetAttribute()ä¸¤ä¸ªæ–¹æ³•ã€‚prop()å‡½æ•°ä¸»è¦ä¾èµ–çš„åˆ™æ˜¯JSä¸­åŽŸç”Ÿçš„å¯¹è±¡å±žæ€§èŽ·å–å’Œè®¾ç½®æ–¹å¼ã€‚1234567891011121314151617181920212223&lt;div id="message" class="test" data_id="123"&gt;&lt;/div&gt;&lt;script type="text/javascript"&gt;var msg = document.getElementById("message");var $msg = $(msg); /* attr()ä¾èµ–çš„æ˜¯Elementå¯¹è±¡çš„element.getAttribute( attribute ) * å’Œ element.setAttribute( attribute, value ) */ // ç›¸å½“äºŽ msg.setAttribute("data_id", 145);$msg.attr("data_id", 145);// ç›¸å½“äºŽ msg.getAttribute("data_id");var dataId = $msg.attr("data_id"); // 145 /* prop()ä¾èµ–çš„æ˜¯JSåŽŸç”Ÿçš„ element[property] * å’Œ element[property] = value; */ // ç›¸å½“äºŽ msg["pid"] = "pidå€¼";$msg.prop("pid", "pidå€¼");// ç›¸å½“äºŽ msg["pid"];var testProp = $msg.prop("pid"); // pidå€¼&lt;/script&gt;å½“ç„¶ï¼ŒjQueryå¯¹è¿™äº›æ“ä½œæ–¹å¼è¿›è¡Œäº†å°è£…ï¼Œä½¿æˆ‘ä»¬æ“ä½œèµ·æ¥æ›´åŠ æ–¹ä¾¿(æ¯”å¦‚ä»¥å¯¹è±¡å½¢å¼åŒæ—¶è®¾ç½®å¤šä¸ªå±žæ€§)ï¼Œå¹¶ä¸”å®žçŽ°äº†è·¨æµè§ˆå™¨å…¼å®¹ã€‚æ­¤å¤–ï¼Œè™½ç„¶prop()é’ˆå¯¹çš„æ˜¯DOMå…ƒç´ çš„propertyï¼Œè€Œä¸æ˜¯å…ƒç´ èŠ‚ç‚¹çš„attributeã€‚ä¸è¿‡DOMå…ƒç´ æŸäº›å±žæ€§çš„æ›´æ”¹ä¹Ÿä¼šå½±å“åˆ°å…ƒç´ èŠ‚ç‚¹ä¸Šå¯¹åº”çš„å±žæ€§ã€‚ä¾‹å¦‚ï¼Œpropertyçš„idå¯¹åº”attributeçš„idï¼Œpropertyçš„classNameå¯¹åº”attributeçš„classã€‚12345678910&lt;div id="message" class="test" data_id="123"&gt;&lt;/div&gt;&lt;script type="text/javascript"&gt;var msg = document.getElementById("message");var $msg = $(msg); console.log( $msg.attr("class") ); // test$msg.prop("className", "newTest");// ä¿®æ”¹className(property)å¯¼è‡´class(attitude)ä¹Ÿéšä¹‹æ›´æ”¹console.log( $msg.attr("class") ); // newTest&lt;/script&gt;åº”ç”¨ç‰ˆæœ¬ä¸åŒattr()æ˜¯jQuery 1.0ç‰ˆæœ¬å°±æœ‰çš„å‡½æ•°ï¼Œprop()æ˜¯jQuery 1.6ç‰ˆæœ¬æ–°å¢žçš„å‡½æ•°ã€‚æ¯«æ— ç–‘é—®ï¼Œåœ¨1.6ä¹‹å‰ï¼Œä½ åªèƒ½ä½¿ç”¨attr()å‡½æ•°ï¼›1.6åŠä»¥åŽç‰ˆæœ¬ï¼Œä½ å¯ä»¥æ ¹æ®å®žé™…éœ€è¦é€‰æ‹©å¯¹åº”çš„å‡½æ•°ã€‚ç”¨äºŽè®¾ç½®çš„å±žæ€§å€¼ç±»åž‹ä¸åŒç”±äºŽattr()å‡½æ•°æ“ä½œçš„æ˜¯æ–‡æ¡£èŠ‚ç‚¹çš„å±žæ€§ï¼Œå› æ­¤è®¾ç½®çš„å±žæ€§å€¼åªèƒ½æ˜¯å­—ç¬¦ä¸²ç±»åž‹ï¼Œå¦‚æžœä¸æ˜¯å­—ç¬¦ä¸²ç±»åž‹ï¼Œä¹Ÿä¼šè°ƒç”¨å…¶toString()æ–¹æ³•ï¼Œå°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²ç±»åž‹ã€‚ prop()å‡½æ•°æ“ä½œçš„æ˜¯JSå¯¹è±¡çš„å±žæ€§ï¼Œå› æ­¤è®¾ç½®çš„å±žæ€§å€¼å¯ä»¥ä¸ºåŒ…æ‹¬æ•°ç»„å’Œå¯¹è±¡åœ¨å†…çš„ä»»æ„ç±»åž‹ã€‚123456789101112&lt;input id="uid" type="checkbox" checked="true" value="1"&gt;&lt;script type="text/javascript"&gt;// å½“å‰jQueryç‰ˆæœ¬ä¸º1.11.1var uid = document.getElementById("uid");var $uid = $(uid); console.log($uid.attr("checked")); // checkedconsole.log(typeof $uid.attr("checked")); // string console.log($uid.prop("checked")); // trueconsole.log(typeof $uid.prop("checked")); //boolean&lt;/script&gt;å…¶ä»–ç»†èŠ‚é—®é¢˜åœ¨jQuery 1.6ä¹‹å‰ï¼Œåªæœ‰attr()å‡½æ•°å¯ç”¨ï¼Œè¯¥å‡½æ•°ä¸ä»…æ‰¿æ‹…äº†attributeçš„è®¾ç½®å’ŒèŽ·å–å·¥ä½œï¼Œè¿˜åŒæ—¶æ‰¿æ‹…äº†propertyçš„è®¾ç½®å’ŒèŽ·å–å·¥ä½œã€‚ä¾‹å¦‚ï¼šåœ¨jQuery 1.6ä¹‹å‰ï¼Œattr()ä¹Ÿå¯ä»¥è®¾ç½®æˆ–èŽ·å–tagNameã€classNameã€nodeNameã€nodeTypeç­‰DOMå…ƒç´ çš„propertyã€‚ç›´åˆ°jQuery 1.6æ–°å¢žprop()å‡½æ•°ï¼Œå¹¶ç”¨æ¥æ‰¿æ‹…propertyçš„è®¾ç½®æˆ–èŽ·å–å·¥ä½œä¹‹åŽï¼Œattr()æ‰åªç”¨æ¥è´Ÿè´£attributeçš„è®¾ç½®å’ŒèŽ·å–å·¥ä½œã€‚æ­¤å¤–ï¼Œå¯¹äºŽè¡¨å•å…ƒç´ çš„checkedã€selectedã€disabledç­‰å±žæ€§ï¼Œåœ¨jQuery 1.6ä¹‹å‰ï¼Œattr()èŽ·å–è¿™äº›å±žæ€§çš„è¿”å›žå€¼ä¸ºBooleanç±»åž‹ï¼šå¦‚æžœè¢«é€‰ä¸­ï¼ˆæˆ–ç¦ç”¨ï¼‰å°±è¿”å›žtrueï¼Œå¦åˆ™è¿”å›žfalseã€‚ä½†æ˜¯ä»Ž1.6å¼€å§‹ï¼Œä½¿ç”¨attr()èŽ·å–è¿™äº›å±žæ€§çš„è¿”å›žå€¼ä¸ºStringç±»åž‹ï¼Œå¦‚æžœè¢«é€‰ä¸­ï¼ˆæˆ–ç¦ç”¨ï¼‰å°±è¿”å›žcheckedã€selectedæˆ–disabledï¼Œå¦åˆ™ï¼ˆå³å…ƒç´ èŠ‚ç‚¹æ²¡æœ‰è¯¥å±žæ€§ï¼‰è¿”å›žundefinedã€‚å¹¶ä¸”ï¼Œåœ¨æŸäº›ç‰ˆæœ¬ä¸­ï¼Œè¿™äº›å±žæ€§å€¼è¡¨ç¤ºæ–‡æ¡£åŠ è½½æ—¶çš„åˆå§‹çŠ¶æ€å€¼ï¼Œå³ä½¿ä¹‹åŽæ›´æ”¹äº†è¿™äº›å…ƒç´ çš„é€‰ä¸­ï¼ˆæˆ–ç¦ç”¨ï¼‰çŠ¶æ€ï¼Œå¯¹åº”çš„å±žæ€§å€¼ä¹Ÿä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚å› ä¸ºjQueryè®¤ä¸ºï¼šattributeçš„checkedã€selectedã€disabledå°±æ˜¯è¡¨ç¤ºè¯¥å±žæ€§åˆå§‹çŠ¶æ€çš„å€¼ï¼Œpropertyçš„checkedã€selectedã€disabledæ‰è¡¨ç¤ºè¯¥å±žæ€§å®žæ—¶çŠ¶æ€çš„å€¼ï¼ˆå€¼ä¸ºtrueæˆ–falseï¼‰ã€‚å› æ­¤ï¼Œåœ¨jQuery 1.6åŠä»¥åŽç‰ˆæœ¬ä¸­ï¼Œè¯·ä½¿ç”¨prop()å‡½æ•°æ¥è®¾ç½®æˆ–èŽ·å–checkedã€selectedã€disabledç­‰å±žæ€§ã€‚å¯¹äºŽå…¶å®ƒèƒ½å¤Ÿç”¨prop()å®žçŽ°çš„æ“ä½œï¼Œä¹Ÿå°½é‡ä½¿ç”¨prop()å‡½æ•°ã€‚12345678910111213141516171819&lt;input id="uid" type="checkbox" checked="checked" value="1"&gt; &lt;script type="text/javascript"&gt;// å½“å‰jQueryç‰ˆæœ¬ä¸º1.11.1var uid = document.getElementById("uid");var $uid = $(uid); console.log( $uid.attr("checked") ); // checkedconsole.log( $uid.prop("checked") ); // true // å–æ¶ˆå¤é€‰æ¡†uidçš„é€‰ä¸­(å°†å…¶è®¾ä¸ºfalseå³å¯)// ç›¸å½“äºŽ uid.checked = false;$uid.prop("checked", false); // attr()èŽ·å–çš„æ˜¯åˆå§‹çŠ¶æ€çš„å€¼ï¼Œå³ä½¿å–æ¶ˆäº†é€‰ä¸­ï¼Œä¹Ÿä¸ä¼šæ”¹å˜console.log( $uid.attr("checked") ); // checked// prop()èŽ·å–çš„å€¼å·²ç»å‘ç”Ÿå˜åŒ–console.log( $uid.prop("checked") ); // false&lt;/script&gt;è½¬è‡ªCodePlayer]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[viç¼–è¾‘å™¨çš„ä¸‰ç§æ¨¡å¼]]></title>
    <url>%2Fvi%E7%BC%96%E8%BE%91%E5%99%A8%E7%9A%84%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%BC%8F.html</url>
    <content type="text"><![CDATA[é€šå¸¸æ¥è¯´ï¼Œviç¼–è¾‘å™¨æœ‰ä¸‰ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯ä¸€èˆ¬æŒ‡ä»¤æ¨¡å¼ã€ç¼–è¾‘æ¨¡å¼ä¸ŽæŒ‡ä»¤è¡Œå‘½ä»¤æ¨¡å¼ã€‚ è¿™ä¸‰ç§æ¨¡å¼çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼šä¸€èˆ¬æŒ‡ä»¤æ¨¡å¼ï¼ˆcommand modeï¼‰ä»¥ vi æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å°±ç›´æŽ¥è¿›å…¥ä¸€èˆ¬æŒ‡ä»¤æ¨¡å¼äº†ï¼ˆè¿™æ˜¯é»˜è®¤çš„æ¨¡å¼ï¼Œä¹Ÿç®€ç§°ä¸ºä¸€èˆ¬æ¨¡å¼ï¼‰ã€‚åœ¨è¿™ä¸ªæ¨¡å¼ä¸­ï¼Œ ä½ å¯ä»¥ä½¿ç”¨ä¸Šä¸‹å·¦å³æŒ‰é”®æ¥ç§»åŠ¨å…‰æ ‡ï¼Œä½ å¯ä»¥ä½¿ç”¨åˆ é™¤å­—ç¬¦æˆ–åˆ é™¤æ•´è¡Œæ¥å¤„ç†æ–‡ä»¶å†…å®¹ï¼Œ ä¹Ÿå¯ä»¥ä½¿ç”¨å¤åˆ¶ã€é»è´´æ¥å¤„ç†ä½ çš„æ–‡ä»¶æ•°æ®ã€‚ç¼–è¾‘æ¨¡å¼ï¼ˆinsert modeï¼‰ç¼–è¾‘æ¨¡å¼å¯ä»¥å¯¹å†…å®¹è¿›è¡Œç¼–è¾‘ï¼ŒæŒ‰ä¸‹i, I, o, O, a, A, r, Rç­‰ä»»ä½•ä¸€ä¸ªå­—æ¯ä¹‹åŽå³å¯è¿›å…¥ç¼–è¾‘æ¨¡å¼ã€‚å¦‚æžœè¦å›žåˆ°ä¸€èˆ¬æŒ‡ä»¤æ¨¡å¼æ—¶ï¼Œ åˆ™å¿…é¡»è¦æŒ‰ä¸‹Escè¿™ä¸ªæŒ‰é”®å³å¯é€€å‡ºç¼–è¾‘æ¨¡å¼ã€‚å‘½ä»¤è¡Œæ¨¡å¼ï¼ˆcommand-line modeï¼‰åœ¨ä¸€èˆ¬æ¨¡å¼å½“ä¸­ï¼Œè¾“å…¥:, /, ? ä¸‰ä¸ªä¸­çš„ä»»ä½•ä¸€ä¸ªæŒ‰é’®ï¼Œå°±å¯ä»¥å°†å…‰æ ‡ç§»åŠ¨åˆ°æœ€åº•ä¸‹é‚£ä¸€è¡Œã€‚åœ¨è¿™ä¸ªæ¨¡å¼å½“ä¸­ï¼Œ å¯ä»¥æä¾›ä½ æœå¯»èµ„æ–™çš„åŠ¨ä½œï¼Œè€Œè¯»å–ã€å­˜ç›˜ã€å¤§é‡å–ä»£å­—ç¬¦ã€ç¦»å¼€ vi ã€æ˜¾ç¤ºè¡Œå·ç­‰ç­‰çš„åŠ¨ä½œåˆ™æ˜¯åœ¨æ­¤æ¨¡å¼ä¸­è¾¾æˆçš„ï¼ æ€»ä¹‹ï¼Œä¸‰è€…çš„å…³ç³»å¯ä»¥ç”¨ä¸‹å›¾æ¥æ¦‚å†µï¼šå„æ¨¡å¼ä¸‹çš„å¿«æ·é”®ä¸€èˆ¬æŒ‡ä»¤æ¨¡å¼ç§»åŠ¨å…‰æ ‡çš„æ–¹æ³•h æˆ– å‘å·¦ç®­å¤´é”®(â†)å…‰æ ‡å‘å·¦ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦j æˆ– å‘ä¸‹ç®­å¤´é”®(â†“)å…‰æ ‡å‘ä¸‹ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦k æˆ– å‘ä¸Šç®­å¤´é”®(â†‘)å…‰æ ‡å‘ä¸Šç§»åŠ¨ä¸€ä¸ªå­—ç¬¦l æˆ– å‘å³ç®­å¤´é”®(â†’)å…‰æ ‡å‘å³ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦hjkl æ˜¯æŽ’åˆ—åœ¨ä¸€èµ·çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨è¿™å››ä¸ªæŒ‰é’®æ¥ç§»åŠ¨å…‰æ ‡ã€‚ å¦‚æžœæƒ³è¦è¿›è¡Œå¤šæ¬¡ç§»åŠ¨çš„è¯ï¼Œä¾‹å¦‚å‘ä¸‹ç§»åŠ¨ 30 è¡Œï¼Œå¯ä»¥ ä½¿ç”¨ â€œ30jâ€ æˆ– â€œ30â†“â€ çš„ç»„åˆæŒ‰é”®ï¼Œäº¦å³åŠ ä¸Šæƒ³è¦è¿›è¡Œçš„æ¬¡æ•°ï¼ˆæ•°å­—ï¼‰åŽï¼ŒæŒ‰ä¸‹åŠ¨ä½œå³å¯ï¼[Ctrl] + [f]å±å¹•å‘ä¸‹ç§»åŠ¨ä¸€é¡µï¼Œç›¸å½“äºŽ [Page Down]æŒ‰é”®[Ctrl] + [b]å±å¹•å‘ä¸Šç§»åŠ¨ä¸€é¡µï¼Œç›¸å½“äºŽ [Page Up] æŒ‰é”®&nbsp;[Ctrl] + [d]&nbsp;å±å¹•å‘ä¸‹ç§»åŠ¨åŠé¡µ[Ctrl] + [u]&nbsp;å±å¹•å‘ä¸Šç§»åŠ¨åŠé¡µn&lt;space&gt;n è¡¨ç¤ºæ•°å­—ï¼Œä¾‹å¦‚ 20 ã€‚æŒ‰ä¸‹æ•°å­—åŽå†æŒ‰ç©ºæ ¼é”®ï¼Œå…‰æ ‡ä¼šå‘å³ç§»åŠ¨è¿™ä¸€è¡Œçš„ n ä¸ª å­—ç¬¦ã€‚ä¾‹å¦‚ 20 åˆ™å…‰æ ‡ä¼šå‘åŽé¢ç§»åŠ¨ 20 ä¸ªå­—ç¬¦è·ç¦»ã€‚0 æˆ–åŠŸèƒ½é”®[Home]ç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€å‰é¢å­—ç¬¦å¤„$ æˆ–åŠŸèƒ½é”®[End]&nbsp;ç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€åŽé¢å­—ç¬¦å¤„H &nbsp;&nbsp;å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„æœ€ä¸Šæ–¹é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦M&nbsp;å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„ä¸­å¤®é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦L&nbsp;å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„æœ€ä¸‹æ–¹é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦Gç§»åŠ¨åˆ°è¿™ä¸ªæ–‡ä»¶çš„æœ€åŽä¸€è¡ŒnGn ä¸ºæ•°å­—ã€‚ç§»åŠ¨åˆ°è¿™ä¸ªæ–‡ä»¶çš„ç¬¬ n è¡Œã€‚ä¾‹å¦‚ 20G åˆ™ä¼šç§»åŠ¨åˆ°è¿™ä¸ªæ–‡ä»¶çš„ç¬¬ 20 è¡Œgg &nbsp;ç§»åŠ¨åˆ°è¿™ä¸ªæ–‡ä»¶çš„ç¬¬ä¸€è¡Œn&lt;Enter&gt;&nbsp;n ä¸ºæ•°å­—ã€‚å…‰æ ‡å‘ä¸‹ç§»åŠ¨ n è¡Œæœç´¢ä¸Žæ›¿æ¢/word&nbsp;å‘å…‰æ ‡ä¹‹ä¸‹å¯»æ‰¾ä¸€ä¸ªåç§°ä¸º word çš„å­—ç¬¦ä¸²?word&nbsp;å‘å…‰æ ‡ä¹‹ä¸Šå¯»æ‰¾ä¸€ä¸ªå­—ç¬¦ä¸²åç§°ä¸º word çš„å­—ç¬¦ä¸²n&nbsp;é‡å¤å‰ä¸€ä¸ªæœå¯»çš„åŠ¨ä½œN&nbsp;ä¸Ž n åˆšå¥½ç›¸åï¼Œä¸ºåå‘è¿›è¡Œå‰ä¸€ä¸ªæœå¯»åŠ¨ä½œã€‚ ä¾‹å¦‚ /word åŽï¼ŒæŒ‰ä¸‹ N åˆ™è¡¨ç¤º ?word:n1,n2s/word1/word2/gn1 ä¸Ž n2 ä¸ºæ•°å­—ã€‚åœ¨ç¬¬ n1 ä¸Ž n2 è¡Œä¹‹é—´å¯»æ‰¾ word1 è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å–ä»£ ä¸º word2 ï¼Œ æ¯”å¦‚ï¼šåœ¨ 100 åˆ° 200 è¡Œä¹‹é—´æœå¯» nullå¹¶å–ä»£ä¸º NULL&nbsp;åˆ™ :100,200s/null/NULL/g:1,$s/word1/word2/g&nbsp;ä»Žç¬¬ä¸€è¡Œåˆ°æœ€åŽä¸€è¡Œå¯»æ‰¾ word1 å­—ç¬¦ä¸²ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å–ä»£ä¸º word2&nbsp;:1,$s/word1/word2/gc&nbsp;ä»Žç¬¬ä¸€è¡Œåˆ°æœ€åŽä¸€è¡Œå¯»æ‰¾ word1 å­—ç¬¦ä¸²ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å–ä»£ä¸º word2 ã€‚ä¸”åœ¨å–ä»£å‰æ˜¾ç¤ºæç¤ºå­—ç¬¦ ç»™ç”¨æˆ·ç¡®è®¤ (confirm) æ˜¯å¦éœ€è¦å–ä»£åˆ é™¤ï¼Œå¤åˆ¶ä¸Žé»è´´x, X&nbsp;åœ¨ä¸€è¡Œå­—å½“ä¸­ï¼Œx ä¸ºå‘åŽåˆ é™¤ä¸€ä¸ªå­—ç¬¦ï¼Œ X ä¸ºå‘å‰åˆ é™¤ä¸€ä¸ªå­—ç¬¦nx&nbsp;nä¸ºæ•°å­—ï¼Œè¿žç»­å‘åŽåˆ é™¤ n ä¸ªå­—ç¬¦dd&nbsp;åˆ é™¤æ¸¸æ ‡æ‰€åœ¨çš„é‚£ä¸€æ•´è¡Œndd&nbsp;n ä¸ºæ•°å­—ã€‚åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„å‘ä¸‹ n è¡Œï¼Œä¾‹å¦‚ 20dd åˆ™æ˜¯åˆ é™¤ 20 è¡Œd1G&nbsp;åˆ é™¤å…‰æ ‡æ‰€åœ¨åˆ°ç¬¬ä¸€è¡Œçš„æ‰€æœ‰æ•°æ®dGåˆ é™¤å…‰æ ‡æ‰€åœ¨åˆ°æœ€åŽä¸€è¡Œçš„æ‰€æœ‰æ•°æ®d$&nbsp;åˆ é™¤æ¸¸æ ‡æ‰€åœ¨å¤„ï¼Œåˆ°è¯¥è¡Œçš„æœ€åŽä¸€ä¸ªå­—ç¬¦d0&nbsp;åˆ é™¤æ¸¸æ ‡æ‰€åœ¨å¤„ï¼Œåˆ°è¯¥è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦yy&nbsp;å¤åˆ¶æ¸¸æ ‡æ‰€åœ¨çš„é‚£ä¸€è¡Œnyy&nbsp;n ä¸ºæ•°å­—ã€‚å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„å‘ä¸‹ n è¡Œï¼Œä¾‹å¦‚ 20yy åˆ™æ˜¯å¤åˆ¶ 20 è¡Œy1G&nbsp;å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œåˆ°ç¬¬ä¸€è¡Œçš„æ‰€æœ‰æ•°æ®yG&nbsp;å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œåˆ°æœ€åŽä¸€è¡Œçš„æ‰€æœ‰æ•°æ®y0&nbsp;å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸ªå­—ç¬¦åˆ°è¯¥è¡Œè¡Œé¦–çš„æ‰€æœ‰æ•°æ®y$&nbsp;å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸ªå­—ç¬¦åˆ°è¯¥è¡Œè¡Œå°¾çš„æ‰€æœ‰æ•°æ®p, P&nbsp;p ä¸ºå°†å·²å¤åˆ¶çš„æ•°æ®é»è´´åˆ°å…‰æ ‡ä¸‹ä¸€è¡Œï¼ŒP åˆ™ä¸ºé»è´´åˆ°ä¸Šä¸€è¡ŒJ&nbsp;å°†å…‰æ ‡æ‰€åœ¨è¡Œä¸Žä¸‹ä¸€è¡Œçš„æ•°æ®ç»“åˆæˆåŒä¸€è¡Œu&nbsp;å›žé€€ï¼Œç±»ä¼¼äºŽCtrl+z[Ctrl]+r&nbsp;å‰è¿›ï¼Œç±»ä¼¼äºŽCtrl+y.é‡å¤å‰ä¸€ä¸ªåŠ¨ä½œã€‚ å¦‚æžœä½ æƒ³è¦é‡å¤åˆ é™¤ã€é‡å¤é»è´´ç­‰åŠ¨ä½œï¼ŒæŒ‰ä¸‹å°æ•°ç‚¹.å°±å¥½äº†ä¸€èˆ¬æŒ‡ä»¤æ¨¡å¼åˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼çš„å¯ç”¨çš„å¿«æ·é”®è¿›å…¥INSERTæˆ–REPLACEæ¨¡å¼i, I &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;è¿›å…¥æ’å…¥æ¨¡å¼(Insert mode)ï¼š i ä¸ºä»Žç›®å‰å…‰æ ‡æ‰€åœ¨å¤„æ’å…¥ï¼ŒI ä¸ºåœ¨ç›®å‰æ‰€åœ¨è¡Œçš„ç¬¬ä¸€ä¸ªéžç©ºæ ¼ç¬¦å¤„å¼€å§‹æ’å…¥a, A&nbsp;è¿›å…¥æ’å…¥æ¨¡å¼(Insert mode)ï¼š a ä¸ºä»Žç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹æ’å…¥ï¼Œ A ä¸ºä»Žå…‰æ ‡æ‰€åœ¨è¡Œçš„æœ€åŽä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹æ’å…¥o, O&nbsp;è¿›å…¥æ’å…¥æ¨¡å¼(Insert mode)ï¼š o ä¸ºåœ¨ç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹ä¸€è¡Œå¤„æ’å…¥æ–°çš„ä¸€è¡Œï¼› O ä¸ºåœ¨ç›®å‰å…‰æ ‡æ‰€åœ¨å¤„çš„ä¸Šä¸€è¡Œæ’å…¥æ–°çš„ä¸€è¡Œr, R&nbsp;è¿›å…¥å–ä»£æ¨¡å¼(Replace mode)ï¼š r åªä¼šå–ä»£å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸€ä¸ªå­—ç¬¦ä¸€æ¬¡ï¼›R ä¼šä¸€ç›´å–ä»£å…‰æ ‡æ‰€åœ¨çš„æ–‡å­—ï¼Œç›´åˆ°æŒ‰ä¸‹ ESC ä¸ºæ­¢[Esc]&nbsp;é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œå›žåˆ°ä¸€èˆ¬æŒ‡ä»¤æ¨¡å¼ä¸­ä¸€èˆ¬æŒ‡ä»¤æ¨¡å¼åˆ‡æ¢åˆ°å‘½ä»¤è¡Œæ¨¡å¼å¯ç”¨çš„å¿«æ·é”®å‘½ä»¤è¡Œæ¨¡å¼çš„å­˜å‚¨ï¼Œç¦»å¼€ç­‰æŒ‡ä»¤:w &nbsp; &nbsp;&nbsp;å°†ç¼–è¾‘çš„æ•°æ®å†™å…¥ç¡¬ç›˜æ–‡ä»¶ä¸­ï¼ˆä¿å­˜ï¼‰:w!&nbsp;è‹¥æ–‡ä»¶å±žæ€§ä¸ºåªè¯»æ—¶ï¼Œå¼ºåˆ¶å†™å…¥è¯¥æ–‡ä»¶ã€‚ä¸è¿‡ï¼Œåˆ°åº•èƒ½ä¸èƒ½å†™å…¥ï¼Œè¿˜æ˜¯è·Ÿä½ å¯¹è¯¥æ–‡ä»¶çš„æ–‡ä»¶æƒé™æœ‰å…³:q &nbsp;ç¦»å¼€ vi:q!&nbsp;è‹¥æ›¾ä¿®æ”¹è¿‡æ–‡ä»¶ï¼Œåˆä¸æƒ³å‚¨å­˜ï¼Œä½¿ç”¨ ! ä¸ºå¼ºåˆ¶ç¦»å¼€ä¸å‚¨å­˜æ–‡ä»¶:wq&nbsp;å‚¨å­˜åŽç¦»å¼€ï¼Œè‹¥ä¸º :wq! åˆ™ä¸ºå¼ºåˆ¶å‚¨å­˜åŽç¦»å¼€ZZ&nbsp;è‹¥æ–‡ä»¶æ²¡æœ‰æ›´åŠ¨ï¼Œåˆ™ä¸å‚¨å­˜ç¦»å¼€ï¼Œè‹¥æ–‡ä»¶å·²ç»è¢«æ›´åŠ¨è¿‡ï¼Œåˆ™å‚¨å­˜åŽç¦»å¼€ï¼:w filenameå°†ç¼–è¾‘çš„æ•°æ®å‚¨å­˜æˆå¦ä¸€ä¸ªæ–‡ä»¶:r filenameåœ¨ç¼–è¾‘çš„æ•°æ®ä¸­ï¼Œè¯»å…¥å¦ä¸€ä¸ªæ–‡ä»¶çš„æ•°æ®ã€‚äº¦å³å°†filenameè¿™ä¸ªæ–‡ä»¶å†…å®¹åŠ åˆ°æ¸¸æ ‡æ‰€åœ¨è¡ŒåŽé¢:n1,n2 w filename&nbsp;å°† n1 åˆ° n2 çš„å†…å®¹å‚¨å­˜æˆ filename è¿™ä¸ªæ–‡ä»¶:! command&nbsp;æš‚æ—¶ç¦»å¼€ vi åˆ°æŒ‡ä»¤è¡Œæ¨¡å¼ä¸‹æ‰§è¡Œ command çš„æ˜¾ç¤ºç»“æžœã€‚ä¾‹å¦‚ :! ls /homeå³å¯åœ¨ vi å½“ä¸­å¯Ÿçœ‹ /home åº•ä¸‹ä»¥ ls è¾“å‡ºçš„æ–‡ä»¶ä¿¡æ¯vim çŽ¯å¢ƒçš„å˜æ›´:set nu&nbsp;æ˜¾ç¤ºè¡Œå·ï¼Œè®¾å®šä¹‹åŽï¼Œä¼šåœ¨æ¯ä¸€è¡Œçš„å‰ç¼€æ˜¾ç¤ºè¯¥è¡Œçš„è¡Œå·:set nonu&nbsp;ä¸Ž:set nu ç›¸åï¼Œä¸ºå–æ¶ˆè¡Œå·ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQueryæ•ˆæžœå‡½æ•°]]></title>
    <url>%2FjQuery%E6%95%88%E6%9E%9C%E5%87%BD%E6%95%B0.html</url>
    <content type="text"><![CDATA[åŸºæœ¬show()ç”¨äºŽæ˜¾ç¤ºæ‰€æœ‰åŒ¹é…çš„å…ƒç´ ã€‚æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥æŒ‡å®šå…ƒç´ æ˜¾ç¤ºçš„è¿‡æ¸¡åŠ¨ç”»æ•ˆæžœã€‚ å¦‚æžœå…ƒç´ æœ¬èº«æ˜¯å¯è§çš„ï¼Œåˆ™ä¸å¯¹å…¶ä½œä»»ä½•æ”¹å˜ã€‚å¦‚æžœå…ƒç´ æ˜¯éšè—çš„ï¼Œåˆ™ä½¿å…¶å¯è§ã€‚ å¸¸ç”¨è¯­æ³•ï¼šjQueryObject.show( [ duration ] [, easing ] [, complete ] )ã€‚å‚æ•°æè¿°durationå¯é€‰/String/Numberç±»åž‹æŒ‡å®šè¿‡æ¸¡åŠ¨ç”»è¿è¡Œå¤šé•¿æ—¶é—´ï¼ˆæ¯«ç§’æ•°ï¼‰ï¼Œé»˜è®¤å€¼ä¸º400ã€‚è¯¥å‚æ•°ä¹Ÿå¯ä»¥ä¸ºå­—ç¬¦ä¸²â€fastâ€ï¼ˆ=200ï¼‰æˆ–â€slowâ€ï¼ˆ=600ï¼‰ã€‚easingå¯é€‰/Stringç±»åž‹æŒ‡å®šä½¿ç”¨ä½•ç§åŠ¨ç”»æ•ˆæžœï¼Œé»˜è®¤ä¸ºâ€swingâ€ï¼Œè¿˜å¯ä»¥è®¾ä¸ºâ€linearâ€æˆ–å…¶ä»–è‡ªå®šä¹‰çš„åŠ¨ç”»æ ·å¼çš„å‡½æ•°åç§°ã€‚completeå¯é€‰/Functionç±»åž‹å…ƒç´ æ˜¾ç¤ºå®Œæ¯•åŽéœ€è¦æ‰§è¡Œçš„å‡½æ•°ã€‚å‡½æ•°å†…çš„ thisæŒ‡å‘å½“å‰DOMå…ƒç´ ã€‚ æ¯”å¦‚æ˜¾ç¤ºpå…ƒç´ ï¼Œè¿‡æ¸¡åŠ¨ç”»ä¸º600msï¼š12$("p").show(600); // æˆ–è€… $("p").show("slow"); $("p").show( &#123; duration: 1000 &#125; );æ˜¾ç¤ºpå…ƒç´ ï¼Œè¿‡åº¦åŠ¨ç”»ä¸º200msï¼ŒåŠ¨ç”»æ•ˆæžœä¸ºlinearï¼š1$("p").show(600,"linear");æ˜¾ç¤ºpå…ƒç´ ï¼Œå¹¶æ·»åŠ å›žè°ƒå‡½æ•°ï¼š1$("p").show(function()&#123; alert('æ˜¾ç¤ºå®Œæ¯•') &#125;);hide()ç”¨äºŽéšè—æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ã€‚ä½œç”¨å’Œshow()ç›¸åï¼Œè¯­æ³•ä¸€æ ·ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚ ä¾‹å¦‚éšè—på…ƒç´ ï¼ŒåŠ¨ç”»é€Ÿåº¦ä¸ºfastï¼Œå¹¶æ·»åŠ å›žè°ƒï¼š1$("p").hide("fast",function()&#123; alert('éšè—å®Œæ¯•') &#125;);æ»‘åŠ¨slideDown()ç”¨äºŽæ˜¾ç¤ºæ‰€æœ‰åŒ¹é…çš„å…ƒç´ ï¼Œå¹¶å¸¦æœ‰å‘ä¸‹æ»‘åŠ¨çš„è¿‡æ¸¡åŠ¨ç”»æ•ˆæžœã€‚ å‘ä¸‹æ»‘åŠ¨çš„åŠ¨ç”»æ•ˆæžœï¼Œå³å…ƒç´ å¯è§åŒºåŸŸçš„é«˜åº¦ä»Ž0é€æ¸å¢žå¤§åˆ°å…¶åŽŸæœ‰é«˜åº¦(å‘ä¸‹é€æ¸å±•å¼€)ã€‚ å¦‚æžœå…ƒç´ æœ¬èº«æ˜¯å¯è§çš„ï¼Œåˆ™ä¸å¯¹å…¶ä½œä»»ä½•æ”¹å˜ã€‚å¦‚æžœå…ƒç´ æ˜¯éšè—çš„ï¼Œåˆ™ä½¿å…¶å¯è§ã€‚ è¯­æ³•å’Œshow()ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ã€‚slideUp()æ•ˆæžœå’ŒslideUp()ç›¸åï¼Œè¯­æ³•ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ã€‚slideToggle()ç”¨äºŽåˆ‡æ¢æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ï¼Œå¹¶å¸¦æœ‰æ»‘åŠ¨çš„è¿‡æ¸¡åŠ¨ç”»æ•ˆæžœã€‚ æ‰€è°“â€åˆ‡æ¢â€ï¼Œä¹Ÿå°±æ˜¯å¦‚æžœå…ƒç´ å½“å‰æ˜¯å¯è§çš„ï¼Œåˆ™å°†å…¶éšè—ï¼ˆå‘ä¸Šæ»‘åŠ¨ï¼‰ï¼›å¦‚æžœå…ƒç´ å½“å‰æ˜¯éšè—çš„ï¼Œåˆ™ä½¿å…¶æ˜¾ç¤ºï¼ˆå‘ä¸‹æ»‘åŠ¨ï¼‰ã€‚ è¯­æ³•å’Œshow()ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ã€‚ ä¾‹å¦‚ï¼Œå‘ä¸Šæˆ–å‘ä¸‹æ»‘åŠ¨ä¸‹æ‹‰æ¡†divå…ƒç´ ï¼Œå¹¶æ·»åŠ å›žè°ƒï¼š12345678$("div").slideToggle(function()&#123; var $this = $(this); if($this.is(":visible"))&#123; alert("å‘ä¸‹æ»‘åŠ¨å±•å¼€"); &#125;else&#123; alert("å‘ä¸Šæ»‘åŠ¨éšè—"); &#125;&#125;);æ·¡å…¥æ·¡å‡ºfadeIn()ç”¨äºŽæ˜¾ç¤ºæ‰€æœ‰åŒ¹é…çš„å…ƒç´ ï¼Œå¹¶å¸¦æœ‰æ·¡å…¥çš„è¿‡æ¸¡åŠ¨ç”»æ•ˆæžœã€‚ æ·¡å…¥çš„åŠ¨ç”»æ•ˆæžœï¼Œå³å…ƒç´ çš„ä¸é€æ˜Žåº¦çš„æ¯”ä¾‹ä»Ž0%é€æ¸å¢žåŠ åˆ°100%ã€‚ å¦‚æžœå…ƒç´ æœ¬èº«æ˜¯å¯è§çš„ï¼Œåˆ™ä¸å¯¹å…¶ä½œä»»ä½•æ”¹å˜ã€‚å¦‚æžœå…ƒç´ æ˜¯éšè—çš„ï¼Œåˆ™ä½¿å…¶å¯è§ã€‚ è¯­æ³•å’Œshow()ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ã€‚fadeOut()ç”¨äºŽéšè—æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ï¼Œå¹¶å¸¦æœ‰æ·¡å‡ºçš„è¿‡æ¸¡åŠ¨ç”»æ•ˆæžœã€‚æ•ˆæžœå’ŒfadeIn()ç›¸åï¼Œè¯­æ³•å’Œshow()ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ã€‚fadeTo()ä»¥æ¸è¿›çš„æ–¹å¼æŠŠå…ƒç´ ä»Žå½“å‰é€æ˜Žçš„è¿‡æ¸¡åˆ°æŒ‡å®šçš„é€æ˜Žåº¦ã€‚å¯ä»¥æŒ‡å®šè¿‡æ¸¡æ—¶é•¿ï¼Œç›®æ ‡é€æ˜Žåº¦ï¼Œå›žè°ƒå‡½æ•°ç­‰ã€‚ å¸¸ç”¨è¯­æ³•ï¼šfadeTo(duration,opacity [,complete])ã€‚ ä¾‹å¦‚ï¼Œå°†på…ƒç´ çš„é€æ˜Žçš„è°ƒæ•´ä¸º.5ï¼Œæ—¶é•¿200msï¼Œå¹¶æ·»åŠ å›žè°ƒï¼š123$( "p" ).fadeTo( "slow" , 0.5, function() &#123; // Animation complete.&#125;);fadeToggle()ç”¨äºŽåˆ‡æ¢æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ï¼Œå¹¶å¸¦æœ‰æ·¡å…¥/æ·¡å‡ºçš„è¿‡æ¸¡åŠ¨ç”»æ•ˆæžœã€‚ æ‰€è°“â€åˆ‡æ¢â€ï¼Œå³å¦‚æžœå…ƒç´ å½“å‰æ˜¯å¯è§çš„ï¼Œåˆ™å°†å…¶éšè—ï¼ˆæ·¡å‡ºï¼‰ï¼›å¦‚æžœå…ƒç´ å½“å‰æ˜¯éšè—çš„ï¼Œåˆ™ä½¿å…¶æ˜¾ç¤ºï¼ˆæ·¡å…¥ï¼‰ã€‚è¯­æ³•å’Œshow()ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ã€‚è‡ªå®šä¹‰animate()ç”¨äºŽæ‰§è¡Œä¸€ä¸ªåŸºäºŽcsså±žæ€§çš„è‡ªå®šä¹‰åŠ¨ç”»ã€‚ ä½ å¯ä»¥ä¸ºåŒ¹é…çš„å…ƒç´ è®¾ç½®cssæ ·å¼ï¼Œanimate()å‡½æ•°å°†ä¼šæ‰§è¡Œä¸€ä¸ªä»Žå½“å‰æ ·å¼åˆ°æŒ‡å®šçš„cssæ ·å¼çš„ä¸€ä¸ªè¿‡æ¸¡åŠ¨ç”»ã€‚ å¸¸ç”¨è¯­æ³•ï¼šjQueryObject.animate( cssProperties [, duration ] [, easing ] [, complete ] )ã€‚å‚æ•°æè¿°cssPropertiesObjectç±»åž‹ä¸€ä¸ªæˆ–å¤šä¸ªcsså±žæ€§çš„é”®å€¼å¯¹æ‰€æž„æˆçš„Objectå¯¹è±¡ã€‚durationå¯é€‰/String/Numberç±»åž‹æŒ‡å®šåŠ¨ç”»è¿è¡Œå¤šé•¿æ—¶é—´ï¼ˆæ¯«ç§’æ•°ï¼‰ï¼Œé»˜è®¤å€¼ä¸º400ã€‚è¯¥å‚æ•°ä¹Ÿå¯ä»¥ä¸ºå­—ç¬¦ä¸²â€fastâ€ï¼ˆ=200ï¼‰æˆ–â€slowâ€ï¼ˆ=600ï¼‰ã€‚easingå¯é€‰/Stringç±»åž‹æŒ‡å®šä½¿ç”¨ä½•ç§åŠ¨ç”»æ•ˆæžœï¼Œé»˜è®¤ä¸ºâ€swingâ€ï¼Œè¿˜å¯ä»¥è®¾ä¸º â€œlinearâ€æˆ–å…¶ä»–è‡ªå®šä¹‰çš„åŠ¨ç”»æ ·å¼å‡½æ•°ã€‚completeå¯é€‰/Functionç±»åž‹å…ƒç´ æ˜¾ç¤ºå®Œæ¯•åŽéœ€è¦æ‰§è¡Œçš„å‡½æ•°ã€‚å‡½æ•°å†…çš„thisæŒ‡å‘å½“å‰DOMå…ƒç´ ã€‚å¤§å¤šæ•°éžæ•°å€¼çš„csså±žæ€§éƒ½æ— æ³•ç”¨æ¥æ‰§è¡ŒåŠ¨ç”»ã€‚ä¾‹å¦‚ï¼šwidthã€heightã€leftã€topéƒ½å¯ç”¨äºŽåŠ¨ç”»ï¼Œä½†colorã€background-coloræ— æ³•ç”¨äºŽåŠ¨ç”»ï¼ˆé™¤éžä½¿ç”¨jQuery.Color()æ’ä»¶ï¼‰ã€‚é™¤éžä½ ä¸ºå±žæ€§å€¼æŒ‡å®šäº†å•ä½ï¼ˆä¾‹å¦‚ï¼špxã€emã€%ï¼‰ï¼Œå¦åˆ™é»˜è®¤çš„æ•°å€¼å•ä½ä¸ºåƒç´ ï¼ˆpxï¼‰ã€‚é€Ÿå†™çš„csså±žæ€§å¯èƒ½æ— æ³•èŽ·å¾—å®Œæ•´å…¨é¢çš„æ”¯æŒï¼Œä¾‹å¦‚ï¼šborderã€marginç­‰ï¼Œå› æ­¤ä¸æŽ¨èä½¿ç”¨ã€‚ä½ è¿˜å¯ä»¥å°†csså±žæ€§å€¼è®¾ä¸ºä¸€äº›ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼šâ€showâ€ã€â€hideâ€ã€â€toggleâ€ï¼Œåˆ™jQueryä¼šè°ƒç”¨è¯¥å±žæ€§é»˜è®¤çš„åŠ¨ç”»å½¢å¼ã€‚æ­¤å¤–ï¼Œcsså±žæ€§å€¼ä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹çš„ï¼Œä½ å¯ä»¥ä¸ºå±žæ€§å€¼åŠ ä¸Šå‰ç¼€â€+=â€æˆ–â€-=â€ï¼Œä»¥ä¾¿äºŽåœ¨åŽŸæ¥çš„å±žæ€§å€¼ä¸Šå¢žåŠ æˆ–å‡å°‘æŒ‡å®šçš„æ•°å€¼ã€‚ä¾‹å¦‚ï¼š{ &quot;height&quot;: &quot;+=100px&quot; }ï¼Œè¡¨ç¤ºåœ¨åŽŸæœ‰é«˜åº¦çš„åŸºç¡€ä¸Šå¢žåŠ 100pxã€‚ä¾‹å¦‚ï¼Œç»™divé«˜åº¦è°ƒæ•´ä¸º300pxï¼Œå®½åº¦è°ƒæ•´ä¸º400pxï¼ŒåŠ¨ç”»æ—¶é•¿ä¸ºslowï¼š1$("div").animate( &#123; width: "400px", height: "300px" &#125;, "slow" );æ ¹æ®divé«˜åº¦åˆ‡æ¢æ˜¾ç¤º/éšè—ï¼Œæ˜¾ç¤ºæ—¶é«˜åº¦ä»Ž0å¢žåŠ åˆ°åŽŸé«˜åº¦ï¼Œéšè—æ—¶é«˜åº¦ä»ŽåŽŸé«˜åº¦å‡å°åˆ°0ï¼š1$("div").animate( &#123; height: "toggle" &#125;);stop()ç”¨äºŽåœæ­¢å½“å‰åŒ¹é…å…ƒç´ ä¸Šæ­£åœ¨è¿è¡Œçš„åŠ¨ç”»ã€‚æ¯”å¦‚divç»‘å®šäº†ä¸‰ä¸ªanimateåŠ¨ç”»å‡½æ•°ï¼š123var $myDiv = $("div");$myDiv.animate( &#123; height: "+=300px" &#125;, 2000 ); // åŠ¨ç”»1$myDiv.animate( &#123; width: "50%" &#125;, 1000 ); // åŠ¨ç”»2å‡è®¾å½“å‰divå…ƒç´ æ­£åœ¨æ‰§è¡Œç¬¬ä¸€ä¸ªåŠ¨ç”»ï¼Œæ­¤æ—¶æ‰§è¡Œä»¥ä¸‹stop()å‡½æ•°æ—¶ï¼Œæ•ˆæžœä¸ºï¼š1234$myDiv.stop( ); // é©¬ä¸Šåœæ­¢åŠ¨ç”»1ï¼Œç»§ç»­æŒ‰é¡ºåºæ‰§è¡ŒåŠ¨ç”»2å’ŒåŠ¨ç”»3$myDiv.stop( true ); // é©¬ä¸Šåœæ­¢åŠ¨ç”»1ï¼Œå¹¶ä¸”ä¸å†æ‰§è¡ŒåŠ¨ç”»2å’ŒåŠ¨ç”»3$myDiv.stop( "fx", true ); // æ•ˆæžœå’Œ$myDiv.stop( true );ä¸€æ ·$myDiv.stop( true, true ); // ç«‹åˆ»é©¬ä¸Šæ‰§è¡Œå®ŒåŠ¨ç”»1ï¼Œå¹¶ä¸å†æ‰§è¡ŒåŠ¨ç”»2å’ŒåŠ¨ç”»3delay()ç”¨äºŽå»¶è¿Ÿé˜Ÿåˆ—ä¸­ä¸‹ä¸€é¡¹çš„æ‰§è¡Œã€‚delay()å¯ä»¥å°†é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œçš„ä¸‹ä¸€ä¸ªåŠ¨ç”»å»¶è¿ŸæŒ‡å®šçš„æ—¶é—´åŽæ‰æ‰§è¡Œã€‚å®ƒå¸¸ç”¨åœ¨é˜Ÿåˆ—ä¸­çš„ä¸¤ä¸ªjQueryæ•ˆæžœå‡½æ•°ä¹‹é—´ï¼Œä»Žè€Œåœ¨ä¸Šä¸€ä¸ªåŠ¨ç”»æ•ˆæžœæ‰§è¡ŒåŽå»¶è¿Ÿä¸‹ä¸€ä¸ªåŠ¨ç”»æ•ˆæžœçš„æ‰§è¡Œæ—¶é—´ã€‚ å¦‚æžœä¸‹ä¸€é¡¹ä¸æ˜¯æ•ˆæžœåŠ¨ç”»ï¼ˆæ¯”å¦‚show()å°±ä¸æ˜¯æ•ˆæžœåŠ¨ç”»ï¼‰ï¼Œåˆ™å®ƒä¸ä¼šè¢«åŠ å…¥æ•ˆæžœé˜Ÿåˆ—ä¸­ï¼Œå› æ­¤è¯¥å‡½æ•°ä¸ä¼šå¯¹å®ƒè¿›è¡Œå»¶è¿Ÿè°ƒç”¨ã€‚ æ¯”å¦‚ï¼š123var $myDiv = $("div");$myDiv.slideUp( 1000 ).delay( 5000 ).slideDown( 1500 );//å…ˆæ‰§è¡ŒslideUp()ï¼Œç„¶åŽç­‰å¾…5sï¼Œåœ¨æ‰§è¡ŒslideDown()finish()åœæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„åŠ¨ç”»ï¼Œåˆ é™¤æ‰€æœ‰é˜Ÿåˆ—ä¸­çš„åŠ¨ç”»ï¼Œç›´æŽ¥æ˜¾ç¤ºæœ€ç»ˆåŠ¨ç”»æ‰§è¡Œå®Œæ¯•çš„æ•ˆæžœã€‚æ¯”å¦‚divç»‘å®šäº†ä¸‰ä¸ªanimateåŠ¨ç”»å‡½æ•°ï¼š1234var $myDiv = $("div");$myDiv.animate( &#123; height: "+=300px" &#125;, 2000 ); // åŠ¨ç”»1$myDiv.animate( &#123; width: "50%" &#125;, 1000 ); // åŠ¨ç”»2$myDiv.animate( &#123; width: "200px", height: "100px" &#125;, 1000 ); // åŠ¨ç”»3å‡è®¾å½“å‰divå…ƒç´ æ­£åœ¨æ‰§è¡Œç¬¬ä¸€ä¸ªåŠ¨ç”»ï¼Œæ­¤æ—¶æ‰§è¡Œfinish()å‡½æ•°æ—¶ï¼Œç«‹åˆ»åœæ­¢å½“å‰åŠ¨ç”»ï¼Œå¹¶ä¸”divç›´æŽ¥å˜ä¸ºæœ€ç»ˆçŠ¶æ€ï¼ˆwidth: &quot;200px&quot;, height: &quot;100px&quot;ï¼‰ã€‚è®¾ç½®jQuery.fx.intervalç”¨äºŽè®¾ç½®jQueryåŠ¨ç”»æ¯éš”å¤šå°‘æ¯«ç§’ç»˜åˆ¶ä¸€å¸§å›¾åƒï¼Œè¯¥å€¼è¶Šå°ï¼Œåˆ™åŠ¨ç”»çš„è§¦å‘æ¬¡æ•°è¶Šå¤šï¼ŒåŠ¨ç”»æ•ˆæžœä¹Ÿæ›´æ˜Žæ˜¾ã€æ›´å¹³æ»‘ï¼Œå½“ç„¶ä¹Ÿå°±è¶Šè€—è´¹æ€§èƒ½ï¼Œé»˜è®¤å€¼ä¸º13ã€‚è®¾ç½®å¸§æ•°ä¸º5ï¼š1$.fx.interval = 5;jQuery.fx.offå…³é—­é¡µé¢ä¸Šæ‰€æœ‰çš„åŠ¨ç”»ã€‚æŠŠè¿™ä¸ªå±žæ€§è®¾ç½®ä¸ºtrueå¯ä»¥ç«‹å³å…³é—­æ‰€æœ‰åŠ¨ç”»ï¼ˆæ‰€æœ‰æ•ˆæžœä¼šç«‹å³æ‰§è¡Œå®Œæ¯•ï¼‰ã€‚ æœ‰äº›æƒ…å†µä¸‹å¯èƒ½éœ€è¦è¿™æ ·ï¼Œæ¯”å¦‚ä½ åœ¨é…ç½®æ¯”è¾ƒä½Žçš„ç”µè„‘ä¸Šä½¿ç”¨jQueryã€‚å½“æŠŠè¿™ä¸ªå±žæ€§è®¾æˆfalseä¹‹åŽï¼Œå¯ä»¥é‡æ–°å¼€å¯æ‰€æœ‰åŠ¨ç”»ã€‚ ç¦ç”¨åŠ¨ç”»æ•ˆæžœï¼š1$.fx.off = true; // ç¦ç”¨åŠ¨ç”»æ•ˆæžœå‚è€ƒç½‘ç«™ï¼šhttp://www.365mini.com/http://caibaojian.com/jquery/]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQueryå·¥å…·å‡½æ•°]]></title>
    <url>%2FjQuery%E5%B7%A5%E5%85%B7%E5%87%BD%E6%95%B0.html</url>
    <content type="text"><![CDATA[æ•°ç»„å’Œå¯¹è±¡æ“ä½œ$.each()ç”¨äºŽéåŽ†å¯¹è±¡æˆ–æ•°ç»„ï¼šjQuery.each(array,callback)æˆ–jQuery.each(object,callback)ã€‚ ä¾‹å¦‚ï¼ŒéåŽ†æ•°ç»„ï¼š123$.each([ 27, 41 ], function( index, value ) &#123; console.log( index + ": " + value );&#125;);éåŽ†å¯¹è±¡ï¼š1234567var obj = &#123; "name": "mrbird", "age": "24"&#125;;$.each( obj, function( key, value ) &#123; console.log( key + ": " + value );&#125;)$.extend()å°†ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡çš„å†…å®¹åˆå¹¶åˆ°ç¬¬ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚æœ‰ä¸¤ç§æž„é€ å‡½æ•°ï¼šjQuery.extend( target [, object1 ] [, objectN... ] )å’ŒjQuery.extend( [ deep ], target , object1 [, objectN... ] )ã€‚å¦‚æžœå¤šä¸ªå¯¹è±¡å…·æœ‰ç›¸åŒçš„å±žæ€§ï¼Œåˆ™åŽè€…ä¼šè¦†ç›–å‰è€…çš„å±žæ€§å€¼ã€‚å‚æ•°æè¿°deepå¯é€‰Booleanç±»åž‹ æŒ‡ç¤ºæ˜¯å¦æ·±åº¦åˆå¹¶å¯¹è±¡ï¼Œé»˜è®¤ä¸ºfalseï¼Œä¸èƒ½æ˜Žå†™falseã€‚å¦‚æžœè¯¥å€¼ä¸ºtrueï¼Œä¸”å¤šä¸ªå¯¹è±¡çš„æŸä¸ªåŒåå±žæ€§ä¹Ÿéƒ½æ˜¯å¯¹è±¡ï¼Œåˆ™è¯¥â€å±žæ€§å¯¹è±¡â€çš„å±žæ€§ä¹Ÿå°†è¿›è¡Œåˆå¹¶ã€‚targetObjectç±»åž‹ç›®æ ‡å¯¹è±¡ï¼Œå…¶ä»–å¯¹è±¡çš„æˆå‘˜å±žæ€§å°†è¢«å¤åˆ¶åˆ°è¯¥å¯¹è±¡ä¸Šã€‚object1å¯é€‰/Objectç±»åž‹ç¬¬ä¸€ä¸ªè¢«åˆå¹¶çš„å¯¹è±¡ã€‚objectNå¯é€‰/Objectç±»åž‹ç¬¬Nä¸ªè¢«åˆå¹¶çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œåˆå¹¶ä¸¤ä¸ªå¯¹è±¡ï¼Œä¿®æ”¹ç¬¬ä¸€ä¸ªå¯¹è±¡ï¼š123456789101112var object1 = &#123; apple: 0, banana: &#123; weight: 52, price: 100 &#125;, cherry: 97&#125;;var object2 = &#123; banana: &#123; price: 200 &#125;, durian: 100&#125;;$.extend( object1, object2 );console.log(JSON.stringify( object1 )); // &#123;"apple":0,"banana":&#123;"price":200&#125;,"cherry":97,"durian":100&#125;é€’å½’åˆå¹¶ä¸¤ä¸ªå¯¹è±¡ï¼Œä¿®æ”¹ç¬¬ä¸€ä¸ªå¯¹è±¡ï¼š12$.extend( true, object1, object2 );// &#123;"apple":0,"banana":&#123;"weight":52,"price":200&#125;,"cherry":97,"durian":100&#125;$.grep()å‡½æ•°ç”¨äºŽä½¿ç”¨æŒ‡å®šçš„å‡½æ•°è¿‡æ»¤æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œå¹¶è¿”å›žè¿‡æ»¤åŽçš„æ•°ç»„ã€‚ æºæ•°ç»„ä¸ä¼šå—åˆ°å½±å“ï¼Œè¿‡æ»¤ç»“æžœåªåæ˜ åœ¨è¿”å›žçš„ç»“æžœæ•°ç»„ä¸­ã€‚è¯­æ³•å¦‚ä¸‹ï¼š1jQuery.grep( array, function [, invert ] )å‚æ•°æè¿°arrayArrayç±»åž‹ å°†è¢«è¿‡æ»¤çš„æ•°ç»„ã€‚functionFunctionç±»åž‹ æŒ‡å®šçš„è¿‡æ»¤å‡½æ•°ã€‚invertå¯é€‰/Booleanç±»åž‹ é»˜è®¤å€¼ä¸º false ã€‚æŒ‡å®šæ˜¯å¦åè½¬è¿‡æ»¤ç»“æžœã€‚ä¾‹å¦‚ï¼š12345678$.grep( [ 0, 1, 2 ], function( n, i ) &#123; return n &gt; 0;&#125;);// [1, 2]$.grep( [ 0, 1, 2 ], function( n, i ) &#123; return n &gt; 0;&#125;,true);// [0]$.makeArray()å°†ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡è½¬æ¢ä¸ºçœŸæ­£çš„æ•°ç»„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š1234var obj = &#123; 0: "mrbird", 1: "blog", 2: true &#125;;console.log(obj instanceof Array); // falsevar arr = $.makeArray(obj);console.log(arr instanceof Array); // true$.map()ç”¨äºŽå¤„ç†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ (æˆ–å¯¹è±¡çš„æ¯ä¸ªå±žæ€§)ï¼Œå¹¶å°†å¤„ç†ç»“æžœå°è£…ä¸ºæ–°çš„æ•°ç»„è¿”å›žã€‚ä¾‹å¦‚ï¼šå°†æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼+4ï¼Œå¹¶è¿”å›žï¼š1234var arr = $.map( [ 0, 1, 2 ], function( n ) &#123; return n + 4;&#125;);console.log(arr); // [4, 5, 6]æ•°ç»„ä¸­å¤§äºŽ0çš„å€¼+1ï¼Œå°äºŽ0çš„åˆ é™¤ï¼š1234var arr = $.map( [ -3, 0, 1, 5 ], function( n ) &#123; return n &gt; 0 ? n + 1 : null;&#125;);console.log(arr); // [2, 6]å°†åŽŸå§‹æ•°ç»„æ˜ å°„åˆ°æ–°çš„æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½åŠ ä¸Šå…¶åŽŸå§‹å€¼å’Œå€¼åŠ 1ï¼š1234var arr = $.map( [ 0, 1, 2 ], function( n ) &#123; return [ n, n + 1 ];&#125;);console.log(arr); // [ 0, 1, 1, 2, 2, 3 ]å°†å¯¹è±¡çš„é”®æ˜ å°„åˆ°æ•°ç»„ï¼š12345var obj = &#123; width: 10, height: 15, length: 20 &#125;;var keys = $.map( obj, function( value, key ) &#123; return key;&#125;);console.log(obj); // [ "width", "height", "length" ]$.inArray()ç”¨äºŽåœ¨æ•°ç»„ä¸­æœç´¢æŒ‡å®šçš„å€¼ï¼Œå¹¶è¿”å›žå…¶ç´¢å¼•å€¼ã€‚å¦‚æžœæ•°ç»„ä¸­ä¸å­˜åœ¨è¯¥å€¼ï¼Œåˆ™è¿”å›ž -1ã€‚1234var arr = [ 4, "Pete", 8, "John" ];console.log($.inArray( "John", arr )); // 3console.log($.inArray( 4, arr )); // 0console.log($.inArray( "mrbird", arr )); // -1$merge()å°†ä¸¤ä¸ªæ•°ç»„çš„å†…å®¹åˆå¹¶åˆ°ç¬¬ä¸€ä¸ªæ•°ç»„ä¸­ã€‚ä¾‹å¦‚ï¼š12var arr = $.merge( [ 0, 1, 2 ], [ 2, 3, 4 ] )console.log(arr); // [0, 1, 2, 2, 3, 4]å‡½æ•°æ“ä½œ$.noop()å‡½æ•°ä¸ºä¸€ä¸ªç©ºå‡½æ•°ï¼Œä»€ä¹ˆä¹Ÿä¸åšã€‚å…¶æºç ä¸ºï¼š1noop: function() &#123;&#125;$.proxy()ç”¨äºŽæ”¹å˜å‡½æ•°çš„ä¸Šä¸‹æ–‡ã€‚ä½ å¯ä»¥å°†æŒ‡å®šå‡½æ•°ä¼ å…¥è¯¥å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è¿”å›žä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå…¶æ‰§è¡Œä»£ç ä¸å˜ï¼Œä½†å‡½æ•°å†…éƒ¨çš„ä¸Šä¸‹æ–‡thiså·²ç»è¢«æ›´æ”¹ä¸ºæŒ‡å®šå€¼ã€‚ ä¾‹å¦‚ï¼š12345678function test()&#123; console.log(this); &#125;test(); // Window var object = &#123; name : "mrbird", age : 100 &#125;var proxy = $.proxy(test,object);proxy(); // Objectæµ‹è¯•æ“ä½œ$.contains()ç”¨äºŽåˆ¤æ–­æŒ‡å®šå…ƒç´ å†…æ˜¯å¦åŒ…å«å¦ä¸€ä¸ªå…ƒç´ ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œè¯¥å‡½æ•°ç”¨äºŽåˆ¤æ–­å¦ä¸€ä¸ªDOMå…ƒç´ æ˜¯å¦æ˜¯æŒ‡å®šDOMå…ƒç´ çš„åŽä»£ã€‚jQuery.contains()ä»…ç”¨äºŽæ¯”è¾ƒä¸¤ä¸ªDOMå…ƒç´ ï¼Œä¸èƒ½ç”¨äºŽæ¯”è¾ƒnodeListæˆ–è€…jQueryå¯¹è±¡ã€‚ä¾‹å¦‚ï¼š123456&lt;div id="n1"&gt; &lt;p id="n2"&gt; &lt;span id="n3"&gt;leanote&lt;/span&gt; &lt;/p&gt;&lt;/div&gt;&lt;p id="n4"&gt;mrbird's blog&lt;/p&gt;12345678var $n1 = $("#n1")[0];var $n2 = $("#n2")[0];var $n3 = $("#n3")[0];var $n4 = $("#n4")[0]; console.log( $.contains( $n1, $n2 ) ); // trueconsole.log( $.contains( $n1, $n3 ) ); // trueconsole.log( $.contains( $n1, $n4 ) ); // false$.type()ç”¨äºŽç¡®å®šJavaScriptå†…ç½®å¯¹è±¡çš„ç±»åž‹ï¼Œå¹¶è¿”å›žå°å†™å½¢å¼çš„ç±»åž‹åç§°ã€‚JavaScriptä¹Ÿè‡ªå¸¦æœ‰ä¸€ä¸ªtypeofè¿ç®—ç¬¦ï¼Œå¯ä»¥ç¡®å®šæ•°æ®çš„ç±»åž‹ã€‚ä¸è¿‡å¯¹äºŽç»å¤§å¤šæ•°å¯¹è±¡è€Œè¨€ï¼Œtypeofè¿ç®—ç¬¦éƒ½è¿”å›žObjectï¼Œæ— æ³•åŒºåˆ†å…·ä½“çš„ç±»åž‹ã€‚$.type()å¯ä»¥æ›´åŠ ç²¾ç¡®åœ°ç¡®å®šJSå†…ç½®å¯¹è±¡çš„ç±»åž‹ã€‚123456789101112131415161718192021console.log( $.type( undefined ) ); // undefinedconsole.log( $.type( null ) ); // nullconsole.log( $.type( true ) ); // booleanconsole.log( $.type( new Boolean(false) ) ); // booleanconsole.log( $.type( 3 ) ); // numberconsole.log( $.type( new Number(3) ) ); // numberconsole.log( $.type( "test" ) ); // stringconsole.log( $.type( new String("test") ) ); // stringconsole.log( $.type( function()&#123;&#125; ) ); // functionconsole.log( $.type( new Function() ) ); // functionconsole.log( $.type( [] ) ); // arrayconsole.log( $.type( new Array() ) ); // arrayconsole.log( $.type( new Date() ) ); // dateconsole.log( $.type( new Error() ) ); // errorconsole.log( $.type( /test/ ) ); // regexpconsole.log( $.type( new RegExp("\\d+") ) ); // regexp /* é™¤ä¸Šè¿°ç±»åž‹çš„å¯¹è±¡å¤–ï¼Œå…¶ä»–å¯¹è±¡ä¸€å¾‹è¿”å›ž"object" */console.log( $.type( &#123;&#125; ) ); // objectfunction User() &#123; &#125;console.log( $.type( new User() ) ); // object$.isArray()ç”¨äºŽåˆ¤æ–­æŒ‡å®šå‚æ•°æ˜¯å¦æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚$.isFunction()ç”¨äºŽåˆ¤æ–­æŒ‡å®šå‚æ•°æ˜¯å¦æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚$.isEmptyObject()ç”¨äºŽåˆ¤æ–­æŒ‡å®šå‚æ•°æ˜¯å¦æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ã€‚123console.log( $.isEmptyObject( &#123; &#125; ) ); // trueconsole.log( $.isEmptyObject( new Object() ) ); // trueconsole.log( $.isEmptyObject( new Function() ) ); // true$.isPlainObject()ç”¨äºŽåˆ¤æ–­æŒ‡å®šå‚æ•°æ˜¯å¦æ˜¯ä¸€ä¸ªçº¯ç²¹çš„å¯¹è±¡ã€‚ æ‰€è°“â€œçº¯ç²¹çš„å¯¹è±¡â€ï¼Œå°±æ˜¯è¯¥å¯¹è±¡æ˜¯é€šè¿‡{}æˆ–new Objectåˆ›å»ºçš„ã€‚123456console.log( $.isPlainObject( &#123; &#125; ) ); // trueconsole.log( $.isPlainObject( new Object() ) ); // trueconsole.log( $.isPlainObject( &#123; name: "CodePlayer"&#125; ) ); // trueconsole.log( $.isPlainObject( &#123; sayHi: function()&#123;&#125; &#125; ) ); // true console.log( $.isPlainObject( new Function() ) ); // false$.isWindow()åˆ¤æ–­å½“å‰å¯¹è±¡æ˜¯å¦ä¸ºæµè§ˆå™¨å†…ç½®çš„Windowå¯¹è±¡ã€‚12console.log( $.isWindow( this ) ); // trueconsole.log( $.isWindow( window ) ); // true$.isNumeric()ç”¨äºŽåˆ¤æ–­æŒ‡å®šå‚æ•°æ˜¯å¦æ˜¯ä¸€ä¸ªæ•°å­—å€¼ã€‚å­—ç¬¦ä¸²æ“ä½œ$.trim()è¯¥å‡½æ•°å¯ä»¥åŽ»é™¤å­—ç¬¦ä¸²å¼€å§‹å’Œæœ«å°¾ä¸¤ç«¯çš„ç©ºç™½å­—ç¬¦(ç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªéžç©ºç™½å­—ç¬¦ä¸²ä¸ºæ­¢)ã€‚å®ƒä¼šæ¸…é™¤åŒ…æ‹¬æ¢è¡Œç¬¦ã€ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ç­‰å¸¸è§çš„ç©ºç™½å­—ç¬¦ã€‚å¦‚æžœå‚æ•°strä¸æ˜¯å­—ç¬¦ä¸²ç±»åž‹ï¼Œè¯¥å‡½æ•°å°†è‡ªåŠ¨å°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²ï¼ˆä¸€èˆ¬è°ƒç”¨å…¶toString()æ–¹æ³•ï¼‰ã€‚å¦‚æžœå‚æ•°strä¸ºnullæˆ–undefinedï¼Œåˆ™è¿”å›žç©ºå­—ç¬¦ä¸²ã€‚URL$.param()ç”¨äºŽå°†ä¸€ä¸ªJSæ•°ç»„æˆ–çº¯ç²¹çš„å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²å€¼ï¼Œä»¥ä¾¿ç”¨äºŽURLæŸ¥è¯¢å­—ç¬¦ä¸²æˆ–AJAXè¯·æ±‚ã€‚å¦‚æžœä¼ å…¥çš„ä¸æ˜¯æ•°ç»„æˆ–â€œçº¯ç²¹çš„å¯¹è±¡â€ï¼Œåˆ™è¿”å›žç©ºå­—ç¬¦ä¸²ï¼›å¦‚æžœä¼ å…¥çš„æ˜¯nullã€undefinedç­‰æ— æ³•è®¿é—®å±žæ€§çš„å€¼ï¼Œåˆ™ç›´æŽ¥æŠ¥é”™ã€‚æ‰€è°“â€œçº¯ç²¹çš„å¯¹è±¡â€ï¼Œå°±æ˜¯é€šè¿‡{}æˆ–new Object()è‡ªè¡Œåˆ›å»ºçš„å¯¹è±¡ã€‚JSå†…ç½®çš„Booleanã€Numberã€Stringã€Dateã€RegExpã€Functionã€Windowç­‰ç±»åž‹çš„å¯¹è±¡éƒ½ä¸ç®—æ˜¯â€œçº¯ç²¹çš„å¯¹è±¡â€ã€‚è¿”å›žçš„å­—ç¬¦ä¸²å·²ç»è¿‡URLç¼–ç å¤„ç†ï¼ˆé‡‡ç”¨çš„å­—ç¬¦é›†ä¸ºUTF-8ï¼‰ã€‚çœ‹ä¸€äº›ä¾‹å­ï¼š123// å­—ç¬¦ä¸²å°†è¢«çœ‹ä½œä¸€ä¸ªå­—ç¬¦æ•°ç»„console.log( $.param( "mrbird" )); // 0=m&amp;1=r&amp;2=b&amp;3=i&amp;4=r&amp;5=dconsole.log( $.param( &#123; name:"mrbird", job:"Coder" &#125; )); // name=mrbird&amp;job=Coderå¦‚æžœå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„Arrayï¼Œé‚£ä¹ˆå®ƒçš„æ¯ä¸ªå…ƒç´ éƒ½å¿…é¡»æ˜¯ä¸€ä¸ªåŒ…å«nameå±žæ€§å’Œvalueå±žæ€§çš„å¯¹è±¡ï¼Œå…¶ä»–å±žæ€§ä¸ä¼šè¢«å¤„ç†ï¼ˆvalueå±žæ€§å¯ä»¥æ²¡æœ‰ï¼Œé»˜è®¤å…¶å€¼ä¸ºundefinedï¼Œå°†è¢«è½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²ï¼‰ã€‚ä¾‹å¦‚ï¼š123456var array = [ &#123; name: "name", value: "mrbird" &#125;, &#123; name: "age", value: 100, extra: "ignore" &#125;, &#123; name: "grade" &#125;];console.log( $.param( array )); // name=mrbird&amp;age=100&amp;grade=ç¼–å†™æ’ä»¶$.error()ç”¨äºŽä¸ºæ¯ä¸ªåŒ¹é…å…ƒç´ çš„erroräº‹ä»¶ç»‘å®šå¤„ç†å‡½æ•°ã€‚ä¾‹å¦‚å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶ï¼Œå¼¹å‡ºæ¡†æé†’ï¼š123$("img").error( function()&#123; alert( "å›¾ç‰‡åŠ è½½å¤±è´¥!" );&#125; );æˆ‘ä»¬è¿˜å¯ä»¥ä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ä¼ é€’ä¸€äº›é™„åŠ çš„æ•°æ®ï¼Œå¹¶ç”¨Eventå¯¹è±¡èŽ·å–ï¼š123456var newImageURL = "../img/test.png"; $("img").error( newImageURL, function(event)&#123; this.src = event.data; console.log(event.data); // ../img/test.png&#125; );$.fn.jqueryç”¨äºŽè¿”å›žå½“å‰jQueryåº“çš„ç‰ˆæœ¬å·ã€‚1console.log($.fn.jquery); // 1.11.1æˆ–è€…ä½¿ç”¨ä»»æ„jQueryå¯¹è±¡çš„jqueryå±žæ€§è®¿é—®ï¼š1console.log($("body").jquery); // 1.11.1å‚è€ƒç½‘ç«™ï¼šhttp://www.365mini.com/http://jquery.com/http://caibaojian.com/jquery/]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Leanoteåšå®¢ä¸»é¢˜Summer]]></title>
    <url>%2FLeanote%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98Summer.html</url>
    <content type="text"><![CDATA[å¤å¤©åˆ°äº†ï¼Œæ‰€ä»¥ä¸»é¢˜åå­—å°±å«Summerå§ã€‚ä¸»é¢˜å‚è€ƒè‡ªhttps://cn.vuejs.org/v2/api/ã€‚emojiä½œè€…ColinXuã€‚ç”±äºŽæ¯ä¸ªäººå•é¡µçš„è¿¥å¼‚ï¼Œæ‰€ä»¥æˆ‘æŠŠè‡ªå®šä¹‰çš„å•é¡µåŽ»æŽ‰äº†ã€‚å•é¡µæ ·å¼è‡ªå®šä¹‰å¯ä»¥å‚è€ƒä¸‹é¢çš„æ€è·¯ï¼š123456&#123;&#123;if eq $.single.Title "Friends"&#125;&#125; &#123;&#123;template "friends.html" $&#125;&#125;&#123;&#123;end&#125;&#125;&#123;&#123;if eq $.single.Title "Music"&#125;&#125; &#123;&#123;template "music.html" $&#125;&#125;&#123;&#123;end&#125;&#125;å…³äºŽè­¦å‘Šæ¡†ï¼Œåœ¨ç¬”è®°ç¼–è¾‘å™¨é‡Œé€‰ä¸­æ–‡å­—åŠ ä¸‹åˆ’çº¿å°±å¯ä»¥äº†ã€‚ä¸»é¢˜å·²ä¸Šæž¶ä¸»é¢˜å¸‚åœºï¼Œæœ‰ä»€ä¹ˆé—®é¢˜æ¬¢è¿Žç•™è¨€ã€‚æœ€æ–°åœ°å€ï¼šgithub]]></content>
      <tags>
        <tag>Leanote</tag>
        <tag>theme</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQueryç­›é€‰æ“ä½œ]]></title>
    <url>%2FjQuery%E7%AD%9B%E9%80%89%E6%93%8D%E4%BD%9C.html</url>
    <content type="text"><![CDATA[jQueryæä¾›äº†ä¸€ç³»åˆ—çš„ç­›é€‰å‡½æ•°æ¥å¯¹jQueryé€‰æ‹©å™¨é€‰æ‹©çš„ç»“æžœè¿›è¡Œç­›é€‰ã€‚ç­›é€‰å‡½æ•°å¤§è‡´å¯åˆ†ä¸ºä¸‰ä¸ªç±»åˆ«ï¼šè¿‡æ»¤ï¼ŒæŸ¥æ‰¾å’Œä¸²è”ã€‚è¿‡æ»¤eq(index)èŽ·å–ç¬¬Nä¸ªå…ƒç´ ã€‚indexä¸ºå…ƒç´ ä½ç½®ï¼Œä¸ºæ­£æ•°æ—¶è¡¨ç¤ºä»Žç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œä»Ž0ç®—èµ·ï¼›ä¸ºè´Ÿæ•°æ—¶è¡¨ç¤ºä»Žæœ€åŽä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œä»Ž-1å¼€å§‹ã€‚ä¾‹å¦‚ï¼ŒèŽ·å–åŒ¹é…çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼š12&lt;p&gt; This is just a test.&lt;/p&gt;&lt;p&gt; So is this&lt;/p&gt;1$("p").eq(1); // &lt;p&gt; So is this&lt;/p&gt; â€‹èŽ·å–å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼š1$("p").eq(-2); //&lt;p&gt; This is just a test.&lt;/p&gt;first()èŽ·å–ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ä¾‹å¦‚ï¼ŒèŽ·å–ulçš„ç¬¬ä¸€ä¸ªliï¼š1234567&lt;ul&gt; &lt;li&gt;list item 1&lt;/li&gt; &lt;li&gt;list item 2&lt;/li&gt; &lt;li&gt;list item 3&lt;/li&gt; &lt;li&gt;list item 4&lt;/li&gt; &lt;li&gt;list item 5&lt;/li&gt;&lt;/ul&gt;1$('ul&gt;li').first(); // &lt;li&gt;list item 1&lt;/li&gt;last()å’Œfirst()ç›¸åï¼ŒèŽ·å–æœ€åŽä¸€ä¸ªå…ƒç´ ã€‚hasClass(class)hasClass()æ–¹æ³•æ£€æŸ¥è¢«é€‰å…ƒç´ æ˜¯å¦åŒ…å«æŒ‡å®šçš„classã€‚ä¾‹å¦‚ï¼Œåˆ¤æ–­é€‰ä¸­å…ƒç´ æ˜¯å¦å«æœ‰happyç±»ï¼š1&lt;div class="happy"&gt;&lt;/div&gt;1var a = $("div").hasClass("happy"); //truefilter(selector,[fn])filter()æ–¹æ³•å°†åŒ¹é…å…ƒç´ é›†åˆç¼©å‡ä¸ºåŒ¹é…æŒ‡å®šé€‰æ‹©å™¨çš„å…ƒç´ ã€‚selectorï¼šå­—ç¬¦ä¸²å€¼ï¼ŒåŒ…å«ä¾›åŒ¹é…å½“å‰å…ƒç´ é›†åˆçš„é€‰æ‹©å™¨è¡¨è¾¾å¼ã€‚fnï¼šå›žè°ƒå‡½æ•°ï¼Œå¯é€‰ã€‚ä¾‹å¦‚ï¼Œä¿ç•™å¸¦æœ‰selectç±»çš„å…ƒç´ ï¼š123&lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;Hello Again&lt;/p&gt;&lt;p class="selected"&gt;And Again&lt;/p&gt;1$("p").filter(".selected"); //&lt;p class="selected"&gt;And Again&lt;/p&gt;ä½¿ç”¨å›žè°ƒå‡½æ•°å®žçŽ°ï¼š123$("p").filter(function(index)&#123; return $(this).hasClass('selected'); &#125;);thisæŒ‡å½“å‰éåŽ†çš„å…ƒç´ ï¼Œè¿”å›žtrueçš„å…ƒç´ å°†è¢«ä¿ç•™ã€‚ä¿ç•™ç¬¬ä¸€ä¸ªæˆ–å¸¦æœ‰selectç±»çš„å…ƒç´ ï¼š1$("p").filter(".selected,:first"); // &lt;p&gt;Hello&lt;/p&gt;, &lt;p class="selected"&gt;And Again&lt;/p&gt;is(selector,[fn])is()æ ¹æ®é€‰æ‹©å™¨ã€å…ƒç´ æˆ– jQuery å¯¹è±¡æ¥æ£€æµ‹åŒ¹é…å…ƒç´ é›†åˆï¼Œå¦‚æžœè¿™äº›å…ƒç´ ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ åŒ¹é…ç»™å®šçš„å‚æ•°ï¼Œåˆ™è¿”å›ž trueã€‚fnï¼šå›žè°ƒå‡½æ•°ï¼Œå¯é€‰ã€‚ä¾‹å¦‚ï¼Œåˆ¤æ–­inputçš„çˆ¶å…ƒç´ æ˜¯å¦ä¸ºformï¼š123&lt;form&gt; &lt;input type="checkbox" /&gt;&lt;/form&gt;1$("input[type='checkbox']").parent().is("form") //trueä½¿ç”¨å›žè°ƒå‡½æ•°å®žçŽ°ï¼š123$("input[type='checkbox']").parent().is(function()&#123; return $(this)[0].nodeName == 'FORM'; &#125;);map(callback(index,domElement))map()æŠŠæ¯ä¸ªå…ƒç´ é€šè¿‡å‡½æ•°ä¼ é€’åˆ°å½“å‰åŒ¹é…é›†åˆä¸­ï¼Œç”ŸæˆåŒ…å«è¿”å›žå€¼çš„æ–°çš„ jQuery å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œæœ‰å¦‚ä¸‹è¡¨å•ï¼Œè¦èŽ·å–ä»¥é€—å·åˆ†éš”çš„å¤é€‰æ¡†åˆ—è¡¨IDï¼š1234567891011121314151617181920&lt;form method="post" action=""&gt; &lt;fieldset&gt; &lt;div&gt; &lt;label for="two"&gt;2&lt;/label&gt; &lt;input type="checkbox" value="2" id="two" name="number[]"&gt; &lt;/div&gt; &lt;div&gt; &lt;label for="four"&gt;4&lt;/label&gt; &lt;input type="checkbox" value="4" id="four" name="number[]"&gt; &lt;/div&gt; &lt;div&gt; &lt;label for="six"&gt;6&lt;/label&gt; &lt;input type="checkbox" value="6" id="six" name="number[]"&gt; &lt;/div&gt; &lt;div&gt; &lt;label for="eight"&gt;8&lt;/label&gt; &lt;input type="checkbox" value="8" id="eight" name="number[]"&gt; &lt;/div&gt; &lt;/fieldset&gt;&lt;/form&gt;123$(':checkbox').map(function() &#123; return this.id;&#125;).get().join(','); //"two,four,six,eight"has(selector)has()å°†åŒ¹é…å…ƒç´ é›†åˆç¼©å‡ä¸ºæ‹¥æœ‰åŒ¹é…æŒ‡å®šé€‰æ‹©å™¨æˆ– DOM å…ƒç´ çš„åŽä»£çš„å­é›†ã€‚ä¾‹å¦‚ï¼Œæœ‰å¦‚ä¸‹åµŒå¥—çš„åˆ—è¡¨ï¼š1234567891011&lt;ul&gt; &lt;li&gt;list item 1&lt;/li&gt; &lt;li&gt;list item 2 &lt;ul&gt; &lt;li&gt;list item 2-a&lt;/li&gt; &lt;li&gt;list item 2-b&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt;list item 3&lt;/li&gt; &lt;li&gt;list item 4&lt;/li&gt;&lt;/ul&gt;çŽ°åœ¨ç»™åŒ…å«ulçš„liæ·»åŠ çº¢è‰²èƒŒæ™¯è‰²ï¼š1$( "li" ).has( "ul" ).css( "background-color", "red" );not()not()ä»ŽåŒ¹é…å…ƒç´ é›†åˆä¸­åˆ é™¤å…ƒç´ ã€‚ä¾‹å¦‚æœ‰å¦‚ä¸‹åˆ—è¡¨ï¼š1234567&lt;ul&gt; &lt;li&gt;list item 1&lt;/li&gt; &lt;li&gt;list item 2&lt;/li&gt; &lt;li id="notli"&gt;list item 3&lt;/li&gt; &lt;li&gt;list item 4&lt;/li&gt; &lt;li&gt;list item 5&lt;/li&gt;&lt;/ul&gt;ç»™é™¤äº†list item 3å¤–çš„liæ·»åŠ çº¢è‰²èƒŒæ™¯è‰²ï¼š1$( "li" ).not("#notli").css( "background-color", "red" );slice(selector,end) â€‹slice()æŠŠåŒ¹é…å…ƒç´ é›†åˆç¼©å‡ä¸ºæŒ‡å®šçš„æŒ‡æ•°èŒƒå›´çš„å­é›†ã€‚å‚æ•°æè¿°selectoråŸºäºŽ 0 çš„æ•´æ•°å€¼ï¼ŒæŒ‡ç¤ºå¼€å§‹é€‰å–å…ƒç´ çš„ä½ç½®ï¼›å¦‚æžœæ˜¯è´Ÿæ•°ï¼Œåˆ™æŒ‡ç¤ºä»Žé›†åˆæœ«ç«¯å¼€å§‹çš„åç§»é‡ã€‚endåŸºäºŽ 0 çš„æ•´æ•°å€¼ï¼ŒæŒ‡ç¤ºç»“æŸé€‰å–å…ƒç´ çš„ä½ç½®ï¼›å¦‚æžœæ˜¯è´Ÿæ•°ï¼Œåˆ™æŒ‡ç¤ºä»Žé›†åˆæœ«ç«¯å¼€å§‹çš„åç§»é‡ã€‚ å¦‚æžœçœç•¥ï¼Œåˆ™é€‰å–èŒƒå›´ä¼šåœ¨é›†åˆæœ«ç«¯ç»“æŸã€‚ä¾‹å¦‚ï¼Œç»™ç¬¬ä¸€ç¬¬äºŒä¸ªpå…ƒç´ åŠ ç²—ï¼š123456&lt;p&gt;This is a paragraph.&lt;/p&gt;&lt;p&gt;This is a paragraph.&lt;/p&gt;&lt;p&gt;This is a paragraph.&lt;/p&gt;&lt;p&gt;This is a paragraph.&lt;/p&gt;&lt;p&gt;This is a paragraph.&lt;/p&gt;&lt;p&gt;This is a paragraph.&lt;/p&gt;1$("p").slice(0, 2).wrapInner("&lt;b&gt;&lt;/b&gt;");ç»™å€’æ•°ç¬¬äºŒä¸ªpå…ƒç´ åŠ ç²—ï¼š1$("p").slice(-2, -1).wrapInner("&lt;b&gt;&lt;/b&gt;");ç»™ç¬¬ä¸‰ä¸ªåŠå…¶ä»¥åŽçš„på…ƒç´ åŠ ç²—ï¼š1$("p").slice(2).wrapInner("&lt;b&gt;&lt;/b&gt;");æŸ¥æ‰¾children()è¿”å›žåŒ¹é…å…ƒç´ é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„å­å…ƒç´ ï¼Œæ·»åŠ å¯é€‰å‚æ•°å¯é€šè¿‡é€‰æ‹©å™¨è¿›è¡Œè¿‡æ»¤ã€‚ä¾‹å¦‚ï¼šæ‰¾åˆ°divçš„æ‰€æœ‰åŒ…å«selectedç±»çš„å­å…ƒç´ ï¼Œç„¶åŽå°†å…¶ç½®ä¸ºè“è‰²ï¼š123456&lt;div&gt; &lt;span&gt;Hello&lt;/span&gt; &lt;p class="selected"&gt;Hello Again&lt;/p&gt; &lt;div class="selected"&gt;And Again&lt;/div&gt; &lt;p&gt;And One Last Time&lt;/p&gt;&lt;/div&gt;1$( "div" ).children( ".selected" ).css( "color", "blue" );closest(selector)closest()æ–¹æ³•èŽ·å¾—åŒ¹é…é€‰æ‹©å™¨çš„ç¬¬ä¸€ä¸ªç¥–å…ˆå…ƒç´ ï¼Œä»Žå½“å‰å…ƒç´ å¼€å§‹æ²¿ DOM æ ‘å‘ä¸Šã€‚ä¾‹å¦‚ï¼Œå½“åˆ—è¡¨è¢«ç‚¹å‡»çš„æ—¶å€™æ·»åŠ èƒŒæ™¯è‰²ï¼Œå…¶ä½™çš„ç§»é™¤èƒŒæ™¯è‰²ï¼š123$( document ).bind("click", function( e ) &#123; $( e.target ).closest("li").addClass("hilight").siblings().removeClass("hilight");&#125;);find(selector)find()æ–¹æ³•èŽ·å¾—å½“å‰å…ƒç´ é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„åŽä»£ï¼Œé€šè¿‡é€‰æ‹©å™¨ã€jQuery å¯¹è±¡æˆ–å…ƒç´ æ¥ç­›é€‰ã€‚ä¾‹å¦‚ï¼šæœç´¢æ‰€æœ‰æ®µè½ä¸­çš„åŽä»£ span å…ƒç´ ï¼Œå¹¶å°†å…¶é¢œè‰²è®¾ç½®ä¸ºçº¢è‰²ï¼š1$("p").find("span").css('color','red');next(selector)next()èŽ·å¾—åŒ¹é…å…ƒç´ é›†åˆä¸­æ¯ä¸ªå…ƒç´ ç´§é‚»çš„åŒèƒžå…ƒç´ ã€‚å¦‚æžœæä¾›é€‰æ‹©å™¨ï¼Œåˆ™å–å›žåŒ¹é…è¯¥é€‰æ‹©å™¨çš„ä¸‹ä¸€ä¸ªåŒèƒžå…ƒç´ ã€‚ä¾‹å¦‚ï¼Œæœ‰å¦‚ä¸‹ç®€å•åˆ—è¡¨ï¼š1234567&lt;ul&gt; &lt;li&gt;list item 1&lt;/li&gt; &lt;li&gt;list item 2&lt;/li&gt; &lt;li class="third-item"&gt;list item 3&lt;/li&gt; &lt;li&gt;list item 4&lt;/li&gt; &lt;li&gt;list item 5&lt;/li&gt;&lt;/ul&gt;å°†list item 4æ·»åŠ çº¢è‰²èƒŒæ™¯è‰²ï¼š1$('li.third-item').next().css('background-color', 'red');å°†list item 3æ·»åŠ çº¢è‰²èƒŒæ™¯è‰²ï¼š1$('li').next('.third-item').css('background-color', 'red');ç­‰ä»·äºŽï¼š1$('ul').find('.third-item').css('background-color', 'red');nextAll(selector)æŸ¥æ‰¾å½“å‰å…ƒç´ ä¹‹åŽæ‰€æœ‰çš„åŒè¾ˆå…ƒç´ ã€‚è¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œç»™list item 3ä¹‹åŽçš„æ‰€æœ‰åŒçº§liæ·»åŠ çº¢è‰²èƒŒæ™¯è‰²ï¼š1$('li.third-item').nextAll().css('background-color', 'red');é€‰æ‹©å™¨ç”¨æ³•ï¼Œç»™å«æœ‰redç±»çš„liæ·»åŠ çº¢è‰²èƒŒæ™¯è‰²ï¼š12345678910&lt;ul&gt; &lt;li&gt;list item 1&lt;/li&gt; &lt;li&gt;list item 2&lt;/li&gt; &lt;li class="red"&gt;list item 3&lt;/li&gt; &lt;li&gt;list item 4&lt;/li&gt; &lt;li class="red"&gt;list item 5&lt;/li&gt;&lt;/ul&gt;&lt;script&gt; $('li').nextAll('.red').css('background-color', 'red');&lt;/script&gt;nextUntil()æŸ¥æ‰¾å½“å‰å…ƒç´ ä¹‹åŽæ‰€æœ‰çš„åŒè¾ˆå…ƒç´ ï¼Œç›´åˆ°é‡åˆ°åŒ¹é…çš„é‚£ä¸ªå…ƒç´ ä¸ºæ­¢ã€‚ä¾‹å¦‚ï¼Œæœ‰å¦‚ä¸‹åˆ—è¡¨ï¼š1234567891011121314&lt;dl&gt; &lt;dt id="term-1"&gt;term 1&lt;/dt&gt; &lt;dd&gt;definition 1-a&lt;/dd&gt; &lt;dd&gt;definition 1-b&lt;/dd&gt; &lt;dd&gt;definition 1-c&lt;/dd&gt; &lt;dd&gt;definition 1-d&lt;/dd&gt; &lt;dt id="term-2"&gt;term 2&lt;/dt&gt; &lt;dd&gt;definition 2-a&lt;/dd&gt; &lt;dd&gt;definition 2-b&lt;/dd&gt; &lt;dd&gt;definition 2-c&lt;/dd&gt; &lt;dt id="term-3"&gt;term 3&lt;/dt&gt; &lt;dd&gt;definition 3-a&lt;/dd&gt; &lt;dd&gt;definition 3-b&lt;/dd&gt;&lt;/dl&gt;æ‰¾åˆ°è·Ÿéš &lt;dt id=&quot;term-1&quot;&gt; çš„åŒèƒžå…ƒç´ ï¼Œç›´åˆ° &lt;dt id=&quot;term-3&quot;&gt;ï¼Œå¹¶ä¸ºå®ƒä»¬è®¾ç½®è“è‰²æ–‡æœ¬é¢œè‰²ï¼š1$("#term-1").nextUntil("#term-3").css("color", "blue");æ•ˆæžœå¦‚å›¾ï¼šæ‰¾åˆ°è·Ÿéš &lt;dt id=&quot;term-1&quot;&gt; çš„&lt;dd&gt;åŒèƒžå…ƒç´ ï¼Œç›´åˆ° &lt;dt id=&quot;term-3&quot;&gt;ï¼Œå¹¶ä¸ºå®ƒä»¬è®¾ç½®è“è‰²æ–‡æœ¬é¢œè‰²ï¼š1$("#term-1").nextUntil("#term-3",'dd').css("color", "blue"); èŽ·å¾—è¢«å®šä½çš„æœ€è¿‘ç¥–å…ˆå…ƒç´ ã€‚è¿™äº›å®šä½åŒ…æ‹¬relativeï¼Œabsoluteæˆ–fixedã€‚ä¾‹å¦‚ï¼Œæœ‰å¦‚ä¸‹htmlï¼š1234567891011121314151617&lt;ul class="level-1"&gt; &lt;li class="item-i"&gt;I&lt;/li&gt; &lt;li class="item-ii" style="position: relative;"&gt;II &lt;ul class="level-2"&gt; &lt;li class="item-a"&gt;A&lt;/li&gt; &lt;li class="item-b"&gt;B &lt;ul class="level-3"&gt; &lt;li class="item-1"&gt;1&lt;/li&gt; &lt;li class="item-2"&gt;2&lt;/li&gt; &lt;li class="item-3"&gt;3&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li class="item-c"&gt;C&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li class="item-iii"&gt;III&lt;/li&gt;&lt;/ul&gt;ç»™&lt;li class=&quot;item-a&quot;&gt;æœ€è¿‘çš„è¢«å®šä½çˆ¶å…ƒç´ ï¼Œå³&lt;li class=&quot;item-ii&quot; style=&quot;position: relative;&quot;&gt;æ·»åŠ çº¢è‰²èƒŒæ™¯è‰²ï¼š1$('li.item-a').offsetParent().css('background-color', 'red');parent(selector)èŽ·å–åŒ¹é…å…ƒç´ æœ€è¿‘çš„çˆ¶å…ƒç´ ã€‚æŽ¥ç€ä¸Šé¢çš„ä¾‹å­ï¼Œç»™&lt;li class=&quot;item-a&quot;&gt;çš„çˆ¶å…ƒç´ ï¼Œå³&lt;ul class=&quot;level-2&quot;&gt;æ·»åŠ çº¢è‰²èƒŒæ™¯è‰²ï¼š1$('li.item-a').parent().css('background-color', 'red'); â€‹å†å¦‚æœ‰å¦‚ä¸‹htmlï¼š12&lt;div&gt;&lt;p&gt;Hello&lt;/p&gt;&lt;/div&gt;&lt;div class="selected"&gt;&lt;p&gt;Hello Again&lt;/p&gt;&lt;/div&gt;1$("p").parent(".selected").css("background", "yellow");ç»“æžœåªæœ‰Hello Againæ‹¥æœ‰é»„è‰²èƒŒæ™¯è‰²ã€‚parents(selector)èŽ·å–åŒ¹é…å…ƒç´ çš„ç¬¦åˆç­›é€‰å™¨selectoræ‰€æœ‰å±‚çº§çš„çˆ¶å…ƒç´ ã€‚æœ‰å¦‚ä¸‹htmlï¼š1234567891011121314&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt; &lt;p&gt; &lt;span&gt; &lt;b&gt;&lt;/b&gt; &lt;/span&gt; &lt;/p&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;12345678var a = $("b").parents().map(function()&#123; return this.nodeName;&#125;).get().join(',');console.log(a); //SPAN,P,DIV,BODY,HTMLvar b = $("b").parents("p").map(function()&#123; return this.nodeName;&#125;).get().join(',');console.log(b); //PparentsUntil(selector)æŸ¥æ‰¾å½“å‰å…ƒç´ çš„æ‰€æœ‰çš„çˆ¶è¾ˆå…ƒç´ ï¼Œç›´åˆ°é‡åˆ°åŒ¹é…çš„é‚£ä¸ªå…ƒç´ ä¸ºæ­¢ã€‚æŽ¥ç€ä¸Šé¢çš„htmlï¼Œæœ‰å¦‚ä¸‹jsä»£ç ï¼š1234var parentEls = $("b").parentsUntil('div').map(function()&#123; return this.nodeName;&#125;).get().join(',');console.log(parentEls); // SPAN,Pprev(selector)å’Œnext(selector)ç›¸åã€‚prevAll(selector)å’ŒnextAll(selector)ç›¸åã€‚prevUntil(selector)å’ŒnextUntil()ç›¸åã€‚siblings(selector)åŒ¹é…é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„åŒèƒžã€‚ä¸²è”add()add() æ–¹æ³•å°†å…ƒç´ æ·»åŠ åˆ°åŒ¹é…å…ƒç´ çš„é›†åˆä¸­ã€‚ä¾‹å¦‚ï¼ŒæŸ¥æ‰¾æ‰€æœ‰divå¹¶æ·»åŠ è¾¹æ¡†ã€‚ç„¶åŽå°†æ‰€æœ‰pæ·»åŠ åˆ°jQueryå¯¹è±¡ä¸­å¹¶å°†å…¶èƒŒæ™¯è®¾ç½®ä¸ºé»„è‰²ã€‚1$( "div" ).css( "border", "2px solid red" ).add( "p" ).css( "background", "yellow" );è¿™é‡Œåªæœ‰divæ·»åŠ äº†è¾¹æ¡†ï¼ç»™æ‰€æœ‰på’Œspanæ·»åŠ é»„è‰²èƒŒæ™¯è‰²ï¼š1$( "p" ).add( "span" ).css( "background", "yellow" );addBack()è¯¥å‡½æ•°ç”¨äºŽæ›¿ä»£1.8ç‰ˆæœ¬ä¹‹å‰çš„andSelf()å‡½æ•°ã€‚é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥æ´žå¯Ÿå…¶ä½œç”¨ï¼š1234567&lt;ul&gt; &lt;li&gt;list item 1&lt;/li&gt; &lt;li&gt;list item 2&lt;/li&gt; &lt;li class="third-item"&gt;list item 3&lt;/li&gt; &lt;li&gt;list item 4&lt;/li&gt; &lt;li&gt;list item 5&lt;/li&gt;&lt;/ul&gt;12345678var a = $('li.third-item').nextAll().map(function()&#123; return this.innerHTML&#125;).get().join(',');var b = $('li.third-item').nextAll().addBack().map(function()&#123; return this.innerHTML&#125;).get().join(',');console.log(a); // list item 4,list item 5console.log(b); // list item 3,list item 4,list item 5contents()contents()æ–¹æ³•èŽ·å¾—åŒ¹é…å…ƒç´ é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„å­èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬æ–‡æœ¬å’Œæ³¨é‡ŠèŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼šæ‰¾åˆ°pä¸­çš„æ‰€æœ‰æ–‡æœ¬èŠ‚ç‚¹ï¼Œå¹¶ç”¨ç²—ä½“æ ‡ç­¾åŒ…è£…å®ƒä»¬ï¼š1$("p").contents().filter(function()&#123; return this.nodeType != 1; &#125;).wrap("&lt;b/&gt;");ä¸‹è¡¨ä¸ºhtmlä¸­nodeTypeçš„å–å€¼ï¼šèŠ‚ç‚¹ç±»åž‹æè¿°1Elementä»£è¡¨å…ƒç´ 2Atträ»£è¡¨å±žæ€§3Textä»£è¡¨å…ƒç´ æˆ–å±žæ€§ä¸­çš„æ–‡æœ¬å†…å®¹ã€‚4CDATASectionä»£è¡¨æ–‡æ¡£ä¸­çš„ CDATA éƒ¨åˆ†ï¼ˆä¸ä¼šç”±è§£æžå™¨è§£æžçš„æ–‡æœ¬ï¼‰ã€‚5EntityReferenceä»£è¡¨å®žä½“å¼•ç”¨ã€‚6Entityä»£è¡¨å®žä½“ã€‚7ProcessingInstructionä»£è¡¨å¤„ç†æŒ‡ä»¤ã€‚8Commentä»£è¡¨æ³¨é‡Šã€‚9Documentä»£è¡¨æ•´ä¸ªæ–‡æ¡£ï¼ˆDOM æ ‘çš„æ ¹èŠ‚ç‚¹ï¼‰ã€‚10DocumentTypeå‘ä¸ºæ–‡æ¡£å®šä¹‰çš„å®žä½“æä¾›æŽ¥å£11DocumentFragmentä»£è¡¨è½»é‡çº§çš„ Document å¯¹è±¡ï¼Œèƒ½å¤Ÿå®¹çº³æ–‡æ¡£çš„æŸä¸ªéƒ¨åˆ†12Notationä»£è¡¨ DTD ä¸­å£°æ˜Žçš„ç¬¦å·ã€‚end()end()æ–¹æ³•ç»“æŸå½“å‰é“¾æ¡ä¸­çš„æœ€è¿‘çš„ç­›é€‰æ“ä½œï¼Œå¹¶å°†åŒ¹é…å…ƒç´ é›†è¿˜åŽŸä¸ºä¸€å¼€å§‹çš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼ŒçŽ°æœ‰å¦‚ä¸‹htmlï¼š12345&lt;ul class="first"&gt; &lt;li class="foo"&gt;list item 1&lt;/li&gt; &lt;li&gt;list item 2&lt;/li&gt; &lt;li class="bar"&gt;list item 3&lt;/li&gt;&lt;/ul&gt; â€‹12$('ul.first').find('.foo').css('background-color', 'red') .end().find('.bar').css('background-color', 'green');è¿™æ¡é“¾å¼çš„jQueryæ“ä½œä»£ç é¦–å…ˆé€‰å–äº†ç±»åä¸ºfirstçš„ulï¼Œç„¶åŽä½¿ç”¨find(&#39;.foo&#39;)æ‰¾åˆ°&lt;li class=&quot;foo&quot;&gt;list item 1&lt;/li&gt;ï¼Œç»™å…¶æ·»åŠ äº†çº¢è‰²èƒŒæ™¯è‰²ã€‚éšåŽï¼Œend()æ–¹æ³•å°†jQueryå¯¹è±¡è¿˜åŽŸä¸ºä¸€å¼€å§‹çš„çŠ¶æ€ï¼Œå³(&#39;ul.first&#39;)ï¼Œå†ä½¿ç”¨find(&#39;.bar&#39;)æ‰¾åˆ°&lt;li class=&quot;bar&quot;&gt;list item 3&lt;/li&gt;ï¼Œç»™å…¶æ·»åŠ ç»¿è‰²èƒŒæ™¯è‰²ã€‚æ•ˆæžœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¦‚æžœåŽ»é™¤end()å‡½æ•°ï¼Œä¼šå› æ‰¾ä¸åˆ°&lt;li class=&quot;bar&quot;&gt;list item 3&lt;/li&gt;ï¼Œæ·»åŠ ç»¿è‰²èƒŒæ™¯è‰²å¤±è´¥ã€‚åŽ»é™¤end()æ•ˆæžœå¦‚ä¸‹ï¼šä¸€èˆ¬ä¸ºäº†è§†è§‰ä¸Šçš„å¯¹ç§°ï¼Œä¸Šé¢çš„ä»£ç æœ«ç«¯ä¹ŸåŠ ä¸Šend()ï¼š12345$('ul.first').find('.foo') .css('background-color', 'red') .end().find('.bar') .css('background-color', 'green') .end();å‚è€ƒç½‘ç«™http://api.jquery.com/http://www.w3school.com.cn/jqueryhttp://caibaojian.com/jquery]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQueryæ“ä½œæ–‡æ¡£æ–°å§¿åŠ¿]]></title>
    <url>%2FjQuery%E6%93%8D%E4%BD%9C%E6%96%87%E6%A1%A3%E6%96%B0%E5%A7%BF%E5%8A%BF.html</url>
    <content type="text"><![CDATA[çŽ°è¦åœ¨bodyä¸‹æ’å…¥ä¸€å¼ åŒ…å«ä¸€äº›å±žæ€§çš„å›¾ç‰‡ï¼Œä½¿ç”¨jQueryæ“ä½œdocumentä¼ ç»Ÿçš„åšæ³•æ˜¯ï¼š12345678var html = ' &lt;img src="../images/little.bear.png" alt="Little Bear"'+ ' title="I woof in your general direction" '+ ' onclick="showTitle($(this));"&gt;&lt;img/&gt;'$(html).appendTo('body');function showTitle(val)&#123; var $this = val; alert($this.attr('title'));&#125;çŽ°ä½¿ç”¨æ›´ä¼˜é›…çš„æ–¹æ³•æ¥å®žçŽ°è¿™ä¸ªæ“ä½œï¼š123456789$('&lt;img&gt;',&#123; src: '../images/little.bear.png', alt: 'Little Bear', title:'I woof in your general direction', click: function() &#123; alert($(this).attr('title')); &#125;&#125;).appendTo('body');æ³¨ï¼š$(&#39;&lt;img&gt;&#39;)ç­‰åŒäºŽ$(&#39;&lt;img&gt;&lt;/img&gt;&#39;)æˆ–$(&#39;&lt;img/&gt;&#39;)ã€ŠjQueryå®žæˆ˜ ç¬¬ä¸‰ç‰ˆã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡ªå®šä¹‰jQueryé€‰æ‹©å™¨]]></title>
    <url>%2F%E8%87%AA%E5%AE%9A%E4%B9%89jQuery%E9%80%89%E6%8B%A9%E5%99%A8.html</url>
    <content type="text"><![CDATA[jQueryè‡ªèº«æä¾›äº†è®¸å¤šé€‰æ‹©å™¨ï¼Œé™¤æ­¤ä¹‹å¤–å…¶è¿˜å…è®¸æˆ‘ä»¬è‡ªå®šä¹‰é€‰æ‹©å™¨ã€‚ä¸‹é¢è¿™ç§è‡ªå®šä¹‰é€‰æ‹©å™¨çš„æ–¹æ³•ä»…é€‚ç”¨äºŽ1.8åŠå…¶ä»¥åŽçš„ç‰ˆæœ¬ã€‚è€ƒè™‘æœ‰å¦‚ä¸‹htmlç‰‡æ®µï¼š123456&lt;ul class="levels"&gt; &lt;li data-level="1" data-points="1" data-technologies="javascript node grunt"&gt;Level 1&lt;/li&gt; &lt;li data-level="2" data-points="10" data-technologies="jquery requirejs"&gt;Level 2&lt;/li&gt; &lt;li data-level="3" data-points="100" data-technologies="php composer"&gt;Level 3&lt;/li&gt; &lt;li data-level="4" data-points="1000" data-technologies="javascript jquery"&gt;Level 4&lt;/li&gt;&lt;/ul&gt;å‡å¦‚æˆ‘ä»¬éœ€è¦é€‰æ‹©å‡ºdata-levelå±žæ€§å€¼å¤§äºŽ2ï¼Œdata-pointså¤§äºŽ100å¹¶ä¸”data-technologieså±žæ€§åŒ…å«â€jqueryâ€çš„liï¼Œä¼ ç»Ÿçš„åšæ³•æ˜¯ï¼š12345678910111213//å…ˆç­›é€‰å‡ºdata-technologieså±žæ€§åŒ…å«"jquery"çš„livar $levels = $('.levels li[data-technologies~="jquery"]');var matchedLevels = [];//å¾ªçŽ¯éåŽ†$levelsï¼Œå°†ç¬¦åˆæ¡ä»¶çš„liå¡žåˆ°matchedLevelsæ•°ç»„é‡Œfor (var i = 0; i &lt; $levels.length; i++) &#123; if ($levels[i].getAttribute('data-level') &gt; 2 &amp;&amp; $levels[i].getAttribute('data-points') &gt; 100) &#123; matchedLevels.push($levels[i]); &#125;&#125;console.log(matchedLevels.length); // 1å¦‚æžœéœ€è¦å¤šæ¬¡ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰é€‰æ‹©å™¨ï¼Œè®©ä»£ç æ›´ä¼˜é›…ï¼š1234567$.expr[':'].requiredLevel = $.expr.createPseudo(function (filterParam) &#123; return function (element, context, isXml) &#123; return element.getAttribute('data-level') &gt; 2 &amp;&amp; element.getAttribute('data-points') &gt; 100 &amp;&amp; element.getAttribute('data-technologies').indexOf('jquery') &gt;= 0; &#125;;&#125;);createPseudoæ–¹æ³•ç”¨äºŽåˆ›é€ è‡ªå®šä¹‰é€‰æ‹©å™¨ï¼Œå¯å‘å…¶ä¼ é€’å‚æ•°filterParamï¼Œå‚æ•°åå¯ä»¥å¦èµ·å…¶åï¼Œè¿™é‡Œéœ€æ±‚å›ºå®šï¼Œæ‰€ä»¥ä¸å¿…ä¼ å‚ã€‚elementè¡¨ç¤ºå½“å‰å¤„ç†çš„å…ƒç´ ï¼ŒisXMLç”¨äºŽæŒ‡å®šæ˜¯å¦ä¸ºXMLæ–‡æœ¬ï¼Œé»˜è®¤ä¸ºfalseã€‚contexté»˜è®¤ä¸ºæ•´ä¸ªdocumentï¼Œå¯ä»¥æŒ‡å®šèŒƒå›´æ¥å¢žå¼ºæ€§èƒ½ï¼šæ¯”å¦‚æŸ¥æ‰¾divå†…çš„på…ƒç´ ï¼š12$("div p") æˆ–$("p","div")ç»“æžœä¸€è‡´ï¼Œç¬¬äºŒç§å†™æ³•æ•ˆçŽ‡æ›´é«˜ã€‚è¨€å½’æ­£ä¼ ï¼Œä½¿ç”¨ä¸Šè¿°å®šä¹‰çš„é€‰æ‹©å™¨æ¥æŸ¥è¯¢æ»¡è¶³æ¡ä»¶çš„liï¼š123var $requiredLevels = $('li:requiredLevel','.levels ');console.log($requiredLevels.length); // 1console.log($requiredLevels.html()); // Level 4ä¼ é€’å‚æ•°å‡å¦‚å°†éœ€æ±‚æ”¹ä¸ºï¼ŒæŸ¥æ‰¾å‡ºdata-pointså¤§äºŽæŸä¸ªæ•´æ•°å€¼çš„liï¼Œè¦æ€Žä¹ˆåšå‘¢ï¼Ÿè¿™æ—¶å€™å°±å¯ä»¥ç”¨ä¸ŠfilterParamäº†ï¼š1234567$.expr[':'].pointsHigherThan = $.expr.createPseudo(function (filterParam) &#123; // ç¼“å­˜å‚æ•°ï¼Œä»¥ä¾›é—­åŒ…ä½¿ç”¨ var points = parseInt(filterParam, 10); return function (element, context, isXml) &#123; return element.getAttribute('data-points') &gt; points; &#125;;&#125;);æµ‹è¯•ï¼š12var $higherPointsLevels = $('li:pointsHigherThan(50)','.levels ');console.log($higherPointsLevels.length); // 2ã€ŠjQueryå®žæˆ˜ ç¬¬ä¸‰ç‰ˆã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[canvasä¸Žæ¸å˜è‰²]]></title>
    <url>%2Fcanvas%E4%B8%8E%E6%B8%90%E5%8F%98%E8%89%B2.html</url>
    <content type="text"><![CDATA[çº¿æ€§æ¸å˜ç»˜åˆ¶çº¿æ€§æ¸å˜ï¼Œéœ€è¦ç”¨åˆ°å›¾å½¢ä¸Šä¸‹æ–‡çš„createLinearGradientæ–¹æ³•æ¥åˆ›å»ºgradientå¯¹è±¡ï¼Œæ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š1var gradient = context.createLinearGradient(x0,y0,x1,y1);(x0,y0)ä¸ºæ¸å˜èµ·å§‹ç‚¹çš„åæ ‡ï¼Œ(x1,y1)ä¸ºæ¸å˜ç»“æŸçš„çš„åæ ‡ã€‚æŽ¥ä¸‹æ¥éœ€è¦æŒ‡å®šæ¸å˜çš„é¢œè‰²ï¼Œå¯ä»¥é€šè¿‡gradientå¯¹è±¡çš„addColorStopæ–¹æ³•æ¥è®¾å®šï¼Œæ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š1gradient.addColorStop(stop,color);å…¶ä¸­stopä¸ºä»‹äºŽ 0.0 ä¸Ž 1.0 ä¹‹é—´çš„å€¼ï¼Œè¡¨ç¤ºæ¸å˜ä¸­å¼€å§‹ä¸Žç»“æŸä¹‹é—´çš„ä½ç½®ï¼›colorä¸ºç»˜åˆ¶æ—¶ä½¿ç”¨çš„é¢œè‰²ã€‚æœ€åŽéœ€è¦åšçš„å°±æ˜¯å°†gradientå¯¹è±¡èµ‹äºˆç»™fillStyleå±žæ€§ï¼š1context.fillStyle = gradient;ç»˜åˆ¶ä¸€ä¸ªæ¸å˜è‰²çŸ©å½¢ï¼š12345678910var canvas = document.getElementById("canvas");var context = canvas.getContext("2d");//è®¾å®šæ¸å˜èŒƒå›´var g = context.createLinearGradient(0,0,250,150);//è®¾ç½®æ¸å˜èµ·ç‚¹é¢œè‰²g.addColorStop(0,'#FF9999');//è®¾ç½®æ¸å˜ç»ˆç‚¹é¢œè‰²g.addColorStop(1,'#FFFF99');context.fillStyle = g;context.fillRect(0,0,250,150);æ˜¾ç¤ºæ•ˆæžœï¼šå¾„å‘æ¸å˜å¾„å‘æ¸å˜æŒ‡çš„æ˜¯æ²¿ç€åœ†å½¢çš„åŠå¾„æ–¹å‘å‘å¤–æ‰©æ•£çš„æ¸å˜æ–¹å¼ã€‚ç»˜åˆ¶å¾„å‘æ¸å˜ä½¿ç”¨çš„æ˜¯å›¾å½¢ä¸Šä¸‹æ–‡çš„createRadialGradientæ–¹æ³•æ¥åˆ›å»ºgradientå¯¹è±¡ï¼Œæ–¹æ³•ç­¾åå¦‚ä¸‹ï¼š1var gradient = context.createRadialGradient(x0,y0,r0,x1,y1,r1);(x0,y0)ä¸ºæ¸å˜çš„å¼€å§‹åœ†å¿ƒåæ ‡ï¼Œr0ä¸ºæ¸å˜å¼€å§‹åœ†çš„åŠå¾„ï¼›(x1,y1)ä¸ºæ¸å˜çš„ç»“æŸåœ†å¿ƒåæ ‡ï¼Œr1ä¸ºæ¸å˜ç»“æŸåœ†çš„åŠå¾„ã€‚å‰©ä½™çš„æ“ä½œå’Œçº¿æ€§æ¸å˜ä¸€è‡´ï¼Œä¸å†èµ˜è¿°ã€‚è¿™é‡Œç»˜åˆ¶ä¸€ä¸ªå¾„å‘æ¸å˜çš„åœ†ï¼š1234567var g = context.createRadialGradient(100,100,0,100,100,100);g.addColorStop(0,'#FFFF99');g.addColorStop(1,'#FF9999');context.beginPath();context.arc(100,100,100,0,Math.PI*2,false);context.fillStyle = g;context.fill();æ˜¾ç¤ºæ•ˆæžœï¼šã€ŠHTML5ä¸ŽCSS3æƒå¨æŒ‡å—ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>HTML5</tag>
        <tag>Canvas</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[canvasç»˜åˆ¶ç®€å•å›¾å½¢]]></title>
    <url>%2Fcanvas%E7%BB%98%E5%88%B6%E7%AE%80%E5%8D%95%E5%9B%BE%E5%BD%A2.html</url>
    <content type="text"><![CDATA[canvasæ˜¯HTML5ä¸­ä¸“é—¨ç”¨æ¥ç»˜åˆ¶å›¾å½¢çš„å…ƒç´ ã€‚åœ¨é¡µé¢ä¸Šæ”¾ç½®ä¸€ä¸ªcanvaså…ƒç´ å°±ç›¸å½“äºŽåˆ›å»ºäº†ä¸€ä¸ªç”»å¸ƒã€‚ç»˜åˆ¶è¿‡ç¨‹ç”±JSè„šæœ¬å®Œæˆã€‚é¦–å…ˆåœ¨é¡µé¢ä¸Šæ·»åŠ ä¸€ä¸ªcanvaså…ƒç´ ï¼š12345678910&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;html5&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;canvas id="canvas" width="500" height="400"/&gt;&lt;/body&gt;&lt;/html&gt;åŸºæœ¬æ­¥éª¤ä½¿ç”¨canvasç»˜åˆ¶å›¾å½¢çš„å‡ ä¸ªåŸºæœ¬æ­¥éª¤ï¼š1.èŽ·å–canvaså¯¹è±¡ï¼š1var canvas = document.getElementById("canvas");2.å–å¾—ä¸Šä¸‹æ–‡contextï¼Œå…¶åŒ…å«è®¸å¤šç»˜åˆ¶çš„æ–¹æ³•ï¼š1var context = canvas.getContext("2d");ç›®å‰ä»…æœ‰2då‚æ•°å¯é€‰ã€‚3.è®¾ç½®ç»˜å›¾æ ·å¼ï¼šç»˜å›¾æ ·å¼ä¸»è¦åŒ…å«å›¾å½¢å¡«å……æ ·å¼fillStyleï¼Œå›¾å½¢è¾¹æ¡†æ ·å¼strokeStyleå’Œçº¿å®½lineWidthã€‚123456//è®¾ç½®å¡«å……æ ·å¼ä¸ºçº¢è‰²context.fillStyle = "red";//è®¾ç½®è¾¹æ¡†ä¸ºé»„è‰²context.strokeStyle = "yellow";//è®¾ç½®çº¿å®½ä¸º1pxcontext.lineWidth = 1;4.å¼€å§‹ç»˜åˆ¶å›¾å½¢ï¼šå…·ä½“ç»˜åˆ¶æ–¹æ³•ä¸‹é¢é™†ç»­å±•å¼€ã€‚ç»˜åˆ¶çŸ©å½¢ä½¿ç”¨fillRectæ–¹æ³•ä¸ŽstrokeRectæ–¹æ³•æ¥ç»˜åˆ¶çŸ©å½¢å’ŒçŸ©å½¢è¾¹æ¡†ï¼š12context.fillRect(x,y,width,height);context.strokeRect(x,y,width,height);â€‹xï¼Œyä¸ºçŸ©å½¢å·¦ä¸Šè§’èµ·ç‚¹åæ ‡ï¼Œwidthä¸ºçŸ©å½¢å®½ï¼Œheightä¸ºçŸ©å½¢é«˜ã€‚å¼€å§‹ç»˜åˆ¶ï¼š1234567891011121314var canvas = document.getElementById("canvas");var context = canvas.getContext("2d");// è®¾ç½®canvasç”»å¸ƒé¢œè‰²context.fillStyle = "#F7F7F7";context.fillRect(0,0,300,300);//è®¾ç½®å¡«å……é¢œè‰²ï¼Œè¾¹æ¡†é¢œè‰²context.fillStyle = "#E4F0C3";context.strokeStyle = "#F06560";//è®¾ç½®çº¿å®½context.lineWidth = 1;//ç»˜åˆ¶çŸ©å½¢context.fillRect(50,50,100,100);//ç»˜åˆ¶çŸ©å½¢è¾¹æ¡†context.strokeRect(50,50,150,150);ç»“æžœï¼šå…³äºŽçŸ©å½¢ï¼Œè¿˜æœ‰ä¸€ä¸ªclearRectæ–¹æ³•ï¼Œç”¨äºŽæ¸…é™¤æŒ‡å®šçŸ©å½¢åŒºåŸŸåƒç´ ï¼š1context.clearRect(x,y,width,height);åœ¨ä¸Šé¢çš„JSè„šæœ¬ä¸­åŠ å…¥ä¸‹é¢è¿™è¡Œä»£ç ï¼š1context.clearRect(50,50,50,50);æ•ˆæžœï¼šç»˜åˆ¶åœ†å½¢ï¼Œæ‰‡å½¢ï¼Œæ¤­åœ†ç»˜åˆ¶åœ†å½¢ä¸»è¦å¤šäº†å¼€å§‹åˆ›å»ºè·¯å¾„beginPathå’Œå…³é—­è·¯å¾„closePathè¿™ä¸¤ä¸ªè¿‡ç¨‹ã€‚ä¸»è¦æ­¥éª¤ï¼š1.å¼€å§‹åˆ›å»ºè·¯å¾„ï¼š1context.beginPath();2.ç»˜åˆ¶åœ†å½¢è·¯å¾„ï¼šæ–¹æ³•ï¼š1context.arc(x,y,r,sAngle,eAngle,anticlockwise);å…¶ä¸­xï¼Œyä¸ºç»˜åˆ¶åœ†å½¢çš„èµ·ç‚¹åæ ‡å³åœ†å¿ƒï¼Œrä¸ºåœ†å½¢åŠå¾„ï¼ŒsAngleï¼ˆèµ·å§‹è§’ï¼‰å’ŒeAngleï¼ˆç»“æŸè§’ï¼‰å†³å®šäº†åœ†çš„å¼§åº¦ï¼Œä¸¤è€…çš„è¿žçº¿å†³å®šäº†åœ†çš„å½¢çŠ¶ï¼Œanticlockwiseè¡¨ç¤ºæ˜¯å¦æŒ‰é€†æ—¶é’ˆæ–¹å‘ç»˜åˆ¶ï¼Œä¸ºbooleanç±»åž‹ã€‚3.å…³é—­è·¯å¾„ï¼š1context.closePath();è®¾ç½®å¡«å……æ ·å¼ã€‚ç»˜åˆ¶åœ†å½¢ç¤ºä¾‹ï¼š1234567891011121314var canvas = document.getElementById("canvas");var context = canvas.getContext("2d");for(var i = 0;i &lt; 6; i++)&#123; //å¼€å§‹åˆ›å»ºè·¯å¾„ context.beginPath(); //ç»˜åˆ¶åœ†ï¼ŒMath.PI*2ä¸º2Ï€å¼§åº¦ context.arc(i*25,i*25,i*10,0,Math.PI*2,true); //å…³é—­è·¯å¾„ context.closePath(); //è®¾ç½®å¡«å……é¢œè‰² context.fillStyle = "rgba(66,185,131,0.4)"; //è¿›è¡Œå¡«å…… context.fill();&#125;åº¦ä¸Žå¼§åº¦æ¢ç®—ï¼š1Â° = 1/180Ï€ radæ•ˆæžœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå‡å¦‚ä¸å…³é—­è·¯å¾„ä¼šæ€Žæ ·å‘¢ï¼Ÿå°†ä¸Šé¢çš„ä»£ç æ”¹ä¸ºï¼š12345678for(var i = 0;i &lt; 6; i++)&#123; //ç»˜åˆ¶åœ†ï¼ŒMath.PI*2ä¸º2Ï€å¼§åº¦ context.arc(i*25,i*25,i*10,0,Math.PI*2,true); //è®¾ç½®å¡«å……é¢œè‰² context.fillStyle = "rgba(66,185,131,0.4)"; //è¿›è¡Œå¡«å…… context.fill();&#125;æ•ˆæžœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šä¸å…³é—­è·¯å¾„å°†ä¼šå¯¼è‡´å†ç»˜åˆ¶ç¬¬äºŒä¸ªåœ†çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªåœ†ä¼šæ ¹æ®ä¹‹å‰çš„è·¯å¾„å†æ¬¡ç»˜åˆ¶ä¸€æ¬¡ã€‚æ‰€ä»¥åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç¬¬ä¸€ä¸ªåœ†ç»˜åˆ¶äº†5æ¬¡ï¼Œç¬¬äºŒä¸ªåœ†ç»˜åˆ¶äº†4æ¬¡ï¼Œä»¥æ­¤ç±»æŽ¨ï¼Œä»¥è‡³äºŽç¬¬ä¸€ä¸ªåœ†çš„é¢œè‰²æœ€æ·±ã€‚å…³äºŽå¼§åº¦çš„å‚è€ƒå¯è§ä¸‹å›¾ï¼šé¡ºæ—¶é’ˆå’Œé€†æ—¶é’ˆçš„å·®åˆ«ä¸¾ä¸ªä¾‹å­è¯´æ˜Žï¼šé¡ºæ—¶é’ˆï¼Œå¼§åº¦ä¸º0.5radï¼š1234567context.beginPath();context.arc(100,100,100,0,Math.PI*0.5,false);context.closePath();context.fillStyle = "rgba(66,185,131,0.4)";context.strokeStyle = "#F06560";context.fill();context.stroke();æ•ˆæžœå¦‚ä¸‹å›¾ï¼šå°†falseæ”¹ä¸ºtrueï¼Œå³é€†æ—¶é’ˆæ—¶ï¼šæ¤­åœ†çš„ç»˜åˆ¶å…¬å¼å¦‚ä¸‹ï¼š1context.ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise);å…¶ä¸­xï¼Œyä¸ºèµ·å§‹åæ ‡ï¼ŒradiusXä¸ºæ¤­åœ†æ¨ªå‘åŠå¾„ï¼ŒradiusYä¸ºæ¤­åœ†çºµå‘åŠå¾„ï¼Œrotationä¸ºæ¤­åœ†é¡ºæ—¶é’ˆæ—‹è½¬è§’åº¦ï¼ŒstartAngleï¼ˆèµ·å§‹è§’ï¼‰å’ŒendAngleï¼ˆç»“æŸè§’ï¼‰å†³å®šäº†åœ†çš„å¼§åº¦ï¼Œä¸¤è€…çš„è¿žçº¿å†³å®šäº†åœ†çš„å½¢çŠ¶ï¼Œanticlockwiseè¡¨ç¤ºæ˜¯å¦æŒ‰é€†æ—¶é’ˆæ–¹å‘ç»˜åˆ¶ï¼Œä¸ºbooleanç±»åž‹ã€‚ç»˜åˆ¶ä¸€ä¸ªç®€å•çš„æ¤­åœ†ï¼š12345context.beginPath();context.ellipse(100,100,50,90,Math.PI*0.25,0,Math.PI*2,false);context.closePath();context.fillStyle = "rgba(66,185,131,0.4)";context.fill();æ•ˆæžœå›¾ï¼šç»˜åˆ¶ç›´çº¿ä¸Žç»˜åˆ¶ç›´çº¿æœ‰å…³çš„æ–¹æ³•ä¸»è¦æœ‰ä¸¤ä¸ªï¼š1context.moveTo(x,y);moveToæ–¹æ³•å°†ç»˜åˆ¶å…‰æ ‡ç§»åŠ¨åˆ°xï¼Œyä½ç½®ã€‚1context.lineTo(x,y);lineToæ–¹æ³•å°†ä»Žå½“å‰å…‰æ ‡ä½ç½®å¼€å§‹ï¼Œåˆ°xï¼Œyä½ç½®é—´ç»˜åˆ¶ä¸€æ¡ç›´çº¿ã€‚å¤šæ¬¡è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåˆ™ä¸‹ä¸€æ¬¡çš„èµ·ç‚¹ä¸ºä¸Šä¸€æ¬¡lineToçš„ç»ˆç‚¹ã€‚ä½¿ç”¨lineToæ–¹æ³•ç»“åˆæ•°å­¦å…¬å¼ï¼Œç»˜åˆ¶ä¸€ä¸ªå¤æ‚çš„å›¾æ¡ˆï¼š123456789101112131415var dx = 150;var dy = 150;var s = 100;context.beginPath();context.fillStyle = "rgba(230,177,163,.5)";context.strokeStyle = "#e96900";var dig = Math.PI/15*11;for(var i = 0;i &lt; 30 ; i++)&#123; var x = Math.sin(i*dig); var y = Math.cos(i*dig); context.lineTo(dx+x*s,dy+y*s);&#125;context.closePath();context.fill();context.stroke();æ•ˆæžœå›¾ï¼šå›¾å½¢ä¸Šä¸‹æ–‡çš„lineCapå±žæ€§å¯ä¸ºç›´çº¿æ·»åŠ çº¿å¸½ï¼Œå¯ç”¨çš„å±žæ€§æœ‰ï¼šbuttï¼Œé»˜è®¤å€¼ï¼Œä¸ä¸ºç›´çº¿æ·»åŠ çº¿å¸½ã€‚roundï¼Œæ·»åŠ åœ†å½¢çº¿å¸½ã€‚squareï¼Œæ·»åŠ æ–¹å½¢çº¿å¸½ã€‚ä¾‹å¦‚ï¼š1234567context.strokeStyle = "rgba(66,185,131,0.6)";context.lineWidth = "10";context.beginPath();context.moveTo(50,50);context.lineTo(50,150);context.lineCap = "round";context.stroke();æ•ˆæžœï¼šå›¾å½¢ä¸Šä¸‹æ–‡çš„lineJoinå±žæ€§æŒ‡å®šä¸¤æ¡çº¿äº¤æ±‡å¤„çš„å½¢çŠ¶ï¼Œå¯ç”¨çš„å€¼æœ‰ï¼šmiterï¼Œé»˜è®¤å€¼ï¼Œå°–è§’æ‹è§’ã€‚roundï¼Œåœ†è§’æ‹è§’ã€‚bevelï¼Œæ–œè§’æ‹è§’ã€‚ä¾‹å¦‚ï¼š12345678context.strokeStyle = "rgba(66,185,131,0.6)";context.lineWidth = "10";context.beginPath();context.moveTo(50,50);context.lineTo(50,150);context.lineTo(150,150);context.lineJoin = "bevel";context.stroke();æ•ˆæžœå›¾ï¼šå›¾å½¢ä¸Šä¸‹æ–‡çš„setLineDashæ–¹æ³•å¯è®¾ç½®è™šçº¿çš„æ ·å¼ï¼š1context.setLineDash(segments);segmentsä¸ºä¸€ä¸ªæ•°ç»„ã€‚æ•°ç»„é•¿åº¦å¯åˆ†ä¸º4ç§æƒ…å†µï¼š1.å½“æ•°ç»„é•¿åº¦ä¸º1æ—¶ï¼š1context.setLineDash([5]);è¡¨ç¤ºçº¿æ®µé•¿åº¦ä¸º5ï¼Œçº¿æ®µé—´è·ç¦»ä¹Ÿä¸º5ã€‚2.å½“æ•°ç»„é•¿åº¦ä¸º2æ—¶ï¼š1context.setLineDash([5,10]);è¡¨ç¤ºçº¿æ®µé•¿åº¦ä¸º5ï¼Œçº¿æ®µé—´è·ç¦»ä¸º10ã€‚3.å½“æ•°ç»„é•¿åº¦ä¸ºå¤§äºŽ2çš„å¶æ•°æ—¶ï¼š1context.setLineDash([5,10,15,20]);ç¬¬å¥‡æ•°ä¸ªæ•°å€¼è¡¨ç¤ºçº¿æ®µé•¿åº¦ï¼Œç¬¬å¶æ•°ä¸ªæ•°å€¼è¡¨ç¤ºçº¿æ®µé—´è·ã€‚4.å½“æ•°ç»„é•¿åº¦ä¸ºå¤§äºŽ1çš„å¥‡æ•°æ—¶ï¼š1context.setLineDash([5,10,15]);æµè§ˆå™¨ä¼šå°†å…¶è§£æžä¸ºï¼š1context.setLineDash([5,10,15,5,10,15]);ç”»ä¸ªè™šçº¿è¯•è¯•ï¼š1234567context.strokeStyle = "rgba(66,185,131,0.9)";context.lineWidth = 2;context.beginPath();context.moveTo(10,50);context.lineTo(250,50);context.setLineDash([15,5]);context.stroke();æ•ˆæžœï¼šç»˜åˆ¶æ›²çº¿ç»˜åˆ¶æ›²çº¿ä½¿ç”¨arcToæ–¹æ³•ï¼š1context.fillRect(x1,y1,x2,y2,radiusX[radiusY,rotation]);å…³äºŽåæ ‡å‚æ•°ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢è¿™å¼ å›¾ï¼šå…¶ä¸­x0ï¼Œy0ä¸ºå½“å‰ç‚¹çš„åæ ‡ï¼Œx1ï¼Œy1ä¸ºç»˜åˆ¶åœ†å¼§æ—¶ä½¿ç”¨çš„æŽ§åˆ¶åæ ‡ï¼Œx2ï¼Œy2ä¸ºé‡ç‚¹åæ ‡ã€‚radiusXä¸ºåœ†å¼§çš„åŠå¾„ã€‚radiusYå’Œrotationä¸ºéšè—å‚æ•°ï¼Œå‰è€…è¡¨ç¤ºçºµå‘åŠå¾„ï¼ŒåŽè€…è¡¨ç¤ºé¡ºæ—¶é’ˆæ—‹è½¬è§’åº¦ã€‚ç»˜åˆ¶ä¸ªæ›²çº¿å›¾ï¼š1234567891011context.strokeStyle = "rgba(66,185,131,0.9)";context.lineWidth = 2;context.beginPath();context.moveTo(10,50);//æ›²çº¿çš„èµ·ç‚¹context.lineTo(100,50);//(150,50)æ›²çº¿çš„æŽ§åˆ¶ç‚¹ï¼Œ(150,100)æ›²çº¿çš„ç»ˆç‚¹ï¼Œæ›²çº¿åŠå¾„ä¸º50context.arcTo(150,50,150,100,50);//å†æ¥ä¸€æ¡context.arcTo(100,100,100,50,50);context.stroke();æ•ˆæžœå›¾ï¼šå›¾å½¢ä¸Šä¸‹æ–‡çš„bezierCurveToæ–¹æ³•ç”¨ä»¥ä¸‰æ¬¡ç»˜åˆ¶è´å¡žå°”æ›²çº¿ã€‚1context.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y); â€‹å…¶ä¸­cp1xä¸ºç¬¬ä¸€ä¸ªè´å¡žå°”æŽ§åˆ¶ç‚¹çš„ x åæ ‡ï¼Œcp1yä¸ºç¬¬ä¸€ä¸ªè´å¡žå°”æŽ§åˆ¶ç‚¹çš„ y åæ ‡ã€‚cp2xä¸ºç¬¬äºŒä¸ªè´å¡žå°”æŽ§åˆ¶ç‚¹çš„ x åæ ‡ï¼Œcp2yä¸ºç¬¬äºŒä¸ªè´å¡žå°”æŽ§åˆ¶ç‚¹çš„ y åæ ‡ã€‚xï¼Œyä¸ºç»ˆç‚¹åæ ‡ã€‚ä¾‹å¦‚ï¼š123456context.strokeStyle = "rgba(66,185,131,0.9)";context.lineWidth = 2;context.beginPath();context.moveTo(50, 150);context.bezierCurveTo(150, 100, 150, 200, 250, 150);context.stroke();æ•ˆæžœå›¾ï¼šè´å¡žå°”æ›²çº¿åœ¨çº¿ç”Ÿæˆå·¥å…·ï¼šhttp://www.j--d.com/bezierå›¾å½¢ä¸Šä¸‹æ–‡çš„quadraticCurveToæ–¹æ³•ç”¨ä»¥äºŒæ¬¡ç»˜åˆ¶è´å¡žå°”æ›²çº¿ï¼š1context.quadraticCurveTo(cpx,cpy,x,y);ç›¸è¾ƒäºŽbezierCurveToæ–¹æ³•ï¼Œå…¶åªæœ‰ä¸€ä¸ªæŽ§åˆ¶ç‚¹ã€‚cpxï¼Œcpyä¸ºæŽ§åˆ¶ç‚¹çš„åæ ‡ï¼Œxï¼Œyä¸ºç»ˆç‚¹åæ ‡ã€‚ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š123456context.strokeStyle = "rgba(66,185,131,0.9)";context.lineWidth = 2;context.beginPath();context.moveTo(50, 50);context.quadraticCurveTo(250, 150, 150, 50);context.stroke();æ•ˆæžœå›¾ï¼šã€ŠHTML5ä¸ŽCSS3æƒå¨æŒ‡å—ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>HTML5</tag>
        <tag>Canvas</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxæ‰“åŒ…æŒ‡ä»¤tar]]></title>
    <url>%2FLinux%E6%89%93%E5%8C%85%E6%8C%87%E4%BB%A4tar.html</url>
    <content type="text"><![CDATA[gzip, bzip2, xz ä¹Ÿèƒ½å¤Ÿé’ˆå¯¹ç›®å½•æ¥è¿›è¡ŒåŽ‹ç¼©ï¼Œä¸è¿‡å®ƒä»¬éƒ½æ˜¯å¯¹ç›®å½•ä¸‹çš„æ–‡ä»¶é€ä¸ªåŽ‹ç¼©çš„ã€‚è€ŒtaræŒ‡ä»¤åˆ™å¯ä»¥å°†è¿™äº›æ–‡ä»¶å…ˆæ‰“åŒ…æˆä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œç„¶åŽå†è¿›è¡ŒåŽ‹ç¼©æ“ä½œã€‚ä»…ç”¨tarå‘½ä»¤æ‰“åŒ…ä¸åŽ‹ç¼©çš„æ–‡ä»¶ï¼Œç§°ä¸ºtarfileï¼Œæ—¢æ‰“åŒ…åˆåŽ‹ç¼©çš„æ–‡ä»¶ï¼Œå¦‚file.tar.gzåˆ™æˆä¸ºtarballã€‚taræŒ‡ä»¤çš„é€‰é¡¹éžå¸¸å¤šï¼Œä¸€èˆ¬åªæ˜¯ç”¨å‡ ä¸ªå¸¸ç”¨çš„ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š12345678910111213141516tar [-z|-j|-J] [cv] [-f å¾…å»ºç«‹çš„æ–‡ä»¶å] filename... &lt;==æ‰“åŒ…ä¸ŽåŽ‹ç¼©tar [-z|-j|-J] [tv] [-f å·²æœ‰çš„taræ ¼å¼æ–‡ä»¶å] &lt;==æŸ¥çœ‹æ–‡ä»¶åtar [-z|-j|-J] [xv] [-f å·²æœ‰çš„taræ ¼å¼æ–‡ä»¶å] [-C ç›®å½•] &lt;==è§£åŽ‹ç¼©é€‰é¡¹ä¸Žå‚æ•°ï¼š-c ï¼šå»ºç«‹æ‰“åŒ…æ–‡ä»¶ï¼Œå¯æ­é… -v æ¥å¯Ÿçœ‹è¿‡ç¨‹ä¸­è¢«æ‰“åŒ…çš„æ¡£å(filename)-t ï¼šå¯Ÿçœ‹æ‰“åŒ…æ–‡ä»¶çš„å†…å®¹å«æœ‰å“ªäº›æ¡£åï¼Œé‡ç‚¹åœ¨å¯Ÿçœ‹ã€Žæ¡£åã€å°±æ˜¯äº†ï¼›-x ï¼šè§£æ‰“åŒ…æˆ–è§£åŽ‹ç¼©çš„åŠŸèƒ½ï¼Œå¯ä»¥æ­é… -C (å¤§å†™) åœ¨ç‰¹å®šç›®å½•è§£å¼€ã€‚ç‰¹åˆ«ç•™æ„çš„æ˜¯ï¼Œ -c, -t, -x ä¸å¯åŒæ—¶å‡ºçŽ°åœ¨ä¸€ä¸²æŒ‡ä»¤åˆ—ä¸­ã€‚-z ï¼šé€è¿‡ gzip çš„æ”¯æŒè¿›è¡ŒåŽ‹ç¼©/è§£åŽ‹ç¼©ï¼šæ­¤æ—¶æ¡£åæœ€å¥½ä¸º *.tar.gz-j ï¼šé€è¿‡ bzip2 çš„æ”¯æŒè¿›è¡ŒåŽ‹ç¼©/è§£åŽ‹ç¼©ï¼šæ­¤æ—¶æ¡£åæœ€å¥½ä¸º *.tar.bz2-J ï¼šé€è¿‡ xz çš„æ”¯æŒè¿›è¡ŒåŽ‹ç¼©/è§£åŽ‹ç¼©ï¼šæ­¤æ—¶æ¡£åæœ€å¥½ä¸º *.tar.xzã€‚ç‰¹åˆ«ç•™æ„ï¼Œ -z, -j, -J ä¸å¯ä»¥åŒæ—¶å‡ºçŽ°åœ¨ä¸€ä¸²æŒ‡ä»¤åˆ—ä¸­-v ï¼šåœ¨åŽ‹ç¼©/è§£åŽ‹ç¼©çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ­£åœ¨å¤„ç†çš„æ–‡ä»¶åæ˜¾ç¤ºå‡ºæ¥ï¼-f filenameï¼š-f åŽé¢è¦ç«‹åˆ»æŽ¥è¦è¢«å¤„ç†çš„æ¡£åï¼å»ºè®® -f å•ç‹¬å†™ä¸€ä¸ªé€‰é¡¹-C ç›®å½• ï¼šè¿™ä¸ªé€‰é¡¹ç”¨åœ¨è§£åŽ‹ç¼©ï¼Œè‹¥è¦åœ¨ç‰¹å®šç›®å½•è§£åŽ‹ç¼©ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ã€‚-p(å°å†™) ï¼šä¿ç•™å¤‡ä»½æ•°æ®çš„åŽŸæœ¬æƒé™ä¸Žå±žæ€§ï¼Œå¸¸ç”¨äºŽå¤‡ä»½(-c)é‡è¦çš„é…ç½®æ–‡ä»¶-P(å¤§å†™) ï¼šä¿ç•™ç»å¯¹è·¯å¾„ï¼Œäº¦å³å…è®¸å¤‡ä»½æ•°æ®ä¸­å«æœ‰æ ¹ç›®å½•å­˜åœ¨ä¹‹æ„ï¼›--exclude=FILEï¼šåœ¨åŽ‹ç¼©çš„è¿‡ç¨‹ä¸­ï¼Œä¸è¦å°† FILE æ‰“åŒ…ï¼ä¸€èˆ¬æ¥è¯´ï¼Œtarå‘½ä»¤åªè¦è®°ä½ä¸‹é¢è¿™ä¸ªèŒƒä¾‹å°±è¡Œäº†ï¼šåŽ‹ ç¼©ï¼štar -jcv -f filename.tar.bz2è¦è¢«åŽ‹ç¼©çš„æ–‡ä»¶æˆ–ç›®å½•åç§°æŸ¥ è¯¢ï¼štar -jtv -f filename.tar.bz2è§£åŽ‹ç¼©ï¼štar -jxv -f filename.tar.bz2 -Cæ¬²è§£åŽ‹ç¼©çš„ç›®å½•filename.tar.bz2 æ˜¯æˆ‘ä»¬è‡ªå·±å–çš„æ–‡ä»¶åï¼Œtar å¹¶ä¸ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆæ‰“åŒ…åŽ‹ç¼©åŽçš„æ–‡ä»¶åã€‚æ–‡ä»¶å‘½åæœ€å¥½ç¬¦åˆè§„èŒƒã€‚ç¤ºä¾‹ï¼šä½¿ç”¨tarå‘½ä»¤æ‰“åŒ…/etc/ç›®å½•ï¼Œç„¶åŽä½¿ç”¨-zï¼Œ-jï¼Œ-Jé€‰é¡¹è¿›è¡ŒåŽ‹ç¼©ï¼Œå¹¶è§‚å¯Ÿç»“æžœä¸Žè€—æ—¶1234567891011121314151617181920212223242526272829root@ubuntu:/temp# time tar -zpcv -f etc.tar.gz /etctar: Removing leading `/' from member names/etc//etc/ucf.conf/etc/selinux//etc/selinux/semanage.conf... real 0m0.848s //è€—æ—¶0.848ç§’user 0m0.456ssys 0m0.080s root@ubuntu:/temp# time tar -jpcv -f etc.tar.bz2 /etctar: Removing leading `/' from member names/etc//etc/ucf.conf/etc/selinux//etc/selinux/semanage.conf... real 0m1.781s //è€—æ—¶1.781ç§’user 0m1.220ssys 0m0.060s root@ubuntu:/temp# time tar -Jpcv -f etc.tar.xz /etc real 0m7.700s //è€—æ—¶7.700ç§’user 0m5.428ssys 0m0.456sæŸ¥é˜… tar æ–‡ä»¶çš„æ•°æ®å†…å®¹12345root@ubuntu:/temp# tar -ztv -f etc.tar.gz drwxr-xr-x root/root 0 2017-04-13 09:31 etc/-rw-r--r-- root/root 1260 2016-03-17 04:58 etc/ucf.confdrwxr-xr-x root/root 0 2016-04-21 06:07 etc/selinux/...å¯å‘çŽ°ï¼Œæ¯ä¸ªæ–‡ä»¶åéƒ½æ²¡äº†æ ¹ç›®å½•ã€‚æ­£å¦‚å¤‡ä»½çš„æ—¶å€™å‡ºçŽ°çš„è­¦å‘Šï¼štar: Removing leading `/â€˜ from member namesé‚£æ ·ã€‚è¿™ç§åšæ³•ä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢è§£åŽ‹ç¼©çš„æ—¶å€™å‡ºçŽ°è¦†ç›–æºæ–‡ä»¶çš„æƒ…å†µã€‚å¦‚æžœè¦ä¿ç•™æ–‡ä»¶çš„æ ¹ç›®å½•/ï¼Œåˆ™å¯ä»¥ä½¿ç”¨-Pï¼ˆå¤§å†™ï¼‰é€‰é¡¹ã€‚æŒ‡å®šç›®å½•è§£åŽ‹ç¼©å¦‚æžœç›´æŽ¥åœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ï¼štar -jxv -f /root/etc.tar.bz2ï¼Œåˆ™ç›®å½•ä¸‹ä¼šå¤šå‡ºä¸ªetcçš„ç›®å½•ã€‚å¦‚æžœè¦æŒ‡å®šè§£åŽ‹ç¼©çš„ç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨-Cé€‰é¡¹ã€‚å¦‚å°†/temp/etc.tar.gzè§£åŽ‹åˆ°/tmpç›®å½•ä¸‹1root@ubuntu:/temp# tar -zxv -f etc.tar.gz -C /tmpæŒ‡å®šè§£åŽ‹æŸä¸ªæ–‡ä»¶é™¤äº†ä¸€æ¬¡æ€§å…¨éƒ¨è§£åŽ‹ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŒ‡å®šè§£åŽ‹æŸä¸ªæ–‡ä»¶ã€‚æ¯”å¦‚æˆ‘è¦è§£åŽ‹etc.tar.gzä¸‹çš„etc/shadowï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š12root@ubuntu:/temp# tar -zxv -f etc.tar.gz etc/shadowetc/shadowæ‰“åŒ…æŸç›®å½•ï¼Œä½†ä¸å«è¯¥ç›®å½•ä¸‹çš„æŸäº›æ–‡ä»¶æ¯”å¦‚æˆ‘æƒ³æ‰“åŒ…/etcç›®å½•ï¼Œä½†æ˜¯ä¸æƒ³åŒ…å«ç›®å½•ä¸‹çš„pppå’Œqqqæ–‡ä»¶ï¼š1root@ubuntu:/temp# tar -zcv -f etc.tar.gz --exclude=/etc/ppp --exclude=/etc/qqq /etcæˆ–è€…ï¼š1root@ubuntu:/temp# vi exclude-fileé‡Œé¢è¾“å…¥12/etc/ppp/etc/qqqç„¶åŽä½¿ç”¨å‘½ä»¤ï¼š1root@ubuntu:/temp# tar -zcvf etc.tar.gz --exclude-from exclude-file /etcä»…å¤‡ä»½æ¯”æŸä¸ªæ—¶åˆ»è¿˜è¦æ–°çš„æ–‡ä»¶æ¯”å¦‚ï¼Œä»…å¤‡ä»½æ¯”/etc/passwdæ–‡ä»¶æ–°çš„æ–‡ä»¶ï¼ˆmtimeï¼‰ï¼š123456789root@ubuntu:/temp# ls -l /etc/passwd-rw-r--r-- 1 root root 2243 Apr 13 09:30 /etc/passwdroot@ubuntu:/temp# tar -zcv -f etc.newer.passwd.tar.gz --newer-mtime="2017/04/13 09:30" /etc/*tar: Option --newer-mtime: Treating date '2017/04/13 09:30' as 2017-04-13 09:30:00tar: Removing leading `/' from member names/etc/acpi/tar: /etc/acpi/asus-wireless.sh: file is unchanged; not dumpedtar: /etc/acpi/asus-keyboard-backlight.sh: file is unchanged; not dumped...ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå¸¸ç”¨åŽ‹ç¼©æŒ‡ä»¤]]></title>
    <url>%2FLinux%E5%B8%B8%E7%94%A8%E5%8E%8B%E7%BC%A9%E6%8C%87%E4%BB%A4.html</url>
    <content type="text"><![CDATA[Linux ä¸Šå¸¸è§çš„åŽ‹ç¼©æŒ‡ä»¤æœ‰ gzipï¼Œbzip2 ä»¥åŠæœ€æ–°çš„ xzã€‚åŽ‹ç¼©çŽ‡ä»Žé«˜åˆ°ä½Žä¸ºxzï¼Œbzip2ï¼Œgzipã€‚åŽ‹ç¼©çŽ‡è¶Šé«˜ï¼ŒåŽ‹ç¼©æ‰€èŠ±çš„æ—¶é—´å°±è¶Šé•¿ã€‚æ‰€ä»¥å®žé™…å·¥ä½œä¸­éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µåœ¨åŽ‹ç¼©çŽ‡å’ŒåŽ‹ç¼©æ—¶é—´ä¸­åšå‡ºæŠ‰æ‹©ã€‚ä»¥ä¸‹ä¸ºå‡ ä¸ªå¸¸è§çš„åŽ‹ç¼©æ–‡ä»¶æ‰©å±•åï¼š123456789*.Z compress ç¨‹åºåŽ‹ç¼©çš„æ–‡ä»¶ï¼›*.zip zip ç¨‹åºåŽ‹ç¼©çš„æ–‡ä»¶ï¼›*.gz gzip ç¨‹åºåŽ‹ç¼©çš„æ–‡ä»¶ï¼›*.bz2 bzip2 ç¨‹åºåŽ‹ç¼©çš„æ–‡ä»¶ï¼›*.xz xz ç¨‹åºåŽ‹ç¼©çš„æ–‡ä»¶ï¼›*.tar tar ç¨‹åºæ‰“åŒ…çš„æ•°æ®ï¼Œå¹¶æ²¡æœ‰åŽ‹ç¼©è¿‡ï¼›*.tar.gz tar ç¨‹åºæ‰“åŒ…çš„æ–‡ä»¶ï¼Œå…¶ä¸­å¹¶ä¸”ç»è¿‡ gzip çš„åŽ‹ç¼©*.tar.bz2 tar ç¨‹åºæ‰“åŒ…çš„æ–‡ä»¶ï¼Œå…¶ä¸­å¹¶ä¸”ç»è¿‡ bzip2 çš„åŽ‹ç¼©*.tar.xz tar ç¨‹åºæ‰“åŒ…çš„æ–‡ä»¶ï¼Œå…¶ä¸­å¹¶ä¸”ç»è¿‡ xz çš„åŽ‹ç¼©compressæŒ‡ä»¤å·²ç»è¿‡æ—¶äº†ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯gzipã€‚gzip, zcat/zmore/zless/zgrepgzipå¯ä»¥è§£å¼€ compressï¼Œzip ä¸Ž gzip ç­‰è½¯ä»¶æ‰€åŽ‹ç¼© çš„æ–‡ä»¶ã€‚ gzip æ‰€å»ºç«‹çš„åŽ‹ç¼©æ–‡ä»¶ä¸º *.gzï¼Œgzipè¯­æ³•ï¼š12345678gzip [-cdtv#] æ–‡ä»¶åzcat æ–‡ä»¶å.gzé€‰é¡¹ä¸Žå‚æ•°ï¼š-c ï¼šå°†åŽ‹ç¼©çš„æ•°æ®è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œå¯é€è¿‡æ•°æ®æµé‡å¯¼å‘æ¥å¤„ç†ï¼›-d ï¼šè§£åŽ‹ç¼©çš„å‚æ•°ï¼›-t ï¼šå¯ä»¥ç”¨æ¥æ£€éªŒä¸€ä¸ªåŽ‹ç¼©æ–‡ä»¶çš„ä¸€è‡´æ€§ï½žçœ‹çœ‹æ–‡ä»¶æœ‰æ— é”™è¯¯ï¼›-v ï¼šå¯ä»¥æ˜¾ç¤ºå‡ºåŽŸæ–‡ä»¶/åŽ‹ç¼©æ–‡ä»¶æ¡ˆçš„åŽ‹ç¼©æ¯”ç­‰ä¿¡æ¯ï¼›-# ï¼š# ä¸ºæ•°å­—çš„æ„æ€ï¼Œä»£è¡¨åŽ‹ç¼©ç­‰çº§ï¼Œ-1 æœ€å¿«ï¼Œä½†æ˜¯åŽ‹ç¼©æ¯”æœ€å·®ã€-9 æœ€æ…¢ï¼Œä½†æ˜¯åŽ‹ç¼©æ¯”æœ€å¥½ï¼é¢„è®¾æ˜¯ -6ç¤ºä¾‹ï¼šä½¿ç”¨gzipåŽ‹ç¼©/temp/servicesæ–‡ä»¶ï¼Œå¹¶æŸ¥çœ‹åŽ‹ç¼©æ¯”ï¼š12345root@ubuntu:/temp# gzip -v services services: 61.6% -- replaced with services.gzroot@ubuntu:/temp# ls -lh /etc/services services.gz -rw-r--r-- 1 root root 20K Oct 25 2014 /etc/services-rw-r--r-- 1 root root 7.4K Apr 17 16:15 services.gzå› ä¸ºservicesæ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨zcat/zmore/zless åŽ»è¯»å– ï¼š1234567root@ubuntu:/temp# zcat services.gz # Network services, Internet style## Note that it is presently the policy of IANA to assign a single well-known# port number for both TCP and UDP; hence, officially ports have two entries# even if the protocol doesn't support UDP operations....å°†services.gzè§£åŽ‹ç¼©ï¼š1root@ubuntu:/temp# gzip -d services.gzä½¿ç”¨gzipæŒ‡ä»¤ä»¥æœ€å¥½çš„åŽ‹ç¼©æ¯”åŽ‹ç¼©servicesï¼Œå¹¶ä¿ç•™åŽŸæ–‡ä»¶ï¼š1gzip -9 -c services &gt; services.gz-c å¯ä»¥å°†åŽŸæœ¬è¦è½¬æˆåŽ‹ç¼©æ–‡ä»¶çš„èµ„æ–™å†…å®¹ï¼Œå°†å®ƒå˜æˆæ–‡å­—ç±»åž‹ä»Žå±å¹•è¾“å‡ºï¼Œ ç„¶åŽæˆ‘ä»¬å¯ä»¥é€è¿‡å¤§äºŽ (&gt;) è¿™ä¸ªç¬¦å·ï¼Œå°†åŽŸæœ¬åº”è¯¥ç”±å±å¹•è¾“å‡ºçš„æ•°æ®ï¼Œè½¬æˆè¾“å‡ºåˆ°æ–‡ä»¶è€Œä¸æ˜¯å±å¹•ï¼Œæ‰€ä»¥å°±èƒ½å¤Ÿå»ºç«‹å‡ºåŽ‹ç¼©æ–‡ä»¶äº†ã€‚åªæ˜¯æ–‡ä»¶åä¹Ÿè¦è‡ªå·±å†™ï¼Œ å½“ç„¶æœ€å¥½è¿˜æ˜¯éµå¾ª gzip çš„åŽ‹ç¼©æ–‡ä»¶åè§„èŒƒã€‚bzip2, bzcat/bzmore/bzless/bzgrepbzip2åˆ™æ˜¯ä¸ºäº†å–ä»£ gzip å¹¶æä¾›æ›´ä½³çš„åŽ‹ç¼©æ¯”è€Œæ¥çš„ï¼Œè¯­æ³•å’Œgzipå·®ä¸å¤šï¼š123456789bzip2 [-cdkzv#] æ–‡ä»¶åbzcat æ–‡ä»¶å.bz2é€‰é¡¹ä¸Žå‚æ•°ï¼š-c ï¼šå°†åŽ‹ç¼©çš„è¿‡ç¨‹äº§ç”Ÿçš„æ•°æ®è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚-d ï¼šè§£åŽ‹ç¼©çš„å‚æ•°ã€‚-k ï¼šä¿ç•™æºæ–‡ä»¶ï¼Œè€Œä¸ä¼šåˆ é™¤åŽŸå§‹çš„æ–‡ä»¶ã€‚-z ï¼šåŽ‹ç¼©çš„å‚æ•° (é»˜è®¤å€¼ï¼Œå¯ä»¥ä¸åŠ )ã€‚-v ï¼šå¯ä»¥æ˜¾ç¤ºå‡ºåŽŸæ–‡ä»¶/åŽ‹ç¼©æ–‡ä»¶æ¡ˆçš„åŽ‹ç¼©æ¯”ç­‰ä¿¡æ¯ã€‚-# ï¼šä¸Ž gzip åŒæ ·çš„ï¼Œéƒ½æ˜¯åœ¨è®¡ç®—åŽ‹ç¼©æ¯”çš„å‚æ•°ï¼Œ -9 æœ€ä½³ï¼Œ -1 æœ€å¿«ï¼ç¤ºä¾‹ï¼šä½¿ç”¨bzip2å‘½ä»¤åŽ‹ç¼©servicesæ–‡ä»¶ï¼š12root@ubuntu:/temp# bzip2 -v services services: 2.712:1, 2.950 bits/byte, 63.13% saved, 19605 in, 7229 out.xz, xzcat/xzmore/xzless/xzgrepbzip2 å·²ç»å…·æœ‰å¾ˆæ£’çš„åŽ‹ç¼©æ¯”ï¼Œä¸è¿‡æ˜¾ç„¶æŸäº›è‡ªç”±è½¯ä»¶å¼€å‘è€…è¿˜ä¸æ»¡è¶³ï¼Œå› æ­¤åŽæ¥è¿˜æŽ¨å‡ºäº† xz è¿™ä¸ªåŽ‹ç¼©æ¯”æ›´é«˜çš„è½¯ä»¶ã€‚xzçš„è¯­æ³•ï¼š123456789xz [-dtlkc#] æ–‡ä»¶åxcat æ–‡ä»¶å.xzé€‰é¡¹ä¸Žå‚æ•°ï¼š-d ï¼šå°±æ˜¯è§£åŽ‹ç¼©-t ï¼šæµ‹è¯•åŽ‹ç¼©æ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œçœ‹æœ‰æ²¡æœ‰é”™è¯¯-l ï¼šåˆ—å‡ºåŽ‹ç¼©æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯-k ï¼šä¿ç•™åŽŸæœ¬çš„æ–‡ä»¶ä¸åˆ é™¤-c ï¼šåŒæ ·çš„ï¼Œå°±æ˜¯å°†æ•°æ®ç”±å±å¹•ä¸Šè¾“å‡ºçš„æ„æ€-# ï¼šåŒæ ·çš„ï¼Œä¹Ÿæœ‰è¾ƒä½³çš„åŽ‹ç¼©æ¯”çš„æ„æ€å¯¹æ¯”åˆ†åˆ«ä½¿ç”¨gzipï¼Œbzip2å’Œxzå‘½ä»¤é»˜è®¤åŽ‹ç¼©æ¯”å¯¹serviceæ–‡ä»¶è¿›è¡ŒåŽ‹ç¼©ï¼Œå¹¶æŸ¥çœ‹æ—¶é—´ï¼š12345678910111213root@ubuntu:/temp# time gzip -c services &gt; services.gz;time bzip2 -k services;time xz -k services real 0m0.003suser 0m0.000ssys 0m0.000s real 0m0.004suser 0m0.000ssys 0m0.000s real 0m0.076suser 0m0.016ssys 0m0.020sæŸ¥çœ‹åŽ‹ç¼©åŽçš„æ–‡ä»¶å¤§å°ï¼š12345root@ubuntu:/temp# ls -l services services.gz services.bz2 services.xz -rw-r--r-- 1 root root 19605 Apr 17 16:42 services-rw-r--r-- 1 root root 7554 Apr 17 16:43 services.gz-rw-r--r-- 1 root root 7229 Apr 17 16:42 services.bz2-rw-r--r-- 1 root root 7156 Apr 17 16:42 services.xzã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€äº›JSæŠ€å·§[è½¬]]]></title>
    <url>%2F%E4%B8%80%E4%BA%9BJS%E6%8A%80%E5%B7%A7-%E8%BD%AC.html</url>
    <content type="text"><![CDATA[ä½¿ç”¨+å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—è¿™ä¸ªæŠ€å·§éžå¸¸æœ‰ç”¨ï¼Œå…¶éžå¸¸ç®€å•ï¼Œå¯ä»¥äº¤å­—ç¬¦ä¸²æ•°æ®è½¬æ¢æˆæ•°å­—ï¼Œä¸è¿‡å…¶åªé€‚åˆç”¨äºŽå­—ç¬¦ä¸²æ•°æ®ï¼Œå¦åˆ™å°†è¿”å›žNaNï¼Œæ¯”å¦‚ä¸‹é¢çš„ç¤ºä¾‹ï¼š12345function toNumber(strNumber) &#123; return +strNumber;&#125;console.log(toNumber("1234")); // 1234console.log(toNumber("ACB")); // NaNè¿™ä¸ªä¹Ÿé€‚ç”¨äºŽ Dateï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œå®ƒå°†è¿”å›žçš„æ˜¯æ—¶é—´æˆ³æ•°å­—ï¼š1console.log(+new Date()) // 1461288164385å¹¶æ¡ä»¶ç¬¦å¦‚æžœä½ å†™äº†ä¸€æ®µè¿™æ ·çš„ä»£ç ï¼š123if (conected) &#123; login();&#125;ä½ ä¹Ÿå¯ä»¥å°†å˜é‡ç®€å†™ï¼Œå¹¶ä¸”ä½¿ç”¨&amp;&amp;å’Œå‡½æ•°è¿žæŽ¥åœ¨ä¸€èµ·ï¼Œæ¯”å¦‚ä¸Šé¢çš„ç¤ºä¾‹ï¼Œå¯ä»¥ç®€å†™æˆè¿™æ ·ï¼š1conected &amp;&amp; login();ä½¿ç”¨ || è¿ç®—ç¬¦åœ¨ES6ä¸­æœ‰é»˜è®¤å‚æ•°è¿™ä¸€ç‰¹æ€§ã€‚ä¸ºäº†åœ¨è€ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­æ¨¡æ‹Ÿè¿™ä¸€ç‰¹æ€§ï¼Œå¯ä»¥ä½¿ç”¨||æ“ä½œç¬¦ï¼Œå¹¶ä¸”å°†å°†é»˜è®¤å€¼å½“åšç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ã€‚å¦‚æžœç¬¬ä¸€ä¸ªå‚æ•°è¿”å›žçš„å€¼ä¸º falseï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªå€¼å°†ä¼šè®¤ä¸ºæ˜¯ä¸€ä¸ªé»˜è®¤å€¼ã€‚å¦‚ä¸‹é¢è¿™ä¸ªç¤ºä¾‹ï¼š123456789101112function User(name, age) &#123; this.name = name || "Oliver Queen"; this.age = age || 27;&#125; var user1 = new User();console.log(user1.name); // Oliver Queenconsole.log(user1.age); // 27 var user2 = new User("Barry Allen", 25);console.log(user2.name); // Barry Allenconsole.log(user2.age); // 25æ£€æµ‹å¯¹è±¡ä¸­å±žæ€§å½“ä½ éœ€è¦æ£€æµ‹ä¸€äº›å±žæ€§æ˜¯å¦å­˜åœ¨ï¼Œé¿å…è¿è¡Œæœªå®šä¹‰çš„å‡½æ•°æˆ–å±žæ€§æ—¶ï¼Œè¿™ä¸ªå°æŠ€å·§å°±æ˜¾å¾—å¾ˆæœ‰ç”¨ã€‚å¦‚æžœä½ æ‰“ç®—å®šäº›ä¸€äº›è·¨å…¼å®¹çš„æµè§ˆå™¨ä»£ç ï¼Œä½ ä¹Ÿå¯èƒ½ä¼šç”¨åˆ°è¿™ä¸ªå°æŠ€å·§ã€‚ä¾‹å¦‚ï¼Œä½ æƒ³ä½¿ç”¨ document.querySelector() æ¥é€‰æ‹©ä¸€ä¸ª idï¼Œå¹¶ä¸”è®©å®ƒèƒ½å…¼å®¹IE6æµè§ˆå™¨ï¼Œä½†æ˜¯åœ¨IE6æµè§ˆå™¨ä¸­è¿™ä¸ªå‡½æ•°æ˜¯ä¸å­˜åœ¨çš„ï¼Œé‚£ä¹ˆä½¿ç”¨è¿™ä¸ªæ“ä½œç¬¦æ¥æ£€æµ‹è¿™ä¸ªå‡½æ•°æ˜¯å¦å­˜åœ¨å°±æ˜¾å¾—éžå¸¸çš„æœ‰ç”¨ï¼Œå¦‚ä¸‹é¢çš„ç¤ºä¾‹ï¼š12345if ('querySelector' in document) &#123; document.querySelector("#id");&#125; else &#123; document.getElementById("id");&#125;åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå¦‚æžœ document ä¸å­˜åœ¨ querySelector å‡½æ•°ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨ docuemnt.getElementById(&quot;id&quot;)ã€‚èŽ·å–æ•°ç»„ä¸­æœ€åŽä¸€ä¸ªå…ƒç´ Array.prototype.slice(begin,end)ç”¨æ¥èŽ·å–beginå’Œendä¹‹é—´çš„æ•°ç»„å…ƒç´ ã€‚å¦‚æžœä½ ä¸è®¾ç½®endå‚æ•°ï¼Œå°†ä¼šå°†æ•°ç»„çš„é»˜è®¤é•¿åº¦å€¼å½“ä½œendå€¼ã€‚ä½†æœ‰äº›åŒå­¦å¯èƒ½ä¸çŸ¥é“è¿™ä¸ªå‡½æ•°è¿˜å¯ä»¥æŽ¥å—è´Ÿå€¼ä½œä¸ºå‚æ•°ã€‚å¦‚æžœä½ è®¾ç½®ä¸€ä¸ªè´Ÿå€¼ä½œä¸ºbeginçš„å€¼ï¼Œé‚£ä¹ˆä½ å¯ä»¥èŽ·å–æ•°ç»„çš„æœ€åŽä¸€ä¸ªå…ƒç´ ã€‚å¦‚ï¼š12345var array = [1,2,3,4,5,6]; console.log(array.slice(-1)); // [6]console.log(array.slice(-2)); // [5,6]console.log(array.slice(-3)); // [4,5,6]æ•°ç»„æˆªæ–­è¿™ä¸ªå°æŠ€å·§ä¸»è¦ç”¨æ¥é”å®šæ•°ç»„çš„å¤§å°ï¼Œå¦‚æžœç”¨äºŽåˆ é™¤æ•°ç»„ä¸­çš„ä¸€äº›å…ƒç´ æ¥è¯´ï¼Œæ˜¯éžå¸¸æœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼Œä½ çš„æ•°ç»„æœ‰10ä¸ªå…ƒç´ ï¼Œä½†ä½ åªæƒ³åªè¦å‰äº”ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡ array.length=5 æ¥æˆªæ–­æ•°ç»„ã€‚å¦‚ä¸‹è¿™ä¸ªç¤ºä¾‹ï¼š123456var array = [1,2,3,4,5,6];console.log(array.length); // 6 array.length = 3;console.log(array.length); // 3console.log(array); // [1,2,3]åˆå¹¶æ•°ç»„å¦‚æžœä½ è¦åˆå¹¶ä¸¤ä¸ªæ•°ç»„ï¼Œä¸€èˆ¬æƒ…å†µä¹‹ä¸‹ä½ éƒ½ä¼šä½¿ç”¨Array.concat()å‡½æ•°ï¼š1234var array1 = [1,2,3];var array2 = [4,5,6]; console.log(array1.concat(array2)); // [1,2,3,4,5,6];ç„¶åŽè¿™ä¸ªå‡½æ•°å¹¶ä¸é€‚åˆç”¨æ¥åˆå¹¶ä¸¤ä¸ªå¤§åž‹çš„æ•°ç»„ï¼Œå› ä¸ºå…¶å°†æ¶ˆè€—å¤§é‡çš„å†…å­˜æ¥å­˜å‚¨æ–°åˆ›å»ºçš„æ•°ç»„ã€‚åœ¨è¿™ç§æƒ…å†µä¹‹ä¸ªï¼Œå¯ä»¥ä½¿ç”¨ Array.pus().apply(arr1,arr2)æ¥æ›¿ä»£åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ã€‚è¿™ç§æ–¹æ³•ä¸æ˜¯ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå…¶åªæ˜¯å°†ç¬¬ä¸€ä¸ªç¬¬äºŒä¸ªæ•°ç»„åˆå¹¶åœ¨ä¸€èµ·ï¼ŒåŒæ—¶å‡å°‘å†…å­˜çš„ä½¿ç”¨ï¼š1234var array1 = [1,2,3];var array2 = [4,5,6]; console.log(array1.push.apply(array1, array2)); // [1,2,3,4,5,6];å°†NodeListè½¬æ¢æˆæ•°ç»„å¦‚æžœä½ è¿è¡Œ document.querySelectorAll(â€œpâ€) å‡½æ•°æ—¶ï¼Œå®ƒå¯èƒ½è¿”å›žDOMå…ƒç´ çš„æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯NodeListå¯¹è±¡ã€‚ä½†è¿™ä¸ªå¯¹è±¡ä¸å…·æœ‰æ•°ç»„çš„å‡½æ•°åŠŸèƒ½ï¼Œæ¯”å¦‚ sort()ã€reduce()ã€map()ã€ilter() ç­‰ã€‚ä¸ºäº†è®©è¿™äº›åŽŸç”Ÿçš„æ•°ç»„å‡½æ•°åŠŸèƒ½ä¹Ÿèƒ½ç”¨äºŽå…¶ä¸Šé¢ï¼Œéœ€è¦å°†èŠ‚ç‚¹åˆ—è¡¨è½¬æ¢æˆæ•°ç»„ã€‚å¯ä»¥ä½¿ç”¨ [].slice.call(elements) æ¥å®žçŽ°ï¼š123var elements = document.querySelectorAll("p"); // NodeListvar arrayElements = [].slice.call(elements); // å°†NodeListè½¬åŒ–ä¸ºæ•°ç»„var arrayElements = Array.from(elements); // å¦ä¸€ç§æ–¹å¼å°†NodeListè½¬åŒ–ä¸ºæ•°ç»„HTML5 DOM é€‰æ‹©å™¨1234567// querySelector() è¿”å›žåŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªå…ƒç´ var item = document.querySelector('.item');console.log(item); // querySelectorAll() è¿”å›žåŒ¹é…åˆ°çš„æ‰€æœ‰å…ƒç´ ï¼Œæ˜¯ä¸€ä¸ªnodeListé›†åˆvar items = document.querySelectorAll('.item');console.log(items[0]);é¼ æ ‡æ»šè½®äº‹ä»¶12345678910111213$('#content').on("mousewheel DOMMouseScroll", function (event) &#123; // chrome &amp; ie || // firefox var delta = (event.originalEvent.wheelDelta &amp;&amp; (event.originalEvent.wheelDelta &gt; 0 ? 1 : -1)) || (event.originalEvent.detail &amp;&amp; (event.originalEvent.detail &gt; 0 ? -1 : 1)); if (delta &gt; 0) &#123; // å‘ä¸Šæ»šåŠ¨ console.log('mousewheel top'); &#125; else if (delta &lt; 0) &#123; // å‘ä¸‹æ»šåŠ¨ console.log('mousewheel bottom'); &#125; &#125;);æ£€æµ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒsvg1234567function isSupportSVG() &#123; var SVG_NS = 'http://www.w3.org/2000/svg'; return !!document.createElementNS &amp;&amp;!!document.createElementNS(SVG_NS, 'svg').createSVGRect; &#125; // æµ‹è¯•console.log(isSupportSVG());æ£€æµ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒcanvas12345678910function isSupportCanvas() &#123; if(document.createElement('canvas').getContext)&#123; return true; &#125;else&#123; return false; &#125;&#125; // æµ‹è¯•console.log(isSupportCanvas());è½¬è‡ªhttp://www.mrfront.com/]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxæ–‡ä»¶ä¸ŽæŒ‡ä»¤æœç´¢]]></title>
    <url>%2FLinux%E6%96%87%E4%BB%B6%E4%B8%8E%E6%8C%87%E4%BB%A4%E6%90%9C%E7%B4%A2.html</url>
    <content type="text"><![CDATA[å½“æˆ‘ä»¬è¦å¯¹Linuxä¸‹çš„æŸä¸ªæ–‡ä»¶åšä¿®æ”¹çš„æ—¶å€™ï¼Œå¿…é¡»å…ˆçŸ¥é“æ–‡ä»¶çš„ä½ç½®ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨æ–‡ä»¶æœç´¢æŒ‡ä»¤æ¥å®Œæˆã€‚è€ŒæŒ‡ä»¤çš„æœç´¢åˆ™å¯ä»¥çŸ¥é“è¯¥æŒ‡ä»¤æ–‡ä»¶çš„å®žé™…å­˜æ”¾ä½ç½®ã€‚æŒ‡ä»¤æœç´¢whiché€šè¿‡whichå¯ä»¥çŸ¥é“æŒ‡ä»¤çš„å®Œæ•´æ–‡ä»¶åæ”¾åœ¨å“ªé‡Œã€‚è¯­æ³•ï¼š123which [-a] commandé€‰é¡¹æˆ–å‚æ•°ï¼š-a ï¼šå°†æ‰€æœ‰ç”± PATH ç›®å½•ä¸­å¯ä»¥æ‰¾åˆ°çš„æŒ‡ä»¤å‡åˆ—å‡ºï¼Œè€Œä¸æ­¢ç¬¬ä¸€ä¸ªè¢«æ‰¾åˆ°çš„æŒ‡ä»¤åç§°ç®€å•ç¤ºä¾‹ï¼š123456mrbird@ubuntu:~$ which ls/bin/lsmrbird@ubuntu:~$ which passwd/usr/bin/passwdmrbird@ubuntu:~$ which which/usr/bin/whichtypeæŒ‡ä»¤ä¹Ÿå¯ä»¥å®žçŽ°æŒ‡ä»¤æœç´¢ï¼š1234mrbird@ubuntu:~$ type passwdpasswd is hashed (/usr/bin/passwd)mrbird@ubuntu:~$ type whichwhich is hashed (/usr/bin/which)æ–‡ä»¶æ¡£åçš„æœå¯»whereis (ç”±ä¸€äº›ç‰¹å®šçš„ç›®å½•ä¸­å¯»æ‰¾æ–‡ä»¶æ–‡ä»¶å)ï¼šwhereis åªæ‰¾ç³»ç»Ÿä¸­æŸäº›ç‰¹å®šç›®å½•åº•ä¸‹çš„æ–‡ä»¶ ï¼ŒåŸºæœ¬è¯­æ³•ï¼š1234567whereis [-bmsu] æ–‡ä»¶æˆ–ç›®å½•åé€‰é¡¹ä¸Žå‚æ•°ï¼š-l :å¯ä»¥åˆ—å‡º whereis ä¼šåŽ»æŸ¥è¯¢çš„å‡ ä¸ªä¸»è¦ç›®å½•è€Œå·²-b :åªæ‰¾ binary æ ¼å¼çš„æ–‡ä»¶-m :åªæ‰¾åœ¨è¯´æ˜Žæ–‡ä»¶ manual è·¯å¾„ä¸‹çš„æ–‡ä»¶-s :åªæ‰¾ source æ¥æºæ–‡ä»¶-u :æœå¯»ä¸åœ¨ä¸Šè¿°ä¸‰ä¸ªé¡¹ç›®å½“ä¸­çš„å…¶ä»–ç‰¹æ®Šæ–‡ä»¶ç¤ºä¾‹ï¼š1234567891011121314151617#æŸ¥çœ‹whereisæœå¯»çš„ç›®å½•ï¼šmrbird@ubuntu:~$ whereis -lbin: /usr/binbin: /usr/sbinbin: /usr/libbin: /binbin: /sbinbin: /etcbin: /libbin: /lib64... mrbird@ubuntu:~$ whereis passwdpasswd: /usr/bin/passwd /etc/passwd /usr/share/man/man1/passwd.1ssl.gz /usr/share/man/man1/passwd.1.gz /usr/share/man/man5/passwd.5.gz#åªæŸ¥æ‰¾åœ¨è¯´æ˜Žæ–‡ä»¶ manual è·¯å¾„ä¸‹çš„æ–‡ä»¶mrbird@ubuntu:~$ whereis -m passwdpasswd: /usr/share/man/man1/passwd.1ssl.gz /usr/share/man/man1/passwd.1.gz /usr/share/man/man5/passwd.5.gzlocate / updatedbï¼šlocateåˆ™æ˜¯åˆ©ç”¨æ•°æ®åº“æ¥æœå¯»æ–‡ä»¶åï¼Œå¹¶ä¸”æ²¡æœ‰å®žé™…çš„æœå¯»ç¡¬ç›˜å†…çš„æ–‡ä»¶ç³»ç»Ÿæ€ã€‚locateè¯­æ³•ï¼š1234567locate [-ir] keywordé€‰é¡¹ä¸Žå‚æ•°ï¼š-i ï¼šå¿½ç•¥å¤§å°å†™çš„å·®å¼‚ï¼›-c ï¼šä¸è¾“å‡ºæ¡£åï¼Œä»…è®¡ç®—æ‰¾åˆ°çš„æ–‡ä»¶æ•°é‡-l ï¼šä»…è¾“å‡ºå‡ è¡Œçš„æ„æ€ï¼Œä¾‹å¦‚è¾“å‡ºäº”è¡Œåˆ™æ˜¯ -l 5-S ï¼šè¾“å‡º locate æ‰€ä½¿ç”¨çš„æ•°æ®åº“æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯¥æ•°æ®åº“çºªå½•çš„æ–‡ä»¶/ç›®å½•æ•°é‡ç­‰-r ï¼šåŽé¢å¯æŽ¥æ­£è§„è¡¨ç¤ºæ³•çš„æ˜¾ç¤ºæ–¹å¼ç¤ºä¾‹ï¼š123456789101112131415#æ‰¾å‡ºç³»ç»Ÿä¸­æ‰€æœ‰ä¸Žpasswdç›¸å…³çš„æ¡£åï¼Œä¸”åªåˆ—å‡º5ä¸ªmrbird@ubuntu:~$ locate -l 5 passwd/etc/passwd/etc/passwd-/etc/cron.daily/passwd/etc/init/passwd.conf/etc/pam.d/chpasswd #åˆ—å‡ºlocateæŸ¥è¯¢æ‰€ä½¿ç”¨çš„æ•°æ®åº“æ–‡ä»¶ä¹‹æ–‡ä»¶åä¸Žå„æ•°æ®æ•°é‡mrbird@ubuntu:~$ locate -SDatabase /var/lib/mlocate/mlocate.db: 22,021 directories 218,810 files 11,880,406 bytes in file names 5,267,885 bytes used to store databaseä¸º locate å¯»æ‰¾çš„æ•°æ®æ˜¯ç”±å·²å»ºç«‹çš„æ•°æ®åº“ /var/lib/mlocate/é‡Œé¢çš„æ•°æ®æ‰€æœå¯»åˆ°çš„ï¼Œ æ‰€ä»¥ä¸ç”¨ç›´æŽ¥åœ¨åŽ»ç¡¬ç›˜å½“ä¸­å­˜å–æ•°æ®ã€‚è€Œæ•°æ®åº“çš„å»ºç«‹é»˜è®¤æ˜¯åœ¨æ¯å¤©æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥å½“ä½ æ–°å»ºç«‹èµ·æ¥çš„æ–‡ä»¶ï¼Œ å´è¿˜åœ¨æ•°æ®åº“æ›´æ–°ä¹‹å‰æœå¯»è¯¥æ–‡ä»¶ï¼Œé‚£ä¹ˆ locate ä¼šå‘Šè¯‰ä½ æ‰¾ä¸åˆ°ï¼å¯ä»¥ä½¿ç”¨updatedbæŒ‡ä»¤æ‰‹åŠ¨æ›´æ–°æ•°æ®åº“ï¼Œå› ä¸º updatedb ä¼šåŽ»æœå¯»ç¡¬ç›˜ï¼Œæ‰€ä»¥å½“ä½ æ‰§è¡Œ updatedb æ—¶ï¼Œå¯èƒ½ä¼šç­‰å¾…æ•°åˆ†é’Ÿçš„æ—¶é—´ã€‚findï¼šfindæŒ‡ä»¤ç›´æŽ¥æœç´¢ç¡¬ç›˜ï¼Œæ‰€ä»¥å…·ä½“æœç´¢æ—¶é—´æ ¹æ®ç¡¬ç›˜æ€§èƒ½è€Œå®šã€‚åŸºæœ¬è¯­æ³•ï¼šä¸Žæ—¶é—´æœ‰å…³çš„é€‰é¡¹ï¼š1234567find [PATH] [option] [action]é€‰é¡¹ä¸Žå‚æ•°ï¼š1. ä¸Žæ—¶é—´æœ‰å…³çš„é€‰é¡¹ï¼šå…±æœ‰ -atime, -ctime ä¸Ž -mtime ï¼Œä»¥ -mtime è¯´æ˜Ž -mtime n ï¼šn ä¸ºæ•°å­—ï¼Œæ„ä¹‰ä¸ºåœ¨ n å¤©ä¹‹å‰çš„ã€Žä¸€å¤©ä¹‹å†…ã€è¢«æ›´åŠ¨è¿‡å†…å®¹çš„æ–‡ä»¶ï¼› -mtime +n ï¼šåˆ—å‡ºåœ¨ n å¤©ä¹‹å‰(ä¸å« n å¤©æœ¬èº«)è¢«æ›´åŠ¨è¿‡å†…å®¹çš„æ–‡ä»¶æ¡£åï¼› -mtime -n ï¼šåˆ—å‡ºåœ¨ n å¤©ä¹‹å†…(å« n å¤©æœ¬èº«)è¢«æ›´åŠ¨è¿‡å†…å®¹çš„æ–‡ä»¶æ¡£åã€‚ -newer file ï¼šfile ä¸ºä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶ï¼Œåˆ—å‡ºæ¯” file è¿˜è¦æ–°çš„æ–‡ä»¶æ¡£åä¸¾ä¸ªä¾‹å­ï¼Œå½“nä¸º4æ—¶ï¼š+4 ä»£è¡¨å¤§äºŽç­‰äºŽ 5 å¤©å‰çš„æ¡£åï¼›-4 ä»£è¡¨å°äºŽç­‰äºŽ 4 å¤©å†…çš„æ–‡ä»¶æ¡£åï¼› 4 åˆ™æ˜¯ä»£è¡¨ 4-5 é‚£ä¸€å¤©çš„æ–‡ä»¶æ¡£åã€‚ç¤ºä¾‹ï¼š12345678910#åˆ—å‡º24å°æ—¶å†…æœ‰æ›´æ”¹è¿‡å†…å®¹ï¼ˆmtimeï¼‰çš„æ–‡ä»¶æ¡£åï¼šroot@ubuntu:~# find / -mtime 0 #å¯»æ‰¾/etcåº•ä¸‹çš„æ–‡ä»¶ï¼Œå¦‚æžœæ–‡ä»¶æ—¥æœŸæ¯”/etc/passwdæ–°å°±åˆ—å‡ºroot@ubuntu:~# find /etc -newer /etc/passwd/etc/etc/apparmor.d/etc/apparmor.d/cache/etc/apparmor.d/cache/.features/etc/gshadowä¸Žä½¿ç”¨è€…æˆ–ç»„åæœ‰å…³çš„å‚æ•°ï¼š12345678910é€‰é¡¹ä¸Žå‚æ•°ï¼š2. ä¸Žä½¿ç”¨è€…æˆ–ç»„åæœ‰å…³çš„å‚æ•°ï¼š -uid n ï¼šn ä¸ºæ•°å­—ï¼Œè¿™ä¸ªæ•°å­—æ˜¯ç”¨æˆ·çš„è´¦å· IDï¼Œäº¦å³ UID ï¼Œè¿™ä¸ª UID æ˜¯è®°å½•åœ¨ /etc/passwd é‡Œé¢ä¸Žè´¦å·åç§°å¯¹åº”çš„æ•°å­—ã€‚ -gid n ï¼šn ä¸ºæ•°å­—ï¼Œè¿™ä¸ªæ•°å­—æ˜¯ç»„åçš„ IDï¼Œäº¦å³ GIDï¼Œè¿™ä¸ª GID è®°å½•åœ¨/etc/groupã€‚ -user name ï¼šname ä¸ºä½¿ç”¨è€…è´¦å·åç§°ã€‚ä¾‹å¦‚ mrbirdã€‚ -group nameï¼šname ä¸ºç»„åï¼Œä¾‹å¦‚ users ã€‚ -nouser ï¼šå¯»æ‰¾æ–‡ä»¶çš„æ‹¥æœ‰è€…ä¸å­˜åœ¨ /etc/passwd çš„äººã€‚ -nogroup ï¼šå¯»æ‰¾æ–‡ä»¶çš„æ‹¥æœ‰ç¾¤ç»„ä¸å­˜åœ¨äºŽ /etc/group çš„æ–‡ä»¶ã€‚ å½“ä½ è‡ªè¡Œå®‰è£…è½¯ä»¶æ—¶ï¼Œå¾ˆå¯èƒ½è¯¥è½¯ä»¶çš„å±žæ€§å½“ä¸­å¹¶æ²¡æœ‰æ–‡ä»¶æ‹¥æœ‰è€…ï¼Œè¿™æ˜¯å¯èƒ½çš„ã€‚åœ¨è¿™ä¸ªæ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨ -nouser ä¸Ž -nogroup æœå¯»ã€‚ç¤ºä¾‹ï¼š12345678#æœå¯»/homeåº•ä¸‹å±žäºŽmrbirdç”¨æˆ·çš„æ–‡ä»¶root@ubuntu:~# find /home -user mrbird/home/mrbird/home/mrbird/.sudo_as_admin_successful... #æœå¯»ç³»ç»Ÿä¸­ä¸å±žäºŽä»»ä½•äººçš„æ–‡ä»¶root@ubuntu:~# find / -nouserä¸Žæ–‡ä»¶æƒé™åŠåç§°æœ‰å…³çš„å‚æ•°ï¼š1234567891011121314151617é€‰é¡¹ä¸Žå‚æ•°ï¼š3. ä¸Žæ–‡ä»¶æƒé™åŠåç§°æœ‰å…³çš„å‚æ•°ï¼š -name filenameï¼šæœå¯»æ–‡ä»¶åä¸º filename çš„æ–‡ä»¶ï¼› -size [+-]SIZEï¼šæœå¯»æ¯” SIZE è¿˜è¦å¤§(+)æˆ–å°(-)çš„æ–‡ä»¶ã€‚è¿™ä¸ª SIZE çš„è§„æ ¼æœ‰ï¼š c: ä»£è¡¨ byteï¼Œ k: ä»£è¡¨ 1024bytesã€‚æ‰€ä»¥ï¼Œè¦æ‰¾æ¯” 50KBè¿˜è¦å¤§çš„æ–‡ä»¶ï¼Œ å°±æ˜¯ã€Ž -size +50k ã€ -type TYPE ï¼šæœå¯»æ–‡ä»¶çš„ç±»åž‹ä¸º TYPE çš„ï¼Œç±»åž‹ä¸»è¦æœ‰ï¼šä¸€èˆ¬æ­£è§„æ–‡ä»¶ (f), è£…ç½®æ–‡ä»¶ (b, c), ç›®å½• (d), è¿žç»“æ¡£ (l), socket (s), åŠ FIFO (p) ç­‰å±žæ€§ã€‚ -perm mode ï¼šæœå¯»æ–‡ä»¶æƒé™ã€Žåˆšå¥½ç­‰äºŽã€ mode çš„æ–‡ä»¶ï¼Œè¿™ä¸ª mode ä¸ºç±»ä¼¼ chmod çš„å±žæ€§å€¼ï¼Œä¸¾ä¾‹æ¥è¯´ï¼Œ -rwxr-xr-x çš„å±žæ€§ä¸º 0755ã€‚ -perm -mode ï¼šæœå¯»æ–‡ä»¶æƒé™ã€Žå¿…é¡»è¦å…¨éƒ¨å›Šæ‹¬ mode çš„æƒé™ã€çš„æ–‡ä»¶ï¼Œä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ ä»¬è¦æœå¯» -rwxr--r-- ï¼Œäº¦å³ 0744 çš„æ–‡ä»¶ï¼Œä½¿ç”¨ -perm -0744ï¼Œ å½“ä¸€ä¸ªæ–‡ä»¶çš„æƒé™ä¸º -rwsr-xr-x ï¼Œäº¦å³ 4755 æ—¶ï¼Œä¹Ÿä¼šè¢«åˆ—å‡ºæ¥ï¼Œ å› ä¸º -rwsr-xr-x çš„å±žæ€§å·²ç»å›Šæ‹¬äº† -rwxr--r-- çš„å±žæ€§äº†ã€‚ -perm /mode ï¼šæœå¯»æ–‡ä»¶æƒé™ã€ŽåŒ…å«ä»»ä¸€ mode çš„æƒé™ã€çš„æ–‡ä»¶ï¼Œä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬æœå¯» -rwxr-xr-x ï¼Œäº¦å³ -perm /755 æ—¶ï¼Œå½“ä¸€ä¸ªæ–‡ä»¶å±žæ€§ä¸º -rw------- ä¹Ÿä¼šè¢«åˆ—å‡ºæ¥ï¼Œå› ä¸ºä»–æœ‰ -rw.... çš„å±žæ€§å­˜åœ¨.ç¤ºä¾‹ï¼š12345678910111213141516171819202122232425262728#æ‰¾å‡ºæ¡£åä¸ºpasswdè¿™ä¸ªæ–‡ä»¶root@ubuntu:~# find / -name passwd/usr/share/lintian/overrides/passwd/usr/share/doc/passwd/usr/share/bash-completion/completions/passwd...#æ‰¾å‡ºæ–‡ä»¶ååŒ…å«äº†passwdè¿™ä¸ªå…³é”®è¯çš„æ–‡ä»¶root@ubuntu:~# find / -name *passwd*/usr/share/app-install/desktop/kdepasswd:kde4__kdepasswd.desktop/usr/share/app-install/desktop/usermode:redhat-userpasswd.desktop/usr/share/lintian/overrides/base-passwd... #æ‰¾å‡º/runç›®å½•ä¸‹ï¼Œæ–‡ä»¶ç±»åž‹ä¸ºSocketçš„æ–‡ä»¶root@ubuntu:~# find /run -type s/run/NetworkManager/private-dhcp/run/cups/cups.sock/run/uuidd/request/run/avahi-daemon/socket... #æœå¯»æ–‡ä»¶æƒé™ä¸º666çš„æ–‡ä»¶root@ubuntu:~# find / -perm 666/dev/vsock/dev/net/tun/dev/ptmx...é¢å¤–å¯è¿›è¡Œçš„æ“ä½œï¼š1234é€‰é¡¹ä¸Žå‚æ•°ï¼š4. é¢å¤–å¯è¿›è¡Œçš„åŠ¨ä½œï¼š -exec command ï¼šcommand ä¸ºå…¶ä»–æŒ‡ä»¤ï¼Œ-exec åŽé¢å¯å†æŽ¥é¢å¤–çš„æŒ‡ä»¤æ¥å¤„ç†æœå¯»åˆ°çš„ç»“æžœã€‚ -print ï¼šå°†ç»“æžœæ‰“å°åˆ°å±å¹•ä¸Šï¼Œè¿™ä¸ªåŠ¨ä½œæ˜¯é¢„è®¾åŠ¨ä½œã€‚ç¤ºä¾‹ï¼š12345678#æœå¯»/runç›®å½•ä¸‹æ–‡ä»¶æƒé™ä¸º666çš„æ–‡ä»¶ï¼Œå¹¶ç”¨ls -lå‘½ä»¤æŸ¥çœ‹å…¶ä¿¡æ¯root@ubuntu:~# find /run -perm 666 -exec ls -l &#123;&#125; \;srw-rw-rw- 1 root root 0 Apr 13 10:34 /run/cups/cups.socksrw-rw-rw- 1 root root 0 Apr 13 10:34 /run/uuidd/requestsrw-rw-rw- 1 root root 0 Apr 13 10:34 /run/avahi-daemon/socketsrw-rw-rw- 1 root root 0 Apr 13 10:34 /run/acpid.socketsrw-rw-rw- 1 root root 0 Apr 13 10:34 /run/dbus/system_bus_socket...{}ä»£è¡¨çš„æ˜¯ç”± find æ‰¾åˆ°çš„å†…å®¹ï¼Œ-exec ä¸€ç›´åˆ°\;æ˜¯æ‰§è¡Œé¢å¤–åŠ¨ä½œçš„æŒ‡ä»¤ã€‚è¿™é‡Œä¸èƒ½ç”¨ç®¡çº¿æ¥ä»£æ›¿-execï¼š12root@ubuntu:~# find /run -perm 666 | ls -ltotal 0ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxæ–‡ä»¶é¢„è®¾æƒé™umask]]></title>
    <url>%2FLinux%E6%96%87%E4%BB%B6%E9%A2%84%E8%AE%BE%E6%9D%83%E9%99%90umask.html</url>
    <content type="text"><![CDATA[å½“æˆ‘ä»¬åœ¨Linuxä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•æˆ–æ–‡ä»¶çš„æ—¶å€™ï¼Œå®ƒéƒ½ä¼šæœ‰ä¸ªé»˜è®¤çš„æƒé™ã€‚è¿™ä¸ªæƒé™çš„è®¾å®šå’Œumaskæœ‰å…³ï¼ŒumaskæŒ‡çš„æ˜¯ï¼šç›®å‰ç”¨æˆ·åœ¨å»ºç«‹æ–‡ä»¶æˆ–ç›®å½•æ—¶å€™çš„æƒé™é»˜è®¤å€¼ã€‚æŸ¥é˜…å½“å‰ç”¨æˆ·umaskæ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§å¯ä»¥ç›´æŽ¥è¾“å…¥ umask ï¼Œå°±å¯ä»¥çœ‹åˆ°æ•°å­—åž‹æ€çš„æƒé™è®¾å®šåˆ†æ•°ï¼Œ ä¸€ç§åˆ™æ˜¯ åŠ å…¥ -S (Symbolic) è¿™ä¸ªé€‰é¡¹ï¼Œå°±ä¼šä»¥ç¬¦å·ç±»åž‹çš„æ–¹å¼æ¥æ˜¾ç¤ºå‡ºæƒé™äº†ï¼š1234root@ubuntu:~# umask0022root@ubuntu:~# umask -Su=rwx,g=rx,o=rxumaskçš„ç¬¬ä¸€ä¸ªå€¼ä¸ºç‰¹æ®Šæƒé™ã€‚å‰©ä¸‹çš„ä¸‰ä¸ªå€¼åˆ†åˆ«å°±ä»£è¡¨äº†rï¼Œwï¼Œxäº†ã€‚Linuxä¸­ï¼Œæ–‡ä»¶çš„é¢„è®¾æƒé™ä¸º-rw-rw-rw-ï¼Œç›®å½•çš„é¢„è®¾æƒé™ä¸ºdrwxrwxrwxã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œumask çš„åˆ†æ•°æŒ‡çš„æ˜¯è¯¥é»˜è®¤å€¼éœ€è¦å‡æŽ‰çš„æƒé™ï¼æ‰€ä»¥å¦‚æžœumaskçš„å€¼ä¸º022çš„æ—¶å€™ï¼Œåœ¨åˆ›å»ºæ–°æ–‡ä»¶æˆ–ç›®å½•çš„æ—¶å€™ï¼Œå…¶æƒé™çš„è®¡ç®—æ–¹å¼ä¸ºï¼šå»ºç«‹æ–‡ä»¶æ—¶ï¼š(-rw-rw-rw-) - (â€”â€“wâ€“w-) ==&gt; -rw-râ€“râ€“å»ºç«‹ç›®å½•æ—¶ï¼š(drwxrwxrwx) - (â€”â€“wâ€“w-) ==&gt; drwxr-xr-xéªŒè¯ä¸€ä¸‹ï¼š12345678root@ubuntu:~# cd /temproot@ubuntu:/temp# umask0022root@ubuntu:/temp# touch file1root@ubuntu:/temp# mkdir dir1root@ubuntu:/temp# ls -ld file1 dir1drwxr-xr-x 2 root root 4096 Apr 13 14:35 dir1-rw-r--r-- 1 root root 0 Apr 13 14:35 file1æ”¹å˜umaskçš„å€¼ï¼š123root@ubuntu:/temp# umask 033root@ubuntu:/temp# umask0033ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxæ–‡ä»¶éšè—å±žæ€§]]></title>
    <url>%2FLinux%E6%96%87%E4%BB%B6%E9%9A%90%E8%97%8F%E5%B1%9E%E6%80%A7.html</url>
    <content type="text"><![CDATA[Linuxæ–‡ä»¶æˆ–ç›®å½•é™¤äº†rwxrwxrwxä¹ä¸ªæƒé™è®¾å®šå¤–ï¼Œè¿˜æœ‰éšè—çš„å±žæ€§ã€‚è®¾ç½®æ–‡ä»¶æˆ–ç›®å½•çš„éšè—å±žæ€§å¯ä»¥æŒ‡ä»¤chattrï¼Œè€Œæ˜¾ç¤ºæ–‡ä»¶æˆ–ç›®å½•çš„éšè—å±žæ€§åˆ™ç”¨æŒ‡ä»¤lsattrã€‚chattrï¼šè¯­æ³•ï¼š123456789101112131415chattr [+-=][ASacdistu] æ–‡ä»¶æˆ–ç›®å½•åç§°é€‰é¡¹ä¸Žå‚æ•°ï¼š+ ï¼šå¢žåŠ æŸä¸€ä¸ªç‰¹æ®Šå‚æ•°ï¼Œå…¶ä»–åŽŸæœ¬å­˜åœ¨å‚æ•°åˆ™ä¸åŠ¨ã€‚- ï¼šç§»é™¤æŸä¸€ä¸ªç‰¹æ®Šå‚æ•°ï¼Œå…¶ä»–åŽŸæœ¬å­˜åœ¨å‚æ•°åˆ™ä¸åŠ¨ã€‚= ï¼šè®¾å®šä¸€å®šï¼Œä¸”ä»…æœ‰åŽé¢æŽ¥çš„å‚æ•°A ï¼šå½“è®¾å®šäº† A è¿™ä¸ªå±žæ€§æ—¶ï¼Œè‹¥ä½ æœ‰å­˜å–æ­¤æ–‡ä»¶(æˆ–ç›®å½•)æ—¶ï¼Œä»–çš„è®¿é—®æ—¶é—´ atime å°†ä¸ä¼šè¢«ä¿®æ”¹ï¼Œå¯é¿å… I/O è¾ƒæ…¢çš„æœºå™¨è¿‡åº¦çš„å­˜å–ç£ç›˜ã€‚S ï¼šä¸€èˆ¬æ–‡ä»¶æ˜¯å¼‚æ­¥å†™å…¥ç£ç›˜çš„ï¼Œå¦‚æžœåŠ ä¸Š S è¿™ä¸ªå±žæ€§æ—¶ï¼Œå½“ä½ è¿›è¡Œä»»ä½•æ–‡ä»¶çš„ä¿®æ”¹ï¼Œè¯¥æ›´åŠ¨ä¼šã€ŽåŒæ­¥ã€å†™å…¥ç£ç›˜ä¸­ã€‚a ï¼šå½“è®¾å®š a ä¹‹åŽï¼Œè¿™ä¸ªæ–‡ä»¶å°†åªèƒ½å¢žåŠ æ•°æ®ï¼Œè€Œä¸èƒ½åˆ é™¤ä¹Ÿä¸èƒ½ä¿®æ”¹æ•°æ®ï¼Œåªæœ‰ root æ‰èƒ½è®¾å®šè¿™å±žæ€§c ï¼šè¿™ä¸ªå±žæ€§è®¾å®šä¹‹åŽï¼Œå°†ä¼šè‡ªåŠ¨çš„å°†æ­¤æ–‡ä»¶ã€ŽåŽ‹ç¼©ã€ï¼Œåœ¨è¯»å–çš„æ—¶å€™å°†ä¼šè‡ªåŠ¨è§£åŽ‹ç¼©ï¼Œä½†æ˜¯åœ¨å‚¨å­˜çš„æ—¶å€™ï¼Œå°†ä¼šå…ˆè¿›è¡ŒåŽ‹ç¼©åŽå†å‚¨å­˜ã€‚d ï¼šå½“ dump ç¨‹åºè¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œè®¾å®š d å±žæ€§å°†å¯ä½¿è¯¥æ–‡ä»¶(æˆ–ç›®å½•)ä¸ä¼šè¢« dump å¤‡ä»½i ï¼šä»–å¯ä»¥è®©ä¸€ä¸ªæ–‡ä»¶ã€Žä¸èƒ½è¢«åˆ é™¤ã€æ”¹åã€è®¾å®šè¿žç»“ä¹Ÿæ— æ³•å†™å…¥æˆ–æ–°å¢žæ•°æ®ã€å¯¹äºŽç³»ç»Ÿå®‰å…¨æ€§æœ‰ç›¸å½“å¤§çš„å¸®åŠ©ã€‚åªæœ‰ root èƒ½è®¾å®šæ­¤å±žæ€§ã€‚s ï¼šå½“æ–‡ä»¶è®¾å®šäº† s å±žæ€§æ—¶ï¼Œå¦‚æžœè¿™ä¸ªæ–‡ä»¶è¢«åˆ é™¤ï¼Œä»–å°†ä¼šè¢«å®Œå…¨çš„ç§»é™¤å‡ºè¿™ä¸ªç¡¬ç›˜ç©ºé—´ï¼Œæ‰€ä»¥å¦‚æžœè¯¯åˆ äº†ï¼Œå®Œå…¨æ— æ³•æ•‘å›žæ¥äº†ã€‚u ï¼šä¸Ž s ç›¸åçš„ï¼Œå½“ä½¿ç”¨ u æ¥é…ç½®æ–‡ä»¶æ¡ˆæ—¶ï¼Œå¦‚æžœè¯¥æ–‡ä»¶è¢«åˆ é™¤äº†ï¼Œåˆ™æ•°æ®å†…å®¹å…¶å®žè¿˜å­˜åœ¨ç£ç›˜ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ¥æ•‘æ´è¯¥æ–‡ä»¶ã€‚æ³¨æ„ 1ï¼šå±žæ€§è®¾å®šå¸¸è§çš„æ˜¯ a ä¸Ž i çš„è®¾å®šå€¼ï¼Œè€Œä¸”å¾ˆå¤šè®¾å®šå€¼å¿…é¡»è¦èº«ä¸º root æ‰èƒ½è®¾å®šã€‚æ³¨æ„ 2ï¼šxfs æ–‡ä»¶ç³»ç»Ÿä»…æ”¯æ´ AadiS è€Œå·²ã€‚ç¤ºä¾‹ï¼šåœ¨/tempä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶åŠ å…¥ié€‰é¡¹ï¼Œç„¶åŽå°è¯•åˆ é™¤ï¼š1234root@ubuntu:/temp# touch file2root@ubuntu:/temp# chattr +i file2root@ubuntu:/temp# rm file2rm: cannot remove 'file2': Operation not permittedæ“ä½œè¢«æ‹’ç»ï¼Œåªæœ‰ç§»é™¤ié€‰é¡¹åŽï¼Œæ‰èƒ½å¤Ÿåˆ é™¤ï¼š12root@ubuntu:/temp# chattr -i file2root@ubuntu:/temp# rm file2lsattrï¼šè¯­æ³•ï¼š12345lsattr [-adR] æ–‡ä»¶æˆ–ç›®å½•é€‰é¡¹ä¸Žå‚æ•°ï¼š-a ï¼šå°†éšè—æ–‡ä»¶çš„å±žæ€§ä¹Ÿç§€å‡ºæ¥ï¼›-d ï¼šå¦‚æžœæŽ¥çš„æ˜¯ç›®å½•ï¼Œä»…åˆ—å‡ºç›®å½•æœ¬èº«çš„å±žæ€§è€Œéžç›®å½•å†…çš„æ–‡ä»¶åï¼›-R ï¼šè¿žåŒå­ç›®å½•çš„æ•°æ®ä¹Ÿä¸€å¹¶åˆ—å‡ºæ¥ã€‚ç¤ºä¾‹ï¼š1234root@ubuntu:/temp# touch file2root@ubuntu:/temp# chattr +iA file2root@ubuntu:/temp# lsattr file2----i--A-----e-- file2ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxæ–‡ä»¶æ—¶é—´ç±»åž‹]]></title>
    <url>%2FLinux%E6%96%87%E4%BB%B6%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B.html</url>
    <content type="text"><![CDATA[Linuxæ–‡ä»¶æœ‰ä¸‰ä¸ªä¸»è¦çš„å˜åŠ¨æ—¶é—´ï¼šmodification time (mtime)ï¼š å½“è¯¥æ–‡ä»¶çš„ã€Žå†…å®¹æ•°æ®ã€å˜æ›´æ—¶ï¼Œå°±ä¼šæ›´æ–°è¿™ä¸ªæ—¶é—´ã€‚å†…å®¹æ•°æ®æŒ‡çš„æ˜¯æ–‡ä»¶çš„å†…å®¹ï¼Œè€Œä¸æ˜¯æ–‡ä»¶çš„å±žæ€§æˆ–æƒé™ã€‚status time (ctime)ï¼š å½“è¯¥æ–‡ä»¶çš„ã€ŽçŠ¶æ€ (status)ã€æ”¹å˜æ—¶ï¼Œå°±ä¼šæ›´æ–°è¿™ä¸ªæ—¶é—´ï¼Œä¸¾ä¾‹æ¥è¯´ï¼Œåƒæ˜¯æƒé™ä¸Žå±žæ€§è¢«æ›´æ”¹äº†ï¼Œéƒ½ä¼šæ›´æ–°è¿™ä¸ªæ—¶é—´ã€‚access time (atime)ï¼š å½“ã€Žè¯¥æ–‡ä»¶çš„å†…å®¹è¢«å–ç”¨ã€æ—¶ï¼Œå°±ä¼šæ›´æ–°è¿™ä¸ªè¯»å–æ—¶é—´ (atime)ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨ cat åŽ»è¯»å–/etc/ltrace.confï¼Œ å°±ä¼šæ›´æ–°è¯¥æ–‡ä»¶çš„atime ã€‚æŸ¥çœ‹/etc/ltrace.confæ–‡ä»¶çš„ç›¸å…³æ—¶é—´ï¼š12345root@ubuntu:/home/mrbird# date;ls -l /etc/ltrace.conf;ls -l --time=atime /etc/ltrace.conf;ls -l --time=ctime /etc/ltrace.conf Wed Apr 12 02:32:27 PDT 2017-rw-r--r-- 1 root root 14867 Apr 11 2016 /etc/ltrace.conf-rw-r--r-- 1 root root 14867 Apr 12 00:31 /etc/ltrace.conf-rw-r--r-- 1 root root 14867 Apr 11 03:20 /etc/ltrace.confé»˜è®¤çš„æƒ…å†µä¸‹ï¼Œls æ˜¾ç¤ºå‡ºæ¥çš„æ˜¯è¯¥æ–‡ä»¶çš„ mtimeã€‚è¦ä¿®æ”¹æ–‡ä»¶ç›¸å…³æ—¶é—´å±žæ€§ï¼Œå¯ä»¥ä½¿ç”¨touchæŒ‡ä»¤ã€‚è¯­æ³•ï¼š1234567touch [-acdmt] æ–‡ä»¶é€‰é¡¹ä¸Žå‚æ•°ï¼š-a ï¼šä»…ä¿®è®¢ access timeï¼›-c ï¼šä»…ä¿®æ”¹æ–‡ä»¶çš„æ—¶é—´ï¼Œè‹¥è¯¥æ–‡ä»¶ä¸å­˜åœ¨åˆ™ä¸å»ºç«‹æ–°æ–‡ä»¶ï¼›-d ï¼šåŽé¢å¯ä»¥æŽ¥æ¬²ä¿®è®¢çš„æ—¥æœŸè€Œä¸ç”¨ç›®å‰çš„æ—¥æœŸï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ --date="æ—¥æœŸæˆ–æ—¶é—´"-m ï¼šä»…ä¿®æ”¹ mtime ï¼›-t ï¼šåŽé¢å¯ä»¥æŽ¥æ¬²ä¿®è®¢çš„æ—¶é—´è€Œä¸ç”¨ç›®å‰çš„æ—¶é—´ï¼Œæ ¼å¼ä¸º[YYYYMMDDhhmm]æ–°å»ºä¸€ä¸ªç©ºæ–‡ä»¶ï¼Œå¹¶æŸ¥çœ‹å…¶æ—¶é—´ï¼š123root@ubuntu:/temp# touch testouchroot@ubuntu:/temp# ls -l testouch-rw-r--r-- 1 root root 0 Apr 12 02:40 testouchä¿®æ”¹testouchçš„mtimeä¸ºä¸¤å¤©å‰ï¼š12root@ubuntu:/temp# ls -l testouch-rw-r--r-- 1 root root 0 Apr 10 02:45 testouchä¿®æ”¹testouchçš„atimeä¸º2017/01/01 00:00ï¼š123root@ubuntu:/temp# touch -a -t 201701010000 testouch root@ubuntu:/temp# ls -l --time=atime testouch -rw-r--r-- 1 root root 0 Jan 1 00:00 testouchã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxæ–‡ä»¶å†…å®¹æŸ¥é˜…]]></title>
    <url>%2FLinux%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E6%9F%A5%E9%98%85.html</url>
    <content type="text"><![CDATA[Linuxæ–‡ä»¶å†…å®¹æŸ¥é˜…ä¸»è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼šcatï¼šç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ã€‚tacï¼šä»Žæœ€åŽä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„å€’ç€å†™ã€‚nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºé“è¾“å‡ºè¡Œå·ã€‚moreï¼šä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ã€‚lessï¼šä¸Ž more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥å¾€å‰ç¿»é¡µã€‚headï¼šåªçœ‹å¤´å‡ è¡Œã€‚tailï¼šåªçœ‹å°¾å·´å‡ è¡Œã€‚odï¼šä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ–‡ä»¶å†…å®¹ã€‚ç›´æŽ¥æ£€è§†æ–‡ä»¶å†…å®¹catï¼šcat æ˜¯ Concatenate (è¿žç»­) çš„ç®€å†™ï¼Œä¸»è¦çš„åŠŸèƒ½æ˜¯å°†ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹è¿žç»­çš„å°å‡ºåœ¨å±å¹•ä¸Šé¢ã€‚è¯­æ³•ï¼š12345678cat [-AbEnTv]é€‰é¡¹ä¸Žå‚æ•°ï¼š-A ï¼šç›¸å½“äºŽ -vET çš„æ•´åˆé€‰é¡¹ï¼Œå¯åˆ—å‡ºä¸€äº›ç‰¹æ®Šå­—ç¬¦è€Œä¸æ˜¯ç©ºç™½è€Œå·²ï¼›-b ï¼šåˆ—å‡ºè¡Œå·ï¼Œä»…é’ˆå¯¹éžç©ºç™½è¡Œåšè¡Œå·æ˜¾ç¤ºï¼Œç©ºç™½è¡Œä¸æ ‡è¡Œå·ï¼-E ï¼šå°†ç»“å°¾çš„æ–­è¡Œå­—ç¬¦ $ æ˜¾ç¤ºå‡ºæ¥ï¼›-n ï¼šæ‰“å°å‡ºè¡Œå·ï¼Œè¿žåŒç©ºç™½è¡Œä¹Ÿä¼šæœ‰è¡Œå·ï¼Œä¸Ž -b çš„é€‰é¡¹ä¸åŒï¼›-T ï¼šå°† [tab] æŒ‰é”®ä»¥ ^I æ˜¾ç¤ºå‡ºæ¥ï¼›-v ï¼šåˆ—å‡ºä¸€äº›çœ‹ä¸å‡ºæ¥çš„ç‰¹æ®Šå­—ç¬¦ç¤ºä¾‹ï¼šä½¿ç”¨catå‘½ä»¤æŸ¥é˜…/etc/legalæ–‡ä»¶å†…å®¹ï¼Œå¹¶åŠ ä¸Šè¡Œå·ï¼š123456789root@ubuntu:~# cat -n /etc/legal 1 2 The programs included with the Ubuntu system are free software; 3 the exact distribution terms for each program are described in the 4 individual files in /usr/share/doc/copyright. 5 6 Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by 7 applicable law. 8tacï¼ˆåå‘åˆ—ç¤ºï¼‰ï¼štac åˆšå¥½æ˜¯å°† cat åå†™è¿‡æ¥ï¼Œæ‰€ä»¥ä»–çš„åŠŸèƒ½å°±è·Ÿ cat ç›¸åã€‚cat æ˜¯ç”±ç¬¬ä¸€è¡Œåˆ°æœ€åŽä¸€è¡Œè¿žç»­æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œè€Œ tac åˆ™æ˜¯ç”±æœ€åŽä¸€è¡Œåˆ°ç¬¬ä¸€è¡Œåå‘åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå‡ºæ¥ã€‚ä½¿ç”¨tacå‘½ä»¤æŸ¥é˜…/etc/legalæ–‡ä»¶å†…å®¹ï¼š12345678root@ubuntu:~# tac /etc/legal applicable law.Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by individual files in /usr/share/doc/copyright.the exact distribution terms for each program are described in theThe programs included with the Ubuntu system are free software;nlï¼ˆæ·»åŠ è¡Œå·æ‰“å°ï¼‰ï¼šnlå¯ä»¥å°†è¾“å‡ºçš„æ–‡ä»¶å†…å®¹è‡ªåŠ¨çš„åŠ ä¸Šè¡Œå·ã€‚å…¶é¢„è®¾çš„ç»“æžœä¸Žcat -næœ‰ç‚¹ä¸å¤ªä¸€æ ·ï¼Œ nlå¯ä»¥å°†è¡Œå·åšæ¯”è¾ƒå¤šçš„æ˜¾ç¤ºè®¾è®¡ï¼ŒåŒ…æ‹¬ä½æ•°ä¸Žæ˜¯å¦è‡ªåŠ¨è¡¥é½ 0 ç­‰ç­‰çš„åŠŸèƒ½ã€‚è¯­æ³•ï¼š12345678910nl [-bnw] æ–‡ä»¶é€‰é¡¹ä¸Žå‚æ•°ï¼š-b ï¼šæŒ‡å®šè¡Œå·æŒ‡å®šçš„æ–¹å¼ï¼Œä¸»è¦æœ‰ä¸¤ç§ï¼š -b a ï¼šè¡¨ç¤ºä¸è®ºæ˜¯å¦ä¸ºç©ºè¡Œï¼Œä¹ŸåŒæ ·åˆ—å‡ºè¡Œå·(ç±»ä¼¼ cat -n)ï¼› -b t ï¼šå¦‚æžœæœ‰ç©ºè¡Œï¼Œç©ºçš„é‚£ä¸€è¡Œä¸è¦åˆ—å‡ºè¡Œå·(é»˜è®¤å€¼)ï¼›-n ï¼šåˆ—å‡ºè¡Œå·è¡¨ç¤ºçš„æ–¹æ³•ï¼Œä¸»è¦æœ‰ä¸‰ç§ï¼š -n ln ï¼šè¡Œå·åœ¨å±å¹•çš„æœ€å·¦æ–¹æ˜¾ç¤ºï¼› -n rn ï¼šè¡Œå·åœ¨è‡ªå·±å­—æ®µçš„æœ€å³æ–¹æ˜¾ç¤ºï¼Œä¸”ä¸åŠ  0 ï¼› -n rz ï¼šè¡Œå·åœ¨è‡ªå·±å­—æ®µçš„æœ€å³æ–¹æ˜¾ç¤ºï¼Œä¸”åŠ  0 ï¼›-w ï¼šè¡Œå·å­—æ®µçš„å ç”¨çš„å­—ç¬¦æ•°ç¤ºä¾‹ï¼šä½¿ç”¨nlæ˜¾ç¤º/etc/legalæ–‡ä»¶å†…å®¹ï¼š12345678root@ubuntu:~# nl /etc/legal 1 The programs included with the Ubuntu system are free software; 2 the exact distribution terms for each program are described in the 3 individual files in /usr/share/doc/copyright. 4 Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by 5 applicable law.å¯è§ï¼Œç©ºè¡Œå¹¶æ²¡æœ‰æ˜¾ç¤ºè¡Œå·ï¼Œå¯ä»¥ä½¿ç”¨-b aé€‰é¡¹æ˜¾ç¤ºç©ºè¡Œè¡Œå·ï¼š123456789root@ubuntu:~# nl -b a /etc/legal 1 2 The programs included with the Ubuntu system are free software; 3 the exact distribution terms for each program are described in the 4 individual files in /usr/share/doc/copyright. 5 6 Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by 7 applicable law. 8å¯ç¿»é¡µæŸ¥é˜…å½“æ–‡ä»¶å†…å®¹è¾ƒå¤šçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨moreå’Œlesså‘½ä»¤æ¥ç¿»é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ã€‚moreï¼šä½¿ç”¨moreæŸ¥é˜…/etc/ltrace.confï¼Œé¡µé¢æœ€åŽä¸€è¡Œä¼šæ˜¾ç¤ºå‡ºç›®å‰æ˜¾ç¤ºçš„ç™¾åˆ†æ¯”ï¼šè¿˜å¯ä»¥åœ¨æœ€åŽä¸€è¡Œè¾“å…¥ä¸€äº›æœ‰ç”¨çš„æŒ‡ä»¤ï¼š123456ç©ºæ ¼é”® (space)ï¼šä»£è¡¨å‘ä¸‹ç¿»ä¸€é¡µï¼›Enter ï¼šä»£è¡¨å‘ä¸‹ç¿»ä¸€è¡Œï¼›/å­—ç¬¦ä¸² ï¼šä»£è¡¨åœ¨è¿™ä¸ªæ˜¾ç¤ºçš„å†…å®¹å½“ä¸­ï¼Œå‘ä¸‹æœå¯»ã€Žå­—ç¬¦ä¸²ã€è¿™ä¸ªå…³é”®è¯ï¼›:f ï¼šç«‹åˆ»æ˜¾ç¤ºå‡ºæ–‡ä»¶åä»¥åŠç›®å‰æ˜¾ç¤ºçš„è¡Œæ•°ï¼›q ï¼šä»£è¡¨ç«‹åˆ»ç¦»å¼€ more ï¼Œä¸å†æ˜¾ç¤ºè¯¥æ–‡ä»¶å†…å®¹ï¼›b æˆ– [ctrl]-b ï¼šä»£è¡¨å¾€å›žç¿»é¡µï¼Œä¸è¿‡è¿™åŠ¨ä½œåªå¯¹æ–‡ä»¶æœ‰ç”¨ï¼Œå¯¹ç®¡çº¿æ— ç”¨ã€‚ â€‹lessï¼šless çš„ç”¨æ³•æ¯”èµ· more åˆæ›´åŠ çš„æœ‰å¼¹æ€§ï¼Œlesså¯ç”¨çš„æŒ‡ä»¤æœ‰ï¼š bash ç©ºæ ¼é”® ï¼šå‘ä¸‹ç¿»åŠ¨ä¸€é¡µï¼› [pagedown]ï¼šå‘ä¸‹ç¿»åŠ¨ä¸€é¡µï¼› [pageup] ï¼šå‘ä¸Šç¿»åŠ¨ä¸€é¡µï¼› /å­—ç¬¦ä¸² ï¼šå‘ä¸‹æœå¯»ã€Žå­—ç¬¦ä¸²ã€çš„åŠŸèƒ½ï¼› ?å­—ç¬¦ä¸² ï¼šå‘ä¸Šæœå¯»ã€Žå­—ç¬¦ä¸²ã€çš„åŠŸèƒ½ï¼› n ï¼šé‡å¤å‰ä¸€ä¸ªæœå¯» (ä¸Ž / æˆ– ? æœ‰å…³) N ï¼šåå‘çš„é‡å¤å‰ä¸€ä¸ªæœå¯» (ä¸Ž / æˆ– ? æœ‰å…³) g ï¼šå‰è¿›åˆ°è¿™ä¸ªèµ„æ–™çš„ç¬¬ä¸€è¡ŒåŽ»ï¼› G ï¼šå‰è¿›åˆ°è¿™ä¸ªæ•°æ®çš„æœ€åŽä¸€è¡ŒåŽ» (æ³¨æ„å¤§å°å†™)ï¼› q ï¼šç¦»å¼€ less è¿™ä¸ªç¨‹åºã€‚ â€‹12345678## ä»¥è¡Œä¸ºå•ä½æŸ¥é˜…### headï¼ˆå–å‡ºå‰é¢å‡ è¡Œï¼‰ï¼šè¯­æ³•ï¼š```bashhead [-n number] æ–‡ä»¶ é€‰é¡¹ä¸Žå‚æ•°ï¼š-n ï¼šåŽé¢æŽ¥æ•°å­—ï¼Œä»£è¡¨æ˜¾ç¤ºå‡ è¡Œçš„æ„æ€ç¤ºä¾‹ï¼š12345678910#ä½¿ç”¨headæŒ‡ä»¤æŸ¥é˜…/etc/ltrace.confï¼Œé»˜è®¤è¾“å‡ºå‰10è¡Œroot@ubuntu:~# head /etc/ltrace.conf ; ltrace.conf;; ~/.ltrace.conf will also be read, if it exists. The -F option may be...#åªæŸ¥çœ‹å‰1è¡Œroot@ubuntu:~# head -n 1 /etc/ltrace.conf ; ltrace.confå¦‚æžœæ•°å­—æ˜¯è´Ÿæ•°çš„è¯ï¼Œå¦‚ä½¿ç”¨æŒ‡ä»¤head -n -100 /etc/file åˆ™è¡¨ç¤ºè¾“å‡ºfileæ–‡ä»¶åŽ»é™¤åŽ100è¡ŒåŽçš„æ‰€æœ‰è¡Œã€‚å³å¦‚æžœfileæ–‡ä»¶æœ‰150è¡Œï¼Œä½¿ç”¨è¯¥æŒ‡ä»¤åŽï¼Œåªä¼šè¾“å‡ºå‰50è¡Œã€‚tailï¼ˆå–å‡ºåŽé¢å‡ è¡Œï¼‰ï¼šè¯­æ³•ï¼š12345tail [-n number] æ–‡ä»¶ é€‰é¡¹ä¸Žå‚æ•°ï¼š-n ï¼šåŽé¢æŽ¥æ•°å­—ï¼Œä»£è¡¨æ˜¾ç¤ºå‡ è¡Œçš„æ„æ€-f ï¼šè¡¨ç¤ºæŒç»­ä¾¦æµ‹åŽé¢æ‰€æŽ¥çš„æ¡£åï¼Œè¦ç­‰åˆ°æŒ‰ä¸‹[ctrl]-c æ‰ä¼šç»“æŸ tail çš„ä¾¦æµ‹ä½¿ç”¨æ–¹æ³•å’Œheadç±»ä¼¼ã€‚å¦‚æžœè¦æŸ¥é˜…/etc/ltrace.confç¬¬11è¡Œåˆ°20è¡Œçš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç®¡çº¿ (|)è¿žæŽ¥headå’ŒtailæŒ‡ä»¤ã€‚ç®¡çº¿çš„æ„æ€æ˜¯ï¼šå‰é¢çš„æŒ‡ä»¤æ‰€è¾“å‡ºçš„è®¯æ¯ï¼Œè¯·é€è¿‡ç®¡çº¿äº¤ç”±åŽç»­ çš„æŒ‡ä»¤ç»§ç»­ä½¿ç”¨ã€‚1234567891011root@ubuntu:~# head -n 20 /etc/ltrace.conf | tail -n 10typedef in_addr = struct(hex(uint));int inet_aton(string, +in_addr*);hex(uint) inet_addr(string);hex(uint) inet_network(string);string inet_ntoa(in_addr);in_addr inet_makeaddr(hex(int), hex(int));hex(uint) inet_lnaof(in_addr);hex(uint) inet_netof(in_addr); ; bfd.håŠ ä¸Šè¡Œå·ï¼š1234567891011root@ubuntu:~# cat -n /etc/ltrace.conf | head -n 20 | tail -n 10 11 typedef in_addr = struct(hex(uint)); 12 int inet_aton(string, +in_addr*); 13 hex(uint) inet_addr(string); 14 hex(uint) inet_network(string); 15 string inet_ntoa(in_addr); 16 in_addr inet_makeaddr(hex(int), hex(int)); 17 hex(uint) inet_lnaof(in_addr); 18 hex(uint) inet_netof(in_addr); 19 20 ; bfd.héžçº¯æ–‡æœ¬æ¡£ï¼š odå½“æŸ¥é˜…éžæ–‡æœ¬æ–‡ä»¶çš„æ—¶å€™ï¼Œåº”è¯¥ä½¿ç”¨odå‘½ä»¤ã€‚è¯­æ³•ï¼š123456789od [-t TYPE] æ–‡ä»¶é€‰é¡¹æˆ–å‚æ•°ï¼š-t ï¼šåŽé¢å¯ä»¥æŽ¥å„ç§ã€Žç±»åž‹ (TYPE)ã€çš„è¾“å‡ºï¼Œä¾‹å¦‚ï¼š a ï¼šåˆ©ç”¨é»˜è®¤çš„å­—ç¬¦æ¥è¾“å‡ºï¼› c ï¼šä½¿ç”¨ ASCII å­—ç¬¦æ¥è¾“å‡º d[size] ï¼šåˆ©ç”¨åè¿›åˆ¶(decimal)æ¥è¾“å‡ºæ•°æ®ï¼Œæ¯ä¸ªæ•´æ•°å ç”¨ size bytes ï¼› f[size] ï¼šåˆ©ç”¨æµ®ç‚¹æ•°(floating)æ¥è¾“å‡ºæ•°æ®ï¼Œæ¯ä¸ªæ•°å ç”¨ size bytes ï¼› o[size] ï¼šåˆ©ç”¨å…«è¿›åˆ¶(octal)æ¥è¾“å‡ºæ•°æ®ï¼Œæ¯ä¸ªæ•´æ•°å ç”¨ size bytes ï¼› x[size] ï¼šåˆ©ç”¨åå…­è¿›åˆ¶(hexadecimal)æ¥è¾“å‡ºæ•°æ®ï¼Œæ¯ä¸ªæ•´æ•°å ç”¨ size bytes ï¼›ç¤ºä¾‹ï¼šå°†/usr/bin/passwd çš„å†…å®¹ä½¿ç”¨ ASCII æ–¹å¼æ¥å±•çŽ°ï¼š123456789od -t c /usr/bin/passwd 0000000 177 E L F 002 001 001 \0 \0 \0 \0 \0 \0 \0 \0 \00000020 003 \0 &gt; \0 001 \0 \0 \0 0 &gt; \0 \0 \0 \0 \0 \00000040 @ \0 \0 \0 \0 \0 \0 \0 360 314 \0 \0 \0 \0 \0 \00000060 \0 \0 \0 \0 @ \0 8 \0 \t \0 @ \0 034 \0 033 \00000100 006 \0 \0 \0 005 \0 \0 \0 @ \0 \0 \0 \0 \0 \0 \00000120 @ \0 \0 \0 \0 \0 \0 \0 @ \0 \0 \0 \0 \0 \0 \00000140 370 001 \0 \0 \0 \0 \0 \0 370 001 \0 \0 \0 \0 \0 \0...å°†/etc/issue è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ä»¥ 8 è¿›ä½åˆ—å‡ºå‚¨å­˜å€¼ä¸Ž ASCII çš„å¯¹ç…§è¡¨ï¼š123456root@ubuntu:~# od -t oCc /etc/issue0000000 125 142 165 156 164 165 040 061 066 056 060 064 056 062 040 114 U b u n t u 1 6 . 0 4 . 2 L0000020 124 123 040 134 156 040 134 154 012 012 T S \ n \ l \n \n0000032ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxæ–‡ä»¶ä¸Žç›®å½•ç®€å•æ“ä½œ]]></title>
    <url>%2FLinux%E6%96%87%E4%BB%B6%E4%B8%8E%E7%9B%AE%E5%BD%95%E7%AE%80%E5%8D%95%E6%93%8D%E4%BD%9C.html</url>
    <content type="text"><![CDATA[Linuxä¸‹å‡ ä¸ªç‰¹æ®Šçš„ç›®å½•ï¼š12345. ä»£è¡¨æ­¤å±‚ç›®å½•.. ä»£è¡¨ä¸Šä¸€å±‚ç›®å½•- ä»£è¡¨å‰ä¸€ä¸ªå·¥ä½œç›®å½•~ ä»£è¡¨ã€Žç›®å‰ç”¨æˆ·èº«ä»½ã€æ‰€åœ¨çš„å®¶ç›®å½•~mrbird ä»£è¡¨ mrbird è¿™ä¸ªç”¨æˆ·çš„å®¶ç›®å½•ç›®å½•ç›¸å…³æ“ä½œå‡ ä¸ªå¸¸è§çš„å¤„ç†ç›®å½•çš„æŒ‡ä»¤ï¼šcdï¼šå˜æ¢ç›®å½•ï¼›pwdï¼šæ˜¾ç¤ºå½“å‰ç›®å½•ï¼›mkdirï¼šå»ºç«‹ä¸€ä¸ªæ–°çš„ç›®å½•ï¼›rmdirï¼šåˆ é™¤ä¸€ä¸ªç©ºçš„ç›®å½•ã€‚cd (change directory, å˜æ¢ç›®å½•)ï¼š1234567891011#åˆ‡æ¢åˆ°varç›®å½•ä¸‹mrbird@ubuntu:~$ cd /var#å›žåˆ°åˆšåˆšé‚£ä¸ªç›®å½•mrbird@ubuntu:/var$ cd -/home/mrbird#åˆ‡æ¢åˆ°ç”¨æˆ·mrbirdçš„å®¶ç›®å½•mrbird@ubuntu:~$ cd ~mrbird#ä¸Šä¸€å±‚ç›®å½•mrbird@ubuntu:~$ cd ..#å½“å‰ç›®å½•mrbird@ubuntu:/home$ cd .pwd (Print Working Directoryï¼Œæ˜¾ç¤ºç›®å‰æ‰€åœ¨çš„ç›®å½•)ï¼šè¯­æ³•ï¼š123pwd [-P]é€‰é¡¹ä¸Žå‚æ•°ï¼š-P ï¼šæ˜¾ç¤ºå‡ºç¡®å®žçš„è·¯å¾„ï¼Œè€Œéžä½¿ç”¨é“¾æŽ¥ (link) è·¯å¾„ã€‚ç¤ºä¾‹ï¼š1234567root@ubuntu:/home/mrbird# pwd/home/mrbirdroot@ubuntu:/home/mrbird# cd /var/lockroot@ubuntu:/var/lock# pwd/var/lockroot@ubuntu:/var/lock# pwd -P/run/lockåŠ å…¥-pé€‰é¡¹åŽï¼Œæ˜¾ç¤ºå‡ºäº†/var/lockçš„çœŸå®žè·¯å¾„ï¼Œå› ä¸ºå®ƒæ˜¯ä¸ªé“¾æŽ¥æ¡£ã€‚mkdir (make directoryï¼Œå»ºç«‹æ–°ç›®å½•)ï¼šè¯­æ³•ï¼š1234mkdir [-mp] ç›®å½•åç§°é€‰é¡¹ä¸Žå‚æ•°ï¼š-m ï¼šé…ç½®æ–‡ä»¶æ¡ˆçš„æƒé™ï¼ç›´æŽ¥è®¾å®šï¼Œä¸éœ€è¦çœ‹é¢„è®¾æƒé™ (umask) çš„è„¸è‰²-p ï¼šå¸®åŠ©ä½ ç›´æŽ¥å°†æ‰€éœ€è¦çš„ç›®å½•(åŒ…å«ä¸Šå±‚ç›®å½•)é€’å½’å»ºç«‹èµ·æ¥ã€‚ â€‹ç¤ºä¾‹ï¼š1234567891011121314#åˆ›å»ºç›®å½•temproot@ubuntu:~# mkdir /temproot@ubuntu:~# cd /temp#ç›´æŽ¥åˆ›å»ºå¤šå±‚çº§ç›®å½•æŠ¥é”™root@ubuntu:/temp# mkdir test1/test2/test3mkdir: cannot create directory 'test1/test2/test3': No such file or directory#åŠ å…¥-pé€’å½’åˆ›å»ºroot@ubuntu:/temp# mkdir -p test1/test2/test3#åˆ›å»ºç›®å½•test2ï¼Œæƒé™ä¸º711root@ubuntu:/temp# mkdir -m 711 test2root@ubuntu:/temp# ls -altotal 16...drwx--x--x 2 root root 4096 Apr 11 18:43 test2rmdir (åˆ é™¤ã€Žç©ºã€çš„ç›®å½•)ï¼šè¯­æ³•ï¼š123rmdir [-p] ç›®å½•åç§°é€‰é¡¹ä¸Žå‚æ•°ï¼š-p ï¼šè¿žåŒã€Žä¸Šå±‚ã€ã€Žç©ºçš„ã€ç›®å½•ä¹Ÿä¸€èµ·åˆ é™¤ç¤ºä¾‹ï¼š12345678910#åˆ é™¤ç©ºç›®å½•test2root@ubuntu:/temp# rmdir test2root@ubuntu:/temp# lstest1#åˆ é™¤éžç©ºç›®å½•test1ï¼Œæç¤ºæ— æ³•åˆ é™¤root@ubuntu:/temp# rmdir test1rmdir: failed to remove 'test1': Directory not empty#ä½¿ç”¨-pé€’å½’åˆ é™¤root@ubuntu:/temp# rmdir -p test1/test2/test3root@ubuntu:/temp# lsæ–‡ä»¶ä¸Žç›®å½•ç®¡ç†ç›¸å…³çš„å‘½ä»¤æœ‰ï¼šlsï¼šæ˜¾ç¤ºå±žæ€§ï¼›cpï¼šæ‹·è´ï¼›rmï¼šåˆ é™¤æ–‡ä»¶ï¼›mvç§»åŠ¨ç›®å½•æˆ–æ–‡ä»¶ç­‰ã€‚lsï¼ˆlistï¼‰æ–‡ä»¶ä¸Žç›®å½•çš„æ£€è§†ï¼šè¯­æ³•ï¼š123456789101112131415161718192021222324ls [-aAdfFhilnrRSt] æ–‡ä»¶åæˆ–ç›®å½•åç§°..ls [--color=&#123;never,auto,always&#125;] æ–‡ä»¶åæˆ–ç›®å½•åç§°..ls [--full-time] æ–‡ä»¶åæˆ–ç›®å½•åç§°..é€‰é¡¹ä¸Žå‚æ•°ï¼š-a ï¼šå…¨éƒ¨çš„æ–‡ä»¶ï¼Œè¿žåŒéšè—æ¡£( å¼€å¤´ä¸º . çš„æ–‡ä»¶) ä¸€èµ·åˆ—å‡ºæ¥(å¸¸ç”¨)-A ï¼šå…¨éƒ¨çš„æ–‡ä»¶ï¼Œè¿žåŒéšè—æ¡£ï¼Œä½†ä¸åŒ…æ‹¬ . ä¸Ž .. è¿™ä¸¤ä¸ªç›®å½•-d ï¼šä»…åˆ—å‡ºç›®å½•æœ¬èº«ï¼Œè€Œä¸æ˜¯åˆ—å‡ºç›®å½•å†…çš„æ–‡ä»¶æ•°æ®(å¸¸ç”¨)-f ï¼šç›´æŽ¥åˆ—å‡ºç»“æžœï¼Œè€Œä¸è¿›è¡ŒæŽ’åº (ls é¢„è®¾ä¼šä»¥æ¡£åæŽ’åºï¼)-F ï¼šæ ¹æ®æ–‡ä»¶ã€ç›®å½•ç­‰ä¿¡æ¯ï¼Œç»™äºˆé™„åŠ æ•°æ®ç»“æž„ï¼Œä¾‹å¦‚ï¼š *:ä»£è¡¨å¯æ‰§è¡Œæ–‡ä»¶ï¼› /:ä»£è¡¨ç›®å½•ï¼› =:ä»£è¡¨ socket æ–‡ä»¶ï¼› |:ä»£è¡¨ FIFO æ–‡ä»¶ï¼›-h ï¼šå°†æ–‡ä»¶å®¹é‡ä»¥äººç±»è¾ƒæ˜“è¯»çš„æ–¹å¼(ä¾‹å¦‚ GB, KB ç­‰ç­‰)åˆ—å‡ºæ¥ï¼›-i ï¼šåˆ—å‡º inode å·ç ï¼Œinode çš„æ„ä¹‰ä¸‹ä¸€ç« å°†ä¼šä»‹ç»ï¼›-l ï¼šé•¿æ•°æ®ä¸²è¡Œå‡ºï¼ŒåŒ…å«æ–‡ä»¶çš„å±žæ€§ä¸Žæƒé™ç­‰ç­‰æ•°æ®ï¼›(å¸¸ç”¨)-n ï¼šåˆ—å‡º UID ä¸Ž GID è€Œéžä½¿ç”¨è€…ä¸Žç¾¤ç»„çš„åç§° (UID ä¸Ž GID ä¼šåœ¨è´¦å·ç®¡ç†æåˆ°ï¼)-r ï¼šå°†æŽ’åºç»“æžœåå‘è¾“å‡ºï¼Œä¾‹å¦‚ï¼šåŽŸæœ¬æ¡£åç”±å°åˆ°å¤§ï¼Œåå‘åˆ™ä¸ºç”±å¤§åˆ°å°ï¼›-R ï¼šè¿žåŒå­ç›®å½•å†…å®¹ä¸€èµ·åˆ—å‡ºæ¥ï¼Œç­‰äºŽè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼›-S ï¼šä»¥æ–‡ä»¶å®¹é‡å¤§å°æŽ’åºï¼Œè€Œä¸æ˜¯ç”¨æ¡£åæŽ’åºï¼›-t ï¼šä¾æ—¶é—´æŽ’åºï¼Œè€Œä¸æ˜¯ç”¨æ¡£åã€‚--color=never ï¼šä¸è¦ä¾æ®æ–‡ä»¶ç‰¹æ€§ç»™äºˆé¢œè‰²æ˜¾ç¤ºï¼›--color=always ï¼šæ˜¾ç¤ºé¢œè‰²--color=auto ï¼šè®©ç³»ç»Ÿè‡ªè¡Œä¾æ®è®¾å®šæ¥åˆ¤æ–­æ˜¯å¦ç»™äºˆé¢œè‰²--full-time ï¼šä»¥å®Œæ•´æ—¶é—´æ¨¡å¼ (åŒ…å«å¹´ã€æœˆã€æ—¥ã€æ—¶ã€åˆ†) è¾“å‡º--time=&#123;atime,ctime&#125; ï¼šè¾“å‡º access æ—¶é—´æˆ–æ”¹å˜æƒé™å±žæ€§æ—¶é—´ (ctime) è€Œéžå†…å®¹å˜æ›´æ—¶é—´ (modification time)lså‘½ä»¤å¾ˆå¸¸ç”¨ï¼Œè¿™é‡Œä»…ç¤ºä¾‹--colorï¼Œ--full-timeï¼Œ--timeå‚æ•°ï¼š--colorå‚æ•°çš„ä½¿ç”¨ï¼šlsé»˜è®¤æ˜¾ç¤ºæ ¹æ®æ–‡ä»¶ç‰¹æ€§æ˜¾ç¤ºé¢œè‰²ï¼Œå¯ä»¥ä½¿ç”¨--color=neverå…³é—­ï¼--full-timeå‚æ•°çš„ä½¿ç”¨ï¼š12345678root@ubuntu:/var# ls --full-timetotal 48drwxr-xr-x 2 root root 4096 2017-04-11 18:07:45.485003705 -0700 backupsdrwxr-xr-x 15 root root 4096 2017-04-11 03:49:17.681766424 -0700 cachedrwxrwsrwt 2 root whoopsie 4096 2017-04-11 04:17:29.961240226 -0700 crashdrwxr-xr-x 64 root root 4096 2017-04-11 04:56:56.702320395 -0700 libdrwxrwsr-x 2 root staff 4096 2016-04-12 13:14:23.000000000 -0700 local...è¯¥å®Œæ•´çš„å‘ˆçŽ°äº†æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´ (modification time)ã€‚cpï¼ˆcopyï¼‰å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•ï¼šè¯­æ³•ï¼š1234567891011121314[root@study ~]# cp [-adfilprsu] æ¥æºæ–‡ä»¶(source) ç›®æ ‡æ–‡ä»¶(destination)[root@study ~]# cp [options] source1 source2 source3 .... directoryé€‰é¡¹ä¸Žå‚æ•°ï¼š-a ï¼šç›¸å½“äºŽ -dr --preserve=all çš„æ„æ€ï¼Œè‡³äºŽ dr è¯·å‚è€ƒä¸‹åˆ—è¯´æ˜Žï¼›(å¸¸ç”¨)-d ï¼šè‹¥æ¥æºæ–‡ä»¶ä¸ºé“¾æŽ¥æ–‡ä»¶çš„å±žæ€§(link file)ï¼Œåˆ™å¤åˆ¶é“¾æŽ¥æ–‡ä»¶å±žæ€§è€Œéžæ–‡ä»¶æœ¬èº«ï¼›-f ï¼šä¸ºå¼ºåˆ¶(force)çš„æ„æ€ï¼Œè‹¥ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ä¸”æ— æ³•å¼€å¯ï¼Œåˆ™ç§»é™¤åŽå†å°è¯•ä¸€æ¬¡ï¼›-i ï¼šè‹¥ç›®æ ‡æ–‡ä»¶(destination)å·²ç»å­˜åœ¨æ—¶ï¼Œåœ¨è¦†ç›–æ—¶ä¼šå…ˆè¯¢é—®åŠ¨ä½œçš„è¿›è¡Œ(å¸¸ç”¨)-l ï¼šè¿›è¡Œç¡¬å¼è¿žç»“(hard link)çš„è¿žç»“æ¡£å»ºç«‹ï¼Œè€Œéžå¤åˆ¶æ–‡ä»¶æœ¬èº«ï¼›-p ï¼šè¿žåŒæ–‡ä»¶çš„å±žæ€§(æƒé™ã€ç”¨æˆ·ã€æ—¶é—´)ä¸€èµ·å¤åˆ¶è¿‡åŽ»ï¼Œè€Œéžä½¿ç”¨é»˜è®¤å±žæ€§(å¤‡ä»½å¸¸ç”¨)ï¼›-r ï¼šé€’å½’æŒç»­å¤åˆ¶ï¼Œç”¨äºŽç›®å½•çš„å¤åˆ¶è¡Œä¸ºï¼›(å¸¸ç”¨)-s ï¼šå¤åˆ¶æˆä¸ºç¬¦å·é“¾æŽ¥æ–‡ä»¶ (symbolic link)ï¼Œäº¦å³ã€Žå¿«æ·æ–¹å¼ã€æ–‡ä»¶ï¼›-u ï¼šdestination æ¯” source æ—§æ‰æ›´æ–° destinationï¼Œæˆ– destination ä¸å­˜åœ¨çš„æƒ…å†µä¸‹æ‰å¤åˆ¶ã€‚--preserve=all ï¼šé™¤äº† -p çš„æƒé™ç›¸å…³å‚æ•°å¤–ï¼Œè¿˜åŠ å…¥ SELinux çš„å±žæ€§, links, xattr ç­‰ä¹Ÿå¤åˆ¶äº†ã€‚ æœ€åŽéœ€è¦æ³¨æ„çš„ï¼Œå¦‚æžœæ¥æºæ¡£æœ‰ä¸¤ä¸ªä»¥ä¸Šï¼Œåˆ™æœ€åŽä¸€ä¸ªç›®çš„æ–‡ä»¶ä¸€å®šè¦æ˜¯ã€Žç›®å½•ã€æ‰è¡Œã€‚ä¸åŒæƒé™ç”¨æˆ·ä½¿ç”¨cpå‘½ä»¤ä¼šäº§ç”Ÿä¸åŒçš„ç»“æžœï¼Œä¸‹é¢ä¸¾å‡ ä¸ªå®žä¾‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940#ç”¨ root èº«ä»½ï¼Œå°†å®¶ç›®å½•ä¸‹çš„ .bashrc å¤åˆ¶åˆ° /tmp ä¸‹ï¼Œå¹¶æ›´åä¸º bashrcroot@ubuntu:~# cp ~/.bashrc /temp/bashrc#ä½¿ç”¨-ié€‰é¡¹ï¼Œå½“ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨æ—¶ï¼Œä¼šè¿›è¡Œæ“ä½œè¯¢é—®root@ubuntu:~# cp -i ~/.bashrc /temp/bashrccp: overwrite '/temp/bashrc'? y &lt;==n ä¸è¦†ç›–ï¼Œy ä¸ºè¦†ç›– root@ubuntu:/var/log# cd /temp#å¤åˆ¶/var/log/wtmp åˆ°å½“å‰ï¼ˆ/tempï¼‰ç›®å½•ï¼Œåˆ«å¿˜è®°äº†åŠ .root@ubuntu:/temp# cp /var/log/wtmp .root@ubuntu:/temp# lsbashrc wtmp #ä½¿ç”¨ls -lå‘½ä»¤è§‚å¯Ÿæºæ–‡ä»¶å’Œå¤åˆ¶æ–‡ä»¶çš„æƒé™ï¼Œå¯è§ä¸¤è€…å¹¶ä¸ä¸€è‡´root@ubuntu:/temp# ls -l /var/log/wtmp wtmp-rw-rw-r-- 1 root utmp 8448 Apr 11 18:11 /var/log/wtmp-rw-r--r-- 1 root root 8448 Apr 11 19:08 wtmp#ä½¿ç”¨-aé€‰é¡¹ï¼Œè¿žåŒæƒé™ä¸€èµ·å¤åˆ¶root@ubuntu:/temp# cp -a /var/log/wtmp wtmp1root@ubuntu:/temp# ls -l /var/log/wtmp wtmp wtmp1-rw-rw-r-- 1 root utmp 8448 Apr 11 18:11 /var/log/wtmp-rw-r--r-- 1 root root 8448 Apr 11 19:08 wtmp-rw-rw-r-- 1 root utmp 8448 Apr 11 18:11 wtmp1 #é…åˆ-ré€‰é¡¹å°†/var/log/ç›®å½•ä¸‹çš„æ‰€æœ‰å†…å®¹å¤åˆ¶åˆ°/tempç›®å½•ä¸‹root@ubuntu:/temp# cp -ar /var/log/ .root@ubuntu:/temp# lsbashrc log wtmp wtmp1root@ubuntu:/temp# ls logXorg.0.log auth.log dmesg gpu-manager.log lightdm ... #å»ºç«‹ä¸€ä¸ªbashrcæ–‡ä»¶çš„è¿žç»“æ¡£ (symbolic link)root@ubuntu:/temp# cp -s bashrc bashrc_slinkroot@ubuntu:/temp# cp -l bashrc bashrc_hlinkroot@ubuntu:/temp# ls -ltotal 36-rw-r--r-- 2 root root 3106 Apr 11 19:04 bashrc-rw-r--r-- 2 root root 3106 Apr 11 19:04 bashrc_hlinklrwxrwxrwx 1 root root 6 Apr 11 19:24 bashrc_slink -&gt; bashrc...æœ€åŽä¸€ä¸ªä¾‹å­ä¸­ï¼Œä½¿ç”¨ -l åŠ -s éƒ½ä¼šå»ºç«‹æ‰€è°“çš„è¿žç»“æ¡£(link file)ï¼Œä½†æ˜¯è¿™ä¸¤ç§è¿žç»“æ¡£å´æœ‰ä¸ä¸€æ ·çš„æƒ…å†µã€‚é‚£ä¸ª -l å°±æ˜¯æ‰€è°“çš„å®žä½“é“¾æŽ¥(hard link)ï¼Œè‡³äºŽ -s åˆ™æ˜¯ç¬¦å·é“¾æŽ¥(symbolic link)ï¼Œ ç®€å•æ¥è¯´ï¼Œbashrc_slink æ˜¯ä¸€ä¸ªã€Žå¿«æ·æ–¹å¼ã€ï¼Œè¿™ä¸ªå¿«æ·æ–¹å¼ä¼šè¿žç»“åˆ° bashrc åŽ»ã€‚æ‰€ä»¥ä½ ä¼šçœ‹åˆ°æ¡£åå³ä¾§ä¼šæœ‰ä¸ªæŒ‡å‘(-&gt;)çš„ç¬¦å·ã€‚bashrc_hlink æ–‡ä»¶ä¸Ž bashrc çš„å±žæ€§ä¸Žæƒé™å®Œå…¨ä¸€æ¨¡ä¸€æ ·ï¼Œä¸Žå°šæœªè¿›è¡Œè¿žç»“å‰çš„å·®å¼‚åˆ™æ˜¯ç¬¬äºŒæ çš„ link æ•°ç”± 1 å˜æˆ 2ã€‚rmï¼ˆremoveï¼‰ç§»é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼šè¯­æ³•ï¼š12345rm [-fir] æ–‡ä»¶æˆ–ç›®å½•é€‰é¡¹ä¸Žå‚æ•°ï¼š-f ï¼šå°±æ˜¯ force çš„æ„æ€ï¼Œå¿½ç•¥ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œä¸ä¼šå‡ºçŽ°è­¦å‘Šè®¯æ¯ï¼›-i ï¼šäº’åŠ¨æ¨¡å¼ï¼Œåœ¨åˆ é™¤å‰ä¼šè¯¢é—®ä½¿ç”¨è€…æ˜¯å¦åŠ¨ä½œ-r ï¼šé€’å½’åˆ é™¤ï¼Œè¿™æ˜¯éžå¸¸å±é™©çš„é€‰é¡¹ï¼ï¼ç¤ºä¾‹ï¼š12345678910111213141516171819202122232425#åˆ é™¤/tempç›®å½•ä¸‹çš„bashrcæ–‡ä»¶root@ubuntu:/temp# rm -i bashrcrm: remove regular file 'bashrc'? y #åˆ é™¤/temp/logç›®å½•root@ubuntu:/temp# rmdir logrmdir: failed to remove 'log': Directory not empty#éžç©ºç›®å½•ï¼Œä½¿ç”¨rm -rå‘½ä»¤é€’å½’åˆ é™¤ï¼Œæ— éœ€è¯¢é—®çš„è¯åŽ»æŽ‰-ié€‰é¡¹å³å¯root@ubuntu:/temp# rm -ri logrm: descend into directory 'log'? yrm: descend into directory 'log/vmware'? yrm: remove regular file 'log/vmware/rc.local.log'? ^C #åˆ é™¤ä¸€ä¸ªå¸¦æœ‰ - å¼€å¤´çš„æ–‡ä»¶root@ubuntu:/temp# touch ./-aaa-root@ubuntu:/temp# ls-aaa- bashrc_hlink bashrc_slink log wtmp wtmp1root@ubuntu:/temp# rm -aaa-rm: invalid option -- 'a'Try 'rm ./-aaa-' to remove the file '-aaa-'. &lt;== bashç»™çš„å»ºè®®Try 'rm --help' for more information.#å› ä¸º-æ˜¯é€‰é¡¹çš„æ„æ€ï¼Œç³»ç»Ÿè¯¯åˆ¤ï¼Œä½¿ç”¨è½¬ä¹‰ç¬¦è§£å†³ï¼šroot@ubuntu:/temp# rm ./-aaa-root@ubuntu:/temp# lsbashrc_hlink bashrc_slink log wtmp wtmp1æœ€åŽä¸€ä¸ªä¾‹å­ä¸­ï¼Œä½¿ç”¨å‘½ä»¤rm -- -aaa-ä¹Ÿå¯ä»¥åˆ é™¤-aaa-æ–‡ä»¶ã€‚mvï¼ˆmoveï¼‰ç§»åŠ¨æ–‡ä»¶ä¸Žç›®å½•ï¼Œæˆ–é‡å‘½åï¼šè¯­æ³•ï¼š123456mv [-fiu] source destinationmv [options] source1 source2 source3 .... directoryé€‰é¡¹ä¸Žå‚æ•°ï¼š-f ï¼šforce å¼ºåˆ¶çš„æ„æ€ï¼Œå¦‚æžœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¸ä¼šè¯¢é—®è€Œç›´æŽ¥è¦†ç›–ï¼›-i ï¼šè‹¥ç›®æ ‡æ–‡ä»¶ (destination) å·²ç»å­˜åœ¨æ—¶ï¼Œå°±ä¼šè¯¢é—®æ˜¯å¦è¦†ç›–ï¼-u ï¼šè‹¥ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¸” source æ¯”è¾ƒæ–°ï¼Œæ‰ä¼šæ›´æ–° (update)ç¤ºä¾‹ï¼š1234567891011121314151617#åœ¨/tempä¸‹æ–°å»ºç›®å½•tmpï¼Œç„¶åŽå°†bashrcæ–‡ä»¶ç§»åŠ¨åˆ°è¯¥ç›®å½•ä¸‹root@ubuntu:/temp# mkdir tmproot@ubuntu:/temp# mv bashrc tmproot@ubuntu:/temp# lsbashrc_hlink bashrc_slink log tmp wtmp wtmp1root@ubuntu:/temp# ls tmpbashrc #å°†ç›®å½•tmpé‡å‘½åä¸ºtmp1root@ubuntu:/temp# mv tmp tmp1root@ubuntu:/temp# lsbashrc_hlink bashrc_slink log tmp1 wtmp wtmp1 #å°†logç›®å½•ä¸‹çš„wtmpå’Œvmwareæ–‡ä»¶ä¸€èµ·ç§»åŠ¨åˆ°tmp1ç›®å½•ä¸‹root@ubuntu:/temp# mv log/wtmp log/vmware tmp1root@ubuntu:/temp# ls tmp1bashrc vmware wtmpæŸ¥çœ‹æ–‡ä»¶ç±»åž‹å¦‚æžœä½ æƒ³è¦çŸ¥é“æŸä¸ªæ–‡ä»¶çš„åŸºæœ¬æ•°æ®ï¼Œä¾‹å¦‚æ˜¯å±žäºŽASCII æˆ–è€…æ˜¯data æ–‡ä»¶ï¼Œæˆ–è€…æ˜¯ binaryç­‰ï¼Œå¯ä»¥åˆ©ç”¨ file è¿™ä¸ªæŒ‡ä»¤æ¥æŸ¥çœ‹ï¼š1234567mrbird@ubuntu:/temp$ file bashrc_hlink bashrc_hlink: ASCII textmrbird@ubuntu:/temp$ file wtmpwtmp: datamrbird@ubuntu:/temp$ file /usr/bin/passwd /usr/bin/passwd: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV),dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=40a9016718f4247f09acc62e1bbf056372bf31f5, strippedã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSSä¼˜å…ˆçº§è§„åˆ™]]></title>
    <url>%2FCSS%E4%BC%98%E5%85%88%E7%BA%A7%E8%A7%84%E5%88%99.html</url>
    <content type="text"><![CDATA[ç‰¹æ®Šæ€§å¦‚æžœä¸€ä¸ªå…ƒç´ æœ‰ä¸¤ä¸ªä»¥ä¸Šå†²çªçš„å±žæ€§å£°æ˜Žï¼Œé‚£ä¹ˆç‰¹æ®Šæ€§ï¼ˆspecificityï¼‰é«˜çš„å£°æ˜Žå°†ä¼šèƒœå‡ºã€‚ç‰¹æ®Šæ€§çš„å€¼è¡¨è¿°ä¸ºå››ä¸ªéƒ¨åˆ†ï¼Œå¦‚0,0,0,0ï¼Œå…·ä½“è§„åˆ™ï¼š1.é€‰æ‹©å™¨ä¸­ç»™å®šçš„å„ä¸ªIDå±žæ€§å€¼ï¼ŒåŠ 0,1,0,0ã€‚2.é€‰æ‹©å™¨ä¸­ç»™å®šçš„å„ä¸ªç±»å±žåž‹å€¼ï¼Œå±žæ€§é€‰æ‹©å’Œä¼ªç±»ï¼ŒåŠ 0,0,1,0ã€‚3.é€‰æ‹©å™¨ä¸­ç»™å®šçš„å„ä¸ªå…ƒç´ å’Œä¼ªå…ƒç´ ï¼ŒåŠ 0,0,0,1ã€‚4.é€šé…ç¬¦å¯¹ç‰¹æ®Šæ€§æ²¡æœ‰ä»»ä½•è´¡çŒ®ï¼ŒåŠ 0,0,0,0ã€‚æ¯”å¦‚ï¼š1234567h1 &#123;color: red;&#125; /* specificity = 0,0,0,1 */p em &#123;color: purple;&#125; /* specificity = 0,0,0,2 */*.grape &#123;color: purple;&#125; /* specificity = 0,0,1,0 */.bright &#123;color: purple;&#125; /* specificity = 0,0,0,1 */p.bright em.dark &#123;color: maroon;&#125; /* specificity = 0,0,2,2 */#drop-down &#123;color: green;&#125; /* specificity = 0,1,0,0 */div#sidebar *[href] &#123;color: black;&#125; /* specificity = 0,1,1,1 */ç‰¹æ®Šæ€§å¤§å°çš„æ¯”è¾ƒè§„åˆ™ä¸ºä»Žå·¦åˆ°å³ï¼Œæ•°å€¼å¤§çš„è¶Šå¤§ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè€ƒè™‘æœ‰å¦‚ä¸‹è§„åˆ™çš„htmlï¼š12345678910111213&lt;style&gt; h1 + p &#123;color: black; font-style: italic&#125; /* specificity = 0,0,0,2 */ p &#123;color: gray; background: white; font-style: normal&#125; /* specificity = 0,0,0,1 */ *.aside &#123;color: black; background: silver&#125; /* specificity = 0,0,1,0 */&lt;/style&gt;&lt;body&gt; &lt;h1&gt;Greeting!&lt;/h1&gt; &lt;p class="aside"&gt;It's a fine way to start a day.&lt;/p&gt; &lt;p&gt;There are many ways to greet a man.&lt;/p&gt; &lt;h1&gt;Salutations&lt;/h1&gt; &lt;p&gt;There is nothing finer than a hearty welcome from ...&lt;/p&gt; &lt;p class="aside"&gt;Although a thick and juicy hamburger with...&lt;/p&gt;&lt;/body&gt;æœ€ç»ˆæ˜¾ç¤ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå†…è”æ ·å¼ç‰¹æ®Šæ€§ç‰¹æ®Šæ€§å€¼çš„ç¬¬ä¸€ä½æ˜¯ä¸ºå†…è”æ ·å¼ä¿ç•™çš„ï¼Œæ¯ä¸ªå†…è”æ ·å¼çš„ç‰¹æ®Šæ€§éƒ½ä¸º1,0,0,0ï¼Œæ¯”å¦‚ä¸‹é¢çš„h1å…ƒç´ å°†æ˜¾ç¤ºä¸ºç»¿è‰²ï¼š12h1#meadow &#123;color: red&#125;&lt;h1 id="meadow" style="color: green;"&gt;The title&lt;/h1&gt;é‡è¦æ€§å¯¹äºŽæŸä¸ªéžå¸¸é‡è¦çš„å£°æ˜Žï¼Œå¯ä»¥åœ¨è¿™äº›å£°æ˜Žçš„ç»“æŸåˆ†å·å‰æ’å…¥!importantã€‚å¦‚æžœä¸€ä¸ªéžé‡è¦å£°æ˜Žå’Œé‡è¦å£°æ˜Žå†²çªï¼Œèƒœå‡ºçš„æ€»æ˜¯é‡è¦å£°æ˜Žã€‚å¦‚ï¼š1234567&lt;style&gt; h1 &#123;color: green !important;&#125; h1.title &#123;color: red&#125;&lt;/style&gt;&lt;body&gt; &lt;h1 class="title"&gt;Greeting!&lt;/h1&gt;&lt;/body&gt;æœ€ç»ˆh1ä¸ºç»¿è‰²ã€‚ç»§æ‰¿å¯¹äºŽç»§æ‰¿çš„å€¼æ²¡æœ‰ç‰¹æ®Šæ€§ï¼Œè€Œéž0ç‰¹æ®Šæ€§ã€‚ä¸¾ä¸ªä¾‹å­ï¼š12345678&lt;style&gt; * &#123;color: lightcoral&#125; h1.title &#123;color: black&#125;&lt;/style&gt;&lt;body&gt; &lt;h1 class="title"&gt;Meerkat &lt;em&gt;Central&lt;/em&gt;&lt;/h1&gt; &lt;p&gt;Welcome to the best place on the web...&lt;/p&gt;&lt;/body&gt;æ˜¾ç¤ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šç»“æžœè¯æ˜Žäº†0ç‰¹æ®Šæ€§æ¯”æ— ç‰¹æ®Šæ€§è¦å¼ºã€‚æŒ‰æƒé‡å’Œæ¥æºæŽ’åºä¸€èˆ¬æ¥è¯´ï¼Œæƒé‡ç”±å¤§åˆ°å°çš„é¡ºåºä¸ºï¼š1.è¯»è€…çš„é‡è¦å£°æ˜Žã€‚2.åˆ›ä½œäººå‘˜çš„é‡è¦å£°æ˜Žã€‚3.åˆ›ä½œäººå‘˜çš„æ­£å¸¸å£°æ˜Žã€‚4.è¯»è€…çš„æ­£å¸¸å£°æ˜Žã€‚5.ç”¨æˆ·ä»£ç†å£°æ˜Žã€‚CSSä¸­çš„æ ·å¼ä¸€å…±æœ‰ä¸‰ç§æ¥æºï¼šåˆ›ä½œäººå‘˜ã€è¯»è€…å’Œç”¨æˆ·ä»£ç†ã€‚åˆ›ä½œäººå‘˜ï¼ˆauthorâ€™s+styleï¼‰æ ·å¼åº”è¯¥æ˜¯æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„ï¼Œå¦‚æžœä½ æ˜¯ä¸€ä¸ªå‰ç«¯å¼€å‘è€…ï¼Œé‚£ä¹ˆä½ å†™çš„é‚£äº›æ ·å¼å°±å«åšåˆ›ä½œäººå‘˜æ ·å¼ã€‚ç”¨æˆ·ä»£ç†æ ·å¼ï¼ˆagentâ€™s+styleï¼‰ã€‚ç”¨æˆ·ä»£ç†ä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„æµè§ˆå™¨ï¼ˆIEã€Firefoxç­‰ç­‰ï¼‰ï¼Œè¿™äº›æµè§ˆå™¨ä¼šæä¾›ä¸€äº›é»˜è®¤çš„æ ·å¼ã€‚è¯»è€…æ ·å¼ï¼ˆreaderâ€™s+styleï¼‰ã€‚æ‰€è°“è¯»è€…è‡ªç„¶å°±æ˜¯æµè§ˆç½‘é¡µçš„ç”¨æˆ·ï¼Œæœ‰äº›æ—¶å€™è¿™äº›ç”¨æˆ·é‡Œå¯èƒ½ä¼šæœ‰äººä¸æ»¡æ„ç½‘é¡µçš„é…è‰²ï¼Œæˆ–è€…å­—ä½“å¤§å°ï¼Œè¿™æ—¶å€™ä»–ä»¬å°±æ˜¯é€šè¿‡æµè§ˆå™¨æä¾›çš„æŽ¥å£ä¸ºç½‘ç«™æ·»åŠ è¯»è€…æ ·å¼ã€‚æ¯”å¦‚ï¼š12p em &#123;color: black;&#125; /* author's style sheet*/ p em &#123;color: yellow;&#125; /* reader's style sheet*/ç¬¬ä¸€æ¡è§„åˆ™å°†èƒœå‡ºã€‚12p em &#123;color: black !important;&#125; /* author's style sheet*/ p em &#123;color: yellow !important;&#125; /* reader's style sheet*/ç¬¬äºŒæ¡è§„åˆ™å°†èƒœå‡ºã€‚]]></content>
      <tags>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ubuntu16.04æ­å»ºJavaå¼€å‘çŽ¯å¢ƒ]]></title>
    <url>%2Fubuntu16-04%E6%90%AD%E5%BB%BAJava%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html</url>
    <content type="text"><![CDATA[å®‰è£…JDKJDK1.8ä¸‹è½½åœ°å€ï¼šhttp://pan.baidu.com/s/1qYPORRAï¼ŒJDKå®‰è£…æ­¥éª¤ï¼š1.å°†ä¸‹è½½çš„åŒ…è§£åŽ‹åˆ°/opt/jvmï¼š12sudo mkdir /opt/jvmsudo tar zxvf jdk-8u77-linux-x64.tar.gz -C /opt/jvmå¦‚æžœæç¤ºå¤±è´¥ï¼Œæ˜¯å› ä¸ºç›®å½•æƒé™ä¸è¶³ï¼Œå¯ä»¥ä½¿ç”¨chmodæ”¹å˜æƒé™ï¼š1sudo chmod 777 /opt /opt/jvm2.é…ç½®jdkçš„çŽ¯å¢ƒå˜é‡ï¼Œæ‰“å¼€ /etc/profileæ–‡ä»¶ï¼ˆsudo vim /etc/profileï¼‰ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸‹è¯­å¥ï¼š1234export JAVA_HOME=/opt/jvm/jdk1.8.0_77export JRE_HOME=$&#123;JAVA_HOME&#125;/jreexport CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/libexport PATH=$&#123;JAVA_HOME&#125;/bin:$PATHç‚¹å‡»Escï¼Œè¾“å…¥:wqä¿å­˜é€€å‡ºã€‚3.ä½¿å…¶ç”Ÿæ•ˆï¼š1sudo source /etc/profileå¦‚è‹¥æç¤ºsudo: sourceï¼šæ‰¾ä¸åˆ°å‘½ä»¤ï¼Œå¯ä»¥åˆ‡æ¢ä¸ºrootï¼Œå†æ¬¡æ‰§è¡Œï¼Œæ“ä½œå¦‚ä¸‹ï¼š12sudo -s -Hsource /etc/profileæ£€æŸ¥æ˜¯å¦æˆåŠŸï¼š1234mrbird@mrbird-xps13:~$ java -versionjava version "1.8.0_77"Java(TM) SE Runtime Environment (build 1.8.0_77-b03)Java HotSpot(TM) 64-Bit Server VM (build 25.77-b03, mixed mode)å®‰è£…eclipseeclipseä¸‹è½½ï¼Œå®˜ç½‘ï¼šhttps://www.eclipse.org/downloads/eclipse-packages/?osType=linux&amp;release=undefinedï¼Œæˆ–è€…ç™¾åº¦äº‘ï¼šhttp://pan.baidu.com/s/1pKMmRR9ã€‚eclipseå®‰è£…æ­¥éª¤ï¼š1.ä¸‹è½½åŽåˆ‡æ¢åˆ°ä¸‹è½½ç›®å½•ï¼Œå°†å…¶è§£åŽ‹åˆ°/opt/æ–‡ä»¶å¤¹ä¸­ï¼š1sudo tar zxvf eclipse-jee-neon-3-linux-gtk-x86_64.tar.gz -C /opt2.ç„¶åŽåˆ°/opt/eclipseç›®å½•ä¸‹åŒå‡»eclipseå³å¯ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå»ºè®®å°†å…¶é”å®šåˆ°å¯åŠ¨å™¨ã€‚å®‰è£…MySQL1.åœ¨Ubuntu 16.04ä¸Šå®‰è£…MySQLï¼š1sudo apt-get install mysql-server mysql-client2.å®‰è£…è¿‡ç¨‹ä¸­éœ€è¦ä½ è¾“å…¥MySQL ç®¡ç†å‘˜ç”¨æˆ·ï¼ˆrootï¼‰å¯†ç  ã€‚3.è¿è¡ŒMySQLåˆå§‹åŒ–å®‰å…¨è„šæœ¬ï¼š1sudo mysql_secure_installation4.æ ¹æ®æç¤ºä¿¡æ¯è®¾ç½®ï¼šæ›´æ”¹rootå¯†ç ã€ç§»é™¤MySQLçš„åŒ¿åç”¨æˆ·ã€ç¦æ­¢rootè¿œç¨‹ç™»å½•ã€åˆ é™¤testæ•°æ®åº“ã€‚æ£€æŸ¥æ˜¯å¦æˆåŠŸï¼š123456789101112131415161718192021222324252627mrbird@mrbird-xps13:~$ mysql -u root -pEnter password: Welcome to the MySQL monitor. Commands end with ; or \g.Your MySQL connection id is 4Server version: 5.7.17-0ubuntu0.16.04.1 (Ubuntu) Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners. Type 'help;' or '\h' for help. Type '\c' to clear the current input statement. mysql&gt; show databases -&gt; ;+--------------------+| Database |+--------------------+| information_schema || mysql || performance_schema || sys |+--------------------+4 rows in set (0.00 sec) mysql&gt;]]></content>
      <tags>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XPS13å®‰è£…win10 ubuntuåŒç³»ç»Ÿ]]></title>
    <url>%2FXPS13%E5%AE%89%E8%A3%85win10-ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F.html</url>
    <content type="text"><![CDATA[è¿™å‡ å¤©è¢«å®‰è£…åŒç³»ç»ŸæŠ˜è…¾å¾—å¤Ÿå‘›ï¼Œæ˜¨å¤©ç»ˆäºŽå®‰è£…æˆåŠŸï¼Œæ‰€ä»¥æ’°å†™æ­¤æ–‡ä»¥å¤‡å¿˜ã€‚å®‰è£…å’Œå¯åŠ¨æ–¹å¼å‡ä¸ºUEFIï¼Œè¿›è¡Œä»¥ä¸‹æ“ä½œæ—¶å…ˆè¿›è¡Œæ•°æ®å¤‡ä»½ï¼åšä¸»ç”µè„‘ä¸ºDell XPS13 9350ï¼Œä¸åŒç”µè„‘è¿›å…¥BIOSå¿«æ·é”®å¯èƒ½ä¸ä¸€æ ·ï¼Œè¯·è‡ªè¡Œç™¾åº¦ã€‚å®‰è£…win10win10é€‰æ‹©çš„æ˜¯å®¶åº­ä¸­æ–‡ç‰ˆ1607 64bitï¼Œå› ä¸ºåºåˆ—å·æ˜¯çƒ§åœ¨ä¸»æ¿ä¸Šçš„ï¼Œæ‰€ä»¥å®‰è£…å®Œè”ç½‘å°±è‡ªåŠ¨æ¿€æ´»äº†ï¼Œè€Œä¸”å¯¹äºŽæˆ‘æ¥è¯´å®¶åº­ç‰ˆå’Œä¸“ä¸šç‰ˆæ²¡æœ‰å¤ªå¤§åŒºåˆ«â€¦win10é•œåƒæ–‡ä»¶ä¸‹è½½åœ°å€ï¼šhttp://pan.baidu.com/s/1dF3Q8Idï¼Œä¸‹è½½åŽç”¨UltraISOå°†é•œåƒæ–‡ä»¶åˆ»å½•åˆ°Uç›˜é‡Œï¼š1.æ‰“å¼€UltralISOï¼Œé€‰æ‹©æ–‡ä»¶â†’æ‰“å¼€ï¼Œé€‰ä¸­ä¸‹è½½å¥½çš„win10é•œåƒæ–‡ä»¶ï¼š 2.é€‰æ‹©å¯åŠ¨â†’å†™å…¥ç¡¬ç›˜æ˜ åƒï¼Œç¡¬ç›˜é©±åŠ¨å™¨é€‰æ‹©æ’å…¥çš„Uç›˜ï¼š3.ç‚¹å‡»ä¾¿æ·å¯åŠ¨â†’å†™å…¥æ–°çš„é©±åŠ¨å™¨å¼•å¯¼æ‰‡åŒºâ†’Windows9xï¼Œå¼¹å‡ºæ¡†ï¼š4.ç‚¹å‡»ç¡®å®šï¼Œç„¶åŽç‚¹å‡»å†™å…¥ï¼Œç­‰å¾…å†™å…¥å®Œæ¯•ã€‚å†™å…¥å®Œæ¯•åŽé‡å¯ç”µè„‘ï¼Œå‡ºçŽ°å“ç‰ŒLogoçš„æ—¶å€™æŒ‰F2è¿›å¦‚BIOSè®¾ç½®ç•Œé¢ã€‚è¿›è¡Œå¦‚ä¸‹è®¾ç½®ï¼šâ€¢ å°†Security Boot è®¾ç½®ä¸ºDisabledâ€¢ å¯åŠ¨æ–¹å¼è®¾ç½®ä¸ºUEFIä¿å­˜è®¾ç½®é‡å¯ç”µè„‘ï¼Œå‡ºçŽ°å“ç‰ŒLogoçš„æ—¶å€™æŒ‰F12è¿›å…¥å¯åŠ¨é€‰æ‹©ç•Œé¢ï¼Œç„¶åŽé€‰æ‹©UEFIæ¨¡å¼ä¸‹çš„Uç›˜é€‰é¡¹ï¼ŒæŽ¥ä¸‹æ¥æ ¹æ®æç¤ºæ“ä½œå³å¯ã€‚å®‰è£…é€”ä¸­ï¼Œå¯èƒ½å‡ºçŽ°æ— æ³•å°†windowså®‰è£…åˆ°ç£ç›˜0çš„åˆ†åŒº1é”™è¯¯æç¤ºï¼Œè§£å†³åŠžæ³•ä¸ºï¼šæŒ‰ä½â€œshift+f10â€ï¼Œå‘¼å‡ºâ€œcmdâ€å‘½ä»¤ç¬¦è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š1234567diskpart //å›žè½¦æ‰§è¡Œï¼Œè¿›å…¥diskpartå‘½ä»¤æ¨¡å¼list disk //å›žè½¦æ‰§è¡Œï¼Œæ˜¾ç¤ºç£ç›˜ä¿¡æ¯select disk 0 //å›žè½¦æ‰§è¡Œï¼Œé€‰æ‹©ç¬¬0ä¸ªç£ç›˜ï¼ˆç”µè„‘çš„ç¡¬ç›˜ç¼–å·æ˜¯ä»Ž0å¼€å§‹çš„ï¼‰clean //å›žè½¦æ‰§è¡Œï¼Œåˆ é™¤ç£ç›˜åˆ†åŒº&amp;æ ¼å¼åŒ–ï¼ˆæ‰€ä»¥è¯´è¦åšå¥½å¤‡ä»½ï¼ï¼‰convert mbr //å›žè½¦æ‰§è¡Œï¼Œå°†å½“å‰ç£ç›˜åˆ†åŒºè®¾ç½®ä¸ºmbrå½¢å¼convert gpt //å›žè½¦æ‰§è¡Œï¼Œå°†å°†å½“å‰ç£ç›˜åˆ†åŒºè®¾ç½®ä¸ºgptå½¢å¼exit //å›žè½¦æ‰§è¡Œï¼Œé€€å‡ºåˆ·æ–°ç£ç›˜ï¼Œå³å¯ç»§ç»­å®‰è£…ã€‚å®‰è£…Ubuntu16.04é•œåƒæ–‡ä»¶åœ¨ubuntuå®˜ç½‘ä¸‹è½½ï¼šhttps://www.ubuntu.com/download/desktopã€‚å®‰è£…å‰ï¼Œå…ˆåœ¨win10ä¸‹åŽ‹ç¼©å‡º100GBçš„ç£ç›˜ç©ºé—´ï¼ˆæˆ‘çš„ç£ç›˜å¤§å°ä¸º256GBï¼Œæ‰€ä»¥åˆ†100GBç»™ubuntuï¼Œä¿æŒæœªåˆ†é…çŠ¶æ€ï¼‰ã€‚åŒæ ·ä½¿ç”¨UltralISOå°†ubuntué•œåƒæ–‡ä»¶åˆ»å½•è¿›Uç›˜é‡Œï¼ˆUç›˜å…ˆæ ¼å¼åŒ–ä¸ºFAT32æ¨¡å¼ï¼Œç„¶åŽåˆ»å½•æ—¶å†™å…¥æ–°çš„é©±åŠ¨å™¨å¼•å¯¼æ‰‡åŒºä¸ºsyslinuxï¼‰ã€‚åˆ»å½•å®Œé‡å¯ç”µè„‘ï¼Œå‡ºçŽ°å“ç‰ŒLogoçš„æ—¶å€™æŒ‰F12è¿›å…¥å¯åŠ¨é€‰æ‹©ç•Œé¢ï¼Œé€‰æ‹©UEFIæ¨¡å¼ä¸‹çš„Uç›˜é€‰é¡¹ï¼Œç„¶åŽInstall ubuntuã€‚å®‰è£…è¿‡ç¨‹ä¸­ä¸è¦é€‰æ‹©â€œä¸Žå…¶å®ƒç³»ç»Ÿå…±å­˜â€é‚£ä¸€é¡¹ï¼Œè€Œé€‰æ‹©æœ€åŽé‚£ä¸ªâ€œå…¶å®ƒé€‰é¡¹ï¼ˆåˆ›å»ºè‡ªå·±çš„åˆ†åŒºï¼‰â€ï¼Œç„¶åŽé€‰æ‹©ç©ºé—²åˆ†åŒºï¼ˆå°±æ˜¯åˆšåˆšåˆ†å‡ºæ¥çš„100GBï¼‰ï¼Œä¸‹é¢ä¾æ¬¡ç‚¹å‡»æ–°å»ºåˆ†åŒºè¡¨æ¥æŒ‚è½½åˆ†åŒºï¼š1.æ–°å»ºefiç³»ç»Ÿåˆ†åŒºï¼Œé€‰ä¸­é€»è¾‘åˆ†åŒºå’Œç©ºé—´èµ·å§‹ä½ç½®ï¼Œåˆ†é…512MBã€‚2.æŒ‚è½½â€œ/homeâ€ï¼Œç±»åž‹ä¸ºEXT4æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿï¼Œé€‰ä¸­é€»è¾‘åˆ†åŒºå’Œç©ºé—´èµ·å§‹ä½ç½®ï¼Œåˆ†é…20GBã€‚3.æŒ‚è½½â€œ/usrâ€ï¼Œç±»åž‹ä¸ºEXT4æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿï¼Œé€‰ä¸­é€»è¾‘åˆ†åŒºå’Œç©ºé—´èµ·å§‹ä½ç½®ï¼Œåˆ†é…45GBã€‚4.æŒ‚è½½â€œ/â€ï¼Œç±»åž‹ä¸ºEXT4æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿï¼Œé€‰ä¸­é€»è¾‘åˆ†åŒºå’Œç©ºé—´èµ·å§‹ä½ç½®ï¼Œåˆ†é…20GBã€‚5.swapäº¤æ¢ç©ºé—´ï¼Œè¿™ä¸ªä¹Ÿå°±æ˜¯è™šæ‹Ÿå†…å­˜çš„åœ°æ–¹ï¼Œé€‰æ‹©ä¸»åˆ†åŒºå’Œç©ºé—´èµ·å§‹ä½ç½®ï¼Œå‰©ä¸‹çš„å†…å­˜éƒ½åˆ†é…ç»™å®ƒã€‚åˆ†é…å¥½å„ä¸ªæŒ‚è½½ç‚¹åŽï¼Œé€‰æ‹©â€œå®‰è£…å¼•å¯¼å¯åŠ¨å™¨çš„è®¾å¤‡â€ï¼Œé€‰æ‹©ç¬¬ä¸€æ­¥åˆ›å»ºçš„efiç³»ç»Ÿåˆ†åŒºï¼ï¼ï¼ï¼ï¼å®‰è£…æˆåŠŸåŽï¼Œæ‹”æŽ‰Uç›˜å¹¶ä¸”é‡å¯ï¼Œå‡ºçŽ°å“ç‰ŒLogoçš„æ—¶å€™æŒ‰F2è¿›å¦‚BIOSè®¾ç½®ç•Œé¢å¼€å¯Secure Bootï¼Œä¿å­˜é€€å‡ºå¯åŠ¨ç”µè„‘å°±å¯ä»¥çœ‹åˆ°ç³»ç»Ÿé€‰æ‹©ç•Œé¢äº†ã€‚æœ€åŽè´´ä¸¤å¼ å®‰è£…å¥½åŽçš„ç³»ç»Ÿæˆªå›¾ï¼šwin10ubuntuï¼š]]></content>
      <tags>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxæ–‡ä»¶æƒé™]]></title>
    <url>%2FLinux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90.html</url>
    <content type="text"><![CDATA[Linux æœ€ä¼˜ç§€çš„åœ°æ–¹ä¹‹ä¸€å°±åœ¨äºŽä»–çš„å¤šäººå¤šä»»åŠ¡çŽ¯å¢ƒã€‚è€Œä¸ºäº†è®©å„ä¸ªä½¿ç”¨è€…å…·æœ‰è¾ƒä¿å¯†çš„æ–‡ä»¶æ•°ï¼Œå› æ­¤æ–‡ä»¶çš„æƒé™ç®¡ç†å°±å˜å¾—å¾ˆé‡è¦äº†ã€‚Linuxä¸€èˆ¬å°†æ–‡ä»¶å¯å­˜å–çš„èº«ä»½åˆ†ä¸ºä¸‰ä¸ªç±»åˆ«ï¼šowner/group/othersï¼Œä¸”ä¸‰ç§èº«ä»½å„æœ‰read/write/executeç­‰æƒé™ã€‚æ–‡ä»¶å±žæ€§ä½¿ç”¨lså‘½ä»¤æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶çš„å±žæ€§ï¼š12345678910111213mrbird@mrbird-xps13:~$ ls -alhæ€»ç”¨é‡ 196Kdrwxr-xr-x 32 mrbird mrbird 4.0K 3æœˆ 26 11:34 .drwxr-xr-x 4 root root 4.0K 3æœˆ 25 03:31 ..drwxrwxr-x 4 mrbird mrbird 4.0K 3æœˆ 26 10:58 .audacity-data-rw------- 1 mrbird mrbird 5.5K 3æœˆ 26 11:18 .bash_history-rw-r--r-- 1 mrbird mrbird 220 3æœˆ 25 03:31 .bash_logout-rw-r--r-- 1 mrbird mrbird 3.7K 3æœˆ 25 03:31 .bashrcdrwx------ 25 mrbird mrbird 4.0K 3æœˆ 26 11:34 .cachedrwx------ 30 mrbird mrbird 4.0K 3æœˆ 26 10:51 .configdrwxrwxr-x 4 mrbird mrbird 4.0K 3æœˆ 25 20:19 .cxofficedrwx------ 3 mrbird mrbird 4.0K 3æœˆ 25 11:35 .dbus...æ–‡ä»¶å±žæ€§åˆ†ä¸º7ä¸ªéƒ¨åˆ†ï¼Œä»Žå·¦åˆ°å³ä¾æ¬¡æ˜¯ï¼šæ–‡ä»¶ç±»åž‹å’Œæƒé™ï¼Œè¿žæŽ¥æ•°ï¼Œæ‹¥æœ‰è€…ï¼Œç¾¤ç»„ï¼Œæ–‡ä»¶å®¹é‡ï¼Œä¿®æ”¹æ—¥æœŸå’Œæ–‡ä»¶åã€‚1.æ–‡ä»¶çš„ç±»åž‹ä¸Žæƒé™ï¼ˆpermissionï¼‰ï¼šå¦‚ï¼šdrwxrwxr-xæˆ‘ä»¬æ‹†åˆ†ä¸ºd rwx rwx r-x å››ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†ä»£è¡¨æ–‡ä»¶ç±»åž‹ï¼Œç±»åž‹æœ‰ï¼šâ€¢ å½“ä¸º[ d ]åˆ™æ˜¯ç›®å½•ï¼Œä¾‹å¦‚ä¸Šé¢æ–‡ä»¶åä¸ºã€Ž.configã€çš„é‚£ä¸€è¡Œã€‚â€¢ å½“ä¸º[ - ]åˆ™æ˜¯æ–‡ä»¶ï¼Œä¾‹å¦‚ä¸Šè¡¨æ¡£åä¸ºã€Ž.bash_historyã€é‚£ä¸€è¡Œã€‚â€¢ è‹¥æ˜¯[ l ]åˆ™è¡¨ç¤ºä¸ºè¿žç»“æ¡£ï¼ˆlink fileï¼‰ã€‚â€¢ è‹¥æ˜¯[ b ]åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„å¯ä¾›å‚¨å­˜çš„æŽ¥å£è®¾å¤‡ï¼ˆå¯éšæœºå­˜å–è£…ç½®ï¼‰ã€‚â€¢ è‹¥æ˜¯[ c ]åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„ä¸²è¡Œç«¯å£è®¾å¤‡ï¼Œä¾‹å¦‚é”®ç›˜ã€é¼ æ ‡ï¼ˆä¸€æ¬¡æ€§è¯»å–è£…ç½®ï¼‰ã€‚å‰©ä½™çš„ä¸‰ä¸ªéƒ¨åˆ†åˆ†åˆ«è¡¨ç¤ºæ–‡ä»¶æ‹¥æœ‰è€…å¯å…·å¤‡çš„æƒé™ï¼ŒåŠ å…¥æ­¤ç¾¤ç»„è´¦å·çš„æƒé™å’Œéžæœ¬äººä¸”æ²¡æœ‰åŠ å…¥æœ¬ç¾¤ç»„ä¹‹å…¶ä»–è´¦å·çš„æƒé™ã€‚å…¶ä¸­rwxåˆ†åˆ«è¡¨ç¤ºï¼š[ r ]ä»£è¡¨å¯è¯»ï¼ˆreadï¼‰ã€[ w ]ä»£è¡¨ å¯å†™ï¼ˆwriteï¼‰ã€[ x ]ä»£è¡¨å¯æ‰§è¡Œï¼ˆexecuteï¼‰ã€‚å¦‚æžœæ²¡æœ‰æƒé™ï¼Œå°±ç”¨å‡å·[ - ]è¡¨ç¤ºã€‚2.è¿žæŽ¥æ•°ï¼ˆi-nodeï¼‰ï¼šæ¯ä¸ªæ–‡ä»¶éƒ½ä¼šå°†ä»–çš„æƒé™ä¸Žå±žæ€§è®°å½•åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ i-node ä¸­ï¼Œä¸è¿‡æˆ‘ä»¬ä½¿ç”¨çš„ç›®å½•æ ‘å´æ˜¯ä½¿ç”¨æ–‡ä»¶åæ¥è®°å½•ï¼Œå› æ­¤æ¯ä¸ªæ¡£åå°±ä¼šè¿žç»“åˆ°ä¸€ä¸ª i-nodeã€‚è¿™ä¸ªå±žæ€§è®°å½•çš„å°±æ˜¯æœ‰å¤šå°‘ä¸åŒçš„æ¡£åè¿žç»“åˆ°ç›¸åŒçš„ä¸€ä¸ª i-node å·ç äº†ã€‚3.æ‹¥æœ‰è€…ï¼šè¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶(æˆ–ç›®å½•)çš„ã€Žæ‹¥æœ‰è€…è´¦å·ã€ã€‚4.ç¾¤ç»„ï¼šåœ¨ Linux ç³»ç»Ÿä¸‹ï¼Œä½ çš„è´¦å·ä¼šåŠ å…¥äºŽä¸€ä¸ªæˆ–å¤šä¸ªçš„ç¾¤ç»„ä¸­ã€‚ä¾‹å¦‚p1ï¼Œp2ï¼Œp3å‡å±žäºŽ people è¿™ä¸ªç¾¤ç»„ï¼Œå‡è®¾æŸä¸ªæ–‡ä»¶æ‰€å±žçš„ç¾¤ç»„ä¸º peopleï¼Œä¸”è¯¥æ–‡ä»¶çš„æƒé™ä¸ºï¼ˆ-rwxrwx---ï¼‰ï¼Œåˆ™p1ï¼Œp2ï¼Œp3ä¸‰äººå¯¹äºŽè¯¥æ–‡ä»¶éƒ½å…·æœ‰å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œçš„æƒé™ï¼ˆçœ‹ç¾¤ç»„æƒé™ï¼‰ã€‚ ä½†å¦‚æžœæ˜¯ä¸å±žäºŽpeopleç¾¤ç»„çš„å…¶ä»–è´¦å·ï¼Œå¯¹äºŽæ­¤æ–‡ä»¶å°±ä¸å…·æœ‰ä»»ä½•æƒé™äº†ã€‚5.æ–‡ä»¶å®¹é‡ï¼šä»£è¡¨æ–‡ä»¶çš„å®¹é‡å¤§å°ï¼Œé»˜è®¤å•ä½ä¸º bytesã€‚6.ä¿®æ”¹æ—¥æœŸï¼šä»£è¡¨æ–‡ä»¶åˆ›å»ºæˆ–æœ€åŽä¿®æ”¹çš„æ—¥æœŸã€‚7.æ–‡ä»¶åï¼šå¦‚æžœä¸ºéšè—æ–‡ä»¶ï¼Œåˆ™ä»¥.å¼€å¤´ã€‚æ›´æ”¹æ–‡ä»¶å±žæ€§å’Œæƒé™æ¶‰åŠçš„æŒ‡ä»¤ï¼šchgrpï¼šæ”¹å˜æ–‡ä»¶æ‰€å±žç¾¤ç»„ï¼Œchownï¼šæ”¹å˜æ–‡ä»¶æ‹¥æœ‰è€…ï¼Œchmodï¼šæ”¹å˜æ–‡ä»¶çš„æƒé™ã€‚1.chgrpï¼ˆchange groupï¼‰ï¼šè¯­æ³•ï¼š1234chgrp [-R] dirname/filename ...é€‰é¡¹ä¸Žå‚æ•°:-R : è¿›è¡Œé€’å½’ï¼ˆrecursiveï¼‰çš„æŒç»­å˜æ›´ï¼Œäº¦å³è¿žåŒæ¬¡ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€ ç›®å½•éƒ½æ›´æ–°æˆä¸ºè¿™ä¸ªç¾¤ç»„ä¹‹æ„ã€‚å¸¸å¸¸ç”¨åœ¨å˜æ›´æŸä¸€ç›®å½•å†…æ‰€æœ‰çš„æ–‡ä»¶çš„æƒ…å†µã€‚æ¯”å¦‚ï¼Œæ”¹å˜æ–‡ä»¶examples.desktopçš„ç¾¤ç»„ä¸ºrootï¼š123456789root@mrbird-xps13:/home/mrbird# ls -lhæ€»ç”¨é‡ 48K-rw-r--r-- 1 mrbird mrbird 8.8K 3æœˆ 25 03:31 examples.desktop...root@mrbird-xps13:/home/mrbird# chgrp root examples.desktop root@mrbird-xps13:/home/mrbird# ls -lhæ€»ç”¨é‡ 48K-rw-r--r-- 1 mrbird root 8.8K 3æœˆ 25 03:31 examples.desktop...2.chownï¼ˆchange ownerï¼‰ï¼šchownä¸ä½†å¯ä»¥æ”¹å˜æ–‡ä»¶æ‹¥æœ‰è€…ï¼Œä¹Ÿå¯ä»¥æ”¹å˜ç¾¤ç»„ï¼è¯­æ³•å¦‚ä¸‹ï¼š1234chown [-R] è´¦å·åç§° æ–‡ä»¶æˆ–ç›®å½•chown [-R] è´¦å·åç§°:ç»„å æ–‡ä»¶æˆ–ç›®å½•é€‰é¡¹ä¸Žå‚æ•°:-R : è¿›è¡Œé€’å½’(recursive)çš„æŒç»­å˜æ›´,äº¦å³è¿žåŒæ¬¡ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½å˜æ›´ä¾‹ï¼šå°†examples.desktopçš„æ‹¥æœ‰è€…æ”¹ä¸ºrootï¼š123456789root@mrbird-xps13:/home/mrbird# ls -lhæ€»ç”¨é‡ 48K-rw-r--r-- 1 mrbird mrbird 8.8K 3æœˆ 25 03:31 examples.desktop...root@mrbird-xps13:/home/mrbird# chown root examples.desktop root@mrbird-xps13:/home/mrbird# ls -lhæ€»ç”¨é‡ 48K-rw-r--r-- 1 root mrbird 8.8K 3æœˆ 25 03:31 examples.desktop...ä¾‹ï¼šå°†examples.desktopçš„æ‹¥æœ‰è€…å’Œç¾¤ç»„éƒ½æ”¹ä¸ºrootï¼š12345root@mrbird-xps13:/home/mrbird# chown root:root examples.desktop root@mrbird-xps13:/home/mrbird# ls -lhæ€»ç”¨é‡ 48K-rw-r--r-- 1 root root 8.8K 3æœˆ 25 03:31 examples.desktop...3.chmodï¼šæ”¹å˜æƒé™æœ‰ä¸¤ç§æ–¹å¼ï¼šæ•°å­—ç±»åž‹å’Œç¬¦å·ç±»åž‹ã€‚â€¢ æ•°å­—ç±»åž‹æ”¹å˜æ–‡ä»¶æƒé™ï¼šrwxåˆ†åˆ«ä»£è¡¨421ï¼Œä¾‹å¦‚å½“æƒé™ä¸º: [-rwxrwx---] åˆ†æ•° åˆ™æ˜¯ï¼šowner = rwx = 4+2+1 = 7group = rwx = 4+2+1 = 7others= â€” = 0+0+0 = 0æ•°å­—ç±»åž‹æ”¹å˜æƒé™è¯­æ³•ï¼š1234chmod [-R] xyz æ–‡ä»¶æˆ–ç›®å½•é€‰é¡¹ä¸Žå‚æ•°:xyz : å°±æ˜¯åˆšåˆšæåˆ°çš„æ•°å­—ç±»åž‹çš„æƒé™å±žæ€§,ä¸º rwx å±žæ€§æ•°å€¼çš„ç›¸åŠ ã€‚-R : è¿›è¡Œé€’å½’(recursive)çš„æŒç»­å˜æ›´,äº¦å³è¿žåŒæ¬¡ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šå˜æ›´ä¾‹ï¼šå°†examples.desktopçš„æƒé™éƒ½å¯ç”¨ï¼š123456789root@mrbird-xps13:/home/mrbird# ls -lhæ€»ç”¨é‡ 48K-rw-r--r-- 1 root root 8.8K 3æœˆ 25 03:31 examples.desktop...root@mrbird-xps13:/home/mrbird# chmod 777 examples.desktop root@mrbird-xps13:/home/mrbird# ls -lhæ€»ç”¨é‡ 48K-rwxrwxrwx 1 root root 8.8K 3æœˆ 25 03:31 examples.desktop...â€¢ ç¬¦å·ç±»åž‹æ”¹å˜æ–‡ä»¶æƒé™åœ¨ç¬¦å·ç±»åž‹æ”¹å˜æƒé™çš„è§„åˆ™ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨uï¼Œgï¼Œoæ¥ä»£è¡¨userï¼Œgroupå’Œownerä¸‰ç§èº«ä»½çš„æƒé™ã€‚æ­¤å¤–ï¼Œa åˆ™ä»£è¡¨ all äº¦å³å…¨éƒ¨çš„èº«ä»½ã€‚ç›¸åº”è§„åˆ™å¯çœ‹ä¸‹è¡¨ï¼šchmodugoa+(åŠ å…¥)-(é™¤åŽ»)=(è®¾å®š)rwxæ–‡ä»¶æˆ–ç›®å½•ä¾‹å¦‚ï¼Œå°†æ–‡ä»¶examples.desktopçš„æƒé™æ”¹ä¸º-rw-r--r--ï¼š12345root@mrbird-xps13:/home/mrbird# chmod u=rw,go=r examples.desktop root@mrbird-xps13:/home/mrbird# ls -lhæ€»ç”¨é‡ 48K-rw-r--r-- 1 root root 8.8K 3æœˆ 25 03:31 examples.desktop...ä¾‹å¦‚ï¼Œå¢žåŠ æ–‡ä»¶examples.desktopæ¯ä¸ªäººå‡å¯å†™å…¥çš„æƒé™ï¼š12345root@mrbird-xps13:/home/mrbird# chmod a+w examples.desktop root@mrbird-xps13:/home/mrbird# ls -lhæ€»ç”¨é‡ 48K-rw-rw-rw- 1 root root 8.8K 3æœˆ 25 03:31 examples.desktop...æƒé™çš„æ„ä¹‰1.å¯¹äºŽæ–‡ä»¶æ¥è¯´ï¼Œrwxä»£è¡¨ï¼šâ€¢ r (read)ï¼šå¯è¯»å–æ­¤ä¸€æ–‡ä»¶çš„å®žé™…å†…å®¹,å¦‚è¯»å–æ–‡æœ¬æ–‡ä»¶çš„æ–‡å­—å†…å®¹ç­‰ã€‚â€¢ w (write)ï¼šå¯ä»¥ç¼–è¾‘ã€æ–°å¢žæˆ–è€…æ˜¯ä¿®æ”¹è¯¥æ–‡ä»¶çš„å†…å®¹ï¼ˆä½†ä¸å«åˆ é™¤è¯¥æ–‡ä»¶ï¼‰ã€‚â€¢ x (eXecute)ï¼šè¯¥æ–‡ä»¶å…·æœ‰å¯ä»¥è¢«ç³»ç»Ÿæ‰§è¡Œçš„æƒé™ï¼ˆç±»ä¼¼ä¸Žwindowä¸­çš„exeï¼Œbatç­‰ï¼‰ã€‚2.å¯¹äºŽç›®å½•æ¥è¯´ï¼Œrwxä»£è¡¨ï¼šâ€¢ r (read contents in directory)ï¼šè¡¨ç¤ºå…·æœ‰è¯»å–ç›®å½•ç»“æž„åˆ—è¡¨çš„æƒé™ï¼Œæ‰€ä»¥å½“ä½ å…·æœ‰è¯»å–ï¼ˆrï¼‰ä¸€ä¸ªç›®å½•çš„æƒé™æ—¶ï¼Œè¡¨ç¤ºä½ å¯ä»¥æŸ¥è¯¢è¯¥ç›®å½•ä¸‹çš„æ–‡ä»¶åæ•°æ®ã€‚ æ‰€ä»¥ä½ å°±å¯ä»¥åˆ©ç”¨ ls è¿™ä¸ªæŒ‡ä»¤å°†è¯¥ç›®å½•çš„å†…å®¹åˆ—è¡¨æ˜¾ç¤ºå‡ºæ¥ã€‚â€¢ w (modify contents of directory)ï¼šè¡¨ç¤ºä½ å…·æœ‰å¼‚åŠ¨è¯¥ç›®å½•ç»“æž„åˆ—è¡¨çš„æƒé™ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å¯¹è¯¥ç›®å½•æˆ–è€…å…¶ä¸‹çš„æ–‡ä»¶è¿›è¡Œæ›¾åˆ æ”¹æ“ä½œï¼â€¢ x (access directory)ï¼šç›®å½•çš„ x ä»£è¡¨çš„æ˜¯ç”¨æˆ·èƒ½å¦è¿›å…¥è¯¥ç›®å½•æˆä¸ºå·¥ä½œç›®å½•ï¼Œæ‰€è°“çš„å·¥ä½œç›®å½•ï¼ˆwork directoryï¼‰å°±æ˜¯ä½ ç›®å‰æ‰€åœ¨çš„ç›®å½•ã€‚]]></content>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Leanoteåšå®¢ä¸»é¢˜Material Design]]></title>
    <url>%2FLeanote%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98Material-Design.html</url>
    <content type="text"><![CDATA[Material Designï¼ˆå¡ç‰‡å¼ææ–™è®¾è®¡ï¼‰æ˜¯è°·æ­Œåœ¨I/O 2014ä¸Šå‘å¸ƒçš„æ–°çš„è®¾è®¡è¯­è¨€ã€‚åœ¨Materialçš„æ‰å¹³åŒ–è®¾è®¡ä¸­ï¼Œå®ƒä½¿ç”¨äº†åˆ†å±‚å…ƒç´ æ¥è¥é€ ä¸‰ç»´ç©ºé—´ã€‚è¯¥ä¸»é¢˜æœ‰Lightå’ŒDarkä¸¤ç§æ˜¾ç¤ºæ¨¡å¼ï¼Œå¯é€šè¿‡toolBarå³ä¾§çš„æŒ‰é’®åˆ‡æ¢ã€‚åšå®¢å¯åœ¨ä¸»é¢˜æ–‡ä»¶theme.jsonä¸­ä½œç®€å•çš„ä¿®æ”¹ï¼Œtheme.jsonæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š12345678910111213&#123; ... "WebImgName": "leanote.png", "Color": "blue", "ColorStrength": "300", "BlogImg": "material.jpg", "FriendLinks": [ &#123;"Title": "My Note", "Url": "https://leanote.com/note"&#125;, &#123;"Title": "Leanote Home", "Url": "https://leanote.com"&#125;, &#123;"Title": "Leanote BBS", "Url": "http://bbs.leanote.com"&#125;, &#123;"Title": "Leanote Github", "Url": "https://github.com/leanote/leanote"&#125; ]&#125;ä¸»é¢˜é¢„è§ˆï¼štheme.jsonæ–‡ä»¶ä¸­ï¼ŒWebImgName ä¸ºç½‘é¡µå°å›¾æ ‡å›¾ç‰‡åç§°+æ ¼å¼åï¼Œ BlogImgä¸ºåšå®¢æ ‡é¢˜èƒŒæ™¯å›¾+æ ¼å¼åï¼Œæ ‡é¢˜çš„èƒŒæ™¯å›¾å°ºå¯¸å»ºè®®ä¸º350X130ï¼ŒColorä¸ºåšå®¢é¢œè‰²ï¼ˆæ¯”å¦‚toolBarå’ŒæŒ‰é’®ç­‰ç»„ä»¶çš„é¢œè‰²ï¼‰ï¼ŒColorStrengthä¸ºé¢œè‰²çš„æµ“åº¦ã€‚ä¸‹é¢ä¸ºæ‰€æœ‰å¯å–çš„å€¼ï¼š è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œé¢œè‰²åç§°å¿…é¡»ä¸ºå…¨å°å†™ï¼Œæ¯”å¦‚Blueåº”å†™ä¸ºblueã€‚å¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿Žç•™è¨€ã€‚2017å¹´3æœˆ20æ—¥ä¿®å¤äº†å‡ å¤„åœ¨ç«ç‹æµè§ˆå™¨ä¸‹çš„bugã€‚2017å¹´3æœˆ23æ—¥ä¿®å¤Markdownä¸‹ç‚¹å‡»æ–‡ç« å¯¼èˆªä¸è·³è½¬é—®é¢˜ã€‚æœ€æ–°ä¸»é¢˜åŒ…ä¸‹è½½åœ°å€ï¼šgithub]]></content>
      <tags>
        <tag>Leanote</tag>
        <tag>theme</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­å»ºSSM (Spring+SpringMVC+MyBatis)]]></title>
    <url>%2F%E6%90%AD%E5%BB%BASSM-Spring-SpringMVC-MyBatis.html</url>
    <content type="text"><![CDATA[Spring+SpringMVCçš„æ­å»ºå‚è€ƒåšæ–‡ â€”â€” æ­å»ºSpringMVCã€‚è¿™é‡Œä¸»è¦è®°å½•SpringMVCä¸ŽMyBatisçš„æ•´åˆã€‚å‡†å¤‡å·¥ä½œæ•°æ®åº“ä½¿ç”¨MySqlï¼Œåˆ›å»ºä¸€å¼ æµ‹è¯•è¡¨ï¼š1234567 CREATE TABLE `emp` ( `ID` int(4) NOT NULL AUTO_INCREMENT, `NAME` varchar(50) COLLATE utf8_unicode_ci NOT NULL, `AGE` int(11) DEFAULT NULL, `BIRTHDAY` date DEFAULT NULL, PRIMARY KEY (`ID`))å¼•å…¥ä¾èµ–ï¼š123456789101112131415161718192021222324252627282930313233343536&lt;!-- springäº‹åŠ¡ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-tx&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt;&lt;/dependency&gt; &lt;!-- spring jdbc --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;!-- mysqlæ•°æ®åº“è¿žæŽ¥åŒ…--&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.6&lt;/version&gt;&lt;/dependency&gt;&lt;!-- æ•°æ®åº“è¿žæŽ¥æ± --&gt;&lt;dependency&gt; &lt;groupId&gt;c3p0&lt;/groupId&gt; &lt;artifactId&gt;c3p0&lt;/artifactId&gt; &lt;version&gt;0.9.1.2&lt;/version&gt;&lt;/dependency&gt;&lt;!-- mybatis --&gt;&lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;3.4.1&lt;/version&gt;&lt;/dependency&gt;&lt;!-- mybaits-spring --&gt;&lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt; &lt;version&gt;1.3.0&lt;/version&gt;&lt;/dependency&gt;Springé…ç½®æ–‡ä»¶åœ¨applicationContext.xmlæ–‡ä»¶ä¸­é…ç½®æ•°æ®åº“ï¼š12345678910111213&lt;!-- å±žæ€§å ä½ç¬¦ --&gt;&lt;context:property-placeholder location="classpath:/config.properties" /&gt;&lt;!--é…ç½®æ•°æ®æº--&gt;&lt;bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close"&gt; &lt;property name="driverClass" value="$&#123;jdbc.driver&#125;" /&gt; &lt;property name="jdbcUrl" value="$&#123;jdbc.url&#125;" /&gt; &lt;property name="user" value="$&#123;jdbc.username&#125;" /&gt; &lt;property name="password" value="$&#123;jdbc.password&#125;" /&gt; &lt;property name="maxPoolSize" value="40" /&gt; &lt;property name="minPoolSize" value="1" /&gt; &lt;property name="initialPoolSize" value="10" /&gt; &lt;/bean&gt;é…ç½®SqlSessionFactoryä»¥åŠsqlSessionTemplateï¼š12345678910&lt;!-- mybatis çš„SqlSessionFactory --&gt;&lt;bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean" scope="prototype"&gt; &lt;property name="dataSource" ref="dataSource"/&gt; &lt;!-- æŒ‡å®šmybaitsé…ç½®æ–‡ä»¶è·¯å¾„ --&gt; &lt;property name="configLocation" value="classpath:mybatis-config.xml"/&gt;&lt;/bean&gt;&lt;!-- sqlSessionTemplate --&gt;&lt;bean id="sqlSessionTemplate" class="org.mybatis.spring.SqlSessionTemplate" scope="prototype"&gt; &lt;constructor-arg index="0" ref="sqlSessionFactory"/&gt;&lt;/bean&gt;é…ç½®äº‹åŠ¡ï¼š1234567&lt;!-- äº‹ç‰©ç®¡ç†å™¨é…ç½® --&gt;&lt;bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt; &lt;property name="dataSource" ref="dataSource"/&gt;&lt;/bean&gt;&lt;!-- å¼€å¯æ³¨è§£äº‹åŠ¡ --&gt;&lt;tx:annotation-driven transaction-manager="transactionManager" proxy-target-class="true"/&gt;é…ç½®æ‰«æmapperï¼š123456&lt;!-- é‡‡ç”¨è‡ªåŠ¨æ‰«æçš„æ–¹å¼åˆ›å»ºmapper bean --&gt;&lt;bean class="org.mybatis.spring.mapper.MapperScannerConfigurer"&gt; &lt;property name="basePackage" value="ssm"/&gt; &lt;property name="sqlSessionTemplateBeanName" value="sqlSessionTemplate"/&gt; &lt;property name="annotationClass" value="org.springframework.stereotype.Repository"/&gt;&lt;/bean&gt;MyBatisé…ç½®æ–‡ä»¶mybaits-config.xmlï¼š123456789101112131415161718192021 &lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt; &lt;configuration&gt; &lt;settings&gt; &lt;setting name="cacheEnabled" value="true"/&gt; &lt;setting name="useGeneratedKeys" value="true"/&gt; &lt;setting name="defaultExecutorType" value="REUSE"/&gt; &lt;setting name="lazyLoadingEnabled" value="true"/&gt; &lt;setting name="defaultStatementTimeout" value="25000"/&gt; &lt;/settings&gt; &lt;typeAliases&gt; &lt;!--ç»™å®žä½“ç±»èµ·ä¸€ä¸ªåˆ«å --&gt; &lt;typeAlias type="ssm.mrbird.entity.Emp" alias="emp" /&gt; &lt;/typeAliases&gt; &lt;mappers&gt; &lt;!--RoleMapper.xmlè£…è½½è¿›æ¥ åŒç­‰äºŽæŠŠ'mapper'çš„å®žçŽ°è£…è½½è¿›æ¥ --&gt; &lt;mapper resource="ssm/mrbird/mapper/EmpMapper.xml" /&gt; &lt;/mappers&gt; &lt;/configuration&gt;åˆ›å»ºå®žä½“åˆ›å»ºåº“è¡¨å¯¹åº”å®žä½“Empï¼š12345678910import java.io.Serializable;import java.sql.Date; public class Emp implements Serializable&#123; private long id; private String name; private int age; private Date birthday; // get set ç•¥&#125;æŽ¥å£ä¸Žæ˜ å°„åˆ›å»ºä¸€ä¸ªåŒ…å«åŸºæœ¬CRUDçš„æŽ¥å£EmpMapperï¼š12345678910import org.springframework.stereotype.Repository;import ssm.mrbird.entity.Emp; @Repositorypublic interface EmpMapper &#123; public void insertEmp(Emp emp); public void updateEmp(Emp emp); public void deleteEmp(long id); public Emp getEmp(long id);&#125;å…¶å¯¹åº”çš„æ˜ å°„æ–‡ä»¶EmpMapper.xmlï¼š1234567891011121314151617181920212223&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="ssm.mrbird.mapper.EmpMapper"&gt; &lt;insert id="insertEmp" parameterType="emp"&gt; insert into emp(name,age,birthday) values (#&#123;name&#125;,#&#123;age&#125;,#&#123;birthday&#125;) &lt;/insert&gt; &lt;update id="updateEmp" parameterType="emp"&gt; update emp &lt;set&gt; &lt;if test="name != null"&gt;name = #&#123;name&#125;,&lt;/if&gt; &lt;if test="age != null"&gt;age = #&#123;age&#125;,&lt;/if&gt; &lt;if test="birthday != null"&gt;birthday = #&#123;birthday&#125;&lt;/if&gt; &lt;/set&gt; where id = #&#123;id&#125; &lt;/update&gt; &lt;delete id="deleteEmp" parameterType="long"&gt; delete from emp where id = #&#123;id&#125; &lt;/delete&gt; &lt;select id="getEmp" parameterType="long" resultType="emp"&gt; select id,name,age,birthday from emp where id = #&#123;id&#125; &lt;/select&gt;&lt;/mapper&gt;é…ç½®æœåŠ¡å±‚é¦–å…ˆåˆ›å»ºæŽ¥å£EmpServiceï¼š12345678import ssm.mrbird.entity.Emp; public interface EmpService &#123; public void insertEmp(Emp emp); public void updateEmp(Emp emp); public void deleteEmp(long id); public Emp getEmp(long id); &#125;å…¶å®žçŽ°ç±»EmpServiceImplï¼š123456789101112131415161718192021222324252627282930313233343536import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import org.springframework.transaction.annotation.Propagation;import org.springframework.transaction.annotation.Transactional; import ssm.mrbird.entity.Emp;import ssm.mrbird.mapper.EmpMapper;@Service@Transactional(propagation=Propagation.SUPPORTS,readOnly=true)public class EmpServiceImpl implements EmpService&#123; @Autowired private EmpMapper empMapper; @Override @Transactional(propagation=Propagation.REQUIRED,readOnly=false) public void insertEmp(Emp emp) &#123; this.empMapper.insertEmp(emp); &#125; @Override @Transactional(propagation=Propagation.REQUIRED,readOnly=false) public void updateEmp(Emp emp) &#123; this.empMapper.updateEmp(emp); &#125; @Override @Transactional(propagation=Propagation.REQUIRED,readOnly=false) public void deleteEmp(long id) &#123; this.empMapper.deleteEmp(id); &#125; @Override public Emp getEmp(long id) &#123; return this.empMapper.getEmp(id); &#125;&#125;è¿™é‡Œé‡‡ç”¨æ³¨è§£çš„æ–¹å¼é…ç½®äº‹åŠ¡ã€‚å…³äºŽäº‹åŠ¡ï¼Œå¯å‚è€ƒåšæ–‡ â€”â€” Springäº‹åŠ¡ç®¡ç†ã€‚æµ‹è¯•æœ€ç»ˆï¼Œå·¥ç¨‹çš„ç›®å½•ç»“æž„ä¸ºï¼šæµ‹è¯•åˆ›å»ºEmpï¼š1234567891011121314151617181920@Controllerpublic class TestController &#123; @Autowired private EmpService empService; @RequestMapping(value="/insert",method=RequestMethod.GET) @ResponseBody public String insertEmp()&#123; try &#123; Emp emp = new Emp(); emp.setName("mrbird"); emp.setAge(100); this.empService.insertEmp(emp); return "success"; &#125; catch (Exception e) &#123; e.printStackTrace(); return "fail"; &#125; &#125;&#125;å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®ï¼šhttp://localhost:8080/ssm/insertæŸ¥è¯¢æ•°æ®åº“ï¼š1234567mysql&gt; select * from emp;+----+--------+------+----------+| ID | NAME | AGE | BIRTHDAY |+----+--------+------+----------+| 1 | mrbird | 100 | NULL |+----+--------+------+----------+1 row in set (0.00 sec)æ’å…¥æˆåŠŸã€‚æµ‹è¯•getEmpï¼š12345678910@RequestMapping(value="/get",method=RequestMethod.GET)@ResponseBodypublic String getEmp()&#123; try &#123; return this.empService.getEmp(1l).getName(); &#125; catch (Exception e) &#123; e.printStackTrace(); return "fail"; &#125;&#125;è®¿é—®ï¼šhttp://localhost:8080/ssm/getæµ‹è¯•updateEmpï¼š12345678910111213@RequestMapping(value="/update",method=RequestMethod.GET)@ResponseBodypublic String updateEmp()&#123; try &#123; Emp emp = this.empService.getEmp(1l); emp.setAge(250); this.empService.updateEmp(emp); return "success"; &#125; catch (Exception e) &#123; e.printStackTrace(); return "fail"; &#125;&#125;è®¿é—®ï¼šhttp://localhost:8080/ssm/updateæŸ¥è¯¢æ•°æ®åº“ï¼š1234567mysql&gt; select * from emp;+----+--------+------+----------+| ID | NAME | AGE | BIRTHDAY |+----+--------+------+----------+| 1 | mrbird | 250 | NULL |+----+--------+------+----------+1 row in set (0.00 sec)æ›´æ–°æˆåŠŸã€‚æµ‹è¯•deleteEmpï¼š1234567891011@RequestMapping(value="/delete",method=RequestMethod.GET)@ResponseBodypublic String deleteEmp()&#123; try &#123; this.empService.deleteEmp(1l); return "success"; &#125; catch (Exception e) &#123; e.printStackTrace(); return "fail"; &#125;&#125;è®¿é—®ï¼šhttp://localhost:8080/ssm/deleteæŸ¥è¯¢æ•°æ®åº“ï¼š12mysql&gt; select * from emp;Empty set (0.00 sec)åˆ é™¤æˆåŠŸã€‚]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>MyBatis</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­å»ºSSH (Spring+SpringMVC+Hibernate)]]></title>
    <url>%2F%E6%90%AD%E5%BB%BASSH-Spring-SpringMVC-Hibernate.html</url>
    <content type="text"><![CDATA[Spring+SpringMVCçš„æ­å»ºå‚è€ƒåšæ–‡ â€”â€” æ­å»ºSpringMVCã€‚è¿™é‡Œä¸»è¦è®°å½•SpringMVCä¸ŽHibernateçš„æ•´åˆã€‚å‡†å¤‡å·¥ä½œæ•°æ®åº“ä½¿ç”¨MySqlï¼Œåˆ›å»ºä¸€å¼ æµ‹è¯•è¡¨ï¼š1234567CREATE TABLE `emp` ( `ID` int(4) NOT NULL AUTO_INCREMENT, `NAME` varchar(50) COLLATE utf8_unicode_ci NOT NULL, `AGE` int(11) DEFAULT NULL, `BIRTHDAY` date DEFAULT NULL, PRIMARY KEY (`ID`))å¼•å…¥ä¾èµ–ï¼š12345678910111213141516171819202122232425262728293031&lt;!-- springäº‹åŠ¡ --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-tx&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt;&lt;/dependency&gt; &lt;!-- spring orm --&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-orm&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;!-- hibernate --&gt;&lt;dependency&gt; &lt;groupId&gt;org.hibernate&lt;/groupId&gt; &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt; &lt;version&gt;4.3.5.Final&lt;/version&gt;&lt;/dependency&gt;&lt;!-- mysqlæ•°æ®åº“è¿žæŽ¥åŒ…--&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.6&lt;/version&gt;&lt;/dependency&gt; &lt;!-- æ•°æ®åº“è¿žæŽ¥æ± --&gt;&lt;dependency&gt; &lt;groupId&gt;c3p0&lt;/groupId&gt; &lt;artifactId&gt;c3p0&lt;/artifactId&gt; &lt;version&gt;0.9.1.2&lt;/version&gt;&lt;/dependency&gt;é…ç½®æ•°æ®åº“åœ¨applicationContext.xmlä¸­é…ç½®æ•°æ®åº“ï¼š1234567891011121314151617181920&lt;!-- å±žæ€§å ä½ç¬¦ --&gt;&lt;context:property-placeholder location="classpath:/config.properties" /&gt; &lt;!--é…ç½®æ•°æ®æº--&gt;&lt;bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close"&gt; &lt;!--æ•°æ®åº“è¿žæŽ¥é©±åŠ¨--&gt; &lt;property name="driverClass" value="$&#123;jdbc.driver&#125;" /&gt; &lt;!--æ•°æ®åº“åœ°å€--&gt; &lt;property name="jdbcUrl" value="$&#123;jdbc.url&#125;" /&gt; &lt;!--ç”¨æˆ·å--&gt; &lt;property name="user" value="$&#123;jdbc.username&#125;" /&gt; &lt;!--å¯†ç --&gt; &lt;property name="password" value="$&#123;jdbc.password&#125;" /&gt; &lt;!--æœ€å¤§è¿žæŽ¥æ•°--&gt; &lt;property name="maxPoolSize" value="40" /&gt; &lt;!--æœ€å°è¿žæŽ¥æ•°--&gt; &lt;property name="minPoolSize" value="1" /&gt; &lt;!--åˆå§‹åŒ–è¿žæŽ¥æ± å†…çš„æ•°æ®åº“è¿žæŽ¥--&gt; &lt;property name="initialPoolSize" value="10" /&gt; &lt;/bean&gt;å…¶ä¸­ï¼Œconfig.propertiesé…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š12345678910#database connection configjdbc.driver = com.mysql.jdbc.Driverjdbc.url = jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=UTF-8jdbc.username = rootjdbc.password = 123456 #hibernate confighibernate.dialect = org.hibernate.dialect.MySQLDialecthibernate.show_sql = truehibernate.format_sql = trueé…ç½®sessionFactoryåœ¨applicationContext.xmlä¸­é…ç½®sessionFactoryï¼š12345678910111213141516&lt;!--é…ç½®sessionå·¥åŽ‚--&gt;&lt;bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean"&gt; &lt;property name="dataSource" ref="dataSource" /&gt; &lt;!-- æŒ‡å®šå®žä½“ç±»æ‰«æè·¯å¾„ --&gt; &lt;property name="packagesToScan" value="ssh.mrbird.entity" /&gt; &lt;property name="hibernateProperties"&gt; &lt;props&gt; &lt;!--æŒ‡å®šæ•°æ®åº“æ–¹è¨€--&gt; &lt;prop key="hibernate.dialect"&gt;$&#123;hibernate.dialect&#125;&lt;/prop&gt; &lt;!--åœ¨æŽ§åˆ¶å°æ˜¾ç¤ºæ‰§è¡Œçš„æ•°æ®åº“æ“ä½œè¯­å¥--&gt; &lt;prop key="hibernate.show_sql"&gt;$&#123;hibernate.show_sql&#125;&lt;/prop&gt; &lt;!--åœ¨æŽ§åˆ¶å°æ˜¾ç¤ºæ‰§è¡Œçš„æ•°æ®åº“æ“ä½œè¯­å¥ï¼ˆæ ¼å¼ï¼‰--&gt; &lt;prop key="hibernate.format_sql"&gt;$&#123;hibernate.format_sql&#125;&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt;&lt;/bean&gt;ä½¿ç”¨springçš„äº‹åŠ¡ç®¡ç†æœºåˆ¶ï¼š123456&lt;!-- äº‹ç‰©ç®¡ç†å™¨é…ç½® --&gt;&lt;bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager"&gt; &lt;property name="sessionFactory" ref="sessionFactory" /&gt;&lt;/bean&gt;&lt;!-- å¼€å¯æ³¨è§£äº‹åŠ¡ --&gt;&lt;tx:annotation-driven transaction-manager="transactionManager" proxy-target-class="true"/&gt;åˆ›å»ºåº“è¡¨å®žä½“123456789101112131415161718192021222324252627282930import java.io.Serializable;import java.sql.Date; import javax.persistence.Column;import javax.persistence.Entity;import javax.persistence.GeneratedValue;import javax.persistence.GenerationType;import javax.persistence.Id;import javax.persistence.Table; @Entity@Table(name = "Emp")public class Emp implements Serializable&#123; private static final long serialVersionUID = 1L; @Id @GeneratedValue(strategy = GenerationType.AUTO) @Column(name = "ID") private long id; @Column(name = "NAME") private String name; @Column(name = "AGE") private int age; @Column(name = "BIRTHDAY") private Date birthday; // get set ç•¥&#125;æ•°æ®åº“è®¿é—®å±‚åˆ›å»ºEmpDaoæŽ¥å£ï¼ŒåŒ…å«åŸºæœ¬çš„CRUDæ–¹æ³•ï¼š12345678import ssh.mrbird.entity.Emp; public interface EmpDao &#123; Emp findEmpById(long id); void deleteEmpById(long id); void updateEmp(Emp emp); void saveEmp(Emp emp);&#125;å…¶å®žçŽ°ç±»EmpDaoImplï¼š123456789101112131415161718192021222324252627282930313233343536import org.hibernate.Session;import org.hibernate.SessionFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Repository;import org.springframework.transaction.annotation.Propagation;import org.springframework.transaction.annotation.Transactional; import ssh.mrbird.entity.Emp; @Repository@Transactional(propagation=Propagation.SUPPORTS,readOnly=true)public class EmpDaoImpl implements EmpDao&#123; //æ³¨å…¥SessionFactory @Autowired private SessionFactory sessionFactory; //èŽ·å–session private Session getCurrentSession() &#123; return this.sessionFactory.getCurrentSession(); &#125; public Emp findEmpById(long id) &#123; return (Emp) getCurrentSession().get(Emp.class, id); &#125; @Transactional(propagation=Propagation.REQUIRED,readOnly=false) public void deleteEmpById(long id) &#123; Emp emp = findEmpById(id); getCurrentSession().delete(emp); &#125; @Transactional(propagation=Propagation.REQUIRED,readOnly=false) public void updateEmp(Emp emp) &#123; getCurrentSession().update(emp); &#125; @Transactional(propagation=Propagation.REQUIRED,readOnly=false) public void saveEmp(Emp emp) &#123; getCurrentSession().save(emp); &#125;&#125;ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æŽ§åˆ¶äº‹åŠ¡ï¼Œå…³äºŽäº‹åŠ¡ï¼Œå¯å‚è€ƒåšæ–‡ â€”â€” Springäº‹åŠ¡ç®¡ç†ã€‚æµ‹è¯•æœ€ç»ˆï¼Œå·¥ç¨‹çš„ç›®å½•ç»“æž„ä¸ºï¼šapplicationContext.xmlå®Œæ•´é…ç½®å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:p="http://www.springframework.org/schema/p" xmlns:tx="http://www.springframework.org/schema/tx" xsi:schemaLocation=" http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.3.xsd http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.3.xsd"&gt; &lt;!-- å¼€å¯ç»„ä»¶æ‰«æ --&gt; &lt;context:component-scan base-package="ssh"/&gt; &lt;!-- å¯ç”¨Spring mvc --&gt; &lt;mvc:annotation-driven/&gt; &lt;!-- é…ç½®viewResolver --&gt; &lt;bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver" p:prefix="/WEB-INF/views/" p:suffix=".jsp"&gt; &lt;/bean&gt; &lt;!-- å±žæ€§å ä½ç¬¦ --&gt; &lt;context:property-placeholder location="classpath:/config.properties" /&gt; &lt;!--é…ç½®æ•°æ®æº--&gt; &lt;bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close"&gt; &lt;property name="driverClass" value="$&#123;jdbc.driver&#125;" /&gt; &lt;property name="jdbcUrl" value="$&#123;jdbc.url&#125;" /&gt; &lt;property name="user" value="$&#123;jdbc.username&#125;" /&gt; &lt;property name="password" value="$&#123;jdbc.password&#125;" /&gt; &lt;property name="maxPoolSize" value="40" /&gt; &lt;property name="minPoolSize" value="1" /&gt; &lt;property name="initialPoolSize" value="10" /&gt; &lt;/bean&gt; &lt;!--é…ç½®sessionå·¥åŽ‚--&gt; &lt;bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean"&gt; &lt;property name="dataSource" ref="dataSource" /&gt; &lt;!-- æŒ‡å®šå®žä½“ç±»æ‰«æè·¯å¾„ --&gt; &lt;property name="packagesToScan" value="ssh.mrbird.entity" /&gt; &lt;property name="hibernateProperties"&gt; &lt;props&gt; &lt;prop key="hibernate.dialect"&gt;$&#123;hibernate.dialect&#125;&lt;/prop&gt; &lt;prop key="hibernate.show_sql"&gt;$&#123;hibernate.show_sql&#125;&lt;/prop&gt; &lt;prop key="hibernate.format_sql"&gt;$&#123;hibernate.format_sql&#125;&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;/bean&gt; &lt;!-- äº‹ç‰©ç®¡ç†å™¨é…ç½® --&gt; &lt;bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager"&gt; &lt;property name="sessionFactory" ref="sessionFactory" /&gt; &lt;/bean&gt; &lt;!-- å¼€å¯æ³¨è§£äº‹åŠ¡ --&gt; &lt;tx:annotation-driven transaction-manager="transactionManager" proxy-target-class="true"/&gt;&lt;/beans&gt;ç¼–å†™æµ‹è¯•Controllerï¼š1234567891011121314151617181920212223242526272829303132333435363738394041@Controllerpublic class TestController &#123; @Autowired private EmpDaoImpl empDao; @RequestMapping(value="/saveEmp",method=RequestMethod.GET) @ResponseBody public String saveEmp()&#123; //ç›´æŽ¥æ¨¡æ‹Ÿæ•°æ® try&#123; Emp emp = new Emp(); emp.setName("mrbird"); emp.setAge(100); empDao.saveEmp(emp); return "success"; &#125;catch(Exception e)&#123; e.printStackTrace(); return "fail"; &#125; &#125; @RequestMapping(value="/findEmp",method=RequestMethod.GET) @ResponseBody public String findEmp()&#123; Emp emp = empDao.findEmpById(1); return emp.getName(); &#125; @RequestMapping(value="/updateEmp",method=RequestMethod.GET) @ResponseBody public String updateEmp()&#123; Emp emp = empDao.findEmpById(1l); emp.setAge(250); empDao.updateEmp(emp); return "success"; &#125; @RequestMapping(value="/deleteEmp",method=RequestMethod.GET) @ResponseBody public String deleteEmp()&#123; empDao.deleteEmpById(1l); return "success"; &#125;&#125;å¯åŠ¨å·¥ç¨‹ï¼Œè®¿é—®ï¼šhttp://localhost:8080/ssh/saveEmpæŸ¥è¯¢æ•°æ®åº“ï¼š1234567mysql&gt; select * from emp;+----+--------+------+----------+| ID | NAME | AGE | BIRTHDAY |+----+--------+------+----------+| 1 | mrbird | 100 | NULL |+----+--------+------+----------+1 row in set (0.00 sec)æ•°æ®æ’å…¥æˆåŠŸï¼Œå‰©ä¸‹çš„æµ‹è¯•ç•¥ã€‚]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
        <tag>Hibernate</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ServletçŠ¶æ€ç®¡ç†]]></title>
    <url>%2FServlet%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86.html</url>
    <content type="text"><![CDATA[ServletçŠ¶æ€ç®¡ç†ï¼šå°†å®¢æˆ·ç«¯(æµè§ˆå™¨)ä¸ŽæœåŠ¡å™¨ä¹‹é—´å¤šæ¬¡äº¤äº’ï¼ˆä¸€æ¬¡è¯·æ±‚ï¼Œä¸€æ¬¡å“åº”ï¼‰å½“åšä¸€ä¸ªæ•´ä½“æ¥çœ‹å¾…ï¼Œå¹¶ä¸”å°†å¤šæ¬¡äº¤äº’æ‰€æ¶‰åŠçš„æ•°æ®ï¼ˆå³çŠ¶æ€ï¼‰ä¿å­˜ä¸‹æ¥ã€‚å¦‚ä½•è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Ÿ1.å®¢æˆ·ç«¯çŠ¶æ€ç®¡ç†æŠ€æœ¯ï¼šå³å°†çŠ¶æ€ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæœ‰ä»£è¡¨æ€§çš„æ˜¯cookieæŠ€æœ¯ã€‚2.æœåŠ¡å™¨ç«¯çŠ¶æ€ç®¡ç†æŠ€æœ¯ï¼šå³å°†çŠ¶æ€ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼Œæœ‰ä»£è¡¨æ€§çš„æ˜¯sessionæŠ€æœ¯ã€‚cookieæµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†å°‘é‡çš„æ•°æ®ä»¥set-cookieæ¶ˆæ¯å¤´çš„æ–¹å¼å‘é€ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨ä¼šå°†è¿™äº›æ•°æ®ä¿å­˜ä¸‹æ¥ã€‚å½“æµè§ˆå™¨å†æ¬¡è®¿é—®æœåŠ¡å™¨æ—¶ï¼Œä¼šå°†è¿™äº›æ•°æ®ä»¥cookieæ¶ˆæ¯å¤´çš„æ–¹å¼å‘é€ç»™æœåŠ¡å™¨ã€‚åˆ›å»ºcookieï¼š12Cookie c = new Cookie(String name,String value);response.addCookie(c);æŸ¥è¯¢cookieï¼š1234567Cookie[] cookies = request.getCookies();if(cookies != null)&#123; for(Cookie c : cookies)&#123; String cookieName = c.getName(); String cookieValue = c.getValue(); &#125;&#125;ç¼–ç é—®é¢˜ï¼šcookieåªèƒ½ä¿å­˜åˆæ³•çš„asciiå­—ç¬¦ï¼Œå¦‚æžœè¦ä¿å­˜ä¸­æ–‡ï¼Œéœ€è¦å°†ä¸­æ–‡è½¬æ¢æˆåˆæ³•çš„asciiå­—ç¬¦ï¼ˆç¼–ç ï¼‰ã€‚1String str = URLEncoder.encode("åŒ—äº¬","utf-8");encodeæ–¹æ³•å…ˆå°†â€åŒ—äº¬â€æŒ‰ç…§â€utf-8â€è¿›è¡Œç¼–ç ï¼ˆç¼–ç ä¹‹åŽä¼šå¾—åˆ°ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼‰ï¼Œç„¶åŽå°†å­—èŠ‚æ•°ç»„è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ç±»ä¼¼äºŽ%AD%EF%88%DD%AF%48%ã€‚12// å°†å­—ç¬¦ä¸²è¿˜åŽŸString decodeValue = URLDecoder.decode(str,"utf-8");ç”Ÿå­˜æ—¶é—´ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼šå°†cookieä¿å­˜åœ¨å†…å­˜é‡Œé¢ï¼Œåªè¦æµè§ˆå™¨ä¸å…³é—­ï¼Œcookieä¼šä¸€ç›´å­˜åœ¨ã€‚ä¹Ÿå¯ä»¥ç”¨ä»£ç æŒ‡å®šå…¶ç”Ÿå­˜æ—¶é—´ï¼š1cookie.setMaxAge(int seconds);æ³¨æ„secondså•ä½æ˜¯ç§’ã€‚secondså–å€¼æœ‰ä¸‰ç§æƒ…å†µï¼š1.seconds &gt; 0ï¼šæµè§ˆå™¨ä¿å­˜cookieçš„æœ€é•¿æ—¶é—´ä¸ºè®¾ç½®çš„å‚æ•°å€¼ï¼Œå¦‚æžœè¶…è¿‡æŒ‡å®šçš„æ—¶é—´ï¼Œæµè§ˆå™¨ä¼šåˆ é™¤è¿™ä¸ªcookieã€‚æµè§ˆå™¨ä¼šå°†cookieä¿å­˜åœ¨ç¡¬ç›˜ä¸Šã€‚2.seconds = 0ï¼šåˆ é™¤cookieã€‚æ¯”å¦‚ï¼Œè¦åˆ é™¤ä¸€ä¸ªåç§°ä¸ºâ€addrâ€çš„cookieï¼š123Cookie c = new Cookie("addr","");c.setMaxAge(0);response.addCookie(c);3.sencods &lt; 0ï¼šç¼ºçœå€¼,æµè§ˆå™¨ä¼šå°†cookieæ”¾åˆ°å†…å­˜é‡Œé¢ã€‚ä¿®æ”¹cookieï¼šæ‰€è°“Cookieçš„ä¿®æ”¹ï¼Œæœ¬è´¨æ˜¯èŽ·å–åˆ°è¦å˜æ›´å€¼çš„Cookieï¼Œé€šè¿‡setValueæ–¹æ³•å°†æ–°çš„æ•°æ®å­˜å…¥åˆ°cookieä¸­ï¼Œç„¶åŽç”±responseå“åº”å¯¹è±¡å‘å›žåˆ°å®¢æˆ·ç«¯ï¼Œå¯¹åŽŸæœ‰æ—§å€¼è¦†ç›–åŽå³å®žçŽ°äº†ä¿®æ”¹ã€‚sessionæœåŠ¡å™¨ä¸ºä¸åŒçš„å®¢æˆ·ç«¯åœ¨å†…å­˜ä¸­åˆ›å»ºäº†ç”¨äºŽä¿å­˜æ•°æ®çš„Sessionå¯¹è±¡ï¼Œå¹¶å°†ç”¨äºŽæ ‡è¯†è¯¥å¯¹è±¡çš„å”¯ä¸€Idå‘å›žç»™ä¸Žè¯¥å¯¹è±¡å¯¹åº”çš„å®¢æˆ·ç«¯ã€‚å½“æµè§ˆå™¨å†æ¬¡å‘é€è¯·æ±‚æ—¶ï¼ŒSessionIdä¹Ÿä¼šè¢«å‘é€è¿‡æ¥ï¼ŒæœåŠ¡å™¨å‡­å€Ÿè¿™ä¸ªå”¯ä¸€Idæ‰¾åˆ°ä¸Žä¹‹å¯¹åº”çš„Sessionå¯¹è±¡ã€‚åœ¨æœåŠ¡å™¨ç«¯ç»´æŠ¤çš„è¿™äº›ç”¨äºŽä¿å­˜ä¸Žä¸åŒå®¢æˆ·ç«¯äº¤äº’æ—¶çš„æ•°æ®çš„å¯¹è±¡å«åšSessionã€‚Sessionå¯¹è±¡å¯ä»¥ä¿å­˜æ›´å¤æ‚çš„å¯¹è±¡ç±»åž‹æ•°æ®äº†ï¼Œä¸åƒCookieåªèƒ½ä¿å­˜å­—ç¬¦ä¸²ã€‚èŽ·å¾—sessionå¯¹è±¡ï¼š1.æ–¹å¼ä¸€ï¼š1HttpSession session = request.getSession(boolean flag);flagä¸ºtrueæ—¶ï¼šå…ˆæŸ¥çœ‹è¯·æ±‚å½“ä¸­æœ‰æ²¡æœ‰sessionIdï¼Œå¦‚æžœæ²¡æœ‰ï¼ŒæœåŠ¡å™¨è¦åˆ›å»ºä¸€ä¸ªsessionå¯¹è±¡ï¼›å¦‚æžœæœ‰sessionIdï¼ŒæœåŠ¡å™¨ä¼šä¾æ®sessionIdæŸ¥æ‰¾å¯¹åº”çš„sessionå¯¹è±¡ï¼Œå¦‚æžœæ‰¾åˆ°äº†åˆ™è¿”å›žï¼Œæ‰¾ä¸åˆ°æœåŠ¡å™¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„sessionå¯¹è±¡ã€‚flagä¸ºfalseæ—¶ï¼šå…ˆæŸ¥çœ‹è¯·æ±‚å½“ä¸­æœ‰æ²¡æœ‰sessionIdï¼Œå¦‚æžœæ²¡æœ‰ï¼ŒæœåŠ¡å™¨ä¸ä¼šåˆ›å»ºsessionå¯¹è±¡ï¼Œè¿”å›žnullã€‚å¦‚æžœæœ‰sessionIdï¼ŒæœåŠ¡å™¨ä¼šä¾æ®sessionIdæŸ¥æ‰¾å¯¹åº”çš„sessionå¯¹è±¡ï¼Œå¦‚æžœæ‰¾åˆ°äº†åˆ™è¿”å›žï¼Œæ‰¾ä¸åˆ°è¿”å›žnullã€‚2.æ–¹å¼äºŒï¼š12HttpSession session = request.getSession();// ç­‰ä»·äºŽ request.getSession(true)ã€‚ä½¿ç”¨sessionå¯¹è±¡ç»‘å®šæ•°æ®ï¼š1void session.setAttribute(String name,Object obj);èŽ·å–ç»‘å®šæ•°æ®æˆ–ç§»é™¤ç»‘å®šæ•°æ®çš„ä»£ç å¦‚ä¸‹ï¼š12void session.getAttribute(String name);void session.removeAttribute(String name);sessionè¶…æ—¶ï¼šä»€ä¹ˆæ˜¯sessionè¶…æ—¶ï¼ŸwebæœåŠ¡å™¨ä¼šå°†ç©ºé—²æ—¶é—´è¿‡é•¿çš„sessionå¯¹è±¡åˆ é™¤æŽ‰ï¼ˆä¸ºäº†èŠ‚çœå†…å­˜ç©ºé—´èµ„æºï¼‰ã€‚webæœåŠ¡å™¨ç¼ºçœçš„è¶…æ—¶æ—¶é—´é™åˆ¶ï¼Œä¸€èˆ¬æ˜¯30åˆ†ã€‚å¯ä»¥ä¿®æ”¹ç¼ºçœçš„è¶…æ—¶æ—¶é—´é™åˆ¶ï¼Œæ¯”å¦‚ï¼Œå¯ä»¥ä¿®æ”¹tomcatçš„web.xmlï¼š123&lt;session-config&gt; &lt;session-timeout&gt;30&lt;/session-timeout&gt;&lt;/session-config&gt;ä½¿ç”¨ç¼–ç¨‹çš„æ–¹å¼æ¥ä¿®æ”¹ï¼š1session.setMaxInactiveInterval(int seconds);ç«‹å³åˆ é™¤sessionå¯¹è±¡ï¼š1session.invalidate();sessionä¼˜ç¼ºç‚¹ï¼šsessionå¯¹è±¡çš„æ•°æ®ç”±äºŽä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ï¼Œå¹¶ä¸åœ¨ç½‘ç»œä¸­è¿›è¡Œä¼ è¾“ï¼Œæ‰€ä»¥å®‰å…¨ä¸€äº›ï¼Œå¹¶ä¸”èƒ½å¤Ÿä¿å­˜çš„æ•°æ®ç±»åž‹æ›´ä¸°å¯Œï¼ŒåŒæ—¶Sessionä¹Ÿèƒ½å¤Ÿä¿å­˜æ›´å¤šçš„æ•°æ®ï¼ŒCookieåªèƒ½ä¿å­˜å¤§çº¦4kbçš„å­—ç¬¦ä¸²ã€‚sessionçš„å®‰å…¨æ€§æ˜¯ä»¥ç‰ºç‰²æœåŠ¡å™¨èµ„æºä¸ºä»£ä»·çš„ï¼Œå¦‚æžœç”¨æˆ·é‡è¿‡å¤§ï¼Œä¼šä¸¥é‡å½±å“æœåŠ¡å™¨çš„æ€§èƒ½ã€‚]]></content>
      <tags>
        <tag>servlet&amp;jsp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MongoDB æ–‡æ¡£æŸ¥è¯¢]]></title>
    <url>%2FMongoDB-%E6%96%87%E6%A1%A3%E6%9F%A5%E8%AF%A2.html</url>
    <content type="text"><![CDATA[MongoDBæŸ¥è¯¢æ¶µç›–ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š1.ä½¿ç”¨findæˆ–è€…findOneå‡½æ•°å’ŒæŸ¥è¯¢æ–‡æ¡£å¯¹æ•°æ®åº“æ‰§è¡ŒæŸ¥è¯¢ï¼›2.ä½¿ç”¨$æ¡ä»¶æŸ¥è¯¢å®žçŽ°èŒƒå›´æŸ¥è¯¢ï¼Œæ•°æ®é›†åŒ…å«æŸ¥è¯¢ï¼Œä¸ç­‰å¼æŸ¥è¯¢ï¼Œä»¥åŠå…¶å®ƒä¸€äº›æŸ¥è¯¢ï¼›3.æŸ¥è¯¢å°†ä¼šè¿”å›žä¸€ä¸ªæ•°æ®åº“æ¸¸æ ‡ï¼Œæ¸¸æ ‡åªä¼šåœ¨ä½ éœ€è¦æ—¶æ‰å°†éœ€è¦çš„æ–‡æ¡£æ‰¹é‡è¿”å›žï¼›4.é’ˆå¯¹æ¸¸æ ‡æ‰§è¡Œçš„å…ƒæ“ä½œï¼ŒåŒ…æ‹¬å¿½ç•¥ä¸€å®šæ•°é‡çš„ç»“æžœï¼Œæˆ–è€…é™å®šè¿”å›žç»“æžœçš„æ•°é‡ï¼Œä»¥åŠå¯¹ç»“æžœæŽ’åºã€‚findç®€ä»‹æŒ‡å®šéœ€è¦è¿”å›žçš„é”®æ¯”å¦‚ï¼Œæˆ‘åªå¯¹blogé›†åˆçš„åšæ–‡postæ„Ÿå…´è¶£ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŸ¥è¯¢è¯­å¥ï¼š1234&gt; db.blog.find(&#123;&#125;,&#123;"post":1&#125;)&#123; "_id" : ObjectId("58acf0743c8ad0b0d9d65f45"), "post" : "MongoDBæ–‡æ¡£CUD" &#125;&#123; "_id" : ObjectId("58acf64b3c8ad0b0d9d65f4a"), "post" : "MongoDB shell" &#125;&#123; "_id" : ObjectId("58acf65d3c8ad0b0d9d65f4d"), "post" : "start Spring Boot" &#125;å¦‚æžœä¸å¸Œæœ›è¿”å›žâ€œ_idâ€ï¼Œå¯ä»¥è¿™æ ·ï¼š1234&gt; db.blog.find(&#123;&#125;,&#123;"post":1,"_id":0&#125;)&#123; "post" : "MongoDBæ–‡æ¡£CUD" &#125;&#123; "post" : "MongoDB shell" &#125;&#123; "post" : "start Spring Boot" &#125;æŸ¥è¯¢æ¡ä»¶æ¯”è¾ƒæ“ä½œç¬¦MongoDBä¸­çš„æ¯”è¾ƒæ“ä½œç¬¦æœ‰äº”ç§ï¼Œå…¶ä¸­$gtï¼Œ$gteï¼Œ$ltï¼Œ$lteåˆ†åˆ«å¯¹åº”&gt;ï¼Œ&gt;=ï¼Œ&lt;ï¼Œ&lt;=ï¼Œæ¯”å¦‚æŸ¥è¯¢blogé˜…è¯»é‡pageviewå¤§äºŽ5çš„æ–‡æ¡£ï¼š123456789&gt; db.blog.find(&#123;"pageview":&#123;"$gte":5&#125;&#125;).pretty()&#123; "_id" : ObjectId("58acf0743c8ad0b0d9d65f45"), "name" : "mrbird's blog", "post" : "MongoDBæ–‡æ¡£CUD", "pageview" : 5, "like" : 2, "date" : ISODate("2017-02-22T05:45:03.006Z")&#125;è¿™å››ç§æ“ä½œç¬¦ä¹Ÿå¯ç”¨äºŽæ—¥æœŸæ¯”è¾ƒï¼Œæ¯”å¦‚ï¼š123456&gt; var date = new Date("01/01/2017")&gt; db.blog.find(&#123;"date":&#123;"$gte":date&#125;&#125;,... &#123;"post":1,"date":1,"_id":0&#125;)&#123; "post" : "MongoDBæ–‡æ¡£CUD", "date" : ISODate("2017-02-22T05:45:03.006Z") &#125;&#123; "post" : "MongoDB shell", "date" : ISODate("2017-02-22T05:45:03.006Z") &#125;&#123; "post" : "start Spring Boot", "date" : ISODate("2017-02-22T05:45:03.006Z") &#125;å¦å¤–ä¸€ä¸ªæ¯”è¾ƒæ“ä½œç¬¦ä¸º$neï¼Œnot equalï¼Œå¯ä»¥ç”¨äºŽæ‰€æœ‰ç±»åž‹ï¼Œæ¯”å¦‚ï¼š1234&gt; db.blog.find(&#123;"post":&#123;"$ne":"MongoDB shell"&#125;&#125;,... &#123;"post":1&#125;)&#123; "_id" : ObjectId("58acf0743c8ad0b0d9d65f45"), "post" : "MongoDBæ–‡æ¡£CUD" &#125;&#123; "_id" : ObjectId("58acf65d3c8ad0b0d9d65f4d"), "post" : "start Spring Boot" &#125;ORæŸ¥è¯¢$inæ“ä½œç¬¦å¯ä»¥æŸ¥è¯¢ä¸€ä¸ªé”®çš„å¤šä¸ªå€¼ï¼Œæ¯”å¦‚ï¼š1234&gt; db.blog.find(&#123;"post":&#123;"$in":["MongoDBæ–‡æ¡£CUD","MongoDB shell"]&#125;&#125;,... &#123;"post":1,"_id":0&#125;)&#123; "post" : "MongoDBæ–‡æ¡£CUD" &#125;&#123; "post" : "MongoDB shell" &#125;å…¶ä¸­æ•°ç»„ä¸­çš„å€¼å¯ä»¥æ˜¯ä¸åŒç±»åž‹çš„ã€‚ä¸Ž$inç›¸åçš„æ˜¯$ninï¼Œå¦‚ï¼š123&gt; db.blog.find(&#123;"post":&#123;"$nin":["MongoDBæ–‡æ¡£CUD","MongoDB shell"]&#125;&#125;,... &#123;"post":1,"_id":0&#125;)&#123; "post" : "start Spring Boot" &#125;$oræ“ä½œç¬¦å’ŒSQLä¸­çš„å«ä¹‰ç±»ä¼¼ï¼Œæ¯”å¦‚æŸ¥è¯¢postä¸ºMongoDBæ–‡æ¡£CUDæˆ–è€…pageviewä¸º3çš„æ–‡æ¡£ï¼š12345&gt; db.blog.find(&#123;"$or":[&#123;"post":"MongoDBæ–‡æ¡£CUD"&#125;,&#123;"pageview":3&#125;]&#125;,...&#123;"post":1,"pageview":1,"_id":0&#125;).pretty()&#123; "post" : "MongoDBæ–‡æ¡£CUD", "pageview" : 5 &#125;&#123; "post" : "MongoDB shell", "pageview" : 3 &#125;&#123; "post" : "start Spring Boot", "pageview" : 3 &#125;$not$modä¸ºå–æ¨¡è¿ç®—ç¬¦ï¼Œæ¯”å¦‚æŸ¥è¯¢pageviewä¸º3çš„å€æ•°çš„åšæ–‡ï¼š123&gt; db.blog.find(&#123;"pageview":&#123;"$mod":[3,0]&#125;&#125;,&#123;"post":1,"pageview":1,"_id":0&#125;)&#123; "post" : "MongoDB shell", "pageview" : 3 &#125;&#123; "post" : "start Spring Boot", "pageview" : 3 &#125;$notè¿ç®—ç¬¦ç”¨äºŽå–åï¼Œæ¯”å¦‚å–pageviewä¸ä¸º3çš„å€æ•°çš„åšæ–‡ï¼š123&gt; db.blog.find(&#123;"pageview":&#123;"$not":&#123;"$mod":[3,0]&#125;&#125;&#125;, ...&#123;"post":1,"pageview":1,"_id":0&#125;)&#123; "post" : "MongoDBæ–‡æ¡£CUD", "pageview" : 5 &#125;$and$andæ“ä½œç¬¦å’ŒSQLä¸­çš„å«ä¹‰ç±»ä¼¼ï¼Œæ¯”å¦‚æŸ¥æ‰¾postä¸ºMongoDBæ–‡æ¡£CUDä¸”pageviewå¤§äºŽ3çš„æ–‡æ¡£ï¼š123&gt; db.blog.find(&#123;"$and":[&#123;"post":"MongoDBæ–‡æ¡£CUD"&#125;,&#123;"pageview":&#123;"$gt":3&#125;&#125;]&#125;,... &#123;"post":1,"pageview":1,"_id":0&#125;)&#123; "post" : "MongoDBæ–‡æ¡£CUD", "pageview" : 5 &#125;ç‰¹å®šç±»åž‹çš„æŸ¥è¯¢nullã€‚æŸ¥è¯¢æ–‡æ¡£æŸä¸ªé”®çš„å€¼ä¸ºnullï¼Œä¼šå°†ä¸åŒ…å«è¯¥é”®çš„æ–‡æ¡£ä¹ŸæŸ¥è¯¢å‡ºæ¥ï¼Œæ¯”å¦‚ï¼š1234567&gt; db.blog.find(&#123;&#125;,&#123;"post":1,"like":1,"_id":0&#125;)&#123; "post" : "MongoDBæ–‡æ¡£CUD", "like" : 2 &#125;&#123; "post" : "MongoDB shell" &#125;&#123; "post" : "start Spring Boot", "like" : null &#125;&gt; db.blog.find(&#123;"like":null&#125;,&#123;"post":1,"like":1,"_id":0&#125;)&#123; "post" : "MongoDB shell" &#125;&#123; "post" : "start Spring Boot", "like" : null &#125;å¯ä»¥é€šè¿‡$existsæ¡ä»¶åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨ï¼Œæ¯”å¦‚ï¼š123&gt; db.blog.find(&#123;"like":&#123;"$in":[null],"$exists":true&#125;&#125;, ...&#123;"post":1,"like":1,"_id":0&#125;)&#123; "post" : "start Spring Boot", "like" : null &#125;MongoDBæŸ¥è¯¢ä¹Ÿæ”¯æŒé”®å€¼çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œè¿™é‡Œå°±æ‡’å¾—è®°å½•äº†ã€‚æŸ¥è¯¢æ•°ç»„å…ˆçœ‹ä¸ªæ —å­ï¼š1234567&gt; db.food.find()&#123; "_id" : ObjectId("58ad45986596dd54570ce1ed"), "fruit" : [ "è¥¿ç“œ", "é¦™è•‰", "æ¡ƒå­" ] &#125;&#123; "_id" : ObjectId("58ad45c76596dd54570ce1ee"), "fruit" : [ "è¥¿ç“œ", "èŠ’æžœ", "æ¨æ¡ƒ" ] &#125;&#123; "_id" : ObjectId("58ad45f76596dd54570ce1ef"), "fruit" : [ "å“ˆå¯†ç“œ", "è‘¡è„", "æ¨±æ¡ƒ" ] &#125;&gt; db.food.find(&#123;"fruit":"è¥¿ç“œ"&#125;)&#123; "_id" : ObjectId("58ad45986596dd54570ce1ed"), "fruit" : [ "è¥¿ç“œ", "é¦™è•‰", "æ¡ƒå­" ] &#125;&#123; "_id" : ObjectId("58ad45c76596dd54570ce1ee"), "fruit" : [ "è¥¿ç“œ", "èŠ’æžœ", "æ¨æ¡ƒ" ] &#125;æŸ¥æ‰¾æ—¢åŒ…å«è¥¿ç“œåˆåŒ…å«èŠ’æžœçš„æ–‡æ¡£ï¼Œä½¿ç”¨$allæ“ä½œç¬¦ï¼š12&gt; db.food.find(&#123;"fruit":&#123;"$all":["è¥¿ç“œ","èŠ’æžœ"]&#125;&#125;)&#123; "_id" : ObjectId("58ad45c76596dd54570ce1ee"), "fruit" : [ "è¥¿ç“œ", "èŠ’æžœ", "æ¨æ¡ƒ" ] &#125;å…¶ä¸­ï¼Œæ•°ç»„ä¸­å€¼çš„é¡ºåºä¸é‡è¦ã€‚å¦‚æžœä¸ä½¿ç”¨$all å°±æ˜¯ç²¾å‡†åŒ¹é…äº†ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªæŸ¥è¯¢å°†æŸ¥è¯¢ä¸å‡ºä»»ä½•ç»“æžœï¼š1&gt; db.food.find(&#123;"fruit":["è¥¿ç“œ","èŠ’æžœ"]&#125;)ä¹Ÿå¯ä»¥æ ¹æ®æ•°ç»„çš„ä¸‹æ ‡è¿›è¡ŒæŸ¥è¯¢ï¼Œæ¯”å¦‚ï¼š12&gt; db.food.find(&#123;"fruit.1":"è‘¡è„"&#125;)&#123; "_id" : ObjectId("58ad45f76596dd54570ce1ef"), "fruit" : [ "å“ˆå¯†ç“œ", "è‘¡è„", "æ¨±æ¡ƒ" ] &#125;$sizeæ“ä½œç¬¦ç”¨äºŽæ ¹æ®æ•°ç»„çš„é•¿åº¦è¿›è¡ŒæŸ¥è¯¢åŒ¹é…ï¼Œæ¯”å¦‚æŸ¥æ‰¾fruitæ•°ç»„é•¿åº¦ä¸º3çš„æ–‡æ¡£ï¼š1234&gt; db.food.find(&#123;"fruit":&#123;"$size":3&#125;&#125;)&#123; "_id" : ObjectId("58ad45986596dd54570ce1ed"), "fruit" : [ "è¥¿ç“œ", "é¦™è•‰", "æ¡ƒå­" ] &#125;&#123; "_id" : ObjectId("58ad45c76596dd54570ce1ee"), "fruit" : [ "è¥¿ç“œ", "èŠ’æžœ", "æ¨æ¡ƒ" ] &#125;&#123; "_id" : ObjectId("58ad45f76596dd54570ce1ef"), "fruit" : [ "å“ˆå¯†ç“œ", "è‘¡è„", "æ¨±æ¡ƒ" ] &#125;æ³¨æ„ï¼š$sizeæ“ä½œç¬¦ä¸èƒ½$gtç­‰æ¯”è¾ƒæ“ä½œç¬¦ä¸€èµ·ä½¿ç”¨ï¼$sliceæ“ä½œç¬¦å¯ä»¥è¿”å›žæŸä¸ªé”®åŒ¹é…çš„æ•°ç»„å…ƒç´ çš„ä¸€ä¸ªå­é›†ï¼Œæ¯”å¦‚ï¼š1234&gt; db.food.find(&#123;&#125;,&#123;"fruit":&#123;"$slice":2&#125;&#125;)&#123; "_id" : ObjectId("58ad45986596dd54570ce1ed"), "fruit" : [ "è¥¿ç“œ", "é¦™è•‰" ] &#125;&#123; "_id" : ObjectId("58ad45c76596dd54570ce1ee"), "fruit" : [ "è¥¿ç“œ", "èŠ’æžœ" ] &#125;&#123; "_id" : ObjectId("58ad45f76596dd54570ce1ef"), "fruit" : [ "å“ˆå¯†ç“œ", "è‘¡è„" ] &#125;å¦‚æžœæƒ³è¿”å›žæ•°ç»„çš„åŽä¸¤ä¸ªå…ƒç´ ï¼Œå¯ä»¥è¿™æ ·ï¼š1234&gt; db.food.find(&#123;&#125;,&#123;"fruit":&#123;"$slice":-2&#125;&#125;)&#123; "_id" : ObjectId("58ad45986596dd54570ce1ed"), "fruit" : [ "é¦™è•‰", "æ¡ƒå­" ] &#125;&#123; "_id" : ObjectId("58ad45c76596dd54570ce1ee"), "fruit" : [ "èŠ’æžœ", "æ¨æ¡ƒ" ] &#125;&#123; "_id" : ObjectId("58ad45f76596dd54570ce1ef"), "fruit" : [ "è‘¡è„", "æ¨±æ¡ƒ" ] &#125;$sliceä¹Ÿå¯ä»¥æŒ‡å®šåç§»é‡ï¼Œæ¯”å¦‚ï¼š1234&gt; db.food.find(&#123;&#125;,&#123;"fruit":&#123;"$slice":[1,3]&#125;&#125;)&#123; "_id" : ObjectId("58ad45986596dd54570ce1ed"), "fruit" : [ "é¦™è•‰", "æ¡ƒå­" ] &#125;&#123; "_id" : ObjectId("58ad45c76596dd54570ce1ee"), "fruit" : [ "èŠ’æžœ", "æ¨æ¡ƒ" ] &#125;&#123; "_id" : ObjectId("58ad45f76596dd54570ce1ef"), "fruit" : [ "è‘¡è„", "æ¨±æ¡ƒ" ] &#125;[1,1]è¡¨ç¤ºè·³è¿‡å‰1ä¸ªå…ƒç´ ï¼Œè¿”å›žç¬¬2~3ä¸ªå…ƒç´ ï¼Œå¦‚æžœæ²¡æœ‰é‚£ä¹ˆå¤šå…ƒç´ ï¼Œå°±è¿”å›žç¬¬2ä¸ªå…ƒç´ ä¹‹åŽçš„æ‰€æœ‰å…ƒç´ ã€‚æ•°ç»„çš„èŒƒå›´æŸ¥è¯¢æ•°ç»„çš„èŒƒå›´æŸ¥è¯¢éœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ï¼š12345678&gt; db.test.find()&#123; "_id" : ObjectId("58b0eca3a263b332501bc7b5"), "x" : 5 &#125;&#123; "_id" : ObjectId("58b0eca9a263b332501bc7b6"), "x" : 15 &#125;&#123; "_id" : ObjectId("58b0ecaea263b332501bc7b7"), "x" : 25 &#125;&#123; "_id" : ObjectId("58b0ecbda263b332501bc7b8"), "x" : [ 5, 25 ] &#125; &gt; db.test.find(&#123;"x":&#123;"$gt":10,"$lt":20&#125;&#125;)&#123; "_id" : ObjectId("58b0eca9a263b332501bc7b6"), "x" : 15 &#125;&#123; "_id" : ObjectId("58b0ecbda263b332501bc7b8"), "x" : [ 5, 25 ] &#125;æŸ¥è¯¢ç»“æžœä¸ç¬¦åˆé¢„æœŸï¼Œå› ä¸ºæ•°ç»„ä¸­çš„5ç¬¦åˆ$lt:20ï¼Œ25ç¬¦åˆ$gt:10ã€‚è¦å¯¹æ•°ç»„å…ƒç´ è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼Œå¯å€ŸåŠ©$elemMatchæ“ä½œç¬¦ï¼š12&gt; db.test.find(&#123;"x":&#123;"$elemMatch":&#123;"$gt":10,"$lt":20&#125;&#125;&#125;)&gt; //æŸ¥è¯¢ä¸åˆ°ä»»ä½•ç»“æžœè¿™ä¸ªæŸ¥è¯¢æ²¡æœ‰ä»»ä½•ç»“æžœï¼Œå› ä¸º{ &quot;_id&quot; : ObjectId(&quot;58b0eca9a263b332501bc7b6&quot;), &quot;x&quot; : 15 }æ–‡æ¡£xçš„å€¼ä¸æ˜¯æ•°ç»„ç±»åž‹ï¼Œå¹¶ä¸”$elemMatchæ“ä½œç¬¦ä½¿å¾—æ•°ç»„å…ƒç´ çš„æ¯ä¸€ä¸ªå€¼éƒ½å¿…é¡»ä¸Žæ¡ä»¶ç›¸åŒ¹é…ã€‚æŸ¥è¯¢å†…åµŒæ–‡æ¡£12345678910111213141516171819202122232425&gt; db.blog.find().pretty()&#123; "_id" : ObjectId("58b11d0ca263b332501bc7b9"), "title" : "MongoDBæŸ¥è¯¢", "like" : "2", "comments" : &#123; "name" : "ltsc", "comment" : "good post" &#125;&#125;&#123; "_id" : ObjectId("58b11daca263b332501bc7ba"), "title" : "MongoDB shell", "like" : "3", "comments" : [ &#123; "name" : "ltsc", "comment" : "good post" &#125;, &#123; "name" : "xiaohema", "comment" : "ä¸æ˜Žè§‰åŽ‰" &#125; ]&#125;è¦æŸ¥è¯¢åŒ…å«åä¸ºâ€xiaohemaâ€ï¼Œå¹¶ä¸”è¯„è®ºä¸ºâ€ä¸æ˜Žè§‰åŽ‰çš„â€åšæ–‡ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŸ¥è¯¢ï¼š12345678910111213141516&gt; db.blog.find(&#123;"comments":&#123;"$elemMatch":&#123;"name":"xiaohema","comment":"ä¸æ˜Žè§‰åŽ‰"&#125;&#125;&#125;).pretty()&#123; "_id" : ObjectId("58b11daca263b332501bc7ba"), "title" : "MongoDB shell", "like" : "3", "comments" : [ &#123; "name" : "ltsc", "comment" : "good post" &#125;, &#123; "name" : "xiaohema", "comment" : "ä¸æ˜Žè§‰åŽ‰" &#125; ]&#125;$whereæŸ¥è¯¢å½“ä¸€èˆ¬æŸ¥è¯¢éƒ½ä¸èƒ½æ»¡è¶³æŸ¥è¯¢è¦æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨$whereæ“ä½œç¬¦ï¼Œæ¯”å¦‚æœ‰å¦‚ä¸‹æ–‡æ¡£ï¼š123&gt; db.food.find(&#123;&#125;,&#123;"_id":0&#125;)&#123; "è‰èŽ“è›‹ç³•" : 4, "èŠå£«è›‹ç³•" : 5, "å·§å…‹åŠ›è›‹ç³•" : 4 &#125;&#123; "æ‘©å¡å’–å•¡" : 3, "æ‹¿é“å’–å•¡" : 6, "çƒ­å·§å…‹åŠ›" : 1 &#125;çŽ°è¦æŸ¥è¯¢å«æœ‰ç›¸åŒæ•°é‡é£Ÿç‰©çš„æ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨$whereæ“ä½œç¬¦ï¼š12345678910&gt; db.food.find(&#123;"$where":function()&#123;... for(var current in this)&#123;... for(var next in this)&#123;... if(current != next &amp;&amp; this[current] == this[next])&#123;... return true;... &#125;... &#125;... &#125;... &#125;&#125;,&#123;"_id":0&#125;)&#123; "è‰èŽ“è›‹ç³•" : 4, "èŠå£«è›‹ç³•" : 5, "å·§å…‹åŠ›è›‹ç³•" : 4 &#125;ä½†æ˜¯åœ¨å®žé™…æƒ…å†µä¸‹ï¼Œå‡ºäºŽå¯¹æ€§èƒ½å’Œå®‰å…¨çš„è€ƒè™‘ï¼Œåº”è¯¥å°½é‡ä¸ä½¿ç”¨$whereã€‚æ¸¸æ ‡MongoDBä½¿ç”¨æ¸¸æ ‡è¿”å›žfindæŸ¥è¯¢ç»“æžœï¼Œä½¿ç”¨hasNextå‡½æ•°åˆ¤æ–­æ¸¸æ ‡ä¸­æ˜¯å¦è¿˜æœ‰å…¶ä»–ç»“æžœï¼Œä½¿ç”¨nextå‡½æ•°æ¥è¿­ä»£ç»“æžœï¼Œå¦‚ï¼š123456789101112131415&gt; function create()&#123;... db.test.drop();... for(var i = 0;i&lt;100;i++)&#123;... db.test.insert(&#123;"x":i&#125;);... &#125;&#125;&gt; create()&gt; var cursor = db.test.find()&gt; cursor.hasNext()true&gt; cursor.next()&#123; "_id" : ObjectId("58b12834a263b332501bc7bd"), "x" : 0 &#125;&gt; cursor.next()&#123; "_id" : ObjectId("58b12834a263b332501bc7be"), "x" : 1 &#125;&gt; cursor.next()&#123; "_id" : ObjectId("58b12834a263b332501bc7bf"), "x" : 2 &#125;æ¸¸æ ‡è¿˜å®žçŽ°äº†JavaScriptçš„è¿­ä»£å™¨æŽ¥å£ï¼Œå¯ä»¥ä½¿ç”¨forEachå¾ªçŽ¯æ¥è¿­ä»£è¾“å‡ºç»“æžœï¼š12345678910111213&gt; cursor.forEach(function(x)&#123;... print(x.x);... &#125;)34567...9899&gt; cursor.hasNext()falselimitï¼Œskipå’Œsortlimitç”¨äºŽé™åˆ¶è¿”å›žç»“æžœçš„æ•°é‡ï¼Œæ¯”å¦‚ï¼š1234&gt; db.test.find().limit(3)&#123; "_id" : ObjectId("58b12834a263b332501bc7bd"), "x" : 0 &#125;&#123; "_id" : ObjectId("58b12834a263b332501bc7be"), "x" : 1 &#125;&#123; "_id" : ObjectId("58b12834a263b332501bc7bf"), "x" : 2 &#125;è¦æ˜¯åŒ¹é…çš„æ•°é‡è¿˜ä¸åˆ°3ä¸ªï¼Œåˆ™è¿”å›žåŒ¹é…çš„æ•°é‡ã€‚skipåˆ™æ˜¯ç”¨äºŽè·³è¿‡Nä¸ªæ•°é‡åŽï¼Œè¿”å›žå‰©ä¸‹çš„æŸ¥è¯¢ç»“æžœï¼Œæ¯”å¦‚ï¼š1234&gt; db.test.find().skip(97)&#123; "_id" : ObjectId("58b12834a263b332501bc81e"), "x" : 97 &#125;&#123; "_id" : ObjectId("58b12834a263b332501bc81f"), "x" : 98 &#125;&#123; "_id" : ObjectId("58b12834a263b332501bc820"), "x" : 99 &#125;sortåˆ™æ˜¯ç”¨äºŽå¯¹è¿”å›žç»“æžœçš„æŽ’åºï¼Œ-1è¡¨ç¤ºé™åºï¼Œ1è¡¨ç¤ºå‡åºï¼Œå¦‚ï¼š12345&gt; db.test.find().limit(4).sort(&#123;"x":-1&#125;)&#123; "_id" : ObjectId("58b12834a263b332501bc820"), "x" : 99 &#125;&#123; "_id" : ObjectId("58b12834a263b332501bc81f"), "x" : 98 &#125;&#123; "_id" : ObjectId("58b12834a263b332501bc81e"), "x" : 97 &#125;&#123; "_id" : ObjectId("58b12834a263b332501bc81d"), "x" : 96 &#125;å½“ä½¿ç”¨skipç•¥è¿‡è¾ƒå¤šæ•°é‡æ–‡æ¡£æ—¶ï¼Œé€Ÿåº¦ä¼šå˜å¾—å¾ˆæ…¢ï¼Œæ¯”å¦‚å¸¸ç”¨çš„åˆ†é¡µéœ€æ±‚ï¼š123&gt; var page1 = db.test.find().limit(100)&gt; var page2 = db.test.find().skip(100).limit(100)&gt; var page3 = db.test.find().skip(200).limit(100)æ­£å¦‚å‰é¢æ‰€è¯´çš„ï¼Œè¿™ä¼šå¯¼è‡´é€Ÿåº¦å¾ˆæ…¢ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ç§æ€è·¯å–ä»£ï¼Œæ¯”å¦‚ä½¿ç”¨dateé™åºæ¥æ˜¾ç¤ºæ–‡æ¡£åˆ—è¡¨ï¼š1&gt; var page1 = db.test.find().sort(&#123;"date":-1&#125;).limit(100)ç„¶åŽå¯ä»¥ä½¿ç”¨æœ€åŽä¸€ä¸ªæ–‡æ¡£çš„dateä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼Œå¦‚ï¼š1234567var latest = nullwhile(page1.hasNext())&#123; latest = page1.next();&#125;//èŽ·å–ä¸‹ä¸€é¡µvar page2 = db.test.find(&#123;"date":&#123;"$gt":&#123;latest.date&#125;&#125;&#125;);page2.sort(&#123;"date":-1&#125;).limit(100);èŽ·å–çš„ä¸€è‡´æ€§çœ‹ä¸ªæ —å­ï¼š123456var cursor = db.test.find();while(cursor.hasNext())&#123; var current = curosr.next(); var modify = process(current); db.test.save(modify);&#125;å…¶ä¸­processä¸ºæŸä¸ªä¿®æ”¹æ–‡æ¡£å‡½æ•°ã€‚è¿™æ ·åšå½“æ–‡æ¡£è¾ƒå¤§çš„æ—¶å€™ï¼Œæ¸¸æ ‡å¯èƒ½ä¼šå¤šæ¬¡è¿”å›žåŒä¸€ä¸ªæ–‡æ¡£ï¼Œè€Œå¹¶ä¸èƒ½é¢„æœŸçš„è¿›è¡ŒéåŽ†ã€‚å› ä¸ºå½“ä¿å­˜æ–‡æ¡£çš„æ—¶å€™ï¼Œå¦‚æžœæ–‡æ¡£è¾ƒå¤§ï¼Œæ–‡æ¡£é—´çš„ç©ºéš™åˆä¸è¶³ï¼Œè¿™æ—¶å€™æ–‡æ¡£æ— æ³•é¢„æœŸçš„ä¿å­˜å›žæ•°æ®åº“ï¼ŒMongoDBä¼šå°†å…¶æŒªè‡³é›†åˆçš„æœ«å°¾ï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æŸ¥è¯¢æ·»åŠ å¿«ç…§ã€‚ä½¿ç”¨æŸ¥è¯¢å¿«ç…§åŽï¼ŒæŸ¥è¯¢ä¼šå¯¹â€_idâ€è¿›è¡ŒéåŽ†ï¼Œè¿™å°±ä¿è¯äº†æ¯ä¸ªæ–‡æ¡£åªä¼šè¿”å›žä¸€æ¬¡ï¼Œä¿®æ”¹ä¸Šè¿°æŸ¥è¯¢ï¼š1var cursor = db.test.find().snapshot();ã€ŠMongoDBæƒå¨æŒ‡å—ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>MongoDB</tag>
        <tag>DataBase</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MongoDBæ–‡æ¡£CUD]]></title>
    <url>%2FMongoDB%E6%96%87%E6%A1%A3CUD.html</url>
    <content type="text"><![CDATA[æ’å…¥æ–‡æ¡£ä½¿ç”¨insertå‘é›†åˆä¸­æ’å…¥ä¸€ä¸ªæ–‡æ¡£ï¼š1234&gt; db.test.insert(&#123;"name":"mrbird"&#125;)WriteResult(&#123; "nInserted" : 1 &#125;)&gt; db.test.findOne()&#123; "_id" : ObjectId("58a99b8168e0d7b9f6992c69"), "name" : "mrbird" &#125;æ’å…¥çš„æ–‡æ¡£æ²¡æœ‰â€œ_idâ€é”®çš„è¯ï¼Œè¿™ä¸ªæ“ä½œä¼šè‡ªåŠ¨ä¸ºæ–‡æ¡£æ·»åŠ ä¸€ä¸ªâ€œ_idâ€é”®ã€‚ æ‰¹é‡æ’å…¥æ–‡æ¡£åˆ™éœ€ä½¿ç”¨insertManyå‡½æ•°ï¼Œå‡½æ•°æŽ¥æ”¶ä¸€ä¸ªæ–‡æ¡£æ•°ç»„ï¼š123456789101112&gt; db.test.insertMany([&#123;"name":"Jane"&#125;,&#123;"name":"KangKang"&#125;])&#123; "acknowledged" : true, "insertedIds" : [ ObjectId("58a99d6468e0d7b9f6992c6b"), ObjectId("58a99d6468e0d7b9f6992c6c") ]&#125;&gt; db.test.find()&#123; "_id" : ObjectId("58a99b8168e0d7b9f6992c69"), "name" : "mrbird" &#125;&#123; "_id" : ObjectId("58a99d6468e0d7b9f6992c6b"), "name" : "Jane" &#125;&#123; "_id" : ObjectId("58a99d6468e0d7b9f6992c6c"), "name" : "KangKang" &#125;è¦æŸ¥çœ‹ä¸€ä¸ªæ–‡æ¡£çš„å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨Object.bsonsize(doc)å‡½æ•°ï¼ˆå•ä½ä¸ºå­—èŠ‚ï¼‰ï¼š12&gt; Object.bsonsize(db.test.find(&#123;"name":"mrbird"&#125;))1215åˆ é™¤æ–‡æ¡£åˆ é™¤æ–‡æ¡£ä½¿ç”¨removeå‡½æ•°ï¼ŒæŽ¥æ”¶ä¸€ä¸ªæŸ¥è¯¢æ–‡æ¡£ï¼Œæ‰€æœ‰åŒ¹é…çš„æ–‡æ¡£éƒ½å°†ä¼šè¢«åˆ é™¤ï¼š12345&gt; db.test.remove(&#123;"name":"mrbird"&#125;)WriteResult(&#123; "nRemoved" : 1 &#125;)&gt; db.test.find()&#123; "_id" : ObjectId("58a99d6468e0d7b9f6992c6b"), "name" : "Jane" &#125;&#123; "_id" : ObjectId("58a99d6468e0d7b9f6992c6c"), "name" : "KangKang" &#125;è¦æ¸…ç©ºæ•´ä¸ªé›†åˆçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨dropå‡½æ•°ï¼š123&gt; db.test.drop()true&gt; db.test.find()æ›´æ–°æ–‡æ¡£ä½¿ç”¨updateå‡½æ•°æ›´æ–°æ–‡æ¡£ï¼ŒæŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ŒæŸ¥è¯¢æ–‡æ¡£å’Œä¿®æ”¹å™¨æ–‡æ¡£ï¼Œå¦‚ï¼š1234567891011121314151617&gt; db.test.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58a9ace92363ff29a7d881e9"), "name" : "mrbird", "blog" : "mrbird.leanote.com"&#125;&gt; var mrbird = db.test.findOne(&#123;"name":"mrbird"&#125;)&gt; mrbird.blog = "mrbird's blog"mrbird's blog&gt; db.test.update(&#123;"name":"mrbird"&#125;,mrbird)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.test.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58a9ace92363ff29a7d881e9"), "name" : "mrbird", "blog" : "mrbird's blog"&#125;$incä¿®æ”¹å™¨ç”¨æ¥å¢žåŠ æˆ–å‡å°‘å·²æœ‰çš„é”®å€¼ï¼Œå¦‚æžœè¯¥é”®ä¸å­˜åœ¨åˆ™åˆ›é€ ä¸€ä¸ªã€‚æ¯”å¦‚ï¼š123456789101112131415161718192021222324252627282930313233 &gt; db.test.findOne(&#123;"name":"mrbird"&#125;) &#123; "_id" : ObjectId("58a9ace92363ff29a7d881e9"), "name" : "mrbird", "blog" : "mrbird's blog"&#125;&gt; db.test.update(&#123;"name":"mrbird"&#125;,&#123;"$inc":&#123;"pageview":1&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.test.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58a9ace92363ff29a7d881e9"), "name" : "mrbird", "blog" : "mrbird's blog", "pageview" : 1&#125;&gt; db.test.update(&#123;"name":"mrbird"&#125;,&#123;"$inc":&#123;"pageview":100&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.test.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58a9ace92363ff29a7d881e9"), "name" : "mrbird", "blog" : "mrbird's blog", "pageview" : 101&#125;&gt; db.test.update(&#123;"name":"mrbird"&#125;,&#123;"$inc":&#123;"pageview":-50&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.test.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58a9ace92363ff29a7d881e9"), "name" : "mrbird", "blog" : "mrbird's blog", "pageview" : 51&#125;$incåªèƒ½ç”¨äºŽæ•´åž‹ï¼Œé•¿æ•´åž‹æˆ–åŒç²¾åº¦æµ®ç‚¹åž‹çš„å€¼ã€‚$setç”¨äºŽä¿®æ”¹æ–‡æ¡£çš„å­—æ®µå€¼ï¼Œå½“è¿™ä¸ªå­—æ®µä¸å­˜åœ¨çš„æ—¶å€™å°±åˆ›å»ºä¸€ä¸ªã€‚å¦‚ï¼š123456789101112131415161718&gt; db.test.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58a9ace92363ff29a7d881e9"), "name" : "mrbird", "blog" : "mrbird's blog", "pageview" : 51&#125;&gt; db.test.update(&#123;"_id":ObjectId("58a9ace92363ff29a7d881e9")&#125;, ... &#123;"$set":&#123;"note":"love leanote!!"&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.test.findOne(&#123;"_id":ObjectId("58a9ace92363ff29a7d881e9")&#125;)&#123; "_id" : ObjectId("58a9ace92363ff29a7d881e9"), "name" : "mrbird", "blog" : "mrbird's blog", "pageview" : 51, "note" : "love leanote!!"&#125;$setè¿˜å¯ä»¥ä¿®æ”¹é”®çš„ç±»åž‹ï¼Œæ¯”å¦‚å°†noteé”®çš„å€¼æ”¹ä¸ºæ•°ç»„ç±»åž‹ï¼š1234567891011121314&gt; db.test.update(&#123;"_id":ObjectId("58a9ace92363ff29a7d881e9")&#125;,... &#123;"$set":&#123;"note":["love leanote","the fun of code"]&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.test.findOne(&#123;"_id":ObjectId("58a9ace92363ff29a7d881e9")&#125;)&#123; "_id" : ObjectId("58a9ace92363ff29a7d881e9"), "name" : "mrbird", "blog" : "mrbird's blog", "pageview" : 51, "note" : [ "love leanote", "the fun of code" ]&#125;$setä¹Ÿå¯ä»¥ä¿®æ”¹å†…åµŒæ–‡æ¡£ï¼Œæ¯”å¦‚ï¼š12345678910111213141516171819202122&gt; db.blog.findOne()&#123; "_id" : ObjectId("58aa47f645b899838bfb6114"), "name" : "mrbird's blog", "post" : "mongodb", "comment" : &#123; "name" : "xiaohema", "msg" : "å­¦ä¹ äº†ï¼Œæ„Ÿè°¢åˆ†äº«" &#125;&#125;&gt; db.blog.update(&#123;"name":"mrbird's blog"&#125;,... &#123;"$set":&#123;"comment.msg":"å¥½ï¼Œæ”¯æŒå¨æ­¦æœ‰å¸Œæœ›äº†"&#125;&#125;)&gt; db.blog.findOne()&#123; "_id" : ObjectId("58aa47f645b899838bfb6114"), "name" : "mrbird's blog", "post" : "mongodb", "comment" : &#123; "name" : "xiaohema", "msg" : "å¥½ï¼Œæ”¯æŒå¨æ­¦æœ‰å¸Œæœ›äº†" &#125;&#125;ä½¿ç”¨$unsetå¯åˆ é™¤é”®ï¼Œæ¯”å¦‚ï¼š12345678910&gt; db.test.update(&#123;"_id":ObjectId("58a9ace92363ff29a7d881e9")&#125;,... &#123;"$unset":&#123;"note":1&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.test.findOne(&#123;"_id":ObjectId("58a9ace92363ff29a7d881e9")&#125;)&#123; "_id" : ObjectId("58a9ace92363ff29a7d881e9"), "name" : "mrbird", "blog" : "mrbird's blog", "pageview" : 51&#125;æ•°ç»„ä¿®æ”¹å™¨$pushä¼šå‘å·²æœ‰çš„æ•°ç»„æœ«å°¾æ·»åŠ ä¸€ä¸ªå€¼ï¼Œå¦‚æžœæ•°ç»„ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥æ•°ç»„ã€‚æ¯”å¦‚ï¼š123456789101112131415161718192021&gt; db.blog.findOne()&#123; "_id" : ObjectId("58aa47f645b899838bfb6114"), "name" : "mrbird's blog", "post" : "mongodb"&#125;&gt; db.blog.update(&#123;"name":"mrbird's blog"&#125;, &#123;"$push":...&#123;"comments": &#123;"name":"ltsc","msg":"ä¸æ˜Žè§‰åŽ‰"&#125;&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.blog.findOne()&#123; "_id" : ObjectId("58aa47f645b899838bfb6114"), "name" : "mrbird's blog", "post" : "mongodb", "comments" : [ &#123; "name" : "ltsc", "msg" : "ä¸æ˜Žè§‰åŽ‰" &#125; ]&#125;å¦‚æžœè¦ä¸€æ¬¡æ€§å‘æ•°ç»„ä¸­æ·»åŠ å¤šä¸ªå€¼ï¼Œå¯ä»¥ä½¿ç”¨$pushç»“åˆ$eachä¿®æ”¹å™¨ã€‚æ¯”å¦‚ï¼š123456789101112131415161718192021222324&gt; db.blog.update(&#123;"name":"mrbird's blog"&#125;,... &#123;"$push":&#123;"comments":&#123;"$each":[... &#123;"name":"Althars","msg":"siguoyi"&#125;,... &#123;"name":"jint","msg":"åŽ‰å®³äº†æˆ‘çš„å“¥"&#125;]&#125;&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.blog.findOne()&#123; "_id" : ObjectId("58aa47f645b899838bfb6114"), "name" : "mrbird's blog", "post" : "mongodb", "comments" : [ &#123; "name" : "ltsc", "msg" : "ä¸æ˜Žè§‰åŽ‰" &#125;, &#123; "name" : "Althars", "msg" : "siguoyi" &#125;, &#123; "name" : "jint", "msg" : "åŽ‰å®³äº†æˆ‘çš„å“¥" &#125; ]$sliceå¯ä»¥åœ¨ä¸ºæ•°ç»„æ·»åŠ å€¼çš„æ—¶å€™æˆªå–æ•°ç»„ï¼Œä½†å¿…é¡»é…åˆ$pushå’Œ$eachä¸€èµ·ä½¿ç”¨ï¼Œå¦åˆ™æŠ¥è¯­æ³•é”™è¯¯ï¼Œæ¯”å¦‚ï¼š123456789101112131415161718192021222324252627&gt; db.user.findOne()&#123; "_id" : ObjectId("58aa5e8a6a294f5543ff66eb"), "name" : "KangKang", "sex" : "male", "habbit" : [ "basketball", "football", "swimming", "running" ]&#125;&gt; db.user.update(&#123;"name":"KangKang"&#125;,... &#123;"$push":&#123;"habbit":&#123;"$each":... ["eating"],"$slice":-3&#125;&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.user.findOne()&#123; "_id" : ObjectId("58aa5e8a6a294f5543ff66eb"), "name" : "KangKang", "sex" : "male", "habbit" : [ "swimming", "running", "eating" ]&#125;ä»Žç»“æžœå¯ä»¥çœ‹å‡ºï¼Œ$sliceæˆªå–äº†æ•°ç»„æœ€æ–°çš„ä¸‰ä¸ªå€¼ã€‚æ³¨æ„ï¼Œ$sliceçš„å€¼å¿…é¡»æ˜¯è´Ÿæ•´æ•°ã€‚çŽ°åœ¨æœ‰è¿™ä¹ˆä¸€ç§æƒ…å†µï¼Œ$pushä¿®æ”¹å™¨å¯ä»¥å‘ä¸€ä¸ªæ•°ç»„ä¸­æ·»åŠ é‡å¤çš„å€¼ï¼Œå¦‚ï¼š12345678910111213141516171819&gt; db.user.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58aa7cb06a294f5543ff66ec"), "name" : "mrbird", "email" : [ "mrbird@qq.com" ]&#125;&gt; db.user.update(&#123;"name":"mrbird"&#125;, &#123;"$push":&#123;"email":"mrbird@qq.com"&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.user.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58aa7cb06a294f5543ff66ec"), "name" : "mrbird", "email" : [ "mrbird@qq.com", "mrbird@qq.com" ]&#125;å¦‚æžœå¸Œæœ›æ•°ç»„ä¸­æ·»åŠ çš„å€¼ä¸é‡å¤çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨$addToSetä¿®æ”¹å™¨ï¼š12345678910111213141516&gt; db.user.update(&#123;"name":"mrbird"&#125;, &#123;"$unset":&#123;"email":1&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.user.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58aa7cb06a294f5543ff66ec"), "name" : "mrbird" &#125;&gt; db.user.update(&#123;"name":"mrbird"&#125;, ... &#123;"$addToSet":&#123;"email":&#123;"$each":["mrbird@qq.com","mrbird@qq.com","mrbird@gmail.com"]&#125;&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.user.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58aa7cb06a294f5543ff66ec"), "name" : "mrbird", "email" : [ "mrbird@qq.com", "mrbird@gmail.com" ]&#125;åˆ é™¤æ•°ç»„å…ƒç´ æœ‰å‡ ç§æ–¹æ³•ï¼Œæ¯”å¦‚$popï¼Œ{â€œ$popâ€:{&quot;key&quot;:1}}è¡¨ç¤ºä»Žæ•°ç»„å°¾éƒ¨åˆ é™¤å…ƒç´ ï¼Œ-1åˆ™è¡¨ç¤ºä»Žå¤´éƒ¨åˆ é™¤ï¼š1234567891011121314151617181920&gt; db.user.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58aa7cb06a294f5543ff66ec"), "name" : "mrbird", "email" : [ "mrbird@qq.com", "mrbird@gmail.com" ]&#125;&gt; db.user.update(&#123;"name":"mrbird"&#125;,... &#123;"$pop":&#123;"email":1&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.user.findOne(&#123;"name":"mrbird"&#125;)&#123; "_id" : ObjectId("58aa7cb06a294f5543ff66ec"), "name" : "mrbird", "email" : [ "mrbird@qq.com" ]&#125;å¦å¤–ä¸€ä¸ªåˆ é™¤æ•°ç»„å…ƒç´ çš„ä¿®æ”¹å™¨ä¸º$pullï¼Œè¯¥æ“ä½œç¬¦ä¼šå°†æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ä»Žæ•°ç»„ä¸­åˆ é™¤ã€‚æ¯”å¦‚ï¼š12345678910111213141516171819202122232425262728&gt; db.user.update(&#123;"name":"KangKang"&#125;,... &#123;"$push":&#123;"habbit":"eating"&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.user.findOne(&#123;"name":"KangKang"&#125;)&#123; "_id" : ObjectId("58aa5e8a6a294f5543ff66eb"), "name" : "KangKang", "sex" : "male", "habbit" : [ "swimming", "running", "eating", "eating" ]&#125;&gt; db.user.update(&#123;"name":"KangKang"&#125;,... &#123;"$pull":&#123;"habbit":"eating"&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.user.findOne(&#123;"name":"KangKang"&#125;)&#123; "_id" : ObjectId("58aa5e8a6a294f5543ff66eb"), "name" : "KangKang", "sex" : "male", "habbit" : [ "swimming", "running" ]&#125;è¿˜å¯ä»¥é€šè¿‡æ•°ç»„çš„ä¸‹æ ‡ä¿®æ”¹æ•°ç»„å†…å®¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243&gt; db.blog.find(&#123;"name":"mrbird's blog"&#125;).pretty()&#123; "_id" : ObjectId("58aa47f645b899838bfb6114"), "name" : "mrbird's blog", "post" : "mongodb", "comments" : [ &#123; "name" : "ltsc", "msg" : "ä¸æ˜Žè§‰åŽ‰" &#125;, &#123; "name" : "Althars", "msg" : "siguoyi" &#125;, &#123; "name" : "jint", "msg" : "åŽ‰å®³äº†æˆ‘çš„å“¥" &#125; ]&#125;&gt; db.blog.update(&#123;"name":"mrbird's blog"&#125;,... &#123;"$set":&#123;"comments.1.msg":"å››å›½ä»¥"&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.blog.find(&#123;"name":"mrbird's blog"&#125;).pretty()&#123; "_id" : ObjectId("58aa47f645b899838bfb6114"), "name" : "mrbird's blog", "post" : "mongodb", "comments" : [ &#123; "name" : "ltsc", "msg" : "ä¸æ˜Žè§‰åŽ‰" &#125;, &#123; "name" : "Althars", "msg" : "å››å›½ä»¥" &#125;, &#123; "name" : "jint", "msg" : "åŽ‰å®³äº†æˆ‘çš„å“¥" &#125; ]&#125;è¿™ç§åšæ³•æœ‰å±€é™æ€§ï¼Œå°±æ˜¯å¿…é¡»å…ˆçŸ¥é“å¾…ä¿®æ”¹å­—æ®µçš„æ•°ç»„ä¸‹æ ‡ï¼Œå¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ç§æ–¹æ³•ï¼Œä¸‹é¢è¿™ç§æ–¹æ³•åªéœ€è¦çŸ¥é“å¾…ä¿®æ”¹å­—æ®µå°±è¡Œäº†ï¼š1234567891011121314151617181920212223&gt; db.blog.update(&#123;"comments.msg":"å››å›½ä»¥"&#125;,... &#123;"$set":&#123;"comments.$.msg":"çœ‹å®Œæ­¤æ–‡ï¼ŒçŠ¹å¦‚é†é†çŒé¡¶"&#125;&#125;)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.blog.find(&#123;"name":"mrbird's blog"&#125;).pretty()&#123; "_id" : ObjectId("58aa47f645b899838bfb6114"), "name" : "mrbird's blog", "post" : "mongodb", "comments" : [ &#123; "name" : "ltsc", "msg" : "ä¸æ˜Žè§‰åŽ‰" &#125;, &#123; "name" : "Althars", "msg" : "çœ‹å®Œæ­¤æ–‡ï¼ŒçŠ¹å¦‚é†é†çŒé¡¶" &#125;, &#123; "name" : "jint", "msg" : "åŽ‰å®³äº†æˆ‘çš„å“¥" &#125; ]&#125;updateå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºupsertï¼Œè®¾ç½®ä¸ºtrueæ—¶ï¼Œæ–°ä¸€ä¸ªæ–‡æ¡£ï¼Œæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„æŸ¥è¯¢æ–‡æ¡£æ—¶ï¼Œæ’å…¥è¯¥æ–‡æ¡£ï¼Œæ‰¾åˆ°äº†å°±æ›´æ–°ï¼Œæ¯”å¦‚ï¼š1234567891011121314151617&gt; db.blog.findOne(&#123;"name":"mrbrid","post":"MongoDBæ–‡æ¡£CUD"&#125;)null&gt; db.blog.update(&#123;"name":"mrbrid","post":"MongoDBæ–‡æ¡£CUD"&#125;,... &#123;"$inc":&#123;"pageview":1&#125;&#125;,true)WriteResult(&#123; "nMatched" : 0, "nUpserted" : 1, "nModified" : 0, "_id" : ObjectId("58acf0743c8ad0b0d9d65f45")&#125;)&gt; db.blog.findOne(&#123;"name":"mrbrid","post":"MongoDBæ–‡æ¡£CUD"&#125;)&#123; "_id" : ObjectId("58acf0743c8ad0b0d9d65f45"), "name" : "mrbrid", "post" : "MongoDBæ–‡æ¡£CUD", "pageview" : 1&#125;updateå‡½æ•°çš„ç¬¬å››ä¸ªå‚æ•°ä¸ºmultiï¼Œè®¾ç½®ä¸ºtrueçš„æ—¶å€™ï¼Œæ‰¹é‡æ›´æ–°å’ŒæŸ¥è¯¢æ–‡æ¡£åŒ¹é…çš„æ–‡æ¡£ï¼Œæ¯”å¦‚å°†mrbirdâ€™s blogé›†åˆä¸­æ‰€æœ‰æ–‡æ¡£çš„pageviewå¢žåŠ 1ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041&gt; db.blog.find().pretty()&#123; "_id" : ObjectId("58acf0743c8ad0b0d9d65f45"), "name" : "mrbird's blog", "post" : "MongoDBæ–‡æ¡£CUD", "pageview" : 1&#125;&#123; "_id" : ObjectId("58acf64b3c8ad0b0d9d65f4a"), "name" : "mrbird's blog", "post" : "MongoDB shell", "pageview" : 1&#125;&#123; "_id" : ObjectId("58acf65d3c8ad0b0d9d65f4d"), "name" : "mrbird's blog", "post" : "start Spring Boot", "pageview" : 1&#125;&gt; db.blog.update(&#123;"name":"mrbird's blog"&#125;,&#123;"$inc":&#123;"pageview":1&#125;&#125;,... false,true)WriteResult(&#123; "nMatched" : 3, "nUpserted" : 0, "nModified" : 3 &#125;)&gt; db.blog.find().pretty()&#123; "_id" : ObjectId("58acf0743c8ad0b0d9d65f45"), "name" : "mrbird's blog", "post" : "MongoDBæ–‡æ¡£CUD", "pageview" : 2&#125;&#123; "_id" : ObjectId("58acf64b3c8ad0b0d9d65f4a"), "name" : "mrbird's blog", "post" : "MongoDB shell", "pageview" : 2&#125;&#123; "_id" : ObjectId("58acf65d3c8ad0b0d9d65f4d"), "name" : "mrbird's blog", "post" : "start Spring Boot", "pageview" : 2&#125;å¦å¤–ï¼Œè°ƒç”¨getLastErrorå¯æŸ¥çœ‹æœ€è¿‘ä¸€æ¬¡æ›´æ–°çš„æ–‡æ¡£æ•°é‡ï¼Œå¦‚ï¼š12345678910&gt; db.runCommand(&#123;getLastError:1&#125;)&#123; "connectionId" : 1, "updatedExisting" : true, "n" : 3, "syncMillis" : 0, "writtenTo" : null, "err" : null, "ok" : 1&#125;æ‹¥æœ‰ç±»ä¼¼äº‹åŠ¡ç‰¹æ€§çš„æ›´æ–°ä¸ŽæŸ¥è¯¢æ“ä½œfindAndModifyã€‚å®ƒæ˜¯åŽŸå­æ€§çš„ï¼Œä¼šè¿”å›žç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„æ›´æ–°åŽçš„æ–‡æ¡£ã€‚ä¸€æ¬¡æœ€å¤šåªæ›´æ–°ä¸€ä¸ªæ–‡æ¡£ï¼Œä¹Ÿå°±æ˜¯æ¡ä»¶queryæ¡ä»¶ï¼Œä¸”æ‰§è¡ŒsortåŽçš„ç¬¬ä¸€ä¸ªæ–‡æ¡£ã€‚è¯­æ³•å¦‚ä¸‹ï¼š123456789db.COLLECTION_NAME.findAndModify(&#123; query:&#123;&#125;, update:&#123;&#125;, remove:true|false, new:true|false, sort:&#123;&#125;, fields:&#123;&#125;, upsert:true|false&#125;); â€‹queryæ˜¯æŸ¥è¯¢é€‰æ‹©å™¨ï¼Œä¸ŽfindOneçš„æŸ¥è¯¢é€‰æ‹©å™¨ç›¸åŒã€‚updateæ˜¯è¦æ›´æ–°çš„å€¼ï¼Œä¸èƒ½ä¸ŽremoveåŒæ—¶å‡ºçŽ°ã€‚removeè¡¨ç¤ºåˆ é™¤ç¬¦åˆqueryæ¡ä»¶çš„æ–‡æ¡£ï¼Œä¸èƒ½ä¸ŽupdateåŒæ—¶å‡ºçŽ°ã€‚newä¸ºtrueï¼šè¿”å›žæ›´æ–°åŽçš„æ–‡æ¡£ï¼Œfalseï¼šè¿”å›žæ›´æ–°å‰çš„ï¼Œé»˜è®¤æ˜¯falseã€‚sortï¼šæŽ’åºæ¡ä»¶ï¼Œä¸Žsortå‡½æ•°çš„å‚æ•°ä¸€è‡´ã€‚fields:æŠ•å½±æ“ä½œï¼Œä¸Žfindçš„ç¬¬äºŒä¸ªå‚æ•°ä¸€è‡´ã€‚upsert:ä¸Župdateçš„upsertå‚æ•°ä¸€æ ·ã€‚ä¾‹å­ï¼š12345678910111213141516171819202122232425262728293031&gt; db.blog.findAndModify(&#123;... "query":&#123;"name":"mrbird's blog"&#125;,... "update":&#123;... "$inc":&#123;"pageview":1&#125;,... "$set":&#123;"like":1&#125;&#125;&#125;)&#123; "_id" : ObjectId("58acf0743c8ad0b0d9d65f45"), "name" : "mrbird's blog", "post" : "MongoDBæ–‡æ¡£CUD", "pageview" : 3&#125;&gt; db.blog.find().pretty()&#123; "_id" : ObjectId("58acf0743c8ad0b0d9d65f45"), "name" : "mrbird's blog", "post" : "MongoDBæ–‡æ¡£CUD", "pageview" : 4, "like" : 1&#125;&#123; "_id" : ObjectId("58acf64b3c8ad0b0d9d65f4a"), "name" : "mrbird's blog", "post" : "MongoDB shell", "pageview" : 3&#125;&#123; "_id" : ObjectId("58acf65d3c8ad0b0d9d65f4d"), "name" : "mrbird's blog", "post" : "start Spring Boot", "pageview" : 3&#125;å¯å‘çŽ°ï¼Œæ‰§è¡ŒfindAndModifyåŽï¼Œè¿”å›žè¢«æ›´æ–°å‰ï¼ˆé»˜è®¤æ˜¾ç¤ºæ›´æ–°å‰çš„ï¼‰çš„æ–‡æ¡£ï¼Œå¹¶ä¸”åªæ›´æ–°äº†åŒ¹é…çš„ç¬¬ä¸€æ¡æ–‡æ¡£ã€‚å¦‚æžœè¦è¿”å›žè¢«æ›´æ–°åŽçš„æ–‡æ¡£ï¼Œæˆ‘ä»¬è®¾ç½®new ä¸ºtrueï¼š1234567891011&gt; db.blog.findAndModify(&#123; ..."query":&#123;"name":"mrbird's blog"&#125;, ..."update":&#123; "$inc":&#123;"pageview":1&#125;, "$set":&#123;"like":2&#125;&#125;,..."new":true&#125;)&#123; "_id" : ObjectId("58acf0743c8ad0b0d9d65f45"), "name" : "mrbird's blog", "post" : "MongoDBæ–‡æ¡£CUD", "pageview" : 5, "like" : 2&#125;ã€ŠMongoDBæƒå¨æŒ‡å—ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>MongoDB</tag>
        <tag>DataBase</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Leanoteåšå®¢ä¸»é¢˜Conciseness]]></title>
    <url>%2FLeanote%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98Conciseness.html</url>
    <content type="text"><![CDATA[ä¸»é¢˜Concisenesså·²ä¸Šæž¶Leanoteåšå®¢ä¸»é¢˜å¸‚åœºã€‚è¯¥ä¸»é¢˜ä¿®æ”¹è‡ªroomcarçš„pureä¸»é¢˜ã€‚ä¸»é¢˜é¢„è§ˆå›¾å¦‚ä¸‹æ‰€ç¤ºï¼šè¯¥ä¸»é¢˜å¯è‡ªè¡Œä¿®æ”¹ï¼Œè¿™é‡Œåšå‡ ç‚¹ä»‹ç»ã€‚ä¿®æ”¹å›¾ç‰‡ç¼–è¾‘ä¸»é¢˜ï¼Œæ‰¾åˆ°theme.jsonæ–‡ä»¶ä»¥ä¸‹å­—æ®µï¼š12345..."BlogImgName": "blogImg.jpg","WebImgName": "webImg.png","ErrorImgName": "robot.png", ...BlogImgNameä¸ºåšå®¢About Meå›¾ç‰‡ï¼ŒWebImgNameä¸ºç½‘é¡µå°å›¾æ ‡ï¼ŒErrorImgNameä¸º404é¡µé¢å›¾ç‰‡ã€‚å‡å¦‚çŽ°åœ¨æ‚¨æƒ³å°†About Meçš„å›¾ç‰‡æ¢ä¸ºè‡ªå·±ä¸Šä¼ çš„åä¸ºhandsomeBoy.pngçš„ç…§ç‰‡ï¼Œåªéœ€å°†theme.jsonæ–‡ä»¶çš„BlogImgNameå­—æ®µå€¼æ¢ä½â€œhandsomeBoy.pngâ€å³å¯ã€‚ä¿®æ”¹About Meè¿žæŽ¥ç¼–è¾‘ä¸»é¢˜ï¼Œæ‰¾åˆ°theme.jsonæ–‡ä»¶ä»¥ä¸‹å­—æ®µï¼š123"QQ": "123456","Weico": "http://weibo.com/","Facebook": "https://www.facebook.com/",å¯å°†å±žæ€§å€¼æ¢ä¸ºè‡ªå·±çš„è¿žæŽ¥å³å¯ã€‚ä¿®æ”¹éŸ³ä¹éŸ³ä¹æ’ä»¶æ¥è‡ªï¼š32ç©ºé—´ã€‚ä¿®æ”¹éŸ³ä¹åªéœ€ä¿®æ”¹theme.jsonæ–‡ä»¶ä¸­çš„MusicUrl å±žæ€§å³å¯ã€‚è¯¥å±žæ€§çš„å€¼ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œæ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š1&#123;"title": "musicTitle","artist":"artist","mp3": "musicUrl","cover": "musicCover"&#125;,titleä¸ºæ­Œæ›²åï¼Œartistä¸ºæ­Œæ‰‹åï¼Œmp3ä¸ºéŸ³ä¹è¿žæŽ¥ï¼Œcoverä¸ºä¸“è¾‘å°é¢ã€‚å…³äºŽè¿™å‡ ä¸ªå€¼çš„èŽ·å–æ–¹æ³•ï¼Œä¸‹é¢åšè¯¦ç»†ä»‹ç»ï¼š1.æ¯”å¦‚åœ¨ç½‘æ˜“äº‘éŸ³ä¹ä¸­æœç´¢èŽ«æ–‡è”šçš„ã€Šå½“ä½ è€äº†ã€‹ï¼Œå¯å¾—åˆ°éŸ³ä¹é“¾æŽ¥ä¸ºï¼šhttp://music.163.com/#/song?id=30621954&amp;userid=3425798ã€‚å…¶ä¸­songçš„idä¸º30621954ã€‚2.å¤åˆ¶è¯¥idï¼Œæ‰“å¼€é“¾æŽ¥ï¼šhttp://music.163.com/api/song/detail/?id=yourId&amp;ids=%5ByourId%5D&amp;csrf_token=ã€‚3.å°†é“¾æŽ¥ä¸­çš„yourIdæ›´æ”¹ä¸ºç¬¬ä¸€æ¡å¤åˆ¶çš„éŸ³ä¹idï¼Œç„¶åŽå›žè½¦ï¼Œå¯çœ‹åˆ°é¡µé¢è§£æžå‡ºä¸€ä¸ªjsonæ ¼å¼å†…å®¹ï¼š123456789101112131415161718192021222324252627282930313233343536373839&#123;"songs": [ &#123; "name": "å½“ä½ è€äº†", "id": 30621954,... "artists": [ &#123; "name": "èŽ«æ–‡è”š", "id": 8926, "picId": 0, "img1v1Id": 0, "briefDesc": "", "picUrl": "http://p3.music.126.net/6y-UleORITEDbvrOLV0Q8A==/5639395138885805.jpg", "img1v1Url": "http://p4.music.126.net/6y-UleORITEDbvrOLV0Q8A==/5639395138885805.jpg", "albumSize": 0, "alias": [], "trans": "", "musicSize": 0 &#125; ], "album": &#123; "name": "å½“ä½ è€äº†", "id": 3104146, "type": "EP/Single", "size": 1, "picId": 7860408627221136, "blurPicUrl": "http://p3.music.126.net/2nJOdPf1RlGY_tQdB5ZdPA==/7860408627221136.jpg", "companyId": 0, "pic": 7860408627221136, "picUrl": "http://p4.music.126.net/2nJOdPf1RlGY_tQdB5ZdPA==/7860408627221136.jpg", "publishTime": 1424188800007,... "mp3Url": "http://m2.music.126.net/tQ0pNmpsiHIsxEl-CnMmJg==/7897792022607979.mp3" &#125; ],"equalizers": &#123;&#125;,"code": 200&#125;ä¸€å¤§æ®µjsonæ•°æ®ï¼Œå’Œæˆ‘ä»¬æœ‰å…³çš„å°±å‡ ä¸ªï¼Œå…¶ä¸­titleè¿™é‡Œæˆ‘ä»¬å¡«å†™ä¸ºâ€œå½“ä½ è€äº†â€ï¼Œartistä¸ºâ€œèŽ«æ–‡è”šâ€ï¼Œmp3ä¸ºjsonæ•°æ®ä¸­çš„mp3Urlå­—æ®µï¼Œè¿™é‡Œä¸ºï¼šhttp://m2.music.126.net/tQ0pNmpsiHIsxEl-CnMmJg==/7897792022607979.mp3ã€‚coverä¸ºjsonæ–‡ä»¶ä¸­çš„albumçš„picUrlå­—æ®µå€¼ï¼Œè¿™é‡Œä¸ºï¼šhttp://p4.music.126.net/2nJOdPf1RlGY_tQdB5ZdPA==/7860408627221136.jpgã€‚æ‰€ä»¥æœ€ç»ˆçš„è¿™é¦–æ­Œçš„ä»£ç ä¸ºï¼š123456 &#123; "title": "å½“ä½ è€äº†", "artist":"èŽ«æ–‡è”š", "mp3": "http://m2.music.126.net/tQ0pNmpsiHIsxEl-CnMmJg==/7897792022607979.mp3", "cover": "http://p4.music.126.net/2nJOdPf1RlGY_tQdB5ZdPA==/7860408627221136.jpg"&#125;,å°†è¿™æ®µä»£ç åŠ åˆ°theme.jsonæ–‡ä»¶ä¸­çš„musicUrlå±žæ€§ä¸­å³å¯ã€‚è¾“å…¥ç‰¹æ•ˆåœ¨æœç´¢ä»¥åŠè¯„è®ºæ¡†å†…åŠ å¦‚äº†æ’ä»¶activate-power-mode.jsç‰¹æ•ˆï¼Œå¦‚æžœä¸éœ€è¦å¯ä»¥æ‰¾åˆ°0-c.htmlç¬¬55è¡Œï¼š12345&lt;script&gt; POWERMODE.colorful = true; POWERMODE.shake = false; document.body.addEventListener('input', POWERMODE);&lt;/script&gt;å°†è¿™å‡ è¡Œä»£ç åˆ æŽ‰å³å¯ã€‚å¼¹å‡ºå±‚é¡µé¢å¼¹å‡ºå±‚ä½¿ç”¨çš„æ˜¯sweetAlert.jsæ’ä»¶ã€‚å½“åˆ é™¤è¯„è®ºä»¥åŠæœªç™»å½•çŠ¶å†µä¸‹ç‚¹å‡»åšæ–‡çš„è¯„è®ºå’Œç‚¹èµžæŒ‰é’®å³å¯è§¦å‘ï¼Œå¦‚ï¼šç›¸åº”APIå¯æŸ¥çœ‹sweetAlertæ’ä»¶å®˜ç½‘ã€‚åœ¨ä¸»é¢˜share_comment.jsæ–‡ä»¶ä¸­å¯æ‰¾åˆ°ç›¸å…³ä»£ç ã€‚å¦‚æžœæœ‰ç–‘é—®ï¼Œæ¬¢è¿Žç•™è¨€ã€‚2017å¹´3æœˆ27æ—¥ä¿®å¤ä¸€äº›bugï¼Œæ ·å¼è°ƒæ•´ã€‚æœ€æ–°å®‰è£…åŒ…ï¼šgithub]]></content>
      <tags>
        <tag>Leanote</tag>
        <tag>theme</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MongoDB shell]]></title>
    <url>%2FMongoDB-shell.html</url>
    <content type="text"><![CDATA[å¯åŠ¨MongoDBå®‰è£…å¥½MongoDBï¼Œå°†å…¶binç›®å½•é…ç½®åˆ°ç³»ç»ŸçŽ¯å¢ƒå˜é‡pathåŽï¼Œåœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªæ•°æ®åº“ä¿å­˜ç›®å½•ï¼Œæ¯”å¦‚D:\MongoDBï¼Œç„¶åŽæ‰“å¼€å‘½ä»¤çª—å£è¾“å…¥å¦‚ä¸‹å‘½ä»¤å¯åŠ¨MongoDBæœåŠ¡ï¼š1&gt; mongod --dbpath=d:\mongodbå½“çœ‹åˆ°è¾“å‡ºå¦‚ä¸‹ä¿¡æ¯ï¼Œè¡¨æ˜Žå¯åŠ¨æˆåŠŸï¼Œç«¯å£å·ä¸º27017ï¼š12...[thread1] waiting for connections on port 27017æ‰“å¼€å¦å¤–ä¸€ä¸ªå‘½ä»¤çª—å£ä½œä¸ºå®¢æˆ·ç«¯ï¼Œè¾“å…¥mongoå³å¯è¿žä¸ŠæœåŠ¡ï¼š1234&gt; mongoMongoDB shell version v3.4.2connecting to: mongodb://127.0.0.1:27017MongoDB server version: 3.4.2è¯­æ³•ç³–MongoDB shellè‡ªå¸¦äº†ä¸€äº›è¯­æ³•ç³–ï¼š123456show dbs åˆ—å‡ºæ‰€æœ‰DBuse dbname åˆ‡æ¢å½“å‰DBshow tables æˆ– show collections åˆ—å‡ºå½“å‰DBçš„æ‰€æœ‰è¡¨/é›†åˆshow users åˆ—å‡ºå½“å‰DBçš„æ‰€æœ‰ç”¨æˆ·show profile åˆ—å‡ºå½“å‰DBçš„æ‰€æœ‰æ…¢æŸ¥è¯¢show logs åˆ—å‡ºè¿è¡Œæ—¥å¿—ä½¿ç”¨shellæ‰§è¡Œè„šæœ¬å‡å¦‚åœ¨C:\Program Files\MongoDB\Server\3.4\binç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªtest.jsè„šæœ¬æ–‡ä»¶ï¼š1print("hello MnogoDB")æœ‰ä¸¤ç§æ–¹å¼è®©MongoDBæ‰§è¡Œè¯¥è„šæœ¬ï¼šè¿žä¸ŠæœåŠ¡å‰123456789&gt; exitbye C:\Users\Dell&gt;cd ../../program files/mongodb/server/3.4/binC:\Program Files\MongoDB\Server\3.4\bin&gt;mongo test.jsMongoDB shell version v3.4.2connecting to: mongodb://127.0.0.1:27017MongoDB server version: 3.4.2hello MnogoDBå¯çœ‹åˆ°ï¼Œshellé¡µé¢æ‰§è¡Œäº†test.jsè„šæœ¬å¹¶å¦‚æœŸè¾“å‡ºhello MongoDBï¼ˆè·¯å¾„å¿…é¡»å’Œè„šæœ¬æ‰€åœ¨è·¯å¾„ä¸€è‡´ï¼‰ã€‚è¿žä¸ŠæœåŠ¡åŽè¿žä¸ŠæœåŠ¡åŽï¼Œå¯ä½¿ç”¨load()å‡½æ•°æ‰§è¡Œè„šæœ¬ï¼š123&gt; load("test.js")hello MnogoDBtrueå¦å¤–ä¸€ä¸ªå°±æ˜¯å¯ä»¥åœ¨shellä¸­åˆå§‹åŒ–ä¸€äº›è¾…åŠ©å‡½æ•°ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ªhello.jsï¼š12345var hello = function()&#123; var world = ["handsome","charming"]; var index = Math.floor(Math.random()*2); print("hello mrbird,you are so "+world[index]);&#125;åœ¨shellä¸­åŠ è½½è¿™ä¸ªè„šæœ¬ï¼Œhelloå‡½æ•°å°±å¯ä»¥ä½¿ç”¨äº†ï¼š12345678&gt; typeof helloundefined&gt; load("hello.js")true&gt; typeof hellofunction&gt; hello()hello mrbird,you are so charming.mongorc.jså¯¹äºŽä¸€äº›å¸¸ç”¨çš„è„šæœ¬ï¼Œå¦‚æžœæ¯æ¬¡å¯åŠ¨æœåŠ¡åŽéƒ½ç”¨load()æ‰‹åŠ¨åŠ è½½ï¼Œè¿™å°†å¾ˆç¹çã€‚å¯¹äºŽè¿™äº›å¸¸ç”¨çš„è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ”¾åœ¨.mongorc.jsæ–‡ä»¶ä¸­ï¼Œå› ä¸ºMongoDBå¯åŠ¨çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åŠ è½½è¯¥è„šæœ¬ã€‚æ¯”å¦‚åœ¨.mongorc.jsåŠ å…¥ä¸€å¥é—®å€™è¯­ï¼š1print("Hello mrbird,welcome to use mongoDB")è¿žæŽ¥æœåŠ¡æ—¶ï¼Œshellçª—å£è¾“å‡ºï¼š12345&gt; mongoMongoDB shell version v3.4.2connecting to: mongodb://127.0.0.1:27017MongoDB server version: 3.4.2Hello mrbird,welcome to use mongoDBä¹Ÿå¯ä»¥åŠ å¦‚ä¸€äº›å®žç”¨åŠŸèƒ½ï¼Œæ¯”å¦‚æ·»åŠ é˜²æ­¢è‡ªå·±è¯¯åˆ çš„jsè„šæœ¬ï¼š123456789var no = function()&#123; print("Please don't");&#125;;// ç¦æ­¢åˆ é™¤æ•°æ®åº“db.dropDatabases = DB.prototype.dropDatabases = no;// ç¦æ­¢åˆ é™¤é›†åˆDBCollection.prototype.drop = no;// ç¦æ­¢åˆ é™¤ç´¢å¼•DBCollection.prototype.dropIndex = no;æµ‹è¯•ä¸€ä¸‹ï¼š123456&gt; show collectionsblog&gt; db.blog.drop();Please don't&gt; show collectionsblogé…åˆç¼–è¾‘å™¨åœ¨shellä¸­ç¼–è¾‘æ–‡æ¡£æ˜¯ä¸€ä»¶éº»çƒ¦çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨.mongorc.jsæ–‡ä»¶ä¸­åŠ å…¥è‡ªå·±çš„è„šæœ¬ç¼–è¾‘å™¨ï¼š1EDITOR = "\"D:\\Program Files (x86)\\Notepad++\\notepad++.exe\""è¿™é‡ŒæŒ‡å®šç¼–è¾‘å™¨ä¸ºnotepad++ï¼Œç„¶åŽåœ¨shellä¸­å³å¯å®žç”¨editå‘½ä»¤æ¥ç¼–è¾‘ä¸€ä¸ªå˜é‡ï¼š123456789&gt; db.blog.findOne()&#123; "_id" : ObjectId("58a86088eb4ef940034d2733"), "title" : "mongodb shell", "content" : "mongodbè¶…çº§æœ‰è¶£", "date" : ISODate("2017-02-18T14:55:39.679Z")&#125;&gt; var msg = db.blog.findOne()&gt; edit msgç•Œé¢å¼¹å‡ºï¼šåœ¨ç¼–è¾‘å™¨ä¸­ä¿®æ”¹contentå†…å®¹åŽï¼Œä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨ï¼Œå˜é‡å°±ä¼šè¢«é‡æ–°è§£æžç„¶åŽåŠ è½½å›žshellï¼š123456789&gt; db.blog.update(&#123;title: "mongodb shell"&#125;,msg)WriteResult(&#123; "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 &#125;)&gt; db.blog.findOne()&#123; "_id" : ObjectId("58a86088eb4ef940034d2733"), "title" : "mongodb shell", "content" : "mongodb is interesting", "date" : ISODate("2017-02-18T14:55:39.679Z")&#125;å¯çœ‹åˆ°ï¼Œæ–‡æ¡£å·²ä¿®æ”¹ã€‚ã€ŠMongoDBæƒå¨æŒ‡å—ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>MongoDB</tag>
        <tag>DataBase</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IntelliJ IDEA å¼€å‘çŽ¯å¢ƒé…ç½®]]></title>
    <url>%2FIntelliJ-IDEA-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE.html</url>
    <content type="text"><![CDATA[IntelliJ IDEA ä¸»è¦ç”¨äºŽæ”¯æŒ Javaã€Scalaã€Groovy ç­‰è¯­è¨€çš„å¼€å‘å·¥å…·ï¼ŒåŒæ—¶å…·å¤‡æ”¯æŒç›®å‰ä¸»æµçš„æŠ€æœ¯å’Œæ¡†æž¶ï¼Œæ“…é•¿äºŽä¼ä¸šåº”ç”¨ã€ç§»åŠ¨åº”ç”¨å’Œ Web åº”ç”¨çš„å¼€å‘ã€‚æœ€è¿‘ä½¿ç”¨åŽè§‰å¾—æ¯”eclipseå¼ºå¤ªå¤šã€‚åˆæ¬¡ä½¿ç”¨è¦é…ç½®å„ç§å¼€å‘çŽ¯å¢ƒï¼Œæ‰€ä»¥è®°ä¹‹ã€‚é…ç½®Git1.åœ¨å®˜ç½‘https://git-scm.com/ä¸‹è½½Git for windowså¹¶å®‰è£…ã€‚2.æ‰“å¼€IntelliJ IDEAçš„è®¾ç½®ç•Œé¢ï¼Œé€‰æ‹©Version Control â†’ Gitï¼šå°†Path to Git executableè®¾ç½®ä¸ºGitå®‰è£…è·¯å¾„ã€‚é…ç½®GitHub1.æ‰“å¼€IntelliJ IDEAçš„è®¾ç½®ç•Œé¢ï¼Œé€‰æ‹©Version Control â†’ GitHubã€‚2.å¡«å†™è´¦å·å¯†ç ï¼Œå¹¶æµ‹è¯•æ˜¯å¦ç™»é™†æˆåŠŸï¼šé…ç½®Maven1.é¦–å…ˆé…ç½®Mavenæœ¬åœ°èµ„æºåº“å­˜æ”¾è·¯å¾„(æ‹·è´Mavenè‡ªå¸¦settings.xmlï¼Œæ‰“å¼€ä¿®æ”¹å­˜æ”¾è·¯å¾„)ï¼š1&lt;localRepository&gt;D:\MyMaven\repository&lt;/localRepository&gt;2.æ‰“å¼€IntelliJ IDEAçš„è®¾ç½®ç•Œé¢ï¼Œé€‰æ‹©Build,Execution,Deployment â†’ Build Tools â†’ Mavenï¼šé€‰æ‹©ç›¸åº”settings.xmlæ–‡ä»¶å³å¯ã€‚]]></content>
      <tags>
        <tag>IntelliJ IDEA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Securityä¿æŠ¤æ–¹æ³•]]></title>
    <url>%2FSpring-Security%E4%BF%9D%E6%8A%A4%E6%96%B9%E6%B3%95.html</url>
    <content type="text"><![CDATA[Spring Securityæä¾›äº†ä¸‰ç§ä¸åŒçš„å®‰å…¨æ³¨è§£ï¼š1.Spring Securityè‡ªå¸¦çš„@Securedæ³¨è§£ï¼›2.JSR-250çš„@RolesAllowedæ³¨è§£ï¼›3.è¡¨è¾¾å¼é©±åŠ¨çš„æ³¨è§£ï¼ŒåŒ…æ‹¬@PreAuthorizeã€@PostAuthorizeã€@PreFilterå’Œ @PostFilterã€‚@Securedåœ¨Spring-Security.xmlä¸­å¯ç”¨@Securedæ³¨è§£ï¼š1&lt;global-method-security secured-annotations="enabled"/&gt;ä¾‹å¦‚åªæœ‰æ‹¥æœ‰æƒé™â€œROLE_ADMINâ€çš„ç”¨æˆ·æ‰èƒ½è®¿é—®ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š1234@Secured("ROLE_ADMIN")public void test()&#123; ...&#125;æƒé™ä¸è¶³æ—¶ï¼Œæ–¹æ³•æŠ›å‡ºAccess Deniedå¼‚å¸¸ã€‚@Securedæ³¨è§£ä¼šä½¿ç”¨ä¸€ä¸ªStringæ•°ç»„ä½œä¸ºå‚æ•°ã€‚æ¯ä¸ªStringå€¼æ˜¯ä¸€ä¸ªæƒé™ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•è‡³å°‘éœ€è¦å…·å¤‡å…¶ä¸­çš„ä¸€ä¸ªæƒé™ã€‚å¦‚ï¼š1234@Secured(&#123;"ROLE_ADMIN","ROLE_USER"&#125;)public void test()&#123; ...&#125;@RolesAllowed@RolesAllowedæ³¨è§£å’Œ@Securedæ³¨è§£åœ¨å„ä¸ªæ–¹é¢åŸºæœ¬ä¸Šéƒ½æ˜¯ä¸€è‡´çš„ã€‚å¯ç”¨@RolesAllowedæ³¨è§£ï¼š1&lt;global-method-security jsr250-annotations="enabled"/&gt;æ —å­ï¼š1234@RolesAllowed("ROLE_ADMIN")public void test()&#123; ...&#125;SpELæ³¨è§£å¯ç”¨è¯¥æ³¨è§£ï¼š1&lt;global-method-security pre-post-annotations="enabled"/&gt;@PreAuthorizeè¯¥æ³¨è§£ç”¨äºŽæ–¹æ³•å‰éªŒè¯æƒé™ï¼Œæ¯”å¦‚é™åˆ¶éžVIPç”¨æˆ·æäº¤blogçš„noteå­—æ®µå­—æ•°ä¸å¾—è¶…è¿‡1000å­—ï¼š1234@PreAuthorize("hasRole('ROLE_ADMIN') and #form.note.length() &lt;= 1000 or hasRole('ROLE_VIP')")public void writeBlog(Form form)&#123; ...&#125;è¡¨è¾¾å¼ä¸­çš„#forméƒ¨åˆ†ç›´æŽ¥å¼•ç”¨äº†æ–¹æ³•ä¸­çš„åŒåå‚æ•°ã€‚è¿™ä½¿å¾—Spring Securityèƒ½å¤Ÿæ£€æŸ¥ä¼ å…¥æ–¹æ³•çš„å‚æ•°ï¼Œå¹¶å°†è¿™äº›å‚æ•°ç”¨äºŽè®¤è¯å†³ç­–çš„åˆ¶å®šã€‚@PostAuthorizeæ–¹æ³•åŽè°ƒç”¨æƒé™éªŒè¯ï¼Œæ¯”å¦‚æ ¡éªŒæ–¹æ³•è¿”å›žå€¼ï¼š12345@PreAuthorize("hasRole(ROLE_USER)")@PostAuthorize("returnObject.user.userName == principal.username")public User getUserById(long id)&#123; ... &#125;Spring Securityåœ¨SpELä¸­æä¾›äº†åä¸ºreturnObject çš„å˜é‡ã€‚åœ¨è¿™é‡Œæ–¹æ³•è¿”å›žä¸€ä¸ªUserå¯¹è±¡ï¼Œæ‰€ä»¥è¿™ä¸ªè¡¨è¾¾å¼å¯ä»¥ç›´æŽ¥è®¿é—®userå¯¹è±¡ä¸­çš„userNameå±žæ€§ã€‚]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Security JSPæ ‡ç­¾åº“]]></title>
    <url>%2FSpring-Security-JSP%E6%A0%87%E7%AD%BE%E5%BA%93.html</url>
    <content type="text"><![CDATA[Spring Securityæä¾›äº†ä¸€å¥—JSPæ ‡ç­¾åº“ç”¨äºŽä¿æŠ¤JSPè§†å›¾ã€‚è¯¥åº“æ¯”è¾ƒå°ï¼Œåªæä¾›äº†ä¸‰ä¸ªæ ‡ç­¾ã€‚è¦ä½¿ç”¨è¿™ä¸ªåº“ï¼Œå…ˆåœ¨JSPé¡µé¦–åŠ å…¥ï¼š1&lt;%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec" %&gt;è¯¥åº“åŒ…å«çš„ä¸‰ä¸ªæ ‡ç­¾å¦‚ä¸‹ï¼š&lt;security:accesscontrollist&gt;ï¼šå¦‚æžœç”¨æˆ·é€šè¿‡è®¿é—®æŽ§åˆ¶åˆ—è¡¨æŽˆäºˆäº†æŒ‡å®šçš„æƒé™ï¼Œé‚£ä¹ˆæ¸²æŸ“è¯¥æ ‡ç­¾ä½“ä¸­çš„å†…å®¹ã€‚&lt;security:authentication&gt;ï¼šæ¸²æŸ“å½“å‰ç”¨æˆ·è®¤è¯å¯¹è±¡çš„è¯¦ç»†ä¿¡æ¯ã€‚&lt;security:authorize&gt;ï¼šå¦‚æžœç”¨æˆ·è¢«æŽˆäºˆäº†ç‰¹å®šçš„æƒé™æˆ–è€…SpELè¡¨è¾¾å¼çš„è®¡ç®—ç»“æžœä¸ºtrueï¼Œé‚£ä¹ˆæ¸²æŸ“è¯¥æ ‡ç­¾ä½“ä¸­çš„å†…å®¹ã€‚è®¤è¯ç”¨æˆ·ä¿¡æ¯ä½¿ç”¨&lt;security:authentication&gt; JSPæ ‡ç­¾å¯ä»¥è®¿é—®ç”¨æˆ·çš„è®¤è¯è¯¦æƒ…ï¼šprincipalï¼šç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯å¯¹è±¡ã€‚ä½¿ç”¨adminç™»é™†ï¼ŒæŸ¥çœ‹å…¶ç”¨æˆ·è®¤è¯è¯¦æƒ…ï¼š1&lt;sec:authentication property="principal"/&gt;é¡µé¢æ˜¾ç¤ºå†…å®¹å¦‚ä¸‹ï¼š12345678org.springframework.security.core.userdetails.User@586034f: Username: admin; Password: [PROTECTED]; Enabled: true; AccountNonExpired: true; credentialsNonExpired: true; AccountNonLocked: true; Granted Authorities: ROLE_ADMIN,ROLE_USERè¿˜å¯ä»¥å°†å…¶èµ‹å€¼ç»™å˜é‡ï¼Œå¹¶æŒ‡å®šä½œç”¨åŸŸï¼š1&lt;sec:authentication property="principal" var="principal" scope="request"/&gt;detailsï¼šè®¤è¯çš„é™„åŠ ä¿¡æ¯ï¼ˆIPåœ°å€ã€è¯ä»¶åºåˆ—å·ã€ä¼šè¯IDç­‰ï¼‰ã€‚æŸ¥çœ‹adminç”¨æˆ·çš„detailså±žæ€§ï¼š1&lt;sec:authentication property="details"/&gt;é¡µé¢æ˜¾ç¤ºå†…å®¹å¦‚ä¸‹ï¼š123org.springframework.security.web.authentication.WebAuthenticationDetails@21a2c: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: D45BA834E227E0DA5596FF8C56FB9CA1authoritiesï¼šä¸€ç»„ç”¨äºŽè¡¨ç¤ºç”¨æˆ·æ‰€æŽˆäºˆæƒé™çš„GrantedAuthorityå¯¹è±¡ã€‚æŸ¥çœ‹adminç”¨æˆ·çš„authoritieså±žæ€§ï¼š1&lt;sec:authentication property="authorities"/&gt;é¡µé¢æ˜¾ç¤ºå†…å®¹å¦‚ä¸‹ï¼š1[ROLE_ADMIN, ROLE_USER]credentialsï¼šç”¨äºŽæ ¸å®žç”¨æˆ·çš„å‡­è¯ï¼ˆé€šå¸¸ï¼Œè¿™ä¼šæ˜¯ç”¨æˆ·çš„å¯†ç ï¼‰ã€‚æ ¹æ®æƒé™å±•ç¤ºJSPé¡µé¢çš„å†…å®¹ä¹Ÿå¯ä»¥æ ¹æ®ç”¨æˆ·çš„æƒé™è¿›è¡Œæœ‰æ¡ä»¶çš„å±•ç¤ºï¼Œæ¯”å¦‚åªè®©adminçœ‹åˆ°admin I love uä¿¡æ¯ï¼š123&lt;sec:authorize access="hasRole('ROLE_ADMIN')"&gt; admin i love u&lt;/sec:authorize&gt;æµ‹è¯•è¿‡ç¨‹ä¸­å‘çŽ°ç¨‹åºæŠ¥é”™ï¼šNo WebApplicationContext found: no ContextLoaderListener registered?ã€‚ä¿®æ”¹web.xmlåŠ å…¥ContextLoaderListeneré…ç½®ï¼š123456789101112131415161718192021&lt;context-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt; classpath:applicationContext.xml &lt;/param-value&gt;&lt;/context-param&gt;&lt;listener&gt; &lt;listener-class&gt; org.springframework.web.context.ContextLoaderListener &lt;/listener-class&gt; &lt;/listener&gt; &lt;servlet&gt; &lt;servlet-name&gt;spring&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;spring&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;...ç»“æžœæŠ›å‡ºæ–°å¼‚å¸¸ï¼šCould not open ServletContext resource [/WEB-INF/spring-servlet.xml]ã€‚åœ¨WEB-INFä¸‹åˆ›å»ºä¸€ä¸ªspring-servlet.xmlæ–‡ä»¶å³å¯ï¼š1234567891011&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xsi:schemaLocation=" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd"&gt; &lt;!-- some tags --&gt;&lt;/beans&gt;]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åŸºäºŽæ•°æ®åº“ç”¨æˆ·è®¤è¯]]></title>
    <url>%2F%E5%9F%BA%E4%BA%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%94%A8%E6%88%B7%E8%AE%A4%E8%AF%81.html</url>
    <content type="text"><![CDATA[å®žé™…å¼€å‘ä¸­ç”¨æˆ·çš„ä¿¡æ¯ä¸€èˆ¬å­˜æ”¾åœ¨æ•°æ®åº“è¡¨é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å…ƒç´ æ›¿ä»£çŽ°ä½¿ç”¨Mysqlæ•°æ®åº“æ¼”ç¤ºï¼Œè¡¨ç»“æž„å¦‚ä¸‹ï¼š123456789101112131415161718192021CREATE TABLE `role` ( `id` int(20) NOT NULL AUTO_INCREMENT COMMENT 'è§’è‰²ç¼–å·', `name` varchar(60) NOT NULL COMMENT 'è§’è‰²', `note` varchar(100) DEFAULT NULL COMMENT 'æè¿°', PRIMARY KEY (`id`));CREATE TABLE `user` ( `id` int(20) NOT NULL AUTO_INCREMENT COMMENT 'ç”¨æˆ·ç¼–å·', `username` varchar(60) NOT NULL COMMENT 'ç”¨æˆ·å', `password` varchar(60) NOT NULL COMMENT 'å¯†ç ', `status` int(20) NOT NULL COMMENT 'çŠ¶æ€', `note` varchar(100) DEFAULT NULL COMMENT 'æè¿°', PRIMARY KEY (`id`));CREATE TABLE `user_role` ( `role_id` int(20) NOT NULL COMMENT 'è§’è‰²ç¼–å·', `user_id` int(20) NOT NULL COMMENT 'ç”¨æˆ·ç¼–å·', PRIMARY KEY (`role_id`,`user_id`), CONSTRAINT `user_role_ibfk_2` FOREIGN KEY (`user_id`) REFERENCES `user` (`id`), CONSTRAINT `user_role_ibfk_1` FOREIGN KEY (`role_id`) REFERENCES `role` (`id`));æ’å…¥æµ‹è¯•æ•°æ®ï¼š1234567INSERT INTO `role` VALUES ('1', 'ROLE_ADMIN', 'ç®¡ç†å‘˜è§’è‰²');INSERT INTO `role` VALUES ('2', 'ROLE_USER', 'ç”¨æˆ·è§’è‰²');INSERT INTO `user` VALUES ('1', 'admin', 'admin', '1', 'ç®¡ç†å‘˜');INSERT INTO `user` VALUES ('2', 'user', 'user', '1', 'æ™®é€šç”¨æˆ·');INSERT INTO `user_role` VALUES ('1', '1');INSERT INTO `user_role` VALUES ('1', '2');INSERT INTO `user_role` VALUES ('2', '2');åŠ å…¥spring-jdbcä»¥åŠmysql-connectorä¾èµ–ï¼š12345678910&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;4.3.2.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.6&lt;/version&gt;&lt;/dependency&gt;ä¿®æ”¹spring-securityé…ç½®ï¼š123456789101112131415161718&lt;bean id="datasource" class="org.springframework.jdbc.datasource.DriverManagerDataSource" p:driverClassName="com.mysql.jdbc.Driver" p:url="jdbc:mysql://localhost:3306/security?useUnicode=true&amp;characterEncoding=UTF-8" p:username="root" p:password="123456"/&gt;&lt;jdbc-user-service id="user_service" data-source-ref="datasource" users-by-username-query="select username,password,status as enabled from user where username=?" authorities-by-username-query="select u.username,r.name as authority from user u join user_role ur on u.id=ur.user_id join role r on r.id=ur.role_id where u.username=?"/&gt;users-by-username-queryä¸ºæ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·ï¼Œç³»ç»Ÿé€šè¿‡ä¼ å…¥çš„ç”¨æˆ·åæŸ¥è¯¢å½“å‰ç”¨æˆ·çš„ç™»å½•åï¼Œå¯†ç å’Œæ˜¯å¦è¢«ç¦ç”¨è¿™ä¸€çŠ¶æ€ã€‚authorities-by-username-queryä¸ºæ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾æƒé™ï¼Œç³»ç»Ÿé€šè¿‡ä¼ å…¥çš„ç”¨æˆ·åæŸ¥è¯¢å½“å‰ç”¨æˆ·å·²è¢«æŽˆäºˆçš„æ‰€æœ‰æƒé™ã€‚]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è‡ªå®šä¹‰Spring Securityç™»å½•é¡µ]]></title>
    <url>%2F%E8%87%AA%E5%AE%9A%E4%B9%89Spring-Security%E7%99%BB%E5%BD%95%E9%A1%B5.html</url>
    <content type="text"><![CDATA[è™½ç„¶Spring Securityæ¡†æž¶ç»™æˆ‘ä»¬èµ é€äº†ä¸ªç™»å½•é¡µé¢ï¼Œä½†è¿™ä¸ªé¡µé¢è¿‡äºŽç®€å•ï¼ŒSpring Securityå…è®¸æˆ‘ä»¬è‡ªå®šä¹‰ç™»å½•é¡µã€‚å‡†å¤‡å·¥ä½œç¬¬ä¸€æ­¥åœ¨mavenä¸­åŠ å…¥Spring Securityç›¸å…³ä¾èµ–ï¼ˆSpring MVCå·²æ­å»ºå¥½ï¼‰ã€‚123456789101112131415&lt;dependency&gt; &lt;groupId&gt;org.springframework.security&lt;/groupId&gt; &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt; &lt;version&gt;3.2.0.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.security&lt;/groupId&gt; &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt; &lt;version&gt;3.2.0.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.security&lt;/groupId&gt; &lt;artifactId&gt;spring-security-taglibs&lt;/artifactId&gt; &lt;version&gt;3.2.0.RELEASE&lt;/version&gt;&lt;/dependency&gt;ä¸ºäº†åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Spring Security æŽ§åˆ¶æƒé™ï¼Œé¦–å…ˆè¦åœ¨web.xml ä¸­é…ç½®è¿‡æ»¤å™¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŽ§åˆ¶å¯¹è¿™ä¸ªé¡¹ç›®çš„æ¯ä¸ªè¯·æ±‚äº†ã€‚12345678&lt;filter&gt; &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;&lt;/filter&gt;&lt;filter-mapping&gt; &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;/filter-mapping&gt;applicationContext.xmlçš„é…ç½®å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:p="http://www.springframework.org/schema/p" xsi:schemaLocation=" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.3.xsd"&gt; &lt;!-- å¼€å¯ç»„ä»¶æ‰«æ --&gt; &lt;context:component-scan base-package="spring"/&gt; &lt;!-- å¯ç”¨Spring mvc --&gt; &lt;mvc:annotation-driven/&gt; &lt;!-- é…ç½®viewResolver --&gt; &lt;bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver" p:prefix="/WEB-INF/views/" p:suffix=".jsp" p:viewClass="org.springframework.web.servlet.view.JstlView"&gt; &lt;/bean&gt; &lt;mvc:resources location="/css/" mapping="/css/**"/&gt; &lt;!-- å¼•å…¥spring-security.xml --&gt; &lt;import resource="spring-security.xml"/&gt;&lt;/beans&gt;åœ¨applicationContext.xmlä¸­ï¼Œä½¿ç”¨&lt;import/&gt;æ ‡ç­¾å¼•å…¥äº†spring-security.xmlé…ç½®ã€‚spring-security.xmlå…ˆç®€å•é…ç½®å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;b:beans xmlns:b="http://www.springframework.org/schema/beans" xmlns="http://www.springframework.org/schema/security" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd"&gt; &lt;!-- è®¾ç½®å…éªŒè¯è·¯å¾„ --&gt; &lt;http pattern="/**/*.css" security="none"/&gt; &lt;http pattern="/**/*.jpg" security="none"/&gt; &lt;http pattern="/**/*.jpeg" security="none"/&gt; &lt;http pattern="/checkCode" security="none"/&gt; &lt;http auto-config="true"&gt; &lt;intercept-url pattern="/login" access="IS_AUTHENTICATED_ANONYMOUSLY" /&gt; &lt;intercept-url pattern="/admin" access="ROLE_ADMIN"/&gt; &lt;intercept-url pattern="/**" access="ROLE_USER"/&gt; &lt;form-login login-page="/login"/&gt; &lt;custom-filter ref="loginfilter" before="FORM_LOGIN_FILTER" /&gt; &lt;/http&gt; &lt;b:bean id="loginfilter" class="spring.security.web.MrbirdUsernamePasswordAuthenticationFilter"&gt; &lt;b:property name="filterProcessesUrl" value="/j_spring_security_check"/&gt; &lt;!-- ç™»å…¥é¡µé¢form mothed å¿…é¡»æ˜¯post --&gt; &lt;b:property name="postOnly" value="true"/&gt; &lt;b:property name="authenticationManager" ref="authenticationManager" /&gt; &lt;b:property name="continueChainBeforeSuccessfulAuthentication" value="false"/&gt; &lt;/b:bean&gt; &lt;user-service id="user_service"&gt; &lt;user name="admin" password="123456" authorities="ROLE_USER,ROLE_ADMIN"/&gt; &lt;user name="user" password="123456" authorities="ROLE_USER"/&gt; &lt;/user-service&gt; &lt;authentication-manager alias="authenticationManager"&gt; &lt;authentication-provider user-service-ref="user_service"/&gt; &lt;/authentication-manager&gt;&lt;/b:beans&gt;ä¸Šè¿°é…ç½®ä¸­ä¸»è¦å¹²äº†å‡ ä»¶äº‹ï¼š1.å£°æ˜Žåœ¨xml ä¸­ä½¿ç”¨Spring Security æä¾›çš„å‘½åç©ºé—´xmlns=â€http://www.springframework.org/schema/security&quot;ã€‚2.è®¾ç½®ä¸€äº›å…éªŒè¯èµ„æºæˆ–è€…è·¯å¾„ã€‚3.åˆ©ç”¨intercept-urlæ¥åˆ¤æ–­ç”¨æˆ·éœ€è¦å…·æœ‰ä½•ç§æƒé™æ‰èƒ½è®¿é—®å¯¹åº”çš„urlèµ„æºï¼Œå¯ä»¥åœ¨patternä¸­æŒ‡å®šä¸€ä¸ªç‰¹å®šçš„urlèµ„æºï¼ŒaccessæŒ‡æ˜Žéœ€è¦çš„æƒé™ã€‚æ¯”å¦‚url â€œ/adminâ€ å¿…é¡»æ‹¥æœ‰ROLE_ADMINçš„ç”¨æˆ·æ‰èƒ½è®¿é—®ã€‚åœ¨å®žé™…ä½¿ç”¨ä¸­ï¼ŒSpring Securityé‡‡ç”¨çš„æ˜¯ä¸€ç§å°±è¿‘åŽŸåˆ™ï¼Œå°±æ˜¯è¯´å½“ç”¨æˆ·è®¿ é—®çš„url èµ„æºæ»¡è¶³å¤šä¸ªintercepter-url æ—¶ï¼Œç³»ç»Ÿå°†ä½¿ç”¨ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„ intercept-url è¿›è¡Œæƒé™æŽ§åˆ¶ã€‚4.access=&quot;IS_AUTHENTICATED_ANONYMOUSLY&quot;æŒ‡å®šåŒ¿åç”¨æˆ·ä¹Ÿå¯ä»¥è®¿é—®ã€‚5.&lt;form-login/&gt;æ ‡ç­¾çš„login-page=â€/loginâ€å±žæ€§è¡¨ç¤ºç™»å½•é¡µé¢çš„è¯·æ±‚ï¼Œç”±æŽ§åˆ¶å™¨åŽ»å¤„ç†ã€‚6.&lt;custom-filter/&gt;æ ‡ç­¾å¼•ç”¨äº†ä¸€ä¸ªåä¸ºloginfilterçš„è¿‡æ»¤å™¨ï¼Œç”¨äºŽç™»å½•çš„æ—¶å€™è¿›è¡ŒéªŒè¯ã€‚7.æŽ¥ä¸‹æ¥å®šä¹‰äº†idä¸ºloginfilterçš„beanï¼Œå…¶filterProcessesUrlè®¾å®šäº†ç™»å½•é¡µè¡¨å•æäº¤æ—¶çš„è¯·æ±‚ï¼›authenticationManagerå±žæ€§æŒ‡å‘authenticationManagerã€‚è¯¥beanå¯¹åº”çš„ç±»ä¸‹æ–‡å†åšä»‹ç»ã€‚8.user-serviceä¸­å®šä¹‰äº†ä¸¤ä¸ªç”¨æˆ·ï¼Œadmin å’Œuserï¼Œpasswordå±žæ€§å®šä¹‰å…¶å¯†ç ï¼Œauthoritieså±žæ€§ä¸ºå…¶åˆ†é…æƒé™ã€‚9.&lt;authentication-manager/&gt;æ ‡ç­¾æ³¨å†Œäº†ä¸€ä¸ªè®¤è¯ç®¡ç†å™¨ï¼Œå¹¶é€šè¿‡ &lt;authentication-provider/&gt;æ ‡ç­¾çš„user-service-refå±žæ€§å°†ä¹‹å‰å®šä¹‰çš„ç”¨æˆ·è£…é…èµ·æ¥ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨SpELè¡¨è¾¾å¼è¿›è¡Œurlçš„æ‹¦æˆªã€‚å¯ç”¨SpELå¯ç”¨SpELï¼š123&lt;http auto-config="true" use-expressions="true"&gt; ...&lt;/http&gt;Spring Securityæ”¯æŒçš„æ‰€æœ‰SpELè¡¨è¾¾å¼å¦‚ä¸‹ï¼šå®‰å…¨è¡¨è¾¾å¼è®¡ç®—ç»“æžœauthenticationç”¨æˆ·çš„è®¤è¯å¯¹è±¡denyAllç»“æžœå§‹ç»ˆä¸ºfalsehasAnyRole(list of&nbsp;roles)å¦‚æžœç”¨æˆ·è¢«æŽˆäºˆäº†åˆ—è¡¨ä¸­ä»»æ„çš„æŒ‡å®šè§’è‰²ï¼Œç»“æžœä¸ºtruehasRole(role)å¦‚æžœç”¨æˆ·è¢«æŽˆäºˆäº†æŒ‡å®šçš„è§’è‰²ï¼Œç»“æžœä¸ºtruehasIpAddress(IP Address)å¦‚æžœè¯·æ±‚æ¥è‡ªæŒ‡å®šIPçš„è¯ï¼Œç»“æžœä¸ºtrueisAnonymous()å¦‚æžœå½“å‰ç”¨æˆ·ä¸ºåŒ¿åç”¨æˆ·ï¼Œç»“æžœä¸ºtrueisAuthenticated()å¦‚æžœå½“å‰ç”¨æˆ·è¿›è¡Œäº†è®¤è¯çš„è¯ï¼Œç»“æžœä¸ºtrueisFullyAuthenticated()å¦‚æžœå½“å‰ç”¨æˆ·è¿›è¡Œäº†å®Œæ•´è®¤è¯çš„è¯ï¼ˆä¸æ˜¯é€šè¿‡Remember-meåŠŸèƒ½è¿›è¡Œçš„è®¤ è¯ï¼‰ï¼Œç»“æžœä¸ºtrueisRememberMe()å¦‚æžœå½“å‰ç”¨æˆ·æ˜¯é€šè¿‡Remember-meè‡ªåŠ¨è®¤è¯çš„ï¼Œç»“æžœä¸ºtruepermitAllç»“æžœå§‹ç»ˆä¸ºtrueprincipalç”¨æˆ·çš„principalå¯¹è±¡ä½¿ç”¨SpELæ”¹å†™çš„accesså±žæ€§ï¼š123456&lt;http auto-config="true" access-denied-page="/deny" use-expressions="true"&gt; &lt;intercept-url pattern="/login" access="permitAll" /&gt; &lt;intercept-url pattern="/admin" access="hasRole('ROLE_ADMIN')"/&gt; &lt;intercept-url pattern="/**" access="hasRole('ROLE_USER')"/&gt; ...&lt;/http&gt;æŽ¥ä¸‹æ¥è‡ªå·±ç¼–å†™ä¸ªç™»å½•é¡µã€‚è‡ªå®šä¹‰ç™»å½•é¡µlogin.jspå¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172&lt;%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%&gt;&lt;%@ taglib uri="http://www.springframework.org/tags" prefix="s" %&gt;&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;&lt;html&gt;&lt;head&gt; &lt;meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/&gt; &lt;title&gt;login page&lt;/title&gt; &lt;link href="&lt;c:url value='/css/bootstrap.min.css'/&gt;" rel="stylesheet" type="text/css"&gt; &lt;link href="&lt;c:url value='/css/bootstrap-theme.min.css'/&gt;" rel="stylesheet" type="text/css"&gt; &lt;link href="&lt;c:url value='/css/templatemo_style.css'/&gt;" rel="stylesheet" type="text/css"&gt; &lt;/head&gt;&lt;body class="templatemo-bg-gray"&gt;&lt;div class="container"&gt; &lt;div class="col-md-12"&gt; &lt;h1 class="margin-bottom-15"&gt;Login Page&lt;/h1&gt; &lt;form action="&lt;s:url value='/j_spring_security_check'/&gt;" class="form-horizontal templatemo-container templatemo-login-form-1 margin-bottom-30" role="form" method="post"&gt; &lt;div class="form-group"&gt; &lt;div class="col-xs-12"&gt; &lt;div class="control-wrapper"&gt; &lt;span class="form-text"&gt;username&lt;/span&gt; &lt;input type="text" class="form-control" name="j_username"/&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;div class="col-md-12"&gt; &lt;div class="control-wrapper"&gt; &lt;span class="form-text"&gt;password&lt;/span&gt; &lt;input type="password" class="form-control" name="j_password"&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;div class="col-md-12"&gt; &lt;div class="control-wrapper"&gt; &lt;span class="form-text"&gt;validateCode&lt;/span&gt; &lt;input type="password" class="form-control" name="validateCode"&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="form-group"&gt; &lt;div class="col-md-12"&gt; &lt;div class="control-wrapper"&gt; &lt;input type="submit" value="Log in" class="btn btn-info"&gt; &lt;input type="reset" value="Reset" class="btn btn-info"&gt; &lt;img id="checkCodeImg" title="éªŒè¯ç ä¸åŒºåˆ†å¤§å°å†™" src="checkCode" onclick="changeValidateCode()" style="cursor: pointer;"&gt; &lt;a href="javascript:;" onclick="changeValidateCode()"&gt;çœ‹ä¸æ¸…ï¼Ÿ&lt;/a&gt; &lt;span class="form-error"&gt; $&#123;sessionScope['SPRING_SECURITY_LAST_EXCEPTION'].message&#125; &lt;/span&gt; &lt;span class="form-error"&gt; $&#123;SPRING_SECURITY_403_EXCEPTION.message&#125; &lt;/span&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;script type="text/javascript"&gt; function changeValidateCode()&#123; document.getElementById("checkCodeImg").src = "checkCode"+ "?nocache=" + new Date().getTime(); &#125; &lt;/script&gt;&lt;/html&gt;ä¸ŽSpring Securityç›¸å…³çš„å°±å‡ ä¸ªï¼š1./j_spring_security_checkï¼Œæäº¤ç™»å½•ä¿¡æ¯çš„URLåœ°å€ã€‚2.j_usernameï¼Œè¾“å…¥ç™»å½•åçš„å‚æ•°åç§°ã€‚3.j_passwordï¼Œè¾“å…¥å¯†ç çš„å‚æ•°åç§°ã€‚4.${sessionScope[&#39;SPRING_SECURITY_LAST_EXCEPTION&#39;].message}å’Œ${SPRING_SECURITY_403_EXCEPTION.message}ç”¨äºŽè¾“å‡ºç™»å½•å¤±è´¥çš„å¼‚å¸¸ä¿¡æ¯ã€‚login.jspé¡µé¢å°¾éƒ¨æ·»åŠ äº†éªŒè¯ç éªŒè¯ã€‚éªŒè¯ç å¯¹åº”çš„controllerå¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091@Controllerpublic class CodeController &#123; @RequestMapping(value="/checkCode") public void createCheckCode(HttpServletRequest request, HttpServletResponse response) throws IOException&#123; //è®¾ç½®ä¸ç¼“å­˜å›¾ç‰‡ response.setHeader("Pragma", "No-cache"); response.setHeader("Cache-Control", "No-cache"); response.setDateHeader("Expires", 0); //æŒ‡å®šç”Ÿæˆçš„å“åº”ç±»åž‹åŠæ ¼å¼-å›¾ç‰‡jpg response.setContentType("image/jpeg"); //æŒ‡å®šç”ŸæˆéªŒè¯ç çš„å®½åº¦å’Œé«˜åº¦ int width=66,height=30; //åˆ›å»ºBufferedImageå¯¹è±¡,å…¶ä½œç”¨ç›¸å½“äºŽä¸€å›¾ç‰‡ BufferedImage image=new BufferedImage(width,height,BufferedImage.TYPE_INT_RGB); //åˆ›å»ºGraphicså¯¹è±¡,å…¶ä½œç”¨ç›¸å½“äºŽç”»ç¬” Graphics g=image.getGraphics(); //åˆ›å»ºGrapchics2Då¯¹è±¡ Graphics2D g2d=(Graphics2D)g; Random random=new Random(); //å®šä¹‰å­—ä½“æ ·å¼ Font mfont=new Font("æ¥·ä½“",Font.BOLD,20); g.setColor(getRandColor(200,250)); //ç»˜åˆ¶èƒŒæ™¯ g.fillRect(0, 0, width, height); //è®¾ç½®å­—ä½“ g.setFont(mfont); g.setColor(getRandColor(180,200)); //ç»˜åˆ¶20æ¡é¢œè‰²å’Œä½ç½®å…¨éƒ¨ä¸ºéšæœºäº§ç”Ÿçš„çº¿æ¡,è¯¥çº¿æ¡ä¸º2f for(int i=0;i&lt;20;i++)&#123; int x=random.nextInt(width-1); int y=random.nextInt(height-1); int x1=random.nextInt(6)+1; int y1=random.nextInt(12)+1; //å®šåˆ¶çº¿æ¡æ ·å¼ BasicStroke bs=new BasicStroke(2f,BasicStroke.CAP_BUTT, BasicStroke.JOIN_BEVEL); Line2D line=new Line2D.Double(x,y,x+x1,y+y1); g2d.setStroke(bs); //ç»˜åˆ¶ç›´çº¿ g2d.draw(line); &#125; String sRand=""; String ctmp=""; String[] rBase=&#123;"1","2","3","4","5","6","7","8","9", "a","b","c","d","e","f","g", "h","i","j","k", "m","n", "o","p","q", "r","s","t", "u","v","w", "x","y","z", "A","B","C","D","E","F","G", "H", "J","K","L","M","N", "O","P","Q", "R","S","T", "U","V","W", "X","Y","Z"&#125;; //åˆ¶å®šè¾“å‡ºçš„éªŒè¯ç ä¸ºå››ä½ for(int i=0;i&lt;4;i++)&#123; int index = random.nextInt(rBase.length-1); ctmp = rBase[index]; sRand+=ctmp; Color color=new Color(20+random.nextInt(110),20+random.nextInt(110), random.nextInt(110)); g.setColor(color); /*å°†æ–‡å­—æ—‹è½¬åˆ¶å®šè§’åº¦*/ Graphics2D g2d_word=(Graphics2D)g; AffineTransform trans=new AffineTransform(); //trans.rotate((45)*3.14/180,15*i+8,7); /*ç¼©æ”¾æ–‡å­—*/ float scaleSize=random.nextFloat()+0.8f; if(scaleSize&gt;1f) scaleSize=1f; trans.scale(scaleSize, scaleSize); g2d_word.setTransform(trans); g.drawString(ctmp, 12*i+12, 22); &#125; HttpSession session=request.getSession(true); session.setAttribute("validateCode", sRand); //é‡Šæ”¾gæ‰€å ç”¨çš„ç³»ç»Ÿèµ„æº g.dispose(); //è¾“å‡ºå›¾ç‰‡ ImageIO.write(image,"JPEG",response.getOutputStream()); &#125; /*è¯¥æ–¹æ³•ä¸»è¦ä½œç”¨æ˜¯èŽ·å¾—éšæœºç”Ÿæˆçš„é¢œè‰²*/ public Color getRandColor(int s,int e)&#123; Random random=new Random (); if(s&gt;255) s=255; if(e&gt;255) e=255; int r,g,b; r=s+random.nextInt(e-s); g=s+random.nextInt(e-s); b=s+random.nextInt(e-s); return new Color(r,g,b); &#125; &#125;æŽ¥ä¸‹æ¥ç¼–å†™index.jspï¼ŒæˆåŠŸç™»å½•åŽè·³è½¬åˆ°è¯¥é¡µé¢ï¼š12345678910111213141516171819&lt;%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec" %&gt;&lt;%@ taglib uri="http://www.springframework.org/tags" prefix="s" %&gt;&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;&lt;html&gt;&lt;head&gt; &lt;meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/&gt; &lt;title&gt;index page&lt;/title&gt; &lt;link href="&lt;c:url value='/css/templatemo_style.css'/&gt;" rel="stylesheet" type="text/css"&gt; &lt;/head&gt;&lt;body class="templatemo-bg-gray"&gt; &lt;div class="index-div"&gt; &lt;span class="index-text"&gt;hello:&lt;sec:authentication property="name"/&gt;&lt;/span&gt;&lt;br/&gt; &lt;hr&gt; &lt;a href="&lt;s:url value='/admin'/&gt;"&gt;admin.jsp&lt;/a&gt; &lt;a href="j_spring_security_logout"&gt;logout&lt;/a&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;ç¼–å†™admin.jspç”¨äºŽæµ‹è¯•æƒé™æŽ§åˆ¶ï¼š1234567891011121314&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;&lt;html&gt;&lt;head&gt; &lt;meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/&gt; &lt;title&gt;admin page&lt;/title&gt; &lt;link href="&lt;c:url value='/css/templatemo_style.css'/&gt;" rel="stylesheet" type="text/css"&gt; &lt;/head&gt;&lt;body class="templatemo-bg-gray"&gt; &lt;div class="index-div"&gt; &lt;span class="index-text"&gt;welcome admin!&lt;/span&gt;&lt;br/&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;é¡µé¢è·³è½¬controllerï¼š123456789101112131415161718import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping; @Controllerpublic class LoginController &#123; @RequestMapping(value="/login") public String login()&#123; return "login"; &#125; @RequestMapping(value="/admin") public String admin()&#123; return "admin"; &#125; @RequestMapping(value="/index") public String index()&#123; return "index"; &#125;&#125;å¤„ç†ç™»å½•åœ¨spring-security.xmlæ–‡ä»¶ä¸­å®šä¹‰çš„loginfilterè¿‡æ»¤å™¨å¯¹åº”çš„ç±»å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession; import org.springframework.security.authentication.AuthenticationServiceException;import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;import org.springframework.security.core.Authentication;import org.springframework.security.core.AuthenticationException;import org.springframework.security.web.authentication .UsernamePasswordAuthenticationFilter;import org.springframework.util.StringUtils; public class MrbirdUsernamePasswordAuthenticationFilter extends UsernamePasswordAuthenticationFilter&#123; private boolean postOnly = true; public static final String VALIDATE_CODE = "validateCode"; public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) throws AuthenticationException &#123; if (postOnly &amp;&amp; !request.getMethod().equals("POST")) &#123; throw new AuthenticationServiceException( "Authentication method not supported: " + request.getMethod()); &#125; //èŽ·å–è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç  String username = obtainUsername(request); String password = obtainPassword(request); //æ ¡éªŒ if (username == null || StringUtils.isEmpty(username.trim())) &#123; //æ ¡éªŒä¸é€šè¿‡æ—¶æŠ›å‡ºç›¸åº”çš„å¼‚å¸¸ throw new AuthenticationServiceException( messages.getMessage("Auth.usernameIsNull")); &#125; if (password == null || StringUtils.isEmpty(password.trim())) &#123; throw new AuthenticationServiceException( messages.getMessage("Auth.passwordIsNull")); &#125; //æ ¡éªŒéªŒè¯ç  checkValidateCode(request); username = username.trim(); UsernamePasswordAuthenticationToken authRequest = new UsernamePasswordAuthenticationToken(username, password); setDetails(request, authRequest); //ä¸åšç”¨æˆ·çš„éªŒè¯å·¥ä½œï¼Œå› ä¸ºåœ¨org.springframework.security.web.access //.intercept.FilterSecurityInterceptorä¸­ä¼šåšéªŒè¯ã€‚ä¸éœ€è¦é‡å¤éªŒè¯ã€‚ return this.getAuthenticationManager().authenticate(authRequest); &#125; protected void checkValidateCode(HttpServletRequest request) &#123; HttpSession session = request.getSession(); String sessionValidateCode = obtainSessionValidateCode(session); //è®©ä¸Šä¸€æ¬¡çš„éªŒè¯ç å¤±æ•ˆ session.setAttribute(VALIDATE_CODE, null); String validateCodeParameter = obtainValidateCodeParameter(request); if (StringUtils.isEmpty(validateCodeParameter) || !sessionValidateCode.equalsIgnoreCase(validateCodeParameter)) &#123; throw new AuthenticationServiceException("éªŒè¯ç é”™è¯¯ï¼"); &#125; &#125; private String obtainValidateCodeParameter(HttpServletRequest request) &#123; Object obj = request.getParameter(VALIDATE_CODE); return null == obj ? "" : obj.toString().toLowerCase(); &#125; protected String obtainSessionValidateCode(HttpSession session) &#123; Object obj = session.getAttribute(VALIDATE_CODE); return null == obj ? "" : obj.toString().toLowerCase(); &#125; &#125;MrbirdUsernamePasswordAuthenticationFilterç»§æ‰¿è‡ªUsernamePasswordAuthenticationFilterï¼Œä¸»è¦å·¥ä½œæ˜¯èŽ·å–ç”¨æˆ·åœ¨ç™»å½•ç•Œé¢è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦ä¸ºç©ºï¼Œä»¥åŠåˆ¤æ–­éªŒè¯ç çš„æ­£ç¡®æ€§ã€‚UsernamePasswordAuthenticationToken ä¸­æœ‰2ä¸ªå‚æ•°Object principalï¼ˆä¸»è¦çš„èº«ä»½è®¤è¯ä¿¡æ¯ï¼‰ï¼ŒObject credentialsï¼ˆç”¨äºŽè¯æ˜Žprincipalæ˜¯æ­£ç¡®çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å¯†ç ï¼‰åœ¨ä¸€ä¸ªå¸¦æœ‰usernameå’Œpasswordçš„æƒé™è®¤è¯è¯·æ±‚ä¸­ï¼Œprincipalå°±ä¼šè¢«èµ‹å€¼usernameï¼Œcredentialså°±ä¼šè¢«èµ‹å€¼passwordã€‚æˆ‘ä»¬è¿˜å¯ä»¥åœ¨Spring Security.xmlä¸­çš„loginfilter beané…ç½®ç™»å½•æˆåŠŸä¸Žå¤±è´¥çš„è¿‡æ»¤å™¨ï¼š1234567891011121314151617181920&lt;b:bean id="loginfilter" class="spring.security.web.MrbirdUsernamePasswordAuthenticationFilter"&gt; ... &lt;!-- éªŒè¯æˆåŠŸåŽçš„å¤„ç†--&gt; &lt;b:property name="authenticationSuccessHandler" ref="authenticationSuccessHandler"/&gt; &lt;!-- éªŒè¯å¤±è´¥åŽçš„å¤„ç†--&gt; &lt;b:property name="authenticationFailureHandler" ref="authenticationFailureHandler"/&gt; ...&lt;/b:bean&gt;&lt;!-- ç™»å…¥ä¿¡æ¯éªŒè¯å¤±è´¥åŽï¼Œé€€å›žåˆ°ç™»å…¥é¡µé¢ --&gt;&lt;b:bean id="authenticationFailureHandler" class="org.springframework.security.web.authentication .SimpleUrlAuthenticationFailureHandler"&gt; &lt;b:property name="defaultFailureUrl" value="/login?error=true"/&gt; &lt;/b:bean&gt; &lt;!-- ç™»å…¥ä¿¡æ¯éªŒè¯æˆåŠŸåŽï¼Œç™»å…¥ç³»ç»Ÿä¸»é¡µ --&gt;&lt;b:bean id="authenticationSuccessHandler" class="spring.security.web.MrbirdLoginSuccessHandler"&gt; &lt;b:property name="defaultTargetUrl" value="/index"/&gt;&lt;/b:bean&gt;å…¶ä¸­ï¼ŒMrbirdLoginSuccessHandlerç”¨äºŽå¤„ç†ç™»å½•æˆåŠŸåŽçš„æ“ä½œï¼Œæ¯”å¦‚ç”Ÿæˆæ—¥å¿—ç­‰ï¼š1234567891011121314151617181920212223import java.io.IOException;import javax.servlet.ServletException;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse; import org.springframework.security.core.Authentication;import org.springframework.security.core.userdetails.User;import org.springframework.security.web.authentication .SavedRequestAwareAuthenticationSuccessHandler; public class MrbirdLoginSuccessHandler extends SavedRequestAwareAuthenticationSuccessHandler &#123; public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response,Authentication authentication) throws ServletException, IOException&#123; System.out.println("ç™»å½•æˆåŠŸï¼"); //èŽ·å–ç™»å½•äººä¿¡æ¯ User user = (User) authentication.getPrincipal(); System.out.println(user.getUsername()+user.getAuthorities()); //è·³è½¬åˆ°ä¸»é¡µé¢ super.onAuthenticationSuccess(request, response, authentication); &#125;&#125;å¤„ç†ç™»å‡ºåŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ç™»å‡ºè¿‡æ»¤å™¨ï¼Œåœ¨Spring Security.xmlä¸­çš„ä¸­é…ç½®ç™»å‡ºè¿‡æ»¤å™¨ï¼š12345678910&lt;http auto-config="true"&gt; ... &lt;logout invalidate-session="true" logout-url="/j_spring_security_logout" success-handler-ref="logoutSuccessHandler"/&gt; &lt;/http&gt; &lt;!-- ç™»å‡ºæˆåŠŸï¼Œå¤„ç†ç±» --&gt;&lt;b:bean id="logoutSuccessHandler" class="spring.security.web.MrbirdLogoutSuccessHandler"&gt; &lt;b:property name="defaultTargetUrl" value="/login"/&gt;&lt;/b:bean&gt;logoutSuccessHandlerå¯¹åº”çš„ç±»MrbirdLogoutSuccessHandlerï¼š12345678910111213141516171819202122232425import java.io.IOException;import javax.servlet.ServletException;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse; import org.springframework.security.core.Authentication;import org.springframework.security.core.userdetails.User;import org.springframework.security.web.authentication .AbstractAuthenticationTargetUrlRequestHandler;import org.springframework.security.web.authentication.logout .LogoutSuccessHandler; public class MrbirdLogoutSuccessHandler extends AbstractAuthenticationTargetUrlRequestHandler implements LogoutSuccessHandler&#123; public void onLogoutSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException, ServletException &#123; System.out.println("ç™»å‡ºæˆåŠŸï¼"); User user = (User) authentication.getPrincipal(); System.out.println(user.getUsername()+user.getAuthorities()); //è·³è½¬åˆ°ç™»å½•é¡µ super.handle(request, response, authentication); &#125;&#125;å¼‚å¸¸ä¿¡æ¯æœ¬åœ°åŒ–Spring Securityè‡ªå¸¦çš„å¼‚å¸¸ä¿¡æ¯æ˜¾ç¤ºæ˜¯çº¯è‹±æ–‡çš„ï¼Œä½†Spring Securityæ”¯æŒå¼‚å¸¸ä¿¡æ¯æœ¬åœ°åŒ–ï¼Œè¿™äº›ä¿¡æ¯åŒ…æ‹¬è®¤è¯å¤±è´¥ã€è®¿é—®è¢«æ‹’ç»ç­‰ã€‚åœ¨Spring Security.xmlä¸­é…ç½®ï¼š12345678910&lt;b:bean id="loginfilter" class="spring.security.web.MrbirdUsernamePasswordAuthenticationFilter"&gt; ... &lt;b:property name="messageSource" ref="messageSource"/&gt; &lt;/b:bean&gt;&lt;!-- å®šä¹‰ç™»å½•é¡µé¢å¼‚å¸¸ä¿¡æ¯çš„æœ¬åœ°åŒ– --&gt; &lt;b:bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource"&gt; &lt;b:property name="basename" value="classpath:messages_zh_CN"/&gt; &lt;/b:bean&gt;å…¶ä¸­ï¼Œmessages_zh_CN.propertiesé…ç½®å¦‚ä¸‹ï¼š123AbstractUserDetailsAuthenticationProvider.badCredentials=\u8D26\u53F7\u6216\u5BC6\u7801\u9519\u8BEFAuth.usernameIsNull=\u8D26\u53F7\u4E0D\u80FD\u4E3A\u7A7AAuth.passwordIsNull=\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7AAbstractUserDetailsAuthenticationProvider.badCredentialså®šä¹‰äº†è´¦æˆ·æˆ–å¯†ç ä¸åŒ¹é…æ—¶å€™çš„å¼‚å¸¸ä¿¡æ¯ï¼ŒAuth.usernameIsNullå’ŒAuth.passwordIsNullåˆ™æ˜¯MrbirdUsernamePasswordAuthenticationFilterä¸­æŠ›å‡ºçš„å¼‚å¸¸ã€‚è‡ªå®šä¹‰é™åˆ¶é¡µé¢å½“é¡µé¢å› ä¸ºç”¨æˆ·æƒé™ä¸è¶³è€Œå—é™çš„æ—¶å€™ï¼Œæ˜¾ç¤ºçš„æ˜¯403 Access is Deniedé¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰è¿™ä¸ªå—é™é¡µé¢ã€‚ä¿®æ”¹é…ç½®spring security.xmlæ–‡ä»¶çš„å…ƒç´ ï¼Œæ·»åŠ è‡ªå®šä¹‰è®¿é—®æ‹’ç»é¡µé¢çš„åœ°å€ï¼š123&lt;http auto-config="true" access-denied-page="/deny" &gt; ...&lt;/http&gt;åœ¨LoginControllerä¸­æ·»åŠ ï¼š12345...@RequestMapping(value="/deny")public String deny()&#123; return "deny";&#125;deny.jsp123456789101112131415&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;&lt;html&gt;&lt;head&gt; &lt;meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/&gt; &lt;title&gt;deny page&lt;/title&gt; &lt;link href="&lt;c:url value='/css/templatemo_style.css'/&gt;" rel="stylesheet" type="text/css"&gt; &lt;/head&gt;&lt;body class="templatemo-bg-gray"&gt; &lt;div class="index-div"&gt; &lt;span class="index-text-deny" style='color:#C7425C;font-size:28px;'&gt; sorry,Insufficient authority +_+ &lt;/span&gt;&lt;br/&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;æµ‹è¯•æœ€ç»ˆï¼Œå·¥ç¨‹çš„ç›®å½•ç»“æž„ä¸ºï¼šspring security.xmlæœ€ç»ˆé…ç½®å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;b:beans xmlns:b="http://www.springframework.org/schema/beans" xmlns="http://www.springframework.org/schema/security" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd"&gt; &lt;!-- è®¾ç½®å…éªŒè¯è·¯å¾„ --&gt; &lt;http pattern="/**/*.css" security="none"/&gt; &lt;http pattern="/**/*.jpg" security="none"/&gt; &lt;http pattern="/**/*.jpeg" security="none"/&gt; &lt;http pattern="/checkCode" security="none"/&gt; &lt;http auto-config="true" access-denied-page="/deny" use-expressions="true"&gt; &lt;intercept-url pattern="/login" access="permitAll" /&gt; &lt;intercept-url pattern="/admin" access="hasRole('ROLE_ADMIN')"/&gt; &lt;intercept-url pattern="/**" access="hasRole('ROLE_USER')"/&gt; &lt;form-login login-page="/login"/&gt; &lt;custom-filter ref="loginfilter" before="FORM_LOGIN_FILTER" /&gt; &lt;logout invalidate-session="true" logout-url="/j_spring_security_logout" success-handler-ref="logoutSuccessHandler"/&gt; &lt;/http&gt; &lt;b:bean id="loginfilter" class="spring.security.web.MrbirdUsernamePasswordAuthenticationFilter"&gt; &lt;b:property name="filterProcessesUrl" value="/j_spring_security_check"/&gt; &lt;!-- ç™»å…¥é¡µé¢form mothed å¿…é¡»æ˜¯post --&gt; &lt;b:property name="postOnly" value="true"/&gt; &lt;!-- æƒé™ç®¡ç†å™¨ --&gt; &lt;b:property name="authenticationManager" ref="authenticationManager" /&gt; &lt;b:property name="continueChainBeforeSuccessfulAuthentication" value="false"/&gt; &lt;!-- éªŒè¯æˆåŠŸåŽçš„å¤„ç†--&gt; &lt;b:property name="authenticationSuccessHandler" ref="authenticationSuccessHandler"/&gt; &lt;!-- éªŒè¯å¤±è´¥åŽçš„å¤„ç†--&gt; &lt;b:property name="authenticationFailureHandler" ref="authenticationFailureHandler"/&gt; &lt;b:property name="messageSource" ref="messageSource"/&gt; &lt;/b:bean&gt; &lt;!-- å®šä¹‰ç™»å½•é¡µé¢å¼‚å¸¸ä¿¡æ¯çš„æœ¬åœ°åŒ– --&gt; &lt;b:bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource"&gt; &lt;b:property name="basename" value="classpath:messages_zh_CN"/&gt; &lt;/b:bean&gt; &lt;!-- ç™»å…¥ä¿¡æ¯éªŒè¯å¤±è´¥åŽï¼Œé€€å›žåˆ°ç™»å…¥é¡µé¢ --&gt; &lt;b:bean id="authenticationFailureHandler" class="org.springframework.security.web.authentication .SimpleUrlAuthenticationFailureHandler"&gt; &lt;b:property name="defaultFailureUrl" value="/login?error=true"/&gt; &lt;/b:bean&gt; &lt;!-- ç™»å…¥ä¿¡æ¯éªŒè¯æˆåŠŸåŽï¼Œç™»å…¥ç³»ç»Ÿä¸»é¡µ --&gt; &lt;b:bean id="authenticationSuccessHandler" class="spring.security.web.MrbirdLoginSuccessHandler"&gt; &lt;b:property name="defaultTargetUrl" value="/index"/&gt; &lt;/b:bean&gt; &lt;!-- ç™»å‡ºæˆåŠŸï¼Œå¤„ç†ç±» --&gt; &lt;b:bean id="logoutSuccessHandler" class="spring.security.web.MrbirdLogoutSuccessHandler"&gt; &lt;b:property name="defaultTargetUrl" value="/login"/&gt; &lt;/b:bean&gt; &lt;user-service id="user_service"&gt; &lt;user name="admin" password="123456" authorities="ROLE_USER,ROLE_ADMIN"/&gt; &lt;user name="user" password="123456" authorities="ROLE_USER"/&gt; &lt;/user-service&gt; &lt;authentication-manager alias="authenticationManager"&gt; &lt;authentication-provider user-service-ref="user_service"/&gt; &lt;/authentication-manager&gt;&lt;/b:beans&gt;å¯åŠ¨å·¥ç¨‹ï¼Œè®¿é—®ï¼šhttp://localhost:8080/spring-security/loginå½“ç™»å½•å¤±è´¥æ—¶ï¼Œé¡µé¢å¦‚ä¸‹ï¼šadminæˆåŠŸç™»å½•åŽï¼šæŽ§åˆ¶å°è¾“å‡ºï¼š12ç™»å½•æˆåŠŸï¼admin[ROLE_ADMIN, ROLE_USER]ç‚¹å‡»admin.jspï¼šç‚¹å‡»logoutå›žåˆ°ç™»å½•é¡µé¢ï¼Œä½¿ç”¨userç™»å½•ï¼šç‚¹å‡»admin.jspï¼šè®¿é—®å—é™ã€‚source code]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Spring Security</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Carrying data across redirect requests]]></title>
    <url>%2FCarrying-data-across-redirect-requests.html</url>
    <content type="text"><![CDATA[é‡å®šå‘è¯·æ±‚ä¼ é€’æ•°æ®ä¸»è¦æœ‰URLå’Œflashä¸¤ç§æ–¹å¼ï¼šURL123456@RequestMapping(value="/redirect",method=RequestMethod.GET)public String redirect(Model model)&#123; model.addAttribute("name", "KangKang"); model.addAttribute("id", 1l); return "redirect:/index/redirect/&#123;name&#125;";&#125;é‡å®šå‘ URLè·¯å¾„å°†ä¼šæ˜¯â€œ/index/redirect/KangKang?id=1lâ€ã€‚é‡å®šå‘æ–¹æ³•ï¼š1234@RequestMapping(value="/redirect/&#123;name&#125;")public String getValue(@PathVariable String name,Long id)&#123; // do something&#125;é€šè¿‡æ–­ç‚¹ï¼Œå¯çœ‹åˆ°nameçš„å€¼ä¸ºKangKangï¼Œidä¸º1lã€‚flashURLåªèƒ½ä¼ é€’Stringç­‰ç®€å•ç±»åž‹å€¼ï¼Œè€Œflashåˆ™å¯ä¼ é€’Javaå¯¹è±¡ç­‰å¤æ‚çš„å€¼ã€‚Springæä¾›äº†é€šè¿‡RedirectAttributesè®¾ç½®flashå±žæ€§çš„æ–¹æ³•ï¼Œè¿™æ˜¯Spring 3.1å¼•å…¥çš„Model çš„ä¸€ä¸ªå­æŽ¥å£ã€‚RedirectAttributesæä¾›äº†Modelçš„æ‰€æœ‰åŠŸèƒ½ã€‚12345678@RequestMapping(value="/redirect",method=RequestMethod.GET)public String redirect(RedirectAttributes model)&#123; User user = new User(); user.setId(2l); user.setName("Jane"); model.addFlashAttribute(user); return "redirect:/index/redirect/flash";&#125;é‡å®šå‘æ–¹æ³•ï¼š1234@RequestMapping(value="/redirect/flash")public String getValue(Model model)&#123; return "testRedirect";&#125;testRedirect.jspé¡µé¢å¯ä»¥ç›´æŽ¥ç”¨ELè®¿é—®Userå¯¹è±¡ã€‚å¦‚æžœè¦åœ¨æ–¹æ³•ä¸­èŽ·å–Userå¯¹è±¡çš„å±žæ€§ï¼Œå¯ä»¥ä½¿ç”¨@ModelAttribute(â€œuserâ€)æ ‡ç­¾ã€‚]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring multipartä¸Šä¼ ä¸‹è½½]]></title>
    <url>%2FSpring-multipart%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD.html</url>
    <content type="text"><![CDATA[åŠ å…¥ä¾èµ–Apache Commons FileUploadï¼š12345&lt;dependency&gt; &lt;groupId&gt;commons-fileupload&lt;/groupId&gt; &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt; &lt;version&gt;1.3.1&lt;/version&gt;&lt;/dependency&gt;maven tomcatè®¾ç½®URIç¼–ç ä¸ºUTF-8ï¼š123456789&lt;plugin&gt; &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt; &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.1&lt;/version&gt; &lt;configuration&gt; &lt;uriEncoding&gt;UTF-8&lt;/uriEncoding&gt; &lt;port&gt;8080&lt;/port&gt; &lt;/configuration&gt;&lt;/plugin&gt;multipartè§£æžå™¨12345678&lt;bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver"&gt; &lt;property name="defaultEncoding" value="utf-8"/&gt; &lt;!-- å•ä½ä¸ºå­—èŠ‚,è¿™é‡Œä¸º100MB --&gt; &lt;property name="maxUploadSize" value="104857600"/&gt; &lt;!-- ä¸´æ—¶ç›®å½• --&gt; &lt;property name="uploadTempDir" value="/WEB-INF/temp"/&gt;&lt;/bean&gt;formè¡¨å•12345&lt;form action='&lt;s:url value="/upload"/&gt;' method="post" enctype="multipart/form-data"&gt; é€‰æ‹©æ–‡ä»¶:&lt;input type="file" name="upload"&gt; &lt;input type="submit" value="æäº¤"&gt; &lt;/form&gt;å¤„ç†multipartè¯·æ±‚123456789101112131415161718192021222324252627282930313233343536373839404142434445@Controller@RequestMapping("/")public class FileUploadController &#123; @RequestMapping(value="upload",method=RequestMethod.GET) public String upload() &#123; return "upload"; &#125; @RequestMapping(value="upload",method=RequestMethod.POST) //@RequestPart("upload")å¯¹äºŽinputæ¡†çš„nameå±žæ€§ public String processUpload(@RequestPart("upload") MultipartFile file, HttpServletRequest request,Model model) &#123; try&#123; if(file != null &amp;&amp; !file.isEmpty())&#123; // ä¿å­˜çš„æ–‡ä»¶åæœªUUID+ä¸Šä¼ æ–‡ä»¶åï¼Œå¹¶ä¸”è¿‡æ»¤æ–‡ä»¶åç‰¹æ®Šå­—ç¬¦ String fileName = makeFileName(StringFilter(file.getOriginalFilename())); String filePath = request.getSession().getServletContext() .getRealPath("/") + "/WEB-INF/upload/" + fileName; File uploadFile = new File(filePath); if(!uploadFile.exists())&#123; uploadFile.mkdirs(); &#125; // è½¬å­˜æ–‡ä»¶ file.transferTo(uploadFile); model.addAttribute("name",file.getOriginalFilename()); return "result"; &#125;else&#123; return "fail"; &#125; &#125;catch(Exception e)&#123; e.printStackTrace(); return "fail"; &#125; &#125; String makeFileName(String filename) &#123; return UUID.randomUUID().toString() + "_" + filename; &#125; String StringFilter(String str) throws PatternSyntaxException &#123; String regEx = "[`~!@#$%^&amp;*+=|&#123;&#125;':; ',//[//]&lt;&gt;/?~ï¼@#ï¿¥%â€¦â€¦&amp;*ï¼ˆï¼‰â€”â€”+|&#123;&#125;ã€ã€‘â€˜ï¼›ï¼šâ€â€œâ€™ã€‚ï¼Œã€ï¼Ÿ]"; Pattern p = Pattern.compile(regEx); Matcher m = p.matcher(str); return m.replaceAll("").trim(); &#125;&#125;å¤šæ–‡ä»¶ä¸Šä¼ çš„è¯ï¼Œåªéœ€å°†MultipartFile fileæ”¹ä¸ºMultipartFile[] filesï¼Œinputæ ‡ç­¾åŠ ä¸Šmultiple=â€multipleâ€å³å¯ã€‚å¤„ç†ä¸‹è½½å½“æ–‡ä»¶ä¸Šä¼ æˆåŠŸåŽï¼Œé¡µé¢è·³è½¬åˆ°result.jspï¼š12&lt;p&gt;ä¸Šä¼ æˆåŠŸ&lt;/p&gt;&lt;a href="&lt;s:url value='/download?fileName=$&#123;name &#125;'/&gt;"&gt;$&#123;name &#125;&lt;/a&gt;çŽ°å¤„ç†ä¸‹è½½è¯·æ±‚ï¼š123456789101112131415161718192021222324@RequestMapping(value="download") public void processDownload(String fileName,HttpServletResponse response, HttpServletRequest request) throws UnsupportedEncodingException&#123; String realFileName = fileName.substring(fileName.indexOf("_") + 1); try &#123; response.setCharacterEncoding("utf-8"); response.setContentType("multipart/form-data"); response.setHeader("Content-Disposition", "attachment;fileName=" + java.net.URLEncoder.encode(realFileName,"utf-8")); String filePath = request.getSession().getServletContext().getRealPath("/") + "WEB-INF/upload/" + fileName; InputStream inputStream = new FileInputStream(new File(filePath)); OutputStream os = response.getOutputStream(); byte[] b = new byte[2048]; int length; while ((length = inputStream.read(b)) &gt; 0) &#123; os.write(b, 0, length); &#125; os.close(); inputStream.close(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125;&#125;å¼‚æ­¥å¤„ç†å¼‚æ­¥å¤„ç†multipartå¯ä»¥ä½¿ç”¨jQuery.form.jsæ’ä»¶æ¥å®Œæˆï¼š12345678$("#form_id").ajaxSubmit(&#123; url: "url.do", type: "post", dataType: "json", success: function(r)&#123; // your code here. &#125;&#125;);formè¡¨å•ä»£ç ï¼š123&lt;form enctype="multipart/form-data"&gt; é€‰æ‹©æ–‡ä»¶:&lt;input type="file" name="upload"&gt; &lt;/form&gt;åŽç«¯ä»£ç ä¸å˜ã€‚]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Springä¸­ä½¿ç”¨Apache Tileså¸ƒå±€]]></title>
    <url>%2FSpring-Apache-Tiles.html</url>
    <content type="text"><![CDATA[å‡è®¾æˆ‘ä»¬æƒ³ä¸ºåº”ç”¨ä¸­çš„æ‰€æœ‰é¡µé¢å®šä¹‰ä¸€ä¸ªé€šç”¨çš„å¤´éƒ¨å’Œåº•éƒ¨ã€‚æœ€åŽŸå§‹çš„æ–¹å¼å°±æ˜¯æŸ¥æ‰¾æ¯ä¸ªJSPæ¨¡æ¿ï¼Œå¹¶ä¸ºå…¶æ·»åŠ å¤´éƒ¨å’Œåº•éƒ¨çš„HTMLã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•çš„æ‰©å±•æ€§å¹¶ä¸å¥½ï¼Œä¹Ÿéš¾ä»¥ç»´æŠ¤ã€‚æ›´å¥½çš„æ–¹å¼æ˜¯ä½¿ç”¨å¸ƒå±€å¼•æ“Žï¼Œå¦‚Apache Tilesï¼Œå®šä¹‰é€‚ç”¨äºŽæ‰€æœ‰é¡µé¢çš„é€šç”¨é¡µé¢å¸ƒå±€ã€‚Spring MVCä»¥è§†å›¾è§£æžå™¨çš„å½¢å¼ä¸ºApache Tilesæä¾›äº†æ”¯æŒã€‚é…ç½®Tilesè§†å›¾è§£æžå™¨é¦–å…ˆå¼•å…¥ä¾èµ–ï¼š123456789101112131415&lt;dependency&gt; &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt; &lt;artifactId&gt;tiles-jsp&lt;/artifactId&gt; &lt;version&gt;3.0.7&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt; &lt;artifactId&gt;tiles-core&lt;/artifactId&gt; &lt;version&gt;3.0.7&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.tiles&lt;/groupId&gt; &lt;artifactId&gt;tiles-api&lt;/artifactId&gt; &lt;version&gt;3.0.7&lt;/version&gt;&lt;/dependency&gt;é…ç½®ï¼š1234567891011121314&lt;!-- æŒ‡å®štiles.xml --&gt;&lt;bean id="tilesConfigurer" class="org.springframework.web.servlet.view.tiles3.TilesConfigurer"&gt; &lt;property name="definitions"&gt; &lt;list&gt; &lt;value&gt;/WEB-INF/views/tiles.xml&lt;/value&gt; &lt;/list&gt;&lt;/property&gt;&lt;/bean&gt;&lt;!-- ä»£æ›¿InternalResourceViewResolver --&gt;&lt;bean id="viewResolver" class="org.springframework.web.servlet.view.tiles3.TilesViewResolver"/&gt;&lt;!-- é…ç½®é™æ€èµ„æºè·¯å¾„ --&gt;&lt;mvc:resources location="/images/" mapping="/images/**"/&gt;tiles.xmlè§ä¸‹æ–‡ã€‚tiles.xml1234567891011121314151617181920&lt;?xml version="1.0" encoding="utf-8" ?&gt;&lt;!DOCTYPE tiles-definitions PUBLIC "-//Apache Software Foundation//DTD Tiles Configuration 3.0//EN" "http://tiles.apache.org/dtds/tiles-config_3_0.dtd"&gt;&lt;tiles-definitions&gt; &lt;!-- è®¾ç½®åŸºæœ¬tileï¼Œå®šä¹‰äº†header,body,footer --&gt; &lt;definition name="base" template="/WEB-INF/views/page.jsp"&gt; &lt;put-attribute name="header" value="/WEB-INF/views/header.jsp" /&gt; &lt;put-attribute name="footer" value="/WEB-INF/views/footer.jsp" /&gt; &lt;/definition&gt; &lt;!-- æ‹“å±•tileï¼Œnameå¯¹åº”controllerä¸­çš„è§†å›¾åï¼ŒbodyæŒ‡å®šé¡µé¢ä¸»ä½“å†…å®¹ --&gt; &lt;definition name="index" extends="base"&gt; &lt;put-attribute name="body" value="/WEB-INF/views/index.jsp" /&gt; &lt;/definition&gt; &lt;definition name="register" extends="base"&gt; &lt;put-attribute name="body" value="/WEB-INF/views/register.jsp" /&gt; &lt;/definition&gt; &lt;/tiles-definitions&gt;æ¯ä¸ªå…ƒç´ éƒ½å®šä¹‰äº†ä¸€ä¸ªTileï¼Œå®ƒæœ€ç»ˆå¼•ç”¨çš„æ˜¯ä¸€ä¸ªJSPæ¨¡æ¿ã€‚åä¸ºbaseçš„Tileä¸­ï¼Œæ¨¡æ¿ä¸ºpage.jspï¼Œè¿˜å®šä¹‰äº†é¡µé¦–å’Œé¡µè„šçš„æ¨¡æ¿JSPï¼šheader.jspï¼š1234567&lt;%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%&gt;&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;&lt;%@ taglib uri="http://www.springframework.org/tags" prefix="s" %&gt;&lt;a href="&lt;s:url value="/index/" /&gt;"&gt; &lt;img src='&lt;c:url value="/images/leanote.png"/&gt;' border="0"/&gt;&lt;/a&gt;footer.jspï¼š123&lt;%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%&gt;Copyright Â© Leanotepage.jspï¼š12345678910111213141516171819202122232425&lt;%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%&gt;&lt;%@ taglib uri="http://www.springframework.org/tags" prefix="s" %&gt;&lt;%@ taglib uri="http://tiles.apache.org/tags-tiles" prefix="t" %&gt;&lt;%@ page session="false" %&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;leanote èš‚èšç¬”è®°&lt;/title&gt; &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt; &lt;/head&gt; &lt;body&gt; &lt;!-- å¤´éƒ¨ --&gt; &lt;div id="header"&gt; &lt;t:insertAttribute name="header" /&gt; &lt;/div&gt; &lt;!-- ä¸»ä½“å†…å®¹ï¼Œå¯¹åº”tiles.xmlä¸­ç»§æ‰¿baseçš„Tile --&gt; &lt;div id="content"&gt; &lt;t:insertAttribute name="body" /&gt; &lt;/div&gt; &lt;!-- å°¾éƒ¨ --&gt; &lt;div id="footer"&gt; &lt;t:insertAttribute name="footer" /&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt;åä¸ºindexå’Œregisterçš„Tileå„è‡ªéƒ½ç»§æ‰¿äº†base Tileï¼Œè¿˜å®šä¹‰äº†bodyï¼Œåˆ†åˆ«å¼•ç”¨index.jspå’Œregister.jspï¼šindex.jspï¼š12345&lt;%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%&gt;&lt;p&gt;èš‚èšç¬”è®°ï¼Œæœ‰æžå®¢èŒƒçš„äº‘ç¬”è®°ï¼&lt;/p&gt;&lt;p&gt;å‰æ‰€æœªæœ‰çš„æ–‡æ¡£ä½“éªŒï¼Œè¿‘ä¹Žå®Œç¾Žçš„å¹³å°è¦†ç›–ï¼Œæ”¯æŒå›¢é˜ŸååŒï¼Œä¼ä¸šçº§ç§æœ‰äº‘&lt;/p&gt;&lt;p&gt;èš‚èšç¬”è®° = ç¬”è®° + åšå®¢ + åä½œ + ç§æœ‰äº‘&lt;/p&gt;register.jspï¼š1234567891011121314&lt;%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%&gt;&lt;%@ taglib uri="http://www.springframework.org/tags/form" prefix="sf" %&gt; &lt;h3&gt;æ³¨å†Œleanote&lt;/h3&gt;&lt;sf:form method="post" commandName="form" action="$&#123;pageContext.request.contextPath&#125;/register"&gt; &lt;sf:label path="name" cssErrorClass="error"&gt;ç”¨æˆ·åï¼š&lt;/sf:label&gt; &lt;sf:input path="name" cssErrorClass="error"/&gt; &lt;sf:errors path="name" cssClass="error"/&gt;&lt;br/&gt; é‚®ç®±ï¼š&lt;sf:input path="email"/&gt;&lt;sf:errors path="email" cssClass="error"/&gt;&lt;br/&gt; å¯†ç ï¼š&lt;sf:password path="password" /&gt;&lt;sf:errors path="password" cssClass="error"/&gt;&lt;br/&gt; &lt;input type="submit" value="æ³¨å†Œ" /&gt;&lt;/sf:form&gt;æµ‹è¯•è®¿é—®http://localhost:8080/spring/index/ï¼šè®¿é—®http://localhost:8080/spring/registerindex/å¯ä»¥çœ‹åˆ°ï¼Œå¤´éƒ¨å’Œå°¾éƒ¨æ˜¯å›ºå®šçš„ï¼Œå˜çš„åªæ˜¯bodyéƒ¨åˆ†ã€‚]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>Apache Tiles</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Springè¡¨å•æ ¡éªŒ]]></title>
    <url>%2FSpring%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C.html</url>
    <content type="text"><![CDATA[ä»ŽSpring 3.0å¼€å§‹ï¼ŒSpringå¯¹Javaæ ¡éªŒAPIï¼ˆJava Validation APIï¼Œåˆç§°JSR-303ï¼‰æä¾›äº†æ”¯æŒã€‚åœ¨Spring MVCä¸­è¦ä½¿ç”¨Javaæ ¡éªŒAPIçš„è¯ï¼Œå¹¶ä¸éœ€è¦ä»€ä¹ˆé¢å¤–çš„é…ç½®ã€‚åªè¦ä¿è¯åœ¨ç±»è·¯å¾„ä¸‹åŒ…å«è¿™ä¸ªJava APIçš„å®žçŽ°å³å¯ï¼Œæ¯”å¦‚Hibernate Validatorã€‚å¼•å…¥hibernate-validatorï¼š123456&lt;!-- https://mvnrepository.com/artifact/org.hibernate/hibernate-validator --&gt;&lt;dependency&gt; &lt;groupId&gt;org.hibernate&lt;/groupId&gt; &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt; &lt;version&gt;5.2.4.Final&lt;/version&gt;&lt;/dependency&gt;æ ¡éªŒæ³¨è§£æ‰€æœ‰çš„æ³¨è§£éƒ½ä½äºŽjavax.validation.constraintså’Œorg.hibernate.validator.constraintsåŒ…ä¸­ã€‚ä¸‹è¡¨åˆ—å‡ºäº†è¿™äº›æ ¡éªŒæ³¨è§£ã€‚æ³¨è§£æè¿°@Nullé™åˆ¶åªèƒ½ä¸ºnull@NotNullé™åˆ¶å¿…é¡»ä¸ä¸ºnull@AssertFalseé™åˆ¶å¿…é¡»ä¸ºfalse@AssertTrueé™åˆ¶å¿…é¡»ä¸ºtrue@DecimalMax(value)é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å¤§äºŽæŒ‡å®šå€¼çš„æ•°å­—@DecimalMin(value)é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å°äºŽæŒ‡å®šå€¼çš„æ•°å­—@Digits(integer,fraction)é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªå°æ•°ï¼Œä¸”æ•´æ•°éƒ¨åˆ†çš„ä½æ•°ä¸èƒ½è¶…è¿‡integerï¼Œ å°æ•°éƒ¨åˆ†çš„ä½æ•°ä¸èƒ½è¶…è¿‡fraction@Futureé™åˆ¶å¿…é¡»æ˜¯ä¸€ä¸ªå°†æ¥çš„æ—¥æœŸ@Pasté™åˆ¶å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡åŽ»çš„æ—¥æœŸ@Max(value)é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å¤§äºŽæŒ‡å®šå€¼çš„æ•°å­—@Min(value)é™åˆ¶å¿…é¡»ä¸ºä¸€ä¸ªä¸å°äºŽæŒ‡å®šå€¼çš„æ•°å­—@Pasté™åˆ¶å¿…é¡»æ˜¯ä¸€ä¸ªè¿‡åŽ»çš„æ—¥æœŸ@Pattern(value)é™åˆ¶å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼@Size(max,min)é™åˆ¶å­—ç¬¦é•¿åº¦å¿…é¡»åœ¨minåˆ°maxä¹‹é—´@SafeHtmlå­—ç¬¦ä¸²æ˜¯å®‰å…¨çš„html@URLå­—ç¬¦ä¸²æ˜¯åˆæ³•çš„URL@NotBlankå­—ç¬¦ä¸²å¿…é¡»æœ‰å­—ç¬¦@NotEmptyå­—ç¬¦ä¸²ä¸ä¸ºNULLï¼Œé›†åˆæœ‰å­—ç¬¦@AssertFalseå¿…é¡»æ˜¯false@AssertTrueå¿…é¡»æ˜¯trueä½¿ç”¨æ ¡éªŒæ³¨è§£é…ç½®å®žä½“ç±»æ–°å»ºä¸€ä¸ªè¡¨å•å®žä½“ç±»ï¼Œå¹¶åŠ ä¸Šæ³¨è§£ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041import javax.validation.constraints.NotNull;import javax.validation.constraints.Size;import org.hibernate.validator.constraints.Email; public class Form &#123; @NotNull @Size(min = 5, max = 16, message = "&#123;name.msg&#125;") private String name; @NotNull() @Email(message = "&#123;email.msg&#125;") private String email; @NotNull @Size(min = 5, max = 16, message = "&#123;password.msg&#125;") private String password; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public String getEmail() &#123; return email; &#125; public void setEmail(String email) &#123; this.email = email; &#125; public String getPassword() &#123; return password; &#125; public void setPassword(String password) &#123; this.password = password; &#125;&#125;messageå±žæ€§ç”¨äºŽæ·»åŠ å›½é™…åŒ–æ”¯æŒï¼ŒæŽ¥ä¸‹æ¥éœ€è¦åšçš„å°±æ˜¯åˆ›å»ºä¸€ä¸ªåä¸ºValidationMessages.propertiesçš„æ–‡ä»¶ï¼ˆé»˜è®¤å«è¿™ä¸ªï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œæ”¾åœ¨src/main/resourcesè·¯å¾„ä¸‹ï¼‰ï¼š123name.msg=\u7528\u6237\u540D\u957F\u5EA6\u4E3A&#123;min&#125;\u5230&#123;max&#125;\u4E2A\u5B57\u7B26password.msg=\u5BC6\u7801\u957F\u5EA6\u4E3A&#123;min&#125;\u5230&#123;max&#125;\u4E2A\u5B57\u7B26email.msg=\u90AE\u7BB1\u683C\u5F0F\u4E0D\u5408\u6CD5ValidationMessages.propertiesæ–‡ä»¶ä¸­æ¯æ¡ä¿¡æ¯çš„keyå€¼å¯¹åº”äºŽæ³¨è§£ä¸­messageå±žæ€§å ä½ç¬¦çš„ å€¼ã€‚åŒæ—¶ï¼Œæœ€å°å’Œæœ€å¤§é•¿åº¦åœ¨ValidationMessages.propertiesæ–‡ä»¶ä¸­æœ‰è‡ªå·±çš„å ä½ç¬¦â€”â€”{min}å’Œ{max}â€”â€”å®ƒä»¬ä¼šå¼•ç”¨@Sizeæ³¨è§£ä¸Šæ‰€è®¾ç½®çš„minå’Œmaxå±žæ€§ã€‚è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™ä¸Šé¢çš„æ³¨è§£éƒ½æ˜¯è¾ƒä¸ºç®€å•çš„æ³¨è§£ï¼Œå®žé™…ç¼–ç¨‹ä¸­æ ¡éªŒçš„è§„åˆ™å¯èƒ½äº”èŠ±å…«é—¨ã€‚å½“è‡ªå¸¦çš„è¿™äº›æ³¨è§£æ— æ³•æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ ¡éªŒæ³¨è§£ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ ¡éªŒæ³¨è§£çš„åŸºæœ¬æ ¼å¼ï¼š1234567891011121314151617import javax.validation.Constraint;import java.lang.annotation.ElementType;import java.lang.annotation.Retention;import java.lang.annotation.RetentionPolicy;import java.lang.annotation.Target@Target(&#123;ElementType.FIELD, ElementType.METHOD&#125;)@Retention(RetentionPolicy.RUNTIME)@Constraint(validatedBy = MyConstraintValidator.class)public @interface MyConstraint &#123; String message(); Class&lt;?&gt;[] groups() default &#123;&#125;; Class&lt;? extends Payload&gt;[] payload() default &#123;&#125;;&#125;å…¶ä¸­@Constraintæ³¨è§£è¡¨æ˜Žè¿™ä¸ªæ³¨è§£æ˜¯ç”¨äºŽè§„åˆ™æ ¡éªŒçš„ï¼ŒvalidatedByå±žæ€§è¡¨æ˜Žç”¨ä»€ä¹ˆåŽ»æ ¡éªŒï¼Œè¿™é‡Œæˆ‘ä»¬æŒ‡å®šçš„ç±»ä¸ºMyConstraintValidatorã€‚æ³¨è§£è¿˜åŒ…å«äº†ä¸‰ä¸ªä¹¦å±žæ€§ï¼Œå±žæ€§messageæŒ‡å®šå½“æ ¡éªŒä¸é€šè¿‡çš„æ—¶å€™æç¤ºä»€ä¹ˆä¿¡æ¯ã€‚æŽ¥ä¸‹æ¥ç¼–å†™MyConstraintValidatorï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š12345678910111213141516import javax.validation.ConstraintValidator;import javax.validation.ConstraintValidatorContext;public class MyConstraintValidator implements ConstraintValidator&lt;MyConstraint, Object&gt; &#123; @Override public void initialize(MyConstraint myConstraint) &#123; System.out.println("my validator init"); &#125; @Override public boolean isValid(Object o, ConstraintValidatorContext constraintValidatorContext) &#123; System.out.println(o); return false; &#125;&#125;MyConstraintValidatorå®žçŽ°äº†ConstraintValidatoræŽ¥å£ï¼Œè¯¥æŽ¥å£å¿…é¡»æŒ‡å®šä¸¤ä¸ªæ³›åž‹ï¼Œç¬¬ä¸€ä¸ªæ³›åž‹æŒ‡çš„æ˜¯ä¸Šé¢å®šä¹‰çš„æ³¨è§£ç±»åž‹ï¼Œç¬¬äºŒä¸ªæ³›åž‹è¡¨ç¤ºæ ¡éªŒå¯¹è±¡çš„ç±»åž‹ã€‚MyConstraintValidatorå®žçŽ°äº†ConstraintValidatoræŽ¥å£çš„initializeæ–¹æ³•å’ŒisValidæ–¹æ³•ã€‚initializeæ–¹æ³•ç”¨äºŽè¯¥æ ¡éªŒåˆå§‹åŒ–çš„æ—¶å€™è¿›è¡Œä¸€äº›æ“ä½œï¼›isValidæ–¹æ³•ç”¨äºŽç¼–å†™æ ¡éªŒé€»è¾‘ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºéœ€è¦æ ¡éªŒçš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæ ¡éªŒä¸Šä¸‹æ–‡ã€‚Spring JSPåº“ä¸ºäº†ä½¿ç”¨Spring JSPåº“ï¼Œéœ€è¦åœ¨JSPé¡µé¦–åŠ å…¥ï¼š12&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;&lt;%@ taglib uri="http://www.springframework.org/tags/form" prefix="sf" %&gt;å¼•å…¥ä¾èµ–ï¼š123456&lt;!-- https://mvnrepository.com/artifact/jstl/jstl --&gt;&lt;dependency&gt; &lt;groupId&gt;jstl&lt;/groupId&gt; &lt;artifactId&gt;jstl&lt;/artifactId&gt; &lt;version&gt;1.2&lt;/version&gt;&lt;/dependency&gt;ç›¸å…³æ ‡ç­¾å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šJSPæ ‡ç­¾æè¿°&lt;sf:checkbox&gt;æ¸²æŸ“æˆä¸€ä¸ªHTML &lt;input&gt;æ ‡ç­¾ï¼Œå…¶ä¸­typeå±žæ€§è®¾ç½®ä¸ºcheckbox&lt;sf:checkboxes&gt;æ¸²æŸ“æˆå¤šä¸ªHTML &lt;input&gt;æ ‡ç­¾ï¼Œå…¶ä¸­typeå±žæ€§è®¾ç½®ä¸ºcheckbox&lt;sf:errors&gt;åœ¨ä¸€ä¸ªHTML &lt;span&gt;ä¸­æ¸²æŸ“è¾“å…¥åŸŸçš„é”™è¯¯&lt;sf:form&gt;æ¸²æŸ“æˆä¸€ä¸ªHTML &lt;form&gt;æ ‡ç­¾ï¼Œå¹¶ä¸ºå…¶å†…éƒ¨æ ‡ç­¾æš´éœ²ç»‘å®šè·¯å¾„ï¼Œç”¨äºŽæ•°æ®ç»‘å®š&lt;sf:hidden&gt;æ¸²æŸ“æˆä¸€ä¸ªHTML &lt;input&gt;æ ‡ç­¾ï¼Œå…¶ä¸­typeå±žæ€§è®¾ç½®ä¸ºhidden&lt;sf:input&gt;æ¸²æŸ“æˆä¸€ä¸ªHTML &lt;input&gt;æ ‡ç­¾ï¼Œå…¶ä¸­typeå±žæ€§è®¾ç½®ä¸ºtext&lt;sf:label&gt;æ¸²æŸ“æˆä¸€ä¸ªHTML &lt;label&gt;æ ‡ç­¾&lt;sf:option&gt;æ¸²æŸ“æˆä¸€ä¸ªHTML &lt;option&gt;æ ‡ç­¾ï¼Œå…¶selectedå±žæ€§æ ¹æ®æ‰€ç»‘å®šçš„å€¼è¿›è¡Œè®¾ç½®&lt;sf:options&gt;æŒ‰ç…§ç»‘å®šçš„é›†åˆã€æ•°ç»„æˆ–Mapï¼Œæ¸²æŸ“æˆä¸€ä¸ªHTML &lt;option&gt;æ ‡ç­¾çš„åˆ—è¡¨&lt;sf:password&gt;æ¸²æŸ“æˆä¸€ä¸ªHTML &lt;input&gt;æ ‡ç­¾ï¼Œå…¶ä¸­typeå±žæ€§è®¾ç½®ä¸ºpassword&lt;sf:radiobutton&gt;æ¸²æŸ“æˆä¸€ä¸ªHTML &lt;input&gt;æ ‡ç­¾ï¼Œå…¶ä¸­typeå±žæ€§è®¾ç½®ä¸ºradio&lt;sf:radiobuttons&gt;æ¸²æŸ“æˆå¤šä¸ªHTML &lt;input&gt;æ ‡ç­¾ï¼Œå…¶ä¸­typeå±žæ€§è®¾ç½®ä¸ºradio&lt;sf:select&gt;æ¸²æŸ“ä¸ºä¸€ä¸ªHTML &lt;select&gt;æ ‡ç­¾&lt;sf:textarea&gt;æ¸²æŸ“ä¸ºä¸€ä¸ªHTML &lt;textarea&gt;æ ‡ç­¾ç”¨Spring JSPæ ‡ç­¾åˆ›å»ºä¸€ä¸ªregister.jspï¼š123456789101112131415161718192021222324252627&lt;%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%&gt;&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;&lt;%@ taglib uri="http://www.springframework.org/tags/form" prefix="sf" %&gt;&lt;html&gt;&lt;head&gt; &lt;meta http-equiv="Content-Type" content="text/html;chartset=utf-8"&gt; &lt;title&gt;leanote èš‚èšç¬”è®°&lt;/title&gt;&lt;/head&gt;&lt;style&gt; input&#123;margin-top:5px;&#125; label.error&#123;color:red;&#125; span.error&#123;color:red;&#125; input.error&#123;border:1px solid red;&#125;&lt;/style&gt;&lt;body&gt; &lt;sf:form method="post" commanName="form" action="$&#123;pageContext.request.contextPath&#125;/register"&gt; &lt;sf:label path="name" cssErrorClass="error"&gt;ç”¨æˆ·åï¼š&lt;/sf:label&gt; &lt;sf:input path="name" cssErrorClass="error"/&gt; &lt;sf:errors path="name" cssClass="error"/&gt;&lt;br/&gt; é‚®ç®±ï¼š&lt;sf:input path="email"/&gt;&lt;sf:errors path="email" cssClass="error"/&gt;&lt;br/&gt; å¯†ç ï¼š&lt;sf:password path="password"/&gt;&lt;sf:errors path="password" cssClass="error"/&gt;&lt;br/&gt; &lt;input type="submit" value="æ³¨å†Œ"/&gt; &lt;/sf:form&gt;&lt;/body&gt;&lt;/html&gt;&lt;sf:form&gt;ä¼šæ¸²æŸ“ä¸ºä¸€ä¸ªHTML&lt;form&gt;æ ‡ç­¾ï¼Œä¹Ÿå¯ä»¥é€šè¿‡commandNameå±žæ€§æž„å»ºé’ˆå¯¹æŸä¸ªæ¨¡åž‹å¯¹è±¡çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚è¿™é‡Œè®¾ä¸ºformï¼ˆå¾…ä¼šåœ¨controllerä¸­ä¼ é€’åˆ°æ­¤é¡µé¢ï¼‰ã€‚cssClasså±žæ€§å¯ä»¥ç»™æ ‡ç­¾åŠ ä¸Šæ ·å¼Classï¼Œç”¨äºŽåœ¨CSSä¸­å¯¹å…¶é€‰ä¸­å¹¶ä¿®æ”¹æ ·å¼ã€‚pathå±žæ€§æŒ‡å‘å®žä½“ç±»formå¯¹åº”çš„å±žæ€§åç§°ã€‚å¦‚æžœå°†&lt;sf:errors/&gt;æ ‡ç­¾çš„pathå±žæ€§è®¾ç½®ä¸º*çš„è¯ï¼Œå…¶å°†æ˜¾ç¤ºæ‰€æœ‰ä¸æ»¡è¶³æ ¡éªŒçš„æç¤ºä¿¡æ¯ã€‚cssErrorClasså±žæ€§æŒ‡å®šæ ¡éªŒä¸é€šè¿‡æ—¶å€™é™¤äº†&lt;sf:errors/&gt;æ ‡ç­¾å¤–çš„æ ‡ç­¾æ ·å¼ã€‚ç¼–å†™controllerRegesteræŽ§åˆ¶å™¨å¦‚ä¸‹æ‰€ç¤ºï¼š123456789101112131415161718192021222324252627282930313233343536373839404142import javax.validation.Valid;import mrbird.mvc.entity.Form;import org.springframework.stereotype.Controller;import org.springframework.ui.Model;import org.springframework.validation.BindingResult;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod; @Controllerpublic class LeanoteController &#123; @RequestMapping(value = "/registerindex", method = RequestMethod.GET) public String register(Model model) &#123; //å¯¹åº”&lt;sf:form/&gt;æ ‡ç­¾çš„commandNameå±žæ€§å€¼ model.addAttribute(new Form()); return "register"; &#125; @RequestMapping(value = "/register", method = RequestMethod.POST) //formå‚æ•°æ·»åŠ äº†@Validæ³¨è§£ï¼Œè¿™ä¼šå‘ŠçŸ¥Springï¼Œéœ€è¦ç¡®ä¿è¿™ä¸ªå¯¹è±¡æ»¡è¶³æ ¡éªŒé™åˆ¶ã€‚ //Errorså‚æ•°è¦ç´§è·Ÿåœ¨å¸¦æœ‰@Validæ³¨è§£çš„å‚æ•°åŽé¢ public String submit(@Valid Form form, BindingResult result) &#123; if (result.hasErrors()) &#123; // è¾“å‡ºæ ¡éªŒå¤±è´¥ä¿¡æ¯ result.getAllErrors().stream().forEach(e -&gt; &#123; FieldError fieldError = (FieldError) e; System.out.println(((FieldError) e).getField() + " " + e.getDefaultMessage()); &#125; ); //å‡ºé”™æ—¶å›žåˆ°æ³¨å†Œé¡µé¢ï¼Œè¿™é‡Œä¸èƒ½å¤Ÿç”¨é‡å®šå‘ï¼Œä¸ç„¶çœ‹ä¸åˆ°é”™è¯¯æç¤ºä¿¡æ¯ return "register"; &#125; //æ ¡éªŒé€šè¿‡ï¼Œé‡å®šå‘åˆ°/success/&#123;name&#125; return "redirect:/success/" + form.getName(); &#125; @RequestMapping(value = "/success/&#123;name&#125;", method = RequestMethod.GET) public String success(@PathVariable String name, Model model) &#123; model.addAttribute(name); return "success"; &#125;&#125;éƒ¨ç½²é¡¹ç›®ï¼Œè®¿é—®ï¼šhttp://localhost:8080/spring/registerindexï¼š]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Springä¼ é€’å‚æ•°]]></title>
    <url>%2FSpring%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0.html</url>
    <content type="text"><![CDATA[æ€»ç»“ä¸‹å¹³æ—¶ä½¿ç”¨Springæ—¶ï¼ŒæœåŠ¡ç«¯æŽ¥æ”¶å®¢æˆ·ç«¯ä¼ é€’çš„å‚æ•°çš„å‡ ç§æ–¹å¼ã€‚åŒåå˜é‡åœ¨å®¢æˆ·ç«¯ï¼Œä½¿ç”¨GETè¯·æ±‚å‘é€ä¸€ä¸ªå˜é‡åˆ°æœåŠ¡ç«¯ï¼Œæ¯”å¦‚ä¼ é€’ä¸€ä¸ªtestParamå˜é‡ï¼š12345var testParam = 'mrbird';$.ajax(&#123; url:"$&#123;pageContext.request.contextPath&#125;/test?testParam="+testParam, method:"get"&#125;);æœåŠ¡ç«¯ï¼š12345678@Controller@RequestMapping(value="/test")public class TestContoller &#123; @RequestMapping(method=RequestMethod.GET) public void test(String testParam)&#123; &#125;&#125;ç”¨testParamåŒåå‚æ•°æŽ¥æ”¶ï¼Œé€šè¿‡æ–­ç‚¹ï¼Œå¾—åˆ°çš„å€¼ä¸ºmrbirdã€‚@requestParamå’Œç¬¬ä¸€ç§æ–¹æ³•ç±»ä¼¼ï¼Œåªä¸è¿‡ä½¿ç”¨@requestParamæ³¨è§£åŽï¼Œå˜é‡å¯ä»¥ä½¿ç”¨åˆ«çš„åå­—å‘½åï¼š12345678@Controller@RequestMapping(value="/test")public class TestContoller &#123; @RequestMapping(method=RequestMethod.GET) public void test(@RequestParam("testParam") String param)&#123; &#125;&#125;HttpServletRequesté€šè¿‡HttpServletRequestå¯¹è±¡èŽ·å–ï¼š12345678@Controller@RequestMapping(value="/test")public class TestContoller &#123; @RequestMapping(method=RequestMethod.GET) public void test(HttpServletRequest request)&#123; String param = request.getParameter("testParam"); &#125;&#125;POJOä½¿ç”¨POJOæŽ¥æ”¶å‚æ•°é€‚ç”¨äºŽå‚æ•°é‡è¾ƒå¤šçš„æ—¶å€™ï¼Œæ¯”æ–¹è¯´è¡¨å•æäº¤çš„æ—¶å€™ï¼Œä½†è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ç”¨testParamæ —å­æ¼”ç¤ºã€‚åˆ›å»ºä¸€ä¸ªç”¨äºŽæŽ¥æ”¶å‚æ•°çš„POJOï¼Œå¹¶å®šä¹‰å’Œä¼ é€’å‚æ•°åŒåçš„å±žæ€§ï¼š12345678910public class Params &#123; private String testParam; public String getTestParam() &#123; return testParam; &#125; public void setTestParam(String testParam) &#123; this.testParam = testParam; &#125;&#125;æœåŠ¡ç«¯ï¼š12345678@Controller@RequestMapping(value="/test")public class TestContoller &#123; @RequestMapping(method=RequestMethod.GET) public void test(Params param)&#123; String testParam = param.getTestParam(); &#125;&#125;å ä½ç¬¦æˆ‘ä»¬å°†GETè¯·æ±‚çš„URLæ”¹ä¸ºï¼š1url:"$&#123;pageContext.request.contextPath&#125;/test/"+testParam,å°†å‚æ•°é€šè¿‡URLè·¯å¾„è¿›è¡Œæ ‡è¯†ï¼Œè€Œä¸æ˜¯é€šè¿‡æŸ¥è¯¢å‚æ•°ã€‚ä¸ºäº†å®žçŽ°è¿™ç§è·¯å¾„å˜é‡ï¼ŒSpring MVCå…è®¸æˆ‘ä»¬åœ¨@RequestMappingè·¯å¾„ä¸­æ·»åŠ å ä½ç¬¦ã€‚å ä½ç¬¦çš„åç§°è¦ç”¨å¤§æ‹¬å·ï¼ˆâ€œ{â€å’Œâ€œ}â€ï¼‰æ‹¬èµ·æ¥ã€‚è·¯å¾„ä¸­çš„å…¶ä»–éƒ¨åˆ†è¦ä¸Žæ‰€å¤„ç†çš„è¯·æ±‚å®Œå…¨åŒ¹é…ï¼Œ ä½†æ˜¯å ä½ç¬¦éƒ¨åˆ†å¯ä»¥æ˜¯ä»»æ„çš„å€¼ã€‚ä¿®æ”¹controllerï¼š12345678@Controller@RequestMapping(value="/test")public class TestContoller &#123; @RequestMapping(value="&#123;testParam&#125;",method=RequestMethod.GET) public void test(@PathVariable String testParam)&#123; &#125;&#125;testæ–¹æ³•å‚æ•°åç§°å¿…é¡»å’Œå ä½ç¬¦åç§°ç›¸åŒã€‚]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ­å»ºSpringMVC]]></title>
    <url>%2F%E6%90%AD%E5%BB%BASpringMVC.html</url>
    <content type="text"><![CDATA[guideä¸‹å›¾å±•ç¤ºäº†è¯·æ±‚åœ¨Spring MVCä¸­çš„è¿‡ç¨‹ï¼šçŽ¯å¢ƒå‡†å¤‡ä½¿ç”¨Mavenæž„å»ºSpring web MVC projectã€‚æ–°å»ºMaven Projectï¼ˆé€‰ä¸­skip archetype selectionï¼‰:ç‚¹å‡»nextï¼Œç„¶åŽå¡«å†™Group Idå’ŒArtifact Idï¼Œæ‰“åŒ…æ–¹å¼ä¸ºwarï¼šfinishåŽï¼Œå³å‡»é¡¹ç›®ï¼Œé€‰æ‹©propertiesï¼Œé€‰ä¸­Deployment Assemblyï¼Œç§»é™¤é€‰ä¸­çš„è·¯å¾„ï¼šapplyåŽé€‰æ‹©Project Facetsï¼Œå‹¾é€‰Dynamic Web Moduleï¼Œç‚¹å‡»ä¸‹æ–¹çš„Further configuration avaiableï¼šå¦‚ä¸‹å¡«å†™åŽç¡®å®šå³å¯ï¼šå‡†å¤‡å¥½åŽï¼Œåœ¨pomä¸­å¼•å…¥ä¾èµ–ä»¥åŠé…ç½®tomcatæ’ä»¶ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;4.3.2.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.annotation&lt;/groupId&gt; &lt;artifactId&gt;jsr250-api&lt;/artifactId&gt; &lt;version&gt;1.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.inject&lt;/groupId&gt; &lt;artifactId&gt;javax.inject&lt;/artifactId&gt; &lt;version&gt;1&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;!-- å¸ƒç½®åˆ°tomcat --&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt; &lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt; &lt;version&gt;2.1&lt;/version&gt; &lt;configuration&gt; &lt;!--åœ¨è¿™é‡Œå®šä¹‰ç«¯å£å· --&gt; &lt;port&gt;8080&lt;/port&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt;XMLé…ç½®æ­å»ºweb.xmlä¸­é…ç½®DispatcherServletï¼š1234567891011121314&lt;!-- é…ç½®dispatcherServlet --&gt;&lt;servlet&gt; &lt;servlet-name&gt;mvc-xml&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;mvc-xml&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;é…ç½®applicationContext.xmlï¼š123456789101112131415161718192021222324&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:p="http://www.springframework.org/schema/p" xsi:schemaLocation=" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.3.xsd"&gt; &lt;!-- å¼€å¯ç»„ä»¶æ‰«æ --&gt; &lt;context:component-scan base-package="mrbird"/&gt; &lt;!-- å¯ç”¨Spring mvc --&gt; &lt;mvc:annotation-driven/&gt; &lt;!-- é…ç½®viewResolver --&gt; &lt;bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver" p:prefix="/WEB-INF/views/" p:suffix=".jsp"&gt; &lt;/bean&gt;&lt;/beans&gt;ç¼–å†™ä¸€ä¸ªæœ€ç®€å•çš„cotrollerï¼š1234567891011import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod; @Controllerpublic class IndexController &#123; @RequestMapping(value="/index",method=RequestMethod.GET) public String index()&#123; return "index"; &#125;&#125;ç¼–å†™ä¸€ä¸ªæœ€ç®€å•çš„é¡µé¢ï¼š12345678910111213&lt;%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%&gt;&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;&lt;title&gt;leanote èš‚èšç¬”è®°&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;èš‚èšç¬”è®°ï¼Œæœ‰æžå®¢èŒƒçš„äº‘ç¬”è®°ï¼&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œå¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®http://localhost:8080/mvc-xml/indexï¼šJavaConfigé…ç½®æ­å»ºé…ç½®DispatcherServletï¼š123456789101112131415161718import org.springframework.web.servlet.support .AbstractAnnotationConfigDispatcherServletInitializer; public class WebAppInitializer extends AbstractAnnotationConfigDispatcherServletInitializer&#123; @Override protected Class&lt;?&gt;[] getRootConfigClasses() &#123; return new Class&lt;?&gt;[]&#123;RootConfig.class&#125;; &#125; @Override protected Class&lt;?&gt;[] getServletConfigClasses() &#123; return new Class&lt;?&gt;[]&#123;WebConfig.class&#125;; &#125; @Override protected String[] getServletMappings() &#123; return new String[]&#123;"/"&#125;; &#125;&#125;WebConfigï¼š123456789101112131415161718192021@Configuration//å¼€å¯spring mvc@EnableWebMvc//å¼€å¯æ‰«æ@ComponentScan("mrbird")public class WebConfig extends WebMvcConfigurerAdapter&#123; //é…ç½®viewResolver @Bean public ViewResolver viewResolver()&#123; InternalResourceViewResolver resolver = new InternalResourceViewResolver(); resolver.setPrefix("/WEB-INF/views/"); resolver.setSuffix(".jsp"); resolver.setExposeContextBeansAsAttributes(true); return resolver; &#125; @Override public void configureDefaultServletHandling( DefaultServletHandlerConfigurer configurer)&#123; configurer.enable(); &#125;&#125;æ–°çš„WebConfigç±»è¿˜æ‰©å±•äº†WebMvcConfigurerAdapterå¹¶é‡å†™äº†å…¶configureDefaultServletHandling()æ–¹æ³•ã€‚é€šè¿‡è°ƒç”¨DefaultServletHandlerConfigurerçš„enable()æ–¹æ³•ï¼Œæˆ‘ä»¬è¦æ±‚DispatcherServletå°†å¯¹é™æ€èµ„æºçš„è¯·æ±‚è½¬å‘åˆ°Servletå®¹å™¨ä¸­é»˜è®¤çš„Servletä¸Šï¼Œè€Œä¸æ˜¯ä½¿ç”¨DispatcherServletæœ¬èº«æ¥å¤„ç†æ­¤ç±»è¯·æ±‚ã€‚RootConfigï¼š123456@Configuration@ComponentScan(basePackages=&#123;"mrbird"&#125;, excludeFilters=&#123;@Filter(type=FilterType.ANNOTATION,value=EnableWebMvc.class)&#125;)public class RootConfig &#123; &#125;Controllerå’ŒJSPé¡µé¢åŒä¸Šã€‚]]></content>
      <tags>
        <tag>Spring</tag>
        <tag>SpringMVC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Springæ³¨å…¥å¤–éƒ¨å€¼]]></title>
    <url>%2FSpring%E6%B3%A8%E5%85%A5%E5%A4%96%E9%83%A8%E5%80%BC.html</url>
    <content type="text"><![CDATA[Springæ³¨å…¥å¤–éƒ¨æ–‡ä»¶çš„å€¼æœ‰å‡ ç§æ–¹å¼ï¼šSpring Environmentåœ¨Springä¸­ï¼Œå¤„ç†å¤–éƒ¨å€¼çš„æœ€ç®€å•æ–¹å¼å°±æ˜¯å£°æ˜Žå±žæ€§æºå¹¶é€šè¿‡Springçš„Environmentæ¥æ£€ç´¢å±žæ€§ã€‚å£°æ˜Žä¸€ä¸ªPhoneæŽ¥å£ï¼š123public interface Phone &#123; public void phoneMsg();&#125;å®žçŽ°ç±»GooglePixelï¼š123456789101112131415public class GooglePixel implements Phone&#123; private String name; private String cpu; private String battery; public GooglePixel(String name, String cpu, String battery) &#123; this.name = name; this.cpu = cpu; this.battery = battery; &#125; public void phoneMsg() &#123; System.out.println(name+"ï¼Œcpuåž‹å·ï¼š"+cpu+"ï¼Œç”µæ± å®¹é‡ï¼š"+battery); &#125;&#125;åˆ›å»ºä¸€ä¸ªå¤–éƒ¨é…ç½®ç±»ï¼šgooglePixel.propertiesï¼š123phone.name=Google Pixelphone.battery=2770mAhphone.cpu=Qualcomm Xiaolong 821åœ¨JavaConfigä¸­åŠ è½½å¤–éƒ¨é…ç½®ï¼Œå¹¶ç”¨Springçš„Environmentå¯¹è±¡èŽ·å–ï¼š123456789101112131415161718192021import org.springframework.beans.factory.annotation.Autowired;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.context.annotation.PropertySource;import org.springframework.core.env.Environment; @Configuration//åŠ è½½å¤–éƒ¨é…ç½®æ–‡ä»¶@PropertySource("classpath:/mrbird/leanote/properties/googlePixel.properties")public class PhoneConfig &#123; //æ³¨å…¥SpringçŽ¯å¢ƒå¯¹è±¡ @Autowired private Environment env; @Bean(name="googlePixel") public Phone phone()&#123; return new GooglePixel( env.getProperty("phone.name"), env.getProperty("phone.cpu"), env.getProperty("phone.battery")); &#125;&#125;æµ‹è¯•æ˜¯å¦æ³¨å…¥æˆåŠŸï¼š1234567public class Test &#123; public static void main(String[] args) &#123; ApplicationContext ac = new AnnotationConfigApplicationContext(PhoneConfig.class); Phone googlePixel = (Phone) ac.getBean("googlePixel"); googlePixel.phoneMsg(); &#125;&#125;æŽ§åˆ¶å°è¾“å‡ºï¼š1Google Pixelï¼Œcpuåž‹å·ï¼šQualcomm Xiaolong 821ï¼Œç”µæ± å®¹é‡ï¼š2770mAhgetProperty()æ–¹æ³•å¹¶ä¸æ˜¯èŽ·å–å±žæ€§å€¼çš„å”¯ä¸€æ–¹æ³•ï¼ŒgetProperty()æ–¹æ³•æœ‰å››ä¸ªé‡è½½çš„å˜ç§å½¢å¼ï¼š1234String getProperty(String key)String getProperty(String key,String defaultValue)T getProperty(String key,Class&lt;T&gt; type)T getProperty(Stirng key,Class&lt;T&gt; type,T defaultValue)å‰ä¸¤ç§å½¢å¼çš„getProperty()æ–¹æ³•éƒ½ä¼šè¿”å›žStringç±»åž‹çš„å€¼ã€‚ä¸Šé¢çš„æ —å­ä½¿ç”¨ç¬¬ä¸€ç§getProperty()æ–¹æ³•ã€‚ç¨å¾®å¯¹@Beanæ–¹æ³•è¿›è¡Œä¸€ä¸‹ä¿®æ”¹ï¼Œè¿™æ ·åœ¨æŒ‡å®šå±žæ€§ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ä¸€ä¸ªé»˜è®¤å€¼ï¼š1234567@Bean(name="googlePixel") public Phone phone()&#123; return new GooglePixel( env.getProperty("phone.name","è°·æ­ŒPixel"), env.getProperty("phone.cpu","é«˜é€šæž­é¾™821"), env.getProperty("phone.battery","2770æ¯«å®‰æ—¶")); &#125;å‰©ä¸‹çš„ä¸¤ç§getProperty()æ–¹æ³•ä¸Žå‰é¢çš„ä¸¤ç§éžå¸¸ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒä»¬å¯ä»¥ä¼ å…¥ç±»åž‹ã€‚Environmentè¿˜æä¾›äº†å‡ ä¸ªä¸Žå±žæ€§ç›¸å…³çš„æ–¹æ³•ï¼Œå¦‚æžœä½ åœ¨ä½¿ç”¨getProperty()æ–¹æ³•çš„æ—¶å€™ æ²¡æœ‰æŒ‡å®šé»˜è®¤å€¼ï¼Œå¹¶ä¸”è¿™ä¸ªå±žæ€§æ²¡æœ‰å®šä¹‰çš„è¯ï¼ŒèŽ·å–åˆ°çš„å€¼æ˜¯nullã€‚å¦‚æžœä½ å¸Œæœ›è¿™ä¸ªå±žæ€§å¿…é¡»è¦å®šä¹‰ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨getRequiredProperty()æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š1234567@Bean(name="googlePixel") public Phone phone()&#123; return new GooglePixel( env.getRequiredProperty("phone.name"), env.getRequiredProperty("phone.cpu"), env.getRequiredProperty("phone.battery")); &#125;åœ¨è¿™é‡Œï¼Œå¦‚æžœphone.nameæˆ–phone.cpuæˆ–phone.batteryå±žæ€§æ²¡æœ‰å®šä¹‰çš„è¯ï¼Œå°†ä¼šæŠ›å‡º IllegalStateExceptionå¼‚å¸¸ã€‚å¦‚æžœæƒ³æ£€æŸ¥ä¸€ä¸‹æŸä¸ªå±žæ€§æ˜¯å¦å­˜åœ¨çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥è°ƒç”¨Environmentçš„ containsProperty()æ–¹æ³•ï¼š1boolean nameExists = env.containsProperty("phone.name");å±žæ€§å ä½ç¬¦åˆ›å»ºä¸€ä¸ªphone-config.xmlæ–‡ä»¶ï¼Œä½¿ç”¨Spring contextå‘½åç©ºé—´ä¸­çš„context:propertyplaceholderå…ƒç´ ç”ŸæˆPropertySourcesPlaceholderConfigurer beanï¼š1234567891011121314151617&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:c="http://www.springframework.org/schema/c" xmlns:context="http://www.springframework.org/schema/context" xmlns:util="http://www.springframework.org/schema/util" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd"&gt; &lt;context:property-placeholder location="classpath:/mrbird/leanote/properties/googlePixel.properties"/&gt; &lt;bean id="googlePixel" class="mrbird.leanote.javaconfig.GooglePixel" c:name="$&#123;phone.name&#125;" c:cpu="$&#123;phone.cpu&#125;" c:battery="$&#123;phone.battery&#125;"/&gt;&lt;/beans&gt;æµ‹è¯•ï¼š123456789101112@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration("classpath:phone-config.xml")public class Test &#123; @Autowired @Qualifier("googlePixel") private Phone phone; @Test public void drive()&#123; assertNotNull(phone); phone.phoneMsg(); &#125;&#125;è¾“å‡ºç»“æžœåŒä¸Šã€‚æˆ–è€…ä¸ç”¨XMLæ˜¾ç¤ºé…ç½®Beanï¼Œå¼€å¯è‡ªåŠ¨æ‰«æï¼Œä½¿ç”¨æ³¨è§£æ³¨å…¥å±žæ€§å€¼ï¼š12&lt;!-- å¼€å¯æ‰«æ --&gt;&lt;context:component-scan base-package="mrbird.leanote.javaconfig"/&gt;GooglePixelç±»å±žæ€§æ³¨å…¥ï¼š12345678910111213141516171819@Componentpublic class GooglePixel implements Phone&#123; @Value("$&#123;phone.name&#125;") private String name; @Value("$&#123;phone.cpu&#125;") private String cpu; @Value("$&#123;phone.battery&#125;") private String battery; public GooglePixel(String name, String cpu, String battery) &#123; this.name = name; this.cpu = cpu; this.battery = battery; &#125; public void phoneMsg() &#123; System.out.println(name+"ï¼Œcpuåž‹å·ï¼š"+cpu+"ï¼Œç”µæ± å®¹é‡ï¼š"+battery); &#125;&#125;æˆ–è€…æž„é€ å™¨æ³¨å…¥ï¼š12345678910...public GooglePixel( @Value("$&#123;phone.name&#125;")String name, @Value("$&#123;phone.cpu&#125;")String cpu, @Value("$&#123;phone.battery&#125;")String battery) &#123; this.name = name; this.cpu = cpu; this.battery = battery;&#125;...util:propertiesåœ¨phone-config.xmlæ–‡ä»¶ä¸­ï¼š12345678910111213141516171819&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:c="http://www.springframework.org/schema/c" xmlns:context="http://www.springframework.org/schema/context" xmlns:util="http://www.springframework.org/schema/util" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.3.xsd"&gt; &lt;util:properties id="p" location="classpath:/mrbird/leanote/properties/googlePixel.properties"/&gt; &lt;bean id="googlePixel" class="mrbird.leanote.javaconfig.GooglePixel" c:name="#&#123;p['phone.name']&#125;" c:cpu="#&#123;p['phone.cpu']&#125;" c:battery="#&#123;p['phone.battery']&#125;"/&gt;&lt;/beans&gt;å’Œå ä½ç¬¦åŒºåˆ«æ˜¯ï¼Œè¿™é‡Œéœ€è¦ç”¨spELè¡¨è¾¾å¼èŽ·å–å±žæ€§çš„å€¼ï¼Œå¹¶ä¸”ä¸èƒ½å†™ä¸ºï¼šâ€#{p.phone.name}â€ï¼Œè¿™æ ·Springè¯»å–ä¸åˆ°å±žæ€§å€¼ï¼Œå°†ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ä½¿ç”¨æ³¨è§£é…ç½®å’Œå ä½ç¬¦ç±»ä¼¼ï¼Œæ¯”å¦‚setæ³¨å…¥ï¼š12345678...@Value("#&#123;p['phone.name']&#125;")private String name;@Value("#&#123;p['phone.cpu']&#125;")private String cpu;@Value("#&#123;p['phone.battery']&#125;")private String battery;...æˆ–è€…ä½¿ç”¨systemPropertiesæ¥ä»£æ›¿pï¼š12345678...@Value("#&#123;systemProperties['phone.name']&#125;")private String name;@Value("#&#123;systemProperties['phone.cpu']&#125;")private String cpu;@Value("#&#123;systemProperties['phone.battery']&#125;")private String battery;...someï¼šXML123&lt;context:property-placeholder location="classpath:....properties"/&gt; &lt;context:component-scan base-package=""/&gt; &lt;import resource="classpath:....xml"/&gt;æ³¨è§£ï¼š123@PropertySource(value = "classpath:....properties")@ComponentScan(basePackages = "")@ImportResource(value = &#123;"classpath:....xml"&#125;)]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Springæ¡ä»¶åŒ–è£…é…Bean]]></title>
    <url>%2FSpring%E6%9D%A1%E4%BB%B6%E5%8C%96%E8%A3%85%E9%85%8DBean.html</url>
    <content type="text"><![CDATA[Spring4å¼•å…¥äº†@Conditionalæ³¨è§£ï¼Œå¯é…åˆ@Beanæˆ–è€…@Componentæ³¨è§£ä¸€èµ·ä½¿ç”¨ã€‚ç”¨CET4è€ƒè¯•æ¥æ¼”ç¤º@Conditionalæ³¨è§£ã€‚æ–°å»ºè€ƒè¯•ç»“æžœResultæŽ¥å£ï¼š123public interface Result &#123; public void getResult();&#125;å®žçŽ°ç±»CET4ï¼š12345public class CET4 implements Result&#123; public void getResult() &#123; System.out.println("æ­å–œä½ é€šè¿‡CET4"); &#125;&#125;å®šä¹‰å­¦ç”ŸæŽ¥å£ï¼š123public interface Student &#123; public void exam();&#125;å®žçŽ°ç±»XiaoMingï¼š12345678910public class XiaoMing implements Student&#123; //æ³¨å…¥result @Autowired(required=false) private Result result; public void exam() &#123; if(result == null) System.out.println("æŠ±æ­‰ï¼ŒCET4æœªé€šè¿‡"); else result.getResult(); &#125;&#125;é…ç½®JavaConfigï¼š12345678910111213141516import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Conditional;import org.springframework.context.annotation.Configuration; @Configurationpublic class ConditionConfig &#123; @Bean @Conditional(ResultCondition.class) public Result result()&#123; return new CET4(); &#125; @Bean(name="xiaoming") public Student student()&#123; return new XiaoMing(); &#125;&#125;å¯ä»¥çœ‹åˆ°ï¼Œ@Conditionalä¸­ç»™å®šäº†ä¸€ä¸ªClassï¼Œå®ƒæŒ‡æ˜Žäº†æ¡ä»¶â€”â€”åœ¨æœ¬ä¾‹ä¸­ï¼Œä¹Ÿå°±æ˜¯ResultConditionï¼š123456789101112131415import org.springframework.context.annotation.Condition;import org.springframework.context.annotation.ConditionContext;import org.springframework.core.env.Environment;import org.springframework.core.type.AnnotatedTypeMetadata; public class ResultCondition implements Condition&#123; public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) &#123; Environment env = context.getEnvironment(); //èŽ·å–çŽ¯å¢ƒå˜é‡ä¸­çš„resultå±žæ€§ String result = env.getProperty("result"); if("success".equals(result)) return true; else return false; &#125;&#125;è®¾ç½®ç»™@Conditionalçš„ç±»å¯ä»¥æ˜¯ä»»æ„å®žçŽ°äº†ConditionæŽ¥å£çš„ç±»åž‹ã€‚å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªæŽ¥å£å®žçŽ°èµ·æ¥å¾ˆç®€å•ç›´æŽ¥ï¼Œåªéœ€æä¾›matches()æ–¹æ³•çš„å®žçŽ°å³å¯ã€‚å¦‚æžœmatches()æ–¹æ³•è¿”å›ž trueï¼Œé‚£ä¹ˆå°±ä¼šåˆ›å»ºå¸¦æœ‰@Conditionalæ³¨è§£çš„beanã€‚å¦‚æžœmatches()æ–¹æ³•è¿”å›žfalseï¼Œå°†ä¸ä¼šåˆ›å»ºè¿™äº›beanã€‚ConditionContextæ˜¯ä¸€ä¸ªæŽ¥å£ï¼Œå¤§è‡´å¦‚ä¸‹æ‰€ç¤ºï¼š1234567public interface conditioncontext&#123; BeanDefinitionRegistry getRegistry(); ConfigurableListableBeanFactory getBeanFactory(); ResourceLoader getResourceLoader(); Environment getEnvironment(); ClassLoder getClassLoader();&#125;é€šè¿‡ConditionContextï¼Œæˆ‘ä»¬å¯ä»¥åšåˆ°å¦‚ä¸‹å‡ ç‚¹ï¼š1.å€ŸåŠ©getRegistry()è¿”å›žçš„BeanDefinitionRegistryæ£€æŸ¥beanå®šä¹‰ï¼›2.å€ŸåŠ©getBeanFactory()è¿”å›žçš„ConfigurableListableBeanFactoryæ£€æŸ¥beanæ˜¯å¦å­˜åœ¨ï¼Œç”šè‡³æŽ¢æŸ¥beançš„å±žæ€§ï¼›3.å€ŸåŠ©getEnvironment()è¿”å›žçš„Environmentæ£€æŸ¥çŽ¯å¢ƒå˜é‡æ˜¯å¦å­˜åœ¨ä»¥åŠå®ƒçš„å€¼æ˜¯ä»€ä¹ˆï¼›4.è¯»å–å¹¶æŽ¢æŸ¥getResourceLoader()è¿”å›žçš„ResourceLoaderæ‰€åŠ è½½çš„èµ„æºï¼›5.å€ŸåŠ©getClassLoader()è¿”å›žçš„ClassLoaderåŠ è½½å¹¶æ£€æŸ¥ç±»æ˜¯å¦å­˜åœ¨ã€‚AnnotatedTypeMetadataåˆ™èƒ½å¤Ÿè®©æˆ‘ä»¬æ£€æŸ¥å¸¦æœ‰@Beanæ³¨è§£çš„æ–¹æ³•ä¸Šè¿˜æœ‰ä»€ä¹ˆå…¶ä»–çš„æ³¨è§£ã€‚åƒConditionContextä¸€æ ·ï¼ŒAnnotatedTypeMetadataä¹Ÿæ˜¯ä¸€ä¸ªæŽ¥å£ã€‚å®ƒå¦‚ä¸‹æ‰€ç¤ºï¼š12345678910public interface AnnotatedTypeMetadata&#123; boolean isAnnotated(String annotationType); Map&lt;String,Object&gt; getAnnotationAttributes(String annotationType); Map&lt;String,Object&gt; getAnnotationAttributes( String annotationType,boolean classValuesAsString); MutilValueMap&lt;String,Object&gt; getAllAnnotationAttributes( String annotationType); MutilValueMap&lt;String,Object&gt; getAllAnnotationAttributes( String annotationType,boolean classValuesAsString);&#125;å€ŸåŠ©isAnnotated()æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ¤æ–­å¸¦æœ‰@Beanæ³¨è§£çš„æ–¹æ³•æ˜¯ä¸æ˜¯è¿˜æœ‰å…¶ä»–ç‰¹å®šçš„æ³¨è§£ã€‚å€ŸåŠ©å…¶ä»–çš„é‚£äº›æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ£€æŸ¥@Beanæ³¨è§£çš„æ–¹æ³•ä¸Šå…¶ä»–æ³¨è§£çš„å±žæ€§ã€‚çŽ°åœ¨æµ‹è¯•@Conditionalæ³¨è§£çš„ä½œç”¨ï¼š12345678public class TestConditional &#123; public static void main(String[] args) &#123; System.setProperty("result", "fail"); ApplicationContext ac = new AnnotationConfigApplicationContext(ConditionConfig.class); Student xiaoming = (Student) ac.getBean("xiaoming"); xiaoming.exam(); &#125;&#125;è¿™é‡Œè®¾ç½®resultä¸ºfailï¼ŒResultConditionçš„matches()æ–¹æ³•è¿”å›žfalseï¼Œæ‰€ä»¥CET4 Beanå¹¶ä¸ä¼šè¢«åˆ›å»ºï¼Œç»“æžœåº”è¯¥è¾“å‡ºâ€œæŠ±æ­‰ï¼ŒCET4æœªé€šè¿‡â€ï¼Œæµ‹è¯•ç»“æžœï¼š1æŠ±æ­‰ï¼ŒCET4æœªé€šè¿‡]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Springæ··åˆè£…é…Bean]]></title>
    <url>%2FSpring%E6%B7%B7%E5%90%88%E8%A3%85%E9%85%8DBean.html</url>
    <content type="text"><![CDATA[Springå¯ä»¥é€šè¿‡Javaä»£ç ä»¥åŠXMLé…ç½®æ¥è£…é…Beanï¼Œä¸ä»…å¦‚æ­¤ï¼ŒSpringè¿˜å¯ä»¥æ··åˆè¿™ä¸¤ç§è£…é…æ–¹æ³•ã€‚JavaConfigä¸­å¼•å…¥XMLé…ç½®åŽ»é™¤@ComponentScanæ³¨è§£ï¼Œè®©æ‰€æœ‰çš„Beanæ˜¾ç¤ºé…ç½®ã€‚åˆ›å»ºä¸€ä¸ªDriverConfigé…ç½®ç±»ï¼Œé‡Œé¢åªè£…é…ä¸€ä¸ªâ€œlaosijiâ€Beanï¼š1234567@Configurationpublic class DriverConfig &#123; @Bean(name="laosiji") public Driver driver()&#123; return new LaoSiJi(); &#125;&#125;åˆ›å»ºä¸€ä¸ªcar-config.xmlé…ç½®ï¼Œåœ¨é‡Œé¢ä½¿ç”¨xmlæ–¹å¼é…ç½®Car Beanï¼š12345678910&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:c="http://www.springframework.org/schema/c" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt; &lt;bean id="wulinghongguang" class="mrbird.leanote.javaconfig.WuLing" c:_-ref="laosiji"/&gt;&lt;/beans&gt;æœ€åŽåˆ›å»ºä¸€ä¸ªMainConfigé…ç½®ç±»ï¼Œå¼•å…¥CarConfigä»¥åŠcar-config.xmlé…ç½®ï¼š123456789101112import org.springframework.context.annotation.Import;import org.springframework.context.annotation.ImportResource;import org.springframework.test.context.ContextConfiguration; @ContextConfiguration//å¯¼å…¥DriverConfigé…ç½®ç±»@Import(DriverConfig.class)//JavaConfigä¸­å¼•å…¥XMLé…ç½®@ImportResource("classpath:car-config.xml")public class MainConfig &#123; &#125;æµ‹è¯•æ˜¯å¦æ³¨å…¥æˆåŠŸï¼š1234567891011121314151617@RunWith(SpringJUnit4ClassRunner.class)//å¯¼å…¥MainConfigé…ç½®ç±»@ContextConfiguration(classes=MainConfig.class)public class CarTest &#123; @Autowired @Qualifier("wulinghongguang") private Car car; @Autowired private Driver driver; @Test public void drive()&#123; assertNotNull(car); car.drive(); assertNotNull(driver); driver.drive(); &#125;&#125;æµ‹è¯•é€šè¿‡ï¼Œé¡µé¢è¾“å‡ºï¼š12å¿«ä¸Šè½¦ï¼Œæ¥ä¸åŠè§£é‡Šäº†å¿«ä¸Šè½¦ï¼Œæ¥ä¸åŠè§£é‡Šäº†XMLé…ç½®ä¸­å¼•å…¥JavaConfigåˆ›å»ºä¸€ä¸ªmain-config.xmlï¼Œé‡Œé¢åˆ†åˆ«å¼•å…¥DriverConfigä»¥åŠcar-config.xmlï¼š123456789&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:c="http://www.springframework.org/schema/c" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt; &lt;bean class="mrbird.leanote.javaconfig.DriverConfig"/&gt; &lt;import resource="car-config.xml"/&gt;&lt;/beans&gt;æµ‹è¯•ï¼š12345678910111213141516@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration("classpath:main-config.xml")public class CarTest &#123; @Autowired @Qualifier("wulinghongguang") private Car car; @Autowired private Driver driver; @Test public void drive()&#123; assertNotNull(car); car.drive(); assertNotNull(driver); driver.drive(); &#125;&#125;æµ‹è¯•é€šè¿‡ï¼Œè¾“å‡ºå¦‚ä¸Šã€‚]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaä»£ç è£…é…Bean]]></title>
    <url>%2FJava%E4%BB%A3%E7%A0%81%E8%A3%85%E9%85%8DBean.html</url>
    <content type="text"><![CDATA[é™¤äº†å¯ä»¥ä½¿ç”¨XMLé…ç½®Beanå¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨Javaä»£ç æ¥è£…é…Beanã€‚å‡†å¤‡å·¥ä½œåˆ›å»ºMavené¡¹ç›®ï¼ŒåŠ å…¥å¦‚ä¸‹ä¾èµ–ï¼š12345678910111213141516171819202122232425262728&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;4.3.2.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;4.3.5.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.stefanbirkner&lt;/groupId&gt; &lt;artifactId&gt;system-rules&lt;/artifactId&gt; &lt;version&gt;1.16.0&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt;åˆ›å»ºBeanåˆ›å»ºDriveræŽ¥å£ï¼š123public interface Driver &#123; public void drive();&#125;å…¶å®žçŽ°ç±»LaoSiJiï¼š12345public class LaoSiJi implements Driver&#123; public void drive() &#123; System.out.println("å¿«ä¸Šè½¦ï¼Œæ¥ä¸åŠè§£é‡Šäº†"); &#125;&#125;ç»™è€å¸æœºåˆ†é…ä¸€è¾†è½¦ï¼Œå®šä¹‰CaræŽ¥å£ï¼š123public interface Car &#123; public void drive();&#125;å…¶å®žçŽ°ç±»äº”è±å®å…‰ï¼š1234567891011public class WuLing implements Car&#123; private Driver driver; // é€šè¿‡æž„é€ å™¨æ³¨å…¥è€å¸æœº @Autowired public WuLing(Driver driver) &#123; this.driver = driver; &#125; public void drive() &#123; driver.drive(); &#125;&#125;åˆ›å»ºé…ç½®ç±»é…ç½®ç±»ä¸­å¯ä»¥æ˜¾ç¤ºçš„é…ç½®Beanï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨è‡ªåŠ¨æ‰«æçš„æ–¹æ³•æ¥ç®€åŒ–é…ç½®ã€‚æ˜¾ç¤ºé…ç½®ï¼š1234567891011121314151617import mrbird.leanote.javaconfig.Car;import mrbird.leanote.javaconfig.CarConfig;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration; @Configurationpublic class CarConfig &#123; //æ˜¾ç¤ºé…ç½®driverå’Œcar @Bean public Driver driver()&#123; return new LaoSiJi(); &#125; @Bean public Car car(Driver driver)&#123; return new WuLing(driver); &#125;&#125;è‡ªåŠ¨æ‰«æï¼šè‡ªåŠ¨æ‰«æçš„è¯ç¨å¾®ä¿®æ”¹é…ç½®ç±»ï¼š1234567import org.springframework.context.annotation.ComponentScan;import org.springframework.context.annotation.Configuration; @Configuration@ComponentScanpublic class CarConfig &#123;&#125;ç„¶åŽåœ¨ä¸Šé¢åˆ›å»ºçš„Beanç±»ä¸Šæ·»åŠ @Componentæ³¨è§£ï¼Œè®©Springå‘çŽ°å¹¶æ³¨å…¥åˆ°é…ç½®ç±»ä¸­ã€‚æµ‹è¯•æµ‹è¯•æ˜¯å¦æ³¨å…¥æˆåŠŸï¼š12345678910111213141516171819202122232425import mrbird.leanote.javaconfig.Car;import mrbird.leanote.javaconfig.CarConfig;import static org.junit.Assert.*;import org.junit.Rule;import org.junit.Test;import org.junit.contrib.java.lang.system.StandardOutputStreamLog;import org.junit.runner.RunWith;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner; @RunWith(SpringJUnit4ClassRunner.class)//åŠ è½½é…ç½®ç±»@ContextConfiguration(classes=CarConfig.class)public class CarTest &#123; @Rule public final StandardOutputStreamLog log = new StandardOutputStreamLog(); @Autowired private Car car; @Test public void drive()&#123; assertNotNull(car); car.drive(); &#125;&#125;è¾“å‡ºï¼š1å¿«ä¸Šè½¦ï¼Œæ¥ä¸åŠè§£é‡Šäº†]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‡ ä¸ªç²¾å½©çš„JavaScriptä»£ç æ®µ]]></title>
    <url>%2F%E5%87%A0%E4%B8%AA%E7%B2%BE%E5%BD%A9%E7%9A%84JavaScript%E4%BB%A3%E7%A0%81%E6%AE%B5.html</url>
    <content type="text"><![CDATA[1.æ ¹æ®ç»™å®šçš„æ¡ä»¶åœ¨åŽŸæœ‰çš„æ•°ç»„ä¸Šï¼Œå¾—åˆ°æ‰€éœ€è¦çš„æ–°æ•°ç»„1234567891011var a = [-1, -1, 1, 2, -2, -2, -3, -3, 3, -3];function f(s, e) &#123; var ret = []; for (var i in s) &#123; // æ ¹æ®åŽŸæœ‰çš„æ•°ç»„é•¿åº¦è¿›è¡Œå¾ªçŽ¯ ret.push(e(s[i])); &#125; return ret;&#125;f(a, function(n) &#123; return n &gt; 0 ? n : 0&#125;); // ä¼ è¾“ä¸€ä¸ªåŒ¿åå‡½æ•°ä½œä¸ºé€»è¾‘åˆ¤æ–­â€‹2.æ¯”åŽŸç”Ÿtypeæˆ–typeofæ›´è¯¦ç»†çš„ç±»åž‹ç›‘æµ‹æ–¹æ³•1234function type(p) &#123; /function.(\w*)\(\)/.test(p.constructor); //é€šè¿‡å…¶æž„é€ å‡½æ•°æ¥èŽ·å–å¯¹åº”çš„ç±»åž‹ã€‚ return RegExp.$1;&#125;3.é€šè¿‡ç§»ä½è¿ç®—æ¥æ›¿ä»£â€parseIntâ€123~~3.14 = &gt; 3;// ~~ å–æ•´ã€‚~å–å½“å‰æ•°å€¼çš„å,~~è¡¨ç¤ºå†æ¬¡å–åï¼Œä¹Ÿå°±æ˜¯å¾—åˆ°å½“å‰è‡ªèº«// ï¼ˆè¯´æ˜Žï¼ŒJSä¸­çš„â€œä½â€è¿ç®—ä¼šå°†æ•°å€¼è‡ªåŠ¨è½¬æ¢ä¸ºæ•´ï¼‰4.å°†æ•°å€¼è½¬æ¢ä¸º16è¿›åˆ¶çš„å­—ç¬¦ä¸²ï¼ˆå¸¸ç”¨äºŽè¡¨ç¤ºè‰²å½©ï¼‰1234(~~ (Math.random() * (1 &lt;&lt; 24))).toString(16)// ~~ é€šè¿‡ä½è¿ç®—æ¥å–æ•´ã€‚// &lt;&lt; å·¦ç§»ä½ã€‚å°†1çš„äºŒè¿›åˆ¶æ•°å·¦ç§»24ä½ã€‚è€Œ1&lt;&lt;24 == 2^24(RGBæ¨¡å¼ä¸‹æœ€å¤šå¯è¡¨ç¤ºçš„è‰²å½©æ•°é‡)// toString(16) å°†æ•°å€¼è½¬æ¢ä¸º16è¿›åˆ¶çš„å­—ç¬¦ä¸²è¾“å‡ºã€‚5.æ­£åˆ™åŒ¹é…æ¸…é™¤ä¸¤ä¾§ç©ºæ ¼1234var trim = function(v)&#123; var patrn = /^\s*(.*?)\s+$/; return (patrn.test(v))? RegExp.$1 : 'null ';&#125;è½¬è‡ªï¼šå¾®ä¿¡å…¬ä¼—å·ï¼šJavaScriptcn]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MyBatis Dynamic SQL]]></title>
    <url>%2FMyBatis-Dynamic-SQL.html</url>
    <content type="text"><![CDATA[MyBatis çš„å¼ºå¤§ç‰¹æ€§ä¹‹ä¸€ä¾¿æ˜¯å®ƒçš„åŠ¨æ€ SQLã€‚å¦‚æžœä½ æœ‰ä½¿ç”¨ JDBC æˆ–å…¶ä»–ç±»ä¼¼æ¡†æž¶çš„ç»éªŒï¼Œä½ å°±èƒ½ä½“ä¼šåˆ°æ ¹æ®ä¸åŒæ¡ä»¶æ‹¼æŽ¥ SQL è¯­å¥æœ‰å¤šä¹ˆç—›è‹¦ã€‚æ‹¼æŽ¥çš„æ—¶å€™è¦ç¡®ä¿ä¸èƒ½å¿˜äº†å¿…è¦çš„ç©ºæ ¼ï¼Œè¿˜è¦æ³¨æ„çœæŽ‰åˆ—ååˆ—è¡¨æœ€åŽçš„é€—å·ã€‚åˆ©ç”¨åŠ¨æ€ SQL è¿™ä¸€ç‰¹æ€§å¯ä»¥å½»åº•æ‘†è„±è¿™ç§ç—›è‹¦ã€‚ifåŠ¨æ€ SQL é€šå¸¸è¦åšçš„äº‹æƒ…æ˜¯æœ‰æ¡ä»¶åœ°åŒ…å« where å­å¥çš„ä¸€éƒ¨åˆ†ã€‚æ¯”å¦‚ï¼š12345678910&lt;select id="findRoles" resultType="roleList"&gt; SELECT * FROM t_role WHERE 1 = 1 &lt;if test="roleNo != null and roleNo != ''"&gt; AND role_no like concat('%',#&#123;roleNo&#125;,'%') &lt;/if&gt; &lt;if test="roleName != null and roleName != ''"&gt; AND role_name like concat('%',#&#123;roleName&#125;,'%') &lt;/if&gt;&lt;/select&gt;choose, when, otherwiseæœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬ä¸æƒ³ç”¨åˆ°æ‰€æœ‰çš„æ¡ä»¶è¯­å¥ï¼Œè€Œåªæƒ³ä»Žä¸­æ‹©å…¶ä¸€äºŒã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼ŒMyBatis æä¾›äº† choose å…ƒç´ ï¼Œå®ƒæœ‰ç‚¹åƒ Java ä¸­çš„ switch è¯­å¥ã€‚å¦‚ï¼š123456789101112131415&lt;select id="findRoles" resultType="roleList"&gt; SELECT * FROM t_role WHERE 1 = 1 &lt;choose&gt; &lt;when test="roleNo != null and roleNo != ''"&gt; AND role_no = #&#123;roleNo&#125; &lt;/when&gt; &lt;when test="roleName != null and roleName != ''"&gt; AND role_name like concat('%',#&#123;roleName&#125;,'%') &lt;/when&gt; &lt;otherwise&gt; AND note is not null &lt;/otherwise&gt; &lt;/choose&gt;&lt;/select&gt;trim, where, setåœ¨ç¬¬ä¸€ä¸ªæ —å­ä¸­ï¼Œå‡å¦‚ä¸åŠ ä¸Š1=1çš„è¯ï¼Œæ¯”å¦‚å½“ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸æˆç«‹çš„æ—¶å€™ï¼ŒSQLå°±å˜æˆäº†è¿™æ ·ï¼š1SELECT * FROM t_role WHERE AND roleName like concat('%',#&#123;roleName&#125;,'%')ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨whereå…ƒç´ ï¼š1234567891011&lt;select id="findRoles" resultType="roleList"&gt; SELECT * FROM t_role &lt;where&gt; &lt;if test="roleNo != null and roleNo != ''"&gt; AND role_no like concat('%',#&#123;roleNo&#125;,'%') &lt;/if&gt; &lt;if test="roleName != null and roleName != ''"&gt; AND role_name like concat('%',#&#123;roleName&#125;,'%') &lt;/if&gt; &lt;/where&gt;&lt;/select&gt;where å…ƒç´ çŸ¥é“åªæœ‰åœ¨ä¸€ä¸ªä»¥ä¸Šçš„ifæ¡ä»¶æœ‰å€¼çš„æƒ…å†µä¸‹æ‰åŽ»æ’å…¥â€œWHEREâ€å­å¥ã€‚è€Œä¸”ï¼Œè‹¥æœ€åŽçš„å†…å®¹æ˜¯â€œANDâ€æˆ–â€œORâ€å¼€å¤´çš„ï¼Œwhere å…ƒç´ ä¹ŸçŸ¥é“å¦‚ä½•å°†ä»–ä»¬åŽ»é™¤ã€‚å’Œ where å…ƒç´ ç­‰ä»·çš„è‡ªå®šä¹‰ trim å…ƒç´ ä¸ºï¼š123&lt;trim prefix="WHERE" prefixOverrides="AND |OR "&gt; ... &lt;/trim&gt;perfixè¡¨ç¤ºè¯­å¥å‰ç¼€ï¼ŒprefixOverridesè¡¨ç¤ºè¦åŽ»é™¤çš„å‰ç¼€ï¼ˆæ³¨æ„æ­¤ä¾‹ä¸­çš„ç©ºæ ¼ä¹Ÿæ˜¯å¿…è¦çš„ï¼‰ã€‚å®ƒå¸¦æ¥çš„ç»“æžœå°±æ˜¯æ‰€æœ‰åœ¨ prefixOverrides å±žæ€§ä¸­æŒ‡å®šçš„å†…å®¹å°†è¢«ç§»é™¤ï¼Œå¹¶ä¸”æ’å…¥ prefix å±žæ€§ä¸­æŒ‡å®šçš„å†…å®¹ã€‚ç±»ä¼¼çš„ç”¨äºŽåŠ¨æ€æ›´æ–°è¯­å¥çš„è§£å†³æ–¹æ¡ˆå«åš setã€‚set å…ƒç´ å¯ä»¥è¢«ç”¨äºŽåŠ¨æ€åŒ…å«éœ€è¦æ›´æ–°çš„åˆ—ï¼Œè€ŒèˆåŽ»å…¶ä»–çš„ã€‚æ¯”å¦‚ï¼š123456789101112&lt;update id="updateRole" parameterType="role"&gt; update t_role &lt;set&gt; &lt;if test="roleName != null and roleName != ''"&gt; role_name = #&#123;roleName&#125;, &lt;/if&gt; &lt;if test="note != null and note != ''"&gt; note = #&#123;note&#125; &lt;/if&gt; where role_no = #&#123;roleNo&#125; &lt;/set&gt;&lt;/update&gt;è¿™é‡Œï¼Œset å…ƒç´ ä¼šåŠ¨æ€å‰ç½® SET å…³é”®å­—ï¼ŒåŒæ—¶ä¹Ÿä¼šæ¶ˆé™¤æ— å…³çš„é€—å·ã€‚å¯¹åº”çš„trimå…ƒç´ çš„å†™æ³•ä¸ºï¼š123&lt;trim prefix="SET" suffixOverrides=","&gt; ...&lt;/trim&gt;suffixOverridesåŽ»é™¤åŽç¼€ã€‚forEachåŠ¨æ€ SQL çš„å¦å¤–ä¸€ä¸ªå¸¸ç”¨çš„å¿…è¦æ“ä½œæ˜¯éœ€è¦å¯¹ä¸€ä¸ªé›†åˆè¿›è¡ŒéåŽ†ï¼Œé€šå¸¸æ˜¯åœ¨æž„å»º IN æ¡ä»¶è¯­å¥çš„æ—¶å€™ã€‚æ¯”å¦‚ï¼š1234567&lt;select id="findUserBySex" resultType="user"&gt; select * from t_user where sex in &lt;forEach item="sex" index="index" collection="sexList" open="(" separator="," close=")"&gt; #&#123;sex&#125; &lt;/forEach&gt;&lt;/select&gt;è¯´æ˜Žï¼š 1.collectioné…ç½®çš„sexListæ˜¯ä¼ é€’è¿›æ¥çš„å‚æ•°åç§°ï¼Œå¯ä»¥ä¸ºæ•°ç»„ï¼ŒListï¼ŒSetæˆ–é›†åˆã€‚2.itemé…ç½®çš„æ˜¯å¾ªçŽ¯ä¸­å½“å‰çš„å…ƒç´ ã€‚3.indexé…ç½®çš„æ˜¯å½“å‰å…ƒç´ çš„ä¸‹æ ‡ã€‚4.openå’Œcloseé…ç½®çš„æ˜¯ä»¥ä»€ä¹ˆç¬¦å·å°†è¿™äº›é›†åˆå…ƒç´ åŒ…è£¹èµ·æ¥ã€‚5.separatoré…ç½®çš„æ˜¯é—´éš”ç¬¦ã€‚bindbindå…ƒç´ å¯ä»¥ä»Ž OGNL è¡¨è¾¾å¼ä¸­åˆ›å»ºä¸€ä¸ªå˜é‡å¹¶å°†å…¶ç»‘å®šåˆ°ä¸Šä¸‹æ–‡ã€‚æ¯”å¦‚ï¼š1234&lt;select id="findRole" resultMap="roleList"&gt; &lt;bind name="pattern" value="'%' + _parameter + '%'"/&gt; select * from t_role where role_name like #&#123;pattern&#125;&lt;/select&gt;å…¶ä¸­_paramrterä»£è¡¨çš„æ˜¯ä¼ è¿›æ¥çš„å‚æ•°ï¼Œå’Œé€šé…ç¬¦è¿žæŽ¥åŽèµ‹ç»™äº†patternã€‚Multi-db vendor supportä¸€ä¸ªé…ç½®äº†â€œ_databaseIdâ€å˜é‡çš„ databaseIdProvider å¯¹äºŽåŠ¨æ€ä»£ç æ¥è¯´æ˜¯å¯ç”¨çš„ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®ä¸åŒçš„æ•°æ®åº“åŽ‚å•†æž„å»ºç‰¹å®šçš„è¯­å¥ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š1234567891011&lt;insert id="insert"&gt; &lt;selectKey keyProperty="id" resultType="int" order="BEFORE"&gt; &lt;if test="_databaseId == 'oracle'"&gt; select seq_users.nextval from dual &lt;/if&gt; &lt;if test="_databaseId == 'db2'"&gt; select nextval for seq_users from sysibm.sysdummy1" &lt;/if&gt; &lt;/selectKey&gt; insert into users values (#&#123;id&#125;, #&#123;name&#125;)&lt;/insert&gt;ã€Šæ·±å…¥æµ…å‡ºMyBatisæŠ€æœ¯åŽŸç†ä¸Žå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MyBatis Cache]]></title>
    <url>%2FMyBatis-Cache.html</url>
    <content type="text"><![CDATA[MyBatiså¯¹ç¼“å­˜æä¾›äº†æ”¯æŒï¼Œé»˜è®¤æƒ…å†µä¸‹åªå¼€å¯äº†ä¸€çº§ç¼“å­˜ï¼Œè¦å¼€å¯äºŒçº§ç¼“å­˜éœ€è¦è¿›è¡Œé…ç½®ã€‚ä¸ºäº†éªŒè¯è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬åˆ›å»ºlog4j.propertiesï¼š1234log4j.rootLogger=DEBUG , stdout log4j.logger.mrbird.leanote=DEBUG log4j.appender.stdout=org.apache.log4j.ConsoleAppender log4j.appender.stdout.layout=org.apache.log4j.PatternLayoutåœ¨mybatis-config.xmlæ–‡ä»¶ä¸­é…ç½®å®ƒï¼š1234&lt;settings&gt; ... &lt;setting name="logImpl" value="LOG4J"/&gt;&lt;/settings&gt;ä¸€çº§ç¼“å­˜ä¸€çº§ç¼“å­˜æ˜¯é’ˆå¯¹äºŽä¸€ä¸ªSqlSessionè€Œè¨€çš„ï¼Œåœ¨å‚æ•°å’ŒSQLå®Œå…¨ä¸€æ ·çš„æƒ…å†µä¸‹ï¼ŒåŒä¸€ä¸ªSqlSessionå¯¹è±¡è°ƒç”¨åŒä¸€ä¸ªMapperæ–¹æ³•ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡SQLï¼Œè€Œä¸åŒçš„SqlSessionéƒ½æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œæ‰€ä»¥å³ä½¿ä½¿ç”¨ç›¸åŒçš„Mapperï¼Œç›¸åŒçš„æ–¹æ³•ï¼Œä¹Ÿä¼šå†æ¬¡å‘é€SQLè¿›è¡ŒæŸ¥è¯¢ã€‚ä¸¾ä¸ªæ —å­ï¼š1234567891011121314151617181920212223242526272829SqlSession sqlSession1 = null;SqlSession sqlSession2 = null;final Logger logger = Logger.getLogger(MyBatisMain.class);try &#123; sqlSession1 = SqlSessionFactoryUtil.openSqlSession(); RoleMapper roleMapper1 = sqlSession1.getMapper(RoleMapper.class); Role role1 = roleMapper1.getRoleById(1L); logger.debug("ä½¿ç”¨åŒä¸€ä¸ªsqlSessionå†æ¬¡æ‰§è¡Œ"); Role role2 = roleMapper1.getRoleById(1L); //ä½¿ç”¨äºŒçº§ç¼“å­˜çš„æ—¶å€™ï¼ŒSqlSessionè°ƒç”¨äº†commitæ–¹æ³•åŽæ‰ä¼šç”Ÿæ•ˆ sqlSession1.commit(); logger.debug("ä½¿ç”¨ä¸åŒsqlSessionå†æ¬¡æ‰§è¡Œ"); sqlSession2 = SqlSessionFactoryUtil.openSqlSession(); RoleMapper roleMapper2 = sqlSession2.getMapper(RoleMapper.class); Role role3 = roleMapper2.getRoleById(1L); //ä½¿ç”¨äºŒçº§ç¼“å­˜çš„æ—¶å€™ï¼ŒSqlSessionè°ƒç”¨äº†commitæ–¹æ³•åŽæ‰ä¼šç”Ÿæ•ˆ sqlSession2.commit();&#125; catch (Exception e) &#123; e.printStackTrace(); sqlSession1.rollback();sqlSession2.rollback();&#125;finally&#123; if(sqlSession1 != null)&#123; sqlSession1.close(); &#125; if(sqlSession2 != null)&#123; sqlSession2.close(); &#125;&#125;æŸ¥çœ‹æŽ§åˆ¶å°è¾“å‡ºæ—¥å¿—ï¼š1234567891011121314151617181920212223242526Logging initialized using 'class org.apache.ibatis.logging.slf4j.Slf4jImpl' adapter.Logging initialized using 'class org.apache.ibatis.logging.log4j.Log4jImpl' adapter.PooledDataSource forcefully closed/removed all connections.PooledDataSource forcefully closed/removed all connections.PooledDataSource forcefully closed/removed all connections.PooledDataSource forcefully closed/removed all connections.Opening JDBC ConnectionCreated connection 1995619265.Setting autocommit to false on JDBC Connection [com.mysql.jdbc.JDBC4Connection@76f2bbc1]==&gt; Preparing: select * from t_role where id = ? ==&gt; Parameters: 1(Long)&lt;== Total: 1ä½¿ç”¨åŒä¸€ä¸ªsqlSessionå†æ¬¡æ‰§è¡Œä½¿ç”¨ä¸åŒsqlSessionå†æ¬¡æ‰§è¡ŒOpening JDBC ConnectionCreated connection 2044366277.Setting autocommit to false on JDBC Connection [com.mysql.jdbc.JDBC4Connection@79da8dc5]==&gt; Preparing: select * from t_role where id = ? ==&gt; Parameters: 1(Long)&lt;== Total: 1Resetting autocommit to true on JDBC Connection [com.mysql.jdbc.JDBC4Connection@76f2bbc1]Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@76f2bbc1]Returned connection 1995619265 to pool.Resetting autocommit to true on JDBC Connection [com.mysql.jdbc.JDBC4Connection@79da8dc5]Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@79da8dc5]Returned connection 2044366277 to pool.å¯è§ä¸€çº§ç¼“å­˜æ˜¯é’ˆå¯¹äºŽSqlSessionå±‚é¢çš„ã€‚äºŒçº§ç¼“å­˜äºŒçº§ç¼“å­˜æ˜¯é’ˆå¯¹äºŽSqlSessionFactoryå±‚é¢çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦æ˜¯åŒä¸€ä¸ªSqlSessionFactoryåˆ›å»ºçš„SqlSessionï¼Œå®ƒä»¬é—´éƒ½å°†å…±äº«ç¼“å­˜ã€‚å¼€å¯äºŒçº§ç¼“å­˜éœ€è¦POJOéƒ½å®žçŽ°SerializableæŽ¥å£ï¼Œå¹¶åœ¨ä½ çš„ SQL æ˜ å°„æ–‡ä»¶ä¸­æ·»åŠ ä¸€è¡Œ:1&lt;cache/&gt;å­—é¢ä¸Šçœ‹å°±æ˜¯è¿™æ ·ã€‚è¿™ä¸ªç®€å•è¯­å¥çš„æ•ˆæžœå¦‚ä¸‹: 1.æ˜ å°„è¯­å¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰ select è¯­å¥å°†ä¼šè¢«ç¼“å­˜ã€‚2.æ˜ å°„è¯­å¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰ insert,update å’Œ delete è¯­å¥ä¼šåˆ·æ–°ç¼“å­˜ã€‚3.ç¼“å­˜ä¼šä½¿ç”¨ Least Recently Used(LRU,æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„)ç®—æ³•æ¥æ”¶å›žã€‚4.æ ¹æ®æ—¶é—´è¡¨(æ¯”å¦‚ no Flush Interval,æ²¡æœ‰åˆ·æ–°é—´éš”), ç¼“å­˜ä¸ä¼šä»¥ä»»ä½•æ—¶é—´é¡ºåº æ¥åˆ·æ–°ã€‚5.ç¼“å­˜ä¼šå­˜å‚¨åˆ—è¡¨é›†åˆæˆ–å¯¹è±¡(æ— è®ºæŸ¥è¯¢æ–¹æ³•è¿”å›žä»€ä¹ˆ)çš„ 1024 ä¸ªå¼•ç”¨ã€‚6.ç¼“å­˜ä¼šè¢«è§†ä¸ºæ˜¯ read/write(å¯è¯»/å¯å†™)çš„ç¼“å­˜,æ„å‘³ç€å¯¹è±¡æ£€ç´¢ä¸æ˜¯å…±äº«çš„,è€Œ ä¸”å¯ä»¥å®‰å…¨åœ°è¢«è°ƒç”¨è€…ä¿®æ”¹,è€Œä¸å¹²æ‰°å…¶ä»–è°ƒç”¨è€…æˆ–çº¿ç¨‹æ‰€åšçš„æ½œåœ¨ä¿®æ”¹ã€‚å¼€å¯äºŒçº§ç¼“å­˜åŽï¼Œå†æ¬¡æ‰§è¡Œä¸Šé¢çš„æ–¹æ³•ï¼ŒæŸ¥çœ‹æŽ§åˆ¶å°è¾“å‡ºæ—¥å¿—ï¼š1234567891011121314151617181920Logging initialized using 'class org.apache.ibatis.logging.slf4j.Slf4jImpl' adapter.Logging initialized using 'class org.apache.ibatis.logging.log4j.Log4jImpl' adapter.PooledDataSource forcefully closed/removed all connections.PooledDataSource forcefully closed/removed all connections.PooledDataSource forcefully closed/removed all connections.PooledDataSource forcefully closed/removed all connections.Cache Hit Ratio [mrbird.leanote.mapper.RoleMapper]: 0.0Opening JDBC ConnectionCreated connection 330382173.Setting autocommit to false on JDBC Connection [com.mysql.jdbc.JDBC4Connection@13b13b5d]==&gt; Preparing: select * from t_role where id = ? ==&gt; Parameters: 1(Long)&lt;== Total: 1ä½¿ç”¨åŒä¸€ä¸ªsqlSessionå†æ¬¡æ‰§è¡ŒCache Hit Ratio [mrbird.leanote.mapper.RoleMapper]: 0.0ä½¿ç”¨ä¸åŒsqlSessionå†æ¬¡æ‰§è¡ŒCache Hit Ratio [mrbird.leanote.mapper.RoleMapper]: 0.3333333333333333Resetting autocommit to true on JDBC Connection [com.mysql.jdbc.JDBC4Connection@13b13b5d]Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@13b13b5d]Returned connection 330382173 to pool.å¯è§ï¼Œä»Žå¤´åˆ°å°¾åªå‘é€äº†ä¸€æ¬¡SQLè¿›è¡ŒæŸ¥è¯¢ã€‚å±žæ€§éƒ½å¯ä»¥é€šè¿‡ç¼“å­˜å…ƒç´ çš„å±žæ€§æ¥ä¿®æ”¹ã€‚æ¯”å¦‚ï¼š1&lt;cache eviction="FIFO" flushInterval="60000" size="512" readOnly="true"/&gt;è¿™ä¸ªæ›´é«˜çº§çš„é…ç½®åˆ›å»ºäº†ä¸€ä¸ª FIFO ç¼“å­˜,å¹¶æ¯éš” 60 ç§’åˆ·æ–°,å­˜æ•°ç»“æžœå¯¹è±¡æˆ–åˆ—è¡¨çš„ 512 ä¸ªå¼•ç”¨,è€Œä¸”è¿”å›žçš„å¯¹è±¡è¢«è®¤ä¸ºæ˜¯åªè¯»çš„,å› æ­¤åœ¨ä¸åŒçº¿ç¨‹ä¸­çš„è°ƒç”¨è€…ä¹‹é—´ä¿®æ”¹å®ƒä»¬ä¼š å¯¼è‡´å†²çªã€‚å¯ç”¨çš„æ”¶å›žç­–ç•¥æœ‰: 1.LRU â€“ æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„:ç§»é™¤æœ€é•¿æ—¶é—´ä¸è¢«ä½¿ç”¨çš„å¯¹è±¡ã€‚2.FIFO â€“ å…ˆè¿›å…ˆå‡º:æŒ‰å¯¹è±¡è¿›å…¥ç¼“å­˜çš„é¡ºåºæ¥ç§»é™¤å®ƒä»¬ã€‚3.SOFT â€“ è½¯å¼•ç”¨:ç§»é™¤åŸºäºŽåžƒåœ¾å›žæ”¶å™¨çŠ¶æ€å’Œè½¯å¼•ç”¨è§„åˆ™çš„å¯¹è±¡ã€‚4.WEAK â€“ å¼±å¼•ç”¨:æ›´ç§¯æžåœ°ç§»é™¤åŸºäºŽåžƒåœ¾æ”¶é›†å™¨çŠ¶æ€å’Œå¼±å¼•ç”¨è§„åˆ™çš„å¯¹è±¡ã€‚é»˜è®¤çš„æ˜¯ LRUã€‚flushInterval(åˆ·æ–°é—´éš”)å¯ä»¥è¢«è®¾ç½®ä¸ºä»»æ„çš„æ­£æ•´æ•°,è€Œä¸”å®ƒä»¬ä»£è¡¨ä¸€ä¸ªåˆç†çš„æ¯«ç§’ å½¢å¼çš„æ—¶é—´æ®µã€‚é»˜è®¤æƒ…å†µæ˜¯ä¸è®¾ç½®,ä¹Ÿå°±æ˜¯æ²¡æœ‰åˆ·æ–°é—´éš”,ç¼“å­˜ä»…ä»…è°ƒç”¨è¯­å¥æ—¶åˆ·æ–°ã€‚size(å¼•ç”¨æ•°ç›®)å¯ä»¥è¢«è®¾ç½®ä¸ºä»»æ„æ­£æ•´æ•°,è¦è®°ä½ä½ ç¼“å­˜çš„å¯¹è±¡æ•°ç›®å’Œä½ è¿è¡ŒçŽ¯å¢ƒçš„ å¯ç”¨å†…å­˜èµ„æºæ•°ç›®ã€‚é»˜è®¤å€¼æ˜¯ 1024ã€‚readOnly(åªè¯»)å±žæ€§å¯ä»¥è¢«è®¾ç½®ä¸º true æˆ– falseã€‚åªè¯»çš„ç¼“å­˜ä¼šç»™æ‰€æœ‰è°ƒç”¨è€…è¿”å›žç¼“ å­˜å¯¹è±¡çš„ç›¸åŒå®žä¾‹ã€‚å› æ­¤è¿™äº›å¯¹è±¡ä¸èƒ½è¢«ä¿®æ”¹ã€‚è¿™æä¾›äº†å¾ˆé‡è¦çš„æ€§èƒ½ä¼˜åŠ¿ã€‚å¯è¯»å†™çš„ç¼“å­˜ ä¼šè¿”å›žç¼“å­˜å¯¹è±¡çš„æ‹·è´(é€šè¿‡åºåˆ—åŒ–) ã€‚è¿™ä¼šæ…¢ä¸€äº›,ä½†æ˜¯å®‰å…¨,å› æ­¤é»˜è®¤æ˜¯ falseã€‚ã€Šæ·±å…¥æµ…å‡ºMyBatisæŠ€æœ¯åŽŸç†ä¸Žå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MyBatisçº§è”]]></title>
    <url>%2FMyBatis%E7%BA%A7%E8%81%94.html</url>
    <content type="text"><![CDATA[MyBatisä¸­çš„çº§è”åˆ†ä¸º3ç§ï¼šassociationï¼Œcollectionå’Œdiscriminatorï¼š1.associationï¼šä»£è¡¨ä¸€å¯¹ä¸€å…³ç³»ï¼Œæ¯”å¦‚å­¦ç”Ÿå’Œå­¦ç”Ÿè¯æ˜¯ä¸€å¯¹ä¸€å…³ç³»ã€‚2.collectionï¼šä»£è¡¨ä¸€å¯¹å¤šå…³ç³»ï¼Œæ¯”å¦‚å­¦ç”Ÿå’Œè¯¾ç¨‹æ˜¯ä¸€å¯¹å¤šå…³ç³»ï¼Œä¸€ä¸ªå­¦ç”Ÿå¯ä»¥æœ‰å¤šä¸ªè¯¾ç¨‹ã€‚3.discriminatorï¼šé‰´åˆ«å™¨ï¼Œå®ƒå¯ä»¥æ ¹æ®å®žé™…é€‰æ‹©é‡‡ç”¨å“ªä¸ªç±»ä½œä¸ºå®žä¾‹ï¼Œå…è®¸ä½ æ ¹æ®ç‰¹å®šçš„æ¡ä»¶åŽ»å…³è”ä¸åŒçš„ç»“æžœé›†ã€‚ä¸ºäº†å­¦ä¹ è¿™äº›ä¸œä¸œï¼Œè®¾è®¡ä¸€ä¸ªæ¨¡åž‹å…³ç³»ï¼šæ ¹æ®æ¨¡åž‹æ–°å»ºåº“è¡¨ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061CREATE TABLE t_lecture( id int(20) not null auto_increment comment 'ç¼–å·', lecture_name VARCHAR(60) not null comment 'è¯¾ç¨‹åç§°', PRIMARY KEY (id)); CREATE table t_student( id int(20) not null auto_increment comment 'ç¼–å·', cnname VARCHAR(60) not null comment 'å­¦ç”Ÿå§“å', sex TINYINT(4) not null COMMENT 'æ€§åˆ«', selfcard_no int(20) not NULL COMMENT 'å­¦ç”Ÿè¯å·', note VARCHAR(1024) COMMENT 'å¤‡æ³¨', PRIMARY KEY (id)); CREATE table t_student_health_female( id int(20) not null auto_increment comment 'ç¼–å·', student_id VARCHAR(60) not null comment 'å­¦ç”Ÿç¼–å·', check_date VARCHAR(60) not NULL COMMENT 'æ£€æŸ¥æ—¥æœŸ', heart VARCHAR(60) not NULL COMMENT 'å¿ƒ', liver VARCHAR(60) not NULL COMMENT 'è‚', spleen VARCHAR(60) not NULL COMMENT 'è„¾', lung VARCHAR(60) not NULL COMMENT 'è‚º', kidney VARCHAR(60) not NULL COMMENT 'è‚¾', uterus VARCHAR(60) not NULL COMMENT 'å­å®«', note VARCHAR(1024) not NULL comment 'å¤‡æ³¨', PRIMARY KEY (id)); CREATE table t_student_health_male( id int(20) not null auto_increment comment 'ç¼–å·', student_id VARCHAR(60) not null comment 'å­¦ç”Ÿç¼–å·', check_date VARCHAR(60) not NULL COMMENT 'æ£€æŸ¥æ—¥æœŸ', heart VARCHAR(60) not NULL COMMENT 'å¿ƒ', liver VARCHAR(60) not NULL COMMENT 'è‚', spleen VARCHAR(60) not NULL COMMENT 'è„¾', lung VARCHAR(60) not NULL COMMENT 'è‚º', kidney VARCHAR(60) not NULL COMMENT 'è‚¾', prostate VARCHAR(60) not NULL COMMENT 'å‰åˆ—è…º', note VARCHAR(1024) not NULL comment 'å¤‡æ³¨', PRIMARY KEY (id)); create table t_student_lecture( id int(20) not null auto_increment COMMENT 'ç¼–å·', student_id int(20) not null comment 'å­¦ç”Ÿç¼–å·', lecture_id int(20) not null comment 'è¯¾ç¨‹ç¼–å·', grade DECIMAL(16,2) not null comment 'è¯„åˆ†', note VARCHAR(1024) comment 'å¤‡æ³¨', PRIMARY KEY (id)); create table t_student_selfcard( id int(20) not null auto_increment COMMENT 'ç¼–å·', student_id int(20) not null comment 'å­¦ç”Ÿç¼–å·', native VARCHAR(60) not NULL COMMENT 'ç±è´¯', issue_date date NOT NULL comment 'å‘è¯æ—¥æœŸ', end_date date not NULL COMMENT 'ç»“æŸæ—¥æœŸ', note VARCHAR(1024) comment 'å¤‡æ³¨', PRIMARY KEY (id));associationç”¨t_studentå’Œt_student_selfcardæ¼”ç¤ºä¸€å¯¹ä¸€çº§è”ã€‚æ–°å¢žStudent POJOï¼š12345678910public class Student &#123; private Long id; private String cnName; private Sex sex; private Long selfCardNo; private String note; //ä¸€å¯¹ä¸€å…³ç³» private StudentSelfcard selfCard; // getterï¼Œsetterç•¥&#125;StudentSelfcard POJOï¼š123456789public class StudentSelfcard &#123; private Long id; private Long studentId; private String natives; private Date issueDate; private Date endDate; private String note; // getterï¼Œsetterç•¥&#125;å®šä¹‰æŽ¥å£StudentSelfcardMapperï¼š1234public interface StudentSelfcardMapper &#123; public StudentSelfcard findStudentSelfcardByStudentId(Long id); public int insertStudentSelfcard(StudentSelfcard selfCard);&#125;åˆ›å»ºå¯¹åº”çš„æ˜ å°„æ–‡ä»¶StudentSelfcardMapper.xmlï¼š123456789101112131415161718&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentSelfcardMapper"&gt; &lt;sql id="studentSelfcard_column"&gt; id,student_id as studentId,native as natives,issue_date as issueDate, end_date as endDate,note &lt;/sql&gt; &lt;select id="findStudentSelfcardByStudentId" parameterType="long" resultType="studentSelfcard"&gt; select &lt;include refid="studentSelfcard_column"/&gt; from t_student_selfcard where student_id = #&#123;studentId&#125; &lt;/select&gt; &lt;insert id="insertStudentSelfcard" parameterType="studentSelfcard"&gt; insert into t_student_selfcard (student_id,native,issue_date,end_date, note) values (#&#123;studentId&#125;,#&#123;natives&#125;,#&#123;issueDate&#125;,#&#123;endDate&#125;,#&#123;note&#125;) &lt;/insert&gt;&lt;/mapper&gt;æŽ¥ç€å®šä¹‰æŽ¥å£StudentMapperï¼š1234public interface StudentMapper &#123; public Student findStudentById(Long id); public int createStudent(Student s);&#125;å…¶ç›¸å¯¹äºŽçš„æ˜ å°„æ–‡ä»¶StudentMapper.xmlï¼š1234567891011121314151617181920212223242526272829303132&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentMapper"&gt; &lt;resultMap type="student" id="studentList"&gt; &lt;id column="id" property="id"/&gt; &lt;result column="cnname" property="cnName"/&gt; &lt;result column="sex" property="sex" typeHandler="org.apache.ibatis.type.EnumTypeHandler"/&gt; &lt;result column="selfcard_no" property="selfCardNo"/&gt; &lt;result column="note" property="note"/&gt; &lt;!-- ä¸€å¯¹ä¸€å…³è”ï¼ŒcolumnæŒ‡å®šç”¨å“ªåˆ—çš„å€¼ä½œä¸ºselectæŸ¥è¯¢çš„æ¡ä»¶ï¼Œå¦‚æžœæœ‰å¤šä¸ªå€¼ç”¨ é€—å·éš”å¼€ï¼ŒselectæŒ‡å®šæŸ¥è¯¢æ–¹æ³•--&gt; &lt;association property="selfCard" column="id" select="mrbird.leanote.mapper.StudentSelfcardMapper.findStudentSelfcardByStudentId"/&gt; &lt;/resultMap&gt; &lt;sql id="student_column"&gt; id,cnname as cnName,sex,selfcard_no as selfCardNo,note &lt;/sql&gt; &lt;select id="findStudentById" parameterType="long" resultMap="studentList"&gt; select &lt;include refid="student_column"/&gt; from t_student where id = #&#123;id&#125; &lt;/select&gt; &lt;!-- è®¾ç½®ä¸»é”®å›žå¡«ï¼Œä¾›t_student_selfcardçš„student_idå­—æ®µä½¿ç”¨ --&gt; &lt;insert id="createStudent" parameterType="student" useGeneratedKeys="true" keyProperty="id"&gt; insert into t_student(cnname,sex,selfcard_no,note) values (#&#123;cnName&#125;, #&#123;sex,typeHandler=org.apache.ibatis.type.EnumTypeHandler&#125;, #&#123;selfCardNo&#125;,#&#123;note&#125;) &lt;/insert&gt;&lt;/mapper&gt;è®¾ç½®åˆ«åï¼ŒæŒ‡å®šmapperç•¥ã€‚å…ˆå¾€åº“è¡¨æ’å…¥å€¼ï¼š123456789101112131415161718192021...sqlSession = SqlSessionFactoryUtil.openSqlSession();StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);StudentSelfcardMapper selfcardMapper = sqlSession.getMapper(StudentSelfcardMapper.class);Student student = new Student();student.setCnName("è¾›ä¹…å¥ˆ");student.setNote("æ—‹æ¶¡è¾›ä¹…å¥ˆ");student.setSelfCardNo(10000L);student.setSex(Sex.FEMALE);int n = studentMapper.createStudent(student);if( n == 1)&#123; StudentSelfcard selfCard = new StudentSelfcard(); selfCard.setStudentId(student.getId()); selfCard.setNatives("ç¦å·ž"); selfCard.setIssueDate(new Date()); selfCard.setEndDate(new Date()); selfCard.setNote("æ—‹æ¶¡è¾›ä¹…å¥ˆçš„å­¦ç”Ÿè¯"); selfcardMapper.insertStudentSelfcard(selfCard);&#125;sqlSession.commit();...æŸ¥è¯¢åº“è¡¨ï¼š123456789101112131415mysql&gt; select * from t_student;+----+--------+--------+-------------+------------+| id | cnname | sex | selfcard_no | note |+----+--------+--------+-------------+------------+| 10 | è¾›ä¹…å¥ˆ | FEMALE | 10000 | æ—‹æ¶¡è¾›ä¹…å¥ˆ |+----+--------+--------+-------------+------------+1 row in set (0.00 sec) mysql&gt; select * from t_student_selfcard;+----+------------+--------+------------+------------+--------------------+| id | student_id | native | issue_date | end_date | note |+----+------------+--------+------------+------------+--------------------+| 2 | 10 | ç¦å·ž | 2017-01-06 | 2017-01-06 | æ—‹æ¶¡è¾›ä¹…å¥ˆçš„å­¦ç”Ÿè¯ |+----+------------+--------+------------+------------+--------------------+1 row in set (0.00 sec)æ’å…¥æˆåŠŸï¼ŒçŽ°æµ‹è¯•çº§è”èŽ·å–ï¼š1234567...sqlSession = SqlSessionFactoryUtil.openSqlSession();StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);Student student = studentMapper.findStudentById(10L);System.out.println(student.getSelfCard().getNote());sqlSession.commit();...æŽ§åˆ¶å°è¾“å‡ºï¼š1æ—‹æ¶¡è¾›ä¹…å¥ˆçš„å­¦ç”Ÿè¯success.collectionå­¦ç”Ÿå’Œå­¦ç”Ÿæˆç»©æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œæ‰€ä»¥ç”¨t_studentå’Œt_student_lectureè¡¨ç»ƒä¹ ä¸€å¯¹å¤šçº§è”ã€‚ä¿®æ”¹Student POJOï¼š12345678910public class Student &#123; private Long id; private String cnName; private Sex sex; private Long selfCardNo; private String note; //ä¸€å¯¹å¤šå…³è” private List&lt;StudentLecture&gt; lectures; // getterï¼Œsetterç•¥&#125;æ–°å¢žStudentLecture POJOï¼š12345678public class StudentLecture &#123; private Long id; private Long studentId; private Long lectureId; private Double grade; private String note; // getterï¼Œsetterç•¥&#125;æ–°å»ºStudentLectureMapperæŽ¥å£ï¼š1234public interface StudentLectureMapper &#123; public List&lt;StudentLecture&gt; getLecturesByStudentId(Long studentId); public int insertStudentLecture(StudentLecture lecture);&#125;å…¶å¯¹åº”çš„æ˜ å°„æ–‡ä»¶StudentLectureMapper.xmlï¼š1234567891011121314151617181920212223242526&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentLectureMapper"&gt; &lt;resultMap type="studentLecture" id="lectures"&gt; &lt;id column="id" property="id"/&gt; &lt;result column="student_id" property="studentId"/&gt; &lt;result column="lecture_id" property="lectureId"/&gt; &lt;result column="grade" property="grade"/&gt; &lt;result column="note" property="note"/&gt; &lt;/resultMap&gt; &lt;sql id="student_lecture_column"&gt; id,student_id as studentId,lecture_id as lectureId,grade,note &lt;/sql&gt; &lt;select id="getLecturesByStudentId" parameterType="long" resultMap="lectures"&gt; select &lt;include refid="student_lecture_column"/&gt; from t_student_lecture where student_id = #&#123;studentId&#125; &lt;/select&gt; &lt;insert id="insertStudentLecture" parameterType="student"&gt; &lt;![CDATA[ insert into t_student_lecture(student_id,lecture_id,grade,note) values (#&#123;studentId&#125;,#&#123;lectureId&#125;,#&#123;grade&#125;,#&#123;note&#125;) ]]&gt; &lt;/insert&gt;&lt;/mapper&gt;ä¿®æ”¹StudentMapper.xmlï¼š12345678910111213141516171819202122232425262728293031&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentMapper"&gt; &lt;resultMap type="student" id="studentList"&gt; &lt;id column="id" property="id"/&gt; &lt;result column="cnname" property="cnName"/&gt; &lt;result column="sex" property="sex" typeHandler="org.apache.ibatis.type.EnumTypeHandler"/&gt; &lt;result column="selfcard_no" property="selfCardNo"/&gt; &lt;result column="note" property="note"/&gt; &lt;!-- ä¸€å¯¹å¤šå…³è”ï¼ŒcolumnæŒ‡å®šç”¨å“ªåˆ—çš„å€¼ä½œä¸ºselectæŸ¥è¯¢çš„æ¡ä»¶ï¼Œå¦‚æžœç”±å¤šä¸ªå€¼ç”¨ é€—å·éš”å¼€ï¼ŒselectæŒ‡å®šæŸ¥è¯¢æ–¹æ³•--&gt; &lt;collection property="lectures" column="id" select="mrbird.leanote.mapper.StudentLectureMapper.getLecturesByStudentId"/&gt; &lt;/resultMap&gt; &lt;sql id="student_column"&gt; id,cnname as cnName,sex,selfcard_no as selfCardNo,note &lt;/sql&gt; &lt;select id="findStudentById" parameterType="long" resultMap="studentList"&gt; select &lt;include refid="student_column"/&gt; from t_student where id = #&#123;id&#125; &lt;/select&gt; &lt;!-- è®¾ç½®ä¸»é”®å›žå¡«ï¼Œä¾›t_student_selfcardçš„student_idå­—æ®µä½¿ç”¨ --&gt; &lt;insert id="createStudent" parameterType="student" useGeneratedKeys="true" keyProperty="id"&gt; insert into t_student(cnname,sex,selfcard_no,note) values (#&#123;cnName&#125;, #&#123;sex,typeHandler=org.apache.ibatis.type.EnumTypeHandler&#125;, #&#123;selfCardNo&#125;,#&#123;note&#125;) &lt;/insert&gt;&lt;/mapper&gt;å…ˆæ’å…¥ä¸€äº›æµ‹è¯•æ•°æ®ï¼š12345678910111213141516171819202122232425...sqlSession = SqlSessionFactoryUtil.openSqlSession();StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);StudentLectureMapper lectureMapper = sqlSession.getMapper(StudentLectureMapper.class);Student student = new Student();student.setCnName("æ°´é—¨");student.setSelfCardNo(11111L);student.setNote("æ³¢é£Žæ°´é—¨");student.setSex(Sex.MALE);int n = studentMapper.createStudent(student);if(n == 1)&#123; Long studentId = student.getId(); String[] noteArr = new String[]&#123;"è¯­æ–‡æˆç»©","æ•°å­¦æˆç»©","è‹±è¯­æˆç»©"&#125;; Double[] gradeArr = new Double[]&#123;99.0,100.0,98.0&#125;; for(int i=0;i&lt;noteArr.length;i++)&#123; StudentLecture lecture = new StudentLecture(); lecture.setStudentId(studentId); lecture.setLectureId(Long.valueOf(i)); lecture.setGrade(gradeArr[i]); lecture.setNote(noteArr[i]); lectureMapper.insertStudentLecture(lecture); &#125;&#125;sqlSession.commit();...æŸ¥è¯¢æ•°æ®åº“ï¼š123456789101112131415161718mysql&gt; select * from t_student;+----+--------+--------+-------------+------------+| id | cnname | sex | selfcard_no | note |+----+--------+--------+-------------+------------+| 10 | è¾›ä¹…å¥ˆ | FEMALE | 10000 | æ—‹æ¶¡è¾›ä¹…å¥ˆ || 12 | æ°´é—¨ | MALE | 11111 | æ³¢é£Žæ°´é—¨ |+----+--------+--------+-------------+------------+2 rows in set (0.01 sec) mysql&gt; select * from t_student_lecture;+----+------------+------------+--------+----------+| id | student_id | lecture_id | grade | note |+----+------------+------------+--------+----------+| 1 | 12 | 0 | 99.00 | è¯­æ–‡æˆç»© || 2 | 12 | 1 | 100.00 | æ•°å­¦æˆç»© || 3 | 12 | 2 | 98.00 | è‹±è¯­æˆç»© |+----+------------+------------+--------+----------+3 rows in set (0.00 sec)æ’å…¥æˆåŠŸï¼ŒçŽ°æµ‹è¯•çº§è”èŽ·å–lecturesï¼š123456789...sqlSession = SqlSessionFactoryUtil.openSqlSession();StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);Student student = studentMapper.findStudentById(12L);List&lt;StudentLecture&gt; lectures = student.getLectures();for(StudentLecture l : lectures)&#123; System.out.println(l.getNote()+"ï¼š"+l.getGrade());&#125; ...æŽ§åˆ¶å°è¾“å‡ºï¼š123è¯­æ–‡æˆç»©ï¼š99.0æ•°å­¦æˆç»©ï¼š100.0è‹±è¯­æˆç»©ï¼š98.0success.discriminatoré‰´åˆ«å™¨å…¶å®žåŒå…¶ä»–çº§è”ä¸€æ ·ï¼Œåªä¸è¿‡æ˜¯å¤šäº†ä¸ªé‰´åˆ«çš„è¿‡ç¨‹ç½¢äº†ã€‚ä¸ºäº†å­¦ä¹ é‰´åˆ«å™¨ï¼Œæˆ‘ä»¬å‘t_student_health_femaleå’Œt_student_health_maleä¸­æ’å…¥ä¸€ç»„æ•°æ®ï¼š12345678910111213141516171819202122232425INSERT INTO `t_student_health_female`VALUES( 1, '10', '2017-1-6', 'å¿ƒæ­£å¸¸', 'è‚æ­£å¸¸', 'è„¾æ­£å¸¸', 'è‚ºæ­£å¸¸', 'è‚¾æ­£å¸¸', 'å­å®«æ­£å¸¸', 'å¥åº·'); INSERT INTO `t_student_health_male`VALUES( 1, '12', '2017-1-6', 'å¿ƒè„è‰¯å¥½', 'è‚è‰¯å¥½', 'è„¾è‰¯å¥½', 'è‚ºè‰¯å¥½', 'è‚¾è‰¯å¥½', 'å‰åˆ—è…ºè‰¯å¥½', 'å¥åº·');å…¶å¯¹åº”çš„å®žä½“ç±»StudentHealthFemaleå’ŒStudentHealthMaleç•¥ã€‚æ–°å¢žä¸¤ä¸ªPOJOï¼šMaleStudentå’ŒFemaleStudentå‡ç»§æ‰¿è‡ªStudentï¼š1234public class MaleStudent extends Student&#123; private List&lt;StudentHealthMale&gt; studentHealthMaleList; // getterï¼Œsetterç•¥&#125;1234public class FemaleStudent extends Student&#123; private List&lt;StudentHealthFemale&gt; studentHealthFemaleList; // getterï¼Œsetterç•¥&#125;æŽ¥ç€ç¼–å†™ä¸¤ä¸ªæŽ¥å£StudentHealthMaleMapperå’ŒStudentHealthFemaleMapperï¼ŒåŒ…å«ä¸€ä¸ªæ ¹æ®studentIdèŽ·å–healthçš„æŠ½è±¡æ–¹æ³•ï¼š12345import mrbird.leanote.pojo.StudentHealthMale; public interface StudentHealthMaleMapper &#123; public StudentHealthMale findStudentHealthMaleByStudentId(Long studentId);&#125;12345import mrbird.leanote.pojo.StudentHealthFemale; public interface StudentHealthFemaleMapper &#123; public StudentHealthFemale findStudentHealthFemaleByStudentId(Long studentId);&#125;å„è‡ªå¯¹åº”çš„æ˜ å°„å™¨ï¼šStudentHealthMaleMapper.xmlï¼š123456789&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentHealthMaleMapper"&gt; &lt;select id="findStudentHealthMaleByStudentId" parameterType="long" resultType="studentHealthMale"&gt; select * from t_student_health_male where student_id = #&#123;studentId&#125; &lt;/select&gt; &lt;/mapper&gt;å› ä¸ºåœ¨MyBatisé…ç½®æ–‡ä»¶ä¸­é…ç½®äº†&lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;ï¼Œå¹¶ä¸”æ•°æ®åº“å‘½åè§„èŒƒï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ç”¨select * fromâ€¦studentHealthFemaleMapper.xmlï¼š12345678&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentHealthFemaleMapper"&gt; &lt;select id="findStudentHealthFemaleByStudentId" parameterType="long" resultType="studentHealthFemale"&gt; select * from t_student_health_female where student_id = #&#123;studentId&#125; &lt;/select&gt; &lt;/mapper&gt;æŽ¥ä¸‹æ¥å°±æ˜¯é‡ç‚¹äº†ï¼Œæˆ‘ä»¬ä¿®æ”¹StudentMapper.xmlï¼š123456789101112131415161718192021222324252627282930313233343536373839&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentMapper"&gt; &lt;!-- å®šä¹‰maleStudentListï¼Œç±»åž‹ä¸ºâ€œmaleStudentâ€ã€‚è¿™æ˜¯ä¸€ä¸ªä¸€å¯¹å¤šå…³è”ï¼Œä¸€ä¸ªå­¦ç”Ÿå¯ä»¥ä½“æ£€å¤šæ¬¡ã€‚ è°ƒç”¨çš„æ–¹æ³•ä¸ºfindStudentHealthMaleByStudentIdã€‚ æ­£å¦‚å…¶POJOç»§æ‰¿Studenté‚£æ ·ï¼ŒresultMapä¹ŸåŒæ ·ç»§æ‰¿è‡ªstudentList--&gt; &lt;resultMap type="maleStudent" id="maleStudentList" extends="studentList"&gt; &lt;collection property="studentHealthMaleList" column="id" select="mrbird.leanote.mapper.StudentHealthMaleMapper .findStudentHealthMaleByStudentId"/&gt; &lt;/resultMap&gt; &lt;resultMap type="femaleStudent" id="femaleStudentList" extends="studentList"&gt; &lt;collection property="studentHealthFemaleList" column="id" select="mrbird.leanote.mapper.StudentHealthFemaleMapper .findStudentHealthFemaleByStudentId"/&gt; &lt;/resultMap&gt; &lt;resultMap type="student" id="studentList"&gt; &lt;id column="id" property="id"/&gt; &lt;result column="cnname" property="cnName"/&gt; &lt;result column="sex" property="sex"/&gt; &lt;result column="selfcard_no" property="selfCardNo"/&gt; &lt;result column="note" property="note"/&gt; &lt;!-- é…ç½®é‰´åˆ«å™¨ï¼Œç±»ä¼¼äºŽswitchï¼Œç”¨äºŽé‰´åˆ«çš„åˆ—ä¸ºâ€œsexâ€ï¼Œ å€¼ä¸ºMALEæ—¶ç»“æžœé›†ä¸ºmaleStudentList å€¼ä¸ºFEMALEæ—¶ç»“æžœé›†ä¸ºfemaleStudentList --&gt; &lt;discriminator javaType="string" column="sex"&gt; &lt;case value="MALE" resultMap="maleStudentList"&gt;&lt;/case&gt; &lt;case value="FEMALE" resultMap="femaleStudentList"&gt;&lt;/case&gt; &lt;/discriminator&gt; &lt;/resultMap&gt; &lt;sql id="student_column"&gt; id,cnname as cnName,sex,selfcard_no as selfCardNo,note &lt;/sql&gt; &lt;select id="findStudentById" parameterType="long" resultMap="studentList"&gt; select &lt;include refid="student_column"/&gt; from t_student where id = #&#123;id&#125; &lt;/select&gt;&lt;/mapper&gt;æµ‹è¯•ä¸€ä¸‹ï¼š1234567...sqlSession = SqlSessionFactoryUtil.openSqlSession();StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);MaleStudent student = (MaleStudent) studentMapper.findStudentById(12L);System.out.println(student.getCnName()+"çš„"+ student.getStudentHealthMaleList().get(0).getProstate());...é¡µé¢è¾“å‡ºï¼š1æ°´é—¨çš„å‰ä¾‹è…ºè‰¯å¥½(â‰– â€¿ â‰–)âœ§å»¶è¿ŸåŠ è½½å‡å¦‚ä¸€æ¬¡æ€§å°†æ‰€æœ‰ä¸ŽStudentæœ‰å…³çš„ä¿¡æ¯éƒ½åŠ è½½å‡ºæ¥ï¼Œè¿™å¿…å®šä¼šé€ æˆæ€§èƒ½çš„é—®é¢˜ï¼Œå¦‚ï¼š1234567891011121314151617181920212223&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentMapper"&gt; &lt;resultMap type="student" id="studentList"&gt; &lt;id column="id" property="id"/&gt; &lt;result column="cnname" property="cnName"/&gt; &lt;result column="sex" property="sex"/&gt; &lt;result column="selfcard_no" property="selfCardNo"/&gt; &lt;result column="note" property="note"/&gt; &lt;association property="selfCard" column="id" select="mrbird.leanote.mapper.StudentSelfcardMapper .findStudentSelfcardByStudentId"/&gt; &lt;collection property="lectures" column="id" select="mrbird.leanote.mapper.StudentLectureMapper .getLecturesByStudentId"/&gt; &lt;discriminator javaType="string" column="sex"&gt; &lt;case value="MALE" resultMap="maleStudentList"&gt;&lt;/case&gt; &lt;case value="FEMALE" resultMap="femaleStudentList"&gt;&lt;/case&gt; &lt;/discriminator&gt; &lt;/resultMap&gt; ... &lt;/mapper&gt;MyBatisçš„å»¶è¿ŸåŠ è½½ç­–ç•¥å¯ä»¥å¾ˆå¥½çš„åº”å¯¹è¿™ç§æƒ…å†µã€‚åªéœ€åœ¨mybatis-config.xmlä¸­é…ç½®ï¼š1234567&lt;settings&gt; ... &lt;!-- å¼€å¯å»¶è¿ŸåŠ è½½ --&gt; &lt;setting name="lazyLoadingEnabled" value="true"/&gt; &lt;!-- å…³é—­æŒ‰å±‚çº§åŠ è½½ --&gt; &lt;setting name="aggressiveLazyLoading" value="false"/&gt;&lt;/settings&gt;ç„¶åŽæˆ‘ä»¬åœ¨çº§è”æ ‡ç­¾ä¸Šå¯ä»¥è‡ªç”±çš„é…ç½®fetchType=â€lazyâ€æˆ–è€…fetchType=â€eagerâ€æ¥æ”¹å˜åŠ è½½ç­–ç•¥ã€‚eager è‹±[Ëˆi:gÉ™(r)] ç¾Ž[ËˆiÉ¡Éš] adj. æ€¥åˆ‡; æ¸´æœ›çš„; çƒ­å¿ƒçš„; çƒ­åˆ‡çš„ï¼Œçƒ­æƒ…æ´‹æº¢çš„;å¦å¤–ä¸€ç§çº§è”æ‰€è°“çš„å¦å¤–ä¸€ç§çº§è”å°±æ˜¯ç”¨ä¸€æ¡sqlæŸ¥å‡ºæ‰€æœ‰å­¦ç”Ÿçš„ä¿¡æ¯ï¼Œæ²¡æœ‰æ€§èƒ½é—®é¢˜ã€‚åœ¨StudentMapperä¸­å®šä¹‰ä¸€ä¸ªæŸ¥æ‰¾æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯çš„æŠ½è±¡æ–¹æ³•ï¼š1public List&lt;Student&gt; finAllStudentMsg();å…¶æ˜ å°„æ–‡ä»¶å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentMapper"&gt; &lt;select id="finAllStudentMsg" resultMap="allStudentList"&gt; select s.id,s.cnname,s.sex,s.selfcard_no,s.note as snote, IF (s.sex = 'MALE',shm.id,shf.id) as hid, IF (s.sex = 'MALE',shm.check_date,shf.check_date) as checkDate, IF (s.sex = 'MALE',shm.heart,shf.heart) as heart, IF (s.sex = 'MALE',shm.liver,shf.liver) as liver, IF (s.sex = 'MALE',shm.spleen,shf.spleen) as spleen, IF (s.sex = 'MALE',shm.lung,shf.lung) as lung, IF (s.sex = 'MALE',shm.kidney,shf.kidney) as kidney, IF (s.sex = 'MALE',shm.note,shf.note) as hnote, shm.prostate,shf.uterus, ss.id as ssid,ss.native as natives, ss.issue_date as issueDate,ss.end_date as endDate, ss.note as ssNote, sl.id as slid,sl.lecture_id as lectureId,sl.grade, sl.note as slNote FROM t_student s LEFT JOIN t_student_health_male shm on s.id = shm.student_id LEFT JOIN t_student_health_female shf on s.id = shf.student_id LEFT JOIN t_student_selfcard ss on s.id = ss.student_id LEFT JOIN t_student_lecture sl on s.id = sl.student_id &lt;/select&gt; &lt;resultMap type="student" id="allStudentList"&gt; &lt;id column="id" property="id"/&gt; &lt;result column="cnname" property="cnName"/&gt; &lt;result column="sex" property="sex"/&gt; &lt;result column="selfcard_no" property="selfCardNo"/&gt; &lt;result column="snote" property="note"/&gt; &lt;!-- javaTypeå±žæ€§å‘Šè¯‰MyBtisç”¨å“ªä¸ªç±»åŽ»æ˜ å°„è¿™äº›å­—æ®µ --&gt; &lt;association property="selfCard" column="id" javaType="studentSelfcard"&gt; &lt;result property="id" column="ssid"/&gt; &lt;result property="studentId" column="id"/&gt; &lt;result property="natives" column="natives"/&gt; &lt;result property="issueDate" column="issueDate"/&gt; &lt;result property="endDate" column="endDate"/&gt; &lt;result property="note" column="ssNote"/&gt; &lt;/association&gt; &lt;collection property="lectures" ofType="studentLecture"&gt; &lt;result property="id" column="slid"/&gt; &lt;result property="studentId" column="id"/&gt; &lt;result property="lectureId" column="lectureId"/&gt; &lt;result property="grade" column="grade"/&gt; &lt;result property="note" column="slNote"/&gt; &lt;/collection&gt; &lt;discriminator javaType="string" column="sex"&gt; &lt;case value="MALE" resultMap="maleStudentList"&gt;&lt;/case&gt; &lt;case value="FEMALE" resultMap="femaleStudentList"&gt;&lt;/case&gt; &lt;/discriminator&gt; &lt;/resultMap&gt; &lt;resultMap type="maleStudent" id="maleStudentList" extends="allStudentList"&gt; &lt;!-- ofTypeå±žæ€§æŒ‡å®šäº†å…¶æ³›åž‹ --&gt; &lt;collection property="studentHealthMaleList" ofType="studentHealthMale"&gt; &lt;id property="id" column="hid"/&gt; &lt;result property="studentId" column="id"/&gt; &lt;result property="checkDate" column="checkDate"/&gt; &lt;result property="heart" column="heart"/&gt; &lt;result property="liver" column="liver"/&gt; &lt;result property="spleen" column="spleen"/&gt; &lt;result property="lung" column="lung"/&gt; &lt;result property="kidney" column="kidney"/&gt; &lt;result property="prostate" column="prostate"/&gt; &lt;result property="note" column="hnote"/&gt; &lt;/collection&gt; &lt;/resultMap&gt; &lt;resultMap type="femaleStudent" id="femaleStudentList" extends="allStudentList"&gt; &lt;collection property="studentHealthFemaleList" ofType="studentHealthFemale"&gt; &lt;id property="id" column="hid"/&gt; &lt;result property="studentId" column="id"/&gt; &lt;result property="checkDate" column="checkDate"/&gt; &lt;result property="heart" column="heart"/&gt; &lt;result property="liver" column="liver"/&gt; &lt;result property="spleen" column="spleen"/&gt; &lt;result property="lung" column="lung"/&gt; &lt;result property="kidney" column="kidney"/&gt; &lt;result property="uterus" column="uterus"/&gt; &lt;result property="note" column="hnote"/&gt; &lt;/collection&gt; &lt;/resultMap&gt;&lt;/mapper&gt;æµ‹è¯•finAllStudentMsgæ–¹æ³•ï¼š12345678910111213141516171819202122232425262728293031323334...sqlSession = SqlSessionFactoryUtil.openSqlSession();StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);List&lt;Student&gt; students = studentMapper.finAllStudentMsg();for(Student student : students)&#123; if("MALE".equalsIgnoreCase(student.getSex().toString()))&#123; MaleStudent male = (MaleStudent) student; System.out.println(male.getCnName()+"çš„å¡å·ï¼š"+male.getSelfCardNo()); StudentSelfcard selfcard = male.getSelfCard(); System.out.println("æ¥è‡ªï¼š"+selfcard.getNatives()+","+selfcard.getNote()); List&lt;StudentLecture&gt; lectures = male.getLectures(); for(StudentLecture le : lectures)&#123; System.out.println(le.getNote()+"ï¼š"+le.getGrade()); &#125; List&lt;StudentHealthMale&gt; healthMales = male.getStudentHealthMaleList(); for(StudentHealthMale healthMale : healthMales)&#123; System.out.println(healthMale.getCheckDate()+"ï¼Œ"+healthMale.getProstate()); &#125; &#125;else&#123; FemaleStudent female = (FemaleStudent) student; System.out.println(female.getCnName()+"çš„å¡å·ï¼š"+female.getSelfCardNo()); StudentSelfcard selfcard = female.getSelfCard(); System.out.println("æ¥è‡ªï¼š"+selfcard.getNatives()+","+selfcard.getNote()); List&lt;StudentLecture&gt; lectures = female.getLectures(); for(StudentLecture le : lectures)&#123; System.out.println(le.getNote()+"ï¼š"+le.getGrade()); &#125; List&lt;StudentHealthFemale&gt; healthFemales = female.getStudentHealthFemaleList(); for(StudentHealthFemale healthfemale : healthFemales)&#123; System.out.println(healthfemale.getCheckDate()+"ï¼Œ"+healthfemale.getUterus()); &#125; &#125;&#125;...æŽ§åˆ¶å°è¾“å‡ºï¼š123456789101112è¾›ä¹…å¥ˆçš„å¡å·ï¼š10000æ¥è‡ªï¼šç¦å·ž,æ—‹æ¶¡è¾›ä¹…å¥ˆçš„å­¦ç”Ÿè¯è¯­æ–‡æˆç»©ï¼š99.0æ•°å­¦æˆç»©ï¼š99.0è‹±è¯­æˆç»©ï¼š99.02017-1-6ï¼Œå­å®«æ­£å¸¸æ°´é—¨çš„å¡å·ï¼š11111æ¥è‡ªï¼šåŽ¦é—¨,æ³¢é£Žæ°´é—¨çš„å­¦ç”Ÿè¯è¯­æ–‡æˆç»©ï¼š99.0æ•°å­¦æˆç»©ï¼š100.0è‹±è¯­æˆç»©ï¼š98.02017-1-6ï¼Œå‰ä¾‹è…ºè‰¯å¥½è¿™ç§æ–¹å¼æ¯”è¾ƒç›´è§‚æ˜Žäº†ï¼Œä½†æ˜¯SQLç¼–å†™èµ·æ¥è¾ƒä¸ºç¹çã€‚ã€Šæ·±å…¥æµ…å‡ºMyBatisæŠ€æœ¯åŽŸç†ä¸Žå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MyBatisæ˜ å°„å™¨]]></title>
    <url>%2FMyBatis%E6%98%A0%E5%B0%84%E5%99%A8.html</url>
    <content type="text"><![CDATA[æ˜ å°„å™¨çš„é…ç½®ï¼šå…ƒç´ åç§°æè¿°selectæŸ¥è¯¢è¯­å¥insertæ’å…¥è¯­å¥updateæ›´æ–°è¯­å¥deleteåˆ é™¤è¯­å¥sqlå…è®¸å®šä¹‰ä¸€éƒ¨åˆ†SQLï¼Œç„¶åŽå„ä¸ªåœ°æ–¹å¼•ç”¨resultMapç”¨äºŽå®šä¹‰ç»“æžœé›†cacheç»™å®šå‘½åæŽ§ä»¶çš„ç¼“å­˜é…ç½®cache-refå…¶å®ƒå‘½åæŽ§ä»¶ç¼“å­˜é…ç½®çš„å¼•ç”¨selectmapUnderscoreToCamelCaseæ•°æ®åº“å­—æ®µåä¸€èˆ¬é‡‡ç”¨ä¸‹åˆ’çº¿å‘½åè§„åˆ™ï¼Œè€Œjavaä¸­çš„å­—æ®µåç”¨çš„æ˜¯é©¼å³°å‘½åè§„åˆ™ï¼šJavaBeanæ•°æ®åº“ididroleNamerole_namenotenoteisGirl&nbsp; &nbsp;is_girlå¦‚æžœæ•°æ®åº“å­—æ®µå‘½åè§„èŒƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨settinsä¸­é…ç½®mapUnderscoreToCamelCaseä¸ºtrueï¼š123&lt;settings&gt; &lt;setting name="mapUnderscoreToCamelCase" value="true"/&gt;&lt;/settings&gt;MyBatiså°±ä¼šè‡ªåŠ¨å°†æ•°æ®åº“å­—æ®µåè½¬æ¢ä¸ºJavaBeançš„å­—æ®µåï¼Œæ¯”å¦‚ï¼š123&lt;select id="getRole" parameterType="long" resultType="role"&gt; &lt;![CDATA[select * from t_role where id = #&#123;id&#125;]]&gt;&lt;/select&gt;å¦‚æžœä¸å°†mapUnderscoreToCamelCaseè®¾ç½®ä¸ºtrueï¼Œåˆ™selectå…ƒç´ å¿…é¡»æŒ‡æ˜Žå­—æ®µåˆ«åï¼š1234&lt;select id="getRole" parameterType="long" resultType="role"&gt; &lt;![CDATA[select id,role_name as roleName, note,is_girl as isGirl from t_role where id = #&#123;id&#125;]]&gt;&lt;/select&gt;å¦åˆ™æ²¡æœ‰å¯¹åº”ä¸Šçš„å­—æ®µå€¼ä¸ºnullã€‚ä¼ é€’å¤šä¸ªå‚æ•°1.ä½¿ç”¨Mapä¼ å‚å®šä¹‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼š1public List&lt;Role&gt; getRole(Map&lt;String,String&gt; params);æ˜ å°„æ–‡ä»¶ä¸­é…ç½®selectï¼š12345678910111213&lt;resultMap type="role" id="roleList"&gt; &lt;id column="id" property="id"/&gt; &lt;result column="role_name" property="roleName"/&gt; &lt;result column="note" property="note"/&gt; &lt;result column="is_girl" property="isGirl" javaType="Boolean" jdbcType="VARCHAR"/&gt;&lt;/resultMap&gt;&lt;select id="getRole" resultMap="roleList"&gt; &lt;![CDATA[select * from t_role where role_name like concat('%',#&#123;roleName&#125;,'%') and note like concat('%',#&#123;note&#125;,'%') ]]&gt;&lt;/select&gt;æµ‹è¯•ï¼š1234567891011...sqlSession = SqlSessionFactoryUtil.openSqlSession();RoleMapper mapper = sqlSession.getMapper(RoleMapper.class);Map&lt;String,String&gt; params = new HashMap&lt;String,String&gt;();params.put("roleName", "é›ç”°");params.put("note", "æ—¥å‘");List&lt;Role&gt; roleList = mapper.getRole(params);for(Role r : roleList)&#123; System.out.println(r.getRoleName()+" is a girl:"+r.getIsGirl());&#125;...è¾“å‡ºï¼š1é›ç”° is a girl:true2.ä½¿ç”¨æ³¨è§£ä¼ å‚ä¿®æ”¹æŠ½è±¡æ–¹æ³•ï¼š12public List&lt;Role&gt; getRole(@Param("roleName")String roleName, @Param("note")String note);æµ‹è¯•ï¼š12345678...sqlSession = SqlSessionFactoryUtil.openSqlSession();RoleMapper mapper = sqlSession.getMapper(RoleMapper.class);List&lt;Role&gt; roleList = mapper.getRole("é›ç”°", "æ—¥å‘");for(Role r : roleList)&#123; System.out.println(r.getRoleName()+" is a girl:"+r.getIsGirl());&#125;...è¾“å‡ºï¼š1é›ç”° is a girl:true3.ä½¿ç”¨JavaBeanä¼ å‚å®šä¹‰ä¸€ä¸ªä¼ é€’å‚æ•°JavaBeanï¼š12345678910111213141516public class RoleParams &#123; private String roleName; private String note; public String getRoleName() &#123; return roleName; &#125; public void setRoleName(String roleName) &#123; this.roleName = roleName; &#125; public String getNote() &#123; return note; &#125; public void setNote(String note) &#123; this.note = note; &#125;&#125;ä¿®æ”¹æŠ½è±¡æ–¹æ³•ï¼š1public List&lt;Role&gt; getRole(RoleParams params);æµ‹è¯•ï¼š1234567891011...sqlSession = SqlSessionFactoryUtil.openSqlSession();RoleMapper mapper = sqlSession.getMapper(RoleMapper.class);RoleParams params = new RoleParams();params.setRoleName("é¸£äºº");params.setNote("æ—‹æ¶¡");List&lt;Role&gt; roleList = mapper.getRole(params);for(Role r : roleList)&#123; System.out.println(r.getRoleName()+" is a girl:"+r.getIsGirl());&#125;...è¾“å‡ºï¼š1é¸£äºº is a girl:falseinsertä¸»é”®å›žå¡«å’Œè‡ªå®šä¹‰å¼€å‘ä¸­æœ‰æ—¶å€™éœ€è¦èŽ·å–åˆ°æ’å…¥è¡Œçš„ä¸»é”®å€¼ï¼ŒMyBatisçš„ä¸»é”®å›žå¡«å¯ä»¥å®Œæˆè¿™ä¸ªåŠŸèƒ½ã€‚å®šä¹‰ä¸€ä¸ªcreateRoleæŠ½è±¡æ–¹æ³•ï¼š1public int createRole(Role role);æ˜ å°„ï¼š1234567&lt;insert id="createRole" parameterType="role" useGeneratedKeys="true" keyProperty="id"&gt; &lt;![CDATA[ insert into t_role(role_name,note,is_girl) values (#&#123;roleName&#125;,#&#123;note&#125;, #&#123;isGirl,typeHandler=mrbird.leanote.typehandler.BooleanTypeHandler&#125;) ]]&gt;&lt;/insert&gt;useGeneratedKeysä¼šä½¿MyBatisä½¿ç”¨JDBCçš„getGeneratedKeysæ–¹æ³•æ¥èŽ·å–å‡ºç”±æ•°æ®åº“å†…éƒ¨ç”Ÿæˆçš„ä¸»é”®ï¼ŒkeyPropertyè¡¨ç¤ºä»¥å“ªä¸ªåˆ—ä¸ºå±žæ€§çš„ä¸»é”®ã€‚æµ‹è¯•èŽ·å–ä¸»é”®ï¼š1234567891011...sqlSession = SqlSessionFactoryUtil.openSqlSession();RoleMapper mapper = sqlSession.getMapper(RoleMapper.class);Role role = new Role();role.setRoleName("ä½åŠ©");role.setNote("å®‡æ™ºæ³¢");role.setIsGirl(Boolean.FALSE);mapper.createRole(role);System.out.println(role.getId()); //7sqlSession.commit();...é¡µé¢è¾“å‡º 7ï¼ŒæŸ¥è¯¢æ•°æ®åº“ï¼š123456789mysql&gt; select * from t_role;+----+-----------+----------+---------+| id | role_name | note | is_girl |+----+-----------+----------+---------+| 1 | é›ç”° | æ—¥å‘é›ç”° | Y || 2 | é¸£äºº | æ—‹æ¶¡é¸£äºº | N || 7 | ä½åŠ© | å®‡æ™ºæ³¢ | N |+----+-----------+----------+---------+3 rows in set (0.00 sec)å‡å¦‚æ•°æ®åº“ä¸»é”®æ²¡æœ‰è®¾ç½®è‡ªå¢žï¼Œæˆ‘ä»¬çš„è¦æ±‚æ˜¯ï¼šå¦‚æžœè¡¨t_roleæ²¡æœ‰è®°å½•ï¼Œåˆ™idè®¾ç½®ä¸º1ï¼Œå¦åˆ™æˆ‘ä»¬å–æœ€å¤§idåŠ 2ã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥å¯¹æ˜ å°„æ–‡ä»¶çš„insertæ ‡ç­¾ç¨ä½œä¿®æ”¹ï¼š1234567891011121314&lt;insert id="createRole" parameterType="role" useGeneratedKeys="true" keyProperty="id"&gt; &lt;!-- resultTypeå¿…é¡»å’ŒPOJOé‡Œidçš„ç±»åž‹ä¸€è‡´ --&gt; &lt;selectKey keyProperty="id" resultType="long" order="BEFORE"&gt; &lt;![CDATA[ select if(max(id) is null,1,max(id)+2) as id from t_role ]]&gt; &lt;/selectKey&gt; &lt;![CDATA[ insert into t_role(id,role_name,note,is_girl) values (#&#123;id&#125;,#&#123;roleName&#125;, #&#123;note&#125;, #&#123;isGirl,typeHandler=mrbird.leanote.typehandler.BooleanTypeHandler&#125;) ]]&gt;&lt;/insert&gt;æµ‹è¯•ï¼š1234567891011...sqlSession = SqlSessionFactoryUtil.openSqlSession();RoleMapper mapper = sqlSession.getMapper(RoleMapper.class);Role role = new Role();role.setRoleName("å°æ¨±");role.setNote("æ˜¥é‡Žæ¨±");role.setIsGirl(Boolean.TRUE);mapper.createRole(role);System.out.println(role.getId()); //9sqlSession.commit();...è¾“å‡º9å’Œæˆ‘ä»¬é¢„æœŸçš„ä¸€è‡´ï¼ŒæŸ¥è¯¢æ•°æ®åº“ï¼š12345678910mysql&gt; select * from t_role;+----+-----------+----------+---------+| id | role_name | note | is_girl |+----+-----------+----------+---------+| 1 | é›ç”° | æ—¥å‘é›ç”° | Y || 2 | é¸£äºº | æ—‹æ¶¡é¸£äºº | N || 7 | ä½åŠ© | å®‡æ™ºæ³¢ | N || 9 | å°æ¨± | æ˜¥é‡Žæ¨± | Y |+----+-----------+----------+---------+4 rows in set (0.00 sec)update &amp; deleteupdateå’Œdeleteè¾ƒä¸ºç®€å•ï¼Œä¸€ä¸ªç®€å•çš„æ›´æ–°å’Œåˆ é™¤ä¾‹å­ï¼š1234567891011&lt;update id="updateRole" parameterType="role"&gt; &lt;![CDATA[ update t_role set role_name = #&#123;roleName&#125;, note = #&#123;note&#125; where id = #&#123;id&#125; ]]&gt;&lt;/update&gt;&lt;delete id="deleteRole" parameterType="long"&gt; &lt;![CDATA[ delete from t_role where id = #&#123;id&#125; ]]&gt;&lt;/delete&gt;å‚æ•°å‚æ•°é…ç½®å‚æ•°é™¤äº†å¯ä»¥æŒ‡å®šjavaTypeï¼ŒjdbcTypeå’ŒtypeHandlerå¤–ï¼Œè¿˜å¯ä»¥å¯¹æ•°å€¼ç±»åž‹çš„å‚æ•°è®¾ç½®ç²¾åº¦ï¼š1#&#123;price,javaType=double,jdbcType=NUMERIC,numericScale=2&#125;$ä¸Žäº•#{}çš„å€¼è¢«ä½œä¸ºsqlçš„å‚æ•°ï¼Œè€Œ${}åˆ™ä¼šè¢«å½“ä½œsqlçš„ä¸€éƒ¨åˆ†ã€‚sqlå…ƒç´ sqlå…ƒç´ çš„ä½œç”¨æ˜¯å¯ä»¥å®šä¹‰sqlè¯­å¥çš„ä¸€éƒ¨åˆ†ï¼Œç„¶åŽå¯¼å‡ºå¼•ç”¨ï¼š123456789&lt;sql id="t_role_column"&gt; &lt;![CDATA[id,role_name as roleName,note,is_girl as isGirl]]&gt;&lt;/sql&gt;&lt;select id="getRole" resultMap="roleList"&gt; select &lt;include refid="t_role_column"/&gt; from t_role where role_name like concat('%',#&#123;roleName&#125;,'%') and note like concat('%',#&#123;note&#125;,'%')&lt;/select&gt;ä¸Šè¿°ä»£ç å®šä¹‰äº†ä¸€ä¸ªidä¸ºt_role_columnçš„sqlï¼Œç„¶åŽåœ¨selectå…ƒç´ ä¸­ä½¿ç”¨includeå…ƒç´ å¼•ç”¨äº†å®ƒï¼Œä»Žè€Œè¾¾åˆ°äº†é‡ç”¨çš„åŠŸèƒ½ã€‚è¿˜å¯ä»¥åœ¨sqlå…ƒç´ ä¸­æŒ‡å®šæ ‡ç­¾ï¼š12345678910111213&lt;sql id="t_role_column"&gt; &lt;![CDATA[$&#123;prefix&#125;.id,$&#123;prefix&#125;.role_name as roleName, $&#123;prefix&#125;.note,$&#123;prefix&#125;.is_girl as isGirl]]&gt;&lt;/sql&gt;&lt;select id="getRole" resultMap="roleList"&gt; select &lt;include refid="t_role_column"&gt; &lt;property name="prefix" value="t"/&gt; &lt;/include&gt; from t_role t where t.role_name like concat('%',#&#123;roleName&#125;,'%') and t.note like concat('%',#&#123;note&#125;,'%')&lt;/select&gt;è¿™ä¸ªåŠŸèƒ½åœ¨ä½¿ç”¨å…³è”æŸ¥è¯¢çš„æ—¶å€™è¾ƒä¸ºæ–¹ä¾¿ã€‚çº§è”ðŸŽ‰MyBatisçº§è”cacheðŸŽ‰MyBatisç¼“å­˜æœºåˆ¶ã€Šæ·±å…¥æµ…å‡ºMyBatisæŠ€æœ¯åŽŸç†ä¸Žå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MyBatisé…ç½®æ–‡ä»¶]]></title>
    <url>%2FMyBatis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.html</url>
    <content type="text"><![CDATA[MyBatisé…ç½®æ–‡ä»¶mybatis-config.xmlåŒ…å«ï¼šâ–  propertiesï¼šç”¨äºŽé…ç½®å±žæ€§ä¿¡æ¯ã€‚â–  settingsï¼šç”¨äºŽé…ç½®MyBatisçš„è¿è¡Œæ—¶æ–¹å¼ã€‚â–  typeAliasesï¼šé…ç½®ç±»åž‹åˆ«åï¼Œå¯ä»¥åœ¨xmlä¸­ç”¨åˆ«åå–ä»£å…¨é™å®šåã€‚â–  typeHandlersï¼šé…ç½®ç±»åž‹å¤„ç†å™¨ã€‚â–  pluginsï¼šé…ç½®æ‹¦æˆªå™¨ï¼Œç”¨äºŽæ‹¦æˆªsqlè¯­å¥çš„æ‰§è¡Œã€‚â–  environmentsï¼šé…ç½®æ•°æ®æºä¿¡æ¯ã€è¿žæŽ¥æ± ã€äº‹åŠ¡å±žæ€§ç­‰ã€‚â–  mappersï¼šé…ç½®SQLæ˜ å°„æ–‡ä»¶ã€‚æ³¨æ„ï¼šè¿™äº›é…ç½®å¿…é¡»æŒ‰ç…§ä¸Šè¿°çš„é¡ºåºè¿›è¡Œé…ç½®ï¼]]></content>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MyBatis typeHandler]]></title>
    <url>%2FMyBatis-typeHandler.html</url>
    <content type="text"><![CDATA[MyBatisåœ¨è®¾ç½®å‚æ•°æˆ–è€…ä»Žç»“æžœé›†ä¸­èŽ·å–å‚æ•°çš„æ—¶å€™ï¼Œéƒ½ä¼šç”¨åˆ°æ³¨å†Œäº†çš„typeHandlerè¿›è¡Œå¤„ç†ã€‚typeHandlerçš„ä½œç”¨ä¸ºå°†å‚æ•°ä»ŽjavaTypeè½¬ä¸ºjdbcTypeï¼Œæˆ–è€…ä»Žæ•°æ®åº“å–å‡ºç»“æžœæ—¶æŠŠjdbcTypeè½¬ä¸ºjavaTypeã€‚å¸¦çš„typeHandlerç±»åž‹å¤„ç†å™¨Javaç±»åž‹JDBCç±»åž‹BooleanTypeHandlerjava.lang.Boolean,booleanæ•°æ®åº“å…¼å®¹çš„BOOLEANByteTypeHandlerjava.lang.Byte,byteæ•°æ®åº“å…¼å®¹çš„NUMERICæˆ–BYTEShortTypeHandler&nbsp;&nbsp;&nbsp;&nbsp;java.lang.Short,shortæ•°æ®åº“å…¼å®¹çš„NUMERICæˆ–SHORT INTEGERIntegerTypeHandler&nbsp;java.lang.Integer,intæ•°æ®åº“å…¼å®¹çš„NUMERICæˆ–INTEGERLongTypeHandler&nbsp;java.lang.Long,longæ•°æ®åº“å…¼å®¹çš„NUMERICæˆ–LONG INTEGERFloatTypeHandler&nbsp;java.lang.Float,floatæ•°æ®åº“å…¼å®¹çš„NUMERICæˆ–FLOATDoubleTypeHandler&nbsp;java.lang.Double,doubleæ•°æ®åº“å…¼å®¹çš„NUMERICæˆ–DOUBLEBigDecimalTypeHandlerjava.math.BigDecimalæ•°æ®åº“å…¼å®¹çš„NUMERICæˆ–DECIMALStringTypeHandler&nbsp;java.lang.StirngCHAR,VARCHARClobypeHandler&nbsp;java.lang.StringCLOB,LONGVARCHARNStringTypeHanlerjava.lang.StringNVARCHAR,NCHARNClobTypeHandler&nbsp;java.lang.StringNNCLOBByteArrayTypeHandler&nbsp;byte[]æ•°æ®åº“å…¼å®¹çš„å­—èŠ‚æµç±»åž‹BlobTypeHandler&nbsp;byte[]BLOB,LONGVARBINARYDateTypeHandler&nbsp;java.util.DateTIMESTAMPDateOnlyTypeHandler&nbsp;java.util.DateDATETimeOnlyTypeHandler&nbsp;java.util.DateTIMESqlTimestampTypeHandler&nbsp;java.sql.TimestampTIMESTAMPSqlDateTypeHandler&nbsp;java.sql.DateDATESqlTimeTypeHandler&nbsp;java.sql.TimeTIMEObjectTypeHandler&nbsp;AnyOTHERæˆ–æœªæŒ‡å®šç±»åž‹EnumTypeHandler&nbsp;Enumeration TypeVARCHARæˆ–ä»»æ„å…¼å®¹çš„å­—ç¬¦ä¸²ç±»åž‹ï¼Œå­˜ å‚¨æžšä¸¾çš„åç§°EnumOrdinalTypeHandler&nbsp;Enumeration Typeä»»ä½•å…¼å®¹çš„NUMERICæˆ–DOUBLEç±»åž‹ï¼Œ å­˜å‚¨æžšä¸¾çš„ç´¢å¼•ä¸ºäº†æ¼”ç¤ºè‡ªå¸¦çš„typeHandlerï¼Œæ–°å»ºä¸€å¼ è¡¨ï¼š1234567CREATE TABLE `t_role` ( `id` int(20) NOT NULL AUTO_INCREMENT COMMENT 'ç¼–å·', `role_name` varchar(60) NOT NULL COMMENT 'è§’è‰²åç§°', `note` varchar(1024) DEFAULT NULL COMMENT 'å¤‡æ³¨', `is_girl` varchar(20) DEFAULT NULL COMMENT 'æ˜¯å¦ä¸ºå¥³å­©', PRIMARY KEY (`id`))åº“è¡¨å¯¹åº”çš„å®žä½“ç±»Roleç•¥ã€‚æŽ¥å£RoleMapperä¸­å®šä¹‰ä¸€ä¸ªcreateRole()æŠ½è±¡æ–¹æ³•ï¼š1public int createRole(Role role);æ˜ å°„æ–‡ä»¶ï¼š123456&lt;insert id="createRole" parameterType="role"&gt; &lt;![CDATA[ insert into t_role(role_name,note,is_girl) values (#&#123;roleName&#125;,#&#123;note&#125;, #&#123;isGirl&#125;) ]]&gt;&lt;/insert&gt;æµ‹è¯•æ’å…¥æ–¹æ³•ï¼š12345678910......sqlSession = SqlSessionFactoryUtil.openSqlSession();RoleMapper roleMapper = sqlSession.getMapper(RoleMapper.class);Role role = new Role();role.setRoleName("é›ç”°");role.setNote("æ—¥å‘é›ç”°");role.setIsGirl(Boolean.TRUE);roleMapper.createRole(role);sqlSession.commit();......æŸ¥è¯¢æ•°æ®åº“ï¼š1234567mysql&gt; select * from t_role;+----+-----------+----------+---------+| id | role_name | note | is_girl |+----+-----------+----------+---------+| 1 | é›ç”° | æ—¥å‘é›ç”° | 1 |+----+-----------+----------+---------+1 row in set (0.00 sec)ä»Žç»“æžœä¸­å¯ä»¥çœ‹å‡ºï¼Œé»˜è®¤çš„BooleantypeHandlerå°†trueè½¬æ¢ä¸ºäº†1ã€‚å¦‚æžœæƒ³æŠŠtrueè½¬æ¢ä¸ºY,falseè½¬æ¢ä¸ºN,æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰BooleantypeHandlerã€‚è‡ªå®šä¹‰typeHandlerè‡ªå®šä¹‰typeHandlerå¯ä»¥é€šè¿‡ç»§æ‰¿BasetypeHandleræˆ–è€…å®žçŽ°typeHandleræŽ¥å£æ¥å®žçŽ°ï¼ŒçŽ°è‡ªå®šä¹‰ä¸€ä¸ªBooleanTypeHandlerï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950package mrbird.leanote.typehandler; import java.sql.CallableStatement;import java.sql.PreparedStatement;import java.sql.ResultSet;import java.sql.SQLException;import org.apache.ibatis.type.JdbcType;import org.apache.ibatis.type.TypeHandler; public class BooleanTypeHandler implements TypeHandler&lt;Boolean&gt;&#123; @Override public Boolean getResult(ResultSet arg0, String arg1) throws SQLException &#123; String str = arg0.getString(arg1); Boolean flag = Boolean.FALSE; if(str.equalsIgnoreCase("Y"))&#123; flag = Boolean.TRUE; &#125; return flag; &#125; @Override public Boolean getResult(ResultSet arg0, int arg1) throws SQLException &#123; String str = arg0.getString(arg1); Boolean flag = Boolean.FALSE; if(str.equalsIgnoreCase("Y"))&#123; flag = Boolean.TRUE; &#125; return flag; &#125; @Override public Boolean getResult(CallableStatement arg0, int arg1) throws SQLException &#123; String str = arg0.getString(arg1); Boolean flag = Boolean.FALSE; if(str.equalsIgnoreCase("Y"))&#123; flag = Boolean.TRUE; &#125; return flag; &#125; @Override public void setParameter(PreparedStatement arg0, int arg1, Boolean arg2, JdbcType arg3) throws SQLException &#123; Boolean flag = (Boolean) arg2; String value = flag == true ? "Y" : "N"; arg0.setString(arg1, value); &#125;&#125;åœ¨mybatis-config.xmlæ–‡ä»¶ä¸­é…ç½®è¯¥typeHandlerï¼š1234&lt;typeHandlers&gt; &lt;typeHandler javaType="Boolean" jdbcType="VARCHAR" handler="mrbird.leanote.typehandler.BooleanTypeHandler" /&gt;&lt;/typeHandlers&gt;ç„¶åŽåœ¨æ˜ å°„æ–‡ä»¶ä¸­å¯¹éœ€è¦è½¬æ¢çš„å­—æ®µæ ‡æ³¨javaTypeå’ŒjdbcTypeï¼Œæˆ–è€…æ— éœ€åœ¨mybatis-config.xmlä¸­æ³¨å†Œç›´æŽ¥åœ¨æ˜ å°„æ–‡ä»¶ä¸­æŒ‡æ˜ŽtypeHandlerçš„è·¯å¾„å³å¯ã€‚æŒ‡æ˜ŽjavaTypeå’ŒjdbcTypeï¼Œä¸Žæ³¨å†Œä¸­çš„ä¸€è‡´å³å¯æ‰¾åˆ°ç›¸å¯¹åº”çš„typeHandlerï¼š123456&lt;insert id="createRole" parameterType="role"&gt; &lt;![CDATA[ insert into t_role(role_name,note,is_girl) values (#&#123;roleName&#125;,#&#123;note&#125;, #&#123;isGirl,javaType=Boolean,jdbcType=VARCHAR&#125;) ]]&gt;&lt;/insert&gt;æˆ–æŒ‡æ˜ŽtypeHandlerè·¯å¾„ï¼š123456&lt;insert id="createRole" parameterType="role"&gt; &lt;![CDATA[ insert into t_role(role_name,note,is_girl) values (#&#123;roleName&#125;,#&#123;note&#125;, #&#123;isGirl,typeHandler=mrbird.leanote.typehandler.BooleanTypeHandler&#125;) ]]&gt;&lt;/insert&gt;æµ‹è¯•ï¼š12345678910......sqlSession = SqlSessionFactoryUtil.openSqlSession();RoleMapper roleMapper = sqlSession.getMapper(RoleMapper.class);Role role = new Role();role.setRoleName("é¸£äºº");role.setNote("æ—‹æ¶¡é¸£äºº");role.setIsGirl(Boolean.FALSE);roleMapper.createRole(role);sqlSession.commit();......æŸ¥è¯¢æ•°æ®åº“ï¼š12345678mysql&gt; select * from t_role;+----+-----------+----------+---------+| id | role_name | note | is_girl |+----+-----------+----------+---------+| 1 | é›ç”° | æ—¥å‘é›ç”° | 1 || 2 | é¸£äºº | æ—‹æ¶¡é¸£äºº | N |+----+-----------+----------+---------+2 rows in set (0.00 sec)å¯å‘çŽ°ï¼Œfalseå·²ç»è½¬æ¢ä¸ºNäº†ã€‚æžšä¸¾ç±»åž‹typeHandlerMyBatisè‡ªå¸¦ä¸¤ç§æžšä¸¾ç±»åž‹å¤„ç†å™¨ï¼š1.org.apache.ibatis.type.EnumOrdinalTypeHandler2.org.apache.ibatis.type.EnumTypeHandlerEnumOrdinalTypeHandlerä½¿ç”¨æ•´æ•°ä¸‹æ ‡ä¼ é€’ï¼ŒEnumTypeHandlerä½¿ç”¨æžšä¸¾å­—ç¬¦ä¸²ä¼ é€’ã€‚åˆ›å»ºä¸€ä¸ªæžšä¸¾ç±»åž‹Sexï¼š1234567891011121314151617181920212223package mrbird.leanote.enums; public enum Sex &#123; MALE(1,"ç”·"),FEMALE(2,"å¥³"); private int id; private String name; private Sex(int id, String name) &#123; this.id = id; this.name = name; &#125; public int getId() &#123; return id; &#125; public void setId(int id) &#123; this.id = id; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125;&#125;EnumOrdinalTypeHandleråˆ›å»ºä¸€å¼ è¡¨æ¥æ¼”ç¤ºEnumOrdinalTypeHandlerï¼š12345678CREATE TABLE `t_student` ( `id` int(20) NOT NULL AUTO_INCREMENT COMMENT 'ç¼–å·', `cnname` varchar(60) NOT NULL COMMENT 'å­¦ç”Ÿå§“å', `sex` tinyint(4) NOT NULL COMMENT 'æ€§åˆ«', `selfcard_no` int(20) NOT NULL COMMENT 'å­¦ç”Ÿè¯å·', `note` varchar(1024) DEFAULT NULL COMMENT 'å¤‡æ³¨', PRIMARY KEY (`id`))è¿™é‡Œsexå­—æ®µç±»åž‹ä¸ºtinyintç±»åž‹ã€‚Studentå®žä½“ç±»ç•¥ã€‚å®šä¹‰ä¸€ä¸ªinterfaceï¼š123456789package mrbird.leanote.mapper; import java.util.List;import mrbird.leanote.pojo.Student; public interface StudentMapper &#123; public List&lt;Student&gt; getAllStudent(); public int createStudent(Student stu);&#125;å¯¹åº”çš„æ˜ å°„æ–‡ä»¶StudentMapper.xmlï¼š123456789101112131415161718192021222324&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentMapper"&gt; &lt;resultMap type="student" id="studentList"&gt; &lt;id column="id" property="id"/&gt; &lt;result column="cnname" property="cnName"/&gt; &lt;result column="sex" property="sex" typeHandler="org.apache.ibatis.type.EnumOrdinalTypeHandler"/&gt; &lt;result column="selfcard_no" property="selfCardNo"/&gt; &lt;result column="note" property="note"/&gt; &lt;/resultMap&gt; &lt;select id="getAllStudent" resultMap="studentList"&gt; &lt;![CDATA[select * from t_student]]&gt; &lt;/select&gt; &lt;insert id="createStudent" parameterType="student"&gt; &lt;![CDATA[ insert into t_student(cnname,sex,selfcard_no,note) values ( #&#123;cnName&#125;, #&#123;sex,typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler&#125;, #&#123;selfCardNo&#125;,#&#123;note&#125;) ]]&gt; &lt;/insert&gt;&lt;/mapper&gt;æµ‹è¯•createStudentæ–¹æ³•ï¼š12345678910...StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);Student stu = new Student();stu.setCnName("é¸£äºº");stu.setSex(Sex.MALE);stu.setSelfCardNo(1L);stu.setNote("æ¼©æ¶¡é¸£äºº");studentMapper.createStudent(stu);sqlSession.commit();...æŸ¥è¯¢æ•°æ®åº“ï¼š1234567mysql&gt; select * from t_student;+----+--------+-----+-------------+----------+| id | cnname | sex | selfcard_no | note |+----+--------+-----+-------------+----------+| 1 | é¸£äºº | 0 | 1 | æ¼©æ¶¡é¸£äºº |+----+--------+-----+-------------+----------+1 row in set (0.00 sec)å¯è§EnumOrdinalTypeHandlerå·²ç»å°†MALEè½¬æ¢ä¸ºäº†MALEçš„ä¸‹æ ‡äº†ã€‚æµ‹è¯•getAllStudentæ–¹æ³•ï¼š1234567...StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);List&lt;Student&gt; students = studentMapper.getAllStudent();for(Student stu : students)&#123; System.out.println(stu.getCnName()+"æ€§åˆ«ï¼š"+stu.getSex());&#125;...æŽ§åˆ¶å°è¾“å‡ºï¼š1é¸£äººæ€§åˆ«ï¼šMALEEnumTypeHandlerä¸ºäº†æ¼”ç¤ºEnumTypeHandlerï¼Œæˆ‘ä»¬éœ€è¦æŠŠsexå­—æ®µç±»åž‹æ”¹ä¸ºVARCHARï¼š1alter table t_student modify column sex VARCHAR(20);ä¿®æ”¹æ˜ å°„æ–‡ä»¶ä¸­çš„typeHandlerï¼š123456789101112131415161718192021222324&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;mapper namespace="mrbird.leanote.mapper.StudentMapper"&gt; &lt;resultMap type="student" id="studentList"&gt; &lt;id column="id" property="id"/&gt; &lt;result column="cnname" property="cnName"/&gt; &lt;result column="sex" property="sex" typeHandler="org.apache.ibatis.type.EnumTypeHandler"/&gt; &lt;result column="selfcard_no" property="selfCardNo"/&gt; &lt;result column="note" property="note"/&gt; &lt;/resultMap&gt; &lt;select id="getAllStudent" resultMap="studentList"&gt; &lt;![CDATA[select * from t_student]]&gt; &lt;/select&gt; &lt;insert id="createStudent" parameterType="student"&gt; &lt;![CDATA[ insert into t_student(cnname,sex,selfcard_no,note) values ( #&#123;cnName&#125;, #&#123;sex,typeHandler=org.apache.ibatis.type.EnumTypeHandler&#125;, #&#123;selfCardNo&#125;,#&#123;note&#125;) ]]&gt; &lt;/insert&gt;&lt;/mapper&gt;æµ‹è¯•createStudentæ–¹æ³•ï¼š12345678910...StudentMapper studentMapper = sqlSession.getMapper(StudentMapper.class);Student stu = new Student();stu.setCnName("é›ç”°");stu.setSex(Sex.FEMALE);stu.setSelfCardNo(2L);stu.setNote("æ—¥å‘é›ç”°");studentMapper.createStudent(stu);sqlSession.commit();...æŸ¥è¯¢æ•°æ®åº“ï¼š1234567mysql&gt; select * from t_student where selfcard_no = '2';+----+--------+--------+-------------+----------+| id | cnname | sex | selfcard_no | note |+----+--------+--------+-------------+----------+| 2 | é›ç”° | FEMALE | 2 | æ—¥å‘é›ç”° |+----+--------+--------+-------------+----------+1 row in set (0.00 sec)å¯è§EnumTypeHandlerä¿å­˜çš„æ˜¯æžšä¸¾å­—ç¬¦ä¸²ã€‚ã€Šæ·±å…¥æµ…å‡ºMyBatisæŠ€æœ¯åŽŸç†ä¸Žå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MyBatisé…ç½®æ•°æ®åº“]]></title>
    <url>%2FMyBatis%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93.html</url>
    <content type="text"><![CDATA[xmlæ–‡ä»¶é…ç½®ç›´æŽ¥åœ¨mybatis-config.xmlæ–‡ä»¶ä¸­é…ç½®ï¼š123456&lt;dataSource type="POOLED"&gt; &lt;property name="driver" value="com.mysql.jdbc.Driver" /&gt; &lt;property name="url" value="jdbc:mysql://localhost:3306/mybatis"/&gt; &lt;property name="username" value="root" /&gt; &lt;property name="password" value="6742530" /&gt; &lt;/dataSource&gt;propertiesé…ç½®æ–‡ä»¶ä¸ºäº†æ–¹ä¾¿æ—¥åŽç»´æŠ¤ä¿®æ”¹ï¼Œæˆ‘ä»¬ç”¨propertiesé…ç½®æ–‡ä»¶æ¥é…ç½®æ•°æ®åº“å±žæ€§ï¼šdb.propertiesï¼š1234driver:com.mysql.jdbc.Driverurl:jdbc:mysql://localhost:3306/mybatisusername:rootpassword:123456åœ¨mybatis-config.xmlæ–‡ä»¶ä¸­å¼•å…¥ï¼š1234567&lt;properties resource="db.properties"/&gt;&lt;dataSource type="POOLED"&gt; &lt;property name="driver" value="$&#123;driver&#125;" /&gt; &lt;property name="url" value="$&#123;url&#125;"/&gt; &lt;property name="username" value="$&#123;username&#125;" /&gt; &lt;property name="password" value="$&#123;password&#125;" /&gt; &lt;/dataSource&gt;å‚æ•°ä¼ é€’å‡å¦‚è¦å¯¹db.propertiesæ–‡ä»¶ä¸­çš„ç”¨æˆ·åå’Œå¯†ç è¿›è¡ŒåŠ å¯†ï¼Œé‚£æˆ‘ä»¬åˆ™éœ€è¦åœ¨ç”ŸæˆSqlSessionFactoryçš„æ—¶å€™å¯¹ç”¨æˆ·åå’Œå¯†ç è§£å¯†ï¼ˆå‡è®¾è§£å¯†æ–¹æ³•ä¸ºdecode()ï¼‰ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445public class SqlSessionFactoryUtil &#123; InputStream cfgStream = null; Reader cfgReader = null; InputStream proStream = null; Reader proReader = null; Properties properties = null; private static SqlSessionFactory sqlSessionFactory = null; //ç±»çº¿ç¨‹é” private static final Class CLASS_LOCK = SqlSessionFactoryUtil.class; //ç§æœ‰åŒ–æž„é€ å‡½æ•° private SqlSessionFactoryUtil()&#123;&#125; //æž„å»ºSqlSessionFactory public static SqlSessionFactory initSqlSessionFactory()&#123; try&#123; //è¯»å…¥é…ç½®æ–‡ä»¶æµ cfgStream = Resources.getResourceAsStream("mybatis-config.xml"); cfgReader = new InputStreamReader(cfgStream); //è¯»å…¥å±žæ€§æ–‡ä»¶ proStream = Resources.getResourceAsStream(db.properties); proReader = new InputStreamReader(proStream); properties = new Properties(); properties.load(proReader); properties.setProperty("username", decode(properties.getProperty("username"))); properties.setProperty("password", decode(properties.getProperty("password"))); &#125;catch(IOException e)&#123; e.printStackTrace(); &#125; synchronized (CLASS_LOCK) &#123; if(sqlSessionFactory == null)&#123; sqlSessionFactory = new SqlSessionFactoryBuilder().build(cfgStream); &#125; &#125; return sqlSessionFactory; &#125; //åˆ›å»ºSqlSession public static SqlSession openSqlSession()&#123; if(sqlSessionFactory == null)&#123; initSqlSessionFactory(); &#125; return sqlSessionFactory.openSession(); &#125;&#125;environmentsé…ç½®çŽ¯å¢ƒ1234567891011121314&lt;environments default="development"&gt; &lt;environment id="development"&gt; &lt;!-- é‡‡ç”¨JDBCäº‹åŠ¡ç®¡ç† --&gt; &lt;transactionManager type="JDBC"&gt; &lt;property name="autoCommit" value="false"/&gt; &lt;/transactionManager&gt; &lt;dataSource type="POOLED"&gt; &lt;property name="driver" value="com.mysql.jdbc.Driver" /&gt; &lt;property name="url" value="jdbc:mysql://localhost:3306/mybatis"/&gt; &lt;property name="username" value="root" /&gt; &lt;property name="password" value="6742530" /&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt;defaultå±žæ€§è¡¨æ˜Žé»˜è®¤é€‰ç”¨å“ªä¸ªæ•°æ®åº“ã€‚idå±žæ€§ä¸ºä¸€ä¸ªæ•°æ®åº“é…ç½®çš„æ ‡è¯†ï¼Œå¯ä»¥åŒæ—¶é…ç½®å¤šä¸ªæ•°æ®åº“ã€‚dataSourceçš„typeå±žæ€§å¯é€‰éžè¿žæŽ¥æ± UNPOOLEDï¼Œè¿žæŽ¥æ± POOLEDå’ŒJNDIã€Šæ·±å…¥æµ…å‡ºMyBatisæŠ€æœ¯åŽŸç†ä¸Žå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MyBatis Guide]]></title>
    <url>%2FMyBatis-Guide.html</url>
    <content type="text"><![CDATA[å‡†å¤‡å·¥ä½œåˆ›å»ºè¡¨t_roleï¼š123456create table T_ROLE( id INT(20) not null auto_increment COMMENT 'ç¼–å·', role_name VARCHAR(60) not null comment 'è§’è‰²åç§°', note varchar(1024) comment 'å¤‡æ³¨', PRIMARY KEY (id));æ·»åŠ MyBatis jaråŒ…å’ŒmySqlè¿žæŽ¥é©±åŠ¨ï¼šMyBatis-jareclipseæ–‡ä»¶è·¯å¾„ï¼šå„æ–‡ä»¶è¯´æ˜Žï¼šæ–‡ä»¶ä½œç”¨MyBatisMain.javaè¿è¡ŒMyBatisç¨‹åºçš„å…¥å£ï¼ŒåŒ…å«mainæ–¹æ³•RoleMapper.javaæ˜ å°„å™¨RoleMapper.xmlæ˜ å°„å™¨é…ç½®æ–‡ä»¶Role.javaPOJOSqlSessionFactoryUtil.javaæž„å»ºSqlSessionFactoryï¼Œå¹¶åˆ›å»ºSqlSessionmybatis-config.xmlMyBatisé…ç½®é…ç½®mybatis-config.xml1234567891011121314151617181920212223242526272829&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt; &lt;configuration&gt; &lt;typeAliases&gt; &lt;!--ç»™å®žä½“ç±»èµ·ä¸€ä¸ªåˆ«å role --&gt; &lt;typeAlias type="mrbird.leanote.pojo.Role" alias="role" /&gt; &lt;/typeAliases&gt; &lt;!--æ•°æ®æºé…ç½® --&gt; &lt;environments default="development"&gt; &lt;environment id="development"&gt; &lt;!-- é‡‡ç”¨JDBCäº‹åŠ¡ç®¡ç† --&gt; &lt;transactionManager type="JDBC"&gt; &lt;property name="autoCommit" value="false"/&gt; &lt;/transactionManager&gt; &lt;dataSource type="POOLED"&gt; &lt;property name="driver" value="com.mysql.jdbc.Driver" /&gt; &lt;property name="url" value="jdbc:mysql://localhost:3306/mybatis"/&gt; &lt;property name="username" value="root" /&gt; &lt;property name="password" value="6742530" /&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;mappers&gt; &lt;!--RoleMapper.xmlè£…è½½è¿›æ¥ åŒç­‰äºŽæŠŠ'dao'çš„å®žçŽ°è£…è½½è¿›æ¥ --&gt; &lt;mapper resource="mrbird/leanote/mapper/RoleMapper.xml" /&gt; &lt;/mappers&gt; &lt;/configuration&gt;æž„å»ºSqlSessionFactoryåˆ©ç”¨mybatis-config.xmlå®ŒæˆSqlSessionFactoryçš„æž„å»ºï¼Œå¹¶åˆ›å»ºSqlSessionã€‚é‡‡ç”¨å•ä¾‹çš„å½¢å¼æž„å»ºSqlSessionFactoryã€‚123456789101112131415161718192021222324252627282930313233343536373839package mrbird.leanote.util; import java.io.IOException;import java.io.InputStream;import org.apache.ibatis.io.Resources;import org.apache.ibatis.session.SqlSession;import org.apache.ibatis.session.SqlSessionFactory;import org.apache.ibatis.session.SqlSessionFactoryBuilder; public class SqlSessionFactoryUtil &#123; private static SqlSessionFactory sqlSessionFactory = null; //ç±»çº¿ç¨‹é” private static final Class CLASS_LOCK = SqlSessionFactoryUtil.class; //ç§æœ‰åŒ–æž„é€ å‡½æ•° private SqlSessionFactoryUtil()&#123;&#125; //æž„å»ºSqlSessionFactory public static SqlSessionFactory initSqlSessionFactory()&#123; String resource = "mybatis-config.xml"; InputStream in = null; try &#123; in = Resources.getResourceAsStream(resource); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; synchronized (CLASS_LOCK) &#123; if(sqlSessionFactory == null)&#123; sqlSessionFactory = new SqlSessionFactoryBuilder().build(in); &#125; &#125; return sqlSessionFactory; &#125; //åˆ›å»ºSqlSession public static SqlSession openSqlSession()&#123; if(sqlSessionFactory == null)&#123; initSqlSessionFactory(); &#125; return sqlSessionFactory.openSession(); &#125;&#125;POJOåˆ›å»ºä¸€ä¸ªä¸Žåº“è¡¨å¯¹åº”çš„POJOï¼š12345678910111213141516171819202122232425package mrbird.leanote.pojo; public class Role &#123; private Long id; private String roleName; private String note; public Long getId() &#123; return id; &#125; public void setId(Long id) &#123; this.id = id; &#125; public String getRoleName() &#123; return roleName; &#125; public void setRoleName(String roleName) &#123; this.roleName = roleName; &#125; public String getNote() &#123; return note; &#125; public void setNote(String note) &#123; this.note = note; &#125; &#125;æŽ¥å£ä¸Žæ˜ å°„æ–‡ä»¶æ–°å»ºä¸€ä¸ªRoleMapperæŽ¥å£ï¼ŒåŒ…å«ç®€å•çš„CRUDæŠ½è±¡æ–¹æ³•ï¼š123456789package mrbird.leanote.mapper; import mrbird.leanote.pojo.Role; public interface RoleMapper &#123; public Role getRole(Long id); public int deleteRole(Long id); public int createRole(Role role);&#125;ç¼–å†™RoleMapper.xmlæ˜ å°„æ–‡ä»¶ï¼Œè®©å…¶è‡ªåŠ¨æ˜ å°„RoleMapper interfaceï¼š1234567891011121314151617181920212223&lt;?xml version="1.0" encoding="UTF-8" ?&gt; &lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt; &lt;!--å’ŒæŽ¥å£è·¯å¾„å’Œåç§°ä¿æŒä¸€è‡´ï¼ŒMyBatisä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ‰¾åˆ°è¿™ä¸ª Mapper--&gt; &lt;mapper namespace="mrbird.leanote.mapper.RoleMapper"&gt; &lt;!-- idä¸ŽæŽ¥å£æ–¹æ³•åä¸€è‡´ï¼Œå‚æ•°ç±»åž‹ä¸ŽæŽ¥å£æ–¹æ³•å‚æ•°ç±»åž‹ä¸€è‡´ï¼Œè¿”å›žå€¼ç±»åž‹ä¸ŽæŽ¥å£æ–¹æ³•ä¸€è‡´ 'role'ä¸ºmybatis-config.xmlä¸­å®šä¹‰çš„åˆ«å --&gt; &lt;select id="getRole" parameterType="long" resultType="role"&gt; &lt;![CDATA[ select id,role_name as roleName,note from t_role where id = #&#123;id&#125; ]]&gt; &lt;/select&gt; &lt;insert id="createRole" parameterType="role"&gt; &lt;![CDATA[ insert into t_role(role_name,note) values (#&#123;roleName&#125;,#&#123;note&#125;) ]]&gt; &lt;/insert&gt; &lt;delete id="deleteRole" parameterType="long"&gt; &lt;![CDATA[ delete from t_role where id = #&#123;id&#125; ]]&gt; &lt;/delete&gt;&lt;/mapper&gt;æµ‹è¯•æµ‹è¯•æ’å…¥æ•°æ®ï¼š12345678910111213141516171819202122232425262728package mrbird.leanote.mian; import mrbird.leanote.mapper.RoleMapper;import mrbird.leanote.pojo.Role;import mrbird.leanote.util.SqlSessionFactoryUtil;import org.apache.ibatis.session.SqlSession; public class MyBatisMain &#123; public static void main(String[] args) &#123; SqlSession sqlSession = null; try &#123; sqlSession = SqlSessionFactoryUtil.openSqlSession(); RoleMapper roleMapper = sqlSession.getMapper(RoleMapper.class); Role role = new Role(); role.setRoleName("mrbird"); role.setNote("the fun of code"); roleMapper.createRole(role); sqlSession.commit(); &#125; catch (Exception e) &#123; e.printStackTrace(); sqlSession.rollback(); &#125;finally&#123; if(sqlSession != null)&#123; sqlSession.close(); &#125; &#125; &#125;&#125;è¿è¡ŒåŽæŸ¥è¯¢æ•°æ®åº“ï¼š1234567mysql&gt; select * from t_role;+----+-----------+-----------------+| id | role_name | note |+----+-----------+-----------------+| 1 | mrbird | the fun of code |+----+-----------+-----------------+1 row in set (0.00 sec)åˆ›å»ºæˆåŠŸã€‚æµ‹è¯•åˆ é™¤ï¼š123456789101112131415161718public class MyBatisMain &#123; public static void main(String[] args) &#123; SqlSession sqlSession = null; try &#123; sqlSession = SqlSessionFactoryUtil.openSqlSession(); RoleMapper roleMapper = sqlSession.getMapper(RoleMapper.class); roleMapper.deleteRole(1L); sqlSession.commit(); &#125; catch (Exception e) &#123; e.printStackTrace(); sqlSession.rollback(); &#125;finally&#123; if(sqlSession != null)&#123; sqlSession.close(); &#125; &#125; &#125;&#125;è¿è¡ŒåŽæŸ¥è¯¢æ•°æ®åº“ï¼š12mysql&gt; select * from t_role;Empty set (0.00 sec)åˆ é™¤æˆåŠŸã€‚ã€Šæ·±å…¥æµ…å‡ºMyBatisæŠ€æœ¯åŽŸç†ä¸Žå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JS ä¸­çš„LHSå’ŒRHS]]></title>
    <url>%2FJS-%E4%B8%AD%E7%9A%84LHS%E5%92%8CRHS.html</url>
    <content type="text"><![CDATA[LHSå’ŒRHSçš„å«ä¹‰æ˜¯â€èµ‹å€¼æ“ä½œç¬¦çš„å·¦ä¾§æˆ–å³ä¾§â€ï¼Œå¹¶ä¸ä¸€å®šæ„å‘³ç€å°±æ˜¯â€œ=èµ‹å€¼æ“ä½œç¬¦çš„å·¦ä¾§æˆ–å³ä¾§â€œã€‚èµ‹å€¼æ“ä½œè¿˜æœ‰å…¶ä»–å‡ ç§å½¢å¼ï¼Œå› æ­¤åœ¨æ¦‚å¿µä¸Šæœ€å¥½å°†å…¶ç†è§£ä¸ºâ€èµ‹å€¼æ“ä½œçš„ç›®æ ‡æ˜¯è°ï¼ˆLHSï¼‰â€œä»¥åŠâ€è°æ˜¯èµ‹å€¼æ“ä½œçš„æºå¤´ï¼ˆRHSï¼‰â€œã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š1234function foo(a)&#123; console.log(a);&#125;foo(2);æœ€åŽä¸€è¡Œfoo(..)å‡½æ•°çš„è°ƒç”¨éœ€è¦å¯¹fooè¿›è¡ŒRHSå¼•ç”¨ï¼Œæ„å‘³ç€åŽ»æ‰¾åˆ°â€fooçš„å€¼ï¼Œå¹¶æŠŠå®ƒç»™æˆ‘â€œã€‚ä»£ç ä¸­ï¼Œéšå¼çš„ a = 2 æ“ä½œè¿›è¡Œäº†ä¸€æ¬¡LHSæŸ¥è¯¢ï¼Œæ‰¾åˆ°èµ‹å€¼æ“ä½œçš„ç›®æ ‡aâ€”â€”fooå‡½æ•°çš„å½¢å¼å‚æ•°ã€‚æŽ¥ä¸‹æ¥å¯¹aè¿›è¡ŒRHSå¼•ç”¨ï¼Œå¹¶å°†å¾—åˆ°çš„å€¼ä¼ ç»™console.log(..)ã€‚console.log(..)æœ¬èº«ä¹Ÿéœ€è¦å¯¹consoleè¿›è¡Œä¸€æ¬¡RHSå¼•ç”¨ï¼ŒæŸ¥æ‰¾æ˜¯å¦æœ‰ä¸€ä¸ªå«ä½œlogçš„æ–¹æ³•ã€‚å½“LHSæŸ¥è¯¢å¤±è´¥æ—¶ï¼Œå¼•æ“Žä¼šåœ¨å…¨å±€ä½œç”¨åŸŸä¸­åˆ›å»ºè¯¥å˜é‡ï¼š12345function foo(a)&#123; b = a;&#125;foo(2);console.log(window.b); //2å½“RHSæŸ¥è¯¢å¤±è´¥æ—¶ï¼Œå¼•æ“Žä¼šæŠ›å‡ºReferenceErrorå¼‚å¸¸ï¼š1234function foo()&#123; var b = a;&#125;foo();å¼•æ“ŽæŠ›å‡ºï¼šUncaught ReferenceError: a is not definedã€‚ã€Šä½ ä¸çŸ¥é“çš„JavaScriptä¸Šå·ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ajax]]></title>
    <url>%2FAjax.html</url>
    <content type="text"><![CDATA[JavaScript AjaxXMLHttpRequestå¯¹è±¡1234567891011function getXHR() &#123; //æ ¹æ®å¯¹è±¡åˆ¤æ–­æµè§ˆå™¨ if(window.XMLHttpRequest) &#123; //ä¸æ˜¯IE return new XMLHttpRequest(); &#125;else&#123; //IE return new ActiveXObject("Microsoft.XMLHttp"); &#125;&#125;var xhr = getXHR();getè¯·æ±‚æ‰“å¼€è¯·æ±‚ï¼š1xhr.open("get", "example.php?name1=value1&amp;name2=value2", true);trueè¡¨ç¤ºå‘é€å¼‚æ­¥è¯·æ±‚ã€‚ä¸‹é¢è¿™ä¸ªå‡½æ•°å¯ä»¥è¾…åŠ©å‘çŽ°æœ‰URL çš„æœ«å°¾æ·»åŠ æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°ï¼š12345function addURLParam(url, name, value) &#123; url += (url.indexOf("?") == -1 ? "?" : "&amp;"); url += encodeURIComponent(name) + "=" + encodeURIComponent(value); return url;&#125;addURLParam()å‡½æ•°æŽ¥å—ä¸‰ä¸ªå‚æ•°ï¼šè¦æ·»åŠ å‚æ•°çš„URLã€å‚æ•°çš„åç§°å’Œå‚æ•°çš„å€¼ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥æž„å»ºè¯·æ±‚URL çš„ç¤ºä¾‹ã€‚12345678var url = "example.php";//æ·»åŠ å‚æ•°url = addURLParam(url, "name", "Nicholas");url = addURLParam(url, "book", "Professional JavaScript");//åˆå§‹åŒ–è¯·æ±‚xhr.open("get", url, false);å‘é€è¯·æ±‚ï¼š1xhr.send(null);è¿™é‡Œçš„send()æ–¹æ³•æŽ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå³è¦ä½œä¸ºè¯·æ±‚ä¸»ä½“å‘é€çš„æ•°æ®ã€‚å¦‚æžœä¸éœ€è¦é€šè¿‡è¯·æ±‚ä¸»ä½“å‘é€æ•°æ®ï¼Œåˆ™å¿…é¡»ä¼ å…¥nullï¼Œå› ä¸ºè¿™ä¸ªå‚æ•°å¯¹æœ‰äº›æµè§ˆå™¨æ¥è¯´æ˜¯å¿…éœ€çš„ã€‚è°ƒç”¨send()ä¹‹åŽï¼Œè¯·æ±‚å°±ä¼šè¢«åˆ†æ´¾åˆ°æœåŠ¡å™¨ã€‚å›žè°ƒå‡½æ•°ï¼šXHR å¯¹è±¡çš„readyState å±žæ€§å¯å–çš„å€¼ï¼š0ï¼šæœªåˆå§‹åŒ–ã€‚å°šæœªè°ƒç”¨open()æ–¹æ³•ã€‚1ï¼šå¯åŠ¨ã€‚å·²ç»è°ƒç”¨open()æ–¹æ³•ï¼Œä½†å°šæœªè°ƒç”¨send()æ–¹æ³•ã€‚2ï¼šå‘é€ã€‚å·²ç»è°ƒç”¨send()æ–¹æ³•ï¼Œä½†å°šæœªæŽ¥æ”¶åˆ°å“åº”ã€‚3ï¼šæŽ¥æ”¶ã€‚å·²ç»æŽ¥æ”¶åˆ°éƒ¨åˆ†å“åº”æ•°æ®ã€‚4ï¼šå®Œæˆã€‚å·²ç»æŽ¥æ”¶åˆ°å…¨éƒ¨å“åº”æ•°æ®ï¼Œè€Œä¸”å·²ç»å¯ä»¥åœ¨å®¢æˆ·ç«¯ä½¿ç”¨äº†ã€‚åªè¦readyState å±žæ€§çš„å€¼ç”±ä¸€ä¸ªå€¼å˜æˆå¦ä¸€ä¸ªå€¼ï¼Œéƒ½ä¼šè§¦å‘ä¸€æ¬¡readystatechange äº‹ä»¶ã€‚å¯ä»¥åˆ©ç”¨è¿™ä¸ªäº‹ä»¶æ¥æ£€æµ‹æ¯æ¬¡çŠ¶æ€å˜åŒ–åŽreadyState çš„å€¼ã€‚123456789xhr.onreadystatechange = function()&#123;callback(xhr);&#125;;//å›žè°ƒå‡½æ•°function callback(xhr) &#123; //å½“è¯·æ±‚ç»“æŸä¸”æ²¡æŠ¥é”™æ—¶ if(xhr.readyState==4 &amp;&amp; xhr.status==200) &#123; var txt = xhr.responseText; console.log(txt); &#125;&#125; â€‹åœ¨æ”¶åˆ°å“åº”åŽï¼Œå“åº”çš„æ•°æ®ä¼šè‡ªåŠ¨å¡«å……XHR å¯¹è±¡çš„å±žæ€§ï¼Œç›¸å…³çš„å±žæ€§ç®€ä»‹å¦‚ä¸‹ã€‚responseTextï¼šä½œä¸ºå“åº”ä¸»ä½“è¢«è¿”å›žçš„æ–‡æœ¬ã€‚responseXMLï¼šå¦‚æžœå“åº”çš„å†…å®¹ç±»åž‹æ˜¯â€text/xmlâ€æˆ–â€application/xmlâ€ï¼Œè¿™ä¸ªå±žæ€§ä¸­å°†ä¿å­˜åŒ…å«ç€å“åº”æ•°æ®çš„XML DOM æ–‡æ¡£ã€‚statusï¼šå“åº”çš„HTTP çŠ¶æ€ã€‚statusTextï¼šHTTP çŠ¶æ€çš„è¯´æ˜Žã€‚postè¯·æ±‚12345678910xhr.open("post", "postexample.php", true);xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");//å‘é€formè¡¨å•æ•°æ®var form = document.getElementById("form");xhr.send(serialize(form));//å‘é€æ™®é€šæ•°æ®xhr.send("name = Nicholas");xhr.send("book = Professional JavaScript");jQuery Ajaxload()load() æ–¹æ³•é€šè¿‡ AJAX è¯·æ±‚ä»ŽæœåŠ¡å™¨åŠ è½½æ•°æ®ï¼Œå¹¶æŠŠè¿”å›žçš„æ•°æ®æ”¾ç½®åˆ°æŒ‡å®šçš„å…ƒç´ ä¸­ã€‚è¯­æ³•ï¼š1load(url,data,function(response,status,xhr));å‚æ•°æè¿°urlè§„å®šè¦å°†è¯·æ±‚å‘é€åˆ°å“ªä¸ª URLã€‚dataå¯é€‰ã€‚è§„å®šè¿žåŒè¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®ã€‚function(response,status,xhr)å¯é€‰ã€‚è§„å®šå½“è¯·æ±‚å®Œæˆæ—¶è¿è¡Œçš„å‡½æ•°ã€‚é¢å¤–çš„å‚æ•°ï¼šresponse&amp;nbsp - åŒ…å«æ¥è‡ªè¯·æ±‚çš„ç»“æžœæ•°æ®status&amp;nbsp - åŒ…å«è¯·æ±‚çš„çŠ¶æ€ï¼ˆâ€successâ€, â€œnotmodifiedâ€, â€œerrorâ€, â€œtimeoutâ€ æˆ– â€œparsererrorâ€ï¼‰xhr&amp;nbsp - åŒ…å« XMLHttpRequest å¯¹è±¡å¦‚åœ¨idä¸ºresultçš„divä¸­åŠ è½½test.htmlé¡µé¢ï¼š1$("#result").load("test.html");\$.get()å’Œ\$.post()$.get()æ–¹æ³•ä½¿ç”¨ HTTP GET è¯·æ±‚ä»ŽæœåŠ¡å™¨åŠ è½½æ•°æ®ã€‚è¯­æ³•ï¼š1$.get(URL,data,function(data,status,xhr),dataType);å‚æ•°ï¼šå‚æ•°æè¿°URLå¿…éœ€ã€‚è§„å®šæ‚¨éœ€è¦è¯·æ±‚çš„ URLã€‚dataå¯é€‰ã€‚è§„å®šè¿žåŒè¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®ã€‚function(data,status,xhr)å¯é€‰ã€‚è§„å®šå½“è¯·æ±‚æˆåŠŸæ—¶è¿è¡Œçš„å‡½æ•°ã€‚é¢å¤–çš„å‚æ•°ï¼šdata&amp;nbsp - åŒ…å«æ¥è‡ªè¯·æ±‚çš„ç»“æžœæ•°æ®status&amp;nbsp - åŒ…å«è¯·æ±‚çš„çŠ¶æ€ï¼ˆâ€successâ€ã€â€notmodifiedâ€ã€â€errorâ€ã€â€timeoutâ€ã€â€parsererrorâ€ï¼‰xhr&amp;nbsp - åŒ…å« XMLHttpRequest å¯¹è±¡dataTypeå¯é€‰ã€‚è§„å®šé¢„æœŸçš„æœåŠ¡å™¨å“åº”çš„æ•°æ®ç±»åž‹ã€‚é»˜è®¤åœ°ï¼ŒjQuery ä¼šæ™ºèƒ½åˆ¤æ–­ã€‚å¯èƒ½çš„ç±»åž‹ï¼šxml - ä¸€ä¸ª XML æ–‡æ¡£html - HTML ä½œä¸ºçº¯æ–‡æœ¬text - çº¯æ–‡æœ¬å­—ç¬¦ä¸²script - ä»¥ JavaScript è¿è¡Œå“åº”ï¼Œå¹¶ä»¥çº¯æ–‡æœ¬è¿”å›žjson - ä»¥ JSON è¿è¡Œå“åº”ï¼Œå¹¶ä»¥ JavaScript å¯¹è±¡è¿”å›žjsonp - ä½¿ç”¨ JSONP åŠ è½½ä¸€ä¸ª JSON å—ï¼Œå°†æ·»åŠ ä¸€ä¸ª â€œ?callback=?â€ åˆ° URL æ¥è§„å®šå›žè°ƒå¦‚ï¼š123456$.get("get.php",&#123; userName : $("#userName").val().trim(), content : $("#content").val().trim() &#125;,function(data)&#123; // do something&#125;,"json");$.post()å’Œ$.get()ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºŽ$.post()å¯å‘é€çš„æ•°æ®é‡æ›´å¤§ã€‚\$.ajax()è¯­æ³•ï¼š1$.ajax(&#123;name:value, name:value, ... &#125;)ä¸‹é¢çš„è¡¨æ ¼ä¸­åˆ—å‡ºäº†å¯èƒ½çš„åç§°/å€¼ï¼šåç§°å€¼/æè¿°asyncå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦å¼‚æ­¥å¤„ç†ã€‚é»˜è®¤æ˜¯ trueã€‚beforeSend( xhr )å‘é€è¯·æ±‚å‰è¿è¡Œçš„å‡½æ•°ã€‚cacheå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæµè§ˆå™¨æ˜¯å¦ç¼“å­˜è¢«è¯·æ±‚é¡µé¢ã€‚é»˜è®¤æ˜¯ trueã€‚complete( xhr,status )è¯·æ±‚å®Œæˆæ—¶è¿è¡Œçš„å‡½æ•°ï¼ˆåœ¨è¯·æ±‚æˆåŠŸæˆ–å¤±è´¥ä¹‹åŽå‡è°ƒç”¨ï¼Œå³åœ¨ success å’Œ error å‡½æ•°ä¹‹åŽï¼‰ã€‚contentTypeå‘é€æ•°æ®åˆ°æœåŠ¡å™¨æ—¶æ‰€ä½¿ç”¨çš„å†…å®¹ç±»åž‹ã€‚é»˜è®¤æ˜¯ï¼šâ€application/x-www-form-urlencodedâ€ã€‚contextä¸ºæ‰€æœ‰ AJAX ç›¸å…³çš„å›žè°ƒå‡½æ•°è§„å®š â€œthisâ€ å€¼ã€‚dataè§„å®šè¦å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®ã€‚dataFilter( data , type )ç”¨äºŽå¤„ç† XMLHttpRequest åŽŸå§‹å“åº”æ•°æ®çš„å‡½æ•°ã€‚dataTypeé¢„æœŸçš„æœåŠ¡å™¨å“åº”çš„æ•°æ®ç±»åž‹ã€‚error( xhr,status,error )å¦‚æžœè¯·æ±‚å¤±è´¥è¦è¿è¡Œçš„å‡½æ•°ã€‚globalå¸ƒå°”å€¼ï¼Œè§„å®šæ˜¯å¦ä¸ºè¯·æ±‚è§¦å‘å…¨å±€ AJAX äº‹ä»¶å¤„ç†ç¨‹åºã€‚é»˜è®¤æ˜¯ trueã€‚ifModifiedå¸ƒå°”å€¼ï¼Œè§„å®šæ˜¯å¦ä»…åœ¨æœ€åŽä¸€æ¬¡è¯·æ±‚ä»¥æ¥å“åº”å‘ç”Ÿæ”¹å˜æ—¶æ‰è¯·æ±‚æˆåŠŸã€‚é»˜è®¤æ˜¯ falseã€‚jsonpåœ¨ä¸€ä¸ª jsonp ä¸­é‡å†™å›žè°ƒå‡½æ•°çš„å­—ç¬¦ä¸²ã€‚jsonpCallbackåœ¨ä¸€ä¸ª jsonp ä¸­è§„å®šå›žè°ƒå‡½æ•°çš„åç§°ã€‚passwordè§„å®šåœ¨ HTTP è®¿é—®è®¤è¯è¯·æ±‚ä¸­ä½¿ç”¨çš„å¯†ç ã€‚processDataå¸ƒå°”å€¼ï¼Œè§„å®šé€šè¿‡è¯·æ±‚å‘é€çš„æ•°æ®æ˜¯å¦è½¬æ¢ä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²ã€‚é»˜è®¤æ˜¯ trueã€‚scriptCharsetè§„å®šè¯·æ±‚çš„å­—ç¬¦é›†ã€‚success( result,status,xhr )å½“è¯·æ±‚æˆåŠŸæ—¶è¿è¡Œçš„å‡½æ•°ã€‚timeoutè®¾ç½®æœ¬åœ°çš„è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆä»¥æ¯«ç§’è®¡ï¼‰ã€‚traditionalå¸ƒå°”å€¼ï¼Œè§„å®šæ˜¯å¦ä½¿ç”¨å‚æ•°åºåˆ—åŒ–çš„ä¼ ç»Ÿæ ·å¼ã€‚typeè§„å®šè¯·æ±‚çš„ç±»åž‹ï¼ˆGET æˆ– POSTï¼‰ã€‚urlè§„å®šå‘é€è¯·æ±‚çš„ URLã€‚é»˜è®¤æ˜¯å½“å‰é¡µé¢ã€‚usernameè§„å®šåœ¨ HTTP è®¿é—®è®¤è¯è¯·æ±‚ä¸­ä½¿ç”¨çš„ç”¨æˆ·åã€‚xhrç”¨äºŽåˆ›å»º XMLHttpRequest å¯¹è±¡çš„å‡½æ•°ã€‚]]></content>
      <tags>
        <tag>Ajax</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[BOM location]]></title>
    <url>%2FBOM-location.html</url>
    <content type="text"><![CDATA[ä½¿ç”¨location å¯¹è±¡å¯ä»¥é€šè¿‡å¾ˆå¤šæ–¹å¼æ¥æ”¹å˜æµè§ˆå™¨çš„ä½ç½®ã€‚å¦‚ï¼š1location.assign("http://www.wrox.com");æˆ–ï¼š12window.location = "http://www.wrox.com";location.href = "http://www.wrox.com";å¦å¤–ï¼Œä¿®æ”¹location å¯¹è±¡çš„å…¶ä»–å±žæ€§ä¹Ÿå¯ä»¥æ”¹å˜å½“å‰åŠ è½½çš„é¡µé¢ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†é€šè¿‡å°†hashã€searchã€hostnameã€pathname å’Œport å±žæ€§è®¾ç½®ä¸ºæ–°å€¼æ¥æ”¹å˜URLã€‚12345678910111213141516//å‡è®¾åˆå§‹URL ä¸ºhttp://www.wrox.com/WileyCDA/ //å°†URL ä¿®æ”¹ä¸º"http://www.wrox.com/WileyCDA/#section1"location.hash = "#section1"; //å°†URL ä¿®æ”¹ä¸º"http://www.wrox.com/WileyCDA/?q=javascript"location.search = "?q=javascript"; //å°†URL ä¿®æ”¹ä¸º"http://www.yahoo.com/WileyCDA/"location.hostname = "www.yahoo.com"; //å°†URL ä¿®æ”¹ä¸º"http://www.yahoo.com/mydir/"location.pathname = "mydir"; //å°†URL ä¿®æ”¹ä¸º"http://www.yahoo.com:8080/WileyCDA/"location.port = 8080;ä½¿ç”¨location.replace(url)ä¼šå¯¼è‡´æµè§ˆå™¨ä½ç½®æ”¹å˜ï¼Œä½†ä¸ä¼šåœ¨åŽ†å²è®°å½•ä¸­ç”Ÿæˆæ–°è®°å½•ã€‚â€åŽé€€â€æŒ‰é’®å°†ä¸å¯ç‚¹å‡»ã€‚reload()ï¼š12location.reload(); //é‡æ–°åŠ è½½ï¼ˆæœ‰å¯èƒ½ä»Žç¼“å­˜ä¸­åŠ è½½ï¼‰location.reload(true); //é‡æ–°åŠ è½½ï¼ˆä»ŽæœåŠ¡å™¨é‡æ–°åŠ è½½ï¼‰]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScript Functionç±»åž‹]]></title>
    <url>%2FJavaScript-Function%E7%B1%BB%E5%9E%8B.html</url>
    <content type="text"><![CDATA[å‡½æ•°å£°æ˜Žä¸Žå‡½æ•°è¡¨è¾¾å¼å‡½æ•°å£°æ˜Žé•¿è¿™æ ·ï¼š123function sum(num1, num2)&#123; return num1 + num2;&#125;å‡½æ•°è¡¨è¾¾å¼é•¿è¿™æ ·ï¼š123var sum = function(num1, num2)&#123; return num1 + num2;&#125;;åŒºåˆ«ï¼šè§£æžå™¨åœ¨å‘æ‰§è¡ŒçŽ¯å¢ƒä¸­åŠ è½½æ•°æ®æ—¶ï¼Œå¯¹å‡½æ•°å£°æ˜Žå’Œå‡½æ•°è¡¨è¾¾å¼å¹¶éžä¸€è§†åŒä»ã€‚è§£æžå™¨ä¼šçŽ‡å…ˆè¯»å–å‡½æ•°å£°æ˜Žï¼Œå¹¶ä½¿å…¶åœ¨æ‰§è¡Œä»»ä½•ä»£ç ä¹‹å‰å¯ç”¨ï¼ˆå¯ä»¥è®¿é—®ï¼‰ï¼›è‡³äºŽå‡½æ•°è¡¨è¾¾å¼ï¼Œåˆ™å¿…é¡»ç­‰åˆ°è§£æžå™¨æ‰§è¡Œåˆ°å®ƒæ‰€åœ¨çš„ä»£ç è¡Œï¼Œæ‰ä¼šçœŸæ­£è¢«è§£é‡Šæ‰§è¡Œã€‚å¦‚ä¸‹é¢è¯­å¥ä¸æŠ¥é”™ï¼š1234alert(sum(10,10));function sum(num1, num2)&#123; return num1 + num2;&#125;è€Œä¸‹é¢è¯­å¥æŠ¥é”™ï¼š1234alert(sum(10,10));var sum = function(num1, num2)&#123; return num1 + num2;&#125;;é™¤äº†ä»€ä¹ˆæ—¶å€™å¯ä»¥é€šè¿‡å˜é‡è®¿é—®å‡½æ•°è¿™ä¸€ç‚¹åŒºåˆ«ä¹‹å¤–ï¼Œå‡½æ•°å£°æ˜Žä¸Žå‡½æ•°è¡¨è¾¾å¼çš„è¯­æ³•å…¶å®žæ˜¯ç­‰ä»·çš„ã€‚ä½œä¸ºå€¼çš„å‡½æ•°å› ä¸ºECMAScript ä¸­çš„å‡½æ•°åæœ¬èº«å°±æ˜¯å˜é‡ï¼Œæ‰€ä»¥å‡½æ•°ä¹Ÿå¯ä»¥ä½œä¸ºå€¼æ¥ä½¿ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ä»…å¯ä»¥åƒä¼ é€’å‚æ•°ä¸€æ ·æŠŠä¸€ä¸ªå‡½æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œè€Œä¸”å¯ä»¥å°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„ç»“æžœè¿”å›žã€‚å¦‚ï¼š12345678function callSomeFunction(someFunction, someArgument)&#123; return someFunction(someArgument);&#125;function add10(num)&#123; return num + 10;&#125;var result1 = callSomeFunction(add10, 10);alert(result1); //20å‡½æ•°å†…éƒ¨å±žæ€§argumentsåœ¨å‡½æ•°ä½“å†…å¯ä»¥é€šè¿‡arguments å¯¹è±¡æ¥è®¿é—®å‚æ•°æ•°ç»„ï¼Œä»Žè€ŒèŽ·å–ä¼ é€’ç»™å‡½æ•°çš„æ¯ä¸€ä¸ªå‚æ•°ï¼Œæ¯”å¦‚å®šä¹‰ä¸€ä¸ªè®¡ç®—ä»»æ„ä¸ªå‚æ•°çš„å’Œçš„å‡½æ•°ï¼š1234567function sum() &#123; var s = 0; for(var i=0;i&lt;arguments.length;i++) &#123; s += arguments[i]; &#125; return s;&#125;è™½ç„¶argumentsçš„ä¸»è¦ç”¨é€”æ˜¯ä¿å­˜å‡½æ•°å‚æ•°ï¼Œä½†è¿™ä¸ªå¯¹è±¡è¿˜æœ‰ä¸€ä¸ªåå«calleeçš„å±žæ€§ï¼Œè¯¥å±žæ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æ‹¥æœ‰è¿™ä¸ªargumentså¯¹è±¡çš„å‡½æ•°ã€‚è¯·çœ‹ä¸‹é¢è¿™ä¸ªéžå¸¸ç»å…¸çš„é˜¶ä¹˜å‡½æ•°ã€‚1234567function factorial(num)&#123; if (num &lt;=1) &#123; return 1; &#125; else &#123; return num * factorial(num-1) &#125;&#125;è¿™ä¸ªå‡½æ•°çš„æ‰§è¡Œä¸Žå‡½æ•°åfactorial ç´§ç´§è€¦åˆåœ¨äº†ä¸€èµ·ã€‚ä¸ºäº†æ¶ˆé™¤è¿™ç§ç´§å¯†è€¦åˆçš„çŽ°è±¡ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·ä½¿ç”¨arguments.calleeã€‚1234567function factorial(num)&#123; if (num &lt;=1) &#123; return 1; &#125; else &#123; return num * arguments.callee(num-1) &#125;&#125;thisthiså¼•ç”¨çš„æ˜¯å‡½æ•°æ®ä»¥æ‰§è¡Œçš„çŽ¯å¢ƒå¯¹è±¡â€”â€”æˆ–è€…ä¹Ÿå¯ä»¥è¯´æ˜¯this å€¼ï¼ˆå½“åœ¨ç½‘é¡µçš„å…¨å±€ä½œç”¨åŸŸä¸­è°ƒç”¨å‡½æ•°æ—¶ï¼Œthis å¯¹è±¡å¼•ç”¨çš„å°±æ˜¯windowï¼‰ã€‚å¦‚ï¼š12345678window.color = "red";var o = &#123; color: "blue" &#125;;function sayColor()&#123; alert(this.color);&#125;sayColor(); //"red"o.sayColor = sayColor;o.sayColor(); //"blue"callerECMAScript 5 ä¹Ÿè§„èŒƒåŒ–äº†å¦ä¸€ä¸ªå‡½æ•°å¯¹è±¡çš„å±žæ€§ï¼šcallerã€‚è¿™ä¸ªå±žæ€§ä¸­ä¿å­˜ç€è°ƒç”¨å½“å‰å‡½æ•°çš„å‡½æ•°çš„å¼•ç”¨ï¼Œå¦‚æžœæ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸­è°ƒç”¨å½“å‰å‡½æ•°ï¼Œå®ƒçš„å€¼ä¸ºnullã€‚ä¾‹å¦‚ï¼š1234567function outer()&#123; inner();&#125;function inner()&#123; alert(inner.caller);&#125;outer();ä»¥ä¸Šä»£ç ä¼šå¯¼è‡´è­¦å‘Šæ¡†ä¸­æ˜¾ç¤ºouter()å‡½æ•°çš„æºä»£ç ã€‚å› ä¸ºouter()è°ƒç”¨äº†inner()ï¼Œæ‰€ä»¥inner.caller å°±æŒ‡å‘outer()ã€‚å±žæ€§å’Œæ–¹æ³•ECMAScript ä¸­çš„å‡½æ•°æ˜¯å¯¹è±¡ï¼Œå› æ­¤å‡½æ•°ä¹Ÿæœ‰å±žæ€§å’Œæ–¹æ³•ã€‚æ¯ä¸ªå‡½æ•°éƒ½åŒ…å«ä¸¤ä¸ªå±žæ€§ï¼šlength å’Œprototypeã€‚lengthlengthå±žæ€§è¡¨ç¤ºå‡½æ•°å¸Œæœ›æŽ¥æ”¶çš„å‘½åå‚æ•°çš„ä¸ªæ•°ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤ºã€‚123456789101112function sayName(name)&#123; alert(name);&#125;function sum(num1, num2)&#123; return num1 + num2;&#125;function sayHi()&#123; alert("hi");&#125;alert(sayName.length); //1alert(sum.length); //2alert(sayHi.length); //0prototypeå¯¹äºŽECMAScript ä¸­çš„å¼•ç”¨ç±»åž‹è€Œè¨€ï¼Œprototypeæ˜¯ä¿å­˜å®ƒä»¬æ‰€æœ‰å®žä¾‹æ–¹æ³•çš„çœŸæ­£æ‰€åœ¨ã€‚å¦‚ï¼š12345678910111213function Person()&#123;&#125;Person.prototype.name = "Nicholas";Person.prototype.age = 29;Person.prototype.job = "Software Engineer";Person.prototype.sayName = function()&#123; alert(this.name);&#125;;var person1 = new Person();person1.sayName(); //"Nicholas"var person2 = new Person();person2.sayName(); //"Nicholas"alert(person1.sayName == person2.sayName); //trueå¯ä»¥é€šè¿‡isPrototypeOf()æ–¹æ³•æ¥ç¡®å®šä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å¦ä¸€ä¸ªå¯¹è±¡çš„åŽŸåž‹ï¼š12alert(Person.prototype.isPrototypeOf(person1)); //truealert(Person.prototype.isPrototypeOf(person2)); //trueä½¿ç”¨Object.getPrototypeOf()å¯ä»¥æ–¹ä¾¿åœ°å–å¾—ä¸€ä¸ªå¯¹è±¡çš„åŽŸåž‹ï¼š12alert(Object.getPrototypeOf(person1) == Person.prototype); //truealert(Object.getPrototypeOf(person1).name); //"Nicholas"æ¯å½“ä»£ç è¯»å–æŸä¸ªå¯¹è±¡çš„æŸä¸ªå±žæ€§æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œä¸€æ¬¡æœç´¢ï¼Œç›®æ ‡æ˜¯å…·æœ‰ç»™å®šåå­—çš„å±žæ€§ã€‚æœç´¢é¦–å…ˆä»Žå¯¹è±¡å®žä¾‹æœ¬èº«å¼€å§‹ã€‚å¦‚æžœåœ¨å®žä¾‹ä¸­æ‰¾åˆ°äº†å…·æœ‰ç»™å®šåå­—çš„å±žæ€§ï¼Œåˆ™è¿”å›žè¯¥å±žæ€§çš„å€¼ï¼›å¦‚æžœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ç»§ç»­æœç´¢æŒ‡é’ˆæŒ‡å‘çš„åŽŸåž‹å¯¹è±¡ï¼Œåœ¨åŽŸåž‹å¯¹è±¡ä¸­æŸ¥æ‰¾å…·æœ‰ç»™å®šåå­—çš„å±žæ€§ã€‚å¦‚æžœåœ¨åŽŸåž‹å¯¹è±¡ä¸­æ‰¾åˆ°äº†è¿™ä¸ªå±žæ€§ï¼Œåˆ™è¿”å›žè¯¥å±žæ€§çš„å€¼ã€‚è™½ç„¶å¯ä»¥é€šè¿‡å¯¹è±¡å®žä¾‹è®¿é—®ä¿å­˜åœ¨åŽŸåž‹ä¸­çš„å€¼ï¼Œä½†å´ä¸èƒ½é€šè¿‡å¯¹è±¡å®žä¾‹é‡å†™åŽŸåž‹ä¸­çš„å€¼ã€‚å¦‚æžœæˆ‘ä»¬åœ¨å®žä¾‹ä¸­æ·»åŠ äº†ä¸€ä¸ªå±žæ€§ï¼Œè€Œè¯¥å±žæ€§ä¸Žå®žä¾‹åŽŸåž‹ä¸­çš„ä¸€ä¸ªå±žæ€§åŒåï¼Œé‚£æˆ‘ä»¬å°±åœ¨å®žä¾‹ä¸­åˆ›å»ºè¯¥å±žæ€§ï¼Œè¯¥å±žæ€§å°†ä¼šå±è”½åŽŸåž‹ä¸­çš„é‚£ä¸ªå±žæ€§ã€‚12345678910111213function Person()&#123;&#125;Person.prototype.name = "Nicholas";Person.prototype.age = 29;Person.prototype.job = "Software Engineer";Person.prototype.sayName = function()&#123; alert(this.name);&#125;;var person1 = new Person();var person2 = new Person();person1.name = "Greg";alert(person1.name); //"Greg"â€”â€”æ¥è‡ªå®žä¾‹alert(person2.name); //"Nicholas"â€”â€”æ¥è‡ªåŽŸåž‹ä½¿ç”¨deleteæ“ä½œç¬¦åˆ™å¯ä»¥å®Œå…¨åˆ é™¤å®žä¾‹å±žæ€§ï¼Œä»Žè€Œè®©æˆ‘ä»¬èƒ½å¤Ÿé‡æ–°è®¿é—®åŽŸåž‹ä¸­çš„å±žæ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚123456789101112131415function Person()&#123;&#125;Person.prototype.name = "Nicholas";Person.prototype.age = 29;Person.prototype.job = "Software Engineer";Person.prototype.sayName = function()&#123; alert(this.name);&#125;;var person1 = new Person();var person2 = new Person();person1.name = "Greg";alert(person1.name); //"Greg"â€”â€”æ¥è‡ªå®žä¾‹alert(person2.name); //"Nicholas"â€”â€”æ¥è‡ªåŽŸåž‹delete person1.name;alert(person1.name); //"Nicholas"â€”â€”æ¥è‡ªåŽŸåž‹ä½¿ç”¨hasOwnProperty()æ–¹æ³•å¯ä»¥æ£€æµ‹ä¸€ä¸ªå±žæ€§æ˜¯å­˜åœ¨äºŽå®žä¾‹ä¸­ï¼Œè¿˜æ˜¯å­˜åœ¨äºŽåŽŸåž‹ä¸­ã€‚è¿™ä¸ªæ–¹æ³•ï¼ˆä¸è¦å¿˜äº†å®ƒæ˜¯ä»ŽObject ç»§æ‰¿æ¥çš„ï¼‰åªåœ¨ç»™å®šå±žæ€§å­˜åœ¨äºŽå¯¹è±¡å®žä¾‹ä¸­æ—¶ï¼Œæ‰ä¼šè¿”å›žtrueã€‚123456789101112131415161718192021function Person()&#123;&#125;Person.prototype.name = "Nicholas";Person.prototype.age = 29;Person.prototype.job = "Software Engineer";Person.prototype.sayName = function()&#123; alert(this.name);&#125;;var person1 = new Person();var person2 = new Person();alert(person1.hasOwnProperty("name")); //false person1.name = "Greg";alert(person1.name); //"Greg"â€”â€”æ¥è‡ªå®žä¾‹alert(person1.hasOwnProperty("name")); //truealert(person2.name); //"Nicholas"â€”â€”æ¥è‡ªåŽŸåž‹alert(person2.hasOwnProperty("name")); //false delete person1.name;alert(person1.name); //"Nicholas"â€”â€”æ¥è‡ªåŽŸåž‹alert(person1.hasOwnProperty("name")); //falseåœ¨å•ç‹¬ä½¿ç”¨inæ“ä½œç¬¦ä¼šåœ¨é€šè¿‡å¯¹è±¡èƒ½å¤Ÿè®¿é—®ç»™å®šå±žæ€§æ—¶è¿”å›žtrueï¼Œæ— è®ºè¯¥å±žæ€§å­˜åœ¨äºŽå®žä¾‹ä¸­è¿˜æ˜¯åŽŸåž‹ä¸­ã€‚çœ‹ä¸€çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚12345678910111213141516171819202122232425262728function Person()&#123;&#125;Person.prototype.name = "Nicholas";Person.prototype.age = 29;Person.prototype.job = "Software Engineer";Person.prototype.sayName = function()&#123; alert(this.name);&#125;; var person1 = new Person();var person2 = new Person(); alert(person1.hasOwnProperty("name")); //falsealert("name" in person1); //true person1.name = "Greg";alert(person1.name); //"Greg" â€”â€”æ¥è‡ªå®žä¾‹alert(person1.hasOwnProperty("name")); //truealert("name" in person1); //true alert(person2.name); //"Nicholas" â€”â€”æ¥è‡ªåŽŸåž‹alert(person2.hasOwnProperty("name")); //falsealert("name" in person2); //true delete person1.name;alert(person1.name); //"Nicholas" â€”â€”æ¥è‡ªåŽŸåž‹alert(person1.hasOwnProperty("name")); //falsealert("name" in person1); //trueè¦å–å¾—å¯¹è±¡ä¸Šæ‰€æœ‰å¯æžšä¸¾çš„å®žä¾‹å±žæ€§ï¼Œå¯ä»¥ä½¿ç”¨ECMAScript 5 çš„Object.keys()æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æŽ¥æ”¶ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿”å›žä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯æžšä¸¾å±žæ€§çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚1234567891011121314151617function Person()&#123;&#125;Person.prototype.name = "Nicholas";Person.prototype.age = 29;Person.prototype.job = "Software Engineer";Person.prototype.sayName = function()&#123; alert(this.name);&#125;; var keys = Object.keys(Person.prototype);alert(keys); //"name,age,job,sayName" var p1 = new Person();p1.name = "Rob";p1.age = 31;var p1keys = Object.keys(p1);alert(p1keys); //"name,age"å¦‚æžœä½ æƒ³è¦å¾—åˆ°æ‰€æœ‰å®žä¾‹å±žæ€§ï¼Œæ— è®ºå®ƒæ˜¯å¦å¯æžšä¸¾ï¼Œéƒ½å¯ä»¥ä½¿ç”¨Object.getOwnPropertyNames()æ–¹æ³•ã€‚12345678var keys = Object.getOwnPropertyNames(Person.prototype);alert(keys); //"constructor,name,age,job,sayName" var p1 = new Person();p1.name = "Rob";p1.age = 31;var p1keys = Object.getOwnPropertyNames(p1);alert(p1keys); //"name,age"æ¯ä¸ªå‡½æ•°éƒ½åŒ…å«ä¸¤ä¸ªéžç»§æ‰¿è€Œæ¥çš„æ–¹æ³•ï¼šapply()å’Œcall()ã€‚apply()å’Œcall()è¿™ä¸¤ä¸ªæ–¹æ³•çš„ç”¨é€”éƒ½æ˜¯åœ¨ç‰¹å®šçš„ä½œç”¨åŸŸä¸­è°ƒç”¨å‡½æ•°ï¼Œå®žé™…ä¸Šç­‰äºŽè®¾ç½®å‡½æ•°ä½“å†…this å¯¹è±¡çš„å€¼ã€‚apply()æ–¹æ³•æŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ˜¯åœ¨å…¶ä¸­è¿è¡Œå‡½æ•°çš„ä½œç”¨åŸŸï¼Œå¦ä¸€ä¸ªæ˜¯å‚æ•°æ•°ç»„ã€‚å…¶ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æ˜¯Array çš„å®žä¾‹ï¼Œä¹Ÿå¯ä»¥æ˜¯argumentså¯¹è±¡ã€‚ä¾‹å¦‚ï¼š1234567891011function sum(num1, num2)&#123; return num1 + num2;&#125;function callSum1(num1, num2)&#123; return sum.apply(this, arguments); // ä¼ å…¥arguments å¯¹è±¡&#125;function callSum2(num1, num2)&#123; return sum.apply(this, [num1, num2]); // ä¼ å…¥æ•°ç»„&#125;alert(callSum1(10,10)); //20alert(callSum2(10,10)); //20åœ¨è¿™é‡Œï¼Œthiså°±ç›¸å½“äºŽwindowã€‚å¯¹äºŽcall()æ–¹æ³•è€Œè¨€ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯this å€¼æ²¡æœ‰å˜åŒ–ï¼Œå˜åŒ–çš„æ˜¯å…¶ä½™å‚æ•°éƒ½ç›´æŽ¥ä¼ é€’ç»™å‡½æ•°ã€‚1234567function sum(num1, num2)&#123; return num1 + num2;&#125;function callSum(num1, num2)&#123; return sum.call(this, num1, num2);&#125;alert(callSum(10,10)); //20äº‹å®žä¸Šï¼Œä¼ é€’å‚æ•°å¹¶éžapply()å’Œcall()çœŸæ­£çš„ç”¨æ­¦ä¹‹åœ°ï¼›å®ƒä»¬çœŸæ­£å¼ºå¤§çš„åœ°æ–¹æ˜¯èƒ½å¤Ÿæ‰©å……å‡½æ•°èµ–ä»¥è¿è¡Œçš„ä½œç”¨åŸŸã€‚12345678910window.color = "red";var o = &#123; color: "blue" &#125;;function sayColor()&#123; alert(this.color);&#125; sayColor(); //redsayColor.call(this); //redsayColor.call(window); //redsayColor.call(o); //blueECMAScript 5 è¿˜å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•ï¼šbind()ã€‚è¿™ä¸ªæ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªå‡½æ•°çš„å®žä¾‹ï¼Œå…¶this å€¼ä¼šè¢«ç»‘å®šåˆ°ä¼ ç»™bind()å‡½æ•°çš„å€¼ã€‚ä¾‹å¦‚ï¼š1234567window.color = "red";var o = &#123; color: "blue" &#125;;function sayColor()&#123; alert(this.color);&#125;var objectSayColor = sayColor.bind(o);objectSayColor(); //blue â€‹ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScript CreateObject]]></title>
    <url>%2FJavaScript-CreateObject.html</url>
    <content type="text"><![CDATA[åˆ›å»ºè‡ªå®šä¹‰ç±»åž‹çš„æœ€å¸¸è§æ–¹å¼ï¼Œå°±æ˜¯ç»„åˆä½¿ç”¨æž„é€ å‡½æ•°æ¨¡å¼ä¸ŽåŽŸåž‹æ¨¡å¼ã€‚æž„é€ å‡½æ•°æ¨¡å¼ç”¨äºŽå®šä¹‰å®žä¾‹å±žæ€§ï¼Œè€ŒåŽŸåž‹æ¨¡å¼ç”¨äºŽå®šä¹‰æ–¹æ³•å’Œå…±äº«çš„å±žæ€§ã€‚ç»“æžœï¼Œæ¯ä¸ªå®žä¾‹éƒ½ä¼šæœ‰è‡ªå·±çš„ä¸€ä»½å®žä¾‹å±žæ€§çš„å‰¯æœ¬ï¼Œä½†åŒæ—¶åˆå…±äº«ç€å¯¹æ–¹æ³•çš„å¼•ç”¨ï¼Œæœ€å¤§é™åº¦åœ°èŠ‚çœäº†å†…å­˜ã€‚å¦å¤–ï¼Œè¿™ç§æ··æˆæ¨¡å¼è¿˜æ”¯æŒå‘æž„é€ å‡½æ•°ä¼ é€’å‚æ•°ã€‚å¦‚ï¼š123456789101112131415161718function Person(name, age, job)&#123; this.name = name; this.age = age; this.job = job; this.friends = ["Shelby", "Court"];&#125;Person.prototype = &#123; constructor : Person, sayName : function()&#123; return this.name; &#125;&#125;var person1 = new Person("Nicholas", 29, "Software Engineer");var person2 = new Person("Greg", 27, "Doctor");alert(person1.friends); //"Shelby,Count"alert(person2.friends); //"Shelby,Count"alert(person1.friends === person2.friends); //falsealert(person1.sayName === person2.sayName); //trueåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®žä¾‹å±žæ€§éƒ½æ˜¯åœ¨æž„é€ å‡½æ•°ä¸­å®šä¹‰çš„ï¼Œè€Œç”±æ‰€æœ‰å®žä¾‹å…±äº«çš„å±žæ€§constructor å’Œæ–¹æ³•sayName()åˆ™æ˜¯åœ¨åŽŸåž‹ä¸­å®šä¹‰çš„ã€‚è€Œä¿®æ”¹äº†person1.friendsï¼ˆå‘å…¶ä¸­æ·»åŠ ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼‰ï¼Œå¹¶ä¸ä¼šå½±å“åˆ°person2.friendsï¼Œå› ä¸ºå®ƒä»¬åˆ†åˆ«å¼•ç”¨äº†ä¸åŒçš„æ•°ç»„ã€‚ è¿™ç§æž„é€ å‡½æ•°ä¸ŽåŽŸåž‹æ··æˆçš„æ¨¡å¼ï¼Œæ˜¯ç›®å‰åœ¨ECMAScript ä¸­ä½¿ç”¨æœ€å¹¿æ³›ã€è®¤åŒåº¦æœ€é«˜çš„ä¸€ç§åˆ›å»ºè‡ªå®šä¹‰ç±»åž‹çš„æ–¹æ³•ã€‚ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScript Arrayç±»åž‹]]></title>
    <url>%2FJavaScript-Array%E7%B1%BB%E5%9E%8B.html</url>
    <content type="text"><![CDATA[æ£€æµ‹æ•°ç»„ECMAScript 5 æ–°å¢žäº†Array.isArray()æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•çš„ç›®çš„æ˜¯æœ€ç»ˆç¡®å®šæŸä¸ªå€¼åˆ°åº•æ˜¯ä¸æ˜¯æ•°ç»„ã€‚123if (Array.isArray(value))&#123; //å¯¹æ•°ç»„æ‰§è¡ŒæŸäº›æ“ä½œ&#125;è½¬æ¢æ–¹æ³•æ‰€æœ‰å¯¹è±¡éƒ½å…·æœ‰toLocaleString()ã€toString()å’ŒvalueOf()æ–¹æ³•ã€‚å…¶ä¸­ï¼Œè°ƒç”¨æ•°ç»„çš„toString()æ–¹æ³•ä¼šè¿”å›žç”±æ•°ç»„ä¸­æ¯ä¸ªå€¼çš„å­—ç¬¦ä¸²å½¢å¼æ‹¼æŽ¥è€Œæˆçš„ä¸€ä¸ªä»¥é€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ã€‚è€Œ è°ƒç”¨valueOf()è¿”å›žçš„è¿˜æ˜¯æ•°ç»„ã€‚1234var colors = ["red", "blue", "green"]; // åˆ›å»ºä¸€ä¸ªåŒ…å«3 ä¸ªå­—ç¬¦ä¸²çš„æ•°ç»„alert(colors.toString()); // red,blue,greenalert(colors.valueOf()); // red,blue,greenalert(colors); // red,blue,greenæœ€åŽä¸€è¡Œä»£ç ç›´æŽ¥å°†æ•°ç»„ä¼ é€’ç»™äº†alert()ã€‚ç”±äºŽalert()è¦æŽ¥æ”¶å­—ç¬¦ä¸²å‚æ•°ï¼Œæ‰€ä»¥å®ƒä¼šåœ¨åŽå°è°ƒç”¨toString()æ–¹æ³•ï¼Œç”±æ­¤ä¼šå¾—åˆ°ä¸Žç›´æŽ¥è°ƒtoString()æ–¹æ³•ç›¸åŒçš„ç»“æžœã€‚join()æ–¹æ³•åªæŽ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå³ç”¨ä½œåˆ†éš”ç¬¦çš„å­—ç¬¦ä¸²ï¼Œç„¶åŽè¿”å›žåŒ…å«æ‰€æœ‰æ•°ç»„é¡¹çš„å­—ç¬¦ä¸²ã€‚123var colors = ["red", "green", "blue"];alert(colors.join(",")); //red,green,bluealert(colors.join("||")); //red||green||blueæ ˆæ–¹æ³•æ ˆæ˜¯ä¸€ç§LIFOï¼ˆLast-In-First-Outï¼ŒåŽè¿›å…ˆå‡ºï¼‰çš„æ•°æ®ç»“æž„ï¼Œä¹Ÿå°±æ˜¯æœ€æ–°æ·»åŠ çš„é¡¹æœ€æ—©è¢«ç§»é™¤ã€‚è€Œæ ˆä¸­é¡¹çš„æ’å…¥ï¼ˆå«åšæŽ¨å…¥ï¼‰å’Œç§»é™¤ï¼ˆå«åšå¼¹å‡ºï¼‰ï¼Œåªå‘ç”Ÿåœ¨ä¸€ä¸ªä½ç½®â€”â€”æ ˆçš„é¡¶éƒ¨ã€‚ECMAScript ä¸ºæ•°ç»„ä¸“é—¨æä¾›äº†push()å’Œpop()æ–¹æ³•ï¼Œä»¥ä¾¿å®žçŽ°ç±»ä¼¼æ ˆçš„è¡Œä¸ºã€‚push()æ–¹æ³•å¯ä»¥æŽ¥æ”¶ä»»æ„æ•°é‡çš„å‚æ•°ï¼ŒæŠŠå®ƒä»¬é€ä¸ªæ·»åŠ åˆ°æ•°ç»„æœ«å°¾ï¼Œå¹¶è¿”å›žä¿®æ”¹åŽæ•°ç»„çš„é•¿åº¦ã€‚è€Œpop()æ–¹æ³•åˆ™ä»Žæ•°ç»„æœ«å°¾ç§»é™¤æœ€åŽä¸€é¡¹ï¼Œå‡å°‘æ•°ç»„çš„lengthå€¼ï¼Œç„¶åŽè¿”å›žç§»é™¤çš„é¡¹ã€‚12345678var colors = new Array(); // åˆ›å»ºä¸€ä¸ªæ•°ç»„var count = colors.push("red", "green"); // æŽ¨å…¥ä¸¤é¡¹alert(count); //2count = colors.push("black"); // æŽ¨å…¥å¦ä¸€é¡¹alert(count); //3var item = colors.pop(); // å–å¾—æœ€åŽä¸€é¡¹alert(item); //"black"alert(colors.length); //2é˜Ÿåˆ—æ–¹æ³•é˜Ÿåˆ—æ•°æ®ç»“æž„çš„è®¿é—®è§„åˆ™æ˜¯FIFOï¼ˆFirst-In-First-Outï¼Œ å…ˆè¿›å…ˆå‡ºï¼‰ã€‚é˜Ÿåˆ—åœ¨åˆ—è¡¨çš„æœ«ç«¯æ·»åŠ é¡¹ï¼Œä»Žåˆ—è¡¨çš„å‰ç«¯ç§»é™¤é¡¹ã€‚shift()æ–¹æ³•ç§»é™¤æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªé¡¹å¹¶è¿”å›žè¯¥é¡¹ï¼ŒåŒæ—¶å°†æ•°ç»„é•¿åº¦å‡1ã€‚12345678var colors = new Array(); //åˆ›å»ºä¸€ä¸ªæ•°ç»„var count = colors.push("red", "green"); //æŽ¨å…¥ä¸¤é¡¹alert(count); //2count = colors.push("black"); //æŽ¨å…¥å¦ä¸€é¡¹alert(count); //3var item = colors.shift(); //å–å¾—ç¬¬ä¸€é¡¹alert(item); //"red"alert(colors.length); //2ECMAScript è¿˜ä¸ºæ•°ç»„æä¾›äº†ä¸€ä¸ªunshift()æ–¹æ³•ã€‚é¡¾åæ€ä¹‰ï¼Œunshift()ä¸Žshift()çš„ç”¨é€”ç›¸åï¼šå®ƒèƒ½åœ¨æ•°ç»„å‰ç«¯æ·»åŠ ä»»æ„ä¸ªé¡¹å¹¶è¿”å›žæ–°æ•°ç»„çš„é•¿åº¦ã€‚12345var colors = new Array(); //åˆ›å»ºä¸€ä¸ªæ•°ç»„var count = colors.unshift("red", "green"); //æŽ¨å…¥ä¸¤é¡¹alert(count); //2count = colors.unshift("black"); //æŽ¨å…¥å¦ä¸€é¡¹alert(count); //3é‡æŽ’åºæ–¹æ³•æ•°ç»„ä¸­å·²ç»å­˜åœ¨ä¸¤ä¸ªå¯ä»¥ç›´æŽ¥ç”¨æ¥é‡æŽ’åºçš„æ–¹æ³•ï¼šreverse()å’Œsort()ã€‚reverse()æ–¹æ³•ä¼šåè½¬æ•°ç»„é¡¹çš„é¡ºåºã€‚123var values = [1, 2, 3, 4, 5];values.reverse();alert(values); //5,4,3,2,1sort()æ–¹æ³•æŒ‰å‡åºæŽ’åˆ—æ•°ç»„é¡¹â€”â€”å³æœ€å°çš„å€¼ä½äºŽæœ€å‰é¢ï¼Œæœ€å¤§çš„å€¼æŽ’åœ¨æœ€åŽé¢ã€‚ä¸ºäº†å®žçŽ°æŽ’åºï¼Œsort()æ–¹æ³•ä¼šè°ƒç”¨æ¯ä¸ªæ•°ç»„é¡¹çš„toString()è½¬åž‹æ–¹æ³•ï¼Œç„¶åŽæ¯”è¾ƒå¾—åˆ°çš„å­—ç¬¦ä¸²ï¼Œä»¥ç¡®å®šå¦‚ä½•æŽ’åºã€‚123var values = [0, 1, 5, 10, 15];values.sort();alert(values); //0,1,10,15,5sort()æ–¹æ³•è¿˜å¯ä»¥æŽ¥æ”¶ä¸€ä¸ªæ¯”è¾ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œä»¥ä¾¿æˆ‘ä»¬æŒ‡å®šå“ªä¸ªå€¼ä½äºŽå“ªä¸ªå€¼çš„å‰é¢ã€‚123456function compare(value1, value2)&#123; return value2 - value1;&#125;var values = [0, 1, 5, 10, 15];values.sort(compare);alert(values); // 15,10,5,1,0æ“ä½œæ–¹æ³•concat()æ–¹æ³•å¯ä»¥åŸºäºŽå½“å‰æ•°ç»„ä¸­çš„æ‰€æœ‰é¡¹åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ã€‚è¿™ä¸ªæ–¹æ³•ä¼šå…ˆåˆ›å»ºå½“å‰æ•°ç»„ä¸€ä¸ªå‰¯æœ¬ï¼Œç„¶åŽå°†æŽ¥æ”¶åˆ°çš„å‚æ•°æ·»åŠ åˆ°è¿™ä¸ªå‰¯æœ¬çš„æœ«å°¾ï¼Œæœ€åŽè¿”å›žæ–°æž„å»ºçš„æ•°ç»„ã€‚åœ¨æ²¡æœ‰ç»™concat()æ–¹æ³•ä¼ é€’å‚æ•°çš„æƒ…å†µä¸‹ï¼Œå®ƒåªæ˜¯å¤åˆ¶å½“å‰æ•°ç»„å¹¶è¿”å›žå‰¯æœ¬ã€‚å¦‚æžœä¼ é€’ç»™concat()æ–¹æ³•çš„æ˜¯ä¸€æˆ–å¤šä¸ªæ•°ç»„ï¼Œåˆ™è¯¥æ–¹æ³•ä¼šå°†è¿™äº›æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹éƒ½æ·»åŠ åˆ°ç»“æžœæ•°ç»„ä¸­ã€‚å¦‚æžœä¼ é€’çš„å€¼ä¸æ˜¯æ•°ç»„ï¼Œè¿™äº›å€¼å°±ä¼šè¢«ç®€å•åœ°æ·»åŠ åˆ°ç»“æžœæ•°ç»„çš„æœ«å°¾ã€‚1234var colors = ["red", "green", "blue"];var colors2 = colors.concat("yellow", ["black", "brown"]);alert(colors); //red,green,bluealert(colors2); //red,green,blue,yellow,black,brownslice()æ–¹æ³•å¯ä»¥æŽ¥å—ä¸€æˆ–ä¸¤ä¸ªå‚æ•°ï¼Œå³è¦è¿”å›žé¡¹çš„èµ·å§‹å’Œç»“æŸä½ç½®ã€‚åœ¨åªæœ‰ä¸€ä¸ªå‚æ•°çš„æƒ…å†µä¸‹ï¼Œslice()æ–¹æ³•è¿”å›žä»Žè¯¥å‚æ•°æŒ‡å®šä½ç½®å¼€å§‹åˆ°å½“å‰æ•°ç»„æœ«å°¾çš„æ‰€æœ‰é¡¹ã€‚å¦‚æžœæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œè¯¥æ–¹æ³•è¿”å›žèµ·å§‹å’Œç»“æŸä½ç½®ä¹‹é—´çš„é¡¹â€”â€”ä½†ä¸åŒ…æ‹¬ç»“æŸä½ç½®çš„é¡¹ã€‚12345var colors = ["red", "green", "blue", "yellow", "purple"];var colors2 = colors.slice(1);var colors3 = colors.slice(1,4);alert(colors2); //green,blue,yellow,purplealert(colors3); //green,blue,yellowsplice()æ–¹æ³•ï¼š12345678910var colors = ["red", "green", "blue"];var removed = colors.splice(0,1); // åˆ é™¤ç¬¬ä¸€é¡¹alert(colors); // green,bluealert(removed); // redï¼Œè¿”å›žçš„æ•°ç»„ä¸­åªåŒ…å«ä¸€é¡¹removed = colors.splice(1, 0, "yellow", "orange"); // ä»Žä½ç½®1 å¼€å§‹æ’å…¥ä¸¤é¡¹alert(colors); // green,yellow,orange,bluealert(removed); // è¿”å›žçš„æ˜¯ä¸€ä¸ªç©ºæ•°ç»„removed = colors.splice(1, 1, "red", "purple"); // æ’å…¥ä¸¤é¡¹ï¼Œåˆ é™¤ä¸€é¡¹alert(colors); // green,red,purple,orange,bluealert(removed); // yellowï¼Œè¿”å›žçš„æ•°ç»„ä¸­åªåŒ…å«ä¸€é¡¹ä½ç½®æ–¹æ³•ECMAScript 5 ä¸ºæ•°ç»„å®žä¾‹æ·»åŠ äº†ä¸¤ä¸ªä½ç½®æ–¹æ³•ï¼šindexOf()å’ŒlastIndexOf()ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šè¦æŸ¥æ‰¾çš„é¡¹å’Œï¼ˆå¯é€‰çš„ï¼‰è¡¨ç¤ºæŸ¥æ‰¾èµ·ç‚¹ä½ç½®çš„ç´¢å¼•ã€‚å…¶ä¸­ï¼ŒindexOf()æ–¹æ³•ä»Žæ•°ç»„çš„å¼€å¤´ï¼ˆä½ç½®0ï¼‰å¼€å§‹å‘åŽæŸ¥æ‰¾ï¼ŒlastIndexOf()æ–¹æ³•åˆ™ä»Žæ•°ç»„çš„æœ«å°¾å¼€å§‹å‘å‰æŸ¥æ‰¾ã€‚æ²¡æœ‰æ‰¾åˆ°è¿”å›ž-1ã€‚12345var numbers = [1,2,3,4,5,4,3,2,1];alert(numbers.indexOf(4)); //3alert(numbers.lastIndexOf(4)); //5alert(numbers.indexOf(4, 4)); //5alert(numbers.lastIndexOf(4, 4)); //3è¿­ä»£æ–¹æ³•every()ï¼šå¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œå¦‚æžœè¯¥å‡½æ•°å¯¹æ¯ä¸€é¡¹éƒ½è¿”å›žtrueï¼Œåˆ™è¿”å›žtrueã€‚filter()ï¼šå¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œè¿”å›žè¯¥å‡½æ•°ä¼šè¿”å›žtrue çš„é¡¹ç»„æˆçš„æ•°ç»„ã€‚forEach()ï¼šå¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ã€‚è¿™ä¸ªæ–¹æ³•æ²¡æœ‰è¿”å›žå€¼ã€‚map()ï¼šå¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œè¿”å›žæ¯æ¬¡å‡½æ•°è°ƒç”¨çš„ç»“æžœç»„æˆçš„æ•°ç»„ã€‚some()ï¼šå¯¹æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹è¿è¡Œç»™å®šå‡½æ•°ï¼Œå¦‚æžœè¯¥å‡½æ•°å¯¹ä»»ä¸€é¡¹è¿”å›žtrueï¼Œåˆ™è¿”å›žtrueã€‚ä»¥ä¸Šæ–¹æ³•éƒ½ä¸ä¼šä¿®æ”¹æ•°ç»„ä¸­çš„åŒ…å«çš„å€¼ã€‚123456789var numbers = [1,2,3,4,5,4,3,2,1];var everyResult = numbers.every(function(item, index, array)&#123; return (item &gt; 2);&#125;);alert(everyResult); //falsevar someResult = numbers.some(function(item, index, array)&#123; return (item &gt; 2);&#125;);alert(someResult); //trueä»¥ä¸Šä»£ç è°ƒç”¨äº†every()å’Œsome()ï¼Œä¼ å…¥çš„å‡½æ•°åªè¦ç»™å®šé¡¹å¤§äºŽ2 å°±ä¼šè¿”å›žtrueã€‚å¯¹äºŽevery()ï¼Œå®ƒè¿”å›žçš„æ˜¯falseï¼Œå› ä¸ºåªæœ‰éƒ¨åˆ†æ•°ç»„é¡¹ç¬¦åˆæ¡ä»¶ã€‚å¯¹äºŽsome()ï¼Œç»“æžœå°±æ˜¯trueï¼Œå› ä¸ºè‡³å°‘æœ‰ä¸€é¡¹æ˜¯å¤§äºŽ2 çš„ã€‚filter()å‡½æ•°ï¼š12345var numbers = [1,2,3,4,5,4,3,2,1];var filterResult = numbers.filter(function(item, index, array)&#123; return (item &gt; 2);&#125;);alert(filterResult); //[3,4,5,4,3]map()ä¹Ÿè¿”å›žä¸€ä¸ªæ•°ç»„ï¼Œè€Œè¿™ä¸ªæ•°ç»„çš„æ¯ä¸€é¡¹éƒ½æ˜¯åœ¨åŽŸå§‹æ•°ç»„ä¸­çš„å¯¹åº”é¡¹ä¸Šè¿è¡Œä¼ å…¥å‡½æ•°çš„ç»“æžœã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç»™æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ä¹˜ä»¥2ï¼Œç„¶åŽè¿”å›žè¿™äº›ä¹˜ç§¯ç»„æˆçš„æ•°ç»„ï¼š12345var numbers = [1,2,3,4,5,4,3,2,1];var mapResult = numbers.map(function(item, index, array)&#123; return item * 2;&#125;);alert(mapResult); //[2,4,6,8,10,8,6,4,2]forEach()ç”¨äºŽè¿­ä»£æ•°ç»„ï¼š1234var numbers = [1,2,3,4,5,4,3,2,1];numbers.forEach(function(item, index, array)&#123; //æ‰§è¡ŒæŸäº›æ“ä½œ&#125;);å½’å¹¶æ–¹æ³•ä½¿ç”¨reduce()æ–¹æ³•å¯ä»¥æ‰§è¡Œæ±‚æ•°ç»„ä¸­æ‰€æœ‰å€¼ä¹‹å’Œçš„æ“ä½œï¼Œæ¯”å¦‚ï¼š12345var values = [1,2,3,4,5];var sum = values.reduce(function(prev, cur, index, array)&#123; return prev + cur;&#125;);alert(sum); //15ç¬¬ä¸€æ¬¡æ‰§è¡Œå›žè°ƒå‡½æ•°ï¼Œprev æ˜¯1ï¼Œcur æ˜¯2ã€‚ç¬¬äºŒæ¬¡ï¼Œprev æ˜¯3ï¼ˆ1 åŠ 2 çš„ç»“æžœï¼‰ï¼Œcur æ˜¯3ï¼ˆæ•°ç»„çš„ç¬¬ä¸‰é¡¹ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šæŒç»­åˆ°æŠŠæ•°ç»„ä¸­çš„æ¯ä¸€é¡¹éƒ½è®¿é—®ä¸€éï¼Œæœ€åŽè¿”å›žç»“æžœã€‚ reduceRight()çš„ä½œç”¨ç±»ä¼¼ï¼Œåªä¸è¿‡æ–¹å‘ç›¸åè€Œå·²ï¼š12345var values = [1,2,3,4,5];var sum = values.reduceRight(function(prev, cur, index, array)&#123; return prev + cur;&#125;);alert(sum); //15åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œå›žè°ƒå‡½æ•°ï¼Œprev æ˜¯5ï¼Œcur æ˜¯4ã€‚å½“ç„¶ï¼Œæœ€ç»ˆç»“æžœç›¸åŒï¼Œå› ä¸ºæ‰§è¡Œçš„éƒ½æ˜¯ç®€å•ç›¸åŠ çš„æ“ä½œã€‚ä½¿ç”¨reduce()è¿˜æ˜¯reduceRight()ï¼Œä¸»è¦å–å†³äºŽè¦ä»Žå“ªå¤´å¼€å§‹éåŽ†æ•°ç»„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒä»¬å®Œå…¨ç›¸åŒã€‚æžå€¼12var values = [1, 2, 3, 4, 5, 6, 7, 8];var max = Math.max.apply(Math, values); //8ã€ŠJavaScripté«˜çº§ç¨‹åºè®¾è®¡ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSP æ ‡ç­¾æ–‡ä»¶]]></title>
    <url>%2FJSP-%E6%A0%87%E7%AD%BE%E6%96%87%E4%BB%B6.html</url>
    <content type="text"><![CDATA[å®šåˆ¶JSPæ ‡ç­¾å¯ä»¥å®žçŽ°ä¸€äº›JSTLå’ŒELæ²¡æœ‰æä¾›çš„åŠŸèƒ½ï¼ŒåŸºæœ¬æ­¥éª¤å°±æ˜¯ç¼–å†™æ ‡ç­¾å¤„ç†å™¨ç„¶åŽæ³¨å†Œæ ‡ç­¾ã€‚ä»ŽJSP2.0ä»¥åŽï¼Œå¯ä»¥ç›´æŽ¥ç¼–å†™æ ‡ç­¾æ–‡ä»¶ï¼ˆ.tagï¼‰æ¥ä»£æ›¿å®šåˆ¶JSPæ ‡ç­¾ã€‚ç›¸æ¯”å®šåˆ¶JSPæ ‡ç­¾ï¼Œæ ‡ç­¾æ–‡ä»¶æ— éœ€ç¼–å†™Javaä»£ç ï¼Œæ— éœ€æ³¨å†Œæ ‡ç­¾ï¼Œåªéœ€è¦åœ¨tagæ–‡ä»¶ä¸­å†™ä»£ç é€»è¾‘å³å¯ã€‚ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼šåœ¨WEB-INFä¸‹åˆ›å»ºtagsæ–‡ä»¶å¤¹ï¼Œç„¶åŽåœ¨é‡Œé¢æ–°å»ºä¸€ä¸ªfirstTag.tagæ–‡ä»¶ï¼š123456&lt;%@tag import="java.util.Date"%&gt;&lt;%@tag import="java.text.SimpleDateFormat"%&gt;&lt;% SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd"); out.print(sdf.format(new Date()));%&gt;ç„¶åŽåœ¨firstTagTest.jspé¡µé¢ä¸­ä½¿ç”¨å®ƒï¼š12&lt;%@ taglib prefix="mt" tagdir="/WEB-INF/tags"%&gt;Today is:&lt;mt:firstTag/&gt;éƒ¨ç½²åˆ°Tomcatä¸­ï¼Œå¯åŠ¨æœåŠ¡ï¼Œè®¿é—®è¯¥jspï¼Œé¡µé¢æ˜¾ç¤ºï¼šThatâ€™ all.æ ‡ç­¾æ–‡ä»¶ä¸­çš„éšå¼å¯¹è±¡ï¼šå¯¹è±¡ç±»åž‹requestjavax.servlet.http.HttpServletRequestresponsejavax.servlet.http.HttpServletResponseoutjavax.servlet.jsp.JspWritersessionjavax.servlet.http.HttpSessionapplicationjavax.servlet.ServletContextconfigjavax.servlet.ServletConfigjspContextjavax.servlet.jsp.JspContextå’ŒJspçš„éšå¼å¯¹è±¡ç±»ä¼¼ã€‚æ ‡ç­¾æ–‡ä»¶æŒ‡ä»¤tagæŒ‡ä»¤tagæŒ‡ä»¤å¸¸ç”¨å±žæ€§ï¼šå±žæ€§æè¿°display-nameé€šè¿‡XMLå·¥å…·æ˜¾ç¤ºçš„ç®€ç§°ï¼Œé»˜è®¤ä¸ºæ ‡ç­¾åbody-contentæ ‡ç­¾ä¸»ä½“å†…å®¹çš„ä¿¡æ¯ï¼Œå¯ä»¥ä¸ºemptyï¼Œtagdependentæˆ–scriptlessï¼ˆé»˜è®¤ï¼‰importå¯¼å…¥Javaç±»åž‹pageEncodingæŒ‡å®šç¼–ç isELIgnoredsæ˜¯å¦ä½¿ç”¨ELè¡¨è¾¾å¼includeæŒ‡ä»¤è¯¥æŒ‡ä»¤å¯ä»¥å¼•å…¥é™æ€æ–‡ä»¶ï¼ˆHTMLæ–‡ä»¶ï¼‰æˆ–åŠ¨æ€æ–‡ä»¶ï¼ˆå¦ä¸€ä¸ªæ ‡ç­¾æ–‡ä»¶ï¼‰ã€‚å¦‚æœ‰é™æ€HTMLæ–‡ä»¶included.htmlï¼š123456789101112131415161718192021222324252627282930313233343536&lt;table border=1&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td style="text-align: center;"&gt;&lt;strong&gt;object&lt;/strong&gt;&lt;/td&gt; &lt;td style="text-align: center;"&gt;&lt;strong&gt;type&lt;/strong&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;request&lt;/td&gt; &lt;td&gt;javax.servlet.http.HttpServletRequest&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;response&lt;/td&gt; &lt;td&gt;javax.servlet.http.HttpServletResponse&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;out&lt;/td&gt; &lt;td&gt;javax.servlet.jsp.JspWriter&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;session&lt;/td&gt; &lt;td&gt;javax.servlet.http.HttpSession&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;application&lt;/td&gt; &lt;td&gt;javax.servlet.ServletContext&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;config&lt;/td&gt; &lt;td&gt;javax.servlet.ServletConfig&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;jspContext&lt;/td&gt; &lt;td&gt;javax.servlet.jsp.JspContext&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt;&lt;/table&gt;included.tagæ–‡ä»¶ï¼š1234&lt;%@tag pageEncoding="utf-8" %&gt;&lt;% out.print("å’ŒJspçš„éšå¼å¯¹è±¡ç±»ä¼¼ã€‚");%&gt;åœ¨include.tagæ ‡ç­¾ä¸­å¼•ç”¨included.htmlå’Œincluded.tagï¼š1234&lt;%@tag pageEncoding="utf-8"%&gt;æ ‡ç­¾æ–‡ä»¶ä¸­çš„éšå¼å¯¹è±¡ï¼š&lt;/br&gt;&lt;/br&gt;&lt;%@include file="/WEB-INF/tags/included.html"%&gt;&lt;/br&gt;&lt;%@include file="/WEB-INF/tags/included.tag"%&gt;åœ¨jspé¡µé¢ä¸­æµ‹è¯•ï¼š123&lt;%@taglib prefix="mt" tagdir="/WEB-INF/tags" %&gt;&lt;%@page pageEncoding="utf-8" %&gt;&lt;mt:include/&gt;å¯åŠ¨è®¿é—®ï¼Œé¡µé¢æ˜¾ç¤ºï¼štaglibæŒ‡ä»¤è¯¥æŒ‡ä»¤çš„ä½œç”¨å°±æ˜¯åœ¨ä¸€ä¸ªæ ‡ç­¾æ–‡ä»¶ä¸­ä½¿ç”¨å¦å¤–ä¸€ä¸ªæ ‡ç­¾ï¼Œå¦‚çŽ°æœ‰taglibDemo.tagï¼š12&lt;%@ taglib prefix="mt" tagdir="/WEB-INF/tags" %&gt;Today's date : &lt;mt:firstTag/&gt;è¯¥æ ‡ç­¾è°ƒç”¨äº†ç¬¬ä¸€ä¸ªä¾‹å­ä¸­åˆ›å»ºçš„firstTagæ ‡ç­¾ã€‚attributeæŒ‡ä»¤è¯¥æŒ‡ä»¤åœ¨æ ‡ç­¾ä¸­ä½¿ç”¨å±žæ€§ï¼Œattributeå¸¸ç”¨çš„å±žæ€§æœ‰ï¼šå±žæ€§æè¿°nameå±žæ€§årequiredæ˜¯å¦å¼å¿…é¡»çš„ï¼Œé»˜è®¤ä¸ºfalsetype&nbsp;&nbsp;&nbsp;&nbsp;ç±»åž‹ï¼Œé»˜è®¤ä¸ºStringç¼–å†™ä¸€ä¸ªæ—¶é—´æ ¼å¼åŒ–æ ‡ç­¾formatDate.tagï¼š1234567&lt;%@tag import="java.util.Date"%&gt;&lt;%@tag import="java.text.SimpleDateFormat"%&gt;&lt;%@ attribute name="fmt" required="true"%&gt;&lt;% SimpleDateFormat sdf = new SimpleDateFormat(fmt); out.print(sdf.format(new Date()));%&gt;jspä¸­æµ‹è¯•ï¼š123&lt;%@ taglib prefix="mt" tagdir="/WEB-INF/tags" %&gt;&lt;mt:dateFormat fmt="yyyy-MM-dd HH:mm:ss"/&gt;&lt;/br&gt;&lt;mt:dateFormat fmt="yyyyMMdd"/&gt;é¡µé¢æ˜¾ç¤ºï¼švariableæŒ‡ä»¤ç”¨äºŽå®šä¹‰æ ‡ç­¾æ–‡ä»¶çš„å˜é‡ï¼Œå¸¸ç”¨çš„å±žæ€§æœ‰ï¼šå±žæ€§æè¿°name-givenå˜é‡åscopeèŒƒå›´descriptionæè¿°å¦‚ä¸‹æ ‡ç­¾ï¼Œå®ƒæœ‰ä¸¤ä¸ªå˜é‡ï¼šlongDateå’ŒshortDateï¼š123456789101112&lt;%@tag import="java.text.SimpleDateFormat"%&gt;&lt;%@tag import="java.util.Date"%&gt;&lt;%@ variable name-given="longDate" %&gt;&lt;%@ variable name-given="shortDate" %&gt;&lt;% Date date = new Date(); SimpleDateFormat longFormat = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss"); SimpleDateFormat shortFormat = new SimpleDateFormat("yyyy-MM-dd"); jspContext.setAttribute("longDate", longFormat.format(date)); jspContext.setAttribute("shortDate", shortFormat.format(date));%&gt;&lt;jsp:doBody/&gt;jspé¡µé¢å¼•ç”¨ï¼š12345678&lt;%@ taglib prefix="tags" tagdir="/WEB-INF/tags" %&gt;Today's date:&lt;br/&gt;&lt;tags:varDemo&gt;In long format: $&#123;longDate&#125;&lt;br/&gt;In short format: $&#123;shortDate&#125;&lt;/tags:varDemo&gt;æµ‹è¯•ï¼Œé¡µé¢æ˜¾ç¤ºï¼š]]></content>
      <tags>
        <tag>servlet&amp;jsp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[IO Stream]]></title>
    <url>%2FIO-Stream.html</url>
    <content type="text"><![CDATA[æˆ‘ä»¬ç¼–å†™çš„ç¨‹åºé™¤äº†è‡ªèº«ä¼šå®šä¹‰ä¸€äº›æ•°æ®ä¿¡æ¯å¤–ï¼Œç»å¸¸è¿˜ä¼šå¼•ç”¨å¤–ç•Œçš„æ•°æ®ï¼Œæˆ–æ˜¯å°†è‡ªèº«çš„æ•°æ®å‘é€åˆ°å¤–ç•Œã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬ç¼–å†™çš„ç¨‹åºæƒ³è¯»å–ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œåˆæˆ–è€…æˆ‘ä»¬æƒ³å°†ç¨‹åºä¸­çš„æŸäº›æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚è¿™æ—¶æˆ‘ä»¬å°±è¦ä½¿ç”¨è¾“å…¥ä¸Žè¾“å‡ºã€‚ä»€ä¹ˆæ˜¯è¾“å…¥(read):è¾“å…¥æ˜¯ä¸€ä¸ªä»Žå¤–ç•Œè¿›å…¥åˆ°ç¨‹åºçš„æ–¹å‘ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦â€œè¯»å–â€å¤–ç•Œçš„æ•°æ®æ—¶ï¼Œä½¿ç”¨è¾“å…¥ã€‚æ‰€ä»¥è¾“å…¥æ˜¯ç”¨æ¥è¯»å–æ•°æ®çš„ã€‚ä»€ä¹ˆæ˜¯è¾“å‡º(write):è¾“å‡ºæ˜¯ä¸€ä¸ªä»Žç¨‹åºå‘é€åˆ°å¤–ç•Œçš„æ–¹å‘ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦â€å†™å‡ºâ€æ•°æ®åˆ°å¤–ç•Œæ—¶ï¼Œä½¿ç”¨è¾“å‡ºã€‚æ‰€ä»¥è¾“å‡ºæ˜¯ç”¨æ¥å†™å‡ºæ•°æ®çš„ã€‚InputStreamæ˜¯æ‰€æœ‰å­—èŠ‚è¾“å…¥æµçš„çˆ¶ç±»ï¼Œå…¶å®šä¹‰äº†åŸºç¡€çš„è¯»å–æ–¹æ³•ï¼Œå¸¸ç”¨çš„æ–¹æ³•å¦‚ä¸‹:1.int read():è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œä»¥intå½¢å¼è¿”å›žï¼Œè¯¥intå€¼çš„â€ä½Žå…«ä½â€æœ‰æ•ˆï¼Œè‹¥è¿”å›žå€¼ä¸º-1åˆ™è¡¨ç¤ºEOFã€‚2.int read(byte[] d):å°è¯•æœ€å¤šè¯»å–ç»™å®šæ•°ç»„çš„lengthä¸ªå­—èŠ‚å¹¶å­˜å…¥è¯¥æ•°ç»„ï¼Œè¿”å›žå€¼ä¸ºå®žé™…è¯»å–åˆ°çš„å­—èŠ‚é‡ã€‚OutputStreamæ˜¯æ‰€æœ‰å­—èŠ‚è¾“å‡ºæµçš„çˆ¶ç±»ï¼Œå…¶å®šä¹‰äº†åŸºç¡€çš„å†™å‡ºæ–¹æ³•ï¼Œå¸¸ç”¨çš„æ–¹æ³•å¦‚ä¸‹:1.void write(int d):å†™å‡ºä¸€ä¸ªå­—èŠ‚,å†™çš„æ˜¯ç»™å®šçš„intçš„â€ä½Žå…«ä½â€ã€‚2.void write(byte[] d):å°†ç»™å®šçš„å­—èŠ‚æ•°ç»„ä¸­çš„æ‰€æœ‰å­—èŠ‚å…¨éƒ¨å†™å‡ºã€‚æ–‡ä»¶æµFileOutputStreamjava.io.FileOutputStreamï¼šæ–‡ä»¶å­—èŠ‚è¾“å‡ºæµï¼Œç”¨äºŽå°†æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­çš„æµï¼Œè¯¥æµæ˜¯ä¸€ä¸ªä½Žçº§æµã€‚ä½Žçº§æµç‰¹ç‚¹:æ•°æ®çš„æ¥æºå’ŒåŽ»å‘æ˜¯æ˜Žç¡®çš„ï¼ŒçœŸå®žè´Ÿè´£â€œæ¬è¿â€æ•°æ®çš„æµã€‚123456789101112131415161718192021222324public class FOSDemo &#123; public static void main(String[] args) throws IOException &#123; /* * å‘æ–‡ä»¶ä¸­å†™å‡ºæ•°æ® * ä¸€ä¸ªå‚æ•°çš„æž„é€ æ–¹æ³•: * FileOutputStream(String path) * FileOutputStream(File file) * åˆ›å»ºå‡ºæ¥çš„æ–‡ä»¶è¾“å‡ºæµæ˜¯è¦†ç›–å†™æ“ä½œï¼Œè‹¥æ“ä½œçš„ * æ–‡ä»¶ä¸­æœ‰æ•°æ®ï¼Œä¼šå…ˆå°†æ•°æ®æ¸…é™¤ï¼Œé‡å†™æœ¬æ¬¡å†™å‡ºçš„æ•°æ®ã€‚ * * è‹¥å¸Œæœ›è¿½åŠ å†™æ“ä½œï¼Œåˆ™éœ€è¦ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•° * æ˜¯ä¸€ä¸ªbooleanå€¼ï¼Œä¸ºtrueå³å¯ã€‚ * FileOutputStream(File file,boolean append) * FileOutputStream(String path,boolean append) */ // File file=new File("fos.txt"); // FileOutputStream fos = new FileOutputStream(file,true); FileOutputStream fos = new FileOutputStream("fos.txt",true); String str = "ä¸€æ­¥ä¸¤æ­¥,ä¸€æ­¥ä¸€æ­¥åƒçˆªç‰™,åƒé­”é¬¼çš„æ­¥ä¼!"; fos.write(str.getBytes("UTF-8")); fos.close(); &#125;&#125;FileInputStreamjava.io.FileInputStreamï¼šä½Žçº§æµï¼Œå¯ä»¥ä»Žæ–‡ä»¶ä¸­è¯»å–å­—èŠ‚ï¼ˆæ“ä½œè¿‡ç¨‹å’ŒRandomAccessFileç›¸ä¼¼ï¼‰ã€‚1234567891011public class FISDemo &#123; public static void main(String[] args) throws IOException &#123; FileInputStream fis = new FileInputStream("fos.txt"); byte[] data = new byte[1024]; int len = fis.read(data); String str = new String(data,0,len,"UTF-8"); System.out.println(str);//ä¸€æ­¥ä¸¤æ­¥,ä¸€æ­¥ä¸€æ­¥åƒçˆªç‰™,åƒé­”é¬¼çš„æ­¥ä¼! fis.close(); &#125;&#125;å¤åˆ¶ä½¿ç”¨æ–‡ä»¶æµçš„å½¢å¼å¤åˆ¶æ–‡ä»¶ã€‚1234567891011121314151617 public class CopyDemo1 &#123; public static void main(String[] args) throws IOException &#123; FileInputStream fis = new FileInputStream("fos.txt"); FileOutputStream fos = new FileOutputStream("fos_copy.txt"); byte[] data = new byte[1024*10]; int len = -1; while((len = fis.read(data))!=-1)&#123; fos.write(data,0,len); &#125; System.out.println("å¤åˆ¶å®Œæ¯•"); fis.close(); fos.close(); &#125;&#125;ç¼“å†²æµåœ¨è¯»å–æ•°æ®æ—¶è‹¥ä»¥å­—èŠ‚ä¸ºå•ä½è¯»å–æ•°æ®ï¼Œä¼šå¯¼è‡´è¯»å–æ¬¡æ•°è¿‡äºŽé¢‘ç¹ä»Žè€Œå¤§å¤§çš„é™ä½Žè¯»å–æ•ˆçŽ‡ã€‚ä¸ºæ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡æé«˜ä¸€æ¬¡è¯»å–çš„å­—èŠ‚æ•°é‡å‡å°‘è¯»å†™æ¬¡æ•°æ¥æé«˜è¯»å–çš„æ•ˆçŽ‡ã€‚1.BIS:æ˜¯ä¸€ä¸ªå¤„ç†æµï¼Œè¯¥æµä¸ºæˆ‘ä»¬æä¾›äº†ç¼“å†²åŠŸèƒ½ã€‚2.BOS:ä¸Žç¼“å†²è¾“å…¥æµç›¸ä¼¼ï¼Œåœ¨å‘ç¡¬ä»¶è®¾å¤‡åšå†™å‡ºæ“ä½œæ—¶ï¼Œå¢žå¤§å†™å‡ºæ¬¡æ•°æ— ç–‘ä¹Ÿä¼šé™ä½Žå†™å‡ºæ•ˆçŽ‡ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¼“å†²è¾“å‡ºæµæ¥ä¸€æ¬¡æ€§æ‰¹é‡å†™å‡ºè‹¥å¹²æ•°æ®å‡å°‘å†™å‡ºæ¬¡æ•°æ¥æé«˜å†™ å‡ºæ•ˆçŽ‡ã€‚3.BufferedInputStreamæ˜¯ç¼“å†²å­—èŠ‚è¾“å…¥æµã€‚å…¶å†…éƒ¨ç»´æŠ¤ç€ä¸€ä¸ªç¼“å†²åŒº(å­—èŠ‚æ•°ç»„)ï¼Œä½¿ç”¨è¯¥æµåœ¨è¯»å–ä¸€ä¸ªå­—èŠ‚æ—¶ï¼Œè¯¥æµä¼šå°½å¯èƒ½å¤šçš„ä¸€æ¬¡æ€§è¯»å–è‹¥å¹²å­—èŠ‚å¹¶å­˜å…¥ç¼“å†²åŒºï¼Œç„¶åŽé€ä¸€çš„å°†å­—èŠ‚è¿”å›žï¼Œç›´åˆ°ç¼“å†²åŒºä¸­çš„æ•°æ®è¢«å…¨éƒ¨è¯»å–å®Œæ¯•ï¼Œä¼šå†æ¬¡è¯»å–è‹¥å¹²å­—èŠ‚ä»Žè€Œåå¤ã€‚è¿™æ ·å°±å‡å°‘äº†è¯»å–çš„æ¬¡æ•°ï¼Œä»Žè€Œæé«˜äº†è¯»å–æ•ˆçŽ‡ã€‚4.BufferedOutputStreamç¼“å†²è¾“å‡ºæµå†…éƒ¨ä¹Ÿç»´æŠ¤ç€ä¸€ä¸ªç¼“å†²åŒºï¼Œæ¯å½“æˆ‘ä»¬å‘è¯¥æµå†™æ•°æ®æ—¶ï¼Œéƒ½ä¼šå…ˆå°†æ•°æ®å­˜å…¥ç¼“å†²åŒºï¼Œå½“ç¼“å†²åŒºå·²æ»¡æ—¶ï¼Œç¼“å†²æµä¼šå°†æ•°æ®ä¸€æ¬¡æ€§å…¨éƒ¨å†™å‡ºã€‚BISå’ŒBOSBufferedInputStreamä¸ŽBufferedOutputStream(BISå’ŒBOS):ç¼“å†²å­—èŠ‚è¾“å…¥æµï¼Œç¼“å†²å­—èŠ‚è¾“å‡ºæµ.è¿™æ˜¯ä¸€å¯¹é«˜çº§æµï¼Œä½œç”¨æ˜¯å¯ä»¥æé«˜è¯»å†™æ•ˆçŽ‡.ï¼ˆä½œç”¨ç±»ä¼¼äºŽå­—èŠ‚æ•°ç»„ï¼‰ã€‚12345678910111213141516171819202122public class CopyDemo2 &#123; public static void main(String[] args) throws IOException &#123; FileInputStream fis = new FileInputStream("1.mp4"); BufferedInputStream bis = new BufferedInputStream(fis); FileOutputStream fos = new FileOutputStream("1_copy2.mp4"); BufferedOutputStream bos = new BufferedOutputStream(fos); int d = -1; while((d=bis.read())!=-1)&#123; bos.write(d); &#125; System.out.println("å¤åˆ¶å®Œæ¯•!"); /* * å…³é—­æµçš„æ—¶å€™ï¼Œåªéœ€è¦å…³é—­æœ€å¤–å±‚çš„é«˜çº§æµ * å³å¯ã€‚å› ä¸ºé«˜çº§æµåœ¨å…³é—­è‡ªèº«å‰ä¼šå…ˆå°†å…¶å¤„ç† * çš„æµå…³é—­ã€‚ */ bis.close(); bos.close(); &#125;&#125;flushvoid flush()ï¼Œç¼“å†²æµéƒ½æä¾›äº†flushçš„å®žçŽ°ã€‚ä½œç”¨æ˜¯å¼ºåˆ¶å°†çŽ°æœ‰ç¼“å†²æ•°ç»„ä¸­çš„æ•°æ®ä¸€æ¬¡æ€§å†™å‡ºã€‚é¿å…äº†å› ç¼“å†²æ•°ç»„ä¸­æ•°æ®ä¸å¤Ÿè€Œå¯¼è‡´æ–‡ä»¶å†…å®¹ä¸ºç©ºçš„é—®é¢˜ã€‚é¢‘ç¹è°ƒç”¨è¯¥æ–¹æ³•ä¼šæé«˜å†™å‡ºæ¬¡æ•°ä»Žè€Œé™ä½Žå†™å‡ºæ•ˆçŽ‡ï¼Œä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦æœ‰å†™å‡ºæ•°æ®å³æ—¶æ€§çš„æ—¶å€™å°±è¦ä½¿ç”¨ã€‚12345678910111213public class BosDemo &#123; public static void main(String[] args) throws IOException &#123; FileOutputStream fos = new FileOutputStream("bos.txt"); BufferedOutputStream bos = new BufferedOutputStream(fos); String str = "æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨"; byte[] data = str.getBytes(); bos.write(data); // bos.flush(); bos.close();//closeå†…éƒ¨ä¹Ÿæœ‰flush()æ–¹æ³•. &#125;&#125;å¯¹è±¡æµå¯¹è±¡æ˜¯å­˜åœ¨äºŽå†…å­˜ä¸­çš„ã€‚æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å°†å¯¹è±¡ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œåˆæœ‰æ—¶æˆ‘ä»¬éœ€è¦å°†å¯¹è±¡ä¼ è¾“åˆ°å¦ä¸€å°è®¡ç®—æœºä¸Šç­‰ç­‰è¿™æ ·çš„æ“ä½œã€‚è¿™æ—¶æˆ‘ä»¬éœ€è¦å°†å¯¹è±¡è½¬æ¢ä¸ºä¸€ä¸ªå­—èŠ‚åºåˆ—ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹å°±ç§°ä¸ºå¯¹è±¡åºåˆ—åŒ–ã€‚ç›¸åï¼Œæˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªå­—èŠ‚åºåˆ—éœ€è¦å°†å…¶è½¬æ¢ä¸ºå¯¹åº”çš„å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ç§°ä¸ºå¯¹è±¡çš„ååºåˆ—åŒ–ã€‚1.java.io.ObjectOutputStreamï¼šé«˜çº§æµï¼ŒåŠŸèƒ½æ˜¯å°†ç»™å®šçš„ä¸€ä¸ªå¯¹è±¡è½¬æ¢ä¸ºä¸€ç»„å­—èŠ‚ï¼Œç„¶åŽé€šè¿‡å…¶å¤„ç†çš„æµå°†å­—èŠ‚å†™å‡ºã€‚2.java.io.ObjectInputStreamï¼šé«˜çº§æµï¼Œå¯ä»¥è¿›è¡Œå¯¹è±¡çš„ååºåˆ—åŒ–ã€‚å°† ä¸€ç»„å­—èŠ‚è¿˜åŽŸå›žå¯¹è±¡ï¼Œå‰ææ˜¯è¿™ä¸€ç»„å­—èŠ‚å¿…é¡»æ˜¯ç”±ObjectOutputStreamå°†ä¸€ä¸ªå¯¹è±¡åºåˆ—åŒ–åŽçš„å­—èŠ‚è¯»å†™å¯¹è±¡ä¸€èˆ¬ç”¨äºŽ:ä¿å­˜çŽ°æœ‰å¯¹è±¡åˆ°ç¡¬ç›˜ä¸Šï¼›åœ¨ç½‘ç»œä¸­ä¼ è¾“å¯¹è±¡ã€‚ä»¥ä¸‹Personç±»ç”¨äºŽæµ‹è¯•å¯¹è±¡æµè¯»å†™å¯¹è±¡ï¼š123456789101112131415161718192021public class Person implements Serializable&#123; private String name; private int age; private String gender; private List&lt;String&gt; otherInfo; public Person()&#123; &#125; public Person(String name, int age, String gender, List&lt;String&gt; otherInfo) &#123; super(); this.name = name; this.age = age; this.gender = gender; this.otherInfo = otherInfo; &#125; // get,setç•¥ public String toString()&#123; return name+","+age+","+gender+","+otherInfo; &#125;&#125;å¯¹è±¡â†’å­—èŠ‚1234567891011121314151617181920212223242526public class OOSDemo &#123; public static void main(String[] args) throws IOException &#123; FileOutputStream fos = new FileOutputStream("person.obj"); ObjectOutputStream oos = new ObjectOutputStream(fos); Person p = new Person(); p.setName("è·¯é£ž"); p.setAge(18); p.setGender("ç”·"); List&lt;String&gt; otherInfo = new ArrayList&lt;String&gt;(); otherInfo.add("è’™å¥‡Â·DÂ·è·¯é£ž"); otherInfo.add("è¦æˆä¸ºæµ·è´¼çŽ‹çš„ç”·äºº"); otherInfo.add("ç§¯æžä¹è§‚"); p.setOtherInfo(otherInfo); /* * void writeObject(Object obj) * è¯¥æ–¹æ³•ä¼šå°†ç»™å®šçš„å¯¹è±¡è½¬æ¢ä¸ºä¸€ç»„å­—èŠ‚ï¼Œç„¶åŽå†™å‡º * * åºåˆ—åŒ–:å°†ä¸€ä¸ªæ•°æ®ç»“æž„è½¬æ¢ä¸ºä¸€ç»„å­—èŠ‚çš„è¿‡ç¨‹ * æŒä¹…åŒ–:å°†å†…å­˜ä¸­çš„æ•°æ®å†™å…¥ç¡¬ç›˜é•¿ä¹…ä¿å­˜çš„è¿‡ç¨‹ */ oos.writeObject(p); oos.close(); &#125;&#125;å­—èŠ‚â†’å¯¹è±¡123456789101112131415public class OISDemo &#123; public static void main(String[] args) throws IOException, ClassNotFoundException &#123; FileInputStream fis = new FileInputStream("person.obj"); ObjectInputStream ois = new ObjectInputStream(fis); /* * Object readObject() * è¯¥æ–¹æ³•ä¼šè¯»å–è‹¥å¹²å­—èŠ‚ï¼Œç„¶åŽå°†å…¶ååºåˆ—åŒ–å›žå¯¹è±¡ã€‚ * å¹¶ä»¥Objectå½¢å¼è¿”å›žï¼Œéœ€è¦è‡ªå·±å¼ºåˆ¶ç±»åž‹è½¬æ¢ */ Person p = (Person)ois.readObject(); System.out.println(p); //è·¯é£ž,18,ç”·,[è’™å¥‡Â·DÂ·è·¯é£ž, è¦æˆä¸ºæµ·è´¼çŽ‹çš„ç”·äºº, ç§¯æžä¹è§‚] ois.close(); &#125;&#125;å­—ç¬¦æµReaderæ˜¯æ‰€æœ‰å­—ç¬¦è¾“å…¥æµçš„çˆ¶ç±»ï¼Œè€ŒWriteræ˜¯æ‰€æœ‰å­—ç¬¦è¾“å‡ºæµçš„çˆ¶ç±»ã€‚å­—ç¬¦æµæ˜¯ä»¥å­—ç¬¦(char)ä¸ºå•ä½è¯»å†™æ•°æ®çš„ã€‚ä¸€æ¬¡å¤„ç†ä¸€ä¸ªunicodeã€‚å­—ç¬¦æµéƒ½æ˜¯é«˜çº§æµï¼Œå…¶åº•å±‚éƒ½æ˜¯ä¾é å­—èŠ‚æµè¿›è¡Œè¯»å†™æ•°æ®çš„ï¼Œæ‰€ä»¥åº•å±‚ä»ç„¶æ˜¯åŸºäºŽå­—èŠ‚è¯»å†™æ•°æ®çš„ã€‚Readerçš„å¸¸ç”¨æ–¹æ³•:1.int read()ï¼šè¯»å–ä¸€ä¸ªå­—ç¬¦ï¼Œè¿”å›žçš„intâ€å€¼ä½Ž16â€ä½æœ‰æ•ˆã€‚2.int read(char[] chs)ï¼šä»Žè¯¥æµä¸­è¯»å–ä¸€ä¸ªå­—ç¬¦æ•°ç»„lengthä¸ªå­—ç¬¦å¹¶å­˜å…¥è¯¥æ•°ç»„ï¼Œè¿”å›žå€¼ä¸ºå®žé™…è¯»å–åˆ°çš„å­—ç¬¦é‡ã€‚Writerçš„å¸¸ç”¨æ–¹æ³•:1.void write(int c)ï¼šå†™å‡ºä¸€ä¸ªå­—ç¬¦,å†™å‡ºç»™å®šintå€¼â€ä½Ž16â€ä½è¡¨ç¤ºçš„å­—ç¬¦ã€‚2.void write(char[] chs)ï¼šå°†ç»™å®šå­—ç¬¦æ•°ç»„ä¸­æ‰€æœ‰å­—ç¬¦å†™å‡ºã€‚3.void write(String str)ï¼šç»™å®šçš„å­—ç¬¦ä¸²å†™å‡ºã€‚4.void write(char[] chs,int offset,int len)ï¼šå°†ç»™å®šçš„å­—ç¬¦æ•°ç»„ä¸­ä»Žoffsetå¤„å¼€å§‹è¿žç»­çš„lenä¸ªå­—ç¬¦å†™å‡ºã€‚WriterWriterå­—ç¬¦è¾“å‡ºæµï¼Œç‰¹ç‚¹:ä»¥å­—ç¬¦ä¸ºå•ä½å†™å‡ºæ•°æ®ã€‚OutputStreamWriter:å­—ç¬¦æµçš„ä¸€ä¸ªå¸¸ç”¨å®žçŽ°ç±»ã€‚ç‰¹ç‚¹æ˜¯å¯ä»¥æŒ‰ç…§æŒ‡å®šçš„å­—ç¬¦é›†å°†ç»™å®šçš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹åº”çš„å­—èŠ‚åŽå†™å‡ºã€‚1234567891011121314151617public class OSWDemo &#123; public static void main(String[] args) throws IOException &#123; FileOutputStream fos = new FileOutputStream("osw.txt"); /* * å¸¸ç”¨æž„é€ æ–¹æ³•: * OutputStreamWriter(OutputStream out) * æŒ‰ç…§ç³»ç»Ÿé»˜è®¤å­—ç¬¦é›†å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚åŽå†™å‡º * * OutputStreamWriter(OutputStream out,String charsetName) * æŒ‰ç…§ç»™å®šçš„å­—ç¬¦é›†å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚åŽå†™å‡º */ OutputStreamWriter osw = new OutputStreamWriter(fos,"UTF-8"); osw.write("æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨"); osw.write("å¤©å®‰é—¨ä¸Šå¤ªé˜³å‡"); osw.close(); &#125;&#125;ReaderReaderå­—ç¬¦è¾“å…¥æµ ç‰¹ç‚¹:ä»¥å­—ç¬¦ä¸ºå•ä½è¯»å–æ•°æ®InputStreamReaderæ˜¯å…¶å¸¸ç”¨å®žçŽ°ç±»ï¼Œä½œç”¨æ˜¯å¯ä»¥æŒ‰ç…§æŒ‡å®šçš„å­—ç¬¦é›†è¯»å–å­—ç¬¦ã€‚123456789101112public class ISRDemo &#123; public static void main(String[] args) throws IOException &#123; FileInputStream fis = new FileInputStream("osw.txt"); InputStreamReader isr = new InputStreamReader(fis,"UTF-8"); int d = -1; while((d=isr.read())!=-1)&#123; System.out.print((char)d); &#125; isr.close(); &#125;&#125;è½¬ç è½¬ç ï¼šæ¯”å¦‚å°†UTF-8ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶è½¬æ¢ä¸ºGBKç¼–ç çš„æ–‡æœ¬æ–‡ä»¶åŽŸç†:ä½¿ç”¨UTF-8ç¼–ç å°†æ¯ä¸€ä¸ªå­—ç¬¦è¯»å–å‡ºæ¥ï¼Œå†ä»¥GBKç¼–ç å°†å­—ç¬¦å†™å…¥å¦ä¸€ä¸ªæ–‡ä»¶å³å¯ã€‚123456789101112131415161718public class ChangeCharsetDemo &#123; public static void main(String[] args) throws IOException &#123; FileInputStream fis = new FileInputStream("osw.txt"); InputStreamReader isr = new InputStreamReader(fis,"UTF-8"); FileOutputStream fos= new FileOutputStream("osw_gbk.txt"); OutputStreamWriter osw = new OutputStreamWriter(fos,"GBK"); char[] data = new char[1024*5]; int len = -1; while((len = isr.read(data))!=-1)&#123; osw.write(data,0,len); &#125; System.out.println("è½¬ç å®Œæ¯•!"); osw.close(); isr.close(); &#125;&#125;PrintWriterç¼“å†²å­—ç¬¦è¾“å‡ºæµï¼Œç‰¹ç‚¹æ˜¯å¯ä»¥ä»¥è¡Œä¸ºå•ä½å†™å‡ºå­—ç¬¦ä¸²å¹¶ä¸”è¯¥æµè¿˜å…·å¤‡è‡ªåŠ¨è¡Œåˆ·æ–°åŠŸèƒ½ã€‚ä¼ ç»Ÿçš„ç¼“å†²å­—ç¬¦è¾“å‡ºæµæ˜¯BufferedWriter.ç”±äºŽPrintWriteråœ¨åˆ›å»ºçš„æ—¶å€™å†…éƒ¨ä½¿ç”¨äº†è¯¥æµï¼Œå¹¶ä¸”PrintWriterè¿˜å…·æœ‰è‡ªåŠ¨è¡Œåˆ·æ–°ï¼Œæ‰€ä»¥æ¯”è¾ƒå¸¸ç”¨ã€‚PrintWriteræä¾›äº†è‹¥å¹²æž„é€ æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿å¿«é€Ÿåˆ›å»ºã€‚123456789101112131415public class PWDemo &#123; public static void main(String[] args) throws IOException &#123; /* * PrintWriterå¯ä»¥ç›´æŽ¥åˆ›å»ºåŸºäºŽæ–‡ä»¶çš„å†™æ“ä½œ: * PrintWriter(File file) * PrintWriter(String path) */ // File file=new File("pw.txt"); // PrintWriter pw = new PrintWriter(file,"UTF-8"); PrintWriter pw = new PrintWriter("pw.txt","UTF-8"); pw.println("æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨"); pw.println("å¤©å®‰é—¨ä¸Šå¤ªé˜³å‡"); pw.close(); &#125;&#125;PrintWriterå¤„ç†å…¶ä»–æµçš„å½¢å¼ï¼š1234567891011121314151617public class PWDemo2 &#123; public static void main(String[] args) throws IOException &#123; /* * PrintWriteræä¾›äº†ç”¨äºŽå¤„ç†å…¶ä»–æµçš„æž„é€ æ–¹æ³•ï¼Œ * æ—¢å¯ä»¥å¤„ç†å­—ç¬¦æµï¼Œä¹Ÿå¯ä»¥å¤„ç†å­—èŠ‚æµã€‚ */ FileOutputStream fos = new FileOutputStream("pw2.txt"); /* * è‹¥è¦æŒ‰ç…§æŒ‡å®šå­—ç¬¦é›†å†™å‡ºï¼Œéœ€è¦ä¸­é—´å†åˆ›å»ºä¸€ä¸ª * OSWæ¥è´Ÿè´£è½¬å­—ç¬¦é›†çš„æ“ä½œã€‚ */ OutputStreamWriter osw = new OutputStreamWriter(fos,"UTF-8"); PrintWriter pw = new PrintWriter(osw); pw.println("éšä¾¿å•¦"); pw.close(); &#125;&#125;BufferedReaderjava.io.BufferedReaderï¼šç¼“å†²å­—ç¬¦è¾“å…¥æµ ç‰¹ç‚¹:ä»¥è¡Œä¸ºå•ä½è¯»å–å­—ç¬¦ä¸²ã€‚1234567891011121314151617181920212223public class BRDemo &#123; public static void main(String[] args) throws IOException &#123; FileInputStream fis= new FileInputStream( "src" + File.separator + "IO" + File.separator + "BRDemo.java"); InputStreamReader isr = new InputStreamReader(fis); BufferedReader br = new BufferedReader(isr); /* * String readLine() * BufferedReaderæä¾›çš„è¯¥æ–¹æ³•ä¼šè¯»å–è‹¥å¹²å­—ç¬¦ï¼Œç›´åˆ°è¯»å–åˆ° * æ¢è¡Œç¬¦ä¸ºæ­¢ï¼Œç„¶åŽå°†æ¢è¡Œç¬¦ä¹‹å‰è¯»å–çš„è¿™è‹¥å¹²å­—ç¬¦ç»„æˆä¸€ä¸ª * å­—ç¬¦ä¸²è¿”å›žã€‚éœ€è¦æ³¨æ„ï¼Œè¿”å›žçš„å­—ç¬¦ä¸²ä¸­æ˜¯ä¸åŒ…å«æ¢è¡Œç¬¦çš„ï¼ * è‹¥è¿”å›žå€¼ä¸ºnull,è¯´æ˜Žè¯»å–åˆ°æ–‡ä»¶æœ«å°¾äº†ã€‚ */ String line = null; while((line = br.readLine())!=null)&#123; System.out.println(line); &#125; br.close(); &#125;&#125;]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaæ–‡ä»¶æ“ä½œ]]></title>
    <url>%2FJava%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C.html</url>
    <content type="text"><![CDATA[java.io.Fileï¼šFileçš„æ¯ä¸€ä¸ªå®žä¾‹ç”¨æ¥è¡¨ç¤ºç¡¬ç›˜ä¸Šçš„ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œæˆ‘ä»¬é€šè¿‡Fileå¯ä»¥:1.è®¿é—®ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„å±žæ€§ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œå¤§å°ï¼Œä¿®æ”¹æ—¥æœŸï¼Œè®¿é—®æƒé™ç­‰ã€‚2.å¯ä»¥åˆ›å»ºæ–‡ä»¶ï¼Œåˆ é™¤æ–‡ä»¶ï¼Œåˆ›å»ºç›®å½•ï¼Œåˆ é™¤ç›®å½•ã€‚3.å¯ä»¥è®¿é—®ç›®å½•ä¸­çš„æ‰€æœ‰å­é¡¹ä½†æ˜¯ä¸èƒ½è®¿é—®æ–‡ä»¶æ•°æ®ã€‚åŸºæœ¬æ“ä½œåœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºtest.txtæ–‡ä»¶ï¼Œå†…å®¹ä¸ºhello worldã€‚ä»¥ä¸‹ä¸ºåŸºæœ¬æ“ä½œã€‚123456789101112131415161718192021222324252627282930313233343536public class FileDemo1 &#123; public static void main(String[] args) &#123; /* * åœ¨eclipseä¸­ï¼Œ"."å½“å‰ç›®å½•ï¼ŒæŒ‡çš„æ˜¯é¡¹ç›®çš„æ ¹ç›®å½• * separatorç›¸å½“äºŽâ€/â€ */ File file = new File("."+File.separator+"test.txt"); //èŽ·å–æ–‡ä»¶å String name = file.getName(); /* * èŽ·å–æ–‡ä»¶å¤§å°ã€‚è¿”å›žå€¼ä¸ºä¸€ä¸ªlongå€¼ï¼Œè¡¨ç¤ºå ç”¨çš„å­—èŠ‚é‡ * ä¸­æ–‡ä»¥åŠä¸­æ–‡çŠ¶æ€ä¸‹çš„æ ‡ç‚¹ç¬¦å·éƒ½å ç”¨ä¸¤ä¸ªå­—èŠ‚ * è‹±æ–‡åŠè‹±æ–‡çŠ¶æ€ä¸‹çš„æ ‡ç‚¹ç¬¦å·å ç”¨ä¸€ä¸ªå­—èŠ‚ */ long length = file.length(); // èŽ·å–æ–‡ä»¶æœ€åŽä¿®æ”¹æ—¶é—´ long time = file.lastModified(); // æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦å…·æœ‰å¯è¿è¡Œï¼Œå¯è¯»ï¼Œå¯å†™çš„æƒé™ file.canExecute(); file.canRead(); file.canWrite(); // åˆ¤æ–­å½“å‰Fileå¯¹è±¡è¡¨ç¤ºçš„æ˜¯å¦ä¸ºä¸€ä¸ªæ–‡ä»¶ boolean isFile = file.isFile(); // åˆ¤æ–­å½“å‰Fileå¯¹è±¡è¡¨ç¤ºçš„æ˜¯å¦ä¸ºä¸€ä¸ªç›®å½• boolean isDir = file.isDirectory(); //æ˜¯å¦ä¸ºä¸€ä¸ªéšè—æ–‡ä»¶ boolean isHidden = file.isHidden()); &#125;&#125;åˆ›å»ºæ–‡ä»¶1234567891011public class FileDemo2 &#123; public static void main(String[] args) throws IOException &#123; // åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶demo.txt File file = new File("."+File.separator+"demo.txt"); if(!file.exists())&#123; file.createNewFile(); System.out.println("åˆ›å»ºå®Œæ¯•!"); &#125; &#125;&#125;åˆ é™¤æ–‡ä»¶12345678910public class FileDemo3 &#123; public static void main(String[] args) &#123; File file = new File("."+File.separator+"demo.txt"); if(file.exists())&#123; file.delete(); System.out.println("åˆ é™¤å®Œæ¯•!"); &#125; &#125;&#125; â€‹åˆ›å»ºç›®å½•123456789101112public class FileDemo4 &#123; public static void main(String[] args) &#123; // å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªç›®å½•demo File dir = new File("demo"); if(!dir.exists())&#123; // åˆ›å»ºç›®å½• dir.mkdir(); System.out.println("åˆ›å»ºå®Œæ¯•!"); &#125; &#125;&#125;åˆ›å»ºå¤šçº§ç›®å½•12345678910111213141516171819public class FileDemo5 &#123; public static void main(String[] args) &#123; // åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºç›®å½•a/b/c/d/e/f File dir = new File( "a"+File.separator + "b"+File.separator + "c"+File.separator + "d"+File.separator + "e"+File.separator + "f" ); if(!dir.exists())&#123; // mkdirsæ–¹æ³•åœ¨åˆ›å»ºå½“å‰ç›®å½•çš„åŒæ—¶ä¼šå°†æ‰€æœ‰ä¸å­˜åœ¨çš„çˆ¶ç›®å½• // è‡ªåŠ¨åˆ›å»ºå‡ºæ¥ã€‚ dir.mkdirs(); System.out.println("åˆ›å»ºå®Œæ¯•ï¼"); &#125; &#125;&#125;ç»“æžœï¼šåˆ é™¤ç›®å½•åªèƒ½åˆ é™¤ç©ºç›®å½•ã€‚12345678910public class FileDemo6 &#123; public static void main(String[] args) &#123; File dir = new File("demo"); if(dir.exists())&#123; // åˆ é™¤ç›®å½•ï¼Œåªèƒ½åˆ é™¤ç©ºç›®å½•ï¼Œå³: ç›®å½•ä¸­ä¸èƒ½å«æœ‰ä»»ä½•å­é¡¹ã€‚ dir.delete(); System.out.println("åˆ é™¤å®Œæ¯•!"); &#125; &#125;&#125;listFilesèŽ·å–ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰å­é¡¹ã€‚123456789public class FileDemo7 &#123; public static void main(String[] args) &#123; File dir = new File("."); File[] subs = dir.listFiles(); for(File sub : subs)&#123; System.out.println((sub.isFile()?"æ–‡ä»¶:":"ç›®å½•:")+sub.getName()); &#125; &#125;&#125;Filefilteræ–‡ä»¶è¿‡æ»¤å™¨Filefilterï¼šèŽ·å–ä¸€ä¸ªç›®å½•ä¸‹ç¬¦åˆæ¡ä»¶çš„å­é¡¹ï¼Œéœ€è¦ä½¿ç”¨æ–‡ä»¶è¿‡æ»¤å™¨æ¥å®šä¹‰è¿‡æ»¤æ¡ä»¶ã€‚é€šå¸¸ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»æ¥å®žçŽ°ã€‚1234567891011121314151617181920212223242526public class FileDemo8 &#123; public static void main(String[] args) &#123; /* * èŽ·å–å½“å‰ç›®å½•ä¸‹æ‰€æœ‰åå­—æ˜¯ä»¥"."å¼€å¤´çš„å­é¡¹ * ä½¿ç”¨åŒ¿åå†…éƒ¨ç±» */ FileFilter filter = new FileFilter()&#123; public boolean accept(File file) &#123; String name = file.getName(); System.out.println("æ­£åœ¨è¿‡æ»¤:"+name); return name.startsWith("."); &#125; &#125;; File dir = new File("."); /* * è¯¥é‡è½½çš„listFilesæ–¹æ³•ä¼šå°†å½“å‰ç›®å½•ä¸­çš„æ¯ * ä¸€ä¸ªå­é¡¹éƒ½äº¤ç»™è¿‡æ»¤å™¨ï¼Œç„¶åŽåªä¿ç•™æ»¡è¶³è¿‡æ»¤å™¨ * è¦æ±‚(ä¸ºtrue)çš„å­é¡¹ */ File[] subs = dir.listFiles(filter); for(File sub : subs)&#123; System.out.println(sub.getName()); &#125; &#125;&#125;è¾“å‡ºï¼š1234567891011æ­£åœ¨è¿‡æ»¤:.classpathæ­£åœ¨è¿‡æ»¤:.projectæ­£åœ¨è¿‡æ»¤:.settingsæ­£åœ¨è¿‡æ»¤:aæ­£åœ¨è¿‡æ»¤:buildæ­£åœ¨è¿‡æ»¤:srcæ­£åœ¨è¿‡æ»¤:test.txtæ­£åœ¨è¿‡æ»¤:WebContent.classpath.project.settingsåˆ é™¤å«æœ‰å­é¡¹ç›®å½•ä½¿ç”¨â€œé€’å½’â€çš„æ–¹å¼åˆ é™¤å«æœ‰å­é¡¹çš„ç›®å½•ï¼ˆåˆ é™¤ä¸Šé¢åˆ›å»ºçš„aç›®å½•ï¼‰ã€‚123456789101112131415161718192021public class FileDemo9 &#123; public static void main(String[] args) &#123; File dir = new File("a"); deleteFile(dir); &#125; /** * å°†ç»™å®šçš„Fileè¡¨ç¤ºçš„æ–‡ä»¶æˆ–ç›®å½•åˆ é™¤ * @param file */ public static void deleteFile(File file)&#123; if(file.isDirectory())&#123; //å…ˆå°†å…¶æ‰€æœ‰å­é¡¹åˆ é™¤ File[] subs = file.listFiles(); for(File sub:subs)&#123; //é€’å½’ deleteFile(sub); &#125; &#125; file.delete(); &#125;&#125;è¯»å†™æ–‡ä»¶æ•°æ®å†™å…¥ï¼š123456789101112131415161718public class RandomAccessFileDemo1 &#123; public static void main(String[] args) throws IOException &#123; /* * RandomAccessFileåˆ›å»ºæ”¯æŒå¾ˆå¤šæ¨¡å¼ * å¸¸ç”¨çš„æœ‰: * "r":åªè¯» * "rw":è¯»å†™ */ RandomAccessFile raf= new RandomAccessFile("demo.dat","rw"); /* * void write(int d) * å‘æ–‡ä»¶ä¸­å†™å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œå†™çš„æ˜¯è¯¥intå€¼å¯¹åº”çš„2è¿›åˆ¶å†…å®¹ä¸­çš„"ä½Žå…«ä½", * èŒƒå›´255 */ raf.write(27); raf.close(); &#125;&#125;è¯»å–ï¼š12345678910111213public class RandomAccessFileDemo2 &#123; public static void main(String[] args) throws IOException &#123; RandomAccessFile raf = new RandomAccessFile("demo.dat","r"); /* * int read() * è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œå¹¶ä»¥int(ä½Žå…«ä½)å½¢å¼è¿”å›ž * è‹¥è¯»å–åˆ°æ–‡ä»¶æœ«å°¾åˆ™è¿”å›žå€¼ä¸º-1 */ int d = raf.read(); System.out.println(d); // 27 raf.close(); &#125;&#125;æ‰¹é‡è¯»å†™void write(byte[] data)ï¼šæ‰¹é‡å†™å‡ºå­—èŠ‚ã€‚ä¸€æ¬¡æ€§å°†ç»™å®šçš„å­—èŠ‚æ•°ç»„ä¸­çš„æ‰€æœ‰å­—èŠ‚å†™å‡ºã€‚12345678910111213141516171819202122public class RandomAccessFileDemo3 &#123; public static void main(String[] args) throws IOException &#123; RandomAccessFile raf = new RandomAccessFile("demo.dat","rw"); String str = "æ‘©æ“¦æ‘©æ“¦ï¼Œæ˜¯é­”é¬¼çš„æ­¥ä¼"; /* * byte[] getBytes() * Stringæä¾›çš„è¯¥æ–¹æ³•å¯ä»¥å°†å½“å‰å­—ç¬¦ä¸² * æŒ‰ç…§ç³»ç»Ÿé»˜è®¤çš„å­—ç¬¦é›†è½¬æ¢ä¸ºå¯¹åº”çš„ä¸€ç»„å­—èŠ‚ * * byte[] getBytes(String charset) * æŒ‰ç…§ç»™å®šçš„å­—ç¬¦é›†å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸€ç»„å­—èŠ‚ * å­—ç¬¦é›†åç§°: * GBK:å›½æ ‡ç¼–ç  ä¸­æ–‡2å­—èŠ‚ * UTF-8:å˜é•¿ç¼–ç é›†ï¼Œ1-4ä¸ªå­—èŠ‚ï¼Œä¸­æ–‡3å­—èŠ‚ * ISO8859-1:æ¬§æ´²ç¼–ç ï¼Œä¸æ”¯æŒä¸­æ–‡ */ byte[] data = str.getBytes("GBK"); raf.write(data); System.out.println("å†™å‡ºå®Œæ¯•"); raf.close(); &#125;&#125;int read(byte[] data)ï¼šä¸€æ¬¡æ€§å°è¯•è¯»å–ç»™å®šå­—èŠ‚æ•°ç»„é•¿åº¦çš„å­—èŠ‚é‡ï¼Œå¹¶å­˜å…¥è¯¥æ•°ç»„ä¸­ï¼Œè¿”å›žå€¼ä¸ºå®žé™…è¯»å–åˆ°çš„å­—èŠ‚é‡ï¼Œè‹¥è¿”å›žå€¼ä¸º-1,åˆ™è¡¨ç¤ºè¿™æ¬¡æ²¡æœ‰è¯»åˆ°ä»»ä½•æ•°æ®(æ–‡ä»¶æœ«å°¾äº†)ã€‚12345678910111213141516public class RandomAccessFileDemo4 &#123; public static void main(String[] args) throws IOException &#123; RandomAccessFile raf = new RandomAccessFile("demo.dat","r"); byte[] data = new byte[100]; int len = raf.read(data);//æ¯æ¬¡readçš„é•¿åº¦ï¼Œä¸å†™é»˜è®¤ä¸º1 System.out.println("è¯»åˆ°äº†"+len+"ä¸ªå­—èŠ‚");//è¯»åˆ°äº†22ä¸ªå­—èŠ‚ /* * è¯¥æž„é€ æ–¹æ³•å…è®¸æˆ‘ä»¬å°†ç»™å®šçš„å­—èŠ‚æ•°ç»„ * ä¸­æŒ‡å®šèŒƒå›´å†…çš„å­—èŠ‚è½¬æ¢ä¸ºå¯¹åº”çš„å­—ç¬¦ä¸² */ String str = new String(data,0,len,"GBK"); System.out.println(str);//æ‘©æ“¦æ‘©æ“¦ï¼Œæ˜¯é­”é¬¼çš„æ­¥ä¼ raf.close(); &#125;&#125;å¤åˆ¶æ–‡ä»¶å®žé™…ä¸Šå°±æ˜¯ä¸€è¯»ä¸€å†™ã€‚12345678910111213141516171819public class CopyDemo &#123; public static void main(String[] args) throws IOException &#123; RandomAccessFile src = new RandomAccessFile("1.mp4","r"); RandomAccessFile desc = new RandomAccessFile("1_copy.mp4","rw" ); byte[] buf = new byte[1024*10]; int len = -1; while((len=src.read(buf))!=-1)&#123; /* * void write(byte[] data,int offset,int len) * å°†å½“å‰æ•°ç»„ä¸­ä»ŽoffsetæŒ‡å®šä½ç½®å¼€å§‹ï¼Œè¿žç»­len * ä¸ªå­—èŠ‚å†™å‡º */ desc.write(buf,0,len); &#125; src.close(); desc.close(); &#125;&#125;]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®šåˆ¶JSPæ ‡ç­¾]]></title>
    <url>%2F%E5%AE%9A%E5%88%B6JSP%E6%A0%87%E7%AD%BE.html</url>
    <content type="text"><![CDATA[å½“JSTLè‡ªå¸¦æ ‡ç­¾æ— æ³•æ»¡è¶³æˆ‘ä»¬çš„å¼€å‘éœ€æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ ‡ç­¾ã€‚å®šåˆ¶æ ‡ç­¾å¯ä»¥é€šè¿‡å®žçŽ°SimpleTagæŽ¥å£æˆ–è€…ç»§æ‰¿SimpleTagSupportç±»ï¼ˆSimpleTagSupportæä¾›äº†SimpleTagæŽ¥å£é»˜è®¤å®žçŽ°ï¼‰ã€‚æ ‡ç­¾çš„å…·ä½“å®žçŽ°åŠŸèƒ½é€»è¾‘å†™åœ¨doTag()æ–¹æ³•ä¸­ï¼Œå®šåˆ¶JSPæ ‡ç­¾çš„å¤§è‡´æ­¥éª¤åˆ†ä¸ºä¸¤æ­¥ï¼š1.ç¼–å†™æ ‡ç­¾å¤„ç†å™¨2.æ³¨å†Œæ ‡ç­¾SimpleTagæ ‡ç­¾å¤„ç†å™¨ç¼–å†™ä¸€ä¸ªJavaç±»ï¼Œå®žçŽ°SimpleTagæŽ¥å£ï¼š12345678910111213141516171819202122232425262728public class MyFirstTag implements SimpleTag&#123; JspContext jspContext; @Override public void doTag() throws JspException, IOException &#123; System.out.println("doTag"); jspContext.getOut().print("This is my first tag."); &#125; @Override public JspTag getParent() &#123; return null; &#125; @Override public void setJspBody(JspFragment body) &#123; System.out.println(body); &#125; @Override public void setJspContext(JspContext jspContext) &#123; this.jspContext=jspContext; &#125; @Override public void setParent(JspTag parent) &#123; &#125;&#125;doTagæ–¹æ³•ä¸­ç¼–å†™äº†å®šåˆ¶æ ‡ç­¾è¦å®žçŽ°çš„åŠŸèƒ½ã€‚getParentï¼ŒsetParentæ–¹æ³•åªæœ‰æ ‡ç­¾åµŒå¥—åœ¨å¦ä¸€ä¸ªæ ‡ç­¾çš„æ—¶å€™æ‰è¢«è°ƒç”¨ã€‚setJspContextæ–¹æ³•ä¼ é€’äº†ä¸€ä¸ªJspContextå¯¹è±¡ï¼ŒJspContextå¯¹è±¡çš„getOutæ–¹æ³•è¿”å›žä¸€ä¸ªJspWriterã€‚æ³¨å†Œæ ‡ç­¾åœ¨WEB-INFæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªtldsæ–‡ä»¶å¤¹ï¼Œç„¶åŽåœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªmytags.tldæ–‡ä»¶ï¼š123456789101112131415&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;taglib xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee web-jsptaglibrary_2_1.xsd" version="2.1"&gt; &lt;description&gt;Simple tag examples&lt;/description&gt; &lt;tlib-version&gt;1.0&lt;/tlib-version&gt; &lt;short-name&gt;My First Taglib Example&lt;/short-name&gt; &lt;tag&gt; &lt;name&gt;firstTag&lt;/name&gt; &lt;tag-class&gt;MyTags.MyFirstTag&lt;/tag-class&gt; &lt;body-content&gt;empty&lt;/body-content&gt; &lt;/tag&gt;&lt;/taglib&gt;æœ€ä¸»è¦çš„ä¸ºtagæ ‡ç­¾ï¼Œnameæ ‡ç­¾åï¼Œtag-classä¸ºæ ‡ç­¾javaç±»è·¯å¾„ã€‚åœ¨jspé¡µé¢ä¸­ä½¿ç”¨è¯¥æ ‡ç­¾ï¼š123456789&lt;%@ taglib uri="/WEB-INF/tlds/mytags.tld" prefix="mt"%&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Testing my first tag&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;mt:firstTag/&gt;&lt;/body&gt;&lt;/html&gt;å¯åŠ¨tomcatè®¿é—®è¯¥jspï¼Œé¡µé¢æ˜¾ç¤ºThis is my first tag. æŽ§åˆ¶å°è¾“å‡ºdoTagã€‚SimpleTagSupportå¦ä¸€ç§æ–¹æ³•ä¸ºç»§æ‰¿SimpleTagSupportç±»ï¼Œé‡å†™doTagæ–¹æ³•ï¼Œè¿™é‡Œæ¨¡æ‹Ÿä¸€ä¸ªæ—¶é—´æ ¼å¼åŒ–æ ‡ç­¾ï¼š12345678910111213public class DateFormatTag extends SimpleTagSupport&#123; private String fmt; public void setFmt(String fmt) &#123; this.fmt = fmt; &#125; public void doTag() throws IOException, JspException &#123; JspContext jspContext = getJspContext(); JspWriter out = jspContext.getOut(); SimpleDateFormat sdf = new SimpleDateFormat(fmt); out.print(sdf.format(new Date())); &#125;&#125;fmtä¸ºæ ‡ç­¾çš„å±žæ€§ï¼Œè¿™é‡Œä¸ºæ—¶é—´æ ¼å¼åŒ–çš„æ ¼å¼ã€‚é€šè¿‡é™æ€æ–¹æ³•getJspContextå¯ä»¥èŽ·å–JspContextå¯¹è±¡ã€‚ç¼–å†™å¥½ä¾¿ç­¾å¤„ç†å™¨åŽï¼Œæ³¨å†Œå®ƒï¼š123456789&lt;tag&gt; &lt;name&gt;DateFormat&lt;/name&gt; &lt;tag-class&gt;MyTags.DateFormatTag&lt;/tag-class&gt; &lt;body-content&gt;empty&lt;/body-content&gt; &lt;attribute&gt; &lt;name&gt;fmt&lt;/name&gt; &lt;required&gt;true&lt;/required&gt; &lt;/attribute&gt;&lt;/tag&gt;â€‹attributeæ ‡ç­¾å®šä¹‰äº†æ ‡ç­¾çš„å±žæ€§ã€‚åœ¨jspé¡µé¢ä¸­è¿›è¡Œæµ‹è¯•ï¼š1234567891011121314&lt;%@ taglib uri="/WEB-INF/tlds/mytags.tld" prefix="mt"%&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;test dateformat&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;mt:DateFormat fmt="yyyy-MM-dd HH:mm:ss"/&gt;&lt;br/&gt; &lt;mt:DateFormat&gt; &lt;jsp:attribute name="fmt"&gt; yyyy-MM-dd &lt;/jsp:attribute&gt; &lt;/mt:DateFormat&gt;&lt;/body&gt;&lt;/html&gt;ä¸¤ç§æ–¹å¼ç»™fmtå±žæ€§èµ‹å€¼ï¼Œå¯åŠ¨tomcatè®¿é—®è¯¥jspé¡µé¢ï¼Œé¡µé¢æ˜¾ç¤ºï¼šJspFragmentJspFragmentå°±æ˜¯ä¸€æ®µä¸åŒ…å«scripletçš„jspä»£ç æ®µï¼ŒJspFragmentç±»æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼šgetJspContextå’Œinvokeã€‚getJspContextæ–¹æ³•è¿”å›žä¸Žè¿™ä¸ªJspFragmentç›¸å…³çš„JspContextï¼Œinvokeæ–¹æ³•ç”¨æ¥æ‰§è¡Œç‰‡æ®µï¼Œå¦‚æžœç‰‡æ®µä¸å«æ ‡ç­¾æ— éœ€æ‰§è¡Œçš„è¯ï¼Œåˆ™ä¼ é€’nullã€‚çŽ°å®šåˆ¶ä¸€ä¸ªselectæ ‡ç­¾ï¼Œä»»åŠ¡æ˜¯æ ¹æ®ä¼ å…¥çš„ä»¥é€—å·åˆ†éš”çš„å­—ç¬¦ä¸²è½¬ä¸ºå¯¹åº”çš„ä¸‹æ‹‰é€‰æ¡†ã€‚selectæ ‡ç­¾é‡Œçš„JspFragmentå†…å®¹ä¸ºï¼š1&lt;option value="$&#123;value&#125;"&gt;$&#123;text&#125;&lt;/option&gt;ç¼–å†™æ ‡ç­¾å¤„ç†å™¨ï¼š12345678910111213141516171819public class SelectTag extends SimpleTagSupport&#123; private String values; public void setValues(String values) &#123; this.values = values; &#125; public void doTag() throws IOException, JspException &#123; JspContext jspContext = getJspContext(); JspWriter out = jspContext.getOut(); String[] arr= values.split(","); out.print("&lt;select&gt;\n"); for(int i=0;i&lt;arr.length;i++)&#123; jspContext.setAttribute("value", i+1); jspContext.setAttribute("text", arr[i]); getJspBody().invoke(null); &#125; out.print("&lt;/select&gt;\n"); &#125;&#125;æ³¨å†Œè¯¥æ ‡ç­¾ï¼š123456789&lt;tag&gt; &lt;name&gt;select&lt;/name&gt; &lt;tag-class&gt;MyTags.SelectTag&lt;/tag-class&gt; &lt;body-content&gt;scriptless&lt;/body-content&gt; &lt;attribute&gt; &lt;name&gt;values&lt;/name&gt; &lt;required&gt;true&lt;/required&gt; &lt;/attribute&gt;&lt;/tag&gt;å› ä¸ºæ ‡ç­¾åŒ…å«JspFragmentï¼Œæ‰€ä»¥body-contentæ ‡ç­¾é…ç½®ä¸ºscriptlessã€‚åœ¨jspé¡µé¢ä¸­æµ‹è¯•è¯¥æ ‡ç­¾ï¼š1234567891011&lt;%@ taglib uri="/WEB-INF/tlds/mytags.tld" prefix="mt"%&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;test selecttag&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;mt:select values="fuzhou,xiamen,longyan"&gt; &lt;option value="$&#123;value&#125;"&gt;$&#123;text&#125;&lt;/option&gt; &lt;/mt:select&gt;&lt;/body&gt;&lt;/html&gt;å¯åŠ¨tomcatï¼Œè®¿é—®è¯¥jspé¡µé¢ï¼Œé¡µé¢æ˜¾ç¤ºï¼šæŸ¥çœ‹æºç ï¼š12345&lt;select&gt; &lt;option value="1"&gt;fuzhou&lt;/option&gt; &lt;option value="2"&gt;xiamen&lt;/option&gt; &lt;option value="3"&gt;longyan&lt;/option&gt;&lt;/select&gt;å‡½æ•°å‡å¦‚JSTLä¸­çš„å‡½æ•°æ ‡ç­¾ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„å®žé™…éœ€æ±‚ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±ç¼–å†™ã€‚æ–°å»ºFunctionåŒ…ï¼Œåœ¨åŒ…ä¸‹åˆ›å»ºStringFunctionç±»ï¼š12345public class StringFunction &#123; public static String reverseString(String value)&#123; return new StringBuffer(value).reverse().toString(); &#125;&#125;æ³¨å†Œè¯¥æ ‡ç­¾ï¼šåœ¨WEB-INFä¸‹çš„tldsä¸‹æ–°å»ºfunction.tldï¼š123456789101112131415161718&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;taglib xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee web-jsptaglibrary_2_1.xsd" version="2.1"&gt; &lt;description&gt;Function tag examples&lt;/description&gt; &lt;tlib-version&gt;1.0&lt;/tlib-version&gt; &lt;function&gt; &lt;description&gt;Reverses a String&lt;/description&gt; &lt;name&gt;reverseString&lt;/name&gt; &lt;function-class&gt;Functions.StringFunction&lt;/function-class&gt; &lt;function-signature&gt; java.lang.String reverseString(java.lang.String) &lt;/function-signature&gt; &lt;/function&gt; &lt;/taglib&gt;nameè¡¨ç¤ºå‡½æ•°åã€‚function-classä¸ºå®žçŽ°è¯¥å‡½æ•°çš„Javaç±»çš„å…¨ç±»åã€‚function-signatureè¡¨ç¤ºè¯¥å‡½æ•°çš„é™æ€Javaæ–¹æ³•ç­¾åã€‚åœ¨jspä¸­æµ‹è¯•è¯¥ELå‡½æ•°ï¼š123456789&lt;%@ taglib uri="/WEB-INF/tlds/function.tld" prefix="fn"%&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Testing reverseString function&lt;/title&gt;&lt;/head&gt;&lt;body&gt; $&#123;fn:reverseString("Hello World")&#125;&lt;/body&gt;&lt;/html&gt;å¯åŠ¨tomcatï¼Œè®¿é—®è¯¥jspï¼Œé¡µé¢æ˜¾ç¤ºï¼šã€ŠServletå’ŒJSPå­¦ä¹ æŒ‡å—ã€‹å­¦ä¹ ç¬”è®°]]></content>
      <tags>
        <tag>servlet&amp;jsp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSP Standard Tag Library]]></title>
    <url>%2FJSP-Standard-Tag-Library.html</url>
    <content type="text"><![CDATA[JSTLï¼ˆJSP Standard Tag Libraryï¼‰ä¸‹è½½åœ°å€ï¼šhttps://jstl.java.net/ã€‚JSTLåŒ…å«ï¼š1.JSTL API2.JSTL ImplementationJSPé¡µé¢ä¸­ä½¿ç”¨JSTLï¼Œä½¿ç”¨taglibæŒ‡ä»¤å¼•å…¥ï¼š1&lt;%@ taglib rui="uri" prefix="prefix"%&gt;é€šç”¨åŠ¨ä½œæŒ‡ä»¤å¼•å…¥ï¼š1&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;outæ ‡ç­¾æ ‡è®°&lt;c:out&gt;å…·æœ‰ä»¥ä¸‹å±žæ€§ï¼šå±žæ€§æè¿°value*+ &nbsp;è¦è¿ç®—çš„è¡¨è¾¾å¼defaulté»˜è®¤å€¼escapeXmlTrueï¼Œå¦‚æžœæ ‡ç­¾è½¬ä¹‰ç‰¹æ®ŠXMLå­—ç¬¦*è¡¨ç¤ºå±žæ€§æ˜¯å¿…éœ€çš„ï¼Œ+å·è¡¨ç¤ºå¯ä»¥ä¸ºè¡¨è¾¾å¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒexcapeXmlå±žæ€§ä¸ºtrueï¼Œæ„å‘³ç€ä¼šå°†&lt;ï¼Œ&gt;ï¼Œâ€™ï¼Œâ€å’Œ&amp;è½¬æ¢ä¸º&lt;ï¼Œ&gt;ï¼Œ&#039;å’Œ&amp;ã€‚setæ ‡ç­¾&lt;c:set&gt;æ ‡è®°å…·æœ‰ä»¥ä¸‹å±žæ€§ï¼šå±žæ€§æè¿°value+è¦åˆ›å»ºçš„å­—ç¬¦ä¸²ï¼Œæˆ–è¦å¼•ç”¨çš„é™åŸŸå¯¹è±¡ï¼Œæˆ–æ–°çš„å±žæ€§å€¼target+å…¶å±žæ€§åº”è¯¥è¢«ä¿®æ”¹çš„é™åŸŸå¯¹è±¡ç›®æ ‡property+è¦ä¿®æ”¹çš„å±žæ€§åç§°varé™åŸŸå˜é‡scopeèŒƒå›´ï¼Œé»˜è®¤ä¸ºpageå¦‚ï¼Œåˆ›å»ºä¸€ä¸ªpageèŒƒå›´çš„fooå˜é‡ï¼Œå¹¶èµ‹å€¼ï¼š1&lt;c:set var="foo" value="The wisest fool"/&gt;åˆ›å»ºä¸€ä¸ªé™åŸŸå˜é‡jobï¼Œå€¼ä¸ºrequestèŒƒå›´çš„å¯¹è±¡positionï¼Œé™åŸŸå˜é‡çš„èŒƒå›´ä¸ºpageï¼š1&lt;c:set var="job" value="$&#123;requestScope.position&#125;" socpe="page"/&gt;è®¾ç½®addresså¯¹è±¡çš„cityå±žæ€§ä¸ºfuzhouï¼š1&lt;c:set target="$&#123;address&#125;" property="city" value="fuzhzou"/&gt;ä¹Ÿå¯ä»¥è¿™æ ·å†™ï¼š123&lt;c:set target="$&#123;address&#125;" property="city"&gt; fuzhou&lt;/c:set&gt;removeæ ‡ç­¾&lt;c:remove&gt;æ ‡ç­¾å…·æœ‰ä»¥ä¸‹å±žæ€§ï¼šå±žæ€§æè¿°é»˜è®¤å€¼varè¦åˆ é™¤çš„å˜é‡åNonescopeåˆ é™¤å˜é‡çš„ä½œç”¨åŸŸæ‰€æœ‰ä½œç”¨åŸŸå¦‚åˆ é™¤ä½œç”¨åŸŸä¸ºpageçš„jobé™åŸŸå˜é‡ï¼š1&lt;c:remove var="job" scope="page"/&gt;æ¡ä»¶å¼åŠ¨ä½œæŒ‡ä»¤å¼•å…¥ï¼š1&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;ifæ ‡ç­¾&lt;c:if&gt;æ ‡ç­¾å…·æœ‰ä»¥ä¸‹å±žæ€§ï¼šå±žæ€§æè¿°é»˜è®¤test*+æ¡ä»¶è®¡ç®—Nonevarå˜é‡åç§°æ¥å­˜å‚¨æ¡ä»¶çš„ç»“æžœï¼ŒBooleanç±»åž‹Nonescopevarå˜é‡çš„ä½œç”¨åŸŸpageå¦‚ï¼š1234&lt;c:set var="salary" scope="session" value="$&#123;2000*2&#125;"/&gt;&lt;c:if test="$&#123;salary &gt; 2000&#125;"&gt; My salary is: &lt;c:out value="$&#123;salary&#125;"/&gt;&lt;/c:if&gt;æ¨¡æ‹Ÿifâ€¦elseï¼š123456&lt;c:if test="$&#123;param.user=='mrbird' &amp;&amp; password=='mrbird'&#125;"&gt; mrbird logged in successfully.&lt;/c:if&gt;&lt;c:if test="$&#123;!(param.user=='mrbird' &amp;&amp; password=='mrbird')&#125;"&gt; userName or password is wrong&lt;/c:if&gt;choose,whenå’Œotherwiseè¯¥æ ‡ç­¾ç±»ä¼¼äºŽJavaä¸­çš„switchå’Œcaseå…³é”®å­—ç±»ä¼¼ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š1234567891011&lt;c:choose&gt; &lt;c:when test="$&#123;param.user=="mrbird"&#125;"&gt; hi,mrbird. &lt;/c:when&gt; &lt;c:when test="$&#123;param.user=="jint"&#125;"&gt; hi,jint. &lt;/c:when&gt; &lt;c:otherwise&gt; hi,someone else. &lt;/c:otherwise&gt;&lt;/c:choose&gt;iteratoråŠ¨ä½œæŒ‡ä»¤forEachæ ‡ç­¾&lt;c:forEach&gt;æ ‡è®°å…·æœ‰ä»¥ä¸‹å±žæ€§ï¼šå±žæ€§æè¿°é»˜è®¤items+è¦è¿­ä»£çš„å¯¹è±¡é›†åˆNonebegin+å¼€å§‹ç´¢å¼•0end+ç»“æŸç´¢å¼•Last elementstep+è¿­ä»£æ­¥é•¿1varå½“å‰è¿­ä»£å†…å®¹çš„é™åŸŸå˜é‡åNonevarStatusä¿å­˜è¿­ä»£çŠ¶æ€çš„é™åŸŸå˜é‡åNoneå…¶ä¸­ï¼ŒvarStatusåŒ…å«ä¸€äº›å±žæ€§ï¼š1.currentå½“å‰è¿™æ¬¡è¿­ä»£çš„ï¼ˆé›†åˆä¸­çš„ï¼‰é¡¹2.indexå½“å‰è¿™æ¬¡è¿­ä»£ä»Ž 0 å¼€å§‹çš„è¿­ä»£ç´¢å¼•3.countå½“å‰è¿™æ¬¡è¿­ä»£ä»Ž 1 å¼€å§‹çš„è¿­ä»£è®¡æ•°4.firstç”¨æ¥è¡¨æ˜Žå½“å‰è¿™è½®è¿­ä»£æ˜¯å¦ä¸ºç¬¬ä¸€æ¬¡è¿­ä»£çš„æ ‡å¿—5.lastç”¨æ¥è¡¨æ˜Žå½“å‰è¿™è½®è¿­ä»£æ˜¯å¦ä¸ºæœ€åŽä¸€æ¬¡è¿­ä»£çš„æ ‡å¿—å¦‚å¾ªçŽ¯è¾“å‡ºbooksé›†åˆï¼Œå¹¶æŽ§åˆ¶å•åŒè¡Œè¡¨æ ¼æ ·å¼ï¼š1234567891011121314151617&lt;table&gt; &lt;tr style="background:#ababff"&gt; &lt;td&gt;ISBN&lt;/td&gt; &lt;td&gt;Title&lt;/td&gt; &lt;/tr&gt; &lt;c:forEach item="$&#123;requestScope.books&#125;" var="book" vatStatus="status"&gt; &lt;c:if test="$&#123;status.count%2 == 0&#125;"&gt; &lt;tr style="background:#eeeeff"&gt; &lt;/c:if&gt; &lt;c:if test="$&#123;status.count%2 != 0&#125;"&gt; &lt;tr style="background:#dedeff"&gt; &lt;/c:if&gt; &lt;td&gt;$&#123;book.isbn&#125;&lt;/td&gt; &lt;td&gt;$&#123;book.title&#125;&lt;/td&gt; &lt;/tr&gt; &lt;/c:forEach&gt;&lt;/table&gt;ç®€å•çš„forEachæ ‡ç­¾ç¤ºä¾‹ï¼š123&lt;c:forEach var="x" begin="1" end="5"&gt; &lt;c:out value="$&#123;x&#125;"/&gt;,&lt;/c:forEach&gt;é¡µé¢è¾“å‡º1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ã€‚forTokensæ ‡ç­¾forTokensæ ‡ç­¾ä½¿ç”¨çš„æ¯”è¾ƒå°‘ï¼Œå¸¸ç”¨çš„ä¾‹å­ï¼š123&lt;c:forTokens items="Zara,nuha,roshy" delims="," var="name"&gt; &lt;c:out value="$&#123;name&#125;"/&gt;&lt;/c:forTokens&gt;è¿™å°†äº§ç”Ÿä»¥ä¸‹è¾“å‡ºç»“æžœï¼š123Zaranuharoshyæ ¼å¼åŒ–åŠ¨ä½œæŒ‡ä»¤å¼•å…¥ï¼š1&lt;%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %&gt;formatNumberæ ‡ç­¾&lt;fmt:formatNumber&gt;æ ‡ç­¾ç”¨äºŽæ ¼å¼åŒ–æ•°å­—ï¼Œç™¾åˆ†æ¯”å’Œè´§å¸ã€‚&lt;fmt:formatNumber&gt;æ ‡ç­¾æœ‰å¦‚ä¸‹å±žæ€§ï¼šå±žæ€§æè¿°é»˜è®¤å€¼value*+è¦æ˜¾ç¤ºçš„æ•°å­—æ— type+NUMBERï¼ŒCURRENCYï¼Œæˆ– PERCENTç±»åž‹Numberpattern+æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰çš„æ ¼å¼åŒ–æ¨¡å¼ç”¨äºŽè¾“å‡ºæ— currencyCode+è´§å¸ç ï¼ˆå½“type=â€currencyâ€æ—¶ï¼‰å–å†³äºŽé»˜è®¤åŒºåŸŸcurrencySymbol+è´§å¸ç¬¦å· (å½“ type=â€currencyâ€æ—¶)å–å†³äºŽé»˜è®¤åŒºåŸŸgroupingUsed+æ˜¯å¦å¯¹æ•°å­—åˆ†ç»„ (TRUE æˆ– FALSE)truemaxIntegerDigits+æ•´åž‹æ•°æœ€å¤§çš„ä½æ•°æ— minIntegerDigits+æ•´åž‹æ•°æœ€å°çš„ä½æ•°æ— maxFractionDigits+å°æ•°ç‚¹åŽæœ€å¤§çš„ä½æ•°æ— minFractionDigits+å°æ•°ç‚¹åŽæœ€å°çš„ä½æ•°æ— varå­˜å‚¨æ ¼å¼åŒ–æ•°å­—çš„å˜é‡Print to pagescopevarå±žæ€§çš„ä½œç”¨åŸŸpagepatternå±žæ€§åŒ…å«çš„å­—ç¬¦ï¼šç¬¦å·æè¿°0ä»£è¡¨ä¸€ä½æ•°å­—Eä½¿ç”¨æŒ‡æ•°æ ¼å¼#ä»£è¡¨ä¸€ä½æ•°å­—ï¼Œè‹¥æ²¡æœ‰åˆ™æ˜¾ç¤º0.å°æ•°ç‚¹,æ•°å­—åˆ†ç»„åˆ†éš”ç¬¦;åˆ†éš”æ ¼å¼-ä½¿ç”¨é»˜è®¤è´Ÿæ•°å‰ç¼€%ç™¾åˆ†æ•°?åƒåˆ†æ•°Â¤è´§å¸ç¬¦å·ï¼Œä½¿ç”¨å®žé™…çš„è´§å¸ç¬¦å·ä»£æ›¿XæŒ‡å®šå¯ä»¥ä½œä¸ºå‰ç¼€æˆ–åŽç¼€çš„å­—ç¬¦â€˜åœ¨å‰ç¼€æˆ–åŽç¼€ä¸­å¼•ç”¨ç‰¹æ®Šå­—ç¬¦ä¾‹å­ï¼š1234567891011121314151617181920&lt;c:set var="balance" value="120000.2309" /&gt;æ ¼å¼åŒ–æ•°å­— (1): &lt;fmt:formatNumber value="$&#123;balance&#125;" type="currency"/&gt;æ ¼å¼åŒ–æ•°å­— (2): &lt;fmt:formatNumber type="number" maxIntegerDigits="3" value="$&#123;balance&#125;" /&gt;æ ¼å¼åŒ–æ•°å­— (3): &lt;fmt:formatNumber type="number" maxFractionDigits="3" value="$&#123;balance&#125;" /&gt;æ ¼å¼åŒ–æ•°å­— (4): &lt;fmt:formatNumber type="number" groupingUsed="false" value="$&#123;balance&#125;" /&gt;æ ¼å¼åŒ–æ•°å­— (5): &lt;fmt:formatNumber type="percent" maxIntegerDigits="3" value="$&#123;balance&#125;" /&gt;æ ¼å¼åŒ–æ•°å­— (6): &lt;fmt:formatNumber type="percent" minFractionDigits="10" value="$&#123;balance&#125;" /&gt;æ ¼å¼åŒ–æ•°å­— (7): &lt;fmt:formatNumber type="percent" maxIntegerDigits="3" value="$&#123;balance&#125;" /&gt;æ ¼å¼åŒ–æ•°å­— (8): &lt;fmt:formatNumber type="number" pattern="###.###E0" value="$&#123;balance&#125;" /&gt;ç¾Žå…ƒ : &lt;fmt:setLocale value="en_US"/&gt; &lt;fmt:formatNumber value="$&#123;balance&#125;" type="currency"/&gt;ç»“æžœï¼š12345678910æ•°å­—æ ¼å¼åŒ–:æ ¼å¼åŒ–æ•°å­— (1): ï¿¥120,000.23æ ¼å¼åŒ–æ•°å­— (2): 000.231æ ¼å¼åŒ–æ•°å­— (3): 120,000.231æ ¼å¼åŒ–æ•°å­— (4): 120000.231æ ¼å¼åŒ–æ•°å­— (5): 023%æ ¼å¼åŒ–æ•°å­— (6): 12,000,023.0900000000%æ ¼å¼åŒ–æ•°å­— (7): 023%æ ¼å¼åŒ–æ•°å­— (8): 120E3ç¾Žå…ƒ : $120,000.23formatDateæ ‡ç­¾&lt;fmt:formatDate&gt;æ ‡ç­¾ç”¨äºŽä½¿ç”¨ä¸åŒçš„æ–¹å¼æ ¼å¼åŒ–æ—¥æœŸã€‚&lt;fmt:formatDate&gt;æ ‡ç­¾æœ‰å¦‚ä¸‹å±žæ€§ï¼šå±žæ€§æè¿°æ˜¯å¦å¿…è¦é»˜è®¤å€¼valueè¦æ˜¾ç¤ºçš„æ—¥æœŸæ˜¯æ— typeDATE, TIME, æˆ– BOTHå¦datedateStyleFULL, LONG, MEDIUM, SHORT, æˆ– DEFAULTå¦defaulttimeStyleFULL, LONG, MEDIUM, SHORT, æˆ– DEFAULTå¦defaultpatternè‡ªå®šä¹‰æ ¼å¼æ¨¡å¼å¦æ— timeZoneæ˜¾ç¤ºæ—¥æœŸçš„æ—¶åŒºå¦é»˜è®¤æ—¶åŒºvarå­˜å‚¨æ ¼å¼åŒ–æ—¥æœŸçš„å˜é‡åå¦æ˜¾ç¤ºåœ¨é¡µé¢scopeå­˜å‚¨æ ¼å¼åŒ–æ—¥å¿—å˜é‡çš„èŒƒå›´å¦é¡µé¢&lt;fmt:formatDate&gt; æ ‡ç­¾æ ¼å¼æ¨¡å¼ï¼šä»£ç æè¿°å®žä¾‹Gæ—¶ä»£æ ‡å¿—ADyä¸åŒ…å«çºªå…ƒçš„å¹´ä»½ã€‚å¦‚æžœä¸åŒ…å«çºªå…ƒçš„å¹´ä»½å°äºŽ 10ï¼Œ åˆ™æ˜¾ç¤ºä¸å…·æœ‰å‰å¯¼é›¶çš„å¹´ä»½ã€‚2002Mæœˆä»½æ•°å­—ã€‚ä¸€ä½æ•°çš„æœˆä»½æ²¡æœ‰å‰å¯¼é›¶ã€‚April &amp; 04dæœˆä¸­çš„æŸä¸€å¤©ã€‚ä¸€ä½æ•°çš„æ—¥æœŸæ²¡æœ‰å‰å¯¼é›¶ã€‚20h12 å°æ—¶åˆ¶çš„å°æ—¶ã€‚ä¸€ä½æ•°çš„å°æ—¶æ•°æ²¡æœ‰å‰å¯¼é›¶ã€‚12H24 å°æ—¶åˆ¶çš„å°æ—¶ã€‚ä¸€ä½æ•°çš„å°æ—¶æ•°æ²¡æœ‰å‰å¯¼é›¶ã€‚0måˆ†é’Ÿã€‚ä¸€ä½æ•°çš„åˆ†é’Ÿæ•°æ²¡æœ‰å‰å¯¼é›¶ã€‚45sç§’ã€‚ä¸€ä½æ•°çš„ç§’æ•°æ²¡æœ‰å‰å¯¼é›¶ã€‚52Sæ¯«ç§’970Eå‘¨å‡ TuesdayDä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©180Fä¸€ä¸ªæœˆä¸­çš„ç¬¬å‡ ä¸ªå‘¨å‡ 2 (ä¸€ä¸ªæœˆä¸­çš„ç¬¬äºŒä¸ªæ˜ŸæœŸä¸‰)wä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨r27Wä¸€ä¸ªæœˆä¸­çš„ç¬¬å‡ å‘¨2aa.m./p.m. æŒ‡ç¤ºç¬¦PMkå°æ—¶(12 å°æ—¶åˆ¶çš„å°æ—¶)24Kå°æ—¶(24 å°æ—¶åˆ¶çš„å°æ—¶)0zæ—¶åŒºä¸­éƒ¨æ ‡å‡†æ—¶é—´â€˜&nbsp;è½¬ä¹‰æ–‡æœ¬â€˜â€™&nbsp;å•å¼•å·ä¾‹å­ï¼š1234567891011&lt;c:set var="now" value="&lt;%=new java.util.Date()%&gt;" /&gt;&lt;p&gt;æ—¥æœŸæ ¼å¼åŒ– (1): &lt;fmt:formatDate type="time" value="$&#123;now&#125;" /&gt;&lt;/p&gt;&lt;p&gt;æ—¥æœŸæ ¼å¼åŒ– (2): &lt;fmt:formatDate type="date" value="$&#123;now&#125;" /&gt;&lt;/p&gt;&lt;p&gt;æ—¥æœŸæ ¼å¼åŒ– (3): &lt;fmt:formatDate type="both" value="$&#123;now&#125;" /&gt;&lt;/p&gt;&lt;p&gt;æ—¥æœŸæ ¼å¼åŒ– (4): &lt;fmt:formatDate type="both" dateStyle="short" timeStyle="short" value="$&#123;now&#125;" /&gt;&lt;/p&gt;&lt;p&gt;æ—¥æœŸæ ¼å¼åŒ– (5): &lt;fmt:formatDate type="both" dateStyle="medium" timeStyle="medium" value="$&#123;now&#125;" /&gt;&lt;/p&gt;&lt;p&gt;æ—¥æœŸæ ¼å¼åŒ– (6): &lt;fmt:formatDate type="both" dateStyle="long" timeStyle="long" value="$&#123;now&#125;" /&gt;&lt;/p&gt;&lt;p&gt;æ—¥æœŸæ ¼å¼åŒ– (7): &lt;fmt:formatDate pattern="yyyy-MM-dd" value="$&#123;now&#125;" /&gt;&lt;/p&gt;ç»“æžœï¼š12345678æ—¥æœŸæ ¼å¼åŒ–:æ—¥æœŸæ ¼å¼åŒ– (1): 11:19:43æ—¥æœŸæ ¼å¼åŒ– (2): 2016-6-26æ—¥æœŸæ ¼å¼åŒ– (3): 2016-6-26 11:19:43æ—¥æœŸæ ¼å¼åŒ– (4): 16-6-26 ä¸Šåˆ11:19æ—¥æœŸæ ¼å¼åŒ– (5): 2016-6-26 11:19:43æ—¥æœŸæ ¼å¼åŒ– (6): 2016å¹´6æœˆ26æ—¥ ä¸Šåˆ11æ—¶19åˆ†43ç§’æ—¥æœŸæ ¼å¼åŒ– (7): 2016-06-26å‰©ä¸‹çš„fmtæ ‡ç­¾è¾ƒå°‘ä½¿ç”¨ï¼Œæ‡’å¾—è®°å½•ã€‚å‡½æ•°å¼•å…¥ï¼š1&lt;%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %&gt;containså‡½æ•°fn:contains()å‡½æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š123&lt;c:if test="$&#123;fn:contains(&lt;åŽŸå§‹å­—ç¬¦ä¸²&gt;, &lt;è¦æŸ¥æ‰¾çš„å­å­—ç¬¦ä¸²&gt;)&#125;"&gt; ...&lt;/c:if&gt; â€‹å¦‚ï¼Œä¸‹é¢çš„ELè¡¨è¾¾å¼éƒ½è¿”å›žtrueï¼š123&lt;c:set var="myString" value="Hello World"/&gt;$&#123;fn:contains(myString,"Hello")&#125;$&#123;fn:contains("Stella Cadente","Cadente")&#125;containsIgnoreCaseå‡½æ•°å’Œcontainsç±»ä¼¼ï¼Œä¸åŒºåˆ†å¤§å°å†™ã€‚endsWithå‡½æ•°åˆ¤æ–­ä»¥ä»€ä¹ˆä¸ºç»“å°¾ã€‚startsWithå‡½æ•°escapeXmlå‡½æ•°å¦‚ï¼š1$&#123;fn:escapeXml("Use &lt;br&gt; to change lines")&#125;æ˜¾ç¤ºä¸ºï¼š1Use &lt;br&gt; to change linesindexOfå‡½æ•°fn:indexOf()å‡½æ•°è¿”å›žä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šå­ä¸²çš„ä½ç½®ã€‚fn:indexOf()å‡½æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š1$&#123;fn:indexOf(&lt;åŽŸå§‹å­—ç¬¦ä¸²&gt;,&lt;å­å­—ç¬¦ä¸²&gt;)&#125;ä¾‹å­ï¼š12&lt;c:set var="string1" value="This is first String."/&gt;&lt;p&gt;Index: $&#123;fn:indexOf(string1, "first")&#125;&lt;/p&gt;ç»“æžœï¼š1Index: 8joinå‡½æ•°fn:join()å‡½æ•°å°†ä¸€ä¸ªæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ä½¿ç”¨æŒ‡å®šçš„åˆ†éš”ç¬¦æ¥è¿žæŽ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚splitå‡½æ•°fn:split()å‡½æ•°å°†ä¸€ä¸ªå­—ç¬¦ä¸²ç”¨æŒ‡å®šçš„åˆ†éš”ç¬¦åˆ†è£‚ä¸ºä¸€ä¸ªå­ä¸²æ•°ç»„ã€‚joinå’Œsplitä¾‹å­ï¼š1234&lt;c:set var="string1" value="www runoob com"/&gt;&lt;c:set var="string2" value="$&#123;fn:split(string1, ' ')&#125;" /&gt;&lt;c:set var="string3" value="$&#123;fn:join(string2, '-')&#125;" /&gt;&lt;p&gt;string3 å­—ç¬¦ä¸² : $&#123;string3&#125;&lt;/p&gt;ç»“æžœä¸ºï¼š1å­—ç¬¦ä¸²ä¸º : www-runoob-comlengthå‡½æ•°replaceå‡½æ•°fn:replace()å‡½æ•°å°†å­—ç¬¦ä¸²ä¸­æ‰€æœ‰æŒ‡å®šçš„å­ä¸²ç”¨å¦å¤–çš„å­—ç¬¦ä¸²æ›¿æ¢ã€‚fn:replace()å‡½æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š1$&#123;fn:replace(&lt;åŽŸå§‹å­—ç¬¦ä¸²&gt;, &lt;è¢«æ›¿æ¢çš„å­—ç¬¦ä¸²&gt;, &lt;è¦æ›¿æ¢çš„å­—ç¬¦ä¸²&gt;)&#125;ä¾‹å­ï¼š123&lt;c:set var="string1" value="I am from USA"/&gt;&lt;c:set var="string2" value="$&#123;fn:replace(string1, 'USA', 'China')&#125;" /&gt;&lt;p&gt;æ›¿æ¢åŽçš„å­—ç¬¦ä¸² : $&#123;string2&#125;&lt;/p&gt;ç»“æžœï¼š1æ›¿æ¢åŽçš„å­—ç¬¦ä¸² : I am from Chinasubstringå‡½æ•°fn:substring()å‡½æ•°è¿”å›žå­—ç¬¦ä¸²ä¸­æŒ‡å®šå¼€å§‹å’Œç»“æŸç´¢å¼•çš„å­ä¸²ã€‚fn:substring()å‡½æ•°çš„è¯­æ³•å¦‚ä¸‹ï¼š1$&#123;fn:substring(&lt;string&gt;, &lt;beginIndex&gt;, &lt;endIndex&gt;)&#125;ä¾‹å­ï¼š123&lt;c:set var="string1" value="This is first String."/&gt;&lt;c:set var="string2" value="$&#123;fn:substring(string1, 5, 15)&#125;" /&gt;&lt;p&gt;ç”Ÿæˆçš„å­å­—ç¬¦ä¸²ä¸º : $&#123;string2&#125;&lt;/p&gt;ç»“æžœï¼š1ç”Ÿæˆçš„å­å­—ç¬¦ä¸²ä¸º : is first SsubstringBeforeå‡½æ•°fn:substringBefore()å‡½æ•°è¿”å›žä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šå­ä¸²å‰é¢çš„éƒ¨åˆ†ã€‚å¦‚ï¼š123&lt;c:set var="string1" value="This is first String."/&gt;&lt;c:set var="string2" value="$&#123;fn:substringBefore(string1, 'first')&#125;" /&gt;&lt;p&gt;ç”Ÿæˆçš„å­å­—ç¬¦ä¸² : $&#123;string2&#125;&lt;/p&gt;ç»“æžœï¼š1ç”Ÿæˆçš„å­å­—ç¬¦ä¸² : This issubstringAfterå‡½æ•°toLowerCaseå‡½æ•°toUpperCaseå‡½æ•°trimå‡½æ•°sqlæ ‡ç­¾ç•¥ã€‚ã€ŠServletå’ŒJSPå­¦ä¹ æŒ‡å—ã€‹å­¦ä¹ ç¬”è®°]]></content>
      <tags>
        <tag>servlet&amp;jsp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java Server Pages]]></title>
    <url>%2FJava-Server-Pages.html</url>
    <content type="text"><![CDATA[scripletJSPé¡µé¢å¯ä»¥ç›´æŽ¥ä¹¦å†™Java ä»£ç ï¼ŒJavaä»£ç è¦ç”¨&lt;% %&gt;åŒ…è£¹èµ·æ¥ï¼Œ&lt;% %&gt;ä»£ç å—ä¹Ÿè¢«æˆä¸ºscripletã€‚å¯ä»¥ä½¿ç”¨pageæŒ‡ä»¤çš„importå¯¼å…¥Javaç±»åž‹ï¼Œå¦åˆ™scripleté‡Œçš„Javaç±»å¿…é¡»ä½¿ç”¨å…¨ç±»åã€‚å¦‚ï¼š123456789101112&lt;%@ page import="java.util.Date"%&gt;&lt;%@ page import="java.text.DataFormat"%&gt;&lt;html&gt; &lt;head&gt;&lt;title&gt;Today's date&lt;/title&gt;&lt;/head&gt; &lt;body&gt; &lt;% DateFormat df = DateFormat.getDateInstance(DateFormat.LONG); String s = df.format(new Date()); out.println("Today is " + s); %&gt; &lt;/body&gt;&lt;/html&gt;éšå¼å¯¹è±¡å¯¹è±¡æè¿°requestHttpServletRequestç±»çš„å®žä¾‹responseHttpServletResponseç±»çš„å®žä¾‹outPrintWriterç±»çš„å®žä¾‹ï¼Œç”¨äºŽæŠŠç»“æžœè¾“å‡ºè‡³ç½‘é¡µä¸ŠsessionHttpSessionç±»çš„å®žä¾‹applicationServletContextç±»çš„å®žä¾‹ï¼Œä¸Žåº”ç”¨ä¸Šä¸‹æ–‡æœ‰å…³configServletConfigç±»çš„å®žä¾‹pageContextPageContextç±»çš„å®žä¾‹ï¼Œæä¾›å¯¹JSPé¡µé¢æ‰€æœ‰å¯¹è±¡ä»¥åŠå‘½åç©ºé—´çš„è®¿é—®pageç±»ä¼¼äºŽJavaç±»ä¸­çš„thiså…³é”®å­—ExceptionExceptionç±»çš„å¯¹è±¡ï¼Œä»£è¡¨å‘ç”Ÿé”™è¯¯çš„JSPé¡µé¢ä¸­å¯¹åº”çš„å¼‚å¸¸å¯¹è±¡èŽ·å–HttpServletRequestå¯¹è±¡çš„userNameå‚æ•°ï¼š123&lt;% String userName = request.getParameter("userName");%&gt;PageContextå®žç”¨æ–¹æ³•ä¸ºå­˜å–å±žæ€§ï¼šsetAttribute()å’ŒgetAttribute()ã€‚setAttributeæ–¹æ³•ç­¾åï¼š1public abstract void setAttribute(String name, Object value, int scope);scopeå€¼å¯ä»¥å–ï¼šPAGE_SCOPE, REQUEST_SCOPE, SESSION_SCOPE, APPLICATION_SCOPEã€‚å¦‚ï¼Œä¸‹é¢scripletåœ¨ServletRequsetä¸­ä¿å­˜äº†ä¸€ä¸ªå±žæ€§ï¼š1234&lt;% //product is a Java object pageContext.setAttribute("product",product,pageContext.REQUEST.SCOPE);%&gt;ç­‰ä»·äºŽï¼š123&lt;% request.setAttribute("product",product);%&gt;outå¯¹è±¡ç±»ä¼¼äºŽåœ¨HttpServletResponseä¸­è°ƒç”¨getWritter()ä¹‹åŽå¾—åˆ°çš„java.io.PrintWriterï¼Œå¦‚åœ¨é¡µé¢è¾“å‡ºWelcomeï¼š123&lt;% out.println("Welcome");%&gt;æŒ‡ä»¤pageæŒ‡ä»¤å¸¸ç”¨æŒ‡ä»¤è¡¨ï¼šå±žæ€§å®šä¹‰language=â€ScriptLanguageâ€æŒ‡å®šJSP Containerç”¨ä»€ä¹ˆè¯­è¨€æ¥ç¼–è¯‘ï¼Œç›®å‰åªæ”¯æŒJAVAè¯­è¨€ã€‚é»˜è®¤ä¸ºJAVAextends=â€classNameâ€å®šä¹‰æ­¤JSPç½‘é¡µäº§ç”Ÿçš„Servletæ˜¯ç»§æ‰¿å“ªä¸ªimport=â€importListâ€å®šä¹‰æ­¤JSPç½‘é¡µè¦ä½¿ç”¨å“ªäº›Java APIsession=â€true|falseâ€å†³å®šæ­¤é¡µé¢æ˜¯å¦ä½¿ç”¨sessionå¯¹è±¡ã€‚é»˜è®¤ä¸ºtruebuffer=â€none|size in kbâ€å†³å®šè¾“å‡ºæµ(Input stream)æ˜¯å¦åˆç¼“å†²åŒºã€‚é»˜è®¤ä¸º8kbautoFlush=â€true|falseâ€å†³å®šè¾“å‡ºæµçš„ç¼“å†²åŒºæ…¢äº†åŽæ˜¯å¦éœ€è¦è‡ªåŠ¨æ¸…é™¤ï¼Œç¼“å†²åŒºæ…¢äº†åŽä¼šäº§ç”Ÿå¼‚å¸¸é”™è¯¯(Exception).é»˜è®¤ä¸ºtrueisThreadSafe=â€true|falseâ€æ˜¯å¦æ”¯æŒçº¿ç¨‹ã€‚é»˜è®¤ä¸ºtrueerrorPage=â€urlâ€å¦‚æžœæ­¤é¡µå‘ç”Ÿå¼‚å¸¸ï¼Œç½‘é¡µä¼šé‡æ–°æŒ‡å‘ä¸€ä¸ªurlisErrorPage=â€true|falseâ€è¡¨ç¤ºæ­¤é¡µé¢æ˜¯å¦ä¸ºé”™è¯¯å¤„ç†é¡µé¢ã€‚é»˜è®¤ä¸ºfalsecontentType=â€text/html;charset=gb2312â€è¡¨ç¤ºMIMEç±»åž‹å’ŒJSPçš„ç¼–ç æ–¹å¼ã€‚ç¬”è€…ä½¿ç”¨ä¾‹å·¦pageEncoding=â€ISO-8859-1â€ç¼–ç æ–¹å¼ã€‚isELLgnored=â€true|falseâ€è¡¨ç¤ºæ˜¯å¦åœ¨æ­¤JSPé¡µé¢ä¸­ELè¡¨è¾¾å¼ã€‚trueåˆ™å¿½ç•¥ï¼Œåä¹‹falseåˆ™æ”¯æŒã€‚é»˜è®¤ä¸ºfalse &nbsp; &nbsp;è®¾ç½®jspä¸­ç”¨åˆ°çš„è¯­è¨€,ç”¨åˆ°çš„æ˜¯javaï¼Œä¹Ÿæ˜¯ç›®å‰å”¯ä¸€æœ‰æ•ˆçš„è®¾å®šï¼š1&lt;%@ page language="java"%&gt;jspé¡µé¢æ‰€ç”¨åˆ°çš„ç±»ï¼š1&lt;%@ page import="java.sql.*"% &gt;è®¾ç½®è¯¥jspé¡µé¢å‡ºçŽ°å¼‚å¸¸æ—¶æ‰€è¦è½¬åˆ°çš„é¡µé¢,å¦‚æžœæ²¡è®¾å®šï¼Œå®¹å™¨å°†ä½¿ç”¨å½“å‰çš„é¡µé¢æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼š1&lt;%@ page errorPage="error.jsp"%&gt;è®¾ç½®è¯¥jspé¡µé¢æ˜¯å¦ä½œä¸ºé”™è¯¯æ˜¾ç¤ºé¡µé¢,é»˜è®¤æ˜¯false,å¦‚æžœè®¾ç½®ä¸ºtrue,å®¹å™¨åˆ™ä¼šåœ¨å½“å‰é¡µé¢ç”Ÿæˆä¸€ä¸ªexceptionå¯¹è±¡ï¼š1&lt;%@ page isErrorPage="true"%&gt;è®¾ç½®é¡µé¢æ–‡ä»¶æ ¼å¼å’Œç¼–ç æ–¹å¼ï¼š1&lt;%@ page contentType="text/html;charset=utf-8"%&gt;è®¾ç½®å®¹å™¨ä»¥å¤šçº¿ç¨‹è¿˜æ˜¯å•çº¿ç¨‹è¿è¡Œè¯¥jspé¡µé¢ï¼Œé»˜è®¤æ˜¯true,æ˜¯å¤šçº¿ç¨‹ã€‚è®¾ç½®ä¸ºfalse,åˆ™ä»¥å•çº¿ç¨‹çš„æ–¹å¼è¿è¡Œè¯¥jspé¡µé¢ï¼š1&lt;%@ page isThreadSafe="true"% &gt;è®¾ç½®è¯¥jspé¡µé¢æ˜¯å¦å¯ä»¥ç”¨åˆ°sessionå¯¹è±¡(jspå†…ç½®å¯¹è±¡ï¼Œä¸ºwebå®¹å™¨åˆ›å»º),é»˜è®¤æ˜¯true,èƒ½ç”¨åˆ°session.è®¾ç½®ä¸ºfalse,åˆ™ç”¨ä¸åˆ°ï¼š1&lt;%@ page session="true"% &gt;includeæŒ‡ä»¤è¯­æ³•ï¼š1&lt;%@ include file="url"%&gt;è¢«å¼•ç”¨çš„æ–‡ä»¶æ‰©å±•åä¸ºjspf(JSP fragment)ã€‚è„šæœ¬å…ƒç´ scripletå‰é¢ä»‹ç»äº†ï¼Œè¿™é‡Œä¸åœ¨èµ˜è¿°ã€‚è¡¨è¾¾å¼ä»¥&lt;%=å¼€å¤´ï¼Œ%&gt;ç»“æŸï¼š1Today is &lt;%=java.util.Calendar.getInstance().getTime()%&gt;ç­‰ä»·äºŽï¼š1234Today is&lt;% out.println(java.util.Calendar.getInstance().getTime());%&gt;å£°æ˜Žå¯ä»¥å£°æ˜Žèƒ½å¤Ÿåœ¨JSPé¡µé¢ä¸­å®žç”¨çš„å˜é‡å’Œæ–¹æ³•ï¼Œå£°æ˜Žç”¨&lt;%!%&gt;åŒ…è£¹èµ·æ¥ï¼Œæ¯”å¦‚åœ¨JSPé¡µé¢ä¸­å£°æ˜Žä¸€ä¸ªgetTodaysDateçš„æ–¹æ³•ï¼š1234567891011&lt;%! public String getTodaysDate() &#123; return new java.util.Date(); &#125; %&gt;&lt;html&gt; &lt;head&gt;&lt;title&gt;Declarations&lt;/title&gt;&lt;/head&gt; &lt;body&gt; Today is &lt;%=getTodayDate()%&gt; &lt;/body&gt;&lt;/html&gt;æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å£°æ˜Žè¦†ç›–å®žçŽ°ç±»ä¸­çš„initå’Œdestoryæ–¹æ³•ï¼š12345678&lt;%! public void jspInit() &#123; System.out.println("jspInit ..."); &#125; public void jspDestory() &#123; System.out.println("jspDestory ..."); &#125;%&gt;å…³é—­è„šæœ¬ä¸ºäº†é¡µé¢çš„æ•´æ´æ€§ï¼ŒçŽ°åœ¨ä¸€èˆ¬ç”¨ELï¼ŒJSTLå–ä»£è„šæœ¬å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å…³é—­è„šæœ¬å…ƒç´ ï¼š123456&lt;jsp-config&gt; &lt;jsp-property-group&gt; &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt; &lt;scripting-invalid&gt;true&lt;/scripting-invalid&gt; &lt;/jsp-property-group&gt; &lt;/jsp-config&gt;åŠ¨ä½œåŠ¨ä½œä¼šè¢«ç¼–è¯‘ä¸ºæ‰§è¡ŒæŸä¸ªæ“ä½œçš„Javaä»£ç ï¼Œä¾‹å¦‚è®¿é—®æŸä¸ªJavaå¯¹è±¡ï¼Œæˆ–è€…è°ƒç”¨æŸä¸ªæ–¹æ³•ã€‚useBeanå¦‚ï¼š123456789&lt;html&gt; &lt;head&gt; &lt;title&gt;useBean&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;jsp:useBean id="today" class="java.util.Date"/&gt; &lt;%=today%&gt; &lt;/body&gt;&lt;/html&gt;è¿è¡Œé¡µé¢åŽï¼Œä¼šåœ¨æµè§ˆå™¨è¾“å‡ºå½“å‰æ—¥æœŸå’Œæ—¶é—´ã€‚å­˜å–å±žæ€§æœ‰Employee JavaBeanï¼ŒçŽ°åœ¨é¡µé¢ä¸­å­˜å–å±žæ€§å€¼ï¼š12345678910&lt;html&gt; &lt;head&gt; &lt;title&gt;getProperty and setProperty&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;jsp:useBean id="employee" class="com.mrbird.entity.Employee"/&gt; &lt;jsp:setProperty name="employee" property="firstName" value="Mrbird"/&gt; First Name:&lt;jsp:getProperty name="employee" property="firstName"/&gt; &lt;/body&gt;&lt;/html&gt;includeincludeåŠ¨ä½œç”¨äºŽåŠ¨æ€åœ°åŒ…å«å¦ä¸€ä¸ªèµ„æºï¼Œå®ƒå¯ä»¥åŒ…å«å¦ä¸€ä¸ªJSPé¡µé¢ï¼Œä¸€ä¸ªServletï¼Œä¸€ä¸ªé™æ€HTMLé¡µé¢ã€‚12345678910 &lt;html&gt; &lt;head&gt; &lt;title&gt;Include Action&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;jsp:include page="jspf/menu.jsp"/&gt; &lt;jsp:param name="text" value="How are you?"/&gt; &lt;/jsp:include&gt; &lt;/body&gt;&lt;/html&gt;includeåŠ¨ä½œå’ŒincludeæŒ‡ä»¤åŒºåˆ«ï¼šâ‘  ä½¿ç”¨includeæŒ‡ä»¤æ‰€å¼•ç”¨çš„ä¸œä¸œæ˜¯å‘ç”Ÿåœ¨é¡µé¢è½¬æ¢çš„æ—¶å€™ï¼ŒincludeåŠ¨ä½œåŒ…å«æ˜¯å‘ç”Ÿåœ¨è¯·æ±‚çš„æ—¶å€™ã€‚â‘¡ ä½¿ç”¨includeæŒ‡ä»¤æ—¶ï¼Œè¢«åŒ…å«çš„æ–‡ä»¶æ‰©å±•åæ˜¯ä»€ä¹ˆå¹¶ä¸é‡è¦ï¼Œè€Œä½¿ç”¨includeåŠ¨ä½œæ—¶ï¼Œæ–‡ä»¶æ‰©å±•åå¿…é¡»ä¸ºjspï¼Œä»¥ä¾¿å®ƒèƒ½å¤Ÿä½œä¸ºä¸€ä¸ªJSPé¡µé¢è¿›è¡Œå¤„ç†ã€‚forwardforwardåŠ¨ä½œæ˜¯å°†å½“å‰é¡µé¢è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªé¡µé¢ï¼Œæ¯”å¦‚ï¼š123&lt;jsp:forward page="jspf/login.jsp"&gt; &lt;jsp:param name="text" value="Please login"/&gt;&lt;/jsp:forward&gt;é”™è¯¯å¤„ç†åœ¨å¯èƒ½å‘ç”Ÿå¼‚å¸¸çš„jspé¡µé¢è®¾ç½®å¼‚å¸¸é¡µé¢è·¯å¾„ï¼š1&lt;%@ page errorPage="errorHandler.jsp"%&gt;errorHandler.jspï¼š1234567891011&lt;%@ page isErrorPage="true"%&gt;&lt;html&gt; &lt;head&gt;&lt;title&gt;Error&lt;/title&gt;&lt;/head&gt; &lt;body&gt; An error occurred.&lt;br/&gt; Error message: &lt;% out.println(exception.toString); %&gt; &lt;/body&gt;&lt;/html&gt;ã€ŠServletå’ŒJSPå­¦ä¹ æŒ‡å—ã€‹å­¦ä¹ ç¬”è®°]]></content>
      <tags>
        <tag>servlet&amp;jsp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nexusæ­å»ºç§æœ]]></title>
    <url>%2FNexus%E6%90%AD%E5%BB%BA%E7%A7%81%E6%9C%8D.html</url>
    <content type="text"><![CDATA[å®‰è£…Nexusä¸‹è½½Nexusï¼šhttp://pan.baidu.com/s/1miTmJB6 ï¼Œå¯†ç ï¼š2jh7è§£åŽ‹åŽæ‰¾åˆ°bin/jswç›®å½•ä¸‹é€‰æ‹©å¯¹äºŽçš„æ“ä½œç³»ç»Ÿæ–‡ä»¶å¤¹ï¼šå¦‚windows-x86-64ï¼ŒåŒå‡»start-nexus.batå³å¯å¯åŠ¨nexusï¼Œå¯åŠ¨åŽæµè§ˆå™¨è®¿é—®loaclhost:8081/nexus/ï¼šç‚¹å‡»å³ä¸Šè§’Log Inç™»å½•ï¼Œç®¡ç†å‘˜è´¦å·å¯†ç  adminï¼Œadmin123ã€‚Nexusä»“åº“å’Œä»“åº“ç»„Nexuså†…ç½®ä»“åº“ç‚¹å‡»å·¦ä¾§çš„Repositorieså¯çœ‹åˆ°ï¼šç±»åž‹åˆ†ä¸ºï¼šgroupï¼ˆä»“åº“ç»„ï¼‰ï¼Œproxyï¼ˆä»£ç†ï¼‰ï¼Œhostedï¼ˆå®¿ä¸»ï¼‰ï¼Œvirtualï¼ˆè™šæ‹Ÿï¼‰ï¼šCentralï¼šä»£ç†Mavenä¸­å¤®ä»“åº“ï¼Œç­–ç•¥ä¸ºReleaseï¼Œå› æ­¤åªä¼šä¸‹è½½å’Œç¼“å­˜ä¸­å¤®ä»“åº“ä¸­çš„å‘è¡Œç‰ˆæœ¬æž„ä»¶Releasesï¼šç­–ç•¥ä¸ºReleaseçš„å®¿ä¸»ç±»åž‹ä»“åº“ï¼Œç”¨æ¥éƒ¨ç½²ç»„ç»‡å†…éƒ¨çš„å‘è¡Œç‰ˆæœ¬æž„ä»¶Snapshotsï¼šç­–ç•¥ä¸ºSnapshotsçš„å®¿ä¸»ç±»åž‹ä»“åº“ï¼Œç”¨æ¥éƒ¨ç½²ç»„ç»‡å†…éƒ¨çš„å¿«ç…§ç‰ˆæœ¬æž„ä»¶Apache Snapshotsï¼šç­–ç•¥ä¸ºSnapshotsçš„ä»£ç†ä»“åº“ï¼Œç”¨æ¥ä»£ç†Apache Mavenä»“åº“çš„å¿«ç…§ç‰ˆæœ¬æž„ä»¶3rd partyï¼šç­–ç•¥ä¸ºReleaseçš„å®¿ä¸»ç±»åž‹ä»“åº“ï¼Œç”¨æ¥éƒ¨ç½²æ— æ³•ä»Žå…¬å…±ä»“åº“èŽ·å¾—çš„ç¬¬ä¸‰æ–¹å‘è¡Œç‰ˆæž„ä»¶Public Repositoriesï¼šè¯¥ä»“åº“ç»„ä¸ºä¸Šè¿°æ‰€æœ‰ç­–ç•¥ä¸ºReleaseçš„ä»“åº“èšåˆå¹¶é€šè¿‡ä¸€è‡´çš„åœ°å€æä¾›æœåŠ¡Public Snapshot Repositoriesï¼šè¯¥ä»“åº“ç»„ä¸ºä¸Šè¿°æ‰€æœ‰ç­–ç•¥ä¸ºSnapshotsçš„ä»“åº“èšåˆå¹¶é€šè¿‡ä¸€è‡´çš„åœ°å€æä¾›æœåŠ¡ä¸Šè¿°çš„å‡ ç§ä»“åº“ç±»åž‹å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šmavenå¯ä»¥ç›´æŽ¥ä»Žå®¿ä¸»ä»“åº“å’Œä»£ç†ä»“åº“ä¸‹è½½æž„ä»¶ï¼Œä»£ç†ä»“åº“ä¼šé—´æŽ¥åœ°ä»Žè¿œç¨‹ä»“åº“ä¸‹è½½å¹¶ç¼“å­˜æž„ä»¶ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œmavenå¯ä»¥ä»Žä»“åº“ç»„ä¸‹è½½æž„ä»¶ï¼Œä»“åº“ç»„æ²¡æœ‰å®žé™…çš„å†…å®¹ï¼Œå®ƒä¼šè½¬å‘å…¶åŒ…å«çš„å®¿ä¸»ä»“åº“æˆ–è€…ä»£ç†ä»“åº“èŽ·å¾—å®žé™…çš„æž„ä»¶ã€‚åˆ›å»ºNexuså®¿ä¸»ä»“åº“ç‚¹å‡»Repositoriesç•Œé¢çš„AddæŒ‰é’®ï¼Œé€‰æ‹©Hosted Repositoryï¼šRepository IDï¼šä»“åº“idï¼Œè¯¥å€¼ä¼šè¢«ä½œä¸ºä»“åº“è·¯å¾„çš„æœ€åŽä¸€é¡¹å†…å®¹Repository Nameï¼šä»“åº“åç§°Providerï¼šä»“åº“çš„æ ¼å¼ï¼Œä¸€èˆ¬é€‰é»˜è®¤çš„Maven2Repository Policyï¼šé…ç½®ä»“åº“æž„ä»¶ä¸ºå¿«ç…§ç±»åž‹è¿˜æ˜¯å‘è¡Œç±»åž‹Default Local Storage Locationï¼šä»“åº“é»˜è®¤åœ°å€ï¼Œè‡ªåŠ¨æ ¹æ®idç”ŸæˆOverride Local Storage Locationï¼šè‡ªå®šä¹‰ä»“åº“åœ°å€Deployment Policyï¼šéƒ¨ç½²ç­–ç•¥ï¼Œæœ‰Disable Redeployï¼ˆåŒä¸€æž„ä»¶åªèƒ½éƒ¨ç½²ä¸€æ¬¡ï¼‰ï¼ŒAllow Redeployï¼ˆå…è®¸é‡æ–°éƒ¨ç½²ï¼‰ï¼ŒReadonlyï¼ˆç¦æ­¢éƒ¨ç½²ï¼‰Allow File Browsingï¼šä¸ºtrueæ—¶ä»¥æ ‘å½¢ç»“æž„æµè§ˆä»“åº“å­˜å‚¨æ–‡ä»¶å†…å®¹Include in Searchï¼šæ˜¯å¦å¯¹è¯¥ä»“åº“è¿›è¡Œç´¢å¼•å¹¶æä¾›æœç´¢Publish URLï¼šæ˜¯å¦é€šè¿‡URLæä¾›æœåŠ¡ï¼Œä¸ºfalseçš„æ—¶å€™ï¼Œè®¿é—®è¯¥ä»“åº“åœ°å€ä¼šå¾—åˆ°HTTP 404 Not Foundé”™è¯¯Not Found Cache TTLï¼šå¦‚æžœæŸæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåœ¨è¿™1440åˆ†é’Ÿå†…å†æ¬¡è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œç›´æŽ¥è¿”å›žä¸å­˜åœ¨ä¿¡æ¯æœªå®Œå¾…ç»­ï¼Œæ‡’å¾—å†™]]></content>
      <tags>
        <tag>maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mavenèšåˆä¸Žç»§æ‰¿]]></title>
    <url>%2Fmaven%E8%81%9A%E5%90%88%E4%B8%8E%E7%BB%A7%E6%89%BF.html</url>
    <content type="text"><![CDATA[mavenä¸­èšåˆå’Œç»§æ‰¿æ˜¯ä¸¤ä¸ªæ¦‚å¿µï¼Œä¸¤è€…çš„ç›®çš„æ˜¯ä¸ä¸€æ ·çš„ã€‚èšåˆæ˜¯ä¸ºäº†æ–¹ä¾¿çš„å¿«é€Ÿæž„å»ºé¡¹ç›®ï¼Œè€Œç»§æ‰¿æ˜¯ä¸ºäº†æ¶ˆé™¤ä¸€äº›é‡å¤çš„é…ç½®ã€‚å¯¹äºŽèšåˆæ¨¡å—æ¥è¯´ï¼Œå®ƒçŸ¥é“æœ‰å“ªäº›æ¨¡å—è¢«èšåˆäº†ï¼Œä½†æ˜¯é‚£äº›è¢«èšåˆçš„æ¨¡å—å¹¶ä¸çŸ¥é“è¿™ä¸ªèšåˆæ¨¡å—çš„å­˜åœ¨ã€‚å¯¹äºŽç»§æ‰¿å…³ç³»çš„çˆ¶pomæ¥è¯´ï¼Œå®ƒä¸çŸ¥é“å“ªäº›è¢«èšåˆçš„æ¨¡å—ï¼Œä½†é‚£äº›è¢«èšåˆçš„æ¨¡å—å¿…é¡»çŸ¥é“è‡ªå·±çš„çˆ¶pomæ˜¯ä»€ä¹ˆã€‚èšåˆå¼€å‘ä¸­ï¼Œä¸€ä¸ªé¡¹ç›®ä¸€èˆ¬è¢«åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œé€šè¿‡mavençš„èšåˆç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªçˆ¶mavené¡¹ç›®æ¥ç®¡ç†æ‰€æœ‰çš„å­æ¨¡å—ã€‚çŽ°æœ‰account-emailå’Œaccount-persistä¸¤ä¸ªmavené¡¹ç›®ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªaccount-parenté¡¹ç›®å°†å…¶èšåˆåœ¨ä¸€èµ·ã€‚èšåˆæœ‰ä¸¤ç§ç»“æž„æ–¹å¼ï¼š1.çˆ¶å­ç»“æž„ï¼š2.å¹³è¡Œç»“æž„ä¸‹é¢ä¾‹å­ä»¥å¹³è¡Œç»“æž„ä¸ºä¾‹ã€‚account-parenté…ç½®å¦‚ä¸‹ï¼š12345678910&lt;groupId&gt;com.juvenxu.mvnbook.account&lt;/groupId&gt;&lt;artifactId&gt;account-parent&lt;/artifactId&gt;&lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;pom&lt;/packaging&gt;&lt;name&gt;Account Parent&lt;/name&gt; &lt;modules&gt; &lt;module&gt;../account-email&lt;/module&gt; &lt;module&gt;../account-persist&lt;/module&gt;&lt;/modules&gt;moduleså…ƒç´ ç”¨äºŽèšåˆå­æ¨¡å—ï¼Œpackagingå…ƒç´ å£°æ˜Žå…¶æ‰“åŒ…æ–¹å¼ä¸ºpomã€‚å¯¹äºŽä¸€ä¸ªèšåˆå­æ¨¡å—çš„çˆ¶æ¨¡å—ï¼Œå…¶æ‰“åŒ…æ–¹å¼å¿…é¡»ä¸ºpomã€‚å¯¹äºŽå¹³è¡Œç»“æž„æ¥è¯´ï¼Œçˆ¶æ¨¡å—çš„å†…å®¹ä»…ä¸ºä¸€ä¸ªpomæ–‡ä»¶ã€‚å¯¹çˆ¶æ¨¡å—æ‰§è¡Œ mvn clean installå‘½ä»¤ï¼š12345678910111213[INFO] ------------------------------------------------------------------------[INFO] Reactor Summary:[INFO] [INFO] Account Parent .................................... SUCCESS [0.447s][INFO] Account Email ..................................... SUCCESS [3.334s][INFO] Account Persist ................................... SUCCESS [1.582s][INFO] ------------------------------------------------------------------------[INFO] BUILD SUCCESS[INFO] ------------------------------------------------------------------------[INFO] Total time: 5.489s[INFO] Finished at: Wed Oct 26 16:59:05 CST 2016[INFO] Final Memory: 17M/160M[INFO] ------------------------------------------------------------------------ç»§æ‰¿å¦‚æžœéœ€è¦ç»§æ‰¿çˆ¶æ¨¡å—pomä¸­çš„ä¸€äº›é…ç½®ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å­æ¨¡å—pomä¸­æ·»åŠ å¦‚ä¸‹é…ç½®123456&lt;parent&gt; &lt;groupId&gt;com.juvenxu.mvnbook.account&lt;/groupId&gt; &lt;artifactId&gt;account-parent&lt;/artifactId&gt; &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt; &lt;relativePath&gt;../account-parent/pom.xml&lt;/relativePath&gt;&lt;/parent&gt;é€šè¿‡parentå…ƒç´ æŒ‡å®šå…¶çˆ¶æ¨¡å—ï¼ŒrelativePathæŒ‡å‘çˆ¶æ¨¡å—çš„pomè·¯å¾„ï¼Œå…¶é»˜è®¤å€¼ä¸º../pom.xmlã€‚çˆ¶æ¨¡å—pomä¸­å£°æ˜Žçš„ä¸€äº›å…ƒç´ å¯ä»¥è¢«å­æ¨¡å—ç»§æ‰¿ï¼Œå¸¸ç”¨çš„æœ‰ï¼šâ–  groupIdï¼šé¡¹ç›®idï¼Œé¡¹ç›®åæ ‡çš„æ ¸å¿ƒå…ƒç´ â–  versionï¼šé¡¹ç›®ç‰ˆæœ¬ï¼Œé¡¹ç›®åæ ‡çš„æ ¸å¿ƒå…ƒç´ â–  descriptionï¼šé¡¹ç›®çš„æè¿°ä¿¡æ¯â–  organizationï¼šé¡¹ç›®çš„ç»„ç»‡ä¿¡æ¯â–  distributionManagementï¼šé¡¹ç›®çš„éƒ¨ç½²ä¿¡æ¯â–  propertiesï¼šè‡ªå®šä¹‰çš„mavenå±žæ€§â–  dependenciesï¼šä¾èµ–â–  dependencyManagementï¼šä¾èµ–ç®¡ç†é…ç½®â–  repositoriesï¼šé¡¹ç›®çš„ä»“åº“é…ç½®â–  buildï¼šé¡¹ç›®çš„æºç ç›®å½•é…ç½®ï¼Œè¾“å‡ºç›®å½•é…ç½®ï¼Œæ’ä»¶é…ç½®ï¼Œæ’ä»¶ç®¡ç†é…ç½®ç­‰ä¾èµ–ç»§æ‰¿å¯¹äºŽå­æ¨¡å—å…±ç”¨çš„ä¾èµ–ï¼Œå¯ä»¥ç»Ÿä¸€åœ¨çˆ¶æ¨¡å—ä¸­å£°æ˜Žï¼Œæ¯”å¦‚åœ¨çˆ¶æ¨¡å—account-parentä¸­é…ç½®dependencyManagementï¼š12345678910111213141516171819202122232425262728293031323334&lt;properties&gt; &lt;springframework.version&gt;2.5.6&lt;/springframework.version&gt; &lt;junit.version&gt;4.7&lt;/junit.version&gt;&lt;/properties&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;$&#123;springframework.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;version&gt;$&#123;springframework.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;$&#123;springframework.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;$&#123;springframework.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;$&#123;junit.version&#125;&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;å­æ¨¡å—ä½¿ç”¨è¿™äº›ä¾èµ–çš„æ—¶å€™ï¼Œåªéœ€è¦ç®€å•çš„é…ç½®ï¼Œå¦‚account-emailçš„pomé…ç½®ï¼š1234567891011121314151617181920212223242526272829303132333435363738&lt;properties&gt; &lt;javax.mail.version&gt;1.4.1&lt;/javax.mail.version&gt; &lt;greenmail.version&gt;1.3.1b&lt;/greenmail.version&gt;&lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.mail&lt;/groupId&gt; &lt;artifactId&gt;mail&lt;/artifactId&gt; &lt;version&gt;$&#123;javax.mail.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.icegreen&lt;/groupId&gt; &lt;artifactId&gt;greenmail&lt;/artifactId&gt; &lt;version&gt;$&#123;greenmail.version&#125;&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt;&lt;/dependencies&gt;å¯å‘çŽ°ï¼Œaccount-emailçš„dependenciesé…ç½®çœåŽ»äº†versionï¼Œå¯¹äºŽjunitè¿˜çœåŽ»äº†scopeã€‚çœåŽ»è¿™äº›ä¿¡æ¯æ˜¯å› ä¸ºaccount-emailç»§æ‰¿äº†çˆ¶æ¨¡å—çš„dependencyManagementé…ç½®ï¼Œå®Œæ•´çš„ä¾èµ–å£°æ˜Žå·²ç»åŒ…å«åœ¨çˆ¶pomä¸­ï¼Œå­æ¨¡å—åªéœ€è¦å£°æ˜Žç®€å•çš„groupIdå’ŒartifactIdå°±å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„ä¾èµ–ã€‚æ³¨æ„ï¼šè™½ç„¶å®Œæ•´çš„ä¾èµ–å·²ç»åŒ…å«åœ¨çˆ¶æ¨¡å—pomä¸­äº†ï¼Œä½†å¹¶ä¸æ˜¯è¯´å­æ¨¡å—å®Œå…¨ä¸éœ€è¦å£°æ˜Žä¾èµ–äº†ã€‚æ¯”å¦‚å­æ¨¡å—ä¸å£°æ˜Žspring-context-supportä¾èµ–ï¼Œé‚£ä¹ˆè¯¥ä¾èµ–ä¸ä¼šè¢«å¼•å…¥ã€‚æ’ä»¶ç»§æ‰¿åœ¨çˆ¶æ¨¡å—account-parentçš„pomä¸­é…ç½®pluginManagementå…ƒç´ ï¼š123456789101112131415161718192021&lt;build&gt; &lt;pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;source&gt;1.5&lt;/source&gt; &lt;target&gt;1.5&lt;/target&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;encoding&gt;UTF-8&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/pluginManagement&gt;&lt;/build&gt;å­æ¨¡å—éœ€è¦ç”¨åˆ°è¿™äº›æ’ä»¶çš„æ—¶å€™ï¼Œåªéœ€è¦ç®€å•çš„é…ç½®ï¼š123456789101112&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt;åªéœ€è¦åœ¨å­æ¨¡å—ä¸­æŒ‡å®šæ’ä»¶çš„groupIdå’ŒartifactIdå°±å¯ä»¥åœ¨çˆ¶æ¨¡å—pomä¸­æ‰¾åˆ°å¯¹åº”çš„æ’ä»¶é…ç½®ã€‚ã€ŠMavenå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JSONå°è®°]]></title>
    <url>%2FJSON%E5%B0%8F%E8%AE%B0.html</url>
    <content type="text"><![CDATA[JSONå…¨ç§°JavaScript Object Notationï¼Œæ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå–åè‡ªJavaScriptå¯¹è±¡ï¼Œä½†ä¸¤è€…ä¹‹é—´å¹¶æ²¡æœ‰ä»€ä¹ˆç›´æŽ¥çš„è”ç³»ã€‚JSONè¯­æ³•å’ŒJavaScriptå¯¹è±¡è¯­æ³•ä¸ŠåŒºåˆ«å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šå¯¹æ¯”å†…å®¹JSONJSå¯¹è±¡é”®åå¿…é¡»æ˜¯åŠ åŒå¼•å·å¯å…è®¸ä¸åŠ ã€åŠ å•å¼•å·ã€åŠ åŒå¼•å·å±žæ€§å€¼åªèƒ½æ˜¯æ•°å€¼ï¼ˆ10è¿›åˆ¶ï¼‰ã€ å­—ç¬¦ä¸²ï¼ˆåŒå¼•å·ï¼‰ã€ å¸ƒå°”å€¼å’Œnullï¼Œ ä¹Ÿå¯ä»¥æ˜¯æ•°ç»„æˆ–è€…ç¬¦åˆJSONè¦æ±‚çš„å¯¹è±¡ï¼Œ ä¸èƒ½æ˜¯å‡½æ•°ã€NaN, Infinity, &nbsp;-Infinityå’Œundefinedä»€ä¹ˆéƒ½å¯ä»¥é€—å·é—®é¢˜æœ€åŽä¸€ä¸ªå±žæ€§åŽé¢ä¸èƒ½æœ‰é€—å·å¯ä»¥æ•°å€¼å‰å¯¼0ä¸èƒ½ç”¨ï¼Œå°æ•°ç‚¹åŽå¿…é¡»æœ‰æ•°å­—æ²¡é™åˆ¶å¯ä»¥çœ‹åˆ°ï¼Œç›¸å¯¹äºŽJSå¯¹è±¡ï¼ŒJSONçš„æ ¼å¼æ›´ä¸¥æ ¼ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†å†™çš„JSå¯¹è±¡æ˜¯ä¸ç¬¦åˆJSONçš„æ ¼å¼çš„ã€‚å¦‚ï¼š123456789101112131415161718192021var obj1 = &#123;&#125;; // è¿™åªæ˜¯ JS å¯¹è±¡ // å¯æŠŠè¿™ä¸ªç§°åšï¼šJSON æ ¼å¼çš„ JavaScript å¯¹è±¡ var obj2 = &#123;"width":100,"height":200,"name":"rose"&#125;; // å¯æŠŠè¿™ä¸ªç§°åšï¼šJSON æ ¼å¼çš„å­—ç¬¦ä¸²var str1 = '&#123;"width":100,"height":200,"name":"rose"&#125;'; // è¿™ä¸ªå¯å« JSON æ ¼å¼çš„æ•°ç»„ï¼Œæ˜¯ JSON çš„ç¨å¤æ‚ä¸€ç‚¹çš„å½¢å¼var arr = [ &#123;"width":100,"height":200,"name":"rose"&#125;, &#123;"width":100,"height":200,"name":"rose"&#125;, &#123;"width":100,"height":200,"name":"rose"&#125;,]; // è¿™ä¸ªå¯å«ç¨å¤æ‚ä¸€ç‚¹çš„ JSON æ ¼å¼çš„å­—ç¬¦ä¸² var str2='['+ '&#123;"width":100,"height":200,"name":"rose"&#125;,'+ '&#123;"width":100,"height":200,"name":"rose"&#125;,'+ '&#123;"width":100,"height":200,"name":"rose"&#125;,'+']';ä»¥ä¸‹æ˜¯JSONçš„ä¸€äº›è½¬æ¢æ–¹æ³•ã€‚JavaScriptjså¯¹è±¡â†’jsonå­—ç¬¦ä¸²è½¬æ¢å‡½æ•°JSON.stringifyï¼Œå‡½æ•°ç­¾åå¦‚ä¸‹æ‰€ç¤ºï¼š1JSON.stringify(value[, replacer [, space]])ä¸‹é¢å°†åˆ†åˆ«å±•å¼€å¸¦1~3ä¸ªå‚æ•°çš„ç”¨æ³•ï¼šåŸºæœ¬ä½¿ç”¨â€”â€”ä»…éœ€ä¸€ä¸ªå‚æ•°12345//åˆ›å»ºjså¯¹è±¡var obj = &#123;"name":"mrbird","age":24&#125;;//å°†æ­¤å¯¹è±¡è½¬æˆjsonå­—ç¬¦ä¸²var str = JSON.stringify(obj);// "&#123;"name":"mrbird","age":24&#125;"ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æ˜¯å‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ•°ç»„å¦‚æžœç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆåºåˆ—åŒ–è¿‡ç¨‹ä¸­çš„æ¯ä¸ªå±žæ€§éƒ½ä¼šè¢«è¿™ä¸ªå‡½æ•°è½¬åŒ–å’Œå¤„ç†.å¦‚æžœç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆåªæœ‰åŒ…å«åœ¨è¿™ä¸ªæ•°ç»„ä¸­çš„å±žæ€§æ‰ä¼šè¢«åºåˆ—åŒ–åˆ°æœ€ç»ˆçš„JSONå­—ç¬¦ä¸²ä¸­ã€‚å¦‚æžœç¬¬äºŒä¸ªå‚æ•°æ˜¯nullï¼Œé‚£ä½œç”¨ä¸Šå’Œç©ºç€æ²¡å•¥åŒºåˆ«ï¼Œä½†æ˜¯ä¸æƒ³è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ï¼Œåªæ˜¯æƒ³è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œå°±å¯ä»¥è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ä¸ºnullã€‚è¿™ç¬¬äºŒä¸ªå‚æ•°è‹¥æ˜¯å‡½æ•°ï¼š123456789101112131415161718var friend=&#123; "firstName": "Good", "lastName": "Man", "phone":"1234567", "age":18&#125;; var friendAfter=JSON.stringify(friend,function(key,value)&#123; if(key==="phone") return "(000)"+value; else if(typeof value === "number") return value + 10; else return value; //å¦‚æžœä½ æŠŠè¿™ä¸ªelseåˆ†å¥åˆ é™¤ï¼Œé‚£ä¹ˆç»“æžœä¼šæ˜¯undefined&#125;); console.log(friendAfter); //è¾“å‡ºï¼š&#123;"firstName":"Good","lastName":"Man","phone":"(000)1234567","age":28&#125;ç¬¬äºŒä¸ªå‚æ•°è‹¥æ˜¯æ•°ç»„ï¼š12345678910111213var friend=&#123; "firstName": "Good", "lastName": "Man", "phone":"1234567", "age":18&#125;; //æ³¨æ„ä¸‹é¢çš„æ•°ç»„æœ‰ä¸€ä¸ªå€¼å¹¶ä¸æ˜¯ä¸Šé¢å¯¹è±¡çš„ä»»ä½•ä¸€ä¸ªå±žæ€§åvar friendAfter=JSON.stringify(friend,["firstName","address","phone"]); console.log(friendAfter); //&#123;"firstName":"Good","phone":"1234567"&#125;//æŒ‡å®šçš„â€œaddressâ€ç”±äºŽæ²¡æœ‰åœ¨åŽŸæ¥çš„å¯¹è±¡ä¸­æ‰¾åˆ°è€Œè¢«å¿½ç•¥å¦‚æžœç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆåªæœ‰åœ¨æ•°ç»„ä¸­å‡ºçŽ°çš„å±žæ€§æ‰ä¼šè¢«åºåˆ—åŒ–è¿›ç»“æžœå­—ç¬¦ä¸²ï¼Œåªè¦åœ¨è¿™ä¸ªæä¾›çš„æ•°ç»„ä¸­æ‰¾ä¸åˆ°çš„å±žæ€§å°±ä¸ä¼šè¢«åŒ…å«è¿›åŽ»ï¼Œè€Œè¿™ä¸ªæ•°ç»„ä¸­å­˜åœ¨ä½†æ˜¯æºJSå¯¹è±¡ä¸­ä¸å­˜åœ¨çš„å±žæ€§ä¼šè¢«å¿½ç•¥ï¼Œä¸ä¼šæŠ¥é”™ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°ç”¨äºŽç¾ŽåŒ–è¾“å‡ºæŒ‡å®šç¼©è¿›ç”¨çš„ç©ºç™½å­—ç¬¦ï¼Œå¯ä»¥å–ä»¥ä¸‹å‡ ä¸ªå€¼ï¼šÂ· æ˜¯1-10çš„æŸä¸ªæ•°å­—ï¼Œä»£è¡¨ç”¨å‡ ä¸ªç©ºç™½å­—ç¬¦Â· æ˜¯å­—ç¬¦ä¸²çš„è¯ï¼Œå°±ç”¨è¯¥å­—ç¬¦ä¸²ä»£æ›¿ç©ºæ ¼ï¼Œæœ€å¤šå–è¿™ä¸ªå­—ç¬¦ä¸²çš„å‰10ä¸ªå­—ç¬¦Â· æ²¡æœ‰æä¾›è¯¥å‚æ•°ç­‰äºŽè®¾ç½®æˆnullï¼Œä¹Ÿç­‰äºŽè®¾ç½®ä¸€ä¸ªå°äºŽ1çš„æ•°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647var friend=&#123; "firstName": "Good", "lastName": "Man", "phone":&#123;"home":"1234567","work":"7654321"&#125;&#125;; //ç›´æŽ¥è½¬åŒ–æ˜¯è¿™æ ·çš„ï¼š//&#123;"firstName":"Good","lastName":"Man","phone":&#123;"home":"1234567","work":"7654321"&#125;&#125; var friendAfter=JSON.stringify(friend,null,4); console.log(friendAfter); /*&#123; "firstName": "Good", "lastName": "Man", "phone": &#123; "home": "1234567", "work": "7654321" &#125;&#125;*/ var friendAfter=JSON.stringify(friend,null,"HAHAHAHA"); console.log(friendAfter); /*&#123;HAHAHAHA"firstName": "Good", HAHAHAHA"lastName": "Man", HAHAHAHA"phone": &#123; HAHAHAHAHAHAHAHA"home": "1234567", HAHAHAHAHAHAHAHA"work": "7654321" HAHAHAHA&#125; &#125;*/ var friendAfter=JSON.stringify(friend,null,"WhatAreYouDoingNow"); console.log(friendAfter); /* æœ€å¤šåªå–10ä¸ªå­—ç¬¦&#123;WhatAreYou"firstName": "Good", WhatAreYou"lastName": "Man", WhatAreYou"phone": &#123; WhatAreYouWhatAreYou"home": "1234567", WhatAreYouWhatAreYou"work": "7654321" WhatAreYou&#125; &#125;*/JSON.stringifyå‡½æ•°æœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š1.é”®åä¸æ˜¯åŒå¼•å·çš„ï¼ˆåŒ…æ‹¬æ²¡æœ‰å¼•å·æˆ–è€…æ˜¯å•å¼•å·ï¼‰ï¼Œä¼šè‡ªåŠ¨å˜æˆåŒå¼•å·ï¼›å­—ç¬¦ä¸²æ˜¯å•å¼•å·çš„ï¼Œä¼šè‡ªåŠ¨å˜æˆåŒå¼•å·ã€‚2.æœ€åŽä¸€ä¸ªå±žæ€§åŽé¢æœ‰é€—å·çš„ï¼Œä¼šè¢«è‡ªåŠ¨åŽ»æŽ‰ã€‚3.éžæ•°ç»„å¯¹è±¡çš„å±žæ€§ä¸èƒ½ä¿è¯ä»¥ç‰¹å®šçš„é¡ºåºå‡ºçŽ°åœ¨åºåˆ—åŒ–åŽçš„å­—ç¬¦ä¸²ä¸­ è¿™ä¸ªå¥½ç†è§£ï¼Œä¹Ÿå°±æ˜¯å¯¹éžæ•°ç»„å¯¹è±¡åœ¨æœ€ç»ˆå­—ç¬¦ä¸²ä¸­ä¸ä¿è¯å±žæ€§é¡ºåºå’ŒåŽŸæ¥ä¸€è‡´ã€‚4.å¸ƒå°”å€¼ã€æ•°å­—ã€å­—ç¬¦ä¸²çš„åŒ…è£…å¯¹è±¡åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„åŽŸå§‹å€¼ ä¹Ÿå°±æ˜¯ä½ çš„ä»€ä¹ˆnew String(â€œbalaâ€)ä¼šå˜æˆâ€balaâ€ï¼Œnew Number(2017)ä¼šå˜æˆ2017ã€‚5.undefinedã€ä»»æ„çš„å‡½æ•°ï¼ˆå…¶å®žæœ‰ä¸ªå‡½æ•°ä¼šå‘ç”Ÿç¥žå¥‡çš„äº‹ï¼ŒåŽé¢ä¼šè¯´ï¼‰ä»¥åŠ symbolå€¼ã€‚å‡ºçŽ°åœ¨éžæ•°ç»„å¯¹è±¡çš„å±žæ€§å€¼ä¸­ï¼šåœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè¢«å¿½ç•¥ã€‚å‡ºçŽ°åœ¨æ•°ç»„ä¸­æ—¶ï¼šè¢«è½¬æ¢æˆ nullã€‚1234JSON.stringify(&#123;x: undefined, y: function()&#123;return 1;&#125;, z: Symbol("")&#125;); //å‡ºçŽ°åœ¨éžæ•°ç»„å¯¹è±¡çš„å±žæ€§å€¼ä¸­è¢«å¿½ç•¥ï¼š"&#123;&#125;"JSON.stringify([undefined, Object, Symbol("")]); //å‡ºçŽ°åœ¨æ•°ç»„å¯¹è±¡çš„å±žæ€§å€¼ä¸­ï¼Œå˜æˆnullï¼š"[null,null,null]"å°†JSONå­—ç¬¦ä¸²è§£æžä¸ºJSæ•°æ®ç»“æž„å‡½æ•°JSON.parseçš„ç­¾åå¦‚ä¸‹ï¼š1JSON.parse(text[, reviver])å¦‚æžœç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³JSONå­—ç¬¦ä¸²ä¸æ˜¯åˆæ³•çš„å­—ç¬¦ä¸²çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°ä¼šæŠ›å‡ºé”™è¯¯ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªå¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä½œç”¨åœ¨å±žæ€§å·²ç»è¢«è§£æžä½†æ˜¯è¿˜æ²¡è¿”å›žå‰ï¼Œå°†å±žæ€§å¤„ç†åŽå†è¿”å›žã€‚123456789101112131415161718192021222324252627282930313233343536373839404142var friend=&#123; "firstName": "Good", "lastName": "Man", "phone":&#123;"home":"1234567","work":["7654321","999000"]&#125;&#125;; //æˆ‘ä»¬å…ˆå°†å…¶åºåˆ—åŒ–var friendAfter=JSON.stringify(friend); //'&#123;"firstName":"Good","lastName":"Man","phone":&#123;"home":"1234567","work":["7654321","999000"]&#125;&#125;' //å†å°†å…¶è§£æžå‡ºæ¥ï¼Œåœ¨ç¬¬äºŒä¸ªå‚æ•°çš„å‡½æ•°ä¸­æ‰“å°å‡ºkeyå’ŒvalueJSON.parse(friendAfter,function(k,v)&#123; console.log(k); console.log(v); console.log("----");&#125;);/*firstName Good ----lastName Man ----home 1234567 ----0 7654321 ----1 999000 ----work []----phone Object ---- Object ----*/ä»”ç»†çœ‹ä¸€ä¸‹è¿™äº›è¾“å‡ºï¼Œå¯ä»¥å‘çŽ°è¿™ä¸ªéåŽ†æ˜¯ç”±å†…è€Œå¤–çš„ï¼Œå¯èƒ½ç”±å†…è€Œå¤–è¿™ä¸ªè¯å¤§å®¶ä¼šè¯¯è§£ï¼Œæœ€é‡Œå±‚æ˜¯å†…éƒ¨æ•°ç»„é‡Œçš„ä¸¤ä¸ªå€¼å•Šï¼Œä½†æ˜¯è¾“å‡ºæ˜¯ä»Žç¬¬ä¸€ä¸ªå±žæ€§å¼€å§‹çš„ï¼Œæ€Žä¹ˆå°±æ˜¯ç”±å†…è€Œå¤–çš„å‘¢ï¼Ÿè¿™ä¸ªç”±å†…è€Œå¤–æŒ‡çš„æ˜¯å¯¹äºŽå¤åˆå±žæ€§æ¥è¯´çš„ï¼Œé€šä¿—åœ°è®²ï¼ŒéåŽ†çš„æ—¶å€™ï¼Œä»Žå¤´åˆ°å°¾è¿›è¡ŒéåŽ†ï¼Œå¦‚æžœæ˜¯ç®€å•å±žæ€§å€¼ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼å’Œnullï¼‰ï¼Œé‚£ä¹ˆç›´æŽ¥éåŽ†å®Œæˆï¼Œå¦‚æžœæ˜¯é‡åˆ°å±žæ€§å€¼æ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„å½¢å¼çš„ï¼Œé‚£ä¹ˆæš‚åœï¼Œå…ˆéåŽ†è¿™ä¸ªå­JSONï¼Œè€ŒéåŽ†çš„åŽŸåˆ™ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œç­‰è¿™ä¸ªå¤åˆå±žæ€§éåŽ†å®Œæˆï¼Œé‚£ä¹ˆå†å®Œæˆå¯¹è¿™ä¸ªå±žæ€§çš„éåŽ†è¿”å›žã€‚æœ¬è´¨ä¸Šï¼Œè¿™å°±æ˜¯ä¸€ä¸ªæ·±åº¦ä¼˜å…ˆçš„éåŽ†ã€‚å½±å“ JSON.stringify çš„ç¥žå¥‡å‡½æ•°â€”â€”object.toJSONå¦‚æžœä½ åœ¨ä¸€ä¸ªJSå¯¹è±¡ä¸Šå®žçŽ°äº†toJSONæ–¹æ³•ï¼Œé‚£ä¹ˆè°ƒç”¨JSON.stringifyåŽ»åºåˆ—åŒ–è¿™ä¸ªJSå¯¹è±¡æ—¶ï¼ŒJSON.stringifyä¼šæŠŠè¿™ä¸ªå¯¹è±¡çš„toJSONæ–¹æ³•è¿”å›žçš„å€¼ä½œä¸ºå‚æ•°åŽ»è¿›è¡Œåºåˆ—åŒ–ã€‚1234567891011var info=&#123; "msg":"I Love You", "toJSON":function()&#123; var replaceMsg=new Object(); replaceMsg["msg"]="Go Die"; return replaceMsg; &#125;&#125;; JSON.stringify(info); //å‡ºsiäº†ï¼Œè¿”å›žçš„æ˜¯ï¼š'"&#123;"msg":"Go Die"&#125;"',è¯´å¥½çš„å¿½ç•¥å‡½æ•°å‘¢è¿™ä¸ªå‡½æ•°å°±æ˜¯è¿™æ ·å­çš„ã€‚å…¶å®žDateç±»åž‹å¯ä»¥ç›´æŽ¥ä¼ ç»™JSON.stringifyåšå‚æ•°ï¼Œå…¶ä¸­çš„é“ç†å°±æ˜¯ï¼ŒDateç±»åž‹å†…ç½®äº†toJSONæ–¹æ³•ã€‚Javaä¸‹é¢æ˜¯JSONå’ŒJavaå¯¹è±¡ç­‰çš„è½¬æ¢æ–¹æ³•ã€‚å‡†å¤‡å·¥ä½œï¼Œåˆ›å»ºEmpå®žä½“ç±»ï¼š1234567891011121314public class Emp implements Serializable &#123; private String name; private Integer age; public Emp() &#123; &#125; public Emp(String name, Integer age) &#123; super(); this.name = name; this.age = age; &#125; //get,setç•¥&#125;javaå¯¹è±¡â†’jsonå­—ç¬¦ä¸²123456789@Testpublic void test1() &#123; //1.èŽ·å–Javaå¯¹è±¡ Emp e = new Emp("mrbird",24); //2.å…ˆå°†å…¶è½¬æ¢æˆjsonå¯¹è±¡(Map) JSONObject obj = JSONObject.fromObject(e); //3.åœ¨å°†jsonå¯¹è±¡è½¬æˆå­—ç¬¦ä¸² System.out.println(obj.toString());&#125;è¾“å‡ºï¼š1&#123;"age":24,"name":"mrbird"&#125;é›†åˆ/æ•°ç»„â†’jsonå­—ç¬¦ä¸²1234567891011@Testpublic void test2() &#123; //1.èŽ·å–é›†åˆ/æ•°ç»„ List&lt;Emp&gt; list = new ArrayList&lt;Emp&gt;(); list.add(new Emp("mrbird",24)); list.add(new Emp("leanote",33)); //2.å…ˆæŠŠé›†åˆè½¬æˆjsonæ•°ç»„(List) JSONArray ary = JSONArray.fromObject(list); //3.æŠŠæ•´ä¸ªæ•°ç»„è½¬æˆå­—ç¬¦ä¸² System.out.println(ary.toString());&#125;è¾“å‡ºï¼š1[&#123;"age":24,"name":"mrbird"&#125;,&#123;"age":33,"name":"leanote"&#125;]jsonå­—ç¬¦ä¸²â†’javaå¯¹è±¡12345678910@Testpublic void test3() &#123; //1.èŽ·å–jsonå­—ç¬¦ä¸² String str = "&#123;\"name\":\"mrbird\",\"age\":24&#125;"; //2.å°†æ­¤å­—ç¬¦ä¸²è½¬æˆjsonå¯¹è±¡(Map) JSONObject obj = JSONObject.fromObject(str); //3.å°†jsonå¯¹è±¡è½¬æ¢æˆJavaå¯¹è±¡(bean) Emp e = (Emp)JSONObject.toBean(obj, Emp.class); System.out.println(e.getName());&#125;è¾“å‡ºï¼š1mrbirdjsonå­—ç¬¦ä¸²è½¬â†’List1234567891011121314151617@Testpublic void test4() &#123; //1.èŽ·å–jsonå­—ç¬¦ä¸² String str = "[&#123;\"name\":\"mrbird\",\"age\":24&#125;," + "&#123;\"name\":\"leanote\",\"age\":33&#125;]"; //2.å…ˆå°†æ­¤å­—ç¬¦ä¸²è½¬æˆjsonæ•°ç»„(List) //å½“å‰Listä¸­å­˜çš„æ˜¯Mapã€‚ JSONArray ary = JSONArray.fromObject(str); //3.å°†List&lt;Map&gt;è½¬æˆList&lt;Emp&gt; //JSONArrayä¼šè‡ªåŠ¨å®žä¾‹åŒ–ä¸€ä¸ªé›†åˆï¼Œç„¶åŽå°†aryä¸­çš„æ¯ä¸€ä¸ªMapè½¬æˆEmpï¼Œ //å¢žåŠ åˆ°è¿™ä¸ªæ–°å»ºçš„é›†åˆä¸­ List&lt;Emp&gt; list = (List&lt;Emp&gt;)JSONArray.toCollection(ary, Emp.class); for(Emp e : list) &#123; System.out.println(e.getName()); &#125;&#125;å‚è€ƒæ–‡ç«  â€“ JSONï¼šå¦‚æžœä½ æ„¿æ„ä¸€å±‚ä¸€å±‚å‰¥å¼€æˆ‘çš„å¿ƒï¼Œä½ ä¼šå‘çŽ°â€¦è¿™é‡Œæ°´å¾ˆæ·±â€”â€”æ·±å…¥ç†è§£JSON]]></content>
      <tags>
        <tag>JSON</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mavenç”Ÿå‘½å‘¨æœŸå’Œæ’ä»¶]]></title>
    <url>%2Fmaven%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E6%8F%92%E4%BB%B6.html</url>
    <content type="text"><![CDATA[mavenç”Ÿå‘½å‘¨æœŸï¼ˆlifecycleï¼‰å¯¹æž„å»ºçš„è¿‡ç¨‹è¿›è¡Œäº†æŠ½è±¡å’Œç»Ÿä¸€ï¼Œå®žé™…çš„å·¥ä½œæ˜¯ç”±å¯¹åº”çš„æ’ä»¶ï¼ˆpluginsï¼‰æ¥å®Œæˆçš„ã€‚mavenç”Ÿå‘½å‘¨æœŸmavenç”Ÿå‘½å‘¨æœŸå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šcleanç”Ÿå‘½å‘¨æœŸè¯¥å‘¨æœŸçš„ä»»åŠ¡æ˜¯æ¸…ç†é¡¹ç›®ï¼ŒåŒ…å«ä¸‰ä¸ªé˜¶æ®µï¼špre-cleanæ‰§è¡Œæ¸…ç†å‰éœ€è¦å®Œæˆçš„å·¥ä½œcleanæ¸…ç†ä¸Šä¸€æ¬¡æž„å»ºç”Ÿæˆçš„æ–‡ä»¶post-cleanæ‰§è¡Œæ¸…ç†åŽéœ€è¦å®Œæˆçš„å·¥ä½œdefaultç”Ÿå‘½å‘¨æœŸdefaultç”Ÿå‘½å‘¨æœŸå®šä¹‰äº†çœŸæ­£æž„å»ºæ—¶éœ€è¦çš„æ‰€æœ‰æ­¥éª¤ã€‚validateéªŒè¯é¡¹ç›®æ˜¯æ­£ç¡®çš„ï¼Œæ‰€æœ‰å¿…è¦çš„ä¿¡æ¯æ˜¯å¯ç”¨çš„initializeåˆå§‹åŒ–æž„å»ºçŠ¶æ€ï¼Œä¾‹å¦‚ï¼šè®¾ç½®å±žæ€§æˆ–åˆ›å»ºç›®å½•generate-sourcesç”Ÿæˆç¼–è¯‘æœŸçš„æºä»£ç ã€‚process-sourceså¤„ç†é¡¹ç›®ä¸»èµ„æºæ–‡ä»¶ã€‚ä¸€èˆ¬æ¥è¯´æ˜¯å¯¹src/main/resourcesç›®å½•å†…å®¹è¿›è¡Œå˜é‡æ›¿æ¢ç­‰å·¥ä½œåŽï¼Œå¤åˆ¶åˆ°é¡¹ç›®è¾“å‡ºçš„ä¸»ç›®å½•classpathç›®å½•ä¸­generate-resourcesç”ŸæˆåŒ…å«åœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­çš„èµ„æºprocess-resourceså¤åˆ¶å’Œå¤„ç†èµ„æºåˆ°ç›®æ ‡ç›®å½•ï¼Œå‡†å¤‡æ‰“åŒ…compileç¼–è¯‘é¡¹ç›®çš„æºä»£ç process-classeså¤„ç†ç¼–è¯‘åŽç”Ÿæˆçš„classæ–‡ä»¶generate-test-sourcesç”Ÿæˆç¼–è¯‘æœŸå†…çš„æµ‹è¯•æºä»£ç process-test-sourceså¤„ç†æµ‹è¯•æºä»£ç ï¼Œå¦‚è¿‡æ»¤ä¸€äº›å€¼generate-test-resourcesåˆ›å»ºæµ‹è¯•èµ„æºprocess-test-resourceså¤åˆ¶æµ‹è¯•èµ„æºåˆ°ç›®æ ‡ç›®å½•å¹¶å¤„ç†test-compileç¼–è¯‘æµ‹è¯•æºä»£ç åˆ°æµ‹è¯•ç›®æ ‡ç›®å½•process-test-classeså¤„ç†ç¼–è¯‘æµ‹è¯•ä»£ç åŽç”Ÿæˆçš„classæ–‡ä»¶testä½¿ç”¨åˆé€‚çš„å•å…ƒæµ‹è¯•æ¡†æž¶è¿è¡Œæµ‹è¯•ã€‚ è¿™äº›æµ‹è¯•ä»£ç ä¸ä¼šè¢«æ‰“åŒ…å’Œ éƒ¨ç½²prepare-packageæ‰§è¡Œæ‰“åŒ…å‰éœ€è¦çš„ä»»ä½•å·¥ä½œpackageæŽ¥æ”¶ç¼–è¯‘å¥½çš„ä»£ç ï¼Œæ‰“åŒ…æˆå¯å‘å¸ƒçš„æ ¼å¼ï¼Œå¦‚jarï¼Œwarç­‰pre-integration-testæ‰§è¡Œé›†æˆæµ‹è¯•ä¹‹å‰æ‰€éœ€çš„æ“ä½œintegration-testå¦‚æžœéœ€è¦ï¼Œå¯ä»¥å°†è½¯ä»¶åŒ…å¤„ç†å’Œéƒ¨ç½²åˆ°å¯ä»¥è¿è¡Œé›†æˆæµ‹è¯•çš„çŽ¯å¢ƒä¸­post-integration-testæ‰§è¡Œé›†æˆæµ‹è¯•ä¹‹åŽæ‰€éœ€çš„æ“ä½œverifyè¿è¡Œä»»ä½•æ£€æŸ¥ä»¥éªŒè¯ç¨‹åºåŒ…æ˜¯å¦æœ‰æ•ˆå¹¶ç¬¦åˆè´¨é‡æ ‡å‡†installå°†ç¨‹åºåŒ…å®‰è£…åˆ°mavenæœ¬åœ°ä»“åº“ï¼Œä¾›æœ¬åœ°å…¶ä»–mavené¡¹ç›®ä½¿ç”¨deployå°†æœ€ç»ˆåŒ…å¤åˆ¶åˆ°è¿œç¨‹ä»“åº“ï¼Œä¾›å…¶å®ƒå¼€å‘äººå‘˜å’Œmavené¡¹ç›®ä½¿ç”¨siteç”Ÿå‘½å‘¨æœŸsiteç”Ÿå‘½å‘¨æœŸçš„ä½œç”¨æ˜¯å»ºç«‹å’Œå‘å¸ƒé¡¹ç›®ç«™ç‚¹ã€‚pre-siteæ‰§è¡Œä¸€äº›åœ¨ç”Ÿæˆé¡¹ç›®ç«™ç‚¹ä¹‹å‰æ‰€éœ€è¦å®Œæˆçš„å·¥ä½œsiteç”Ÿæˆé¡¹ç›®ç«™ç‚¹æ–‡æ¡£post-siteæ‰§è¡Œä¸€äº›åœ¨ç”Ÿæˆé¡¹ç›®ç«™ç‚¹ä¹‹åŽéœ€è¦å®Œæˆçš„å·¥ä½œsite-deployå°†ç”Ÿæˆçš„é¡¹ç›®ç«™ç‚¹å‘å¸ƒåˆ°æœåŠ¡å™¨ä¸Šmavenç”Ÿå‘½å‘¨æœŸæ˜¯ç›¸äº’ä¾èµ–çš„å…³ç³»ï¼Œå¦‚æ‰§è¡Œ mvn cleanå‘½ä»¤æ—¶ï¼Œä¼šæ‰§è¡Œpre-cleanï¼Œcleané˜¶æ®µï¼›æ‰§è¡Œmvn deployä¼šæ‰§è¡Œdefaultç”Ÿå‘½å‘¨æœŸå‰é¢çš„æ‰€æœ‰é˜¶æ®µã€‚æ’ä»¶ç›®æ ‡mavenç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µæ˜¯å’Œæ’ä»¶ç»‘å®šåœ¨ä¸€èµ·çš„ï¼Œä¸€ä¸ªæ’ä»¶å¯ä»¥åŒ…å«å¤šä¸ªåŠŸèƒ½ï¼Œæ¯ä¸ªåŠŸèƒ½å¯¹åº”ç”Ÿå‘½å‘¨æœŸçš„ä¸€ä¸ªé˜¶æ®µï¼Œå¹¶ç§°å…¶ä¸ºæ’ä»¶ç›®æ ‡ã€‚å¦‚ï¼šmaven-dependency-pluginåŒ…å«æ’ä»¶ç›®æ ‡ï¼šdependencyï¼štreeï¼Œdependencyï¼šlistï¼Œdependencyï¼šanalyzeç­‰ã€‚å†…ç½®ç»‘å®šæ’ä»¶mavenåœ¨æ ¸å¿ƒä¸ºä¸€äº›ä¸»è¦çš„ç”Ÿå‘½å‘¨æœŸç»‘å®šäº†è®¸å¤šæ’ä»¶ç›®æ ‡ï¼šcleanç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸Žæ’ä»¶ç»‘å®šæƒ…å†µï¼šç”Ÿå‘½å‘¨æœŸé˜¶æ®µæ’ä»¶ç›®æ ‡pre-cleanmaven-clean-plugin:cleancleanpost-cleandefaultç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸Žæ’ä»¶ç»‘å®šæƒ…å†µåŠå…·ä½“ä»»åŠ¡ï¼šç”Ÿå‘½å‘¨æœŸé˜¶æ®µæ’ä»¶ç›®æ ‡æ‰§è¡Œä»»åŠ¡process-resourcesmaven-resources-plugin:resourceså¤åˆ¶ä¸»èµ„æºæ–‡ä»¶åˆ°è¾“å‡º ç›®å½•compilemaven-compiler-plugin:compileç¼–è¯‘ä¸»ä»£ç åˆ°è¾“å‡ºç›®å½•process-test-resourcesmaven-resources-plugin:testResourceså¤åˆ¶æµ‹è¯•èµ„æºæ–‡ä»¶åˆ°è¾“ å‡ºç›®å½•test-compilemaven-compiler-plugin:testCompileç¼–è¯‘æµ‹è¯•ä»£ç åˆ°è¾“å‡ºç›® å½•testmaven-surefire-plugin:testæ‰§è¡Œæµ‹è¯•ç”¨ä¾‹packagemaven-jar-plugin:jaråˆ›å»ºé¡¹ç›®jaråŒ…installmaven-install-plugin:installå°†é¡¹ç›®è¾“å‡ºæž„ä»¶å®‰è£…åˆ° æœ¬åœ°ä»“åº“deploymaven-deploy-plugin:deployå°†é¡¹ç›®è¾“å‡ºæž„ä»¶éƒ¨ç½²åˆ° è¿œç¨‹ä»“åº“siteç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸Žæ’ä»¶ç»‘å®šæƒ…å†µï¼šç”Ÿå‘½å‘¨æœŸé˜¶æ®µæ’ä»¶ç›®æ ‡pre-sitemaven-site-plugin:sitesitepost-sitesite-deploymaven-site-plugin:deployå¦‚ï¼Œå¯¹é¡¹ç›®æ‰§è¡Œ mvn clean install å‘½ä»¤ï¼š1234567891011121314151617181920212223242526272829--- maven-clean-plugin:2.5:clean (default-clean) @ viswcm-project ---[INFO] Deleting D:\workspace\viswcm-project\target[INFO] [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ viswcm-project ---[INFO] Using 'UTF-8' encoding to copy filtered resources.[INFO] Copying 0 resource[INFO] [INFO] --- maven-compiler-plugin:2.5.1:compile (default-compile) @ viswcm-project ---[INFO] Compiling 20 source files to D:\workspace\viswcm-project\target\classes[INFO] [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ viswcm-project ---[INFO] Using 'UTF-8' encoding to copy filtered resources.[INFO] skip non existing resourceDirectory D:\workspace\viswcm-project\src\test\resources[INFO] [INFO] --- maven-compiler-plugin:2.5.1:testCompile (default-testCompile) @ viswcm-project ---[INFO] Nothing to compile - all classes are up to date[INFO] [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ viswcm-project ---[INFO] No tests to run.[INFO] [INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ viswcm-project ---[INFO] Building jar: D:\workspace\viswcm-project\target\viswcm-project-0.0.1-SNAPSHOT.jar[INFO] [INFO] --- maven-install-plugin:2.4:install (default-install) @ viswcm-project ---[INFO] Installing D:\workspace\viswcm-project\target\viswcm-project-0.0.1-SNAPSHOT.jar to D:\64\m2\repository\com\visgreat\viswcm-project\0.0.1-SNAPSHOT\viswcm-project-0.0.1-SNAPSHOT.jar[INFO] Installing D:\workspace\viswcm-project\pom.xml to D:\64\m2\repository\com\visgreat\viswcm-project\0.0.1-SNAPSHOT\viswcm-project-0.0.1-SNAPSHOT.pom[INFO] ------------------------------------------------------------------------[INFO] BUILD SUCCESS[INFO] ------------------------------------------------------------------------å…¶è¾“å‡ºç»“æžœå’Œä¸Šé¢çš„è¡¨æ ¼æè¿°ä¸€è‡´ã€‚è‡ªå®šä¹‰æ’ä»¶ç»‘å®šé™¤äº†mavenå†…ç½®ç»‘å®šï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªè¡Œç»‘å®šæŸä¸ªæ’ä»¶åˆ°æŸä¸ªç”Ÿå‘½å‘¨æœŸçš„æŸä¸ªé˜¶æ®µã€‚æ¯”å¦‚è¦ç”Ÿæˆé¡¹ç›®æºç jaråŒ…ï¼Œæˆ‘ä»¬å¯ä»¥å°†maven-source-pluginæ’ä»¶é…ç½®åˆ°defaultç”Ÿå‘½å‘¨æœŸçš„verifyé˜¶æ®µï¼š123456789101112131415161718&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-source-plugin&lt;/artifactId&gt; &lt;version&gt;2.1.1&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;attach-sources&lt;/id&gt; &lt;phase&gt;verify&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;jar-no-fork&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt;ä¸Šè¿°é…ç½®æè¿°äº†maven-source-pluginæ’ä»¶åæ ‡å¤–ï¼Œè¿˜æœ‰æ’ä»¶æ‰§è¡Œé…ç½®executionså…ƒç´ ä¸‹çš„æ¯ä¸ªexecutionå­å…ƒç´ å¯ä»¥ç”¨æ¥é…ç½®æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ã€‚è¿™é‡Œé…ç½®äº†ä¸€ä¸ªidä¸ºattach-sourcesçš„ä»»åŠ¡ï¼Œé€šè¿‡phaseå…ƒç´ ï¼Œå°†å…¶ç»‘å®šåˆ°verifyé˜¶æ®µä¸Šï¼Œå†é€šè¿‡goalsé…ç½®æŒ‡å®šæ‰§è¡Œçš„æ’ä»¶ç›®æ ‡ã€‚è¿è¡Œmvn verifyï¼š12[INFO] --- maven-source-plugin:2.1.1:jar-no-fork (attach-sources) @ viswcm-project --- [INFO] Building jar: D:\workspace\viswcm-project\target\viswcm-project-0.0.1-SNAPSHOT-sources.jarèŽ·å–æ’ä»¶ä¿¡æ¯mavenå®˜æ–¹æ’ä»¶ï¼šhttp://maven.apache.org/plugins/index.htmlmavenå®˜æ–¹æ’ä»¶ä¸‹è½½åœ°å€ï¼šhttp://repo1.maven.org/maven2/org/apache/maven/plugins/é…ç½®æ’ä»¶ä»“åº“1234567891011121314&lt;pluginRepositories&gt; &lt;pluginRepository&gt; &lt;id&gt;central&lt;/id&gt; &lt;name&gt;Maven.Plugin.Repository&lt;/name&gt; &lt;url&gt;http://repo1.maven.org/maven2&lt;/url&gt; &lt;layout&gt;default&lt;/layout&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;releases&gt; &lt;updatePolicy&gt;never&lt;/updatePolicy&gt; &lt;/releases&gt; &lt;/pluginRepository&gt;&lt;/pluginRepositories&gt;ã€ŠMavenå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[maven repository]]></title>
    <url>%2Fmaven-repository.html</url>
    <content type="text"><![CDATA[ä¿å­˜æž„ä»¶çš„åœ°æ–¹å³ä¸ºrepositoryï¼ˆä»“åº“ï¼‰ã€‚ä»“åº“çš„åˆ†ç±»mavenä»“åº“åˆ†ä¸ºä¸¤ç±»ï¼šæœ¬åœ°ä»“åº“å’Œè¿œç¨‹ä»“åº“ã€‚å½“mavenæ ¹æ®pomä¸­å®šä¹‰çš„åæ ‡å¯»æ‰¾æž„ä»¶æ—¶ï¼Œé¦–å…ˆåœ¨æœ¬åœ°ä»“åº“ä¸­å¯»æ‰¾ï¼Œå½“æ‰¾ä¸åˆ°æ—¶å†ä»Žè¿œç¨‹ä»“åº“å¯»æ‰¾ï¼Œéƒ½æ‰¾ä¸åˆ°æ—¶æŠ›å‡ºå¼‚å¸¸ã€‚mavenè¿œç¨‹ä»“åº“è¿˜å¯è¿›ä¸€æ­¥åˆ†ç±»ï¼šæœ¬åœ°ä»“åº“é»˜è®¤mavenä¼šåœ¨cç›˜åˆ›å»ºä¸€ä¸ª.m2çš„æœ¬åœ°ä»“åº“ï¼Œå¦‚æžœè¦ä¿®æ”¹æœ¬åœ°ä»“åº“åœ°å€ï¼Œå¯ä»¥ä¿®æ”¹setting.xmlæ–‡ä»¶ï¼š123&lt;settings&gt; &lt;localRepository&gt;D:\64\m2\repository&lt;/localRepository&gt;&lt;/settings&gt;è¿œç¨‹ä»“åº“ä¸­å¤®ä»“åº“ä½¿ç”¨è§£åŽ‹è½¯ä»¶æ‰“å¼€%M2_HOME%/lib/maven-model-builder-3.1.1.jarï¼Œç„¶åŽè®¿é—®è·¯å¾„org/apache/maven/model/pom-4.0.0.xmlï¼Œå¯çœ‹åˆ°ï¼š1234567891011&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;central&lt;/id&gt; &lt;name&gt;Central Repository&lt;/name&gt; &lt;url&gt;http://repo.maven.apache.org/maven2&lt;/url&gt; &lt;layout&gt;default&lt;/layout&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt;åŒ…å«è¿™æ®µé…ç½®çš„æ–‡ä»¶æ˜¯æ‰€æœ‰mavené¡¹ç›®éƒ½ä¼šç»§æ‰¿çš„è¶…çº§pomã€‚ä¸Šè¿°é…ç½®ä¸­ï¼Œsnapshotså­å…ƒç´ enabledçš„å€¼ä¸ºfalseï¼Œè¡¨ç¤ºä¸ä»Žä¸­å¤®ä»“åº“ä¸‹è½½å¿«ç…§ç‰ˆæœ¬çš„æž„ä»¶ã€‚ç§æœç§æœæ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿œç¨‹ä»“åº“ï¼Œæž¶è®¾äºŽå±€åŸŸç½‘å†…ã€‚å½“mavenéœ€è¦ä¸‹è½½æž„ä»¶æ—¶ï¼Œå…ˆä»Žç§æœå¯»æ‰¾ï¼Œç§æœä¸­æ²¡æœ‰å†ä»Žå¤–éƒ¨ä»“åº“ä¸‹è½½ã€‚ç§æœæœ‰è®¸å¤šæ˜¾è‘—çš„ä¼˜ç‚¹ï¼šâ–  èŠ‚çœå¤–ç½‘å¸¦å®½â–  åŠ é€Ÿmavenæž„ä»¶â–  éƒ¨ç½²ç¬¬ä¸‰æ–¹æž„ä»¶â–  æé«˜ç¨³å®šæ€§ï¼Œå¢žå¼ºæŽ§åˆ¶â–  é™ä½Žä¸­å¤®ä»“åº“çš„è´Ÿè·è¿œç¨‹ä»“åº“é…ç½®å¦‚æžœé»˜è®¤çš„è¿œç¨‹ä¸­å¤®ä»“åº“æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨pomä¸­æ·»åŠ è¿œç¨‹ä»“åº“çš„é…ç½®ï¼š1234567891011121314151617&lt;project&gt; ... &lt;repositories&gt; &lt;repository&gt; &lt;id&gt;jboss&lt;/id&gt; &lt;name&gt;JBoss Repository&lt;/name&gt; &lt;url&gt;http://repository.jboss.com/maven2/&lt;/url&gt; &lt;releases&gt; &lt;enabled&gt;true&lt;/enabled&gt; &lt;/releases&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;layout&gt;default&lt;/layout&gt; &lt;/repository&gt; &lt;/repositories&gt;&lt;/project&gt;åœ¨repositorieså…ƒç´ ä¸‹ï¼Œä½¿ç”¨repositoryå…ƒç´ å£°æ˜Žä¸€ä¸ªæˆ–å¤šä¸ªè¿œç¨‹ä»“åº“ã€‚ä¸Šé¢çš„xmlå£°æ˜Žäº†ä¸€ä¸ªidä¸ºjbossï¼Œåç§°ä¸ºJBoss Repositoryçš„ä»“åº“ã€‚ä»»ä½•ä¸€ä¸ªä»“åº“çš„idæ˜¯å”¯ä¸€çš„ï¼Œmavenè‡ªå¸¦çš„ä¸­å¤®ä»“åº“ä½¿ç”¨çš„idä¸ºcentralï¼Œå¦‚æžœå…¶ä»–ä»“åº“çš„idä¹Ÿä¸ºcentralï¼Œé‚£ä¹ˆå®ƒå°†è¦†ç›–è‡ªå¸¦çš„ä¸­å¤®ä»“åº“ã€‚urlæŒ‡å‘ä»“åº“åœ°å€ï¼Œä¸€èˆ¬è¯¥åœ°å€éƒ½æ˜¯åŸºäºŽhttpåè®®ã€‚releasesçš„enabledå€¼ä¸ºtrueï¼Œè¡¨ç¤ºå¼€å¯JBossä»“åº“çš„å‘å¸ƒç‰ˆæœ¬ä¸‹è½½æ”¯æŒï¼Œsnapshotsçš„enabledå€¼ä¸ºfalseï¼Œè¡¨ç¤ºå…³é—­JBossä»“åº“çš„å¿«ç…§ç‰ˆæœ¬çš„ä¸‹è½½æ”¯æŒã€‚releaseå’Œsnapshotså…ƒç´ è¿˜å¯ä»¥é…ç½®å¦å¤–ä¸¤ä¸ªå­å…ƒç´ ï¼š12345&lt;snapshots&gt; &lt;enabled&gt;true&lt;/enabled&gt; &lt;updatePolicy&gt;daily&lt;/updatePolicy&gt; &lt;checksumPolicy&gt;ignore&lt;/checksumPolicy&gt;&lt;/snapshots&gt;updatePolicyå…ƒç´ é…ç½®mavenä»Žè¿œç¨‹ä»“åº“æ£€æŸ¥æ›´æ–°çš„é¢‘çŽ‡ï¼Œé»˜è®¤å€¼ä¸ºdailyã€‚å…¶ä»–å¯ç”¨å€¼æœ‰ï¼šnever â€”â€” ä»Žä¸æ£€æŸ¥æ›´æ–°ï¼Œalways â€”â€” æ¯æ¬¡æž„å»ºéƒ½æ£€æŸ¥æ›´æ–°ï¼Œintervalï¼šX â€”â€” æ¯éš”Xåˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ›´æ–°ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤ mvn clean install -Uå¼ºåˆ¶æ›´æ–°ã€‚checksumPolicyå…ƒç´ ç”¨æ¥é…ç½®å½“ä¸‹è½½æž„ä»¶æ—¶ï¼Œmavenæ£€éªŒå’ŒéªŒè¯å¤±è´¥æ—¶å€™çš„åŠ¨ä½œï¼Œé»˜è®¤ä¸ºwarnï¼Œå³è¾“å‡ºè­¦å‘Šä¿¡æ¯ï¼Œignoreåˆ™ä¸ºå¿½ç•¥é”™è¯¯ã€‚è¿œç¨‹ä»“åº“è®¤è¯å¦‚æžœè¿œç¨‹ä»“åº“å‡ºäºŽå®‰å…¨çš„è€ƒè™‘è®¾ç½®äº†ç”¨æˆ·åå’Œå¯†ç ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¿…é¡»åœ¨settings.xmlä¸­é…ç½®ï¼š12345678910&lt;settings&gt; ... &lt;servers&gt; &lt;server&gt; &lt;id&gt;my-proj&lt;/id&gt; &lt;username&gt;repo-user&lt;/username&gt; &lt;password&gt;repo_pwd&lt;/password&gt; &lt;/server&gt; &lt;/servers&gt;&lt;/settings&gt;ä¸Šè¿°xmlæŒ‡å®šäº†idä¸ºmy-projçš„è¿œç¨‹ä»“åº“çš„ç”¨æˆ·åå’Œå¯†ç ã€‚éƒ¨ç½²è‡³è¿œç¨‹ä»“åº“å¦‚å‰æ‰€è¿°ï¼Œç§æœä¸€å¤§ä½œç”¨æ˜¯å¯ä»¥éƒ¨ç½²ç¬¬ä¸‰æ–¹æž„ä»¶ã€‚æ— è®ºæ˜¯å¼€å‘ä¸­ç”Ÿæˆçš„æž„ä»¶è¿˜æ˜¯æ­£å¼å‘å¸ƒçš„æž„ä»¶ï¼Œéƒ½éœ€è¦éƒ¨ç½²åˆ°ç§æœä¸­ä¾›å°ç»„ä¸­çš„å…¶ä»–å¼€å‘äººå‘˜ä½¿ç”¨ï¼Œåœ¨mavené¡¹ç›®pomä¸­é…ç½®ï¼š123456789101112131415161718&lt;project&gt; ... &lt;distributionManagement&gt; &lt;snapshotRepository&gt; &lt;id&gt;user-snapshot&lt;/id&gt; &lt;name&gt;User Porject Snapshot&lt;/name&gt; &lt;url&gt;http://192.168.10.217:8081/nexus/ content/repositories/snapshots/&lt;/url&gt; &lt;uniqueVersion&gt;true&lt;/uniqueVersion&gt; &lt;/snapshotRepository&gt; &lt;repository&gt; &lt;id&gt;user-release&lt;/id&gt; &lt;name&gt;User Porject Release&lt;/name&gt; &lt;url&gt;http://192.168.10.217:8081/nexus/ content/repositories/releases/&lt;/url&gt; &lt;/repository&gt; &lt;/distributionManagement&gt;&lt;/project&gt;ä¸Šè¿°xmlæ˜Žç¡®æŒ‡å®šäº†å¿«ç…§ç‰ˆæœ¬å’Œå‘è¡Œç‰ˆæœ¬çš„ç§æœidå’Œåœ°å€ï¼Œå¦‚å‰æ‰€è¿°ï¼Œå¦‚æžœç§æœè®¾ç½®äº†è´¦å·å¯†ç ï¼Œåˆ™åº”è¯¥åœ¨settings.xmlä¸­è®¾ç½®å¯¹åº”idçš„ç§æœè´¦å·å’Œå¯†ç ï¼Œå°±æœ¬ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨settings.xmlä¸­è®¾ç½®ï¼š1234567891011121314&lt;settings&gt; &lt;servers&gt; &lt;server&gt; &lt;id&gt;user-release&lt;/id&gt; &lt;username&gt;deployment&lt;/username&gt; &lt;password&gt;deployment123&lt;/password&gt; &lt;/server&gt; &lt;server&gt; &lt;id&gt;user-snapshot&lt;/id&gt; &lt;username&gt;deployment&lt;/username&gt; &lt;password&gt;deployment123&lt;/password&gt; &lt;/server&gt; &lt;/servers&gt;&lt;/settings&gt;é…ç½®æ­£ç¡®åŽï¼Œå¯ä»¥è¿è¡Œå‘½ä»¤mvn clean deployå°†é¡¹ç›®æž„å»ºè¾“å‡ºçš„æž„ä»¶éƒ¨ç½²åˆ°å¯¹åº”çš„è¿œç¨‹ä»“åº“ã€‚å¿«ç…§ç‰ˆæœ¬ç‰ˆæœ¬å…ƒç´ versionä¸­æ·»åŠ SNAPSHOTæ ‡è¯†ï¼Œè¡¨æ˜Žè¯¥æž„ä»¶ä¸ºå¿«ç…§ç‰ˆæœ¬ã€‚SNAPSHOTç‰ˆæœ¬çš„æž„ä»¶å‘å¸ƒåˆ°ç§æœçš„è¿‡ç¨‹ä¸­ï¼Œmavenä¼šè‡ªåŠ¨åŠ ä¸Šæ—¶é—´æˆ³ã€‚å¦ä¸€ä½å¼€å‘è€…ä»Žè¯¥ç§æœèŽ·å–è¿™ä¸ªæž„ä»¶çš„æ—¶å€™ï¼Œmavenä¼šè‡ªåŠ¨èŽ·å–æ—¶é—´æˆ³æœ€æ–°çš„æž„ä»¶ã€‚å¿«ç…§ç‰ˆæœ¬åªåº”è¯¥åœ¨ç»„ç»‡å†…éƒ¨ä¾èµ–ä½¿ç”¨ï¼Œé¡¹ç›®ä¸åº”è¯¥ä¾èµ–äºŽä»»ä½•ç»„ç»‡å¤–éƒ¨çš„å¿«ç…§ç‰ˆæœ¬ä¾èµ–ã€‚å› ä¸ºå¿«ç…§ç‰ˆæœ¬çš„ä¸ç¨³å®šæ€§ä¼šå¯¹é¡¹ç›®é€ æˆæ½œåœ¨çš„å±é™©ã€‚é•œåƒå¦‚æžœä»“åº“Bå¯ä»¥æä¾›ä»“åº“Aå­˜å‚¨çš„æ‰€æœ‰å†…å®¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¤ä¸ºBæ˜¯Açš„ä¸€ä¸ªé•œåƒã€‚mavené»˜è®¤çš„è¿œç¨‹ä¸­å¤®ä»“åº“ç”±äºŽæœåŠ¡å™¨ä¸åœ¨ä¸­å›½ï¼Œæ‰€ä»¥è®¿é—®é€Ÿåº¦å¯èƒ½ä¼šæ…¢äº›ï¼Œè¿™æ—¶å€™å¯ä»¥å†settings.xmlä¸­é…ç½®ä¸€ä¸ªé•œåƒï¼š1234567891011&lt;settings&gt; ... &lt;mirrors&gt; &lt;mirror&gt; &lt;id&gt;maven.net.cn&lt;/id&gt; &lt;name&gt;one of the central mirrors in china&lt;/name&gt; &lt;url&gt;http://maven.net.cn/content/groups/public&lt;/url&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;/mirror&gt; &lt;/mirrors&gt;&lt;/settings&gt;&lt;mirrorOf&gt;çš„å€¼ä¸ºcentralï¼Œè¡¨ç¤ºè¯¥é…ç½®ä¸ºä¸­å¤®ä»“åº“çš„é•œåƒã€‚ä»»ä½•å¯¹äºŽä¸­å¤®ä»“åº“çš„è¯·æ±‚éƒ½ä¼šæœ¬è½¬è‡³è¯¥é•œåƒã€‚é•œåƒå¸¸ç”¨äºŽç§æœã€‚ç”±äºŽç§æœå¯ä»¥ä»£ç†ä»»ä½•å¤–éƒ¨çš„å…¬å…±ä»“åº“ï¼Œæ‰€ä»¥å¯ä»¥è¯´ç§æœå°±æ˜¯æ‰€æœ‰ä»“åº“çš„é•œåƒã€‚å¦‚ï¼š12345678910&lt;settings&gt; ... &lt;mirrors&gt; &lt;mirror&gt; &lt;id&gt;nexus&lt;/id&gt; &lt;mirrorOf&gt;*&lt;/mirrorOf&gt; &lt;url&gt;http://192.168.10.217:8081/nexus/content/groups/public/&lt;/url&gt; &lt;/mirror&gt; &lt;/mirrors&gt;&lt;/settings&gt;&lt;mirrorOf&gt;çš„å€¼ä¸º*å·ï¼Œè¡¨ç¤ºhttp://192.168.10.217:8081/nexus/content/groups/public/æ˜¯æ‰€æœ‰å¤–éƒ¨ä»“åº“çš„é•œåƒã€‚ä»»ä½•å¯¹è¿œç¨‹ä»“åº“çš„è¯·æ±‚éƒ½ä¼šè¢«è½¬åˆ°è¿™ä¸ªåœ°å€ã€‚&lt;mirrorOf&gt;çš„é…ç½®ï¼šâ–  &lt;mirrorOf&gt;*&lt;mirrorOf&gt;ï¼šåŒ¹é…æ‰€æœ‰çš„è¿œç¨‹ä»“åº“â–  &lt;mirrorOf&gt;external:*&lt;mirrorOf&gt;ï¼šåŒ¹é…æ‰€æœ‰ä¸åœ¨æœ¬æœºä¸Šçš„è¿œç¨‹ä»“åº“â–  &lt;mirrorOf&gt;repo1,repo2&lt;mirrorOf&gt;ï¼šåŒ¹é…ä»“åº“repo1å’Œrepo2â–  &lt;mirrorOf&gt;*,!repo1&lt;mirrorOf&gt;ï¼šåŒ¹é…é™¤äº†repo1ä¹‹å¤–çš„æ‰€æœ‰è¿œç¨‹ä»“åº“é•œåƒä»“åº“å®Œå…¨å±è”½äº†è¢«é•œåƒä»“åº“ï¼Œå½“é•œåƒä»“åº“åœæ­¢æœåŠ¡çš„æ—¶å€™ï¼Œmavenä»æ— æ³•è®¿é—®è¢«é•œåƒä»“åº“ï¼Œå› è€Œå°†æ— æ³•ä¸‹è½½æž„å»ºã€‚ä»“åº“æœç´¢æœåŠ¡ä¸‹é¢åˆ—å‡ºå‡ ä¸ªç›®å‰èƒ½ç”¨çš„mavenåæ ‡æœåŠ¡ï¼š1.The Centrl Repositoryï¼šhttp://search.maven.org/2.Maven Repositoryï¼šhttp://www.mvnrepository.com/3.Nexus Repository Managerï¼šhttps://repository.sonatype.org/#welcomeã€ŠMavenå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[svnæ€»ç»“]]></title>
    <url>%2Fsvn%E6%80%BB%E7%BB%93.html</url>
    <content type="text"><![CDATA[SVNæ˜¯Subversionçš„ç®€ç§°ï¼Œæ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç çš„ç‰ˆæœ¬æŽ§åˆ¶ç³»ç»Ÿï¼Œç›¸è¾ƒäºŽRCSã€CVSï¼Œå®ƒé‡‡ç”¨äº†åˆ†æ”¯ç®¡ç†ç³»ç»Ÿï¼Œå®ƒçš„è®¾è®¡ç›®æ ‡å°±æ˜¯å–ä»£CVSã€‚äº’è”ç½‘ä¸Šå¾ˆå¤šç‰ˆæœ¬æŽ§åˆ¶æœåŠ¡å·²ä»ŽCVSè¿ç§»åˆ°Subversionã€‚è¯´å¾—ç®€å•ä¸€ç‚¹SVNå°±æ˜¯ç”¨äºŽå¤šä¸ªäººå…±åŒå¼€å‘åŒä¸€ä¸ªé¡¹ç›®ï¼Œå…±ç”¨èµ„æºçš„ç›®çš„ã€‚æœåŠ¡ç«¯å®‰è£…visualsvnä¸‹è½½åœ°å€ï¼šhttps://www.visualsvn.com/downloads/ï¼Œé€‰æ‹©ï¼šä¸‹è½½åŽå¼€å§‹å®‰è£…ï¼Œä¸€è·¯nextï¼Œç›´åˆ°ï¼šé€‰æ‹©ä»“åº“åœ°å€å’Œç«¯å£å·ï¼Œç„¶åŽç»§ç»­nextå³å¯ã€‚å®¢æˆ·ç«¯å®‰è£…tortoisesvnä¸‹è½½åœ°å€ï¼šhttps://tortoisesvn.net/downloads.htmlï¼Œå®‰è£…è¿‡ç¨‹ä¸€è·¯nextå³å¯ã€‚tortoisesvnè¯­è¨€åŒ…ï¼Œtortoisesvnä¸‹è½½åœ°å€ä¸‹é¢å¯é€‰æ‹©å®‰è£…å¯¹åº”çš„è¯­è¨€åŒ…ï¼šæœåŠ¡ç«¯é…ç½®æ–°å¢žrepositoryä»“åº“æ‰“å¼€VisualSvn server,å¦‚ä¸‹å›¾æ‰€ç¤ºæ–°å»ºä¸€ä¸ªrepositoryï¼šå¡«å†™ä»“åº“åç§°ï¼šæ–°å»ºå®ŒåŽå·¦è¾¹ç›®å½•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šåˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹å³é”®æ–°å»ºå¥½çš„MyRepositoryï¼Œé€‰æ‹©æ–°å»º â†’ Floderâ€¦ï¼šå¡«å†™Floderåç§°ï¼šç‚¹å‡»okå³å¯ã€‚åˆ›å»ºå®ŒåŽï¼šåˆ›å»ºç”¨æˆ·è¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªå¼€å‘è€…è´¦å·ï¼šdeveloper1å’Œdeveloper2ï¼Œä¸¤ä¸ªæµ‹è¯•äººå‘˜ï¼štester1å’Œtester2ã€‚ç‚¹å‡»Users â†’ Create Userï¼šåˆ›å»ºå¥½developer1åŽå†æ‰§è¡ŒåŒæ ·æ“ä½œåˆ›å»ºå‰©ä½™çš„è´¦å·ï¼Œåˆ›å»ºå®ŒåŽå¦‚å›¾æ‰€ç¤ºï¼šåˆ›å»ºç”¨æˆ·ç¾¤è¿™é‡Œæˆ‘ä»¬å»ºç«‹ä¸¤ä¸ªç¾¤ï¼šå¼€å‘è€…ç¾¤å’Œæµ‹è¯•äººå‘˜ç¾¤ï¼šç‚¹å‡»Groups â†’ Create Groupâ€¦ï¼šç‚¹å‡»AddæŒ‰é’®å‘ç¾¤ä¸­æ·»åŠ ç”¨æˆ·ï¼šç‚¹å‡»okåŽå°±åˆ›å»ºå¥½äº†developerç¾¤å¹¶æ·»åŠ äº†ç›¸å…³äººå‘˜ï¼Œåˆ›å»ºæµ‹è¯•ç¾¤æ“ä½œä¸€æ ·ï¼Œåˆ›å»ºå¥½åŽå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šè®¾ç½®æƒé™å³å‡»é¡¹ç›®æ–‡ä»¶å¤¹Project1ï¼Œé€‰æ‹©propertiesï¼šå¼¹å‡ºæ¡†ç‚¹å‡»Addæ·»åŠ ç”¨æˆ·ç¾¤ï¼šç‚¹å‡»okåŽå¦‚ä¸‹å›¾æ‰€ç¤ºè®¾ç½®ç”¨æˆ·ç¾¤æƒé™ï¼šå› ä¸ºæµ‹è¯•äººå‘˜ä¸å‚ä¸Žå¼€å‘ï¼Œæ‰€ä»¥å°†å…¶æƒé™è®¾ç½®ä¸ºRead Onlyå³å¯ã€‚ä½¿ç”¨tortoisesvnå¯¼å…¥é¡¹ç›®å³å‡»éœ€è¦å¯¼å…¥çš„é¡¹ç›®ï¼Œé€‰æ‹©å¯¼å…¥ï¼šå¼¹å‡ºæ¡†ï¼šå…¶ä¸­URLæ¥æºäºŽä¹‹å‰åœ¨æœåŠ¡ç«¯æ–°å»ºçš„é¡¹ç›®æ–‡ä»¶å¤¹çš„URLåœ°å€ï¼ŒèŽ·å–æ–¹æ³•ä¸ºï¼šç‚¹å‡»ç¡®å®šåŽå³å¯å‘æœåŠ¡å™¨å¯¼å…¥é¡¹ç›®ï¼šä½¿ç”¨tortoisesvnå¯¼å‡ºé¡¹ç›®åœ¨éœ€è¦å¯¼å‡ºé¡¹ç›®çš„è·¯å¾„ä¸‹å³é”®é€‰æ‹©SVNæ£€å‡ºï¼Œç„¶åŽå¼¹å‡ºï¼šç‚¹å‡»ç¡®å®šåŽå¼¹å‡ºè´¦å·å¯†ç å¡«å†™æ¡†ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ†åˆ«ä½¿ç”¨develop1å’Œdeveloper2æ£€å‡ºï¼šæ£€å‡ºåŽï¼šSVNæäº¤åœ¨developer1æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªreadme.txtæ–‡ä»¶ï¼Œç„¶åŽé€‰ä¸­è¯¥æ–‡ä»¶å³å‡»é€‰æ‹©åŠ å…¥ï¼šå®ŒæˆåŽä¼šå‘çŽ°readme.txtä¸Šæ–°å¢žäº†ä¸€ä¸ªåŠ å·çš„å›¾æ ‡ï¼šæ­¤æ–‡ä»¶å¯ä»¥æäº¤åˆ°SVNåº“é‡Œäº†ã€‚é€‰ä¸­æ–‡ä»¶å³é”®é€‰æ‹©SVNæäº¤ï¼šå¯ä»¥åœ¨ä¿¡æ¯æ¡†é‡Œå¡«å†™ä¿®æ”¹ä¿¡æ¯ï¼Œç‚¹å‡»ç¡®å®šåŽreadme.txtå³å¯è¢«æäº¤åˆ°SVNåº“ï¼šSVNæ›´æ–°developer1æäº¤äº†æ–°æ–‡ä»¶ï¼ŒçŽ°åœ¨åœ¨developer2æ–‡ä»¶å¤¹ä¸‹æ›´æ–°æ­¤æ–‡ä»¶ï¼šå³é”®developer2æ–‡ä»¶å¤¹ï¼Œé€‰æ‹©SVNæ›´æ–°ï¼Œå¼¹å‡ºå¡«å†™è´¦å·å¯†ç æ¡†ï¼Œå¡«å†™developer2è´¦å·å¯†ç å³å¯ã€‚æ›´æ–°åŽdeveloper2æ–‡ä»¶å¤¹åŒæ­¥äº†readme.txtæ–‡ä»¶ï¼šè§£å†³å†²çªå†²çªæ¥æºï¼šæ¯”å¦‚developer1ä¿®æ”¹äº†readme.txtæ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶ä¸”æäº¤äº†ã€‚è¿™æ—¶å€™developer2å¹¶æ²¡æœ‰åŽ»æ›´æ–°developer1æäº¤çš„å†…å®¹ï¼Œä¿®æ”¹çš„æ–‡ä»¶ä¹Ÿä¸ºreadme.txtï¼Œdeveloper2ä¿®æ”¹å®Œæäº¤æ—¶å°±ä¼šå‘çŽ°ç‰ˆæœ¬å†²çªäº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå†²çªçš„æ–‡ä»¶è¢«æ ‡è®°é—®æ„Ÿå¹å·ï¼Œå¹¶ä¸”å¤šå‡ºäº†3ä¸ªæ–‡ä»¶ã€‚è§£å†³å†²çªæœ‰ä¸¤ç§åŠžæ³•ï¼š1.é€‰æ‹©å†²çªæ–‡ä»¶ï¼Œå³é”®é€‰æ‹©SVNè¿˜åŽŸï¼Œè¿™æ ·é¡¹ç›®å°±ä¼šè¢«è¿˜åŽŸåˆ°ä½ ä¿®æ”¹å‰çš„çŠ¶æ€ã€‚è¿™ç§åšæ³•ç¼ºç‚¹æ˜¾è€Œæ˜“è§ï¼Œé‚£å°±æ˜¯ä½ ä¿®æ”¹éƒ¨åˆ†çš„ä»£ç å˜æ²¡äº†ï¼Œæ‰€ä»¥é€‰æ‹©è¿™ç§æ–¹æ³•å‰ï¼Œè¯·æ³¨æ„å¤‡ä»½å¥½è‡ªå·±ä¿®æ”¹éƒ¨åˆ†çš„æºä»£ç ã€‚2.é€‰æ‹©å†²çªæ–‡ä»¶ï¼Œå³é”®é€‰æ‹©ç¼–è¾‘å†²çªï¼šçº¢è‰²éƒ¨åˆ†å³ä¸ºå†²çªéƒ¨åˆ†ï¼Œå¯ä»¥å’Œæäº¤æ­¤æ–‡ä»¶çš„å¼€å‘è€…å•†é‡ï¼Œå°†å•†é‡å¥½åŽçš„ä»£ç æ”¾ç½®äºŽå·²åˆå¹¶éƒ¨åˆ†å³å¯ï¼šç‚¹å‡»ä¿å­˜åŽï¼Œå¤šå‡ºæ¥çš„3ä¸ªæ–‡ä»¶æœ¬åˆ é™¤äº†ï¼Œè¿™æ—¶å€™å°†readme.txtæäº¤å³å¯ã€‚éªŒè¯æƒé™ä½¿ç”¨tester1çš„è´¦å·å¯¼å‡ºé¡¹ç›®åŽï¼Œåœ¨é¡¹ç›®é‡Œæ·»åŠ ä¸€ä¸ªmodify.txtæ–‡ä»¶ï¼Œç„¶åŽåŠ å…¥ï¼Œæäº¤ï¼šæ“ä½œé™åˆ¶ã€‚]]></content>
      <tags>
        <tag>svn</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mavenåæ ‡ä¸Žä¾èµ–]]></title>
    <url>%2Fmaven%E5%9D%90%E6%A0%87%E4%B8%8E%E4%BE%9D%E8%B5%96.html</url>
    <content type="text"><![CDATA[åæ ‡åœ¨mavenä¸­ï¼Œä»»ä½•æž„ä»¶éƒ½æœ‰æ˜Žç¡®å®šä¹‰çš„åæ ‡ã€‚è¿™äº›åæ ‡æ˜¯é€šè¿‡ä¸€äº›å…ƒç´ å®šä¹‰çš„ï¼Œä¸‹é¢æ˜¯nexus-indexerçš„åæ ‡å®šä¹‰ï¼š1234&lt;groupId&gt;org.sonatype.nexus&lt;/groupId&gt;&lt;artifactId&gt;nexus-indexer&lt;/artifactId&gt;&lt;version&gt;2.0.0&lt;/version&gt;&lt;packing&gt;jar&lt;/packing&gt;groupIdï¼šå®šä¹‰å½“å‰mavené¡¹ç›®éš¶å±žçš„å®žé™…é¡¹ç›®ï¼Œä¸€èˆ¬ç”±å…¬å¸å‰ç¼€+éš¶å±žé¡¹ç›®åç§°ç»„æˆartifactIdï¼šå®šä¹‰å½“å‰mavené¡¹ç›®æ¨¡å—ï¼Œä¸€èˆ¬ç”±éš¶å±žé¡¹ç›®åç§°+å½“å‰mavenæ¨¡å—åç§°ç»„æˆversionï¼šç‰ˆæœ¬å·packingï¼šæ‰“åŒ…æ–¹å¼ã€‚æœ‰jarï¼Œwarç­‰ï¼Œé»˜è®¤ä¸ºjar classifierï¼šå®šä¹‰æž„ä»¶è¾“å‡ºçš„ä¸€äº›é™„å±žæž„ä»¶ã€‚æœ¬ä¾‹ä¸»æž„ä»¶è¾“å‡ºnexus-indexer-2.0.0.jarï¼Œé™„å±žæž„ä»¶æ¯”å¦‚æœ‰ï¼šnexus-indexer-2.0.0-javadoc.jarï¼Œnexus-indexer-2.0.0-source.jarç­‰ä¾èµ–é…ç½®é™¤äº†ä¸Šé¢çš„åŸºæœ¬åæ ‡å®šä¹‰ï¼Œä¾èµ–è¿˜å¯ä»¥åŒ…å«ï¼š123456789101112131415161718192021&lt;project&gt; ... &lt;dependency&gt; &lt;dependency&gt; &lt;groupId&gt;... &lt;/groupId&gt; &lt;artifactId&gt;... &lt;/artifactId&gt; &lt;version&gt;... &lt;/version&gt; &lt;type&gt;... &lt;/type&gt; &lt;scope&gt;... &lt;/scope&gt; &lt;optional&gt;... &lt;/optional&gt; &lt;exclusions&gt; &lt;exclusion&gt; ... &lt;/exclusion&gt; ... &lt;/exclusions&gt; &lt;/dependency&gt; ... &lt;/dependency&gt; ...&lt;/project&gt;typeï¼šä¾èµ–çš„ç±»åž‹ï¼Œå¯¹åº”åæ ‡ä¸­çš„packingï¼Œé»˜è®¤ä¸ºjarï¼Œä¸€èˆ¬ä¸ç”¨å£°æ˜Žscopeï¼šä¾èµ–çš„èŒƒå›´optionalï¼šæ ‡è®°ä¾èµ–æ˜¯å¦å¯é€‰ï¼Œè‹¥ä¸ºtrueåˆ™ä¸ºå¯é€‰ä¾èµ–ã€‚å¯é€‰ä¾èµ–ä¸èƒ½ä¼ é€’exclusionsï¼šç”¨æ¥æŽ’é™¤ä¼ é€’æ€§ä¾èµ–ä¾èµ–èŒƒå›´åœ¨ä¸€ä¸ªmavené¡¹ç›®ä¸­ä¸»è¦æœ‰ä¸‰ä¸ªclasspathï¼šç¼–è¯‘classpathï¼Œæµ‹è¯•classpathï¼Œè¿è¡Œæ—¶classpathã€‚ä¸‹è¡¨åˆ—å‡ºäº†ä¾èµ–èŒƒå›´å’Œclasspathçš„å…³ç³»ï¼šä¾èµ–èŒƒå›´ï¼ˆScopeï¼‰å¯¹äºŽç¼–è¯‘classpathæœ‰æ•ˆå¯¹äºŽæµ‹è¯•classpathæœ‰æ•ˆå¯¹äºŽè¿è¡Œæ—¶classpathæœ‰æ•ˆä¾‹å­compileâˆšâˆšâˆšspring-coretestÃ—âˆšÃ—JUnitprovidedâˆšâˆšÃ—servlet-apiruntimeÃ—âˆšâˆšJDBCé©±åŠ¨å®žçŽ°systemâˆšâˆšÃ—æœ¬åœ°çš„ï¼ŒMavenä»“åº“å¤–çš„ ç±»åº“æ–‡ä»¶compileï¼šç¼–è¯‘ä¾èµ–èŒƒå›´testï¼šæµ‹è¯•ä¾èµ–èŒƒå›´providedï¼šå·²æä¾›ä¾èµ–èŒƒå›´runtimeï¼šè¿è¡Œæ—¶ä¾èµ–èŒƒå›´systemï¼šç³»ç»Ÿä¾èµ–èŒƒå›´importï¼šå¯¼å…¥ä¾èµ–èŒƒå›´ä¼ é€’æ€§ä¾èµ–çŽ°æœ‰pomå¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.juven.mvnbook.account&lt;/groupId&gt; &lt;artifactId&gt;account-email&lt;/artifactId&gt; &lt;name&gt;Account Email&lt;/name&gt; &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;4.3.3.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;version&gt;4.3.3.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;4.3.3.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;4.3.3.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.mail&lt;/groupId&gt; &lt;artifactId&gt;mail&lt;/artifactId&gt; &lt;version&gt;1.4.7&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.7&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.icegreen&lt;/groupId&gt; &lt;artifactId&gt;greenmail&lt;/artifactId&gt; &lt;version&gt;1.5.2&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;encoding&gt;UTF-8&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt;ä¸Šé¢çš„xmlä¸­æœ‰ä¸€ä¸ªorg.springframeworkï¼šspring-core.4.3.3.RELEASE.jarä¾èµ–ã€‚åœ¨ä¸­å¤®ä»“åº“æŸ¥çœ‹å…¶xmlï¼Œä¼šå‘çŽ°å…¶è¿˜åŒ…å«äº†ï¼š123456&lt;dependency&gt; &lt;groupId&gt;commons-logging&lt;/groupId&gt; &lt;artifactId&gt;commons-logging&lt;/artifactId&gt; &lt;version&gt;1.2&lt;/version&gt; &lt;scope&gt;compile&lt;/scope&gt;&lt;/dependency&gt;è¯¥ä¾èµ–çš„èŒƒå›´ä¸ºcompileï¼Œè€Œspring-coreä¾èµ–æ²¡æœ‰ç›´æŽ¥å£°æ˜Žä¾èµ–èŒƒå›´ï¼Œé»˜è®¤ä¸ºcompileã€‚çŽ°åœ¨account-emailæœ‰ä¸€ä¸ªcompileèŒƒå›´çš„spring-coreä¾èµ–ï¼Œspring-coreæœ‰ä¸€ä¸ªcompileèŒƒå›´çš„comms-loggingä¾èµ–ï¼Œæ‰€ä»¥comms-loggingä¼šæˆä¸ºaccount-emailçš„compileèŒƒå›´çš„ä¼ é€’æ€§ä¾èµ–ã€‚çŽ°å‡è®¾Aä¾èµ–äºŽBï¼ŒBä¾èµ–äºŽCï¼Œé‚£ä¹ˆAç›¸å¯¹äºŽBæ˜¯ç¬¬ä¸€ç›´æŽ¥ä¾èµ–ï¼ŒBç›¸å¯¹äºŽCæ˜¯ç¬¬äºŒç›´æŽ¥ä¾èµ–ï¼ŒAç›¸å¯¹äºŽCæ˜¯ä¼ é€’æ€§ä¾èµ–ï¼Œå…¶ä¾èµ–èŒƒå›´æŒ‰ä¸‹è¡¨å®šä¹‰ï¼šcompiletestprovidedruntimecompilecompileâ€”â€”compiletesttestâ€”â€”testprovidedprovidedâ€”providedprovidedruntimeruntimeâ€”â€”runtimeè¡¨ä¸­ï¼Œç¬¬ä¸€åˆ—æ˜¯ç¬¬ä¸€ç›´æŽ¥ä¾èµ–èŒƒå›´ï¼Œç¬¬ä¸€è¡Œæ˜¯ç¬¬äºŒç›´æŽ¥ä¾èµ–èŒƒå›´ï¼Œäº¤å‰éƒ¨åˆ†æ˜¯æœ€ç»ˆä¼ é€’æ€§ä¾èµ–èŒƒå›´ã€‚ä¾èµ–è°ƒè§£ä¾èµ–è°ƒè§£æœ‰ä¸¤ä¸ªåŽŸåˆ™ï¼š1.è·¯å¾„æœ€è¿‘çš„ä¼˜å…ˆçŽ°åœ¨æœ‰å¦‚ä¸‹ä¸¤ä¸ªä¾èµ–ï¼šA â†’ B â†’ C â†’ Xï¼ˆ1.0.0ï¼‰A â†’ B â†’ Xï¼ˆ1.2.1ï¼‰Aæœ‰ä¸¤ä¸ªç‰ˆæœ¬çš„ä¼ é€’æ€§ä¾èµ–Xï¼Œå› ä¸ºXï¼ˆ1.2.1ï¼‰è·¯å¾„è¾ƒçŸ­ï¼Œæ‰€ä»¥æœ€ç»ˆXï¼ˆ1.2.1ï¼‰ä¼šè¢«è§£æžä½¿ç”¨ã€‚2.ç¬¬ä¸€å£°æ˜Žè€…ä¼˜å…ˆçŽ°åœ¨æœ‰å¦‚ä¸‹ä¸¤ä¸ªä¾èµ–ï¼šA â†’ B â†’ Xï¼ˆ1.0.0ï¼‰A â†’ B â†’ Xï¼ˆ1.2.1ï¼‰ä¸¤ä¸ªç‰ˆæœ¬Xçš„ä¾èµ–è·¯å¾„ä¸€æ ·é•¿ï¼Œè¿™æ—¶å€™è°è¢«è§£æžå–å†³äºŽè°å…ˆå®šä¹‰ï¼æŽ’é™¤ä¾èµ–ä½¿ç”¨compile:treeæŸ¥çœ‹ä¾èµ–æ ‘ï¼š123456789101112131415[INFO] --- maven-dependency-plugin:2.8:tree (default-cli) @ account-email ---[INFO] com.juven.mvnbook.account:account-email:jar:1.0.0-SNAPSHOT[INFO] +- org.springframework:spring-core:jar:4.3.3.RELEASE:compile[INFO] | \- commons-logging:commons-logging:jar:1.2:compile[INFO] +- org.springframework:spring-beans:jar:4.3.3.RELEASE:compile[INFO] +- org.springframework:spring-context:jar:4.3.3.RELEASE:compile[INFO] | +- org.springframework:spring-aop:jar:4.3.3.RELEASE:compile[INFO] | \- org.springframework:spring-expression:jar:4.3.3.RELEASE:compile[INFO] +- org.springframework:spring-context-support:jar:4.3.3.RELEASE:compile[INFO] +- javax.mail:mail:jar:1.4.7:compile[INFO] | \- javax.activation:activation:jar:1.1:compile[INFO] +- junit:junit:jar:4.7:test[INFO] \- com.icegreen:greenmail:jar:1.5.2:test[INFO] +- com.sun.mail:javax.mail:jar:1.5.6:test[INFO] \- org.slf4j:slf4j-api:jar:1.7.21:testå¦‚ä¸Šæ‰€è¿°çš„ï¼Œspring-coreéšå¼ä¾èµ–äºŽcommons-loggingï¼Œå¦‚æžœä¸æƒ³ä¼ é€’æ­¤ä¾èµ–ï¼Œå¯ä»¥ä¸ºspring-coreæ·»åŠ exclusionså…ƒç´ ï¼š1234567891011&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;4.3.3.RELEASE&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;commons-logging&lt;/groupId&gt; &lt;artifactId&gt;commons-logging&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt;å†æ¬¡æ‰§è¡Œdependency:treeå‘½ä»¤ï¼š1234567891011121314[INFO] --- maven-dependency-plugin:2.8:tree (default-cli) @ account-email ---[INFO] com.juven.mvnbook.account:account-email:jar:1.0.0-SNAPSHOT[INFO] +- org.springframework:spring-core:jar:4.3.3.RELEASE:compile[INFO] +- org.springframework:spring-beans:jar:4.3.3.RELEASE:compile[INFO] +- org.springframework:spring-context:jar:4.3.3.RELEASE:compile[INFO] | +- org.springframework:spring-aop:jar:4.3.3.RELEASE:compile[INFO] | \- org.springframework:spring-expression:jar:4.3.3.RELEASE:compile[INFO] +- org.springframework:spring-context-support:jar:4.3.3.RELEASE:compile[INFO] +- javax.mail:mail:jar:1.4.7:compile[INFO] | \- javax.activation:activation:jar:1.1:compile[INFO] +- junit:junit:jar:4.7:test[INFO] \- com.icegreen:greenmail:jar:1.5.2:test[INFO] +- com.sun.mail:javax.mail:jar:1.5.6:test[INFO] \- org.slf4j:slf4j-api:jar:1.7.21:testå¯å‘çŽ°spring-coreå·²ç»ä¸ä¾èµ–äºŽcommons-loggingäº†ï¼Œå½“ç„¶è¿™é‡Œåªæ˜¯å•çº¯æ¼”ç¤ºæŽ’é™¤ä¾èµ–ï¼Œcommons-loggingå¯¹äºŽSpringæ¡†æž¶æ˜¯å¿…é¡»çš„ã€‚å½’ç±»ä¾èµ–åœ¨ä¸Šè¿°çš„pomä¸­ï¼Œspringçš„ç‰ˆæœ¬éƒ½ä¸º4.3.3.RELEASEç‰ˆæœ¬ï¼Œè€Œä¸”å¯¹äºŽä¸€ä¸ªæ¡†æž¶æ¥è¯´ï¼Œå…¶å„ä¸ªæ¨¡å—çš„ç‰ˆæœ¬ä¸€èˆ¬éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç»Ÿä¸€å£°æ˜Žå…¶ç‰ˆæœ¬ï¼Œç„¶åŽå¼•ç”¨å³å¯ï¼š123456789101112131415161718192021222324&lt;properties&gt; &lt;springframework.version&gt;4.3.3.RELEASE&lt;/springframework.version&gt;&lt;/properties&gt;...&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;$&#123;springframework.version&#125;&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;version&gt;$&#123;springframework.version&#125;&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;$&#123;springframework.version&#125;&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;$&#123;springframework.version&#125;&lt;/version&gt;&lt;/dependency&gt;è¿™æ ·åœ¨ä»¥åŽæ›´æ–°springç‰ˆæœ¬çš„æ—¶å€™ï¼Œåªéœ€è¦ä¿®æ”¹propertieså³å¯ã€‚ä¼˜åŒ–ä¾èµ–é™¤äº†ä½¿ç”¨dependency:treeå‘½ä»¤å¤–ï¼Œè¿˜å¯ä½¿æ˜¯dependency:listæŸ¥çœ‹æ‰€æœ‰ä¾èµ–ï¼šdependency:list12345678910111213141516[INFO] --- maven-dependency-plugin:2.8:list (default-cli) @ account-email ---[INFO] [INFO] The following files have been resolved:[INFO] org.springframework:spring-beans:jar:4.3.3.RELEASE:compile[INFO] org.springframework:spring-context-support:jar:4.3.3.RELEASE:compile[INFO] org.slf4j:slf4j-api:jar:1.7.21:test[INFO] junit:junit:jar:4.7:test[INFO] com.sun.mail:javax.mail:jar:1.5.6:test[INFO] com.icegreen:greenmail:jar:1.5.2:test[INFO] commons-logging:commons-logging:jar:1.2:compile[INFO] org.springframework:spring-aop:jar:4.3.3.RELEASE:compile[INFO] javax.activation:activation:jar:1.1:compile[INFO] javax.mail:mail:jar:1.4.7:compile[INFO] org.springframework:spring-core:jar:4.3.3.RELEASE:compile[INFO] org.springframework:spring-context:jar:4.3.3.RELEASE:compile[INFO] org.springframework:spring-expression:jar:4.3.3.RELEASE:compileä½¿ç”¨dependency:analyzeåˆ†æžä¾èµ–ï¼š1234567[INFO] &lt;&lt;&lt; maven-dependency-plugin:2.8:analyze (default-cli) @ account-email &lt;&lt;&lt;[INFO] [INFO] --- maven-dependency-plugin:2.8:analyze (default-cli) @ account-email ---[WARNING] Unused declared dependencies found:[WARNING] org.springframework:spring-core:jar:4.3.3.RELEASE:compile[WARNING] org.springframework:spring-beans:jar:4.3.3.RELEASE:compile[INFO] ------------------------------------------------------------------------ã€ŠMavenå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨m2eclipseåˆ›å»ºmavené¡¹ç›®]]></title>
    <url>%2F%E4%BD%BF%E7%94%A8m2eclipse%E5%88%9B%E5%BB%BAmaven%E9%A1%B9%E7%9B%AE.html</url>
    <content type="text"><![CDATA[æ–°å»ºmavené¡¹ç›®æ–°å»ºä¸€ä¸ªmaven projectï¼Œå¡«å†™Group Idï¼ŒArtifact Idï¼šç‚¹å‡»finishåŽé¡¹ç›®ç›®å½•ä¸‹è‡ªåŠ¨ç”Ÿæˆäº†pom.xmlæ–‡ä»¶ï¼ˆProject Object Modelï¼Œé¡¹ç›®å¯¹è±¡æ¨¡åž‹ï¼‰ï¼š1234567891011121314151617181920212223242526&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;mrbird.leanote.com&lt;/groupId&gt; &lt;artifactId&gt;hello_maven&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;name&gt;hello_maven&lt;/name&gt; &lt;url&gt;http://maven.apache.org&lt;/url&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.7&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt;&lt;groupId&gt;å®šä¹‰äº†é¡¹ç›®å±žäºŽå“ªä¸ªç»„ï¼Œä¸€èˆ¬ä¸ºå…¬å¸åŸŸååŠ ç»„åã€‚&lt;artifactId&gt;å®šä¹‰äº†å½“å‰mavené¡¹ç›®åœ¨ç»„ä¸­çš„å”¯ä¸€idã€‚&lt;version&gt;å®šä¹‰äº†å½“å‰é¡¹ç›®çš„ç‰ˆæœ¬ã€‚&lt;name&gt;å®šä¹‰äº†æ›´ä¸ºå‹å¥½çš„é¡¹ç›®åç§°ã€‚&lt;dependencies&gt;åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª&lt;dependency&gt;ï¼Œä¸Šé¢ä»£ç æ·»åŠ äº†ä¸€ä¸ªä¾èµ–â€”â€”groupIdä¸ºjunitï¼ŒartifactIdä¸ºjunitï¼Œversionä¸º4.7ã€‚é€šè¿‡è¿™æ®µå£°æ˜Žï¼Œmavenèƒ½å¤Ÿè‡ªåŠ¨ä¸‹è½½junit-4.7.jarã€‚ç¼–å†™ä¸»ä»£ç åœ¨src/main/javaç›®å½•ä¸‹çš„mrbird.leanote.com.hello_mavenåŒ…ä¸‹æ–°å»ºHelloMaven.javaï¼š12345678910public class HelloMaven &#123; public String sayHello()&#123; return "Hello Maven"; &#125; public static void main(String[] args)&#123; System.out.print( new HelloMaven().sayHello() ); &#125;&#125;è¿›è¡Œmavenè¿›è¡Œç¼–è¯‘ï¼Œå³å‡»é¡¹ç›®â†’Run Asâ†’Maven buildâ€¦ï¼šç„¶åŽç‚¹å‡»runï¼š12345678910111213141516171819202122[INFO] Scanning for projects...[INFO] [INFO] ------------------------------------------------------------------------[INFO] Building hello_maven 0.0.1-SNAPSHOT[INFO] ------------------------------------------------------------------------[INFO] [INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ hello_maven ---[INFO] Deleting F:\workspaces\Spring\hello_maven\target[INFO] [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ hello_maven ---[INFO] Using 'UTF-8' encoding to copy filtered resources.[INFO] skip non existing resourceDirectory F:\workspaces\Spring\hello_maven\src\main\resources[INFO] [INFO] --- maven-compiler-plugin:2.5.1:compile (default-compile) @ hello_maven ---[INFO] Compiling 1 source file to F:\workspaces\Spring\hello_maven\target\classes[INFO] ------------------------------------------------------------------------[INFO] BUILD SUCCESS[INFO] ------------------------------------------------------------------------[INFO] Total time: 2.443s[INFO] Finished at: Mon Oct 17 13:12:43 CST 2016[INFO] Final Memory: 11M/115M[INFO] ------------------------------------------------------------------------cleanå‘Šè¯‰mavenæ¸…ç†è¾“å‡ºç›®å½•target/ï¼Œcompileå‘Šè¯‰mavenç¼–è¯‘é¡¹ç›®ä¸»ä»£ç ã€‚ä»Žä¸Šé¢çš„è¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œmavené¦–å…ˆæ‰§è¡Œäº†celanä»»åŠ¡ï¼Œåˆ é™¤target/ç›®å½•ã€‚æŽ¥ç€æ‰§è¡Œresourceä»»åŠ¡ï¼Œå°†é¡¹ç›®ä¸»ä»£ç ç¼–è¯‘è‡³F:\workspaces\Spring\hello_maven\target\classesç›®å½•ã€‚ç¼–å†™æµ‹è¯•ä»£ç åœ¨src/test/javaç›®å½•ä¸‹çš„mrbird.leanote.com.hello_mavenåŒ…ä¸‹æ–°å»ºHelloMavenTest.javaï¼š123456789public class HelloMavenTest&#123; @Test public void testSayHello() &#123; HelloMaven helloMaven = new HelloMaven(); String result = helloMaven.sayHello(); assertEquals( "Hello Maven", result ); &#125;&#125;è°ƒç”¨mavenæ‰§è¡Œæµ‹è¯•ï¼Œå³å‡»é¡¹ç›®â†’Run Asâ†’Maven buildâ€¦è¾“å…¥clean testâ†’runï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243[INFO] Scanning for projects...[INFO] [INFO] ------------------------------------------------------------------------[INFO] Building hello_maven 0.0.1-SNAPSHOT[INFO] ------------------------------------------------------------------------[INFO] [INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ hello_maven ---[INFO] Deleting F:\workspaces\Spring\hello_maven\target[INFO] [INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ hello_maven ---[INFO] Using 'UTF-8' encoding to copy filtered resources.[INFO] skip non existing resourceDirectory F:\workspaces\Spring\hello_maven\src\main\resources[INFO] [INFO] --- maven-compiler-plugin:2.5.1:compile (default-compile) @ hello_maven ---[INFO] Compiling 1 source file to F:\workspaces\Spring\hello_maven\target\classes[INFO] [INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ hello_maven ---[INFO] Using 'UTF-8' encoding to copy filtered resources.[INFO] skip non existing resourceDirectory F:\workspaces\Spring\hello_maven\src\test\resources[INFO] [INFO] --- maven-compiler-plugin:2.5.1:testCompile (default-testCompile) @ hello_maven ---[INFO] Compiling 1 source file to F:\workspaces\Spring\hello_maven\target\test-classes[INFO] [INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ hello_maven ---[INFO] Surefire report directory: F:\workspaces\Spring\hello_maven\target\surefire-reports ------------------------------------------------------- T E S T S-------------------------------------------------------Running mrbird.leanote.com.hello_maven.HelloMavenTestTests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.056 sec Results : Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 [INFO] ------------------------------------------------------------------------[INFO] BUILD SUCCESS[INFO] ------------------------------------------------------------------------[INFO] Total time: 2.794s[INFO] Finished at: Mon Oct 17 13:32:08 CST 2016[INFO] Final Memory: 13M/151M[INFO] ------------------------------------------------------------------------æµ‹è¯•é€šè¿‡ã€‚æ‰“åŒ…è¿è¡Œcompileå’Œtestä¹‹åŽï¼Œæ‰§è¡Œpackageã€‚å³å‡»é¡¹ç›®â†’Run Asâ†’Maven buildâ€¦è¾“å…¥clean packageâ†’runï¼š123456789101112131415161718192021...------------------------------------------------------- T E S T S-------------------------------------------------------Running mrbird.leanote.com.hello_maven.HelloMavenTestTests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.078 sec Results : Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 [INFO] [INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ hello_maven ---[INFO] Building jar: F:\workspaces\Spring\hello_maven\target\hello_maven-0.0.1-SNAPSHOT.jar[INFO] ------------------------------------------------------------------------[INFO] BUILD SUCCESS[INFO] ------------------------------------------------------------------------[INFO] Total time: 4.254s[INFO] Finished at: Mon Oct 17 13:53:15 CST 2016[INFO] Final Memory: 13M/139M[INFO] ------------------------------------------------------------------------æ‰“åŒ…æˆåŠŸï¼Œå·²ç»ç”Ÿæˆäº†jaråŒ…ã€‚å¦‚æžœè¦è®©åˆ«çš„mavené¡¹ç›®èƒ½å¤Ÿå¼•ç”¨HelloMavenï¼Œåˆ™è¿˜éœ€æ‰§è¡Œ clean installï¼š12345678910111213141516171819202122232425...------------------------------------------------------- T E S T S-------------------------------------------------------Running mrbird.leanote.com.hello_maven.HelloMavenTestTests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.064 sec Results : Tests run: 1, Failures: 0, Errors: 0, Skipped: 0 [INFO] [INFO] --- maven-jar-plugin:2.4:jar (default-jar) @ hello_maven ---[INFO] Building jar: F:\workspaces\Spring\hello_maven\target\hello_maven-0.0.1-SNAPSHOT.jar[INFO] [INFO] --- maven-install-plugin:2.4:install (default-install) @ hello_maven ---[INFO] Installing F:\workspaces\Spring\hello_maven\target\hello_maven-0.0.1-SNAPSHOT.jar to C:\Users\Administrator\.m2\repository\mrbird\leanote\com\hello_maven\0.0.1-SNAPSHOT\hello_maven-0.0.1-SNAPSHOT.jar[INFO] Installing F:\workspaces\Spring\hello_maven\pom.xml to C:\Users\Administrator\.m2\repository\mrbird\leanote\com\hello_maven\0.0.1-SNAPSHOT\hello_maven-0.0.1-SNAPSHOT.pom[INFO] ------------------------------------------------------------------------[INFO] BUILD SUCCESS[INFO] ------------------------------------------------------------------------[INFO] Total time: 4.486s[INFO] Finished at: Mon Oct 17 14:01:13 CST 2016[INFO] Final Memory: 14M/138M[INFO] ------------------------------------------------------------------------è¯¥æ“ä½œä¼šå°†è¯¥é¡¹ç›®æ‰“åŒ…åŽçš„jarå’Œpomæ–‡ä»¶æ‹·è´åˆ°æœ¬åœ°mavenä»“åº“ã€‚å› ä¸ºä¸»æ–¹æ³•ä¸­æœ‰mainæ–¹æ³•ï¼Œé»˜è®¤æ‰“åŒ…ç”Ÿæˆçš„jaråŒ…æ˜¯ä¸èƒ½è¿è¡Œçš„ï¼Œå¦‚ï¼š12F:\workspaces\Spring\hello_maven&gt;java -jar target/hello_maven-0.0.1-SNAPSHOT.jartarget/hello_maven-0.0.1-SNAPSHOT.jarä¸­æ²¡æœ‰ä¸»æ¸…å•å±žæ€§ä¸ºäº†ç”Ÿæˆå¯æ‰§è¡Œçš„jarï¼Œéœ€è¦å€ŸåŠ©maven-shade-pluginï¼Œåœ¨pomä¸­é…ç½®ï¼š1234567891011121314151617181920212223242526&lt;build&gt;&lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt; &lt;version&gt;1.2.1&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;phase&gt;package&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;shade&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;transformers&gt; &lt;transformer implementation="org.apache.maven.plugins.shade. resource.ManifestResourceTransformer"&gt; &lt;mainClass&gt;mrbird.leanote.com.hello_maven.HelloMaven&lt;/mainClass&gt; &lt;/transformer&gt; &lt;/transformers&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt;&lt;/plugins&gt;&lt;/build&gt;é…ç½®mainClassä¸ºmrbird.leanote.com.hello_maven.HelloMavenã€‚å†æ¬¡æ‰§è¡Œclean installæ“ä½œï¼Œç„¶åŽæ‰§è¡Œjarï¼š12F:\workspaces\Spring\hello_maven&gt;java -jar target/hello_maven-0.0.1-SNAPSHOT.jarHello Mavenã€ŠMavenå®žæˆ˜ã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çŽ¯å¢ƒå˜é‡è®¾ç½®]]></title>
    <url>%2F%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E8%AE%BE%E7%BD%AE.html</url>
    <content type="text"><![CDATA[JDK1.JAVA_HOMEï¼š1C:\Program Files\Java\jdk1.8.0_602.Pathï¼š1%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin3.CLASSPATH :1.;%JAVA_HOME%\lib;%JAVA_HOME%\lib\tools.jaræ£€æµ‹ï¼š1234567C:\Users\Administrator&gt;echo %java_home%C:\Program Files\Java\jdk1.8.0_60 C:\Users\Administrator&gt;java -versionjava version "1.8.0_60"Java(TM) SE Runtime Environment (build 1.8.0_60-b27)Java HotSpot(TM) 64-Bit Server VM (build 25.60-b23, mixed mode)MAVEN1.M2_HOMEï¼š1D:\Program Files\apache-maven-3.1.12.Pathï¼š1%M2_HOME%\binæµ‹è¯•ï¼š12345678910C:\Users\Administrator&gt;echo %m2_home%D:\Program Files\apache-maven-3.1.1 C:\Users\Administrator&gt;mvn -vApache Maven 3.1.1 (0728685237757ffbf44136acec0402957f723d9a)Maven home: D:\Program Files\apache-maven-3.1.1Java version: 1.8.0_60, vendor: Oracle CorporationJava home: C:\Program Files\Java\jdk1.8.0_60\jreDefault locale: zh_CN, platform encoding: GBKOS name: "windows 10", version: "10.0", arch: "amd64", family: "dos"]]></content>
      <tags>
        <tag>çŽ¯å¢ƒå˜é‡</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring äº‹åŠ¡ç®¡ç†]]></title>
    <url>%2FSpring-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86.html</url>
    <content type="text"><![CDATA[åœ¨SimpleJdbcTemplateçš„UserDaoImplä¸­çš„addUser()æ–¹æ³•ä¸­æ‰‹åŠ¨åˆ¶é€ ä¸€ä¸ªNullPointerExceptionå¼‚å¸¸ï¼š123456789public void addUser(User user) &#123; Map&lt;String, Object&gt; params=new HashMap&lt;String, Object&gt;(); params.put("name", user.getName()); params.put("age", user.getAge()); params.put("pwd", user.getPassword()); jdbcTemplate.update(SQL_INSERT_USER, params); String a = null; a.toString();&#125;æµ‹è¯•addUser()æ–¹æ³•ï¼š123456789101112public class TestJdbc &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); UserDao dao=ac.getBean("userDao",UserDao.class); User u=new User(); u.setName("testUser"); u.setAge("24"); u.setPassword("123456"); dao.addUser(u); &#125;&#125;æ‰§è¡Œæ—¶ï¼ŒæŽ§åˆ¶å°æŠ›å‡ºNullPointerExceptionå¼‚å¸¸ï¼Œä½†æ˜¯æ•°æ®æ’å…¥æˆåŠŸäº†ä¹ˆï¼ŸæŸ¥è¯¢æ•°æ®åº“ï¼š123456SQL&gt; select * from lzp.userinfo; USERI NAME AGE PWD----- ---------- --- ----------8 testUser 24 1234564 SCOTT 25 123456å‘çŽ°è™½ç„¶addUser()æ–¹æ³•æŠ›å‡ºäº†å¼‚å¸¸ï¼Œä½†æ˜¯æ•°æ®è¿˜æ˜¯è¢«æˆåŠŸçš„æ’å…¥ï¼Œè¿™è¿èƒŒäº†äº‹åŠ¡çš„ACIDåŽŸåˆ™ã€‚Springæä¾›äº†å¯¹äº‹åŠ¡ç®¡ç†çš„æ”¯æŒã€‚è¿™é‡Œä»…ä»‹ç»å£°æ˜Žå¼äº‹åŠ¡ã€‚é€‰æ‹©äº‹åŠ¡ç®¡ç†å™¨JDBCäº‹åŠ¡ç®¡ç†å™¨å¦‚æžœåº”ç”¨ç¨‹åºä¸­ç›´æŽ¥ä½¿ç”¨JDBCæ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œé‚£ä¹ˆåº”è¯¥é€‰æ‹©DataSourceTransactionManagerä½œä¸ºäº‹åŠ¡ç®¡ç†å™¨ï¼š1234&lt;bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt; &lt;property name="dataSource" ref="dataSource" /&gt;&lt;/bean&gt;Hibernateäº‹åŠ¡ç®¡ç†å™¨å¦‚æžœåº”ç”¨ç¨‹åºçš„æŒä¹…åŒ–æ˜¯é€šè¿‡Hibernateæ¥å®žçŽ°çš„ï¼Œé‚£ä¹ˆåº”è¯¥é€‰æ‹©HibernateTransactionManagerä½œä¸ºäº‹åŠ¡ç®¡ç†å™¨ï¼š1234&lt;bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager"&gt; &lt;property name="sessionFactory" ref="sessionFactory" /&gt;&lt;/bean&gt;äº‹åŠ¡äº”å¤§å±žæ€§ä¼ æ’­è¡Œä¸ºä¼ æ’­è¡Œä¸ºï¼ˆpropagation behaviorï¼‰å®šä¹‰äº†å®¢æˆ·ç«¯ä¸Žè¢«è°ƒç”¨æ–¹æ³•ä¹‹é—´çš„äº‹åŠ¡è¾¹ç•Œã€‚å³ä½•æ—¶è¦åˆ›å»ºä¸€ä¸ªäº‹åŠ¡ï¼Œæˆ–è€…ä½•æ—¶ä½¿ç”¨å·²æœ‰çš„äº‹åŠ¡ï¼šä¼ æ’­è¡Œä¸ºå«ä¹‰PROPAGATION_MANDATORYè¡¨ç¤ºè¯¥æ–¹æ³•å¿…é¡»åœ¨äº‹åŠ¡ä¸­è¿›è¡Œï¼Œå¦‚æžœå½“å‰äº‹åŠ¡ä¸å­˜åœ¨ï¼Œåˆ™ä¼š æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸PROPAGATION_NESTEDå¦‚æžœå½“å‰å·²å­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•åœ¨åµŒå¥—äº‹åŠ¡ä¸­è¿è¡Œã€‚ åµŒå¥—äº‹åŠ¡å¯ä»¥ç‹¬ç«‹äºŽå½“å‰äº‹åŠ¡è¿›è¡Œå•ç‹¬åœ°æäº¤æˆ–å›žæ»šã€‚å¦‚ æžœå½“å‰äº‹åŠ¡ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¡Œä¸ºå’Œ PROPAGATION_REQUIREDä¸€æ ·PROPAGATION_NEVERè¡¨ç¤ºå½“å‰æ–¹æ³•ä¸è¿è¡Œåœ¨äº‹åŠ¡ä¸Šä¸‹æ–‡ä¸­ã€‚å¦‚æžœå½“å‰æ­£æœ‰ä¸€ä¸ª äº‹åŠ¡åœ¨è¿è¡Œï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸PROPAGATION_NOT_SUPPORTEDè¡¨ç¤ºè¯¥æ–¹æ³•ä¸åº”è¯¥è¿è¡Œåœ¨äº‹åŠ¡ä¸Šä¸‹æ–‡ä¸­ï¼Œå¦‚æžœå­˜åœ¨å½“å‰äº‹ åŠ¡ï¼Œåœ¨è¯¥æ–¹æ³•è¿è¡ŒæœŸé—´ï¼Œå½“å‰äº‹åŠ¡ä¼šè¢«æŒ‚èµ·PROPAGATION_REQUIREDè¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»è¿è¡Œåœ¨äº‹åŠ¡ä¸­ï¼Œå¦‚æžœäº‹åŠ¡ä¸å­˜åœ¨ï¼Œåˆ™å¯ åŠ¨ä¸€ä¸ªæ–°çš„äº‹åŠ¡PROPAGATION_REQUIRED_NEWè¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»è¿è¡Œåœ¨å®ƒè‡ªå·±çš„äº‹åŠ¡ä¸­ã€‚ä¸€ä¸ªæ–°çš„äº‹åŠ¡ å°†å¯åŠ¨ã€‚å¦‚æžœå­˜åœ¨å½“å‰äº‹åŠ¡ï¼Œå½“å‰äº‹åŠ¡ä¼šè¢«æŒ‚èµ·PROPAGATION_SUPPORTSè¡¨ç¤ºå½“å‰æ–¹æ³•ä¸éœ€è¦äº‹åŠ¡ä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯å¦‚æžœå­˜åœ¨å½“å‰äº‹åŠ¡ çš„è¯ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•ä¼šåœ¨è¿™ä¸ªäº‹åŠ¡ä¸­è¿è¡Œ&nbsp;&nbsp;éš”ç¦»çº§åˆ«éš”ç¦»çº§åˆ«ï¼ˆisolation levelï¼‰å®šä¹‰äº†ä¸€ä¸ªäº‹åŠ¡å¯èƒ½å—å…¶ä»–å¹¶å‘äº‹åŠ¡çš„å½±å“ç¨‹åº¦ã€‚å¹¶å‘æ“ä½œç›¸åŒçš„æ•°æ®å¯èƒ½äº§ç”Ÿä¸€äº›é—®é¢˜ï¼š1.è„è¯»ï¼ˆDirty readsï¼‰â€”â€” å‘ç”Ÿåœ¨ä¸€ä¸ªäº‹åŠ¡è¯»å–äº†å¦ä¸€ä¸ªäº‹åŠ¡æ”¹å†™åŽä½†æœªæäº¤çš„æ•°æ®ï¼Œå¦‚æžœæ”¹å†™è¢«å›žæ»šäº†ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªäº‹åŠ¡èŽ·å–çš„æ•°æ®å°±æ˜¯â€œè„â€çš„ã€‚2.ä¸å¯é‡å¤è¯»ï¼ˆNonrepeatable readï¼‰â€”â€” ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œä¸¤æ¬¡ä»¥ä¸Šç›¸åŒæŸ¥è¯¢å¾—åˆ°ä¸åŒçš„æ•°æ®ã€‚è¿™é€šå¸¸æ˜¯å¦å¤–ä¸€ä¸ªäº‹åŠ¡åœ¨æ­¤æœŸé—´æ›´æ–°äº†æ•°æ®ã€‚3.å¹»è¯»ï¼ˆPhantom readï¼‰â€”â€” ä¸€ä¸ªäº‹åŠ¡è¯»å–äº†å‡ è¡Œæ•°æ®ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æ’å…¥äº†å‡ æ¡æ•°æ®ï¼Œå½“ç¬¬ä¸€ä¸ªäº‹åŠ¡å†æ¬¡è¯»å–æ—¶å‘çŽ°å¤šäº†å‡ æ¡åŽŸæœ¬æ²¡æœ‰çš„æ•°æ®ã€‚éš”ç¦»çº§åˆ«å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼šéš”ç¦»çº§åˆ«å«ä¹‰ISOLATION_DEFAULTä½¿ç”¨åŽç«¯æ•°æ®åº“é»˜è®¤çš„éš”ç¦»çº§åˆ«ISOLATION_READ_UNCOMMITTEDå…è®¸è¯»å–å°šæœªæäº¤çš„æ•°æ®è¡¨æ›´ã€‚å¯èƒ½å¯¼è‡´è„è¯»ï¼Œä¸å¯é‡å¤ è¯»ï¼Œå¹»è¯»ISOLATION_READ_COMMITTEDå…è®¸è¯»å–å¹¶å‘äº‹åŠ¡å·²ç»æäº¤çš„æ•°æ®ï¼Œå¯ä»¥é˜»æ­¢è„è¯»ï¼Œä½†ä¸ å¯é‡å¤è¯»ï¼Œå¹»è¯»ä»å¯èƒ½å‘ç”ŸISOLATION_REPEATABLE_READå¯¹åŒä¸€å­—æ®µçš„å¤šæ¬¡è¯»å–ç»“æžœä¸€è‡´ï¼Œé™¤éžæ•°æ®æ˜¯æœ¬äº‹åŠ¡è‡ªå·± ä¿®æ”¹çš„ã€‚å¯ä»¥é˜»æ­¢è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œä½†ä»å¯èƒ½å‘ç”Ÿå¹»è¯»REPEATABLE_SERIALIZABLEå®Œå…¨æœä»Žäº‹åŠ¡çš„ACIDåŽŸåˆ™ï¼Œé¿å…è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»å¯ä»¥çœ‹å‡ºï¼ŒISOLATION_READ_UNCOMMITTEDéš”ç¦»çº§åˆ«æ˜¯æœ€ä½Žçš„ï¼Œå¯èƒ½å¯¼è‡´è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»ã€‚REPEATABLE_SERIALIZABLEéš”ç¦»çº§åˆ«æœ€é«˜ï¼Œä½†æ˜¯è¿™ä¼šé™ä½Žæ•°æ®è¯»å–é€ŸçŽ‡ï¼Œå®ƒé€šå¸¸æ˜¯é€šè¿‡å®Œå…¨é”å®šäº‹åŠ¡ç›¸å…³çš„æ•°æ®åº“è¡¨æ¥å®žçŽ°çš„ã€‚åªè¯»åªè¯»ï¼ˆread-onlyï¼‰ å¦‚æžœäº‹åŠ¡åªè¯»æ•°æ®åº“è¿›è¡Œè¯»æ“ä½œï¼Œé‚£ä¹ˆè®¾ç½®è¯¥å±žæ€§ä¸ºtrueå¯ä»¥ç»™æ•°æ®åº“æ‰§è¡Œä¼˜åŒ–æŽªæ–½ã€‚å› ä¸ºåªè¯»æ˜¯åœ¨äº‹åŠ¡å¯åŠ¨ï¼Œç”±æ•°æ®åº“å®žæ–½çš„ï¼Œæ‰€ä»¥å¯¹é‚£äº›å…·å¤‡å¯åŠ¨ä¸€ä¸ªæ–°çš„äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼ˆPROPAGATION_REQUIREDï¼ŒPROPAGATION_REQUIRED_NEWå’ŒPROPAGATION_NESTEDï¼‰æ‰æœ‰æ„ä¹‰ã€‚è®¾ç½®åªè¯»è¿˜ä¼šä½¿Hibernateçš„flushæ¨¡å¼è¢«è®¾ç½®ä¸ºFLUSH_NEVERã€‚äº‹åŠ¡è¶…æ—¶è¶…æ—¶ï¼ˆtimeoutï¼‰å‡å¦‚äº‹åŠ¡è¿è¡Œæ—¶é—´è¿‡é•¿ï¼Œåˆ™ä¼šå½±å“æ•ˆçŽ‡ï¼Œæ‰€ä»¥å¯ä»¥è®¾ç½®è¶…æ—¶å±žæ€§ï¼Œè¶…æ—¶åŽæ‰§è¡Œè‡ªåŠ¨å›žæ»šã€‚å› ä¸ºè¶…æ—¶æ—¶é’Ÿä¼šåœ¨äº‹åŠ¡å¼€å¯æ—¶å¯åŠ¨ï¼Œæ‰€ä»¥åªæœ‰å¯¹é‚£äº›å…·å¤‡å¯åŠ¨ä¸€ä¸ªæ–°çš„äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼ˆPROPAGATION_REQUIREDï¼ŒPROPAGATION_REQUIRED_NEWå’ŒPROPAGATION_NESTEDï¼‰æ‰æœ‰æ„ä¹‰ã€‚å›žæ»šåŽŸåˆ™é»˜è®¤æƒ…å†µé‡åˆ°è¿è¡ŒæœŸå¼‚å¸¸å°±å›žæ»šã€‚å›žæ»šåŽŸåˆ™å¯ä»¥å®šä¹‰é‡åˆ°å“ªäº›å¼‚å¸¸ä¸å›žæ»šã€‚XMLä¸­å®šä¹‰äº‹åŠ¡ä½¿ç”¨txå‘½åç©ºé—´é…ç½®ï¼š123456&lt;tx:advice id="txAdvice" transaction-manager="transactionManager"&gt; &lt;tx:attributes&gt; &lt;tx:method name="add*" propagation="REQUIRED"/&gt; &lt;tx:method name="*" propagation="SUPPORTS" read-only="true"/&gt; &lt;/tx:attributes&gt;&lt;/tx:advice&gt;transaction-managerä¸ºä¸Šè¿°çš„äº‹åŠ¡ç®¡ç†å™¨ã€‚&lt;tx:method&gt;å…ƒç´ ä¸ºæŸä¸ªï¼ˆæŸäº›ï¼‰nameå±žæ€§æŒ‡å®šçš„æ–¹æ³•å®šä¹‰äº‹åŠ¡å‚æ•°ã€‚&lt;tx:method&gt;æœ‰å¤šä¸ªå±žæ€§æ¥å¸®åŠ©å®šä¹‰æ–¹æ³•çš„äº‹åŠ¡ç­–ç•¥ï¼Œè¿™äº›å±žæ€§å¯¹äºŽä¸Šè¿°çš„äº‹åŠ¡äº”å¤§å±žæ€§ï¼šå±žæ€§å«ä¹‰isolationæŒ‡å®šéš”ç¦»çº§åˆ«propagationæŒ‡å®šä¼ æ’­åŽŸåˆ™read-onlyæŒ‡å®šäº‹åŠ¡ä¸ºåªè¯»å›žæ»šåŽŸåˆ™ï¼šrollback-forno-rollback-forrollback-foræŒ‡å®šäº‹åŠ¡ä¸ºå“ªäº›æ£€æŸ¥åž‹å¼‚å¸¸å›žæ»šno-rollback-foræŒ‡å®šäº‹åŠ¡å¯¹å“ªäº›å¼‚å¸¸ç»§ç»­è¿è¡Œè€Œä¸å›žæ»štimeoutè®¾å®šäº‹åŠ¡è¶…æ—¶æ—¶é—´æˆ‘ä»¬è¿˜éœ€è®¾å®šå“ªäº›Beanåº”è¯¥è¢«é€šçŸ¥ï¼Œä½¿ç”¨aopå®šä¹‰ä¸€ä¸ªé€šçŸ¥å™¨ï¼ˆadvisorï¼‰ï¼š12345&lt;aop:config&gt; &lt;aop:advisor pointcut="execution(* *..UserDaoImpl.*(..))" advice-ref="txAdvice"/&gt;&lt;/aop:config&gt;advice-refå±žæ€§å¼•ç”¨äº†åä¸ºtxAdviceçš„é€šçŸ¥ã€‚çŽ°åœ¨æµ‹è¯•æ·»åŠ äº‹åŠ¡åŽçš„addUser()æ–¹æ³•ï¼š123456789101112public class TestTransaction &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); UserDao dao=ac.getBean("userDao",UserDao.class); User u=new User(); u.setName("testTx"); u.setAge("30"); u.setPassword("123456"); dao.addUser(u); &#125;&#125;æŽ§åˆ¶å°æŠ›å‡ºå¼‚å¸¸ï¼š12Exception in thread "main" java.lang.NullPointerException at com.spring.dao.UserDaoImpl.addUser(UserDaoImpl.java:51)æŸ¥è¯¢æ•°æ®ï¼š123456SQL&gt; select * from lzp.userinfo; USERI NAME AGE PWD----- ---------- --- ----------8 testUser 24 1234564 SCOTT 25 123456å¯ä»¥å‘çŽ°testTxå¹¶æ²¡æœ‰è¢«æ’å…¥ã€‚æ³¨è§£äº‹åŠ¡é™¤äº†ä½¿ç”¨XMLå®šä¹‰äº‹åŠ¡ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ³¨è§£äº‹åŠ¡ï¼Œé€šè¿‡å£°æ˜Žï¼š1&lt;tx:annotation-driven transaction-manager="transactionManager"/&gt;&lt;tx:annotation-driven&gt;å‘Šè¯‰Springæ£€æŸ¥ä¸Šä¸‹æ–‡ä¸­æ‰€æœ‰ä½¿ç”¨@Transactionæ³¨è§£çš„Beanï¼Œä¸ç®¡è¿™ä¸ªæ³¨è§£æ˜¯åœ¨ç±»çº§åˆ«ä¸Šè¿˜æ˜¯æ–¹æ³•çº§åˆ«ä¸Šã€‚ä½¿ç”¨æ³¨è§£ä¿®æ”¹UserDaoImplï¼š12345678910111213141516@Repository("userDao")@Transactional(propagation=Propagation.SUPPORTS,readOnly=true)public class UserDaoImpl implements UserDao &#123; //... @Transactional(propagation=Propagation.REQUIRED,readOnly=false) public void addUser(User user) &#123; Map&lt;String, Object&gt; params=new HashMap&lt;String, Object&gt;(); params.put("name", user.getName()); params.put("age", user.getAge()); params.put("pwd", user.getPassword()); jdbcTemplate.update(SQL_INSERT_USER, params); String a=null; a.toString(); &#125; //...&#125;å†æ¬¡è¿è¡ŒtestTransaction()æ–¹æ³•ï¼ŒæŠ›å‡ºå¼‚å¸¸åŽæŸ¥è¯¢æ•°æ®åº“ï¼š123456SQL&gt; select * from lzp.userinfo; USERI NAME AGE PWD----- ---------- --- ----------8 testUser 24 1234564 SCOTT 25 123456å¯å‘çŽ°å’ŒXMLé…ç½®äº‹åŠ¡æ•ˆæžœæ˜¯ä¸€æ ·çš„ã€‚ã€ŠSpring In Actionã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å„è¿›åˆ¶æ•°çš„è½¬æ¢]]></title>
    <url>%2F%E5%90%84%E8%BF%9B%E5%88%B6%E6%95%B0%E7%9A%84%E8%BD%AC%E6%8D%A2.html</url>
    <content type="text"><![CDATA[æ€»ç»“å¤‡å¿˜ã€‚åè¿›åˆ¶è½¬äºŒè¿›åˆ¶æ–¹æ³•ä¸ºï¼šåè¿›åˆ¶æ•°é™¤2å–ä½™æ³•ï¼Œå³åè¿›åˆ¶æ•°é™¤2ï¼Œä½™æ•°ä¸ºæƒä½ä¸Šçš„æ•°ï¼Œå¾—åˆ°çš„å•†å€¼ç»§ç»­é™¤2ï¼Œä¾æ­¤æ­¥éª¤ç»§ç»­å‘ä¸‹è¿ç®—ç›´åˆ°å•†ä¸º0ä¸ºæ­¢ã€‚12345678217/2 = 108 ---- 1108/2 = 54 ---- 054/2 = 27 ---- 027/2 = 13 ---- 113/2 = 6 ---- 16/2 = 3 ---- 03/2 = 1 ---- 11/2 = 0 ---- 1æ‰€ä»¥åè¿›åˆ¶217è½¬äºŒè¿›åˆ¶æ•°ä¸º 11011001ã€‚jsè½¬æ¢ï¼š12&gt; parseInt("217").toString(2);&gt; "11011001"äºŒè¿›åˆ¶è½¬åè¿›åˆ¶æ–¹æ³•ä¸ºï¼šæŠŠäºŒè¿›åˆ¶æ•°æŒ‰æƒå±•å¼€ã€ç›¸åŠ å³å¾—åè¿›åˆ¶æ•°ã€‚$$ 11011001=1\times2^0+1\times2^3+1\times2^4+1\times2^6+1\times2^7=1+8+16+64+128=217 $$jsè½¬æ¢ï¼š12&gt; parseInt("11011001",2);&gt; 217äºŒè¿›åˆ¶è½¬å…«è¿›åˆ¶æ–¹æ³•ä¸ºï¼š3ä½äºŒè¿›åˆ¶æ•°æŒ‰æƒå±•å¼€ç›¸åŠ å¾—åˆ°1ä½å…«è¿›åˆ¶æ•°ã€‚ï¼ˆæ³¨æ„äº‹é¡¹ï¼Œ3ä½äºŒè¿›åˆ¶è½¬æˆå…«è¿›åˆ¶æ˜¯ä»Žå³åˆ°å·¦å¼€å§‹è½¬æ¢ï¼Œä¸è¶³æ—¶è¡¥0ï¼‰ã€‚$$ 11011001=(011)(011)(001)=(1\times2^0+1\times2^1)(t\times2^0+1\times2^1)(t\times2^0)=331 $$jsè½¬æ¢ï¼š12&gt; parseInt("11011001",2).toString(8);&gt; "331"å…«è¿›åˆ¶è½¬äºŒè¿›åˆ¶æ–¹æ³•ä¸ºï¼šå…«è¿›åˆ¶æ•°æ¯ä¸ªä½ä¸Šçš„æ•°åˆ†åˆ«è½¬æ¢ä¸ºä¸‰ä½äºŒè¿›åˆ¶ï¼Œé¡ºåºä»Žå³å¾€å·¦ã€‚$$ 331=(3)(3)(1)=(011)(011)(001)=11011001 $$jsè½¬æ¢ï¼š12&gt; parseInt('331',8).toString(2);&gt; "11011001"äºŒè¿›åˆ¶è½¬åå…­è¿›åˆ¶æ–¹æ³•ä¸ºï¼šä¸ŽäºŒè¿›åˆ¶è½¬å…«è¿›åˆ¶æ–¹æ³•è¿‘ä¼¼ï¼Œå…«è¿›åˆ¶æ˜¯å–ä¸‰åˆä¸€ï¼Œåå…­è¿›åˆ¶æ˜¯å–å››åˆä¸€ã€‚ï¼ˆæ³¨æ„äº‹é¡¹ï¼Œ4ä½äºŒè¿›åˆ¶è½¬æˆåå…­è¿›åˆ¶æ˜¯ä»Žå³åˆ°å·¦å¼€å§‹è½¬æ¢ï¼Œä¸è¶³æ—¶è¡¥0ï¼‰ã€‚$$ 11011001=(1101)(1001)=(1\times2^0+1\times2^2+1\times2^3)(1\times2^0+1\times2^3)=(13)(9)=d9 $$jsè½¬æ¢ï¼š12&gt; parseInt('11011001',2).toString(16);&gt; "d9"åå…­è¿›åˆ¶è½¬äºŒè¿›åˆ¶æ–¹æ³•ä¸ºï¼šåå…­è¿›åˆ¶æ•°æ¯ä¸ªä½ä¸Šçš„æ•°åˆ†åˆ«è½¬æ¢ä¸ºå››ä½äºŒè¿›åˆ¶ï¼Œé¡ºåºä»Žå³å¾€å·¦ã€‚$$ d9=(d)(9)=(13)(9)=(1101)(1001)=11011001 $$jsè½¬æ¢ï¼š12&gt; parseInt('d9',16).toString(2);&gt; "11011001"åè¿›åˆ¶è½¬å…«è¿›åˆ¶æ–¹æ³•å’Œåè¿›åˆ¶è½¬äºŒè¿›åˆ¶ç±»ä¼¼ï¼š123150/8 = 18 ---- 618/8 = 2 ---- 22/8 = 0 ---- 2jsè½¬æ¢ï¼š12&gt; parseInt(150).toString(8);&gt; "226"å…«è¿›åˆ¶è½¬åè¿›åˆ¶æ–¹æ³•ï¼šæŠŠå…«è¿›åˆ¶æ•°æŒ‰æƒå±•å¼€ã€ç›¸åŠ å³å¾—åè¿›åˆ¶æ•°ã€‚$$ 226=2\times8^2+2\times8^1+6\times8^0=128=16=6=150 $$jsè½¬æ¢ï¼š12&gt; parseInt('226',8);&gt; 150åè¿›åˆ¶è½¬åå…­è¿›åˆ¶æ–¹æ³•å’Œåè¿›åˆ¶è½¬äºŒè¿›åˆ¶ç±»ä¼¼ï¼š12150/16 = 9 ---- 69/16 = 0 ---- 9jsè½¬æ¢ï¼š12&gt; parseInt(150).toString(16);&gt; "96"åå…­è¿›åˆ¶è½¬åè¿›åˆ¶æ–¹æ³•ï¼šæŠŠå…«è¿›åˆ¶æ•°æŒ‰æƒå±•å¼€ã€ç›¸åŠ å³å¾—åè¿›åˆ¶æ•°ã€‚$$ 96=9\times16^1+6\times16^0=144+16=150 $$jsè½¬æ¢ï¼š12&gt; parseInt('96',16);&gt; 150]]></content>
      <tags>
        <tag>è¿›åˆ¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring SimpleJdbcTemplate]]></title>
    <url>%2FSpring-SimpleJdbcTemplate.html</url>
    <content type="text"><![CDATA[Springæä¾›äº†JDBCæ¨¡æ¿ï¼Œä»£æ›¿äº†JDBCç¹çæ“ä½œã€‚ä½¿ç”¨Spring JDBCæ¨¡æ¿æˆ‘ä»¬ä¸å†éœ€è¦æ‰‹åŠ¨åŽ»å…³é—­è¿žæŽ¥ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸ä¹Ÿæ›´ä¸ºæ˜Žç¡®ã€‚å‡†å¤‡å·¥ä½œæ•°æ®åº“åˆ›å»ºè¡¨ï¼š123456create table userinfo ( userid varchar2(5) not null, name varchar2(10), age varchar2(3), pwd varchar2(10))åˆ›å»ºåºåˆ—ï¼š1create sequence user_seq start with 1 increment by 1;é…ç½®æ•°æ®æºè¿žæŽ¥æ± æ–°å»ºä¸€ä¸ªæ•°æ®åº“é…ç½®æ–‡ä»¶db.propertiesï¼š123username=oraclepassword=123456url=jdbc:oracle:thin:/localhost:1521/orclåœ¨Springé…ç½®æ–‡ä»¶è¯»å–db.properties1&lt;util:properties id="db" location="classpath:db.properties" /&gt;é…ç½®è¿žæŽ¥æ± ï¼š1234567891011&lt;bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"&gt; &lt;property name="driverClassName" value="oracle.jdbc.OracleDriver"/&gt; &lt;!-- SpELè¯»å– --&gt; &lt;property name="url" value="#&#123;db.url&#125;"/&gt; &lt;property name="username" value="#&#123;db.username&#125;"/&gt; &lt;property name="password" value="#&#123;db.password&#125;"/&gt; &lt;property name="initialSize" value="5"/&gt; &lt;property name="maxActive" value="10"/&gt;&lt;/bean&gt;é™¤äº†ä¸Šè¿°é…ç½®å±žæ€§ï¼Œä¸‹è¡¨åˆ—å‡ºäº†BasicDataSourceçš„ä¸€äº›å¸¸ç”¨å±žæ€§ï¼šæ± é…ç½®å±žæ€§æ‰€æŒ‡å®šçš„å†…å®¹initialSizeæ± å¯åŠ¨æ—¶åˆ›å»ºçš„è¿žæŽ¥æ•°é‡maxActiveåŒä¸€æ—¶é—´å¯ä»¥ä»Žæ± ä¸­åˆ†é…çš„æœ€å¤šè¿žæŽ¥æ•°ï¼Œå¦‚æžœè®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºæ— é™åˆ¶maxIdleæ± é‡Œä¸ä¼šè¢«é‡Šæ”¾çš„æœ€å¤šç©ºé—²è¿žæŽ¥æ•°ã€‚å¦‚æžœè®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºæ— é™åˆ¶maxOpenPreparedStatementsåœ¨åŒä¸€æ—¶é—´èƒ½å¤Ÿä»Žè¯­å¥æ± ä¸­åˆ†é…çš„é¢„å¤„ç†è¯­å¥çš„æœ€å¤§æ•°é‡ã€‚å¦‚æžœè®¾ç½® ä¸º0ï¼Œè¡¨ç¤ºæ— é™åˆ¶maxWaitåœ¨æŠ›å‡ºå¼‚å¸¸ä¹‹å‰ï¼Œæ± ç­‰å¾…è¿žæŽ¥å›žæ”¶çš„æœ€å¤§æ—¶é—´ (å½“æ²¡æœ‰å¯ç”¨è¿žæŽ¥æ—¶)ã€‚ å¦‚æžœè®¾ç½®ä¸º-1ï¼Œè¡¨ç¤ºæ— é™ç­‰å¾…minEvictableIdleTimeMillisè¿žæŽ¥åœ¨æ± ä¸­ä¿æŒç©ºé—²è€Œä¸è¢«å›žæ”¶çš„æœ€å¤§æ—¶é—´minIdleåœ¨ä¸åˆ›å»ºæ–°è¿žæŽ¥çš„æƒ…å†µä¸‹ï¼Œæ± ä¸­ä¿æŒç©ºé—²çš„æœ€å°è¿žæŽ¥æ•°poolPreparedStatementsæ˜¯å¦å¯¹é¢„å¤„ç†è¯­å¥è¿›è¡Œæ± ç®¡ç†ï¼ˆå¸ƒå°”ç±»åž‹ï¼‰ä½¿ç”¨JdbcTemplateåœ¨Springé…ç½®æ–‡ä»¶ä¸­é…ç½®JdbcTemplateï¼š1234&lt;bean id="jdbcTemplate" class="org.springframework.jdbc.core.simple.SimpleJdbcTemplate"&gt; &lt;constructor-arg ref="dataSource"/&gt;&lt;/bean&gt;æ–°å»ºä¸€ä¸ªUserç±»ï¼Œç”¨äºŽå­˜å‚¨æŸ¥è¯¢ç»“æžœï¼š1234567public class User &#123; private Integer userId; private String name; private String age; private String password; // get,setç•¥&#125;æ–°å»ºUserDao interfaceï¼Œå®šä¹‰åŸºæœ¬çš„å¢žåˆ æ”¹æŸ¥æ–¹æ³•ï¼š1234567public interface UserDao &#123; void addUser(User user); void deleteUser(Integer userId); void updateUser(User user); User selectUser(Integer userId); List&lt;User&gt; selectAll();&#125;æ–°å»ºUserDaoå®žçŽ°ç±»UserDaoImplï¼š12345678// DAOæ³¨è§£@Repository("userDao")public class UserDaoImpl implements UserDao &#123; // æ³¨å…¥JdbcTemplate @Resource private SimpleJdbcTemplate jdbcTemplate; // ......&#125;å¢žåŠ ç”¨æˆ·å®žçŽ°addUser()æ–¹æ³•ï¼š12345678910private static final String SQL_INSERT_USER = "insert into userinfo (userid,name,age,pwd) " + "values (user_seq.nextval,?,?,?)";public void addUser(User user) &#123; Object[] params = &#123; user.getName(), user.getAge(), user.getPassword() &#125;; jdbcTemplate.update(SQL_INSERT_USER, params);&#125;ä¸Šè¿°SQLä½¿ç”¨äº†ç´¢å¼•å‚æ•°ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬ä¸å¾—ä¸ä¸¥æ ¼æŒ‰ç…§å‚æ•°çš„é¡ºåºæ¥å®šä¹‰å‚æ•°ã€‚SimpleJdbcTemplateæ”¯æŒä½¿ç”¨å‘½åå‚æ•°çš„SQLã€‚ä¿®æ”¹addUser()æ–¹æ³•ï¼š12345678910private static final String SQL_INSERT_USER = "insert into userinfo (userid,name,age,pwd) " + "values (user_seq.nextval,:name,:age,:pwd)";public void addUser(User user) &#123; Map&lt;String, Object&gt; params=new HashMap&lt;String, Object&gt;(); params.put("name", user.getName()); params.put("age", user.getAge()); params.put("pwd", user.getPassword()); jdbcTemplate.update(SQL_INSERT_USER, params);&#125;çŽ°åœ¨ï¼Œå‚æ•°çš„é¡ºåºå·²ç»ä¸é‡è¦äº†ï¼Œåªè¦å‚æ•°åç§°å¯¹åº”ä¸Šå°±è¡Œã€‚æµ‹è¯•ï¼š123456789101112public class TestJdbc &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); UserDao dao=ac.getBean("userDao",UserDao.class); User user=new User(); user.setName("SCOTT"); user.setAge("25"); user.setPassword("123456"); dao.addUser(user); &#125;&#125;æŸ¥è¯¢æ•°æ®åº“ï¼š12345SQL&gt; select * from lzp.userinfo where name='SCOTT'; USERI NAME AGE PWD----- ---------- --- ----------5 SCOTT 25 123456åˆ é™¤ç”¨æˆ·å®žçŽ°deleteUser()æ–¹æ³•ï¼š12345private static final String SQL_DELETE_USER = "delete from userinfo where userid=?";public void deleteUser(Integer userId) &#123; jdbcTemplate.update(SQL_DELETE_USER, userId);&#125;æµ‹è¯•ï¼š12345678public class TestJdbc &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); UserDao dao=ac.getBean("userDao",UserDao.class); dao.deleteUser(5); &#125;&#125;æŸ¥è¯¢æ•°æ®åº“ï¼ŒSCOTTå·²è¢«åˆ é™¤ï¼š123456SQL&gt; select * from lzp.userinfo; USERI NAME AGE PWD----- ---------- --- ----------6 JANE 24 1234567 MIKE 28 123456æŸ¥è¯¢å•ä¸ªç”¨æˆ·å®žçŽ°selectUser()æ–¹æ³•ï¼š1234567891011121314151617private static final String SQL_SELECT_USER = "select * from userinfo where userid = ?";public User selectUser(Integer userId) &#123; return jdbcTemplate.queryForObject( SQL_SELECT_USER, new ParameterizedRowMapper&lt;User&gt;() &#123; public User mapRow(ResultSet rs, int rowNum) throws SQLException &#123; User user = new User(); user.setUserId(rs.getInt("userId")); user.setName(rs.getString("name")); user.setAge(rs.getString("age")); user.setPassword(rs.getString("pwd")); return user; &#125; &#125;, userId);&#125;æµ‹è¯•ï¼š1234567891011public class TestJdbc &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); UserDao dao=ac.getBean("userDao",UserDao.class); User user=new User(); user=dao.selectUser(6); System.out.println(user.getName()); // JANE &#125;&#125;æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·å®žçŽ°selectAll()æ–¹æ³•ï¼š12345678910111213141516private static final String SQL_SELECT_All_USER = "select * from userinfo"; public List&lt;User&gt; selectAll() &#123; return jdbcTemplate.query( SQL_SELECT_All_USER, new ParameterizedRowMapper&lt;User&gt;() &#123; public User mapRow(ResultSet rs, int rowNum) throws SQLException &#123; User user = new User(); user.setUserId(rs.getInt("userId")); user.setName(rs.getString("name")); user.setAge(rs.getString("age")); user.setPassword(rs.getString("pwd")); return user; &#125; &#125;);&#125;æµ‹è¯•ï¼š1234567891011public class TestJdbc &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); UserDao dao=ac.getBean("userDao",UserDao.class); List&lt;User&gt; list=dao.selectAll(); for(User u:list)&#123; System.out.println(u.getName()); &#125; &#125;&#125;è¾“å‡ºï¼š12JANEMIKEä¿®æ”¹ç”¨æˆ·å®žçŽ°updateUser()æ–¹æ³•ï¼š12345678private static final String SQL_UPDATE_USER = "update userinfo set age=:age where userid=:userid";public void updateUser(User user) &#123; Map&lt;String, Object&gt; params=new HashMap&lt;String, Object&gt;(); params.put("userid", user.getUserId()); params.put("age", user.getAge()); jdbcTemplate.update(SQL_UPDATE_USER, params);&#125;æµ‹è¯•ï¼š1234567891011public class TestJdbc &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); UserDao dao=ac.getBean("userDao",UserDao.class); User user=new User(); user.setUserId(6); user.setAge("100"); dao.updateUser(user); &#125;&#125;æŸ¥è¯¢æ•°æ®åº“ï¼Œå¯å‘çŽ°å€¼å·²è¢«ä¿®æ”¹ï¼š123456SQL&gt; select * from lzp.userinfo; USERI NAME AGE PWD----- ---------- --- ----------6 JANE 100 1234567 MIKE 28 123456Spring JDBC DAOæ”¯æŒç±»é™¤äº†å‘DAOä¸­æ³¨å…¥simpleJdbcTemplateå¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç»§æ‰¿Springæä¾›çš„SimpleJdbcDaoSupportç±»ï¼š123public class UserDaoImpl extends SimpleJdbcDaoSupport implements UserDao &#123; //... &#125;èŽ·å–simpleJdbcTemplateå¯¹è±¡å¯é€šè¿‡é™æ€æ–¹æ³•ï¼šgetSimpleJdbcTemplate()ã€‚ã€ŠSpring In Actionã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQuery äº‹ä»¶å‡½æ•°]]></title>
    <url>%2FjQuery-%E4%BA%8B%E4%BB%B6%E5%87%BD%E6%95%B0.html</url>
    <content type="text"><![CDATA[é¡µé¢è½½å…¥ready()å½“DOMè½½å…¥å°±ç»ªå¯ä»¥æŸ¥è¯¢åŠæ“çºµæ—¶ç»‘å®šä¸€ä¸ªè¦æ‰§è¡Œçš„å‡½æ•°ã€‚è¿™ä¸ªæ–¹æ³•çº¯ç²¹æ˜¯å¯¹å‘window.loadäº‹ä»¶æ³¨å†Œäº‹ä»¶çš„æ›¿ä»£æ–¹æ³•ã€‚æœ‰ä¸€ä¸ªå‚æ•°å¯¹jQueryå‡½æ•°çš„å¼•ç”¨ä¼šä¼ é€’åˆ°è¿™ä¸ªreadyäº‹ä»¶å¤„ç†å‡½æ•°ä¸­ã€‚å¯ä»¥ç»™è¿™ä¸ªå‚æ•°ä»»æ„èµ·ä¸€ä¸ªåå­—ï¼Œå¹¶å› æ­¤å¯ä»¥ä¸å†æ‹…å¿ƒå‘½åå†²çªè€Œæ”¾å¿ƒåœ°ä½¿ç”¨$åˆ«åã€‚å¯ä»¥åœ¨åŒä¸€ä¸ªé¡µé¢ä¸­æ— é™æ¬¡åœ°ä½¿ç”¨$(document).ready()äº‹ä»¶ã€‚å…¶ä¸­æ³¨å†Œçš„å‡½æ•°ä¼šæŒ‰ç…§ï¼ˆä»£ç ä¸­çš„ï¼‰å…ˆåŽé¡ºåºä¾æ¬¡æ‰§è¡Œã€‚ç¤ºä¾‹ï¼šåœ¨DOMåŠ è½½å®Œæˆæ—¶è¿è¡Œçš„ä»£ç ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š123$(document).ready(function()&#123; // åœ¨è¿™é‡Œå†™ä½ çš„ä»£ç ...&#125;);ä½¿ç”¨ $(document).ready() çš„ç®€å†™ï¼ŒåŒæ—¶å†…éƒ¨çš„ jQuery ä»£ç ä¾ç„¶ä½¿ç”¨ $ ä½œä¸ºåˆ«åï¼Œè€Œä¸ç®¡å…¨å±€çš„ $ æ˜¯ä»€ä¹ˆã€‚123$(function($) &#123; // ä½ å¯ä»¥åœ¨è¿™é‡Œç»§ç»­ä½¿ç”¨$ä½œä¸ºåˆ«å...&#125;); â€‹äº‹ä»¶å¤„ç†on(eve,[sel],[data],fn)on()æ–¹æ³•åœ¨è¢«é€‰å…ƒç´ åŠå­å…ƒç´ ä¸Šæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶å¤„ç†ç¨‹åºã€‚è‡ª jQuery ç‰ˆæœ¬ 1.7 èµ·ï¼Œon() æ–¹æ³•æ˜¯ bind()ã€live() å’Œ delegate() æ–¹æ³•çš„æ–°çš„æ›¿ä»£å“ã€‚è¯¥æ–¹æ³•ç»™ API å¸¦æ¥å¾ˆå¤šä¾¿åˆ©ï¼Œæˆ‘ä»¬æŽ¨èä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå®ƒç®€åŒ–äº† jQuery ä»£ç åº“ã€‚è¯­æ³•ï¼š1$(selector).on(event,childSelector,data,function,map)å‚æ•°æè¿°eventå¿…éœ€ã€‚è§„å®šè¦ä»Žè¢«é€‰å…ƒç´ ç§»é™¤çš„ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶æˆ–å‘½åç©ºé—´ã€‚ç”±ç©ºæ ¼åˆ†éš”å¤šä¸ªäº‹ä»¶å€¼ã€‚å¿…é¡»æ˜¯æœ‰æ•ˆçš„äº‹ä»¶ã€‚childSelectorå¯é€‰ã€‚è§„å®šåªèƒ½æ·»åŠ åˆ°æŒ‡å®šçš„å­å…ƒç´ ä¸Šçš„äº‹ä»¶å¤„ç†ç¨‹åºï¼ˆä¸”ä¸æ˜¯é€‰æ‹©å™¨æœ¬èº«ï¼Œæ¯”å¦‚å·²åºŸå¼ƒçš„ delegate() æ–¹æ³•ï¼‰ã€‚dataå¯é€‰ã€‚è§„å®šä¼ é€’åˆ°å‡½æ•°çš„é¢å¤–æ•°æ®ã€‚functionå¯é€‰ã€‚è§„å®šå½“äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œçš„å‡½æ•°ã€‚mapè§„å®šäº‹ä»¶æ˜ å°„ ( {event:function, event:function, â€¦}) ï¼ŒåŒ…å«è¦æ·»åŠ åˆ°å…ƒç´ çš„ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶ï¼Œä»¥åŠå½“äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œçš„å‡½æ•°ã€‚ç¤ºä¾‹ï¼šå•å‡»æ–‡æœ¬æ—¶ï¼Œæ˜¾ç¤ºæ–‡æœ¬çš„å†…å®¹ï¼š123$("p").on("click", function()&#123; alert( $(this).text() );&#125;);å–æ¶ˆè¡¨å•æäº¤æ“ä½œï¼Œå¹¶é€šè¿‡è¿”å›žfalseé˜²æ­¢äº‹ä»¶å†’æ³¡ï¼š1$("form").on("submit", false)é€šè¿‡ä½¿ç”¨.preventDefault()å–æ¶ˆé»˜è®¤æ“ä½œï¼š123$("form").on("submit", function(event) &#123; event.preventDefault();&#125;);ä½¿ç”¨.stopPropagation()åœæ­¢äº‹ä»¶å†’æ³¡ï¼Œè€Œä¸ä¼šé˜»æ­¢è¡¨å•æäº¤ï¼š123$("form").on("submit", function(event) &#123; event.stopPropagation();&#125;);off(eve,[sel],[fn])off() æ–¹æ³•é€šå¸¸ç”¨äºŽç§»é™¤é€šè¿‡ on() æ–¹æ³•æ·»åŠ çš„äº‹ä»¶å¤„ç†ç¨‹åºã€‚è‡ª jQuery ç‰ˆæœ¬ 1.7 èµ·ï¼Œoff() æ–¹æ³•æ˜¯ unbind()ã€die() å’Œ undelegate() æ–¹æ³•çš„æ–°çš„æ›¿ä»£å“ã€‚è¯¥æ–¹æ³•ç»™ API å¸¦æ¥å¾ˆå¤šä¾¿åˆ©ï¼Œæˆ‘ä»¬æŽ¨èä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå®ƒç®€åŒ–äº† jQuery ä»£ç åº“ã€‚è¯­æ³•ï¼š1$(selector).off(event,selector,function(eventObj),map)å‚æ•°æè¿°eventå¿…éœ€ã€‚è§„å®šè¦ä»Žè¢«é€‰å…ƒç´ ç§»é™¤çš„ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶æˆ–å‘½åç©ºé—´ã€‚ç”±ç©ºæ ¼åˆ†éš”å¤šä¸ªäº‹ä»¶å€¼ã€‚å¿…é¡»æ˜¯æœ‰æ•ˆçš„äº‹ä»¶ã€‚selectorå¯é€‰ã€‚è§„å®šæ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºæ—¶æœ€åˆä¼ é€’ç»™ on() æ–¹æ³•çš„é€‰æ‹©å™¨ã€‚function(eventObj)å¯é€‰ã€‚è§„å®šå½“äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œçš„å‡½æ•°ã€‚mapè§„å®šäº‹ä»¶æ˜ å°„ ( {event:function, event:function, â€¦}) ï¼ŒåŒ…å«è¦æ·»åŠ åˆ°å…ƒç´ çš„ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶ï¼Œä»¥åŠå½“äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œçš„å‡½æ•°ã€‚ç¤ºä¾‹ï¼šä»Žæ‰€æœ‰æ®µè½ä¸­åˆ é™¤æ‰€æœ‰äº‹ä»¶å¤„ç†å‡½æ•°ï¼š1$("p").off()ä»Žæ‰€æœ‰æ®µè½ä¸­åˆ é™¤æ‰€æœ‰å•å‡»å‡½æ•°ï¼š1$("p").off( "click", "**" )é€šè¿‡ä¼ é€’ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œåªåˆ é™¤ä¸€ä¸ªå…ˆå‰ç»‘å®šçš„å¤„ç†å‡½æ•°ï¼š12345678910var foo = function () &#123; // code to handle some kind of event&#125;; // ... now foo will be called when paragraphs are clicked ...$("body").on("click", "p", foo); // ... foo will no longer be called.$("body").off("click", "p", foo);é€šè¿‡å…¶å‘½åç©ºé—´è§£é™¤æ‰€æœ‰å§”æ´¾çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼š123456789101112var validate = function () &#123; // code to validate form entries&#125;; // delegate events under the ".validator" namespace$("form").on("click.validator", "button", validate); $("form").on("keypress.validator", "input[type='text']", validate); // remove event handlers in the ".validator" namespace $("form").off(".validator");bind(type,[data],fn)ä¸ºæ¯ä¸ªåŒ¹é…å…ƒç´ çš„ç‰¹å®šäº‹ä»¶ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°ã€‚ä¸Žå…¶ç›¸åçš„å‡½æ•°ä¸ºunbind()ã€‚è¯­æ³•ï¼š1$(selector).bind(event,data,function,map)å‚æ•°æè¿°eventå¿…éœ€ã€‚è§„å®šæ·»åŠ åˆ°å…ƒç´ çš„ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶ã€‚ç”±ç©ºæ ¼åˆ†éš”å¤šä¸ªäº‹ä»¶å€¼ã€‚å¿…é¡»æ˜¯æœ‰æ•ˆçš„äº‹ä»¶ã€‚dataå¯é€‰ã€‚è§„å®šä¼ é€’åˆ°å‡½æ•°çš„é¢å¤–æ•°æ®ã€‚functionå¿…éœ€ã€‚è§„å®šå½“äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œçš„å‡½æ•°ã€‚mapè§„å®šäº‹ä»¶æ˜ å°„ ( {event:function, event:function, â€¦}) ï¼ŒåŒ…å«è¦æ·»åŠ åˆ°å…ƒç´ çš„ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶ï¼Œä»¥åŠå½“äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œçš„å‡½æ•°ã€‚ç¤ºä¾‹ï¼šå½“æ¯ä¸ªæ®µè½è¢«ç‚¹å‡»çš„æ—¶å€™ï¼Œå¼¹å‡ºå…¶æ–‡æœ¬ï¼š123$("p").bind("click", function()&#123; alert( $(this).text() );&#125;);åŒæ—¶ç»‘å®šå¤šä¸ªäº‹ä»¶ç±»åž‹ï¼š123$('#foo').bind('mouseenter mouseleave', function() &#123; $(this).toggleClass('entered');&#125;);åŒæ—¶ç»‘å®šå¤šä¸ªäº‹ä»¶ç±»åž‹/å¤„ç†ç¨‹åºï¼š12345$("button").bind(&#123; click:function()&#123;$("p").slideToggle();&#125;, mouseover:function()&#123;$("body").css("background-color","red");&#125;, mouseout:function()&#123;$("body").css("background-color","#FFFFFF");&#125; &#125;);ä½ å¯ä»¥åœ¨äº‹ä»¶å¤„ç†ä¹‹å‰ä¼ é€’ä¸€äº›é™„åŠ çš„æ•°æ®ï¼š1234function handler(event) &#123; alert(event.data.foo);&#125;$("p").bind("click", &#123;foo: "bar"&#125;, handler);é€šè¿‡è¿”å›žfalseæ¥å–æ¶ˆé»˜è®¤çš„è¡Œä¸ºå¹¶é˜»æ­¢äº‹ä»¶èµ·æ³¡ï¼š1$("form").bind("submit", function() &#123; return false; &#125;)é€šè¿‡ä½¿ç”¨ preventDefault() æ–¹æ³•åªå–æ¶ˆé»˜è®¤çš„è¡Œä¸ºï¼š123$("form").bind("submit", function(event)&#123; event.preventDefault();&#125;);é€šè¿‡ä½¿ç”¨ stopPropagation() æ–¹æ³•åªé˜»æ­¢ä¸€ä¸ªäº‹ä»¶èµ·æ³¡ï¼š123$("form").bind("submit", function(event)&#123; event.stopPropagation();&#125;); â€‹one(type,[data],fn)one() æ–¹æ³•ä¸ºè¢«é€‰å…ƒç´ æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¹¶è§„å®šå½“äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œçš„å‡½æ•°ã€‚å½“ä½¿ç”¨ one() æ–¹æ³•æ—¶ï¼Œæ¯ä¸ªå…ƒç´ åªèƒ½è¿è¡Œä¸€æ¬¡äº‹ä»¶å¤„ç†ç¨‹åºå‡½æ•°ã€‚è¯­æ³•ï¼š1$(selector).one(event,data,function)å‚æ•°æè¿°eventå¿…éœ€ã€‚è§„å®šæ·»åŠ åˆ°å…ƒç´ çš„ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶ã€‚ç”±ç©ºæ ¼åˆ†éš”å¤šä¸ªäº‹ä»¶å€¼ã€‚å¿…é¡»æ˜¯æœ‰æ•ˆçš„äº‹ä»¶ã€‚dataå¯é€‰ã€‚è§„å®šä¼ é€’åˆ°å‡½æ•°çš„é¢å¤–æ•°æ®ã€‚functionå¿…éœ€ã€‚è§„å®šå½“äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œçš„å‡½æ•°ã€‚ç¤ºä¾‹ï¼šå½“æ‰€æœ‰æ®µè½è¢«ç¬¬ä¸€æ¬¡ç‚¹å‡»çš„æ—¶å€™ï¼Œæ˜¾ç¤ºæ‰€æœ‰å…¶æ–‡æœ¬ã€‚123$("p").one("click", function()&#123; alert( $(this).text() );&#125;); â€‹trigger(type,[data])trigger() æ–¹æ³•è§¦å‘è¢«é€‰å…ƒç´ ä¸ŠæŒ‡å®šçš„äº‹ä»¶ä»¥åŠäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼ˆæ¯”å¦‚è¡¨å•æäº¤ï¼‰ã€‚è¿™ä¸ªå‡½æ•°ä¹Ÿä¼šå¯¼è‡´æµè§ˆå™¨åŒåçš„é»˜è®¤è¡Œä¸ºçš„æ‰§è¡Œã€‚æ¯”å¦‚ï¼Œå¦‚æžœç”¨trigger()è§¦å‘ä¸€ä¸ªâ€™submitâ€™ï¼Œåˆ™åŒæ ·ä¼šå¯¼è‡´æµè§ˆå™¨æäº¤è¡¨å•ã€‚å¦‚æžœè¦é˜»æ­¢è¿™ç§é»˜è®¤è¡Œä¸ºï¼Œåº”è¿”å›žfalseã€‚ç¤ºä¾‹ï¼šé¡µé¢ä¸€åŠ è½½å°±æ‰§è¡Œbuttonçš„clickå‡½æ•°ï¼š12345$(document).ready(function()&#123; $("button").click(function()&#123; alert("123"); &#125;).trigger("click");&#125;);æäº¤ç¬¬ä¸€ä¸ªè¡¨å•ï¼Œä½†ä¸ç”¨submit()1$("form:first").trigger("submit")ç»™ä¸€ä¸ªäº‹ä»¶ä¼ é€’å‚æ•°1234$("p").click( function (event, a, b) &#123; // ä¸€ä¸ªæ™®é€šçš„ç‚¹å‡»äº‹ä»¶æ—¶ï¼Œaå’Œbæ˜¯undefinedç±»åž‹ // å¦‚æžœç”¨ä¸‹é¢çš„è¯­å¥è§¦å‘ï¼Œé‚£ä¹ˆaæŒ‡å‘"foo",è€ŒbæŒ‡å‘"bar"&#125; ).trigger("click", ["foo", "bar"]);ä¸‹é¢çš„ä»£ç å¯ä»¥æ˜¾ç¤ºä¸€ä¸ªâ€Hello Worldâ€123$("p").bind("myEvent", function (event, message1, message2) &#123; alert(message1 + ' ' + message2);&#125;).trigger("myEvent", ["Hello","World!"]); â€‹triggerHandler(type, [data])è¿™ä¸ªæ–¹æ³•ä¸Žtrigger()ç±»ä¼¼ï¼Œä½†ä¸ä¼šæ‰§è¡Œæµè§ˆå™¨é»˜è®¤åŠ¨ä½œï¼Œä¹Ÿä¸ä¼šäº§ç”Ÿäº‹ä»¶å†’æ³¡ã€‚äº‹ä»¶å§”æ´¾live(type, [data], fn)jQuery ç»™æ‰€æœ‰åŒ¹é…çš„å…ƒç´ é™„åŠ ä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå³ä½¿è¿™ä¸ªå…ƒç´ æ˜¯ä»¥åŽå†æ·»åŠ è¿›æ¥çš„ä¹Ÿæœ‰æ•ˆã€‚è¿™ä¸ªæ–¹æ³•æ˜¯åŸºæœ¬æ˜¯çš„ .bind() æ–¹æ³•çš„ä¸€ä¸ªå˜ä½“ã€‚ä½¿ç”¨ .bind() æ—¶ï¼Œé€‰æ‹©å™¨åŒ¹é…çš„å…ƒç´ ä¼šé™„åŠ ä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè€Œä»¥åŽå†æ·»åŠ çš„å…ƒç´ åˆ™ä¸ä¼šæœ‰ã€‚ä¸ºæ­¤éœ€è¦å†ä½¿ç”¨ä¸€æ¬¡ .bind() æ‰è¡Œã€‚æ¯”å¦‚è¯´ï¼š123&lt;body&gt; &lt;div class="clickme"&gt;Click here&lt;/div&gt;&lt;/body&gt;å¯ä»¥ç»™è¿™ä¸ªå…ƒç´ ç»‘å®šä¸€ä¸ªç®€å•çš„clickäº‹ä»¶ï¼š123$('.clickme').bind('click', function() &#123; alert("Bound handler called.");&#125;);å½“ç‚¹å‡»äº†å…ƒç´ ï¼Œå°±ä¼šå¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†ã€‚ç„¶åŽï¼Œæƒ³è±¡ä¸€ä¸‹è¿™ä¹‹åŽæœ‰å¦ä¸€ä¸ªå…ƒç´ æ·»åŠ è¿›æ¥äº†ã€‚1$('body').append('&lt;div class="clickme"&gt;Another target&lt;/div&gt;');å°½ç®¡è¿™ä¸ªæ–°çš„å…ƒç´ ä¹Ÿèƒ½å¤ŸåŒ¹é…é€‰æ‹©å™¨ â€œ.clickmeâ€ ï¼Œä½†æ˜¯ç”±äºŽè¿™ä¸ªå…ƒç´ æ˜¯åœ¨è°ƒç”¨ .bind() ä¹‹åŽæ·»åŠ çš„ï¼Œæ‰€ä»¥ç‚¹å‡»è¿™ä¸ªå…ƒç´ ä¸ä¼šæœ‰ä»»ä½•æ•ˆæžœã€‚.live() å°±æä¾›äº†å¯¹åº”è¿™ç§æƒ…å†µçš„æ–¹æ³•ã€‚å¦‚æžœæˆ‘ä»¬æ˜¯è¿™æ ·ç»‘å®šclickäº‹ä»¶çš„ï¼š123$('.clickme').live('click', function() &#123; alert("Live handler called."); &#125;);ç„¶åŽå†æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ ï¼š1$('body').append('&lt;div class="clickme"&gt;Another target&lt;/div&gt;');ç„¶åŽå†ç‚¹å‡»æ–°å¢žçš„å…ƒç´ ï¼Œä»–ä¾ç„¶èƒ½å¤Ÿè§¦å‘äº‹ä»¶å¤„ç†å‡½æ•°ã€‚ä»Ž jQuery 1.7 å¼€å§‹ï¼Œä¸å†å»ºè®®ä½¿ç”¨ .live() æ–¹æ³•ã€‚è¯·ä½¿ç”¨ .on() æ¥æ·»åŠ äº‹ä»¶å¤„ç†ã€‚ä¸Žå…¶ä½œç”¨ç›¸åçš„å‡½æ•°ä¸ºdie()ã€‚delegate(sel,[t],[d],fn)delegate() æ–¹æ³•ä¸ºæŒ‡å®šçš„å…ƒç´ ï¼ˆå±žäºŽè¢«é€‰å…ƒç´ çš„å­å…ƒç´ ï¼‰æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå¹¶è§„å®šå½“è¿™äº›äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œçš„å‡½æ•°ã€‚ä½¿ç”¨ delegate() æ–¹æ³•çš„äº‹ä»¶å¤„ç†ç¨‹åºé€‚ç”¨äºŽå½“å‰æˆ–æœªæ¥çš„å…ƒç´ ï¼ˆæ¯”å¦‚ç”±è„šæœ¬åˆ›å»ºçš„æ–°å…ƒç´ ï¼‰ã€‚è¯­æ³•ï¼š1$(selector).delegate(childSelector,event,data,function)å‚æ•°æè¿°childSelectorå¿…éœ€ã€‚è§„å®šè¦æ·»åŠ äº‹ä»¶å¤„ç†ç¨‹åºçš„ä¸€ä¸ªæˆ–å¤šä¸ªå­å…ƒç´ ã€‚eventå¿…éœ€ã€‚è§„å®šæ·»åŠ åˆ°å…ƒç´ çš„ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶ã€‚ç”±ç©ºæ ¼åˆ†éš”å¤šä¸ªäº‹ä»¶å€¼ã€‚å¿…é¡»æ˜¯æœ‰æ•ˆçš„äº‹ä»¶ã€‚dataå¯é€‰ã€‚è§„å®šä¼ é€’åˆ°å‡½æ•°çš„é¢å¤–æ•°æ®ã€‚functionå¿…éœ€ã€‚è§„å®šå½“äº‹ä»¶å‘ç”Ÿæ—¶è¿è¡Œçš„å‡½æ•°ã€‚ç¤ºä¾‹ï¼šå½“ç‚¹å‡»é¼ æ ‡æ—¶ï¼Œéšè—æˆ–æ˜¾ç¤º p å…ƒç´ ï¼šHTML ä»£ç :1234&lt;div&gt; è¿™æ˜¯ä¸€ä¸ªæ®µè½ã€‚ &lt;button&gt;è¯·ç‚¹å‡»è¿™é‡Œ&lt;/button&gt;&lt;/div&gt;jQuery ä»£ç :123$("div").delegate("button","click",function()&#123; $("p").slideToggle();&#125;); â€‹delegateè¿™ä¸ªæ–¹æ³•å¯ä½œä¸ºlive()æ–¹æ³•çš„æ›¿ä»£ï¼Œä½¿å¾—æ¯æ¬¡äº‹ä»¶ç»‘å®šåˆ°ç‰¹å®šçš„DOMå…ƒç´ ã€‚ä»¥ä¸‹ä¸¤æ®µä»£ç æ˜¯ç­‰åŒçš„:12345678$("table").delegate("td", "hover", function()&#123; $(this).toggleClass("hover");&#125;);$("table").each(function()&#123; $("td", this).live("hover", function()&#123; $(this).toggleClass("hover"); &#125;); &#125;); â€‹ä¸Žå…¶ç›¸åçš„å‡½æ•°æ˜¯undelegate()ã€‚äº‹ä»¶åˆ‡æ¢hover([over,]out)å½“é¼ æ ‡ç§»åŠ¨åˆ°ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ ä¸Šé¢æ—¶ï¼Œä¼šè§¦å‘æŒ‡å®šçš„ç¬¬ä¸€ä¸ªå‡½æ•°ã€‚å½“é¼ æ ‡ç§»å‡ºè¿™ä¸ªå…ƒç´ æ—¶ï¼Œä¼šè§¦å‘æŒ‡å®šçš„ç¬¬äºŒä¸ªå‡½æ•°ã€‚ç¤ºä¾‹ï¼šé¼ æ ‡æ‚¬åœçš„è¡¨æ ¼åŠ ä¸Šç‰¹å®šçš„ç±»ï¼š12345678$("td").hover( function () &#123; $(this).addClass("hover"); &#125;, function () &#123; $(this).removeClass("hover"); &#125;); â€‹ä¸‹é¢è¿žæ®µä»£ç æ•ˆæžœç›¸åŒï¼š12$("td").bind("mouseenter mouseleave",handlerInOut);$("td").hover(handlerInOut);toggle([s],[easing],[fn])toggle() æ–¹æ³•åœ¨è¢«é€‰å…ƒç´ ä¸Šè¿›è¡Œ hide() å’Œ show() ä¹‹é—´çš„åˆ‡æ¢ã€‚å¦‚ï¼šåœ¨æ‰€æœ‰ å…ƒç´ ä¸Šè¿›è¡Œéšè—å’Œæ˜¾ç¤ºä¹‹é—´çš„åˆ‡æ¢ï¼š123$("button").click(function()&#123; $("p").toggle();&#125;);è¯¥æ–¹æ³•æ£€æŸ¥è¢«é€‰å…ƒç´ çš„å¯è§çŠ¶æ€ã€‚å¦‚æžœä¸€ä¸ªå…ƒç´ æ˜¯éšè—çš„ï¼Œåˆ™è¿è¡Œ show()ï¼Œå¦‚æžœä¸€ä¸ªå…ƒç´ æ˜¯å¯è§çš„ï¼Œåˆ™è¿è¡Œ hide() - è¿™ä¼šé€ æˆä¸€ç§åˆ‡æ¢çš„æ•ˆæžœã€‚å¸¦å‚æ•°è¯­æ³•ï¼š1$(selector).toggle(speed,easing,callback)å‚æ•°æè¿°speedå¯é€‰ã€‚è§„å®šéšè—/æ˜¾ç¤ºæ•ˆæžœçš„é€Ÿåº¦ã€‚ å¯èƒ½çš„å€¼ï¼šæ¯«ç§’â€œslowâ€â€œfastâ€easingå¯é€‰ã€‚è§„å®šåœ¨åŠ¨ç”»çš„ä¸åŒç‚¹ä¸Šå…ƒç´ çš„é€Ÿåº¦ã€‚é»˜è®¤å€¼ä¸º â€œswingâ€ã€‚ å¯èƒ½çš„å€¼ï¼šâ€œswingâ€ - åœ¨å¼€å¤´/ç»“å°¾ç§»åŠ¨æ…¢ï¼Œåœ¨ä¸­é—´ç§»åŠ¨å¿«â€œlinearâ€ - åŒ€é€Ÿç§»åŠ¨callbackå¯é€‰ã€‚toggle() æ–¹æ³•æ‰§è¡Œå®Œä¹‹åŽï¼Œè¦æ‰§è¡Œçš„å‡½æ•°ã€‚1ç§’ä¹‹å†…åŠ¨æ€éšè—å’Œæ˜¾ç¤ºpå…ƒç´ ï¼š123$("button").click(function()&#123; $("p").toggle(1000);&#125;);1ç§’ä¹‹å†…åŠ¨æ€éšè—å’Œæ˜¾ç¤ºpå…ƒç´ ï¼Œå¹¶æ‰§è¡Œå›žè°ƒå‡½æ•°ï¼š12345$("button").click(function()&#123; $("p").toggle(1000,function()&#123; alert("toggle() æ–¹æ³•å·²å®Œæˆ!"); &#125;); â€‹&#125;);toggle(fn1,fn2...fnN)å‡½æ•°ä¹Ÿå¯ä»¥ç”¨äºŽå‡ ä¸ªå‡½æ•°é—´çš„åˆ‡æ¢ï¼ŒçŽ°æœ‰å¦‚ä¸‹ä»£ç ï¼š123456789$("panel h5.head").bind("click",function()&#123; var $content=$(this).next("div.content"); if($content.is(":visible"))&#123; $content.hide(); &#125;else&#123; $content.show(); &#125; &#125;);ä½¿ç”¨toggleæ”¹å†™ï¼š1234567$("panel h5.head").toggle( function()&#123; $(this).next("div.content").show(); &#125;,function()&#123; $(this).next("div.content").hide(); &#125;);äº‹ä»¶blur([[data],fn])å½“å…ƒç´ å¤±åŽ»ç„¦ç‚¹æ—¶è§¦å‘ blur äº‹ä»¶ã€‚ç¤ºä¾‹ï¼šè§¦å‘æ‰€æœ‰æ®µè½çš„bluräº‹ä»¶ï¼š1$("p").blur();ä»»ä½•æ®µè½å¤±åŽ»ç„¦ç‚¹æ—¶å¼¹å‡ºä¸€ä¸ª â€œHello World!â€åœ¨æ¯ä¸€ä¸ªåŒ¹é…å…ƒç´ çš„bluräº‹ä»¶ä¸­ç»‘å®šçš„å¤„ç†å‡½æ•°ï¼š1$("p").blur( function () &#123; alert("Hello World!"); &#125; ); â€‹change([[data],fn])å½“å…ƒç´ çš„å€¼æ”¹å˜æ—¶å‘ç”Ÿ change äº‹ä»¶ï¼ˆä»…é€‚ç”¨äºŽè¡¨å•å­—æ®µï¼‰ã€‚ç¤ºä¾‹ï¼šå½“&lt;input&gt;æ–‡æœ¬å€¼å‘ç”Ÿæ”¹å˜ï¼Œä¸”å¤±åŽ»ç„¦ç‚¹æˆ–è€…æŒ‰Enteré”®çš„æ—¶å€™è§¦å‘ï¼š123$("input").change(function()&#123; alert("æ–‡æœ¬å·²è¢«ä¿®æ”¹");&#125;);æ³¨æ„ï¼Œåœ¨è¾“å…¥è¿‡ç¨‹ä¸­ï¼Œè™½ç„¶å€¼ä¸æ–­æ”¹å˜ï¼Œä½†ä¸ä¼šè§¦å‘change()ï¼Œé™¤éž&lt;input&gt;å¤±åŽ»ç„¦ç‚¹æˆ–è€…æŒ‰Enteré”®çš„æ—¶å€™è§¦å‘ã€‚click([[data],fn])ç•¥ã€‚dblclick([[data],fn])ç•¥ã€‚error([[data],fn])å½“å…ƒç´ é‡åˆ°é”™è¯¯ï¼ˆæ²¡æœ‰æ­£ç¡®è½½å…¥ï¼‰æ—¶ï¼Œå‘ç”Ÿ error äº‹ä»¶ã€‚å¦‚ï¼šå›¾ç‰‡åŠ è½½é”™è¯¯æ—¶ï¼Œæ›¿æ¢ä¸ºæ–‡æœ¬æç¤ºï¼š123$("img").error(function()&#123; $("img").replaceWith("&lt;p&gt;å›¾ç‰‡åŠ è½½é”™è¯¯!&lt;/p&gt;");&#125;);focus([[data],fn])å½“å…ƒç´ èŽ·å¾—ç„¦ç‚¹æ—¶ï¼Œè§¦å‘ focus äº‹ä»¶ã€‚å¯ä»¥é€šè¿‡é¼ æ ‡ç‚¹å‡»æˆ–è€…é”®ç›˜ä¸Šçš„TABå¯¼èˆªè§¦å‘ã€‚è¿™å°†è§¦å‘æ‰€æœ‰ç»‘å®šçš„focuså‡½æ•°ã€‚ç¤ºä¾‹ï¼šå½“é¡µé¢åŠ è½½åŽå°† id ä¸º â€˜loginâ€™ çš„å…ƒç´ è®¾ç½®ç„¦ç‚¹ï¼š123$(document).ready(function()&#123; $("#login").focus();&#125;);ä½¿äººæ— æ³•ä½¿ç”¨æ–‡æœ¬æ¡†ï¼š123$("input[type=text]").focus(function()&#123; this.blur();&#125;); â€‹focusin([data],fn)å½“å…ƒç´ ï¼ˆæˆ–åœ¨å…¶å†…çš„ä»»æ„å…ƒç´ ï¼‰èŽ·å¾—ç„¦ç‚¹æ—¶å‘ç”Ÿ focusin äº‹ä»¶ã€‚å½“åœ¨å…ƒç´ æˆ–åœ¨å…¶å†…çš„ä»»æ„å…ƒç´ ä¸Šå‘ç”Ÿ focus äº‹ä»¶æ—¶ï¼Œfocusin() æ–¹æ³•æ·»åŠ è¦è¿è¡Œçš„å‡½æ•°ã€‚ä¸Ž focus() æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œfocusin()æ–¹æ³•åœ¨ä»»æ„å­å…ƒç´ èŽ·å¾—ç„¦ç‚¹æ—¶ä¹Ÿä¼šè§¦å‘ã€‚ä¾‹å¦‚ï¼ŒçŽ°æœ‰divï¼š1234&lt;div style="border: 1px solid black;padding:10px;"&gt; First name: &lt;input type="text"&gt;&lt;br&gt; Last name: &lt;input type="text"&gt;&lt;/div&gt;divå­å…ƒç´ &lt;input&gt;èŽ·å¾—ç„¦ç‚¹æ—¶ï¼Œæ”¹å˜divçš„é¢œè‰²ï¼š123$("div").focusin(function()&#123; $(this).css("background-color","#FFFFCC");&#125;);focusout([data],fn)ä¸Žfoucusinç›¸åã€‚keydown([[data],fn])å½“é”®ç›˜æˆ–æŒ‰é’®è¢«æŒ‰ä¸‹æ—¶ï¼Œå‘ç”Ÿ keydown äº‹ä»¶ã€‚ä¾‹å¦‚ï¼šåœ¨é¡µé¢å†…å¯¹é”®ç›˜æŒ‰é”®åšå‡ºå›žåº”ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š12345678$(window).keydown(function(event)&#123; switch(event.which) &#123; // ... // ä¸åŒçš„æŒ‰é”®å¯ä»¥åšä¸åŒçš„äº‹æƒ… // ä¸åŒçš„æµè§ˆå™¨çš„keycodeä¸åŒ // ... &#125;&#125;);keypress([[data],fn])keydownï¼šç”¨æˆ·åœ¨é”®ç›˜ä¸ŠæŒ‰ä¸‹æŸæŒ‰é”®æ˜¯å‘ç”Ÿã€‚ä¸€ç›´æŒ‰ç€æŸæŒ‰é”®åˆ™ä¼šä¸æ–­è§¦å‘ï¼ˆoperaæµè§ˆå™¨é™¤å¤–ï¼‰ã€‚keypressï¼šç”¨æˆ·æŒ‰ä¸‹ä¸€ä¸ªæŒ‰é”®ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªå­—ç¬¦æ—¶å‘ç”Ÿï¼ˆä¹Ÿå°±æ˜¯ä¸ç®¡ç±»ä¼¼shiftã€altã€ctrlä¹‹ç±»çš„é”®ï¼Œå°±æ˜¯è¯´ç”¨æˆ·æŒ‰äº†ä¸€ä¸ªèƒ½åœ¨å±å¹•ä¸Šè¾“å‡ºå­—ç¬¦çš„æŒ‰é”®keypressäº‹ä»¶æ‰ä¼šè§¦å‘ï¼‰ã€‚ä¸€ç›´æŒ‰ç€æŸæŒ‰é”®åˆ™ä¼šä¸æ–­è§¦å‘ã€‚keyup([[data],fn])å½“æŒ‰é’®è¢«æ¾å¼€æ—¶ï¼Œå‘ç”Ÿ keyup äº‹ä»¶ã€‚mousedown([[d,fn])å½“é¼ æ ‡æŒ‡é’ˆç§»åŠ¨åˆ°å…ƒç´ ä¸Šæ–¹ï¼Œå¹¶æŒ‰ä¸‹é¼ æ ‡æŒ‰é”®æ—¶ï¼Œä¼šå‘ç”Ÿ mousedown äº‹ä»¶ã€‚mousedown ä¸Ž click äº‹ä»¶ä¸åŒï¼Œmousedown äº‹ä»¶ä»…éœ€è¦æŒ‰é”®è¢«æŒ‰ä¸‹ï¼Œè€Œä¸éœ€è¦æ¾å¼€å³å¯å‘ç”Ÿã€‚é¼ æ ‡æŒ‰é”®å¯ä»¥ä¸ºå·¦é”®å³é”®å’Œæ»šè½®ã€‚mouseup([[data],fn])ä¸Žmousedown()ç›¸åã€‚ä¾‹å­ï¼šå½“é¼ æ ‡æŒ‡å‘&lt;div&gt;å¹¶æŒ‰ä¸‹é¼ æ ‡æŒ‰é”®æ—¶ï¼Œä»¥åŠæ¾å¼€æ—¶è§¦å‘äº‹ä»¶ï¼šHTMLï¼š1&lt;div&gt;åœ¨è¿™ä¸ª div å…ƒç´ ä¸­æŒ‰ä¸‹å’Œé‡Šæ”¾é¼ æ ‡æŒ‰é’®ã€‚&lt;/div&gt;jQueryï¼š123456$("div").mouseup(function()&#123; $(this).after("é‡Šæ”¾é¼ æ ‡æŒ‰é’®ã€‚");&#125;);$("div").mousedown(function()&#123; $(this).after("æŒ‰ä¸‹é¼ æ ‡æŒ‰é’®ã€‚");&#125;);mouseenter([[data],fn])å½“é¼ æ ‡æŒ‡é’ˆç©¿è¿‡å…ƒç´ æ—¶ï¼Œä¼šå‘ç”Ÿ mouseenter äº‹ä»¶ã€‚è¯¥äº‹ä»¶å¤§å¤šæ•°æ—¶å€™ä¼šä¸Ž mouseleave äº‹ä»¶ä¸€èµ·ä½¿ç”¨ã€‚mouseleave([[data],fn])å½“é¼ æ ‡æŒ‡é’ˆç¦»å¼€å…ƒç´ æ—¶ï¼Œä¼šå‘ç”Ÿ mouseleave äº‹ä»¶ã€‚è¯¥äº‹ä»¶å¤§å¤šæ•°æ—¶å€™ä¼šä¸Ž mouseenter äº‹ä»¶ä¸€èµ·ä½¿ç”¨ã€‚ä¾‹å­ï¼šå½“é¼ æ ‡æŒ‡é’ˆè¿›å…¥ &lt;p&gt; å…ƒç´ æ—¶ï¼Œè®¾ç½®èƒŒæ™¯è‰²ä¸ºé»„è‰²ï¼Œç¦»å¼€æ—¶è®¾ç½®ä¸ºç°è‰²ï¼šHTMLï¼š1&lt;p&gt;é¼ æ ‡ç§»åŠ¨åˆ°è¯¥æ®µè½ã€‚&lt;/p&gt;jQueryï¼š123456$("p").mouseenter(function()&#123; $("p").css("background-color","yellow");&#125;);$("p").mouseleave(function()&#123; $("p").css("background-color","lightgray");&#125;);mouseover([[d],fn])å½“é¼ æ ‡æŒ‡é’ˆä½äºŽå…ƒç´ ä¸Šæ–¹æ—¶ï¼Œä¼šå‘ç”Ÿ mouseover äº‹ä»¶ã€‚è¯¥äº‹ä»¶å¤§å¤šæ•°æ—¶å€™ä¼šä¸Ž mouseout äº‹ä»¶ä¸€èµ·ä½¿ç”¨ã€‚æ³¨é‡Šï¼šä¸Ž mouseenter äº‹ä»¶ä¸åŒï¼Œä¸è®ºé¼ æ ‡æŒ‡é’ˆç©¿è¿‡è¢«é€‰å…ƒç´ æˆ–å…¶å­å…ƒç´ ï¼Œéƒ½ä¼šè§¦å‘ mouseover äº‹ä»¶ã€‚mouseout([[data],fn])å½“é¼ æ ‡æŒ‡é’ˆä»Žå…ƒç´ ä¸Šç§»å¼€æ—¶ï¼Œå‘ç”Ÿ mouseout äº‹ä»¶ã€‚mousemove([[data],fn])å½“é¼ æ ‡æŒ‡é’ˆåœ¨æŒ‡å®šçš„å…ƒç´ ä¸­ç§»åŠ¨æ—¶ï¼Œå°±ä¼šå‘ç”Ÿ mousemove äº‹ä»¶ã€‚ä¾‹å­ï¼šèŽ·å¾—é¼ æ ‡æŒ‡é’ˆåœ¨é¡µé¢ä¸­çš„ä½ç½®ï¼š123$(document).mousemove(function(event)&#123; $("span").text(event.pageX + ", " + event.pageY);&#125;);resize([[data],fn])å½“è°ƒæ•´æµè§ˆå™¨çª—å£çš„å¤§å°æ—¶ï¼Œå‘ç”Ÿ resize äº‹ä»¶ã€‚ä¾‹å­ï¼šHTMLï¼š1&lt;p&gt;çª—å£é‡ç½®äº† &lt;span&gt;0&lt;/span&gt; æ¬¡å¤§å°ã€‚&lt;/p&gt;jQueryï¼š123$(window).resize(function()&#123; $("span").text(x+=1);&#125;);scroll([[data],fn])å½“ç”¨æˆ·æ»šåŠ¨æŒ‡å®šçš„å…ƒç´ æ—¶ï¼Œä¼šå‘ç”Ÿ scroll äº‹ä»¶ã€‚å¯¹å…ƒç´ æ»šåŠ¨çš„æ¬¡æ•°è¿›è¡Œè®¡æ•°ï¼š123$("div").scroll(function()&#123; $("span").text(x+=1);&#125;);select([[data],fn])å½“ textarea æˆ–æ–‡æœ¬ç±»åž‹çš„ input å…ƒç´ ä¸­çš„æ–‡æœ¬è¢«é€‰æ‹©æ—¶ï¼Œä¼šå‘ç”Ÿ select äº‹ä»¶ã€‚123$("input").select(function()&#123; alert("æ–‡æœ¬å·²é€‰ä¸­!");&#125;);submit([[data],fn])å½“æäº¤è¡¨å•æ—¶ï¼Œä¼šå‘ç”Ÿ submit äº‹ä»¶ã€‚è¯¥äº‹ä»¶åªé€‚ç”¨äºŽè¡¨å•å…ƒç´ ã€‚å¦‚æžœä½ è¦é˜»æ­¢è¡¨å•æäº¤:123$("form").submit( function () &#123; return false;&#125;); â€‹unload([[data],fn])å½“ç”¨æˆ·ç¦»å¼€é¡µé¢æ—¶ï¼Œä¼šå‘ç”Ÿ unload äº‹ä»¶ã€‚å½“å‘ç”Ÿä»¥ä¸‹æƒ…å†µä¸‹ï¼Œä¼šè§¦å‘ unload äº‹ä»¶ï¼š1.ç‚¹å‡»æŸä¸ªç¦»å¼€é¡µé¢çš„é“¾æŽ¥2.åœ¨åœ°å€æ ä¸­é”®å…¥äº†æ–°çš„ URL3.ä½¿ç”¨å‰è¿›æˆ–åŽé€€æŒ‰é’®4.å…³é—­æµè§ˆå™¨çª—å£5.é‡æ–°åŠ è½½é¡µé¢unload() æ–¹æ³•åªåº”ç”¨äºŽ window å¯¹è±¡ã€‚123$(window).unload(function()&#123; alert("Goodbye!");&#125;);]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQuery æ–‡æ¡£å¤„ç†]]></title>
    <url>%2FjQuery-%E6%96%87%E6%A1%A3%E5%A4%84%E7%90%86.html</url>
    <content type="text"><![CDATA[å†…éƒ¨æ’å…¥append(content|fn)å‘æ¯ä¸ªåŒ¹é…çš„å…ƒç´ å†…éƒ¨è¿½åŠ å†…å®¹ã€‚ç¤ºä¾‹ï¼šå‘æ‰€æœ‰æ®µè½ä¸­è¿½åŠ ä¸€äº›HTMLæ ‡è®°ï¼šHTML ä»£ç ï¼š1&lt;p&gt;I would like to say: &lt;/p&gt;jQuery ä»£ç ï¼š1$("p").append("&lt;b&gt;Hello&lt;/b&gt;")ç»“æžœï¼š1&lt;p&gt;I would like to say: &lt;b&gt;Hello&lt;/b&gt;&lt;/p&gt;â€‹appendTo(content)æŠŠæ‰€æœ‰åŒ¹é…çš„å…ƒç´ è¿½åŠ åˆ°å¦ä¸€ä¸ªæŒ‡å®šçš„å…ƒç´ å…ƒç´ é›†åˆä¸­ã€‚ å®žé™…ä¸Šï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ˜¯é¢ å€’äº†å¸¸è§„çš„$(A).append(B)çš„æ“ä½œï¼Œå³ä¸æ˜¯æŠŠBè¿½åŠ åˆ°Aä¸­ï¼Œè€Œæ˜¯æŠŠAè¿½åŠ åˆ°Bä¸­ã€‚ç¤ºä¾‹1ï¼šæŠŠæ‰€æœ‰æ®µè½è¿½åŠ åˆ°divå…ƒç´ ä¸­ã€‚HTML ä»£ç ï¼š12&lt;p&gt;I would like to say: &lt;/p&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt; â€‹jQuery ä»£ç ï¼š1$("p").appendTo("div")ç»“æžœï¼š12&lt;div&gt;&lt;p&gt;I would like to say: &lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p&gt;I would like to say: &lt;/p&gt;&lt;/div&gt; â€‹ç¤ºä¾‹2ï¼šæ–°å»ºæ®µè½è¿½åŠ divä¸­å¹¶åŠ ä¸Šä¸€ä¸ªclassHTML ä»£ç ï¼š1&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt; â€‹jQuery ä»£ç ï¼š12345$("&lt;p/&gt;") .appendTo("div") .addClass("test") .end() .addClass("test2"); â€‹ç»“æžœï¼š12&lt;div&gt;&lt;p class="test test2"&gt;&lt;/p&gt;&lt;/div&gt;&lt;div&gt;&lt;p class="test"&gt;&lt;/p&gt;&lt;/div&gt;prepend(content)å‘æ¯ä¸ªåŒ¹é…çš„å…ƒç´ å†…éƒ¨å‰ç½®å†…å®¹ã€‚ç¤ºä¾‹1ï¼šå‘æ‰€æœ‰æ®µè½ä¸­å‰ç½®ä¸€äº›HTMLæ ‡è®°ä»£ç ã€‚HTML ä»£ç ï¼š1&lt;p&gt;I would like to say: &lt;/p&gt;jQuery ä»£ç ï¼š1$("p").prepend("&lt;b&gt;Hello&lt;/b&gt;");ç»“æžœï¼š1&lt;p&gt;&lt;b&gt;Hello&lt;/b&gt;I would like to say: &lt;/p&gt;ç¤ºä¾‹2ï¼šå°†ä¸€ä¸ªDOMå…ƒç´ å‰ç½®å…¥æ‰€æœ‰æ®µè½ã€‚HTML ä»£ç ï¼š1234&lt;p&gt;I would like to say: &lt;/p&gt;&lt;p&gt;I would like to say: &lt;/p&gt;&lt;b class="foo"&gt;Hello&lt;/b&gt;&lt;b class="foo"&gt;Good Bye&lt;/b&gt;jQuery ä»£ç ï¼š1$("p").prepend( $(".foo")[0] );ç»“æžœï¼š123&lt;p&gt;&lt;b class="foo"&gt;Hello&lt;/b&gt;I would like to say: &lt;/p&gt;&lt;p&gt;&lt;b class="foo"&gt;Hello&lt;/b&gt;I would like to say: &lt;/p&gt;&lt;b class="foo"&gt;Good Bye&lt;/b&gt; â€‹prependTo(content)æŠŠæ‰€æœ‰åŒ¹é…çš„å…ƒç´ å‰ç½®åˆ°å¦ä¸€ä¸ªã€æŒ‡å®šçš„å…ƒç´ å…ƒç´ é›†åˆä¸­ã€‚å®žé™…ä¸Šï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ˜¯é¢ å€’äº†å¸¸è§„çš„$(A).prepend(B)çš„æ“ä½œï¼Œå³ä¸æ˜¯æŠŠBå‰ç½®åˆ°Aä¸­ï¼Œè€Œæ˜¯æŠŠAå‰ç½®åˆ°Bä¸­ã€‚ç¤ºä¾‹1ï¼šHTML ä»£ç ï¼š1&lt;p&gt;I would like to say: &lt;/p&gt;&lt;div id="foo"&gt;&lt;/div&gt;jQuery ä»£ç ï¼š1$("p").prependTo("#foo");ç»“æžœï¼š1&lt;div id="foo"&gt;&lt;p&gt;I would like to say: &lt;/p&gt;&lt;/div&gt; â€‹å¤–éƒ¨æ’å…¥after(content|fn)åœ¨æ¯ä¸ªåŒ¹é…çš„å…ƒç´ ä¹‹åŽæ’å…¥å†…å®¹ã€‚ç¤ºä¾‹1ï¼šåœ¨æ‰€æœ‰æ®µè½ä¹‹åŽæ’å…¥ä¸€äº›HTMLæ ‡è®°ä»£ç ã€‚HTML ä»£ç ï¼š1&lt;p&gt;I would like to say: &lt;/p&gt;jQuery ä»£ç ï¼š1$("p").after("&lt;b&gt;Hello&lt;/b&gt;");ç»“æžœï¼š1&lt;p&gt;I would like to say: &lt;/p&gt;&lt;b&gt;Hello&lt;/b&gt; â€‹ç¤ºä¾‹2ï¼šåœ¨æ‰€æœ‰æ®µè½ä¹‹åŽæ’å…¥ä¸€ä¸ªDOMå…ƒç´ ã€‚HTML ä»£ç ï¼š1&lt;b id="foo"&gt;Hello&lt;/b&gt;&lt;p&gt;I would like to say: &lt;/p&gt;jQuery ä»£ç ï¼š1$("p").after( $("#foo")[0] );ç»“æžœï¼š1&lt;p&gt;I would like to say: &lt;/p&gt;&lt;b id="foo"&gt;Hello&lt;/b&gt; â€‹ç¤ºä¾‹3ï¼šåœ¨æ‰€æœ‰æ®µè½ä¸­åŽæ’å…¥ä¸€ä¸ªjQueryå¯¹è±¡(ç±»ä¼¼äºŽä¸€ä¸ªDOMå…ƒç´ æ•°ç»„)ã€‚HTML ä»£ç ï¼š1&lt;b&gt;Hello&lt;/b&gt;&lt;p&gt;I would like to say: &lt;/p&gt;jQuery ä»£ç ï¼š1$("p").after( $("b") );ç»“æžœï¼š1&lt;p&gt;I would like to say: &lt;/p&gt;&lt;b&gt;Hello&lt;/b&gt; â€‹insertAfter(content)æŠŠæ‰€æœ‰åŒ¹é…çš„å…ƒç´ æ’å…¥åˆ°å¦ä¸€ä¸ªã€æŒ‡å®šçš„å…ƒç´ å…ƒç´ é›†åˆçš„åŽé¢ã€‚å®žé™…ä¸Šï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ˜¯é¢ å€’äº†å¸¸è§„çš„$(A).after(B)çš„æ“ä½œï¼Œå³ä¸æ˜¯æŠŠBæ’å…¥åˆ°AåŽé¢ï¼Œè€Œæ˜¯æŠŠAæ’å…¥åˆ°BåŽé¢ã€‚ç¤ºä¾‹ï¼šæŠŠæ‰€æœ‰æ®µè½æ’å…¥åˆ°ä¸€ä¸ªå…ƒç´ ä¹‹åŽã€‚ä¸Ž $(&quot;#foo&quot;).after(&quot;p&quot;)ç›¸åŒHTML ä»£ç ï¼š1&lt;p&gt;I would like to say: &lt;/p&gt;&lt;div id="foo"&gt;Hello&lt;/div&gt;jQuery ä»£ç ï¼š1$("p").insertAfter("#foo");ç»“æžœï¼š1&lt;div id="foo"&gt;Hello&lt;/div&gt;&lt;p&gt;I would like to say: &lt;/p&gt; â€‹before(content|fn)åœ¨æ¯ä¸ªåŒ¹é…çš„å…ƒç´ ä¹‹å‰æ’å…¥å†…å®¹ã€‚ç¤ºä¾‹ï¼šåœ¨æ‰€æœ‰æ®µè½ä¹‹å‰æ’å…¥ä¸€äº›HTMLæ ‡è®°ä»£ç ã€‚HTML ä»£ç ï¼š1&lt;p&gt;I would like to say: &lt;/p&gt;jQuery ä»£ç ï¼š1$("p").before("&lt;b&gt;Hello&lt;/b&gt;");ç»“æžœï¼š1&lt;b&gt;Hello&lt;/b&gt;&lt;p&gt;I would like to say: &lt;/p&gt;insertBefore(content)æŠŠæ‰€æœ‰åŒ¹é…çš„å…ƒç´ æ’å…¥åˆ°å¦ä¸€ä¸ªã€æŒ‡å®šçš„å…ƒç´ å…ƒç´ é›†åˆçš„å‰é¢ã€‚å®žé™…ä¸Šï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ˜¯é¢ å€’äº†å¸¸è§„çš„$(A).before(B)çš„æ“ä½œï¼Œå³ä¸æ˜¯æŠŠBæ’å…¥åˆ°Aå‰é¢ï¼Œè€Œæ˜¯æŠŠAæ’å…¥åˆ°Bå‰é¢ã€‚ç¤ºä¾‹ï¼šæŠŠæ‰€æœ‰æ®µè½æ’å…¥åˆ°ä¸€ä¸ªå…ƒç´ ä¹‹å‰ã€‚ä¸Ž $(&quot;#foo&quot;).before(&quot;p&quot;)ç›¸åŒã€‚HTML ä»£ç ï¼š1&lt;div id="foo"&gt;Hello&lt;/div&gt;&lt;p&gt;I would like to say: &lt;/p&gt;jQuery ä»£ç ï¼š1$("p").insertBefore("#foo");ç»“æžœï¼š1&lt;p&gt;I would like to say: &lt;/p&gt;&lt;div id="foo"&gt;Hello&lt;/div&gt; â€‹åŒ…è£¹wrap(html|element|fn)æŠŠæ‰€æœ‰åŒ¹é…çš„å…ƒç´ ç”¨å…¶ä»–å…ƒç´ çš„ç»“æž„åŒ–æ ‡è®°åŒ…è£¹èµ·æ¥ã€‚ç¤ºä¾‹ï¼šhtmlå‚æ•°æè¿°ï¼šæŠŠæ‰€æœ‰çš„æ®µè½ç”¨ä¸€ä¸ªæ–°åˆ›å»ºçš„divåŒ…è£¹èµ·æ¥jQuery ä»£ç ï¼š1$("p").wrap("&lt;div class='wrap'&gt;&lt;/div&gt;");elemå‚æ•°æè¿°ï¼šç”¨IDæ˜¯â€contentâ€çš„divå°†æ¯ä¸€ä¸ªæ®µè½åŒ…è£¹èµ·æ¥jQuery ä»£ç ï¼š1$("p").wrap(document.getElementById('content'));å›žè°ƒå‡½æ•°æè¿°ï¼šç”¨åŽŸå…ˆdivçš„å†…å®¹ä½œä¸ºæ–°divçš„classï¼Œå¹¶å°†æ¯ä¸€ä¸ªå…ƒç´ åŒ…è£¹èµ·æ¥HTML ä»£ç ï¼š1234&lt;div class="container"&gt; &lt;div class="inner"&gt;Hello&lt;/div&gt; &lt;div class="inner"&gt;Goodbye&lt;/div&gt;&lt;/div&gt;jQuery ä»£ç ï¼š123$('.inner').wrap(function() &#123; return '&lt;div class="' + $(this).text() + '" /&gt;';&#125;);ç»“æžœï¼š12345678&lt;div class="container"&gt; &lt;div class="Hello"&gt; &lt;div class="inner"&gt;Hello&lt;/div&gt; &lt;/div&gt; &lt;div class="Goodbye"&gt; &lt;div class="inner"&gt;Goodbye&lt;/div&gt; &lt;/div&gt;&lt;/div&gt; â€‹unwrap()è¿™ä¸ªæ–¹æ³•å°†ç§»å‡ºå…ƒç´ çš„çˆ¶å…ƒç´ ã€‚è¿™èƒ½å¿«é€Ÿå–æ¶ˆ .wrap()æ–¹æ³•çš„æ•ˆæžœã€‚åŒ¹é…çš„å…ƒç´ ï¼ˆä»¥åŠä»–ä»¬çš„åŒè¾ˆå…ƒç´ ï¼‰ä¼šåœ¨DOMç»“æž„ä¸Šæ›¿æ¢ä»–ä»¬çš„çˆ¶å…ƒç´ ã€‚ç¤ºä¾‹ï¼šHTML ä»£ç ï¼š12345&lt;div&gt; &lt;p&gt;Hello&lt;/p&gt; &lt;p&gt;cruel&lt;/p&gt; &lt;p&gt;World&lt;/p&gt;&lt;/div&gt;jQuery ä»£ç ï¼š1$("p").unwrap()ç»“æžœï¼š123&lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;cruel&lt;/p&gt;&lt;p&gt;World&lt;/p&gt; â€‹wrapAll(html|ele)å°†æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ç”¨å•ä¸ªå…ƒç´ åŒ…è£¹èµ·æ¥ã€‚ç¤ºä¾‹ï¼šhtmlæè¿°ï¼šç”¨ä¸€ä¸ªç”Ÿæˆçš„divå°†æ‰€æœ‰æ®µè½åŒ…è£¹èµ·æ¥ã€‚HTMLä»£ç ï¼š123&lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;cruel&lt;/p&gt;&lt;p&gt;World&lt;/p&gt; â€‹jQuery ä»£ç ï¼š1$("p").wrapAll("&lt;div&gt;&lt;/div&gt;");ç»“æžœï¼š12345&lt;div&gt; &lt;p&gt;Hello&lt;/p&gt; &lt;p&gt;cruel&lt;/p&gt; &lt;p&gt;World&lt;/p&gt;&lt;/div&gt; â€‹elemæè¿°ï¼šç”¨ä¸€ä¸ªç”Ÿæˆçš„divå°†æ‰€æœ‰æ®µè½åŒ…è£¹èµ·æ¥jQuery ä»£ç ï¼š1$("p").wrapAll(document.createElement("div")); â€‹wrapInner(htm|ele|fn)å°†æ¯ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ çš„å­å†…å®¹(åŒ…æ‹¬æ–‡æœ¬èŠ‚ç‚¹)ç”¨ä¸€ä¸ªHTMLç»“æž„åŒ…è£¹èµ·æ¥ã€‚ç¤ºä¾‹ï¼šå‚æ•°htmlæè¿°ï¼šæŠŠæ‰€æœ‰æ®µè½å†…çš„æ¯ä¸ªå­å†…å®¹åŠ ç²—jQuery ä»£ç ï¼š1$("p").wrapInner("&lt;b&gt;&lt;/b&gt;");å‚æ•°elemæè¿°ï¼šæŠŠæ‰€æœ‰æ®µè½å†…çš„æ¯ä¸ªå­å†…å®¹åŠ ç²—jQuery ä»£ç ï¼š1$("p").wrapInner(document.createElement("b"));å›žè°ƒå‡½æ•°æè¿°ï¼šç”¨åŽŸå…ˆdivçš„å†…å®¹ä½œä¸ºæ–°divçš„classï¼Œå¹¶å°†æ¯ä¸€ä¸ªå…ƒç´ åŒ…è£¹èµ·æ¥HTML ä»£ç ï¼š1234&lt;div class="container"&gt; &lt;div class="inner"&gt;Hello&lt;/div&gt; &lt;div class="inner"&gt;Goodbye&lt;/div&gt;&lt;/div&gt;jQuery ä»£ç ï¼š123$('.inner').wrapInner(function() &#123; return '&lt;div class="' + $(this).text() + '" /&gt;';&#125;);ç»“æžœï¼š12345678&lt;div class="container"&gt; &lt;div class="inner"&gt; &lt;div class="Hello"&gt;Hello&lt;/div&gt; &lt;/div&gt; &lt;div class="inner"&gt; &lt;div class="Goodbye"&gt;Goodbye&lt;/div&gt; &lt;/div&gt;&lt;/div&gt;æ›¿æ¢replaceWith(content|fn)å°†æ‰€æœ‰åŒ¹é…çš„å…ƒç´ æ›¿æ¢æˆæŒ‡å®šçš„HTMLæˆ–DOMå…ƒç´ ã€‚ç¤ºä¾‹1ï¼šæŠŠæ‰€æœ‰çš„æ®µè½æ ‡è®°æ›¿æ¢æˆåŠ ç²—çš„æ ‡è®°ã€‚HTML ä»£ç ï¼š1&lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;cruel&lt;/p&gt;&lt;p&gt;World&lt;/p&gt;jQuery ä»£ç ï¼š1$("p").replaceWith("&lt;b&gt;Paragraph. &lt;/b&gt;");ç»“æžœï¼š1&lt;b&gt;Paragraph. &lt;/b&gt;&lt;b&gt;Paragraph. &lt;/b&gt;&lt;b&gt;Paragraph. &lt;/b&gt; â€‹ç¤ºä¾‹2ï¼šç”¨ç¬¬ä¸€æ®µæ›¿æ¢ç¬¬ä¸‰æ®µï¼Œä½ å¯ä»¥å‘çŽ°ä»–æ˜¯ç§»åŠ¨åˆ°ç›®æ ‡ä½ç½®æ¥æ›¿æ¢ï¼Œè€Œä¸æ˜¯å¤åˆ¶ä¸€ä»½æ¥æ›¿æ¢ã€‚HTML ä»£ç ï¼š12345&lt;div class="container"&gt; &lt;div class="inner first"&gt;Hello&lt;/div&gt; &lt;div class="inner second"&gt;And&lt;/div&gt; &lt;div class="inner third"&gt;Goodbye&lt;/div&gt;&lt;/div&gt;jQuery ä»£ç ï¼š1$('.third').replaceWith($('.first'));ç»“æžœï¼š1234&lt;div class="container"&gt; &lt;div class="inner second"&gt;And&lt;/div&gt; &lt;div class="inner first"&gt;Hello&lt;/div&gt;&lt;/div&gt; â€‹replaceAll(selector)ç”¨åŒ¹é…çš„å…ƒç´ æ›¿æ¢æŽ‰æ‰€æœ‰ selectoråŒ¹é…åˆ°çš„å…ƒç´ ã€‚å’Œ replaceWith() ç›¸åã€‚ç¤ºä¾‹ï¼šæŠŠæ‰€æœ‰çš„æ®µè½æ ‡è®°æ›¿æ¢æˆåŠ ç²—æ ‡è®°HTML ä»£ç ï¼š1&lt;p&gt;Hello&lt;/p&gt;&lt;p&gt;cruel&lt;/p&gt;&lt;p&gt;World&lt;/p&gt;jQuery ä»£ç ï¼š1$("&lt;b&gt;Paragraph. &lt;/b&gt;").replaceAll("p");ç»“æžœï¼š1&lt;b&gt;Paragraph. &lt;/b&gt;&lt;b&gt;Paragraph. &lt;/b&gt;&lt;b&gt;Paragraph. &lt;/b&gt; â€‹åˆ é™¤empty()åˆ é™¤åŒ¹é…çš„å…ƒç´ é›†åˆä¸­æ‰€æœ‰çš„å­èŠ‚ç‚¹ã€‚ç¤ºä¾‹ï¼šæŠŠæ‰€æœ‰æ®µè½çš„å­å…ƒç´ ï¼ˆåŒ…æ‹¬æ–‡æœ¬èŠ‚ç‚¹ï¼‰åˆ é™¤HTML ä»£ç ï¼š1&lt;p&gt;Hello, &lt;span&gt;Person&lt;/span&gt; &lt;a href="#"&gt;and person&lt;/a&gt;&lt;/p&gt;jQuery ä»£ç ï¼š1$("p").empty();ç»“æžœï¼š1&lt;p&gt;&lt;/p&gt; â€‹remove([expr])ä»ŽDOMä¸­åˆ é™¤æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ã€‚è¿™ä¸ªæ–¹æ³•ä¸ä¼šæŠŠåŒ¹é…çš„å…ƒç´ ä»ŽjQueryå¯¹è±¡ä¸­åˆ é™¤ï¼Œå› è€Œå¯ä»¥åœ¨å°†æ¥å†ä½¿ç”¨è¿™äº›åŒ¹é…çš„å…ƒç´ ã€‚ä½†é™¤äº†è¿™ä¸ªå…ƒç´ æœ¬èº«å¾—ä»¥ä¿ç•™ä¹‹å¤–ï¼Œå…¶ä»–çš„æ¯”å¦‚ç»‘å®šçš„äº‹ä»¶ï¼Œé™„åŠ çš„æ•°æ®ç­‰éƒ½ä¼šè¢«ç§»é™¤ã€‚ç¤ºä¾‹1ï¼šä»ŽDOMä¸­æŠŠæ‰€æœ‰æ®µè½åˆ é™¤HTML ä»£ç ï¼š1&lt;p&gt;Hello&lt;/p&gt; how are &lt;p&gt;you?&lt;/p&gt;jQuery ä»£ç ï¼š1$("p").remove();ç»“æžœï¼š1how areç¤ºä¾‹2ï¼šä»ŽDOMä¸­æŠŠå¸¦æœ‰helloç±»çš„æ®µè½åˆ é™¤ã€‚HTML ä»£ç ï¼š1&lt;p class="hello"&gt;Hello&lt;/p&gt; how are &lt;p&gt;you?&lt;/p&gt;jQuery ä»£ç ï¼š1$("p").remove(".hello");ç»“æžœï¼š1how are &lt;p&gt;you?&lt;/p&gt; â€‹detach([expr])ä»ŽDOMä¸­åˆ é™¤æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ã€‚ è¿™ä¸ªæ–¹æ³•ä¸ä¼šæŠŠåŒ¹é…çš„å…ƒç´ ä»ŽjQueryå¯¹è±¡ä¸­åˆ é™¤ï¼Œå› è€Œå¯ä»¥åœ¨å°†æ¥å†ä½¿ç”¨è¿™äº›åŒ¹é…çš„å…ƒç´ ã€‚ä¸Žremove()ä¸åŒçš„æ˜¯ï¼Œæ‰€æœ‰ç»‘å®šçš„äº‹ä»¶ã€é™„åŠ çš„æ•°æ®ç­‰éƒ½ä¼šä¿ç•™ä¸‹æ¥ã€‚å¤åˆ¶clone([Even[,deepEven]])å…‹éš†åŒ¹é…çš„DOMå…ƒç´ å¹¶ä¸”é€‰ä¸­è¿™äº›å…‹éš†çš„å‰¯æœ¬ã€‚ç¤ºä¾‹1ï¼šå…‹éš†æ‰€æœ‰bå…ƒç´ ï¼ˆå¹¶é€‰ä¸­è¿™äº›å…‹éš†çš„å‰¯æœ¬ï¼‰ï¼Œç„¶åŽå°†å®ƒä»¬å‰ç½®åˆ°æ‰€æœ‰æ®µè½ä¸­ã€‚HTML ä»£ç :1&lt;b&gt;Hello&lt;/b&gt;&lt;p&gt;, how are you?&lt;/p&gt;jQuery ä»£ç :1$("b").clone().prependTo("p");ç»“æžœ:1&lt;b&gt;Hello&lt;/b&gt;&lt;p&gt;&lt;b&gt;Hello&lt;/b&gt;, how are you?&lt;/p&gt;ç¤ºä¾‹2ï¼šåˆ›å»ºä¸€ä¸ªæŒ‰é’®ï¼Œä»–å¯ä»¥å¤åˆ¶è‡ªå·±ï¼Œå¹¶ä¸”ä»–çš„å‰¯æœ¬ä¹Ÿæœ‰åŒæ ·åŠŸèƒ½ã€‚HTML ä»£ç :1&lt;button&gt;Clone Me!&lt;/button&gt;jQuery ä»£ç :123$("button").click(function()&#123; $(this).clone(true).insertAfter(this);&#125;); â€‹]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨æ³¨è§£é…ç½®AOPåˆ‡é¢]]></title>
    <url>%2F%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3%E9%85%8D%E7%BD%AEAOP%E5%88%87%E9%9D%A2.html</url>
    <content type="text"><![CDATA[æ³¨è§£åˆ‡é¢é™¤äº†ä½¿ç”¨XMLé…ç½®AOPåˆ‡é¢ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨æ›´ç®€æ´çš„æ³¨è§£é…ç½®ã€‚çŽ°ä½¿ç”¨æ³¨è§£ä¿®æ”¹Audienceç±»ï¼š123456789101112131415161718192021222324252627282930313233343536import org.aspectj.lang.ProceedingJoinPoint;import org.aspectj.lang.annotation.AfterReturning;import org.aspectj.lang.annotation.AfterThrowing;import org.aspectj.lang.annotation.Aspect;import org.aspectj.lang.annotation.Before;import org.aspectj.lang.annotation.Pointcut;import org.springframework.stereotype.Component;@Component@Aspectpublic class Audience &#123; // å£°æ˜Žåˆ‡ç‚¹ @Pointcut("execution(* com.spring.entity.Performer.perform(..))") public void performance()&#123; &#125; // è¡¨æ¼”ä¹‹å‰ @Before("performance()") public void takeSeats()&#123; System.out.println("è§‚ä¼—å…¥åº§"); &#125; // è¡¨æ¼”ä¹‹å‰ @Before("performance()") public void turnOffCellPhones()&#123; System.out.println("å…³é—­æ‰‹æœº"); &#125; // è¡¨æ¼”ä¹‹åŽ @AfterReturning("performance()") public void applaud()&#123; System.out.println("å•ªå•ªå•ªå•ªå•ª"); &#125; // è¡¨æ¼”å¤±è´¥åŽ @AfterThrowing("performance()") public void failure()&#123; System.out.println("å‘çˆ¹ï¼Œé€€é’±ï¼"); &#125;&#125;@Aspectä½¿å¾—Audienceæˆä¸ºäº†åˆ‡é¢ã€‚ä¸ºäº†è®©Springè¯†åˆ«æ”¹æ³¨è§£ï¼Œæˆ‘ä»¬è¿˜éœ€åœ¨XMLä¸­æ·»åŠ &lt;aop:aspectj-autoproxy/&gt;ã€‚&lt;aop:aspectj-autoproxy/&gt;å°†åœ¨Springåº”ç”¨ä¸Šä¸‹æ–‡ä¸­åˆ›å»ºä¸€ä¸ªAnnotationAwareAspectJAutoProxyCreatorç±»ï¼Œå®ƒä¼šè‡ªåŠ¨ä»£ç†@Aspectæ ‡æ³¨çš„Beanï¼š1&lt;aop:aspectj-autoproxy proxy-target-class="true" /&gt;å®žä¾‹åŒ–kennyï¼Œè¾“å‡ºï¼š123456è§‚ä¼—å…¥åº§å…³é—­æ‰‹æœºå”±ï¼šMay Rainå¹è¨å…‹æ–¯å•ªå•ªå•ªå•ªå•ªå’ŒXMLé…ç½®AOPæ•ˆæžœä¸€æ ·ã€‚åœ¨è¿™é€”ä¸­é‡åˆ°é”™è¯¯ï¼š1ï¼šerror at ::0 can't find referenced pointcut XXXç½‘ç»œä¸Šçš„è¯´æ³•æ˜¯JDKä¸åŒ¹é…é€ æˆçš„ï¼Œæˆ‘åŽŸæ¥ç”¨çš„JDK1.7åŒ¹é…çš„æ˜¯aspectjrt.1.6å’Œaspectjweaver.1.6,å› æ­¤ä¼šæŠ¥é”™ã€‚ å¦‚æžœè¦ä½¿ç”¨AspectJå®Œæˆæ³¨è§£åˆ‡é¢éœ€è¦æ³¨æ„ä¸‹é¢çš„JDKä¸ŽAspectJçš„åŒ¹é…ï¼šJDK1.6 â€”â€” aspectJ1.6JDK1.7 â€”â€” aspectJ1.7.3+aspectJ1.7ä¸‹è½½é“¾æŽ¥ï¼šå¯†ç ï¼š6wd7æ³¨è§£çŽ¯ç»•é€šçŸ¥ä½¿ç”¨@Aroundæ³¨è§£çŽ¯ç»•é€šçŸ¥ï¼š123456789101112131415161718192021222324@Component@Aspectpublic class Audience &#123; // å£°æ˜Žåˆ‡ç‚¹ @Pointcut("execution(* com.spring.entity.Performer.perform(..))") public void performance()&#123; &#125; @Around("performance()") public void watch(ProceedingJoinPoint joinpoint)&#123; try&#123; System.out.println("è§‚ä¼—å…¥åº§"); System.out.println("å…³é—­æ‰‹æœº"); long start=System.currentTimeMillis(); // æ‰§è¡Œè¢«é€šçŸ¥çš„æ–¹æ³•ï¼ joinpoint.proceed(); long end=System.currentTimeMillis(); System.out.println("å•ªå•ªå•ªå•ªå•ª"); System.out.println("è¡¨æ¼”è€—æ—¶ï¼š"+(end-start)+" milliseconds"); &#125;catch(Throwable t)&#123; System.out.println("å‘çˆ¹ï¼Œé€€é’±ï¼"); &#125; &#125;&#125;å®žä¾‹åŒ–kennyï¼Œè¾“å‡ºï¼š123456è§‚ä¼—å…¥åº§å…³é—­æ‰‹æœºå”±ï¼šMay Rainå¹è¨å…‹æ–¯å•ªå•ªå•ªå•ªå•ªè¡¨æ¼”è€—æ—¶ï¼š30 millisecondsæ³¨è§£ä¼ é€’å‚æ•°ä¿®æ”¹Magicianç±»ï¼š123456789101112131415161718192021222324import org.aspectj.lang.annotation.Aspect;import org.aspectj.lang.annotation.Before;import org.aspectj.lang.annotation.Pointcut;import org.springframework.stereotype.Component;@Component@Aspectpublic class Magician implements MindReader&#123; private String thoughts; // å£°æ˜Žå‚æ•°åŒ–åˆ‡ç‚¹ @Pointcut("execution(* com.spring.entity." + "Thinker.thinkOfSomething(String)) &amp;&amp; args(thoughts)") public void thinking(String thoughts) &#123; &#125; // æŠŠå‚æ•°ä¼ é€’ç»™é€šçŸ¥ @Before("thinking(thoughts)") public void interceptThoughts(String thoughts) &#123; System.out.println("ä¾¦å¬å¿—æ„¿è€…çš„å¿ƒå£°"); this.thoughts=thoughts; &#125; public String getThoughts() &#123; return thoughts; &#125;&#125;&lt;aop:pointcut&gt;å˜ä¸º@Pointcutæ³¨è§£ï¼Œ&lt;aop:before&gt;å˜ä¸º@Beforeæ³¨è§£ã€‚æµ‹è¯•ï¼š12345678910public class TestIntercept &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); Volunteer volunteer = (Volunteer) ac.getBean("volunteer"); volunteer.thinkOfSomething("æ¼”å‡ºçœŸç²¾å½©ï¼"); Magician magician = (Magician) ac.getBean("magician"); System.out.println("å¿—æ„¿è€…å¿ƒé‡Œæƒ³çš„æ˜¯ï¼š"+magician.getThoughts()); &#125;&#125;è¾“å‡ºï¼š12ä¾¦å¬å¿—æ„¿è€…çš„å¿ƒå£°å¿—æ„¿è€…å¿ƒé‡Œæƒ³çš„æ˜¯ï¼šæ¼”å‡ºçœŸç²¾å½©ï¼é€šè¿‡æ³¨è§£å¼•å…¥æ–°çš„æ–¹æ³•ä¹‹å‰é€šè¿‡åœ¨XMLä¸­é…ç½®AOPåˆ‡é¢çš„æ–¹æ³•ä¸ºBeanå¼•å…¥æ–°çš„æ–¹æ³•ï¼ŒçŽ°åœ¨æ”¹ç”¨æ³¨è§£çš„æ–¹å¼æ¥å®žçŽ°ï¼šæ–°å»ºä¸€ä¸ªContestantIntroducerç±»ï¼š123456789101112import org.aspectj.lang.annotation.Aspect;import org.aspectj.lang.annotation.DeclareParents;import org.springframework.stereotype.Component;@Component@Aspectpublic class ContestantIntroducer &#123; @DeclareParents( value = "com.spring.entity.Performer+", defaultImpl = OutstandingContestant.class) public static Contestant contestant;&#125;@DeclareParentsæ³¨è§£ä»£æ›¿äº†ä¹‹å‰çš„&lt;aop:declare-parents&gt;æ ‡ç­¾ã€‚ @DeclareParentsæ³¨è§£ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š1.valueå±žæ€§ç­‰åŒäºŽ&lt;aop:declare-parents&gt;çš„types-matchingå±žæ€§ã€‚å®ƒæ ‡è¯†åº”è¯¥è¢«å¼•å…¥æŒ‡å®šæŽ¥å£çš„Beanã€‚2.defaultImplå±žæ€§ç­‰åŒäºŽ&lt;aop:declare-parents&gt;çš„default-implå±žæ€§ã€‚å®ƒæ ‡è¯†è¯¥ç±»æ‰€å¼•å…¥æŽ¥å£çš„å®žçŽ°ã€‚3.ç”±@DeclareParentsæ³¨è§£æ‰€æ ‡æ³¨çš„staticå±žæ€§åˆ¶è®¢äº†å°†è¢«å¼•å…¥çš„æŽ¥å£ã€‚æµ‹è¯•ï¼š12345678910public class Play &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); Instrumentalist kenny = (Instrumentalist)ac.getBean("kenny"); kenny.perform(); Contestant kenny1=(Contestant) ac.getBean("kenny"); kenny1.receiveAward(); &#125;&#125;è¾“å‡ºï¼š1234567è§‚ä¼—å…¥åº§å…³é—­æ‰‹æœºå”±ï¼šMay Rainå¹è¨å…‹æ–¯å•ªå•ªå•ªå•ªå•ªè¡¨æ¼”è€—æ—¶ï¼š27 millisecondså‚åŠ é¢å¥–å…¸ç¤¼ã€ŠSpring In Actionã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åœ¨Spring XMLä¸­å£°æ˜Žåˆ‡é¢]]></title>
    <url>%2F%E5%9C%A8Spring-XML%E4%B8%AD%E5%A3%B0%E6%98%8E%E5%88%87%E9%9D%A2.html</url>
    <content type="text"><![CDATA[åœ¨Spring AOPä¸­ï¼Œéœ€è¦ä½¿ç”¨AspectJçš„åˆ‡ç‚¹è¡¨è¾¾å¼è¯­è¨€æ¥å®šä¹‰åˆ‡ç‚¹ã€‚ä¸‹è¡¨åˆ—å‡ºäº†Spring AOPæ‰€æ”¯æŒçš„AspectJåˆ‡ç‚¹æŒ‡ç¤ºå™¨ï¼šAspectJæŒ‡ç¤ºå™¨æè¿°arg()é™åˆ¶è¿žæŽ¥ç‚¹åŒ¹é…å‚æ•°ä¸ºæŒ‡å®šç±»åž‹çš„æ‰§è¡Œæ–¹æ³•@args()é™åˆ¶è¿žæŽ¥ç‚¹åŒ¹é…å‚æ•°ç”±æŒ‡å®šæ³¨è§£æ ‡æ³¨çš„æ‰§è¡Œæ–¹æ³•execution()ç”¨äºŽåŒ¹é…æ˜¯è¿žæŽ¥ç‚¹çš„æ‰§è¡Œæ–¹æ³•this()é™åˆ¶è¿žæŽ¥ç‚¹åŒ¹é…AOPä»£ç†çš„Beanå¼•ç”¨çš„æŒ‡å®šç±»åž‹çš„ç±»target()é™åˆ¶è¿žæŽ¥ç‚¹åŒ¹é…ç›®æ ‡å¯¹è±¡ä¸ºæ‰§è¡Œç±»åž‹çš„ç±»@target()é™åˆ¶è¿žæŽ¥ç‚¹åŒ¹é…ç‰¹å®šçš„æ‰§è¡Œå¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡å¯¹åº”çš„ç±»è¦å…·å¤‡æŒ‡å®šç±»åž‹çš„æ³¨è§£within()é™åˆ¶è¿žæŽ¥ç‚¹åŒ¹é…æŒ‡å®šçš„ç±»åž‹@within()é™åˆ¶è¿žæŽ¥ç‚¹åŒ¹é…æŒ‡å®šæ³¨è§£æ‰€æ ‡æ³¨çš„ç±»åž‹(å½“ä½¿ç”¨Spring AOPæ—¶ï¼Œæ–¹æ³•å®šä¹‰åœ¨ç”±æŒ‡å®šçš„æ³¨è§£æ‰€æ ‡æ³¨çš„ç±»é‡Œ)@annotation()é™åˆ¶åŒ¹é…å¸¦æœ‰æŒ‡å®šæ³¨è§£è¿žæŽ¥ç‚¹ç¼–å†™åˆ‡ç‚¹å¦‚ä¸‹æ‰€ç¤ºçš„åˆ‡ç‚¹è¡¨è¾¾å¼è¡¨ç¤ºå½“Instrumentçš„play()æ–¹æ³•æ‰§è¡Œæ—¶ä¼šè§¦å‘é€šçŸ¥ã€‚1execution(* com.spring.entity.Instrument.play(..))ä½¿ç”¨execution()æŒ‡ç¤ºå™¨é€‰æ‹©Instrumentçš„play()æ–¹æ³•ã€‚æ–¹æ³•è¡¨è¾¾å¼ä»¥*å¼€å§‹ï¼Œè¡¨ç¤ºè¿”å›žä»»æ„ç±»åž‹çš„è¿”å›žå€¼ã€‚ç„¶åŽæŒ‡å®šäº†å…¨é™å®šç±»åå’Œæ–¹æ³•åã€‚å¯¹äºŽå‚æ•°åˆ—è¡¨(..)æ ‡è¯†åˆ‡ç‚¹é€‰æ‹©ä»»æ„çš„pay()æ–¹æ³•ï¼Œæ— è®ºæ–¹æ³•çš„å…¥å‚æ˜¯ä»€ä¹ˆã€‚ä½¿ç”¨Springçš„Bean()æŒ‡ç¤ºå™¨Spring2.5å¼•å…¥äº†æ–°çš„bean()æŒ‡ç¤ºå™¨ã€‚å¦‚ï¼š1execution(* com.spring.entity.Instrument.play()) and bean(eddie)è¡¨ç¤ºï¼Œæ‰§è¡ŒInstrumentçš„play()æ–¹æ³•æ—¶åº”ç”¨é€šçŸ¥ï¼Œå¹¶ä¸”Beançš„IDä¸ºeddieã€‚XMLä¸­é…ç½®AOPåœ¨Spring XMLä¸­é…ç½®AOPä½¿ç”¨å…ƒç´ ï¼Œä¸‹è¡¨æ¦‚è¿°äº†AOPé…ç½®å…ƒç´ ã€‚AOPé…ç½®å…ƒç´ æè¿°&lt;aop:advisor&gt;å®šä¹‰AOPé€šçŸ¥å™¨&lt;aop:after&gt;å®šä¹‰AOPåŽç½®é€šçŸ¥(ä¸ç®¡è¢«é€šçŸ¥çš„æ–¹æ³•æ˜¯å¦æ‰§è¡ŒæˆåŠŸ)&lt;aop:after-returning&gt;å®šä¹‰AOP after-returningé€šçŸ¥&lt;aop:after-throwing&gt;å®šä¹‰AOP after-throwingé€šçŸ¥&lt;aop:around&gt;å®šä¹‰AOPçŽ¯ç»•é€šçŸ¥&lt;aop:aspect&gt;å®šä¹‰åˆ‡é¢&lt;aop:aspectj-autoproxy&gt;å¯ç”¨@AspectJæ³¨è§£é©±åŠ¨åˆ‡é¢&lt;aop:before&gt;å®šä¹‰AOPå‰ç½®é€šçŸ¥&lt;aop:config&gt;é¡¶å±‚çš„AOPé…ç½®å…ƒç´ &lt;aop:declare-parents&gt;ä¸ºè¢«é€šçŸ¥çš„å¯¹è±¡å¼•å…¥é¢å¤–çš„æŽ¥å£ï¼Œå¹¶é€æ˜Žçš„å®žçŽ°&lt;aop:pointcut&gt;å®šä¹‰åˆ‡ç‚¹ä¸ºäº†æ¼”ç¤ºSpring AOPï¼ŒçŽ°åœ¨å®šä¹‰ä¸€ä¸ªè§‚ä¼—ç±» Audienceï¼š123456789101112131415161718public class Audience &#123; // è¡¨æ¼”ä¹‹å‰ public void takeSeats()&#123; System.out.println("è§‚ä¼—å…¥åº§"); &#125; // è¡¨æ¼”ä¹‹å‰ public void turnOffCellPhones()&#123; System.out.println("å…³é—­æ‰‹æœº"); &#125; // è¡¨æ¼”ä¹‹åŽ public void applaud()&#123; System.out.println("å•ªå•ªå•ªå•ªå•ª"); &#125; // è¡¨æ¼”å¤±è´¥åŽ public void failure()&#123; System.out.println("å‘çˆ¹ï¼Œé€€é’±ï¼"); &#125;&#125;åœ¨Spring XMLä¸­é…ç½®è¯¥Beanï¼š1&lt;bean id="audience" class="com.spring.entity.Audience"/&gt;å£°æ˜Žå‰ç½®å’ŒåŽç½®é€šçŸ¥å°†audience Beanå˜æˆä¸€ä¸ªåˆ‡é¢ï¼š12345678910111213141516&lt;aop:config&gt; &lt;aop:aspect ref="audience"&gt; &lt;aop:before pointcut= "execution(* com.spring.entity.Performer.perform(..))" method="takeSeats"/&gt; &lt;aop:before pointcut= "execution(* com.spring.entity.Performer.perform(..))" method="turnOffCellPhones"/&gt; &lt;aop:after-returning pointcut= "execution(* com.spring.entity.Performer.perform(..))" method="applaud"/&gt; &lt;aop:after-throwing pointcut= "execution(* com.spring.entity.Performer.perform(..))" method="failure"/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt;å››ä¸ªåˆ‡ç‚¹çš„è¡¨è¾¾å¼å®Œå…¨ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ–ä¸Šè¿°å†™æ³•ï¼š1234567891011121314&lt;aop:config&gt; &lt;aop:aspect ref="audience"&gt; &lt;aop:pointcut id="performance" expression="execution(* com.spring.entity.Performer.perform(..))"/&gt; &lt;aop:before pointcut-ref="performance" method="takeSeats"/&gt; &lt;aop:before pointcut-ref="performance" method="turnOffCellPhones"/&gt; &lt;aop:after-returning pointcut-ref="performance" method="applaud"/&gt; &lt;aop:after-throwing pointcut-ref="performance" method="failure"/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt;å†æ¬¡å®žä¾‹åŒ–kennyï¼š12345678public class Play &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); Instrumentalist kenny=(Instrumentalist)ac.getBean("kenny"); kenny.perform(); &#125;&#125;ç»“æžœå‘çŽ°æŠ¥é”™ï¼š12Exception in thread "main" java.lang.ClassCastException: com.sun.proxy.$Proxy8 cannot be cast to...åŽŸå› æš‚æ—¶è¿˜ä¸æ™“å¾—â€¦ðŸ˜¢è§£å†³åŠžæ³•ï¼Œåœ¨&lt;aop:config&gt;å…ƒç´ æ·»åŠ proxy-target-class=&quot;true&quot;ï¼š123&lt;aop:config proxy-target-class="true"&gt; //...&lt;/aop:config&gt;è¾“å‡ºï¼š12345è§‚ä¼—å…¥åº§å…³é—­æ‰‹æœºå”±ï¼šMay Rainå¹è¨å…‹æ–¯å•ªå•ªå•ªå•ªå•ªçŽ°åœ¨åœ¨Instrumentalistçš„perform()æ–¹æ³•é‡Œåˆ¶é€ ä¸€ä¸ªå¼‚å¸¸ï¼š12345public void perform() &#123; System.out.println("å”±ï¼š"+song+""); instrument = null; instrument.play();&#125;å®žä¾‹åŒ–kennyè¾“å‡ºï¼š12345è§‚ä¼—å…¥åº§å…³é—­æ‰‹æœºå”±ï¼šMay Rainå‘çˆ¹ï¼Œé€€é’±ï¼Exception in thread "main" java.lang.NullPointerExceptionå£°æ˜ŽçŽ¯ç»•é€šçŸ¥å¦‚æžœä¸ä½¿ç”¨æˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆåœ¨å‰ç½®é€šçŸ¥å’ŒåŽç½®é€šçŸ¥ä¹‹é—´å…±äº«ä¿¡æ¯æ˜¯éžå¸¸éº»çƒ¦çš„ã€‚å¯ä»¥ä½¿ç”¨çŽ¯ç»•é€šçŸ¥ä»£æ›¿å‰ç½®é€šçŸ¥å’ŒåŽç½®é€šçŸ¥ï¼ŒçŽ°åœ¨åœ¨Audienceç±»é‡Œæ·»åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼š123456789101112131415 public void watch(ProceedingJoinPoint joinpoint)&#123; try&#123; System.out.println("è§‚ä¼—å…¥åº§"); System.out.println("å…³é—­æ‰‹æœº"); long start=System.currentTimeMillis(); // æ‰§è¡Œè¢«é€šçŸ¥çš„æ–¹æ³•ï¼ joinpoint.proceed(); long end=System.currentTimeMillis(); System.out.println("å•ªå•ªå•ªå•ªå•ª"); System.out.println("è¡¨æ¼”è€—æ—¶ï¼š"+(end-start)+"milliseconds"); &#125;catch(Throwable t)&#123; System.out.println("å‘çˆ¹ï¼Œé€€é’±ï¼"); &#125;&#125;å¯¹äºŽæ–°çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ProceedingJoinPointä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥åœ¨é€šçŸ¥é‡Œè°ƒç”¨è¢«é€šçŸ¥çš„æ–¹æ³•ï¼ï¼æˆ‘ä»¬è¦æŠŠæŽ§åˆ¶è½¬ç»™è¢«é€šçŸ¥çš„æ–¹æ³•æ—¶ï¼Œå¿…é¡»è°ƒç”¨ProceedingJoinPointçš„proceed()æ–¹æ³•ã€‚ä¿®æ”¹&lt;aop:config&gt;å…ƒç´ ï¼š123456789&lt;aop:config proxy-target-class="true"&gt; &lt;aop:aspect ref="audience"&gt; &lt;aop:pointcut id="performance" expression="execution(* com.spring.entity.Performer.perform(..))"/&gt; &lt;aop:around pointcut-ref="performance" method="watch"/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt;å®žä¾‹åŒ–kennyè¾“å‡ºï¼š123456è§‚ä¼—å…¥åº§å…³é—­æ‰‹æœºå”±ï¼šMay Rainå¹è¨å…‹æ–¯å•ªå•ªå•ªå•ªå•ªè¡¨æ¼”è€—æ—¶ï¼š20 millisecondså‡å¦‚ä¸è°ƒç”¨ProceedingJoinPointçš„proceed()æ–¹æ³•å‘çŽ°è¾“å‡ºä¸ºï¼š1234è§‚ä¼—å…¥åº§å…³é—­æ‰‹æœºå•ªå•ªå•ªå•ªå•ªè¡¨æ¼”è€—æ—¶ï¼š0 millisecondsè¿™æ ·æˆ‘ä»¬ä½¿ç”¨AOPå°±æ²¡å•¥æ„ä¹‰äº†ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥é‡å¤è°ƒç”¨ProceedingJoinPointçš„proceed()æ–¹æ³•ï¼Œé‡å¤æ‰§è¡Œperform()æ–¹æ³•ï¼Œè¾“å‡ºï¼š12345678910è§‚ä¼—å…¥åº§å…³é—­æ‰‹æœºå”±ï¼šMay Rainå¹è¨å…‹æ–¯å”±ï¼šMay Rainå¹è¨å…‹æ–¯å”±ï¼šMay Rainå¹è¨å…‹æ–¯å•ªå•ªå•ªå•ªå•ªè¡¨æ¼”è€—æ—¶ï¼š22 millisecondsä¸ºé€šçŸ¥ä¼ é€’å‚æ•°å®šä¹‰ä¸€ä¸ªæ–°çš„å‚èµ›è€…ï¼Œä»–æ˜¯ä¸€ä¸ªè¯»å¿ƒè€…ï¼Œç”±MindReaderæŽ¥å£æ‰€å®šä¹‰ï¼š1234public interface MindReader &#123; void interceptThoughts(String thoughts); String getThoughts();&#125;é­”æœ¯å¸ˆMagicianå®žçŽ°è¯¥æŽ¥å£ï¼š1234567891011public class Magician implements MindReader&#123; private String thoughts; public void interceptThoughts(String thoughts) &#123; System.out.println("ä¾¦å¬å¿—æ„¿è€…çš„å¿ƒå£°"); this.thoughts=thoughts; &#125; public String getThoughts() &#123; return thoughts; &#125;&#125;å†å®šä¹‰ä¸€ä¸ªMagicianæ‰€è¦ä¾¦å¬çš„å¿—æ„¿è€…ï¼Œé¦–å…ˆå®šä¹‰ä¸€ä¸ªæ€è€ƒè€…æŽ¥å£ï¼š123public interface Thinker &#123; void thinkOfSomething(String thoughts);&#125;å¿—æ„¿è€…Volunteerå®žçŽ°è¯¥æŽ¥å£ï¼š123456789public class Volunteer implements Thinker&#123; private String thoughts; public void thinkOfSomething(String thoughts) &#123; this.thoughts=thoughts; &#125; public String getThoughts()&#123; return thoughts; &#125;&#125;æŽ¥ä¸‹æ¥ä½¿ç”¨Spring AOPä¼ é€’Volunteerçš„thoughtså‚æ•°ï¼Œä»¥æ­¤å®žçŽ°Magiciançš„ä¾¦å¬ã€‚ã€‚ã€‚:1234567891011&lt;bean id="magician" class="com.spring.entity.Magician"/&gt;&lt;aop:config proxy-target-class="true"&gt; &lt;aop:aspect ref="magician"&gt; &lt;aop:pointcut id="thinking" expression=" execution(* com.spring.entity.Volunteer.thinkOfSomething(String)) and args(thoughts)"/&gt; &lt;aop:before pointcut-ref="thinking" method="interceptThoughts" arg-names="thoughts"/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt;arg-nameså±žæ€§ä¼ é€’äº†å‚æ•°ç»™interceptThoughts()æ–¹æ³•ã€‚æµ‹è¯•ï¼š12345678910public class TestIntercept &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); Volunteer volunteer = (Volunteer) ac.getBean("volunteer"); volunteer.thinkOfSomething("æ¼”å‡ºçœŸç²¾å½©ï¼"); Magician magician = (Magician) ac.getBean("magician"); System.out.println("å¿—æ„¿è€…å¿ƒé‡Œæƒ³çš„æ˜¯ï¼š"+magician.getThoughts()); &#125;&#125;è¾“å‡ºï¼š12ä¾¦å¬å¿—æ„¿è€…çš„å¿ƒå£°å¿—æ„¿è€…å¿ƒé‡Œæƒ³çš„æ˜¯ï¼šæ¼”å‡ºçœŸç²¾å½©ï¼é€šè¿‡åˆ‡é¢å¼•å…¥æ–°çš„æ–¹æ³•çŽ°åœ¨å‡è®¾è¦ç»™Performeræ´¾ç”Ÿç±»æ·»åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼Œä¼ ç»Ÿåšæ³•æ˜¯æ‰¾åˆ°æ‰€æœ‰æ´¾ç”Ÿç±»ï¼Œè®©åŽé€ä¸ªå¢žåŠ æ–°çš„æ–¹æ³•æˆ–è€…å®žçŽ°ã€‚è¿™ä¸ä½†å¾ˆç´¯è€Œä¸”å‡è®¾ç¬¬ä¸‰æ–¹å®žçŽ°æ²¡æœ‰æºç çš„è¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šå˜å¾—å¾ˆå›°éš¾ã€‚å¹¸å¥½ï¼Œé€šè¿‡Spring AOPå¯ä»¥ä¸å¿…å…¥ä¾µæ€§åœ°æ”¹å˜åŽŸæœ‰åœ°å®žçŽ°ã€‚æ¯”å¦‚ï¼ŒçŽ°åœ¨è¦ç»™æ‰€æœ‰æ¼”å‡ºè€…æ·»åŠ ä¸€ä¸ªreceiveAward()æ–¹æ³•ï¼šæ–°å¢žä¸€ä¸ªæŽ¥å£Contestantï¼š123public interface Contestant &#123; void receiveAward();&#125;ç”±OutstandingContestantå®žçŽ°ï¼š12345public class OutstandingContestant implements Contestant&#123; public void receiveAward() &#123; System.out.println("å‚åŠ é¢å¥–å…¸ç¤¼"); &#125;&#125;XMLï¼š12345678&lt;aop:config proxy-target-class="true"&gt; &lt;aop:aspect&gt; &lt;aop:declare-parents types-matching="com.spring.entity.Performer+" implement-interface="com.spring.entity.Constentant" default-impl="com.spring.entity.OutstandingContestant"/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt;æˆ–è€…ï¼š123456789&lt;bean id="contestantDelegate" class="com.spring.entity.OutstandingContestant"/&gt;&lt;aop:config proxy-target-class="true"&gt; &lt;aop:aspect&gt; &lt;aop:declare-parents types-matching="com.spring.entity.Performer+" implement-interface="com.spring.entity.Contestant" delegate-ref="contestantDelegate"/&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt;types-matchingæŒ‡å®šæ‰€è¦æ·»åŠ æ–°æ–¹æ³•çš„æ´¾ç”Ÿç±»å®žçŽ°çš„æŽ¥å£ï¼Œimplement-interfaceæŒ‡å®šè¦å®žçŽ°æ–°çš„æŽ¥å£ï¼Œdefault-implæŒ‡å®šè¿™ä¸ªæŽ¥å£çš„å®žçŽ°ç±»ã€‚æµ‹è¯•ï¼š12345678910public class Play &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); Instrumentalist kenny=(Instrumentalist)ac.getBean("kenny"); kenny.perform(); Contestant kenny1=(Contestant) ac.getBean("kenny"); kenny1.receiveAward(); &#125;&#125;è¾“å‡ºï¼š123å”±ï¼šMay Rainå¹è¨å…‹æ–¯å‚åŠ é¢å¥–å…¸ç¤¼ã€ŠSpring In Actionã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AOPæœ¯è¯­]]></title>
    <url>%2FAOP%E6%9C%AF%E8%AF%AD.html</url>
    <content type="text"><![CDATA[åœ¨è½¯ä»¶ä¸šï¼ŒAOPä¸ºAspect Oriented Programmingçš„ç¼©å†™ï¼Œæ„ä¸ºï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®žçŽ°ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ã€‚AOPæ˜¯OOPçš„å»¶ç»­ï¼Œæ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ä¸ªçƒ­ç‚¹ï¼Œä¹Ÿæ˜¯Springæ¡†æž¶ä¸­çš„ä¸€ä¸ªé‡è¦å†…å®¹ï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ç§è¡ç”ŸèŒƒåž‹ã€‚åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»Žè€Œä½¿å¾—ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„è€¦åˆåº¦é™ä½Žï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ï¼ŒåŒæ—¶æé«˜äº†å¼€å‘çš„æ•ˆçŽ‡ã€‚â€”â€” ç™¾åº¦ç™¾ç§‘é€šçŸ¥(Advice)åœ¨AOPä¸­ï¼Œåˆ‡é¢çš„å·¥ä½œè¢«ç§°ä¸ºé€šçŸ¥ã€‚é€šçŸ¥å®šä¹‰äº†åˆ‡é¢æ˜¯ä»€ä¹ˆä»¥åŠä½•æ—¶ä½¿ç”¨ã€‚Springåˆ‡é¢å¯ä»¥åº”ç”¨5ä¸­ç±»åž‹çš„é€šçŸ¥ï¼šBefore â€”â€” åœ¨æ–¹æ³•è¢«è°ƒç”¨ä¹‹å‰è°ƒç”¨é€šçŸ¥ã€‚After â€”â€” åœ¨æ–¹æ³•å®Œæˆä¹‹åŽè°ƒç”¨é€šçŸ¥ï¼Œæ— è®ºæ–¹æ³•æ˜¯å¦æ‰§è¡ŒæˆåŠŸã€‚After-returning â€”â€” åœ¨æ–¹æ³•æˆåŠŸæ‰§è¡Œä¹‹åŽè°ƒç”¨é€šçŸ¥ã€‚After-throwing â€”â€” åœ¨æ–¹æ³•æŠ›å‡ºå¼‚å¸¸ä»¥åŽè°ƒç”¨é€šçŸ¥ã€‚Around â€”â€” é€šçŸ¥åŒ…è£¹äº†è¢«é€šçŸ¥çš„æ–¹æ³•ï¼Œåœ¨è¢«é€šçŸ¥çš„æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œè°ƒç”¨ä¹‹åŽæ‰§è¡Œè‡ªå®šä¹‰çš„è¡Œä¸ºã€‚è¿žæŽ¥ç‚¹(Joinpoint)è¿žæŽ¥ç‚¹æ˜¯åœ¨åº”ç”¨æ‰§è¡Œè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ’å…¥åˆ‡é¢çš„ä¸€ä¸ªç‚¹ã€‚è¿™ä¸ªç‚¹å¯ä»¥æ˜¯è°ƒç”¨æ–¹æ³•æ—¶ï¼ŒæŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œç”šè‡³æ˜¯ä¿®æ”¹ä¸€ä¸ªå­—æ®µæ—¶ã€‚åˆ‡é¢ä»£ç å¯ä»¥åˆ©ç”¨è¿™äº›ç‚¹æ’å…¥åˆ°åº”ç”¨çš„æ­£å¸¸æµç¨‹ä¹‹ä¸­ï¼Œå¹¶æ·»åŠ æ–°çš„è¡Œä¸ºã€‚åˆ‡ç‚¹(Pointcut)åˆ‡ç‚¹çš„å®šä¹‰ä¼šåŒ¹é…é€šçŸ¥æ‰€è¦ç»‡å…¥çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¿žæŽ¥ç‚¹ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ˜Žç¡®çš„ç±»å’Œæ–¹æ³•åç§°æ¥æŒ‡å®šè¿™äº›åˆ‡ç‚¹ï¼Œæˆ–æ˜¯åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼å®šä¹‰åŒ¹é…çš„ç±»å’Œæ–¹æ³•åç§°æ¨¡å¼æ¥æŒ‡å®šè¿™äº›åˆ‡ç‚¹ã€‚åˆ‡é¢(Aspect)åˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚é€šçŸ¥å’Œåˆ‡ç‚¹å…±åŒå®šä¹‰äº†å…³äºŽåˆ‡é¢çš„å…¨éƒ¨å†…å®¹ â€”â€” å®ƒæ˜¯ä»€ä¹ˆï¼Œåœ¨ä½•æ—¶å’Œä½•å¤„å®Œæˆå…¶åŠŸèƒ½ã€‚å¼•å…¥(Introduction)å¼•å…¥å…è®¸æˆ‘ä»¬å‘çŽ°æœ‰çš„ç±»æ·»åŠ æ–°çš„æ–¹æ³•å’Œå±žæ€§ã€‚ç»‡å…¥(Weaving)ç»‡å…¥æ˜¯å°†åˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡æ¥åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ã€‚åˆ‡é¢åœ¨æŒ‡å®šçš„è¿žæŽ¥ç‚¹è¢«ç»‡å…¥åˆ°ç›®æ ‡å¯¹è±¡ä¸­ã€‚åœ¨ç›®æ ‡å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸé‡Œæœ‰å¤šä¸ªç‚¹å¯ä»¥è¿›è¡Œç»‡å…¥ï¼šç¼–è¯‘å™¨ â€”â€” åˆ‡é¢åœ¨ç›®æ ‡ç±»ç¼–è¯‘æ—¶è¢«ç»‡å…¥ã€‚ç±»åŠ è½½æœŸ â€”â€” åˆ‡é¢åœ¨ç›®æ ‡ç±»åŠ è½½åˆ°JVMæ—¶è¢«ç»‡å…¥ã€‚è¿è¡ŒæœŸ â€”â€” åˆ‡é¢åœ¨åº”ç”¨è¿è¡Œçš„æŸä¸ªæ—¶å€™è¢«ç»‡å…¥ã€‚Spring AOPå°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ã€‚]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring è‡ªåŠ¨æ£€æµ‹Bean]]></title>
    <url>%2FSpring-%E8%87%AA%E5%8A%A8%E6%A3%80%E6%B5%8BBean.html</url>
    <content type="text"><![CDATA[å¼€å¯è‡ªåŠ¨æ£€æµ‹å¼€å¯è‡ªåŠ¨æ£€æµ‹Beanæœ‰ä¸¤ç§æ–¹å¼ï¼šXMLé…ç½®&lt;context:annotation-config&gt;è™½ç„¶æ¶ˆé™¤äº†&lt;property&gt;å’Œ&lt;constructor-arg&gt;å…ƒç´ ï¼Œä½†æˆ‘ä»¬ä»éœ€ä½¿ç”¨&lt;bean&gt;å…ƒç´ æ˜¾ç¤ºå®šä¹‰Beanã€‚&lt;context:component-scan&gt;é™¤äº†å®Œæˆä¸Ž&lt;context:annotation-config&gt;ä¸€æ ·çš„å·¥ä½œè¿˜å¯ä»¥è‡ªåŠ¨æ£€æµ‹Beanå’Œå®šä¹‰Beanã€‚åœ¨Spring XMLä¸­é…ç½®ï¼š12&lt;context:component-scan base-package="com.spring.entity"&gt;&lt;/context:component-scan&gt;base-packageæŒ‡å®šäº†æ‰«æçš„è·¯å¾„ã€‚Javaé…ç½®1234567import org.springframework.context.annotation.ComponentScan;import org.springframework.context.annotation.Configuration; @Configuration@ComponentScanpublic class InstrumentConfig&#123;&#125;@ComponentScanä¼šæ‰«æä¸Žè¯¥ç±»ç›¸åŒåŒ…ä¸‹çš„æ‰€æœ‰å¸¦æœ‰@Componentæ³¨è§£çš„ç±»ã€‚å¦‚æžœæƒ³æ˜Žç¡®æŒ‡å‡ºæ‰«æè·¯å¾„ï¼Œå¯ä»¥é…ç½®valueï¼š1@ComponentScan(basePackages="com.spring")ä¹Ÿå¯ä»¥é…ç½®å¤šä¸ªæ‰«æè·¯å¾„ï¼š1@ComponentScan(basePackages=&#123;"com.spring.entity","com.spring.dao"&#125;)é™¤äº†æŒ‡å®šæ‰«æè·¯å¾„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šæ‰«æçš„ç±»åž‹ï¼š1@ComponentScan(basePackageClasses=&#123;Piano.class,Guitar.class&#125;)ä¸ºè‡ªåŠ¨æ£€æµ‹æ ‡æ³¨Beanæ³¨è§£ç±»åž‹ï¼š@Component â€”â€” é€šç”¨çš„æž„é€ åž‹æ³¨è§£ï¼Œæ ‡è¯†è¯¥ç±»ä¸ºSpringç»„ä»¶ã€‚@Controller â€”â€” æ ‡è¯†å°†è¯¥ç±»å®šä¹‰ä¸ºSpring MVC Controllerç»„ä»¶ã€‚@Repository â€”â€” æ ‡è¯†å°†è¯¥ç±»å®šä¹‰ä¸ºæ•°æ®ä»“åº“ã€‚@Service â€”â€” æ ‡è¯†å°†è¯¥ç±»å®šä¹‰ä¸ºæœåŠ¡ã€‚é€šè¿‡æ ‡æ³¨è¿™äº›æ³¨è§£ï¼ŒSpringæ‰çŸ¥é“å“ªäº›ç±»è¦è¢«æ³¨å†Œä¸ºSpring Beanã€‚å¦‚ï¼Œä½¿ç”¨@Componentæ ‡æ³¨Guitarç±»ï¼š123456@Componentpublic class Guitar implements Instrument&#123; public void play() &#123; System.out.println("å¼¹å¥å‰ä»–"); &#125; &#125;Springæ‰«æcom.spring.entityåŒ…æ—¶ï¼Œä¼šå‘çŽ°ä½¿ç”¨@Componentæ³¨è§£æ‰€æ ‡æ³¨çš„Guitarï¼Œå¹¶è‡ªåŠ¨å°†å…¶æ³¨å†Œä¸ºSpring Beanã€‚Beançš„IDé»˜è®¤ä¸ºæ— é™å®šé¦–å­—æ¯å°å†™ç±»åï¼Œä¹Ÿå°±æ˜¯guitarã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜¾å¼è®¾å®šIDï¼š1234567891011121314151617181920212223242526272829@Component("kenny")public class Instrumentalist implements Performer&#123; @Value("May Rain") private String song; @Autowired @Qualifier("guitar") private Instrument instrument; public Instrumentalist() &#123; &#125; public void perform() &#123; System.out.println("å”±ï¼š"+song+""); instrument.play(); &#125; //æ³¨å…¥æ­Œæ›² public String getSong() &#123; return song; &#125; public void setSong(String song) &#123; this.song = song; &#125; public Instrument getInstrument() &#123; return instrument; &#125; //æ³¨å…¥ä¹å™¨ public void setInstrument(Instrument instrument) &#123; this.instrument = instrument; &#125;&#125;ä¹Ÿå¯ä»¥ä½¿ç”¨@Named(&quot;kenny&quot;)ä»£æ›¿@Component(&quot;kenny&quot;)ï¼Œä½†ä¸€èˆ¬æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨@Component(&quot;kenny&quot;)æ¯”è¾ƒç›´è§‚ã€‚ç„¶åŽå®žä¾‹åŒ–kenny Beanï¼š12345678public class Play &#123; public static void main(String[] args) &#123; ApplicationContext ac = new ClassPathXmlApplicationContext("applicationContext.xml"); Instrumentalist kenny=(Instrumentalist)ac.getBean("kenny"); kenny.perform(); &#125;&#125;è¾“å‡ºï¼š12å”±ï¼šMay Rainå¼¹å¥å‰ä»–çŽ°åœ¨åœ¨XMLä¸­æ²¡æœ‰ä»»ä½•&lt;bean&gt;å…ƒç´ ï¼Œä¹Ÿå®žçŽ°äº†å’Œå…ˆå‰ä¸€æ ·çš„æ•ˆæžœã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†ä¸¤ä¸ªé—®é¢˜ï¼š12345678Exception in thread "main" org.springframework.beans.factory.BeanDefinitionStoreException: Failed to read candidate component class: file [F:\workspaces\Spring\Spring2\build\classes\com\spring\entity\Guitar.class]; nested exception is org.springframework.core.NestedIOException: ASM ClassReader failed to parse class file - probably due to a new Java class file version that isn't supported yet: file [F:\workspaces\Spring\Spring2\build\classes\com\spring\entity\Guitar.class]; nested exception is java.lang.IllegalArgumentExceptioné€šè¿‡æŸ¥é˜…èµ„æ–™ï¼Œå‘çŽ°æœ‰ä½è€å¤–ç»™å‡ºäº†è§£é‡Šï¼šNote that the Java 8 bytecode level (-target 1.8, as required by -source 1.8) is only fully supported as of Spring Framework 4.0. In particular, Spring 3.2 based applications need to be compiled with a maximum of Java 7 as the target, even if they happen to be deployed onto a Java 8 runtime. Please upgrade to Spring 4 for Java 8 based applications.äºŽæ˜¯å°†jdkæ”¹ä¸º1.7ç‰ˆæœ¬ã€‚ä¿®æ”¹åŽåˆé‡åˆ°å¼‚å¸¸ï¼š12Exception in thread "main" java.lang.UnsupportedClassVersionError: ...åŽŸæ¥æ˜¯jdkç‰ˆæœ¬å’Œjvmç‰ˆæœ¬ä¸ä¸€è‡´æ‰€è‡´ã€‚å³é”®é¡¹ç›®â€“&gt;propertiesâ€“&gt;java compiler â€“&gt; Enable project specific settings â€“&gt;å°†compiler compliance levelè®¾ç½®ä¸º1.7ï¼Œè‡³æ­¤é—®é¢˜éƒ½è§£å†³äº†ã€‚è¿‡æ»¤ç»„ä»¶æ‰«æ&lt;context:component-scan&gt;é»˜è®¤æ‰«ææŒ‡å®šè·¯å¾„ä¸‹é€šè¿‡@Componentæ ‡æ³¨çš„Beanã€‚å‡å¦‚çŽ°åœ¨æˆ‘ä»¬åªè¦æŠŠInstrumentæ‰€æ´¾ç”Ÿçš„ç±»æ³¨å†Œä¸ºSpring Beanï¼Œæˆ‘ä»¬ä¸å¾—ä¸åŽ»æŸ¥çœ‹æ‰€æœ‰javaä»£ç ï¼Œä¸€ä¸ªä¸€ä¸ªçš„ç»™Instrumentæ´¾ç”Ÿç±»æ·»åŠ @Componentæ³¨è§£ï¼Œå‡å¦‚æœ‰ç¬¬ä¸‰æ–¹å®žçŽ°äº†Instrumentï¼Œå…¶æºç æˆ‘ä»¬è¿˜çœ‹ä¸åˆ°ï¼Œè¿™æ—¶å€™æ·»åŠ @Componentæ³¨è§£å°±å˜å¾—éžå¸¸å›°éš¾ç”šè‡³ä¸å¯èƒ½ã€‚å¹¸å¥½ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»™&lt;context:component-scan&gt;å…ƒç´ æ·»åŠ è¿‡æ»¤è¡Œä¸ºï¼šé€šè¿‡ä¸ºå…¶é…ç½®&lt;context:include-filter&gt;å’Œ&lt;context:exclude-filter&gt;å­å…ƒç´ ã€‚æ¯”å¦‚ï¼š123456&lt;context:component-scan base-package="com.spring.entity"&gt; &lt;context:include-filter type="assignable" expression="com.spring.entity.Instrument"/&gt; &lt;context:exclude-filter type="annotation" expression="com.spring.entity.SkipIt"/&gt;&lt;/context:component-scan&gt;å…¶ä¸­ï¼Œè¿‡æ»¤å™¨ç±»åž‹æœ‰5ç§ï¼šè¿‡æ»¤å™¨ç±»åž‹æè¿°annotationè¿‡æ»¤å™¨æ‰«æä½¿ç”¨æŒ‡å®šæ³¨è§£æ‰€æ ‡æ³¨çš„é‚£äº›ç±»ï¼Œé€šè¿‡expressionå±žæ€§æŒ‡å®šè¦æ‰«æçš„æ³¨è§£assignableè¿‡æ»¤å™¨æ‰«ææ´¾ç”ŸäºŽexpressionå±žæ€§æ‰€æŒ‡å®šç±»åž‹çš„é‚£äº›ç±»aspectjè¿‡æ»¤å™¨æ‰«æä¸Žexpressionå±žæ€§æ‰€æŒ‡å®šçš„AspectJè¡¨è¾¾å¼æ‰€åŒ¹é…çš„é‚£äº›ç±»customä½¿ç”¨è‡ªå®šä¹‰çš„org.springframework.core.type.TypeFilterå®žçŽ°ç±»ï¼Œè¯¥ç±»ç”±expression å±žæ€§æŒ‡å®šregexè¿‡æ»¤å™¨æ‰«æç±»çš„åç§°ä¸Žexpressionå±žæ€§æ‰€æŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼æ‰€åŒ¹é…çš„ç±»com.spring.entity.SkipItè‡ªå®šä¹‰é™å®šå™¨ï¼š123456@Target(&#123;ElementType.FIELD,ElementType.PARAMETER,ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Qualifierpublic @interface SkipIt &#123; &#125;com.spring.entityç›®å½•ä¸‹æœ‰ä¸‰ä¸ªç±»æ´¾ç”ŸäºŽInstrumentï¼šPianoï¼ŒSaxophoneï¼ŒGuitarã€‚çŽ°åœ¨ç”¨@SkipItæ ‡æ³¨Pianoå’ŒGuitarç±»ï¼š123456@SkipItpublic class Piano implements Instrument&#123; public void play() &#123; System.out.println("é’¢ç´å£°å“èµ·"); &#125;&#125;123456@SkipItpublic class Guitar implements Instrument&#123; public void play() &#123; System.out.println("å¼¹å¥å‰ä»–"); &#125; &#125;Saxophoneä¸åšä»»ä½•æ ‡æ³¨ï¼š12345public class Saxophone implements Instrument&#123; public void play() &#123; System.out.println("å¹è¨å…‹æ–¯"); &#125;&#125;å®žä¾‹åŒ–kennyï¼Œè¾“å‡ºï¼š12å”±ï¼šMay Rainå¹è¨å…‹æ–¯éžå¸¸æ–¹ä¾¿ï¼ã€ŠSpring In Actionã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring è‡ªåŠ¨è£…é…Bean]]></title>
    <url>%2FSpring-%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8DBean.html</url>
    <content type="text"><![CDATA[ä¸ºäº†ç®€åŒ–XMLé…ç½®ï¼ŒSpringæä¾›äº†è‡ªåŠ¨è£…é…ï¼ˆautowiringï¼‰ã€‚å››ç§ç±»åž‹è‡ªåŠ¨è£…é…byNameè‡ªåŠ¨è£…é…byNameè‡ªåŠ¨è£…é…éµå¾ªçº¦å®šï¼šä¸ºå±žæ€§è‡ªåŠ¨è£…é…IDä¸Žè¯¥å±žæ€§çš„åå­—ç›¸åŒçš„Beanã€‚ä¾‹å¦‚ï¼Œå°†å…ˆå‰çš„kennyä¾‹å­ï¼š1234&lt;bean id="kenny" class="com.spring.entity.Instrumentalist"&gt; &lt;property name="instrument" ref="saxophone"&gt;&lt;/property&gt; &lt;property name="song" value="May Rain"/&gt;&lt;/bean&gt;æ”¹ä¸ºï¼š123&lt;bean id="kenny" class="com.spring.entity.Instrumentalist" autowire="byName"&gt; &lt;property name="song" value="May Rain"/&gt;&lt;/bean&gt;é€šè¿‡autowireå±žæ€§ï¼ŒSpringå°±å¯ä»¥åˆ©ç”¨æ­¤ä¿¡æ¯è‡ªåŠ¨è£…é…kennyçš„å‰©ä¸‹çš„instrumentå±žæ€§äº†ã€‚é…ç½®ä¸€ä¸ªidä¸ºâ€instrumentâ€çš„Beanï¼š1&lt;bean id="instrument" class="com.spring.entity.Saxophone"/&gt;è¿™æ ·ï¼Œsaxophoneå°±è‡ªåŠ¨è£…é…ç»™kennyçš„instrumentå±žæ€§äº†ã€‚å½“æ‰¾ä¸åˆ°æ—¶ï¼Œåˆ™è¯¥å±žæ€§ä¸è¿›è¡Œè£…é…ã€‚å¦‚æžœå¤šä¸ªInstrumentalist Beanéƒ½è¢«é…ç½®ä¸ºbyNameè‡ªåŠ¨è£…é…ï¼Œé‚£ä»–ä»¬å°†ä¼šæ¼”å¥åŒä¸€ä¸ªä¹å™¨ã€‚byTypeè‡ªåŠ¨è£…é…byTypeè‡ªåŠ¨è£…é…é€šè¿‡å¯»æ‰¾å“ªä¸€ä¸ªBeançš„ç±»åž‹ä¸Žå±žæ€§çš„ç±»åž‹ç›¸åŒ¹é…ã€‚å¦‚æžœæ‰¾åˆ°å¤šä¸ªä¸Žéœ€è¦è£…é…çš„å±žæ€§ç±»åž‹ç›¸åŒ¹é…çš„Beanï¼ŒSpringä¼šç›´æŽ¥æŠ›å‡ºå¼‚å¸¸ã€‚æ‰€ä»¥ï¼Œåº”ç”¨åªå…è®¸å­˜åœ¨ä¸€ä¸ªç±»åž‹ç›¸åŒ¹é…çš„Beanã€‚ä½†åœ¨å®žé™…ä¸­ï¼ŒXMLä¸­å¯èƒ½å­˜åœ¨å¤šä¸ªç±»åž‹ä¸€æ ·çš„Beanï¼Œä¸ºäº†è§£å†³è¿™ç§æƒ…å†µï¼ŒSpringæä¾›äº†ä¸¤ç§è§£å†³æ–¹æ³•ï¼šâ‘  ä¸ºè‡ªåŠ¨è£…é…æ ‡è¯†ä¸€ä¸ªé¦–é€‰Beanä½¿ç”¨&lt;bean&gt;å…ƒç´ çš„primaryå±žæ€§ã€‚å¦‚æžœåªæœ‰ä¸€ä¸ªè‡ªåŠ¨è£…é…çš„å€™é€‰Beançš„primaryå±žæ€§è®¾ç½®ä¸ºtrueï¼Œé‚£ä¹ˆå…¶å°†è¢«ä¼˜å…ˆé€‰æ‹©ã€‚æ¯”å¦‚è®¾ç½®saxophoneä¸ºé¦–é€‰Beanï¼š1&lt;bean id="saxophone" class="com.spring.entity.Saxophone" primary="true"/&gt;ä¹Ÿå¯ä»¥ä½¿ç”¨@Primaryæ³¨è§£ã€‚ â‘¡ å–æ¶ˆæŸä¸ªBeanè‡ªåŠ¨è£…é…çš„å€™é€‰èµ„æ ¼ä½¿ç”¨æ–¹æ³•ä¸ºè®¾ç½®Beançš„autowire-candidateå±žæ€§ä¸ºfalseå³å¯ï¼š1&lt;bean id="saxophone" class="com.spring.entity.Saxophone" autowire-candidate="false"/&gt;constructorè‡ªåŠ¨è£…é…å¦‚æžœé€šè¿‡æž„é€ å™¨æ³¨å…¥é…ç½®Beanï¼Œé‚£ä¹ˆå¯ä»¥ç§»é™¤&lt;constructor-arg&gt;å…ƒç´ ã€‚å¦‚å°†å…ˆå‰çš„dukeé…ç½®ï¼š1&lt;bean id="duke" class="com.spring.entity.Juggler" autowire="constructor"/&gt;é€šè¿‡autowire=&quot;constructor&quot;å£°æ˜Žï¼ŒSpringä¼šåŽ»èŽ·å–JuggleræŸä¸ªæž„é€ å™¨çš„æ‰€æœ‰å‚æ•°ç±»åž‹ï¼Œç„¶åŽå†XMLä¸­å¯»æ‰¾ä¸Žå…¶ç±»åž‹åŒ¹é…çš„Beanã€‚soï¼Œconstructorè‡ªåŠ¨è£…é…ä¸ŽbyTypeè‡ªåŠ¨è£…é…å…·æœ‰ç›¸åŒçš„å±€é™æ€§ã€‚autodetectè‡ªåŠ¨è£…é…detect è‹±[dÉªËˆtekt] ç¾Ž[dÉªËˆtÉ›kt] vt. æŸ¥æ˜Žï¼Œå‘çŽ°; æ´žå¯Ÿ; ä¾¦å¯Ÿï¼Œä¾¦æŸ¥; [ç”µå­å­¦] æ£€æ³¢1&lt;bean id="duke" class="com.spring.entity.Juggler" autowire="autodetect"/&gt;é€šè¿‡è¯¥å£°æ˜Žï¼ŒSpringé¦–æ¬¡å°è¯•ä½¿ç”¨constructorè‡ªåŠ¨è£…é…ï¼Œå¤±è´¥çš„è¯å†æ¬¡å°è¯•ä½¿ç”¨byTypeè‡ªåŠ¨è£…é…ã€‚é»˜è®¤è‡ªåŠ¨è£…é…é€šè¿‡é…ç½®&lt;beans&gt;å…ƒç´ ä¸Šå¢žåŠ ä¸€ä¸ªdefault-autowireå±žæ€§ï¼š123456789101112131415161718192021222324252627&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:util="http://www.springframework.org/schema/util" xmlns:jee="http://www.springframework.org/schema/jee" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:jpa="http://www.springframework.org/schema/data/jpa" xmlns:mvc="http://www.springframework.org/schema/mvc" xsi:schemaLocation=" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.2.xsd http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.3.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd" default-autowire="byType"&gt; &lt;!--Bean declarations go here --&gt;&lt;/beans&gt;è¿™æ ·çš„è¯ï¼ŒSpringé…ç½®æ–‡ä»¶é‡Œçš„æ‰€æœ‰Beanéƒ½å°†ä½¿ç”¨byTypeè‡ªåŠ¨è£…é…ï¼Œé™¤éžBeanè‡ªå·±é…ç½®äº†autowireå±žæ€§ã€‚æ··åˆè£…é…ä¸€ä¸ªBeanå¯ä»¥åŒæ—¶ä½¿ç”¨è‡ªåŠ¨è£…é…å’Œæ˜¾ç¤ºè£…é…ï¼Œå¦‚ï¼š12345&lt;bean id="kenny" class="com.spring.entity.Instrumentalist" autowire="byType"&gt; &lt;property name="song" value="May Rain"/&gt; &lt;property name="instrument" ref="saxophone"&gt;&lt;/property&gt;&lt;/bean&gt;æ··åˆä½¿ç”¨å¯ä»¥é¿å…å½“è‡ªåŠ¨è£…é…å¤±è´¥çš„æ—¶å€™ï¼Œä½¿ç”¨æ˜¾ç¤ºè£…é…è¦†ç›–è‡ªåŠ¨è£…é…ã€‚ä½¿ç”¨constructorè‡ªåŠ¨è£…é…æ—¶ï¼Œä¸èƒ½æ··åˆä½¿ç”¨constructorè‡ªåŠ¨è£…é…ç­–ç•¥å’Œå…ƒç´ ã€‚ä½¿ç”¨æ³¨è§£è£…é…1&lt;context:annotation-config/&gt;annotation è‹±[ËŒÃ¦nÉ™â€™teÉªÊƒn] ç¾Ž[ËŒÃ¦nÉ™â€™teÉªÊƒn] n. æ³¨é‡Š;&lt;context:annotation-config/&gt;å¯ä»¥æ¶ˆé™¤Springä¸­çš„&lt;property&gt;å’Œ&lt;constructor-arg&gt;å…ƒç´ ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—ä½¿ç”¨&lt;bean&gt;å…ƒç´ æ˜¾ç¤ºå®šä¹‰Beanã€‚@Autowiredä¾‹å¦‚ï¼Œåœ¨Instrumentalistçš„setInstrument()æ–¹æ³•è¿›è¡Œæ ‡æ³¨ï¼š12345//æ³¨å…¥ä¹å™¨@Autowiredpublic void setInstrument(Instrument instrument) &#123; this.instrument = instrument;&#125;è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç§»é™¤ç”¨æ¥å®šä¹‰Instrumentalistçš„instrumentå±žæ€§æ‰€å¯¹åº”çš„&lt;property&gt;å…ƒç´ äº†ã€‚é€šè¿‡@Autowiredæ³¨è§£ï¼ŒSpringä¼šé€šè¿‡byTypeè‡ªåŠ¨è£…é…ã€‚å‡å¦‚@Autowiredæ³¨è§£æ ‡æ³¨äºŽå±žæ€§ï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤setteræ–¹æ³•ï¼š12@Autowiredprivate Instrument instrument;@Autowiredä¹Ÿå¯ä»¥æ ‡æ³¨äºŽæž„é€ å™¨ï¼Œè¿™æ ·XMLæ–‡ä»¶ä¸­å¯ä»¥çœåŽ»&lt;constructor-arg&gt;å…ƒç´ é…ç½®Beanï¼š1234@Autowiredpublic Instrumentalist(Instrument instrument) &#123; this.instrument=instrument;&#125;å½“å¤šä¸ªæž„é€ å™¨éƒ½é€šè¿‡@Autowiredæ³¨è§£çš„æ—¶å€™ï¼ŒSpringå°±ä¼šä»Žæ‰€æœ‰æ»¡è¶³è£…é…æ¡ä»¶çš„æž„é€ å™¨ä¸­é€‰æ‹©å‡ºå‚æ•°æœ€å¤šçš„é‚£ä¸ªã€‚å¯é€‰çš„è‡ªåŠ¨è£…é…ï¼šé€šè¿‡@Autowiredæ ‡æ³¨çš„å±žæ€§æˆ–è€…å‚æ•°å¿…é¡»æ˜¯å¯è£…é…çš„ã€‚å‡å¦‚åŒ¹é…å¤±è´¥ï¼Œåˆ™æŠ›å‡ºNoSuchBeanDefinitionExceptionå¼‚å¸¸ã€‚å‡å¦‚å±žæ€§ä¸ä¸€å®šè¦è£…é…ï¼Œnullå€¼ä¹Ÿå¯ä»¥æŽ¥æ”¶çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®required=fasleæ¥è®©è‡ªåŠ¨è£…é…å˜ä¸ºå¯é€‰ï¼š12@Autowired(required=false)private Instrument instrument;å½“ä½¿ç”¨æž„é€ å™¨è£…é…æ—¶ï¼Œåªæœ‰ä¸€ä¸ªæž„é€ å™¨å¯ä»¥å°†@Autowiredçš„requiredå±žæ€§è®¾ç½®ä¸ºtrueï¼Œå…¶ä½™çš„åªèƒ½è®¾ç½®ä¸ºfalseã€‚é™å®šæ­§ä¹‰æ€§ä¾èµ–ï¼šå¦‚æžœé€šè¿‡@Autowiredæ³¨è§£åŒ¹é…åˆ°å¥½å‡ ä¸ªBeanï¼Œä¸ºäº†é‰´åˆ«å“ªä¸€ä¸ªæ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨@Autowiredæ³¨è§£ä¸‹æ·»åŠ @Qualifieræ³¨è§£ï¼šqualifier è‹±[ËˆkwÉ’lÉªfaÉªÉ™(r)] ç¾Ž[ËˆkwÉ‘:lÉªfaÉªÉ™(r)] n. åˆæ ¼è€…ï¼Œå·²å–å¾—èµ„æ ¼çš„äºº; [è¯­] ä¿®é¥°è¯­; é¢„é€‰èµ›ï¼Œèµ„æ ¼èµ›123@Autowired@Qualifier("guitar")private Instrument instrument;å¦‚ä¸Šæ‰€ç¤ºï¼Œ@Qualifieræ³¨è§£å°†å°è¯•æ³¨å…¥IDä¸ºâ€guitarâ€çš„Beanã€‚é™¤äº†é€šè¿‡Beançš„IDæ¥åŒ¹é…ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¿®æ”¹guitar Beané…ç½®ï¼š123&lt;bean class="com.spring.entity.Guitar"&gt; &lt;qualifier value="Stringed"/&gt;&lt;/bean&gt;&lt;qualifier&gt;å…ƒç´ é™å®šäº†guitar Beanæ˜¯ä¸€ä¸ªå¼¦ä¹å™¨(stringed)ã€‚è¿™æ—¶å€™å¯ä»¥å°†ä¸Šé¢çš„æ³¨è§£ä¿®æ”¹ä¸ºï¼š123@Autowired@Qualifier("Stringed")private Instrument instrument;åˆ›å»ºè‡ªå®šä¹‰çš„é™å®šå™¨ï¼šé¦–å…ˆï¼Œé€šè¿‡å¦‚ä¸‹ä»£ç åˆ›å»ºè‡ªå®šä¹‰çš„é™å®šå™¨ï¼š123456789101112import java.lang.annotation.ElementType;import java.lang.annotation.Retention;import java.lang.annotation.RetentionPolicy;import java.lang.annotation.Target;import org.springframework.beans.factory.annotation.Qualifier; @Target(&#123;ElementType.FIELD,ElementType.PARAMETER,ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Qualifierpublic @interface StringedInstrument &#123; &#125;è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨guitarç±»ä¸Šæ·»åŠ æ­¤é™å®šå™¨ï¼š123456@StringedInstrumentpublic class Guitar implements Instrument&#123; public void play() &#123; System.out.println("å¼¹å¥å‰ä»–"); &#125; &#125;åœ¨è‡ªåŠ¨è£…é…çš„instrumentå±žæ€§è¿›è¡Œé™å®šï¼š123@Autowired@StringedInstrumentprivate Instrument instrument;è¿™æ ·guitarå°±ä¼šè¢«è£…é…çš„instrumentå±žæ€§é‡Œï¼å‡å¦‚åŒ¹é…åˆ°å¤šä¸ªBeanï¼Œéœ€è¦è¿›ä¸€æ­¥çš„ç¼©å°èŒƒå›´ï¼Œç»§ç»­å®šä¹‰è‡ªå®šä¹‰é™å®šå™¨å³å¯ï¼@InjectMavenä¾èµ–ï¼š123456&lt;!-- https://mvnrepository.com/artifact/javax.inject/javax.inject --&gt;&lt;dependency&gt; &lt;groupId&gt;javax.inject&lt;/groupId&gt; &lt;artifactId&gt;javax.inject&lt;/artifactId&gt; &lt;version&gt;1&lt;/version&gt;&lt;/dependency&gt;ä¸ºäº†è§„èŒƒå„ç§ä¾èµ–æ³¨å…¥æ¡†æž¶çš„ç¼–ç¨‹æ¨¡åž‹ï¼ŒJCP(Java Community Process)å‘å¸ƒäº†Javaä¾èµ–æ³¨å…¥è§„èŒƒï¼Œç®€ç§°ä¸ºJCR-330ã€‚Spring 3.0å¼€å§‹å…¼å®¹è¯¥ä¾èµ–æ³¨å…¥æ¨¡åž‹ã€‚@Injectæ³¨è§£å‡ ä¹Žå¯ä»¥å®Œå…¨æ›¿ä»£@Autowiredã€‚å¦‚ï¼š12@Injectprivate Instrument instrument;@Injectä¹Ÿå¯ä»¥æ ‡æ³¨äºŽå±žæ€§ï¼Œæ–¹æ³•å’Œæž„é€ å™¨ï¼Œä¸è¿‡@Injectæ²¡æœ‰requiredå±žæ€§ï¼Œæ‰€ä»¥@Injectæ³¨è§£æ‰€æ ‡æ³¨çš„ä¾èµ–å…³ç³»å¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚é™å®š@Injectæ‰€æ ‡æ³¨çš„å±žæ€§ç±»ä¼¼äºŽå‰é¢çš„@Qualifierï¼Œ@Injectæ‰€å¯¹åº”çš„æ˜¯@Namedæ³¨è§£ï¼š123@Inject@Named("piano")private Instrument instrument;åˆ›å»ºè‡ªå®šä¹‰çš„JSR-330 Qualifieré€šè¿‡ä¸‹é¢çš„ä»£ç åˆ›å»ºä¸€ä¸ªæ–°çš„@NewStringedInstrumentæ³¨è§£ï¼š123456789101112import java.lang.annotation.ElementType;import java.lang.annotation.Retention;import java.lang.annotation.RetentionPolicy;import java.lang.annotation.Target;import javax.inject.Qualifier; @Target(&#123;ElementType.FIELD,ElementType.PARAMETER,ElementType.TYPE&#125;)@Retention(RetentionPolicy.RUNTIME)@Qualifierpublic @interface NewStringedInstrument &#123; &#125;å’Œå‰é¢çš„è‡ªå®šä¹‰é™å®šå™¨å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯@Qualifieræ³¨è§£çš„å¯¼å…¥å£°æ˜Žã€‚åœ¨æ³¨è§£ä¸­ä½¿ç”¨SpELè¡¨è¾¾å¼Spring3.0 å¼•å…¥äº†@Valueï¼Œå…¶å¯ä»¥æ³¨è§£è£…é…Stringç±»åž‹å’ŒåŸºæœ¬ç±»åž‹çš„å€¼ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬é€šè¿‡@Valueæ³¨è§£ä¼ å…¥ä¸€ä¸ªStringç±»åž‹çš„å€¼ï¼š12@Value("May Rain")private String song;è¿™æ ·â€May Rainâ€å°±è¢«æ³¨å…¥åˆ°songå±žæ€§ä¸­äº†ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ç»“åˆSpELè¡¨è¾¾å¼ï¼š12@Value("#&#123;systemProperties.myFavoriteSong&#125;")private String song;@ResourceMavenä¾èµ–ï¼š123456&lt;!-- https://mvnrepository.com/artifact/javax.annotation/jsr250-api --&gt;&lt;dependency&gt; &lt;groupId&gt;javax.annotation&lt;/groupId&gt; &lt;artifactId&gt;jsr250-api&lt;/artifactId&gt; &lt;version&gt;1.0&lt;/version&gt;&lt;/dependency&gt;@Resourceæ³¨è§£æ˜¯JSR-250å‘å¸ƒçš„æ³¨è§£ã€‚ä¸Ž@Autowiredå’Œ@Injectä¸åŒçš„æ˜¯ï¼Œ@Resourceæ³¨è§£ä¸èƒ½ç”¨äºŽæž„é€ å™¨ï¼@Resourceæ³¨è§£é»˜è®¤ä½¿ç”¨byNameè‡ªåŠ¨è£…é…ï¼@Resourceæœ‰ä¸¤ä¸ªä¸­é‡è¦çš„å±žæ€§ï¼šnameå’Œtype ï¼Œè€ŒSpringå°†@Resourceæ³¨è§£çš„nameå±žæ€§è§£æžä¸ºbeançš„ åå­—ï¼Œè€Œtypeå±žæ€§åˆ™è§£æžä¸ºbeançš„ç±»åž‹ã€‚æ‰€ä»¥å¦‚æžœä½¿ç”¨nameå±žæ€§ï¼Œåˆ™ä½¿ç”¨byNameçš„è‡ªåŠ¨æ³¨å…¥ç­–ç•¥ï¼Œè€Œä½¿ç”¨typeå±žæ€§æ—¶åˆ™ä½¿ç”¨ byTypeè‡ªåŠ¨æ³¨å…¥ç­–ç•¥ã€‚å¦‚æžœæ—¢ä¸æŒ‡å®šnameä¹Ÿä¸æŒ‡å®štypeå±žæ€§ï¼Œè¿™æ—¶å°†é€šè¿‡åå°„æœºåˆ¶ä½¿ç”¨byNameè‡ªåŠ¨æ³¨å…¥ç­–ç•¥ã€‚byNameï¼š12@Resource(name="piano")private Instrument instrument;byTypeï¼š12@Resource(type=Instrument.class)private Instrument instrument;ã€ŠSpring In Actionã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SpELè¡¨è¾¾å¼]]></title>
    <url>%2FSpEL%E8%A1%A8%E8%BE%BE%E5%BC%8F.html</url>
    <content type="text"><![CDATA[Spring3å¼•å…¥äº†Springè¡¨è¾¾å¼è¯­è¨€(Spring Expression Languageï¼ŒSpEL)ã€‚å‰é¢ä»‹ç»çš„æ³¨å…¥éƒ½æ˜¯ç¼–å†™Springé…ç½®æ–‡ä»¶çš„æ—¶å€™å°±ç¡®å®šäº†çš„ã€‚è€ŒSpELå®ƒé€šè¿‡è¿è¡ŒæœŸé—´æ‰§è¡Œçš„è¡¨è¾¾å¼å°†å€¼è£…é…åˆ°Beançš„å±žæ€§æˆ–è€…æž„é€ å™¨å‚æ•°ä¸­ã€‚SpELæœ‰è®¸å¤šç‰¹æ€§ï¼š1.ä½¿ç”¨Beançš„IDæ¥å¼•ç”¨Bean2.è°ƒç”¨æ–¹æ³•å’Œè®¿é—®å¯¹è±¡çš„å±žæ€§3.å¯¹å€¼è¿›è¡Œç®—æ•°ï¼Œå…³ç³»å’Œé€»è¾‘è¿ç®—4.æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…5.é›†åˆæ“ä½œSpELçš„åŸºæœ¬ä½¿ç”¨å­—é¢å€¼æœ€ç®€å•çš„SpELè¡¨è¾¾å¼ä»…åŒ…å«ä¸€ä¸ªå­—é¢å€¼ã€‚å‡è®¾çŽ°åœ¨æŸä¸ªç±»çš„countå±žæ€§çš„å€¼ä¸º5ï¼Œæˆ‘ä»¬ç”¨SpELè¡¨è¾¾å¼è¡¨ç¤ºï¼š1&lt;property name="count" value="#&#123;5&#125;"/&gt;#{ }ç¬¦å·ä¼šæé†’Springï¼Œé‡Œé¢çš„å†…å®¹æ˜¯ä¸€ä¸ªSpELè¡¨è¾¾å¼ã€‚å®ƒä»¬è¿˜å¯ä»¥ä¸ŽéžSpELè¡¨è¾¾å¼æ··ç”¨ï¼š1&lt;property name="message" value="the value is #&#123;5&#125;"/&gt;JavaåŸºæœ¬æ•°æ®ç±»åž‹éƒ½å¯ä»¥å‡ºçŽ°åœ¨SpELè¡¨è¾¾å¼ä¸­ã€‚è¡¨è¾¾å¼ä¸­çš„æ•°å­—ä¹Ÿå¯ä»¥ä½¿ç”¨ç§‘å­¦è®°æ•°æ³•ï¼š1&lt;property name="salary" value="#&#123;1e4&#125;"/&gt;å¼•ç”¨Bean , Propertieså’Œæ–¹æ³•SpELè¡¨è¾¾å¼èƒ½å¤Ÿé€šè¿‡å…¶ä»–Beançš„IDè¿›è¡Œå¼•ç”¨ã€‚å¦‚ï¼š1&lt;constructor-arg value="#&#123;deceivedByLife&#125;"/&gt;å…¶ç­‰ä»·äºŽï¼š1&lt;constructor-arg ref="deceivedByLife"/&gt;carlå‚èµ›è€…æ˜¯ä¸€ä½æ¨¡ä»¿é«˜æ‰‹ï¼Œkennyå”±ä»€ä¹ˆæ­Œï¼Œå¼¹å¥ä»€ä¹ˆä¹å™¨ï¼Œä»–å°±å”±ä»€ä¹ˆæ­Œï¼Œå¼¹å¥ä»€ä¹ˆä¹å™¨ï¼š1234567&lt;bean id="kenny" class="com.spring.entity.Instrumentalist" p:song="May Rain" p:instrument-ref="piano"/&gt;&lt;bean id="carl" class="com.spring.entity.Instrumentalist"&gt; &lt;property name="instrument" value="#&#123;kenny.instrument&#125;"/&gt; &lt;property name="song" value="#&#123;kenny.song&#125;"/&gt;&lt;/bean&gt;As you can seeï¼Œå±žæ€§çš„å€¼ç”±keyå’Œvalueç»„æˆã€‚keyæŒ‡å®škenny&lt;bean&gt; çš„idï¼ŒvalueæŒ‡å®škenny&lt;bean&gt;çš„songå±žæ€§ã€‚å…¶ç­‰ä»·äºŽæ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼š12Instrumentalist carl = new Instrumentalist();carl.setSong(kenny.getSong());é™¤äº†è®¿é—®ç±»çš„å±žæ€§ï¼ŒSpELè¡¨è¾¾å¼è¿˜å¯ä»¥è®¿é—®ç±»çš„æ–¹æ³•ã€‚å‡è®¾çŽ°åœ¨æœ‰ä¸ªSongSelectorç±»ï¼Œè¯¥ç±»æœ‰ä¸ªselectSong()æ–¹æ³•ï¼Œè¿™æ ·çš„è¯carlå°±å¯ä»¥ä¸ç”¨æ¨¡ä»¿åˆ«äººï¼Œå¼€å§‹å”±songSelectoræ‰€é€‰çš„æ­Œäº†ï¼š1&lt;property name="song" value="#&#123;SongSelector.selectSong()&#125;"/&gt;carlæœ‰ä¸ªç™–å¥½ï¼Œæ­Œæ›²åä¸æ˜¯å¤§å†™çš„ä»–å°±æµ‘èº«éš¾å—ï¼Œæˆ‘ä»¬çŽ°åœ¨è¦åšçš„å°±æ˜¯ä»…ä»…å¯¹è¿”å›žçš„æ­Œæ›²è°ƒç”¨toUpperCase()æ–¹æ³•ï¼š1&lt;property name="song" value="#&#123;SongSelector.selectSong().toUpperCase()&#125;"/&gt;æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬ä¸èƒ½ç¡®ä¿ä¸æŠ›å‡ºNullPointerExceptionï¼Œä¸ºäº†é¿å…è¿™ä¸ªè®¨åŽŒçš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨SpELçš„null-safeå­˜å–å™¨1&lt;property name="song" value="#&#123;SongSelector.selectSong()?.toUpperCase()&#125;"/&gt;yesï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚?.ç¬¦å·ä¼šç¡®ä¿å·¦è¾¹çš„è¡¨è¾¾å¼ä¸ä¼šä¸ºnullï¼Œå¦‚æžœä¸ºnullçš„è¯å°±ä¸ä¼šè°ƒç”¨toUpperCase()æ–¹æ³•äº†ã€‚æ“ä½œç±»åœ¨SpELè¡¨è¾¾å¼ä¸­ï¼Œä½¿ç”¨T()è¿ç®—ç¬¦ä¼šè°ƒç”¨ç±»çš„ä½œç”¨åŸŸå’Œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦è°ƒç”¨java.lang.Mathçš„PIå€¼ï¼š1&lt;property name="pi" value="#&#123;T(java.lang.Math).PI&#125;"/&gt;èŽ·å–0~1éšæœºæ•°ï¼š1&lt;property name="random" value="#&#123;T(java.lang.Math).random()&#125;"/&gt;åœ¨SpELå€¼ä¸Šæ‰§è¡Œæ“ä½œSpELæä¾›äº†å‡ ç§è¿ç®—ç¬¦ï¼šè¿ç®—ç¬¦ç±»åž‹è¿ç®—ç¬¦ç®—æ•°è¿ç®—+, -, *, /, %, ^å…³ç³»è¿ç®—&lt;, &gt;, ==, &lt;=, &gt;=, lt, gt, eq, le, geé€»è¾‘è¿ç®—and, or, not, !æ¡ä»¶è¿ç®—?:(ternary), ?:(Elvis)æ­£åˆ™è¡¨è¾¾å¼matchesç®—æ•°è¿ç®—åŠ æ³•è¿ç®—ï¼š1&lt;property name="add" value="#&#123;counter.total+42&#125;"/&gt;åŠ å·è¿˜å¯ä»¥ç”¨äºŽå­—ç¬¦ä¸²æ‹¼æŽ¥ï¼š1&lt;property name="blogName" value="#&#123;my blog name is+' '+mrBird &#125;"/&gt;^è¿ç®—ç¬¦æ‰§è¡Œå¹‚è¿ç®—ï¼Œå…¶ä½™ç®—æ•°è¿ç®—ç¬¦å’ŒJavaä¸€æ¯›ä¸€æ ·ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚å…³ç³»è¿ç®—åˆ¤æ–­ä¸€ä¸ªBeançš„æŸä¸ªå±žæ€§æ˜¯å¦ç­‰äºŽ100ï¼š1&lt;property name="eq" value="#&#123;counter.total==100&#125;"/&gt;è¿”å›žå€¼æ˜¯booleanç±»åž‹ã€‚å…³ç³»è¿ç®—ç¬¦å”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨Spring XMLé…ç½®æ–‡ä»¶ä¸­ç›´æŽ¥å†™&gt;=å’Œ&lt;=ä¼šæŠ¥é”™ã€‚å› ä¸ºè¿™â€&lt;â€å’Œâ€&gt;â€ä¸¤ä¸ªç¬¦å·åœ¨XMLä¸­æœ‰ç‰¹æ®Šçš„å«ä¹‰ã€‚æ‰€ä»¥å®žé™…ä½¿ç”¨æ—¶ï¼Œæœ€å·ä½¿ç”¨æ–‡æœ¬ç±»åž‹ä»£æ›¿ç¬¦å·ï¼šè¿ç®—ç¬¦ç¬¦å·æ–‡æœ¬ç±»åž‹ç­‰äºŽ==eqå°äºŽ&lt;ltå°äºŽç­‰äºŽ&lt;=leå¤§äºŽ&gt;gtå¤§äºŽç­‰äºŽ&gt;=geå¦‚ï¼š1&lt;property name="eq" value="#&#123;counter.total le 100&#125;"/&gt;é€»è¾‘è¿ç®—SpELè¡¨è¾¾å¼æä¾›äº†å¤šç§é€»è¾‘è¿ç®—ç¬¦ï¼Œå…¶å«ä¹‰å’ŒJavaä¹Ÿæ˜¯ä¸€æ¯›ä¸€æ ·ï¼Œåªä¸è¿‡ç¬¦å·ä¸ä¸€æ ·ç½¢äº†ã€‚ä½¿ç”¨andè¿ç®—ç¬¦ï¼š1&lt;property name="largeCircle" value="#&#123;shape.kind == 'circle' and shape.perimeter gt 10000&#125;"/&gt;ä¸¤è¾¹ä¸ºtrueæ—¶æ‰è¿”å›žtrueã€‚å…¶ä½™æ“ä½œä¸€æ ·ï¼Œåªä¸è¿‡éžè¿ç®—æœ‰notå’Œ!ä¸¤ç§ç¬¦å·å¯ä¾›é€‰æ‹©ã€‚éžè¿ç®—ï¼š1&lt;property name="outOfStack" value="#&#123;!product.available&#125;"/&gt;æ¡ä»¶è¿ç®—æ¡ä»¶è¿ç®—ç¬¦ç±»ä¼¼äºŽJavaçš„ä¸‰ç›®è¿ç®—ç¬¦ï¼š12&lt;property name="instrument" value="#&#123;songSelector.selectSong() == 'May Rain' ? piano:saxphone&#125;"/&gt;å½“é€‰æ‹©çš„æ­Œæ›²ä¸ºâ€May Rainâ€çš„æ—¶å€™ï¼Œä¸€ä¸ªidä¸ºpianoçš„Beanå°†è£…é…åˆ°instrumentå±žæ€§ä¸­ï¼Œå¦åˆ™ä¸€ä¸ªidä¸ºsaxophoneçš„Beanå°†è£…é…åˆ°instrumentå±žæ€§ä¸­ã€‚æ³¨æ„åŒºåˆ«pianoå’Œå­—ç¬¦ä¸²â€œpianoâ€ï¼ä¸€ä¸ªå¸¸è§çš„ä¸‰ç›®è¿ç®—ç¬¦çš„ä½¿ç”¨åœºåˆæ˜¯åˆ¤æ–­æ˜¯å¦ä¸ºnullå€¼ï¼š1&lt;property name="song" value="#&#123;kenny.song !=null ? kenny.song:'Jingle Bells'&#125;"/&gt;è¿™é‡Œï¼Œkenny.songå¼•ç”¨é‡å¤äº†ä¸¤æ¬¡ï¼ŒSpELæä¾›äº†ä¸‰ç›®è¿ç®—ç¬¦çš„å˜ä½“æ¥ç®€åŒ–è¡¨è¾¾å¼ï¼š1&lt;property name="song" value="#&#123;kenny.song !=null ?:'Jingle Bells'&#125;"/&gt;åœ¨ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œå¦‚æžœkenny.songä¸ä¸ºnullï¼Œé‚£ä¹ˆè¡¨è¾¾å¼çš„æ±‚å€¼ç»“æžœæ˜¯kenny.songå¦åˆ™å°±æ˜¯â€œJingle Bellsâ€ã€‚æ­£åˆ™è¡¨è¾¾å¼éªŒè¯é‚®ç®±ï¼š12&lt;property name="email" value="#&#123;admin.email matches '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.com'&#125;"/&gt;è™½ç„¶è¿™ä¸ªé‚®ç®±æ­£åˆ™ä¸å¤Ÿå¥å£®ï¼Œä½†å¯¹äºŽæ¼”ç¤ºmatchesæ¥è¯´è¶³å¤Ÿå•¦ã€‚åœ¨SpELä¸­ç­›é€‰é›†åˆä¸ºäº†å±•ç¤ºSpELæ“ä½œé›†åˆçš„æ–¹æ³•ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªCityç±»ï¼š1234567891011121314151617181920212223public class City &#123; private String name; private String state; private int population; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public String getState() &#123; return state; &#125; public void setState(String state) &#123; this.state = state; &#125; public int getPopulation() &#123; return population; &#125; public void setPopulation(int population) &#123; this.population = population; &#125;&#125;åŒæ ·ï¼Œæˆ‘ä»¬åœ¨Springå®¹å™¨ä¸­ä½¿ç”¨&lt;util:list&gt;å…ƒç´ é…ç½®ä¸€ä¸ªåŒ…å«Cityå¯¹è±¡çš„Listé›†åˆï¼š123456789101112131415161718&lt;util:list id="cities"&gt; &lt;bean class="com.spring.entity.City" p:name="Chicago" p:state="IL" p:population="2853114"/&gt; &lt;bean class="com.spring.entity.City" p:name="Atlanta" p:state="GA" p:population="537958"/&gt; &lt;bean class="com.spring.entity.City" p:name="Dallas" p:state="TX" p:population="1279910"/&gt; &lt;bean class="com.spring.entity.City" p:name="Houston" p:state="TX" p:population="2242193"/&gt; &lt;bean class="com.spring.entity.City" p:name="Odessa" p:state="TX" p:population="90943"/&gt; &lt;bean class="com.spring.entity.City" p:name="El Paso" p:state="TX" p:population="613190"/&gt; &lt;bean class="com.spring.entity.City" p:name="Jal" p:state="NM" p:population="1996"/&gt; &lt;bean class="com.spring.entity.City" p:name="Las Cruces" p:state="NM" p:population="91865"/&gt;&lt;/util:list&gt;è®¿é—®é›†åˆæˆå‘˜å®šä¹‰ä¸€ä¸ªChoseCityç±»ï¼š123456789public class ChoseCity &#123; private City city; public void setCity(City city) &#123; this.city = city; &#125; public City getCity() &#123; return city; &#125;&#125;é€‰å–é›†åˆä¸­çš„æŸä¸€ä¸ªæˆå‘˜ï¼Œå¹¶èµ‹å€¼ç»™cityå±žæ€§ä¸­ï¼š123&lt;bean id="choseCity" class="com.spring.entity.ChoseCity"&gt; &lt;property name="city" value="#&#123;cities[0]&#125;"/&gt;&lt;/bean&gt;å®žä¾‹åŒ–è¿™ä¸ªBeanï¼š12345678public class ChoseaCity &#123; public static void main(String[] args) &#123; String conf="applicationContext.xml"; ApplicationContext ac=new ClassPathXmlApplicationContext(conf); ChoseCity c=(ChoseCity)ac.getBean("choseCity"); System.out.println(c.getCity().getName()); &#125;&#125;è¾“å‡ºï¼š1Chicagoéšæœºçš„é€‰æ‹©ä¸€ä¸ªcityï¼š123&lt;bean id="choseCity" class="com.spring.entity.ChoseCity"&gt; &lt;property name="city" value="#&#123;cities[T(java.lang.Math).random()*cities.size()]&#125;"/&gt;&lt;/bean&gt;ä¸­æ‹¬å·[]è¿ç®—ç¬¦å§‹ç»ˆé€šè¿‡ç´¢å¼•è®¿é—®é›†åˆä¸­çš„æˆå‘˜ã€‚[]è¿ç®—ç¬¦åŒæ ·å¯ä»¥ç”¨æ¥èŽ·å–java.util.Mapé›†åˆä¸­çš„æˆå‘˜ã€‚ä¾‹å¦‚ï¼Œå‡è®¾Cityå¯¹è±¡ä»¥å…¶åå­—ä½œä¸ºé”®æ”¾å…¥Mapé›†åˆä¸­ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¸‹é¢é‚£æ ·èŽ·å–é”®ä¸ºDallasçš„entryï¼š1&lt;property name="chosenCity" value="#&#123;cities['Dallas']&#125;"/&gt;[]è¿ç®—ç¬¦çš„å¦ä¸€ç§ç”¨æ³•æ˜¯ä»Žjava.util.Propertiesé›†åˆä¸­å–å€¼ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦é€šè¿‡&lt;util:properties&gt;å…ƒç´ åœ¨Springä¸­åŠ è½½ä¸€ä¸ªpropertiesé…ç½®æ–‡ä»¶ï¼š1&lt;util:properties id="settings" loaction="classpath:settings.properties"/&gt;çŽ°åœ¨è¦åœ¨è¿™ä¸ªé…ç½®æ–‡ä»¶Beanä¸­è®¿é—®ä¸€ä¸ªåä¸ºtwitter.accessTokençš„å±žæ€§ï¼š1&lt;property name="accessToken" value="#&#123;settings['twitter.accessToken']&#125;"/&gt;[]è¿ç®—ç¬¦åŒæ ·å¯ä»¥é€šè¿‡ç´¢å¼•æ¥å¾—åˆ°æŸä¸ªå­—ç¬¦ä¸²çš„æŸä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚ä¸‹é¢çš„è¡¨è¾¾å¼å°†è¿”å›žsï¼š1'This is a test'[3]æŸ¥è¯¢é›†åˆæˆå‘˜å¦‚æžœæˆ‘ä»¬æƒ³ä»ŽåŸŽå¸‚citiesé›†åˆä¸­æŸ¥è¯¢å‡ºäººå£å¤§äºŽ10000çš„åŸŽå¸‚ï¼Œåœ¨SpELä¸­åªéœ€è¦ç”¨ä¸€ä¸ªæŸ¥è¯¢è¿ç®—ç¬¦ .?[]å°±å¯ä»¥ç®€å•åšåˆ°ã€‚ä¿®æ”¹choseCityç±»ï¼š12345678910public class ChoseCity &#123; private List&lt;City&gt; city; public List&lt;City&gt; getCity() &#123; return city; &#125; public void setCity(List&lt;City&gt; city) &#123; this.city = city; &#125;&#125;ä¿®æ”¹Beanï¼š123&lt;bean id="choseCity" class="com.spring.entity.ChoseCity"&gt; &lt;property name="city" value="#&#123;cities.?[population gt 100000]&#125;"/&gt;&lt;/bean&gt;å®žä¾‹åŒ–è¯¥Beanï¼š12345678910public class ChoseCitys &#123; public static void main(String[] args) &#123; String conf="applicationContext.xml"; ApplicationContext ac=new ClassPathXmlApplicationContext(conf); ChoseCity c=(ChoseCity)ac.getBean("choseCity"); for(City city:c.getCity())&#123; System.out.println(city.getName()); &#125; &#125;&#125;è¾“å‡ºï¼š12345ChicagoAtlantaDallasHoustonEl PasoSpELè¿˜æä¾›äº†å…¶ä»–ä¸¤ç§æŸ¥è¯¢è¿ç®—ç¬¦ï¼š.^[]å’Œ.$[]ï¼Œä»Žé›†åˆæŸ¥è¯¢ä¸­æŸ¥å‡ºç¬¬ä¸€ä¸ªåŒ¹é…é¡¹å’Œæœ€åŽä¸€ä¸ªåŒ¹é…é¡¹ã€‚ä¾‹å¦‚æŸ¥è¯¢ç¬¬ä¸€ä¸ªç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„åŸŽå¸‚ï¼š1&lt;property name="firstBigCity" value="#&#123;cities.^[population gt 100000]&#125;"/&gt;æŠ•å½±é›†åˆé›†åˆæŠ•å½±å°±æ˜¯ä»Žé›†åˆçš„æ¯ä¸€ä¸ªæˆå‘˜ä¸­é€‰æ‹©ç‰¹å®šçš„å±žæ€§æ”¾å…¥åˆ°ä¸€ä¸ªæ–°çš„é›†åˆä¸­ã€‚SpELçš„æŠ•å½±è¿ç®—ç¬¦.![]å®Œå…¨å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä»…éœ€è¦åŒ…å«åŸŽå¸‚åç§°çš„ä¸€ä¸ªStringç±»åž‹çš„é›†åˆï¼š1&lt;property name="cityNames" value="#&#123;cities.![name]&#125;"/&gt;å†æ¯”å¦‚ï¼Œå¾—åˆ°åŸŽå¸‚åå­—åŠ å·žåçš„é›†åˆï¼š1&lt;property name="cityNames" value="#&#123;cities.![name+','+state]&#125;"/&gt;æŠŠç¬¦åˆæ¡ä»¶çš„åŸŽå¸‚çš„åå­—å’Œå·žåä½œä¸ºä¸€ä¸ªæ–°çš„é›†åˆï¼š1&lt;property name="cityNames" value="#&#123;cities.?[population gt 100000].![name+','+state]&#125;"/&gt;æ€»ä¹‹SpELéžå¸¸å¼ºå¤§ï¼Œä½†SpELæœ€ç»ˆä¹Ÿåªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸æ˜“äºŽæµ‹è¯•ï¼Œä¹Ÿæ²¡IDEè¯­æ³•æ£€æŸ¥çš„æ”¯æŒã€‚æ‰€ä»¥ï¼šå»ºè®®ä¸è¦æŠŠè¿‡å¤šçš„é€»è¾‘æ”¾å…¥SpELè¡¨è¾¾å¼ä¸­ã€‚ã€ŠSpring In Actionã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Beanç”Ÿå‘½å‘¨æœŸ]]></title>
    <url>%2FSpring-Bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.html</url>
    <content type="text"><![CDATA[ä¼ ç»Ÿçš„Javaåº”ç”¨ï¼ŒBeançš„ç”Ÿå‘½å‘¨æœŸå¾ˆç®€å•ã€‚ä½¿ç”¨Javaå…³é”®å­—newè¿›è¡ŒBeançš„å®žä¾‹åŒ–ï¼Œç„¶åŽè¯¥Beanå°±å¯ä»¥ä½¿ç”¨äº†ã€‚ä¸€æ—¦è¯¥Beanä¸å†è¢«ä½¿ç”¨ï¼Œåˆ™æœ‰GCé€‰æ‹©å›žæ”¶ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨Springå®¹å™¨ä¸­ï¼ŒBeançš„ç”Ÿå‘½å‘¨æœŸè¦ç»†è…»çš„å¤šï¼Œå¤§è‡´è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š1.Springå¯¹Beanè¿›è¡Œå®žä¾‹åŒ–ï¼›2.Springå°†å€¼å’Œå¯¹Beançš„å¼•ç”¨æ³¨å…¥è¿›Beanå¯¹åº”çš„å±žæ€§ä¸­ï¼›3.å¦‚æžœBeanå®žçŽ°äº†BeanNameAwareæŽ¥å£ï¼ŒSpringå°†Beançš„IDä¼ é€’ç»™setBeanName()æŽ¥å£æ–¹æ³•ï¼›4.å¦‚æžœBeanå®žçŽ°äº†BeanFactoryAwareæŽ¥å£ï¼ŒSpringå°†è°ƒç”¨setBeanFactory()æŽ¥å£æ–¹æ³•ï¼Œå°†BeanFactoryå®¹å™¨å®žä¾‹ä¼ å…¥ï¼›5.å¦‚æžœBeanå®žçŽ°äº†ApplicationContextAwareæŽ¥å£ï¼ŒSpringå°†è°ƒç”¨setApplicationContext()æŽ¥å£æ–¹æ³•ï¼Œå°†åº”ç”¨ä¸Šä¸‹æ–‡çš„å¼•ç”¨ä¼ å…¥ï¼›6.å¦‚æžœBeanå®žçŽ°äº†BeanPostProcessoræŽ¥å£ï¼ŒSpringå°†è°ƒç”¨å®ƒä»¬çš„postProcessBeforeInitialization()æŽ¥å£æ–¹æ³•ï¼›7.å¦‚æžœBeanå®žçŽ°äº†InitializingBeanæŽ¥å£ï¼ŒSpringå°†è°ƒç”¨å®ƒä»¬çš„afterPropertiesSet()æŽ¥å£æ–¹æ³•ã€‚ç±»ä¼¼çš„ï¼Œå¦‚æžœBeanä½¿ç”¨init-methodå£°æ˜Žäº†åˆå§‹åŒ–æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚8.å¦‚æžœBeanå®žçŽ°äº†BeanPostProcessoræŽ¥å£ï¼ŒSpringå°†è°ƒç”¨å®ƒä»¬çš„postProcessAfterInitialization()æ–¹æ³•ï¼›9.æ­¤æ—¶æ­¤åˆ»ï¼ŒBeanå·²ç»å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥è¢«ä½¿ç”¨äº†ã€‚å®ƒä»¬å°†ä¸€ç›´é©»ç•™åœ¨Springå®¹å™¨ä¸­ï¼Œç›´åˆ°å®¹å™¨è¢«é”€æ¯ï¼›10.å¦‚æžœBeanå®žçŽ°äº†DisposableBeanæŽ¥å£ï¼ŒSpringå°†è°ƒç”¨å®ƒçš„destroy()æŽ¥å£æ–¹æ³•ã€‚åŒæ ·ï¼Œå¦‚æžœBeanä½¿ç”¨destroy-methodå£°æ˜Žäº†é”€æ¯æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¹Ÿä¼šè¢«è°ƒç”¨ï¼›]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Setteræ–¹æ³•æ³¨å…¥]]></title>
    <url>%2FSpring-Setter%E6%96%B9%E6%B3%95%E6%B3%A8%E5%85%A5.html</url>
    <content type="text"><![CDATA[Springé™¤äº†æž„é€ å™¨æ³¨å…¥ï¼Œè¿˜å¯ä»¥é€šè¿‡ç±»çš„set()æ–¹æ³•æ³¨å…¥ã€‚ä¸ºäº†æ¼”ç¤ºè¿™ä¸ªè¿‡ç¨‹ï¼ŒçŽ°åœ¨æœ‰è¯·ä¸‹ä¸€ä½å‚èµ›è€…kennyã€‚kennyæ˜¯ä¸€ä½å¤©èµ‹å¼‚ç¦€çš„ä¹å™¨æ¼”å¥è€…ï¼ŒçŽ°å®šä¹‰ä¸€ä¸ªä¹å™¨æ¼”å¥å¸ˆç±»ï¼š1234567891011121314151617181920212223242526272829public class Instrumentalist implements Performer&#123; private String song; private Instrument instrument; public Instrumentalist() &#123; &#125; public void perform() &#123; System.out.println("å”±ï¼š"+song+""); instrument.play(); &#125; public String screamSong()&#123; return song; &#125; public String getSong() &#123; return song; &#125; //æ³¨å…¥æ­Œæ›² public void setSong(String song) &#123; this.song = song; &#125; public Instrument getInstrument() &#123; return instrument; &#125; //æ³¨å…¥ä¹å™¨ public void setInstrument(Instrument instrument) &#123; this.instrument = instrument; &#125;&#125;ä¹å™¨InstrumentæŽ¥å£ï¼š123public interface Instrument&#123; public void play();&#125;setteræ³¨å…¥ç®€å•å€¼å¯ä»¥é€šè¿‡InstrumentListç±»çš„é»˜è®¤æž„é€ å™¨æ¥å®žä¾‹åŒ–è¯¥Beanï¼Œä½†æ²¡æœ‰ç»™songå’Œinstrumentå±žæ€§èµ‹å€¼çš„è¯æ˜¾ç„¶æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚Springå¯ä»¥ç”¨&lt;property&gt;å…ƒç´ ç»™å±žæ€§Songæ³¨å…¥å€¼ï¼š123&lt;bean id="kenny" class="com.spring.entity.Instrumentalist"&gt; &lt;property name="song" value="May Rain"/&gt;&lt;/bean&gt;nameä¸ºå±žæ€§åï¼Œvalueä¸ºå±žæ€§å€¼ã€‚å¼•ç”¨å…¶ä»–çš„Beanæœ‰äº†æ­Œæ›²ï¼ŒkennyçŽ°åœ¨è¿˜å·®ä¹å™¨ã€‚å®šä¹‰ä¸€ä¸ªpianoç±»ï¼Œå®žçŽ°InstrumentæŽ¥å£ï¼š12345public class Piano implements Instrument&#123; public void play() &#123; System.out.println("é’¢ç´å£°å“èµ·"); &#125;&#125;æœ‰äº†pianoç±»ï¼ŒçŽ°åœ¨æˆ‘ä»¬åœ¨Springå®¹å™¨ä¸­å®šä¹‰è¿™ä¸ªé’¢ç´ç±»ï¼š1&lt;bean id="piano" class="com.spring.entity.Piano"/&gt;æœ‰äº†é’¢ç´ï¼ŒçŽ°åœ¨æˆ‘ä»¬æŠŠé’¢ç´äº¤ç»™kennyï¼Œä¿®æ”¹kennyçš„&lt;bean&gt;é…ç½®ï¼š1234&lt;bean id="kenny" class="com.spring.entity.Instrumentalist"&gt; &lt;property name="song" value="May Rain"/&gt; &lt;property name="piano" ref="piano"&gt;&lt;/property&gt;&lt;/bean&gt;refå±žæ€§æŒ‡å‘ä¹‹å‰å®šä¹‰çš„piano&lt;bean&gt;ã€‚çŽ°åœ¨æˆ‘ä»¬è®©kennyæ­£å¼ä¸Šå°è¡¨æ¼”ï¼š1234567public class Play &#123; public static void main(String[] args) &#123; ApplicationContext ac=new ClassPathXmlApplicationContext("applicationContext.xml"); Instrumentalist kenny=(Instrumentalist)ac.getBean("kenny"); kenny.perform(); &#125;&#125;è¾“å‡ºï¼š123å¼€ç¯å”±ï¼šMay Rainé’¢ç´å£°å“èµ·æ³¨å…¥å†…éƒ¨Beankennyæ˜¯ä¸€ä¸ªå æœ‰æ¬²å¾ˆå¼ºçš„äººï¼Œä»–ä¸å¸Œæœ›è‡ªå·±çš„é’¢ç´è¢«åˆ«äººä½¿ç”¨ã€‚è¿™æ—¶å€™æˆ‘ä»¬ä¸èƒ½åƒä¸Šé¢é‚£æ ·å¼•ç”¨piano&lt;bean&gt;äº†ï¼Œå› ä¸ºè¿™æ ·ä»»ä½•ä¸€ä¸ª&lt;bean&gt;éƒ½å¯ä»¥å¼•ç”¨å®ƒã€‚çŽ°åœ¨ä¿®æ”¹kennyçš„&lt;bean&gt;ï¼š123456&lt;bean id="kenny" class="com.spring.entity.Instrumentalist"&gt; &lt;property name="song" value="May Rain"/&gt; &lt;property name="instrument" &gt; &lt;bean class="com.spring.entity.Piano"/&gt; &lt;/property&gt;&lt;/bean&gt;å¦‚ä½ æ‰€è§ï¼Œå†…éƒ¨Beanæ˜¯ç›´æŽ¥å£°æ˜Žä¸€ä¸ª&lt;bean&gt;å…ƒç´ ä½œä¸º&lt;property&gt;å…ƒç´ çš„å­èŠ‚ç‚¹è€Œå®šä¹‰çš„ã€‚åŒæ ·ï¼Œæž„é€ å™¨æ³¨å…¥ä¹Ÿæ”¯æŒå†…éƒ¨Beançš„å£°æ˜Žã€‚ ç»†å¿ƒçš„ä½  ä¼šå‘çŽ°å†…éƒ¨Beanæ²¡æœ‰å®šä¹‰idå±žæ€§ï¼Œå®žé™…ä¸Šåœ¨è¿™é‡Œå®šä¹‰idå±žæ€§æ˜¯å®Œå…¨åˆæ³•çš„ï¼Œåªä¸è¿‡å¯¹äºŽå†…éƒ¨Beanï¼Œidå±žæ€§æ˜¾ç„¶ä¸é‡è¦äº†ã€‚ä½¿ç”¨Spring Pè£…é…å±žæ€§&lt;property&gt;å…ƒç´ çš„å†™æ³•å¯ä»¥æ›´ç®€ç•¥ï¼Œåªéœ€åœ¨&lt;beans&gt;åŠ å…¥å¦‚ä¸‹ä»£ç ï¼š1xmlns:p="http://www.springframework.org/schema/p"é€šè¿‡è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨p:ä½œä¸º&lt;bean&gt;å…ƒç´ çš„æ‰€æœ‰å±žæ€§çš„å‰ç¼€æ¥è£…é…Beançš„å±žæ€§ã€‚çŽ°ä¿®æ”¹kennyçš„&lt;bean&gt;é…ç½®ï¼š123&lt;bean id="kenny" class="com.spring.entity.Instrumentalist" p:song="May Rain" p:instrument-ref="piano"/&gt;è£…é…é›†åˆå½“é…ç½®é›†åˆç±»åž‹çš„Beanå±žæ€§æ—¶ï¼ŒSpringæä¾›äº†ç›¸åº”çš„é›†åˆé…ç½®å…ƒç´ ï¼šé›†åˆå…ƒç´ ç”¨é€”&lt;list&gt;è£…é…listç±»åž‹çš„å€¼ï¼Œå…è®¸é‡å¤&lt;set&gt;è£…é…setç±»åž‹çš„å€¼ï¼Œä¸å…è®¸é‡å¤&lt;map&gt;è£…é…mapç±»åž‹çš„å€¼ï¼Œåç§°å’Œå€¼å¯ä»¥æ˜¯ä»»æ„ç±»åž‹&lt;props&gt;è£…é…propertiesç±»åž‹çš„å€¼ï¼Œåç§°å’Œå€¼éƒ½å¿…é¡»æ˜¯Stringç±»åž‹ä¸ºäº†å±•ç¤ºSpringè£…é…é›†åˆï¼ŒçŽ°åœ¨æœ‰è¯·ä¸‹ä¸€ä½å‚èµ›è€…hankã€‚hankæ˜¯ä¸€ä½æ‰åŽæ¨ªæº¢çš„ä¸€äººä¹é˜Ÿï¼Œå¯ä»¥åŒæ—¶æ¼”å¥å¤šç§ä¹å™¨ã€‚çŽ°å®šä¹‰ä¸€ä¸ªOneManBanç±»ï¼š1234567891011121314public class OneManBan implements Performer&#123; private Collection&lt;Instrument&gt; instruments; //æ³¨å…¥instrumentsé›†åˆ public void setInstruments(Collection&lt;Instrument&gt; instruments) &#123; this.instruments = instruments; &#125; public void perform() &#123; for(Instrument ins:instruments)&#123; ins.play(); &#125; &#125;&#125;è£…é…List,Setå’ŒArrayçŽ°åœ¨å†å®šä¹‰ä¸¤ä¸ªä¹å™¨ç±»ï¼Œå¹¶åœ¨Springå®¹å™¨ä¸­å®šä¹‰å®ƒï¼š12&lt;bean id="saxophone" class="com.spring.entity.Saxophone"/&gt;&lt;bean id="guitar" class="com.spring.entity.Guitar"/&gt;çŽ°åœ¨æŠŠæ‰€æœ‰ä¹å™¨éƒ½è£…é…ç»™hankï¼š123456789&lt;bean id="hank" class="com.spring.entity.OneManBan"&gt; &lt;property name="instruments"&gt; &lt;list&gt; &lt;ref bean="saxophone"/&gt; &lt;ref bean="piano"/&gt; &lt;ref bean="guitar"/&gt; &lt;/list&gt; &lt;/property&gt;&lt;/bean&gt;è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–çš„Springè®¾ç½®å…ƒç´ è®¾ç½®&lt;list&gt;çš„æˆå‘˜ã€‚åŒ…æ‹¬&lt;value&gt;ï¼Œ&lt;bean&gt;ï¼Œ&lt;/null&gt;ç”šè‡³&lt;list&gt;ã€‚å®žé™…ä¸Šï¼Œinstrumentså±žæ€§åªè¦æ˜¯java.util.collectionçš„å®žçŽ°ç±»åž‹éƒ½å¯ä»¥ä½¿ç”¨&lt;list&gt;ï¼Œå¦‚ï¼š1java.util.List&lt;Instrument&gt; instruments;æˆ–è€…ï¼š1Instrument[] instruments;&lt;set&gt;å…ƒç´ çš„ä½¿ç”¨ä¸Ž&lt;list&gt;å®Œå…¨ä¸€è‡´ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äºŽ&lt;set&gt;å…ƒç´ çš„æˆå‘˜éƒ½æ˜¯å”¯ä¸€çš„ã€‚çŽ°åœ¨å®žä¾‹åŒ–hankæŸ¥çœ‹è¾“å‡ºï¼š1234å¼€ç¯å¹è¨å…‹æ–¯é’¢ç´å£°å“èµ·å¼¹å¥å‰ä»–è£…é…Mapé›†åˆå¦‚æžœinstrumentså±žæ€§æ˜¯ä¸€ä¸ªMapé›†åˆçš„è¯ï¼Œæˆ‘ä»¬åˆè¯¥å¦‚ä½•è£…é…å‘¢ï¼ŸçŽ°ä¿®æ”¹OneManBanç±»ï¼š1234567891011121314151617public class OneManBan implements Performer&#123; private Map&lt;String,Instrument&gt; instruments; public OneManBan() &#123; &#125; public void perform() &#123; for(String key:instruments.keySet())&#123; System.out.print(key+": "); Instrument ins=instruments.get(key); ins.play(); &#125; &#125; public void setInstruments(Map&lt;String, Instrument&gt; instruments) &#123; this.instruments = instruments; &#125;&#125;hank&lt;bean&gt;ä¿®æ”¹å¦‚ä¸‹ï¼š123456789&lt;bean id="hank" class="com.spring.entity.OneManBan"&gt; &lt;property name="instruments"&gt; &lt;map&gt; &lt;entry key="saxophone" value-ref="saxophone"/&gt; &lt;entry key="piano" value-ref="piano"/&gt; &lt;entry key="guitar" value-ref="guitar"/&gt; &lt;/map&gt; &lt;/property&gt;&lt;/bean&gt;&lt;map&gt;çš„&lt;entry&gt;ç”±keyå’Œvalueç»„æˆï¼šå±žæ€§ç”¨é€”keyé”®ä¸ºStringkey-refé”®ä¸ºSpringå®¹å™¨ä¸­å…¶ä»–Beançš„å¼•ç”¨valueå€¼ä¸ºStringvalue-refå€¼ä¸ºSpringå®¹å™¨ä¸­å…¶ä»–Beançš„å¼•ç”¨è£…é…Propertiesé›†åˆå½“keyå’Œvalueéƒ½æ˜¯Stringç±»åž‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Propertiesæ¥ä»£æ›¿Mapä¿®æ”¹OneManBanï¼š12345678910111213141516public class OneManBan implements Performer&#123; private Properties instruments; public OneManBan() &#123; &#125; public void perform() &#123; for(Object key:instruments.keySet())&#123; System.out.print(key+": "); String ins=instruments.getProperty(key.toString()); System.out.println(ins); &#125; &#125; public void setInstruments(Properties instruments) &#123; this.instruments = instruments; &#125;&#125;ä¿®æ”¹&lt;bean&gt;:123456789&lt;bean id="hank" class="com.spring.entity.OneManBan"&gt; &lt;property name="instruments"&gt; &lt;props&gt; &lt;prop key="saxophone" &gt;play the saxophone&lt;/prop&gt; &lt;prop key="piano"&gt;play the piano&lt;/prop&gt; &lt;prop key="guitar"&gt;play the guitar&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt;&lt;/bean&gt;ã€ŠSpring In Actionã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring æž„é€ å™¨æ³¨å…¥]]></title>
    <url>%2FSpring-%E6%9E%84%E9%80%A0%E5%99%A8%E6%B3%A8%E5%85%A5.html</url>
    <content type="text"><![CDATA[ä»ŽSpring3.0å¼€å§‹ï¼ŒSpringå¯ä»¥é€šè¿‡æ³¨è§£çš„æ–¹å¼æ¥é…ç½®Beanã€‚è¿™é‡Œå…ˆä»‹ç»ä»¥ä¼ ç»Ÿçš„XMLé…ç½®å¼æ¥é…ç½®Beanã€‚ç”¨ä¸€åœºé€‰ç§€æ¯”èµ›æ¥æ¨¡æ‹ŸSpringè£…å¤‡Beanè¿‡ç¨‹ã€‚ä¸€åœºæ¯”èµ›ä¸­ï¼Œéœ€è¦ä¸€äº›å‚èµ›è€…æ¥å‚åŠ æ¯”èµ›ï¼Œä¸ºæ­¤æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªPerformeræŽ¥å£ï¼š123public interface Performer &#123; public void perform();&#125;å‚èµ›é€‰æ‰‹éƒ½å®žçŽ°äº†è¿™ä¸ªPerformeræŽ¥å£ã€‚ä»¥ä¸‹ä¸ºä¸€ä¸ªå…¸åž‹çš„Spring XMLé…ç½®æ–‡ä»¶(Springå®¹å™¨ï¼ŒSpringä¸Šä¸‹æ–‡)ï¼š1234567891011121314151617181920212223242526&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:util="http://www.springframework.org/schema/util" xmlns:jee="http://www.springframework.org/schema/jee" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:jpa="http://www.springframework.org/schema/data/jpa" xmlns:mvc="http://www.springframework.org/schema/mvc" xsi:schemaLocation=" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.2.xsd http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.3.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd"&gt; &lt;!--Bean declarations go here --&gt;&lt;/beans&gt;åœ¨&lt;beans&gt;å…ƒç´ å†…ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®æ‰€æœ‰Springé…ç½®ä¿¡æ¯ä»¥åŠ&lt;bean&gt;å…ƒç´ çš„å£°æ˜Žã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒSpringè¿˜è‡ªå¸¦äº†åŒ…æ‹¬&lt;beans&gt;åœ¨å†…çš„10å¤§å‘½åç©ºé—´ï¼šå‘½åç©ºé—´ç”¨é€”aopä¸ºå£°æ˜Žåˆ‡é¢ä»¥åŠå°†@AspectJæ³¨è§£çš„ç±»ä»£ç†ä¸ºSpringåˆ‡é¢æä¾›äº†é…ç½®å…ƒç´ beans&nbsp;&nbsp;&nbsp;&nbsp;æ”¯æŒå£°æ˜ŽBeanå’Œè£…é…Beanï¼Œæ˜¯Springæœ€æ ¸å¿ƒä¹Ÿæ˜¯æœ€åŽŸå§‹çš„å‘½åç©ºé—´contextä¸ºé…ç½®Springåº”ç”¨ä¸Šä¸‹æ–‡æä¾›äº†é…ç½®å…ƒç´ ï¼ŒåŒ…æ‹¬è‡ªåŠ¨æ£€æµ‹å’Œè‡ªåŠ¨è£…é…Beanï¼Œæ³¨å…¥éžSpringç›´æŽ¥ç®¡ç†çš„å¯¹è±¡jee&nbsp;&nbsp;&nbsp;&nbsp;æä¾›äº†ä¸ŽJava EE APIçš„é›†æˆï¼Œä¾‹å¦‚JNDIå’ŒEJBjmsä¸ºå£°æ˜Žæ¶ˆæ¯é©±åŠ¨çš„POJOæä¾›äº†é…ç½®å…ƒç´ langæ”¯æŒé…ç½®ç”±Groovyï¼ŒJRubyæˆ–BeanShellç­‰è„šæœ¬å®žçŽ°çš„Beanmvcå¯åŠ¨Spring MVCçš„èƒ½åŠ›ï¼Œä¾‹å¦‚é¢å‘æ³¨è§£çš„æŽ§åˆ¶å™¨ï¼Œè§†å›¾æŽ§åˆ¶å™¨å’Œæ‹¦æˆªå™¨oxmæ”¯æŒSpringçš„å¯¹è±¡åˆ°XMLæ˜ å°„é…ç½®txæä¾›å£°æ˜Žäº‹åŠ¡é…ç½®utilæä¾›å„ç§å„æ ·çš„å·¥å…·ç±»å…ƒç´ ï¼ŒåŒ…æ‹¬æŠŠé›†åˆé…ç½®ä¸ºBeanï¼Œæ”¯æŒå±žæ€§å ä½ç¬¦å…ƒç´ å›žå½’æ¯”èµ›ï¼Œç¬¬ä¸€ä½å‚èµ›è€…æ˜¯ä¸€ä¸ªJuggler(æ‚æŠ€å¸ˆ)ï¼Œå£°æ˜Žä¸€ä¸ªJuggler Beanï¼š12345678910111213public class Juggler implements Performer&#123; private int beanBags=3; public Juggler() &#123; &#125; public Juggler(int beanBags) &#123; this.beanBags = beanBags; &#125; public void perform() &#123; System.out.println("throws "+beanBags+" beanBags"); &#125;&#125;Jugglerå®žçŽ°äº†PerformeræŽ¥å£ï¼Œé»˜è®¤å¯ä»¥åŒæ—¶æŠ›å‡ºä¸‰ä¸ªè±†è¢‹å­ã€‚ä¹Ÿå¯ä»¥é€šè¿‡æœ‰å‚æž„é€ å™¨æ”¹å˜è¢‹å­æ•°é‡ã€‚çŽ°åœ¨æœ‰è¯·ç¬¬ä¸€ä½å«dukeçš„æ‚æŠ€å¸ˆä¸Šåœºï¼åœ¨applicationContext.xmlæ–‡ä»¶ä¸­é…ç½®Dukeï¼š1&lt;bean id="duke" class="com.spring.entity.Juggler"/&gt;idè¡¨æ˜Žä»–å«dukeï¼Œclassè¡¨æ˜Žä»–æ˜¯ä¸€ä¸ªjugglerã€‚çŽ°åœ¨è®©dukeä¸Šå°è¡¨æ¼”ï¼š12345678public class Show &#123; public static void main(String[] args) &#123; String conf="applicationContext.xml"; ApplicationContext ac=new ClassPathXmlApplicationContext(conf); Juggler duke=(Juggler)ac.getBean("duke"); duke.perform(); //æ‰”äº† 3 ä¸ªè±†è¢‹å­ &#125;&#125;æž„é€ å™¨æ³¨å…¥è¯„å§”è§‰å¾—è¿™å¹¶æ²¡æœ‰ä»€ä¹ˆéš¾åº¦ï¼ŒäºŽæ˜¯dukeå†³å®šä¸€æ¬¡æ€§æ‰”15ä¸ªè±†è¢‹å­ï¼ä¿®æ”¹duke&lt;bean&gt;çš„é…ç½®ï¼š123&lt;bean id="duke" class="com.spring.entity.Juggler"&gt; &lt;constructor-arg value="15" /&gt;&lt;/bean&gt;ä¹Ÿå¯ä»¥ä½¿ç”¨c-å‘½åç©ºé—´ä»£æ›¿&lt;constructor-arg&gt;æ ‡ç­¾ï¼Œè¦ä½¿ç”¨å®ƒçš„è¯ï¼ŒçŽ°åœ¨XMLé¡¶éƒ¨å£°æ˜Žå…¶æ¨¡å¼ï¼š1xmlns:c="http://www.springframework.org/schema/c"ä¸Šé¢çš„é…ç½®å¯ä»¥æ”¹ä¸ºï¼š1&lt;bean id="duke" class="com.spring.entity.Juggler" c:beanBags="15"&gt;æˆ–è€…ï¼š1&lt;bean id="duke" class="com.spring.entity.Juggler" c:_0="15"&gt;åƒè¿™ç§åªæœ‰ä¸€ä¸ªå‚æ•°çš„è¯ä¹Ÿå¯ä»¥å†™ä¸ºï¼š1&lt;bean id="duke" class="com.spring.entity.Juggler" c:_="15"&gt;Jugglerç±»æœ‰ä¸¤ä¸ªæž„é€ å™¨ï¼Œæ— å‚å’Œæœ‰å‚ã€‚å½“æ²¡æœ‰å£°æ˜Ž&lt;constructor-arg&gt;çš„æ—¶å€™ï¼ŒSpringå°†é»˜è®¤ä½¿ç”¨æ— å‚çš„æž„é€ æ–¹æ³•ã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬å°†&lt;constructor-arg&gt;çš„valueè®¾ç½®ä½15çš„æ—¶å€™ï¼ŒSpringä½¿ç”¨æœ‰å‚æž„é€ æ–¹æ³•æ¥æ”¹å˜å±žæ€§beanBagsçš„å€¼ã€‚å†æ¬¡è¡¨æ¼”ï¼Œè¾“å‡ºï¼š12æ‰”äº† 15 ä¸ªè±†è¢‹å­æŽŒå£°é›·åŠ¨ã€‚ç¨ç­‰ï¼dukeè¯´ä»–è¿˜ä¼šè¾¹æ‰”è¢‹å­å˜æœ—è¯µè¯—æ­Œï¼ä¸ºæ­¤æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªPoeticJugglerï¼ˆä¼šæœ—è¯µçš„æ‚æŠ€å¸ˆï¼‰ï¼š1234567891011121314151617181920public class PoeticJuggler extends Juggler&#123; //è¯—æ­Œå±žæ€§ private Poem poem; public PoeticJuggler(Poem poem) &#123; this.poem = poem; &#125; public PoeticJuggler(int beanBags,Poem poem) &#123; //ç»§æ‰¿è±†è¢‹å­å±žæ€§ super(beanBags); this.poem = poem; &#125; public void perform()&#123; //ç»§æ‰¿æ‰”è¢‹å­æŠ€èƒ½ super.perform(); System.out.println("è¾¹æœ—è¯µ..."); //æœ—è¯µè¯—æ­Œ poem.recite(); &#125;&#125;è¯—æ­ŒæŽ¥å£ï¼š123public interface Poem &#123; public void recite();&#125;dukeæœ€å–œæ¬¢çš„æ˜¯æ™®å¸Œé‡‘çš„ã€Šå‡å¦‚ç”Ÿæ´»æ¬ºéª—äº†ä½ ã€‹ï¼Œä¸ºæ­¤æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªDeceivedByLifeç±»ï¼Œå®žçŽ°PoemæŽ¥å£ï¼š123456789101112131415161718192021public class DeceivedByLife implements Poem&#123; private static String[] LINES = &#123; "å‡å¦‚ç”Ÿæ´»æ¬ºéª—äº†ä½ ï¼Œ", "ä¸è¦æ‚²ä¼¤ï¼Œä¸è¦å¿ƒæ€¥ï¼", "å¿§éƒçš„æ—¥å­é‡Œé¡»è¦é•‡é™ï¼š", "ç›¸ä¿¡å§ï¼Œå¿«ä¹çš„æ—¥å­å°†ä¼šæ¥ä¸´ï¼", "å¿ƒå„¿æ°¸è¿œå‘å¾€ç€æœªæ¥ï¼›", "çŽ°åœ¨å´å¸¸æ˜¯å¿§éƒã€‚", "ä¸€åˆ‡éƒ½æ˜¯çž¬æ¯ï¼Œä¸€åˆ‡éƒ½å°†ä¼šè¿‡åŽ»ï¼›", "è€Œé‚£è¿‡åŽ»äº†çš„ï¼Œå°±ä¼šæˆä¸ºäº²åˆ‡çš„æ€€æ‹"&#125;; public DeceivedByLife()&#123; &#125; //æœ—è¯µè¯—æ­Œ public void recite() &#123; for(int i=0;i&lt;LINES.length;i++)&#123; System.out.println(LINES[i]); &#125; &#125; &#125;åœ¨Springå®¹å™¨é‡Œé…ç½®è¿™é¦–è¯—æ­Œï¼š1&lt;bean id="deceivedByLife" class="com.spring.entity.DeceivedByLife"/&gt;çŽ°åœ¨dukeæ˜¯ä¸€ä¸ªpoeticJuggleräº†ï¼Œä¸ºæ­¤æˆ‘ä»¬ä¿®æ”¹dukeçš„&lt;bean&gt;é…ç½®ï¼š1234&lt;bean id="poeticDuke" class="com.spring.entity.PoeticJuggler"&gt; &lt;constructor-arg value="15"/&gt; &lt;constructor-arg ref="deceivedByLife"/&gt;&lt;/bean&gt;c-å‘½åç©ºé—´å†™æ³•ï¼š123&lt;bean id="poeticDuke" class="com.spring.entity.PoeticJuggler" c:_beanBags="15" c:_poem-ref="deceivedByLife"/&gt;æˆ–è€…ï¼š123&lt;bean id="poeticDuke" class="com.spring.entity.PoeticJuggler" c:_0="15" c:_1-ref="deceivedByLife"/&gt;å½“Springç¢°åˆ°deceivedByLifeå’ŒpoeticDukeçš„&lt;bean&gt;å£°æ˜Žæ—¶ï¼Œå®ƒæ‰€æ‰§è¡Œçš„é€»è¾‘æœ¬è´¨å’Œä¸‹é¢çš„Javaä»£ç æ˜¯ä¸€æ ·çš„ï¼š12Poem deceivedByLife = new DeceivedByLife();Performer duke = new PoeticJuggler(15,deceivedByLife);çŽ°åœ¨ï¼Œdukeå†æ¬¡è¿›è¡Œäº†è¡¨æ¼”ï¼š12345678public class Show &#123; public static void main(String[] args) &#123; String conf="applicationContext.xml"; ApplicationContext ac=new ClassPathXmlApplicationContext(conf); Juggler duke=(PoeticJuggler)ac.getBean("poeticDuke"); duke.perform(); &#125;&#125;è¾“å‡ºï¼š12345678910æ‰”äº† 15 ä¸ªè±†è¢‹å­è¾¹æœ—è¯µ...å‡å¦‚ç”Ÿæ´»æ¬ºéª—äº†ä½ ï¼Œä¸è¦æ‚²ä¼¤ï¼Œä¸è¦å¿ƒæ€¥ï¼å¿§éƒçš„æ—¥å­é‡Œé¡»è¦é•‡é™ï¼šç›¸ä¿¡å§ï¼Œå¿«ä¹çš„æ—¥å­å°†ä¼šæ¥ä¸´ï¼å¿ƒå„¿æ°¸è¿œå‘å¾€ç€æœªæ¥ï¼›çŽ°åœ¨å´å¸¸æ˜¯å¿§éƒã€‚ä¸€åˆ‡éƒ½æ˜¯çž¬æ¯ï¼Œä¸€åˆ‡éƒ½å°†ä¼šè¿‡åŽ»ï¼›è€Œé‚£è¿‡åŽ»äº†çš„ï¼Œå°±ä¼šæˆä¸ºäº²åˆ‡çš„æ€€æ‹æŽŒå£°å†æ¬¡é›·åŠ¨ã€‚é€šè¿‡å·¥åŽ‚æ–¹æ³•åˆ›å»ºBeanæœ‰æ—¶å€™ï¼Œä¸€ä¸ªç±»æ²¡æœ‰å…¬å¼€çš„æž„é€ æ–¹æ³•ï¼Œè¿™æ—¶å€™å°±ä¸èƒ½ä½¿ç”¨æž„é€ å™¨æ³¨å…¥äº†ã€‚Springæ”¯æŒ&lt;bean&gt;å…ƒç´ çš„factory-methodæ–¹æ³•æ¥è£…é…Beanã€‚åˆ›å»ºä¸€ä¸ªèˆžå°ç±»ï¼š12345678910111213141516public class Stage &#123; private Stage()&#123; &#125; //å»¶è¿ŸåŠ è½½å®žä¾‹ public static class stageSingletonHolder&#123; static Stage instance=new Stage(); &#125; //è¿”å›žå®žä¾‹ public static Stage getInstance()&#123; return stageSingletonHolder.instance; &#125; public void createStage()&#123; System.out.println("åˆ›é€ ä¸€ä¸ªèˆžå°"); &#125;&#125;Stageä½œä¸ºä¸€ä¸ªå•ä¾‹ç±»ï¼Œæ²¡æœ‰å…¬å¼€çš„æž„é€ æ–¹æ³•ï¼Œç›¸åï¼Œé™æ€æ–¹æ³•getInstance()æ¯æ¬¡è°ƒç”¨éƒ½è¿”å›žä¸€ä¸ªç›¸åŒçš„Stageå®žä¾‹ã€‚&lt;bean&gt;å…ƒç´ çš„factory-methodå±žæ€§å…è®¸æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œä»Žè€Œä»£æ›¿æž„é€ æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªç±»çš„å®žä¾‹ã€‚åœ¨Springä¸Šä¸‹æ–‡ä¸­é…ç½®Stage&lt;bean&gt;ï¼š1&lt;bean id="stage" class="com.spring.entity.Stage" factory-method="getInstance"/&gt;çŽ°åœ¨ä»ŽSpringå®¹å™¨ä¸­èŽ·å–è¿™ä¸ª&lt;bean&gt;ï¼š12345678public class CreateStage &#123; public static void main(String[] args) &#123; String conf="applicationContext.xml"; ApplicationContext ac=new ClassPathXmlApplicationContext(conf); Stage stage=(Stage)ac.getBean("stage"); stage.createStage(); &#125;&#125;è¾“å‡ºï¼š1åˆ›é€ ä¸€ä¸ªèˆžå°Beanä½œç”¨åŸŸæ‰€æœ‰Spring Beané»˜è®¤éƒ½æ˜¯å•ä¾‹çš„ã€‚å¦‚æžœçŽ°åœ¨è¦åˆ›å»ºä¸€ä¸ªâ€é—¨ç¥¨â€ç±»ï¼Œæ¯ä¸ªäººçš„é—¨ç¥¨è‚¯å®šæ˜¯ä¸ä¸€æ ·çš„ã€‚ä¸ºäº†è®©Springæ¯æ¬¡è¯·æ±‚éƒ½äº§ç”Ÿä¸€ä¸ªæ–°çš„å®žä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¦‚ä¸‹ticket&lt;bean&gt;ï¼š1&lt;bean id="ticket" class="com.spring.entity.Ticket" scope="prototype"/&gt;é™¤äº†prototypeï¼ŒSpringè¿˜æä¾›äº†å…¶ä»–å‡ ä¸ªä½œç”¨åŸŸé€‰é¡¹ï¼šä½œç”¨åŸŸå®šä¹‰singletonåœ¨æ¯ä¸€ä¸ªspringå®¹å™¨ä¸­ï¼Œä¸€ä¸ªBeanå®šä¹‰åªæœ‰ä¸€ä¸ªå¯¹è±¡å®žä¾‹ï¼ˆé»˜è®¤ï¼‰prototypeå…è®¸Beançš„å®šä¹‰å¯ä»¥è¢«å®žä¾‹åŒ–ä»»æ„æ¬¡ï¼ˆæ¯æ¬¡è°ƒç”¨éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„å®žä¾‹ï¼‰requeståœ¨ä¸€æ¬¡HTTPè¯·æ±‚ä¸­ï¼Œæ¯ä¸ªBeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®žä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäºŽWebçš„Springä¸Šä¸‹æ–‡ä¸­æ‰æœ‰æ•ˆsessionåœ¨ä¸€ä¸ªHTTP Sessionä¸­ï¼Œæ¯ä¸ªBeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®žä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäºŽWebçš„Springä¸Šä¸‹æ–‡ä¸­æ‰æœ‰æ•ˆglobal-sessionåœ¨ä¸€ä¸ªå…¨å±€HTTP Sessionä¸­ï¼Œæ¯ä¸ªBeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®žä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨Protletä¸Šä¸‹æ–‡ä¸­æ‰æœ‰æ•ˆSpringçš„å•ä¾‹Beanåªèƒ½ä¿è¯åœ¨æ¯ä¸ªåº”ç”¨ä¸Šä¸‹æ–‡ä¸­åªæœ‰ä¸€ä¸ªBeanå®žä¾‹ã€‚æ²¡æœ‰äººèƒ½å¤Ÿé˜»æ­¢ä½ ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼å®žä¾‹åŒ–åŒä¸€ä¸ªBeanï¼Œæˆ–è€…ä½ ç”šè‡³å¯ä»¥å®šä¹‰å‡ ä¸ªå£°æ˜Žæ¥å®žä¾‹åŒ–åŒä¸€ä¸ªBeanã€‚åˆå§‹åŒ–å’Œé”€æ¯Beanä¸ºBeanå®šä¹‰åˆå§‹åŒ–å’Œé”€æ¯æ“ä½œï¼Œåªéœ€è¦ä½¿ç”¨init-methodå’Œdestroy-methodå‚æ•°æ¥é…ç½®&lt;bean&gt;å…ƒç´ ã€‚init-methodå±žæ€§æŒ‡å®šäº†åœ¨åˆå§‹åŒ–Beanæ—¶è¦è°ƒç”¨çš„æ–¹æ³•ã€‚destroy-methodå±žæ€§æŒ‡å®šäº†Beanä»Žå®¹å™¨ç§»é™¤ä¹‹å‰è¦è°ƒç”¨çš„æ–¹æ³•ã€‚çŽ°åœ¨å®šä¹‰ä¸€ä¸ªç¯å…‰ç±»Lightï¼š12345678public class Light &#123; void turnOnTheLight()&#123; System.out.println("å¼€ç¯"); &#125; void turnOffTheLight()&#123; System.out.println("å…³ç¯"); &#125;&#125;åœ¨å®¹å™¨ä¸­é…ç½®è¯¥Beanï¼š12&lt;bean id="light" class="com.spring.entity.Light" init-method="turnOnTheLight" destroy-method="turnOffTheLight"/&gt;åŠ è½½å®¹å™¨ï¼Œä»¥æ­¤æ¥å®žä¾‹åŒ–lightï¼š123456789public class LightControl &#123; public static void main(String[] args) &#123; String conf="applicationContext.xml"; //åŠ è½½å®¹å™¨ ApplicationContext ac=new ClassPathXmlApplicationContext(conf); //å…³é—­å®¹å™¨ ((ClassPathXmlApplicationContext)ac).close(); &#125;&#125;è¾“å‡ºï¼š123å¼€ç¯...å…³ç¯æˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰é»˜è®¤çš„init-methodå’Œdestroy-methodã€‚å¦‚æžœä¸Šä¸‹æ–‡ä¸­Beanå®šä¹‰äº†åå­—ç›¸åŒçš„åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿä¸€é…ç½®default-init-methodå’Œdefault-destroy-methodï¼š12345678910111213141516171819202122232425262728&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:util="http://www.springframework.org/schema/util" xmlns:jee="http://www.springframework.org/schema/jee" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:jpa="http://www.springframework.org/schema/data/jpa" xmlns:mvc="http://www.springframework.org/schema/mvc" xsi:schemaLocation=" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.2.xsd http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.3.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd" default-init-method="turnOnTheLight" default-destroy-method="turnOffTheLight"&gt; &lt;!--Bean declarations go here --&gt;&lt;/beans&gt;ä¸ºBeanå®šä¹‰åˆå§‹åŒ–å’Œé”€æ¯çš„æ–¹æ³•æ˜¯è®©Beanå®žçŽ°Springçš„InitializingBeanå’ŒDisposableBeanæŽ¥å£ã€‚InitializingBeanå£°æ˜Žäº†ä¸€ä¸ªafterPropertiesSet()æ–¹æ³•ä½œä¸ºåˆå§‹åŒ–æ–¹æ³•ã€‚DisposableBeanå£°æ˜Žäº†ä¸€ä¸ªdestroy()æ–¹æ³•ä½œä¸ºé”€æ¯æ–¹æ³•ã€‚åœ¨Springå®¹å™¨ä¸­æ— éœ€ä»»ä½•é…ç½®ã€‚ä¿®æ”¹Lightç±»ï¼š12345678public class Light implements InitializingBean,DisposableBean&#123; public void afterPropertiesSet() throws Exception &#123; System.out.println("å¼€ç¯"); &#125; public void destroy() throws Exception &#123; System.out.println("å…³ç¯"); &#125;&#125; â€‹è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¾è€Œæ˜“è§äº†ï¼šå®žçŽ°Springçš„æŽ¥å£æ„å‘³ç€Beanä¸ŽSpringçš„APIäº§ç”Ÿäº†è€¦åˆã€‚æ‰€ä»¥è¿™ç§æ–¹æ³•å¹¶ä¸æŽ¨èï¼ã€ŠSpring In Actionã€‹è¯»ä¹¦ç¬”è®°]]></content>
      <tags>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jQueryé€‰æ‹©å™¨æ€»ç»“]]></title>
    <url>%2FjQuery%E9%80%89%E6%8B%A9%E5%99%A8%E6%80%BB%E7%BB%93.html</url>
    <content type="text"><![CDATA[jQueryé€‰æ‹©å™¨å’ŒCSSé€‰æ‹©å™¨ä¸€æ ·ï¼Œå¹¶åœ¨å…¶åŸºç¡€ä¸Šåšå‡ºäº†æ‹“å±•ã€‚å¯åœ¨æ­¤é¡µé¢ä¸Šç»ƒä¹ jQueryé€‰æ‹©å™¨ï¼šhttp://mrbird.leanote.com/single/jQuery-Selectors-Lab-PageåŸºæœ¬é€‰æ‹©å™¨é€‰æ‹©å™¨æè¿°è¿”å›žç¤ºä¾‹#idæ ¹æ®ç»™å®šçš„idåŒ¹é…ä¸€ä¸ªå…ƒç´ å•ä¸ªå…ƒç´ $(â€œ#testâ€)é€‰å–idä¸ºtestçš„å…ƒç´ .classæ ¹æ®ç»™å®šçš„ç±»ååŒ¹é…å…ƒç´ é›†åˆå…ƒç´ $(â€œ.testâ€)é€‰å–æ‰€æœ‰classä¸ºtestçš„å…ƒç´ elementæ ¹æ®ç»™å®šçš„å…ƒç´ ååŒ¹é…å…ƒç´ é›†åˆå…ƒç´ $(â€œpâ€)é€‰å–æ‰€æœ‰&lt;p&gt;å…ƒç´ *åŒ¹é…æ‰€æœ‰å…ƒç´ é›†åˆå…ƒç´ $(â€œ*â€)é€‰å–æ‰€æœ‰å…ƒç´ selector1,selector2 â€¦â€¦ï¼ŒselectorNå°†æ¯ä¸€ä¸ªé€‰æ‹©å™¨åŒ¹é…åˆ°çš„å…ƒç´ åˆå¹¶åŽä¸€èµ·è¿”å›žé›†åˆå…ƒç´ $(â€œdiv,span,p.myClassâ€)é€‰å–æ‰€æœ‰&lt;div&gt;ï¼Œ&lt;span&gt;å’Œ æ‹¥æœ‰classä¸ºmyClassçš„&lt;p&gt;æ ‡ç­¾çš„ä¸€ç»„å…ƒç´ å±‚æ¬¡é€‰æ‹©å™¨é€‰æ‹©å™¨æè¿°è¿”å›žç¤ºä¾‹$(â€œancestor descendantâ€)é€‰å–ancestorå…ƒç´ é‡Œçš„æ‰€æœ‰descendantï¼ˆåŽä»£ï¼‰å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv spanâ€)é€‰å–&lt;div&gt;é‡Œçš„æ‰€æœ‰çš„&lt;span&gt;å…ƒç´ $(â€œparent&gt;childâ€)é€‰å–parentå…ƒç´ ä¸‹çš„childå…ƒç´ ä¸Ž\$(â€œancestor descendantâ€)æœ‰åŒºåˆ«ï¼Œ\$(â€œancestor descendantâ€)é€‰æ‹©çš„æ˜¯åŽä»£å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv&gt;spanâ€)é€‰å–&lt;div&gt;å…ƒç´ ä¸‹å…ƒç´ åæ˜¯&lt;span&gt;çš„å­å…ƒç´ $(â€œprev+nextâ€)é€‰å–ç´§æŽ¥åœ¨prevå…ƒç´ åŽçš„nextå…ƒç´ é›†åˆå…ƒç´ $(â€œ.one+divâ€)é€‰å–classä¸ºoneçš„ä¸‹ä¸€ä¸ª&lt;div&gt;åŒè¾ˆå…ƒç´ $(â€œprev~siblingsâ€)é€‰å–prevå…ƒç´ ä¹‹åŽçš„æ‰€æœ‰siblingså…ƒç´ é›†åˆå…ƒç´ $(â€œ#two~divâ€)é€‰å–idä¸ºtwoçš„å…ƒç´ åŽçš„ æ‰€æœ‰&lt;div&gt;åŒè¾ˆå…ƒç´ è¿‡æ»¤é€‰æ‹©å™¨jQueryè¿‡æ»¤é€‰æ‹©å™¨è§„åˆ™åŒCSSä¸­çš„ä¼ªç±»é€‰æ‹©å™¨ï¼Œéƒ½ä»¥ä¸€ä¸ªå†’å·(:)å¼€å¤´ã€‚æŒ‰ç…§ä¸åŒçš„è¿‡æ»¤è§„åˆ™ï¼Œè¿‡æ»¤é€‰æ‹©å™¨å¯ä»¥åˆ†ä¸ºåŸºæœ¬è¿‡æ»¤å™¨ï¼Œå†…å®¹è¿‡æ»¤å™¨ï¼Œå¯è§æ€§è¿‡æ»¤å™¨ï¼Œå±žæ€§è¿‡æ»¤å™¨ï¼Œå­å…ƒç´ è¿‡æ»¤å™¨å’Œè¡¨å•å¯¹è±¡å±žæ€§è¿‡æ»¤é€‰æ‹©å™¨ã€‚åŸºæœ¬è¿‡æ»¤é€‰æ‹©å™¨é€‰æ‹©å™¨&nbsp;æè¿°è¿”å›žç¤ºä¾‹:firsté€‰å–ç¬¬ä¸€ä¸ªå…ƒç´ å•ä¸ªå…ƒç´ $(â€œdiv:firstâ€)é€‰å–æ‰€æœ‰&lt;div&gt;å…ƒç´ ä¸­ç¬¬ä¸€ä¸ª&lt;div&gt;å…ƒç´ :lasté€‰å–æœ€åŽä¸€ä¸ªå…ƒç´ å•ä¸ªå…ƒç´ $(â€œdiv:lastâ€)é€‰å–æ‰€æœ‰&lt;div&gt;å…ƒç´ ä¸­æœ€åŽä¸€ä¸ª&lt;div&gt;å…ƒç´ :not(selector)åŽ»é™¤æ‰€æœ‰ä¸Žç»™å®šé€‰æ‹©å™¨åŒ¹é…çš„ å…ƒç´ é›†åˆå…ƒç´ $(â€œinput:not(.myClass)â€)é€‰å–classä¸æ˜¯myClassçš„&lt;input&gt; å…ƒç´ :evené€‰å–ç´¢å¼•æ˜¯å¶æ•°çš„æ‰€æœ‰å…ƒç´ ï¼Œ ç´¢å¼•ä»Ž0å¼€å§‹é›†åˆå…ƒç´ $(â€œinput:evenâ€)é€‰å–ç´¢å¼•æ˜¯å¶æ•°çš„&lt;input&gt;å…ƒç´ :oddé€‰å–ç´¢å¼•æ˜¯å¥‡æ•°çš„æ‰€æœ‰å…ƒç´ ï¼Œ ç´¢å¼•ä»Ž0å¼€å§‹é›†åˆå…ƒç´ $(â€œinput:oddâ€)é€‰å–ç´¢å¼•æ˜¯å¥‡æ•°çš„&lt;input&gt;å…ƒç´ :eq(index)é€‰å–ç´¢å¼•ç­‰äºŽindexçš„å…ƒç´ ï¼Œ (index)ä»Ž0å¼€å§‹é›†åˆå…ƒç´ $(â€œinput:eq(1)â€)é€‰å–ç´¢å¼•ç­‰äºŽ1çš„&lt;input&gt;å…ƒç´ :gt(index)é€‰å–ç´¢å¼•å¤§äºŽindexçš„å…ƒç´ ï¼Œ (index)ä»Ž0å¼€å§‹é›†åˆå…ƒç´ $(â€œinput:gt(1)â€)é€‰å–ç´¢å¼•å¤§äºŽ1çš„&lt;input&gt;å…ƒç´ ï¼ˆæ³¨ï¼šå¤§äºŽ1ï¼Œè€Œä¸åŒ…æ‹¬1ï¼‰:lt(index)é€‰å–ç´¢å¼•å°äºŽindexçš„å…ƒç´ ï¼Œ (index)ä»Ž0å¼€å§‹é›†åˆå…ƒç´ $(â€œinput:lt(1)â€)é€‰å–ç´¢å¼•å°äºŽ1çš„&lt;input&gt;å…ƒç´ ï¼ˆæ³¨ï¼šå°äºŽ1ï¼Œè€Œä¸åŒ…æ‹¬1ï¼‰:headeré€‰å–æ‰€æœ‰çš„æ ‡é¢˜å…ƒç´ ï¼Œå¦‚h1ï¼Œ h2ç­‰é›†åˆå…ƒç´ $(â€œ:headerâ€)é€‰å–ç½‘é¡µä¸­æ‰€æœ‰headerï¼Œå¦‚h1,h2â€¦:animatedé€‰å–å½“å‰æ­£åœ¨æ‰§è¡ŒåŠ¨ç”»çš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv:animateâ€)é€‰å–æ­£åœ¨æ‰§è¡ŒåŠ¨ç”»çš„&lt;div&gt;å…ƒç´ :focusèŽ·å–å½“å‰èŽ·å–ç„¦ç‚¹çš„å…ƒç´ é›†åˆå…ƒç´ $(â€œinput:focusâ€)èŽ·å–å½“å‰èŽ·å–ç„¦ç‚¹çš„&lt;input&gt;å…ƒç´ :rooté€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´ å•ä¸ªå…ƒç´ $(â€œ:rootâ€)èŽ·å–å½“å‰æ–‡æ¡£çš„æ ¹å…ƒç´ :lang(language)åªé€‰æ‹©é‡‡ç”¨ç‰¹å®šè¯­è¨€çš„å…ƒç´ é›†åˆå…ƒç´ $(â€œp:lang(en)â€)é€‰å–å¸¦æœ‰ä»¥ â€œenâ€ å¼€å¤´çš„lang å±žæ€§å€¼çš„æ‰€æœ‰ &lt;p&gt; å…ƒç´ å†…å®¹è¿‡æ»¤é€‰æ‹©å™¨é€‰æ‹©å™¨æè¿°è¿”å›žç¤ºä¾‹:contains(text)é€‰å–å«æœ‰æ–‡æœ¬å†…å®¹ä¸ºâ€textâ€çš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv:contents(â€˜æˆ‘â€™)â€)é€‰å–å«æœ‰æ–‡æœ¬æˆ‘çš„&lt;div&gt;å…ƒç´ :emptyé€‰å–ä¸åŒ…å«å­å…ƒç´ å’Œæ–‡æœ¬çš„ç©ºå…ƒç´ é›†åˆå…ƒç´ $(â€œdiv:emptyâ€)é€‰å–ä¸åŒ…å«å­å…ƒç´ (åŒ…æ‹¬æ–‡æœ¬å…ƒç´ )çš„ &lt;div&gt;å…ƒç´ :has(selector)é€‰å–å«æœ‰é€‰æ‹©å™¨æ‰€åŒ¹é…çš„å…ƒç´ çš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv:has(p)â€)é€‰å–å«æœ‰&lt;p&gt;å…ƒç´ çš„&lt;div&gt;å…ƒç´ :parenté€‰å–å«æœ‰å­å…ƒç´ æˆ–æ–‡æœ¬çš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv:parentâ€)é€‰å–æ‹¥æœ‰å­å…ƒç´ ï¼ˆåŒ…æ‹¬æ–‡æœ¬å…ƒç´ ï¼‰çš„ &lt;div&gt;å…ƒç´ å¯è§æ€§è¿‡æ»¤é€‰æ‹©å™¨é€‰æ‹©å™¨æè¿°è¿”å›žç¤ºä¾‹:hiddené€‰å–æ‰€æœ‰ä¸å¯è§å…ƒç´ é›†åˆå…ƒç´ \$(â€œ:hiddenâ€)é€‰å–æ‰€æœ‰ä¸å¯è§å…ƒç´ ã€‚åŒ…æ‹¬&lt;input type=â€hidden/â€œ&gt;ï¼Œ&lt;div sytle=â€dispaly:none;â€&gt;å’Œ&lt;div&gt;ç­‰å…ƒç´ ã€‚å¦‚æžœåªæƒ³é€‰å–&lt;input&gt;å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨\$(â€œinput:hiddenâ€):visibleé€‰å–æ‰€æœ‰å¯è§å…ƒç´ é›†åˆå…ƒç´ $(â€œinput:visibleâ€)é€‰å–æ‰€æœ‰å¯è§çš„&lt;div&gt;å…ƒç´ å±žæ€§è¿‡æ»¤é€‰æ‹©å™¨é€‰æ‹©å™¨æè¿°è¿”å›žç¤ºä¾‹[attribute]é€‰å–æ‹¥æœ‰æ­¤å±žæ€§çš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv[id]â€)é€‰å–æ‹¥æœ‰å±žæ€§idçš„å…ƒç´ [attribute=value]é€‰å–å±žæ€§çš„å€¼ä¸ºvalueçš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv[title=test]â€)é€‰å–å±žæ€§titleä¸ºâ€testâ€çš„&lt;div&gt;å…ƒç´ [attribute!=value]é€‰å–å±žæ€§çš„å€¼ä¸ç­‰äºŽvalueçš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv[title!=test]â€)é€‰å–å±žæ€§titleä¸ç­‰äºŽâ€testâ€çš„&lt;div&gt;å…ƒç´ ï¼ˆæ³¨æ„ï¼šæ²¡æœ‰å±žæ€§titleçš„&lt;div&gt;å…ƒç´ ä¹Ÿä¼šè¢«é€‰å–ï¼‰[attribute^=value]é€‰å–å±žæ€§çš„å€¼ä»¥valueå¼€å§‹çš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv[title^=test]â€)é€‰å–å±žæ€§titleä»¥â€testâ€å¼€å§‹çš„&lt;div&gt;[attribute$=value]é€‰å–å±žæ€§çš„å€¼ä»¥valueç»“æŸçš„å…ƒç´ é›†åˆå…ƒç´ \$(â€œdiv[title$=test]â€)é€‰å–å±žæ€§titleä»¥â€testâ€ç»“æŸçš„&lt;div&gt;[attribute*=value]é€‰å–å±žæ€§çš„å€¼å«æœ‰valueçš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv[title*=test]â€)é€‰å–å±žæ€§titleå«æœ‰â€testâ€çš„&lt;div&gt;[attribute|=value]é€‰å–å±žæ€§ç­‰äºŽç»™å®šå­—ç¬¦ä¸²æˆ–ä»¥è¯¥å­—ç¬¦ä¸²ä¸ºå‰ç¼€ï¼ˆè¯¥å­—ç¬¦ä¸²åŽè·Ÿä¸€ä¸ªâ€œ_â€œï¼‰çš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv[title|=â€™enâ€™]â€)é€‰å–å±žæ€§titeç­‰äºŽenæˆ–ä»¥enä¸ºå‰ç¼€ï¼ˆè¯¥å­—ç¬¦ä¸²åŽè·Ÿä¸€ä¸ªè¿žå­—ç¬¦â€_â€œï¼‰çš„å…ƒç´ [attribute~=value]é€‰å–å±žæ€§ç”¨ç©ºæ ¼åˆ†éš”çš„å€¼ä¸­åŒ…å«ä¸€ä¸ªç»™å®šå€¼çš„å…ƒç´ é›†åˆå…ƒç´ $(â€œdiv[title~=â€™ukâ€™]â€)é€‰å–å±žæ€§titleç”¨ç©ºæ ¼åˆ†éš”çš„å€¼ä¸­åŒ…å«å­—ç¬¦ukçš„å…ƒç´ [attribute1][attribute2][attributeN]å¤åˆå±žæ€§é€‰æ‹©å™¨æ»¡è¶³å¤šä¸ªæ¡ä»¶ï¼Œæ¯é€‰æ‹©ä¸€æ¬¡ï¼ŒèŒƒå›´ç¼©å°ä¸€æ¬¡é›†åˆå…ƒç´ \$(â€œdiv[id][title$=â€™testâ€™]â€)é€‰å–æ‹¥æœ‰å±žæ€§idï¼Œå¹¶ä¸”å±žæ€§titleä»¥â€testâ€ç»“æŸçš„&lt;div&gt;å…ƒç´ å­å…ƒç´ è¿‡æ»¤é€‰æ‹©å™¨é€‰æ‹©å™¨æè¿°è¿”å›žç¤ºä¾‹:nth-child(index/even/odd/equation)é€‰å–æ¯ä¸ªçˆ¶å…ƒç´ ä¸‹çš„ç¬¬indexä¸ªå­å…ƒç´ æˆ–è€…å¥‡å¶å…ƒç´ ï¼ˆindexä»Ž1å¼€å§‹ï¼‰é›†åˆå…ƒç´ :eq(index)åªåŒ¹é…ä¸€ä¸ªå…ƒç´ ï¼Œè€Œ:nth-childå°†ä¸ºæ¯ä¸€ä¸ªçˆ¶å…ƒç´ åŒ¹é…å­å…ƒç´ ï¼Œå¹¶ä¸”:nth-child(index)çš„indexæ˜¯ä»Ž1å¼€å§‹çš„ï¼Œè€Œeq(index)æ˜¯ä»Ž0å¼€å§‹çš„:nth-last-child(index/even/odd/equation)é€‰å–çˆ¶å…ƒç´ ä¸‹çš„å€’æ•°ç¬¬nä¸ªå­å…ƒç´ æˆ–ç¬¦åˆç‰¹å®šé¡ºåºè§„åˆ™çš„å…ƒç´ &nbsp;é›†åˆå…ƒç´ &nbsp;:nth-last-child(2)è¡¨ç¤ºä½œä¸ºçˆ¶å…ƒç´ çš„å€’æ•°ç¬¬2ä¸ªå­å…ƒç´ ï¼›:nth-last-child(3n)è¡¨ç¤ºåŒ¹é…ä½œä¸ºçˆ¶å…ƒç´ å€’æ•°é¡ºåºçš„ç¬¬3nä¸ªå­å…ƒç´ çš„å…ƒç´ ï¼ˆnè¡¨ç¤ºåŒ…æ‹¬0åœ¨å†…çš„è‡ªç„¶æ•°ï¼‰:first-childé€‰å–æ¯ä¸ªçˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ é›†åˆå…ƒç´ :firståªè¿”å›žä¸€ä¸ªå…ƒç´ ï¼Œè€Œ:first-childé€‰æ‹©ç¬¦å°†ä¸ºæ¯ä¸ªçˆ¶å…ƒç´ åŒ¹é…å­å…ƒç´ ã€‚ä¾‹å¦‚$(â€œul li:fisrt-childâ€)é€‰å–æ¯ä¸ª&lt;ul&gt;ä¸­çš„ç¬¬ä¸€ä¸ª&lt;li&gt;å…ƒç´ :last-childé€‰å–æ¯ä¸ªçˆ¶å…ƒç´ çš„æœ€åŽä¸€ä¸ªå­å…ƒç´ é›†åˆå…ƒç´ :laståªè¿”å›žä¸€ä¸ªå…ƒç´ ï¼Œè€Œ:last-childé€‰æ‹©ç¬¦å°†ä¸ºæ¯ä¸ªçˆ¶å…ƒç´ åŒ¹é…å­å…ƒç´ ã€‚ä¾‹å¦‚$(â€œul li:last-childâ€)é€‰å–æ¯ä¸ª&lt;ul&gt;ä¸­çš„æœ«å°¾&lt;li&gt;å…ƒç´ :only-childå¦‚æžœæŸä¸ªå…ƒç´ æ˜¯å®ƒçˆ¶å…ƒç´ ä¸­å”¯ä¸€çš„å­å…ƒç´ ï¼Œé‚£ä¹ˆå°†ä¼šè¢«åŒ¹é…ã€‚å¦‚æžœçˆ¶å…ƒç´ ä¸­å«æœ‰å…¶ä»–å…ƒç´ ï¼Œé‚£ä¹ˆä¸ä¼šè¢«åŒ¹é…é›†åˆå…ƒç´ $(â€œul li:only-childâ€)åœ¨&lt;ul&gt;ä¸­é€‰å–æ˜¯å”¯ä¸€å­å…ƒç´ çš„&lt;li&gt;å…ƒç´ :only-of-typeåŒ¹é…ä½œä¸ºçˆ¶å…ƒç´ å”¯ä¸€ä¸€ä¸ªè¯¥ç±»åž‹çš„å­å…ƒç´ çš„å…ƒç´ ï¼Œå°†å…¶å°è£…ä¸ºjQueryå¯¹è±¡å¹¶è¿”å›žã€‚é›†åˆå…ƒç´ $(â€œli:only-of-typeâ€)é€‰å–liçˆ¶å…ƒç´ ä¸‹çš„å”¯ä¸€çš„ä¸€ä¸ªliå…ƒç´ :first-fo-typeåŒ¹é…ä½œä¸ºçˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªè¯¥ç±»åž‹çš„å­å…ƒç´ çš„å…ƒç´ ï¼Œå°†å…¶å°è£…ä¸ºjQueryå¯¹è±¡å¹¶è¿”å›žé›†åˆå…ƒç´ \$(â€œspan:first-of-typeâ€)é€‰å–spançˆ¶å…ƒç´ ä¸‹çš„ç¬¬ä¸€ä¸ªspanå…ƒç´ ï¼Œç­‰ä»·äºŽ\$(â€œspan:nth-of-type(1)â€):last-of-typeåŒ¹é…ä½œä¸ºçˆ¶å…ƒç´ çš„æœ€åŽä¸€ä¸ªè¯¥ç±»åž‹çš„å­å…ƒç´ çš„å…ƒç´ ï¼Œå°†å…¶å°è£…ä¸ºjQueryå¯¹è±¡å¹¶è¿”å›ž&nbsp;é›†åˆå…ƒç´ \$(â€œspan:last-of-typeâ€)é€‰å–spançˆ¶å…ƒç´ ä¸‹çš„æœ€åŽä¸€ä¸ªspanå…ƒç´ ï¼Œç­‰ä»·äºŽ\$(â€œspan:nth-last-of-type(1)â€):nth-of-type(index/even/odd/equation)åŒ¹é…ä½œä¸ºçˆ¶å…ƒç´ çš„åŒç±»åž‹å­å…ƒç´ ä¸­çš„ç¬¬nä¸ª(æˆ–ç¬¦åˆç‰¹å®šé¡ºåºçš„)å…ƒç´ ï¼Œå°†å…¶å°è£…ä¸ºjQueryå¯¹è±¡å¹¶è¿”å›ž&nbsp;é›†åˆå…ƒç´ &nbsp; $(â€œspan:nth-of-type(2)â€)é€‰å–spançˆ¶å…ƒç´ ä¸‹çš„ç¬¬äºŒä¸ªspanå…ƒç´ :nth-last-of-type(index/even/odd/equation)åŒ¹é…ä½œä¸ºçˆ¶å…ƒç´ çš„åŒç±»åž‹å­å…ƒç´ ä¸­çš„å€’æ•°ç¬¬nä¸ªï¼ˆæˆ–ç¬¦åˆç‰¹å®šå€’æ•°é¡ºåºçš„ï¼‰å…ƒç´ ï¼Œå°†å…¶å°è£…ä¸ºjQueryå¯¹è±¡å¹¶è¿”å›ž&nbsp;é›†åˆå…ƒç´ $(â€œspan:nth-last-of-type(2)â€)é€‰å–spançˆ¶å…ƒç´ ä¸‹çš„å€’æ•°ç¬¬äºŒä¸ªspanå…ƒç´ :nth-child()é€‰æ‹©å™¨æ˜¯å¾ˆå¸¸è§çš„å­å…ƒç´ è¿‡æ»¤é€‰æ‹©å™¨ï¼Œè¯¦ç»†åŠŸèƒ½å¦‚ä¸‹ï¼š(1) :nth-child(even)èƒ½é€‰å–æ¯ä¸ªçˆ¶å…ƒç´ ä¸‹çš„ç´¢å¼•å€¼æ˜¯å¶æ•°çš„å…ƒç´ ã€‚(2) :nth-child(odd)èƒ½é€‰å–æ¯ä¸ªçˆ¶å…ƒç´ ä¸‹çš„ç´¢å¼•å€¼æ˜¯å¥‡æ•°çš„å…ƒç´ ã€‚(3) :nth-child(2)èƒ½é€‰å–æ¯ä¸ªçˆ¶å…ƒç´ ä¸‹çš„ç´¢å¼•å€¼ç­‰äºŽ2çš„å…ƒç´ ã€‚(4) :nth-child(3n)èƒ½é€‰å–æ¯ä¸ªçˆ¶å…ƒç´ ä¸‹çš„ç´¢å¼•å€¼æ˜¯3çš„å€æ•°çš„å…ƒç´ ã€‚(nä»Ž1å¼€å§‹)å¦å¤–ï¼Œå…³äºŽ:only-childå’Œ:only-of-typeçš„åŒºåˆ«å¯ä»¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š1234567891011&lt;ul&gt; &lt;span id="span"&gt;span&lt;/span&gt; &lt;li id="li1"&gt;li1&lt;/li&gt;&lt;/ul&gt;&lt;ul&gt; &lt;li id="li2"&gt;li2&lt;/li&gt;&lt;/ul&gt;&lt;script&gt; console.log($("li:only-child")); console.log($("li:only-of-type"));&lt;/script&gt;æ‰“å°ç»“æžœï¼šè¡¨å•å¯¹è±¡å±žæ€§è¿‡æ»¤é€‰æ‹©å™¨æ­¤é€‰æ‹©å™¨ä¸»è¦æ˜¯å¯¹æ‰€é€‰æ‹©çš„è¡¨å•å…ƒç´ è¿›è¡Œè¿‡æ»¤ï¼Œä¾‹å¦‚é€‰æ‹©è¢«é€‰ä¸­çš„ä¸‹æ‹‰æ¡†ï¼Œå¤šé€‰æ¡†ç­‰å…ƒç´ ã€‚é€‰æ‹©å™¨æè¿°è¿”å›žç¤ºä¾‹:enabledé€‰å–æ‰€æœ‰å¯ç”¨å…ƒç´ é›†åˆå…ƒç´ $(â€œ#form1:enabledâ€)é€‰å–idä¸ºform1çš„è¡¨å•å†…æ‰€æœ‰å¯ç”¨å…ƒç´ :disabledé€‰å–æ‰€æœ‰ä¸å¯ç”¨å…ƒç´ é›†åˆå…ƒç´ $(â€œ#form2:disabledâ€)é€‰å–idä¸ºform2çš„è¡¨å•å†…æ‰€æœ‰ä¸å¯ç”¨å…ƒç´ :checkedé€‰å–æ‰€æœ‰è¢«é€‰ä¸­çš„å…ƒç´ ï¼ˆå•é€‰æ¡†ï¼Œå¤é€‰æ¡†ï¼‰é›†åˆå…ƒç´ $(â€œinput:checkedâ€)é€‰å–æ‰€æœ‰è¢«é€‰ä¸­çš„&lt;input&gt;å…ƒç´ :selectedé€‰å–æ‰€æœ‰è¢«é€‰ä¸­çš„é€‰é¡¹å…ƒç´ ï¼ˆä¸‹æ‹‰åˆ—è¡¨ï¼‰é›†åˆå…ƒç´ $(â€œselect option:selectedâ€)é€‰å–æ‰€æœ‰è¢«é€‰ä¸­çš„é€‰é¡¹å…ƒç´ è¡¨å•é€‰æ‹©å™¨é€‰æ‹©å™¨æè¿°è¿”å›žç¤ºä¾‹:inputé€‰å–æ‰€æœ‰&lt;input&gt;ï¼Œ&lt;textarea&gt;,&lt;select&gt;å’Œ&lt;button&gt;å…ƒç´ é›†åˆå…ƒç´ $(â€œ:inputâ€)é€‰å–æ‰€æœ‰&lt;input&gt;ï¼Œ&lt;textarea&gt;ï¼Œ&lt;select&gt;å’Œ&lt;button&gt;å…ƒç´ :texté€‰å–æ‰€æœ‰çš„å•è¡Œæ–‡æœ¬æ¡†é›†åˆå…ƒç´ $(â€œ:textâ€)é€‰å–æ‰€æœ‰çš„å•è¡Œæ–‡æœ¬æ¡†:passwordé€‰å–æ‰€æœ‰çš„å¯†ç æ¡†é›†åˆå…ƒç´ $(â€œ:passwordâ€)é€‰å–æ‰€æœ‰çš„å¯†ç æ¡†:radioé€‰å–æ‰€æœ‰çš„å•é€‰æ¡†é›†åˆå…ƒç´ $(â€œ:radioâ€)é€‰å–æ‰€æœ‰çš„å•é€‰æ¡†:checkboxé€‰å–æ‰€æœ‰çš„å¤šé€‰æ¡†é›†åˆå…ƒç´ $(â€œ:checkboxâ€)é€‰å–æ‰€æœ‰çš„å¤šé€‰æ¡†:submité€‰å–æ‰€æœ‰çš„æäº¤æŒ‰é’®é›†åˆå…ƒç´ $(â€œ:submitâ€)é€‰å–æ‰€æœ‰çš„æäº¤æŒ‰é’®:imageé€‰å–æ‰€æœ‰çš„å›¾åƒæŒ‰é’®é›†åˆå…ƒç´ $(â€œ:imageâ€)é€‰å–æ‰€æœ‰çš„å›¾åƒæŒ‰é’®:reseté€‰å–æ‰€æœ‰çš„é‡ç½®æŒ‰é’®é›†åˆå…ƒç´ $(â€œ:resetâ€)é€‰å–æ‰€æœ‰çš„é‡ç½®æŒ‰é’®:buttoné€‰å–æ‰€æœ‰çš„æŒ‰é’®é›†åˆå…ƒç´ $(â€œ:buttonâ€)é€‰å–æ‰€æœ‰çš„æŒ‰é’®:fileé€‰å–æ‰€æœ‰çš„ä¸Šä¼ åŸŸé›†åˆå…ƒç´ $(â€œ:fileâ€)é€‰å–æ‰€æœ‰çš„ä¸Šä¼ åŸŸ:hiddené€‰å–æ‰€æœ‰çš„ä¸å¯è§å…ƒç´ é›†åˆå…ƒç´ åŒå‰æ‰€è¿°]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è§£æ±ºjQueryå’Œå…¶ä»–åº“çš„å†²çª]]></title>
    <url>%2F%E8%A7%A3%E6%B1%BAjQuery%E5%92%8C%E5%85%B6%E4%BB%96%E5%BA%93%E7%9A%84%E5%86%B2%E7%AA%81.html</url>
    <content type="text"><![CDATA[jQueryåº“åœ¨å…¶ä»–åº“ä¹‹åŽå¯¼å…¥åœ¨å…¶ä»–åº“å’ŒjQueryåº“éƒ½è¢«åŠ è½½å®Œæ¯•åŽï¼Œå¯ä»¥ä»»ä½•æ—¶å€™è°ƒç”¨jQuery.noConflict()å‡½æ•°æ¥å°†å˜é‡\$çš„ä½¿ç”¨æƒç§»äº¤ç»™å…¶ä»–JavaScriptåº“ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š1234567891011121314151617181920// ...çœç•¥å…¶ä»–ä»£ç &lt;p id="pp"&gt;Test-prototype(å°†è¢«éšè—)&lt;/p&gt;&lt;p &gt;Test-jQuery(å°†è¢«ç»‘å®šå•å‡»äº‹ä»¶)&lt;/p&gt;&lt;!-- å¼•å…¥ prototype --&gt;&lt;script src="lib/prototype.js" type="text/javascript"&gt;&lt;/script&gt;&lt;!-- å¼•å…¥ jQuery --&gt;&lt;script src="../../scripts/jquery.js" type="text/javascript"&gt;&lt;/script&gt;&lt;script type="text/javascript"&gt;jQuery.noConflict(); //å°†å˜é‡$çš„æŽ§åˆ¶æƒè®©æ¸¡ç»™prototype.jsjQuery(function()&#123; //ä½¿ç”¨jQuery jQuery("p").click(function()&#123; alert( jQuery(this).text() ); &#125;);&#125;); $("#pp").style.display = 'none'; //ä½¿ç”¨prototype.jséšè—å…ƒç´ &lt;/script&gt; &lt;/body&gt;// ...çœç•¥å…¶ä»–ä»£ç ç„¶åŽï¼Œå°±å¯ä»¥åœ¨ç¨‹åºé‡Œä½¿ç”¨jQuery()å‡½æ•°ä½œä¸ºjQueryå¯¹è±¡çš„åˆ¶é€ å·¥åŽ‚ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§é€‰æ‹©ã€‚å¦‚æžœæƒ³ç¡®ä¿jQueryâ€™ä¸ä¼šä¸Žå…¶ä»–åº“å†²çªï¼Œä½†åˆæƒ³è‡ªå®šä¹‰ä¸€ä¸ªå¿«æ·æ–¹å¼ã€‚å¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š123456789101112// ...çœç•¥å…¶ä»–ä»£ç &lt;script type="text/javascript"&gt;var $j = jQuery.noConflict(); //è‡ªå®šä¹‰ä¸€ä¸ªæ¯”è¾ƒçŸ­å¿«æ·æ–¹å¼$j(function()&#123; //ä½¿ç”¨jQueryï¼Œåˆ©ç”¨è‡ªå®šä¹‰å¿«æ·æ–¹å¼â€”â€”$j $j("p").click(function()&#123; alert( $j(this).text() ); &#125;);&#125;); $("#pp").style.display = 'none'; //ä½¿ç”¨prototype.jséšè—å…ƒç´ &lt;/script&gt;// ...çœç•¥å…¶ä»–ä»£ç å¯ä»¥è‡ªå®šä¹‰å¤‡ç”¨åç§°ï¼Œä¾‹å¦‚jqï¼Œ\$jç­‰ã€‚å¦‚æžœä¸æƒ³è‡ªå®šä¹‰åç§°ï¼Œè¿˜æƒ³ç»§ç»­ä½¿ç”¨\$ç¬¦å·ï¼Œåˆä¸èƒ½ä¸Žå…¶ä»–jsåº“å†²çªçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§åŠžæ³•ï¼šå…¶ä¸€ï¼š12345678910&lt;script type="text/javascript"&gt;jQuery.noConflict(); //å°†å˜é‡$çš„æŽ§åˆ¶æƒè®©æ¸¡ç»™prototype.jsjQuery(function($)&#123; //ä½¿ç”¨jQueryè®¾å®šé¡µé¢åŠ è½½æ—¶æ‰§è¡Œçš„å‡½æ•° $("p").click(function()&#123; //åœ¨å‡½æ•°å†…éƒ¨ç»§ç»­ä½¿ç”¨ $() æ–¹æ³• alert( $(this).text() ); &#125;);&#125;); $("#pp").style.display = 'none'; //ä½¿ç”¨prototype&lt;/script&gt;å…¶äºŒï¼š123456789101112&lt;script type="text/javascript"&gt;jQuery.noConflict(); //å°†å˜é‡$çš„æŽ§åˆ¶æƒè®©æ¸¡ç»™prototype.js(function($)&#123; //å®šä¹‰åŒ¿åå‡½æ•°å¹¶è®¾ç½®å½¢å‚ä¸º$ $(function()&#123; //åŒ¿åå‡½æ•°å†…éƒ¨çš„$å‡ä¸ºjQuery $("p").click(function()&#123; //ç»§ç»­ä½¿ç”¨ $() æ–¹æ³• alert($(this).text()); &#125;); &#125;);&#125;)(jQuery); //æ‰§è¡ŒåŒ¿åå‡½æ•°ä¸”ä¼ é€’å®žå‚jQuery $("#pp").style.display = 'none'; //ä½¿ç”¨prototype&lt;/script&gt;jQueryåº“åœ¨å…¶ä»–åº“ä¹‹å‰å¯¼å…¥å¦‚æžœjQueryåº“åœ¨å…¶ä»–åº“ä¹‹å‰å°±å¯¼å…¥äº†ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æŽ¥ä½¿ç”¨â€œjQueryâ€æ¥åšä¸€äº›jQueryçš„å·¥ä½œï¼ŒåŒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨\$()æ–¹æ³•ä½œä¸ºå…¶ä»–åº“çš„å¿«æ·æ–¹å¼ã€‚æ— éœ€è°ƒç”¨jQuery.noConflict()å‡½æ•°ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š12345678910111213141516171819&lt;!-- å¼•å…¥ jQuery --&gt;&lt;script src="../../scripts/jquery.js" type="text/javascript"&gt;&lt;/script&gt;&lt;!-- å¼•å…¥ prototype --&gt;&lt;script src="lib/prototype.js" type="text/javascript"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;p id="pp"&gt;Test-prototype(å°†è¢«éšè—)&lt;/p&gt;&lt;p &gt;Test-jQuery(å°†è¢«ç»‘å®šå•å‡»äº‹ä»¶)&lt;/p&gt; &lt;script type="text/javascript"&gt;jQuery(function()&#123; //ç›´æŽ¥ä½¿ç”¨ jQuery ,æ²¡æœ‰å¿…è¦è°ƒç”¨"jQuery.noConflict()"å‡½æ•°ã€‚ jQuery("p").click(function()&#123; alert( jQuery(this).text() ); &#125;);&#125;); $("#pp").style.display = 'none'; //ä½¿ç”¨prototype&lt;/script&gt;&lt;/body&gt;]]></content>
      <tags>
        <tag>jQuery</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java åå°„æœºåˆ¶]]></title>
    <url>%2FJava-%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6.html</url>
    <content type="text"><![CDATA[JAVAåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºŽä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±žæ€§å’Œæ–¹æ³•ï¼›å¯¹äºŽä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±žæ€§ï¼›è¿™ç§åŠ¨æ€èŽ·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶ã€‚â€”-ç™¾åº¦ç™¾ç§‘åŠ¨æ€ï¼šè¿è¡ŒæœŸé—´åŠ¨æ€ç»‘å®šæ‰§è¡Œè§„åˆ™ã€‚é™æ€ï¼šç¼–è¯‘ä»¥åŽå°±å·²ç»ç¡®å®šçš„æ‰§è¡Œè¿‡ç¨‹ã€‚åŠ¨æ€åŠ è½½ç±»åˆ°æ–¹æ³•åŒº1234567891011public void test1()&#123; String str = new String("Hello"); Class cls = String.class; //åŠ¨æ€èŽ·å– Stringç±»åž‹çš„æ–¹æ³•ä¿¡æ¯ï¼š Method[] all = cls.getDeclaredMethods(); //Method ä»£è¡¨æ–¹æ³•çš„ä¿¡æ¯ // method.getName å¯ä»¥èŽ·å–æ–¹æ³•çš„åç§° for (Method method : all) &#123; System.out.println(method.getName()); &#125;&#125;åˆ›å»ºå¯¹è±¡è¿‡ç¨‹1.Java å°†ç±»åŠ è½½åˆ°æ–¹æ³•åŒºï¼ˆè‡ªåŠ¨å®Œæˆï¼‰2.åˆ©ç”¨ç±»åˆ›å»ºå¯¹è±¡ã€‚å†…å­˜ä¸­æœ‰ä¸€ä¸ªStringå¯¹è±¡ï¼Œæ–¹æ³•åŒºä¸­è¿˜æœ‰ç±»çš„ä¿¡æ¯ï¼é€šè¿‡Classå¯¹è±¡å¯ä»¥èŽ·å–ç±»çš„ç›¸å…³ä¿¡æ¯ã€‚åŠ¨æ€èŽ·å–ç±»çš„ä¿¡æ¯åŠ¨æ€èŽ·å–ç±»çš„æ–¹æ³•ä¿¡æ¯Fooç±»ï¼ˆpackageï¼šdemoï¼‰ï¼š12345678910//ç¼–è¯‘ä»¥åŽæ˜¯ demo.Foo.class//ç±»çš„å…¨åæ˜¯ demo.Fooclass Foo&#123; public int test()&#123; return 5; &#125; public double test1()&#123; return 5d; &#125;&#125;åŠ¨æ€èŽ·å–Fooç±»çš„æ–¹æ³•ï¼š1234567891011121314151617181920@Testpublic void testClassForName()&#123; /* * åŠ¨æ€çš„åŠ è½½ç±»ä¿¡æ¯åˆ°æ–¹æ³•åŒº * å¹¶ä¸”è¿”å›žå¯¹åº”çš„Classå¯¹è±¡ï¼ * Class å¯¹è±¡å¯ä»¥è®¿é—®ç±»çš„å…¨éƒ¨ä¿¡æ¯ï¼ * * å°†classNameå¯¹åº”çš„ç±»æ–‡ä»¶ï¼Œä»Žç£ç›˜ä¸­åŠ è½½ * å†…å­˜æ–¹æ³•åŒºï¼Œè¿”å›žè¿™ä¸ªç±»çš„ä¿¡æ¯ */ String className = "demo.Foo"; try &#123; Class cls = Class.forName(className); Method[] all = cls.getDeclaredMethods(); for (Method method : all) &#123; System.out.println(method.getName()); &#125; &#125; catch (ClassNotFoundException e) &#123; e.printStackTrace();&#125;è¾“å‡ºï¼š12testtest1 â€‹åŠ¨æ€èŽ·å–ç±»çš„å±žæ€§ä¿¡æ¯Eooç±»ï¼š1234567891011121314151617class Eoo&#123; int id; String name; double salary; String meno; public Eoo()&#123; &#125; public Eoo(int id, String name, double salary, String meno) &#123; super(); this.id = id; this.name = name; this.salary = salary; this.meno = meno; &#125; // getï¼Œsetç•¥&#125;åŠ¨æ€èŽ·å–Eooç±»çš„å±žæ€§ï¼š1234567891011121314151617@Testpublic void testField()throws Exception &#123; /* * åŠ¨æ€èŽ·å–ä¸€ä¸ªç±»çš„å…¨éƒ¨å±žæ€§ä¿¡æ¯ * 1 åŠ¨æ€åŠ è½½ä¸€ä¸ªç±»åˆ°æ–¹æ³•åŒº * 2 åŠ¨æ€èŽ·å–ç±»çš„å±žæ€§ä¿¡æ¯ */ String className = "demo.Eoo"; //åŠ¨æ€åŠ è½½ç±» Class cls = Class.forName(className); //åŠ¨æ€èŽ·å–ç±»å£°æ˜Žçš„å±žæ€§ä¿¡æ¯ Field[] all = cls.getDeclaredFields(); for (Field field : all) &#123; //getName èŽ·å–å±žæ€§çš„åå­— System.out.print(field.getName()+" "); &#125;&#125;è¾“å‡ºï¼š1id name salary menoåŠ¨æ€èŽ·å–ç±»çš„æž„é€ å™¨ä¿¡æ¯123456789101112131415161718@Testpublic void testCon() throws Exception&#123; /* * 1 åŠ¨æ€åŠ è½½ç±» */ String className = "demo.Eoo"; Class cls = Class.forName(className); Constructor[] all = cls.getDeclaredConstructors(); for (Constructor c : all) &#123; System.out.print(c.getName()); //èŽ·å–æž„é€ å™¨çš„å‚æ•°ç±»åž‹åˆ—è¡¨ // Parameter å‚æ•° Typeç±»åž‹ // Class[] ä»£è¡¨æ‰€æœ‰å‚æ•°çš„ç±»åž‹åˆ—è¡¨ Class[] types = c.getParameterTypes(); System.out.println(Arrays.toString(types)); &#125;&#125;è¾“å‡ºï¼š12demo.Eoo[]demo.Eoo[int, class java.lang.String, double, class java.lang.String] â€‹åŠ¨æ€åˆ›å»ºå¯¹è±¡è°ƒç”¨æ— å‚æž„é€ å™¨åˆ›å»ºå¯¹è±¡å¦‚æžœæ²¡æœ‰æ— å‚æ•°æž„é€ å™¨ï¼Œå°†å‘ç”Ÿå¼‚å¸¸ï¼Class æä¾›äº†æ–¹æ³• newInstance()ã€‚123456789101112131415161718@Testpublic void testNewInstance() throws Exception&#123; /* * åŠ¨æ€è°ƒç”¨æ— å‚æ•°æž„é€ å™¨åˆ›å»ºå¯¹è±¡ * 1 åŠ¨æ€åŠ è½½ç±» * 2 åˆ©ç”¨class çš„æ–¹æ³• newInstance æ‰§è¡Œ * æ— å‚æ•°æž„é€ å™¨å¸¸è§å¯¹è±¡ * æ³¨æ„ï¼šç±»å¿…é¡»æœ‰æ— å‚æ•°ï¼Œå¦åˆ™å‡ºå¼‚å¸¸ */ String className = "java.util.Date"; Class cls = Class.forName(className); // cls.newInstance()è°ƒç”¨æ— å‚æ•°æž„é€ å™¨åˆ›å»ºå¯¹è±¡ Object obj = cls.newInstance(); System.out.println(obj); //é™æ€çš„åˆ›å»ºå¯¹è±¡ï¼ç¼–è¯‘å·²ç»å°±å›ºå®šäº†ï¼ Date date = new Date();&#125;è¾“å‡ºï¼š1Fri Sep 16 20:04:55 CST 2016è°ƒç”¨æœ‰å‚æž„é€ å™¨åˆ›å»ºå¯¹è±¡å¦‚æžœæ²¡æœ‰å¯¹åº”æœ‰å‚æ•°æž„é€ å™¨ï¼å°†å‘ç”Ÿå¼‚å¸¸ï¼å‚æ•°ä¼ é€’é”™è¯¯ã€å°†å‘ç”Ÿå¼‚å¸¸ï¼123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * è°ƒç”¨ className ç±»åå¯¹åº”çš„ç±»çš„æœ‰å‚æ•°æž„é€ å™¨ï¼ŒparamTypes ä»£è¡¨å¯¹åº”æž„é€ å™¨çš„å‚æ•°åˆ—è¡¨ * className + paramTypes å…±åŒå†³å®šè°ƒç”¨å“ªä¸ªæž„é€ å™¨ï¼æ‰§è¡Œæž„é€ å™¨è¿˜éœ€è¦å…·ä½“çš„å‚æ•°params */public Object create(String className,Class[] paramTypes,Object[] params) throws Exception&#123; // åŠ¨æ€åŠ è½½ç±» // åŠ¨æ€èŽ·å–æŒ‡å®šå‚æ•°ç±»åž‹çš„æž„é€ å™¨ // æ‰§è¡Œè¿™ä¸ªæž„é€ å™¨ï¼Œä¼ é€’ params å‚æ•°ã€‚ Class cls = Class.forName(className); //getDeclaredConstructor åœ¨ç±»ä¿¡æ¯ä¸­æŸ¥æ‰¾ //ç»™å®šå‚æ•°ç±»åž‹çš„æž„é€ å™¨ä¿¡æ¯ Constructor c = cls.getDeclaredConstructor(paramTypes); //æ‰§è¡Œæž„é€ å™¨ c.newInstance() æ–¹æ³•ï¼Œåˆ›å»ºå¯¹è±¡ //è¿”å›žå€¼å°±æ˜¯è¿™ä¸ªæž„é€ å™¨åˆ›å»ºçš„å¯¹è±¡ Object obj = c.newInstance(params); return obj;&#125;@Testpublic void testCreate() throws Exception &#123; String className = "java.util.Date"; //ç±»åž‹åˆ—è¡¨==Classç±»åž‹çš„æ•°ç»„ Class[] paramTypes = &#123;long.class&#125;; //å®žé™…å‚æ•°åˆ—è¡¨ Object[] params=&#123;-1000L*60*60*24*365&#125;; Object obj = create(className, paramTypes, params); System.out.println(obj); //æ€è€ƒï¼šå¦‚ä½•åŠ¨æ€è°ƒç”¨ new String("Hello"); className = "java.lang.String"; /* * &#123;&#125; åªèƒ½æ‹¥æœ‰å£°æ˜Žå˜é‡æ—¶å€™ç›´æŽ¥åˆå§‹åŒ– * ä¸èƒ½ç”¨äºŽèµ‹å€¼è¯­å¥ï¼ * èµ‹å€¼è¯­å¥å¯ä»¥ä½¿ç”¨ new Object[]&#123;"Hello"&#125; */ paramTypes = new Class[]&#123;String.class&#125;; params = new Object[]&#123;"Hello"&#125;; obj = create(className, paramTypes, params); System.out.println(obj);//Hello //æ€è€ƒï¼šå¦‚ä½•åŠ¨æ€è°ƒç”¨ new String(byte[],"utf-8"); obj = create("java.lang.String", new Class[]&#123;byte[].class, String.class&#125;, new Object[]&#123;new byte[]&#123;65,66,67,68&#125;, "UTF-8"&#125;); System.out.println(obj);&#125;è¾“å‡ºï¼š123Wed Jan 01 08:00:00 CST 1969HelloABCD â€‹åŠ¨æ€èŽ·å–ç±»çš„å±žæ€§å€¼å®žçŽ°è¿‡ç¨‹ï¼ˆå¦‚ä½•åˆ©ç”¨åå°„APIå®žçŽ°åŠ¨æ€å±žæ€§è®¿é—®ï¼‰ï¼š1.æ‰¾åˆ°å¯¹è±¡çš„ç±»åž‹ä¿¡æ¯ï¼ˆæ–¹æ³•åŒºï¼‰2.åœ¨ä¿¡æ¯ä¸­æ‰¾å±žæ€§ä¿¡æ¯ï¼ˆFieldï¼‰3.åœ¨å¯¹è±¡ä¸ŠèŽ·å–å±žæ€§çš„å€¼ï¼ç±»Gooï¼š123456789101112public class Goo &#123; public int id; public String name; public Goo() &#123; &#125; public Goo(int id, String name) &#123; super(); this.id = id; this.name = name; &#125;&#125;åŠ¨æ€èŽ·å–å±žæ€§çš„å€¼ï¼š12345678910111213141516171819202122232425262728293031323334353637383940 /** * èŽ·å–objå¯¹è±¡çš„ fieldName å¯¹åº”å±žæ€§çš„å€¼ * @param obj * @param fieldName * @return å±žæ€§å€¼ */public Object get(Object obj, String fieldName)throws Exception&#123; //1 èŽ·å–ç±»ä¿¡æ¯ /* * Java ä¸­å¯¹è±¡çš„getClass()æ–¹æ³•å¯ä»¥èŽ·å– å¯¹è±¡çš„ç±»åž‹ä¿¡æ¯ï¼ * Java ä¸­ æœ‰3ç§æ–¹æ³•å¯ä»¥èŽ·å–Classä¿¡æ¯ * 1. ç±»å.class èŽ·å–ç±»ä¿¡æ¯(é™æ€) * 2. Class.forName("ç±»å") èŽ·å–ç±»ä¿¡æ¯ åŠ¨æ€ * 3. obj.getClass() èŽ·å–ç±»ä¿¡æ¯ã€‚è¿è¡ŒæœŸé—´ï¼Œé€šè¿‡å½“å‰å¯¹è±¡èŽ·å–ç±»ä¿¡æ¯ */ Class cls = obj.getClass(); //æ‰¾åˆ°å±žæ€§: /* * getDeclaredField æŒ‰ç…§å±žæ€§ååœ¨clsä¸­æŸ¥æ‰¾ * ç±»ä¿¡æ¯ã€‚ å½“å±žæ€§æ²¡æœ‰æ‰¾åˆ°æ—¶å€™ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼ */ Field field = cls.getDeclaredField(fieldName); //åœ¨å¯¹è±¡ä¸ŠèŽ·å–å±žæ€§çš„å€¼ï¼ /* * getæ–¹æ³•ï¼šåœ¨ä¸€ä¸ªå¯¹è±¡ä¸ŠèŽ·å–å±žæ€§çš„å€¼ï¼Œå¯¹è±¡ä¸Šæ²¡æœ‰å¯¹åº”çš„å±žæ€§ï¼ŒæŠ›å‡ºå¼‚å¸¸ */ Object value = field.get(obj); return value;&#125; @Testpublic void testGetField()throws Exception &#123; /* * åŠ¨æ€èŽ·å–å¯¹è±¡çš„å±žæ€§ */ Goo goo = new Goo(5, "Tom"); Object v1 = get(goo, "id"); Object v2 = get(goo, "name"); System.out.println(v1+" "+v2);&#125;è¾“å‡ºï¼š15 TomåŠ¨æ€è°ƒç”¨ç±»çš„æ–¹æ³•12345678910111213@Testpublic void testinvoke()throws Exception&#123; List&lt;String&gt; list=new ArrayList&lt;String&gt;(); list.add("tom"); list.add("jack"); // åŠ¨æ€èŽ·å–ç±»ä¿¡æ¯ Class cls = list.getClass(); // é€šè¿‡æ–¹æ³•åå’Œå‚æ•°ç±»åž‹æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³• Method method = cls.getDeclaredMethod("remove", new Class[]&#123;int.class&#125;); // è°ƒç”¨æ–¹æ³•ï¼Œä¼ é€’å¯¹è±¡å’Œå…·ä½“å‚æ•° Object value=method.invoke(list,new Object[]&#123;0&#125;); System.out.println(value); //tom&#125;åå°„çš„æ„ä¹‰å¸¸è§çš„æ¡†æž¶çš„åº•å±‚éƒ½æ˜¯ä½¿ç”¨åå°„å®žçŽ°çš„ï¼å¦‚ï¼šSpring MyBatis Struts2 Hibernate â€¦çŽ°æœ‰application.xmlæ–‡ä»¶ï¼š12345&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans&gt; &lt;bean id="date" class="java.util.Date"&gt;&lt;/bean&gt; &lt;bean id="list" class="java.util.ArrayList"&gt;&lt;/bean&gt;&lt;/beans&gt;æ¨¡æ‹ŸSpringæ¡†æž¶çš„getBean()æ–¹æ³•ï¼š123456789101112131415161718192021222324252627282930313233343536public class ApplicationContext &#123; private HashMap&lt;String, Object&gt; map= new HashMap&lt;String, Object&gt;(); public ApplicationContext(String xml) &#123; SAXReader reader = new SAXReader(); try&#123; //è¯»å–xml InputStream in = this.getClass().getClassLoader().getResourceAsStream(xml); Document doc = reader.read(in); //è§£æžXMLå†…å®¹ èŽ·å–å…¨éƒ¨çš„&lt;bean&gt; List&lt;Element&gt; beans = doc.getRootElement().elements(); for (Element e : beans) &#123; //e æ˜¯æ¯ä¸ª &lt;bean&gt; å…ƒç´  String id = e.attributeValue("id"); String className = e.attributeValue("class"); //åˆ©ç”¨åå°„åˆ›å»ºå¯¹è±¡ Class cls = Class.forName(className); Object obj = cls.newInstance(); //å¯¹è±¡ç¼“å­˜åˆ° mapä¸­ map.put(id, obj); &#125; &#125;catch(Exception e)&#123; e.printStackTrace(); throw new RuntimeException(e); &#125; &#125; public Object getBean(String id)&#123; return map.get(id); &#125; public static void main(String[] args) &#123; String conf = "application.xml"; ApplicationContext ac = new ApplicationContext(conf); Object o = ac.getBean("date"); System.out.println(o); //Fri Sep 16 21:30:07 CST 2016 &#125;&#125;]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracle SQLå¸¸ç”¨å‡½æ•°]]></title>
    <url>%2FOracle-SQL%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0.html</url>
    <content type="text"><![CDATA[æ–‡ä¸­ä¾‹å­æ¶‰åŠåˆ°çš„è¡¨æ•°æ®ï¼š1234567891011121314151617181920SQL&gt; select empno,ename,job, hiredate,sal,deptno,comm from lzp.emp; EMPNO ENAME JOB HIREDATE SAL DEPTNO COMM---------- ---------- --------- -------------- ------- ---------- ---------- 7369 SMITH CLERK 17-12æœˆ-80 800 20 null 7499 ALLEN SALESMAN 20-2æœˆ -81 3100 30 300 7521 WARD SALESMAN 22-2æœˆ -81 1250 30 500 7566 JONES MANAGER 02-4æœˆ -81 2975 20 null 7654 MARTIN SALESMAN 28-9æœˆ -81 8000 30 1400 7698 BLAKE MANAGER 01-5æœˆ -81 2850 30 null 7782 CLARK MANAGER 09-6æœˆ -81 2450 10 null 7788 SCOTT ANALYST 19-4æœˆ -87 3000 20 null 7839 KING PRESIDENT 17-11æœˆ-81 5000 10 null 7844 TURNER SALESMAN 08-9æœˆ -81 1500 30 0 7876 ADAMS CLERK 23-5æœˆ -87 1100 20 null 7900 JAMES CLERK 03-12æœˆ-81 950 30 null 7902 FORD ANALYST 03-12æœˆ-81 3000 20 null 7934 MILLER CLERK 23-1æœˆ -82 1300 10 null å·²é€‰æ‹©14è¡Œã€‚å­—ç¬¦å‡½æ•°å­—ç¬¦ä¸²æˆªå–12345SQL&gt; select substr('mrbird',3,6) from dual; SUBS----birdæŸ¥æ‰¾å­ä¸²ä½ç½®12345SQL&gt; select instr('mrBird','Bird') from dual; INSTR('MRBIRD','BIRD')---------------------- 3å­—ç¬¦ä¸²è¿žæŽ¥123456789101112/* 1. || */SQL&gt; select 'mr'||'Bird'as result from dual; RESULT------mrBird/* 2.concat */SQL&gt; select concat('mr','Bird') as result from dual; RESULT------mrBirdåŽ»é™¤ç©ºæ ¼1234567891011SQL &gt; SELECT LTRIM (' mrBird') l, RTRIM ('mrBird ') r, TRIM (' mrBird ') TFROM dual; L R T------ ------ ------mrBird mrBird mrBirdåŽ»é™¤å‰ç¼€å’ŒåŽç¼€1234567891011SQL &gt; SELECT TRIM (LEADING 'M' FROM 'MMMMMmrBird') s1, TRIM (TRAILING 'D' FROM 'mrBirdDDDD') s2, TRIM ('M' FROM 'MMMmrBirdMMMM') s3FROM dual; S1 S2 S3------ ------ ------mrBird mrBird mrBirdè®¡ç®—å­—ç¬¦ä¸²é•¿åº¦12345SQL&gt; select length('mrbird') from dual; LENGTH('MRBIRD')---------------- 6initcapï¼ˆé¦–å­—æ¯å˜å¤§å†™ï¼‰ ,lowerï¼ˆå˜å°å†™ï¼‰,upperï¼ˆå˜å¤§å†™ï¼‰12345SQL&gt; select initcap('mrbird') s1,lower('MRBIRD') s2,upper('mrbird') s3 from dual; S1 S2 S3------ ------ ------Mrbird mrbird MRBIRDæ›¿æ¢12345SQL&gt; select replace('mrXiaoniao','Xiaoniao','Bird') from dual; REPLAC------mrBirddecode[å®žçŽ°if ..then é€»è¾‘] æ³¨:ç¬¬ä¸€ä¸ªæ˜¯è¡¨è¾¾å¼,æœ€åŽä¸€ä¸ªæ˜¯ä¸æ»¡è¶³ä»»ä½•ä¸€ä¸ªæ¡ä»¶çš„å€¼123456789101112131415161718192021222324SQL&gt; SELECT DECODE ( deptno, 10, 'äººåŠ›èµ„æºéƒ¨', 20, 'è½¯ä»¶å¼€å‘éƒ¨', 30, 'å¸‚åœºéƒ¨', 'å…¶ä»–ç¥žç§˜éƒ¨é—¨' ) deptName, deptno, enameFROM lzp.empWHERE empno &gt;= 7900; DEPTNAME DEPTNO ENAME------------ ---------- ----------å¸‚åœºéƒ¨ 30 JAMESè½¯ä»¶å¼€å‘éƒ¨ 20 FORDäººåŠ›èµ„æºéƒ¨ 10 MILLERcase[å®žçŽ°switch ..case é€»è¾‘]12345678910111213141516171819202122232425262728293031SQL&gt; SELECT CASEWHEN sal &lt; 2000 THEN 'è¢«å‰¥å‰Šçš„äºº'WHEN sal &lt; 3000 THEN 'è¢«åŽ‹æ¦¨çš„äºº'WHEN sal &lt; 5000 THEN 'æ™®é€šçš„äºº'ELSE 'åŠªåŠ›çš„äºº'END meno, sal, enameFROM lzp.empWHERE deptno = 30ORDER BY sal ASC; MENO SAL ENAME---------- ---------- ----------è¢«å‰¥å‰Šçš„äºº 950 JAMESè¢«å‰¥å‰Šçš„äºº 1250 WARDè¢«å‰¥å‰Šçš„äºº 1500 TURNERè¢«åŽ‹æ¦¨çš„äºº 2850 BLAKEæ™®é€šçš„äºº 3100 ALLENåŠªåŠ›çš„äºº 8000 MARTIN å·²é€‰æ‹©6è¡Œã€‚åè¿›åˆ¶å’ŒASCIIäº’ç›¸è½¬æ¢12345SQL&gt; select ascii('A'),chr(65) from dual; ASCII('A') C---------- - 65 Aæ—¥æœŸå‡½æ•°TO_DATEæ ¼å¼(ä»¥æ—¶é—´: 2007-11-02 13:45:25 ä¸ºä¾‹)Yearyy &nbsp; &nbsp;two digitsä¸¤ä½å¹´æ˜¾ç¤ºå€¼:07yyythree digitsä¸‰ä½å¹´æ˜¾ç¤ºå€¼:007yyyyfour digitså››ä½å¹´æ˜¾ç¤ºå€¼:2007Monthmm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;number&nbsp;ä¸¤ä½æœˆ&nbsp;æ˜¾ç¤ºå€¼:11mon&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;abbreviatedå­—ç¬¦é›†è¡¨ç¤ºæ˜¾ç¤ºå€¼:11æœˆ,è‹¥æ˜¯è‹±æ–‡ç‰ˆ,æ˜¾ç¤ºnov&nbsp;monthspelled outå­—ç¬¦é›†è¡¨ç¤ºæ˜¾ç¤ºå€¼:11æœˆ,è‹¥æ˜¯è‹±æ–‡ç‰ˆ,æ˜¾ç¤ºnovemberDaydd &nbsp; &nbsp; &nbsp;&nbsp;numberå½“æœˆç¬¬å‡ å¤©æ˜¾ç¤ºå€¼:02ddd&nbsp;&nbsp;numberå½“å¹´ç¬¬å‡ å¤©æ˜¾ç¤ºå€¼:306dy &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;abbreviated &nbsp; &nbsp;å½“å‘¨ç¬¬å‡ å¤©ç®€å†™&nbsp;æ˜¾ç¤ºå€¼:æ˜ŸæœŸäº”,è‹¥æ˜¯è‹±æ–‡ç‰ˆ,æ˜¾ç¤ºfridayspelled outå½“å‘¨ç¬¬å‡ å¤©å…¨å†™æ˜¾ç¤ºå€¼:æ˜ŸæœŸäº”,è‹¥æ˜¯è‹±æ–‡ç‰ˆ,æ˜¾ç¤ºfridayddspthspelled outå½“æœˆç¬¬å‡ å¤©è‹±æ–‡æ˜¾ç¤ºå€¼:secondHourhh &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;two digits12å°æ—¶è¿›åˆ¶&nbsp;æ˜¾ç¤ºå€¼:01hh24two digits24å°æ—¶è¿›åˆ¶æ˜¾ç¤ºå€¼:13Minute &nbsp;&nbsp;mi/mm &nbsp; &nbsp;&nbsp;two digits60è¿›åˆ¶æ˜¾ç¤ºå€¼:45Secondss &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;two digits60è¿›åˆ¶æ˜¾ç¤ºå€¼:25OthersQ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;digitå­£åº¦æ˜¾ç¤ºå€¼:4WWdigitå½“å¹´ç¬¬å‡ å‘¨&nbsp;æ˜¾ç¤ºå€¼:44Wdigitå½“æœˆç¬¬å‡ å‘¨æ˜¾ç¤ºå€¼:124å°æ—¶æ ¼å¼ä¸‹æ—¶é—´èŒƒå›´ä¸ºï¼š 0:00:00 - 23:59:59â€¦.12å°æ—¶æ ¼å¼ä¸‹æ—¶é—´èŒƒå›´ä¸ºï¼š 1:00:00 - 12:59:59 â€¦.æ—¥æœŸå­—ç¬¦ä¸²ç›¸äº’è½¬æ¢æ—¶é—´è½¬å­—ç¬¦ä¸²:Yearï¼š1234567891011SQL&gt; SELECT TO_CHAR (SYSDATE, 'yy') yy, TO_CHAR (SYSDATE, 'yyy') yyy, TO_CHAR (SYSDATE, 'yyyy') yyyyFROM dual; YY YYY YYYY-- --- ----16 016 2016Monthï¼š1234567891011SQL&gt;SELECT TO_CHAR (SYSDATE, 'mm') mm, TO_CHAR (SYSDATE, 'mon') mon, TO_CHAR (SYSDATE, 'month') monthFROM dual; MM MON MONTH-- -------- ------09 9æœˆ 9æœˆDayï¼š12345678910111213SQL&gt;SELECT TO_CHAR (SYSDATE, 'dd') dd, TO_CHAR (SYSDATE, 'ddd') ddd, TO_CHAR (SYSDATE, 'dy') dy, TO_CHAR (SYSDATE, 'day') DAY, TO_CHAR (SYSDATE, 'ddspth') ddspthFROM dual; DD DDD DY DAY DDSPTH-- --- ------------ --------- --------------06 250 tue tuesday sixthHourï¼š12345678910SQL&gt;SELECT TO_CHAR (SYSDATE, 'hh') hh, TO_CHAR (SYSDATE, 'hh24') hh24FROM dual; HH HH24-- --05 17Minute,Secondç•¥å­£åº¦ï¼Œå‘¨ï¼š1234567891011SQL&gt;SELECT TO_CHAR (SYSDATE, 'Q') Q, TO_CHAR (SYSDATE, 'WW') WW, TO_CHAR (SYSDATE, 'W') WFROM dual; Q WW W- -- -3 36 1å­—ç¬¦ä¸²è½¬æ—¶é—´ï¼š12345SQL&gt; select to_date('2016-09-06','yyyy-MM-dd') time from dual; TIME--------------06-9æœˆ -16next_dayè¿”å›žä¸‹ä¸ªæ˜ŸæœŸçš„æ—¥æœŸ,dayä¸º1-7æˆ–æ˜ŸæœŸæ—¥-æ˜ŸæœŸå…­,1è¡¨ç¤ºæ˜ŸæœŸæ—¥ï¼Œä¹Ÿå¯ä»¥ç”¨è‹±æ–‡è¡¨ç¤ºæ˜ŸæœŸã€‚12345SQL&gt; select next_day(sysdate,'monday') time from dual; TIME--------------12-9æœˆ -16ä¸¤ä¸ªæ—¥æœŸç›¸å·®å¤©æ•°12345SQL&gt; select floor(sysdate - to_date('20020405','yyyymmdd')) time from dual; TIME---------- 5268months_between123456789101112SQL&gt; SELECT MONTHS_BETWEEN ( TO_DATE ('2016-09-01', 'yyyy-MM-dd'), TO_DATE ('2016-01-01', 'yyyy-MM-dd') ) monthsFROM dual; MONTHS---------- 8round [èˆå…¥åˆ°æœ€æŽ¥è¿‘çš„æ—¥æœŸ]ï¼ˆday:èˆå…¥åˆ°æœ€æŽ¥è¿‘çš„æ˜ŸæœŸæ—¥ï¼‰12345678910111213SQL&gt; SELECT SYSDATE S1, ROUND (SYSDATE) S2, ROUND (SYSDATE, 'year') YEAR, ROUND (SYSDATE, 'month') MONTH, ROUND (SYSDATE, 'day') DAYFROM dual; S1 S2 YEAR MONTH DAY-------------- -------------- -------------- -------------- --------------07-9æœˆ -16 07-9æœˆ -16 01-1æœˆ -17 01-9æœˆ -16 04-9æœˆ -16è®¡ç®—æ—¶é—´å·®æ³¨:oracleæ—¶é—´å·®æ˜¯ä»¥å¤©æ•°ä¸ºå•ä½,æ‰€ä»¥æ¢ç®—æˆå¹´æœˆ,æ—¥123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566SQL&gt;SELECT FLOOR ( TO_NUMBER ( SYSDATE - TO_DATE ( '2007-11-02 15:55:03', 'yyyy-mm-dd hh24:mi:ss' ) ) / 365 ) AS spanYearsFROM dual; SPANYEARS---------- 8SQL&gt;SELECT CEIL ( MONTHS_BETWEEN ( SYSDATE, TO_DATE ( '2007-11-02 15:55:03', 'yyyy-mm-dd hh24:mi:ss' ) ) ) AS spanMonthsFROM dual; SPANMONTHS---------- 107SQL&gt;SELECT FLOOR ( TO_NUMBER ( SYSDATE - TO_DATE ( '2007-11-02 15:55:03', 'yyyy-mm-dd hh24:mi:ss' ) ) ) AS spanDaysFROM dual; SPANDAYS---------- 3231SQL&gt;SELECT FLOOR ( TO_NUMBER ( SYSDATE - TO_DATE ( '2007-11-02 15:55:03', 'yyyy-mm-dd hh24:mi:ss' ) ) * 24 ) AS spanHoursFROM dual; SPANHOURS---------- 77562/* åˆ†ç§’ç•¥ï¼Œä»¥æ­¤ç±»æŽ¨ */æŸ¥æ‰¾æœˆçš„æœ€åŽä¸€å¤©12345SQL&gt; select last_day(sysdate) from dual; LAST_DAY(SYSDA--------------30-9æœˆ -16ADD_MONTHS(dateï¼Œi)å¯¹ç»™å®šçš„æ—¥æœŸåŠ ä¸Šç»™å®šçš„æœˆï¼ŒæŸ¥çœ‹æ¯ä¸ªå‘˜å·¥å…¥èŒ20å‘¨å¹´1234567891011121314151617181920SQL&gt; select ename,add_months(hiredate,12*20) from lzp.emp; ENAME ADD_MONTHS(HIR---------- --------------SMITH 17-12æœˆ-00ALLEN 20-2æœˆ -01WARD 22-2æœˆ -01JONES 02-4æœˆ -01MARTIN 28-9æœˆ -01BLAKE 01-5æœˆ -01CLARK 09-6æœˆ -01SCOTT 19-4æœˆ -07KING 17-11æœˆ-01TURNER 08-9æœˆ -01ADAMS 23-5æœˆ -07JAMES 03-12æœˆ-01FORD 03-12æœˆ-01MILLER 23-1æœˆ -02å·²é€‰æ‹©14è¡Œã€‚EXTRACTå•ç‹¬èŽ·å–æŒ‡å®šæ—¶é—´çš„å¹´æˆ–æœˆæˆ–æ—¥12345SQL&gt; select extract(year from sysdate) from dual; EXTRACT(YEARFROMSYSDATE)------------------------ 2016æ•°å­—å‡½æ•°å–æ•´å‡½æ•°ï¼ˆceil å‘ä¸Šå–æ•´,floor å‘ä¸‹å–æ•´ï¼‰12345SQL&gt; select ceil(66.6) N1,floor(66.6) N2 from dual; N1 N2---------- ---------- 67 66å–å¹‚(power) å’Œ æ±‚å¹³æ–¹æ ¹(sqrt)12345SQL&gt; select power(3,2) N1,sqrt(9) N2 from dual; N1 N2---------- ---------- 9 3æ±‚ä½™12345SQL&gt; select mod(9,5) from dual; MOD(9,5)---------- 4è¿”å›žå›ºå®šå°æ•°ä½æ•° ï¼ˆround:å››èˆäº”å…¥ï¼Œtrunc:ç›´æŽ¥æˆªæ–­ï¼‰12345SQL&gt; select round(66.667,2) N1,trunc(66.667,2) N2 from dual; N1 N2---------- ---------- 66.67 66.66è¿”å›žå€¼çš„ç¬¦å·ï¼ˆæ­£æ•°è¿”å›žä¸º1,è´Ÿæ•°ä¸º-1ï¼‰12345SQL&gt; select sign(-32),sign(293) from dual; SIGN(-32) SIGN(293)---------- ---------- -1 1LEASTã€GREATESTä¸¤ä¸ªå‡½æ•°éƒ½å¯ä»¥æœ‰å¤šä¸ªå‚æ•°å€¼ï¼Œä½†å‚æ•°ç±»åž‹å¿…é¡»ä¸€è‡´ï¼Œè¿”å›žç»“æžœæ˜¯å‚æ•°åˆ—è¡¨ä¸­æœ€å¤§æˆ–æœ€å°çš„å€¼ã€‚ åœ¨æ¯”è¾ƒä¹‹å‰ï¼Œåœ¨å‚æ•°åˆ—è¡¨ä¸­ç¬¬äºŒä¸ªä»¥åŽçš„å‚æ•°ä¼šè¢«éšå«çš„è½¬æ¢ä¸ºç¬¬ä¸€ä¸ªå‚æ•°çš„æ•°æ®ç±»åž‹ï¼Œæ‰€ä»¥å¦‚æžœå¯ä»¥è½¬æ¢ï¼Œåˆ™ç»§ç»­æ¯”è¾ƒï¼Œå¦‚æžœä¸èƒ½è½¬æ¢å°†ä¼šæŠ¥é”™ã€‚12345SQL&gt; select least(1,2,3),greatest(sysdate,'01-10æœˆ-16') from dual; LEAST(1,2,3) GREATEST(SYSDA------------ -------------- 1 01-10æœˆ-16å…¶ä»–å‡½æ•°vsize: è¿”å›žè¡¨è¾¾å¼æ‰€éœ€çš„å­—èŠ‚æ•°12345SQL&gt; select vsize('mrBird123') from dual; VSIZE('MRBIRD123')------------------ 9nvl(ex1,ex2):ex1å€¼ä¸ºç©ºåˆ™è¿”å›žex2,å¦åˆ™è¿”å›žè¯¥å€¼æœ¬èº«ex1ï¼ˆå¸¸ç”¨ï¼‰ ä¾‹ï¼šå¦‚æžœé›‡å‘˜æ²¡æœ‰ä½£é‡‘ï¼Œå°†æ˜¾ç¤º0ï¼Œå¦åˆ™æ˜¾ç¤ºä½£é‡‘1234567891011121314151617181920SQL&gt; select comm,nvl(comm,0) from lzp.emp; COMM NVL(COMM,0)---------- ----------- 0 300 300 500 500 0 1400 1400 0 0 0 0 0 0 0 0 0 0 å·²é€‰æ‹©14è¡Œã€‚nullif(ex1,ex2):1234567891011121314SQL&gt; select nullif(88,88) from dual; NULLIF(88,88)------------- SQL&gt; select nullif(88,123) from dual; NULLIF(88,123)-------------- 88SQL&gt; select nullif('mrBird','mrBird') from dual; NULLIF------nvl2(ex1,ex2,ex3) :å¦‚æžœex1ä¸ä¸ºç©ºï¼Œæ˜¾ç¤ºex2,å¦åˆ™æ˜¾ç¤ºex3æ³¨ï¼šéƒ¨åˆ†å†…å®¹æ¥è‡ªè„šæœ¬ä¹‹å®¶]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java Encryption - Decryption]]></title>
    <url>%2FJava-Encryption-Decryption.html</url>
    <content type="text"><![CDATA[å¼€å‘ä¸­ï¼Œç»å¸¸è¦å¯¹ä¸€äº›æ•æ„Ÿå†…å®¹è¿›è¡ŒåŠ å¯†ï¼Œè¿™æ—¶å€™å¯ä»¥ç”¨åˆ°javax.crypto.Cipherç±»æä¾›åŠ å¯†å’Œè§£å¯†åŠŸèƒ½ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144public class EncryptionDecryption &#123; //è®¾ç½®é»˜è®¤å¯†åŒ™ private static String strDefaultKey = "defaultKey"; //åŠ å¯† private Cipher encryptCipher = null; //è§£å¯† private Cipher decryptCipher = null; /** * å°†byteæ•°ç»„è½¬æ¢ä¸ºè¡¨ç¤º16è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²ï¼Œ å¦‚ï¼šbyte[]&#123;8,18&#125;è½¬æ¢ä¸ºï¼š0813å’Œ * public static byte[]hexStr2ByteArr(String strIn) äº’ä¸ºå¯é€†çš„è½¬æ¢è¿‡ç¨‹ * @param arrB éœ€è¦è½¬æ¢çš„byteæ•°ç»„ * @return è½¬æ¢åŽçš„å­—ç¬¦ä¸² * @throws Exception */ public static String byteArr2HexStr(byte[] arrB) throws Exception &#123; int iLen = arrB.length; // æ¯ä¸ªbyteç”¨ä¸¤ä¸ªå­—ç¬¦æ‰èƒ½è¡¨ç¤ºï¼Œæ‰€ä»¥å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯æ•°ç»„é•¿åº¦çš„ä¸¤å€ StringBuffer sb = new StringBuffer(iLen * 2); for (int i = 0; i &lt; iLen; i++) &#123; int intTmp = arrB[i]; // æŠŠè´Ÿæ•°è½¬æ¢ä¸ºæ­£æ•° while (intTmp &lt; 0) &#123; intTmp = intTmp + 256; &#125; // å°äºŽ0Fçš„æ•°éœ€è¦åœ¨å‰é¢è¡¥0 if (intTmp &lt; 16) &#123; sb.append("0"); &#125; sb.append(Integer.toString(intTmp, 16)); &#125; return sb.toString(); &#125; /** * å°†è¡¨ç¤º16è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºbyteæ•°ç»„å’Œpublic static String * byteArr2HexStr(byte[] arrB)äº’ä¸ºå¯é€†çš„è½¬æ¢è¿‡ç¨‹ * @param strIn éœ€è¦è½¬æ¢çš„å­—ç¬¦ä¸² * @return è½¬æ¢åŽçš„byteæ•°ç»„ * @throws Exception */ public static byte[] hexStr2ByteArr(String strIn) throws Exception &#123; byte[] arrB = strIn.getBytes(); int iLen = arrB.length; // ä¸¤ä¸ªå­—ç¬¦è¡¨ç¤ºä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å­—èŠ‚æ•°ç»„é•¿åº¦æ˜¯å­—ç¬¦ä¸²é•¿åº¦é™¤ä»¥2 byte[] arrOut = new byte[iLen / 2]; for (int i = 0; i &lt; iLen; i = i + 2) &#123; String strTmp = new String(arrB, i, 2); arrOut[i / 2] = (byte) Integer.parseInt(strTmp, 16); &#125; return arrOut; &#125; /** * é»˜è®¤æž„é€ æ–¹æ³•ï¼Œä½¿ç”¨é»˜è®¤å¯†é’¥ * @throws Exception */ public EncryptionDecryption() throws Exception &#123; this(strDefaultKey); &#125; /** * æŒ‡å®šå¯†é’¥æž„é€ æ–¹æ³• * @param strKey æŒ‡å®šçš„å¯†é’¥ * @throws Exception */ public EncryptionDecryption(String strKey) throws Exception &#123; Security.addProvider(new com.sun.crypto.provider.SunJCE()); Key key = getKey(strKey.getBytes()); encryptCipher = Cipher.getInstance("DES"); encryptCipher.init(Cipher.ENCRYPT_MODE, key); decryptCipher = Cipher.getInstance("DES"); decryptCipher.init(Cipher.DECRYPT_MODE, key); &#125; /** * åŠ å¯†å­—èŠ‚æ•°ç»„ * @param arrB éœ€åŠ å¯†çš„å­—èŠ‚æ•°ç»„ * @return åŠ å¯†åŽçš„å­—èŠ‚æ•°ç»„ * @throws Exception */ public byte[] encrypt(byte[] arrB) throws Exception &#123; return encryptCipher.doFinal(arrB); &#125; /** * åŠ å¯†å­—ç¬¦ä¸² * * @param strIn éœ€åŠ å¯†çš„å­—ç¬¦ä¸² * @return åŠ å¯†åŽçš„å­—ç¬¦ä¸² * @throws Exception */ public String encrypt(String strIn) throws Exception &#123; return byteArr2HexStr(encrypt(strIn.getBytes())); &#125; /** * è§£å¯†å­—èŠ‚æ•°ç»„ * @param arrB éœ€è§£å¯†çš„å­—èŠ‚æ•°ç»„ * @return è§£å¯†åŽçš„å­—èŠ‚æ•°ç»„ * @throws Exception */ public byte[] decrypt(byte[] arrB) throws Exception &#123; return decryptCipher.doFinal(arrB); &#125; /** * è§£å¯†å­—ç¬¦ä¸² * @param strIn éœ€è§£å¯†çš„å­—ç¬¦ä¸² * @return è§£å¯†åŽçš„å­—ç¬¦ä¸² * @throws Exception */ public String decrypt(String strIn) throws Exception &#123; try &#123; return new String(decrypt(hexStr2ByteArr(strIn))); &#125; catch (Exception e) &#123; return ""; &#125; &#125; /** * ä»ŽæŒ‡å®šå­—ç¬¦ä¸²ç”Ÿæˆå¯†é’¥ï¼Œå¯†é’¥æ‰€éœ€çš„å­—èŠ‚æ•°ç»„é•¿åº¦ä¸º8ä½ ä¸è¶³8ä½æ—¶åŽé¢è¡¥0ï¼Œè¶…å‡º * 8ä½åªå–å‰8ä½ * @param arrBTmp æž„æˆè¯¥å­—ç¬¦ä¸²çš„å­—èŠ‚æ•°ç»„ * @return ç”Ÿæˆçš„å¯†é’¥ * @throws java.lang.Exception */ private Key getKey(byte[] arrBTmp) throws Exception &#123; // åˆ›å»ºä¸€ä¸ªç©ºçš„8ä½å­—èŠ‚æ•°ç»„ï¼ˆé»˜è®¤å€¼ä¸º0ï¼‰ byte[] arrB = new byte[8]; // å°†åŽŸå§‹å­—èŠ‚æ•°ç»„è½¬æ¢ä¸º8ä½ for (int i = 0; i &lt; arrBTmp.length &amp;&amp; i &lt; arrB.length; i++) &#123; arrB[i] = arrBTmp[i]; &#125; // ç”Ÿæˆå¯†é’¥ Key key = new javax.crypto.spec.SecretKeySpec(arrB, "DES"); return key; &#125;&#125;æµ‹è¯•ï¼š1234567891011121314public static void main(String[] args) &#123; try &#123; //è®¾ç½®å¯†åŒ™ EncryptionDecryption ed=new EncryptionDecryption("mrbird"); //åŠ å¯† System.out.println(ed.encrypt("testEncryption")); //a9eb83878c22e90a23dcc32a0333e5e8 //è§£å¯† System.out.println(ed.decrypt("a9eb83878c22e90a23dcc32a0333e5e8")); //testEncryption &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracleæ•°æ®åº“ä¸Žå®žä¾‹]]></title>
    <url>%2FOracle%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E5%AE%9E%E4%BE%8B.html</url>
    <content type="text"><![CDATA[é€šå¸¸ï¼Œâ€œOracleæ•°æ®åº“â€æ—¢æŒ‡å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šçš„å†…éƒ¨å­˜æœ‰æ•°æ®çš„æ•°æ®æ–‡ä»¶ï¼Œä¹ŸæŒ‡ç”¨æ¥ç®¡ç†è¿™äº›æ•°æ®æ–‡ä»¶çš„å†…å­˜ç»“æž„ã€‚å®žé™…ä¸Šï¼Œâ€œæ•°æ®åº“â€å½’å±žäºŽæ•°æ®æ–‡ä»¶ï¼Œâ€œå®žä¾‹â€åˆ™å½’å±žäºŽå†…å­˜ç»“æž„ã€‚å›¾1-1å±•ç¤ºäº†oracleå®žä¾‹ä¸Žæ•°æ®åº“çš„å…³ç³»ã€‚ä¸€ä¸ªå®žä¾‹ç”±ç³»ç»Ÿå…¨å±€å†…å­˜åŒºåŸŸï¼ˆSystem Global Areaï¼ŒSGAï¼‰ä»¥åŠä¸€ç³»åˆ—åŽå°è¿›ç¨‹ç»„æˆã€‚æ¯ä¸ªé“¾æŽ¥åˆ°æ•°æ®åº“çš„ç”¨æˆ·éƒ½æ˜¯é€šè¿‡ä¸€ä¸ªå®¢æˆ·ç«¯è¿›ç¨‹è¿›è¡Œç®¡ç†ï¼Œå®¢æˆ·ç«¯è¿›ç¨‹ä¸ŽæœåŠ¡å™¨è¿›ç¨‹ç›¸è”ç»“ï¼Œæ¯ä¸ªæœåŠ¡å™¨è¿›ç¨‹éƒ½ä¼šè¢«åˆ†é…ä¸€å—ç§æœ‰çš„å†…å­˜åŒºåŸŸï¼Œè¯¥åŒºåŸŸç§°ä¸ºç¨‹åºå…±äº«å†…å­˜åŒºåŸŸæˆ–è¿›ç¨‹å…±äº«å†…å­˜åŒºåŸŸï¼ˆProcess Global Areaï¼ŒPGAï¼‰ã€‚å›¾1-1 å®žä¾‹ä¸Žæ•°æ®åº“å…³ç³»å›¾ SGAå…±äº«æ± å…±äº«æ± æ˜¯Oracleç¼“å­˜æ•°æ®çš„åœ°æ–¹ã€‚æ‰§è¡Œè¿‡çš„æ¯ä¸€æ¡SQLè¯­å¥åœ¨å…±äº«æ± éƒ½å­˜æœ‰è§£æžåŽçš„å†…å®¹ã€‚è€Œå­˜æ”¾è¿™äº›å†…å®¹çš„åŒºåŸŸç§°ä¸ºåº“é«˜é€Ÿç¼“å­˜ã€‚åœ¨æ¯ä¸€æ¡SQLè¯­å¥æ‰§è¡Œä¹‹å‰ï¼ŒOracleéƒ½ä¼šæŸ¥çœ‹åº“é«˜é€Ÿç¼“å­˜ä¸­æ˜¯å¦å·²å­˜åœ¨ç›¸åŒçš„SQLè¯­å¥ã€‚å­˜åœ¨çš„è¯ç›´æŽ¥ä»Žé‡Œé¢è¯»å–è¯¥ä¿¡æ¯ï¼Œè€Œéžå†è§£æžä¸€éã€‚å…±äº«æ± è¿˜å­˜å‚¨æ‰€æœ‰Oracleæ•°æ®åº“å¯¹è±¡ä¿¡æ¯ï¼Œå­˜å‚¨è¯¥ä¿¡æ¯çš„åŒºåŸŸç§°ä¸ºæ•°æ®å­—å…¸ç¼“å­˜åŒºåŸŸã€‚å…±äº«æ± å†…å­˜æœ‰é™ï¼Œå·²åŠ è½½çš„è¯­å¥ä¸èƒ½é•¿æ—¶é—´å­˜æ”¾åœ¨å…¶ä¸­ã€‚åŸºæœ¬æ€æƒ³æ˜¯ä¿ç•™é‚£äº›ä½¿ç”¨æœ€é¢‘ç¹ä»¥åŠæœ€è¿‘ä½¿ç”¨çš„è¯­å¥ã€‚åº“é«˜é€Ÿç¼“å­˜æ¯ä¸€æ¡SQLè¯­å¥æ‰§è¡Œä¹‹å‰éƒ½å°†è¢«è§£æžå¹¶å­˜å…¥åˆ°åº“é«˜é€Ÿç¼“å­˜ä¸­ã€‚è§£æžåŒ…æ‹¬éªŒè¯è¯­æ³•ï¼Œæ£€éªŒæåŠå¯¹è±¡ï¼Œç¡®è®¤å¯¹è±¡ç”¨æˆ·æƒé™ã€‚æ£€éªŒè¿‡åŽï¼Œä¸‹ä¸€ä¸ªæ­¥éª¤å°±æ˜¯æ‰§è¡Œè½¯è§£æžæˆ–è€…ç¡¬è§£æžã€‚è½¯è§£æžï¼šåº“é«˜é€Ÿç¼“å­˜è§£æžæ¯ä¸€æ¡sqlï¼Œåˆ¤æ–­ä¹‹å‰æ˜¯å¦æ‰§è¡Œè¿‡è¯¥è¯­å¥ï¼Œå¦‚æžœæ˜¯ï¼ŒOracleå°†å–å›žä¹‹å‰è§£æžçš„ä¿¡æ¯å¹¶é‡ç”¨ã€‚ç¡¬è§£æžï¼šå¦‚æžœè¯¥è¯­å¥ä¹‹å‰æ²¡æœ‰æ‰§è¡Œè¿‡ï¼ŒOracleå°†æ‰§è¡Œæ‰€æœ‰å·¥ä½œæ¥ä¸ºå½“å‰çš„sqlè¯­å¥ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼Œå¹¶å°†å…¶ä¿å­˜åœ¨ç¼“å­˜ä¸­ä»¥å¤‡å°†æ¥é‡ç”¨ã€‚ç”±æ­¤å¯è§ï¼Œè½¯è§£æžæ•ˆçŽ‡è¿œæ¯”ç¡¬è§£æžæ•ˆçŽ‡é«˜å¾—å¤šï¼å®Œå…¨ç›¸åŒçš„è¯­å¥æœ‰ä¸‰æ¡SQLè¯­å¥ï¼š12345678910111213141516171819202122232425262728SQL&gt; select employee_id,first_name,last_name from hr.employees where department_id = 60; EMPLOYEE_ID FIRST_NAME LAST_NAME----------- -------------------- ------------------------- 103 Alexander Hunold 104 Bruce Ernst 105 David Austin 106 Valli Pataballa 107 Diana LorentzSQL&gt; SELECT EMPLOYEE_ID,FIRST_NAME,LAST_NAME FROM HR.EMPLOYEES WHERE DEPARTMENT_ID = 60; EMPLOYEE_ID FIRST_NAME LAST_NAME----------- -------------------- ------------------------- 103 Alexander Hunold 104 Bruce Ernst 105 David Austin 106 Valli Pataballa 107 Diana Lorentz SQL&gt; select /*a_comment*/ employee_id,first_name,last_name from hr.employees where department_id = 60; EMPLOYEE_ID FIRST_NAME LAST_NAME----------- -------------------- ------------------------- 103 Alexander Hunold 104 Bruce Ernst 105 David Austin 106 Valli Pataballa 107 Diana Lorentzä¸‰æ¡SQLè¯­å¥çš„æ‰§è¡Œç»“æžœå®Œå…¨ä¸€è‡´ã€‚ä½†ä»–ä»¬æ˜¯å®Œå…¨ä¸€æ ·çš„SQLè¯­å¥ä¹ˆï¼ŸæŸ¥çœ‹V$sqlè§†å›¾ï¼š1234567SQL&gt; select sql_id,hash_value,executions from v$sql where upper(sql_text) like '%EMPLOYEES%'; SQL_ID HASH_VALUE EXECUTIONS------------- ---------- ----------3g8h969j7cgdd 1651916205 13j0qbm7gx8jwz 3755231135 1ary9nccpyyqmb 737106539 1ä»Žç»“æžœæ¥çœ‹ï¼Œè¿™ä¸‰æ¡SQLå¹¶ä¸ä¸€æ ·ï¼Œå› ä¸ºå®ƒä»¬å¹¶ä¸æ˜¯ä¸¥æ ¼ä¸€è‡´çš„ã€‚å®Œå…¨ç›¸åŒçš„SQLè¯­å¥å¿…é¡» å¤§å°å†™å­—æ¯ä¸€è‡´ï¼Œç©ºæ ¼ä½ç½®ä¸€è‡´ï¼Œæ³¨é‡Šå†…å®¹ä½ç½®å®Œå…¨ä¸€è‡´ã€‚å¯ä»¥é€šè¿‡ç»‘å®šå˜é‡çš„æ–¹å¼æ¥ä»£æ›¿å¸¸é‡ï¼š123456789101112131415161718192021222324252627282930313233343536373839SQL&gt; variable v_dept numberSQL&gt; exec :v_dept :=10 SQL&gt; select employee_id,first_name,last_name from hr.employees where department_id = :v_dept; EMPLOYEE_ID FIRST_NAME LAST_NAME----------- -------------------- ------------------------- 200 Jennifer Whalen /*--------------------------------------------------------*/SQL&gt; exec :v_dept :=20 SQL&gt; select employee_id,first_name,last_name from hr.employees where department_id = :v_dept; EMPLOYEE_ID FIRST_NAME LAST_NAME----------- -------------------- ------------------------- 201 Michael Hartstein 202 Pat Fay /*--------------------------------------------------------*/SQL&gt; exec :v_dept :=30 SQL&gt; select employee_id,first_name,last_name from hr.employees where department_id = :v_dept; EMPLOYEE_ID FIRST_NAME LAST_NAME----------- -------------------- ------------------------- 114 Den Raphaely 115 Alexander Khoo 116 Shelli Baida 117 Sigal Tobias 118 Guy Himuro 119 Karen Colmenares /*--------------------------------------------------------*/SQL&gt; select sql_id,hash_value,executions from v$sql where upper(sql_text) like '%V_DEPT%'; SQL_ID HASH_VALUE EXECUTIONS------------- ---------- ----------6qsnhnb7dbdra 3470112490 3ç”±æ­¤å¯è§ï¼Œåº“é«˜é€Ÿç¼“å­˜åªå­˜å‚¨äº†ä¸€æ¡è¯­å¥ï¼Œå¹¶æ‰§è¡Œäº†ä¸‰æ¬¡ã€‚é”å­˜å™¨Oracleåªæœ‰èŽ·å¾—äº†é”å­˜å™¨åŽæ‰å¯ä»¥ä»Žåº“é«˜é€Ÿç¼“å­˜æˆ–å…¶ä»–å†…å­˜ä¸­è¯»å–ä¿¡æ¯ã€‚é”å­˜å™¨å¯ä»¥é¿å…åº“é«˜é€Ÿç¼“å­˜åŒæ—¶è¢«ä¸¤ä¸ªä¼šè¯ä¿®æ”¹ï¼Œä¸€ä¸ªä¼šè¯åœ¨è¯»å–åº“é«˜é€Ÿç¼“å­˜ä¿¡æ¯ä¹‹å‰ï¼Œéƒ½ä¼šèŽ·å¾—ä¸€ä¸ªé”å­˜å™¨ï¼Œå¦ä¸€ä¸ªä¼šè¯å¿…é¡»ç­‰åˆ°ä¸Šä¸€ä¸ªä¼šè¯é‡Šæ”¾é”å­˜å™¨ã€‚è‡ªæ—‹å¦‚Oracleåˆ¤æ–­å½“å‰sqlæ˜¯å¦å·²ç»å­˜åœ¨åº“é«˜é€Ÿç¼“å­˜ä¸­æ—¶å¿…é¡»å…ˆèŽ·å¾—é”å­˜å™¨ï¼Œå¦‚æžœæ­¤æ—¶é”å­˜å™¨ä¸æ˜¯ç©ºé—²çš„ï¼ŒOracleä¼šè¿­ä»£è½®è¯¢ï¼ŒæŸ¥çœ‹é”å­˜å™¨æ˜¯å¦å¯ç”¨ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´ï¼ˆ_spin_count=2000ï¼‰é”å­˜å™¨ä»ä¸å¯ç”¨çš„è¯ï¼Œè¯¥è¯·æ±‚ä¼šè¢«æš‚æ—¶æŒ‚èµ·ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡èŽ·å¾—cpuæ—¶é—´ç‰‡ã€‚SGAç¼“å†²åŒºç¼“å­˜å­˜å‚¨æ•°æ®å—ã€‚å—æ˜¯Oracleè¿›è¡Œæ“ä½œçš„æœ€å°çš„å•ä½ï¼ŒåŒ…å«æ•°æ®è¡Œï¼Œç´¢å¼•æˆ–ç”¨æ¥æŽ’åºçš„ä¸´æ—¶æ•°æ®ï¼ˆä¹ŸåŒ…å«å—è‡ªèº«ä¿¡æ¯ï¼‰ã€‚Oracleå¿…é¡»è¯»å–å—æ¥èŽ·å–sqléœ€è¦çš„æ•°æ®è¡Œã€‚ç¼“å†²åŒºå—çš„ç®¡ç†ä¹Ÿéµå¾ªLRU(Least Recently Used)åŽŸåˆ™ï¼ŒåŒæ—¶ä¹Ÿæœ‰ä¸ªå«æŽ¥è§¦è®¡æ•°å™¨ï¼ˆtouch-countï¼‰çš„ä¸œè¥¿ï¼Œè®°å½•å—è¢«ä½¿ç”¨çš„æ¬¡æ•°ï¼Œè¢«è®¿é—®è¶Šé¢‘ç¹çš„å—å­˜æ´»æ—¶é—´è¶Šé•¿ã€‚åœ¨éªŒè¯å—æ˜¯å¦å­˜åœ¨ç¼“å†²åŒºç¼“å­˜çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿéœ€è¦èŽ·å¾—é”å­˜å™¨ã€‚å¦‚æžœä¸€ä¸ªsqlæŸ¥è¯¢æ‰€éœ€æ•°æ®ä¸åœ¨ç¼“å†²åŒºç¼“å­˜çš„å—ä¸­ï¼Œå°±å¿…é¡»è¯»å–æ“ä½œç³»ç»Ÿç¡¬ç›˜æ¥èŽ·å–è¿™äº›ä¿¡æ¯ï¼Œç„¶åŽå­˜æ”¾åˆ°ç¼“å†²åŒºç¼“å­˜çš„å—ä¸­ã€‚é€»è¾‘è¯»å–ï¼šOracleä»Žç¼“å†²åŒºç¼“å­˜å—ä¸­è¯»å–æ•°æ®ï¼›ç‰©ç†è¯»å–ï¼šç¼“å†²åŒºç¼“å­˜å—ä¸­æ²¡æœ‰æ•°æ®ï¼ŒOracleä»Žç¡¬ç›˜ä¸­è¯»å–æ•°æ®çš„è¿‡ç¨‹ã€‚Eg:1.æ¸…é™¤å…±äº«æ± å’Œç¼“å†²åŒºç¼“å­˜ï¼ˆç¡¬è§£æžå’Œç‰©ç†è¯»å–ï¼‰ï¼š123456789101112131415161718192021SQL&gt; alter system set events 'immediate trace name flush_cache';ç³»ç»Ÿå·²æ›´æ”¹ã€‚SQL&gt; alter system flush shared_pool;ç³»ç»Ÿå·²æ›´æ”¹ã€‚SQL&gt; set autotrace traceonly statisticsSQL&gt;SQL&gt; select * from hr.employees where department_id=60; ç»Ÿè®¡ä¿¡æ¯---------------------------------------------------------- 976 recursive calls 0 db block gets 237 consistent gets 23 physical reads 0 redo size 1320 bytes sent via SQL*Net to client 359 bytes received via SQL*Net from client 2 SQL*Net roundtrips to/from client 9 sorts (memory) 0 sorts (disk) 5 rows processed2.ä»…æ¸…é™¤ç¼“å†²åŒºç¼“å­˜ï¼ˆè½¯è§£æžå’Œç‰©ç†è¯»å–ï¼‰ï¼š12345678910111213141516171819202122SQL&gt; set autotrace offSQL&gt;SQL&gt; alter system set events 'immediate trace name flush_cache'; ç³»ç»Ÿå·²æ›´æ”¹ã€‚SQL&gt; set autotrace traceonly statisticsSQL&gt;SQL&gt; select * from hr.employees where department_id=60; ç»Ÿè®¡ä¿¡æ¯---------------------------------------------------------- 0 recursive calls 0 db block gets 4 consistent gets 2 physical reads 0 redo size 1320 bytes sent via SQL*Net to client 359 bytes received via SQL*Net from client 2 SQL*Net roundtrips to/from client 0 sorts (memory) 0 sorts (disk) 5 rows processed â€‹3.éƒ½ä¸æ¸…é™¤ï¼ˆè½¯è§£æžå’Œé€»è¾‘è¯»å–ï¼‰ï¼š123456789101112131415SQL&gt; select * from hr.employees where department_id=60; ç»Ÿè®¡ä¿¡æ¯---------------------------------------------------------- 0 recursive calls 0 db block gets 4 consistent gets 0 physical reads 0 redo size 1320 bytes sent via SQL*Net to client 359 bytes received via SQL*Net from client 2 SQL*Net roundtrips to/from client 0 sorts (memory) 0 sorts (disk) 5 rows processed â€‹ç»“æžœè¯æ˜Žï¼Œå½“æ‰§è¡Œçš„æŸ¥è¯¢åªéœ€è¦è½¯è§£æžå’Œé€»è¾‘è¯»å–æ•°æ®å—çš„æ—¶å€™ï¼Œæ‰€æ¶ˆè€—çš„èµ„æºæ˜¯æœ€å°‘çš„ï¼]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptæ—¶é—´æ ¼å¼åŒ–]]></title>
    <url>%2FJavaScript%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E5%8C%96.html</url>
    <content type="text"><![CDATA[æœ‰æ—¶å€™åŽå°ä¼ é€çš„æ—¶é—´æ ¼å¼æ˜¯è¿™æ ·çš„ï¼š1471881600000ï¼Œæˆ–è€…é€šè¿‡new Date( )ç”Ÿæˆçš„æ—¶é—´æ ¼å¼æ˜¯è¿™æ ·çš„ï¼šTue Aug 30 2016 16:32:38 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)ã€‚JavaScriptæ²¡æœ‰ç±»ä¼¼äºŽjavaçš„SimpleDateFormat( )å‡½æ•°ï¼Œè¿™æ—¶å€™å¯ä»¥è‡ªå·±å†™ä¸€ä¸ªå‡½æ•°ä»£æ›¿ï¼š1234567891011121314151617181920212223//æ—¶é—´æ ¼å¼åŒ–Date.prototype.Format = function (fmt) &#123; var o = &#123; "M+": this.getMonth() + 1, "d+": this.getDate(), "h+": this.getHours(), "m+": this.getMinutes(), "s+": this.getSeconds(), "q+": Math.floor((this.getMonth() + 3) / 3), "S": this.getMilliseconds() &#125;; if (/(y+)/.test(fmt))&#123; fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "") .substr(4 - RegExp.$1.length)); &#125; for (var k in o)&#123; if (new RegExp("(" + k + ")").test(fmt))&#123; fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length))); &#125; &#125; return fmt;&#125;è°ƒç”¨æ–¹å¼ï¼šnew Date( ).Format(&quot;yyyy-MM-dd&quot;);]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dom4jè§£æžå’Œç”Ÿæˆxmlæ–‡ä»¶]]></title>
    <url>%2Fdom4j%E8%A7%A3%E6%9E%90%E5%92%8C%E7%94%9F%E6%88%90xml%E6%96%87%E4%BB%B6.html</url>
    <content type="text"><![CDATA[è§£æžxmlå¤§è‡´æ­¥éª¤ï¼š1: åˆ›å»ºSAXReaderï¼›2: ä½¿ç”¨SAXReaderè§£æžæŒ‡å®šçš„xmlæ–‡æ¡£ä¿¡æ¯ï¼Œå¹¶è¿”å›žå¯¹åº”Documentå¯¹è±¡ã€‚Documentå¯¹è±¡ä¸­å°±åŒ…å«äº†è¯¥xmlæ–‡ä¸­çš„æ‰€æœ‰ä¿¡æ¯ä»¥åŠç»“æž„äº†ã€‚3: æ ¹æ®æ–‡æ¡£ç»“æž„å°†xmlæè¿°çš„æ ‘çŠ¶ä¿¡æ¯è¯»å–åˆ° ã€‚çŽ°æœ‰emp.xmlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930313233&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;list&gt; &lt;emp id="1"&gt; &lt;name&gt;æåˆ©æ˜‚Â·å…°å°¼æ–¯ç‰¹&lt;/name&gt; &lt;age&gt;25&lt;/age&gt; &lt;gender&gt;ç”·&lt;/gender&gt; &lt;salary&gt;5000&lt;/salary&gt; &lt;/emp&gt; &lt;emp id="2"&gt; &lt;name&gt;å¡ä¸½ç†™&lt;/name&gt; &lt;age&gt;27&lt;/age&gt; &lt;gender&gt;å¥³&lt;/gender&gt; &lt;salary&gt;6000&lt;/salary&gt; &lt;/emp&gt; &lt;emp id="3"&gt; &lt;name&gt;ç¼æ©Â·é›ªè¯º&lt;/name&gt; &lt;age&gt;28&lt;/age&gt; &lt;gender&gt;ç”·&lt;/gender&gt; &lt;salary&gt;7000&lt;/salary&gt; &lt;/emp&gt; &lt;emp id="4"&gt; &lt;name&gt;å¸ƒå…°Â·æ–¯å¡”å…‹&lt;/name&gt; &lt;age&gt;22&lt;/age&gt; &lt;gender&gt;ç”·&lt;/gender&gt; &lt;salary&gt;8000&lt;/salary&gt; &lt;/emp&gt; &lt;emp id="5"&gt; &lt;name&gt;nightKing&lt;/name&gt; &lt;age&gt;26&lt;/age&gt; &lt;gender&gt;æœªçŸ¥&lt;/gender&gt; &lt;salary&gt;9000&lt;/salary&gt; &lt;/emp&gt;&lt;/list&gt;æ–°å»ºä¸€ä¸ªempå®žä½“ç±»ï¼Œç”¨äºŽæŽ¥æ”¶è§£æžæ•°æ®ï¼š12345678910111213141516171819public class Emp &#123; private int id; private String name; private int age; private String gender; private int salary; public Emp()&#123; &#125; public Emp(int id,String name,int age,String gender,int salary)&#123; super(); this.id = id; this.name = name; this.age = age; this.gender = gender; this.salary = salary; &#125; //get,setç•¥&#125;123456789101112131415161718192021222324252627282930313233343536373839public class ParseXmlDemo &#123; public static List getXml()&#123; try &#123; SAXReader reader=new SAXReader(); Document doc=reader.read(new File("emp.xml")); List&lt;Emp&gt; list=new ArrayList&lt;Emp&gt;(); /* * è§£æžç¬¬ä¸€æ­¥ï¼ŒèŽ·å–æ ¹æ ‡ç­¾ï¼ˆæ ¹å…ƒç´ ï¼‰ * è¿™é‡ŒèŽ·å–çš„æ ¹æ ‡ç­¾å°±ç›¸å½“äºŽæ˜¯&lt;list&gt;...&lt;/list&gt; * é‚£å¯¹æ ‡ç­¾ã€‚ */ Element root=doc.getRootElement(); //èŽ·å–åä¸º"emp"çš„æ ‡ç­¾ List&lt;Element&gt; elementList=root.elements("emp"); //éåŽ†æ¯ä¸€ä¸ªempæ ‡ç­¾ for(Element empEle:elementList)&#123; //èŽ·å–name String name=empEle.elementText("name"); int age=Integer.parseInt(empEle.elementText("age")); String gender=empEle.elementText("gender"); int salary=Integer.parseInt(empEle.elementText("salary")); //å±žæ€§ Attribute attr=empEle.attribute("id"); int id=Integer.parseInt(attr.getValue()); Emp emp=new Emp(id,name,age,gender,salary); list.add(emp); &#125; return list; &#125; catch (Exception e) &#123; // TODO: handle exception System.out.println(e.toString()); &#125; return null;&#125; public static void main(String[] args) &#123; List list=ParseXmlDemo.getXml(); System.out.println(list.toString()); &#125;&#125;è¾“å‡ºç»“æžœï¼š123451,æåˆ©æ˜‚Â·å…°å°¼æ–¯ç‰¹,25,ç”·,5000, 2,å¡ä¸½ç†™,27,å¥³,6000,3,ç¼æ©é›ªè¯º,28,ç”·,7000, 4,å¸ƒå…°æ–¯å¡”å…‹,22,ç”·,8000, 5,nightKing,26,æœªçŸ¥,9000ç”Ÿæˆxmlå¤§è‡´æ­¥éª¤ï¼š1: åˆ›å»ºä¸€ä¸ªDocumentå¯¹è±¡ï¼Œè¡¨ç¤ºä¸€ä¸ªç©ºçš„xmlæ–‡æ¡£ï¼›2: å‘Documentä¸­æ·»åŠ æ ¹å…ƒç´ ï¼›3: æŒ‰ç…§ç›®æ ‡xmlæ–‡æ¡£çš„ç»“æž„é¡ºåºå‘æ ¹å…ƒç´ ä¸­æ·»åŠ å­å…ƒç´ æ¥ç»„å»ºè¯¥ç»“æž„ï¼›4: åˆ›å»ºXMLWriterï¼›5: è®¾ç½®ä½Žçº§æµï¼›6: ä½¿ç”¨XMLWriterå°†Documentå†™å‡ºæ¥ç”Ÿæˆ è¯¥æ–‡æ¡£ ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344public class WriteXmlDemo &#123; public static void main(String[] args) &#123; try &#123; List&lt;Emp&gt; list= new ArrayList&lt;Emp&gt;(); list.add(new Emp(1,"é¸£äºº",25,"ç”·",4000)); list.add(new Emp(2,"å°æ¨±",27,"å¥³",6000)); list.add(new Emp(3,"ä½åŠ©",28,"ç”·",7000)); list.add(new Emp(4,"é›ç”°",22,"å¥³",8000)); list.add(new Emp(5,"å¡å¡è¥¿",26,"ç”·",90001)); Document doc = DocumentHelper.createDocument(); //ç”Ÿæˆæ ¹å…ƒç´  Element root = doc.addElement("list"); for(Emp emp : list)&#123; //æ ¹æ ‡ç­¾ä¸‹æ·»åŠ å­æ ‡ç­¾ Element empEle= root.addElement("emp"); //å‘empæ ‡ç­¾ä¸­æ·»åŠ å­æ ‡ç­¾name Element nameEle= empEle.addElement("name"); //æ ‡ç­¾èµ‹å€¼ nameEle.addText(emp.getName()); Element ageEle = empEle.addElement("age"); ageEle.addText(emp.getAge()+""); Element genderEle = empEle.addElement("gender"); genderEle.addText(emp.getGender()); Element salaryEle = empEle.addElement("salary"); salaryEle.addText(emp.getSalary()+""); //æ·»åŠ å±žæ€§ empEle.addAttribute("id", emp.getId()+""); &#125; //org.dom4j.XMLWriter XMLWriter writer = new XMLWriter( OutputFormat.createPrettyPrint()); /* * å‘æ–‡ä»¶myemp.xmlä¸­å†™å‡ºæ•°æ® */ FileOutputStream fos= new FileOutputStream("myemp.xml"); writer.setOutputStream(fos); writer.write(doc); writer.close(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125;ç”Ÿæˆmyemp.xmlï¼š12345678910111213141516171819202122232425262728293031323334&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;list&gt; &lt;emp id="1"&gt; &lt;name&gt;é¸£äºº&lt;/name&gt; &lt;age&gt;25&lt;/age&gt; &lt;gender&gt;ç”·&lt;/gender&gt; &lt;salary&gt;4000&lt;/salary&gt; &lt;/emp&gt; &lt;emp id="2"&gt; &lt;name&gt;å°æ¨±&lt;/name&gt; &lt;age&gt;27&lt;/age&gt; &lt;gender&gt;å¥³&lt;/gender&gt; &lt;salary&gt;6000&lt;/salary&gt; &lt;/emp&gt; &lt;emp id="3"&gt; &lt;name&gt;ä½åŠ©&lt;/name&gt; &lt;age&gt;28&lt;/age&gt; &lt;gender&gt;ç”·&lt;/gender&gt; &lt;salary&gt;7000&lt;/salary&gt; &lt;/emp&gt; &lt;emp id="4"&gt; &lt;name&gt;é›ç”°&lt;/name&gt; &lt;age&gt;22&lt;/age&gt; &lt;gender&gt;å¥³&lt;/gender&gt; &lt;salary&gt;8000&lt;/salary&gt; &lt;/emp&gt; &lt;emp id="5"&gt; &lt;name&gt;å¡å¡è¥¿&lt;/name&gt; &lt;age&gt;26&lt;/age&gt; &lt;gender&gt;ç”·&lt;/gender&gt; &lt;salary&gt;90001&lt;/salary&gt; &lt;/emp&gt;&lt;/list&gt;]]></content>
      <tags>
        <tag>Java</tag>
        <tag>xml</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaè¯»å–å’Œä¿®æ”¹iniæ–‡ä»¶]]></title>
    <url>%2FJava%E8%AF%BB%E5%8F%96%E5%92%8C%E4%BF%AE%E6%94%B9ini%E6%96%87%E4%BB%B6.html</url>
    <content type="text"><![CDATA[é¡¹ç›®å¼€å‘ä¸­ï¼Œä¸€èˆ¬å°†ç³»ç»Ÿçº§çš„é…ç½®æ”¾åœ¨inié…ç½®æ–‡ä»¶é‡Œï¼Œé¡¹ç›®å¯åŠ¨æ—¶ï¼Œé€šè¿‡javaè¯»å–inié‡Œçš„å˜é‡å€¼ï¼Œç„¶åŽå‘é€åˆ°é¡µé¢ä¸Šã€‚å¦‚çº¢è‰²è­¦æˆ’çš„ra2.inié…ç½®æ–‡ä»¶ï¼š12345678910111213141516171819202122232425262728[MultiPlayer]PreferredGameTypeID = 111111 PreferredScenarioIndex=0Locale=0StoreNick=yesPortBase=1255PortPool=9415PhoneIndex=-1WOLLimitResolution=noLastNickSlot=-1Handle=5b,4e,65,77,20,50,6c,61,79,65,72,5d,Color=2ColorEx=-1Side=AmericansSideEx=-1GameMode=2 [Options]GameSpeed=0Difficulty=0ScrollMethod=0ScrollRate=0AutoScroll=yesDetailLevel=2SidebarCameoText=yesUnitActionLines=yesShowHidden=yesToolTips=yesè¯»å–å’Œä¿®æ”¹æ–¹æ³•ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126public final class javaReadIniUtil &#123; /** * ä»Žinié…ç½®æ–‡æ¡£ä¸­è¯»å–å˜é‡çš„å€¼ * @param file é…ç½®æ–‡æ¡£çš„è·¯å¾„ * @param section è¦èŽ·å–çš„å˜é‡æ‰€åœ¨æ®µåç§° * @param variable è¦èŽ·å–çš„å˜é‡åç§° * @param defaultValue å˜é‡åç§°ä¸å­˜åœ¨æ—¶çš„é»˜è®¤å€¼ * @return å˜é‡çš„å€¼ * @throws IOException æŠ›å‡ºæ–‡æ¡£æ“ä½œå¯èƒ½å‡ºçŽ°çš„ioå¼‚å¸¸ */ public static String getProfileString(String file, String section, String variable, String defaultValue) throws IOException &#123; String strLine, value = ""; BufferedReader bufferedReader = new BufferedReader(new FileReader(file)); boolean isInSection = false; try &#123; while ((strLine = bufferedReader.readLine()) != null) &#123; strLine = strLine.trim(); Pattern p; Matcher m; p = Pattern.compile("\\["+section+"\\]"); m = p.matcher((strLine)); if (m.matches()) &#123; p = Pattern.compile("\\["+section+"\\]"); m = p.matcher(strLine); if (m.matches()) &#123; isInSection = true; &#125; else &#123; isInSection = false; &#125; &#125; if (isInSection == true) &#123; strLine = strLine.trim(); String[] strArray = strLine.split("="); if (strArray.length == 1) &#123; value = strArray[0].trim(); if (value.equalsIgnoreCase(variable)) &#123; value = ""; return value; &#125; &#125; else if (strArray.length == 2) &#123; value = strArray[0].trim(); if (value.equalsIgnoreCase(variable)) &#123; value = strArray[1].trim(); return value; &#125; &#125; else if (strArray.length &gt; 2) &#123; value = strArray[0].trim(); if (value.equalsIgnoreCase(variable)) &#123; value = strLine .substring(strLine.indexOf("=") + 1).trim(); return value; &#125; &#125; &#125; &#125; &#125; finally &#123; bufferedReader.close(); &#125; return defaultValue; &#125; /** * ä¿®æ”¹inié…ç½®æ–‡æ¡£ä¸­å˜é‡çš„å€¼ * @param file é…ç½®æ–‡æ¡£çš„è·¯å¾„ * @param section è¦ä¿®æ”¹çš„å˜é‡æ‰€åœ¨æ®µåç§° * @param variable è¦ä¿®æ”¹çš„å˜é‡åç§° * @param value å˜é‡çš„æ–°å€¼ * @throws IOException æŠ›å‡ºæ–‡æ¡£æ“ä½œå¯èƒ½å‡ºçŽ°çš„ioå¼‚å¸¸ */ public static boolean setProfileString(String file, String section,String variable, String value)throws IOException&#123; String fileContent, allLine, strLine, newLine, remarkStr; String getValue; BufferedReader bufferedReader = new BufferedReader(new FileReader(file)); boolean isInSection = false; fileContent = ""; try &#123; while ((allLine = bufferedReader.readLine()) != null) &#123; allLine = allLine.trim(); strLine = allLine; Pattern p; Matcher m; p = Pattern.compile("\\["+section+"\\]"); m = p.matcher((strLine)); if (m.matches()) &#123; p = Pattern.compile("\\["+section+"\\]"); m = p.matcher(strLine); if (m.matches()) &#123; isInSection = true; &#125; else &#123; isInSection = false; &#125; &#125; if (isInSection == true) &#123; strLine = strLine.trim(); String[] strArray = strLine.split("="); getValue = strArray[0].trim(); if (getValue.equalsIgnoreCase(variable)) &#123; newLine = getValue + " = " + value + " "; fileContent += newLine + "\r\n"; while((allLine = bufferedReader.readLine())!= null)&#123; fileContent += allLine + "\r\n"; &#125; bufferedReader.close(); BufferedWriter bufferedWriter = new BufferedWriter(new FileWriter(file, false)); bufferedWriter.write(fileContent); bufferedWriter.flush(); bufferedWriter.close(); return true; &#125; &#125; fileContent += allLine + "\r\n"; &#125; &#125; catch (IOException ex) &#123; throw ex; &#125; finally &#123; bufferedReader.close(); &#125; return false; &#125; &#125;æµ‹è¯•ç¨‹åºï¼š123456789101112// ä¿®æ”¹iniå€¼public static void main(String[] args) &#123; try &#123; javaReadIniUtil.setProfileString( "resource/ra2.ini", "MultiPlayer", "GameMode", "mr_bird")); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;å€¼å·²è¢«æ”¹å˜ï¼š12345678910111213141516[MultiPlayer]PreferredGameTypeID = 111111PreferredScenarioIndex=0Locale=0StoreNick=yesPortBase=1255PortPool=9415PhoneIndex=-1WOLLimitResolution=noLastNickSlot=-1Handle=5b,4e,65,77,20,50,6c,61,79,65,72,5d,Color=2ColorEx=-1Side=AmericansSideEx=-1GameMode = mr_birdè¯»å–[MultiPlayer]çš„GameModeå˜é‡å€¼123456789101112public static void main(String[] args) &#123; try &#123; System.out.println( readIniUtil.getProfileString( "resource/ra2.ini", "MultiPlayer", "GameMode", "default")); //mr_bird &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125; â€‹]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java.math.BigDecimalç±»å¸¸ç”¨æ–¹æ³•]]></title>
    <url>%2FJava-math-BigDecimal%E7%B1%BB%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95.html</url>
    <content type="text"><![CDATA[åœ¨ç¼–ç¨‹ä¸­ï¼Œå½“æˆ‘ä»¬éœ€è¦å¾—åˆ°ç²¾ç¡®çš„è¿ç®—ç»“æžœçš„æ—¶å€™ï¼Œ+ï¼Œ-ï¼Œ*ï¼Œ/ å·²ç»ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œæ¯”å¦‚ï¼š1234System.out.println(0.1+0.2); //0.30000000000000004System.out.println(0.3-0.2); //0.09999999999999998System.out.println(0.1*0.2); //0.020000000000000004System.out.println(1.2/3); //0.39999999999999997ç®€å•çš„è¿ç®—ç»“æžœå´ä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚Javaæä¾›äº†ä¸€ä¸ªå«BigDecimalçš„ç±»ï¼Œè¯¥ç±»æ”¯æŒä»»ä½•ç²¾åº¦çš„å®šç‚¹æ•°ï¼Œå¯ä»¥ç”¨å®ƒæ¥ç²¾ç¡®è®¡ç®—è´§å¸å€¼ã€‚java.math.BigDecimalç±»å…±æœ‰å››ä¸ªæž„é€ æ–¹æ³•ï¼š1.BigDecimal(int) â€”-intç±»åž‹è½¬ä¸ºBigDecimalç±»åž‹2.BigDecimal(double) â€”-doubleç±»åž‹è½¬ä¸ºBigDecimalç±»åž‹3.BigDecimal(long) â€”-longç±»åž‹è½¬ä¸ºBigDecimalç±»åž‹4.BigDecimal(string) â€”-stringç±»åž‹è½¬ä¸ºBigDecimalç±»åž‹å®žé™…ä½¿ç”¨ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨BigDecimal(string)æž„é€ æ–¹æ³•ã€‚å› ä¸ºå°†stringç±»åž‹è½¬ä¸ºBigDecimalçš„ç»“æžœæ˜¯å¯é¢„çŸ¥çš„ã€‚ç›¸åï¼Œå¦‚é€šè¿‡æž„é€ æ–¹æ³•BigDecimal(0.1) å°†0.1è½¬ä¸ºBigDecimalç±»åž‹ï¼š1System.out.println(new BigDecimal(0.1)); //0.1000000000000000055511151...å› ä¸º0.1å¹¶ä¸èƒ½ç²¾ç¡®çš„è¡¨ç¤ºä¸ºdoubleè€Œé€šè¿‡BigDecimal(string)æˆ‘ä»¬å¯ä»¥å¾—åˆ°é¢„æœŸçš„è½¬æ¢ç»“æžœï¼š1System.out.println(new BigDecimal("0.1")); //0.1å¸¸ç”¨æ–¹æ³•ï¼š1.åŠ æ³•ï¼š123456BigDecimal add=new BigDecimal("0.1").add(new BigDecimal("0.2"));System.out.println(add); //0.3//ä¿ç•™ä¸¤ä½æœ‰æ•ˆæ•°å­—BigDecimal add1=new BigDecimal("0.1") .add(new BigDecimal("0.22222222222"),new MathContext(2));System.out.println(add1); //0.322.å‡æ³•ï¼š123456BigDecimal sub=new BigDecimal("0.3").subtract(new BigDecimal("0.1"));System.out.println(sub); //0.2//ä¿ç•™ä¸¤ä½æœ‰æ•ˆæ•°å­—BigDecimal sub=new BigDecimal("0.3") .subtract(new BigDecimal("0.111111111"),new MathContext(2));System.out.println(sub); //0.193.ä¹˜æ³•ï¼š123456BigDecimal mul=new BigDecimal("0.1").multiply(new BigDecimal("0.2"));System.out.println(mul); //0.02//ä¿ç•™ä¸¤ä½æœ‰æ•ˆæ•°å­—BigDecimal mul1=new BigDecimal("0.1") .multiply(new BigDecimal("0.2222222222"),new MathContext(2));System.out.println(mul1); //0.0224.é™¤æ³•ï¼š12345678910BigDecimal div=new BigDecimal("1.2").divide(new BigDecimal("3"));System.out.println(div); //0.4//ä¿ç•™ä¸¤ä½æœ‰æ•ˆæ•°å­—BigDecimal div1=new BigDecimal("1") .divide(new BigDecimal("3"),new MathContext(2));System.out.println(div1); //0.33//å››èˆäº”å…¥ï¼Œä¿ç•™ä¸¤ä½å°æ•°BigDecimal div2=new BigDecimal("2") .divide(new BigDecimal("3"), 2, RoundingMode.HALF_UP);System.out.println(div2); //0.675.æ¯”è¾ƒå¤§å°ï¼š123456789//å°äºŽï¼Œè¿”å›ž-1int result=new BigDecimal("0.1").compareTo(new BigDecimal("0.2"));System.out.println(result); //-1 //ç­‰äºŽï¼Œè¿”å›ž 0int result=new BigDecimal("0.2").compareTo(new BigDecimal("0.2"));System.out.println(result); //0//å¤§äºŽï¼Œè¿”å›ž 1int result=new BigDecimal("0.3").compareTo(new BigDecimal("0.2"));System.out.println(result); //1]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[EasyUIç­‰å¾…åŠ è½½åŠ¨ç”» [è½¬]]]></title>
    <url>%2FEasyUI%E7%AD%89%E5%BE%85%E5%8A%A0%E8%BD%BD%E5%8A%A8%E7%94%BB-%E8%BD%AC.html</url>
    <content type="text"><![CDATA[ä½¿ç”¨æ–¹æ³•:1.å¼€å¯:MaskUtil.mask();2.å…³é—­:MaskUtil.unmask();3.MaskUtil.mask(â€˜å…¶å®ƒæç¤ºæ–‡å­—â€¦â€™);123456789101112131415161718192021222324252627282930var MaskUtil = (function()&#123; var $mask,$maskMsg; var defMsg = 'æ­£åœ¨å¤„ç†ï¼Œè¯·ç¨å¾…ã€‚ã€‚ã€‚'; function init()&#123; if(!$mask)&#123; $mask = $("&lt;div class=\"datagrid-mask mymask\"&gt;&lt;/div&gt;").appendTo("body"); &#125; if(!$maskMsg)&#123; $maskMsg = $("&lt;div class=\"datagrid-mask-msg mymask\"&gt;"+defMsg+"&lt;/div&gt;") .appendTo("body").css(&#123;'font-size':'12px'&#125;); &#125; $mask.css(&#123;width:"100%",height:$(document).height()&#125;); var scrollTop = $(document.body).scrollTop(); $maskMsg.css(&#123; left:( $(document.body).outerWidth(true) - 190 ) / 2 , top:( ($(window).height() - 45) / 2 ) + scrollTop &#125;); &#125; return &#123; mask:function(msg)&#123; init(); $mask.show(); $maskMsg.html(msg||defMsg).show(); &#125;, unmask:function()&#123; $mask.hide(); $maskMsg.hide(); &#125; &#125;&#125;());è½¬è‡ªï¼šAXEåšå®¢]]></content>
      <tags>
        <tag>EasyUI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»¿Windowsç•Œé¢çš„JFileChooser]]></title>
    <url>%2F%E4%BB%BFWindows%E7%95%8C%E9%9D%A2%E7%9A%84JFileChooser.html</url>
    <content type="text"><![CDATA[1234567891011121314151617181920try &#123; UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());&#125; catch (Exception e1) &#123; e1.printStackTrace();&#125;String out = new SimpleDateFormat("yyMMddhhmmss").format(new Date());JFileChooser fc = new JFileChooser();//è®¾ç½®é»˜è®¤æ–‡ä»¶åfc.setSelectedFile(new File("é¡¹ç›®å†…å®¹è¡¨" + out + ".xls"));fc.setDialogType(JFileChooser.FILES_ONLY);fc.setDialogTitle("é€‰æ‹©ä¿å­˜è·¯å¾„");fc.setMultiSelectionEnabled(false);int result = fc.showSaveDialog(fc);if (result == JFileChooser.APPROVE_OPTION) &#123; //ä¿å­˜ //your code here&#125; else &#123; //å–æ¶ˆ //your code here&#125;å¦‚å›¾ï¼šæ›´æ¢å›¾æ ‡ï¼šé‡å†™å…¶çˆ¶ç±»JFrameï¼š123JFrame jf=new JFrame();ImageIcon imgIcon = new ImageIcon(ProExportUtil.class.getResource("icon.png"));jf.setIconImage(imgIcon.getImage());å°†ä¸Šé¢13è¡Œä»£ç æ”¹ä¸ºï¼š1int result = fc.showSaveDialog(jf);æ•ˆæžœå¦‚å›¾æ‰€ç¤ºï¼š]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[onClickäº‹ä»¶å’ŒonDblClick äº‹ä»¶å¹¶å­˜çš„è§£å†³æ–¹æ³• [è½¬]]]></title>
    <url>%2FonClick%E4%BA%8B%E4%BB%B6%E5%92%8ConDblClick-%E4%BA%8B%E4%BB%B6%E5%B9%B6%E5%AD%98%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95-%E8%BD%AC.html</url>
    <content type="text"><![CDATA[æœ€è¿‘é¡¹ç›®ä¸­é‡åˆ°äº†åœ¨åŒä¸€DOMå…ƒç´ ä¸Šéœ€è¦æ·»åŠ  onclick å’Œ ondblclick 2ä¸ªäº‹ä»¶ï¼Œå¦‚æžœæŒ‰ç…§æ­£å¸¸çš„æ–¹å¼æ·»åŠ å¤„ç†ï¼Œç»“æžœå‘çŽ°åªä¼šæ‰§è¡Œonclickï¼Œè€Œä¸ä¼šæ‰§è¡Œ ondblclickï¼›è¿™æ—¶æˆ‘ä»¬éœ€è¦å¯¹2ä¸ªäº‹ä»¶çš„å¤„ç†å‡½æ•°ç¨ä½œå¤„ç†å°±å¯ä»¥å®žçŽ°2ä¸ªäº‹ä»¶å¹¶å­˜äº†ï¼Œä»£ç å¦‚ä¸‹ï¼š12345678910111213141516171819202122&lt;script type="text/javascript"&gt; var clickTimer = null; function _click()&#123; if(clickTimer) &#123; window.clearTimeout(clickTimer); clickTimer = null; &#125; clickTimer = window.setTimeout(function()&#123; // your click process code here alert("ä½ å•å‡»äº†æˆ‘"); &#125;, 300); &#125; function _dblclick()&#123; if(clickTimer) &#123; window.clearTimeout(clickTimer); clickTimer = null; &#125; // your click process code here alert("ä½ åŒå‡»äº†æˆ‘"); &#125; &lt;/script&gt;å¤„ç†æ€æƒ³å°±æ˜¯ï¼šåˆ©ç”¨å®šæ—¶å™¨å»¶è¿Ÿæ‰§è¡Œonclickäº‹ä»¶ï¼Œè¿™æ ·åœ¨åŒå‡»è¿‡ç¨‹ä¸­ä¼šå–æ¶ˆä¸­é€”è§¦å‘çš„å•å‡»äº‹ä»¶ã€‚è½¬è‡ªå±±å“¥]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Apache POIå¯¼å‡ºExcelæ–‡ä»¶]]></title>
    <url>%2FApache-POI%E5%AF%BC%E5%87%BAExcel%E6%96%87%E4%BB%B6.html</url>
    <content type="text"><![CDATA[Apache POI æ˜¯ç”¨Javaç¼–å†™çš„å…è´¹å¼€æºçš„è·¨å¹³å°çš„ Java APIï¼ŒApache POIæä¾›APIç»™Javaç¨‹å¼å¯¹Microsoft Officeæ ¼å¼æ¡£æ¡ˆè¯»å’Œå†™çš„åŠŸèƒ½ã€‚Apache POI ä¸­æä¾›çš„å‡ å¤§éƒ¨åˆ†çš„ä½œç”¨ï¼š1.HSSF ï¼ æä¾›è¯»å†™Microsoft Excel XLSæ ¼å¼æ¡£æ¡ˆçš„åŠŸèƒ½ã€‚2.XSSF ï¼ æä¾›è¯»å†™Microsoft Excel OOXML XLSXæ ¼å¼æ¡£æ¡ˆçš„åŠŸèƒ½ã€‚3.HWPF ï¼ æä¾›è¯»å†™Microsoft Word DOCæ ¼å¼æ¡£æ¡ˆçš„åŠŸèƒ½ã€‚4.HSLF ï¼ æä¾›è¯»å†™Microsoft PowerPointæ ¼å¼æ¡£æ¡ˆçš„åŠŸèƒ½ã€‚5.HDGF ï¼ æä¾›è¯»Microsoft Visioæ ¼å¼æ¡£æ¡ˆçš„åŠŸèƒ½ã€‚6.HPBF ï¼ æä¾›è¯»Microsoft Publisheræ ¼å¼æ¡£æ¡ˆçš„åŠŸèƒ½ã€‚7.HSMF ï¼ æä¾›è¯»Microsoft Outlookæ ¼å¼æ¡£æ¡ˆçš„åŠŸèƒ½ã€‚ä½¿ç”¨Apache POIå¯¼å‡ºExcelè¡¨æ ¼æ–‡ä»¶å¤§è‡´å¦‚ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š1.åˆ›å»ºæ–°çš„Excelå·¥ä½œè–„ï¼š1HSSFWorkbook workbook = new HSSFWorkbook(); â€‹2.åˆ›å»ºä¸€ä¸ªå·¥ä½œè¡¨ï¼Œå¦‚â€œå‘˜å·¥è¡¨â€ï¼š1HSSFSheet sheet = workbook.createSheet("å‘˜å·¥è¡¨"); â€‹3.åˆ›å»ºè¡Œï¼š1HSSFRow row = sheet.createRow(0); //0è¡¨ç¤ºç´¢å¼•ä¸º0çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯å·¦ä¸Šè§’4.åˆ›å»ºåˆ—ï¼ˆä¹Ÿå°±æ˜¯æ¯ä¸€è¡Œçš„å•å…ƒæ ¼ï¼‰:1HSSFCell cell = row.createCell((short) 0); â€‹5.åˆ›å»ºæ–‡ä»¶æµï¼Œè¾“å‡ºExcelï¼Œè¾“å‡ºåŽå…³é—­æµä»¥ä¸‹æ˜¯å…·ä½“å®žä¾‹ï¼šExcelå·¥å…·ç±»(ExcelUtil)ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899public class ExcelUtil &#123; private HSSFWorkbook wb = null; private HSSFSheet sheet = null; /** * @param wb * @param sheet */ public ExcelUtil(HSSFWorkbook wb, HSSFSheet sheet) &#123; super(); this.wb = wb; this.sheet = sheet; &#125; public HSSFSheet getSheet() &#123; return sheet; &#125; public void setSheet(HSSFSheet sheet) &#123; this.sheet = sheet; &#125; public HSSFWorkbook getWb() &#123; return wb; &#125; public void setWb(HSSFWorkbook wb) &#123; this.wb = wb; &#125; /** * åˆ›å»ºé€šç”¨EXCELå¤´éƒ¨ * * @param headString å¤´éƒ¨æ˜¾ç¤ºçš„å­—ç¬¦ * @param colSum è¯¥æŠ¥è¡¨çš„åˆ—æ•° */ @SuppressWarnings("deprecation") public void createNormalHead(String headString, int colSum) &#123; // è®¾ç½®ç¬¬ä¸€è¡Œ HSSFRow row = sheet.createRow(0); HSSFCell cell = row.createCell(0); row.setHeight((short) 350); // å®šä¹‰å•å…ƒæ ¼ä¸ºå­—ç¬¦ä¸²ç±»åž‹ cell.setCellType(HSSFCell.ENCODING_UTF_16); // è®¾ç½®Excelè¡¨æ ¼æ ‡é¢˜ cell.setCellValue(new HSSFRichTextString(headString)); // æŒ‡å®šåˆå¹¶åŒºåŸŸ sheet.addMergedRegion(new Region(0,(short) 0,0,(short) colSum)); // è®¾ç½®å•å…ƒæ ¼æ ·å¼ HSSFCellStyle cellStyle = wb.createCellStyle(); // æŒ‡å®šå•å…ƒæ ¼å±…ä¸­å¯¹é½ cellStyle.setAlignment(HSSFCellStyle.ALIGN_CENTER); cellStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER); // æŒ‡å®šå•å…ƒæ ¼è‡ªåŠ¨æ¢è¡Œ cellStyle.setWrapText(true); // è®¾ç½®å•å…ƒæ ¼å­—ä½“ HSSFFont font = wb.createFont(); font.setBoldweight(HSSFFont.BOLDWEIGHT_NORMAL); font.setFontName("å¾®è½¯é›…é»‘"); font.setFontHeight((short) 250); cellStyle.setFont(font); cell.setCellStyle(cellStyle); &#125; /** * åˆ›å»ºå•å…ƒæ ¼æ–¹æ³• * * @param wb HSSFWorkbook * @param row HSSFRow * @param col shortåž‹çš„åˆ—ç´¢å¼• * @param align å¯¹é½æ–¹å¼ * @param val åˆ—å€¼ */ public void cteateCell(HSSFWorkbook wb, HSSFRow row, int col, String val) &#123; HSSFCell cell = row.createCell(col); cell.setCellType(HSSFCell.ENCODING_UTF_16); cell.setCellValue(new HSSFRichTextString(val)); HSSFCellStyle cellStyle = wb.createCellStyle(); cellStyle.setAlignment(HSSFCellStyle.ALIGN_CENTER); cellStyle.setVerticalAlignment(HSSFCellStyle.VERTICAL_CENTER); HSSFFont font = wb.createFont(); font.setBoldweight(HSSFFont.BOLDWEIGHT_NORMAL); font.setFontName("å¾®è½¯é›…é»‘"); cellStyle.setFont(font); cell.setCellStyle(cellStyle); &#125; /** * è¾“å…¥EXCELæ–‡ä»¶ * * @param fileName æ–‡ä»¶å */ public void outputExcel(String fileName) &#123; FileOutputStream fos = null; try &#123; fos = new FileOutputStream(new File(fileName)); wb.write(fos); fos.close(); &#125; catch (FileNotFoundException e) &#123; e.printStackTrace(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125;Excelè¡¨æ ¼æ–‡ä»¶ç”Ÿæˆç±»ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566public class ExportExcelClient &#123; // åˆ›å»ºä¸€ä¸ªæ–°çš„Excelå·¥ä½œç°¿ private static HSSFWorkbook wb = new HSSFWorkbook(); // åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œè¡¨ private static HSSFSheet sheet = wb.createSheet(); private static Session session = null; public static void main(String[] args) &#123; ExcelUtil exportExcel = new ExcelUtil(wb, sheet); session = SessionUtil.getSession(); // æŸ¥è¯¢åˆ—å String column_names = "select COLUMN_NAME from USER_TAB_COLS where TABLE_NAME = 'SYS_OBJECT_TYPE'"; List&lt;String&gt; list = session.createSQLQuery(column_names).list(); // åˆ—æ•° Integer column_nums = list.toArray().length; exportExcel.createNormalHead("æŸ¥è¯¢ç»“æžœè¡¨", column_nums - 1); // 1.è®¾ç½®Excelè¡¨è¡¨å¤´ HSSFRow row = sheet.createRow(1); HSSFCellStyle cellStyle = wb.createCellStyle(); // è®¾ç½®è¡¨å¤´èƒŒæ™¯è‰² cellStyle.setFillForegroundColor(HSSFColor.LIGHT_GREEN.index); cellStyle.setFillPattern(HSSFCellStyle.SOLID_FOREGROUND); // è®¾ç½®è¡¨å¤´å­—ä½“ HSSFFont font = wb.createFont(); font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD); font.setFontName("å¾®è½¯é›…é»‘"); cellStyle.setFont(font); // è®¾ç½®è¡¨å¤´åˆ—å for (int i = 0; i &lt; column_nums; i++) &#123; HSSFCell cell = row.createCell((short) i); cell.setCellType(HSSFCell.CELL_TYPE_STRING); cell.setCellValue(list.toArray()[i].toString()); cell.setCellStyle(cellStyle); &#125; // 2.å¡«å€¼ // ç»Ÿè®¡æ€»å…±æœ‰å‡ è¡Œæ•°æ® String count = "select count(*) from SYS_OBJECT_TYPE"; Integer num = Integer.valueOf(session.createSQLQuery(count).uniqueResult().toString()); // æŸ¥è¯¢å‡ºè¡¨æ ¼å†…å®¹ String sql = "select * from SYS_OBJECT_TYPE"; Query q = session.createSQLQuery(sql); @SuppressWarnings("unchecked") List&lt;Object&gt; data = q.list(); // å¾ªçŽ¯å‘Excelè¡¨æ ¼å¡«å……æ•°æ® // æ¯ä¸€è¡Œ for (int i = 2; i &lt; num; i++) &#123; HSSFRow row1 = sheet.createRow((short) i); // æ¯ä¸€åˆ— for (int j = 0; j &lt; column_nums; j++) &#123; ortExcel.cteateCell(wb, row1, (short) j, ((Object[]) data.get(i))[j] == null ? "" :((Object[]) data.get(i))[j].toString()); // è®¾ç½®åˆ—çš„å®½åº¦æ ¹æ®å†…å®¹è‡ªé€‚åº” sheet.autoSizeColumn((short) j); &#125; &#125; String out = new SimpleDateFormat("yyMMddhhmmss").format(new Date()); // 3.è¾“å‡ºxls exportExcel.outputExcel("d:\\æŸ¥è¯¢ç»“æžœ" + out + ".xls"); session.close(); &#125;&#125;æ•ˆæžœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šé™„å½•ä¸€ï¼šç›¸å…³jaråŒ…é“¾æŽ¥:ç™¾åº¦ç½‘ç›˜ å¯†ç ï¼šwow5é™„å½•äºŒï¼šHSSFColoré¢œè‰²å¯¹ç…§è¡¨ï¼š]]></content>
      <tags>
        <tag>POI</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸Šä¼ ä¸‹è½½demo]]></title>
    <url>%2F%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BDdemo.html</url>
    <content type="text"><![CDATA[é™„ä»¶ä¸Šä¼ ä¸‹è½½çš„åŸºæœ¬è¿‡ç¨‹ä¸»è¦åŒ…å«ä¸¤ä¸ªæ­¥éª¤ï¼š1.é€šè¿‡IOæµå°†é™„ä»¶ä¸Šä¼ /ä¸‹è½½åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹å†…ï¼›2.å°†é™„ä»¶å¯¹åº”çš„ä¿¡æ¯ï¼ˆç»è¿‡å¤„ç†åŽçš„é™„ä»¶åï¼Œæ ¼å¼ï¼Œå¤§å°ç­‰ï¼‰ä¿å­˜åˆ°æ•°æ®åº“ã€‚ä¸‹å›¾æ˜¯æ­¤æ¬¡demoçš„æ•ˆæžœå›¾ï¼ˆé»˜è®¤ç”¨æˆ·idä¸º1ï¼‰ï¼šæ•°æ®åº“é™„ä»¶è¡¨SYS_ANNEXï¼š123456789101112 create table SYS_ANNEX ( ANNEX_ID VARCHAR2(20) not null, --é™„ä»¶id AREA_ID NUMBER(5), BUSI_TYPE_ID NUMBER(5), --ä¸šåŠ¡ç±»åž‹idï¼Œè¿™é‡Œæˆ‘ä»¬é»˜è®¤ä¸º1 ANNEX_KEY VARCHAR2(20) not null, NAME VARCHAR2(100) not null, --é™„ä»¶å USER_ID NUMBER(12) not null, --ç”¨æˆ·idï¼Œè¿™é‡Œæˆ‘ä»¬é»˜è®¤ä¸º1 CREATE_DATE DATE not null, --åˆ›å»ºæ—¶é—´ STATE_ID NUMBER(5) not null, STATE_DATE DATE not null, constraint PK_SYS_ANNEX primary key (ANNEX_ID));Sessionå·¥å…·ç±»ï¼Œç”¨æ¥åˆ›å»ºæŸ¥è¯¢ï¼š1234567891011121314public class SessionUtil &#123; private static SessionFactory sf; static&#123; Configuration conf=new Configuration(); conf.configure("hibernate.cfg.xml"); sf=conf.buildSessionFactory(); &#125; public static Session getSession()&#123; return sf.openSession(); &#125; public static SessionFactory getSf()&#123; return sf; &#125;&#125;ä¸Šä¼ æ¨¡å—servletï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152public class UploadHandleServlet extends HttpServlet &#123; public void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; // å¾—åˆ°ä¸Šä¼ æ–‡ä»¶çš„ä¿å­˜ç›®å½•ï¼Œå°†ä¸Šä¼ çš„æ–‡ä»¶å­˜æ”¾äºŽWEB-INFç›®å½•ä¸‹ï¼Œä¸å…è®¸å¤–ç•Œç›´æŽ¥è®¿é—®ï¼Œ // ä¿è¯ä¸Šä¼ æ–‡ä»¶çš„å®‰å…¨ String savePath = this.getServletContext().getRealPath("/WEB-INF/upload"); // ä¸Šä¼ æ—¶ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶ä¿å­˜ç›®å½• String tempPath = this.getServletContext().getRealPath("/WEB-INF/temp"); File tmpFile = new File(tempPath); if (!tmpFile.exists()) &#123; // åˆ›å»ºä¸´æ—¶ç›®å½• tmpFile.mkdir(); &#125; // æ¶ˆæ¯æç¤º String message = ""; try &#123; // ä½¿ç”¨Apacheæ–‡ä»¶ä¸Šä¼ ç»„ä»¶å¤„ç†æ–‡ä»¶ä¸Šä¼ æ­¥éª¤ï¼š // 1ã€åˆ›å»ºä¸€ä¸ªDiskFileItemFactoryå·¥åŽ‚ DiskFileItemFactory factory = new DiskFileItemFactory(); // è®¾ç½®å·¥åŽ‚çš„ç¼“å†²åŒºçš„å¤§å°ï¼Œå½“ä¸Šä¼ çš„æ–‡ä»¶å¤§å°è¶…è¿‡ç¼“å†²åŒºçš„å¤§å°æ—¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ª // ä¸´æ—¶æ–‡ä»¶å­˜æ”¾åˆ°æŒ‡å®šçš„ä¸´æ—¶ç›®å½•å½“ä¸­ã€‚è®¾ç½®ç¼“å†²åŒºçš„å¤§å°ä¸º100KBï¼Œå¦‚æžœä¸æŒ‡å®šï¼Œ // é‚£ä¹ˆç¼“å†²åŒºçš„å¤§å°é»˜è®¤æ˜¯10KB factory.setSizeThreshold(1024 * 100); // è®¾ç½®ä¸Šä¼ æ—¶ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶çš„ä¿å­˜ç›®å½• factory.setRepository(tmpFile); // 2ã€åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ è§£æžå™¨ ServletFileUpload upload=new ServletFileUpload(factory); // è§£å†³ä¸Šä¼ æ–‡ä»¶åçš„ä¸­æ–‡ä¹±ç  upload.setHeaderEncoding("UTF-8"); // 3ã€åˆ¤æ–­æäº¤ä¸Šæ¥çš„æ•°æ®æ˜¯å¦æ˜¯ä¸Šä¼ è¡¨å•çš„æ•°æ® if (!ServletFileUpload.isMultipartContent(request)) &#123; // æŒ‰ç…§ä¼ ç»Ÿæ–¹å¼èŽ·å–æ•°æ® return; &#125; // è®¾ç½®ä¸Šä¼ å•ä¸ªæ–‡ä»¶çš„å¤§å°çš„æœ€å¤§å€¼ï¼Œç›®å‰æ˜¯è®¾ç½®ä¸º1024*1024*100å­—èŠ‚ï¼Œ // ä¹Ÿå°±æ˜¯100MB upload.setFileSizeMax(1024 * 1024 * 100); // è®¾ç½®ä¸Šä¼ æ–‡ä»¶æ€»é‡çš„æœ€å¤§å€¼ï¼Œæœ€å¤§å€¼=åŒæ—¶ä¸Šä¼ çš„å¤šä¸ªæ–‡ä»¶çš„å¤§å°çš„ // æœ€å¤§å€¼çš„å’Œï¼Œç›®å‰è®¾ç½®ä¸º1000MB upload.setSizeMax(1024 * 1024 * 1000); // 4ã€ä½¿ç”¨ServletFileUploadè§£æžå™¨è§£æžä¸Šä¼ æ•°æ®ï¼Œè§£æžç»“æžœè¿”å›žçš„ // æ˜¯ä¸€ä¸ªList&lt;FileItem&gt;é›†åˆï¼Œæ¯ä¸€ä¸ªFileItemå¯¹åº”ä¸€ä¸ªFormè¡¨å•çš„ // è¾“å…¥é¡¹ List&lt;FileItem&gt; list = upload.parseRequest(request); for (FileItem item : list) &#123; // å¦‚æžœfileitemä¸­å°è£…çš„æ˜¯æ™®é€šè¾“å…¥é¡¹çš„æ•°æ® if (item.isFormField()) &#123; String name = item.getFieldName(); // è§£å†³æ™®é€šè¾“å…¥é¡¹çš„æ•°æ®çš„ä¸­æ–‡ä¹±ç é—®é¢˜ String value = item.getString("UTF-8"); &#125; else &#123;// å¦‚æžœfileitemä¸­å°è£…çš„æ˜¯ä¸Šä¼ æ–‡ä»¶ // å¾—åˆ°ä¸Šä¼ çš„æ–‡ä»¶åç§°ï¼Œ String filename = item.getName(); System.out.println(filename); if (filename == null || filename.trim().equals("")) &#123; continue; &#125; // æ³¨æ„ï¼šä¸åŒçš„æµè§ˆå™¨æäº¤çš„æ–‡ä»¶åæ˜¯ä¸ä¸€æ ·çš„ï¼Œæœ‰äº›æµè§ˆå™¨æäº¤ä¸Šæ¥çš„ // æ–‡ä»¶åæ˜¯å¸¦æœ‰è·¯å¾„çš„ï¼Œå¦‚ï¼š c:\a\b\1.txtï¼Œè€Œæœ‰äº›åªæ˜¯å•çº¯çš„æ–‡ä»¶åï¼Œ // å¦‚ï¼š1.txtï¼Œå¤„ç†èŽ·å–åˆ°çš„ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶åçš„è·¯å¾„éƒ¨åˆ†ï¼Œåªä¿ç•™æ–‡ä»¶ // åéƒ¨åˆ† filename = filename.substring(filename.lastIndexOf("\\") + 1); // å¾—åˆ°ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å String fileExtName = filename.substring(filename.lastIndexOf(".") + 1); // å¦‚æžœéœ€è¦é™åˆ¶ä¸Šä¼ çš„æ–‡ä»¶ç±»åž‹ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡æ–‡ä»¶çš„æ‰©å±•åæ¥åˆ¤æ–­ä¸Šä¼ çš„ // æ–‡ä»¶ç±»åž‹æ˜¯å¦åˆæ³• System.out.println( "ä¸Šä¼ çš„æ–‡ä»¶çš„æ‰©å±•åæ˜¯ï¼š" + fileExtName); // èŽ·å–itemä¸­çš„ä¸Šä¼ æ–‡ä»¶çš„è¾“å…¥æµ InputStream in = item.getInputStream(); // å¾—åˆ°æ–‡ä»¶ä¿å­˜çš„åç§° String saveFilename = makeFileName(filename); // å¾—åˆ°æ–‡ä»¶çš„ä¿å­˜ç›®å½• String realSavePath = savePath; // åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è¾“å‡ºæµ FileOutputStream out = new FileOutputStream(realSavePath+ "\\"+ saveFilename); // åˆ›å»ºä¸€ä¸ªç¼“å†²åŒº byte buffer[] = new byte[1024]; // åˆ¤æ–­è¾“å…¥æµä¸­çš„æ•°æ®æ˜¯å¦å·²ç»è¯»å®Œçš„æ ‡è¯† int len = 0; // å¾ªçŽ¯å°†è¾“å…¥æµè¯»å…¥åˆ°ç¼“å†²åŒºå½“ä¸­ï¼Œ(len=in.read(buffer))&gt;0å°± // è¡¨ç¤ºiné‡Œé¢è¿˜æœ‰æ•°æ® while ((len = in.read(buffer)) &gt; 0) &#123; // ä½¿ç”¨FileOutputStreamè¾“å‡ºæµå°†ç¼“å†²åŒºçš„æ•°æ®å†™å…¥åˆ°æŒ‡å®šçš„ // ç›®å½•(savePath + "\\"+ filename)ä¸­ out.write(buffer, 0, len); &#125; // å…³é—­è¾“å…¥æµ in.close(); // å…³é—­è¾“å‡ºæµ out.close(); // åˆ é™¤å¤„ç†æ–‡ä»¶ä¸Šä¼ æ—¶ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶ item.delete(); message = "æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼"; // æ–‡ä»¶ä¸Šä¼ æˆåŠŸåŽï¼Œå°†å¯¹åº”çš„ä¿¡æ¯ä¿å­˜åˆ°æ•°æ®åº“SYS_ANNEXè¡¨ Integer userId = Integer.valueOf(request.getParameter("userId")); Date date = new Date(System.currentTimeMillis()); String annexId = System.currentTimeMillis() + ""; String annexKey = userId + ""; Session session = SessionUtil.getSession(); String sql = "insert INTO SYS_ANNEX VALUES(ANNEX_SEQ.nextval,"; sql+="1,1,?,?,?,sysdate,1,sysdate)"; SQLQuery query = session.createSQLQuery(sql); query.setString(0, annexKey); query.setString(1, saveFilename); query.setInteger(2, userId); Transaction ts = session.beginTransaction(); try &#123; query.executeUpdate(); ts.commit(); System.out.println("æ’å…¥æˆåŠŸ"); &#125; catch (HibernateException e) &#123; e.printStackTrace(); ts.rollback(); System.out.println("æ’å…¥å¤±è´¥"); &#125; finally &#123; session.close(); &#125; &#125; &#125; &#125; catch (FileUploadBase .FileSizeLimitExceededException e) &#123; e.printStackTrace(); request.setAttribute( "message", "å•ä¸ªæ–‡ä»¶è¶…å‡ºæœ€å¤§å€¼ï¼"); return; &#125; catch (FileUploadBase.SizeLimitExceededException e) &#123; e.printStackTrace(); request.setAttribute( "message","ä¸Šä¼ æ–‡ä»¶çš„æ€»å¤§å°è¶…å‡ºé™åˆ¶çš„æœ€å¤§å€¼ï¼"); return; &#125; catch (Exception e) &#123; message = "æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼"; e.printStackTrace(); &#125; request.setAttribute("message", message); &#125; /** * @Method: makeFileName * @Description: ç”Ÿæˆä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶åï¼Œæ–‡ä»¶åä»¥ï¼šuuid+"_"+æ–‡ä»¶çš„åŽŸå§‹åç§° * @param filenameæ–‡ä»¶çš„åŽŸå§‹åç§° * @return uuid+"_"+æ–‡ä»¶çš„åŽŸå§‹åç§° */ private String makeFileName(String filename) &#123; // ä¸ºé˜²æ­¢æ–‡ä»¶è¦†ç›–çš„çŽ°è±¡å‘ç”Ÿï¼Œè¦ä¸ºä¸Šä¼ æ–‡ä»¶äº§ç”Ÿä¸€ä¸ªå”¯ä¸€çš„æ–‡ä»¶å return UUID.randomUUID().toString() + "_" + filename; &#125; &#125;å±•ç¤ºå½“å‰ï¼ˆç”¨æˆ·idä¸º1ï¼Œä¸šåŠ¡ç±»åž‹idä¸º1ï¼‰çš„æ‰€æœ‰é™„ä»¶çš„servletï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859public class ListFileServlet extends HttpServlet &#123; public void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; Integer userId = Integer.valueOf(request.getParameter("userId")); Integer busiTypeId = Integer.valueOf(request.getParameter("busiTypeId")); // èŽ·å–ä¸Šä¼ æ–‡ä»¶çš„ç›®å½• String uploadFilePath = this.getServletContext() .getRealPath("/WEB-INF/upload"); // å­˜å‚¨è¦ä¸‹è½½çš„æ–‡ä»¶å Map&lt;String, String&gt; fileNameMap = new HashMap&lt;String, String&gt;(); // é€’å½’éåŽ†filepathç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ï¼Œå°†æ–‡ä»¶çš„æ–‡ä»¶åå­˜å‚¨åˆ°mapé›†åˆä¸­ listfile(new File(uploadFilePath),fileNameMap,userId,busiTypeId); // Fileæ—¢å¯ä»¥ä»£è¡¨ä¸€ä¸ªæ–‡ä»¶ä¹Ÿå¯ä»¥ä»£è¡¨ä¸€ä¸ªç›®å½• Iterator&lt;Map.Entry&lt;String, String&gt;&gt; it = fileNameMap.entrySet().iterator(); while (it.hasNext()) &#123; Map.Entry&lt;String, String&gt; entry = it.next(); &#125; // å°†Mapé›†åˆå‘é€åˆ°listfile.jspé¡µé¢è¿›è¡Œæ˜¾ç¤º request.setAttribute("fileNameMap", fileNameMap); request.getRequestDispatcher("/listfile.jsp").forward(request, response); &#125; /** * @Method: listfile * @Description: é€’å½’éåŽ†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ * @param fileï¼šå³ä»£è¡¨ä¸€ä¸ªæ–‡ä»¶ï¼Œä¹Ÿä»£è¡¨ä¸€ä¸ªæ–‡ä»¶ç›®å½• * @param mapï¼šå­˜å‚¨æ–‡ä»¶åçš„Mapé›†åˆ */ public void listfile(File file, Map&lt;String, String&gt; map,Integer userId, Integer busiTypeId)&#123; Session session = SessionUtil.getSession(); String sql = "select name from SYS_ANNEX where user_id=?" sql += "and busi_type_id=?"; SQLQuery query = session.createSQLQuery(sql); query.setInteger(0, userId); query.setInteger(1, busiTypeId); List&lt;String&gt; list = query.list(); for (String fileName : list) &#123; /** * å¤„ç†æ–‡ä»¶åï¼Œä¸Šä¼ åŽçš„æ–‡ä»¶æ˜¯ä»¥uuid_æ–‡ä»¶åçš„å½¢å¼åŽ»é‡æ–°å‘½ * åçš„ï¼ŒåŽ»é™¤æ–‡ä»¶åçš„uuid_éƒ¨åˆ†file.getName().indexOf("_") * æ£€ç´¢å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºçŽ°"_"å­—ç¬¦çš„ä½ç½®ï¼Œå¦‚æžœæ–‡ä»¶å * ç±»ä¼¼äºŽï¼š9349249849-88343-8344_å¤šå•¦Aæ¢¦.avié‚£ä¹ˆ * file.getName().substring(file.getName().indexOf("_")+1) * å¤„ç†ä¹‹åŽå°±å¯ä»¥å¾—åˆ°å¤šå•¦Aæ¢¦.aviéƒ¨åˆ† */ String realName = fileName.substring(fileName.indexOf("_") + 1); // file.getName()å¾—åˆ°çš„æ˜¯æ–‡ä»¶çš„åŽŸå§‹åç§°ï¼Œè¿™ä¸ªåç§°æ˜¯ // å”¯ä¸€çš„ï¼Œå› æ­¤å¯ä»¥ä½œä¸ºkeyï¼ŒrealNameæ˜¯å¤„ç†è¿‡åŽçš„åç§°ï¼Œ // æœ‰å¯èƒ½ä¼šé‡å¤ map.put(fileName, realName); &#125; session.close(); &#125; &#125;ä¸‹è½½servletï¼š12345678910111213141516171819202122232425262728293031323334353637383940public class DownLoadServlet extends HttpServlet &#123; public void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; // å¾—åˆ°è¦ä¸‹è½½çš„æ–‡ä»¶å String fileName = request.getParameter("filename"); // ä¸Šä¼ çš„æ–‡ä»¶éƒ½æ˜¯ä¿å­˜åœ¨/WEB-INF/uploadç›®å½•ä¸‹çš„å­ç›®å½•å½“ä¸­ String fileSaveRootPath = this.getServletContext() .getRealPath("/WEB-INF/upload"); // é€šè¿‡æ–‡ä»¶åæ‰¾å‡ºæ–‡ä»¶çš„æ‰€åœ¨ç›®å½• String path = fileSaveRootPath; // å¾—åˆ°è¦ä¸‹è½½çš„æ–‡ä»¶ File file = new File(path + "\\" + fileName); // å¦‚æžœæ–‡ä»¶ä¸å­˜åœ¨ if (!file.exists()) &#123; request.setAttribute("message", "æ‚¨è¦ä¸‹è½½çš„èµ„æºå·²è¢«åˆ é™¤ï¼"); return; &#125; // å¤„ç†æ–‡ä»¶å String realname = fileName.substring(fileName.indexOf("_") + 1); // è®¾ç½®å“åº”å¤´ï¼ŒæŽ§åˆ¶æµè§ˆå™¨ä¸‹è½½è¯¥æ–‡ä»¶ response.setHeader("content-disposition", "attachment;filename=" + URLEncoder.encode(realname, "UTF-8")); // è¯»å–è¦ä¸‹è½½çš„æ–‡ä»¶ï¼Œä¿å­˜åˆ°æ–‡ä»¶è¾“å…¥æµ FileInputStream in = new FileInputStream(path + "\\" + fileName); // åˆ›å»ºè¾“å‡ºæµ OutputStream out = response.getOutputStream(); // åˆ›å»ºç¼“å†²åŒº byte buffer[] = new byte[1024]; int len = 0; // å¾ªçŽ¯å°†è¾“å…¥æµä¸­çš„å†…å®¹è¯»å–åˆ°ç¼“å†²åŒºå½“ä¸­ while ((len = in.read(buffer)) &gt; 0) &#123; // è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹åˆ°æµè§ˆå™¨ï¼Œå®žçŽ°æ–‡ä»¶ä¸‹è½½ out.write(buffer, 0, len); &#125; // å…³é—­æ–‡ä»¶è¾“å…¥æµ in.close(); // å…³é—­è¾“å‡ºæµ out.close(); &#125;&#125;åˆ é™¤servletï¼š123456789101112131415161718192021222324252627282930313233343536public class DeleteFileServlet extends HttpServlet&#123; @Override protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123; //èŽ·å–æ–‡ä»¶å String fileName = request.getParameter("fileName"); // æ•°æ®åº“åˆ é™¤è®°å½• Session session=SessionUtil.getSession(); String sql="delete from SYS_ANNEX where name=?"; SQLQuery query=session.createSQLQuery(sql); query.setString(0,fileName); Transaction ts=session.beginTransaction(); try&#123; query.executeUpdate(); ts.commit(); &#125;catch(HibernateException e)&#123; e.printStackTrace(); ts.rollback(); return; &#125;finally&#123; session.close(); &#125; // æ•°æ®åº“æˆåŠŸåˆ é™¤è®°å½•åŽï¼Œå†ä»Žç¡¬ç›˜é‡Œåˆ é™¤æ–‡ä»¶ //ä¸Šä¼ çš„æ–‡ä»¶éƒ½æ˜¯ä¿å­˜åœ¨/WEB-INF/uploadç›®å½•ä¸‹çš„å­ç›®å½•å½“ä¸­ String fileSaveRootPath = this.getServletContext() .getRealPath("/WEB-INF/upload"); //é€šè¿‡æ–‡ä»¶åæ‰¾å‡ºæ–‡ä»¶çš„æ‰€åœ¨ç›®å½• String path = fileSaveRootPath; //å¾—åˆ°è¦åˆ é™¤çš„æ–‡ä»¶ File file = new File(path + "\\" + fileName); //åˆ é™¤æ–‡ä»¶ file.delete(); &#125;&#125;ä¸Šä¼ é¡µé¢upload.jspï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111&lt;%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%&gt;&lt;%@taglib prefix="c_rt" uri="http://java.sun.com/jstl/core_rt" %&gt; &lt;!DOCTYPE HTML&gt; &lt;html&gt; &lt;style&gt; table&#123; margin:auto; &#125; &lt;/style&gt; &lt;head&gt; &lt;title&gt;æ–‡ä»¶ä¸Šä¼ &lt;/title&gt; &lt;script type="text/javascript" src="js/jquery.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; $(function()&#123; //é¡µé¢ä¸€åŠ è½½è°ƒç”¨onLoad()å‡½æ•°è¯»å–é™„ä»¶ onLoad(); $("#submit").click(function()&#123; //å°†formè¡¨å•é™„ä»¶æ ¼å¼åŒ– var formData = new FormData($("#form")[0]); var userId=$("#userId").val().trim(); var location="http://localhost:8080/file/servlet/"; location+="UploadHandleServlet?userId="+userId; $.ajax(&#123; //è°ƒç”¨ä¸Šä¼ servlet url:location, type:"post", data:formData, async: false, cache: false, contentType: false, processData: false, success:function()&#123; //æˆåŠŸåŽæ¸…é™¤ä¸Šä¼ é™„ä»¶æ¨¡å—å†…å®¹ $("#file").empty(); AddMore(); //è°ƒç”¨onLoad()å‡½æ•°ï¼Œåˆ·æ–° onLoad(); &#125; &#125;); &#125;); //onLoad()å‡½æ•°è°ƒç”¨listfileServlet,è¯»å–å½“å‰ç”¨æˆ·ä¸‹çš„æ‰€æœ‰é™„ä»¶ function onLoad()&#123; $.ajax(&#123; url:"http://localhost:8080/file/listfile", type:"post", //æ¨¡æ‹Ÿç”¨æˆ·idä¸º1ï¼Œä¸šåŠ¡ç±»åž‹idä¸º1 data:&#123;"userId":1,"busiTypeId":1&#125;, success:function(fileNameMap)&#123; //å°†è¯»å–åˆ°çš„fileMapå±•ç¤ºå‡ºæ¥ $("#fileLoad").html(fileNameMap); &#125; &#125;); &#125;&#125;); &lt;/script&gt; &lt;script type="text/javascript"&gt; function AddMore()&#123; var more = document.getElementById("file"); var br = document.createElement("br"); var input = document.createElement("input"); var button = document.createElement("input"); input.type = "file"; input.name = "file"; input.id="file"; button.type = "button"; button.value = "åˆ é™¤"; more.appendChild(input); more.appendChild(button); more.appendChild(br); button.onclick = function()&#123; more.removeChild(br); more.removeChild(input); more.removeChild(button); &#125;;&#125; &lt;/script&gt; &lt;/head&gt; &lt;body &gt; &lt;form action="http://localhost:8080/file/servlet/UploadHandleServlet" enctype="multipart/form-data" method="post" id="form"&gt; &lt;table border="1" &gt; &lt;tr&gt; &lt;td&gt;ç”¨æˆ·ID:&lt;/td&gt; &lt;td&gt;&lt;input type="text" name="userId" id="userId" value="1"/&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;é™„ä»¶:&lt;/td&gt; &lt;td id="file"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td colspan="2" align="center"&gt; &lt;input type="button" value="å¢žåŠ é™„ä»¶" onclick="AddMore()"&gt; &lt;input type="button" value="æäº¤" id="submit"&gt; &lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;é™„ä»¶ä¸‹è½½:&lt;/td&gt; &lt;td id="fileLoad"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/form&gt; &lt;script type="text/javascript"&gt; AddMore(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;å±•ç¤ºé¡µé¢listfile.jspï¼Œä¾›ajaxè°ƒç”¨ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&lt;%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%&gt;&lt;%@taglib prefix="c_rt" uri="http://java.sun.com/jstl/core_rt" %&gt;&lt;!DOCTYPE HTML&gt;&lt;html&gt;&lt;style&gt; #method &#123; float:right; margin-right:2px; &#125;&lt;/style&gt;&lt;script type="text/javascript"&gt; $(function()&#123; //åˆ é™¤ $(".delete").click(function()&#123; var name=$(this).attr("name"); var location="http://localhost:8080/file/servlet/DeleteFileServlet"; $.ajax(&#123; url:location, type:"post", data:&#123;"fileName":name&#125;, success:function()&#123; onLoad(); &#125; &#125;); &#125;); function onLoad()&#123; $.ajax(&#123; url:"http://localhost:8080/file/listfile", type:"post", data:&#123;"userId":1,"busiTypeId":1&#125;, success:function(fileNameMap)&#123; $("#fileLoad").html(fileNameMap); &#125; &#125;); &#125;&#125;); &lt;/script&gt;&lt;head&gt; &lt;title&gt;ä¸‹è½½æ–‡ä»¶é¡µé¢ï¼Œä¾›ajaxè¿”å›žè°ƒç”¨&lt;/title&gt;&lt;/head&gt; &lt;body&gt;&lt;!-- éåŽ†fileNameMapé›†åˆ --&gt;&lt;c_rt:forEach var="me" items="$&#123;fileNameMap&#125;"&gt; &lt;c_rt:url value="/servlet/DownLoadServlet" var="downurl"&gt; &lt;c_rt:param name="filename" value="$&#123;me.key&#125;"&gt;&lt;/c_rt:param&gt; &lt;/c_rt:url&gt; &lt;c_rt:url value="/servlet/DeleteFileServlet" var="deleteurl"&gt; &lt;c_rt:param name="filename" value="$&#123;me.key&#125;"&gt;&lt;/c_rt:param&gt; &lt;/c_rt:url&gt; $&#123;me.value&#125; &lt;span id="method"&gt; &lt;a href="$&#123;downurl&#125;" id="downLoad"&gt;ä¸‹è½½&lt;/a&gt; &lt;a href="javascript:void(0)" class="delete" name="$&#123;me.key&#125;"&gt;åˆ é™¤&lt;/a&gt; &lt;/span&gt;&lt;br/&gt;&lt;/c_rt:forEach&gt;&lt;/body&gt;&lt;/html&gt;å‰©ä¸‹çš„åªéœ€åœ¨web.xmlä¸­é…ç½®è¿™å‡ ä¸ªservletï¼Œä»¥åŠé…ç½®hibernate.cfg.xmlå³å¯ ã€‚jaråŒ…ï¼šé“¾æŽ¥:ç™¾åº¦ç½‘ç›˜ å¯†ç ï¼šq75g]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracleæ ‘æŸ¥è¯¢]]></title>
    <url>%2FOracle%E6%A0%91%E6%9F%A5%E8%AF%A2.html</url>
    <content type="text"><![CDATA[oracleæ ‘æŸ¥è¯¢çš„æœ€é‡è¦çš„å°±æ˜¯selectâ€¦start withâ€¦connect byâ€¦priorè¯­æ³•äº†ã€‚ä¾æ‰˜äºŽè¯¥è¯­æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªè¡¨å½¢ç»“æž„çš„ä»¥æ ‘çš„é¡ºåºåˆ—å‡ºæ¥ã€‚åœ¨ä¸‹é¢åˆ—è¿°äº†oracleä¸­æ ‘åž‹æŸ¥è¯¢çš„å¸¸ç”¨æŸ¥è¯¢æ–¹å¼ä»¥åŠç»å¸¸ä½¿ç”¨çš„ä¸Žæ ‘æŸ¥è¯¢ç›¸å…³çš„oracleç‰¹æ€§å‡½æ•°ç­‰ï¼Œåœ¨è¿™é‡Œåªæ¶‰åŠåˆ°ä¸€å¼ è¡¨ä¸­çš„æ ‘æŸ¥è¯¢æ–¹å¼è€Œä¸æ¶‰åŠå¤šè¡¨ä¸­çš„å…³è”ç­‰ã€‚1.å‡†å¤‡æµ‹è¯•è¡¨å’Œæµ‹è¯•æ•°æ®ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162--èœå•ç›®å½•ç»“æž„è¡¨create table tb_menu( id number(10) not null, --ä¸»é”®id title varchar2(50), --æ ‡é¢˜ parent number(10) --parent id) --çˆ¶èœå•insert into tb_menu(id, title, parent) values(1, 'çˆ¶èœå•1',0);insert into tb_menu(id, title, parent) values(2, 'çˆ¶èœå•2',0);insert into tb_menu(id, title, parent) values(3, 'çˆ¶èœå•3',0);insert into tb_menu(id, title, parent) values(4, 'çˆ¶èœå•4',0);insert into tb_menu(id, title, parent) values(5, 'çˆ¶èœå•5',0);--ä¸€çº§èœå•insert into tb_menu(id, title, parent) values(6, 'ä¸€çº§èœå•6',1);insert into tb_menu(id, title, parent) values(7, 'ä¸€çº§èœå•7',1);insert into tb_menu(id, title, parent) values(8, 'ä¸€çº§èœå•8',1);insert into tb_menu(id, title, parent) values(9, 'ä¸€çº§èœå•9',2);insert into tb_menu(id, title, parent) values(10, 'ä¸€çº§èœå•10',2);insert into tb_menu(id, title, parent) values(11, 'ä¸€çº§èœå•11',2);insert into tb_menu(id, title, parent) values(12, 'ä¸€çº§èœå•12',3);insert into tb_menu(id, title, parent) values(13, 'ä¸€çº§èœå•13',3);insert into tb_menu(id, title, parent) values(14, 'ä¸€çº§èœå•14',3);insert into tb_menu(id, title, parent) values(15, 'ä¸€çº§èœå•15',4);insert into tb_menu(id, title, parent) values(16, 'ä¸€çº§èœå•16',4);insert into tb_menu(id, title, parent) values(17, 'ä¸€çº§èœå•17',4);insert into tb_menu(id, title, parent) values(18, 'ä¸€çº§èœå•18',5);insert into tb_menu(id, title, parent) values(19, 'ä¸€çº§èœå•19',5);insert into tb_menu(id, title, parent) values(20, 'ä¸€çº§èœå•20',5);--äºŒçº§èœå•insert into tb_menu(id, title, parent) values(21, 'äºŒçº§èœå•21',6);insert into tb_menu(id, title, parent) values(22, 'äºŒçº§èœå•22',6);insert into tb_menu(id, title, parent) values(23, 'äºŒçº§èœå•23',7);insert into tb_menu(id, title, parent) values(24, 'äºŒçº§èœå•24',7);insert into tb_menu(id, title, parent) values(25, 'äºŒçº§èœå•25',8);insert into tb_menu(id, title, parent) values(26, 'äºŒçº§èœå•26',9);insert into tb_menu(id, title, parent) values(27, 'äºŒçº§èœå•27',10);insert into tb_menu(id, title, parent) values(28, 'äºŒçº§èœå•28',11);insert into tb_menu(id, title, parent) values(29, 'äºŒçº§èœå•29',12);insert into tb_menu(id, title, parent) values(30, 'äºŒçº§èœå•30',13);insert into tb_menu(id, title, parent) values(31, 'äºŒçº§èœå•31',14);insert into tb_menu(id, title, parent) values(32, 'äºŒçº§èœå•32',15);insert into tb_menu(id, title, parent) values(33, 'äºŒçº§èœå•33',16);insert into tb_menu(id, title, parent) values(34, 'äºŒçº§èœå•34',17);insert into tb_menu(id, title, parent) values(35, 'äºŒçº§èœå•35',18);insert into tb_menu(id, title, parent) values(36, 'äºŒçº§èœå•36',19);insert into tb_menu(id, title, parent) values(37, 'äºŒçº§èœå•37',20);--ä¸‰çº§èœå•insert into tb_menu(id, title, parent) values(38, 'ä¸‰çº§èœå•38',21);insert into tb_menu(id, title, parent) values(39, 'ä¸‰çº§èœå•39',22);insert into tb_menu(id, title, parent) values(40, 'ä¸‰çº§èœå•40',23);insert into tb_menu(id, title, parent) values(41, 'ä¸‰çº§èœå•41',24);insert into tb_menu(id, title, parent) values(42, 'ä¸‰çº§èœå•42',25);insert into tb_menu(id, title, parent) values(43, 'ä¸‰çº§èœå•43',26);insert into tb_menu(id, title, parent) values(44, 'ä¸‰çº§èœå•44',27);insert into tb_menu(id, title, parent) values(45, 'ä¸‰çº§èœå•45',28);insert into tb_menu(id, title, parent) values(46, 'ä¸‰çº§èœå•46',28);insert into tb_menu(id, title, parent) values(47, 'ä¸‰çº§èœå•47',29);insert into tb_menu(id, title, parent) values(48, 'ä¸‰çº§èœå•48',30);insert into tb_menu(id, title, parent) values(49, 'ä¸‰çº§èœå•49',31);insert into tb_menu(id, title, parent) values(50, 'ä¸‰çº§èœå•50',31);commit;parentå­—æ®µå­˜å‚¨çš„æ˜¯ä¸Šçº§idï¼Œå¦‚æžœæ˜¯é¡¶çº§çˆ¶èŠ‚ç‚¹ï¼Œè¯¥parentä¸º0ã€‚2.æ ‘æ“ä½œæˆ‘ä»¬ä»Žæœ€åŸºæœ¬çš„æ“ä½œï¼Œé€æ­¥åˆ—å‡ºæ ‘æŸ¥è¯¢ä¸­å¸¸è§çš„æ“ä½œï¼Œæ‰€æœ‰æŸ¥è¯¢å‡ºæ¥çš„èŠ‚ç‚¹ä»¥å®¶æ—ä¸­çš„è¾ˆä»½ä½œæ¯”æ–¹ã€‚æŸ¥æ‰¾æ ‘ä¸­çš„æ‰€æœ‰é¡¶çº§çˆ¶èŠ‚ç‚¹å‡è®¾è¿™ä¸ªæ ‘æ˜¯ä¸ªç›®å½•ç»“æž„ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªæ“ä½œæ€»æ˜¯æ‰¾å‡ºæ‰€æœ‰çš„é¡¶çº§èŠ‚ç‚¹ï¼Œå†æ ¹æ®è¯¥èŠ‚ç‚¹æ‰¾åˆ°å…¶ä¸‹å±žèŠ‚ç‚¹ã€‚123456789SQL&gt; select * from tb_menu m where m.parent=0; ID TITLE PARENT---------- -------------------------------------------------- ---------- 1 çˆ¶èœå•1 0 2 çˆ¶èœå•2 0 3 çˆ¶èœå•3 0 4 çˆ¶èœå•4 0 5 çˆ¶èœå•5 0æŸ¥æ‰¾ä¸€ä¸ªèŠ‚ç‚¹çš„ç›´å±žå­èŠ‚ç‚¹å¦‚æžœæŸ¥æ‰¾çš„æ˜¯ç›´å±žå­ç±»èŠ‚ç‚¹ï¼Œä¹Ÿæ˜¯ä¸ç”¨ç”¨åˆ°æ ‘åž‹æŸ¥è¯¢çš„ã€‚1234567SQL&gt; select * from tb_menu m where m.parent=1; ID TITLE PARENT---------- -------------------------------------------------- ---------- 6 ä¸€çº§èœå•6 1 7 ä¸€çº§èœå•7 1 8 ä¸€çº§èœå•8 1æŸ¥æ‰¾ä¸€ä¸ªèŠ‚ç‚¹æ‰€æœ‰ç›´å±žå­èŠ‚ç‚¹1234567891011121314151617181920SQL&gt; select * from tb_menu m start with m.id=1 connect by m.parent=prior m.id; ID TITLE PARENT---------- -------------------------------------------------- ---------- 1 çˆ¶èœå•1 0 6 ä¸€çº§èœå•6 1 21 äºŒçº§èœå•21 6 38 ä¸‰çº§èœå•38 21 22 äºŒçº§èœå•22 6 39 ä¸‰çº§èœå•39 22 7 ä¸€çº§èœå•7 1 23 äºŒçº§èœå•23 7 40 ä¸‰çº§èœå•40 23 24 äºŒçº§èœå•24 7 41 ä¸‰çº§èœå•41 24 8 ä¸€çº§èœå•8 1 25 äºŒçº§èœå•25 8 42 ä¸‰çº§èœå•42 25 å·²é€‰æ‹©14è¡Œã€‚è¿™ä¸ªæŸ¥æ‰¾çš„æ˜¯idä¸º1çš„èŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰ç›´å±žå­ç±»èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬å­è¾ˆçš„å’Œå­™å­è¾ˆçš„æ‰€æœ‰ç›´å±žèŠ‚ç‚¹ã€‚æŸ¥æ‰¾ä¸€ä¸ªèŠ‚ç‚¹çš„ç›´å±žçˆ¶èŠ‚ç‚¹å¦‚æžœæŸ¥æ‰¾çš„æ˜¯èŠ‚ç‚¹çš„ç›´å±žçˆ¶èŠ‚ç‚¹ï¼Œä¹Ÿæ˜¯ä¸ç”¨ç”¨åˆ°æ ‘åž‹æŸ¥è¯¢çš„ã€‚12345678910111213141516SQL&gt;SELECT c. ID, c.title, P . ID parent_id, P .title parent_titleFROM tb_menu c, tb_menu PWHERE c. PARENT = P . IDAND c. ID = 6; ID TITLE PARENT_ID PARENT_TITLE---------- --------------------- ---------- --------------------------- 6 ä¸€çº§èœå•6 1 çˆ¶èœå•1æŸ¥æ‰¾ä¸€ä¸ªèŠ‚ç‚¹æ‰€æœ‰ç›´å±žçˆ¶èŠ‚ç‚¹12345678SQL&gt; select * from tb_menu m start with m.id=38 connect by prior m.parent=m.id; ID TITLE PARENT---------- -------------------------------------------------- ---------- 38 ä¸‰çº§èœå•38 21 21 äºŒçº§èœå•21 6 6 ä¸€çº§èœå•6 1 1 çˆ¶èœå•1 0è¿™é‡ŒæŸ¥æ‰¾çš„å°±æ˜¯idä¸º1çš„æ‰€æœ‰ç›´å±žçˆ¶èŠ‚ç‚¹ï¼Œæ‰“ä¸ªæ¯”æ–¹å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªäººçš„çˆ¶äº²ã€ç¥–çˆ¶ç­‰ã€‚ä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ä¸ªæŸ¥è¯¢å‡ºæ¥çš„ç»“æžœçš„é¡ºåºæ˜¯å…ˆåˆ—å‡ºå­ç±»èŠ‚ç‚¹å†åˆ—å‡ºçˆ¶ç±»èŠ‚ç‚¹ï¼Œå§‘ä¸”è®¤ä¸ºæ˜¯ä¸ªå€’åºå§ã€‚ä¸Šé¢åˆ—å‡ºä¸¤ä¸ªæ ‘åž‹æŸ¥è¯¢æ–¹å¼ï¼Œç¬¬3æ¡è¯­å¥å’Œç¬¬5æ¡è¯­å¥ï¼Œè¿™ä¸¤æ¡è¯­å¥ä¹‹é—´çš„åŒºåˆ«åœ¨äºŽpriorå…³é”®å­—çš„ä½ç½®ä¸åŒï¼Œæ‰€ä»¥å†³å®šäº†æŸ¥è¯¢çš„æ–¹å¼ä¸åŒã€‚ å½“parent = prior idæ—¶ï¼Œæ•°æ®åº“ä¼šæ ¹æ®å½“å‰çš„idè¿­ä»£å‡ºparentä¸Žè¯¥idç›¸åŒçš„è®°å½•ï¼Œæ‰€ä»¥æŸ¥è¯¢çš„ç»“æžœæ˜¯è¿­ä»£å‡ºäº†æ‰€æœ‰çš„å­ç±»è®°å½•ï¼›è€Œprior parent = idæ—¶ï¼Œæ•°æ®åº“ä¼šè·Ÿæ®å½“å‰çš„parentæ¥è¿­ä»£å‡ºä¸Žå½“å‰çš„parentç›¸åŒçš„idçš„è®°å½•ï¼Œæ‰€ä»¥æŸ¥è¯¢å‡ºæ¥çš„ç»“æžœå°±æ˜¯æ‰€æœ‰çš„çˆ¶ç±»ç»“æžœã€‚ä»¥ä¸‹æ˜¯ä¸€ç³»åˆ—é’ˆå¯¹æ ‘ç»“æž„çš„æ›´æ·±å±‚æ¬¡çš„æŸ¥è¯¢ï¼Œè¿™é‡Œçš„æŸ¥è¯¢ä¸ä¸€å®šæ˜¯æœ€ä¼˜çš„æŸ¥è¯¢æ–¹å¼ï¼Œæˆ–è®¸åªæ˜¯å…¶ä¸­çš„ä¸€ç§å®žçŽ°è€Œå·²ã€‚æŸ¥è¯¢ä¸€ä¸ªèŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹12345678910111213141516171819202122--m.parent=m2.parent--&gt;åŒä¸€ä¸ªçˆ¶äº²SQL&gt; SELECT * FROM tb_menu MWHERE EXISTS ( SELECT * FROM tb_menu m2 WHERE M . PARENT = m2. PARENT AND m2. ID = 6 ); ID TITLE PARENT---------- -------------------------------------------------- ---------- 8 ä¸€çº§èœå•8 1 7 ä¸€çº§èœå•7 1 6 ä¸€çº§èœå•6 1æŸ¥è¯¢ä¸Žä¸€ä¸ªèŠ‚ç‚¹åŒçº§çš„èŠ‚ç‚¹å¦‚æžœåœ¨è¡¨ä¸­è®¾ç½®äº†çº§åˆ«çš„å­—æ®µï¼Œé‚£ä¹ˆåœ¨åšè¿™ç±»æŸ¥è¯¢æ—¶ä¼šå¾ˆè½»æ¾ï¼ŒåŒä¸€çº§åˆ«çš„å°±æ˜¯ä¸Žé‚£ä¸ªèŠ‚ç‚¹åŒçº§çš„ï¼Œåœ¨è¿™é‡Œåˆ—å‡ºä¸ä½¿ç”¨è¯¥å­—æ®µæ—¶çš„å®žçŽ°ï¼š12345678910111213141516171819202122232425262728293031323334353637SQL&gt; WITH tmp AS ( SELECT A .*, LEVEL leaf FROM tb_menu A START WITH A . PARENT = 0 CONNECT BY A . PARENT = PRIOR A . ID) SELECT *FROM tmpWHERE leaf = ( SELECT leaf FROM tmp WHERE ID = 50 ); ID TITLE PARENT LEAF---------- ----------------------------------------- ---------- ---------- 38 ä¸‰çº§èœå•38 21 4 39 ä¸‰çº§èœå•39 22 4 40 ä¸‰çº§èœå•40 23 4 41 ä¸‰çº§èœå•41 24 4 42 ä¸‰çº§èœå•42 25 4 43 ä¸‰çº§èœå•43 26 4 44 ä¸‰çº§èœå•44 27 4 45 ä¸‰çº§èœå•45 28 4 46 ä¸‰çº§èœå•46 28 4 47 ä¸‰çº§èœå•47 29 4 48 ä¸‰çº§èœå•48 30 4 49 ä¸‰çº§èœå•49 31 4 50 ä¸‰çº§èœå•50 31 4 å·²é€‰æ‹©13è¡Œã€‚è¿™é‡Œä½¿ç”¨ä¸¤ä¸ªæŠ€å·§ï¼Œä¸€ä¸ªæ˜¯ä½¿ç”¨äº†levelæ¥æ ‡è¯†æ¯ä¸ªèŠ‚ç‚¹åœ¨è¡¨ä¸­çš„çº§åˆ«ï¼Œè¿˜æœ‰å°±æ˜¯ä½¿ç”¨withè¯­æ³•æ¨¡æ‹Ÿå‡ºäº†ä¸€å¼ å¸¦æœ‰çº§åˆ«çš„ä¸´æ—¶è¡¨ã€‚æŸ¥è¯¢ä¸€ä¸ªèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455SQL&gt; WITH tmp AS ( SELECT tb_menu.*, LEVEL lev FROM tb_menu START WITH PARENT = 0 CONNECT BY PARENT = PRIOR ID) SELECT b.*FROM tmp b, ( SELECT * FROM tmp WHERE ID = 21 AND lev = 2 ) AWHERE b.lev = 1UNION ALL SELECT * FROM tmp WHERE PARENT = ( SELECT DISTINCT x. ID FROM tmp x, --ç¥–çˆ¶ tmp y, --çˆ¶äº² ( SELECT * FROM tmp WHERE ID = 21 AND lev &gt; 2 ) z --å„¿å­ WHERE y. ID = z. PARENT AND x. ID = y. PARENT ); ID TITLE PARENT LEV---------- ---------------------------------------- ---------- ---------- 6 ä¸€çº§èœå•6 1 2 7 ä¸€çº§èœå•7 1 2 8 ä¸€çº§èœå•8 1 2è¿™é‡ŒæŸ¥è¯¢åˆ†æˆä»¥ä¸‹å‡ æ­¥ã€‚é¦–å…ˆï¼Œå°†ç¬¬7ä¸ªä¸€æ ·ï¼Œå°†å…¨è¡¨éƒ½ä½¿ç”¨ä¸´æ—¶è¡¨åŠ ä¸Šçº§åˆ«ï¼›å…¶æ¬¡ï¼Œæ ¹æ®çº§åˆ«æ¥åˆ¤æ–­æœ‰å‡ ç§ç±»åž‹ï¼Œä»¥ä¸Šæ–‡ä¸­ä¸¾çš„ä¾‹å­æ¥è¯´ï¼Œæœ‰ä¸‰ç§æƒ…å†µï¼šï¼ˆ1ï¼‰å½“å‰èŠ‚ç‚¹ä¸ºé¡¶çº§èŠ‚ç‚¹ï¼Œå³æŸ¥è¯¢å‡ºæ¥çš„levå€¼ä¸º1ï¼Œé‚£ä¹ˆå®ƒæ²¡æœ‰ä¸Šçº§èŠ‚ç‚¹ï¼Œä¸äºˆè€ƒè™‘ã€‚ï¼ˆ2ï¼‰å½“å‰èŠ‚ç‚¹ä¸º2çº§èŠ‚ç‚¹ï¼ŒæŸ¥è¯¢å‡ºæ¥çš„levå€¼ä¸º2ï¼Œé‚£ä¹ˆå°±åªè¦ä¿è¯levçº§åˆ«ä¸º1çš„å°±æ˜¯å…¶ä¸Šçº§èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹ã€‚ï¼ˆ3ï¼‰å…¶å®ƒæƒ…å†µå°±æ˜¯3ä»¥åŠä»¥ä¸Šçº§åˆ«ï¼Œé‚£ä¹ˆå°±è¦é€‰æŸ¥è¯¢å‡ºæ¥å…¶ä¸Šçº§çš„ä¸Šçº§èŠ‚ç‚¹ï¼ˆç¥–çˆ¶ï¼‰ï¼Œå†æ¥åˆ¤æ–­ç¥–çˆ¶çš„ä¸‹çº§èŠ‚ç‚¹éƒ½æ˜¯å±žäºŽè¯¥èŠ‚ç‚¹çš„ä¸Šçº§èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹ã€‚æœ€åŽï¼Œå°±æ˜¯ä½¿ç”¨unionå°†æŸ¥è¯¢å‡ºæ¥çš„ç»“æžœè¿›è¡Œç»“åˆèµ·æ¥ï¼Œå½¢æˆç»“æžœé›†ã€‚æŸ¥è¯¢ä¸€ä¸ªèŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„åŒçº§èŠ‚ç‚¹è¿™ä¸ªå…¶å®žè·Ÿç¬¬7ç§æƒ…å†µæ˜¯ç›¸åŒçš„ã€‚1234567891011121314151617181920SQL&gt; WITH tmp AS ( SELECT A .*, LEVEL leaf FROM tb_menu A START WITH A . PARENT = 0 CONNECT BY A . PARENT = PRIOR A . ID) SELECT *FROM tmpWHERE leaf = (SELECT leaf FROM tmp WHERE ID = 6) - 1; ID TITLE PARENT LEAF---------- ------------------------------------------- ---------- ---------- 1 çˆ¶èœå•1 0 1 2 çˆ¶èœå•2 0 1 3 çˆ¶èœå•3 0 1 4 çˆ¶èœå•4 0 1 5 çˆ¶èœå•5 0 1åŸºæœ¬ä¸Šï¼Œå¸¸è§çš„æŸ¥è¯¢åœ¨é‡Œé¢äº†ï¼Œä¸å¸¸è§çš„ä¹Ÿæœ‰éƒ¨åˆ†äº†ã€‚å…¶ä¸­ï¼ŒæŸ¥è¯¢çš„å†…å®¹éƒ½æ˜¯èŠ‚ç‚¹çš„åŸºæœ¬ä¿¡æ¯ï¼Œéƒ½æ˜¯æ•°æ®è¡¨ä¸­çš„åŸºæœ¬å­—æ®µï¼Œä½†æ˜¯åœ¨æ ‘æŸ¥è¯¢ä¸­è¿˜æœ‰äº›ç‰¹æ®Šéœ€æ±‚ï¼Œæ˜¯å¯¹æŸ¥è¯¢æ•°æ®è¿›è¡Œäº†å¤„ç†çš„ï¼Œå¸¸è§çš„åŒ…æ‹¬åˆ—å‡ºæ ‘è·¯å¾„ç­‰ã€‚è¡¥å……ä¸€ä¸ªæ¦‚å¿µï¼Œå¯¹äºŽæ•°æ®åº“æ¥è¯´ï¼Œæ ¹èŠ‚ç‚¹å¹¶ä¸ä¸€å®šæ˜¯åœ¨æ•°æ®åº“ä¸­è®¾è®¡çš„é¡¶çº§èŠ‚ç‚¹ï¼Œå¯¹äºŽæ•°æ®åº“æ¥è¯´ï¼Œæ ¹èŠ‚ç‚¹å°±æ˜¯start withå¼€å§‹çš„åœ°æ–¹ã€‚ä¸‹é¢åˆ—å‡ºçš„æ˜¯ä¸€äº›ä¸Žæ ‘ç›¸å…³çš„ç‰¹æ®Šéœ€æ±‚ã€‚åç§°è¦åˆ—å‡ºåç§°å…¨éƒ¨è·¯å¾„è¿™é‡Œå¸¸è§çš„æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ä»Žé¡¶çº§åˆ—å‡ºï¼Œç›´åˆ°å½“å‰èŠ‚ç‚¹çš„åç§°ï¼ˆæˆ–è€…å…¶å®ƒå±žæ€§ï¼‰ï¼›ä¸€ç§æ˜¯ä»Žå½“å‰èŠ‚ç‚¹åˆ—å‡ºï¼Œç›´åˆ°é¡¶çº§èŠ‚ç‚¹çš„åç§°ï¼ˆæˆ–å…¶å®ƒå±žæ€§ï¼‰ã€‚ä¸¾åœ°å€ä¸ºä¾‹ï¼šå›½å†…çš„ä¹ æƒ¯æ˜¯ä»Žçœå¼€å§‹ã€åˆ°å¸‚ã€åˆ°åŽ¿ã€åˆ°å±…å§”ä¼šçš„ï¼Œè€Œå›½å¤–çš„ä¹ æƒ¯æ­£å¥½ç›¸åã€‚ ä»Žé¡¶éƒ¨å¼€å§‹ï¼š1234567891011SQL&gt; SELECT SYS_CONNECT_BY_PATH (title, '/')FROM tb_menuWHERE ID = 50 START WITH PARENT = 0 CONNECT BY PARENT = PRIOR ID; SYS_CONNECT_BY_PATH(TITLE,'/')----------------------------------------------------/çˆ¶èœå•3/ä¸€çº§èœå•14/äºŒçº§èœå•31/ä¸‰çº§èœå•50ä»Žå½“å‰èŠ‚ç‚¹å¼€å§‹ï¼š123456789101112SQL&gt; SELECT SYS_CONNECT_BY_PATH (title, '/')FROM tb_menu START WITH ID = 50 CONNECT BY PRIOR PARENT = ID; SYS_CONNECT_BY_PATH(TITLE,'/')------------------------------------------------------ /ä¸‰çº§èœå•50/ä¸‰çº§èœå•50/äºŒçº§èœå•31/ä¸‰çº§èœå•50/äºŒçº§èœå•31/ä¸€çº§èœå•14/ä¸‰çº§èœå•50/äºŒçº§èœå•31/ä¸€çº§èœå•14/çˆ¶èœå•3åœ¨è¿™é‡Œæˆ‘åˆä¸å¾—ä¸æ”¾ä¸ªç‰¢éªšäº†ã€‚oracleåªæä¾›äº†ä¸€ä¸ªsys_connect_by_pathå‡½æ•°ï¼Œå´å¿˜äº†å­—ç¬¦ä¸²çš„è¿žæŽ¥çš„é¡ºåºã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¬¬ä¸€ä¸ªsqlæ˜¯ä»Žæ ¹èŠ‚ç‚¹å¼€å§‹éåŽ†ï¼Œè€Œç¬¬äºŒä¸ªsqlæ˜¯ç›´æŽ¥æ‰¾åˆ°å½“å‰èŠ‚ç‚¹ï¼Œä»Žæ•ˆçŽ‡ä¸Šæ¥è¯´å·²ç»æ˜¯åƒå·®ä¸‡åˆ«ï¼Œæ›´å…³é”®çš„æ˜¯ç¬¬ä¸€ä¸ªsqlåªèƒ½é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œç¬¬äºŒä¸ªsqlå´æ˜¯éåŽ†å‡ºäº†ä¸€é¢—æ ‘æ¥ã€‚å†æ¬¡psä¸€ä¸‹ã€‚sys_connect_by_pathå‡½æ•°å°±æ˜¯ä»Žstart withå¼€å§‹çš„åœ°æ–¹å¼€å§‹éåŽ†ï¼Œå¹¶è®°ä¸‹å…¶éåŽ†åˆ°çš„èŠ‚ç‚¹ï¼Œstart withå¼€å§‹çš„åœ°æ–¹è¢«è§†ä¸ºæ ¹èŠ‚ç‚¹ï¼Œå°†éåŽ†åˆ°çš„è·¯å¾„æ ¹æ®å‡½æ•°ä¸­çš„åˆ†éš”ç¬¦ï¼Œç»„æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªåŠŸèƒ½è¿˜æ˜¯å¾ˆå¼ºå¤§çš„ã€‚åˆ—å‡ºå½“å‰èŠ‚ç‚¹çš„æ ¹èŠ‚ç‚¹ã€‚åœ¨å‰é¢è¯´è¿‡ï¼Œæ ¹èŠ‚ç‚¹å°±æ˜¯start withå¼€å§‹çš„åœ°æ–¹ã€‚12345678910111213SQL&gt; SELECT CONNECT_BY_ROOT title, tb_menu.*FROM tb_menu START WITH ID = 50 CONNECT BY PRIOR PARENT = ID; CONNECT_BY_ROOTTITLE ID TITLE PARENT----------------------------------------------------------------ä¸‰çº§èœå•50 50 ä¸‰çº§èœå•50 31ä¸‰çº§èœå•50 31 äºŒçº§èœå•31 14ä¸‰çº§èœå•50 14 ä¸€çº§èœå•14 3ä¸‰çº§èœå•50 3 çˆ¶èœå•3 0connect_by_rootå‡½æ•°ç”¨æ¥åˆ—çš„å‰é¢ï¼Œè®°å½•çš„æ˜¯å½“å‰èŠ‚ç‚¹çš„æ ¹èŠ‚ç‚¹çš„å†…å®¹ã€‚åˆ—å‡ºå½“å‰èŠ‚ç‚¹æ˜¯å¦ä¸ºå¶å­è¿™ä¸ªæ¯”è¾ƒå¸¸è§ï¼Œå°¤å…¶åœ¨åŠ¨æ€ç›®å½•ä¸­ï¼Œåœ¨æŸ¥å‡ºçš„å†…å®¹æ˜¯å¦è¿˜æœ‰ä¸‹çº§èŠ‚ç‚¹æ—¶ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å¾ˆé€‚ç”¨çš„ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960SELECT CONNECT_BY_ISLEAF, tb_menu.*FROM tb_menu START WITH PARENT = 0 CONNECT BY PARENT = PRIOR ID; CONNECT_BY_ISLEAF ID TITLE PARENT----------------- ---------- --------------------------------------- ---------- 0 1 çˆ¶èœå•1 0 0 6 ä¸€çº§èœå•6 1 0 21 äºŒçº§èœå•21 6 1 38 ä¸‰çº§èœå•38 21 0 22 äºŒçº§èœå•22 6 1 39 ä¸‰çº§èœå•39 22 0 7 ä¸€çº§èœå•7 1 0 23 äºŒçº§èœå•23 7 1 40 ä¸‰çº§èœå•40 23 0 24 äºŒçº§èœå•24 7 1 41 ä¸‰çº§èœå•41 24 0 8 ä¸€çº§èœå•8 1 0 25 äºŒçº§èœå•25 8 1 42 ä¸‰çº§èœå•42 25 0 2 çˆ¶èœå•2 0 0 9 ä¸€çº§èœå•9 2 0 26 äºŒçº§èœå•26 9 1 43 ä¸‰çº§èœå•43 6 0 10 ä¸€çº§èœå•10 2 0 27 äºŒçº§èœå•27 10 1 44 ä¸‰çº§èœå•44 27 0 11 ä¸€çº§èœå•11 2 0 28 äºŒçº§èœå•28 11 1 45 ä¸‰çº§èœå•45 28 1 46 ä¸‰çº§èœå•46 28 0 3 çˆ¶èœå•3 0 0 12 ä¸€çº§èœå•12 3 0 29 äºŒçº§èœå•29 12 1 47 ä¸‰çº§èœå•47 29 0 13 ä¸€çº§èœå•13 3 0 30 äºŒçº§èœå•30 13 1 48 ä¸‰çº§èœå•48 30 0 14 ä¸€çº§èœå•14 3 0 31 äºŒçº§èœå•31 14 1 49 ä¸‰çº§èœå•49 31 1 50 ä¸‰çº§èœå•50 31 0 4 çˆ¶èœå•4 0 0 15 ä¸€çº§èœå•15 4 1 32 äºŒçº§èœå•32 15 0 16 ä¸€çº§èœå•16 4 1 33 äºŒçº§èœå•33 16 0 17 ä¸€çº§èœå•17 4 1 34 äºŒçº§èœå•34 17 0 5 çˆ¶èœå•5 0 0 18 ä¸€çº§èœå•18 5 1 35 äºŒçº§èœå•35 18 0 19 ä¸€çº§èœå•19 5 1 36 äºŒçº§èœå•36 19 0 20 ä¸€çº§èœå•20 5 1 37 äºŒçº§èœå•37 20 å·²é€‰æ‹©50è¡Œã€‚]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle 11g</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨JFinalå¿«é€Ÿæ­å»º Java webé¡¹ç›®]]></title>
    <url>%2F%E4%BD%BF%E7%94%A8JFinal%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA-Java-web%E9%A1%B9%E7%9B%AE.html</url>
    <content type="text"><![CDATA[JFinalæ˜¯ä¸€ä¸ªåŸºäºŽJavaçš„æžé€ŸWebå¼€å‘æ¡†æž¶ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç›®æ ‡æ˜¯å¼€å‘è¿…é€Ÿã€ä»£ç é‡å°‘ã€å­¦ä¹ ç®€å•ã€åŠŸèƒ½å¼ºå¤§ã€è½»é‡çº§ã€æ˜“æ‰©å±•ã€Restfulï¼Œåœ¨æ‹¥æœ‰Javaè¯­è¨€æ‰€æœ‰ä¼˜åŠ¿çš„åŒæ—¶å†æ‹¥æœ‰Rubyã€Pythonç­‰åŠ¨æ€è¯­è¨€çš„å¼€å‘æ•ˆçŽ‡ã€‚1.åœ¨eclipseä¸­æ–°å»ºJfinalé¡¹ç›® å¯¼å…¥jfinal-1.8-bin.jar å’Œ jfinal-2.2-bin-with-src.jarï¼›2.æ–°å»ºJfinalConfigç±»ï¼Œç”¨æ¥é…ç½®Jfinalï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344public class JfinalConfig extends JFinalConfig&#123; /* * é…ç½®å¸¸é‡å€¼ */ @Override public void configConstant(Constants arg0) &#123; //è®¾ç½®å¼€å‘æ¨¡å¼ä¸ºtrue arg0.setDevMode(true); //è®¾ç½®ç¼–ç æ ¼å¼ arg0.setEncoding("utf-8"); //è®¾ç½®è§†å›¾ç±»åž‹ arg0.setViewType(ViewType.JSP); &#125; /* * é…ç½®å¤„ç†å™¨ */ @Override public void configHandler(Handlers arg0) &#123; //é…ç½®é¡¹ç›®contextPath,ä»¥ä¾¿åœ¨jspé¡µé¢ç›´æŽ¥èŽ·å–é¡¹ç›®è®¿é—®è·¯å¾„ arg0.add(new ContextPathHandler("basepath")); &#125; /* * é…ç½®æ‹¦æˆªå™¨ï¼Œé¡¹ç›®é‡Œéœ€è¦æ‹¦æˆªå™¨çš„è¯åœ¨è¿™é‡Œé…ç½® */ @Override public void configInterceptor(Interceptors arg0) &#123; // TODO Auto-generated method stub &#125; /* * é…ç½®æ’ä»¶ï¼Œé€šå¸¸ç”¨æ¥é…ç½®å¯¹æ•°æ®åº“çš„æ”¯æŒ */ @Override public void configPlugin(Plugins arg0) &#123; // TODO Auto-generated method stub &#125; /* * é…ç½®è·¯ç”±ï¼Œç±»ä¼¼äºŽstrutsçš„action */ @Override public void configRoute(Routes arg0) &#123; //è®¿é—®è·¯å¾„ä¸ºé¡¹ç›®æ ¹è·¯å¾„æ—¶ï¼Œè°ƒç”¨JfinalController arg0.add("/", JfinalController.class); &#125; &#125;3.åœ¨web.xmlä¸­é…ç½®JfinalConfigï¼Œä»¥æ­¤åœ¨å¯åŠ¨Tomcatçš„æ—¶å€™åˆå§‹åŒ–JfinalConfigè¿™ä¸ªå…¥å£ï¼š12345678910111213141516171819202122&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-ap.xsd" version="2.5"&gt; &lt;filter&gt; &lt;filter-name&gt;jfinal&lt;/filter-name&gt; &lt;filter-class&gt;com.jfinal.core.JFinalFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;configClass&lt;/param-name&gt; &lt;param-value&gt;com.vis.config.JfinalConfig&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;jfinal&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; &lt;welcome-file-list&gt; &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt; &lt;/welcome-file-list&gt;&lt;/web-app&gt;4.åˆ›å»ºç™»é™†é¡µé¢ login.jsp å’Œä¸»é¡µ index.jspï¼šlogin.jspï¼š1234567891011121314151617&lt;%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%&gt;&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;&lt;html&gt; &lt;head&gt; &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt; &lt;title&gt;login page&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;!-- è·³è½¬åˆ°JfinalController loginæ–¹æ³• --&gt; &lt;form action="$&#123;basepath &#125;/login" id="body"&gt; &lt;p&gt;input userName:&lt;/p&gt; &lt;input type="text" name="userName" id="userName"/&gt; &lt;input type="submit" value="login"/&gt; &lt;/form&gt; &lt;/body&gt;&lt;/html&gt;index.jspï¼š12345678910111213 &lt;%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%&gt;&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;&lt;title&gt;my index&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;!-- èŽ·å–userName --&gt; &lt;h3&gt;welcome back,$&#123;userName &#125;&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;5.åˆ›å»ºJfinalControllerï¼Œç”¨æ¥å“åº”jspé¡µé¢çš„è¯·æ±‚ï¼š12345678910111213public class JfinalController extends Controller&#123; //è®¾ç½®é»˜è®¤è®¿é—®é¡µé¢ public void index()&#123; this.render("login.jsp"); &#125; //è®¿é—®è·¯å¾„ä¸º basepath/loginæ—¶è°ƒç”¨æ­¤æ–¹æ³• public void login()&#123; String userName=this.getPara("userName"); this.setAttr("userName", userName); //å–åˆ°userNameåŽè·³è½¬åˆ°index.jsp this.render("index.jsp"); &#125;&#125;è‡³æ­¤ï¼Œä¸€ä¸ªç®€å•çš„Java webé¡¹ç›®æ­å»ºå®Œäº†ï¼Œå°†é¡¹ç›®éƒ¨ç½²åˆ°Tomcatä¸­ï¼Œå¹¶å¯åŠ¨ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥è®¿é—®è·¯å¾„ï¼šlocalhost:8080/Jfinal/ï¼š]]></content>
      <tags>
        <tag>JFinal</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Atomç¼–è¾‘å™¨æ·»åŠ é…·ç‚«åŠ¨ç”»]]></title>
    <url>%2FAtom%E7%BC%96%E8%BE%91%E5%99%A8%E6%B7%BB%E5%8A%A0%E9%85%B7%E7%82%AB%E5%8A%A8%E7%94%BB.html</url>
    <content type="text"><![CDATA[ç”±äºŽæ²¡æœ‰å®‰è£…å®Œæ•´ä¾èµ–åº“æˆ–è€…é‚£å µä¼Ÿå¤§çš„å¢™çš„åŽŸå› ï¼Œä½¿å¾—åŽŸæœ¬åªæ˜¯å®‰è£…ä¸€ä¸ªPackageçš„æ“ä½œå˜å¾—ä¸é‚£ä¹ˆç®€å•ã€‚è¿™é‡Œä»‹ç»ä¸€ç§100%å®‰è£…æˆåŠŸçš„æ–¹æ³•ï¼š1.é¦–å…ˆå®‰è£…node.jsï¼šhttps://nodejs.org/en/ã€‚2.ç„¶åŽä¸‹è½½ activate-power-mode-master å¹¶è§£åŽ‹åˆ° C:\Users\Administrator\.atom\packagesç›®å½•ä¸‹ã€‚3.ä½¿ç”¨CMDå‘½ä»¤åˆ‡æ¢åˆ°activate-power-mode-masteræ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰§è¡Œnpmå‘½ä»¤ï¼š123C:\Users\Administrator\.atom\packages\activate-power-mode-master&gt;npm install lodashC:\Users\Administrator\.atom\packages\activate-power-mode-master&gt;npm install lodash.randomC:\Users\Administrator\.atom\packages\activate-power-mode-master&gt;npm install lodash.throttleæ‰§è¡Œå‘½ä»¤ä¹‹åŽï¼Œæ‰“å¼€Atomç¼–è¾‘å™¨ï¼ŒCtrl+Alt+Oå¼€å¯å°±å¯ä»¥çœ‹åˆ°é…·ç‚«çš„åŠ¨ç”»å•¦ã€‚å¦‚æžœæƒ³å…³é—­éœ‡åŠ¨æ•ˆæžœçš„è¯ï¼Œä¿®æ”¹activate-power-mode-master/lib/activate-power-mode.coffeeæ–‡ä»¶68è¡Œä¸ºï¼š1if @getConfig "screenShake.disabled"é™„ä¸Šä¸€å¼ æ•ˆæžœå›¾ï¼š]]></content>
      <tags>
        <tag>Atom</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨Ajaxå‘æœåŠ¡ç«¯ä¼ é€formè¡¨å•æ•°æ®]]></title>
    <url>%2F%E4%BD%BF%E7%94%A8Ajax%E5%90%91%E6%9C%8D%E5%8A%A1%E7%AB%AF%E4%BC%A0%E9%80%81form%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE.html</url>
    <content type="text"><![CDATA[ä»Šå¤©åœ¨åšé™„ä»¶Demoçš„æ—¶å€™ï¼Œå‘çŽ°formè¡¨å•çš„submitæŒ‰é’®ä¼šè‡ªåŠ¨åˆ·æ–°é¡µé¢ï¼Œä½†åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œé¡µé¢çš„åˆ·æ–°ä¼šå¾ˆå¤§ç¨‹åº¦å½±å“ä½“éªŒã€‚äºŽæ˜¯æƒ³åˆ°ç”¨Ajaxæ¥ä»£æ›¿submitå‘æœåŠ¡ç«¯å‘é€æ•°æ®ï¼Œç½‘ç»œä¸Šçš„è¯´æ³•æ˜¯é€šè¿‡JQueryçš„serialize()æ–¹æ³•åºåˆ—åŒ–è¡¨å•ï¼Œä½†å®žéªŒä¹‹åŽå‘çŽ°è¯¥æ–¹æ³•åªèƒ½ä¼ é€’ä¸€èˆ¬çš„å‚æ•°ï¼Œä¸Šä¼ çš„æ–‡ä»¶å¹¶ä¸èƒ½è¢«åºåˆ—åŒ–ä¼ é€’åˆ°æœåŠ¡ç«¯ã€‚ç»§ç»­æŸ¥æ‰¾èµ„æ–™å‘çŽ°å¯ä»¥ä½¿ç”¨formDataæ–¹æ³•æ¥ä½¿ç”¨Ajaxè¯·æ±‚å‘æœåŠ¡ç«¯ä¸Šä¼ formè¡¨å•é™„ä»¶ï¼šHTMLä»£ç ï¼š1234567891011121314151617181920212223&lt;form action="http://localhost:8080/file/servlet/UploadHandleServlet" enctype="multipart/form-data" method="post" id="form"&gt; &lt;table border="1" &gt; &lt;tr&gt; &lt;td&gt;ç”¨æˆ·å:&lt;/td&gt; &lt;td&gt;&lt;input type="text" name=userName/&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;é™„ä»¶:&lt;/td&gt; &lt;td id="file"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td colspan="2" align="center"&gt; &lt;input type="button" value="å¢žåŠ é™„ä»¶" onclick="AddMore()"&gt; &lt;input type="button" value="æäº¤" id="submit"&gt; &lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;é™„ä»¶ä¸‹è½½:&lt;/td&gt; &lt;td id="fileLoad"&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/form&gt;JSä»£ç ï¼š123456789101112131415$("#submit").click(function()&#123; var formData = new FormData($("#form")[0]); $.ajax(&#123; url:"http://localhost:8080/file/servlet/UploadHandleServlet", type:"post", data:formData, async: false, cache: false, contentType: false, processData: false, success:function()&#123; // something to do... &#125; &#125;); &#125;);]]></content>
      <tags>
        <tag>Ajax</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java å¹¶å‘åŸºç¡€]]></title>
    <url>%2FJava-Concurrent-Basis.html</url>
    <content type="text"><![CDATA[Thread ç±»çš„æ¯ä¸€ä¸ªå®žä¾‹éƒ½è¡¨ç¤ºä¸€ä¸ªçº¿ç¨‹ï¼Œ è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿçº§åˆ«çš„å¤šä»»åŠ¡ï¼ŒJVM å°±æ˜¯è¿è¡Œåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­çš„ã€‚æ‰€ä»¥åœ¨Java ä¸­æˆ‘æˆ‘ä»¬åªè€ƒè™‘çº¿ç¨‹ã€‚è¿›ç¨‹æœ‰ç‹¬ç«‹çš„å†…å­˜ï¼Œä¸€ä¸ªè¿›ç¨‹é—´çš„å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜è¿›ç¨‹ä¸­è‡³å°‘è¦æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚çº¿ç¨‹çŠ¶æ€Newï¼šå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œè¯¥çº¿ç¨‹å¹¶æ²¡æœ‰çº³å…¥çº¿ç¨‹è°ƒåº¦ï¼Œå…¶å¤„äºŽä¸€ä¸ªnewçŠ¶æ€ã€‚Runnableï¼šå½“è°ƒç”¨çº¿ç¨‹çš„startæ–¹æ³•åŽï¼Œè¯¥çº¿ç¨‹çº³å…¥çº¿ç¨‹è°ƒåº¦çš„æŽ§åˆ¶ï¼Œå…¶å¤„äºŽä¸€ä¸ªå¯è¿è¡ŒçŠ¶æ€ï¼Œç­‰å¾…åˆ†é…æ—¶é—´ç‰‡æ®µä»¥å¹¶å‘è¿è¡Œã€‚Runningï¼šå½“è¯¥çº¿ç¨‹è¢«åˆ†é…åˆ°äº†æ—¶é—´ç‰‡æ®µåŽå…¶è¢«CPUè¿è¡Œï¼Œè¿™æ˜¯è¯¥çº¿ç¨‹å¤„äºŽrunningçŠ¶æ€ã€‚Blockedï¼šå½“çº¿ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºçŽ°é˜»å¡žçŽ°è±¡ï¼Œæ¯”å¦‚ç­‰å¾…ç”¨æˆ·è¾“å…¥ä¿¡æ¯ç­‰ã€‚ä½†é˜»å¡žçŠ¶æ€ä¸æ˜¯ç™¾åˆ†ç™¾å‡ºçŽ°çš„ï¼Œå…·ä½“è¦çœ‹ä»£ç ä¸­æ˜¯å¦æœ‰ç›¸å…³éœ€æ±‚ã€‚Deadï¼šå½“çº¿ç¨‹çš„ä»»åŠ¡å…¨éƒ¨è¿è¡Œå®Œæ¯•ï¼Œæˆ–åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºäº†ä¸€ä¸ªæœªæ•èŽ·çš„å¼‚å¸¸ï¼Œé‚£ä¹ˆçº¿ç¨‹ç»“æŸï¼Œç­‰å¾…GCå›žæ”¶åˆ›å»ºçº¿ç¨‹çº¿ç¨‹æœ‰ä¸¤ç§åˆ›å»ºæ–¹å¼ï¼šæ–¹å¼1ï¼šå®šä¹‰ä¸€ä¸ªç±»å¹¶ç»§æ‰¿Threadï¼Œç„¶åŽé‡å†™runæ–¹æ³•ï¼Œåœ¨å…¶ä¸­ä¹¦å†™çº¿ç¨‹ä»»åŠ¡é€»è¾‘ï¼š12345678910111213141516171819Thread t1 = new MyThread1();Thread t2 = new MyThread2();t1.start();t2.start();class MyThread1 extends Thread &#123; public void run() &#123; for (int i = 0; i &lt; 5; i++) &#123; System.out.println("are you ok?"); &#125; &#125;&#125;class MyThread2 extends Thread &#123; public void run() &#123; for (int i = 0; i &lt; 5; i++) &#123; System.out.println("of course"); &#125; &#125;&#125;è¾“å‡ºï¼š123456789of courseof courseof courseof courseof courseare you ok?are you ok?are you ok?are you ok?å¯åŠ¨çº¿ç¨‹è¦è°ƒç”¨startæ–¹æ³•ï¼Œä¸èƒ½ç›´æŽ¥è°ƒç”¨runæ–¹æ³•ã€‚startæ–¹æ³•ä¼šå°†å½“å‰çº¿ç¨‹çº³å…¥åˆ°çº¿ç¨‹è°ƒåº¦ä¸­ï¼Œä½¿å…¶å…·æœ‰å¹¶å‘è¿è¡Œçš„èƒ½åŠ›ã€‚startæ–¹æ³•å¾ˆå¿«ä¼šæ‰§è¡Œå®Œæ¯•ã€‚å½“startæ–¹æ³•æ‰§è¡Œå®Œæ¯•åŽï¼Œå½“å‰çº¿ç¨‹çš„runæ–¹æ³•ä¼šå¾ˆå¿«çš„è¢«æ‰§è¡Œèµ·æ¥ï¼ˆåªè¦èŽ·å–åˆ°äº†cpuæ—¶é—´ç‰‡ï¼‰ã€‚ä½†ä¸èƒ½ç†è§£ä¸ºè°ƒç”¨startæ–¹æ³•æ—¶runæ–¹æ³•å°±æ‰§è¡Œäº†ï¼çº¿ç¨‹æœ‰å‡ ä¸ªä¸å¯æŽ§å› ç´ :cpuåˆ†é…æ—¶é—´ç‰‡ç»™å“ªä¸ªçº¿ç¨‹æˆ‘ä»¬è¯´äº†ä¸ç®—ã€‚æ—¶é—´ç‰‡é•¿çŸ­ä¹Ÿä¸å¯æŽ§ã€‚çº¿ç¨‹è°ƒåº¦ä¼šå°½å¯èƒ½å‡åŒ€çš„å°†æ—¶é—´ç‰‡åˆ†é…ç»™å¤šä¸ªçº¿ç¨‹ã€‚ç¬¬ä¸€ç§åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼å­˜åœ¨ä¸¤ä¸ªä¸è¶³ï¼šç”±äºŽjavaæ˜¯å•ç»§æ‰¿çš„ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬è‹¥ç»§æ‰¿äº†Threadç±»å°±æ— æ³•å†ç»§æ‰¿å…¶ä»–ç±»ï¼Œè¿™åœ¨å†™é¡¹ç›®æ—¶ä¼šé‡åˆ°å¾ˆå¤§é—®é¢˜ï¼›ç”±äºŽæˆ‘ä»¬å®šä¹‰çº¿ç¨‹çš„åŒæ—¶é‡å†™runæ–¹æ³•æ¥å®šä¹‰çº¿ç¨‹è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œè¿™å°±å¯¼è‡´çº¿ç¨‹ä¸Žä»»åŠ¡æœ‰ä¸€ä¸ªå¼ºè€¦åˆå…³ç³»ï¼Œçº¿ç¨‹çš„é‡ç”¨æ€§å˜å¾—éžå¸¸å±€é™ã€‚æ–¹å¼2ï¼šå®šä¹‰ä¸€ä¸ªç±»å¹¶å®žçŽ°RunnableæŽ¥å£ç„¶åŽåœ¨åˆ›å»ºçº¿ç¨‹çš„åŒæ—¶å°†ä»»åŠ¡æŒ‡å®šã€‚å› ä¸ºæ˜¯å®žçŽ°RunnableæŽ¥å£ï¼Œæ‰€ä»¥ä¸å½±å“å…¶ç»§æ‰¿å…¶ä»–ç±»ï¼š12345678910111213Thread t1 = new Thread(() -&gt; &#123; for (int i = 0; i &lt; 5; i++) &#123; System.out.println("are you ok?"); &#125;&#125;);t1.start();Thread t2 = new Thread(() -&gt; &#123; for (int i = 0; i &lt; 5; i++) &#123; System.out.println("of course"); &#125;&#125;);t2.start();çº¿ç¨‹ç›¸å…³APIèŽ·å–å½“å‰çº¿ç¨‹ï¼š1Thread current = Thread.currentThread(); // Thread[main,5,main]èŽ·å–å½“å‰çº¿ç¨‹IDï¼š12Thread current = Thread.currentThread();System.out.println(current.getId()); // 1èŽ·å–å½“å‰çº¿ç¨‹åå­—ï¼š12Thread current = Thread.currentThread();System.out.println(current.getName()); // mainèŽ·å–å½“å‰çº¿ç¨‹ä¼˜å…ˆçº§ï¼š12Thread current = Thread.currentThread();System.out.println(current.getPriority()); // 5åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦è¿˜æ´»ç€ï¼š12Thread current = Thread.currentThread();System.out.println(current.isAlive()); // trueåˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼š12Thread current = Thread.currentThread();System.out.println(current.isDaemon()); // falseåˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼š12Thread current = Thread.currentThread();System.out.println(current.isInterrupted()); // falseçº¿ç¨‹çš„ä¼˜å…ˆçº§çº¿ç¨‹ä¼˜å…ˆçº§åˆ†ä¸º10ä¸ªç­‰çº§ï¼Œ1æœ€ä½Žï¼Œ5é»˜è®¤ï¼Œ10æœ€é«˜ã€‚çº¿ç¨‹æä¾›äº†3ä¸ªå¸¸é‡ï¼šMIN_PRIORITYï¼š1 å¯¹åº”æœ€ä½Žä¼˜å…ˆçº§ï¼›MAX_PRIORITYï¼š 10 å¯¹åº”æœ€é«˜ä¼˜å…ˆçº§ï¼›NORM_PRIORITYï¼š5 é»˜è®¤ä¼˜å…ˆçº§ã€‚çº¿ç¨‹é˜»å¡žThreadæä¾›äº†ä¸€ä¸ªé™æ€æ–¹æ³•: sleepï¼Œè¯¥æ–¹æ³•ä¼šé˜»å¡žè¿è¡Œå½“å‰æ–¹æ³•çš„çº¿ç¨‹æŒ‡å®šæ¯«ç§’ã€‚å½“è¶…æ—¶åŽï¼Œçº¿ç¨‹ä¼šè‡ªåŠ¨å›žåˆ°RunnableçŠ¶æ€ï¼Œç­‰å¾…å†æ¬¡åˆ†é…æ—¶é—´ç‰‡è¿è¡Œï¼š1234567System.out.println("ç¨‹åºå¼€å§‹äº†");try &#123; Thread.sleep(5000);&#125; catch (InterruptedException e) &#123; e.printStackTrace();&#125;System.out.println("ç¨‹åºç»“æŸäº†");å®ˆæŠ¤çº¿ç¨‹åŽå°çº¿ç¨‹ï¼Œåˆå«åšå®ˆæŠ¤çº¿ç¨‹ï¼Œå½“ä¸€ä¸ªè¿›ç¨‹ä¸­çš„æ‰€æœ‰å‰å°çº¿ç¨‹éƒ½ç»“æŸäº†ï¼Œè¿›ç¨‹å°±ä¼šç»“æŸï¼Œæ— è®ºè¿›ç¨‹ä¸­çš„å…¶ä»–åŽå°çº¿ç¨‹æ˜¯å¦è¿˜åœ¨è¿è¡Œï¼Œéƒ½è¦è¢«å¼ºåˆ¶ä¸­æ–­ï¼š1234567891011121314151617181920212223242526Thread front = new Thread(() -&gt; &#123; for (int i = 0; i &lt; 2; i++) &#123; System.out.println("å‰ç«¯çº¿ç¨‹è¿è¡Œä¸­"); try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; System.out.println("å‰å°çº¿ç¨‹è¿è¡Œå®Œæ¯•");&#125;);Thread back = new Thread(() -&gt; &#123; while (true) &#123; System.out.println("å‰å°çº¿ç¨‹ç»“æŸï¼Œæˆ‘å°±gg"); try &#123; TimeUnit.SECONDS.sleep(1); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;&#125;);front.start();back.setDaemon(true);back.start();è¾“å‡ºå¦‚ä¸‹ï¼š123456å‰å°çº¿ç¨‹ç»“æŸï¼Œæˆ‘å°±ggå‰ç«¯çº¿ç¨‹è¿è¡Œä¸­å‰å°çº¿ç¨‹ç»“æŸï¼Œæˆ‘å°±ggå‰ç«¯çº¿ç¨‹è¿è¡Œä¸­å‰å°çº¿ç¨‹ç»“æŸï¼Œæˆ‘å°±ggå‰å°çº¿ç¨‹è¿è¡Œå®Œæ¯•yieldè¯¥æ–¹æ³•ç”¨äºŽä½¿å½“å‰çº¿ç¨‹ä¸»åŠ¨è®©å‡ºå½“æ¬¡CPUæ—¶é—´ç‰‡å›žåˆ°RunnableçŠ¶æ€ï¼Œç­‰å¾…åˆ†é…æ—¶é—´ç‰‡ã€‚joinå…è®¸å½“å‰çº¿ç¨‹åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸Šç­‰å¾…ï¼Œç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ç»“æŸå·¥ä½œã€‚é€šå¸¸æ˜¯ç”¨æ¥åè°ƒä¸¤ä¸ªçº¿ç¨‹å·¥ä½œä½¿ç”¨ï¼š1234567891011121314151617181920212223242526272829303132private static boolean isFinish = false;public static void main(String[] args) &#123; Thread download = new Thread(() -&gt; &#123; System.out.println("å¼€å§‹ä¸‹è½½å›¾ç‰‡..."); for (int i = 1; i &lt;= 100; i++) &#123; System.out.println("down:" + i + "%"); try &#123; TimeUnit.MILLISECONDS.sleep(10); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; System.out.println("å›¾ç‰‡ä¸‹è½½å®Œæ¯•!"); isFinish = true; &#125;); Thread show = new Thread(() -&gt; &#123; System.out.println("å¼€å§‹æ˜¾ç¤ºå›¾ç‰‡..."); try &#123; download.join(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; if (!isFinish) &#123; throw new RuntimeException("å›¾ç‰‡åŠ è½½å¤±è´¥!"); &#125; System.out.println("å›¾ç‰‡æ˜¾ç¤ºå®Œæ¯•!"); &#125;); download.start(); show.start();&#125;synchroinzedå¤šä¸ªçº¿ç¨‹å¹¶å‘è¯»å†™åŒä¸€ä¸ªä¸´ç•Œèµ„æºæ—¶å€™ä¼šå‘ç”Ÿâ€œçº¿ç¨‹å¹¶å‘å®‰å…¨é—®é¢˜â€å¸¸è§çš„ä¸´ç•Œèµ„æº:å¤šçº¿ç¨‹å…±äº«å®žä¾‹å˜é‡ï¼›å¤šçº¿ç¨‹å…±äº«é™æ€å…¬å…±å˜é‡ã€‚è‹¥æƒ³è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œéœ€è¦å°†å¼‚æ­¥çš„æ“ä½œå˜ä¸ºåŒæ­¥æ“ä½œã€‚ ä½•ä¸ºåŒæ­¥ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬æ¥å¯¹æ¯”çœ‹ä¸€ä¸‹ä»€ä¹ˆæ˜¯åŒæ­¥ä»€ä¹ˆå¼‚æ­¥ï¼šæ‰€è°“å¼‚æ­¥æ“ä½œæ˜¯æŒ‡å¤šçº¿ç¨‹å¹¶å‘çš„æ“ä½œï¼Œç›¸å½“äºŽå„å¹²å„çš„ã€‚æ‰€è°“åŒæ­¥æ“ä½œæ˜¯æŒ‡æœ‰å…ˆåŽé¡ºåºçš„æ“ä½œï¼Œç›¸å½“äºŽä½ å¹²å®Œæˆ‘å†å¹²ã€‚è€Œjavaä¸­æœ‰ä¸€ä¸ªå…³é”®å­—åä¸ºï¼šsynchronizedï¼Œè¯¥å…³é”®å­—æ˜¯åŒæ­¥é”ï¼Œç”¨äºŽå°†æŸæ®µä»£ç å˜ä¸ºåŒæ­¥æ“ä½œï¼Œä»Žè€Œè§£å†³çº¿ç¨‹å¹¶å‘å®‰å…¨é—®é¢˜ã€‚ä½¿ç”¨é”éœ€è¦æ³¨æ„ä¸¤ä¸ªæ–¹é¢ï¼šé€‰æ‹©åˆé€‚çš„é”å¯¹è±¡ï¼šä½¿ç”¨synchroinzedéœ€è¦å¯¹ä¸€ä¸ªé”å¯¹è±¡ä¸Šé”ä»¥ä¿è¯çº¿ç¨‹åŒæ­¥ã€‚é‚£ä¹ˆè¿™ä¸ªé”å¯¹è±¡åº”å½“æ³¨æ„å¤šä¸ªéœ€è¦åŒæ­¥çš„çº¿ç¨‹åœ¨è®¿é—®è¯¥åŒæ­¥å—æ—¶ï¼Œçœ‹åˆ°çš„åº”è¯¥æ˜¯åŒä¸€ä¸ªé”å¯¹è±¡å¼•ç”¨ã€‚å¦åˆ™è¾¾ä¸åˆ°åŒæ­¥æ•ˆæžœã€‚ é€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨thisæ¥ä½œä¸ºé”å¯¹è±¡ã€‚é€‰æ‹©åˆé€‚çš„é”èŒƒå›´ï¼šåœ¨ä½¿ç”¨åŒæ­¥å—æ—¶ï¼Œåº”å½“å°½é‡åœ¨å…è®¸çš„æƒ…å†µä¸‹å‡å°‘åŒæ­¥èŒƒå›´ï¼Œä»¥æé«˜å¹¶å‘çš„æ‰§è¡Œæ•ˆçŽ‡ã€‚synchronizedå…³é”®å­—æœ‰ä¸¤ä¸ªç”¨æ³•:ä¿®é¥°æ–¹æ³•ï¼Œè¿™æ ·çš„è¯ï¼Œè¯¥æ–¹æ³•å°±ç§°ä¸ºâ€åŒæ­¥æ–¹æ³•â€ï¼Œå¤šä¸ªçº¿ç¨‹å°±ä¸èƒ½åŒæ—¶è¿›å…¥åˆ°æ–¹æ³•å†…éƒ¨åŽ»æ‰§è¡Œã€‚å¯ä»¥é¿å…ç”±äºŽçº¿ç¨‹åˆ‡æ¢ä¸ç¡®å®šï¼Œå¯¼è‡´çš„é€»è¾‘é”™è¯¯ã€‚synchronizedå—ï¼Œå¯ä»¥å°†æŸæ®µä»£ç ç‰‡æ®µæ‹¬èµ·æ¥ï¼Œå¤šä¸ªçº¿ç¨‹ä¸èƒ½åŒæ—¶æ‰§è¡Œé‡Œé¢çš„ä»£ç ã€‚12345678910111213141516171819202122232425262728293031323334public static void main(String[] args) &#123; final Table table = new Table(); Thread t0 = new Thread() &#123; public void run() &#123; while (true) &#123; int bean = table.getBean(); Thread.yield(); System.out.println(getName() + ":" + bean); &#125; &#125; &#125;; Thread t1 = new Thread() &#123; public void run() &#123; while (true) &#123; int bean = table.getBean(); Thread.yield(); System.out.println(getName() + ":" + bean); &#125; &#125; &#125;; t0.start(); t1.start();&#125;static class Table &#123; private int beans = 20; synchronized int getBean() &#123; if (beans == 0) &#123; throw new RuntimeException("æ²¡æœ‰è±†å­äº†!"); &#125; Thread.yield(); return beans--; &#125;&#125;å¦‚æžœä¸åŠ synchronizedå…³é”®å­—ï¼Œå¯èƒ½beansä¸ºè´Ÿæ•°äº†ï¼Œçº¿ç¨‹è¿˜åœ¨æ‰§è¡Œï¼Œæˆäº†æ­»å¾ªçŽ¯ã€‚synchronizedå—çš„ä¾‹å­ï¼š12345678910111213141516171819202122232425public static void main(String[] args) &#123; final Shop shop = new Shop(); Thread t1 = new Thread(shop::buy); Thread t2 = new Thread(shop::buy); t1.start(); t2.start();&#125;static class Shop &#123; void buy() &#123; try &#123; Thread t = Thread.currentThread(); System.out.println(t + "æ­£åœ¨æŒ‘é€‰è¡£æœ."); Thread.sleep(1000); synchronized (this) &#123; System.out.println(t + "æ­£åœ¨è¯•è¡£æœ."); Thread.sleep(1000); &#125; System.out.println(t + "ç»“è´¦ç¦»å¼€."); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;&#125;æ­¤æ—¶ï¼Œâ€œæ­£åœ¨è¯•è¡£æœâ€è¿™ä¸ªä»£ç å—ä¸€æ¬¡åªèƒ½ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œã€‚wait&amp;notifyObjectç±»ä¸­å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•wait()å’Œnotify()ã€‚å®ƒä»¬ä¹Ÿå¯ä»¥å®žçŽ°åè°ƒçº¿ç¨‹ä¹‹é—´åŒæ­¥å·¥ä½œçš„æ–¹æ³•ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨äº†æŸä¸ªå¯¹è±¡çš„waitæ–¹æ³•æ—¶ï¼Œè¿™ä¸ªçº¿ç¨‹å°±è¿›å…¥é˜»å¡žçŠ¶æ€ï¼Œç›´åˆ°è¿™ä¸ªå¯¹è±¡çš„notifyæ–¹æ³•è¢«è°ƒç”¨ï¼Œè¿™ä¸ªçº¿ç¨‹æ‰ä¼šè§£é™¤waité˜»å¡žï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œä»£ç ã€‚è‹¥å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨waitæ–¹æ³•è¿›å…¥é˜»å¡žçŠ¶æ€åŽï¼Œé‚£ä¹ˆå½“è¯¥å¯¹è±¡çš„notifyæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šéšæœºè§£é™¤ä¸€ä¸ªçº¿ç¨‹çš„waité˜»å¡žï¼Œè¿™ä¸ªä¸å¯æŽ§ã€‚è‹¥å¸Œæœ›ä¸€æ¬¡æ€§å°†æ‰€æœ‰çº¿ç¨‹çš„waité˜»å¡žè§£é™¤ï¼Œå¯ä»¥è°ƒç”¨notifyAllæ–¹æ³•ã€‚12345678910111213141516171819202122232425262728293031323334353637383940private static boolean isFinish;private static final Object obj = new Object();public static void main(String[] args) &#123; final Thread download = new Thread(() -&gt; &#123; System.out.println("down:å¼€å§‹ä¸‹è½½å›¾ç‰‡..."); for (int i = 1; i &lt;= 100; i++) &#123; System.out.println("down:" + i + "%"); try &#123; TimeUnit.MILLISECONDS.sleep(10); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; System.out.println("down:å›¾ç‰‡ä¸‹è½½å®Œæ¯•!"); isFinish = true; //é€šçŸ¥ showçº¿ç¨‹å¼€å§‹å·¥ä½œ synchronized (obj) &#123; obj.notify(); &#125; &#125;); Thread show = new Thread(() -&gt; &#123; System.out.println("show:å¼€å§‹æ˜¾ç¤ºå›¾ç‰‡..."); synchronized (obj) &#123; try &#123; obj.wait(); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; if (!isFinish) &#123; throw new RuntimeException("å›¾ç‰‡åŠ è½½å¤±è´¥!"); &#125; System.out.println("show:å›¾ç‰‡æ˜¾ç¤ºå®Œæ¯•!"); &#125;); download.start(); show.start();&#125;çº¿ç¨‹æ± å½“æˆ‘ä»¬çš„é€»è¾‘ä¸­å‡ºçŽ°äº†ä¼šé¢‘ç¹åˆ›å»ºçº¿ç¨‹çš„æƒ…å†µæ—¶ï¼Œå°±è¦è€ƒè™‘ä½¿ç”¨çº¿ç¨‹æ± æ¥ç®¡ç†çº¿ç¨‹ã€‚è¿™å¯ä»¥è§£å†³åˆ›å»ºè¿‡å¤šçº¿ç¨‹å¯¼è‡´çš„ç³»ç»Ÿå¨èƒã€‚çº¿ç¨‹æ± ä¸»è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼šæŽ§åˆ¶çº¿ç¨‹æ•°é‡ï¼›é‡ç”¨çº¿ç¨‹ã€‚12345678910111213141516171819//åˆ›å»ºä¸€ä¸ªå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ExecutorService threadPool = Executors.newFixedThreadPool(3);//æŒ‡æ´¾ 5ä¸ªä»»åŠ¡for (int i = 0; i &lt; 5; i++) &#123; Runnable runn = () -&gt; &#123; Thread t = Thread.currentThread(); System.out.println(t + "æ­£åœ¨è¿è¡Œä»»åŠ¡!"); try &#123; TimeUnit.SECONDS.sleep(2); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(t + "æ‰§è¡Œä»»åŠ¡å®Œæ¯•"); &#125;; threadPool.execute(runn);&#125;//åœæ­¢çº¿ç¨‹æ± threadPool.shutdown();12345678910Thread[pool-1-thread-2,5,main]æ­£åœ¨è¿è¡Œä»»åŠ¡!Thread[pool-1-thread-1,5,main]æ­£åœ¨è¿è¡Œä»»åŠ¡!Thread[pool-1-thread-3,5,main]æ­£åœ¨è¿è¡Œä»»åŠ¡!Thread[pool-1-thread-2,5,main]æ‰§è¡Œä»»åŠ¡å®Œæ¯•Thread[pool-1-thread-3,5,main]æ‰§è¡Œä»»åŠ¡å®Œæ¯•Thread[pool-1-thread-2,5,main]æ­£åœ¨è¿è¡Œä»»åŠ¡!Thread[pool-1-thread-1,5,main]æ‰§è¡Œä»»åŠ¡å®Œæ¯•Thread[pool-1-thread-3,5,main]æ­£åœ¨è¿è¡Œä»»åŠ¡!Thread[pool-1-thread-3,5,main]æ‰§è¡Œä»»åŠ¡å®Œæ¯•Thread[pool-1-thread-2,5,main]æ‰§è¡Œä»»åŠ¡å®Œæ¯•æ­¤æ—¶åŒæ—¶åªèƒ½æœ‰ä¸‰ä¸ªçº¿ç¨‹æ•°é‡ã€‚]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracle ç»å…¸è¯•é¢˜é›†]]></title>
    <url>%2FOracle-%E7%BB%8F%E5%85%B8%E8%AF%95%E9%A2%98%E9%9B%86.html</url>
    <content type="text"><![CDATA[ä¸€ä»½å¾ˆå¥½çš„Oracle SQLè¯•é¢˜é›†ðŸ™Œã€‚å‡†å¤‡å·¥ä½œï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465create table student( sno varchar2(10) primary key, sname varchar2(20), sage number(2), ssex varchar2(5));create table teacher( tno varchar2(10) primary key, tname varchar2(20));create table course( cno varchar2(10), cname varchar2(20), tno varchar2(20), constraint pk_course primary key (cno,tno));create table sc( sno varchar2(10), cno varchar2(10), score number(4,2), constraint pk_sc primary key (sno,cno));/*******åˆå§‹åŒ–å­¦ç”Ÿè¡¨çš„æ•°æ®******/insert into student values ('s001','å¼ ä¸‰',23,'ç”·');insert into student values ('s002','æŽå››',23,'ç”·');insert into student values ('s003','å´é¹',25,'ç”·');insert into student values ('s004','ç´æ²',20,'å¥³');insert into student values ('s005','çŽ‹ä¸½',20,'å¥³');insert into student values ('s006','æŽæ³¢',21,'ç”·');insert into student values ('s007','åˆ˜çŽ‰',21,'ç”·');insert into student values ('s008','è§è“‰',21,'å¥³');insert into student values ('s009','é™ˆè§æ™“',23,'å¥³');insert into student values ('s010','é™ˆç¾Ž',22,'å¥³');commit;/******************åˆå§‹åŒ–æ•™å¸ˆè¡¨***********************/insert into teacher values ('t001', 'åˆ˜é˜³');insert into teacher values ('t002', 'è°Œç‡•');insert into teacher values ('t003', 'èƒ¡æ˜Žæ˜Ÿ');commit;/***************åˆå§‹åŒ–è¯¾ç¨‹è¡¨****************************/insert into course values ('c001','J2SE','t002');insert into course values ('c002','Java Web','t002');insert into course values ('c003','SSH','t001');insert into course values ('c004','Oracle','t001');insert into course values ('c005','SQL SERVER 2005','t003');insert into course values ('c006','C#','t003');insert into course values ('c007','JavaScript','t002');insert into course values ('c008','DIV+CSS','t001');insert into course values ('c009','PHP','t003');insert into course values ('c010','EJB3.0','t002');commit;/***************åˆå§‹åŒ–æˆç»©è¡¨***********************/insert into sc values ('s001','c001',78.9);insert into sc values ('s002','c001',80.9);insert into sc values ('s003','c001',81.9);insert into sc values ('s004','c001',60.9);insert into sc values ('s001','c002',82.9);insert into sc values ('s002','c002',72.9);insert into sc values ('s003','c002',81.9);insert into sc values ('s001','c003','59');commit;1ã€æŸ¥è¯¢â€œc001â€è¯¾ç¨‹æ¯”â€œc002â€è¯¾ç¨‹æˆç»©é«˜çš„æ‰€æœ‰å­¦ç”Ÿçš„æˆç»©ä¿¡æ¯ï¼›12345678SQL&gt; select a.* from 2 (select * from sc a where a.cno = 'c001') a, 3 (select * from sc b where b.cno = 'c002') b 4 where a.sno=b.sno and a.score &gt; b.score;SNO CNO SCORE---------- ---------- ----------s002 c001 80.9æˆ–è€…ï¼š1234567SQL&gt; select * from sc a 2 where a.cno = 'c001' 3 and exists (select * from sc b where b.cno='c002' and a.score &gt; b.score and a.sno = b.sno);SNO CNO SCORE---------- ---------- ----------s002 c001 80.92ã€æŸ¥è¯¢å¹³å‡æˆç»©å¤§äºŽ60åˆ†çš„åŒå­¦çš„å­¦å·å’Œå¹³å‡æˆç»©ï¼›12345678SQL&gt; select sno,avg(score) from sc group by sno having avg(score) &gt; 60;SNO AVG(SCORE)---------- ----------s003 81.9s004 60.9s001 73.6s002 76.93ã€æŸ¥è¯¢æ‰€æœ‰åŒå­¦çš„å­¦å·ã€å§“åã€é€‰è¯¾æ•°ã€æ€»æˆç»©ï¼›1234567891011121314151617SQL&gt; SELECT a.sno, a.sNAME,sum(score),count(b.cno) 2 FROM student a, sc b 3 WHERE a.sno = b.sno(+) 4 group by a.sno,sname;SNO SNAME SUM(SCORE) COUNT(B.CNO)---------- -------------------- ---------- ------------s009 é™ˆè§æ™“ 0s005 çŽ‹ä¸½ 0s001 å¼ ä¸‰ 220.8 3s008 è§è“‰ 0s003 å´é¹ 163.8 2s004 ç´æ² 60.9 1s007 åˆ˜çŽ‰ 0s006 æŽæ³¢ 0s010 é™ˆç¾Ž 0s002 æŽå›› 153.8 24ã€æŸ¥è¯¢å§“â€œåˆ˜â€çš„è€å¸ˆçš„ä¸ªæ•°ï¼š12345SQL&gt; select count(1) from TEACHER where TNAME LIKE 'åˆ˜%'; COUNT(1)---------- 1]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Oracle basis]]></title>
    <url>%2FOracle-basis.html</url>
    <content type="text"><![CDATA[Oracleæ•°æ®ç±»åž‹NUMBERNUMBERè¡¨ç¤ºæ•°å­—ç±»åž‹ï¼Œç»å¸¸è¢«å®šä¹‰æˆNUMBERï¼ˆPï¼ŒSï¼‰å½¢å¼ï¼Œå…¶ä¸­ï¼šPè¡¨ç¤ºæ•°å­—çš„æ€»ä½æ•°ï¼›Sè¡¨ç¤ºå°æ•°ç‚¹åŽé¢çš„ä½æ•°ã€‚å¦‚ï¼šSal NUMBER(6,2)ï¼šè¡¨ç¤ºSalåˆ—ä¸­çš„æ•°æ®ï¼Œæ•´æ•°ä½æœ€å¤§ä¸º4ä½ï¼Œå°æ•°ä½æœ€å¤§ä½æ•°æ˜¯2ä½ï¼Œä¹Ÿå°±æ˜¯æœ€å¤§å–å€¼ï¼š9999.99ã€‚Pä¸å†™ä¸º*å·çš„æ—¶å€™ä»£è¡¨é»˜è®¤38ã€‚CHARCHARè¡¨ç¤ºå›ºå®šé•¿åº¦çš„å­—ç¬¦ç±»åž‹ï¼Œç»å¸¸è¢«å®šä¹‰æˆCHARï¼ˆNï¼‰å½¢å¼ï¼Œ Nè¡¨ç¤ºå ç”¨çš„å­—èŠ‚æ•°ï¼ŒNçš„æœ€å¤§å–å€¼æ˜¯2000ã€‚ä¾‹å¦‚åœ¨è¡¨Empä¸­çš„Enameåˆ—çš„å®šä¹‰å¦‚ä¸‹ï¼šEname CHAR(20)ï¼šè¡¨ç¤ºEnameåˆ—ä¸­æœ€å¤šå¯å­˜å‚¨20ä¸ªå­—èŠ‚çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å ç”¨çš„ç©ºé—´æ˜¯å›ºå®šçš„20ä¸ªå­—èŠ‚ã€‚VARCHAR2VARCHAR2è¡¨ç¤ºå˜é•¿çš„å­—ç¬¦ç±»åž‹ï¼Œå®šä¹‰æ ¼å¼æ˜¯VARCHAR2ï¼ˆNï¼‰ï¼Œ Nè¡¨ç¤ºæœ€å¤šå¯å ç”¨çš„å­—èŠ‚æ•°ï¼Œæœ€å¤§é•¿åº¦æ˜¯4000å­—èŠ‚ã€‚ä¾‹å¦‚åœ¨è¡¨Empä¸­çš„JOBåˆ—çš„å®šä¹‰å¦‚ä¸‹ï¼š JOB VARCHAR2(100)ï¼šè¡¨ç¤ºJOBåˆ—ä¸­æœ€å¤šå¯å­˜å‚¨é•¿åº¦ä¸º100ä¸ªå­—èŠ‚çš„å­—ç¬¦ä¸²ã€‚æ ¹æ®å…¶ä¸­ä¿å­˜çš„æ•°æ®é•¿åº¦ï¼Œå ç”¨çš„ç©ºé—´æ˜¯å˜åŒ–çš„ï¼Œæœ€å¤§å ç”¨ç©ºé—´ä¸º100ä¸ªå­—èŠ‚ã€‚CHARå’ŒVARCHAR2çš„åŒºåˆ«CHARå’ŒVARCHAR2ç±»åž‹CHARå’ŒVARCHAR2ç±»åž‹éƒ½æ˜¯ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²æ•°æ®ç±»åž‹ï¼Œç”¨æ¥åœ¨è¡¨ä¸­å­˜æ”¾å­—ç¬¦ä¸²ä¿¡æ¯ï¼Œ æ¯”å¦‚å§“åã€èŒä¸šã€åœ°å€ç­‰ã€‚CHARå­˜æ”¾å®šé•¿å­—ç¬¦ï¼Œå¦‚æžœæ•°æ®å­˜ä¸æ»¡å®šé•¿é•¿åº¦ï¼Œåˆ™è¡¥é½ç©ºæ ¼ï¼›VARCHAR2å­˜æ”¾å˜é•¿å­—ç¬¦ï¼Œå®žé™…æ•°æ®æœ‰å¤šå°‘é•¿åº¦åˆ™å ç”¨å¤šå°‘ã€‚å¦‚ä¿å­˜å­—ç¬¦ä¸²â€™HELLOWORLDâ€™ï¼Œå…±10ä¸ªè‹±æ–‡å­—æ¯ï¼šCHAR(100)ï¼š 10ä¸ªå­—æ¯ï¼Œè¡¥é½90ä¸ªç©ºæ ¼ï¼Œå®žé™…å ç”¨100ä¸ªå­—èŠ‚ã€‚VARCHAR2(100) ï¼š10ä¸ªå­—æ¯ï¼Œå®žé™…å ç”¨10ä¸ªå­—èŠ‚ã€‚CHARç±»åž‹æµªè´¹ç©ºé—´æ¢å–æŸ¥è¯¢æ—¶é—´çš„ç¼©çŸ­ï¼ŒVARCHAR2èŠ‚çœç©ºé—´æŸ¥è¯¢æ—¶é—´è¾ƒCHARç±»åž‹è¦é•¿ã€‚å­—ç¬¦ä¸²æŒ‰ç…§è‡ªç„¶é¡ºåºæŽ’åºã€‚CHARå’ŒVARCHAR2çš„å­˜å‚¨ç¼–ç å­—ç¬¦ä¸²åœ¨æ•°æ®åº“ä¸­å­˜å‚¨çš„é»˜è®¤å•ä½æ˜¯å­—èŠ‚ï¼Œä¹Ÿå¯æ˜¾å¼æŒ‡å®šä¸ºå­—ç¬¦ã€‚å¦‚ï¼šCHAR(10)ï¼Œç­‰ä»·äºŽ CHAR(10 BYTE)ã€‚å¦‚æžœæŒ‡å®šå•ä½ä¸ºå­—ç¬¦ï¼šCHAR(10 CHAR)ï¼Œ20ä¸ªå­—èŠ‚ã€‚VARCHAR2(10)ï¼Œ ç­‰ä»·äºŽVARCHAR2ï¼ˆ10 BYTEï¼‰ã€‚æŒ‡å®šå•ä½ä¸ºå­—ç¬¦ï¼šVARCHAR2(10 CHAR)ï¼Œ20ä¸ªå­—èŠ‚ã€‚CHARå’ŒVARCHAR2çš„æœ€å¤§é•¿åº¦CHARç±»åž‹çš„æœ€å¤§å–å€¼ä¸º2000å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯å®šä¹‰ä¸ºCHARï¼ˆ2000ï¼‰ã€‚å…¶ä¸­æœ€å¤šä¿å­˜2000ä¸ªè‹±æ–‡å­—ç¬¦ï¼Œ1000ä¸ªæ±‰å­—ï¼ˆGBKï¼‰ã€‚VARCHAR2æœ€å¤§å–å€¼ä¸º4000å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯VARCHAR2ï¼ˆ4000ï¼‰ï¼Œæœ€å¤šä¿å­˜4000ä¸ªè‹±æ–‡å­—ç¬¦ï¼Œ2000ä¸ªæ±‰å­—ï¼ˆGBKï¼‰ã€‚CHARå¦‚æžœä¸æŒ‡å®šé•¿åº¦ï¼Œé»˜è®¤ä¸º1ä¸ªå­—èŠ‚ï¼Œ VARCHAR2å¿…é¡»æŒ‡å®šé•¿åº¦ã€‚DATEDATEç”¨äºŽå®šä¹‰æ—¥æœŸæ—¶é—´çš„æ•°æ®ï¼Œé•¿åº¦æ˜¯7ä¸ªå­—èŠ‚ï¼Œé»˜è®¤æ ¼å¼æ˜¯ï¼šDD-MON-RRï¼Œ ä¾‹å¦‚ï¼šâ€œ11-APR-71â€ã€‚å¦‚æžœæ˜¯ä¸­æ–‡çŽ¯å¢ƒï¼Œæ˜¯â€œ11-4æœˆ-71â€è¿™ç§å½¢å¼ã€‚ä¾‹å¦‚åœ¨è¡¨Empä¸­çš„Hiredateåˆ—çš„å®šä¹‰å¦‚ä¸‹ï¼šHiredate DATEï¼šè¡¨ç¤ºHiredateåˆ—ä¸­å­˜æ”¾çš„æ˜¯æ—¥æœŸæ•°æ®ã€‚LONGå’ŒCLOBç±»åž‹LONGç±»åž‹å¯ä»¥è®¤ä¸ºæ˜¯VARCHAR2çš„åŠ é•¿ç‰ˆï¼Œç”¨æ¥å­˜å‚¨å˜é•¿å­—ç¬¦ä¸²ï¼Œæœ€å¤šè¾¾2GBçš„å­—ç¬¦ä¸²æ•°æ®ï¼Œä½†æ˜¯LONGç±»åž‹æœ‰è¯¸å¤šé™åˆ¶ï¼Œæ‰€ä»¥ä¸å»ºè®®ä½¿ç”¨ï¼šæ¯ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªLONGç±»åž‹åˆ—ï¼›ä¸èƒ½ä½œä¸ºä¸»é”®ï¼›ä¸èƒ½å»ºç«‹ç´¢å¼•ï¼›ä¸èƒ½å‡ºçŽ°åœ¨æŸ¥è¯¢æ¡ä»¶ä¸­ç­‰CLOBç”¨æ¥å­˜å‚¨å®šé•¿æˆ–å˜é•¿å­—ç¬¦ä¸²ï¼Œæœ€å¤šè¾¾4GBçš„å­—ç¬¦ä¸²æ•°æ®ï¼ŒORACLEå»ºè®®å¼€å‘ä¸­ä½¿ç”¨CLOBæ›¿ä»£LONGç±»åž‹ã€‚SQLåˆ†ç±»SQLï¼ˆStructured Query Languageï¼‰æ˜¯ç»“æž„åŒ–æŸ¥è¯¢è¯­è¨€çš„ç¼©å†™ã€‚å¯åˆ†ä¸ºï¼šæ•°æ®å®šä¹‰è¯­è¨€ï¼ˆDDL Data Definition Languageï¼‰ï¼šç”¨äºŽå»ºç«‹ï¼Œä¿®æ”¹å’Œåˆ é™¤æ•°æ®åº“å¯¹è±¡ã€‚åŒ…å«ï¼šCREATEï¼šåˆ›å»ºè¡¨æˆ–å…¶ä»–å¯¹è±¡çš„ç»“æž„ã€‚ALTER: ä¿®æ”¹è¡¨æˆ–å…¶ä»–å¯¹è±¡çš„ç»“æž„ã€‚DROPï¼šåˆ é™¤è¡¨æˆ–å…¶ä»–å¯¹è±¡çš„ç»“æž„ã€‚TRUNCATEï¼šåˆ é™¤è¡¨æ•°æ®ï¼Œä¿ç•™è¡¨ç»“æž„ã€‚CREATEè¯­å¥åˆ›å»ºè¡¨æ ¼ï¼š12345678910111213141516171819202122SQL&gt; create table employee ( 2 id NUMBER(10) not null, 3 name VARCHAR2(20), 4 gender CHAR(1), 5 birth DATE, 6 salary NUMBER(6,2), 7 job VARCHAR2(30), 8 deptno NUMBER(2) 9 );è¡¨å·²åˆ›å»ºã€‚SQL&gt; desc employee; åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- ID NOT NULL NUMBER(10) NAME VARCHAR2(20) GENDER CHAR(1) BIRTH DATE SALARY NUMBER(6,2) JOB VARCHAR2(30) DEPTNO NUMBER(2)ä¿®æ”¹è¡¨åï¼š123SQL&gt; RENAME employee TO employee1;è¡¨å·²é‡å‘½åã€‚å¢žåŠ åˆ—ï¼šåœ¨å»ºè¡¨ä¹‹åŽï¼Œè¦ç»™è¡¨å¢žåŠ åˆ—å¯ä»¥ä½¿ç”¨ALTER TABLEçš„ADDå­å¥å®žçŽ°ã€‚å¦‚åœ¨employee1è¡¨æœ€åŽé¢å¢žåŠ ä¸€åˆ—ï¼š123456789101112131415SQL&gt; ALTER TABLE employee1 ADD(hiredate DATE DEFAULT SYSDATE);è¡¨å·²æ›´æ”¹ã€‚SQL&gt; desc employee1 åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- ID NOT NULL NUMBER(10) NAME VARCHAR2(20) GENDER CHAR(1) BIRTH DATE SALARY NUMBER(6,2) JOB VARCHAR2(30) DEPTNO NUMBER(2) HIREDATE DATEåˆ é™¤åˆ—ï¼šåˆ é™¤employee1è¡¨ä¸­çš„hiredateåˆ—ï¼š123SQL&gt; ALTER TABLE employee1 DROP(hiredate);è¡¨å·²æ›´æ”¹ã€‚åˆ é™¤æ‰€æœ‰è¡¨æ•°æ®ï¼Œä¿ç•™ç»“æž„ï¼š123SQL&gt; truncate TABLE employee1;è¡¨è¢«æˆªæ–­ã€‚TRUNCATE TABLEåœ¨åŠŸèƒ½ä¸Šä¸Žä¸å¸¦WHEREå­å¥çš„DELETEè¯­å¥ç›¸åŒï¼šäºŒè€…å‡åˆ é™¤è¡¨ä¸­çš„å…¨éƒ¨è¡Œã€‚ä½†TRUNCATE TABLEæ¯”DELETEé€Ÿåº¦å¿«ï¼Œä¸”ä½¿ç”¨çš„ç³»ç»Ÿå’Œäº‹åŠ¡æ—¥å¿—èµ„æºå°‘ã€‚DELETEè¯­å¥æ¯æ¬¡åˆ é™¤ä¸€è¡Œï¼Œå¹¶åœ¨äº‹åŠ¡æ—¥å¿—ä¸­ä¸ºæ‰€åˆ é™¤çš„æ¯è¡Œè®°å½•ä¸€é¡¹ã€‚ä¿®æ”¹åˆ—ï¼šå»ºè¡¨ä¹‹åŽï¼Œå¯ä»¥æ”¹å˜è¡¨ä¸­åˆ—çš„æ•°æ®ç±»åž‹ã€é•¿åº¦å’Œé»˜è®¤å€¼ï¼Œæ³¨æ„è¿™ç§ä¿®æ”¹ä»…å¯¹ä»¥åŽæ’å…¥çš„æ•°æ®æœ‰æ•ˆï¼Œå¦å¤–å¦‚æžœè¡¨ä¸­å·²ç»æœ‰æ•°æ®çš„æƒ…å†µä¸‹ï¼ŒæŠŠé•¿åº¦ç”±å¤§æ”¹å°ï¼Œæœ‰å¯èƒ½ä¸æˆåŠŸï¼Œæ¯”å¦‚åŽŸæ¥çš„ç±»åž‹æ˜¯VARCHAR2(100)ï¼Œå…¶ä¸­å·²ç»å­˜æ”¾äº†100ä¸ªå­—èŠ‚é•¿åº¦çš„æ•°æ®ï¼Œå¦‚æžœè¦æ”¹ä¸ºVARCHAR2(80)ï¼Œåˆ™ä¸ä¼šä¿®æ”¹æˆåŠŸã€‚ä¿®æ”¹è¡¨employee1çš„åˆ—jobï¼Œå¹¶å¢žåŠ é»˜è®¤å€¼çš„è®¾ç½®ï¼š123SQL&gt; ALTER TABLE employee1 MODIFY(job VARCHAR2(40) DEFAULT 'manager');è¡¨å·²æ›´æ”¹ã€‚åˆ é™¤è¡¨ï¼š1234567SQL&gt; drop table employee1;è¡¨å·²åˆ é™¤ã€‚SQL&gt; desc employee1;ERROR:ORA-04043: å¯¹è±¡ employee1 ä¸å­˜åœ¨æ•°æ®æ“çºµè¯­è¨€ï¼ˆDML Data Manipulation Languageï¼‰ï¼šç”¨äºŽæ”¹å˜æ•°æ®è¡¨ä¸­çš„æ•°æ®ï¼Œå’Œäº‹åŠ¡ç›¸å…³ï¼Œæ‰§è¡Œå®ŒåŽéœ€è¦é€šè¿‡äº‹åŠ¡æŽ§åˆ¶è¯­å¥æäº¤åŽæ‰çœŸæ­£çš„å°†æ”¹å˜åº”ç”¨åˆ°æ•°æ®åº“ä¸­ã€‚åŒ…æ‹¬ï¼šINSERTï¼šå°†æ•°æ®æ’å…¥åˆ°æ•°æ®è¡¨ä¸­ã€‚UPDATEï¼šæ›´æ–°æ•°æ®è¡¨ä¸­å·²å­˜åœ¨çš„æ•°æ®ã€‚DELETEï¼šåˆ é™¤æ•°æ®è¡¨ä¸­çš„æ•°æ®ã€‚äº‹åŠ¡æŽ§åˆ¶è¯­è¨€ï¼ˆTCL Transaction Control Languageï¼‰ï¼šç”¨æ¥ç»´æŠ¤æ•°æ®ä¸€è‡´æ€§çš„è¯­å¥ã€‚åŒ…æ‹¬ï¼šCOMMITï¼šæäº¤ï¼Œç¡®è®¤å·²ç»è¿›è¡Œçš„æ•°æ®æ”¹å˜ã€‚ROLLBACKï¼šå›žæ»šï¼Œå–æ¶ˆå·²ç»è¿›è¡Œçš„æ•°æ®æ”¹å˜ã€‚SAVEPOINTï¼šä¿å­˜ç‚¹ï¼Œä½¿å½“å‰çš„äº‹åŠ¡å¯ä»¥å›žé€€åˆ°æŒ‡å®šçš„ä¿å­˜ç‚¹ï¼Œä¾¿äºŽå–æ¶ˆéƒ¨åˆ†æ”¹å˜ã€‚æ•°æ®æŸ¥è¯¢è¯­è¨€ï¼ˆDQL Data Query Languageï¼‰ï¼šç”¨æ¥æŸ¥è¯¢éœ€è¦çš„æ•°æ®ã€‚SELECTè¯­å¥ã€‚æ•°æ®æŽ§åˆ¶è¯­è¨€ï¼ˆDCL Data Control Languageï¼‰ï¼šç”¨äºŽæ‰§è¡Œæƒé™çš„æŽˆäºˆä¸Žå›žæ”¶å·¥ä½œã€‚åŒ…æ‹¬ï¼šGRANTï¼šæŽˆäºˆï¼Œç”¨äºŽç»™ç”¨æˆ·æˆ–è§’è‰²æŽˆäºˆæƒé™ã€‚REVOKEï¼šç”¨äºŽæ”¶å›žç”¨æˆ·æˆ–è§’è‰²çš„æƒé™ã€‚CREATE USERï¼šåˆ›å»ºç”¨æˆ·ã€‚SQLåŸºç¡€æŸ¥è¯¢FROMå­å¥SELECTç”¨äºŽæŒ‡å®šè¦æŸ¥è¯¢çš„åˆ—ï¼ŒFROMæŒ‡å®šè¦ä»Žå“ªä¸ªè¡¨ä¸­æŸ¥è¯¢ã€‚å¦‚æžœè¦æŸ¥è¯¢æ‰€æœ‰åˆ—ï¼Œå¯ä»¥åœ¨SELECTåŽé¢ä½¿ç”¨*å·ï¼Œå¦‚æžœåªæŸ¥è¯¢ç‰¹å®šçš„åˆ—ï¼Œå¯ä»¥ç›´æŽ¥åœ¨SELECTåŽé¢æŒ‡å®šåˆ—åï¼Œåˆ—åä¹‹é—´ç”¨é€—å·éš”å¼€ã€‚åˆ—çš„åˆ«åå½“æˆ‘ä»¬æŸ¥è¯¢çš„å†…å®¹ä¸æ˜¯ä¸€ä¸ªå•çº¯çš„åˆ—ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæˆ–è€…è¡¨è¾¾å¼ï¼Œé‚£ä¹ˆåœ¨ç»“æžœé›†ä¸­è¯¥å­—æ®µå¯¹åº”çš„å­—æ®µåå°±æ˜¯è¿™ä¸ªå‡½æ•°æˆ–è€…è¡¨è¾¾å¼ã€‚è¿™æ ·ä¸å¤Ÿæ¸…æ™°ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥å•ç‹¬æŒ‡å®šåˆ«åï¼Œè¿™æ ·åœ¨ç»“æžœé›†ä¸­è¯¥å­—æ®µçš„åå­—å°±æ˜¯è¿™ä¸ªåˆ«åã€‚è‹¥æƒ³æ˜¾ç¤ºè‡ªå·±æƒ³è¦çš„å†…å®¹ï¼Œä½¿ç”¨åŒå¼•å·ã€‚å…¶ä¸­â€ASâ€å¯ä»¥çœç•¥ã€‚123456789101112131415SQL&gt; SELECT ename,sal*12 as "å¹´è–ª",job from emp;ENAME å¹´è–ª JOB---------- ---------- ---------SMITH 9600 CLERKALLEN 19200 SALESMANWARD 15000 SALESMANJONES 35700 MANAGERMARTIN 15000 SALESMANBLAKE 34200 MANAGERCLARK 29400 MANAGERSCOTT 36000 ANALYSTKING 60000 PRESIDENTTURNER 18000 SALESMANADAMS 13200 CLERKAND,ORä¸Žå’Œæˆ–ã€‚ANDä¼˜å…ˆçº§é«˜äºŽORï¼Œå¯ä»¥ç”¨æ‹¬å·æé«˜ä¼˜å…ˆçº§ã€‚123456789101112131415161718SQL&gt; select ename,sal,job from emp where sal &gt; 1000 or job = 'CLERK';ENAME SAL JOB---------- ---------- ---------SMITH 800 CLERKALLEN 1600 SALESMANWARD 1250 SALESMANJONES 2975 MANAGERMARTIN 1250 SALESMANBLAKE 2850 MANAGERCLARK 2450 MANAGERSCOTT 3000 ANALYSTKING 5000 PRESIDENTTURNER 1500 SALESMANADAMS 1100 CLERKJAMES 950 CLERKFORD 3000 ANALYSTMILLER 1300 CLERKLIKEç”¨äºŽæ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ”¯æŒä¸¤ä¸ªé€šé…ç¬¦ï¼Œ%ï¼šè¡¨ç¤º0åˆ°å¤šä¸ªå­—ç¬¦ï¼Œ_è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚1234567SQL&gt; select ename,sal,job from emp where ename like '_L%';ENAME SAL JOB---------- ---------- ---------ALLEN 1600 SALESMANBLAKE 2850 MANAGERCLARK 2450 MANAGERIN,NOT INåœ¨WHEREå­å¥ä¸­å¯ä»¥ç”¨æ¯”è¾ƒæ“ä½œç¬¦IN(list)æ¥å–å‡ºç¬¦åˆåˆ—è¡¨èŒƒå›´ä¸­çš„æ•°æ®ã€‚å…¶ä¸­çš„å‚æ•°listè¡¨ç¤ºå€¼åˆ—è¡¨ï¼Œå½“åˆ—æˆ–è¡¨è¾¾å¼åŒ¹é…äºŽåˆ—è¡¨ä¸­çš„ä»»ä½•ä¸€ä¸ªå€¼æ—¶ï¼Œæ¡ä»¶ä¸ºTRUEï¼Œè¯¥æ¡è®°å½•åˆ™è¢«æ˜¾ç¤ºå‡ºæ¥ã€‚INä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªèŒƒå›´æ¯”è¾ƒæ“ä½œç¬¦ï¼Œåªä¸è¿‡è¿™ä¸ªèŒƒå›´æ˜¯ä¸€ä¸ªæŒ‡å®šçš„å€¼åˆ—è¡¨ï¼ŒNOT IN(list)å–å‡ºä¸ç¬¦åˆæ­¤åˆ—è¡¨ä¸­çš„æ•°æ®è®°å½•ã€‚123456789101112SQL&gt; select ename,sal,job from emp where job in('CLERK','SALESMAN');ENAME SAL JOB---------- ---------- ---------SMITH 800 CLERKALLEN 1600 SALESMANWARD 1250 SALESMANMARTIN 1250 SALESMANTURNER 1500 SALESMANADAMS 1100 CLERKJAMES 950 CLERKMILLER 1300 CLERKBETWEEN AND1234567891011SQL&gt; select ename,sal,job from emp where sal between 1500 and 3000;ENAME SAL JOB---------- ---------- ---------ALLEN 1600 SALESMANJONES 2975 MANAGERBLAKE 2850 MANAGERCLARK 2450 MANAGERSCOTT 3000 ANALYSTTURNER 1500 SALESMANFORD 3000 ANALYSTANY,ALLå½“æˆ‘ä»¬éœ€è¦åˆ¤æ–­å†…å®¹&gt;ï¼Œ&gt;=ï¼Œ&lt;ï¼Œ&lt;=ä¸€ä¸ªåˆ—è¡¨ä¸­çš„å¤šä¸ªå€¼æ—¶ï¼Œéœ€è¦ç»“åˆANYæˆ–ALLæ¥ä½¿ç”¨ã€‚ANY(LIST)ï¼šå¤§äºŽåˆ—è¡¨ä¸­å…¶ä¸­ä¹‹ä¸€å³å¯ï¼Œå³å¤§äºŽæœ€å°çš„ï¼›ALL(LIST)ï¼šå¤§äºŽåˆ—è¡¨ä¸­æ‰€æœ‰ï¼Œå³å¤§äºŽæœ€å¤§çš„ã€‚åˆ—è¡¨ä¸­çš„å†…å®¹é€šå¸¸ä¸æ˜¯å›ºå®šå€¼ï¼Œè€Œæ˜¯ä¸€ä¸ªæŸ¥è¯¢ç»“æžœé›†ï¼Œæ‰€ä»¥å¸¸åœ¨å­æŸ¥è¯¢ä¸­ï¼Œä¸ŽINé“ç†ä¸€æ ·ã€‚å¦‚æŸ¥è¯¢è°çš„è–ªæ°´æ¯”FORDé«˜ï¼Ÿå¦‚æžœæœ‰å¤šä¸ªåŒåï¼Œæ¯”ä»»ä½•ä¸€ä¸ªå«FORDçš„äººé«˜å°±è¡Œï¼š12345SQL&gt; select ename from emp where sal &gt; any(select sal from emp where ename = 'FORD');ENAME----------KINGæŸ¥è¯¢æ¡ä»¶ä¸­ä½¿ç”¨è¡¨è¾¾å¼å’Œå‡½æ•°å½“æŸ¥è¯¢éœ€è¦å¯¹é€‰å‡ºçš„å­—æ®µè¿›è¡Œè¿›ä¸€æ­¥è®¡ç®—ï¼Œå¯ä»¥åœ¨æ•°å­—åˆ—ä¸Šä½¿ç”¨ç®—æœ¯è¡¨è¾¾å¼(+ã€-ã€*ã€/)ã€‚è¡¨è¾¾å¼ç¬¦åˆå››åˆ™è¿ç®—çš„é»˜è®¤ä¼˜å…ˆçº§ï¼Œå¦‚æžœè¦æ”¹å˜ä¼˜å…ˆçº§å¯ä»¥ä½¿ç”¨æ‹¬å·ã€‚ç®—æœ¯è¿ç®—ä¸»è¦æ˜¯é’ˆå¯¹æ•°å­—ç±»åž‹çš„æ•°æ®ï¼Œå¯¹æ—¥æœŸç±»åž‹çš„æ•°æ®å¯ä»¥åšåŠ å‡æ“ä½œï¼Œè¡¨ç¤ºåœ¨ä¸€ä¸ªæ—¥æœŸå€¼ä¸ŠåŠ æˆ–å‡ä¸€ä¸ªå¤©æ•°ã€‚æŸ¥è¯¢æ¡ä»¶ä¸­ä¸èƒ½ä½¿ç”¨èšåˆå‡½æ•°ï¼æŸ¥è¯¢æ¡ä»¶ä¸­ä½¿ç”¨ç®—æ•°è¡¨è¾¾å¼ï¼ŒæŸ¥è¯¢å¹´è–ªå¤§äºŽ5wå…ƒçš„å‘˜å·¥è®°å½•ï¼š12345SQL&gt; select ename,sal,job from emp where sal*12 &gt; 50000;ENAME SAL JOB---------- ---------- ---------KING 5000 PRESIDENTORDER BYä½¿ç”¨ORDER BYå­—å¥ï¼šç”¨äºŽå¯¹ç»“æžœå³æŒ‰ç…§æŒ‡å®šçš„å­—æ®µçš„å€¼å‡åºæˆ–è€…é™åºè¿›è¡ŒæŽ’åºã€‚ASCï¼šå‡åºï¼Œé»˜è®¤ä¹Ÿæ˜¯ASCï¼›DESCï¼šé™åºã€‚æŸ¥çœ‹å·¥èµ„æŽ’åï¼š123456789101112131415161718SQL&gt; select ename,sal,job from emp order by sal;ENAME SAL JOB---------- ---------- ---------SMITH 800 CLERKJAMES 950 CLERKADAMS 1100 CLERKWARD 1250 SALESMANMARTIN 1250 SALESMANMILLER 1300 CLERKTURNER 1500 SALESMANALLEN 1600 SALESMANCLARK 2450 MANAGERBLAKE 2850 MANAGERJONES 2975 MANAGERSCOTT 3000 ANALYSTFORD 3000 ANALYSTKING 5000 PRESIDENTè‹¥æŽ’åºçš„å­—æ®µä¸­æœ‰NULLå€¼ï¼ŒNULLè¢«è§†ä¸ºæœ€å¤§å€¼ã€‚å½“å¤šä¸ªå­—æ®µè¿›è¡ŒæŽ’åºæ—¶ï¼Œ æ¯ä¸ªå­—æ®µå¯ä»¥åˆ†åˆ«æŒ‡å®šå‡é™åºï¼Œå¹¶ä¸”æŽ’åºé¡ºåºæŒ‰ç…§ç¬¬ä¸€ä¸ªå­—æ®µä¼˜å…ˆæŽ’åºï¼Œåªæœ‰ç¬¬ä¸€ä¸ªå­—æ®µå€¼ç›¸åŒæ—¶æ‰æŒ‰ç…§ç¬¬äºŒä¸ªå­—æ®µæŽ’åºï¼Œä»¥æ­¤ç±»æŽ¨ã€‚12345678910111213141516171819SQL&gt; select ename,sal,job,deptno from emp 2 order by deptno desc,sal desc;ENAME SAL JOB DEPTNO---------- ---------- --------- ----------BLAKE 2850 MANAGER 30ALLEN 1600 SALESMAN 30TURNER 1500 SALESMAN 30WARD 1250 SALESMAN 30MARTIN 1250 SALESMAN 30JAMES 950 CLERK 30FORD 3000 ANALYST 20SCOTT 3000 ANALYST 20JONES 2975 MANAGER 20ADAMS 1100 CLERK 20SMITH 800 CLERK 20KING 5000 PRESIDENT 10CLARK 2450 MANAGER 10MILLER 1300 CLERK 10èšåˆå‡½æ•°ï¼ˆåˆ†ç»„å‡½æ•°ï¼Œç»„å‡½æ•°ï¼‰æŸ¥è¯¢æ—¶éœ€è¦åšä¸€äº›æ•°æ®ç»Ÿè®¡ï¼Œæ¯”å¦‚ï¼šæŸ¥è¯¢èŒå‘˜è¡¨ä¸­å„éƒ¨é—¨èŒå‘˜çš„å¹³å‡è–ªæ°´ï¼Œå„éƒ¨é—¨çš„å‘˜å·¥äººæ•°ã€‚å½“éœ€è¦ç»Ÿè®¡çš„æ•°æ®å¹¶ä¸èƒ½åœ¨èŒå‘˜è¡¨é‡Œç›´è§‚åˆ—å‡ºï¼Œè€Œæ˜¯éœ€è¦æ ¹æ®çŽ°æœ‰çš„æ•°æ®è®¡ç®—å¾—åˆ°ç»“æžœï¼Œè¿™ç§åŠŸèƒ½å¯ä»¥ä½¿ç”¨èšåˆå‡½æ•°æ¥å®žçŽ°ï¼Œå³ï¼šå°†è¡¨çš„å…¨éƒ¨æ•°æ®åˆ’åˆ†ä¸ºå‡ ç»„æ•°æ®ï¼Œæ¯ç»„æ•°æ®ç»Ÿè®¡å‡ºä¸€ä¸ªç»“æžœã€‚å› ä¸ºæ˜¯å¤šè¡Œæ•°æ®å‚ä¸Žè¿ç®—è¿”å›žä¸€è¡Œç»“æžœï¼Œä¹Ÿç§°ä½œåˆ†ç»„å‡½æ•°ã€å¤šè¡Œå‡½æ•°ã€é›†åˆå‡½æ•°ã€‚ç”¨åˆ°çš„å…³é”®å­—ï¼šGOURP BY æŒ‰ä»€ä¹ˆåˆ†ç»„ã€‚HAVING è¿›ä¸€æ­¥é™åˆ¶åˆ†ç»„ç»“æžœã€‚èšåˆå‡½æ•°æ˜¯å¿½ç•¥NULLå€¼çš„ã€‚1ã€MAXå’ŒMINç”¨æ¥å–å¾—åˆ—æˆ–è¡¨è¾¾å¼çš„æœ€å¤§ã€æœ€å°å€¼ï¼Œå¯ä»¥ç”¨æ¥ç»Ÿè®¡ä»»ä½•æ•°æ®ç±»åž‹ï¼ŒåŒ…æ‹¬æ•°å­—ã€å­—ç¬¦å’Œæ—¥æœŸã€‚è®¡ç®—æœ€æ—©å’Œæœ€æ™šçš„å…¥èŒæ—¶é—´ï¼Œå‚æ•°æ˜¯æ—¥æœŸï¼š12345SQL&gt; select max(hiredate),min(hiredate) from emp;MAX(HIREDATE) MIN(HIREDATE)-------------- --------------23-5æœˆ -87 17-12æœˆ-802ã€AVGå’ŒSUMAVGå’ŒSUMå‡½æ•°ç”¨æ¥ç»Ÿè®¡åˆ—æˆ–è¡¨è¾¾å¼çš„å¹³å‡å€¼å’Œå’Œå€¼ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°åªèƒ½æ“ä½œæ•°å­—ç±»åž‹ï¼Œå¹¶å¿½ç•¥NULLå€¼ã€‚ç»Ÿè®¡æ‰€æœ‰å‘˜å·¥çš„æ€»å·¥èµ„å’Œå¹³å‡å·¥èµ„ï¼š12345SQL&gt; select avg(sal) avg_sal,sum(sal) sum_sal from emp; AVG_SAL SUM_SAL---------- ----------2073.21429 290253ã€COUNTCOUNTå‡½æ•°ç”¨æ¥è®¡ç®—è¡¨ä¸­çš„è®°å½•æ¡æ•°ï¼ŒåŒæ ·å¿½ç•¥NULLå€¼ã€‚ä¾‹å¦‚èŽ·å–èŒå‘˜è¡¨ä¸­ä¸€å…±æœ‰å¤šå°‘åèŒå‘˜è®°å½•ï¼š12345SQL&gt; select count(1) from emp; COUNT(1)---------- 14åˆ†ç»„1ã€GROUP BYå­å¥å…¶æ˜¯ä¸ºèšåˆå‡½æ•°æœåŠ¡çš„ï¼Œå¯ä»¥åœ¨ç»Ÿè®¡æ•°æ®æ—¶ç»†åŒ–åˆ†ç»„ã€‚ä»–å…è®¸å°†æŸä¸ªå­—æ®µå€¼ä¸€æ ·çš„è®°å½•çœ‹æˆä¸€ç»„ï¼Œç„¶åŽè¿›è¡Œç»Ÿè®¡ã€‚è€Œä¸æ˜¯å°†æ•´å¼ è¡¨æ‰€æœ‰è®°å½•çœ‹æˆä¸€ç»„ï¼Œé‚£ä¹ˆæ¯ç»„å¯ä»¥å‡ºä¸€ä¸ªç»Ÿè®¡ç»“æžœã€‚æŸ¥çœ‹æ¯ä¸ªéƒ¨é—¨çš„æœ€é«˜å·¥èµ„ï¼Œæœ€ä½Žå·¥èµ„ï¼š12345678SQL&gt; select deptno "éƒ¨é—¨", max(sal) "æœ€é«˜å·¥èµ„",min(sal) "æœ€ä½Žå·¥èµ„" 2 from emp group by deptno; éƒ¨é—¨ æœ€é«˜å·¥èµ„ æœ€ä½Žå·¥èµ„---------- ---------- ---------- 30 2850 950 20 3000 800 10 5000 1300SQLè¯­æ³•è¦æ±‚ï¼šé™¤äº†èšåˆå‡½æ•°ï¼Œå…¶ä»–ä¸åœ¨GROUP BYå­å¥ä¸­çš„åˆ—åï¼Œä¸èƒ½å‡ºçŽ°åœ¨SELECTè¯­å¥åŽé¢ã€‚GROUP BYè¿›è¡Œåˆ†ç»„çš„å­—æ®µåº”åœ¨æ•´å¼ è¡¨ä¸­æœ‰é‡å¤æ•°æ®ï¼Œå¦åˆ™åˆ†ç»„æ¯›æœ‰æ„ä¹‰GROUP BYå­å¥åŽé¢å…è®¸æŒ‡å®šå¤šä¸ªå­—æ®µï¼Œé‚£ä¹ˆæ˜¯æŒ‰ç…§è¿™äº›å­—æ®µå€¼çš„ç»„åˆç›¸åŒçš„è®°å½•çœ‹ä½œä¸€ç»„ã€‚æŸ¥çœ‹æ¯ä¸ªéƒ¨é—¨æ¯ç§èŒä½çš„å¹³å‡å·¥èµ„ä»¥åŠå·¥èµ„æ€»å’Œï¼š1234567891011121314SQL&gt; select deptno,job,avg(sal),sum(sal) 2 from emp group by deptno,job; DEPTNO JOB AVG(SAL) SUM(SAL)---------- --------- ---------- ---------- 20 CLERK 950 1900 30 SALESMAN 1400 5600 20 MANAGER 2975 2975 30 CLERK 950 950 10 PRESIDENT 5000 5000 30 MANAGER 2850 2850 10 CLERK 1300 1300 10 MANAGER 2450 2450 20 ANALYST 3000 60002ã€HAVINGå­—å¥HAVING ä¹Ÿæ˜¯ç”¨äºŽæ·»åŠ è¿‡æ»¤æ¡ä»¶çš„ï¼Œå®ƒçš„è¿‡æ»¤å®žé™…æ˜¯åœ¨ç»Ÿè®¡ç»“æžœä¹‹åŽè¿›è¡Œçš„ï¼Œæ‰€ä»¥HAVINGæ˜¯ä¸ºç»Ÿè®¡ç»“æžœè¿›è¡Œè¿‡æ»¤ä½¿ç”¨çš„ï¼Œå…¶ä¸èƒ½ç‹¬ç«‹å‡ºçŽ°ï¼Œå¿…é¡»è·Ÿåœ¨GROUP BYå­å¥åŽé¢ã€‚æŸ¥çœ‹å¹³å‡å·¥èµ„å¤§äºŽ2000çš„éƒ¨é—¨ï¼š1234567SQL&gt; select deptno,avg(sal) from emp 2 group by deptno having avg(sal) &gt; 2000; DEPTNO AVG(SAL)---------- ---------- 20 2175 10 2916.66667HAVINGå­å¥è§£å†³äº†WHEREå­å¥åŽé¢ä¸èƒ½è·Ÿèšåˆå‡½æ•°çš„é—®é¢˜ï¼š123456SQL&gt; select deptno,avg(sal) from emp where avg(sal) &gt; 2000 2 group by deptno;select deptno,avg(sal) from emp where avg(sal) &gt; 2000 *ç¬¬ 1 è¡Œå‡ºçŽ°é”™è¯¯:ORA-00934: æ­¤å¤„ä¸å…è®¸ä½¿ç”¨åˆ†ç»„å‡½æ•°è¯¥è¯­å¥ä¼šæŠ¥é”™ï¼ŒåŽŸå› åœ¨äºŽæˆ‘ä»¬çš„è¿‡æ»¤æ¡ä»¶æ˜¯å¹³å‡å·¥èµ„é«˜äºŽ2000ï¼Œè€ŒWHEREçš„è¿‡æ»¤æ—¶æœºåœ¨äºŽï¼šç¬¬ä¸€æ¬¡ä»Žè¡¨ä¸­æŸ¥è¯¢æ•°æ®æ—¶è¿›è¡Œè¿‡æ»¤ï¼Œåªæœ‰æ»¡è¶³WHEREæ¡ä»¶çš„è®°å½•æ‰ä¼šè¢«æŸ¥è¯¢å‡ºæ¥ã€‚è€Œåˆ¤æ–­å¹³å‡å·¥èµ„é«˜äºŽ2000ï¼Œé¦–å…ˆå¹³å‡å·¥èµ„ç»Ÿè®¡æ˜¯å»ºç«‹åœ¨æ•°æ®æŸ¥è¯¢å‡ºæ¥çš„åŸºç¡€ä¸Šçš„ï¼Œæ‰€ä»¥è¿™æ—¶WHEREå·²ç»å®Œæˆäº†è¿‡æ»¤ã€‚æ”¹ä½¿ç”¨HVING å­å¥å°±å¯è§£å†³ã€‚æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œé¡ºåºå½“ä¸€æ¡æŸ¥è¯¢è¯­å¥ä¸­åŒ…å«æ‰€æœ‰çš„å­å¥ï¼Œæ‰§è¡Œé¡ºåºä¾ä¸‹åˆ—å­å¥æ¬¡åºï¼šFROM å­å¥ï¼šæ‰§è¡Œé¡ºåºä¸ºä»ŽåŽå¾€å‰ã€ä»Žå³åˆ°å·¦ã€‚æ•°æ®é‡è¾ƒå°‘çš„è¡¨å°½é‡æ”¾åœ¨åŽé¢ã€‚WHEREå­å¥ï¼šæ‰§è¡Œé¡ºåºä¸ºè‡ªä¸‹è€Œä¸Šã€ä»Žå³åˆ°å·¦ã€‚å°†èƒ½è¿‡æ»¤æŽ‰æœ€å¤§æ•°é‡è®°å½•çš„æ¡ä»¶å†™åœ¨WHERE å­å¥çš„æœ€å³ã€‚GROUP BYï¼šæ‰§è¡Œé¡ºåºä»Žå·¦å¾€å³åˆ†ç»„ï¼Œæœ€å¥½åœ¨GROUP BYå‰ä½¿ç”¨WHEREå°†ä¸éœ€è¦çš„è®°å½•åœ¨GROUP BYä¹‹å‰è¿‡æ»¤æŽ‰ã€‚HAVING å­å¥ï¼šæ¶ˆè€—èµ„æºã€‚å°½é‡é¿å…ä½¿ç”¨ï¼ŒHAVING ä¼šåœ¨æ£€ç´¢å‡ºæ‰€æœ‰è®°å½•ä¹‹åŽæ‰å¯¹ç»“æžœé›†è¿›è¡Œè¿‡æ»¤ï¼Œéœ€è¦æŽ’åºç­‰æ“ä½œã€‚SELECTå­å¥ï¼šå°‘ç”¨*å·ï¼Œå°½é‡å–å­—æ®µåç§°ã€‚ORACLE åœ¨è§£æžçš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æŸ¥è¯¢æ•°æ®å­—å…¸å°†*å·ä¾æ¬¡è½¬æ¢æˆæ‰€æœ‰çš„åˆ—åï¼Œæ¶ˆè€—æ—¶é—´ã€‚ORDER BYå­å¥ï¼šæ‰§è¡Œé¡ºåºä¸ºä»Žå·¦åˆ°å³æŽ’åºï¼Œæ¶ˆè€—èµ„æºã€‚SQLå…³è”æŸ¥è¯¢å…³è”æŸ¥è¯¢å½“ä»Žå¤šå¼ è¡¨æŸ¥è¯¢æ•°æ®æ—¶ï¼Œæˆ‘ä»¬ä¼šå»ºç«‹å…³è”å…³ç³»ç„¶åŽåœ¨å¼ è¡¨ä¸­è¿›è¡ŒæŸ¥è¯¢å·¥ä½œï¼Œé‡ç‚¹å°±æ˜¯å¦‚ä½•æŒ‡å®šè¿™äº›è¡¨ä¸­æ•°æ®çš„å¯¹åº”å…³ç³»(å…³è”å…³ç³»)ï¼ŒNå¼ è¡¨æŸ¥è¯¢æ—¶è‡³å°‘è¦æœ‰N-1ä¸ªè¿žæŽ¥æ¡ä»¶ã€‚æŸ¥è¯¢æ¯ä¸ªå‘˜å·¥çš„åå­—ï¼Œå·¥èµ„ï¼Œä»¥åŠéƒ¨é—¨åç§°å’Œæ‰€åœ¨åœ°ï¼š1234567891011121314151617181920SQL&gt; select e.ename,e.deptno,d.dname,d.loc 2 from emp e join dept d 3 on(d.deptno = e.deptno);ENAME DEPTNO DNAME LOC---------- ---------- -------------- -------------CLARK 10 ACCOUNTING NEW YORKKING 10 ACCOUNTING NEW YORKMILLER 10 ACCOUNTING NEW YORKJONES 20 RESEARCH DALLASFORD 20 RESEARCH DALLASADAMS 20 RESEARCH DALLASSMITH 20 RESEARCH DALLASSCOTT 20 RESEARCH DALLASWARD 30 SALES CHICAGOTURNER 30 SALES CHICAGOALLEN 30 SALES CHICAGOJAMES 30 SALES CHICAGOBLAKE 30 SALES CHICAGOMARTIN 30 SALES CHICAGOæˆ–è€…ï¼š123SQL&gt; select e.ename,e.deptno,d.dname,d.loc 2 from emp e,dept d 3 where e.deptno = d.deptno;å†…è¿žæŽ¥å†…è¿žæŽ¥åªè¿”å›žä¸¤ä¸ªå…³è”è¡¨ä¸­æ‰€æœ‰æ»¡è¶³è¿žæŽ¥æ¡ä»¶çš„è®°å½•ã€‚å¤–è¿žæŽ¥å†…è¿žæŽ¥è¿”å›žä¸¤ä¸ªè¡¨ä¸­æ‰€æœ‰æ»¡è¶³è¿žæŽ¥æ¡ä»¶çš„æ•°æ®è®°å½•ï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œéœ€è¦è¿”å›žé‚£äº›ä¸æ»¡è¶³è¿žæŽ¥æ¡ä»¶çš„è®°å½•ï¼Œéœ€è¦ä½¿ç”¨å¤–è¿žæŽ¥ï¼Œå³ä¸ä»…è¿”å›žæ»¡è¶³è¿žæŽ¥æ¡ä»¶çš„è®°å½•ï¼Œè¿˜å°†è¿”å›žä¸æ»¡è¶³è¿žæŽ¥æ¡ä»¶çš„è®°å½•ã€‚å°†å‘˜å·¥SOCTTçš„éƒ¨é—¨å·æ”¹ä¸º50ï¼š12SQL&gt; update emp set deptno = 50 2 where ename = 'SCOTT';æ‰§è¡Œä¸‹é¢è¯­å¥ï¼š123456789101112131415161718192021SQL&gt; select e.ename,d.dname 2 from emp e join dept d 3 on(e.deptno = d.deptno);ENAME DNAME---------- --------------CLARK ACCOUNTINGKING ACCOUNTINGMILLER ACCOUNTINGJONES RESEARCHFORD RESEARCHADAMS RESEARCHSMITH RESEARCHWARD SALESTURNER SALESALLEN SALESJAMES SALESBLAKE SALESMARTIN SALESå·²é€‰æ‹©13è¡Œã€‚ä¼šå‘çŽ°SCOTTå‘˜å·¥æ²¡æœ‰è¢«æŸ¥è¯¢å‡ºæ¥ï¼ŒåŽŸå› æ˜¯å…¶ä¸æ»¡è¶³è¿žæŽ¥æ¡ä»¶ã€‚å¤–è¿žæŽ¥å…è®¸æˆ‘ä»¬åœ¨å…³è”æŸ¥è¯¢çš„æ—¶å€™ï¼Œä»¥ä¸€å¼ è¡¨ä½œä¸ºé©±åŠ¨è¡¨(æ•°æ®è¦æ˜¾ç¤ºå…¨)ã€‚è¯¥è¡¨çš„æ•°æ®å…¨éƒ¨ä¼šä½“çŽ°å†ç»“æžœé›†ä¸­ï¼Œä½†æ˜¯æ¥è‡ªå…³è”è¡¨ä¸­çš„å­—æ®µç”±äºŽä¸æ»¡è¶³è¿žæŽ¥æ¡ä»¶æ²¡æœ‰å¯¹åº”çš„è®°å½•ï¼Œæ‰€ä»¥å…¨éƒ¨å–NULLã€‚å¤–è¿žæŽ¥ä¸»è¦è§£å†³çš„é—®é¢˜å°±æ˜¯æ˜¾ç¤ºå†å…³è”æŸ¥è¯¢ä¸­ä¸æ»¡è¶³è¿žæŽ¥æ¡ä»¶çš„è®°å½•ã€‚å¤–è¿žæŽ¥åˆ†ä¸ºï¼šå·¦å¤–è¿žæŽ¥ï¼Œå³å¤–è¿žæŽ¥ï¼Œå…¨å¤–è¿žæŽ¥ã€‚ä½¿ç”¨å·¦å¤–è¿žæŽ¥æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯ï¼š12345678910111213141516171819202122SQL&gt; select e.ename,d.dname 2 from emp e left outer join dept d 3 on(e.deptno = d.deptno);ENAME DNAME---------- --------------MILLER ACCOUNTINGKING ACCOUNTINGCLARK ACCOUNTINGFORD RESEARCHADAMS RESEARCHJONES RESEARCHSMITH RESEARCHJAMES SALESTURNER SALESBLAKE SALESMARTIN SALESWARD SALESALLEN SALESSCOTTå·²é€‰æ‹©14è¡Œã€‚å¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶SCOTTä¸æ»¡è¶³è¿žæŽ¥æ¡ä»¶ï¼Œä½†ä¹Ÿå‡ºçŽ°åœ¨æŸ¥è¯¢ç»“æžœä¸­äº†ã€‚è‡ªè¿žæŽ¥å½“å‰è¡¨çš„ä¸€æ¡è®°å½•å¯¹åº”å½“å‰è¡¨çš„å¤šæ¡è®°å½•ï¼Œè‡ªè¿žæŽ¥çš„è®¾è®¡æ˜¯ä¸ºäº†è§£å†³åŒç±»åž‹æ•°æ®é—´åˆå­˜åœ¨ä¸Šä¸‹çº§å…³ç³»çš„æ ‘çŠ¶ç»“æž„çš„ä¿å­˜ä¸Žå…³è”ã€‚æŸ¥çœ‹å‘˜å·¥çš„åå­—ä»¥åŠä»–é¢†å¯¼çš„åå­—ï¼š12345678910111213141516171819SQL&gt; select e.ename "å‘˜å·¥",m.ename "é¢†å¯¼" 2 from emp e,emp m 3 where e.mgr = m.empno;å‘˜å·¥ é¢†å¯¼---------- ----------FORD JONESSCOTT JONESTURNER BLAKEALLEN BLAKEWARD BLAKEJAMES BLAKEMARTIN BLAKEMILLER CLARKADAMS SCOTTBLAKE KINGJONES KINGCLARK KINGSMITH FORDè‹¥æƒ³å°†æ²¡æœ‰é¢†å¯¼çš„äººä¹Ÿåˆ—å‡ºæ¥ï¼Œå¯ä»¥å°†ä»£ç æ”¹ä¸ºï¼š12345678910111213141516171819202122SQL&gt; select e.ename "å‘˜å·¥",m.ename "é¢†å¯¼" 2 from emp e,emp m 3 where e.mgr = m.empno(+);å‘˜å·¥ é¢†å¯¼---------- ----------FORD JONESSCOTT JONESJAMES BLAKETURNER BLAKEMARTIN BLAKEWARD BLAKEALLEN BLAKEMILLER CLARKADAMS SCOTTCLARK KINGBLAKE KINGJONES KINGSMITH FORDKINGå·²é€‰æ‹©14è¡Œã€‚ç­‰åŒäºŽï¼š12345678910111213141516171819202122SQL&gt; select e.ename "å‘˜å·¥",m.ename "é¢†å¯¼" 2 from emp e left join emp m 3 on(e.mgr = m.empno);å‘˜å·¥ é¢†å¯¼---------- ----------FORD JONESSCOTT JONESJAMES BLAKETURNER BLAKEMARTIN BLAKEWARD BLAKEALLEN BLAKEMILLER CLARKADAMS SCOTTCLARK KINGBLAKE KINGJONES KINGSMITH FORDKINGå·²é€‰æ‹©14è¡Œã€‚å­æŸ¥è¯¢å­æŸ¥è¯¢é€šå¸¸æ˜¯å°†å…¶æŸ¥è¯¢å‡ºæ¥çš„ç»“æžœé›†æä¾›ç»™å…¶ä»–SQLè¯­å¥ä½¿ç”¨ï¼Œé€šå¸¸åµŒå¥—åœ¨å®žé™…è¦è¿è¡Œçš„SQLè¯­å¥ä¹‹ä¸­ã€‚1ã€å­æŸ¥è¯¢åœ¨WHEREå­å¥ä¸­ã€‚åœ¨WHEREæŸ¥è¯¢æ¡ä»¶ä¸­çš„é™åˆ¶æ¡ä»¶ä¸æ˜¯ä¸€ä¸ªç¡®å®šçš„å€¼ï¼Œè€Œæ˜¯æ¥è‡ªäºŽå¦å¤–ä¸€ä¸ªæŸ¥è¯¢çš„ç»“æžœã€‚æ¯”å¦‚æŸ¥çœ‹å·¥èµ„æ¯”CLARKé«˜çš„å‘˜å·¥ä¿¡æ¯ï¼š1234567891011SQL&gt; select ename,job,sal from emp 2 where sal &gt; (select sal from emp 3 where ename = 'CLARK');ENAME JOB SAL---------- --------- ----------JONES MANAGER 2975BLAKE MANAGER 2850SCOTT ANALYST 3000KING PRESIDENT 5000FORD ANALYST 3000æ ¹æ®è¿”å›žç»“æžœçš„ä¸åŒï¼Œå­æŸ¥è¯¢å¯åˆ†ä¸ºå•è¡Œå•åˆ—å­æŸ¥è¯¢ã€å¤šè¡Œå•åˆ—å­æŸ¥è¯¢åŠå¤šè¡Œå¤šåˆ—å­æŸ¥è¯¢ã€‚å¦‚æžœå­æŸ¥è¯¢è¿”å›žå¤šè¡Œï¼Œä¸»æŸ¥è¯¢ä¸­è¦ä½¿ç”¨å¤šè¡Œæ¯”è¾ƒæ“ä½œç¬¦ï¼ŒåŒ…æ‹¬INã€ALLã€ANYã€‚å…¶ä¸­ALLå’ŒANYä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œéœ€è¦é…åˆå•è¡Œæ¯”è¾ƒæ“ä½œç¬¦&gt;ã€&gt;=ã€&lt;ã€&lt;= ä¸€èµ·ä½¿ç”¨ã€‚ä¾‹å¦‚æŸ¥è¯¢å‡ºéƒ¨é—¨ä¸­æœ‰SALESMANä½†èŒä½ä¸æ˜¯SALESMANçš„å‘˜å·¥çš„ä¿¡æ¯ï¼š12345678910SQL&gt; select ename,job,sal from emp 2 where deptno in 3 (select deptno from emp 4 where job = 'SALESMAN') 5 and job &lt;&gt; 'SALESMAN';ENAME JOB SAL---------- --------- ----------JAMES CLERK 950BLAKE MANAGER 2850ç”±äºŽå­å¥select deptno from emp where job = &#39;SALESMAN&#39;æŸ¥è¯¢ç»“æžœä¸ºå¤šè¡Œå•åˆ—ï¼š123456789SQL&gt; select deptno from emp 2 where job = 'SALESMAN'; DEPTNO---------- 30 30 30 30æ‰€ä»¥ä¸èƒ½ç”¨=ï¼Œè€Œç”¨INã€‚æŸ¥çœ‹æ‰€æœ‰æ¯”SALESMANå’ŒCLERKèŒä½å·¥èµ„éƒ½è¦é«˜çš„å‘˜å·¥ä¿¡æ¯ï¼š12345678910111213SQL&gt; select ename,job,sal from emp 2 where sal &gt; all( 3 select sal from emp 4 where job in('SALESMAN','CLERK'));ENAME JOB SAL---------- --------- ----------CLARK MANAGER 2450BLAKE MANAGER 2850JONES MANAGER 2975SCOTT ANALYST 3000FORD ANALYST 3000KING PRESIDENT 5000EXISTSå…³é”®å­—:ç”¨åœ¨è¿‡æ»¤æ¡ä»¶ä¸­ï¼Œè¯¥å…³é”®å­—åŽé¢è·Ÿä¸€ä¸ªå­æŸ¥è¯¢åªè¦å­æŸ¥è¯¢èƒ½æŸ¥è¯¢è‡³å°‘ä¸€æ¡æ•°æ®ï¼ŒEXISTSå°±è¿”å›žTRUEã€‚ä¾‹å¦‚åˆ—å‡ºé‚£äº›æœ‰å‘˜å·¥çš„éƒ¨é—¨ä¿¡æ¯ï¼š123456789SQL&gt; select d.deptno,d.dname from dept d 2 where exists(select 1 from 3 emp e where e.deptno = d.deptno); DEPTNO DNAME---------- -------------- 10 ACCOUNTING 20 RESEARCH 30 SALES2ã€å­æŸ¥è¯¢åœ¨HAVINGéƒ¨åˆ†å­æŸ¥è¯¢ä¸ä»…å¯ä»¥å‡ºçŽ°åœ¨WHEREå­å¥ä¸­ï¼Œè¿˜å¯ä»¥å‡ºçŽ°åœ¨HAVINGéƒ¨åˆ†ã€‚ä¾‹å¦‚æŸ¥è¯¢åˆ—å‡ºæœ€ä½Žè–ªæ°´é«˜äºŽ30å·éƒ¨é—¨çš„æœ€ä½Žè–ªæ°´çš„éƒ¨é—¨ä¿¡æ¯ï¼š123456789SQL&gt; select deptno,min(sal) from emp 2 group by deptno having min(sal) &gt; 3 (select min(sal) from emp 4 where deptno = 30); DEPTNO MIN(SAL)---------- ---------- 50 3000 10 13003ã€å­æŸ¥è¯¢åœ¨FROMéƒ¨åˆ†åœ¨æŸ¥è¯¢è¯­å¥ä¸­ï¼ŒFROMå­å¥ç”¨æ¥æŒ‡å®šè¦æŸ¥è¯¢çš„è¡¨ã€‚å¦‚æžœè¦åœ¨ä¸€ä¸ªå­æŸ¥è¯¢çš„ç»“æžœä¸­ç»§ç»­æŸ¥è¯¢ï¼Œåˆ™å­æŸ¥è¯¢å‡ºçŽ°åœ¨FROM å­å¥ä¸­ï¼Œè¿™ä¸ªå­æŸ¥è¯¢ä¹Ÿç§°ä½œè¡Œå†…è§†å›¾æˆ–è€…åŒ¿åè§†å›¾ã€‚è¿™æ—¶ï¼ŒæŠŠå­æŸ¥è¯¢å½“ä½œè§†å›¾å¯¹å¾…ï¼Œä½†è§†å›¾æ²¡æœ‰åå­—ï¼Œåªèƒ½åœ¨å½“å‰çš„SQLè¯­å¥ä¸­æœ‰æ•ˆã€‚æŸ¥è¯¢å‡ºè–ªæ°´æ¯”æœ¬éƒ¨é—¨å¹³å‡è–ªæ°´é«˜çš„å‘˜å·¥ä¿¡æ¯ï¼š12345678910111213SQL&gt; select e.ename,e.job,e.sal from emp e, 2 (select deptno,avg(sal) avg_sal from emp group by deptno) d 3 where e.deptno = d.deptno 4 and e.sal &gt; d.avg_sal 5 order by e.deptno;ENAME JOB SAL---------- --------- ----------KING PRESIDENT 5000JONES MANAGER 2975FORD ANALYST 3000ALLEN SALESMAN 1600BLAKE MANAGER 28504ã€å­æŸ¥è¯¢åœ¨SELECTéƒ¨åˆ†æŠŠå­æŸ¥è¯¢æ”¾åœ¨SELECTå­å¥éƒ¨åˆ†ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å¤–è¿žæŽ¥çš„å¦ä¸€ç§è¡¨çŽ°å½¢å¼ï¼Œä½¿ç”¨æ›´çµæ´»ï¼š123456789101112131415161718192021SQL&gt; select e.ename,e.job,e.sal, 2 (select d.deptno from dept d 3 where d.deptno = e.deptno) deptno 4 from emp e;ENAME JOB SAL DEPTNO---------- --------- ---------- ----------SMITH CLERK 800 20ALLEN SALESMAN 1600 30WARD SALESMAN 1250 30JONES MANAGER 2975 20MARTIN SALESMAN 1250 30BLAKE MANAGER 2850 30CLARK MANAGER 2450 10SCOTT ANALYST 3000KING PRESIDENT 5000 10TURNER SALESMAN 1500 30ADAMS CLERK 1100 20JAMES CLERK 950 30FORD ANALYST 3000 20MILLER CLERK 1300 10å¯ä»¥çœ‹å‡ºï¼Œå³ä½¿ä¸æ»¡è¶³whereæ¡ä»¶çš„SCOTTä¹Ÿè¢«åˆ—å‡ºæ¥äº†ï¼Œæ‰€ä»¥ï¼Œç›¸å½“äºŽå¤–è¿žæŽ¥ã€‚5ã€DDLä¸­ä½¿ç”¨å­æŸ¥è¯¢ï¼šåˆ›å»ºè¡¨å¯ä»¥å°†ä¸€ä¸ªæŸ¥è¯¢çš„ç»“æžœé›†åˆ›å»ºä¸ºä¸€å¼ è¡¨ã€‚åˆ›å»ºä¸€ä¸ª10å·éƒ¨é—¨å‘˜å·¥ä¿¡æ¯è¡¨ ï¼š1234567891011121314SQL&gt; create table emp_10 2 as 3 select * from emp 4 where deptno = 10;è¡¨å·²åˆ›å»ºã€‚SQL&gt; select * from emp_10; EMPNO ENAME JOB MGR HIREDATE SAL COMM DEPTNO---------- ---------- --------- ---------- -------------- ---------- ---------- ---------- 7782 CLARK MANAGER 7839 09-6æœˆ -81 2450 10 7839 KING PRESIDENT 17-11æœˆ-81 5000 10 7934 MILLER CLERK 7782 23-1æœˆ -82 1300 10åˆ†é¡µæŸ¥è¯¢åˆ†é¡µæ˜¯å°†æŸ¥è¯¢çš„ç»“æžœé›†åˆ†æ‰¹æ˜¾ç¤ºç›®çš„è§†ä¸ºäº†è§£å†³æ—¶é—´ï¼Œæ€§èƒ½ï¼Œèµ„æºæ¶ˆè€—ï¼Œå’Œç”¨æˆ·éœ€æ±‚ã€‚å½“æŸ¥è¯¢ç»“æžœé›†æ¡ç›®æ•°éžå¸¸å¤šæ—¶ã€‚é€šå¸¸ä¼šä½¿ç”¨åˆ†é¡µã€‚åˆ†é¡µåœ¨æ ‡å‡†SQLä¸­æ²¡æœ‰å®šä¹‰ï¼Œæ‰€ä»¥ä¸åŒçš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå¯¹äºŽåˆ†é¡µçš„è¯­å¥ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚ROWNUMï¼šROWNUMè¢«ç§°ä½œä¼ªåˆ—ï¼Œç”¨äºŽè¿”å›žæ ‡è¯†è¡Œæ•°æ®é¡ºåºçš„æ•°å­—ã€‚è¯¥å…³é”®å­—ä¸æ˜¯æ‰€æœ‰æ•°æ®åº“éƒ½æœ‰çš„ã€‚ROWNUMåœ¨SELECTè¢«å½“ä½œä¸€ä¸ªå­—æ®µåŽ»ä½¿ç”¨ï¼Œä»–ä¸æ˜¯è¡¨ä¸­çœŸå®žçš„å­—æ®µï¼Œå½“æˆ‘ä»¬ä»Žè¡¨ä¸­æŸ¥è¯¢å‡ºä¸€æ¡æ•°æ®åŽï¼Œè¯¥å­—æ®µå°±ä¼šä¸ºè¿™ä¸€æ¡è®°å½•ç¼–ä¸€ä¸ªè¡Œå·ï¼Œä»Ž1å¼€å§‹ï¼Œè‡ªåŠ¨é€’å¢žã€‚ROWNUMé»˜è®¤å€¼ä¸º1ã€‚åœ¨ä½¿ç”¨ROWNUMå¯¹ç»“æžœé›†è¿›è¡Œç¼–å·æ—¶ä¸è¦ä½¿ç”¨ROWNUMåš&gt;1ä»¥ä¸Šçš„æ•°å­—çš„åˆ¤æ–­ï¼Œå¦åˆ™è¯¥ç»“æžœé›†å°†å¾—ä¸åˆ°ä»»ä½•è®°å½•ã€‚é™¤éžROWNUMä»Ž1å¼€å§‹(åŒ…å«1)ã€‚ä¾‹å¦‚ï¼š1234567891011121314151617 ROWNUM ENAME JOB---------- ---------- --------- 1 SMITH CLERK 2 ALLEN SALESMAN 3 WARD SALESMAN 4 JONES MANAGER 5 MARTIN SALESMAN 6 BLAKE MANAGER 7 CLARK MANAGER 8 SCOTT ANALYST 9 KING PRESIDENT 10 TURNER SALESMAN 11 ADAMS CLERK 12 JAMES CLERK 13 FORD ANALYST 14 MILLER CLERKROWNUMåªèƒ½ä»Ž1è®¡æ•°ï¼Œä¸èƒ½ä»Žç»“æžœé›†ä¸­ç›´æŽ¥æˆªå–ã€‚ä¸‹é¢çš„æŸ¥è¯¢è¯­å¥å°†æ²¡æœ‰ç»“æžœï¼š1234SQL&gt; select rownum,ename,job from emp 2 where rownum between 6 and 10;æœªé€‰å®šè¡Œæ³¨æ„åŒºåˆ†ä¸‹é¢è¯­å¥ï¼Œæ­¤å¤„ROWNUMå¯ä»¥ä¸ä»Ž1å¼€å§‹ï¼Œå› ä¸ºä»–å·²ç»ç”Ÿæˆä¸€å¼ è¡¨äº†ï¼š1234567891011SQL&gt; select * from 2 (select rownum rn,ename,job from emp) 3 where rn between 6 and 10; RN ENAME JOB---------- ---------- --------- 6 BLAKE MANAGER 7 CLARK MANAGER 8 SCOTT ANALYST 9 KING PRESIDENT 10 TURNER SALESMANæŒ‰ç…§å·¥èµ„ä»Žé«˜åˆ°ä½ŽæŽ’åºåŽï¼Œå–6åˆ°10åï¼š123456789101112SQL&gt; select * from 2 (select rownum rn,ename,job,sal from emp 3 order by sal desc) t 4 where t.rn between 6 and 10; RN ENAME JOB SAL---------- ---------- --------- ---------- 9 KING PRESIDENT 5000 8 SCOTT ANALYST 3000 6 BLAKE MANAGER 2850 7 CLARK MANAGER 2450 10 TURNER SALESMAN 1500ä¸Šé¢çš„å†™æ³•æ˜¯å…ˆç¼–å·åŽæŽ’åºçš„ï¼Œæ‰€ä»¥ä¸Šé¢è¿™ç§å†™æ³•å¾—å‡ºçš„åºå·æ˜¯ä¸å¯¹çš„ã€‚è€Œåº”è¯¥å…ˆæŽ’åºå†ç¼–å·ï¼Œå†æ ¹æ®ç¼–å·å–èŒƒå›´ï¼ˆåµŒå¥—ä¸¤å±‚ï¼Œå…ˆæŽ’åºï¼ŒæŽ’åºç»“æžœå†ç¼–å·ï¼‰ï¼š123456789101112SQL&gt; select * from 2 (select rownum rn,ename,job,sal from 3 (select * from emp order by sal desc)) t 4 where t.rn between 6 and 10; RN ENAME JOB SAL---------- ---------- --------- ---------- 6 CLARK MANAGER 2450 7 ALLEN SALESMAN 1600 8 TURNER SALESMAN 1500 9 MILLER CLERK 1300 10 WARD SALESMAN 1250æŽ’åºå‡½æ•°å¯ä»¥æ ¹æ®æŒ‡å®šçš„å­—æ®µè¿›è¡Œåˆ†ç»„ï¼Œå†æ ¹æ®æŒ‡å®šçš„å­—æ®µæŽ’åºåŽç”Ÿæˆä¸€ä¸ªç»„å†…ç¼–å·ã€‚1ã€ROW_NUMBERï¼šç”Ÿæˆç»„å†…è¿žç»­ä¸”å”¯ä¸€çš„æ•°å­—æŸ¥çœ‹å…¬å¸æ¯ä¸ªéƒ¨é—¨çš„å·¥èµ„æŽ’åï¼ŒæŒ‰ç…§éƒ¨é—¨åˆ†ç»„ï¼ŒæŒ‰ç…§å·¥èµ„é™åºæŽ’åˆ—ç”Ÿæˆç¼–å·ï¼š123456789101112131415161718192021SQL&gt; select ename,deptno,sal, 2 row_number() over( 3 partition by deptno 4 order by sal desc) rank from emp;ENAME DEPTNO SAL RANK---------- ---------- ---------- ----------KING 10 5000 1CLARK 10 2450 2MILLER 10 1300 3FORD 20 3000 1JONES 20 2975 2ADAMS 20 1100 3SMITH 20 800 4BLAKE 30 2850 1ALLEN 30 1600 2TURNER 30 1500 3WARD 30 1250 4MARTIN 30 1250 5JAMES 30 950 6SCOTT 50 3000 12ã€RANKå‡½æ•°ï¼šç”Ÿæˆä¸è¿žç»­ä¸å”¯ä¸€çš„æ•°å­—æŽ’åºå­—æ®µç›¸åŒçš„è®°å½•ï¼Œå¾—åˆ°çš„æ•°å­—ä¸€æ ·åŽç»­å†…å®¹ä¼šæ ¹æ®é‡å¤çš„è¡Œæ•°è‡ªåŠ¨è·³å·ã€‚æ¯”å¦‚ï¼š123456789101112131415161718192021SQL&gt; select ename,deptno,sal, 2 rank() over( 3 partition by deptno 4 order by sal desc) rank from emp;ENAME DEPTNO SAL RANK---------- ---------- ---------- ----------KING 10 5000 1CLARK 10 2450 2MILLER 10 1300 3FORD 20 3000 1JONES 20 2975 2ADAMS 20 1100 3SMITH 20 800 4BLAKE 30 2850 1ALLEN 30 1600 2TURNER 30 1500 3WARD 30 1250 4MARTIN 30 1250 4JAMES 30 950 6SCOTT 50 3000 13ã€DENSE_RANK()ï¼šå‡½æ•°ç”Ÿæˆè¿žç»­ä½†ä¸å”¯ä¸€çš„æ•°å­—ï¼š123456789101112131415161718192021SQL&gt; select ename,deptno,sal, 2 dense_rank() over( 3 partition by deptno 4 order by sal desc) rank from emp;ENAME DEPTNO SAL RANK---------- ---------- ---------- ----------KING 10 5000 1CLARK 10 2450 2MILLER 10 1300 3FORD 20 3000 1JONES 20 2975 2ADAMS 20 1100 3SMITH 20 800 4BLAKE 30 2850 1ALLEN 30 1600 2TURNER 30 1500 3WARD 30 1250 4MARTIN 30 1250 4JAMES 30 950 5SCOTT 50 3000 1é«˜çº§åˆ†ç»„å‡½æ•°é›†åˆæ“ä½œ1ã€UNIONå’ŒUNION ALLç”¨æ¥èŽ·å–ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šç»“æžœé›†çš„å¹¶é›†ï¼ˆç»“æžœé›†çš„åˆ—å¿…é¡»ä¸€ä¸€å¯¹åº”ï¼‰ï¼šUNIONæ“ä½œç¬¦ä¼šè‡ªåŠ¨åŽ»æŽ‰åˆå¹¶åŽçš„é‡å¤è®°å½•ã€‚UNION ALLè¿”å›žä¸¤ä¸ªç»“æžœé›†ä¸­çš„æ‰€æœ‰è¡Œï¼ŒåŒ…æ‹¬é‡å¤çš„è¡Œã€‚UNIONæ“ä½œç¬¦å¯¹æŸ¥è¯¢ç»“æžœæŽ’åºï¼ŒUNION ALLä¸æŽ’åºã€‚åˆå¹¶èŒä½æ˜¯â€™MANAGERâ€™çš„å‘˜å·¥å’Œè–ªæ°´å¤§äºŽ2500çš„å‘˜å·¥é›†åˆï¼ŒæŸ¥çœ‹ä¸¤ç§æ–¹å¼çš„ç»“æžœå·®åˆ«ï¼šUNIONï¼š1234567891011121314SQL&gt; select ename,job,sal from emp 2 where job = 'MANAGER' 3 UNION 4 select ename,job,sal from emp 5 where sal &gt; 2500;ENAME JOB SAL---------- --------- ----------BLAKE MANAGER 2850CLARK MANAGER 2450FORD ANALYST 3000JONES MANAGER 2975KING PRESIDENT 5000SCOTT ANALYST 3000UNION ALLï¼š12345678910111213141516SQL&gt; select ename,job,sal from emp 2 where job = 'MANAGER' 3 UNION ALL 4 select ename,job,sal from emp 5 where sal &gt; 2500;ENAME JOB SAL---------- --------- ----------JONES MANAGER 2975BLAKE MANAGER 2850CLARK MANAGER 2450JONES MANAGER 2975BLAKE MANAGER 2850SCOTT ANALYST 3000KING PRESIDENT 5000FORD ANALYST 30002ã€INTERSECTï¼ˆ[ËŒÉªntÉ™Ëˆsekt]ï¼Œç›¸äº¤ï¼‰INTERSECTå‡½æ•°èŽ·å¾—ä¸¤ä¸ªç»“æžœé›†çš„äº¤é›†ï¼Œåªæœ‰åŒæ—¶å­˜åœ¨äºŽä¸¤ä¸ªç»“æžœé›†ä¸­çš„æ•°æ®ï¼Œæ‰è¢«æ˜¾ç¤ºè¾“å‡ºã€‚ä½¿ç”¨INTERSECTæ“ä½œç¬¦åŽçš„ç»“æžœé›†ä¼šä»¥ç¬¬ä¸€åˆ—çš„æ•°æ®ä½œå‡åºæŽ’åˆ—ã€‚12345678910SQL&gt; select ename,job,sal from emp 2 where job = 'MANAGER' 3 INTERSECT 4 select ename,job,sal from emp 5 where sal &gt; 2500;ENAME JOB SAL---------- --------- ----------BLAKE MANAGER 2850JONES MANAGER 29753ã€MINUSï¼ˆè‹±[ËˆmaÉªnÉ™s]ï¼Œå‡åŽ»ï¼‰MINUSå‡½æ•°èŽ·å–ä¸¤ä¸ªç»“æžœé›†çš„å·®é›†ã€‚åªæœ‰åœ¨ç¬¬ä¸€ä¸ªç»“æžœé›†ä¸­å­˜åœ¨ï¼Œåœ¨ç¬¬äºŒä¸ªç»“æžœé›†ä¸­ä¸å­˜åœ¨çš„æ•°æ®ï¼Œæ‰èƒ½å¤Ÿè¢«æ˜¾ç¤ºå‡ºæ¥ã€‚ä¹Ÿå°±æ˜¯ç»“æžœé›†ä¸€å‡åŽ»ç»“æžœé›†äºŒçš„ç»“æžœã€‚123456789SQL&gt; select ename,job,sal from emp 2 where job = 'MANAGER' 3 MINUS 4 select ename,job,sal from emp 5 where sal &gt; 2500;ENAME JOB SAL---------- --------- ----------CLARK MANAGER 2450è§†å›¾è§†å›¾(VIEW)ä¹Ÿè¢«ç§°ä½œè™šè¡¨ï¼Œå³è™šæ‹Ÿçš„è¡¨ï¼Œæ˜¯ä¸€ç»„æ•°æ®çš„é€»è¾‘è¡¨ç¤ºï¼Œå…¶æœ¬è´¨æ˜¯å¯¹åº”äºŽä¸€æ¡SELECTè¯­å¥ï¼Œç»“æžœé›†è¢«èµ‹äºˆä¸€ä¸ªåå­—ï¼Œå³è§†å›¾åå­—ã€‚è§†å›¾æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ•°æ®ï¼Œå®ƒåªåŒ…å«æ˜ å°„åˆ°åŸºè¡¨çš„ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œå½“åŸºè¡¨æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œè§†å›¾æ•°æ®ä¹Ÿéšä¹‹å˜åŒ–ã€‚ä½œç”¨ï¼š1ã€é‡ç”¨å­æŸ¥è¯¢ã€‚SELECTè¯­å¥ä¸­çš„FROMå­å¥ä¸­ï¼Œæˆ‘ä»¬å¸¸ä¼šä½¿ç”¨ä¸€ä¸ªå­æŸ¥è¯¢ï¼Œç„¶åŽå°†ç»“æžœå½“ä½œè¡¨å†è¿›è¡ŒæŸ¥è¯¢å·¥ä½œï¼Œè‹¥å¾ˆå¤šSELECTè¯­å¥ä¸­éƒ½è¦ç”¨åˆ°è¯¥å­æŸ¥è¯¢ï¼Œå°±å¯ä»¥å°†è¿™ä¸ªå­æŸ¥è¯¢å®šä¹‰ä¸ºä¸€ä¸ªè¯•å›¾è¿›è¡Œé‡ç”¨ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥ç®€åŒ–SQLè¯­å¥çš„å¤æ‚åº¦ã€‚2ã€é™åˆ¶æ•°æ®è®¿é—®ï¼Œå¯ä»¥éšè—çœŸå®žçš„è¡¨ä¸­å­—æ®µä¿¡æ¯ï¼Œè¡¨çš„åå­—ï¼Œå­—æ®µçš„åå­—ï¼Œè¿™æ ·å¯ä»¥é¿å…è®¿é—®æ•æ„Ÿä¿¡æ¯ç­‰ã€‚æ ¹æ®è§†å›¾æ‰€å¯¹åº”çš„å­æŸ¥è¯¢ç§ç±»åˆ†ä¸ºå‡ ç§ç±»åž‹ï¼šSELECTè¯­å¥æ˜¯åŸºäºŽå•è¡¨å»ºç«‹çš„ï¼Œä¸”ä¸åŒ…å«ä»»ä½•å‡½æ•°è¿ç®—ã€è¡¨è¾¾å¼æˆ–åˆ†ç»„å‡½æ•°ï¼Œå«åšç®€å•è§†å›¾ï¼Œæ­¤æ—¶è§†å›¾æ˜¯åŸºè¡¨çš„å­é›†ï¼›SELECTè¯­å¥åŒæ ·æ˜¯åŸºäºŽå•è¡¨ï¼Œä½†åŒ…å«äº†å•è¡Œå‡½æ•°ã€è¡¨è¾¾å¼ã€åˆ†ç»„å‡½æ•°æˆ–GROUP BYå­å¥ï¼Œå«åšå¤æ‚è§†å›¾ï¼›SELECTè¯­å¥æ˜¯åŸºäºŽå¤šä¸ªè¡¨çš„ï¼Œå«åšè¿žæŽ¥è§†å›¾ã€‚åˆ›å»ºä¸€ä¸ªç®€å•è§†å›¾V_EMP_10ï¼Œæ¥æ˜¾ç¤ºéƒ¨é—¨10ä¸­çš„å‘˜å·¥çš„ç¼–ç ã€å§“åå’Œè–ªæ°´ï¼š12345678910111213SQL&gt; create view v_emp_10 2 as 3 select empno,ename,sal 4 from emp where deptno = 10;è§†å›¾å·²åˆ›å»ºã€‚SQL&gt; desc v_emp_10; åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- EMPNO NOT NULL NUMBER(4) ENAME VARCHAR2(10) SAL NUMBER(7,2)ä¿®æ”¹è§†å›¾ç”±äºŽè§†å›¾è‡ªèº«æ²¡æœ‰ç»“æž„ï¼Œå®Œå…¨å–å†³äºŽå¯¹åº”çš„æŸ¥è¯¢è¯­å¥ï¼Œæ‰€ä»¥ä¿®æ”¹è§†å›¾å°±æ˜¯æ›¿æ¢å¯¹åº”çš„æŸ¥è¯¢è¯­å¥ã€‚1234567891011121314SQL&gt; create or replace view v_emp_10 2 as 3 select empno,ename name,sal salary,deptno 4 from emp where deptno = 20;è§†å›¾å·²åˆ›å»ºã€‚SQL&gt; desc v_emp_10; åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- EMPNO NOT NULL NUMBER(4) NAME VARCHAR2(10) SALARY NUMBER(7,2) DEPTNO NUMBER(2) NUMBER(2)å¯¹è§†å›¾è¿›è¡ŒDMLæ“ä½œå°±æ˜¯å¯¹è§†å›¾æ•°æ®æ¥æºçš„åŸºè¡¨è¿›è¡Œæ“ä½œã€‚åªèƒ½å¯¹ç®€å•è¯•å›¾è¿›è¡ŒDMLæ“ä½œï¼Œå¤æ‚è§†å›¾ä¸å…è®¸DMLæ“ä½œï¼Œå³è§†å›¾å®šä¹‰ä¸­åŒ…å«äº†å‡½æ•°ã€è¡¨è¾¾å¼ã€åˆ†ç»„è¯­å¥ã€DISTINCTå…³é”®å­—æˆ–ROWNUMä¼ªåˆ—ï¼Œä¸å…è®¸æ‰§è¡ŒDMLæ“ä½œã€‚ç”±äºŽè§†å›¾åªèƒ½çœ‹åˆ°empè¡¨ä¸­çš„ä¸‰ä¸ªå­—æ®µï¼Œæ‰€ä»¥å°±ç®—å‘è§†å›¾ä¸­æ‰€æœ‰å­—æ®µæ’å…¥å€¼ï¼Œé‚£ä¹ˆå®žé™…æ’å…¥empè¡¨ä¸­æ—¶ï¼Œé™¤äº†è¿™å‡ ä¸ªå­—æ®µå¤–ï¼Œå…¶ä»–è§†å›¾çœ‹ä¸è§çš„å­—æ®µå…¨éƒ¨æ’å…¥å­—æ®µé»˜è®¤å€¼NULLã€‚123456789 SQL&gt; insert into v_emp_10 values(7935,'KangKang',4500,20);å·²åˆ›å»º 1 è¡Œã€‚SQL&gt; select * from emp where ename = 'KangKang'; EMPNO ENAME JOB MGR HIREDATE SAL COMM DEPTNO---------- ---------- --------- ---------- -------------- ---------- ---------- ---------- 7935 KangKang 4500 20ä¸‹é¢è¿™æ¡è¯­å¥ï¼Œé€šè¿‡è§†å›¾æ’å…¥åˆ°EMPè¡¨ä¸­ï¼Œä½†æ˜¯å› ä¸ºéƒ¨é—¨å·æ˜¯10ï¼Œè€Œä¸æ˜¯è§†å›¾ä¸­çš„20ï¼Œæ‰€ä»¥è§†å›¾çœ‹ä¸è§ï¼Œæ— æ³•å†å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œä¿®æ”¹ï¼Œè¿™å°±å¯¹åŸºè¡¨æ•°æ®äº§ç”Ÿäº†æ±¡æŸ“ï¼Œä¿®æ”¹è§†å›¾æ•°æ®åŒæ ·å¯èƒ½å­˜åœ¨å°†è§†å›¾æ•°æ®ä¿®æ”¹åŽï¼Œå¯¼è‡´è§†å›¾æ— æ³•å†æŸ¥çœ‹åˆ°å®ƒä»¬ã€‚12345678910111213SQL&gt; insert into v_emp_10 values(7936,'Jane',4000,10);å·²åˆ›å»º 1 è¡Œã€‚SQL&gt; select * from v_emp_10; EMPNO NAME SALARY DEPTNO---------- ---------- ---------- ---------- 7935 KangKang 4500 20 7369 SMITH 800 20 7566 JONES 2975 20 7876 ADAMS 1100 20 7902 FORD 3000 20åˆ›å»ºå…·æœ‰CHECK OPTIONçº¦æŸçš„è§†å›¾å¯ä»¥ä¸ºè§†å›¾æ·»åŠ CHECK OPTIONé€‰é¡¹ï¼Œè¿™æ ·å¯¹è§†å›¾è¿›è¡ŒDMLæ“ä½œæ—¶ï¼Œè§†å›¾ä¼šæ£€æŸ¥æ“ä½œå®Œæ¯•åŽå¯¹è¯¥è®°å½•æ˜¯å¦å¯è§ï¼Œå¯è§ä¸å…è®¸æ“ä½œã€‚12345678910111213SQL&gt; create or replace view v_emp_10 2 as 3 select empno,ename name,sal salary,deptno 4 from emp where deptno = 20 5 with check option;è§†å›¾å·²åˆ›å»ºã€‚SQL&gt; insert into v_emp_10 values(7937,'Maria',3000,10);insert into v_emp_10 values(7937,'Maria',3000,10) *ç¬¬ 1 è¡Œå‡ºçŽ°é”™è¯¯:ORA-01402: è§†å›¾ WITH CHECK OPTION where å­å¥è¿è§„åˆ›å»ºå…·æœ‰READ ONLYçº¦æŸçš„è§†å›¾å½“è§†å›¾è¢«è®¾ç½®ä¸ºREAD ONLYåŽï¼Œä¸å…è®¸å¯¹è¯¥è§†å›¾è¿›è¡ŒDMLæ“ä½œï¼Œå…¶ä¸ºåªè¯»çš„ã€‚12345678910111213SQL&gt; create or replace view v_emp_10 2 as 3 select empno,ename name,sal salary,deptno 4 from emp where deptno = 20 5 with read only;è§†å›¾å·²åˆ›å»ºã€‚SQL&gt; insert into v_emp_10 values(7937,'Maria',3000,20);insert into v_emp_10 values(7937,'Maria',3000,20)*ç¬¬ 1 è¡Œå‡ºçŽ°é”™è¯¯:ORA-42399: æ— æ³•å¯¹åªè¯»è§†å›¾æ‰§è¡Œ DML æ“ä½œå¤æ‚è§†å›¾å¯¹åº”çš„SELECTè¯­å¥ä¸­å«æœ‰å‡½æ•°ï¼Œè¡¨è¾¾å¼ï¼Œåˆ†ç»„ï¼Œè¿žæŽ¥æŸ¥è¯¢ã€‚åˆ›å»ºä¸€ä¸ªæ˜¾ç¤ºæ¯ä¸ªéƒ¨é—¨è–ªæ°´æƒ…å†µçš„è§†å›¾ï¼š1234567891011121314151617181920SQL&gt; create view v_emp_sal 2 as 3 select d.deptno,d.dname, 4 avg(e.sal) avg_sal, 5 sum(e.sal) sum_sal, 6 max(e.sal) max_sal, 7 min(e.sal) min_sal 8 from emp e,dept d 9 where e.deptno = d.deptno 10 group by d.deptno,d.dname;è§†å›¾å·²åˆ›å»ºã€‚SQL&gt; select * from v_emp_sal; DEPTNO DNAME AVG_SAL SUM_SAL MAX_SAL MIN_SAL---------- -------------- ---------- ---------- ---------- ---------- 10 ACCOUNTING 3187.5 12750 5000 1300 20 RESEARCH 2475 12375 4500 800 30 SALES 1566.66667 9400 2850 950å¤æ‚è§†å›¾ä¸èƒ½è¿›è¡ŒDMLæ“ä½œã€‚å½“ä¸å†éœ€è¦è§†å›¾çš„å®šä¹‰ï¼Œå¯ä»¥ä½¿ç”¨DROP VIEWè¯­å¥åˆ é™¤è§†å›¾ï¼š123SQL&gt; drop view v_emp_10;è§†å›¾å·²åˆ é™¤ã€‚åºåˆ—åºåˆ—æ˜¯ä¸€ä¸ªæ•°æ®åº“å¯¹è±¡ä½œç”¨æ˜¯æ ¹æ®æŒ‡å®šçš„è§„åˆ™ç”Ÿæˆä¸€ç»„æ•°å­—ï¼Œæ¯æ¬¡è¿”å›žä¸€ä¸ªæ•°å­—ã€‚å¸¸ç”¨äºŽä¸ºè¡¨ä¸­çš„ä¸»é”®æä¾›å€¼ã€‚ä¸»é”®ï¼šé€šå¸¸æ¯å¼ è¡¨çš„ç¬¬ä¸€ä¸ªå­—æ®µå°±æ˜¯ä¸»é”®ï¼Œä¸»é”®å­—æ®µçš„å€¼è¦æ±‚åœ¨æ•´å¼ è¡¨ä¸­ä¸èƒ½ä¸ºç©ºï¼Œä¸”å€¼ä¸èƒ½é‡å¤ã€‚ç›®çš„æ˜¯ç”¨äºŽå”¯ä¸€æ ‡è¯†æ¯ä¸€ä¸ªè®°å½•ã€‚åˆ›å»ºä¸€ä¸ªåºåˆ—ï¼Œèµ·å§‹æ•°æ®æ˜¯100ï¼Œæ­¥è¿›æ˜¯1ï¼š12345SQL&gt; create sequence emp_seq 2 start with 100 3 increment by 1;åºåˆ—å·²åˆ›å»ºã€‚åºåˆ—æœ‰ä¸¤ä¸ªä¼ªåˆ—NEXTVALï¼šä½¿åºåˆ—ç”Ÿæˆä¸€ä¸ªæ•°å­—ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶ï¼Œè¿”å›žçš„æ˜¯START WITHæŒ‡å®šçš„å€¼ã€‚éœ€è¦æ³¨æ„ï¼Œåºåˆ—ä¸å¯é€†ï¼Œä¸€æ—¦èŽ·å–ä¸‹ä¸€ä¸ªæ•°å­—åŽï¼Œå°±ä¸èƒ½å¾—åˆ°ä¸Šä¸€ä¸ªæ•°å­—äº†ã€‚CURRVALï¼šèŽ·å–åºåˆ—æœ€åŽä¸€æ¬¡ç”Ÿæˆçš„æ•°å­—ï¼Œå¯ä»¥è°ƒç”¨å¤šæ¬¡ï¼Œä¸ä¼šé€ æˆåºåˆ—ç”Ÿæˆä¸‹ä¸€ä¸ªæ•°å­—ã€‚CURRVALå¿…é¡»è¦åœ¨åºåˆ—åˆ›å»ºå®Œæ¯•åŽï¼Œè‡³å°‘è°ƒç”¨è¿‡ä¸€ä¾§NEXTVALè¾“å‡ºç”Ÿæˆä¸€ä¸ªæ•°å­—åŽæ‰å¯ä»¥ä½¿ç”¨ã€‚æµ‹è¯•è®©åºåˆ—ç”Ÿæˆä¸€ä¸ªæ•°å­—ï¼š1234567891011SQL&gt; select emp_seq.nextval from dual; NEXTVAL---------- 100SQL&gt; select emp_seq.nextval from dual; NEXTVAL---------- 101æ¯è¿è¡Œä¸€æ¬¡ï¼Œæ•°å­—å¢žåŠ 10ã€‚èŽ·å–åºåˆ—æœ€åŽç”Ÿæˆçš„æ•°å­—ï¼š12345SQL&gt; select emp_seq.currval from dual; CURRVAL---------- 101åˆ é™¤åºåˆ—çš„è¯­æ³•å¦‚ä¸‹ï¼š123SQL&gt; drop sequence emp_seq;åºåˆ—å·²åˆ é™¤ã€‚ç´¢å¼•ç´¢å¼•ä¹Ÿæ˜¯æ•°æ®åº“å¯¹è±¡ï¼Œç”¨æ¥æé«˜æ£€ç´¢æ•ˆçŽ‡ï¼ŒæŽ’åºæ•ˆçŽ‡æœ‰æ•ˆçš„ä½¿ç”¨ä¼šå¸¦æ¥å¾ˆå¥½çš„æ•ˆæžœã€‚æ•°æ®åº“ç®¡ç†ç³»ç»Ÿè‡ªè¡Œç»´æŠ¤ç´¢å¼•çš„ç®—æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‡å®šä½•æ—¶ä¸ºæŸè¡¨çš„æŸå­—æ®µæ·»åŠ å³å¯ã€‚ä¸ºempè¡¨çš„ENAMEå­—æ®µæ·»åŠ ç´¢å¼•ï¼š123SQL&gt; create index idx_emp_ename on emp(ename);ç´¢å¼•å·²åˆ›å»ºã€‚å¤åˆç´¢å¼•ä¹Ÿå«å¤šåˆ—ç´¢å¼•ï¼Œæ˜¯åŸºäºŽå¤šä¸ªåˆ—çš„ç´¢å¼•ã€‚å¦‚æžœç»å¸¸åœ¨ORDER BYå­å¥ä¸­ä½¿ç”¨jobå’Œsalä½œä¸ºæŽ’åºä¾æ®ï¼Œå¯ä»¥å»ºç«‹å¤åˆç´¢å¼•ï¼š123SQL&gt; create index idx_emp_jobsal on emp(job,sal);ç´¢å¼•å·²åˆ›å»ºã€‚å½“åšä¸‹é¢çš„æŸ¥è¯¢æ—¶ï¼Œä¼šè‡ªåŠ¨åº”ç”¨ç´¢å¼•idx_emp_jobsalï¼š12SQL&gt; select empno,ename,job,sal from emp 2 order by job,sal;åˆ é™¤ç´¢å¼•ï¼š123SQL&gt; drop index idx_emp_jobsal;ç´¢å¼•å·²åˆ é™¤ã€‚åˆç†ä½¿ç”¨ç´¢å¼•æå‡æŸ¥è¯¢æ•ˆçŽ‡ï¼šä¸ºç»å¸¸å‡ºçŽ°åœ¨WHEREå­å¥ä¸­çš„åˆ—åˆ›å»ºç´¢å¼•ã€‚ä¸ºç»å¸¸å‡ºçŽ°åœ¨ORDER BYã€DISTINCTåŽé¢çš„å­—æ®µå»ºç«‹ç´¢å¼•ã€‚å¦‚æžœå»ºç«‹çš„å¤åˆç´¢å¼•ï¼Œç´¢å¼•çš„å­—æ®µé¡ºåºè¦å’Œè¿™äº›å…³é”®å­—åŽé¢çš„å­—æ®µé¡ºåºä¸€è‡´ã€‚ä¸ºç»å¸¸ä½œä¸ºè¡¨çš„è¿žæŽ¥æ¡ä»¶çš„åˆ—ä¸Šåˆ›å»ºç´¢å¼•ã€‚ä¸è¦åœ¨ç»å¸¸åšDMLæ“ä½œçš„è¡¨ä¸Šå»ºç«‹ç´¢å¼•ã€‚ä¸è¦åœ¨å°è¡¨ä¸Šå»ºç«‹ç´¢å¼•ã€‚é™åˆ¶è¡¨ä¸Šçš„ç´¢å¼•æ•°ç›®ï¼Œç´¢å¼•å¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ã€‚åˆ é™¤å¾ˆå°‘è¢«ä½¿ç”¨çš„ã€ä¸åˆç†çš„ç´¢å¼•ã€‚çº¦æŸçº¦æŸçš„ç±»åž‹ï¼šéžç©ºçº¦æŸ(Not Null)ï¼Œç®€ç§°NNã€‚å”¯ä¸€æ€§çº¦æŸ(Unique)ï¼Œç®€ç§°UKã€‚ä¸»é”®çº¦æŸ(Primary Key)ï¼Œç®€ç§°PKã€‚å¤–é”®çº¦æŸ(Foreign Key)ï¼Œç®€ç§°FKã€‚æ£€æŸ¥çº¦æŸ(Check)ï¼Œç®€ç§°CKã€‚éžç©ºçº¦æŸå»ºè¡¨æ—¶æ·»åŠ éžç©ºçº¦æŸï¼š123456789101112131415SQL&gt; create table employees( 2 eid number(6), 3 name varchar2(30) not null, 4 salary number(7,2), 5 hiredate date constraint employees_hiredate_nn not null);è¡¨å·²åˆ›å»ºã€‚SQL&gt; desc employees; åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- EID NUMBER(6) NAME NOT NULL VARCHAR2(30) SALARY NUMBER(7,2) HIREDATE NOT NULL DATEå–æ¶ˆéžç©ºçº¦æŸï¼š1234567891011 SQL&gt; alter table employees modify(hiredate date null);è¡¨å·²æ›´æ”¹ã€‚SQL&gt; desc employees; åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- EID NUMBER(6) NAME NOT NULL DATE SALARY NUMBER(7,2) HIREDATE DATEå”¯ä¸€æ€§çº¦æŸå”¯ä¸€æ€§(Unique)çº¦æŸæ¡ä»¶ç”¨äºŽä¿è¯å­—æ®µæˆ–è€…å­—æ®µçš„ç»„åˆä¸å‡ºçŽ°é‡å¤å€¼ã€‚å½“ç»™è¡¨çš„æŸä¸ªåˆ—å®šä¹‰äº†å”¯ä¸€çº¦æŸæ¡ä»¶ï¼Œè¯¥åˆ—çš„å€¼ä¸å…è®¸é‡å¤ï¼Œä½†å…è®¸æ˜¯NULLå€¼ã€‚å»ºè¡¨çš„æ—¶å€™æ·»åŠ å”¯ä¸€æ€§çº¦æŸï¼š123456789SQL&gt; create table employees1( 2 eid number(6) unique, 3 name varchar2(30), 4 email varchar(50), 5 salary number(7,2), 6 hiredate date, 7 constraint employees1_email_uk unique(email));è¡¨å·²åˆ›å»ºã€‚ä¸»é”®çº¦æŸä¸»é”®(Primary Key)çº¦æŸæ¡ä»¶ä»ŽåŠŸèƒ½ä¸Šçœ‹ç›¸å½“äºŽéžç©ºï¼ˆNOT NULLï¼‰ä¸”å”¯ä¸€ï¼ˆUNIQUEï¼‰çš„ç»„åˆã€‚ä¸»é”®å­—æ®µå¯ä»¥æ˜¯å•å­—æ®µæˆ–å¤šå­—æ®µç»„åˆï¼Œå³ï¼šåœ¨ä¸»é”®çº¦æŸä¸‹çš„å•å­—æ®µæˆ–è€…å¤šå­—æ®µç»„åˆä¸Šä¸å…è®¸æœ‰ç©ºå€¼ï¼Œä¹Ÿä¸å…è®¸æœ‰é‡å¤å€¼ã€‚ä¸»é”®å¯ä»¥ç”¨æ¥åœ¨è¡¨ä¸­å”¯ä¸€çš„ç¡®å®šä¸€è¡Œæ•°æ®ã€‚ä¸€ä¸ªè¡¨ä¸Šåªå…è®¸å»ºç«‹ä¸€ä¸ªä¸»é”®ï¼Œè€Œå…¶å®ƒçº¦æŸæ¡ä»¶åˆ™æ²¡æœ‰æ˜Žç¡®çš„ä¸ªæ•°é™åˆ¶ã€‚ä¸»é”®é€‰å–çš„åŽŸåˆ™ï¼šä¸»é”®åº”æ˜¯å¯¹ç³»ç»Ÿæ— æ„ä¹‰çš„æ•°æ®ã€‚æ°¸è¿œä¹Ÿä¸è¦æ›´æ–°ä¸»é”®ï¼Œè®©ä¸»é”®é™¤äº†å”¯ä¸€æ ‡è¯†ä¸€è¡Œä¹‹å¤–ï¼Œå†æ— å…¶ä»–çš„ç”¨é€”ã€‚ä¸»é”®ä¸åº”åŒ…å«åŠ¨æ€å˜åŒ–çš„æ•°æ®ï¼Œå¦‚æ—¶é—´æˆ³ã€‚ä¸»é”®åº”è‡ªåŠ¨ç”Ÿæˆï¼Œä¸è¦äººä¸ºå¹²é¢„ï¼Œä»¥å…ä½¿å®ƒå¸¦æœ‰é™¤äº†å”¯ä¸€æ ‡è¯†ä¸€è¡Œä»¥å¤–çš„æ„ä¹‰ã€‚ä¸»é”®å°½é‡å»ºç«‹åœ¨å•åˆ—ä¸Šã€‚å»ºè¡¨çš„æ—¶å€™æ·»åŠ ä¸»é”®çº¦æŸï¼š1234567891011121314151617SQL&gt; create table employees2( 2 eid number(6) primary key, 3 name varchar(30), 4 email varchar2(30), 5 salary number(7,2), 6 hiredate date);è¡¨å·²åˆ›å»ºã€‚SQL&gt; desc employees2; åç§° æ˜¯å¦ä¸ºç©º? ç±»åž‹ ----------------------------------------- -------- ---------------------------- EID NOT NULL NUMBER(6) NAME VARCHAR2(30) EMAIL VARCHAR2(30) SALARY NUMBER(7,2) HIREDATE DATEå»ºè¡¨åŽæ·»åŠ ä¸»é”®ï¼Œé¦–å…ˆåˆ›å»ºä¸€å¼ æ²¡æœ‰ä¸»é”®çš„è¡¨ï¼š12345678 SQL&gt; create table employees3( 2 eid number(6), 3 name varchar2(30), 4 email varchar2(50), 5 salary number(7,2), 6 hiredate date);è¡¨å·²åˆ›å»ºã€‚å†æ·»åŠ ä¸»é”®ï¼š1234SQL&gt; alter table employees3 2 add constraint emplpoyees3_eid_pk primary key(eid);è¡¨å·²æ›´æ”¹ã€‚å¤–é”®çº¦æŸå¤–é”®çº¦æŸæ¡ä»¶å®šä¹‰åœ¨ä¸¤ä¸ªè¡¨çš„å­—æ®µæˆ–ä¸€ä¸ªè¡¨çš„ä¸¤ä¸ªå­—æ®µä¸Šï¼Œç”¨äºŽä¿è¯ç›¸å…³ä¸¤ä¸ªå­—æ®µçš„å…³ç³»ã€‚æ¯”å¦‚empè¡¨çš„deptnoåˆ—å‚ç…§deptè¡¨çš„deptnoåˆ—ï¼Œåˆ™deptç§°ä½œä¸»è¡¨æˆ–çˆ¶è¡¨ï¼Œempè¡¨ç§°ä½œä»Žè¡¨æˆ–å­è¡¨ã€‚12345678910111213SQL&gt; create table employees4( 2 eid number(6), 3 name varchar2(30), 4 salary number(7,2), 5 deptno number(4));è¡¨å·²åˆ›å»ºã€‚SQL&gt; alter table employees4 2 add constraint employees4_deptno_fk 3 foreign key(deptno) references dept(deptno);è¡¨å·²æ›´æ”¹ã€‚æ£€æŸ¥çº¦æŸæ£€æŸ¥(Check)çº¦æŸæ¡ä»¶ç”¨æ¥å¼ºåˆ¶åœ¨å­—æ®µä¸Šçš„æ¯ä¸ªå€¼éƒ½è¦æ»¡è¶³Checkä¸­å®šä¹‰çš„æ¡ä»¶ã€‚å½“å®šä¹‰äº†Checkçº¦æŸçš„åˆ—æ–°å¢žæˆ–ä¿®æ”¹æ•°æ®æ—¶ï¼Œæ•°æ®å¿…é¡»ç¬¦åˆCheckçº¦æŸä¸­å®šä¹‰çš„æ¡ä»¶ã€‚å‘˜å·¥çš„è–ªæ°´å¿…é¡»å¤§äºŽ2000å…ƒï¼Œå¢žåŠ æ£€æŸ¥çº¦æŸï¼š12345SQL&gt; alter table employees4 2 add constraint employees4_salary_check 3 check (salary &gt; 2000);è¡¨å·²æ›´æ”¹ã€‚]]></content>
      <tags>
        <tag>DataBase</tag>
        <tag>Oracle</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Servlet Jsp note]]></title>
    <url>%2FServlet-Jsp-note.html</url>
    <content type="text"><![CDATA[ä»€ä¹ˆæ˜¯Servletsun(oracle)å…¬å¸åˆ¶è®¢çš„ä¸€ç§ç”¨æ¥æ‰©å±•webæœåŠ¡å™¨åŠŸèƒ½çš„ç»„ä»¶è§„èŒƒã€‚ä½¿ç”¨Myeclipseåˆ›å»ºä¸€ä¸ªweb projectï¼Œç¼–å†™ä¸€ä¸ªç®€å•çš„servletï¼šsrcâ†’com.postar.servletï¼ˆpackageï¼‰â†’HiServletï¼š12345678910public class HiServlet extends HttpServlet&#123; @Override protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException &#123; res.setContentType("text/html"); PrintWriter pw = res.getWriter(); pw.write("&lt;h1 style='color:#6db33f'&gt;hello world&lt;/h1&gt;"); pw.close(); &#125;&#125;é…ç½®æ–‡ä»¶WebRootâ†’WEB-INFâ†’web.xmlä¸‹æ·»åŠ ï¼š12345678910111213141516171819&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"&gt; &lt;display-name&gt;&lt;/display-name&gt; &lt;welcome-file-list&gt; &lt;welcome-file&gt;index.jsp&lt;/welcome-file&gt; &lt;/welcome-file-list&gt; &lt;servlet&gt; &lt;servlet-name&gt;hi&lt;/servlet-name&gt; &lt;servlet-class&gt;com.postar.servlet.HiServlet&lt;/servlet-class&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;hi&lt;/servlet-name&gt; &lt;url-pattern&gt;/hi&lt;/url-pattern&gt; &lt;/servlet-mapping&gt;&lt;/web-app&gt;å¯åŠ¨Tomcatï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼šhttp://localhost:8088/servlet/hi å¾—åˆ°é¡µé¢ï¼šç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ï¼šServletè¿è¡Œçš„åŽŸç†åŽŸç†å›¾ï¼ˆæ‰§è¡Œè¿‡ç¨‹ï¼‰ï¼šå…·ä½“è¿‡ç¨‹æè¿°ï¼š1.æµè§ˆå™¨ä¾æ®ip,portå»ºç«‹ä¸Žå®¹å™¨ä¹‹é—´çš„è¿žæŽ¥ã€‚2.æµè§ˆå™¨å°†è¯·æ±‚æ•°æ®æ‰“åŒ…(åŒ…å«äº†è¯·æ±‚èµ„æºè·¯å¾„)ã€‚3.å‘å®¹å™¨ï¼ˆç¬¦åˆä¸€å®šè§„èŒƒï¼Œæä¾›ç»„ä»¶çš„è¿è¡ŒçŽ¯å¢ƒçš„ä¸€ä¸ªç¨‹åºã€‚ï¼‰å‘è¯·æ±‚æ•°æ®åŒ…ã€‚4.å®¹å™¨è§£æžè¯·æ±‚æ•°æ®åŒ…ã€‚5.å°†è§£æžçš„ç»“æžœå°è£…åˆ°requestå¯¹è±¡ä¸Šï¼ŒåŒæ—¶ï¼Œå®¹å™¨è¿˜è¦åˆ›å»ºä¸€ä¸ªresponseå¯¹è±¡ã€‚6.å®¹å™¨ä¾æ®è¯·æ±‚èµ„æºè·¯å¾„æ‰¾åˆ°servletçš„é…ç½®(web.xml)ã€‚7.8.ç„¶åŽåˆ›å»ºè¯¥servletå¯¹è±¡ï¼Œè°ƒç”¨servletå¯¹è±¡çš„serviceæ–¹æ³•(ä¼šå°†requestå¯¹è±¡,responseå¯¹è±¡ä½œä¸ºå‚æ•°)ã€‚åœ¨serviceæ–¹æ³•é‡Œé¢ï¼Œå¯ä»¥é€šè¿‡requestå¯¹è±¡èŽ·å¾—è¯·æ±‚æ•°æ®å¹¶è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œç„¶åŽï¼Œå¤„ç†ç»“æžœåªéœ€è¦å†™åˆ°responseå¯¹è±¡ä¸Šã€‚9.å®¹å™¨ä»Žresponseå¯¹è±¡ä¸ŠèŽ·å–å¤„ç†ç»“æžœï¼Œç„¶åŽæ‰“åŒ…ã€‚10.å‘é€ç»™æµè§ˆå™¨ã€‚11.æµè§ˆå™¨ä»Žå“åº”æ•°æ®åŒ…ä¸­å–å‡ºå¤„ç†ç»“æžœï¼Œç”Ÿæˆç›¸åº”çš„é¡µé¢ã€‚getè¯·æ±‚å’Œpostè¯·æ±‚æœ€å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼getå’Œpostã€‚get/postè¯·æ±‚çš„åŒºåˆ«ï¼šgetè¯·æ±‚å¦‚æžœéœ€è¦å‘æœåŠ¡å™¨ä¼ é€’å°‘é‡æ•°æ®ç”¨getã€‚getè¯·æ±‚ä½¿ç”¨URLä¼ å€¼ï¼Œå³æ•°æ®ä¼šé™„ç€åœ¨URLä¸Šä¼ é€’ç»™æœåŠ¡å™¨ï¼Œå¦‚ï¼šåªèƒ½ä¼ é€’è¾ƒå°‘çš„æ•°æ®postè¯·æ±‚å¦‚æžœéœ€è¦æäº¤è¡¨å•ï¼Œæˆ–è€…ä¼ é€’å¤§é‡çš„æ•°æ®ç”¨postã€‚postè¯·æ±‚ä½¿ç”¨è¯·æ±‚æ•°æ®åŒ…çš„å®žä½“å†…å®¹æ¥ä¼ å€¼ã€‚å¯ä»¥ä¼ é€’å¤§é‡æ•°æ®ã€‚postè¯·æ±‚éšç§æ€§æ›´å¥½ï¼Œä½†æ˜¯å®‰å…¨çº§åˆ«å’Œgetå®Œå…¨ç›¸ç­‰ï¼Œä¸èƒ½è¯´å®ƒæ›´å®‰å…¨ã€‚é€šè¿‡F12éƒ½èƒ½æŸ¥çœ‹åˆ°æ‰€æœ‰æ•°æ®ã€‚è§£å†³getï¼Œpsotè¯·æ±‚ä¸­æ–‡ä¹±ç æœåŠ¡ç«¯Servletä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435public class RegistServlet extends HttpServlet&#123; @Override protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException &#123; // è§£å†³postè¯·æ±‚ä¹±ç  req.setCharacterEncoding("utf-8"); // ä½¿ç”¨requestæŽ¥æ”¶è¯·æ±‚æ•°æ® // é€šè¿‡æ¡†ä½“çš„nameå±žæ€§å€¼æ¥æŽ¥æ”¶æ•°æ® String code = req.getParameter("code"); // è§£å†³getè¯·æ±‚ä¹±ç  // code = new String(code.getBytes("iso8859-1"), "utf-8"); String pwd = req.getParameter("pwd"); String sex = req.getParameter("sex"); // å€¼æ˜¯ä¸ªæ•°ç»„çš„æ—¶å€™ä½¿ç”¨request.getParameterValues() String[] favorites = req.getParameterValues("favorites"); System.out.println(code); System.out.println(pwd); System.out.println(sex); for(String f : favorites) &#123; System.out.println(f); &#125; //å‘æµè§ˆå™¨è¾“å‡ºä¸€äº›æç¤ºä¿¡æ¯ res.setContentType("text/html;charset=utf-8;"); PrintWriter w = res.getWriter(); if("admin".equals(code)) &#123; w.println("&lt;h1&gt;æ­¤è´¦å·å·²å­˜åœ¨.&lt;/h1&gt;"); &#125; else &#123; w.println("&lt;h1&gt;æ³¨å†ŒæˆåŠŸ.&lt;/h1&gt;"); &#125; w.close(); &#125;&#125;å®¢æˆ·ç«¯htmlä»£ç ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142&lt;!doctype html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset="gbk" /&gt; &lt;title&gt;æ³¨å†Œç”¨æˆ·&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;!-- 1.æƒ³è¦ç»™æœåŠ¡å™¨æäº¤æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨è¡¨å•ã€‚ 2.ä¼ æ•°æ®æ—¶ï¼Œéœ€è¦ç»™æ¡†è®¾ç½®nameå±žæ€§ï¼Œè¯¥å±žæ€§å°†ä½œä¸ºä¼ é€’çš„æ•°æ®çš„åå­—ï¼ŒæœåŠ¡ç«¯ éœ€è¦é€šè¿‡æ­¤åå­—æ¥èŽ·å–æ•°æ®ã€‚ 3.è¡¨å•ä¼ é€’çš„æ•°æ®å°±æ˜¯æ¡†ä½“çš„valueå±žæ€§å€¼ã€‚ 3.1å¯¹äºŽæ–‡æœ¬æ¡†ã€å¯†ç æ¡†ï¼Œå®ƒçš„valueå±žæ€§å€¼å°±æ˜¯æˆ‘ä»¬åœ¨æ¡†å†…è¾“å…¥çš„å†…å®¹ï¼Œå› æ­¤ä¸å¿…é¢å¤–è®¾ç½®ï¼› 3.2å¯¹äºŽå•é€‰ã€å¤é€‰ã€ä¸‹æ‹‰é€‰ï¼Œéœ€è¦æ˜Žç¡®è®¾ç½®valueå±žæ€§çš„å€¼ã€‚ 4.è¡¨å•ä¸Šéœ€è¦é€šè¿‡actionå±žæ€§è®¾ç½®æäº¤çš„è·¯å¾„ï¼Œå†™å‡ºURIå³å¯ï¼Œä¸éœ€è¦å†™å‡ºå®Œæ•´çš„URLã€‚ é€šè¿‡methodå±žæ€§å£°æ˜Žè¯·æ±‚çš„ç±»åž‹ã€‚ --&gt; &lt;form action="/servlet/register" method="post"&gt; &lt;h1&gt;æ³¨å†Œç”¨æˆ·&lt;/h1&gt; &lt;p&gt;è´¦å·:&lt;input type="text" name="code" /&gt;&lt;/p&gt; &lt;p&gt;å¯†ç :&lt;input type="password" name="pwd" /&gt;&lt;/p&gt; &lt;p&gt;æ€§åˆ«: &lt;input type="radio" name="sex" value="M" /&gt;ç”· &lt;input type="radio" name="sex" value="F" /&gt;å¥³ &lt;/p&gt; &lt;p&gt; å…´è¶£: &lt;input type="checkbox" name="favorites" value="basketball" /&gt; ç¯®çƒ &lt;input type="checkbox" name="favorites" value="football" /&gt; è¶³çƒ &lt;input type="checkbox" name="favorites" value="pingpang" /&gt; ä¹’ä¹“ &lt;input type="checkbox" name="favorites" value="running" /&gt; è·‘æ­¥ &lt;/p&gt; &lt;p&gt; &lt;!-- submitæ˜¯ä¸“é—¨ç”¨äºŽæäº¤è¡¨å•çš„æŒ‰é’® --&gt; &lt;input type="submit" value="æ³¨å†Œ" /&gt; &lt;/p&gt; &lt;/form&gt; &lt;/body&gt;&lt;/html&gt;é…ç½®xmlï¼š12345678&lt;servlet&gt; &lt;servlet-name&gt;regist&lt;/servlet-name&gt; &lt;servlet-class&gt;com.postar.servlet.RegistServlet&lt;/servlet-class&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;regist&lt;/servlet-name&gt; &lt;url-pattern&gt;/register&lt;/url-pattern&gt;&lt;/servlet-mapping&gt;é‡å®šå‘æœåŠ¡å™¨å‘æµè§ˆå™¨å‘é€ä¸€ä¸ª302çŠ¶æ€ç åŠä¸€ä¸ªLocationæ¶ˆæ¯å¤´ï¼ˆè¯¥æ¶ˆæ¯å¤´çš„å€¼æ˜¯ä¸€ä¸ªåœ°å€ï¼Œç§°ä¹‹ä¸ºé‡å®šå‘åœ°å€ï¼‰ï¼Œæµè§ˆå™¨æ”¶åˆ°åŽä¼šç«‹å³å‘é‡å®šå‘åœ°å€å‘è¯·æ±‚ã€‚å¦‚ä½•é‡å®šå‘ï¼Ÿ1response.sendRedirect(String url);ç‰¹ç‚¹ï¼šé‡å®šå‘åœ°å€å¯ä»¥æ˜¯ä»»æ„çš„åœ°å€ã€‚é‡å®šå‘ä¹‹åŽï¼Œæµè§ˆå™¨åœ°å€æ çš„åœ°å€ä¼šå˜ã€‚è½¬å‘ä¸€ä¸ªwebç»„ä»¶ï¼ˆservlet/jspï¼‰å°†æœªå®Œæˆçš„å¤„ç†é€šè¿‡å®¹å™¨è½¬äº¤ç»™å¦å¤–ä¸€ä¸ªwebç»„ä»¶ç»§ç»­å®Œæˆã€‚å¸¸è§çš„æƒ…å†µæ˜¯ï¼šä¸€ä¸ªservletèŽ·å¾—æ•°æ®ä¹‹åŽï¼ˆæ¯”å¦‚ï¼Œé€šè¿‡è°ƒç”¨daoï¼‰ï¼Œå°†è¿™äº›æ•°æ®è½¬å‘ç»™ä¸€ä¸ªjspï¼Œç”±è¿™ä¸ªjspæ¥å±•çŽ°è¿™äº›æ•°æ®ï¼ˆæ¯”å¦‚ï¼Œä»¥è¡¨æ ¼çš„æ–¹å¼æ¥å±•çŽ°ï¼‰ã€‚è½¬å‘çš„åŽŸç†å›¾ï¼šè½¬å‘çš„è¿‡ç¨‹ï¼š1.å…ˆç»‘è®¢æ•°æ®åˆ°requestå¯¹è±¡ï¼š12// å˜é‡ånameï¼Œå€¼objrequest.setAttribute(String name,Object obj);2.èŽ·å¾—è½¬å‘å™¨ï¼š12// uriï¼šè½¬å‘çš„ç›®çš„åœ°ï¼Œæ¯”å¦‚ä¸€ä¸ªjspæ–‡ä»¶ã€‚RequestDispatcher rd = request.getRequestDispatcher(String uri);3.è½¬å‘ï¼š1rd.forward(request,response);è½¬å‘çš„ç‰¹ç‚¹ï¼šè½¬å‘ä¹‹åŽï¼Œæµè§ˆå™¨åœ°å€æ çš„åœ°å€ä¸å˜ã€‚è½¬å‘çš„ç›®çš„åœ°å¿…é¡»æ˜¯åŒä¸€ä¸ªåº”ç”¨å†…éƒ¨çš„æŸä¸ªåœ°å€ã€‚è½¬å‘æ‰€æ¶‰åŠçš„å„ä¸ªwebç»„ä»¶ä¼šå…±äº«åŒä¸€ä¸ªrequestå¯¹è±¡å’Œresponseå¯¹è±¡ã€‚è½¬å‘å’Œé‡å®šå‘çš„åŒºåˆ«è½¬å‘æ‰€æ¶‰åŠçš„å„ä¸ªwebç»„ä»¶ä¼šå…±äº«åŒä¸€ä¸ªrequestå¯¹è±¡å’Œresponseå¯¹è±¡ï¼Œè€Œé‡å®šå‘ä¸è¡Œã€‚è¯´æ˜Žï¼šå½“è¯·æ±‚åˆ°è¾¾å®¹å™¨ï¼Œå®¹å™¨ä¼šåˆ›å»ºrequestå¯¹è±¡å’Œresponseå¯¹è±¡ï¼Œå½“å“åº”å‘é€å®Œæ¯•ï¼Œå®¹å™¨ä¼šç«‹å³åˆ é™¤requestå¯¹è±¡å’Œresponseå¯¹è±¡ã€‚å³requestå¯¹è±¡å’Œresponseå¯¹è±¡çš„ç”Ÿå­˜æ—¶é—´æ˜¯ä¸€æ¬¡è¯·æ±‚ä¸Žå“åº”æœŸé—´ã€‚è½¬å‘ä¹‹åŽï¼Œæµè§ˆå™¨åœ°å€æ çš„åœ°å€ä¸å˜ï¼Œé‡å®šå‘ä¼šå˜ã€‚è½¬å‘çš„åœ°å€å¿…é¡»æ˜¯åŒä¸€ä¸ªåº”ç”¨å†…éƒ¨æŸä¸ªåœ°å€ï¼Œè€Œé‡å®šå‘æ²¡æœ‰è¿™ä¸ªé™åˆ¶ã€‚è½¬å‘æ˜¯ä¸€ä»¶äº‹æƒ…æœªåšå®Œï¼Œè°ƒç”¨å¦å¤–ä¸€ä¸ªç»„ä»¶ç»§ç»­åšï¼›è€Œé‡å®šå‘æ˜¯ä¸€ä»¶äº‹æƒ…å·²ç»åšå®Œï¼Œå†è°ƒç”¨ä¸€ä¸ªç»„ä»¶åšå¦å¤–ä¸€ä»¶äº‹æƒ…ã€‚Servletçš„ç”Ÿå‘½å‘¨æœŸServletå®¹å™¨å¦‚ä½•åˆ›å»ºServletå¯¹è±¡ã€å¦‚ä½•ä¸ºServletå¯¹è±¡åˆ†é…ã€å‡†å¤‡èµ„æºã€å¦‚ä½•è°ƒç”¨å¯¹åº”çš„æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ä»¥åŠå¦‚ä½•é”€æ¯Servletå¯¹è±¡çš„æ•´ä¸ªè¿‡ç¨‹å³Servletçš„ç”Ÿå‘½å‘¨æœŸã€‚é˜¶æ®µä¸€ï¼šå®žä¾‹åŒ–ï¼Œå®¹å™¨è°ƒç”¨servletçš„æž„é€ å™¨ï¼Œåˆ›å»ºä¸€ä¸ªservletå¯¹è±¡ã€‚å®¹å™¨åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå¯¹äºŽæŸä¸ªç±»åž‹çš„servlet,åªä¼šåˆ›å»ºä¸€ä¸ªå®žä¾‹ã€‚é˜¶æ®µäºŒï¼šåˆå§‹åŒ–ï¼Œå®¹å™¨åœ¨åˆ›å»ºå¥½servletå¯¹è±¡ä¹‹åŽï¼Œä¼šç«‹å³è°ƒç”¨è¯¥å¯¹è±¡çš„initæ–¹æ³•ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ç”¨å†™initæ–¹æ³•ï¼Œå› ä¸ºGenericServletå·²ç»æä¾›äº†initæ–¹æ³•çš„å®žçŽ°ï¼ˆå°†å®¹å™¨ä¼ é€’è¿‡æ¥çš„ServletConfigå¯¹è±¡ä¿å­˜æ¥ä¸‹ï¼Œå¹¶ä¸”ï¼Œæä¾›äº†getServletConfigæ–¹æ³•æ¥èŽ·å¾—ServletConfigå¯¹è±¡ï¼‰ã€‚é˜¶æ®µä¸‰ï¼šå°±ç»ªï¼Œå®¹å™¨æ”¶åˆ°è¯·æ±‚ä¹‹åŽï¼Œè°ƒç”¨servletå¯¹è±¡çš„serviceæ–¹æ³•æ¥å¤„ç†è¯·æ±‚ã€‚é˜¶æ®µå››ï¼šé”€æ¯ï¼Œå®¹å™¨ä¾æ®è‡ªèº«çš„ç®—æ³•åˆ é™¤servletå¯¹è±¡ï¼Œè¢«åˆ é™¤çš„servletå¯¹è±¡ä¼šè¢«åžƒåœ¾å›žæ”¶æœºåˆ¶å›žæ”¶ã€‚å®¹å™¨åœ¨åˆ é™¤servletå¯¹è±¡ä¹‹å‰ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„destroyæ–¹æ³•ï¼ˆåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼‰ã€‚å¯ä»¥override destroyæ–¹æ³•æ¥å®žçŽ°è‡ªå·²çš„å¤„ç†é€»è¾‘ã€‚ä¾‹å­ï¼š123456789101112131415161718192021222324252627282930313233public class LifeServlet extends HttpServlet&#123; // 1.Tomcatä¼šè‡ªåŠ¨è°ƒç”¨é»˜è®¤æž„é€ å™¨åˆ›å»ºServlet public LifeServlet()&#123; System.out.println("åˆ›å»ºLifeServlet"); &#125; // 2.Tomcatä¼šè‡ªåŠ¨ä¸ºå½“å‰çš„Servletåˆ›å»ºä¸€ä¸ªServletConfigï¼Œç”¨æ¥ç»™å®ƒé¢„ç½®ä¸€äº›æ•°æ®ï¼› // 3.Tomcatä¼šè‡ªåŠ¨è°ƒç”¨initæ–¹æ³•ï¼Œæ¥ä¸ºæ­¤Servletåˆå§‹åŒ–ä¸€äº›æ•°æ®ï¼› // æ³¨æ„ï¼ŒServletConfigä¸­é¢„ç½®çš„æ•°æ®ï¼Œå¯ä»¥åœ¨initæ—¶ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨serviceæ—¶ä½¿ç”¨ã€‚ @Override public void init(ServletConfig config) throws ServletException &#123; System.out.println("åˆå§‹åŒ–Servlet"); &#125; // 4.å½“è¯·æ±‚ä¼ å…¥æ—¶ï¼ŒTomcatä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•æ¥å¤„ç†æœ¬æ¬¡è¯·æ±‚ã€‚ @Override protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException &#123; System.out.println("è°ƒç”¨service()"); res.setContentType("text/html"); PrintWriter w = res.getWriter(); w.println("&lt;h1&gt;LifeServlet&lt;/h1&gt;"); w.close(); &#125; // 5.Tomcatåœ¨å…³é—­å‰ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•æ¥é”€æ¯è¯¥Servletã€‚é€šå¸¸æ˜¯å°†æ­¤Servletæ‰€ä¾èµ–çš„æ•°æ®é‡Šæ”¾ï¼ˆ=nullï¼‰ã€‚ @Override public void destroy() &#123; // TODO Auto-generated method stub super.destroy(); &#125;&#125;ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„å‡ ä¸ªæŽ¥å£ä¸Žç±»ï¼šServletContextServletä¸Šä¸‹æ–‡ï¼ŒWEBå®¹å™¨åœ¨å¯åŠ¨æ—¶ï¼Œå®ƒä¼šä¸ºæ¯ä¸ªWEBåº”ç”¨ç¨‹åºéƒ½åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„ServletContextå¯¹è±¡ï¼Œå®ƒä»£è¡¨å½“å‰webåº”ç”¨ï¼Œæ˜¯ä¸€ä¸ªå…¨å±€çš„çŽ¯å¢ƒå˜é‡ã€‚è¯¥åº”ç”¨ä¸­çš„ä»»ä½•ç»„ä»¶ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥è®¿é—®åˆ°è¯¥å¯¹è±¡ï¼Œæ‰€ä»¥Servletä¸Šä¸‹æ–‡å…·æœ‰å”¯ä¸€æ€§ã€‚åœ¨ä¸€ä¸ªwebé¡¹ç›®ä¸­å†™ä¸¤ä¸ªç›¸åŒçš„Servletï¼š123456789101112131415161718192021222324252627public class FirstServlet extends HttpServlet&#123; @Override protected void service(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException &#123; //1.ç»Ÿè®¡Servletè®¿é—®æ¬¡æ•°ï¼šèŽ·å–ServletContextï¼Œå®ƒæ˜¯Servletå…¬ç”¨çš„ //æ•°æ®å¯¹è±¡ï¼Œåœ¨Tomcatå¯åŠ¨æ—¶è¢«Tomcatè‡ªåŠ¨åˆ›å»ºï¼Œåœ¨Tomcatå…³é—­æ—¶è¢«Tomcatè‡ªåŠ¨é”€æ¯ã€‚ //å®ƒæ˜¯å•ä¾‹çš„å¯¹è±¡ï¼Œä¸€ä¸ªé¡¹ç›®å†…åªæœ‰ä¸€ä»½ã€‚ ServletContext ctx = getServletContext(); //å°è¯•ä»Žæ­¤å¯¹è±¡ä¸­è¯»å–countå˜é‡ Object count = ctx.getAttribute("count"); //åˆ¤æ–­å˜é‡æ˜¯å¦å­˜åœ¨ if(count == null) &#123; //å˜é‡ä¸å­˜åœ¨ï¼Œæœ¬æ¬¡è®¿é—®æ˜¯ç¬¬1æ¬¡ï¼Œ //åˆå§‹åŒ–æ­¤å˜é‡å¹¶å­˜å…¥ServletContextã€‚ ctx.setAttribute("count", 1); &#125; else &#123; //å˜é‡å­˜åœ¨ï¼Œæœ¬æ¬¡è®¿é—®ä¸æ˜¯ç¬¬1æ¬¡ï¼Œ //å°†å˜é‡+1ï¼Œå†æ¬¡å­˜å…¥ServletContextã€‚ ctx.setAttribute("count", new Integer(count.toString())+1); &#125; //2.å°†ç»Ÿè®¡ç»“æžœè¾“å‡ºåˆ°æµè§ˆå™¨ä¸Š res.setContentType("text/html;charset=utf-8;"); PrintWriter w = res.getWriter(); w.println("&lt;h1&gt;æ€»æµé‡æ˜¯ï¼š"+ctx.getAttribute("count")+"&lt;/h1&gt;"); w.close(); &#125;&#125;SecondServletå†…å®¹å’ŒFirstServletä¸€è‡´ã€‚é…ç½®ç•¥ã€‚è®¿é—®http://localhost:8080/servlet/firstï¼šè®¿é—®http://localhost:8080/servlet/secondï¼šå¯è§å®ƒä»¬èŽ·å–åˆ°çš„æ˜¯åŒä¸€ä¸ªServletContextï¼Œæ¢å¥è¯è¯´ServletContextåªæœ‰ä¸€ä»½ã€‚JSPJSPï¼ˆJava Server Pageï¼‰æ˜¯Sunå…¬å¸åˆ¶å®šçš„ä¸€ç§æœåŠ¡å™¨ç«¯åŠ¨æ€é¡µé¢æŠ€æœ¯çš„ç»„ä»¶è§„èŒƒï¼Œä»¥â€œ.jspâ€ä¸ºåŽç¼€çš„æ–‡ä»¶ä¸­æ—¢åŒ…å«HTMLé™æ€æ ‡è®°ç”¨äºŽè¡¨çŽ°é¡µé¢ï¼Œä¹ŸåŒ…å«ç‰¹æ®Šçš„ä»£ç ï¼Œç”¨äºŽç”ŸæˆåŠ¨æ€å†…å®¹ã€‚JSPä½œä¸ºç®€åŒ–Servletå¼€å‘çš„ä¸€ç§æŠ€æœ¯ï¼Œå®žè´¨ä¸Šæœ€ç»ˆä¾ç„¶è¦è½¬å˜ä¸ºServletæ‰å¯èƒ½è¿è¡Œï¼Œåªä¸è¿‡è¿™ä¸ªè½¬å˜è¿‡ç¨‹ç”±Servletå®¹å™¨æ¥å®Œæˆã€‚ç»Ÿä¸€å¤„ç†å¼‚å¸¸å°†ç³»ç»Ÿå¼‚å¸¸å°†ç»™å®¹å™¨æ¥å¤„ç†ï¼Œåœ¨web.xmlä¸­é…ç½®å¼‚å¸¸å¤„ç†é¡µé¢ï¼š1234&lt;error-page&gt; &lt;exception-type&gt;javax.servlet.ServletException&lt;/exception-type&gt; &lt;location&gt;/error.jsp&lt;/location&gt;&lt;/error-page&gt;è¿‡æ»¤å™¨Filterç¼–å†™è¿‡æ»¤å™¨éµå¾ªä¸‹åˆ—æ­¥éª¤ï¼š1.ç¼–å†™ä¸€ä¸ªå®žçŽ°äº†FilteræŽ¥å£çš„ç±»ã€‚2.å®žçŽ°FilteræŽ¥å£çš„ä¸‰ä¸ªæ–¹æ³•ï¼Œè¿‡æ»¤é€»è¾‘åœ¨doFilteræ–¹æ³•ä¸­å®žçŽ°ã€‚3.åœ¨Webç¨‹åºä¸­æ³¨å†Œè¿‡æ»¤å™¨ã€‚4.æŠŠè¿‡æ»¤å™¨å’ŒWebåº”ç”¨ä¸€èµ·æ‰“åŒ…éƒ¨ç½²ã€‚å½“æœ‰å¤šä¸ªè¿‡æ»¤å™¨çš„æ—¶å€™ï¼Œè¿‡æ»¤çš„å…ˆåŽæŒ‰ç…§xmlæ–‡ä»¶ä¸­mappingçš„å…ˆåŽé¡ºåºæ‰§è¡Œï¼Œå…·ä½“è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šä¸Šå›¾å±•ç¤ºäº†å¤šä¸ªè¿‡æ»¤å™¨çš„æ‰§è¡Œæµç¨‹ï¼Œè¿‡æ»¤å™¨1çš„doFilterçš„code1 â†’è¿‡æ»¤å™¨2çš„doFilterçš„code1 â†’service()æ–¹æ³•â†’è¿‡æ»¤å™¨2çš„doFilterçš„code2 â†’è¿‡æ»¤å™¨1çš„doFilterçš„code2 â†’è¿”å›žç»™å®¢æˆ·ç«¯ã€‚åœ¨è¿™ä¸ªåŠ¨ä½œçš„ä¼ é€’è¿‡ç¨‹ä¸­ä¸€å®šè¦å†™chain.doFilter()ã€‚æ¨¡æ‹Ÿä¸€ä¸ªç™»å½•çš„ä¾‹å­ï¼š123456789101112131415161718192021222324252627282930313233343536373839public class LoginFilter implements Filter&#123; private String[] paths; @Override public void destroy() &#123; &#125; @Override public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123; HttpServletRequest req = (HttpServletRequest) request; HttpServletResponse res = (HttpServletResponse) response; String uri = req.getRequestURI(); for(String path : paths)&#123; if(uri.contains(path))&#123; chain.doFilter(req, res); return; &#125; &#125; //åˆ¤æ–­sessionä¸­æ˜¯å¦å­˜åœ¨ç™»å½•æ•°æ® HttpSession session = req.getSession(); //æ¨¡æ‹Ÿä¸€ä¸ªå«adminçš„è´¦å· String admin = (String) session.getAttribute("admin"); if(admin == null) &#123; //æ²¡æœ‰ç™»å½•ï¼Œå¼ºåˆ¶è·³è½¬åˆ°ç™»å½•é¡µ res.sendRedirect(req.getContextPath() + "/login/toLogin.do"); &#125; else &#123; //å·²ç™»å½•ï¼Œç»§ç»­æ‰§è¡Œ chain.doFilter(req, res); &#125; &#125; @Override public void init(FilterConfig filterConfig) throws ServletException &#123; String excludePath = filterConfig.getInitParameter("excludePath"); paths = excludePath.split(","); &#125;&#125;åœ¨web.xmlä¸­é…ç½®Filterï¼š12345678910111213&lt;filter&gt; &lt;filter-name&gt;loginFilter&lt;/filter-name&gt; &lt;filter-class&gt;com.postar.servlet.LoginFilter&lt;/filter-class&gt; &lt;!-- è®¾ç½®è¦æŽ’é™¤è¿‡æ»¤çš„è·¯å¾„ --&gt; &lt;init-param&gt; &lt;param-name&gt;excludePath&lt;/param-name&gt; &lt;param-value&gt;login/toLogin,login/login,login/createImage&lt;/param-value&gt; &lt;/init-param&gt;&lt;/filter&gt;&lt;filter-mapping&gt; &lt;filter-name&gt;loginFilter&lt;/filter-name&gt; &lt;url-pattern&gt;*.do&lt;/url-pattern&gt;&lt;/filter-mapping&gt;æºç åœ°å€ https://git.coding.net/laizhipeng/Servlet.git]]></content>
      <tags>
        <tag>servlet&amp;jsp</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java OOP2]]></title>
    <url>%2FJava-OOP2.html</url>
    <content type="text"><![CDATA[æ–‡ç« å·²åŠ å¯†ï¼Œè¯·è¾“å…¥å¯†ç  ðŸ˜›ï¼š å¯†ç é”™è¯¯ ðŸ˜­ No content to display! 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]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Java OOP1]]></title>
    <url>%2FJava%20OOP1.html</url>
    <content type="text"><![CDATA[æ–‡ç« å·²åŠ å¯†ï¼Œè¯·è¾“å…¥å¯†ç  ðŸ˜›ï¼š å¯†ç é”™è¯¯ ðŸ˜­ No content to display! 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]]></content>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
</search>
